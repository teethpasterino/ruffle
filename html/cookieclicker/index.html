<!DOCTYPE html>
<html>
  <head>
    <!-- external -->
    <script type="text/javascript">
    </script>

    <script type="text/javascript" src="cookieconsent.min.js"></script>

    <!--<link href="https://fonts.googleapis.com/css?family=Kavoon&subset=latin,latin-ext" rel="stylesheet" type="text/css">-->
    <link href="https://fonts.googleapis.com/css?family=Merriweather:900&subset=latin,latin-ext" rel="stylesheet" type="text/css" />
    <title>index.html</title>
    <!--
      Code and graphics copyright Orteil, 2013-2022
      Feel free to alter this code to your liking, but please do not re-host it, do not profit from it and do not present it as your own.
    -->
    <meta name="viewport" content="width=900, initial-scale=1" />
    <link rel="shortcut icon" href="img/favicon.ico" />
    <script src="base64.js"></script>
    <script src="data:@file/javascript;base64,LyoKQWxsIHRoaXMgY29kZSBpcyBjb3B5cmlnaHQgT3J0ZWlsLCAyMDEzLTIwMjIuCgktd2l0aCBzb21lIGhlbHAsIGFkdmljZSBhbmQgZml4ZXMgYnkgTmljaG9sYXMgTGF1eCwgRGVidWdicm8sIE9wdGksIHRoZSBmb2xrcyBhdCBQbGF5c2F1cnVzLCBhbmQgbG90cyBvZiBwZW9wbGUgb24gcmVkZGl0LCBEaXNjb3JkLCBhbmQgdGhlIERhc2hOZXQgZm9ydW1zCgktYWxzbyBpbmNsdWRlcyBhIGJ1bmNoIG9mIHNuaXBwZXRzIGZvdW5kIG9uIHN0YWNrb3ZlcmZsb3cuY29tIGFuZCBvdGhlcnMKCS13YW50IHRvIG1vZCB0aGUgZ2FtZT8gc2Nyb2xsIGRvd24gdG8gdGhlICJNT0RESU5HIEFQSSIgc2VjdGlvbgpIZWxsbywgYW5kIHdlbGNvbWUgdG8gdGhlIGpveW91cyBtZXNzIHRoYXQgaXMgbWFpbi5qcy4gQ29kZSBjb250YWluZWQgaGVyZWluIGlzIG5vdCBndWFyYW50ZWVkIHRvIGJlIGdvb2QsIGNvbnNpc3RlbnQsIG9yIHNhbmUuIE1vc3Qgb2YgdGhpcyBpcyB5ZWFycyBvbGQgYXQgdGhpcyBwb2ludCBhbmQgaGFya2VucyBiYWNrIHRvIHNpbXBsZXIsIGNydWRlciB0aW1lcy4gSW4gcGFydGljdWxhciBJJ3ZlIHRyaWVkIHRvIG1haW50YWluIGNvbXBhdGliaWxpdHkgd2l0aCBmYWlybHkgb2xkIHZlcnNpb25zIG9mIGphdmFzY3JpcHQsIHdoaWNoIG1lYW5zIGx1eHVyaWVzIHN1Y2ggYXMgJ2xldCcsIGFycm93IGZ1bmN0aW9ucyBhbmQgc3RyaW5nIGxpdGVyYWxzIGFyZSB1bmF2YWlsYWJsZS4KQXMgQ29va2llIENsaWNrZXIgaXMgcmlmZSB3aXRoIHB1bnMgYW5kIHRyaWNreSB3b3JkcGxheSwgbG9jYWxpemF0aW9uIHdhcyBuZXZlciBpbnRlbmRlZCB0byBiZSBwb3NzaWJsZSAtIGJ1dCBlbmRlZCB1cCBoYXBwZW5pbmcgYW55d2F5IGFzIHBhcnQgb2YgdGhlIFN0ZWFtIHBvcnQuIEFzIGEgcmVzdWx0LCB1c2FnZSBvZiBzdHJpbmdzIGlzIHNvbWV3aGF0IHVub3J0aG9kb3ggaW4gc29tZSBwbGFjZXMuCkhhdmUgYSBuaWNlIHRyaXAsIGFuZCBzdGF5IHNhZmUuClNwb2lsZXJzIGFoZWFkLgpodHRwOi8vb3J0ZWlsLmRhc2huZXQub3JnCiovCgovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KTUlTQyBIRUxQRVIgRlVOQ1RJT05TCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCmZ1bmN0aW9uIGwod2hhdCkgewogIHJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh3aGF0KTsKfQpmdW5jdGlvbiBjaG9vc2UoYXJyKSB7CiAgcmV0dXJuIGFycltNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBhcnIubGVuZ3RoKV07Cn0KCmZ1bmN0aW9uIGVzY2FwZVJlZ0V4cChzdHIpIHsKICByZXR1cm4gc3RyLnJlcGxhY2UoL1tcLVxbXF1cL1x7XH1cKFwpXCpcK1w/XC5cXFxeXCRcfF0vZywgIlxcJCYiKTsKfQpmdW5jdGlvbiByZXBsYWNlQWxsKGZpbmQsIHJlcGxhY2UsIHN0cikgewogIHJldHVybiBzdHIucmVwbGFjZShuZXcgUmVnRXhwKGVzY2FwZVJlZ0V4cChmaW5kKSwgImciKSwgcmVwbGFjZSk7Cn0KCmZ1bmN0aW9uIGNhcChzdHIpIHsKICByZXR1cm4gc3RyLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgc3RyLnNsaWNlKDEpOwp9CgpmdW5jdGlvbiByb21hbml6ZShudW0pIHsKICBpZiAoaXNOYU4obnVtKSkgcmV0dXJuIE5hTjsKICB2YXIgZGlnaXRzID0gU3RyaW5nKCtudW0pLnNwbGl0KCIiKSwKICAgIGtleSA9IFsKICAgICAgIiIsCiAgICAgICJDIiwKICAgICAgIkNDIiwKICAgICAgIkNDQyIsCiAgICAgICJDRCIsCiAgICAgICJEIiwKICAgICAgIkRDIiwKICAgICAgIkRDQyIsCiAgICAgICJEQ0NDIiwKICAgICAgIkNNIiwKICAgICAgIiIsCiAgICAgICJYIiwKICAgICAgIlhYIiwKICAgICAgIlhYWCIsCiAgICAgICJYTCIsCiAgICAgICJMIiwKICAgICAgIkxYIiwKICAgICAgIkxYWCIsCiAgICAgICJMWFhYIiwKICAgICAgIlhDIiwKICAgICAgIiIsCiAgICAgICJJIiwKICAgICAgIklJIiwKICAgICAgIklJSSIsCiAgICAgICJJViIsCiAgICAgICJWIiwKICAgICAgIlZJIiwKICAgICAgIlZJSSIsCiAgICAgICJWSUlJIiwKICAgICAgIklYIiwKICAgIF0sCiAgICByb21hbiA9ICIiLAogICAgaSA9IDM7CiAgd2hpbGUgKGktLSkgcm9tYW4gPSAoa2V5WytkaWdpdHMucG9wKCkgKyBpICogMTBdIHx8ICIiKSArIHJvbWFuOwogIHJldHVybiBBcnJheSgrZGlnaXRzLmpvaW4oIiIpICsgMSkuam9pbigiTSIpICsgcm9tYW47Cn0KCi8vZGlzYWJsZSBzb3VuZHMgY29taW5nIGZyb20gc291bmRqYXkuY29tIChzb3JyeSkKdmFyIHJlYWxBdWRpbyA9CiAgdHlwZW9mIEF1ZGlvICE9PSAidW5kZWZpbmVkIgogICAgPyBBdWRpbwogICAgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHt9OwogICAgICB9OyAvL2JhY2t1cCByZWFsIGF1ZGlvCkF1ZGlvID0gZnVuY3Rpb24gKHNyYykgewogIGlmIChzcmMgJiYgc3JjLmluZGV4T2YoInNvdW5kamF5IikgPiAtMSkgewogICAgR2FtZS5Qb3B1cCgiU29ycnksIG5vIHNvdW5kcyBob3RsaW5rZWQgZnJvbSBzb3VuZGpheS5jb20uIik7CiAgICB0aGlzLnBsYXkgPSBmdW5jdGlvbiAoKSB7fTsKICB9IGVsc2UgcmV0dXJuIG5ldyByZWFsQXVkaW8oc3JjKTsKfTsKCmlmICghQXJyYXkucHJvdG90eXBlLmluZGV4T2YpIHsKICBBcnJheS5wcm90b3R5cGUuaW5kZXhPZiA9IGZ1bmN0aW9uIChuZWVkbGUpIHsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykgewogICAgICBpZiAodGhpc1tpXSA9PT0gbmVlZGxlKSB7CiAgICAgICAgcmV0dXJuIGk7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiAtMTsKICB9Owp9CgpmdW5jdGlvbiByYW5kb21GbG9vcih4KSB7CiAgaWYgKHggJSAxIDwgTWF0aC5yYW5kb20oKSkgcmV0dXJuIE1hdGguZmxvb3IoeCk7CiAgZWxzZSByZXR1cm4gTWF0aC5jZWlsKHgpOwp9CgpmdW5jdGlvbiBzaHVmZmxlKGFycmF5KSB7CiAgdmFyIGNvdW50ZXIgPSBhcnJheS5sZW5ndGgsCiAgICB0ZW1wLAogICAgaW5kZXg7CiAgLy8gV2hpbGUgdGhlcmUgYXJlIGVsZW1lbnRzIGluIHRoZSBhcnJheQogIHdoaWxlIChjb3VudGVyLS0pIHsKICAgIC8vIFBpY2sgYSByYW5kb20gaW5kZXgKICAgIGluZGV4ID0gKE1hdGgucmFuZG9tKCkgKiBjb3VudGVyKSB8IDA7CgogICAgLy8gQW5kIHN3YXAgdGhlIGxhc3QgZWxlbWVudCB3aXRoIGl0CiAgICB0ZW1wID0gYXJyYXlbY291bnRlcl07CiAgICBhcnJheVtjb3VudGVyXSA9IGFycmF5W2luZGV4XTsKICAgIGFycmF5W2luZGV4XSA9IHRlbXA7CiAgfQogIHJldHVybiBhcnJheTsKfQoKRWxlbWVudC5wcm90b3R5cGUuZ2V0Qm91bmRzID0gZnVuY3Rpb24gKCkgewogIHZhciBib3VuZHMgPSB0aGlzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogIHZhciBzID0gR2FtZS5zY2FsZTsKICBib3VuZHMueCAvPSBzOwogIGJvdW5kcy55IC89IHM7CiAgYm91bmRzLndpZHRoIC89IHM7CiAgYm91bmRzLmhlaWdodCAvPSBzOwogIGJvdW5kcy50b3AgLz0gczsKICBib3VuZHMuYm90dG9tIC89IHM7CiAgYm91bmRzLmxlZnQgLz0gczsKICBib3VuZHMucmlnaHQgLz0gczsKICByZXR1cm4gYm91bmRzOwp9OwoKdmFyIExvYWRTY3JpcHQgPSBmdW5jdGlvbiAodXJsLCBjYWxsYmFjaywgZXJyb3IpIHsKICB2YXIganMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKTsKICBqcy5zZXRBdHRyaWJ1dGUoInR5cGUiLCAidGV4dC9qYXZhc2NyaXB0Iik7CiAgaWYgKGpzLnJlYWR5U3RhdGUpIHsKICAgIGpzLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKGpzLnJlYWR5U3RhdGUgPT09ICJsb2FkZWQiIHx8IGpzLnJlYWR5U3RhdGUgPT09ICJjb21wbGV0ZSIpIHsKICAgICAgICBqcy5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsOwogICAgICAgIGlmIChjYWxsYmFjaykgY2FsbGJhY2soKTsKICAgICAgfQogICAgfTsKICB9IGVsc2UgaWYgKGNhbGxiYWNrKSB7CiAgICBqcy5vbmxvYWQgPSBjYWxsYmFjazsKICB9CiAgaWYgKGVycm9yKSBqcy5vbmVycm9yID0gZXJyb3I7CgogIGpzLnNldEF0dHJpYnV0ZSgic3JjIiwgdXJsKTsKICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGpzKTsKfTsKCmxvY2FsU3RvcmFnZUdldCA9IGZ1bmN0aW9uIChrZXkpIHsKICB2YXIgbG9jYWwgPSAwOwogIHRyeSB7CiAgICBsb2NhbCA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpOwogIH0gY2F0Y2ggKGV4Y2VwdGlvbikge30KICByZXR1cm4gbG9jYWw7Cn07CmxvY2FsU3RvcmFnZVNldCA9IGZ1bmN0aW9uIChrZXksIHN0cikgewogIHZhciBsb2NhbCA9IDA7CiAgdHJ5IHsKICAgIGxvY2FsID0gd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKGtleSwgc3RyKTsKICB9IGNhdGNoIChleGNlcHRpb24pIHt9CiAgcmV0dXJuIGxvY2FsOwp9OwoKdmFyIGFqYXggPSBmdW5jdGlvbiAodXJsLCBjYWxsYmFjaykgewogIHZhciBodHRwUmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOwogIGlmICghaHR0cFJlcXVlc3QpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CiAgaHR0cFJlcXVlc3Qub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkgewogICAgdHJ5IHsKICAgICAgaWYgKAogICAgICAgIGh0dHBSZXF1ZXN0LnJlYWR5U3RhdGUgPT09IFhNTEh0dHBSZXF1ZXN0LkRPTkUgJiYKICAgICAgICBodHRwUmVxdWVzdC5zdGF0dXMgPT09IDIwMAogICAgICApIHsKICAgICAgICBjYWxsYmFjayhodHRwUmVxdWVzdC5yZXNwb25zZVRleHQpOwogICAgICB9CiAgICB9IGNhdGNoIChlKSB7fQogIH07CiAgLy9odHRwUmVxdWVzdC5vbmVycm9yPWZ1bmN0aW9uKGUpe2NvbnNvbGUubG9nKCdFUlJPUicsZSk7fQogIGlmICh1cmwuaW5kZXhPZigiPyIpID09IC0xKSB1cmwgKz0gIj8iOwogIGVsc2UgdXJsICs9ICImIjsKICB1cmwgKz0gIm5vY2FjaGU9IiArIERhdGUubm93KCk7CiAgaHR0cFJlcXVlc3Qub3BlbigiR0VUIiwgdXJsKTsKICBodHRwUmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAidGV4dC9wbGFpbiIpOwogIGh0dHBSZXF1ZXN0Lm92ZXJyaWRlTWltZVR5cGUoInRleHQvcGxhaW4iKTsKICBodHRwUmVxdWVzdC5zZW5kKCk7CiAgcmV0dXJuIHRydWU7Cn07CgpmdW5jdGlvbiB0b0ZpeGVkKHgpIHsKICBpZiAoTWF0aC5hYnMoeCkgPCAxLjApIHsKICAgIHZhciBlID0gcGFyc2VJbnQoeC50b1N0cmluZygpLnNwbGl0KCJlLSIpWzFdKTsKICAgIGlmIChlKSB7CiAgICAgIHggKj0gTWF0aC5wb3coMTAsIGUgLSAxKTsKICAgICAgeCA9ICIwLiIgKyBuZXcgQXJyYXkoZSkuam9pbigiMCIpICsgeC50b1N0cmluZygpLnN1YnN0cmluZygyKTsKICAgIH0KICB9IGVsc2UgewogICAgdmFyIGUgPSBwYXJzZUludCh4LnRvU3RyaW5nKCkuc3BsaXQoIisiKVsxXSk7CiAgICBpZiAoZSA+IDIwKSB7CiAgICAgIGUgLT0gMjA7CiAgICAgIHggLz0gTWF0aC5wb3coMTAsIGUpOwogICAgICB4ICs9IG5ldyBBcnJheShlICsgMSkuam9pbigiMCIpOwogICAgfQogIH0KICByZXR1cm4geDsKfQoKLy9CZWF1dGlmeSBhbmQgbnVtYmVyLWZvcm1hdHRpbmcgYWRhcHRlZCBmcm9tIHRoZSBGcm96ZW4gQ29va2llcyBhZGQtb24gKGh0dHA6Ly9jb29raWVjbGlja2VyLndpa2lhLmNvbS93aWtpL0Zyb3plbl9Db29raWVzXyUyOEphdmFTY3JpcHRfQWRkLW9uJTI5KQpmdW5jdGlvbiBmb3JtYXRFdmVyeVRoaXJkUG93ZXIobm90YXRpb25zKSB7CiAgcmV0dXJuIGZ1bmN0aW9uICh2YWwpIHsKICAgIHZhciBiYXNlID0gMCwKICAgICAgbm90YXRpb25WYWx1ZSA9ICIiOwogICAgaWYgKCFpc0Zpbml0ZSh2YWwpKSByZXR1cm4gIkluZmluaXR5IjsKICAgIGlmICh2YWwgPj0gMTAwMDAwMCkgewogICAgICB2YWwgLz0gMTAwMDsKICAgICAgd2hpbGUgKE1hdGgucm91bmQodmFsKSA+PSAxMDAwKSB7CiAgICAgICAgdmFsIC89IDEwMDA7CiAgICAgICAgYmFzZSsrOwogICAgICB9CiAgICAgIGlmIChiYXNlID49IG5vdGF0aW9ucy5sZW5ndGgpIHsKICAgICAgICByZXR1cm4gIkluZmluaXR5IjsKICAgICAgfSBlbHNlIHsKICAgICAgICBub3RhdGlvblZhbHVlID0gbm90YXRpb25zW2Jhc2VdOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gTWF0aC5yb3VuZCh2YWwgKiAxMDAwKSAvIDEwMDAgKyBub3RhdGlvblZhbHVlOwogIH07Cn0KCmZ1bmN0aW9uIHJhd0Zvcm1hdHRlcih2YWwpIHsKICByZXR1cm4gTWF0aC5yb3VuZCh2YWwgKiAxMDAwKSAvIDEwMDA7Cn0KCnZhciBmb3JtYXRMb25nID0gWwogICIgdGhvdXNhbmQiLAogICIgbWlsbGlvbiIsCiAgIiBiaWxsaW9uIiwKICAiIHRyaWxsaW9uIiwKICAiIHF1YWRyaWxsaW9uIiwKICAiIHF1aW50aWxsaW9uIiwKICAiIHNleHRpbGxpb24iLAogICIgc2VwdGlsbGlvbiIsCiAgIiBvY3RpbGxpb24iLAogICIgbm9uaWxsaW9uIiwKXTsKdmFyIHByZWZpeGVzID0gWwogICIiLAogICJ1biIsCiAgImR1byIsCiAgInRyZSIsCiAgInF1YXR0dW9yIiwKICAicXVpbiIsCiAgInNleCIsCiAgInNlcHRlbiIsCiAgIm9jdG8iLAogICJub3ZlbSIsCl07CnZhciBzdWZmaXhlcyA9IFsKICAiZGVjaWxsaW9uIiwKICAidmlnaW50aWxsaW9uIiwKICAidHJpZ2ludGlsbGlvbiIsCiAgInF1YWRyYWdpbnRpbGxpb24iLAogICJxdWlucXVhZ2ludGlsbGlvbiIsCiAgInNleGFnaW50aWxsaW9uIiwKICAic2VwdHVhZ2ludGlsbGlvbiIsCiAgIm9jdG9naW50aWxsaW9uIiwKICAibm9uYWdpbnRpbGxpb24iLApdOwpmb3IgKHZhciBpIGluIHN1ZmZpeGVzKSB7CiAgZm9yICh2YXIgaWkgaW4gcHJlZml4ZXMpIHsKICAgIGZvcm1hdExvbmcucHVzaCgiICIgKyBwcmVmaXhlc1tpaV0gKyBzdWZmaXhlc1tpXSk7CiAgfQp9Cgp2YXIgZm9ybWF0U2hvcnQgPSBbImsiLCAiTSIsICJCIiwgIlQiLCAiUWEiLCAiUWkiLCAiU3giLCAiU3AiLCAiT2MiLCAiTm8iXTsKdmFyIHByZWZpeGVzID0gWyIiLCAiVW4iLCAiRG8iLCAiVHIiLCAiUWEiLCAiUWkiLCAiU3giLCAiU3AiLCAiT2MiLCAiTm8iXTsKdmFyIHN1ZmZpeGVzID0gWyJEIiwgIlYiLCAiVCIsICJRYSIsICJRaSIsICJTeCIsICJTcCIsICJPIiwgIk4iXTsKZm9yICh2YXIgaSBpbiBzdWZmaXhlcykgewogIGZvciAodmFyIGlpIGluIHByZWZpeGVzKSB7CiAgICBmb3JtYXRTaG9ydC5wdXNoKCIgIiArIHByZWZpeGVzW2lpXSArIHN1ZmZpeGVzW2ldKTsKICB9Cn0KZm9ybWF0U2hvcnRbMTBdID0gIkRjIjsKCnZhciBudW1iZXJGb3JtYXR0ZXJzID0gWwogIGZvcm1hdEV2ZXJ5VGhpcmRQb3dlcihmb3JtYXRTaG9ydCksCiAgZm9ybWF0RXZlcnlUaGlyZFBvd2VyKGZvcm1hdExvbmcpLAogIHJhd0Zvcm1hdHRlciwKXTsKdmFyIEJlYXV0aWZ5ID0gZnVuY3Rpb24gKHZhbCwgZmxvYXRzKSB7CiAgdmFyIG5lZ2F0aXZlID0gdmFsIDwgMDsKICB2YXIgZGVjaW1hbCA9ICIiOwogIHZhciBmaXhlZCA9IHZhbC50b0ZpeGVkKGZsb2F0cyk7CiAgaWYgKGZsb2F0cyA+IDAgJiYgTWF0aC5hYnModmFsKSA8IDEwMDAgJiYgTWF0aC5mbG9vcihmaXhlZCkgIT0gZml4ZWQpCiAgICBkZWNpbWFsID0gIi4iICsgZml4ZWQudG9TdHJpbmcoKS5zcGxpdCgiLiIpWzFdOwogIHZhbCA9IE1hdGguZmxvb3IoTWF0aC5hYnModmFsKSk7CiAgaWYgKGZsb2F0cyA+IDAgJiYgZml4ZWQgPT0gdmFsICsgMSkgdmFsKys7CiAgLy92YXIgZm9ybWF0PSFFTj8yOkdhbWUucHJlZnMuZm9ybWF0PzI6MTsKICB2YXIgZm9ybWF0ID0gR2FtZS5wcmVmcy5mb3JtYXQgPyAyIDogMTsKICB2YXIgZm9ybWF0dGVyID0gbnVtYmVyRm9ybWF0dGVyc1tmb3JtYXRdOwogIHZhciBvdXRwdXQgPQogICAgdmFsLnRvU3RyaW5nKCkuaW5kZXhPZigiZSsiKSAhPSAtMSAmJiBmb3JtYXQgPT0gMgogICAgICA/IHZhbC50b1ByZWNpc2lvbigzKS50b1N0cmluZygpCiAgICAgIDogZm9ybWF0dGVyKHZhbCkKICAgICAgICAgIC50b1N0cmluZygpCiAgICAgICAgICAucmVwbGFjZSgvXEIoPz0oXGR7M30pKyg/IVxkKSkvZywgIiwiKTsKICAvL3ZhciBvdXRwdXQ9Zm9ybWF0dGVyKHZhbCkudG9TdHJpbmcoKS5yZXBsYWNlKC9cQig/PShcZHszfSkrKD8hXGQpKS9nLCcsJyk7CiAgaWYgKG91dHB1dCA9PSAiMCIpIG5lZ2F0aXZlID0gZmFsc2U7CiAgcmV0dXJuIG5lZ2F0aXZlID8gIi0iICsgb3V0cHV0IDogb3V0cHV0ICsgZGVjaW1hbDsKfTsKdmFyIHNob3J0ZW5OdW1iZXIgPSBmdW5jdGlvbiAodmFsKSB7CiAgLy9pZiBubyBzY2llbnRpZmljIG5vdGF0aW9uLCByZXR1cm4gYXMgaXMsIGVsc2UgOgogIC8va2VlcCBvbmx5IHRoZSA1IGZpcnN0IGRpZ2l0cyAocGx1cyBkb3QpLCByb3VuZCB0aGUgcmVzdAogIC8vbWF5IG9yIG1heSBub3Qgd29yayBwcm9wZXJseQogIGlmICh2YWwgPj0gMTAwMDAwMCAmJiBpc0Zpbml0ZSh2YWwpKSB7CiAgICB2YXIgbnVtID0gdmFsLnRvU3RyaW5nKCk7CiAgICB2YXIgaW5kID0gbnVtLmluZGV4T2YoImUrIik7CiAgICBpZiAoaW5kID09IC0xKSByZXR1cm4gdmFsOwogICAgdmFyIHN0ciA9ICIiOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbmQ7IGkrKykgewogICAgICBzdHIgKz0gaSA8IDYgPyBudW1baV0gOiAiMCI7CiAgICB9CiAgICBzdHIgKz0gImUrIjsKICAgIHN0ciArPSBudW0uc3BsaXQoImUrIilbMV07CiAgICByZXR1cm4gcGFyc2VGbG9hdChzdHIpOwogIH0KICByZXR1cm4gdmFsOwp9OwoKdmFyIFNpbXBsZUJlYXV0aWZ5ID0gZnVuY3Rpb24gKHZhbCkgewogIHZhciBzdHIgPSB2YWwudG9TdHJpbmcoKTsKICB2YXIgc3RyMiA9ICIiOwogIGZvciAodmFyIGkgaW4gc3RyKSB7IC8vYWRkIGNvbW1hcwogICAgaWYgKChzdHIubGVuZ3RoIC0gaSkgJSAzID09IDAgJiYgaSA+IDApIHN0cjIgKz0gIiwiOwogICAgc3RyMiArPSBzdHJbaV07CiAgfQogIHJldHVybiBzdHIyOwp9OwoKdmFyIGJlYXV0aWZ5SW5UZXh0RmlsdGVyID0gLygoW1xkXStbLF0qKSspL2c7IC8vbmV3IHJlZ2V4CmZ1bmN0aW9uIEJlYXV0aWZ5SW5UZXh0RnVuY3Rpb24oc3RyKSB7CiAgcmV0dXJuIEJlYXV0aWZ5KHBhcnNlSW50KHN0ci5yZXBsYWNlKC8sL2csICIiKSwgMTApKTsKfQpmdW5jdGlvbiBCZWF1dGlmeUluVGV4dChzdHIpIHsKICByZXR1cm4gc3RyLnJlcGxhY2UoYmVhdXRpZnlJblRleHRGaWx0ZXIsIEJlYXV0aWZ5SW5UZXh0RnVuY3Rpb24pOwp9IC8vcmVmb3JtYXQgZXZlcnkgbnVtYmVyIGluc2lkZSBhIHN0cmluZwpmdW5jdGlvbiBCZWF1dGlmeUFsbCgpIHsKICAvL3J1biB0aHJvdWdoIHVwZ3JhZGVzIGFuZCBhY2hpZXZlbWVudHMgdG8gcmVmb3JtYXQgdGhlIG51bWJlcnMKICB2YXIgZnVuYyA9IGZ1bmN0aW9uICh3aGF0KSB7CiAgICB3aGF0LmRkZXNjID0gQmVhdXRpZnlJblRleHQod2hhdC5kZGVzYyk7CiAgfTsKICBmb3IgKHZhciBpIGluIEdhbWUuVXBncmFkZXNCeUlkKSB7CiAgICBHYW1lLlVwZ3JhZGVzQnlJZFtpXS5kZGVzYyA9IEJlYXV0aWZ5SW5UZXh0KEdhbWUuVXBncmFkZXNCeUlkW2ldLmRkZXNjKTsKICB9CiAgZm9yICh2YXIgaSBpbiBHYW1lLkFjaGlldmVtZW50c0J5SWQpIHsKICAgIEdhbWUuQWNoaWV2ZW1lbnRzQnlJZFtpXS5kZGVzYyA9IEJlYXV0aWZ5SW5UZXh0KAogICAgICBHYW1lLkFjaGlldmVtZW50c0J5SWRbaV0uZGRlc2MKICAgICk7CiAgfQp9CgovLz09PSBMT0NBTElaQVRJT04gPT09Cgp2YXIgbG9jU3RyaW5ncyA9IHt9Owp2YXIgbG9jU3RyaW5nc0ZhbGxiYWNrID0ge307CnZhciBsb2NJZCA9ICJOT05FIjsKdmFyIEVOID0gdHJ1ZTsKdmFyIGxvY05hbWUgPSAibm9uZSI7CnZhciBsb2NQYXRjaGVzID0gW107CnZhciBsb2NQbHVyID0gIm5wbHVyYWxzPTI7cGx1cmFsPShuIT0xKTsiOyAvL3NlZSBodHRwOi8vZG9jcy50cmFuc2xhdGVob3VzZS5vcmcvcHJvamVjdHMvbG9jYWxpemF0aW9uLWd1aWRlL2VuL2xhdGVzdC9sMTBuL3BsdXJhbGZvcm1zLmh0bWwKdmFyIGxvY1BsdXJGYWxsYmFjayA9IGxvY1BsdXI7Ci8vbm90ZSA6IHBsdXJhbCBpbmRleCB3aWxsIGJlIGRvd25ncmFkZWQgdG8gdGhlIGxhc3QgbWF0Y2hpbmcsIGllLiBpbiB0aGlzIGNhc2UsIGlmIHdlIGdldCAiMCIgYnV0IGRvbid0IGhhdmUgYSAzcmQgb3B0aW9uLCB1c2UgdGhlIDJuZCBvcHRpb24gKG9yIDFzdCwgbGFja2luZyB0aGF0IHRvbykKdmFyIGxvY1N0cmluZ3NCeVBhcnQgPSB7fTsKdmFyIEZpbmRMb2NTdHJpbmdCeVBhcnQgPSBmdW5jdGlvbiAobWF0Y2gpIHsKICByZXR1cm4gbG9jU3RyaW5nc0J5UGFydFttYXRjaF0gfHwgdW5kZWZpbmVkOwogIC8qCgkvL25vdGU6IHNsb3csIG9ubHkgZG8gdGhpcyBvbiBpbml0Cglmb3IgKHZhciBpIGluIGxvY1N0cmluZ3MpewoJCXZhciBiaXQ9aS5zcGxpdCgnXScpOwoJCWlmIChiaXRbMF0uc3Vic3RyaW5nKDEpPT1tYXRjaCkgcmV0dXJuIGk7Cgl9CglyZXR1cm4gdW5kZWZpbmVkOwoJKi8KfTsKCnZhciBMYW5ncyA9IHsKICBFTjogewogICAgZmlsZTogIkVOIiwKICAgIG5hbWVFTjogIkVuZ2xpc2giLAogICAgbmFtZTogIkVuZ2xpc2giLAogICAgY2hhbmdlTGFuZ3VhZ2U6ICJMYW5ndWFnZSIsCiAgICBpY29uOiAwLAogICAgdzogMSwKICAgIGlzRU46IHRydWUsCiAgfSwKICBGUjogewogICAgZmlsZTogIkZSIiwKICAgIG5hbWVFTjogIkZyZW5jaCIsCiAgICBuYW1lOiAiRnJhbiZjY2VkaWw7YWlzIiwKICAgIGNoYW5nZUxhbmd1YWdlOiAiTGFuZ3VlIiwKICAgIGljb246IDAsCiAgICB3OiAxLAogIH0sCiAgREU6IHsKICAgIGZpbGU6ICJERSIsCiAgICBuYW1lRU46ICJHZXJtYW4iLAogICAgbmFtZTogIkRldXRzY2giLAogICAgY2hhbmdlTGFuZ3VhZ2U6ICJTcHJhY2hlIiwKICAgIGljb246IDAsCiAgICB3OiAxLAogIH0sCiAgTkw6IHsKICAgIGZpbGU6ICJOTCIsCiAgICBuYW1lRU46ICJEdXRjaCIsCiAgICBuYW1lOiAiTmVkZXJsYW5kcyIsCiAgICBjaGFuZ2VMYW5ndWFnZTogIlRhYWwiLAogICAgaWNvbjogMCwKICAgIHc6IDEsCiAgfSwKICBDUzogewogICAgZmlsZTogIkNTIiwKICAgIG5hbWVFTjogIkN6ZWNoIiwKICAgIG5hbWU6ICImI3gxMEM7ZSYjeDE2MTt0aW5hIiwKICAgIGNoYW5nZUxhbmd1YWdlOiAiSmF6eWsiLAogICAgaWNvbjogMCwKICAgIHc6IDEsCiAgfSwKICBQTDogewogICAgZmlsZTogIlBMIiwKICAgIG5hbWVFTjogIlBvbGlzaCIsCiAgICBuYW1lOiAiUG9sc2tpIiwKICAgIGNoYW5nZUxhbmd1YWdlOiAiSiYjMjgxO3p5ayIsCiAgICBpY29uOiAwLAogICAgdzogMSwKICB9LAogIElUOiB7CiAgICBmaWxlOiAiSVQiLAogICAgbmFtZUVOOiAiSXRhbGlhbiIsCiAgICBuYW1lOiAiSXRhbGlhbm8iLAogICAgY2hhbmdlTGFuZ3VhZ2U6ICJMaW5ndWEiLAogICAgaWNvbjogMCwKICAgIHc6IDEsCiAgfSwKICBFUzogewogICAgZmlsZTogIkVTIiwKICAgIG5hbWVFTjogIlNwYW5pc2giLAogICAgbmFtZTogIkVzcGEmI3hGMTtvbCIsCiAgICBjaGFuZ2VMYW5ndWFnZTogIklkaW9tYSIsCiAgICBpY29uOiAwLAogICAgdzogMSwKICB9LAogICJQVC1CUiI6IHsKICAgIGZpbGU6ICJQVC1CUiIsCiAgICBuYW1lRU46ICJQb3J0dWd1ZXNlIiwKICAgIG5hbWU6ICJQb3J0dWd1JiN4RUE7cyIsCiAgICBjaGFuZ2VMYW5ndWFnZTogIklkaW9tYSIsCiAgICBpY29uOiAwLAogICAgdzogMSwKICB9LAogIEpBOiB7CiAgICBmaWxlOiAiSkEiLAogICAgbmFtZUVOOiAiSmFwYW5lc2UiLAogICAgbmFtZTogIiYjeDY1RTU7JiN4NjcyQzsmI3g4QTlFOyIsCiAgICBjaGFuZ2VMYW5ndWFnZTogIiYjMzUzMjg7JiMzNTQ4NjsiLAogICAgaWNvbjogMCwKICAgIHc6IDEuNSwKICB9LAogICJaSC1DTiI6IHsKICAgIGZpbGU6ICJaSC1DTiIsCiAgICBuYW1lRU46ICJDaGluZXNlIiwKICAgIG5hbWU6ICImI3g0RTJEOyYjeDY1ODc7IiwKICAgIGNoYW5nZUxhbmd1YWdlOiAiJiMzNTgyMTsmIzM1MzI4OyIsCiAgICBpY29uOiAwLAogICAgdzogMS41LAogIH0sCiAgS086IHsKICAgIGZpbGU6ICJLTyIsCiAgICBuYW1lRU46ICJLb3JlYW4iLAogICAgbmFtZTogIiYjeEQ1NUM7JiN4QUUwMDsiLAogICAgY2hhbmdlTGFuZ3VhZ2U6ICImI3hDNUI4OyYjeEM1QjQ7IiwKICAgIGljb246IDAsCiAgICB3OiAxLjUsCiAgfSwKICBSVTogewogICAgZmlsZTogIlJVIiwKICAgIG5hbWVFTjogIlJ1c3NpYW4iLAogICAgbmFtZTogIiYjeDQyMDsmI3g0NDM7JiN4NDQxOyYjeDQ0MTsmI3g0M0E7JiN4NDM4OyYjeDQzOTsiLAogICAgY2hhbmdlTGFuZ3VhZ2U6ICImIzEwNzE7JiMxMDc5OyYjMTA5OTsmIzEwODI7IiwKICAgIGljb246IDAsCiAgICB3OiAxLjIsCiAgfSwKfTsKCi8vbm90ZSA6IGJhc2VsaW5lIHNob3VsZCBiZSB0aGUgb3JpZ2luYWwgZW5nbGlzaCB0ZXh0Ci8vaW4gc2V2ZXJhbCBpbnN0YW5jZXMsIHRoZSBlbmdsaXNoIHRleHQgd2lsbCBiZSBxdWl0ZSBkaWZmZXJlbnQgZnJvbSB0aGUgb3RoZXIgbGFuZ3VhZ2VzLCBhcyB0aGlzIGdhbWUgd2FzIGluaXRpYWxseSBuZXZlciBtZWFudCB0byBiZSB0cmFuc2xhdGVkIGFuZCB0aGUgdHJhbnNsYXRpb24gcHJvY2VzcyBkb2Vzbid0IGFsd2F5cyBwbGF5IHdlbGwgd2l0aCBjb21wbGV4IHNlbnRlbmNlIHN0cnVjdHVyZXMKLyp1c2U6Cglsb2MoJ1BsYWluIHRleHQnKQoJbG9jKCdUZXh0IHdoZXJlICUxIGlzIGEgcGFyYW1ldGVyJywnc29tZXRoaW5nJykKCWxvYygnVGV4dCB3aGVyZSAlMSBhbmQgJTIgYXJlIHBhcmFtZXRlcnMnLFsnYSB0aGluZycsJ2Fub3RoZXIgdGhpbmcnXSkKCWxvYygnVGhlcmUgaXMgJTEgYXBwbGUnLDUpCgkJIC4uLmlmIHRoZSBsb2NhbGl6ZWQgc3RyaW5nIGlzIGFuIGFycmF5LCB0aGlzIGlzIHBhcnNlZCBhcyBhIHBsdXJhbGl6ZWQgc3RyaW5nOyBmb3IgaW5zdGFuY2UsIHRoZSBsb2NhbGl6ZWQgc3RyaW5nIGNvdWxkIGJlCgkJIlRoZXJlIGlzICUxIGFwcGxlIjpbCgkJCSJUaGVyZSBpcyAlMSBhcHBsZSIsCgkJCSJUaGVyZSBhcmUgJTEgYXBwbGVzIgoJCV0KCWxvYygnVGhlcmUgaXMgJTEgYXBwbGUgYW5kIGFsc28sICUyIScsWzUsJ2hlbGxvJ10pCglsb2MoJ1RoaXMgc3RyaW5nIGlzIGxvY2FsaXplZC4nLDAsJ1RoaXMgaXMgdGhlIHN0cmluZyBkaXNwbGF5ZWQgaW4gdGhlIGVuZ2xpc2ggdmVyc2lvbi4nKQoJbG9jKCdZb3UgaGF2ZSAlMS4nLCc8Yj4nK2xvYygnJTEgYXBwbGUnLExCZWF1dGlmeShhbW91bnQpKSsnPC9iPicpCgkJLi4ueW91IG1heSBuZXN0IGxvY2FsaXplZCBzdHJpbmdzLCBhbmQgdXNlIExCZWF1dGlmeSgpIHRvIHBhY2sgQmVhdXRpZmllZCB2YWx1ZXMKKi8KdmFyIGxvY0JsaW5rID0gZmFsc2U7CnZhciBsb2NhbGl6YXRpb25Ob3RGb3VuZCA9IFtdOwp2YXIgbG9jID0gZnVuY3Rpb24gKGlkLCBwYXJhbXMsIGJhc2VsaW5lKSB7CiAgdmFyIGZhbGxiYWNrID0gZmFsc2U7CiAgdmFyIGZvdW5kID0gbG9jU3RyaW5nc1tpZF07CiAgaWYgKCFmb3VuZCkgewogICAgZm91bmQgPSBsb2NTdHJpbmdzRmFsbGJhY2tbaWRdOwogICAgZmFsbGJhY2sgPSB0cnVlOwogIH0KICBpZiAoZm91bmQpIHsKICAgIHZhciBzdHIgPSAiIjsKICAgIHN0ciA9IHBhcnNlTG9jKGZvdW5kLCBwYXJhbXMpOwogICAgLy9yZXR1cm4gc3RyOwogICAgaWYgKHN0ci5jb25zdHJ1Y3RvciA9PT0gQXJyYXkpIHJldHVybiBzdHI7CiAgICBpZiAobG9jQmxpbmsgJiYgIWZhbGxiYWNrKQogICAgICByZXR1cm4gJzxzcGFuIGNsYXNzPSJibGlua2luZyI+JyArIHN0ciArICI8L3NwYW4+IjsgLy93aWxsIG1ha2UgZXZlcnkgbG9jYWxpemVkIHRleHQgYmxpbmsgb24gc2NyZWVuLCBtYWtpbmcgb21pc3Npb25zIG9idmlvdXM7IHdpbGwgbm90IHdvcmsgZm9yIGVsZW1lbnRzIGZpbGxlZCB3aXRoIHRleHRDb250ZW50CiAgfQoKICAvL2lmICgoZmFsbGJhY2sgfHwgIWZvdW5kKSAmJiBsb2NhbGl6YXRpb25Ob3RGb3VuZC5sZW5ndGg8MjAgJiYgbG9jYWxpemF0aW9uTm90Rm91bmQuaW5kZXhPZihpZCk9PS0xKXtsb2NhbGl6YXRpb25Ob3RGb3VuZC5wdXNoKGlkKTtjb25zb2xlLnRyYWNlKCdsb2NhbGl6YXRpb24gc3RyaW5nIG5vdCBmb3VuZDogJyxpZCk7fQogIGlmIChmb3VuZCkgcmV0dXJuIHN0cjsKICByZXR1cm4gYmFzZWxpbmUgfHwgaWQ7Cn07Cgp2YXIgcGFyc2VMb2MgPSBmdW5jdGlvbiAoc3RyLCBwYXJhbXMpIHsKICAvKgoJCXBhcnNlcyBsb2NhbGl6YXRpb24gc3RyaW5ncwoJCS10aGVyZSBjYW4gb25seSBiZSAxIHBsdXJhbCBwZXIgc3RyaW5nIGFuZCBpdCBNVVNUIGJlIGF0IGluZGV4ICUxCgkJLWEgcGx1cmFsaXplZCBzdHJpbmcgaXMgZGV0ZWN0ZWQgaWYgd2UgaGF2ZSBhdCBsZWFzdCAxIHBhcmFtIGFuZCB0aGUgbWF0Y2hpbmcgbG9jYWxpemVkIHN0cmluZyBpcyBhbiBhcnJheQoJKi8KICBpZiAodHlwZW9mIHBhcmFtcyA9PT0gInVuZGVmaW5lZCIpIHBhcmFtcyA9IFtdOwogIGVsc2UgaWYgKHBhcmFtcy5jb25zdHJ1Y3RvciAhPT0gQXJyYXkpIHBhcmFtcyA9IFtwYXJhbXNdOwogIGlmICghc3RyKSByZXR1cm4gIiI7CiAgLy9pZiAoc3RyLmNvbnN0cnVjdG9yPT09QXJyYXkpIHJldHVybiBzdHI7CiAgLy9pZiAodHlwZW9mIHN0cj09PSdmdW5jdGlvbicpIHJldHVybiBzdHIocGFyYW1zKTsKICAvL3N0cj1zdHIucmVwbGFjZSgvW1x0XG5ccl0vZ20sJycpOwoKICBpZiAocGFyYW1zLmxlbmd0aCA9PSAwKSByZXR1cm4gc3RyOwoKICBpZiAoc3RyLmNvbnN0cnVjdG9yID09PSBBcnJheSkgewogICAgaWYgKHR5cGVvZiBwYXJhbXNbMF0gPT09ICJvYmplY3QiKSB7CiAgICAgIC8vYW4gb2JqZWN0IGNvbnRhaW5pbmcgYSBiZWF1dGlmaWVkIG51bWJlcgogICAgICB2YXIgcGx1ckluZGV4ID0gbG9jUGx1cihwYXJhbXNbMF0ubik7CiAgICAgIHBsdXJJbmRleCA9IE1hdGgubWluKHN0ci5sZW5ndGggLSAxLCBwbHVySW5kZXgpOwogICAgICBzdHIgPSBzdHJbcGx1ckluZGV4XTsKICAgICAgc3RyID0gcmVwbGFjZUFsbCgiJTEiLCBwYXJhbXNbMF0uYiwgc3RyKTsKICAgIH0gZWxzZSB7CiAgICAgIHZhciBwbHVySW5kZXggPSBsb2NQbHVyKHBhcmFtc1swXSk7CiAgICAgIHBsdXJJbmRleCA9IE1hdGgubWluKHN0ci5sZW5ndGggLSAxLCBwbHVySW5kZXgpOwogICAgICBzdHIgPSBzdHJbcGx1ckluZGV4XTsKICAgICAgc3RyID0gcmVwbGFjZUFsbCgiJTEiLCBwYXJhbXNbMF0sIHN0cik7CiAgICB9CiAgfQoKICB2YXIgb3V0ID0gIiI7CiAgdmFyIGxlbiA9IHN0ci5sZW5ndGg7CiAgdmFyIGluUGVyY2VudCA9IGZhbHNlOwogIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKICAgIHZhciBpdCA9IHN0cltpXTsKICAgIGlmIChpblBlcmNlbnQpIHsKICAgICAgaW5QZXJjZW50ID0gZmFsc2U7CiAgICAgIGlmICghaXNOYU4oaXQpICYmIHBhcmFtcy5sZW5ndGggPj0gcGFyc2VJbnQoaXQpIC0gMSkKICAgICAgICBvdXQgKz0gcGFyYW1zW3BhcnNlSW50KGl0KSAtIDFdOwogICAgICBlbHNlIG91dCArPSAiJSIgKyBpdDsKICAgIH0gZWxzZSBpZiAoaXQgPT0gIiUiKSBpblBlcmNlbnQgPSB0cnVlOwogICAgZWxzZSBvdXQgKz0gaXQ7CiAgfQogIHJldHVybiBvdXQ7Cn07Cgp2YXIgTEJlYXV0aWZ5ID0gZnVuY3Rpb24gKHZhbCwgZmxvYXRzKSB7CiAgLy9yZXR1cm5zIGFuIG9iamVjdCBpbiB0aGUgZm9ybSB7bjpvcmlnaW5hbCB2YWx1ZSBmbG9vcmVkLGI6YmVhdXRpZmllZCB2YWx1ZSBhcyBzdHJpbmd9IGZvciBsb2NhbGl6YXRpb24gcHVycG9zZXMKICByZXR1cm4geyBuOiBNYXRoLmZsb29yKE1hdGguYWJzKHZhbCkpLCBiOiBCZWF1dGlmeSh2YWwsIGZsb2F0cykgfTsKfTsKCnZhciBNb2RMYW5ndWFnZSA9IGZ1bmN0aW9uIChpZCwganNvbikgewogIGlmIChpZCA9PSAiKiIpIGlkID0gbG9jSWQ7CiAgaWYgKGlkICE9IGxvY0lkIHx8ICFMYW5nc1tpZF0pIHJldHVybiBmYWxzZTsKICBpZiAoanNvblsiUkVQTEFDRSBBTEwiXSkgewogICAgdmFyIHJlcCA9IGZ1bmN0aW9uIChzdHIsIGZyb20sIHRvKSB7CiAgICAgIHZhciByZWdleCA9IG5ldyBSZWdFeHAoZnJvbSwgImlnIik7CiAgICAgIHJldHVybiBzdHIucmVwbGFjZShyZWdleCwgZnVuY3Rpb24gKG1hdGNoKSB7CiAgICAgICAgcmV0dXJuIG1hdGNoWzBdID09IG1hdGNoWzBdLnRvTG93ZXJDYXNlKCkgPyB0byA6IGNhcCh0byk7CiAgICAgIH0pOwogICAgfTsKICAgIGZvciAodmFyIGkgaW4ganNvblsiUkVQTEFDRSBBTEwiXSkgewogICAgICB2YXIgdG8gPSBqc29uWyJSRVBMQUNFIEFMTCJdW2ldOwogICAgICBmb3IgKHZhciBpaSBpbiBsb2NTdHJpbmdzKSB7CiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkobG9jU3RyaW5nc1tpaV0pKSB7CiAgICAgICAgICBmb3IgKHZhciBpaWkgaW4gbG9jU3RyaW5nc1tpaV0pIHsKICAgICAgICAgICAgbG9jU3RyaW5nc1tpaV1baWlpXSA9IHJlcChsb2NTdHJpbmdzW2lpXVtpaWldLCBpLCB0byk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGxvY1N0cmluZ3NbaWldID0gcmVwKGxvY1N0cmluZ3NbaWldLCBpLCB0byk7CiAgICAgIH0KICAgIH0KICB9CiAgZGVsZXRlIGpzb25bIlJFUExBQ0UgQUxMIl07CiAgQWRkTGFuZ3VhZ2UoaWQsIExhbmdzW2lkXS5uYW1lLCBqc29uLCB0cnVlKTsKfTsKCnZhciBBZGRMYW5ndWFnZSA9IGZ1bmN0aW9uIChpZCwgbmFtZSwganNvbiwgbW9kKSB7CiAgLy91c2VkIGluIGxvYyBmaWxlcwogIC8vaWYgbW9kIGlzIHRydWUsIHRoaXMgZmlsZSBpcyBhdWdtZW50aW5nIHRoZSBjdXJyZW50IGxhbmd1YWdlCiAgaWYgKGlkID09IGxvY0lkICYmICFtb2QpIHJldHVybiBmYWxzZTsgLy9kb24ndCBsb2FkIHR3aWNlCiAgaWYgKCFMYW5nc1tpZF0pIHJldHVybiBmYWxzZTsKICBsb2NJZCA9IGlkOwogIGlmIChMYW5nc1tsb2NJZF0uaXNFTikgRU4gPSB0cnVlOwogIGVsc2UgRU4gPSBmYWxzZTsKICBsb2NOYW1lID0gTGFuZ3NbaWRdLm5hbWVFTjsgLy9uYW1lCgogIGlmIChtb2QpIHsKICAgIGZvciAodmFyIGkgaW4ganNvbikgewogICAgICBsb2NTdHJpbmdzW2ldID0ganNvbltpXTsKICAgIH0KICAgIGZvciAodmFyIGkgaW4gbG9jU3RyaW5ncykgewogICAgICB2YXIgYml0ID0gaS5zcGxpdCgiXSIpOwogICAgICBpZiAoCiAgICAgICAgYml0WzFdICYmCiAgICAgICAgYml0WzBdLmluZGV4T2YoIltDT01NRU5UOiIpICE9IDAgJiYKICAgICAgICAhbG9jU3RyaW5nc0J5UGFydFtiaXRbMF0uc3Vic3RyaW5nKDEpXQogICAgICApCiAgICAgICAgbG9jU3RyaW5nc0J5UGFydFtiaXRbMF0uc3Vic3RyaW5nKDEpXSA9IGk7CiAgICB9CiAgICBjb25zb2xlLmxvZygnQXVnbWVudGVkIGxhbmd1YWdlICInICsgbG9jTmFtZSArICciLicpOwogIH0gZWxzZSB7CiAgICBsb2NTdHJpbmdzID0ganNvbjsKICAgIGxvY1BsdXIgPSBqc29uWyIiXVsicGx1cmFsLWZvcm1zIl0gfHwgbG9jUGx1ckZhbGxiYWNrOwogICAgZGVsZXRlIGxvY1N0cmluZ3NbIiJdOwogICAgZm9yICh2YXIgaSBpbiBsb2NTdHJpbmdzKSB7CiAgICAgIGlmIChsb2NTdHJpbmdzW2ldID09ICIvIikgbG9jU3RyaW5nc1tpXSA9IGk7CiAgICB9CgogICAgbG9jUGx1ciA9IChmdW5jdGlvbiAocGx1cmFsX2Zvcm0pIHsKICAgICAgLy9saWZ0ZWQgYW5kIG1vZGlmaWVkIGZyb20gZ2V0dGV4dC5qcwogICAgICB2YXIgcGZfcmUgPSBuZXcgUmVnRXhwKAogICAgICAgICJeXFxzKm5wbHVyYWxzXFxzKj1cXHMqWzAtOV0rXFxzKjtcXHMqcGx1cmFsXFxzKj1cXHMqKD86XFxzfFstXFw/XFx8Jj0hPD4rKi8lOjtuMC05XygpXSkrIgogICAgICApOwogICAgICBpZiAoIXBmX3JlLnRlc3QocGx1cmFsX2Zvcm0pKQogICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIHBsdXJhbCBmb3JtICInICsgcGx1cmFsX2Zvcm0gKyAnIiBpcyBub3QgdmFsaWQnKTsKICAgICAgcmV0dXJuIG5ldyBGdW5jdGlvbigKICAgICAgICAibiIsCiAgICAgICAgInZhciBwbHVyYWwsIG5wbHVyYWxzOyAiICsgcGx1cmFsX2Zvcm0gKyAiIHJldHVybiBwbHVyYWw7IgogICAgICApOwogICAgICAvL3JldHVybiBuZXcgRnVuY3Rpb24oJ24nLCd2YXIgcGx1cmFsLCBucGx1cmFsczsgJysgcGx1cmFsX2Zvcm0gKycgcmV0dXJuIHsgbnBsdXJhbHM6IG5wbHVyYWxzLCBwbHVyYWw6IChwbHVyYWwgPT09IHRydWUgPyAxIDogKHBsdXJhbCA/IHBsdXJhbCA6IDApKSB9OycpOwogICAgfSkobG9jUGx1cik7CgogICAgbG9jUGF0Y2hlcyA9IFtdOwogICAgZm9yICh2YXIgaSBpbiBsb2NTdHJpbmdzKSB7CiAgICAgIGlmIChpLnNwbGl0KCJ8IilbMF0gPT0gIlVwZGF0ZSBub3RlcyIpIHsKICAgICAgICB2YXIgcGF0Y2ggPSBpLnNwbGl0KCJ8Iik7CiAgICAgICAgdmFyIHBhdGNoVHJhbnNsYXRlZCA9IGxvY1N0cmluZ3NbaV0uc3BsaXQoInwiKTsKICAgICAgICBsb2NQYXRjaGVzLnB1c2goewogICAgICAgICAgaWQ6IHBhcnNlSW50KHBhdGNoWzFdKSwKICAgICAgICAgIHR5cGU6IDEsCiAgICAgICAgICB0aXRsZTogcGF0Y2hUcmFuc2xhdGVkWzJdLAogICAgICAgICAgcG9pbnRzOiBwYXRjaFRyYW5zbGF0ZWQuc2xpY2UoMyksCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICAgIHZhciBzb3J0TWFwID0gZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgaWYgKGEuaWQgPCBiLmlkKSByZXR1cm4gMTsKICAgICAgZWxzZSByZXR1cm4gLTE7CiAgICB9OwogICAgbG9jUGF0Y2hlcy5zb3J0KHNvcnRNYXApOwoKICAgIGZvciAodmFyIGkgaW4gbG9jU3RyaW5ncykgewogICAgICB2YXIgYml0ID0gaS5zcGxpdCgiXSIpOwogICAgICBpZiAoCiAgICAgICAgYml0WzFdICYmCiAgICAgICAgYml0WzBdLmluZGV4T2YoIltDT01NRU5UOiIpICE9IDAgJiYKICAgICAgICAhbG9jU3RyaW5nc0J5UGFydFtiaXRbMF0uc3Vic3RyaW5nKDEpXQogICAgICApCiAgICAgICAgbG9jU3RyaW5nc0J5UGFydFtiaXRbMF0uc3Vic3RyaW5nKDEpXSA9IGk7CiAgICB9CgogICAgY29uc29sZS5sb2coJ0xvYWRlZCBsYW5ndWFnZSAiJyArIGxvY05hbWUgKyAnIi4nKTsKICB9Cn07Cgp2YXIgTG9hZExhbmcgPSBMb2FkU2NyaXB0OwoKdmFyIExvY2FsaXplVXBncmFkZXNBbmRBY2hpZXZzID0gZnVuY3Rpb24gKCkgewogIGlmICghR2FtZS5VcGdyYWRlc0J5SWQpIHJldHVybiBmYWxzZTsKCiAgdmFyIGFsbFRoaW5ncyA9IFtdOwogIGZvciAodmFyIGkgaW4gR2FtZS5VcGdyYWRlc0J5SWQpIHsKICAgIGFsbFRoaW5ncy5wdXNoKEdhbWUuVXBncmFkZXNCeUlkW2ldKTsKICB9CiAgZm9yICh2YXIgaSBpbiBHYW1lLkFjaGlldmVtZW50c0J5SWQpIHsKICAgIGFsbFRoaW5ncy5wdXNoKEdhbWUuQWNoaWV2ZW1lbnRzQnlJZFtpXSk7CiAgfQogIGZvciAodmFyIGkgPSAwOyBpIDwgYWxsVGhpbmdzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgaXQgPSBhbGxUaGluZ3NbaV07CiAgICB2YXIgdHlwZSA9IGl0LmdldFR5cGUoKTsKICAgIHZhciBmb3VuZCA9IDA7CiAgICBmb3VuZCA9IEZpbmRMb2NTdHJpbmdCeVBhcnQodHlwZSArICIgbmFtZSAiICsgaXQuaWQpOwogICAgaWYgKGZvdW5kKSBpdC5kbmFtZSA9IGxvYyhmb3VuZCk7CgogICAgaWYgKCFFTikgaXQuYmFzZURlc2MgPSBpdC5iYXNlRGVzYy5yZXBsYWNlKC88cT4uKi8sICIiKTsgLy9zdHJpcCBxdW90ZSBzZWN0aW9uCiAgICBpdC5kZGVzYyA9IEJlYXV0aWZ5SW5UZXh0KGl0LmJhc2VEZXNjKTsKCiAgICBmb3VuZCA9IEZpbmRMb2NTdHJpbmdCeVBhcnQodHlwZSArICIgZGVzYyAiICsgaXQuaWQpOwogICAgaWYgKGZvdW5kKSBpdC5kZGVzYyA9IGxvYyhmb3VuZCk7CiAgICBmb3VuZCA9IEZpbmRMb2NTdHJpbmdCeVBhcnQodHlwZSArICIgcXVvdGUgIiArIGl0LmlkKTsKICAgIGlmIChmb3VuZCkgaXQuZGRlc2MgKz0gIjxxPiIgKyBsb2MoZm91bmQpICsgIjwvcT4iOwogIH0KICBCZWF1dGlmeUFsbCgpOwp9Owp2YXIgZ2V0VXBncmFkZU5hbWUgPSBmdW5jdGlvbiAobmFtZSkgewogIHZhciBpdCA9IEdhbWUuVXBncmFkZXNbbmFtZV07CiAgdmFyIGZvdW5kID0gRmluZExvY1N0cmluZ0J5UGFydCgiVXBncmFkZSBuYW1lICIgKyBpdC5pZCk7CiAgaWYgKGZvdW5kKSByZXR1cm4gbG9jKGZvdW5kKTsKICBlbHNlIHJldHVybiBuYW1lOwp9Owp2YXIgZ2V0QWNoaWV2ZW1lbnROYW1lID0gZnVuY3Rpb24gKG5hbWUpIHsKICB2YXIgaXQgPSBHYW1lLkFjaGlldmVtZW50c1tuYW1lXTsKICB2YXIgZm91bmQgPSBGaW5kTG9jU3RyaW5nQnlQYXJ0KCJBY2hpZXZlbWVudCBuYW1lICIgKyBpdC5pZCk7CiAgaWYgKGZvdW5kKSByZXR1cm4gbG9jKGZvdW5kKTsKICBlbHNlIHJldHVybiBuYW1lOwp9OwoKLy90aGVzZSBhcmUgZmF1bHR5LCBpbnZlc3RpZ2F0ZSBsYXRlcgovL2Z1bmN0aW9uIHV0ZjhfdG9fYjY0KHN0cil7cmV0dXJuIGJ0b2Eoc3RyKTt9Ci8vZnVuY3Rpb24gYjY0X3RvX3V0Zjgoc3RyKXtyZXR1cm4gYXRvYihzdHIpO30KCi8qZnVuY3Rpb24gdXRmOF90b19iNjQoIHN0ciApIHsKCXRyeXtyZXR1cm4gQmFzZTY0LmVuY29kZSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoIHN0ciApKSk7fQoJY2F0Y2goZXJyKQoJe3JldHVybiAnJzt9Cn0KCmZ1bmN0aW9uIGI2NF90b191dGY4KCBzdHIgKSB7Cgl0cnl7cmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChlc2NhcGUoQmFzZTY0LmRlY29kZSggc3RyICkpKTt9CgljYXRjaChlcnIpCgl7cmV0dXJuICcnO30KfSovCgovL3BoZXdpZSEgaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMzAxMDY0NzYvdXNpbmctamF2YXNjcmlwdHMtYXRvYi10by1kZWNvZGUtYmFzZTY0LWRvZXNudC1wcm9wZXJseS1kZWNvZGUtdXRmLTgtc3RyaW5ncwpmdW5jdGlvbiB1dGY4X3RvX2I2NChzdHIpIHsKICB0cnkgewogICAgcmV0dXJuIGJ0b2EoCiAgICAgIGVuY29kZVVSSUNvbXBvbmVudChzdHIpLnJlcGxhY2UoLyUoWzAtOUEtRl17Mn0pL2csIGZ1bmN0aW9uIChtYXRjaCwgcDEpIHsKICAgICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShwYXJzZUludChwMSwgMTYpKTsKICAgICAgfSkKICAgICk7CiAgfSBjYXRjaCAoZXJyKSB7CiAgICByZXR1cm4gIiI7CiAgfQp9CgpmdW5jdGlvbiBiNjRfdG9fdXRmOChzdHIpIHsKICB0cnkgewogICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudCgKICAgICAgQXJyYXkucHJvdG90eXBlLm1hcAogICAgICAgIC5jYWxsKGF0b2Ioc3RyKSwgZnVuY3Rpb24gKGMpIHsKICAgICAgICAgIHJldHVybiAiJSIgKyAoIjAwIiArIGMuY2hhckNvZGVBdCgwKS50b1N0cmluZygxNikpLnNsaWNlKC0yKTsKICAgICAgICB9KQogICAgICAgIC5qb2luKCIiKQogICAgKTsKICB9IGNhdGNoIChlcnIpIHsKICAgIHJldHVybiAiIjsKICB9Cn0KCmZ1bmN0aW9uIENvbXByZXNzQmluKGFycikgewogIC8vY29tcHJlc3MgYSBzZXF1ZW5jZSBsaWtlIFswLDEsMSwwLDEsMF0uLi4gaW50byBhIG51bWJlciBsaWtlIDU0LgogIHZhciBzdHIgPSAiIjsKICB2YXIgYXJyMiA9IGFyci5zbGljZSgwKTsKICBhcnIyLnVuc2hpZnQoMSk7CiAgYXJyMi5wdXNoKDEpOwogIGFycjIucmV2ZXJzZSgpOwogIGZvciAodmFyIGkgaW4gYXJyMikgewogICAgc3RyICs9IGFycjJbaV07CiAgfQogIHN0ciA9IHBhcnNlSW50KHN0ciwgMik7CiAgcmV0dXJuIHN0cjsKfQoKZnVuY3Rpb24gVW5jb21wcmVzc0JpbihudW0pIHsKICAvL3VuY29tcHJlc3MgYSBudW1iZXIgbGlrZSA1NCB0byBhIHNlcXVlbmNlIGxpa2UgWzAsMSwxLDAsMSwwXS4KICB2YXIgYXJyID0gbnVtLnRvU3RyaW5nKDIpOwogIGFyciA9IGFyci5zcGxpdCgiIik7CiAgYXJyLnJldmVyc2UoKTsKICBhcnIuc2hpZnQoKTsKICBhcnIucG9wKCk7CiAgcmV0dXJuIGFycjsKfQoKZnVuY3Rpb24gQ29tcHJlc3NMYXJnZUJpbihhcnIpIHsKICAvL3dlIGhhdmUgdG8gY29tcHJlc3MgaW4gc21hbGxlciBjaHVua3MgdG8gYXZvaWQgZ2V0dGluZyBpbnRvIHNjaWVudGlmaWMgbm90YXRpb24KICB2YXIgYXJyMiA9IGFyci5zbGljZSgwKTsKICB2YXIgdGhpc0JpdCA9IFtdOwogIHZhciBiaXRzID0gW107CiAgZm9yICh2YXIgaSBpbiBhcnIyKSB7CiAgICB0aGlzQml0LnB1c2goYXJyMltpXSk7CiAgICBpZiAodGhpc0JpdC5sZW5ndGggPj0gNTApIHsKICAgICAgYml0cy5wdXNoKENvbXByZXNzQmluKHRoaXNCaXQpKTsKICAgICAgdGhpc0JpdCA9IFtdOwogICAgfQogIH0KICBpZiAodGhpc0JpdC5sZW5ndGggPiAwKSBiaXRzLnB1c2goQ29tcHJlc3NCaW4odGhpc0JpdCkpOwogIGFycjIgPSBiaXRzLmpvaW4oIjsiKTsKICByZXR1cm4gYXJyMjsKfQoKZnVuY3Rpb24gVW5jb21wcmVzc0xhcmdlQmluKGFycikgewogIHZhciBhcnIyID0gYXJyLnNwbGl0KCI7Iik7CiAgdmFyIGJpdHMgPSBbXTsKICBmb3IgKHZhciBpIGluIGFycjIpIHsKICAgIGJpdHMucHVzaChVbmNvbXByZXNzQmluKHBhcnNlSW50KGFycjJbaV0pKSk7CiAgfQogIGFycjIgPSBbXTsKICBmb3IgKHZhciBpIGluIGJpdHMpIHsKICAgIGZvciAodmFyIGlpIGluIGJpdHNbaV0pIGFycjIucHVzaChiaXRzW2ldW2lpXSk7CiAgfQogIHJldHVybiBhcnIyOwp9CgpmdW5jdGlvbiBwYWNrKGJ5dGVzKSB7CiAgdmFyIGNoYXJzID0gW107CiAgdmFyIGxlbiA9IGJ5dGVzLmxlbmd0aDsKICBmb3IgKHZhciBpID0gMCwgbiA9IGxlbjsgaSA8IG47ICkgewogICAgY2hhcnMucHVzaCgoKGJ5dGVzW2krK10gJiAweGZmKSA8PCA4KSB8IChieXRlc1tpKytdICYgMHhmZikpOwogIH0KICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLCBjaGFycyk7Cn0KCmZ1bmN0aW9uIHVucGFjayhzdHIpIHsKICB2YXIgYnl0ZXMgPSBbXTsKICB2YXIgbGVuID0gc3RyLmxlbmd0aDsKICBmb3IgKHZhciBpID0gMCwgbiA9IGxlbjsgaSA8IG47IGkrKykgewogICAgdmFyIGNoYXIgPSBzdHIuY2hhckNvZGVBdChpKTsKICAgIGJ5dGVzLnB1c2goY2hhciA+Pj4gOCwgY2hhciAmIDB4ZmYpOwogIH0KICByZXR1cm4gYnl0ZXM7Cn0KCi8vbW9kaWZpZWQgZnJvbSBodHRwOi8vd3d3LnNtYXNoaW5nbWFnYXppbmUuY29tLzIwMTEvMTAvMTkvb3B0aW1pemluZy1sb25nLWxpc3RzLW9mLXllc25vLXZhbHVlcy13aXRoLWphdmFzY3JpcHQvCmZ1bmN0aW9uIHBhY2syKC8qIHN0cmluZyAqLyB2YWx1ZXMpIHsKICB2YXIgY2h1bmtzID0gdmFsdWVzLm1hdGNoKC8uezEsMTR9L2cpLAogICAgcGFja2VkID0gIiI7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaHVua3MubGVuZ3RoOyBpKyspIHsKICAgIHBhY2tlZCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKHBhcnNlSW50KCIxIiArIGNodW5rc1tpXSwgMikpOwogIH0KICByZXR1cm4gcGFja2VkOwp9CgpmdW5jdGlvbiB1bnBhY2syKC8qIHN0cmluZyAqLyBwYWNrZWQpIHsKICB2YXIgdmFsdWVzID0gIiI7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYWNrZWQubGVuZ3RoOyBpKyspIHsKICAgIHZhbHVlcyArPSBwYWNrZWQuY2hhckNvZGVBdChpKS50b1N0cmluZygyKS5zdWJzdHJpbmcoMSk7CiAgfQogIHJldHVybiB2YWx1ZXM7Cn0KCmZ1bmN0aW9uIHBhY2szKHZhbHVlcykgewogIC8vdG9vIG1hbnkgc2F2ZSBjb3JydXB0aW9ucywgZGFybiBpdCB0byBoZWNrCiAgcmV0dXJuIHZhbHVlczsKfQoKLy9maWxlIHNhdmUgZnVuY3Rpb24gZnJvbSBodHRwczovL2dpdGh1Yi5jb20vZWxpZ3JleS9GaWxlU2F2ZXIuanMKdmFyIHNhdmVBcyA9CiAgc2F2ZUFzIHx8CiAgKGZ1bmN0aW9uICh2aWV3KSB7CiAgICAidXNlIHN0cmljdCI7CiAgICBpZiAoCiAgICAgIHR5cGVvZiBuYXZpZ2F0b3IgIT09ICJ1bmRlZmluZWQiICYmCiAgICAgIC9NU0lFIFsxLTldXC4vLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkKICAgICkgewogICAgICByZXR1cm47CiAgICB9CiAgICB2YXIgZG9jID0gdmlldy5kb2N1bWVudCwKICAgICAgZ2V0X1VSTCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gdmlldy5VUkwgfHwgdmlldy53ZWJraXRVUkwgfHwgdmlldzsKICAgICAgfSwKICAgICAgc2F2ZV9saW5rID0gZG9jLmNyZWF0ZUVsZW1lbnROUygiaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIsICJhIiksCiAgICAgIGNhbl91c2Vfc2F2ZV9saW5rID0gImRvd25sb2FkIiBpbiBzYXZlX2xpbmssCiAgICAgIGNsaWNrID0gZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICB2YXIgZXZlbnQgPSBuZXcgTW91c2VFdmVudCgiY2xpY2siKTsKICAgICAgICBub2RlLmRpc3BhdGNoRXZlbnQoZXZlbnQpOwogICAgICB9LAogICAgICBpc19zYWZhcmkgPSAvVmVyc2lvblwvW1xkXC5dKy4qU2FmYXJpLy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpLAogICAgICB3ZWJraXRfcmVxX2ZzID0gdmlldy53ZWJraXRSZXF1ZXN0RmlsZVN5c3RlbSwKICAgICAgcmVxX2ZzID0KICAgICAgICB2aWV3LnJlcXVlc3RGaWxlU3lzdGVtIHx8IHdlYmtpdF9yZXFfZnMgfHwgdmlldy5tb3pSZXF1ZXN0RmlsZVN5c3RlbSwKICAgICAgdGhyb3dfb3V0c2lkZSA9IGZ1bmN0aW9uIChleCkgewogICAgICAgICh2aWV3LnNldEltbWVkaWF0ZSB8fCB2aWV3LnNldFRpbWVvdXQpKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHRocm93IGV4OwogICAgICAgIH0sIDApOwogICAgICB9LAogICAgICBmb3JjZV9zYXZlYWJsZV90eXBlID0gImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSIsCiAgICAgIGZzX21pbl9zaXplID0gMCwKICAgICAgYXJiaXRyYXJ5X3Jldm9rZV90aW1lb3V0ID0gNTAwLAogICAgICByZXZva2UgPSBmdW5jdGlvbiAoZmlsZSkgewogICAgICAgIHZhciByZXZva2VyID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKHR5cGVvZiBmaWxlID09PSAic3RyaW5nIikgewogICAgICAgICAgICBnZXRfVVJMKCkucmV2b2tlT2JqZWN0VVJMKGZpbGUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZmlsZS5yZW1vdmUoKTsKICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIGlmICh2aWV3LmNocm9tZSkgewogICAgICAgICAgcmV2b2tlcigpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzZXRUaW1lb3V0KHJldm9rZXIsIGFyYml0cmFyeV9yZXZva2VfdGltZW91dCk7CiAgICAgICAgfQogICAgICB9LAogICAgICBkaXNwYXRjaCA9IGZ1bmN0aW9uIChmaWxlc2F2ZXIsIGV2ZW50X3R5cGVzLCBldmVudCkgewogICAgICAgIGV2ZW50X3R5cGVzID0gW10uY29uY2F0KGV2ZW50X3R5cGVzKTsKICAgICAgICB2YXIgaSA9IGV2ZW50X3R5cGVzLmxlbmd0aDsKICAgICAgICB3aGlsZSAoaS0tKSB7CiAgICAgICAgICB2YXIgbGlzdGVuZXIgPSBmaWxlc2F2ZXJbIm9uIiArIGV2ZW50X3R5cGVzW2ldXTsKICAgICAgICAgIGlmICh0eXBlb2YgbGlzdGVuZXIgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBsaXN0ZW5lci5jYWxsKGZpbGVzYXZlciwgZXZlbnQgfHwgZmlsZXNhdmVyKTsKICAgICAgICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICAgICAgICB0aHJvd19vdXRzaWRlKGV4KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgYXV0b19ib20gPSBmdW5jdGlvbiAoYmxvYikgewogICAgICAgIGlmICgKICAgICAgICAgIC9eXHMqKD86dGV4dFwvXFMqfGFwcGxpY2F0aW9uXC94bWx8XFMqXC9cUypcK3htbClccyo7LipjaGFyc2V0XHMqPVxzKnV0Zi04L2kudGVzdCgKICAgICAgICAgICAgYmxvYi50eXBlCiAgICAgICAgICApCiAgICAgICAgKSB7CiAgICAgICAgICByZXR1cm4gbmV3IEJsb2IoWyJcdWZlZmYiLCBibG9iXSwgeyB0eXBlOiBibG9iLnR5cGUgfSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBibG9iOwogICAgICB9LAogICAgICBGaWxlU2F2ZXIgPSBmdW5jdGlvbiAoYmxvYiwgbmFtZSwgbm9fYXV0b19ib20pIHsKICAgICAgICBpZiAoIW5vX2F1dG9fYm9tKSB7CiAgICAgICAgICBibG9iID0gYXV0b19ib20oYmxvYik7CiAgICAgICAgfQogICAgICAgIHZhciBmaWxlc2F2ZXIgPSB0aGlzLAogICAgICAgICAgdHlwZSA9IGJsb2IudHlwZSwKICAgICAgICAgIGJsb2JfY2hhbmdlZCA9IGZhbHNlLAogICAgICAgICAgb2JqZWN0X3VybCwKICAgICAgICAgIHRhcmdldF92aWV3LAogICAgICAgICAgZGlzcGF0Y2hfYWxsID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBkaXNwYXRjaCgKICAgICAgICAgICAgICBmaWxlc2F2ZXIsCiAgICAgICAgICAgICAgIndyaXRlc3RhcnQgcHJvZ3Jlc3Mgd3JpdGUgd3JpdGVlbmQiLnNwbGl0KCIgIikKICAgICAgICAgICAgKTsKICAgICAgICAgIH0sCiAgICAgICAgICBmc19lcnJvciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgaWYgKHRhcmdldF92aWV3ICYmIGlzX3NhZmFyaSAmJiB0eXBlb2YgRmlsZVJlYWRlciAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKICAgICAgICAgICAgICByZWFkZXIub25sb2FkZW5kID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgdmFyIGJhc2U2NERhdGEgPSByZWFkZXIucmVzdWx0OwogICAgICAgICAgICAgICAgdGFyZ2V0X3ZpZXcubG9jYXRpb24uaHJlZiA9CiAgICAgICAgICAgICAgICAgICJkYXRhOmF0dGFjaG1lbnQvZmlsZSIgKwogICAgICAgICAgICAgICAgICBiYXNlNjREYXRhLnNsaWNlKGJhc2U2NERhdGEuc2VhcmNoKC9bLDtdLykpOwogICAgICAgICAgICAgICAgZmlsZXNhdmVyLnJlYWR5U3RhdGUgPSBmaWxlc2F2ZXIuRE9ORTsKICAgICAgICAgICAgICAgIGRpc3BhdGNoX2FsbCgpOwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoYmxvYik7CiAgICAgICAgICAgICAgZmlsZXNhdmVyLnJlYWR5U3RhdGUgPSBmaWxlc2F2ZXIuSU5JVDsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGJsb2JfY2hhbmdlZCB8fCAhb2JqZWN0X3VybCkgewogICAgICAgICAgICAgIG9iamVjdF91cmwgPSBnZXRfVVJMKCkuY3JlYXRlT2JqZWN0VVJMKGJsb2IpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh0YXJnZXRfdmlldykgewogICAgICAgICAgICAgIHRhcmdldF92aWV3LmxvY2F0aW9uLmhyZWYgPSBvYmplY3RfdXJsOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHZhciBuZXdfdGFiID0gdmlldy5vcGVuKG9iamVjdF91cmwsICJfYmxhbmsiKTsKICAgICAgICAgICAgICBpZiAobmV3X3RhYiA9PSB1bmRlZmluZWQgJiYgaXNfc2FmYXJpKSB7CiAgICAgICAgICAgICAgICB2aWV3LmxvY2F0aW9uLmhyZWYgPSBvYmplY3RfdXJsOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmaWxlc2F2ZXIucmVhZHlTdGF0ZSA9IGZpbGVzYXZlci5ET05FOwogICAgICAgICAgICBkaXNwYXRjaF9hbGwoKTsKICAgICAgICAgICAgcmV2b2tlKG9iamVjdF91cmwpOwogICAgICAgICAgfSwKICAgICAgICAgIGFib3J0YWJsZSA9IGZ1bmN0aW9uIChmdW5jKSB7CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgaWYgKGZpbGVzYXZlci5yZWFkeVN0YXRlICE9PSBmaWxlc2F2ZXIuRE9ORSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgICB9LAogICAgICAgICAgY3JlYXRlX2lmX25vdF9mb3VuZCA9IHsgY3JlYXRlOiB0cnVlLCBleGNsdXNpdmU6IGZhbHNlIH0sCiAgICAgICAgICBzbGljZTsKICAgICAgICBmaWxlc2F2ZXIucmVhZHlTdGF0ZSA9IGZpbGVzYXZlci5JTklUOwogICAgICAgIGlmICghbmFtZSkgewogICAgICAgICAgbmFtZSA9ICJkb3dubG9hZCI7CiAgICAgICAgfQogICAgICAgIGlmIChjYW5fdXNlX3NhdmVfbGluaykgewogICAgICAgICAgb2JqZWN0X3VybCA9IGdldF9VUkwoKS5jcmVhdGVPYmplY3RVUkwoYmxvYik7CiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgc2F2ZV9saW5rLmhyZWYgPSBvYmplY3RfdXJsOwogICAgICAgICAgICBzYXZlX2xpbmsuZG93bmxvYWQgPSBuYW1lOwogICAgICAgICAgICBjbGljayhzYXZlX2xpbmspOwogICAgICAgICAgICBkaXNwYXRjaF9hbGwoKTsKICAgICAgICAgICAgcmV2b2tlKG9iamVjdF91cmwpOwogICAgICAgICAgICBmaWxlc2F2ZXIucmVhZHlTdGF0ZSA9IGZpbGVzYXZlci5ET05FOwogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmICh2aWV3LmNocm9tZSAmJiB0eXBlICYmIHR5cGUgIT09IGZvcmNlX3NhdmVhYmxlX3R5cGUpIHsKICAgICAgICAgIHNsaWNlID0gYmxvYi5zbGljZSB8fCBibG9iLndlYmtpdFNsaWNlOwogICAgICAgICAgYmxvYiA9IHNsaWNlLmNhbGwoYmxvYiwgMCwgYmxvYi5zaXplLCBmb3JjZV9zYXZlYWJsZV90eXBlKTsKICAgICAgICAgIGJsb2JfY2hhbmdlZCA9IHRydWU7CiAgICAgICAgfQogICAgICAgIGlmICh3ZWJraXRfcmVxX2ZzICYmIG5hbWUgIT09ICJkb3dubG9hZCIpIHsKICAgICAgICAgIG5hbWUgKz0gIi5kb3dubG9hZCI7CiAgICAgICAgfQogICAgICAgIGlmICh0eXBlID09PSBmb3JjZV9zYXZlYWJsZV90eXBlIHx8IHdlYmtpdF9yZXFfZnMpIHsKICAgICAgICAgIHRhcmdldF92aWV3ID0gdmlldzsKICAgICAgICB9CiAgICAgICAgaWYgKCFyZXFfZnMpIHsKICAgICAgICAgIGZzX2Vycm9yKCk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGZzX21pbl9zaXplICs9IGJsb2Iuc2l6ZTsKICAgICAgICByZXFfZnMoCiAgICAgICAgICB2aWV3LlRFTVBPUkFSWSwKICAgICAgICAgIGZzX21pbl9zaXplLAogICAgICAgICAgYWJvcnRhYmxlKGZ1bmN0aW9uIChmcykgewogICAgICAgICAgICBmcy5yb290LmdldERpcmVjdG9yeSgKICAgICAgICAgICAgICAic2F2ZWQiLAogICAgICAgICAgICAgIGNyZWF0ZV9pZl9ub3RfZm91bmQsCiAgICAgICAgICAgICAgYWJvcnRhYmxlKGZ1bmN0aW9uIChkaXIpIHsKICAgICAgICAgICAgICAgIHZhciBzYXZlID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICBkaXIuZ2V0RmlsZSgKICAgICAgICAgICAgICAgICAgICBuYW1lLAogICAgICAgICAgICAgICAgICAgIGNyZWF0ZV9pZl9ub3RfZm91bmQsCiAgICAgICAgICAgICAgICAgICAgYWJvcnRhYmxlKGZ1bmN0aW9uIChmaWxlKSB7CiAgICAgICAgICAgICAgICAgICAgICBmaWxlLmNyZWF0ZVdyaXRlcigKICAgICAgICAgICAgICAgICAgICAgICAgYWJvcnRhYmxlKGZ1bmN0aW9uICh3cml0ZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICB3cml0ZXIub253cml0ZWVuZCA9IGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0X3ZpZXcubG9jYXRpb24uaHJlZiA9IGZpbGUudG9VUkwoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVzYXZlci5yZWFkeVN0YXRlID0gZmlsZXNhdmVyLkRPTkU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaChmaWxlc2F2ZXIsICJ3cml0ZWVuZCIsIGV2ZW50KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldm9rZShmaWxlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlci5vbmVycm9yID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVycm9yID0gd3JpdGVyLmVycm9yOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVycm9yLmNvZGUgIT09IGVycm9yLkFCT1JUX0VSUikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmc19lcnJvcigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgICAgIndyaXRlc3RhcnQgcHJvZ3Jlc3Mgd3JpdGUgYWJvcnQiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3BsaXQoIiAiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvckVhY2goZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlclsib24iICsgZXZlbnRdID0gZmlsZXNhdmVyWyJvbiIgKyBldmVudF07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICB3cml0ZXIud3JpdGUoYmxvYik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZXNhdmVyLmFib3J0ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVyLmFib3J0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlc2F2ZXIucmVhZHlTdGF0ZSA9IGZpbGVzYXZlci5ET05FOwogICAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZXNhdmVyLnJlYWR5U3RhdGUgPSBmaWxlc2F2ZXIuV1JJVElORzsKICAgICAgICAgICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICAgICAgICAgIGZzX2Vycm9yCiAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgICAgIGZzX2Vycm9yCiAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgZGlyLmdldEZpbGUoCiAgICAgICAgICAgICAgICAgIG5hbWUsCiAgICAgICAgICAgICAgICAgIHsgY3JlYXRlOiBmYWxzZSB9LAogICAgICAgICAgICAgICAgICBhYm9ydGFibGUoZnVuY3Rpb24gKGZpbGUpIHsKICAgICAgICAgICAgICAgICAgICBmaWxlLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgICAgIHNhdmUoKTsKICAgICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICAgIGFib3J0YWJsZShmdW5jdGlvbiAoZXgpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoZXguY29kZSA9PT0gZXguTk9UX0ZPVU5EX0VSUikgewogICAgICAgICAgICAgICAgICAgICAgc2F2ZSgpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICBmc19lcnJvcigpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgZnNfZXJyb3IKICAgICAgICAgICAgKTsKICAgICAgICAgIH0pLAogICAgICAgICAgZnNfZXJyb3IKICAgICAgICApOwogICAgICB9LAogICAgICBGU19wcm90byA9IEZpbGVTYXZlci5wcm90b3R5cGUsCiAgICAgIHNhdmVBcyA9IGZ1bmN0aW9uIChibG9iLCBuYW1lLCBub19hdXRvX2JvbSkgewogICAgICAgIHJldHVybiBuZXcgRmlsZVNhdmVyKGJsb2IsIG5hbWUsIG5vX2F1dG9fYm9tKTsKICAgICAgfTsKICAgIGlmICh0eXBlb2YgbmF2aWdhdG9yICE9PSAidW5kZWZpbmVkIiAmJiBuYXZpZ2F0b3IubXNTYXZlT3JPcGVuQmxvYikgewogICAgICByZXR1cm4gZnVuY3Rpb24gKGJsb2IsIG5hbWUsIG5vX2F1dG9fYm9tKSB7CiAgICAgICAgaWYgKCFub19hdXRvX2JvbSkgewogICAgICAgICAgYmxvYiA9IGF1dG9fYm9tKGJsb2IpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbmF2aWdhdG9yLm1zU2F2ZU9yT3BlbkJsb2IoYmxvYiwgbmFtZSB8fCAiZG93bmxvYWQiKTsKICAgICAgfTsKICAgIH0KICAgIEZTX3Byb3RvLmFib3J0ID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgZmlsZXNhdmVyID0gdGhpczsKICAgICAgZmlsZXNhdmVyLnJlYWR5U3RhdGUgPSBmaWxlc2F2ZXIuRE9ORTsKICAgICAgZGlzcGF0Y2goZmlsZXNhdmVyLCAiYWJvcnQiKTsKICAgIH07CiAgICBGU19wcm90by5yZWFkeVN0YXRlID0gRlNfcHJvdG8uSU5JVCA9IDA7CiAgICBGU19wcm90by5XUklUSU5HID0gMTsKICAgIEZTX3Byb3RvLkRPTkUgPSAyOwogICAgRlNfcHJvdG8uZXJyb3IgPQogICAgICBGU19wcm90by5vbndyaXRlc3RhcnQgPQogICAgICBGU19wcm90by5vbnByb2dyZXNzID0KICAgICAgRlNfcHJvdG8ub253cml0ZSA9CiAgICAgIEZTX3Byb3RvLm9uYWJvcnQgPQogICAgICBGU19wcm90by5vbmVycm9yID0KICAgICAgRlNfcHJvdG8ub253cml0ZWVuZCA9CiAgICAgICAgbnVsbDsKICAgIHJldHVybiBzYXZlQXM7CiAgfSkoCiAgICAodHlwZW9mIHNlbGYgIT09ICJ1bmRlZmluZWQiICYmIHNlbGYpIHx8CiAgICAgICh0eXBlb2Ygd2luZG93ICE9PSAidW5kZWZpbmVkIiAmJiB3aW5kb3cpIHx8CiAgICAgIHRoaXMuY29udGVudAogICk7CmlmICh0eXBlb2YgbW9kdWxlICE9PSAidW5kZWZpbmVkIiAmJiBtb2R1bGUuZXhwb3J0cykgewogIG1vZHVsZS5leHBvcnRzLnNhdmVBcyA9IHNhdmVBczsKfSBlbHNlIGlmICgKICB0eXBlb2YgZGVmaW5lICE9PSAidW5kZWZpbmVkIiAmJgogIGRlZmluZSAhPT0gbnVsbCAmJgogIGRlZmluZS5hbWQgIT0gbnVsbAopIHsKICBkZWZpbmUoW10sIGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiBzYXZlQXM7CiAgfSk7Cn0KCi8vc2VlZGVkIHJhbmRvbSBmdW5jdGlvbiwgY291cnRlc3kgb2YgaHR0cDovL2RhdmlkYmF1LmNvbS9hcmNoaXZlcy8yMDEwLzAxLzMwL3JhbmRvbV9zZWVkc19jb2RlZF9oaW50c19hbmRfcXVpbnRpbGxpb25zLmh0bWwKKGZ1bmN0aW9uIChhLCBiLCBjLCBkLCBlLCBmKSB7CiAgZnVuY3Rpb24gayhhKSB7CiAgICB2YXIgYiwKICAgICAgYyA9IGEubGVuZ3RoLAogICAgICBlID0gdGhpcywKICAgICAgZiA9IDAsCiAgICAgIGcgPSAoZS5pID0gZS5qID0gMCksCiAgICAgIGggPSAoZS5TID0gW10pOwogICAgZm9yIChjIHx8IChhID0gW2MrK10pOyBkID4gZjsgKSBoW2ZdID0gZisrOwogICAgZm9yIChmID0gMDsgZCA+IGY7IGYrKykKICAgICAgKGhbZl0gPSBoWyhnID0gaiAmIChnICsgYVtmICUgY10gKyAoYiA9IGhbZl0pKSldKSwgKGhbZ10gPSBiKTsKICAgIChlLmcgPSBmdW5jdGlvbiAoYSkgewogICAgICBmb3IgKHZhciBiLCBjID0gMCwgZiA9IGUuaSwgZyA9IGUuaiwgaCA9IGUuUzsgYS0tOyApCiAgICAgICAgKGIgPSBoWyhmID0gaiAmIChmICsgMSkpXSksCiAgICAgICAgICAoYyA9IGMgKiBkICsgaFtqICYgKChoW2ZdID0gaFsoZyA9IGogJiAoZyArIGIpKV0pICsgKGhbZ10gPSBiKSldKTsKICAgICAgcmV0dXJuIChlLmkgPSBmKSwgKGUuaiA9IGcpLCBjOwogICAgfSkoZCk7CiAgfQogIGZ1bmN0aW9uIGwoYSwgYikgewogICAgdmFyIGUsCiAgICAgIGMgPSBbXSwKICAgICAgZCA9ICh0eXBlb2YgYSlbMF07CiAgICBpZiAoYiAmJiAibyIgPT0gZCkKICAgICAgZm9yIChlIGluIGEpCiAgICAgICAgdHJ5IHsKICAgICAgICAgIGMucHVzaChsKGFbZV0sIGIgLSAxKSk7CiAgICAgICAgfSBjYXRjaCAoZikge30KICAgIHJldHVybiBjLmxlbmd0aCA/IGMgOiAicyIgPT0gZCA/IGEgOiBhICsgIlwwIjsKICB9CiAgZnVuY3Rpb24gbShhLCBiKSB7CiAgICBmb3IgKHZhciBkLCBjID0gYSArICIiLCBlID0gMDsgYy5sZW5ndGggPiBlOyApCiAgICAgIGJbaiAmIGVdID0gaiAmICgoZCBePSAxOSAqIGJbaiAmIGVdKSArIGMuY2hhckNvZGVBdChlKyspKTsKICAgIHJldHVybiBvKGIpOwogIH0KICBmdW5jdGlvbiBuKGMpIHsKICAgIHRyeSB7CiAgICAgIHJldHVybiBhLmNyeXB0by5nZXRSYW5kb21WYWx1ZXMoKGMgPSBuZXcgVWludDhBcnJheShkKSkpLCBvKGMpOwogICAgfSBjYXRjaCAoZSkgewogICAgICByZXR1cm4gWytuZXcgRGF0ZSgpLCBhLCBhLm5hdmlnYXRvci5wbHVnaW5zLCBhLnNjcmVlbiwgbyhiKV07CiAgICB9CiAgfQogIGZ1bmN0aW9uIG8oYSkgewogICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkoMCwgYSk7CiAgfQogIHZhciBnID0gYy5wb3coZCwgZSksCiAgICBoID0gYy5wb3coMiwgZiksCiAgICBpID0gMiAqIGgsCiAgICBqID0gZCAtIDE7CiAgKGMuc2VlZHJhbmRvbSA9IGZ1bmN0aW9uIChhLCBmKSB7CiAgICB2YXIgaiA9IFtdLAogICAgICBwID0gbShsKGYgPyBbYSwgbyhiKV0gOiAwIGluIGFyZ3VtZW50cyA/IGEgOiBuKCksIDMpLCBqKSwKICAgICAgcSA9IG5ldyBrKGopOwogICAgcmV0dXJuICgKICAgICAgbShvKHEuUyksIGIpLAogICAgICAoYy5yYW5kb20gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgZm9yICh2YXIgYSA9IHEuZyhlKSwgYiA9IGcsIGMgPSAwOyBoID4gYTsgKQogICAgICAgICAgKGEgPSAoYSArIGMpICogZCksIChiICo9IGQpLCAoYyA9IHEuZygxKSk7CiAgICAgICAgZm9yICg7IGEgPj0gaTsgKSAoYSAvPSAyKSwgKGIgLz0gMiksIChjID4+Pj0gMSk7CiAgICAgICAgcmV0dXJuIChhICsgYykgLyBiOwogICAgICB9KSwKICAgICAgcAogICAgKTsKICB9KSwKICAgIG0oYy5yYW5kb20oKSwgYik7Cn0pKHRoaXMsIFtdLCBNYXRoLCAyNTYsIDYsIDUyKTsKCmZ1bmN0aW9uIGJpbmQoc2NvcGUsIGZuKSB7CiAgLy91c2UgOiBiaW5kKHRoaXMsZnVuY3Rpb24oKXt0aGlzLngrKzt9KSAtIHJldHVybnMgYSBmdW5jdGlvbiB3aGVyZSAidGhpcyIgcmVmZXJzIHRvIHRoZSBzY29wZWQgdGhpcwogIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICBmbi5hcHBseShzY29wZSwgYXJndW1lbnRzKTsKICB9Owp9Cgp2YXIgZ3JhYlByb3BzID0gZnVuY3Rpb24gKGFyciwgcHJvcCkgewogIGlmICghYXJyKSByZXR1cm4gW107CiAgYXJyMiA9IFtdOwogIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7CiAgICBhcnIyLnB1c2goYXJyW2ldW3Byb3BdKTsKICB9CiAgcmV0dXJuIGFycjI7Cn07CgpDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQucHJvdG90eXBlLmZpbGxQYXR0ZXJuID0gZnVuY3Rpb24gKAogIGltZywKICBYLAogIFksCiAgVywKICBILAogIGlXLAogIGlILAogIG9mZlgsCiAgb2ZmWQopIHsKICAvL2ZvciB3aGVuIGJ1aWx0LWluIHBhdHRlcm5zIGFyZW4ndCBlbm91Z2gKICBpZiAoaW1nLmFsdCAhPSAiYmxhbmsiKSB7CiAgICB2YXIgb2ZmWCA9IG9mZlggfHwgMDsKICAgIHZhciBvZmZZID0gb2ZmWSB8fCAwOwogICAgaWYgKG9mZlggPCAwKSB7CiAgICAgIG9mZlggPSBvZmZYIC0gTWF0aC5mbG9vcihvZmZYIC8gaVcpICogaVc7CiAgICB9CiAgICBpZiAob2ZmWCA+IDApIHsKICAgICAgb2ZmWCA9IChvZmZYICUgaVcpIC0gaVc7CiAgICB9CiAgICBpZiAob2ZmWSA8IDApIHsKICAgICAgb2ZmWSA9IG9mZlkgLSBNYXRoLmZsb29yKG9mZlkgLyBpSCkgKiBpSDsKICAgIH0KICAgIGlmIChvZmZZID4gMCkgewogICAgICBvZmZZID0gKG9mZlkgJSBpSCkgLSBpSDsKICAgIH0KICAgIGZvciAodmFyIHkgPSBvZmZZOyB5IDwgSDsgeSArPSBpSCkgewogICAgICBmb3IgKHZhciB4ID0gb2ZmWDsgeCA8IFc7IHggKz0gaVcpIHsKICAgICAgICB0aGlzLmRyYXdJbWFnZShpbWcsIFggKyB4LCBZICsgeSwgaVcsIGlIKTsKICAgICAgfQogICAgfQogIH0KfTsKCnZhciBPbGRDYW52YXNEcmF3SW1hZ2UgPSBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQucHJvdG90eXBlLmRyYXdJbWFnZTsKQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELnByb3RvdHlwZS5kcmF3SW1hZ2UgPSBmdW5jdGlvbiAoKSB7CiAgLy9vbmx5IGRyYXcgdGhlIGltYWdlIGlmIGl0J3MgbG9hZGVkCiAgaWYgKGFyZ3VtZW50c1swXS5hbHQgIT0gImJsYW5rIikgT2xkQ2FudmFzRHJhd0ltYWdlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn07CgppZiAoIWRvY3VtZW50Lmhhc0ZvY3VzKQogIGRvY3VtZW50Lmhhc0ZvY3VzID0gZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIGRvY3VtZW50LmhpZGRlbjsKICB9OyAvL2ZvciBPcGVyYQoKZnVuY3Rpb24gQWRkRXZlbnQoZWwsIGV2LCBmdW5jKSB7CiAgLy9pZS4gbXlMaXN0ZW5lcj1BZGRFdmVudChsKCdlbGVtZW50JyksJ2NsaWNrJyxmdW5jdGlvbigpe2NvbnNvbGUubG9nKCdoaSEnKTt9KTsKICBpZiAoZWwuYWRkRXZlbnRMaXN0ZW5lcikgewogICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihldiwgZnVuYywgZmFsc2UpOwogICAgcmV0dXJuIFtlbCwgZXYsIGZ1bmNdOwogIH0gZWxzZSBpZiAoZWwuYXR0YWNoRXZlbnQpIHsKICAgIHZhciBmdW5jMiA9IGZ1bmN0aW9uICgpIHsKICAgICAgZnVuYy5jYWxsKGVsKTsKICAgIH07CiAgICBlbC5hdHRhY2hFdmVudCgib24iICsgZXYsIGZ1bmMyKTsKICAgIHJldHVybiBbZWwsIGV2LCBmdW5jMl07CiAgfQogIHJldHVybiBmYWxzZTsKfQpmdW5jdGlvbiBSZW1vdmVFdmVudChldk9iaikgewogIC8vaWUuIFJlbW92ZUV2ZW50KG15TGlzdGVuZXIpOwogIGlmICghZXZPYmopIHJldHVybiBmYWxzZTsKICBpZiAoZXZPYmpbMF0ucmVtb3ZlRXZlbnRMaXN0ZW5lcikKICAgIGV2T2JqWzBdLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZPYmpbMV0sIGV2T2JqWzJdLCBmYWxzZSk7CiAgZWxzZSBpZiAoZXZPYmpbMF0uZGV0YWNoRXZlbnQpCiAgICBldk9ialswXS5kZXRhY2hFdmVudCgib24iICsgZXZPYmpbMV0sIGV2T2JqWzJdKTsKICByZXR1cm4gdHJ1ZTsKfQoKZnVuY3Rpb24gRmlyZUV2ZW50KGVsLCBldikgewogIGlmIChlbC5maXJlRXZlbnQpIHsKICAgIGVsLmZpcmVFdmVudCgib24iICsgZXYpOwogIH0gZWxzZSB7CiAgICB2YXIgZXZPYmogPSBkb2N1bWVudC5jcmVhdGVFdmVudCgiRXZlbnRzIik7CiAgICBldk9iai5pbml0RXZlbnQoZXYsIHRydWUsIGZhbHNlKTsKICAgIGVsLmRpc3BhdGNoRXZlbnQoZXZPYmopOwogIH0KfQoKZnVuY3Rpb24gd3JpdGVJY29uKGljb24pIHsKICAvL3JldHVybnMgQ1NTIGZvciBhbiBpY29uJ3MgYmFja2dyb3VuZCBpbWFnZQogIC8vZm9yIHVzZSBpbiBDU1Mgc3RyaW5ncwogIHJldHVybiAoCiAgICAoaWNvblsyXQogICAgICA/ICJiYWNrZ3JvdW5kLWltYWdlOnVybCgnIiArIGljb25bMl0ucmVwbGFjZSgvJy9nLCAiXFwnIikgKyAiJyk7IgogICAgICA6ICIiKSArCiAgICAiYmFja2dyb3VuZC1wb3NpdGlvbjoiICsKICAgIC1pY29uWzBdICogNDggKwogICAgInB4ICIgKwogICAgLWljb25bMV0gKiA0OCArCiAgICAicHg7IgogICk7Cn0KZnVuY3Rpb24gdGlueUljb24oaWNvbiwgY3NzKSB7CiAgLy9yZXR1cm5zIEhUTUwgZGlzcGxheWluZyBhbiBpY29uLCB3aXRoIG9wdGlvbmFsIGV4dHJhIENTUwogIHJldHVybiAoCiAgICAnPGRpdiBjbGFzcz0iaWNvbiB0aW55SWNvbiIgc3R5bGU9InZlcnRpY2FsLWFsaWduOm1pZGRsZTtkaXNwbGF5OmlubGluZS1ibG9jazsnICsKICAgIHdyaXRlSWNvbihpY29uKSArCiAgICAidHJhbnNmb3JtOnNjYWxlKDAuNSk7bWFyZ2luOi0xNnB4OyIgKwogICAgKGNzcyA/IGNzcyA6ICIiKSArCiAgICAnIj48L2Rpdj4nCiAgKTsKfQoKdmFyIExvYWRlciA9IGZ1bmN0aW9uICgpIC8vYXNzZXQtbG9hZGluZyBzeXN0ZW0KewogIHRoaXMubG9hZGluZ04gPSAwOwogIHRoaXMuYXNzZXRzTiA9IDA7CiAgdGhpcy5hc3NldHMgPSBbXTsKICB0aGlzLmFzc2V0c0xvYWRpbmcgPSBbXTsKICB0aGlzLmFzc2V0c0xvYWRlZCA9IFtdOwogIHRoaXMuZG9tYWluID0gIiI7CiAgdGhpcy5sb2FkZWQgPSAwOyAvL2NhbGxiYWNrCiAgdGhpcy5kb25lTG9hZGluZyA9IDA7CgogIHRoaXMuYmxhbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJjYW52YXMiKTsKICB0aGlzLmJsYW5rLndpZHRoID0gODsKICB0aGlzLmJsYW5rLmhlaWdodCA9IDg7CiAgdGhpcy5ibGFuay5hbHQgPSAiYmxhbmsiOwoKICB0aGlzLkxvYWQgPSBmdW5jdGlvbiAoYXNzZXRzKSB7CiAgICBmb3IgKHZhciBpIGluIGFzc2V0cykgewogICAgICB0aGlzLmxvYWRpbmdOKys7CiAgICAgIHRoaXMuYXNzZXRzTisrOwogICAgICBpZiAoIXRoaXMuYXNzZXRzTG9hZGluZ1thc3NldHNbaV1dICYmICF0aGlzLmFzc2V0c0xvYWRlZFthc3NldHNbaV1dKSB7CiAgICAgICAgdmFyIGltZyA9IG5ldyBJbWFnZSgpOwogICAgICAgIGlmIChhc3NldHNbaV0uaW5kZXhPZigiLyIpICE9IC0xKSBpbWcuc3JjID0gYXNzZXRzW2ldOwogICAgICAgIGVsc2UgaW1nLnNyYyA9IHRoaXMuZG9tYWluICsgYXNzZXRzW2ldOwogICAgICAgIGltZy5hbHQgPSBhc3NldHNbaV07CiAgICAgICAgaW1nLm9ubG9hZCA9IGJpbmQodGhpcywgdGhpcy5vbkxvYWQpOwogICAgICAgIHRoaXMuYXNzZXRzW2Fzc2V0c1tpXV0gPSBpbWc7CiAgICAgICAgdGhpcy5hc3NldHNMb2FkaW5nLnB1c2goYXNzZXRzW2ldKTsKICAgICAgfQogICAgfQogIH07CiAgdGhpcy5SZXBsYWNlID0gZnVuY3Rpb24gKG9sZCwgbmV3ZXIpIHsKICAgIGlmICghdGhpcy5hc3NldHNbb2xkXSkgdGhpcy5Mb2FkKFtvbGRdKTsKICAgIHZhciBpbWcgPSBuZXcgSW1hZ2UoKTsKICAgIGlmIChuZXdlci5pbmRleE9mKCIvIikgIT0gLTEpCiAgICAgIC8qbmV3ZXIuaW5kZXhPZignaHR0cCcpIT0tMSB8fCBuZXdlci5pbmRleE9mKCdodHRwcycpIT0tMSkqLyBpbWcuc3JjID0KICAgICAgICBuZXdlcjsKICAgIGVsc2UgaW1nLnNyYyA9IHRoaXMuZG9tYWluICsgbmV3ZXI7CiAgICBpbWcuYWx0ID0gbmV3ZXI7CiAgICBpbWcub25sb2FkID0gYmluZCh0aGlzLCB0aGlzLm9uTG9hZCk7CiAgICB0aGlzLmFzc2V0c1tvbGRdID0gaW1nOwogIH07CiAgdGhpcy5vbkxvYWRSZXBsYWNlID0gZnVuY3Rpb24gKCkge307CiAgdGhpcy5vbkxvYWQgPSBmdW5jdGlvbiAoZSkgewogICAgdGhpcy5hc3NldHNMb2FkZWQucHVzaChlLnRhcmdldC5hbHQpOwogICAgdGhpcy5hc3NldHNMb2FkaW5nLnNwbGljZSh0aGlzLmFzc2V0c0xvYWRpbmcuaW5kZXhPZihlLnRhcmdldC5hbHQpLCAxKTsKICAgIHRoaXMubG9hZGluZ04tLTsKICAgIGlmICh0aGlzLmRvbmVMb2FkaW5nID09IDAgJiYgdGhpcy5sb2FkaW5nTiA8PSAwICYmIHRoaXMubG9hZGVkICE9IDApIHsKICAgICAgdGhpcy5kb25lTG9hZGluZyA9IDE7CiAgICAgIHRoaXMubG9hZGVkKCk7CiAgICB9CiAgfTsKICB0aGlzLmdldFByb2dyZXNzID0gZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIDEgLSB0aGlzLmxvYWRpbmdOIC8gdGhpcy5hc3NldHNOOwogIH07Cn07Cgp2YXIgUGljID0gZnVuY3Rpb24gKHdoYXQpIHsKICBpZiAoR2FtZS5Mb2FkZXIuYXNzZXRzTG9hZGVkLmluZGV4T2Yod2hhdCkgIT0gLTEpCiAgICByZXR1cm4gR2FtZS5Mb2FkZXIuYXNzZXRzW3doYXRdOwogIGVsc2UgaWYgKEdhbWUuTG9hZGVyLmFzc2V0c0xvYWRpbmcuaW5kZXhPZih3aGF0KSA9PSAtMSkKICAgIEdhbWUuTG9hZGVyLkxvYWQoW3doYXRdKTsKICByZXR1cm4gR2FtZS5Mb2FkZXIuYmxhbms7Cn07Cgp2YXIgU291bmRzID0gW107CnZhciBPbGRQbGF5U291bmQgPSBmdW5jdGlvbiAodXJsLCB2b2wpIHsKICB2YXIgdm9sdW1lID0gMTsKICBpZiAodm9sICE9PSB1bmRlZmluZWQpIHZvbHVtZSA9IHZvbDsKICBpZiAoIUdhbWUudm9sdW1lIHx8IHZvbHVtZSA9PSAwKSByZXR1cm4gMDsKICBpZiAoIVNvdW5kc1t1cmxdKSB7CiAgICBTb3VuZHNbdXJsXSA9IG5ldyBBdWRpbyh1cmwpOwogICAgU291bmRzW3VybF0ub25sb2FkZWRkYXRhID0gZnVuY3Rpb24gKGUpIHsKICAgICAgZS50YXJnZXQudm9sdW1lID0gTWF0aC5wb3coKHZvbHVtZSAqIEdhbWUudm9sdW1lKSAvIDEwMCwgMik7CiAgICB9OwogIH0gZWxzZSBpZiAoU291bmRzW3VybF0ucmVhZHlTdGF0ZSA+PSAyKSB7CiAgICBTb3VuZHNbdXJsXS5jdXJyZW50VGltZSA9IDA7CiAgICBTb3VuZHNbdXJsXS52b2x1bWUgPSBNYXRoLnBvdygodm9sdW1lICogR2FtZS52b2x1bWUpIC8gMTAwLCAyKTsKICB9CiAgU291bmRzW3VybF0ucGxheSgpOwp9Owp2YXIgU291bmRJbnN0cyA9IFtdOwp2YXIgU291bmRJID0gMDsKZm9yICh2YXIgaSA9IDA7IGkgPCAxMjsgaSsrKSB7CiAgU291bmRJbnN0c1tpXSA9IG5ldyBBdWRpbygpOwp9CnZhciBwaXRjaFN1cHBvcnQgPSBmYWxzZTsKLy9ub3RlIDogQ2hyb21lIHR1cm5zIG91dCB0byBub3Qgc3VwcG9ydCB3ZWJraXRQcmVzZXJ2ZXNQaXRjaCBkZXNwaXRlIHRoZSBzcGVjaWZpY2F0aW9ucyBjbGFpbWluZyBvdGhlcndpc2UsIGFuZCBGaXJlZm94IGNsaXBzIHNvbWUgc2hvcnQgc291bmRzIHdoZW4gY2hhbmdpbmcgcGxheWJhY2tSYXRlLCBzbyBpJ20gdHVybmluZyB0aGUgZmVhdHVyZSBvZmYgY29tcGxldGVseSB1bnRpbCBicm93c2VycyBnZXQgaXQgdG9nZXRoZXIKLy9pZiAoU291bmRJbnN0c1swXS5wcmVzZXJ2ZXNQaXRjaCB8fCBTb3VuZEluc3RzWzBdLm1velByZXNlcnZlc1BpdGNoIHx8IFNvdW5kSW5zdHNbMF0ud2Via2l0UHJlc2VydmVzUGl0Y2gpIHBpdGNoU3VwcG9ydD10cnVlOwoKdmFyIFBsYXlTb3VuZCA9IGZ1bmN0aW9uICh1cmwsIHZvbCwgcGl0Y2hWYXIpIHsKICAvL3VybCA6IHRoZSB1cmwgb2YgdGhlIHNvdW5kIHRvIHBsYXkgKHdpbGwgYmUgY2FjaGVkIHNvIGl0IG9ubHkgbG9hZHMgb25jZSkKICAvL3ZvbCA6IHZvbHVtZSBiZXR3ZWVuIDAgYW5kIDEgKG11bHRpcGxpZWQgYnkgZ2FtZSB2b2x1bWUgc2V0dGluZyk7IGRlZmF1bHRzIHRvIDEgKGZ1bGwgdm9sdW1lKQogIC8vKERJU0FCTEVEKSBwaXRjaFZhciA6IHBpdGNoIHZhcmlhbmNlIGluIGJyb3dzZXJzIHRoYXQgc3VwcG9ydCBpdCAoRmlyZWZveCBvbmx5IGF0IHRoZSBtb21lbnQpOyBkZWZhdWx0cyB0byAwLjA1ICh3aGljaCBtZWFucyBwaXRjaCBjYW4gYmUgdXAgdG8gLTUlIG9yICs1JSBhbnl0aW1lIHRoZSBzb3VuZCBwbGF5cykKICB2YXIgdm9sdW1lID0gMTsKICB2YXIgdm9sdW1lU2V0dGluZyA9IEdhbWUudm9sdW1lOwogIGlmICh0eXBlb2Ygdm9sICE9PSAidW5kZWZpbmVkIikgdm9sdW1lID0gdm9sOwogIGlmICh2b2x1bWUgPCAtNSkgewogICAgdm9sdW1lICs9IDEwOwogICAgdm9sdW1lU2V0dGluZyA9IEdhbWUudm9sdW1lTXVzaWM7CiAgfQogIGlmICghdm9sdW1lU2V0dGluZyB8fCB2b2x1bWUgPT0gMCkgcmV0dXJuIDA7CiAgaWYgKHR5cGVvZiBTb3VuZHNbdXJsXSA9PT0gInVuZGVmaW5lZCIpIHsKICAgIC8vc291bmQgaXNuJ3QgbG9hZGVkLCBjYWNoZSBpdAogICAgU291bmRzW3VybF0gPSBuZXcgQXVkaW8odXJsKTsKICAgIFNvdW5kc1t1cmxdLm9ubG9hZGVkZGF0YSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIFBsYXlTb3VuZCh1cmwsIHZvbCwgcGl0Y2hWYXIpOwogICAgfTsKICAgIC8vU291bmRzW3VybF0ubG9hZCgpOwogIH0gZWxzZSBpZiAoU291bmRzW3VybF0ucmVhZHlTdGF0ZSA+PSAyICYmIFNvdW5kSW5zdHNbU291bmRJXS5wYXVzZWQpIHsKICAgIHZhciBzb3VuZCA9IFNvdW5kSW5zdHNbU291bmRJXTsKICAgIFNvdW5kSSsrOwogICAgaWYgKFNvdW5kSSA+PSAxMikgU291bmRJID0gMDsKICAgIHNvdW5kLnNyYyA9IFNvdW5kc1t1cmxdLnNyYzsKICAgIC8vc291bmQuY3VycmVudFRpbWU9MDsKICAgIHNvdW5kLnZvbHVtZSA9IE1hdGgucG93KCh2b2x1bWUgKiB2b2x1bWVTZXR0aW5nKSAvIDEwMCwgMik7CiAgICBpZiAocGl0Y2hTdXBwb3J0KSB7CiAgICAgIHZhciBwaXRjaFZhciA9IHR5cGVvZiBwaXRjaFZhciA9PT0gInVuZGVmaW5lZCIgPyAwLjA1IDogcGl0Y2hWYXI7CiAgICAgIHZhciByYXRlID0gMSArIChNYXRoLnJhbmRvbSgpICogMiAtIDEpICogcGl0Y2hWYXI7CiAgICAgIHNvdW5kLnByZXNlcnZlc1BpdGNoID0gZmFsc2U7CiAgICAgIHNvdW5kLm1velByZXNlcnZlc1BpdGNoID0gZmFsc2U7CiAgICAgIHNvdW5kLndlYmtpdFByZXNlcnZlc1BpdGNoID0gZmFsc2U7CiAgICAgIHNvdW5kLnBsYXliYWNrUmF0ZSA9IHJhdGU7CiAgICB9CiAgICB0cnkgewogICAgICBzb3VuZC5wbGF5KCk7CiAgICB9IGNhdGNoIChlKSB7fQogICAgLyoKCQl2YXIgc291bmQ9U291bmRzW3VybF0uY2xvbmVOb2RlKCk7CgkJc291bmQudm9sdW1lPU1hdGgucG93KHZvbHVtZSp2b2x1bWVTZXR0aW5nLzEwMCwyKTsKCQlzb3VuZC5vbmVuZGVkPWZ1bmN0aW9uKGUpe2lmIChlLnRhcmdldCl7ZGVsZXRlIGUudGFyZ2V0O319OwoJCXNvdW5kLnBsYXkoKTsqLwogIH0KfTsKdmFyIFBsYXlNdXNpY1NvdW5kID0gZnVuY3Rpb24gKHVybCwgdm9sLCBwaXRjaFZhcikgewogIC8vbGlrZSBQbGF5U291bmQgYnV0LCBpZiBtdXNpYyBpcyBlbmFibGVkLCBwbGF5IHdpdGggbXVzaWMgdm9sdW1lCiAgUGxheVNvdW5kKHVybCwgKHZvbCB8fCAxKSAtIChNdXNpYyA/IDEwIDogMCksIHBpdGNoVmFyKTsKfTsKCk11c2ljID0gZmFsc2U7ClBsYXlDdWUgPSBmdW5jdGlvbiAoY3VlLCBhcmcpIHsKICBpZiAoTXVzaWMgJiYgR2FtZS5qdWtlYm94LnRyYWNrQXV0bykgTXVzaWMuY3VlKGN1ZSwgYXJnKTsKfTsKCmlmICghRGF0ZS5ub3cpIHsKICBEYXRlLm5vdyA9IGZ1bmN0aW9uIG5vdygpIHsKICAgIHJldHVybiBuZXcgRGF0ZSgpLmdldFRpbWUoKTsKICB9Owp9Cgp2YXIgdHJpZ2dlckFuaW0gPSBmdW5jdGlvbiAoZWxlbWVudCwgYW5pbSkgewogIGlmICghZWxlbWVudCkgcmV0dXJuOwogIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShhbmltKTsKICB2b2lkIGVsZW1lbnQub2Zmc2V0V2lkdGg7CiAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKGFuaW0pOwp9OwoKdmFyIGRlYnVnU3RyID0gIiI7CnZhciBEZWJ1ZyA9IGZ1bmN0aW9uICh3aGF0KSB7CiAgaWYgKCFkZWJ1Z1N0cikgZGVidWdTdHIgPSB3aGF0OwogIGVsc2UgZGVidWdTdHIgKz0gIjsgIiArIHdoYXQ7Cn07Cgp2YXIgVGltZXIgPSB7fTsKVGltZXIudCA9IERhdGUubm93KCk7ClRpbWVyLmxhYmVscyA9IFtdOwpUaW1lci5zbW9vdGhlZCA9IFtdOwpUaW1lci5yZXNldCA9IGZ1bmN0aW9uICgpIHsKICBUaW1lci5sYWJlbHMgPSBbXTsKICBUaW1lci50ID0gRGF0ZS5ub3coKTsKfTsKVGltZXIudHJhY2sgPSBmdW5jdGlvbiAobGFiZWwpIHsKICBpZiAoIUdhbWUuc2VzYW1lKSByZXR1cm47CiAgdmFyIG5vdyA9IERhdGUubm93KCk7CiAgaWYgKCFUaW1lci5zbW9vdGhlZFtsYWJlbF0pIFRpbWVyLnNtb290aGVkW2xhYmVsXSA9IDA7CiAgVGltZXIuc21vb3RoZWRbbGFiZWxdICs9IChub3cgLSBUaW1lci50IC0gVGltZXIuc21vb3RoZWRbbGFiZWxdKSAqIDAuMTsKICBUaW1lci5sYWJlbHNbbGFiZWxdID0KICAgICc8ZGl2IHN0eWxlPSJwYWRkaW5nLWxlZnQ6OHB4OyI+JyArCiAgICBsYWJlbCArCiAgICAiIDogIiArCiAgICBNYXRoLnJvdW5kKFRpbWVyLnNtb290aGVkW2xhYmVsXSkgKwogICAgIm1zPC9kaXY+IjsKICBUaW1lci50ID0gbm93Owp9OwpUaW1lci5jbGVhbiA9IGZ1bmN0aW9uICgpIHsKICBpZiAoIUdhbWUuc2VzYW1lKSByZXR1cm47CiAgdmFyIG5vdyA9IERhdGUubm93KCk7CiAgVGltZXIudCA9IG5vdzsKfTsKVGltZXIuc2F5ID0gZnVuY3Rpb24gKGxhYmVsKSB7CiAgaWYgKCFHYW1lLnNlc2FtZSkgcmV0dXJuOwogIFRpbWVyLmxhYmVsc1tsYWJlbF0gPQogICAgJzxkaXYgc3R5bGU9ImJvcmRlci10b3A6MXB4IHNvbGlkICNjY2M7Ij4nICsgbGFiZWwgKyAiPC9kaXY+IjsKfTsKCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpHQU1FIElOSVRJQUxJWkFUSU9OCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCnZhciBHYW1lID0ge307CgooZnVuY3Rpb24gKCkgewogIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJTU9ERElORyBBUEkKCT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCiAgLyoKCQl0byB1c2U6CgkJLShOT1RFOiB0aGlzIGZ1bmN0aW9ucyBhIGxpdHRsZSBkaWZmZXJlbnRseSBpbiB0aGUgc3RhbmRhbG9uZS9TdGVhbSB2ZXJzaW9uOyBoYXZlIGEgbG9vayBpbiB0aGUgZ2FtZSdzIC9tb2RzIGZvbGRlciBmb3IgZXhhbXBsZSBtb2RzIC0gdGhvdWdoIG1vc3Qgb2YgdGhlIGluZm9ybWF0aW9uIGJlbG93IHN0aWxsIGFwcGxpZXMpCgkJLWhhdmUgeW91ciBtb2QgY2FsbCBHYW1lLnJlZ2lzdGVyTW9kKCJ1bmlxdWUgaWQiLG1vZCBvYmplY3QpCgkJLXRoZSAidW5pcXVlIGlkIiB2YWx1ZSBpcyBhIHN0cmluZyB0aGUgbW9kIHdpbGwgdXNlIHRvIGluZGV4IGFuZCByZXRyaWV2ZSBpdHMgc2F2ZSBkYXRhOyBzcGVjaWFsIGNoYXJhY3RlcnMgYXJlIGlnbm9yZWQKCQktdGhlICJtb2Qgb2JqZWN0IiB2YWx1ZSBpcyBhbiBvYmplY3Qgc3RydWN0dXJlZCBsaWtlIHNvOgoJCQl7CgkJCQlpbml0OmZ1bmN0aW9uKCl7CgkJCQkJLy90aGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCBhcyBzb29uIGFzIHRoZSBtb2QgaXMgcmVnaXN0ZXJlZAoJCQkJCS8vZGVjbGFyZSBob29rcyBoZXJlCgkJCQl9LAoJCQkJc2F2ZTpmdW5jdGlvbigpewoJCQkJCS8vdXNlIHRoaXMgdG8gc3RvcmUgcGVyc2lzdGVudCBkYXRhIGFzc29jaWF0ZWQgd2l0aCB5b3VyIG1vZAoJCQkJCXJldHVybiAnYSBzdHJpbmcgdG8gYmUgc2F2ZWQnOwoJCQkJfSwKCQkJCWxvYWQ6ZnVuY3Rpb24oc3RyKXsKCQkJCQkvL2RvIHN0dWZmIHdpdGggdGhlIHN0cmluZyBkYXRhIHlvdSBzYXZlZCBwcmV2aW91c2x5CgkJCQl9LAoJCQl9CgkJLXRoZSBtb2Qgb2JqZWN0IG1heSBhbHNvIGNvbnRhaW4gYW55IG90aGVyIGRhdGEgb3IgZnVuY3Rpb25zIHlvdSB3YW50LCBmb3IgaW5zdGFuY2UgdG8gbWFrZSB0aGVtIGFjY2Vzc2libGUgdG8gb3RoZXIgbW9kcwoJCS15b3VyIG1vZCBhbmQgaXRzIGRhdGEgY2FuIGJlIGFjY2Vzc2VkIHdpdGggR2FtZS5tb2RzWydtb2QgaWQnXQoJCS1ob29rcyBhcmUgZnVuY3Rpb25zIHRoZSBnYW1lIGNhbGxzIGF1dG9tYXRpY2FsbHkgaW4gY2VydGFpbiBjaXJjdW1zdGFuY2VzLCBsaWtlIHdoZW4gY2FsY3VsYXRpbmcgY29va2llcyBwZXIgY2xpY2sgb3Igd2hlbiByZWRyYXdpbmcgdGhlIHNjcmVlbgoJCS10byBhZGQgYSBob29rOiBHYW1lLnJlZ2lzdGVySG9vaygnaG9vayBpZCcseW91ckZ1bmN0aW9uSGVyZSkgLSBub3RlOiB5b3UgY2FuIGFsc28gZGVjbGFyZSB3aG9sZSBhcnJheXMgb2YgaG9va3MsIGllLiBHYW1lLnJlZ2lzdGVySG9vaygnaG9vayBpZCcsW2Z1bmN0aW9uMSxmdW5jdGlvbjIsLi4uXSkKCQktdG8gcmVtb3ZlIGEgaG9vazogR2FtZS5yZW1vdmVIb29rKCdob29rIGlkJyx0aGVTYW1lRnVuY3Rpb25IZXJlKQoJCS1zb21lIGhvb2tzIGFyZSBmZWQgYSBwYXJhbWV0ZXIgeW91IGNhbiB1c2UgaW4gdGhlIGZ1bmN0aW9uCgkJLWxpc3Qgb2YgdmFsaWQgaG9vayBpZHM6CgkJCSdsb2dpYycgLSBjYWxsZWQgZXZlcnkgbG9naWMgdGljawoJCQknZHJhdycgLSBjYWxsZWQgZXZlcnkgZHJhdyB0aWNrCgkJCSdyZXNldCcgLSBjYWxsZWQgd2hlbmV2ZXIgdGhlIHBsYXllciByZXNldHM7IHBhcmFtZXRlciBpcyB0cnVlIGlmIHRoaXMgaXMgYSBoYXJkIHJlc2V0LCBmYWxzZSBpZiBpdCdzIGFuIGFzY2Vuc2lvbgoJCQkncmVpbmNhcm5hdGUnIC0gY2FsbGVkIHdoZW4gdGhlIHBsYXllciBoYXMgcmVpbmNhcm5hdGVkIGFmdGVyIGFuIGFzY2Vuc2lvbgoJCQkndGlja2VyJyAtIGNhbGxlZCB3aGVuIGRldGVybWluaW5nIG5ld3MgdGlja2VyIHRleHQ7IHNob3VsZCByZXR1cm4gYW4gYXJyYXkgb2YgcG9zc2libGUgY2hvaWNlcyB0byBhZGQKCQkJJ2NwcycgLSBjYWxsZWQgd2hlbiBkZXRlcm1pbmluZyB0aGUgQ3BTOyBwYXJhbWV0ZXIgaXMgdGhlIGN1cnJlbnQgQ3BTOyBzaG91bGQgcmV0dXJuIHRoZSBtb2RpZmllZCBDcFMKCQkJJ2Nvb2tpZXNQZXJDbGljaycgLSBjYWxsZWQgd2hlbiBkZXRlcm1pbmluZyB0aGUgY29va2llcyBwZXIgY2xpY2s7IHBhcmFtZXRlciBpcyB0aGUgY3VycmVudCB2YWx1ZTsgc2hvdWxkIHJldHVybiB0aGUgbW9kaWZpZWQgdmFsdWUKCQkJJ2NsaWNrJyAtIGNhbGxlZCB3aGVuIHRoZSBiaWcgY29va2llIGlzIGNsaWNrZWQKCQkJJ2NyZWF0ZScgLSBjYWxsZWQgYWZ0ZXIgdGhlIGdhbWUgZGVjbGFyZXMgYWxsIGJ1aWxkaW5ncywgYnVmZnMsIHVwZ3JhZGVzIGFuZCBhY2hpZXZzOyB1c2UgdGhpcyB0byBkZWNsYXJlIHlvdXIgb3duIC0gbm90ZSB0aGF0IHdoaWxlIHRoZSBnYW1lIGRpc3Rpbmd1aXNoZXMgYmV0d2VlbiB2YW5pbGxhIGFuZCBub24tdmFuaWxsYSBjb250ZW50LCBzYXZpbmcvbG9hZGluZyBmdW5jdGlvbmFsaXR5IGZvciBjdXN0b20gY29udGVudCAoaW5jbHVkaW5nIHN0dWZmIGxpa2UgYWN0aXZlIGJ1ZmZzIG9yIHBlcm1hbmVudCB1cGdyYWRlIHNsb3R0aW5nKSBpcyBub3QgZXhwbGljaXRseSBpbXBsZW1lbnRlZCBhbmQgbWF5IGJlIHVucHJlZGljdGFibGUgYW5kIGJyb2tlbgoJCQknY2hlY2snIC0gY2FsbGVkIGV2ZXJ5IGZldyBzZWNvbmRzIHdoZW4gd2UgY2hlY2sgZm9yIHVwZ3JhZGUvYWNoaWV2IHVubG9jayBjb25kaXRpb25zOyB5b3UgY2FuIGFsc28gdXNlIHRoaXMgZm9yIG90aGVyIGNoZWNrcyB0aGF0IHlvdSBkb24ndCBuZWVkIGhhcHBlbmluZyBldmVyeSBsb2dpYyBmcmFtZQoJCS1mdW5jdGlvbiBob29rcyBhcmUgcHJvdmlkZWQgZm9yIGNvbnZlbmllbmNlIGFuZCBtb3JlIGFkdmFuY2VkIG1vZCBmdW5jdGlvbmFsaXR5IHdpbGwgcHJvYmFibHkgaW52b2x2ZSBtYW51YWwgY29kZSBpbmplY3Rpb24KCQktcGxlYXNlIGJlIG1pbmRmdWwgb2YgdGhlIGxlbmd0aCBvZiB0aGUgZGF0YSB5b3Ugc2F2ZSwgYXMgaXQgZG9lcyBpbmZsYXRlIHRoZSBleHBvcnQtc2F2ZS10by1zdHJpbmcgZmVhdHVyZQoJCQoJCU5PVEU6IG1vZGRpbmcgQVBJIGlzIHN1c2NlcHRpYmxlIHRvIGNoYW5nZSBhbmQgbWF5IG5vdCBhbHdheXMgZnVuY3Rpb24gc3VwZXItd2VsbAoJKi8KICBHYW1lLm1vZHMgPSB7fTsKICBHYW1lLnNvcnRlZE1vZHMgPSBbXTsKICBHYW1lLmJyb2tlbk1vZHMgPSBbXTsKICBHYW1lLm1vZFNhdmVEYXRhID0ge307CiAgR2FtZS5tb2RIb29rcyA9IHt9OwogIEdhbWUubW9kSG9va3NOYW1lcyA9IFsKICAgICJsb2dpYyIsCiAgICAiZHJhdyIsCiAgICAicmVzZXQiLAogICAgInJlaW5jYXJuYXRlIiwKICAgICJ0aWNrZXIiLAogICAgImNwcyIsCiAgICAiY29va2llc1BlckNsaWNrIiwKICAgICJjbGljayIsCiAgICAiY3JlYXRlIiwKICAgICJjaGVjayIsCiAgXTsKICBmb3IgKHZhciBpID0gMDsgaSA8IEdhbWUubW9kSG9va3NOYW1lcy5sZW5ndGg7IGkrKykgewogICAgR2FtZS5tb2RIb29rc1tHYW1lLm1vZEhvb2tzTmFtZXNbaV1dID0gW107CiAgfQogIEdhbWUucmVnaXN0ZXJNb2QgPSBmdW5jdGlvbiAoaWQsIG1vZCkgewogICAgaWQgPSBpZC5yZXBsYWNlKC9cVysvZywgIiAiKTsKICAgIGlmIChpZCA9PSAiTUVUQSIpIHJldHVybiBmYWxzZTsKICAgIGlmIChHYW1lLm1vZHNbaWRdKSB7CiAgICAgIGNvbnNvbGUubG9nKCdFUlJPUjogbW9kIGFscmVhZHkgcmVnaXN0ZXJlZCB3aXRoIHRoZSBpZCAiJyArIGlkICsgJyIuJyk7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIEdhbWUubW9kc1tpZF0gPSBtb2Q7CiAgICBHYW1lLnNvcnRlZE1vZHMucHVzaChtb2QpOwogICAgbW9kLmlkID0gaWQ7CiAgICBtb2QubmFtZSA9IG1vZC5uYW1lIHx8IGlkOwogICAgaWYgKEFwcCkgQXBwLnJlZ2lzdGVyTW9kKG1vZCk7CiAgICBjb25zb2xlLmxvZygnTW9kICInICsgaWQgKyAnIiBhZGRlZC4nKTsKICAgIGlmIChHYW1lLnJlYWR5ICYmIG1vZC5pbml0KSB7CiAgICAgIGlmICghQXBwICYmIEdhbWUuV2luKSBHYW1lLldpbigiVGhpcmQtcGFydHkiKTsKICAgICAgbW9kLmluaXQoKTsKICAgICAgaWYgKG1vZC5sb2FkICYmIEdhbWUubW9kU2F2ZURhdGFbaWRdKSBtb2QubG9hZChHYW1lLm1vZFNhdmVEYXRhW2lkXSk7CiAgICAgIG1vZC5pbml0ID0gMDsKICAgIH0KICB9OwogIEdhbWUubGF1bmNoTW9kcyA9IGZ1bmN0aW9uICgpIHsKICAgIGlmIChHYW1lLmJyb2tlbk1vZHMubGVuZ3RoID4gMCkgewogICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAnPHNwYW4gY2xhc3M9Indhcm5pbmciPicgKwogICAgICAgICAgbG9jKCJTb21lIG1vZHMgY291bGRuJ3QgYmUgbG9hZGVkOiIpICsKICAgICAgICAgICI8L3NwYW4+IiwKICAgICAgICAiWyIgKyBHYW1lLmJyb2tlbk1vZHMuam9pbigiLCAiKSArICJdIiwKICAgICAgICBbMzIsIDE3XQogICAgICApOwogICAgfQogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBHYW1lLnNvcnRlZE1vZHMubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIG1vZCA9IEdhbWUuc29ydGVkTW9kc1tpXTsKICAgICAgaWYgKG1vZC5pbml0KSB7CiAgICAgICAgY29uc29sZS5sb2coIj09PWluaXRpYWxpemluZyBtb2QiLCBtb2QuaWQpOwogICAgICAgIG1vZC5pbml0KCk7CiAgICAgICAgbW9kLmluaXQgPSAwOwogICAgICAgIC8vaWYgKG1vZC5sb2FkICYmIEdhbWUubW9kU2F2ZURhdGFbbW9kLmlkXSkgbW9kLmxvYWQoR2FtZS5tb2RTYXZlRGF0YVttb2QuaWRdKTsKICAgICAgfQogICAgfQogICAgaWYgKCFBcHAgJiYgR2FtZS5zb3J0ZWRNb2RzLmxlbmd0aCA+IDApIEdhbWUuV2luKCJUaGlyZC1wYXJ0eSIpOwogIH07CiAgR2FtZS5yZWdpc3Rlckhvb2sgPSBmdW5jdGlvbiAoaG9vaywgZnVuYykgewogICAgaWYgKGZ1bmMuY29uc3RydWN0b3IgPT09IEFycmF5KSB7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZnVuYy5sZW5ndGg7IGkrKykgewogICAgICAgIEdhbWUucmVnaXN0ZXJIb29rKGhvb2ssIGZ1bmNbaV0pOwogICAgICB9CiAgICAgIHJldHVybjsKICAgIH0KICAgIGlmICh0eXBlb2YgZnVuYyAhPT0gImZ1bmN0aW9uIikgcmV0dXJuOwogICAgaWYgKHR5cGVvZiBHYW1lLm1vZEhvb2tzW2hvb2tdICE9PSAidW5kZWZpbmVkIikKICAgICAgR2FtZS5tb2RIb29rc1tob29rXS5wdXNoKGZ1bmMpOwogICAgZWxzZQogICAgICBjb25zb2xlLmxvZygKICAgICAgICAnRXJyb3I6IGEgbW9kIHRyaWVkIHRvIHJlZ2lzdGVyIGEgbm9uLWV4aXN0ZW50IGhvb2sgbmFtZWQgIicgKwogICAgICAgICAgaG9vayArCiAgICAgICAgICAnIi4nCiAgICAgICk7CiAgfTsKICBHYW1lLnJlbW92ZUhvb2sgPSBmdW5jdGlvbiAoaG9vaywgZnVuYykgewogICAgaWYgKGZ1bmMuY29uc3RydWN0b3IgPT09IEFycmF5KSB7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZnVuYy5sZW5ndGg7IGkrKykgewogICAgICAgIEdhbWUucmVtb3ZlSG9vayhob29rLCBmdW5jW2ldKTsKICAgICAgfQogICAgICByZXR1cm47CiAgICB9CiAgICBpZiAodHlwZW9mIGZ1bmMgIT09ICJmdW5jdGlvbiIpIHJldHVybjsKICAgIGlmICgKICAgICAgdHlwZW9mIEdhbWUubW9kSG9va3NbaG9va10gIT09ICJ1bmRlZmluZWQiICYmCiAgICAgIEdhbWUubW9kSG9va3NbaG9va10uaW5kZXhPZihmdW5jKSAhPSAtMQogICAgKQogICAgICBHYW1lLm1vZEhvb2tzW2hvb2tdLnNwbGljZShHYW1lLm1vZEhvb2tzW2hvb2tdLmluZGV4T2YoZnVuYyksIDEpOwogICAgZWxzZQogICAgICBjb25zb2xlLmxvZygKICAgICAgICAnRXJyb3I6IGEgbW9kIHRyaWVkIHRvIHJlbW92ZSBhIG5vbi1leGlzdGVudCBob29rIG5hbWVkICInICsgaG9vayArICciLicKICAgICAgKTsKICB9OwogIEdhbWUucnVuTW9kSG9vayA9IGZ1bmN0aW9uIChob29rLCBwYXJhbSkgewogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBHYW1lLm1vZEhvb2tzW2hvb2tdLmxlbmd0aDsgaSsrKSB7CiAgICAgIEdhbWUubW9kSG9va3NbaG9va11baV0ocGFyYW0pOwogICAgfQogIH07CiAgR2FtZS5ydW5Nb2RIb29rT25WYWx1ZSA9IGZ1bmN0aW9uIChob29rLCB2YWwpIHsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgR2FtZS5tb2RIb29rc1tob29rXS5sZW5ndGg7IGkrKykgewogICAgICB2YWwgPSBHYW1lLm1vZEhvb2tzW2hvb2tdW2ldKHZhbCk7CiAgICB9CiAgICByZXR1cm4gdmFsOwogIH07CiAgR2FtZS5zYWZlU2F2ZVN0cmluZyA9IGZ1bmN0aW9uIChzdHIpIHsKICAgIC8vbG9vayBhcyBsb25nIGFzIGl0IHdvcmtzCiAgICBzdHIgPSByZXBsYWNlQWxsKCJ8IiwgIltQXSIsIHN0cik7CiAgICBzdHIgPSByZXBsYWNlQWxsKCI7IiwgIltTXSIsIHN0cik7CiAgICByZXR1cm4gc3RyOwogIH07CiAgR2FtZS5zYWZlTG9hZFN0cmluZyA9IGZ1bmN0aW9uIChzdHIpIHsKICAgIHN0ciA9IHJlcGxhY2VBbGwoIltQXSIsICJ8Iiwgc3RyKTsKICAgIHN0ciA9IHJlcGxhY2VBbGwoIltTXSIsICI7Iiwgc3RyKTsKICAgIHJldHVybiBzdHI7CiAgfTsKICBHYW1lLnNhdmVNb2REYXRhID0gZnVuY3Rpb24gKCkgewogICAgdmFyIHN0ciA9ICIiOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBHYW1lLnNvcnRlZE1vZHMubGVuZ3RoOyBpKyspIHsKICAgICAgaWYgKEdhbWUuc29ydGVkTW9kc1tpXVsic2F2ZSJdKSB7CiAgICAgICAgdmFyIGRhdGEgPSBHYW1lLnNvcnRlZE1vZHNbaV1bInNhdmUiXSgpOwogICAgICAgIGlmICh0eXBlb2YgZGF0YSAhPT0gInVuZGVmaW5lZCIpCiAgICAgICAgICBHYW1lLm1vZFNhdmVEYXRhW0dhbWUuc29ydGVkTW9kc1tpXS5pZF0gPSBkYXRhOwogICAgICB9CiAgICB9CiAgICBmb3IgKHZhciBpIGluIEdhbWUubW9kU2F2ZURhdGEpIHsKICAgICAgc3RyICs9IGkgKyAiOiIgKyBHYW1lLnNhZmVTYXZlU3RyaW5nKEdhbWUubW9kU2F2ZURhdGFbaV0pICsgIjsiOwogICAgfQogICAgaWYgKEFwcCAmJiBBcHAuc2F2ZU1vZHMpIHN0ciArPSBBcHAuc2F2ZU1vZHMoKTsKICAgIHJldHVybiBzdHI7CiAgfTsKICBHYW1lLmxvYWRNb2REYXRhID0gZnVuY3Rpb24gKCkgewogICAgZm9yICh2YXIgaSBpbiBHYW1lLm1vZFNhdmVEYXRhKSB7CiAgICAgIGlmIChHYW1lLm1vZHNbaV0gJiYgR2FtZS5tb2RzW2ldWyJsb2FkIl0pCiAgICAgICAgR2FtZS5tb2RzW2ldWyJsb2FkIl0oR2FtZS5tb2RTYXZlRGF0YVtpXSk7CiAgICB9CiAgfTsKICBHYW1lLmRlbGV0ZU1vZERhdGEgPSBmdW5jdGlvbiAoaWQpIHsKICAgIGlmIChHYW1lLm1vZFNhdmVEYXRhW2lkXSkgZGVsZXRlIEdhbWUubW9kU2F2ZURhdGFbaWRdOwogIH07CiAgR2FtZS5kZWxldGVBbGxNb2REYXRhID0gZnVuY3Rpb24gKCkgewogICAgR2FtZS5tb2RTYXZlRGF0YSA9IHt9OwogIH07CiAgR2FtZS5DaGVja01vZERhdGEgPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgbW9kc04gPSAwOwogICAgdmFyIHN0ciA9ICIiOwogICAgZm9yICh2YXIgaSBpbiBHYW1lLm1vZFNhdmVEYXRhKSB7CiAgICAgIHN0ciArPQogICAgICAgICc8ZGl2IHN0eWxlPSJib3JkZXItYm90dG9tOjFweCBkYXNoZWQgcmdiYSgyNTUsMjU1LDI1NSwwLjIpO2NsZWFyOmJvdGg7b3ZlcmZsb3c6aGlkZGVuO3BhZGRpbmc6NHB4IDBweDsiPic7CiAgICAgIHN0ciArPQogICAgICAgICc8ZGl2IHN0eWxlPSJmbG9hdDpsZWZ0O3dpZHRoOjQ5JTt0ZXh0LWFsaWduOmxlZnQ7b3ZlcmZsb3c6aGlkZGVuOyI+PGI+JyArCiAgICAgICAgaSArCiAgICAgICAgIjwvYj4iOwogICAgICBpZiAoR2FtZS5tb2RzW2ldKSBzdHIgKz0gIiAiICsgbG9jKCIobG9hZGVkKSIpOwogICAgICBzdHIgKz0gIjwvZGl2PiI7CiAgICAgIHN0ciArPQogICAgICAgICc8ZGl2IHN0eWxlPSJmbG9hdDpyaWdodDt3aWR0aDo0OSU7dGV4dC1hbGlnbjpyaWdodDtvdmVyZmxvdzpoaWRkZW47Ij4nICsKICAgICAgICBsb2MoIiUxIGNoYXIiLCBHYW1lLm1vZFNhdmVEYXRhW2ldLmxlbmd0aCkgKwogICAgICAgICcgPGEgY2xhc3M9Im9wdGlvbiB3YXJuaW5nIiBzdHlsZT0icGFkZGluZzowcHggMnB4O2ZvbnQtc2l6ZToxMHB4O21hcmdpbjowcHg7dmVydGljYWwtYWxpZ246dG9wOyIgJyArCiAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgIj1cIkdhbWUuZGVsZXRlTW9kRGF0YSgnIiArCiAgICAgICAgaSArCiAgICAgICAgIicpO1BsYXlTb3VuZCgnc25kL3RpY2subXAzJyk7R2FtZS5DbG9zZVByb21wdCgpO0dhbWUuQ2hlY2tNb2REYXRhKCk7XCI+WDwvYT4iOwogICAgICBzdHIgKz0gIjwvZGl2PiI7CiAgICAgIHN0ciArPSAiPC9kaXY+IjsKICAgICAgbW9kc04rKzsKICAgIH0KICAgIGlmIChtb2RzTiA9PSAwKSBzdHIgKz0gbG9jKCJObyBtb2QgZGF0YSBwcmVzZW50LiIpOwogICAgZWxzZQogICAgICBzdHIgKz0KICAgICAgICAnPGRpdj48YSBjbGFzcz0ib3B0aW9uIHdhcm5pbmciIHN0eWxlPSJmb250LXNpemU6MTFweDttYXJnaW4tdG9wOjRweDsiICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICI9XCJHYW1lLmRlbGV0ZUFsbE1vZERhdGEoKTtQbGF5U291bmQoJ3NuZC90aWNrLm1wMycpO0dhbWUuQ2xvc2VQcm9tcHQoKTtHYW1lLkNoZWNrTW9kRGF0YSgpO1wiPiIgKwogICAgICAgIGxvYygiRGVsZXRlIGFsbCIpICsKICAgICAgICAiPC9hPjwvZGl2PiI7CiAgICBHYW1lLlByb21wdCgKICAgICAgIjxpZCBNb2REYXRhPjxoMz4iICsKICAgICAgICBsb2MoIk1vZCBkYXRhIikgKwogICAgICAgICc8L2gzPjxkaXYgY2xhc3M9ImJsb2NrIj4nICsKICAgICAgICB0aW55SWNvbihbMTYsIDVdKSArCiAgICAgICAgIjxkaXY+PC9kaXY+IiArCiAgICAgICAgbG9jKAogICAgICAgICAgIlRoZXNlIGFyZSB0aGUgbW9kcyBwcmVzZW50IGluIHlvdXIgc2F2ZSBkYXRhLiBZb3UgbWF5IGRlbGV0ZSBzb21lIG9mIHRoaXMgZGF0YSB0byBtYWtlIHlvdXIgc2F2ZSBmaWxlIHNtYWxsZXIuIgogICAgICAgICkgKwogICAgICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJibG9jayIgc3R5bGU9ImZvbnQtc2l6ZToxMXB4OyI+JyArCiAgICAgICAgc3RyICsKICAgICAgICAiPC9kaXY+IiwKICAgICAgW2xvYygiQmFjayIpXQogICAgKTsKICB9OwoKICBHYW1lLkxvYWRNb2QgPSBMb2FkU2NyaXB0OyAvL2xvYWRzIHRoZSBtb2QgYXQgdGhlIGdpdmVuIFVSTAoKICBpZiAoZmFsc2UpIHsKICAgIC8vRVhBTVBMRSBNT0QKICAgIEdhbWUucmVnaXN0ZXJNb2QoInRlc3QgbW9kIiwgewogICAgICAvKgoJCQkJd2hhdCB0aGlzIGV4YW1wbGUgbW9kIGRvZXM6CgkJCQktZG91YmxlIHlvdXIgQ3BTCgkJCQktZGlzcGxheSBhIGxpdHRsZSBwb3B1cCBmb3IgaGFsZiBhIHNlY29uZCB3aGVuZXZlciB5b3UgY2xpY2sgdGhlIGJpZyBjb29raWUKCQkJCS1hZGQgYSBsaXR0bGUgaW50cm8gdGV4dCBhYm92ZSB5b3VyIGJha2VyeSBuYW1lLCBhbmQgZ2VuZXJhdGUgdGhhdCBpbnRybyB0ZXh0IGF0IHJhbmRvbSBpZiB5b3UgZG9uJ3QgYWxyZWFkeSBoYXZlIG9uZQoJCQkJLXNhdmUgYW5kIGxvYWQgeW91ciBpbnRybyB0ZXh0CgkJCSovCiAgICAgIGluaXQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLnJlZ2lzdGVySG9vaygicmVpbmNhcm5hdGUiLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBHYW1lLm1vZHNbInRlc3QgbW9kIl0uYWRkSW50cm8oKTsKICAgICAgICB9KTsKICAgICAgICBHYW1lLnJlZ2lzdGVySG9vaygiY2hlY2siLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAoIUdhbWUucGxheWVySW50cm8pIHsKICAgICAgICAgICAgR2FtZS5tb2RzWyJ0ZXN0IG1vZCJdLmFkZEludHJvKCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgR2FtZS5yZWdpc3Rlckhvb2soImNsaWNrIiwgZnVuY3Rpb24gKCkgewogICAgICAgICAgR2FtZS5Ob3RpZnkoCiAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgIkEgZ29vZCBjbGljay4iLAogICAgICAgICAgICAgICJBIHNvbGlkIGNsaWNrLiIsCiAgICAgICAgICAgICAgIkEgbWVkaW9jcmUgY2xpY2suIiwKICAgICAgICAgICAgICAiQW4gZXhjZWxsZW50IGNsaWNrISIsCiAgICAgICAgICAgIF0pLAogICAgICAgICAgICAiIiwKICAgICAgICAgICAgMCwKICAgICAgICAgICAgMC41CiAgICAgICAgICApOwogICAgICAgIH0pOwogICAgICAgIEdhbWUucmVnaXN0ZXJIb29rKCJjcHMiLCBmdW5jdGlvbiAoY3BzKSB7CiAgICAgICAgICByZXR1cm4gY3BzICogMjsKICAgICAgICB9KTsKICAgICAgfSwKICAgICAgc2F2ZTogZnVuY3Rpb24gKCkgewogICAgICAgIC8vbm90ZTogd2UgdXNlIHN0cmluZ2lmaWVkIEpTT04gZm9yIGVhc2UgYW5kIGNsYXJpdHkgYnV0IHlvdSBjb3VsZCBzdG9yZSBhbnkgdHlwZSBvZiBzdHJpbmcKICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoeyB0ZXh0OiBHYW1lLnBsYXllckludHJvIH0pOwogICAgICB9LAogICAgICBsb2FkOiBmdW5jdGlvbiAoc3RyKSB7CiAgICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKHN0cik7CiAgICAgICAgaWYgKGRhdGEudGV4dCkgR2FtZS5tb2RzWyJ0ZXN0IG1vZCJdLmFkZEludHJvKGRhdGEudGV4dCk7CiAgICAgIH0sCiAgICAgIGFkZEludHJvOiBmdW5jdGlvbiAodGV4dCkgewogICAgICAgIC8vbm90ZTogdGhpcyBpcyBub3QgYSBtb2QgaG9vaywganVzdCBhIGZ1bmN0aW9uIHRoYXQncyBwYXJ0IG9mIHRoZSBtb2QKICAgICAgICBHYW1lLnBsYXllckludHJvID0KICAgICAgICAgIHRleHQgfHwKICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICJvaCBzbmFwLCBpdCdzIiwKICAgICAgICAgICAgIndhdGNoIG91dCwgaXQncyIsCiAgICAgICAgICAgICJvaCBubyEgaGVyZSBjb21lcyIsCiAgICAgICAgICAgICJoaWRlIHlvdXIgY29va2llcywgZm9yIGhlcmUgY29tZXMiLAogICAgICAgICAgICAiYmVob2xkISBpdCdzIiwKICAgICAgICAgIF0pOwogICAgICAgIGlmICghbCgiYmFrZXJ5U3VidGl0bGUiKSkKICAgICAgICAgIGwoImJha2VyeU5hbWUiKS5pbnNlcnRBZGphY2VudEhUTUwoCiAgICAgICAgICAgICJhZnRlcmVuZCIsCiAgICAgICAgICAgICc8ZGl2IGlkPSJiYWtlcnlTdWJ0aXRsZSIgY2xhc3M9InRpdGxlIiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7cG9zaXRpb246YWJzb2x1dGU7bGVmdDowcHg7cmlnaHQ6MHB4O2JvdHRvbTozMnB4O2ZvbnQtc2l6ZToxMnB4O3BvaW50ZXItZXZlbnRzOm5vbmU7dGV4dC1zaGFkb3c6MHB4IDFweCAxcHggIzAwMCwwcHggMHB4IDRweCAjZjAwO29wYWNpdHk6MC44OyI+PC9kaXY+JwogICAgICAgICAgKTsKICAgICAgICBsKCJiYWtlcnlTdWJ0aXRsZSIpLnRleHRDb250ZW50ID0gIn4iICsgR2FtZS5wbGF5ZXJJbnRybyArICJ+IjsKICAgICAgfSwKICAgIH0pOwogIH0KCiAgLy9yZXBsYWNpbmcgYW4gZXhpc3RpbmcgY2FudmFzIHBpY3R1cmUgd2l0aCBhIG5ldyBvbmUgYXQgcnVudGltZSA6IEdhbWUuTG9hZGVyLlJlcGxhY2UoJ3BlcmZlY3RDb29raWUucG5nJywnaW1wZXJmZWN0Q29va2llLnBuZycpOwogIC8vdXBncmFkZXMgYW5kIGFjaGlldmVtZW50cyBjYW4gdXNlIG90aGVyIHBpY3R1cmVzIHRoYW4gaWNvbnMucG5nOyBkZWNsYXJlIHRoZWlyIGljb24gd2l0aCBbcG9zWCxwb3NZLCdodHRwOi8vZXhhbXBsZS5jb20vbXlJY29ucy5wbmcnXQogIC8vY2hlY2sgb3V0IHRoZSAiVU5MT0NLSU5HIFNUVUZGIiBzZWN0aW9uIHRvIHNlZSBob3cgdW5sb2NraW5nIGFjaGlldnMgYW5kIHVwZ3JhZGVzIGlzIGRvbmUKfSkoKTsKCkdhbWUudmVyc2lvbiA9IFZFUlNJT047CkdhbWUubG9hZGVkRnJvbVZlcnNpb24gPSBWRVJTSU9OOwpHYW1lLmJldGEgPSBCRVRBOwppZiAoIUFwcCAmJiB3aW5kb3cubG9jYXRpb24uaHJlZi5pbmRleE9mKCIvYmV0YSIpID4gLTEpIEdhbWUuYmV0YSA9IDE7CmVsc2UgaWYgKEFwcCAmJiBuZXcgVVJMKHdpbmRvdy5sb2NhdGlvbi5ocmVmKS5zZWFyY2hQYXJhbXMuZ2V0KCJiZXRhIikpCiAgR2FtZS5iZXRhID0gMTsKR2FtZS5odHRwcyA9ICFBcHAgPyAobG9jYXRpb24ucHJvdG9jb2wgIT0gImh0dHBzOiIgPyBmYWxzZSA6IHRydWUpIDogdHJ1ZTsKR2FtZS5TYXZlVG8gPSAiQ29va2llQ2xpY2tlckdhbWUiOwppZiAoR2FtZS5iZXRhKSBHYW1lLlNhdmVUbyA9ICJDb29raWVDbGlja2VyR2FtZUJldGEiOwppZiAoQXBwICYmIG5ldyBVUkwod2luZG93LmxvY2F0aW9uLmhyZWYpLnNlYXJjaFBhcmFtcy5nZXQoIm1vZGxlc3MiKSkKICBHYW1lLm1vZGxlc3MgPSAxOwoKR2FtZS5MYXVuY2ggPSBmdW5jdGlvbiAoKSB7CiAgR2FtZS5tb2JpbGUgPSAwOwogIEdhbWUudG91Y2hFdmVudHMgPSAwOwogIC8vaWYgKC9BbmRyb2lkfHdlYk9TfGlQaG9uZXxpUGFkfGlQb2R8QmxhY2tCZXJyeXxJRU1vYmlsZXxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgR2FtZS5tb2JpbGU9MTsKICAvL2lmIChHYW1lLm1vYmlsZSkgR2FtZS50b3VjaEV2ZW50cz0xOwogIC8vaWYgKCdvbnRvdWNoc3RhcnQnIGluIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCkgR2FtZS50b3VjaEV2ZW50cz0xOwoKICB2YXIgY3NzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic3R5bGUiKTsKICBjc3MudHlwZSA9ICJ0ZXh0L2NzcyI7CiAgY3NzLmlubmVySFRNTCA9CiAgICAiYm9keSAuaWNvbixib2R5IC5jcmF0ZSxib2R5IC51c2VzSWNvbntiYWNrZ3JvdW5kLWltYWdlOnVybChpbWcvaWNvbnMucG5nP3Y9IiArCiAgICBHYW1lLnZlcnNpb24gKwogICAgIik7fSI7CiAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChjc3MpOwoKICAvL3RoaXMgaXMgc28gc2hpbW1lcnMgY2FuIHN0aWxsIGFwcGVhciBldmVuIGlmIHlvdSBsb3NlIGNvbm5lY3Rpb24gYWZ0ZXIgdGhlIGdhbWUgaXMgbG9hZGVkCiAgdmFyIHByZWxvYWRJbWFnZXMgPSBbCiAgICAiaW1nL2dvbGRDb29raWUucG5nIiwKICAgICJpbWcvd3JhdGhDb29raWUucG5nIiwKICAgICJpbWcvc3Bvb2t5Q29va2llLnBuZyIsCiAgICAiaW1nL2hlYXJ0cy5wbmciLAogICAgImltZy9jb250cmFjdC5wbmciLAogICAgImltZy93cmF0aENvbnRyYWN0LnBuZyIsCiAgICAiaW1nL2J1bm5pZXMucG5nIiwKICAgICJpbWcvZnJvc3RlZFJlaW5kZWVyLnBuZyIsCiAgXTsKICB2YXIgcHJlbG9hZEltYWdlc0wgPSBsKCJwcmVsb2FkSW1hZ2VzIik7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcmVsb2FkSW1hZ2VzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgaW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaW1nIik7CiAgICBpbWcuc3JjID0gcHJlbG9hZEltYWdlc1tpXTsKICAgIHByZWxvYWRJbWFnZXNMLmFwcGVuZENoaWxkKGltZyk7CiAgfQoKICBHYW1lLnZpc2libGUgPSB0cnVlOwogIEFkZEV2ZW50KGRvY3VtZW50LCAidmlzaWJpbGl0eWNoYW5nZSIsIGZ1bmN0aW9uIChlKSB7CiAgICBpZiAoZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlID09PSAiaGlkZGVuIikgR2FtZS52aXNpYmxlID0gZmFsc2U7CiAgICBlbHNlIEdhbWUudmlzaWJsZSA9IHRydWU7CiAgfSk7CgogIGlmICghRU4pIHsKICAgIC8vY29kZS1wYXRjaGluZyB0aGUgQ1NTIGZvciBsb2NhbGl6YXRpb24gZmVlbHMgbGlrZSBpdCBzaG91bGQgYmUgYWdhaW5zdCB0aGUgbGF3LCBhbmQgeWV0CiAgICB2YXIgY3NzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic3R5bGUiKTsKICAgIGNzcy50eXBlID0gInRleHQvY3NzIjsKICAgIGNzcy5pbm5lckhUTUwgPQogICAgICAiI3VwZ3JhZGVzOmJlZm9yZXtjb250ZW50OiciICsKICAgICAgbG9jKCJVcGdyYWRlcyIpICsKICAgICAgIic7fSIgKwogICAgICAiI3RvZ2dsZVVwZ3JhZGVzOmJlZm9yZXtjb250ZW50OiciICsKICAgICAgbG9jKCJTd2l0Y2hlcyIpICsKICAgICAgIic7fSIgKwogICAgICAiI3RlY2hVcGdyYWRlczpiZWZvcmV7Y29udGVudDonIiArCiAgICAgIGxvYygiUmVzZWFyY2giKSArCiAgICAgICInO30iICsKICAgICAgIiN2YXVsdFVwZ3JhZGVzOmJlZm9yZXtjb250ZW50OiciICsKICAgICAgbG9jKCJWYXVsdCIpICsKICAgICAgIic7fSIgKwogICAgICAiI3Byb2R1Y3RzOmJlZm9yZXtjb250ZW50OiciICsKICAgICAgbG9jKCJCdWlsZGluZ3MiKSArCiAgICAgICInO30iICsKICAgICAgIiI7CiAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGNzcyk7CiAgfQoKICBHYW1lLmJhc2VTZWFzb24gPSAiIjsgLy9oYWxsb3dlZW4sIGNocmlzdG1hcywgdmFsZW50aW5lcywgZm9vbHMsIGVhc3RlcgogIC8vYXV0b21hdGljIHNlYXNvbiBkZXRlY3Rpb24gKG1pZ2h0IG5vdCBiZSAxMDAlIGFjY3VyYXRlKQogIHZhciB5ZWFyID0gbmV3IERhdGUoKS5nZXRGdWxsWWVhcigpOwogIHZhciBsZWFwID0gKHllYXIgJSA0ID09IDAgJiYgeWVhciAlIDEwMCAhPSAwKSB8fCB5ZWFyICUgNDAwID09IDAgPyAxIDogMDsKICB2YXIgZGF5ID0gTWF0aC5mbG9vcigKICAgIChuZXcgRGF0ZSgpIC0gbmV3IERhdGUoeWVhciwgMCwgMCkpIC8gKDEwMDAgKiA2MCAqIDYwICogMjQpCiAgKTsKICBpZiAoZGF5ID49IDQxICYmIGRheSA8PSA0NikgR2FtZS5iYXNlU2Vhc29uID0gInZhbGVudGluZXMiOwogIGVsc2UgaWYgKGRheSArIGxlYXAgPj0gOTAgJiYgZGF5IDw9IDkyICsgbGVhcCkgR2FtZS5iYXNlU2Vhc29uID0gImZvb2xzIjsKICBlbHNlIGlmIChkYXkgPj0gMzA0IC0gNyArIGxlYXAgJiYgZGF5IDw9IDMwNCArIGxlYXApCiAgICBHYW1lLmJhc2VTZWFzb24gPSAiaGFsbG93ZWVuIjsKICBlbHNlIGlmIChkYXkgPj0gMzQ5ICsgbGVhcCAmJiBkYXkgPD0gMzY1ICsgbGVhcCkKICAgIEdhbWUuYmFzZVNlYXNvbiA9ICJjaHJpc3RtYXMiOwogIGVsc2UgewogICAgLy9lYXN0ZXIgaXMgYSBwYWluIGdvZGRhbW4KICAgIHZhciBlYXN0ZXJEYXkgPSAoZnVuY3Rpb24gKFkpIHsKICAgICAgdmFyIEMgPSBNYXRoLmZsb29yKFkgLyAxMDApOwogICAgICB2YXIgTiA9IFkgLSAxOSAqIE1hdGguZmxvb3IoWSAvIDE5KTsKICAgICAgdmFyIEsgPSBNYXRoLmZsb29yKChDIC0gMTcpIC8gMjUpOwogICAgICB2YXIgSSA9IEMgLSBNYXRoLmZsb29yKEMgLyA0KSAtIE1hdGguZmxvb3IoKEMgLSBLKSAvIDMpICsgMTkgKiBOICsgMTU7CiAgICAgIEkgPSBJIC0gMzAgKiBNYXRoLmZsb29yKEkgLyAzMCk7CiAgICAgIEkgPQogICAgICAgIEkgLQogICAgICAgIE1hdGguZmxvb3IoSSAvIDI4KSAqCiAgICAgICAgICAoMSAtCiAgICAgICAgICAgIE1hdGguZmxvb3IoSSAvIDI4KSAqCiAgICAgICAgICAgICAgTWF0aC5mbG9vcigyOSAvIChJICsgMSkpICoKICAgICAgICAgICAgICBNYXRoLmZsb29yKCgyMSAtIE4pIC8gMTEpKTsKICAgICAgdmFyIEogPSBZICsgTWF0aC5mbG9vcihZIC8gNCkgKyBJICsgMiAtIEMgKyBNYXRoLmZsb29yKEMgLyA0KTsKICAgICAgSiA9IEogLSA3ICogTWF0aC5mbG9vcihKIC8gNyk7CiAgICAgIHZhciBMID0gSSAtIEo7CiAgICAgIHZhciBNID0gMyArIE1hdGguZmxvb3IoKEwgKyA0MCkgLyA0NCk7CiAgICAgIHZhciBEID0gTCArIDI4IC0gMzEgKiBNYXRoLmZsb29yKE0gLyA0KTsKICAgICAgcmV0dXJuIG5ldyBEYXRlKFksIE0gLSAxLCBEKTsKICAgIH0pKHllYXIpOwogICAgZWFzdGVyRGF5ID0gTWF0aC5mbG9vcigKICAgICAgKGVhc3RlckRheSAtIG5ldyBEYXRlKGVhc3RlckRheS5nZXRGdWxsWWVhcigpLCAwLCAwKSkgLwogICAgICAgICgxMDAwICogNjAgKiA2MCAqIDI0KQogICAgKTsKICAgIGlmIChkYXkgPj0gZWFzdGVyRGF5IC0gNyAmJiBkYXkgPD0gZWFzdGVyRGF5KSBHYW1lLmJhc2VTZWFzb24gPSAiZWFzdGVyIjsKICB9CgogIEdhbWUudXBkYXRlTG9nID0KICAgICc8ZGl2IGNsYXNzPSJzZWxlY3RhYmxlIj4nICsKICAgICc8ZGl2IGNsYXNzPSJzZWN0aW9uIj4nICsKICAgIGxvYygiSW5mbyIpICsKICAgICI8L2Rpdj4iICsKICAgICc8ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+JyArCiAgICBsb2MoIkFib3V0IikgKwogICAgIjwvZGl2PiIgKwogICAgKEFwcAogICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIiBzdHlsZT0iZm9udC13ZWlnaHQ6Ym9sZDtmb250LXN0eWxlOml0YWxpYztvcGFjaXR5OjAuNTsiPicgKwogICAgICAgIGxvYygiTm90ZTogbGlua3Mgd2lsbCBvcGVuIGluIHlvdXIgd2ViIGJyb3dzZXIuIikgKwogICAgICAgICI8L2Rpdj4iCiAgICAgIDogIiIpICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4nICsKICAgIGxvYygiQ29va2llIENsaWNrZXIgaXMgYSBqYXZhc2NyaXB0IGdhbWUgYnkgJTEgYW5kICUyLiIsIFsKICAgICAgJzxhIGhyZWY9Ii8vb3J0ZWlsLmRhc2huZXQub3JnIiB0YXJnZXQ9Il9ibGFuayI+T3J0ZWlsPC9hPicsCiAgICAgICc8YSBocmVmPSIvL2Rhc2huZXQub3JnIiB0YXJnZXQ9Il9ibGFuayI+T3B0aTwvYT4nLAogICAgXSkgKwogICAgIjwvZGl2PiIgKwogICAgKEFwcAogICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4nICsKICAgICAgICBsb2MoCiAgICAgICAgICAiTXVzaWMgYnkgJTEuIiwKICAgICAgICAgICc8YSBocmVmPSJodHRwczovL3R3aXR0ZXIuY29tL0M0MTgiIHRhcmdldD0iX2JsYW5rIj5DNDE4PC9hPicKICAgICAgICApICsKICAgICAgICAiPC9kaXY+IgogICAgICA6ICIiKSArCiAgICAvLyc8ZGl2IGNsYXNzPSJsaXN0aW5nIj5XZSBoYXZlIGFuIDxhIGhyZWY9Imh0dHBzOi8vZGlzY29yZGFwcC5jb20vaW52aXRlL2Nvb2tpZSIgdGFyZ2V0PSJfYmxhbmsiPm9mZmljaWFsIERpc2NvcmQ8L2E+LCBhcyB3ZWxsIGFzIGEgPGEgaHJlZj0iaHR0cDovL2ZvcnVtLmRhc2huZXQub3JnIiB0YXJnZXQ9Il9ibGFuayI+Zm9ydW08L2E+OyAnKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPicgKwogICAgKEVOCiAgICAgID8gJ1dlIGhhdmUgYW4gPGEgaHJlZj0iaHR0cHM6Ly9kaXNjb3JkYXBwLmNvbS9pbnZpdGUvY29va2llIiB0YXJnZXQ9Il9ibGFuayI+b2ZmaWNpYWwgRGlzY29yZDwvYT47IGlmIHlvdVwncmUgbG9va2luZyBmb3IgaGVscCwgeW91IG1heSBhbHNvIHdhbnQgdG8gdmlzaXQgdGhlIDxhIGhyZWY9Imh0dHBzOi8vd3d3LnJlZGRpdC5jb20vci9Db29raWVDbGlja2VyIiB0YXJnZXQ9Il9ibGFuayI+c3VicmVkZGl0PC9hPiBvciB0aGUgPGEgaHJlZj0iaHR0cHM6Ly9jb29raWVjbGlja2VyLndpa2lhLmNvbS93aWtpL0Nvb2tpZV9DbGlja2VyX1dpa2kiIHRhcmdldD0iX2JsYW5rIj53aWtpPC9hPi48YnI+TmV3cyBhbmQgdGVhc2VycyBhcmUgdXN1YWxseSBwb3N0ZWQgb24gT3J0ZWlsXCdzIDxhIGhyZWY9Imh0dHBzOi8vb3J0ZWlsNDIudHVtYmxyLmNvbS8iIHRhcmdldD0iX2JsYW5rIj50dW1ibHI8L2E+IGFuZCA8YSBocmVmPSJodHRwczovL3R3aXR0ZXIuY29tL29ydGVpbDQyIiB0YXJnZXQ9Il9ibGFuayI+dHdpdHRlcjwvYT4uJwogICAgICA6IGxvYygiVXNlZnVsIGxpbmtzOiAlMSwgJTIsICUzLCAlNC4iLCBbCiAgICAgICAgICAnPGEgaHJlZj0iaHR0cHM6Ly9kaXNjb3JkYXBwLmNvbS9pbnZpdGUvY29va2llIiB0YXJnZXQ9Il9ibGFuayIgY2xhc3M9ImhpZ2hsaWdodEhvdmVyIHNtYWxsQmxhY2tCdXR0b24iPkRpc2NvcmQ8L2E+JywKICAgICAgICAgICc8YSBocmVmPSJodHRwczovL2Nvb2tpZWNsaWNrZXIud2lraWEuY29tL3dpa2kvQ29va2llX0NsaWNrZXJfV2lraSIgdGFyZ2V0PSJfYmxhbmsiIGNsYXNzPSJoaWdobGlnaHRIb3ZlciBzbWFsbEJsYWNrQnV0dG9uIj53aWtpPC9hPicsCiAgICAgICAgICAnPGEgaHJlZj0iaHR0cHM6Ly9vcnRlaWw0Mi50dW1ibHIuY29tLyIgdGFyZ2V0PSJfYmxhbmsiIGNsYXNzPSJoaWdobGlnaHRIb3ZlciBzbWFsbEJsYWNrQnV0dG9uIj50dW1ibHI8L2E+JywKICAgICAgICAgICc8YSBocmVmPSJodHRwczovL3R3aXR0ZXIuY29tL29ydGVpbDQyIiB0YXJnZXQ9Il9ibGFuayIgY2xhc3M9ImhpZ2hsaWdodEhvdmVyIHNtYWxsQmxhY2tCdXR0b24iPnR3aXR0ZXI8L2E+JywKICAgICAgICBdKSkgKwogICAgIjwvZGl2PiIgKwogICAgKCFBcHAKICAgICAgPyAnPGRpdiBjbGFzcz0ibGlzdGluZyBibG9jayIgc3R5bGU9Im1hcmdpbjo4cHggMzJweDtmb250LXNpemU6MTFweDtsaW5lLWhlaWdodDoxMTAlO2NvbG9yOnJnYmEoMjAwLDIwMCwyNTUsMSk7YmFja2dyb3VuZDpyZ2JhKDEyOCwxMjgsMjU1LDAuMTUpOyIgaWQ9InN1cHBvcnRTZWN0aW9uIj4nICsKICAgICAgICBsb2MoCiAgICAgICAgICAiVGhpcyB2ZXJzaW9uIG9mIENvb2tpZSBDbGlja2VyIGlzIDEwMCUgZnJlZSwgZm9yZXZlci4gV2FudCB0byBzdXBwb3J0IHVzIHNvIHdlIGNhbiBrZWVwIGRldmVsb3BpbmcgZ2FtZXM/IEhlcmUncyBzb21lIHdheXMgeW91IGNhbiBoZWxwOiUxIiwKICAgICAgICAgIFsKICAgICAgICAgICAgKCFBcHAKICAgICAgICAgICAgICA/ICI8YnI+PGJyPiZidWxsOyAiICsKICAgICAgICAgICAgICAgIChFTiA/ICJnZXQgIiA6ICIiKSArCiAgICAgICAgICAgICAgICAnPGEgaHJlZj0iaHR0cHM6Ly9zdG9yZS5zdGVhbXBvd2VyZWQuY29tL2FwcC8xNDU0NDAwL0Nvb2tpZV9DbGlja2VyLyIgdGFyZ2V0PSJfYmxhbmsiIGNsYXNzPSJoaWdobGlnaHRIb3ZlciBzbWFsbFdoaXRlQnV0dG9uIj5Db29raWUgQ2xpY2tlciBvbiBTdGVhbTwvYT4nCiAgICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgICAgICIiICsKICAgICAgICAgICAgICAoRU4gPyAiIChpdCdzIGFib3V0IDUgYnVja3MpIiA6ICIiKSArCiAgICAgICAgICAgICAgIjxicj48YnI+JmJ1bGw7ICIgKwogICAgICAgICAgICAgIChFTiA/ICJzdXBwb3J0IHVzIG9uICIgOiAiIikgKwogICAgICAgICAgICAgICc8YSBocmVmPSJodHRwczovL3d3dy5wYXRyZW9uLmNvbS9kYXNobmV0IiB0YXJnZXQ9Il9ibGFuayIgY2xhc3M9ImhpZ2hsaWdodEhvdmVyIHNtYWxsT3JhbmdlQnV0dG9uIj5QYXRyZW9uPC9hPicgKwogICAgICAgICAgICAgIChFTiA/ICIgKHRoZXJlJ3MgcGVya3MhKSIgOiAiIikgKwogICAgICAgICAgICAgICI8YnI+PGJyPiZidWxsOyAiICsKICAgICAgICAgICAgICAoRU4gPyAiY2hlY2sgb3V0IG91ciAiIDogIiIpICsKICAgICAgICAgICAgICAnPGEgaHJlZj0iaHR0cDovL3d3dy5yZWRidWJibGUuY29tL3Blb3BsZS9kYXNobmV0IiB0YXJnZXQ9Il9ibGFuayIgY2xhc3M9ImhpZ2hsaWdodEhvdmVyIHNtYWxsV2hpdGVCdXR0b24iPlNob3A8L2E+JyArCiAgICAgICAgICAgICAgKEVOID8gIiB3aXRoIHJhZCBjb29raWUgc2hpcnRzLCBob29kaWVzIGFuZCBzdGlja2VycyIgOiAiIikgKwogICAgICAgICAgICAgICghQXBwICYmIEVOCiAgICAgICAgICAgICAgICA/ICI8YnI+PGJyPiZidWxsOyBkaXNhYmxlIHlvdXIgYWRibG9ja2VyIChpZiB5b3Ugd2FudCEpIgogICAgICAgICAgICAgICAgOiAiIiksCiAgICAgICAgICBdCiAgICAgICAgKSArCiAgICAgICAgIjwvZGl2PjwvZGl2PiIKICAgICAgOiAiIikgKwogICAgJzxkaXYgY2xhc3M9Imxpc3Rpbmcgd2FybmluZyI+JyArCiAgICBsb2MoCiAgICAgICJOb3RlOiBpZiB5b3UgZmluZCBhIG5ldyBidWcgYWZ0ZXIgYW4gdXBkYXRlIGFuZCB5b3UncmUgdXNpbmcgYSAzcmQtcGFydHkgYWRkLW9uLCBtYWtlIHN1cmUgaXQncyBub3QganVzdCB5b3VyIGFkZC1vbiBjYXVzaW5nIGl0ISIKICAgICkgKwogICAgIjwvZGl2PiIgKwogICAgKCFBcHAKICAgICAgPyAnPGRpdiBjbGFzcz0ibGlzdGluZyB3YXJuaW5nIj4nICsKICAgICAgICBsb2MoCiAgICAgICAgICAiV2FybmluZzogY2xlYXJpbmcgeW91ciBicm93c2VyIGNhY2hlIG9yIGNvb2tpZXMgPHNtYWxsPih3aGF0IGVsc2U/KTwvc21hbGw+IHdpbGwgcmVzdWx0IGluIHlvdXIgc2F2ZSBiZWluZyB3aXBlZC4gRXhwb3J0IHlvdXIgc2F2ZSBhbmQgYmFjayBpdCB1cCBmaXJzdCEiCiAgICAgICAgKSArCiAgICAgICAgIjwvZGl2PiIKICAgICAgOiAiIikgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24iPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4nICsKICAgIGxvYygiVmVyc2lvbiBoaXN0b3J5IikgKwogICAgIjwvZGl2PiI7CgogIGZvciAodmFyIGkgPSAwOyBpIDwgbG9jUGF0Y2hlcy5sZW5ndGg7IGkrKykgewogICAgdmFyIHBhdGNoID0gbG9jUGF0Y2hlc1tpXTsKICAgIHZhciBwYXRjaFRleHQgPQogICAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUnICsKICAgICAgKHBhdGNoLnR5cGUgPT0gMiA/ICIgc21hbGwiIDogIiIpICsKICAgICAgJyI+JyArCiAgICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+JyArCiAgICAgIHBhdGNoLnRpdGxlICsKICAgICAgIjwvZGl2PiI7CiAgICBmb3IgKHZhciBpaSA9IDA7IGlpIDwgcGF0Y2gucG9pbnRzLmxlbmd0aDsgaWkrKykgewogICAgICBwYXRjaFRleHQgKz0gJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyAnICsgcGF0Y2gucG9pbnRzW2lpXSArICI8L2Rpdj4iOwogICAgfQogICAgR2FtZS51cGRhdGVMb2cgKz0gcGF0Y2hUZXh0OwogIH0KCiAgaWYgKCFFTikKICAgIEdhbWUudXBkYXRlTG9nICs9CiAgICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIiBzdHlsZT0iZm9udC13ZWlnaHQ6Ym9sZDtmb250LXN0eWxlOml0YWxpYztvcGFjaXR5OjAuNTsiPicgKwogICAgICBsb2MoIk5vdGU6IG9sZGVyIHVwZGF0ZSBub3RlcyBhcmUgaW4gRW5nbGlzaC4iKSArCiAgICAgICI8L2Rpdj4iOwoKICBHYW1lLnVwZGF0ZUxvZyArPQogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MzEvMDUvMjAyMiAtIGEgbWluZCBvZiBpdHMgb3duPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGEgbmV3IGJ1aWxkaW5nPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGEgbmV3IHRpZXIgb2YgdXBncmFkZXMgYW5kIGFjaGlldmVtZW50czwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBtdWx0aS1sYW5ndWFnZSBzdXBwb3J0IGFkZGVkIHRvIHdlYiB2ZXJzaW9uPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGEgZmV3IG5ldyBoZWF2ZW5seSB1cGdyYWRlczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCB0aGUganVrZWJveDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB0aGUgMyBzZWNyZXQgaGVhdmVubHkgdXBncmFkZXMgbm93IHJlbHkgb24gaG93IG1hbnkgdGltZXMgdGhlIHJlbGV2YW50IGRpZ2l0IGlzIHByZXNlbnQgaW4gdG90YWwsIHJhdGhlciB0aGFuIGF0IHRoZSBlbmQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYmFja2dyb3VuZHMgb3ZlcmhhdWxlZDsgZXh0cmEgb3B0aW9ucyBmb3IgdGhlIGJhY2tncm91bmQgc2VsZWN0b3I8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgZXh0cmEgb3B0aW9ucyBmb3IgdGhlIGdvbGRlbiBjb29raWUgc291bmQgc2VsZWN0b3I8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgdGhlIGJhbmsgbWluaWdhbWUgbm93IHRlbGxzIHlvdSB0aGUgdmFsdWUgeW91IHByZXZpb3VzbHkgYm91Z2h0IGEgc3RvY2sgYXQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgdGhlIGJhbmsgbWluaWdhbWUgZmxvdyBpcyBhIGxpdHRsZSBtb3JlIGV4Y2l0aW5nPC9kaXY+JyArCiAgICAoQXBwCiAgICAgID8gJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBuZXcgb3B0aW9uIHRvIGRpc2FibGUgeW91ciBnYW1lIGFjdGl2aXR5IHNob3dpbmcgdXAgaW4gRGlzY29yZDwvZGl2PicKICAgICAgOiAiIikgKwogICAgKEFwcAogICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbGF1bmNoIGVycm9ycyBub3cgcHJvdmlkZSB0aGUgb3B0aW9uIHRvIHJlc3RhcnQgd2l0aG91dCBtb2RzPC9kaXY+JwogICAgICA6ICIiKSArCiAgICAoQXBwCiAgICAgID8gJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIHNtYWxsIj4nICsKICAgICAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjE4LzEyLzIwMjEgLSB3b3JrIGl0PC9kaXY+JyArCiAgICAgICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBTdGVhbSBXb3Jrc2hvcCBzdXBwb3J0IChsZXRzIHlvdSBpbnN0YWxsIG1vZHMgYW5kIHVwbG9hZCB5b3VyIG93bik8L2Rpdj4nICsKICAgICAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIEtvcmVhbiBsYW5ndWFnZSBzdXBwb3J0PC9kaXY+JyArCiAgICAgICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBiYWNrICJzaG9ydCBudW1iZXJzIiBvcHRpb24gZm9yIG5vbi1lbmdsaXNoIGxhbmd1YWdlcyAodXNlcyBlbmdsaXNoIHRlcm1zIGZvciB0aGUgdGltZSBiZWluZyk8L2Rpdj4nICsKICAgICAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIHRvb2x0aXBzIG9uIGFjaGlldmVtZW50IG5vdGlmaWNhdGlvbnM8L2Rpdj4nICsKICAgICAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIERpc2NvcmQgcmljaCBwcmVzZW5jZSBzdXBwb3J0PC9kaXY+JwogICAgICA6ICIiKSArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4wMS8wOS8yMDIxIC0gZ2l2ZSBtZSBTdGVhbTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBDb29raWUgQ2xpY2tlciBoYXMgYmVlbiA8YSBocmVmPSJodHRwczovL3N0b3JlLnN0ZWFtcG93ZXJlZC5jb20vYXBwLzE0NTQ0MDAvQ29va2llX0NsaWNrZXIvIiB0YXJnZXQ9Il9ibGFuayI+cmVsZWFzZWQgb24gU3RlYW08L2E+IHdpdGggbXVzaWMgYnkgQzQxOCE8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgd2ViIHZlcnNpb24gYW5kIFN0ZWFtIHZlcnNpb24gd2lsbCByZWNlaXZlIHRoZSBzYW1lIHVwZGF0ZXMgZnJvbSBub3cgb248L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgeW91IGNhbiBub3cgcGxheSBpbiAxMyBkaWZmZXJlbnQgbGFuZ3VhZ2VzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IG5ldyBvcHRpb24gdG8gZGlzYWJsZSBzY2FyeSBzdHVmZjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBiYXNpYyBzY3JlZW4tcmVhZGVyIHN1cHBvcnQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgdmFyaW91cyBvdGhlciBpbXByb3ZlbWVudHM8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjAxLzExLzIwMjAgLSBhbHRlcm5hdGUgcmVhbGl0eTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBuZXcgYnVpbGRpbmc8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbmV3IHVwZ3JhZGUgdGllcjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBuZXcgYWNoaWV2ZW1lbnQgdGllcjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBuZXcgaGVhdmVubHkgdXBncmFkZXM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbmV3IG1vZGRpbmcgQVBJPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IG5ldyByZWJhbGFuY2luZyAoYXNjZW5zaW9uIHNsb3QgcHJpY2VzLCBmaW5nZXIgdXBncmFkZXMuLi4pPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IG5ldyBmaXhlcyAobGVhcCB5ZWFycywgZ2hvc3Qgc3dhcHMsIGNhcnJ5b3ZlciBzZWVkcy4uLik8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbmV3IHN0dWZmPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4yMy8wOC8yMDIwIC0gbW9uZXkgbWUsIG1vbmV5IG5vdzwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBmaW5hbGl6ZWQgc3RvY2sgbWFya2V0IG1pbmlnYW1lIGJldGEgYW5kIGFkZGVkIGl0IHRvIGxpdmUgdmVyc2lvbjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBkYXJrIG1vZGUgYWRkZWQgdG8gc3RvY2sgbWFya2V0IG1pbmlnYW1lPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGNhbiBubyBsb25nZXIgc2VsZWN0IGEgbWlsayBiZWZvcmUgdW5sb2NraW5nIGl0OyBtaWxrIHNlbGVjdG9yIGxheW91dCBoYXMgYmVlbiBpbXByb3ZlZDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBzdG9jayBtYXJrZXQgZ29vZHMgaGF2ZSBoaWdoZXIgdmFsdWUgY2FwcyBhbmQgYSBsYXJnZXIgc3ByZWFkOyBjYW4gYWxzbyBzaGlmdC1jbGljayB0aGUgaGlkZSBidXR0b25zIHRvIGhpZGUvc2hvdyBhbGwgb3RoZXIgc3RvY2tzPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4wOC8wOC8yMDIwIC0gY2hlY2tpbmcgYWNjb3VudCAoYmV0YSk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgc3RvY2sgbWFya2V0IGxheW91dCBoYXMgYmVlbiByZXZpc2VkPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHNlbGxpbmcgc3RvY2tzIG5vIGxvbmdlciBpbmNyZWFzZXMgY29va2llcyBiYWtlZCBhbGwgdGltZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBzdG9jayBwcmljZXMgYXJlIG5vdyBkZWZpbmVkIGJ5IHlvdXIgaGlnaGVzdCByYXcgQ3BTIHRoaXMgYXNjZW5zaW9uICh3aGljaCBpcyBub3cgZGlzcGxheWVkIGluIHRoZSBzdGF0cyBzY3JlZW4pPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGNhbiBubyBsb25nZXIgYnV5IGFuZCBzZWxsIGEgc3RvY2sgaW4gdGhlIHNhbWUgdGljazwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB3YXJlaG91c2Ugc3BhY2Ugbm93IGdhaW5zICsxMCBwZXIgYXNzb2NpYXRlZCBidWlsZGluZyBsZXZlbCAodXAgZnJvbSArNSk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYmFuayBsZXZlbCBub3cgaW1wcm92ZXMgYXZlcmFnZSAoYW5kIG1heGltdW0pIHN0b2NrIHZhbHVlczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBsYXRlciBzdG9ja3MgYXJlIHdvcnRoIG1vcmU8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgQ29va2llIENsaWNrZXIgdHVybnMgNyE8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjE4LzA2LzIwMjAgLSBtYWtpbmcgYmFuayAoYmV0YSk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgdGhlIHN0b2NrIG1hcmtldCBtaW5pZ2FtZSwgYWNjZXNzaWJsZSB3aXRoIGxldmVsIDEgYmFua3Mgb3IgYWJvdmU7IGJ1eSBsb3csIHNlbGwgaGlnaCE8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgKG1pbmlnYW1lIHN1YmplY3QgdG8gaGVhdnkgcmViYWxhbmNpbmcgb3ZlciB0aGUgY29taW5nIHBhdGNoZXMpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGEgY291cGxlIGhlYXZlbmx5IHVwZ3JhZGVzLCBpbmNsdWRpbmcgb25lIHRoYXQgbGV0cyB5b3UgcGV0IHlvdXIgZHJhZ29uPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGEgbmV3IHRpZXIgb2YgYnVpbGRpbmcgdXBncmFkZXMgYW5kIGFjaGlldmVtZW50czwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyByZWluZGVlciBjbGlja3Mgbm93IHByb3Blcmx5IGNvdW50IGZvciBzaGltbWVyaW5nIHZlaWw8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbnVtYmVycyBpbiBzY2llbnRpZmljIG5vdGF0aW9uIHNob3VsZCBkaXNwbGF5IGJldHRlciB3aXRoIFNob3J0IG51bWJlcnMgb2ZmPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHJlcGxhY2VkIOODhCBpbiB0aGUgamF2YXNjcmlwdCBjb25zb2xlIGJ1aWxkaW5nIGRpc3BsYXkgd2l0aCBtb3JlIGFjY3VyYXRlIOODgzwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MjgvMDkvMjAxOSAtIGdvaW5nIG9mZi1zY3JpcHQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgYSBuZXcgYnVpbGRpbmc8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgZm9ydHVuZSBjb29raWVzIChhIG5ldyBoZWF2ZW5seSB1cGdyYWRlKTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBtb3JlIHVwZ3JhZGVzLCBhY2hpZXZlbWVudHMgZXRjPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHVwZGF0ZWQgdGhlIFJ1c3NpYW4gYnJlYWQgY29va2llcyBpY29uIHRvIGJldHRlciByZWZsZWN0IHRoZWlyIGN5cmlsbGljIG9yaWdpbnM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgPGkgc3R5bGU9ImZvbnQtc3R5bGU6aXRhbGljOyI+c3RlYWx0aCB1cGRhdGUgOjwvaT4gdGhlIHN1Z2FyIGx1bXAgcmVmaWxsIHRpbWVvdXQgKG5vdCBzdWdhciBsdW1wIGdyb3d0aCkgbm93IG5vIGxvbmdlciB0aWNrcyBkb3duIHdoaWxlIHRoZSBnYW1lIGlzIGNsb3NlZCAodGhpcyBmaXhlcyBhbiBleHBsb2l0KTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhbHNvIHJlbGVhc2VkIHRoZSBvZmZpY2lhbCBBbmRyb2lkIHZlcnNpb24gb2YgQ29va2llIENsaWNrZXIsIHBsYXlhYmxlIDxhIGhyZWY9Imh0dHBzOi8vcGxheS5nb29nbGUuY29tL3N0b3JlL2FwcHMvZGV0YWlscz9pZD1vcmcuZGFzaG5ldC5jb29raWVjbGlja2VyIiB0YXJnZXQ9Il9ibGFuayI+aGVyZTwvYT4gKGlPUyB2ZXJzaW9uIHdpbGwgY29tZSBsYXRlcik8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSBzbWFsbCI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjAxLzA0LzIwMTkgLSAyLjAxOSAodGhlICJ0aGlzIHllYXIiIHVwZGF0ZSk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgZ2FtZSBoYXMgYmVlbiByZW5hbWVkIHRvICJDb29raWUgQ2xpY2tlciIgdG8gYXZvaWQgY29uZnVzaW9uPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGNhbiBub3cgY2xpY2sgdGhlIGJpZyBjb29raWUgdG8gZ2VuZXJhdGUgY29va2llcyBmb3IgZnJlZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyByZW1vdmVkIGZhbGwgZGFtYWdlPC9kaXY+JyArCiAgICAvLyc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgZml4ZWQgdmFyaW91cyB0eXBvcyA6IHBsYXllclwncyBuYW1lIGlzIG5vdyBjb3JyZWN0bHkgc3BlbGxlZCBhcyAiW2Jha2VyeU5hbWVdIjwvZGl2PicrCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHJlbW92ZWQgYWxsIHJlZmVyZW5jZXMgdG8gY29tcHV0ZXItYW5pbWF0ZWQgbW92aWUgPGkgc3R5bGU9ImZvbnQtc3R5bGU6aXRhbGljOyI+SG9vZHdpbmtlZCE8L2k+ICgyMDA1KTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB3ZW50IGJhY2sgaW4gdGltZSBhbmQgaW52ZW50ZWQgY29va2llcyBhbmQgY29tcHV0ZXIgbWljZSwgZW5zdXJpbmcgQ29va2llIENsaWNrZXIgd291bGQgb25lIGRheSBjb21lIHRvIGV4aXN0PC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGdhbWUgbm93IGZ1bGx5IGNvbXBsaWFudCB3aXRoIEdlbmV2YSBDb252ZW50aW9uczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBkcm9wcGVkIHN1cHBvcnQgZm9yIFRJLTg0IHZlcnNpb248L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgcmVsZWFzZWQgYSBsb3ctcmVzIHJldHJvIHZlcnNpb24gb2YgdGhlIGdhbWUsIHBsYXlhYmxlIGhlcmUgOiA8YSBocmVmPSIvL29ydGVpbC5kYXNobmV0Lm9yZy9leHBlcmltZW50cy9jb29raWUvIiB0YXJnZXQ9Il9ibGFuayI+b3J0ZWlsLmRhc2huZXQub3JnL2V4cGVyaW1lbnRzL2Nvb2tpZTwvYT48L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgdXBkYXRlZCB2ZXJzaW9uIG51bWJlcjwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIHNtYWxsIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MDUvMDMvMjAxOSAtIGNvb2tpZXMgZm9yIGRheXM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgb3ZlciAyMCBuZXcgY29va2llcywgYWxsIHByZXZpb3VzbHkgc3VnZ2VzdGVkIGJ5IG91ciBzdXBwb3J0ZXJzIG9uIDxhIGhyZWY9Imh0dHBzOi8vd3d3LnBhdHJlb24uY29tL2Rhc2huZXQiIHRhcmdldD0iX2JsYW5rIj5QYXRyZW9uPC9hPjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCAyIGhlYXZlbmx5IHVwZ3JhZGVzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHRoZSBHb2xkZW4gZ29vc2UgZWdnIG5vdyBjb3VudHMgYXMgYSBnb2xkZW4gY29va2llIHVwZ3JhZGUgZm9yIFJlc2lkdWFsIGx1Y2sgcHVycG9zZXM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgZ29sZGVuIHN1Z2FyIGx1bXBzIG5vdyBlaXRoZXIgZG91YmxlIHlvdXIgY29va2llcywgb3IgZ2l2ZSB5b3UgMjQgaG91cnMgb2YgeW91ciBDcFMsIHdoaWNoZXZlciBpcyBsb3dlc3QgKHByZXZpb3VzbHkgd2FzIGRvdWJsaW5nIGNvb2tpZXMgd2l0aCBubyBjYXApPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHRoZSBhbW91bnQgb2YgaGVyYWxkcyBpcyBub3cgc2F2ZWQgd2l0aCB5b3VyIGdhbWUsIGFuZCBpcyB1c2VkIHRvIGNvbXB1dGUgb2ZmbGluZSBDcFMgdGhlIG5leHQgdGltZSB0aGUgZ2FtZSBpcyBsb2FkZWQ7IHByZXZpb3VzbHksIG9uIHBhZ2UgbG9hZCwgdGhlIG9mZmxpbmUgY2FsY3VsYXRpb24gYXNzdW1lZCBoZXJhbGRzIHRvIGJlIDA8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgYSBzeXN0ZW0gdG8gY291bnRlcmFjdCB0aGUgZ2FtZSBmcmVlemluZyB1cCAoYW5kIG5vdCBiYWtpbmcgY29va2llcykgYWZ0ZXIgYmVpbmcgaW5hY3RpdmUgZm9yIGEgbG9uZyB3aGlsZSBvbiBzbG93ZXIgY29tcHV0ZXJzOyBpbnN0ZWFkLCB0aGlzIHdpbGwgbm93IHRyaWdnZXIgc2xlZXAgbW9kZSwgZHVyaW5nIHdoaWNoIHlvdSBzdGlsbCBwcm9kdWNlIGNvb2tpZXMgYXMgaWYgdGhlIGdhbWUgd2FzIGNsb3NlZDsgdG8gZW5hYmxlIHRoaXMgZmVhdHVyZSwgdXNlIHRoZSAiU2xlZXAgbW9kZSB0aW1lb3V0IiBvcHRpb24gaW4gdGhlIHNldHRpbmdzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHZhdWx0aW5nIHVwZ3JhZGVzIGlzIG5vdyBkb25lIHdpdGggc2hpZnQtY2xpY2ssIGFzIGN0cmwtY2xpY2sgd2FzIHBvc2luZyBpc3N1ZXMgZm9yIE1hYyBicm93c2VyczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBtYWRlIHRvb2x0aXBzIGZvciBidWlsZGluZyBDcFMgYm9vc3RzIGZyb20gc3luZXJnaWVzIGhvcGVmdWxseSBjbGVhcmVyPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGZpeGVkIGFuIGV4cGxvaXQgd2l0aCBnYW1ibGVyXCdzIGZldmVyIGRyZWFtIHdvcmtpbmcgYWNyb3NzIGV4cG9ydHMgYW5kIGFzY2Vuc2lvbnM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgY2FuIG5vdyBoaWRlIHRvb2x0aXBzIGluIHRoZSBnYXJkZW4gYnkga2VlcGluZyB0aGUgc2hpZnQga2V5IHByZXNzZWQgdG8gbWFrZSBpdCBlYXNpZXIgdG8gc2VlIHdoZXJlIHlvdVwncmUgcGxhbnRpbmc8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgZml4ZWQgYSBidWcgd2l0aCBnb2xkZW4gY29va2llcy9yZWluZGVlciBub3QgZGlzYXBwZWFyaW5nIHByb3Blcmx5IGluIHNvbWUgY2lyY3Vtc3RhbmNlczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB0aGUgRHJhZ29uXCdzIEN1cnZlIGF1cmEgc2hvdWxkIG5vdyBwcm9wZXJseSBtYWtlIHN1Z2FyIGx1bXBzIHR3aWNlIGFzIHdlaXJkPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHRoZSBjdHJsIGtleSBzaG91bGQgbGVzcyBvZnRlbiByZWdpc3RlciBpbmNvcnJlY3RseSBhcyBwcmVzc2VkPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGEgbmV3IGFkIHNsb3QgaW4gdGhlIHRvcC1yaWdodCwgYXMgd2hpbGUgb3VyIHBsYXllcmJhc2UgaXMgc3Ryb25nIGFuZCBzdXBwb3J0aXZlIGFzIGV2ZXIsIG91ciBhZCByZXZlbnVlIHNvbWV0aW1lcyBmbHVjdHVhdGVzIGJhZGx5OyB3ZSBtYXkgcmVtb3ZlIHRoZSBhZCBhZ2FpbiBzaG91bGQgb3VyIGluY29tZSBzdGFiaWxpemU8L2Rpdj4nICsKICAgICI8ZGl2IGNsYXNzPVwibGlzdGluZ1wiPiZidWxsOyBtYWRlIGEgZmV3IGFkanVzdG1lbnRzIHRvIG1ha2UgdGhlIGdhbWUgc29tZXdoYXQgcGxheWFibGUgaW4gbW9iaWxlIGJyb3dzZXJzOyBpdCdzIG5vdCBwZXJmZWN0IGFuZCBjYW4gZ2V0IGJ1Z2d5LCBidXQgaXQncyBmdW5jdGlvbmFsISAoeW91IG1heSBuZWVkIHRvIHpvb20gb3V0IG9yIHNjcm9sbCBhcm91bmQgdG8gdmlldyB0aGUgZ2FtZSBwcm9wZXJseSk8L2Rpdj4iICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgc3BlYWtpbmcgb2Ygd2hpY2gsIHdlIGFsc28gZ290IHNvbWUgZ29vZCBwcm9ncmVzcyBvbiB0aGUgbW9iaWxlIGFwcCB2ZXJzaW9uIChidWlsdCBmcm9tIHNjcmF0Y2ggZm9yIG1vYmlsZSksIHNvIHN0YXkgdHVuZWQhPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4yNS8xMC8yMDE4IC0gZmVlZGJhY2sgbG9vcDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBhIG5ldyBidWlsZGluZzwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBsYXVuY2hlZCBvdXIgPGEgaHJlZj0iaHR0cHM6Ly93d3cucGF0cmVvbi5jb20vZGFzaG5ldCIgY2xhc3M9Im9yYW5nZUxpbmsiIHRhcmdldD0iX2JsYW5rIj5QYXRyZW9uPC9hPiA8c3BhbiBzdHlsZT0iZm9udC1zaXplOjgwJTsiPih0aGUgbGluayBpcyBvcmFuZ2Ugc28geW91XCdsbCBub3RpY2UgaXQhKTwvc3Bhbj48L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgYSBidW5jaCBvZiBuZXcgaGVhdmVubHkgdXBncmFkZXMsIG9uZSBvZiB3aGljaCB0aWVzIGludG8gb3VyIFBhdHJlb24gYnV0IGJlbmVmaXRzIGV2ZXJ5b25lICh0aGlzIGlzIHN0aWxsIGV4cGVyaW1lbnRhbCEpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHdoZW4gaG92ZXJpbmcgb3ZlciBncmFuZG1hcywgeW91IGNhbiBub3cgc2VlIHRoZWlyIG5hbWVzIGFuZCBhZ2VzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7ICJtYWtlIFggY29va2llcyBqdXN0IGZyb20gWSIgcmVxdWlyZW1lbnRzIGFyZSBub3cgaGlnaGVyPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHR3ZWFrZWQgdGhlIHByaWNlcyBvZiBzb21lIGhlYXZlbmx5IHVwZ3JhZGVzIHRvIGJldHRlciBmaXQgdGhlIGN1cnJlbnQgY29va2llIGVjb25vbXkgKGl0IHR1cm5zIG91dCBiaWxsaW9ucyBvZiBoZWF2ZW5seSBjaGlwcyBpcyBub3cgdmVyeSBhY2hpZXZhYmxlKTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBidWlsZGluZyB0b29sdGlwcyBub3cgZGlzcGxheSB3aGF0ICUgb2YgQ3BTIHRoZXkgY29udHJpYnV0ZSB0aHJvdWdoIHN5bmVyZ3kgdXBncmFkZXM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgcXVlZW5iZWV0cyBub3cgZ2l2ZSB1cCB0byA0JSBvZiBiYW5rLCBkb3duIGZyb20gNiU8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYW1vbmcgb3RoZXIgdGhpbmdzLCBzZWFzb24gc3dpdGNoZXMgbm93IGRpc3BsYXkgaG93IG1hbnkgc2Vhc29uYWwgdXBncmFkZXMgeW91XCdyZSBtaXNzaW5nLCBhbmQgcGVybWFuZW50IHVwZ3JhZGUgc2xvdHMgbm93IGRpc3BsYXkgdGhlIG5hbWUgb2YgdGhlIHNsb3R0ZWQgdXBncmFkZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBzZWFzb24gc3dpdGNoZXMgaGF2ZSByZXdvcmtlZCBwcmljZXM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgc2Vhc29uIHN3aXRjaGVzIGNhbiBub3cgYmUgY2FuY2VsbGVkIGJ5IGNsaWNraW5nIHRoZW0gYWdhaW48L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgY2FuIG5vIGxvbmdlciBhY2NpZGVudGFsbHkgY2xpY2sgd3JpbmtsZXJzIHRocm91Z2ggb3RoZXIgZWxlbWVudHM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgc3VnYXIgZnJlbnp5IG5vdyB0cmlwbGVzIHlvdXIgQ3BTIGZvciBhbiBob3VyIGluc3RlYWQgb2YgZG91YmxpbmcgaXQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgdGhpcyB0ZXh0IGlzIG5vdyBzZWxlY3RhYmxlPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHByb2dyZXNzIG9uIGR1bmdlb25zIG1pbmlnYW1lIGlzIHN0aWxsIHZlcnkgbXVjaCBvbmdvaW5nPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4wOC8wOC8yMDE4IC0gaGV5IG5vdzwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBDb29raWUgQ2xpY2tlciBzb21laG93IHR1cm5zIDUsIGdvaW5nIGFnYWluc3QgZG9jdG9yc1wnIG1vc3Qgb3B0aW1pc3RpYyBlc3RpbWF0ZXM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgYSBuZXcgdGllciBvZiBidWlsZGluZyBhY2hpZXZlbWVudHMsIGFsbCBuYW1lZCBhZnRlciBTbWFzaCBNb3V0aFwncyBjbGFzc2ljIDE5OTkgaGl0ICJBbGwgU3RhciI8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgYSBuZXcgdGllciBvZiBidWlsZGluZyB1cGdyYWRlcywgYWxsIG5hbWVkIGFmdGVyIG5vdGhpbmcgaW4gcGFydGljdWxhcjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyA8Yj50byBvdXIgcGxheWVycyA6PC9iPiB0aGFuayB5b3Ugc28gbXVjaCBmb3Igc3RpY2tpbmcgd2l0aCB1cyBhbGwgdGhvc2UgeWVhcnMgYW5kIGFsbG93aW5nIHVzIHRvIGtlZXAgbWFraW5nIHRoZSBkdW1iZXN0IGdhbWUga25vd24gdG8gbWFua2luZDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyByZXN1bWVkIHdvcmsgb24gdGhlIGR1bmdlb25zIG1pbmlnYW1lPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4wMS8wOC8yMDE4IC0gYnV5IGJ1eSBidXk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgYSBoZWF2ZW5seSB1cGdyYWRlIHRoYXQgbGV0cyB5b3UgYnV5IGFsbCB5b3VyIHVwZ3JhZGVzIGluc3RhbnRseTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBhIGhlYXZlbmx5IHVwZ3JhZGUgdGhhdCBsZXRzIHlvdSBzZWUgdXBncmFkZSB0aWVycyAoZmVhdHVyZSB3YXMgcHJldmlvdXNseSByZW1vdmVkIGR1ZSB0byBiZWluZyBjb25mdXNpbmcpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGEgbmV3IHdyaW5rbGVyLXJlbGF0ZWQgaGVhdmVubHkgdXBncmFkZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBhIG5ldyB1cGdyYWRlIHRpZXI8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgYSBjb3VwbGUgbmV3IGNvb2tpZXMgYW5kIGFjaGlldmVtZW50czwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBuZXcgImV4dHJhIGJ1dHRvbnMiIHNldHRpbmc7IHR1cm5pbmcgaXQgb24gYWRkcyBidXR0b25zIHRoYXQgbGV0IHlvdSBtaW5pbWl6ZSBidWlsZGluZ3M8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbmV3ICJsdW1wIGNvbmZpcm1hdGlvbiIgc2V0dGluZzsgdHVybmluZyBpdCBvbiB3aWxsIHNob3cgYSBjb25maXJtYXRpb24gcHJvbXB0IHdoZW4geW91IHNwZW5kIHN1Z2FyIGx1bXBzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGJ1aWxkaW5ncyBub3cgc2VsbCBiYWNrIGZvciAyNSUgb2YgdGhlaXIgY3VycmVudCBwcmljZSAoZG93biBmcm9tIDUwJSk7IEVhcnRoIFNoYXR0ZXJlciBtb2RpZmllZCBhY2NvcmRpbmdseSwgbm93IGdpdmVzIGJhY2sgNTAlIChkb3duIGZyb20gODUlKTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBmYXJtIHNvaWxzIG5vdyB1bmxvY2sgY29ycmVjdGx5IGJhc2VkIG9uIGN1cnJlbnQgYW1vdW50IG9mIGZhcm1zPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGNoZWFwY2FwcyBoYXZlIGEgbmV3IGV4Y2l0aW5nIG5lcmY8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgd3JpbmtsZWdpbGwgc3Bhd25zIGEgYnVuY2ggbW9yZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBjYW4gbm93IGN0cmwtc2hpZnQtY2xpY2sgb24gIkhhcnZlc3QgYWxsIiB0byBvbmx5IGhhcnZlc3QgbWF0dXJlLCBub24taW1tb3J0YWwgcGxhbnRzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGEgbmV3IHJhcmUgdHlwZSBvZiBzdWdhciBsdW1wPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4yMC8wNC8yMDE4IC0gd2VlZGluZyBvdXQgc29tZSBidWdzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGdvbGRlbiBjbG92ZXJzIGFuZCB3cmlua2xlZ2lsbHMgc2hvdWxkIHNwYXduIGEgYml0IG1vcmUgb2Z0ZW48L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgY3JvbmVyaWNlIG1hdHVyZXMgYSBsb3Qgc29vbmVyPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IG1hdHVyZSBlbGRlcndvcnRzIHN0YXkgbWF0dXJlIGFmdGVyIHJlbG9hZGluZzwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBnYXJkZW4gaW50ZXJmYWNlIG9jY3VwaWVzIHNwYWNlIG1vcmUgaW50ZWxsaWdlbnRseTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBzZWVkIHByaWNlIGRpc3BsYXlzIHNob3VsZCBiZSBiZXR0ZXIgYmVoYXZlZCB3aXRoIHNob3J0IG51bWJlcnMgZGlzYWJsZWQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbWluaWdhbWUgYW5pbWF0aW9ucyBhcmUgbm93IHR1cm5lZCBvZmYgaWYgdXNpbmcgdGhlICJGYW5jeSBncmFwaGljcyIgb3B0aW9uIGlzIGRpc2FibGVkPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IENwUyBhY2hpZXZlbWVudCByZXF1aXJlbWVudHMgd2VyZSBkaWFsZWQgZG93biBhIHdlZSB0YWQ8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSBzbWFsbCI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjE5LzA0LzIwMTggLSBnYXJkZW4gcGF0Y2g8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgdXBncmFkZXMgZHJvcHBlZCBieSBnYXJkZW4gcGxhbnRzIG5vdyBzdGF5IHVubG9ja2VkIGZvcmV2ZXIgKGJ1dCBkcm9wIG11Y2ggbW9yZSByYXJlbHkpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGdhcmRlbiBzdWdhciBsdW1wIHJlZmlsbCBub3cgYWxzbyBtYWtlcyBwbGFudHMgc3ByZWFkIGFuZCBtdXRhdGUgMyB0aW1lcyBtb3JlIGR1cmluZyB0aGUgYm9udXMgdGljazwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhIGZldyBuZXcgdXBncmFkZXM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYSBjb3VwbGUgYnVnIGZpeGVzIGFuZCByZXBocmFzaW5nczwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MTgvMDQvMjAxOCAtIHlvdXIgZ2FyZGVuLXZhcmlldHkgdXBkYXRlPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIHRoZSBnYXJkZW4sIGEgbWluaWdhbWUgdW5sb2NrZWQgYnkgaGF2aW5nIGF0IGxlYXN0IGxldmVsIDEgZmFybXM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgYSBsaXR0bGUgYXJyb3cgYW5kIGEgYmxpbmt5IGxhYmVsIHRvIHNpZ25hbCB0aGUgZ2FtZSBoYXMgdXBkYXRlZCBzaW5jZSB5b3UgbGFzdCBwbGF5ZWQgaXQgKGhpISk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbmV3IGNvb2tpZXMsIG1pbGsgZmxhdm9ycyBhbmQgYWNoaWV2ZW1lbnRzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHN1Z2FyIGx1bXBzIGFyZSBub3cgdW5sb2NrZWQgd2hlbmV2ZXIgeW91XCd2ZSBiYWtlZCBhdCBsZWFzdCBhIGJpbGxpb24gY29va2llcywgaW5zdGVhZCBvZiBvbiB5b3VyIGZpcnN0IGFzY2Vuc2lvbjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBzdWdhciBsdW1wIHR5cGUgbm93IHNhdmVzIGNvcnJlY3RseTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBtaW5pZ2FtZSBzdWdhciBsdW1wIHJlZmlsbHMgY2FuIG5vdyBvbmx5IGJlIGRvbmUgZXZlcnkgMTUgbWludXRlcyAodGltZXIgc2hhcmVkIGFjcm9zcyBhbGwgbWluaWdhbWVzKTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBDcFMgYWNoaWV2ZW1lbnRzIG5vdyBoYXZlIHN0ZWVwZXIgcmVxdWlyZW1lbnRzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGdvbGRlbiBjb29raWVzIG5vdyBsYXN0IDUlIHNob3J0ZXIgZm9yIGV2ZXJ5IG90aGVyIGdvbGRlbiBjb29raWUgb24gdGhlIHNjcmVlbjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB0aGUgZ2FtZSBub3cgcmVtZW1iZXJzIHdoaWNoIG1pbmlnYW1lcyBhcmUgY2xvc2VkIG9yIG9wZW48L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgYSBwb3B1cCB0aGF0IHNob3dzIHdoZW4gYSBzZWFzb24gc3RhcnRzIChzbyBwZW9wbGUgd29uXCd0IGJlIHNvIGNvbmZ1c2VkIGFib3V0ICJ0aGUgZ2FtZSBsb29raW5nIHdlaXJkIHRvZGF5Iik8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgcGVybWFuZW50IHVwZ3JhZGUgc2xvdHMgbm93IHNob3cgYSB0b29sdGlwIGZvciB0aGUgc2VsZWN0ZWQgdXBncmFkZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBmaW5hbGx5IGZpeGVkIHRoZSBzYXZlIGNvcnJ1cHRpb24gYnVnLCBob3BlZnVsbHk8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSBzbWFsbCI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjI0LzAyLzIwMTggLSBzdWdhciBjb2F0aW5nPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGxpbmsgdG8gPGEgaHJlZj0iaHR0cHM6Ly9kaXNjb3JkYXBwLmNvbS9pbnZpdGUvY29va2llIiB0YXJnZXQ9Il9ibGFuayI+b2ZmaWNpYWwgRGlzY29yZCBzZXJ2ZXI8L2E+PC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGZlbHQgd2VpcmQgYWJvdXQgcHVzaGluZyBhbiB1cGRhdGUgd2l0aG91dCBjb250ZW50IHNvIDo8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgYSBoYW5kZnVsIG9mIG5ldyBjb29raWVzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIDMgbmV3IGhlYXZlbmx5IHVwZ3JhZGVzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHNob3J0IG51bWJlcnMgc2hvdWxkIG5vdyBiZSBkaXNwbGF5ZWQgdXAgdG8gbm92ZW1ub25hZ2ludGlsbGlvbnM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgY29va2llIGNoYWlucyBubyBsb25nZXIgc3Bhd24gZnJvbSB0aGUgRm9yY2UgdGhlIEhhbmQgb2YgRmF0ZSBzcGVsbDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBiaWdnZXIsIGJldHRlciBDb29raWUgQ2xpY2tlciBjb250ZW50IGNvbWluZyBsYXRlciB0aGlzIHllYXI8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjA4LzA4LzIwMTcgLSA0IG1vcmUgeWVhcnM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbmV3IGJ1aWxkaW5nIDogQ2hhbmNlbWFrZXJzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IG5ldyBtaWxrLCBuZXcga2l0dGVucywgbmV3IGRyYWdvbiBhdXJhLCBuZXcgY29va2llLCBuZXcgdXBncmFkZSB0aWVyPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGJ1ZmZzIG5vIGxvbmdlciBhZmZlY3Qgb2ZmbGluZSBDcFM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgR29kemFtb2tcJ3MgaHVuZ2VyIHdhcyBtYWRlIGxlc3MgcG90ZW50ICh0aGlzIGlzIGEgbmVyZiwgdmVyeSBzb3JyeSk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgZ3JpbW9pcmUgc3BlbGwgY29zdHMgYW5kIG1heGltdW0gbWFnaWMgd29yayBkaWZmZXJlbnRseTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBTcG9udGFuZW91cyBFZGlmaWNlIGhhcyBiZWVuIHJld29ya2VkPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGNoYW5nZWQgdW5sb2NrIGxldmVscyBhbmQgcHJpY2VzIGZvciBzb21lIGN1cnNvciB1cGdyYWRlczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBmaXhlZCBidWdneSBwYW50aGVvbiBzbG90cywgaG9wZWZ1bGx5PC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGZpeGVkICJMZWdhY3kgc3RhcnRlZCBhIGxvbmcgd2hpbGUgYWdvIiBzaG93aW5nIGFzICJhIGZldyBzZWNvbmRzIGFnbyI8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgQ29va2llIENsaWNrZXIganVzdCB0dXJuZWQgNC4gVGhhbmsgeW91IGZvciBzdGlja2luZyB3aXRoIHVzIHRoaXMgbG9uZyE8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjE1LzA3LzIwMTcgLSB0aGUgc3Bpcml0dWFsIHVwZGF0ZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBpbXBsZW1lbnRlZCBzdWdhciBsdW1wcywgd2hpY2ggc3RhcnQgY29hbGVzY2luZyBpZiB5b3VcJ3ZlIGFzY2VuZGVkIGF0IGxlYXN0IG9uY2UgYW5kIGNhbiBiZSB1c2VkIGFzIGN1cnJlbmN5IGZvciBzcGVjaWFsIHRoaW5nczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBidWlsZGluZ3MgY2FuIG5vdyBsZXZlbCB1cCBieSB1c2luZyBzdWdhciBsdW1wcyBpbiB0aGUgbWFpbiBidWlsZGluZ3MgZGlzcGxheSwgcGVybWFuZW50bHkgYm9vc3RpbmcgdGhlaXIgQ3BTPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIHR3byBuZXcgZmVhdHVyZXMgdW5sb2NrZWQgYnkgbGV2ZWxsaW5nIHVwIHRoZWlyIGFzc29jaWF0ZWQgYnVpbGRpbmdzLCBUZW1wbGVzIGFuZCBXaXphcmQgdG93ZXJzOyBtb3JlIGJ1aWxkaW5nLXJlbGF0ZWQgbWluaWdhbWVzIHdpbGwgYmUgaW1wbGVtZW50ZWQgaW4gdGhlIGZ1dHVyZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhY3RpdmUgYnVmZnMgYXJlIG5vdyBzYXZlZDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB0aGUgYmFja2dyb3VuZCBzZWxlY3RvciB1cGdyYWRlIGlzIG5vdyBmdW5jdGlvbmFsPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHRoZSB0b3AgbWVudSBubyBsb25nZXIgc2Nyb2xscyB3aXRoIHRoZSByZXN0PC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHRpbWVzcGFucyBhcmUgd3JpdHRlbiBuaWNlcjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBEcmFnb25mbGlnaHRzIG5vdyB0ZW5kIHRvIHN1cGVyY2VkZSBDbGljayBmcmVuemllcywgeW91IHdpbGwgcmFyZWx5IGhhdmUgYm90aCBhdCB0aGUgc2FtZSB0aW1lPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHNvbWUgb2xkIGJ1Z3Mgd2VyZSBwaGFzZWQgb3V0IGFuZCByZXBsYWNlZCBieSBuZXcgb25lczwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIHNtYWxsIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MjQvMDcvMjAxNiAtIGdvbGRlbiBjb29raWVzIG92ZXJoYXVsPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGdvbGRlbiBjb29raWVzIGFuZCByZWluZGVlciBub3cgZm9sbG93IGEgbmV3IHN5c3RlbSBpbnZvbHZpbmcgZXhwbGljaXRseSBkZWZpbmVkIGJ1ZmZzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGEgYnVuY2ggb2YgbmV3IGdvbGRlbiBjb29raWUgZWZmZWN0cyBoYXZlIGJlZW4gYWRkZWQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgQ3BTIGdhaW5zIGZyb20gZWdncyBhcmUgbm93IG11bHRpcGxpY2F0aXZlPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHNoaW55IHdyaW5rbGVycyBhcmUgbm93IHNhdmVkPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHJlaW5kZWVyIGhhdmUgYmVlbiByZWJhbGFuY2VkIGV2ZXIgc28gc2xpZ2h0bHk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgYSBuZXcgY29va2llIHVwZ3JhZGUgbmVhciB0aGUgcm9vdCBvZiB0aGUgaGVhdmVubHkgdXBncmFkZSB0cmVlOyB0aGlzIGlzIGludGVuZGVkIHRvIGJvb3N0IGVhcmx5IGFzY2Vuc2lvbnMgYW5kIHNwZWVkIHVwIHRoZSBnYW1lIGFzIGEgd2hvbGU8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgZHVlIHRvIEVVIGxlZ2lzbGF0aW9uLCBpbXBsZW1lbnRlZCBhIHdhcm5pbmcgbWVzc2FnZSByZWdhcmRpbmcgYnJvd3NlciBjb29raWVzOyBkbyB1bmRlcnN0YW5kIHRoYXQgdGhlIGlyb255IGlzIG5vdCBsb3N0IG9uIHVzPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4wOC8wMi8yMDE2IC0gbGVnYWN5PC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGI+RXZlcnl0aGluZyB0aGF0IHdhcyBpbXBsZW1lbnRlZCBkdXJpbmcgdGhlIGFsbW9zdCAyLXllYXItbG9uZyBiZXRhIGhhcyBiZWVuIGFkZGVkIHRvIHRoZSBsaXZlIGdhbWUuIFRvIHJlY2FwIDo8L2I+PC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IDMgbmV3IGJ1aWxkaW5ncyA6IGJhbmtzLCB0ZW1wbGVzLCBhbmQgd2l6YXJkIHRvd2VyczsgdGhlc2UgaGF2ZSBiZWVuIGFkZGVkIGluLWJldHdlZW4gZXhpc3RpbmcgYnVpbGRpbmdzIGFuZCBhcyBzdWNoLCBtYXkgZGlzcnVwdCBzb21lIGJ1aWxkaW5nLXJlbGF0ZWQgYWNoaWV2ZW1lbnRzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHRoZSBhc2NlbnNpb24gc3lzdGVtIGhhcyBiZWVuIHJlZG9uZSBmcm9tIHNjcmF0Y2gsIHdpdGggYSBuZXcgaGVhdmVubHkgdXBncmFkZSB0cmVlPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IG15c3RlcmlvdXMgbmV3IGZlYXR1cmVzIHN1Y2ggYXMgYW5nZWwtcG93ZXJlZCBvZmZsaW5lIHByb2dyZXNzaW9uLCBjaGFsbGVuZ2UgcnVucywgYW5kIGEgY29va2llIGRyYWdvbjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBzb3VuZHMgaGF2ZSBiZWVuIGFkZGVkIChjYW4gYmUgZGlzYWJsZWQgaW4gdGhlIG9wdGlvbnMpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGhlYXBzIG9mIHJlYmFsYW5jaW5nIGFuZCBidWcgZml4ZXM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYSBjb3VwbGUgbW9yZSB1cGdyYWRlcyBhbmQgYWNoaWV2ZW1lbnRzLCBwcm9iYWJseTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBmcmVzaCBuZXcgb3B0aW9ucyB0byBmdXJ0aGVyIGN1c3RvbWl6ZSB5b3VyIGNvb2tpZS1jbGlja2luZyBleHBlcmllbmNlPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHF1YWxpdHktb2YtbGlmZSBpbXByb3ZlbWVudHMgOiBiZXR0ZXIgYnVsay1idXksIGJldHRlciBzd2l0Y2hlcyBldGM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgc29tZSA8YSBocmVmPSJodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpLycgKwogICAgY2hvb3NlKFsKICAgICAgIktyenlzenRvZl9BcmNpc3pld3NraSIsCiAgICAgICJFdXN0YWNoeV9TYW5ndXN6a28iLAogICAgICAiTWF1cnljeV9IYXVrZSIsCiAgICAgICJLYXJvbF9UdXJubyIsCiAgICAgICJUYWRldXN6X0t1dHJ6ZWJhIiwKICAgICAgIkthemltaWVyel9GYWJyeWN5IiwKICAgICAgIkZsb3JpYW5fU2l3aWNraSIsCiAgICBdKSArCiAgICAnIiB0YXJnZXQ9Il9ibGFuayI+Z2VuZXJhbCBwb2xpc2g8L2E+PC9kaXY+JyAvKiBpIGxpa2VkIHRoaXMgZHVtYiBwdW4gdG9vIG11Y2ggdG8gbGV0IGl0IGdvIHVubm90aWNlZCAqLyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHRvbnMgb2Ygb3RoZXIgbGl0dGxlIHRoaW5ncyB3ZSBjYW5cJ3QgZXZlbiByZW1lbWJlciByaWdodCBub3c8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj5NaXNzIHRoZSBvbGQgdmVyc2lvbj8gWW91ciBvbGQgc2F2ZSB3YXMgYXV0b21hdGljYWxseSBleHBvcnRlZCA8YSBocmVmPSIvL29ydGVpbC5kYXNobmV0Lm9yZy9jb29raWVjbGlja2VyL3YxMDQ2Ni8iIHRhcmdldD0iX2JsYW5rIj5oZXJlPC9hPiE8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSBzbWFsbCI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjA1LzAyLzIwMTYgLSBsZWdhY3kgYmV0YSwgbW9yZSBmaXhlczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBjaGFsbGVuZ2UgbW9kZXMsIHdoaWNoIGNhbiBiZSBzZWxlY3RlZCB3aGVuIGFzY2VuZGluZyAob25seSAxIGZvciBub3cgOiAiQm9ybiBhZ2FpbiIpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGNoYW5nZWQgdGhlIHdheSBidWxrLWJ1eWluZyBhbmQgYnVsay1zZWxsaW5nIHdvcmtzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IG1vcmUgYnVncyBpcm9uZWQgb3V0PC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4wMy8wMi8yMDE2IC0gbGVnYWN5IGJldGEsIHBhcnQgSUlJPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyB3YXJuaW5nIj4mYnVsbDsgTm90IGFsbCBidWdzIGhhdmUgYmVlbiBmaXhlZCwgYnV0IGV2ZXJ5dGhpbmcgc2hvdWxkIGJlIG11Y2ggbGVzcyBicm9rZW4uPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IEFkZGl0aW9ucycgKwogICAgJzxkaXYgc3R5bGU9Im9wYWNpdHk6MC44O21hcmdpbi1sZWZ0OjEycHg7Ij4nICsKICAgICItYSBmZXcgbW9yZSBhY2hpZXZlbWVudHM8YnI+IiArCiAgICAiLW5ldyBvcHRpb24gZm9yIG5lYXQsIGJ1dCBzbG93IENTUyBlZmZlY3RzIChkaXNhYmxlZCBieSBkZWZhdWx0KTxicj4iICsKICAgICItbmV3IG9wdGlvbiBmb3IgYSBsZXNzIGdyYXRpbmcgY29va2llIHNvdW5kIChlbmFibGVkIGJ5IGRlZmF1bHQpPGJyPiIgKwogICAgIi1uZXcgb3B0aW9uIHRvIGJyaW5nIGJhY2sgdGhlIGJveGVzIGFyb3VuZCBpY29ucyBpbiB0aGUgc3RhdHMgc2NyZWVuPGJyPiIgKwogICAgIi1uZXcgYnV0dG9ucyBmb3Igc2F2aW5nIGFuZCBsb2FkaW5nIHlvdXIgZ2FtZSB0byBhIHRleHQgZmlsZTxicj4iICsKICAgICI8L2Rpdj4iICsKICAgICI8L2Rpdj4iICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgQ2hhbmdlcycgKwogICAgJzxkaXYgc3R5bGU9Im9wYWNpdHk6MC44O21hcmdpbi1sZWZ0OjEycHg7Ij4nICsKICAgICItZWFybHkgZ2FtZSBzaG91bGQgYmUgYSBiaXQgZmFzdGVyIGFuZCB2ZXJ5IGxhdGUgZ2FtZSB3YXMga2luZGx5IGFza2VkIHRvIHRvbmUgaXQgZG93biBhIHRhZDxicj4iICsKICAgICItZHJhZ29uZmxpZ2h0IHNob3VsZCBiZSBzb21ld2hhdCBsZXNzIHJpZGljdWxvdXNseSBvdmVycG93ZXJlZDxicj4iICsKICAgICItcGxlYXNlIGxldCBtZSBrbm93IGlmIHRoZSByZWJhbGFuY2luZyB3YXMgdG9vIGhlYXZ5IG9yIG5vdCBoZWF2eSBlbm91Z2g8YnI+IiArCiAgICAiLXNhbnRhIGFuZCBlYXN0ZXIgdXBncmFkZXMgbm93IGRlcGVuZCBvbiBTYW50YSBsZXZlbCBhbmQgYW1vdW50IG9mIGVnZ3Mgb3duZWQsIHJlc3BlY3RpdmVseSwgaW5zdGVhZCBvZiBjb3N0aW5nIHNldmVyYWwgbWludXRlcyB3b3J0aCBvZiBDcFM8YnI+IiArCiAgICAiLWNvb2tpZSB1cGdyYWRlcyBub3cgc3RhY2sgbXVsdGlwbGljYXRpdmVseSByYXRoZXIgdGhhbiBhZGRpdGl2ZWx5PGJyPiIgKwogICAgIi1nb2xkZW4gc3dpdGNoIG5vdyBnaXZlcyArNTAlIENwUywgYW5kIHJlc2lkdWFsIGx1Y2sgaXMgKzEwJSBDcFMgcGVyIGdvbGRlbiBjb29raWUgdXBncmFkZSAodXAgZnJvbSArMjUlIGFuZCArMSUsIHJlc3BlY3RpdmVseSk8YnI+IiArCiAgICAiLWx1Y2t5IGNvb2tpZXMgYW5kIGNvb2tpZSBjaGFpbiBwYXlvdXRzIGhhdmUgYmVlbiBtb2RpZmllZCBhIGJpdCwgcG9zc2libHkgZm9yIHRoZSBiZXR0ZXIsIHdobyBrbm93cyE8YnI+IiArCiAgICAiLXdyaW5rbGVycyBoYWQgcHJldmlvdXNseSBiZWVuIHJlZHVjZWQgdG8gYSBtYXhpbXVtIG9mIDggKDEwIHdpdGggYSBoZWF2ZW5seSB1cGdyYWRlKSwgYnV0IGFyZSBub3cgYmFjayB0byAxMCAoMTIgd2l0aCB0aGUgdXBncmFkZSk8YnI+IiArCiAgICAvKictYWxsIGFuaW1hdGlvbnMgYXJlIG5vdyBoYW5kbGVkIGJ5IHJlcXVlc3RBbmltYXRpb25GcmFtZSgpLCB3aGljaCBzaG91bGQgaG9wZWZ1bGx5IGhlbHAgbWFrZSB0aGUgZ2FtZSBsZXNzIHJlc291cmNlLWludGVuc2l2ZTxicj4nKyovCiAgICAiLWFuIGFzY2Vuc2lvbiBub3cgb25seSBjb3VudHMgZm9yIGFjaGlldmVtZW50IHB1cnBvc2VzIGlmIHlvdSBlYXJuZWQgYXQgbGVhc3QgMSBwcmVzdGlnZSBsZXZlbCBmcm9tIGl0PGJyPiIgKwogICAgIi10aGUgZW1ibGVtYXRpYyBDb29raWUgQ2xpY2tlciBmb250IChLYXZvb24pIHdhcyBidWdnZWQgaW4gRmlyZWZveCwgYW5kIGhhcyBiZWVuIHJlcGxhY2VkIHdpdGggYSBuZXcgZm9udCAoTWVycml3ZWF0aGVyKTxicj4iICsKICAgICItdGhlIG15c3RlcmlvdXMgd3JpbmtseSBjcmVhdHVyZSBpcyBub3cgZXZlbiByYXJlciwgYnV0IGhhcyBhIHNoYWRvdyBhY2hpZXZlbWVudCB0aWVkIHRvIGl0PGJyPiIgKwogICAgIjwvZGl2PiIgKwogICAgIjwvZGl2PiIgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBGaXhlcycgKwogICAgJzxkaXYgc3R5bGU9Im9wYWNpdHk6MC44O21hcmdpbi1sZWZ0OjEycHg7Ij4nICsKICAgICItcHJlc3RpZ2Ugbm93IGdyYW50cyArMSUgQ3BTIHBlciBsZXZlbCBhcyBpbnRlbmRlZCwgaW5zdGVhZCBvZiArMTAwJTxicj4iICsKICAgICItaGVhdmVubHkgY2hpcHMgc2hvdWxkIG5vIGxvbmdlciBhZGQgdXAgbGlrZSBjcmF6eSB3aGVuIHlvdSBhc2NlbmQ8YnI+IiArCiAgICAiLXVwZ3JhZGVzIGluIHRoZSBzdG9yZSBzaG91bGQgbm8gbG9uZ2VyIHJhbmRvbWx5IGdvIHVuc29ydGVkPGJyPiIgKwogICAgIi13aW5kb3cgY2FuIGJlIHJlc2l6ZWQgdG8gYW55IHNpemUgYWdhaW48YnI+IiArCiAgICAnLXRoZSAiU3RhdHMiIGFuZCAiT3B0aW9ucyIgYnV0dG9ucyBoYXZlIGJlZW4gc3dhcHBlZCBhZ2Fpbjxicj4nICsKICAgICItdGhlIGdvbGRlbiBjb29raWUgc291bmQgc2hvdWxkIGJlIHNvbWV3aGF0IGNsZWFyZXI8YnI+IiArCiAgICAiLXRoZSBhc2NlbmQgc2NyZWVuIHNob3VsZCBiZSBsZXNzIENQVS1odW5ncnk8YnI+IiArCiAgICAiPC9kaXY+IiArCiAgICAiPC9kaXY+IiArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4yMC8xMi8yMDE1IC0gbGVnYWN5IGJldGEsIHBhcnQgSUk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIHdhcm5pbmciPiZidWxsOyBleGlzdGluZyBiZXRhIHNhdmVzIGhhdmUgYmVlbiB3aXBlZCBkdWUgdG8gZm9ybWF0IGluY29uc2lzdGVuY2llcyBhbmQganVzdCBwbGFpbiBicm9rZW4gYmFsYW5jZTsgeW91XCdsbCBoYXZlIHRvIHN0YXJ0IG92ZXIgZnJvbSBzY3JhdGNoIC0gd2hpY2ggd2lsbCBhbGxvdyB5b3UgdG8gZnVsbHkgZXhwZXJpZW5jZSB0aGUgdXBkYXRlIGFuZCBmaW5kIGFsbCB0aGUgYXdmdWwgbGl0dGxlIGJ1Z3MgdGhhdCBubyBkb3VidCBwbGFndWUgaXQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIHdhcm5pbmciPiZidWxsOyBpbXBvcnRpbmcgeW91ciBzYXZlIGZyb20gdGhlIGxpdmUgdmVyc2lvbiBpcyBhbHNvIGZpbmU8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgd2UgdG9vayBzbyBsb25nIHRvIG1ha2UgdGhpcyB1cGRhdGUsIENvb2tpZSBDbGlja2VyIHR1cm5lZCAyIHllYXJzIG9sZCBpbiB0aGUgbWVhbnRpbWUhIEh1cnJheSE8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgaGVhcHMgb2YgbmV3IHVwZ3JhZGVzIGFuZCBhY2hpZXZlbWVudHM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgZml4ZWQgYSB3aG9sZSBidW5jaCBvZiBidWdzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGRpZCBhIGxvdCBvZiByZWJhbGFuY2luZzwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyByZXdvcmtlZCBoZWF2ZW5seSBjaGlwcyBhbmQgaGVhdmVubHkgY29va2llcyAoc3RpbGwgZXhwZXJpbWVudGluZywgd2lsbCBwcm9iYWJseSByZWJhbGFuY2UgdGhpbmdzIGZ1cnRoZXIpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHlvdSBtYXkgbm93IHVubG9jayBhIGRyYWdvbiBmcmllbmQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgc3dpdGNoZXMgYW5kIHNlYXNvbiB0cmlnZ2VycyBub3cgaGF2ZSB0aGVpciBvd24gc3RvcmUgc2VjdGlvbjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBjdHJsLXMgYW5kIGN0cmwtbyBub3cgc2F2ZSB0aGUgZ2FtZSBhbmQgb3BlbiB0aGUgaW1wb3J0IG1lbnUsIHJlc3BlY3RpdmVseTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBzb21lIHF1aWNrIHNvdW5kcywganVzdCBhcyBhIHRlc3Q8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYSBjb3VwbGUgbW9yZSBvcHRpb25zPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGV2ZW4gbW9yZSBtaXNjZWxsYW5lb3VzIGNoYW5nZXMgYW5kIGFkZGl0aW9uczwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MjUvMDgvMjAxNCAtIGxlZ2FjeSBiZXRhLCBwYXJ0IEk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgMyBuZXcgYnVpbGRpbmdzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHByaWNlIGFuZCBDcFMgY3VydmVzIHJldmFtcGVkPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IENwUyBjYWxjdWxhdGlvbnMgcmV2YW1wZWQ7IGNvb2tpZSB1cGdyYWRlcyBub3cgc3RhY2sgbXVsdGlwbGljYXRpdmVseTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBwcmVzdGlnZSBzeXN0ZW0gcmVkb25lIGZyb20gc2NyYXRjaCwgd2l0aCBhIHdob2xlIG5ldyB1cGdyYWRlIHRyZWU8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgc29tZSA8YSBocmVmPSJodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpLycgKwogICAgY2hvb3NlKFsKICAgICAgIktyenlzenRvZl9BcmNpc3pld3NraSIsCiAgICAgICJFdXN0YWNoeV9TYW5ndXN6a28iLAogICAgICAiTWF1cnljeV9IYXVrZSIsCiAgICAgICJLYXJvbF9UdXJubyIsCiAgICAgICJUYWRldXN6X0t1dHJ6ZWJhIiwKICAgICAgIkthemltaWVyel9GYWJyeWN5IiwKICAgICAgIkZsb3JpYW5fU2l3aWNraSIsCiAgICBdKSArCiAgICAnIiB0YXJnZXQ9Il9ibGFuayI+Z2VuZXJhbCBwb2xpc2g8L2E+PC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHRvbnMgb2Ygb3RoZXIgbWlzY2VsbGFuZW91cyBmaXhlcyBhbmQgYWRkaXRpb25zPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IENvb2tpZSBDbGlja2VyIGlzIG5vdyAxIHllYXIgb2xkISAoVGhhbmsgeW91IGd1eXMgZm9yIGFsbCB0aGUgc3VwcG9ydCEpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyB3YXJuaW5nIj4mYnVsbDsgTm90ZSA6IHRoaXMgaXMgYSBiZXRhOyB5b3UgYXJlIGxpa2VseSB0byBlbmNvdW50ZXIgYnVncyBhbmQgb3ZlcnNpZ2h0cy4gRmVlbCBmcmVlIHRvIHNlbmQgbWUgZmVlZGJhY2sgaWYgeW91IGZpbmQgc29tZXRoaW5nIGZpc2h5ITwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIHNtYWxsIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MTgvMDUvMjAxNCAtIGJldHRlciBsYXRlIHRoYW4gZWFzdGVyPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGJ1bm5pZXMgYW5kIGVnZ3MsIHNvbWVob3c8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgcHJvbXB0cyBub3cgaGF2ZSBrZXlib2FyZCBzaG9ydGN1dHMgbGlrZSBzeXN0ZW0gcHJvbXB0cyB3b3VsZDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBuYW1pbmcgeW91ciBiYWtlcnk/IHlvdSBiZXRjaGE8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgIkZhc3Qgbm90ZXMiIG9wdGlvbiB0byBtYWtlIGFsbCBub3RpZmljYXRpb25zIGNsb3NlIGZhc3RlcjsgbmV3IGJ1dHRvbiB0byBjbG9zZSBhbGwgbm90aWZpY2F0aW9uczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB0aGUgZHVuZ2VvbnMgYmV0YSBpcyBub3cgYXZhaWxhYmxlIG9uIDxhIGhyZWY9Ii8vb3J0ZWlsLmRhc2huZXQub3JnL2Nvb2tpZWNsaWNrZXIvYmV0YWR1bmdlb25zIiB0YXJnZXQ9Il9ibGFuayI+L2JldGFkdW5nZW9uczwvYT48L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSBzbWFsbCI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjA5LzA0LzIwMTQgLSBuaWdodG1hcmUgaW4gaGVhdmVuPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGJyb2tlIGEgdGhpbmc7IGhlYXZlbmx5IGNoaXBzIHdlcmUgY29ycnVwdGVkIGZvciBzb21lIHBlb3BsZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB3aWxsIHByb2JhYmx5IHVwZGF0ZSB0byAvYmV0YSBmaXJzdCBpbiB0aGUgZnV0dXJlPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHNvcnJ5IGFnYWluPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4wOS8wNC8yMDE0IC0gcXVhbGl0eSBvZiBsaWZlPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IG5ldyB1cGdyYWRlIGFuZCBhY2hpZXZlbWVudCB0aWVyPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHBvcHVwcyBhbmQgcHJvbXB0cyBhcmUgbXVjaCBuaWNlcjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB0b29sdGlwcyBvbiBidWlsZGluZ3MgYXJlIG1vcmUgaW5mb3JtYXRpdmU8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgaW1wbGVtZW50ZWQgYSBzaW1wbGlmaWVkIHZlcnNpb24gb2YgdGhlIDxhIGhyZWY9Imh0dHBzOi8vZ2l0aHViLmNvbS9JY2VoYXdrNzgvRnJvemVuQ29va2llcyIgdGFyZ2V0PSJfYmxhbmsiPkZyb3plbiBDb29raWVzPC9hPiBhZGQtb25cJ3Mgc2hvcnQgbnVtYmVyIGZvcm1hdHRpbmc8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgeW91IGNhbiBub3cgYnV5IDEwIGFuZCBzZWxsIGFsbCBvZiBhIGJ1aWxkaW5nIGF0IGEgdGltZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB0b25zIG9mIG9wdGltaXphdGlvbnMgYW5kIHN1YnRsZXIgY2hhbmdlczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB5b3UgY2FuIG5vdyA8YSBocmVmPSIvL29ydGVpbC5kYXNobmV0Lm9yZy9jb29raWVzMmNhc2gvIiB0YXJnZXQ9Il9ibGFuayI+Y29udmVydCB5b3VyIGNvb2tpZXMgdG8gY2FzaDwvYT4hPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4wNS8wNC8yMDE0IC0gcGl0eSB0aGUgZm9vbDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB3cmlua2xlcnMgc2hvdWxkIG5vdyBiZSBzYXZlZCBzbyB5b3UgZG9uXCd0IGhhdmUgdG8gcG9wIHRoZW0gZXZlcnkgdGltZSB5b3UgcmVmcmVzaCB0aGUgZ2FtZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB5b3Ugbm93IHByb3Blcmx5IHdpbiAxIGNvb2tpZSB1cG9uIHJlYWNoaW5nIDEwIGJpbGxpb24gY29va2llcyBhbmQgbWFraW5nIGl0IG9uIHRoZSBsb2NhbCBuZXdzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IG1pc2NlbGxhbmVvdXMgZml4ZXMgYW5kIHRpbnkgYWRkaXRpb25zPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGEgZmV3IHZlcnkgcnVkaW1lbnRhcnkgbW9kIGhvb2tzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHRoZSBnYW1lIHNob3VsZCB3b3JrIGFnYWluIGluIE9wZXJhPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGRvblwndCBmb3JnZXQgdG8gY2hlY2sgb3V0IDxhIGhyZWY9Ii8vb3J0ZWlsLmRhc2huZXQub3JnL3JhbmRvbWdlbi8iIHRhcmdldD0iX2JsYW5rIj5SYW5kb21HZW48L2E+LCBvdXIgYWxsLXB1cnBvc2UgcmFuZG9tIGdlbmVyYXRvciBtYWtlciE8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSBzbWFsbCI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjAxLzA0LzIwMTQgLSBmb29saW5nIGFyb3VuZDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBpdFwncyBhYm91dCB0aW1lIDogQ29va2llIENsaWNrZXIgaGFzIHR1cm5lZCBpbnRvIHRoZSBtdWNoIG1vcmUgcmVhbGlzdGljIENvb2tpZSBCYWtlcjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBzZWFzb24gdHJpZ2dlcnMgYXJlIGNoZWFwZXIgYW5kIHByb3Blcmx5IHVubG9jayBhZ2FpbiB3aGVuIHRoZXkgcnVuIG91dDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBidWlsZGluZ3Mgc2hvdWxkIHByb3Blcmx5IHVubG9jayAocmVtaW5kZXIgOiBidWlsZGluZyB1bmxvY2tpbmcgaXMgY29tcGxldGVseSBjb3NtZXRpYyBhbmQgZG9lcyBub3QgY2hhbmdlIHRoZSBnYW1lcGxheSk8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSBzbWFsbCI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjE0LzAyLzIwMTQgLSBsb3ZlbHkgcmFpbmJvd2NhbHlwc2U8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbmV3IGJ1aWxkaW5nIChpdFwncyBiZWVuIGEgd2hpbGUpLiBNb3JlIHRvIGNvbWUhPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHlvdSBjYW4gbm93IHRyaWdnZXIgc2Vhc29uYWwgZXZlbnRzIHRvIHlvdXIgaGVhcnRcJ3MgY29udGVudCAodXBncmFkZSB1bmxvY2tzIGF0IDUwMDAgaGVhdmVubHkgY2hpcHMpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IG5ldyB1bHRyYS1leHBlbnNpdmUgYmF0Y2ggb2Ygc2Vhc29uYWwgY29va2llIHVwZ3JhZGVzIHlvdVwnbGwgbG92ZSB0byBoYXRlPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IG5ldyB0aW1lciBiYXJzIGZvciBnb2xkZW4gY29va2llIGJ1ZmZzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGJ1aWxkaW5ncyBhcmUgbm93IGhpZGRlbiB3aGVuIHlvdSBzdGFydCBvdXQgYW5kIGFwcGVhciBhcyB0aGV5IGJlY29tZSBhdmFpbGFibGU8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgdGVjaG5pY2FsIHN0dWZmIDogdGhlIGdhbWUgaXMgbm93IHNhdmVkIHRocm91Z2ggbG9jYWxzdG9yYWdlIGluc3RlYWQgb2YgYnJvd3NlciBjb29raWVzLCB0aGVyZWZvcmUgcnVpbmluZyBhIHBlcmZlY3RseSBnb29kIHB1bjwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIHNtYWxsIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MjIvMTIvMjAxMyAtIG1lcnJ5IGZpeG1hczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBzb21lIGlzc3VlcyB3aXRoIHRoZSBjaHJpc3RtYXMgdXBncmFkZXMgaGF2ZSBiZWVuIGZpeGVkPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHJlaW5kZWVyIGNvb2tpZSBkcm9wcyBhcmUgbm93IG1vcmUgY29tbW9uPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHJlaW5kZWVycyBhcmUgbm93IHJlaW5kZWVyPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4yMC8xMi8yMDEzIC0gQ2hyaXN0bWFzIGlzIGhlcmU8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgdGhlcmUgaXMgbm93IGEgZmVzdGl2ZSBuZXcgZXZvbHZpbmcgdXBncmFkZSBpbiBzdG9yZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyByZWluZGVlciBhcmUgcnVubmluZyBhbW9rIChjYXRjaCB0aGVtIGlmIHlvdSBjYW4hKTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBhIG5ldyBvcHRpb24gdG8gd2FybiB5b3Ugd2hlbiB5b3UgY2xvc2UgdGhlIHdpbmRvdywgc28geW91IGRvblwndCBsb3NlIHlvdXIgdW4tcG9wcGVkIHdyaW5rbGVyczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhbHNvIGFkZGVkIGEgc2VwYXJhdGUgb3B0aW9uIGZvciBkaXNwbGF5aW5nIGN1cnNvcnM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWxsIHRoZSBIYWxsb3dlZW4gZmVhdHVyZXMgYXJlIHN0aWxsIHRoZXJlIChhbmQgaGF2aW5nIHRoZSBTcG9va3kgY29va2llcyBhY2hpZXZlbWVudHMgbWFrZXMgdGhlIEhhbGxvd2VlbiBjb29raWVzIGRyb3AgbXVjaCBtb3JlIG9mdGVuKTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBvaCB5ZWFoLCB3ZSBub3cgaGF2ZSA8YSBocmVmPSJodHRwOi8vd3d3LnJlZGJ1YmJsZS5jb20vcGVvcGxlL2Rhc2huZXQiIHRhcmdldD0iX2JsYW5rIj5Db29raWUgQ2xpY2tlciBzaGlydHMsIHN0aWNrZXJzIGFuZCBob29kaWVzPC9hPiEgKHRoZXlcJ3JlIHJlYWxseSByYWQpPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4yOS8xMC8yMDEzIC0gc3Bvb2t5IHVwZGF0ZTwvZGl2PicgKwogICAgIjxkaXYgY2xhc3M9XCJsaXN0aW5nXCI+JmJ1bGw7IHRoZSBHcmFuZG1hcG9jYWx5cHNlIG5vdyBzcGF3bnMgd3JpbmtsZXJzLCBoaWRlb3VzIGVsZGVybHkgY3JlYXR1cmVzIHRoYXQgZGFtYWdlIHlvdXIgQ3BTIHdoZW4gdGhleSByZWFjaCB5b3VyIGJpZyBjb29raWUuIFRoYW5rZnVsbHksIHlvdSBjYW4gY2xpY2sgb24gdGhlbSB0byBtYWtlIHRoZW0gZXhwbG9kZSAoeW91J2xsIGV2ZW4gZ2FpbiBiYWNrIHRoZSBjb29raWVzIHRoZXkndmUgc3dhbGxvd2VkIC0gd2l0aCBpbnRlcmVzdCEpLjwvZGl2PiIgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB3cmF0aCBjb29raWUgbm93IDI3JSBzcG9va2llcjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBzb21lIG90aGVyIHN0dWZmPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHlvdSBzaG91bGQgdG90YWxseSBnbyBjaGVjayBvdXQgPGEgaHJlZj0iaHR0cDovL2NhbmR5Ym94Mi5uZXQvIiB0YXJnZXQ9Il9ibGFuayI+Q2FuZHkgQm94IDI8L2E+LCB0aGUgc2VxdWVsIHRvIHRoZSBnYW1lIHRoYXQgaW5zcGlyZWQgQ29va2llIENsaWNrZXI8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSBzbWFsbCI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjE1LzEwLzIwMTMgLSBpdFwncyBhIHNlY3JldDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBhIG5ldyBoZWF2ZW5seSB1cGdyYWRlIHRoYXQgZ2l2ZXMgeW91IDUlIG9mIHlvdXIgaGVhdmVubHkgY2hpcHMgcG93ZXIgZm9yIDExIGNvb2tpZXMgKGlmIHlvdSBwdXJjaGFzZWQgdGhlIEhlYXZlbmx5IGtleSwgeW91IG1pZ2h0IG5lZWQgdG8gYnV5IGl0IGFnYWluLCBzb3JyeSk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgZ29sZGVuIGNvb2tpZSBjaGFpbnMgc2hvdWxkIG5vdyB3b3JrIHByb3Blcmx5PC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4xNS8xMC8yMDEzIC0gcGxheWVyLWZyaWVuZGx5PC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGhlYXZlbmx5IHVwZ3JhZGVzIGFyZSBub3cgd2F5LCB3YXkgY2hlYXBlcjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB0aWVyIDUgYnVpbGRpbmcgdXBncmFkZXMgYXJlIDUgdGltZXMgY2hlYXBlcjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBjdXJzb3JzIG5vdyBqdXN0IHBsYWluIGRpc2FwcGVhciB3aXRoIEZhbmN5IEdyYXBoaWNzIG9mZiwgSSBtaWdodCBhZGQgYSBwcm9wZXIgb3B0aW9uIHRvIHRvZ2dsZSBvbmx5IHRoZSBjdXJzb3JzIGxhdGVyPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHdhcm5pbmcgOiB0aGUgQ29va2llIE1vbnN0ZXIgYWRkLW9uIHNlZW1zIHRvIGJlIGJ1Z2d5IHdpdGggdGhpcyB1cGRhdGUsIHlvdSBtaWdodCB3YW50IHRvIHdhaXQgdW50aWwgaXRzIHByb2dyYW1tZXIgdXBkYXRlcyBpdDwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIHNtYWxsIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MTUvMTAvMjAxMyAtIGEgY291cGxlIGZpeGVzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGdvbGRlbiBjb29raWVzIHNob3VsZCBubyBsb25nZXIgc3Bhd24gZW1iYXJyYXNzaW5nbHkgb2Z0ZW48L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgY3Vyc29ycyBub3cgc3RvcCBtb3ZpbmcgaWYgRmFuY3kgR3JhcGhpY3MgaXMgdHVybmVkIG9mZjwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIHNtYWxsIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MTQvMTAvMjAxMyAtIGdvaW5nIGZvciB0aGUgZ29sZDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBnb2xkZW4gY29va2llIGNoYWlucyB3b3JrIGEgYml0IGRpZmZlcmVudGx5PC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGdvbGRlbiBjb29raWUgc3Bhd25zIGFyZSBtb3JlIHJhbmRvbTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBDcFMgYWNoaWV2ZW1lbnRzIGFyZSBubyBsb25nZXIgYWZmZWN0ZWQgYnkgZ29sZGVuIGNvb2tpZSBmcmVuemllczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyByZXZpc2VkIGNvb2tpZS1iYWtpbmcgYWNoaWV2ZW1lbnQgcmVxdWlyZW1lbnRzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGhlYXZlbmx5IGNoaXBzIG5vdyByZXF1aXJlIHVwZ3JhZGVzIHRvIGZ1bmN0aW9uIGF0IGZ1bGwgY2FwYWNpdHk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgNCBtb3JlIGNvb2tpZSB1cGdyYWRlcywgdW5sb2NrZWQgYWZ0ZXIgcmVhY2hpbmcgY2VydGFpbiBhbW91bnRzIG9mIEhlYXZlbmx5IENoaXBzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHNwZWVkIGJha2luZyBhY2hpZXZlbWVudHMgbm93IHJlcXVpcmUgeW91IHRvIGhhdmUgbm8gaGVhdmVubHkgdXBncmFkZXM7IGFzIHN1Y2gsIHRoZXkgaGF2ZSBiZWVuIHJlc2V0IGZvciBldmVyeW9uZSAoYWxvbmcgd2l0aCB0aGUgSGFyZGNvcmUgYWNoaWV2ZW1lbnQpIHRvIGJldHRlciBtYXRjaCB0aGVpciBpbml0aWFsbHkgaW50ZW5kZWQgZGlmZmljdWx0eTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBtYWRlIGdvb2QgcHJvZ3Jlc3Mgb24gdGhlIG1vYmlsZSBwb3J0PC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4wMS8xMC8yMDEzIC0gc21vb3RoaW5nIGl0IG91dDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBzb21lIHZpc3VhbCBlZmZlY3RzIGhhdmUgYmVlbiBjb21wbGV0ZWx5IHJld3JpdHRlbiBhbmQgc2hvdWxkIG5vdyBydW4gbW9yZSBzbW9vdGhseSAoYW5kIGJlIGxlc3MgQ1BVLWludGVuc2l2ZSk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbmV3IHVwZ3JhZGUgdGllcjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBuZXcgbWlsayB0aWVyPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGNvb2tpZSBjaGFpbnMgaGF2ZSBkaWZmZXJlbnQgY2FwcGluZyBtZWNoYW5pY3M8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYW50aW1hdHRlciBjb25kZW5zZXJzIGFyZSBiYWNrIHRvIHRoZWlyIHByZXZpb3VzIHByaWNlPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGhlYXZlbmx5IGNoaXBzIG5vdyBnaXZlICsyJSBDcFMgYWdhaW4gKHRoZXkgd2lsbCBiZSBleHRlbnNpdmVseSByZXdvcmtlZCBpbiB0aGUgZnV0dXJlKTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBmYXJtcyBoYXZlIGJlZW4gYnVmZmVkIGEgYml0ICh0byBwb3B1bGFyIGRlbWFuZCk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgZHVuZ2VvbnMgc3RpbGwgbmVlZCBhIGJpdCBtb3JlIHdvcmsgYW5kIHdpbGwgYmUgcmVsZWFzZWQgc29vbiAtIHdlIHdhbnQgdGhlbSB0byBiZSBqdXN0IHJpZ2h0ISAoeW91IGNhbiB0ZXN0IGFuIHVuZmluaXNoZWQgdmVyc2lvbiBpbiA8YSBocmVmPSIvL29ydGVpbC5kYXNobmV0Lm9yZy9jb29raWVjbGlja2VyL2JldGFkdW5nZW9ucy8iIHRhcmdldD0iX2JsYW5rIj50aGUgYmV0YTwvYT4pPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4yOC8wOS8yMDEzIC0gZHVuZ2VvbiBiZXRhPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGZyb20gbm93IG9uLCBiaWcgdXBkYXRlcyB3aWxsIGNvbWUgdGhyb3VnaCBhIGJldGEgc3RhZ2UgZmlyc3QgKHlvdSBjYW4gPGEgaHJlZj0iLy9vcnRlaWwuZGFzaG5ldC5vcmcvY29va2llY2xpY2tlci9iZXRhZHVuZ2VvbnMvIiB0YXJnZXQ9Il9ibGFuayI+dHJ5IGl0IGhlcmU8L2E+KTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBmaXJzdCBkdW5nZW9ucyEgKHlvdSBuZWVkIDUwIGZhY3RvcmllcyB0byB1bmxvY2sgdGhlbSEpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGNvb2tpZSBjaGFpbnMgY2FuIGJlIGxvbmdlcjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhbnRpbWF0dGVyIGNvbmRlbnNlcnMgYXJlIGEgYml0IG1vcmUgZXhwZW5zaXZlPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGhlYXZlbmx5IGNoaXBzIG5vdyBvbmx5IGdpdmUgKzElIGNwcyBlYWNoICh0byBhY2NvdW50IGZvciBhbGwgdGhlIGNvb2tpZXMgbWFkZSBmcm9tIGNvbmRlbnNlcnMpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGZsYXZvciB0ZXh0IG9uIGFsbCB1cGdyYWRlczwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIHNtYWxsIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MTUvMDkvMjAxMyAtIGFudGljb29raWVzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHJhbiBvdXQgb2YgcmVndWxhciBtYXR0ZXIgdG8gbWFrZSB5b3VyIGNvb2tpZXM/IFRyeSBvdXIgbmV3IGFudGltYXR0ZXIgY29uZGVuc2VycyE8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgcmVuYW1lZCBIYXJkLXJlc2V0IHRvICJXaXBlIHNhdmUiIHRvIGF2b2lkIGNvbmZ1c2lvbjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyByZXNldCBhY2hpZXZlbWVudHMgYXJlIG5vdyByZWd1bGFyIGFjaGlldmVtZW50cyBhbmQgcmVxdWlyZSBjb29raWVzIGJha2VkIGFsbCB0aW1lLCBub3QgY29va2llcyBpbiBiYW5rPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGhlYXZlbmx5IGNoaXBzIGhhdmUgYmVlbiBuZXJmZWQgYSBiaXQgKGFuZCBhcmUgbm93IGF3YXJkZWQgZm9sbG93aW5nIGEgZ2VvbWV0cmljIHByb2dyZXNzaW9uIDogMSB0cmlsbGlvbiBmb3IgdGhlIGZpcnN0LCAyIGZvciB0aGUgc2Vjb25kLCBldGMpOyB0aGUgcHJlc3RpZ2Ugc3lzdGVtIHdpbGwgYmUgZXh0ZW5zaXZlbHkgcmV3b3JrZWQgaW4gYSBmdXR1cmUgdXBkYXRlIChhZnRlciBkdW5nZW9ucyk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgZ29sZGVuIGNvb2tpZSBjbGlja3MgYXJlIG5vIGxvbmdlciByZXNldCBieSBzb2Z0LXJlc2V0czwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB5b3UgY2FuIG5vdyBzZWUgaG93IGxvbmcgeW91XCd2ZSBiZWVuIHBsYXlpbmcgaW4gdGhlIHN0YXRzPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4wOC8wOS8yMDEzIC0gZXZlcmxhc3RpbmcgY29va2llczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBhIHByZXN0aWdlIHN5c3RlbSAtIHJlc2V0dGluZyBnaXZlcyB5b3UgcGVybWFuZW50IENwUyBib29zdHMgKHRoZSBtb3JlIGNvb2tpZXMgbWFkZSBiZWZvcmUgcmVzZXR0aW5nLCB0aGUgYmlnZ2VyIHRoZSBib29zdCEpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHNhdmUgZm9ybWF0IGhhcyBiZWVuIHNsaWdodGx5IG1vZGlmaWVkIHRvIHRha2UgbGVzcyBzcGFjZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBMZXByZWNoYXVuIGhhcyBiZWVuIGJ1bXBlZCB0byA3NzcgZ29sZGVuIGNvb2tpZXMgY2xpY2tlZCBhbmQgaXMgbm93IHNoYWRvdzsgRm9ydHVuZSBpcyB0aGUgbmV3IDc3IGdvbGRlbiBjb29raWVzIGFjaGlldmVtZW50PC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGNsaWNraW5nIGZyZW56eSBpcyBub3cgeDc3NzwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIHNtYWxsIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MDQvMDkvMjAxMyAtIHNtYXJ0ZXIgY29va2llPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGdvbGRlbiBjb29raWVzIG9ubHkgaGF2ZSAyMCUgY2hhbmNlIG9mIGdpdmluZyB0aGUgc2FtZSBvdXRjb21lIHR3aWNlIGluIGEgcm93IG5vdzwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBhIGdvbGRlbiBjb29raWUgdXBncmFkZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBhbiB1cGdyYWRlIHRoYXQgbWFrZXMgcGxlZGdlcyBsYXN0IHR3aWNlIGFzIGxvbmcgKHJlcXVpcmVzIGhhdmluZyBwbGVkZ2VkIDEwIHRpbWVzKTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBRdWludGlsbGlvbiBmaW5nZXJzIGlzIG5vdyB0d2ljZSBhcyBlZmZpY2llbnQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgVW5jYW5ueSBjbGlja2VyIHdhcyByZWFsbHkgdG9vIHVucHJlZGljdGFibGU7IGl0IGlzIG5vdyBhIHJlZ3VsYXIgYWNoaWV2ZW1lbnQgYW5kIG5vIGxvbmdlciByZXF1aXJlcyBhIHdvcmxkIHJlY29yZCwganVzdCAqcHJldHR5IGZhc3QqIGNsaWNraW5nPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4wMi8wOS8yMDEzIC0gYSBiZXR0ZXIgd2F5IG91dDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBFbGRlciBDb3ZlbmFudCBpcyBldmVuIGNoZWFwZXIsIGFuZCByZXZva2luZyBpdCBpcyBjaGVhcGVyIHN0aWxsIChhbHNvIGFkZGVkIGEgbmV3IGFjaGlldmVtZW50IGZvciBnZXR0aW5nIGl0KTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBlYWNoIGdyYW5kbWEgdXBncmFkZSBub3cgcmVxdWlyZXMgMTUgb2YgdGhlIG1hdGNoaW5nIGJ1aWxkaW5nPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHRoZSBkcmVhZGVkIGJvdHRvbSBjdXJzb3IgaGFzIGJlZW4gZml4ZWQgd2l0aCBhIG5ldyBjdXJzb3IgZGlzcGxheSBzdHlsZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBhbiBvcHRpb24gZm9yIGZhc3RlciwgY2hlYXBlciBncmFwaGljczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBiYXNlNjQgZW5jb2RpbmcgaGFzIGJlZW4gcmVkb25lOyB0aGlzIG1pZ2h0IG1ha2Ugc2F2aW5nIHBvc3NpYmxlIGFnYWluIG9uIHNvbWUgb2xkZXIgYnJvd3NlcnM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgc2hhZG93IGFjaGlldmVtZW50cyBub3cgaGF2ZSB0aGVpciBvd24gc2VjdGlvbjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyByYXNwYmVycnkganVpY2UgaXMgbm93IG5hbWVkIHJhc3BiZXJyeSBtaWxrLCBkZXNwaXRlIHJhc3BiZXJyeSBqdWljZSBiZWluZyBkZWxpY2lvdXMgYW5kIGdvaW5nIHVucXVlc3Rpb25hYmx5IHdlbGwgd2l0aCBjb29raWVzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IEhPVEZJWCA6IGN1cnNvcnMgbm93IGNsaWNrOyBmYW5jeSBncmFwaGljcyBidXR0b24gcmVuYW1lZDsgY29va2llcyBhbW91bnQgbm93IG1vcmUgdmlzaWJsZSBhZ2FpbnN0IGN1cnNvcnM8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSBzbWFsbCI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjAxLzA5LzIwMTMgLSBzb3J0aW5nIHRoaW5ncyBvdXQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgdXBncmFkZXMgYW5kIGFjaGlldmVtZW50cyBhcmUgcHJvcGVybHkgc29ydGVkIGluIHRoZSBzdGF0cyBzY3JlZW48L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbWFkZSBFbGRlciBDb3ZlbmFudCBtdWNoIGNoZWFwZXIgYW5kIGxlc3MgaGFybWZ1bDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBpbXBvcnRpbmcgZnJvbSB0aGUgZmlyc3QgdmVyc2lvbiBoYXMgYmVlbiBkaXNhYmxlZCwgYXMgcHJvbWlzZWQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgIk9uZSBtaW5kIiBub3cgYWN0dWFsbHkgYXNrcyB5b3UgdG8gY29uZmlybSB0aGUgdXBncmFkZTwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIHNtYWxsIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MzEvMDgvMjAxMyAtIGhvdGZpeGVzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGEgd2F5IHRvIHBlcm1hbmVudGx5IHN0b3AgdGhlIGdyYW5kbWFwb2NhbHlwc2U8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgRWxkZXIgUGxlZGdlIHByaWNlIGlzIG5vdyBjYXBwZWQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgT25lIE1pbmQgYW5kIG90aGVyIGdyYW5kbWEgcmVzZWFyY2ggdXBncmFkZXMgYXJlIG5vdyBhIGxpdHRsZSBtb3JlIHBvd2VyZnVsLCBpZiBub3QgMTAwJSBhY2N1cmF0ZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyAiZ29sZGVuIiBjb29raWUgbm93IGFwcGVhcnMgYWdhaW4gZHVyaW5nIGdyYW5kbWFwb2NhbHlwc2U7IEVsZGVyIFBsZWRnZS1yZWxhdGVkIGFjaGlldmVtZW50cyBhcmUgbm93IHVubG9ja2FibGU8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjMxLzA4LzIwMTMgLSB0b28gbWFueSBncmFuZG1hczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB0aGUgZ3JhbmRtYXBvY2FseXBzZSBpcyBiYWNrLCBhbG9uZyB3aXRoIG1vcmUgZ3JhbmRtYSB0eXBlczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBzb21lIHVwZ3JhZGVzIHRoYXQgYm9vc3QgeW91ciBjbGlja2luZyBwb3dlciBhbmQgbWFrZSBpdCBzY2FsZSB3aXRoIHlvdXIgY3BzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGNsaWNraW5nIGFjaGlldmVtZW50cyBtYWRlIGhhcmRlcjsgTmV2ZXJjbGljayBpcyBub3cgYSBzaGFkb3cgYWNoaWV2ZW1lbnQ7IFVuY2FubnkgY2xpY2tlciBzaG91bGQgbm93IHRydWx5IGJlIGEgd29ybGQgcmVjb3JkPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4yOC8wOC8yMDEzIC0gb3Zlci1hY2hpZXZlcjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBhIGZldyBtb3JlIGFjaGlldmVtZW50czwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyByZXdvcmtlZCB0aGUgIkJha2UgWCBjb29raWVzIiBhY2hpZXZlbWVudHMgc28gdGhleSB0YWtlIGxvbmdlciB0byBhY2hpZXZlPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4yNy8wOC8yMDEzIC0gYSBiYWQgaWRlYTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBkdWUgdG8gcG9wdWxhciBkZW1hbmQsIHJldGlyZWQgNSBhY2hpZXZlbWVudHMgKHRoZSAicmVzZXQgeW91ciBnYW1lIiBhbmQgImNoZWF0IiBvbmVzKTsgdGhleSBjYW4gc3RpbGwgYmUgdW5sb2NrZWQsIGJ1dCBkbyBub3QgY291bnQgdG93YXJkIHlvdXIgdG90YWwgYW55bW9yZS4gRG9uXCd0IHdvcnJ5LCB0aGVyZSB3aWxsIGJlIG1hbnkgbW9yZSBhY2hpZXZlbWVudHMgc29vbiE8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbWFkZSBzb21lIGFjaGlldmVtZW50cyBoaWRkZW4gZm9yIGFkZGVkIG15c3Rlcnk8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjI3LzA4LzIwMTMgLSBhIHNlbnNlIG9mIGFjaGlldmVtZW50PC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGFjaGlldmVtZW50cyAoYW5kIG1pbGspPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGk+KHRoaXMgaXMgYSBiaWcgdXBkYXRlLCBwbGVhc2UgZG9uXCd0IGdldCB0b28gbWFkIGlmIHlvdSBsb3NlIHNvbWUgZGF0YSEpPC9pPjwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIHNtYWxsIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MjYvMDgvMjAxMyAtIG5ldyB1cGdyYWRlIHRpZXI8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgc29tZSBtb3JlIHVwZ3JhZGVzIChpbmNsdWRpbmcgYSBjb3VwbGUgZ29sZGVuIGNvb2tpZS1yZWxhdGVkIG9uZXMpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGNsaWNraW5nIHN0YXRzPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4yNi8wOC8yMDEzIC0gbW9yZSB0d2Vha3M8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgdHdlYWtlZCBhIGNvdXBsZSBjdXJzb3IgdXBncmFkZXM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbWFkZSB0aW1lIG1hY2hpbmVzIGxlc3MgcG93ZXJmdWw8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgb2ZmbGluZSBtb2RlIG9wdGlvbjwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIHNtYWxsIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MjUvMDgvMjAxMyAtIHR3ZWFrczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyByZWJhbGFuY2VkIHByb2dyZXNzaW9uIGN1cnZlIChtaWQtIGFuZCBlbmQtZ2FtZSBvYmplY3RzIGNvc3QgbW9yZSBhbmQgZ2l2ZSBtb3JlKTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBzb21lIG1vcmUgY29va2llIHVwZ3JhZGVzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIENwUyBmb3IgY3Vyc29yczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBzZWxsIGJ1dHRvbjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBtYWRlIGdvbGRlbiBjb29raWUgbW9yZSB1c2VmdWw8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSBzbWFsbCI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjI0LzA4LzIwMTMgLSBob3RmaXhlczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBpbXBvcnQvZXhwb3J0IGZlYXR1cmUsIHdoaWNoIGFsc28gYWxsb3dzIHlvdSB0byByZXRyaWV2ZSBhIHNhdmUgZ2FtZSBmcm9tIHRoZSBvbGQgdmVyc2lvbiAod2lsbCBiZSBkaXNhYmxlZCBpbiBhIHdlZWsgdG8gcHJldmVudCB0b28gbXVjaCBjaGVhdGluZyk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgdXBncmFkZSBzdG9yZSBub3cgaGFzIHVubGltaXRlZCBzbG90cyAoanVzdCBob3ZlciBvdmVyIGl0KSwgZHVlIHRvIHBvcHVsYXIgZGVtYW5kPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIHVwZGF0ZSBsb2c8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjI0LzA4LzIwMTMgLSBiaWcgdXBkYXRlITwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyByZXZhbXBlZCB0aGUgd2hvbGUgZ2FtZSAobmV3IGdyYXBoaWNzLCBuZXcgZ2FtZSBtZWNoYW5pY3MpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIHVwZ3JhZGVzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IG11Y2ggc2FmZXIgc2F2aW5nPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4wOC8wOC8yMDEzIC0gZ2FtZSBsYXVuY2g8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbWFkZSA8YSBocmVmPSJodHRwczovL29ydGVpbC5kYXNobmV0Lm9yZy9leHBlcmltZW50cy9jb29raWUvIiB0YXJnZXQ9Il9ibGFuayI+dGhlIGdhbWU8L2E+IGluIGEgY291cGxlIGhvdXJzLCBmb3IgbGF1Z2hzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGtpbmRhIHN0YXJ0aW5nIHRvIHJlZ3JldCBpdDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhaCB3ZWxsPC9kaXY+JyArCiAgICAiPC9kaXY+IiArCiAgICAiPC9kaXY+IjsKCiAgR2FtZS5yZWFkeSA9IDA7CgogIEdhbWUuTG9hZCA9IGZ1bmN0aW9uIChjYWxsYmFjaykgewogICAgLy9sKCdvZmZHYW1lTWVzc2FnZScpLmlubmVySFRNTD0nPGRpdiBzdHlsZT0icGFkZGluZzo2NHB4IDEyOHB4OyI+PGRpdiBjbGFzcz0idGl0bGUiPkxvYWRpbmcuLi48L2Rpdj48L2Rpdj4nOwogICAgR2FtZS5Mb2FkZXIgPSBuZXcgTG9hZGVyKCk7CiAgICBHYW1lLkxvYWRlci5kb21haW4gPSAiaW1nLyI7CiAgICBpZiAodHlwZW9mIFBSRUxPQUQgIT09ICJ1bmRlZmluZWQiKSBHYW1lLkxvYWRlci5sb2FkZWQgPSBQUkVMT0FEKEdhbWUuSW5pdCk7CiAgICBlbHNlIEdhbWUuTG9hZGVyLmxvYWRlZCA9IGNhbGxiYWNrOwogICAgR2FtZS5Mb2FkZXIuTG9hZChbImZpbGxlci5wbmciXSk7CiAgfTsKICBHYW1lLkVycm9yRnJhbWUgPSBmdW5jdGlvbiAoKSB7CiAgICBsKCJvZmZHYW1lTWVzc2FnZSIpLmlubmVySFRNTCA9CiAgICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+T29wcy4gV3JvbmcgYWRkcmVzcyE8L2Rpdj4nICsKICAgICAgIjxkaXY+SXQgbG9va3MgbGlrZSB5b3UncmUgYWNjZXNzaW5nIENvb2tpZSBDbGlja2VyIGZyb20gYW5vdGhlciBVUkwgdGhhbiB0aGUgb2ZmaWNpYWwgb25lLjxicj4iICsKICAgICAgJ1lvdSBjYW4gPGEgaHJlZj0iLy9vcnRlaWwuZGFzaG5ldC5vcmcvY29va2llY2xpY2tlci8iIHRhcmdldD0iX2JsYW5rIj5wbGF5IENvb2tpZSBDbGlja2VyIG92ZXIgaGVyZTwvYT4hPGJyPicgKwogICAgICAiPHNtYWxsPihJZiBmb3IgYW55IHJlYXNvbiwgeW91IGFyZSB1bmFibGUgdG8gYWNjZXNzIHRoZSBnYW1lIG9uIHRoZSBvZmZpY2lhbCBVUkwsIHdlIGFyZSBjdXJyZW50bHkgd29ya2luZyBvbiBhIHNlY29uZCBkb21haW4uKTwvc21hbGw+PC9kaXY+IjsKICB9OwogIEdhbWUudGltZWRvdXQgPSBmYWxzZTsKICBHYW1lLlRpbWVvdXQgPSBmdW5jdGlvbiAoKSB7CiAgICBHYW1lLldyaXRlU2F2ZSgpOwogICAgR2FtZS5raWxsU2hpbW1lcnMoKTsKICAgIGwoIm9mZkdhbWVNZXNzYWdlIikuaW5uZXJIVE1MID0KICAgICAgJzxkaXYgY2xhc3M9InRpdGxlIj4nICsKICAgICAgKEdhbWUuSGFzKCJUd2luIEdhdGVzIG9mIFRyYW5zY2VuZGVuY2UiKQogICAgICAgID8gbG9jKCJDb29raWUgQ2xpY2tlciBpcyBpbiBzbGVlcCBtb2RlIGFuZCBnZW5lcmF0aW5nIG9mZmxpbmUgY29va2llcy4iKQogICAgICAgIDogbG9jKCJDb29raWUgQ2xpY2tlciBpcyBpbiBzbGVlcCBtb2RlLiIpKSArCiAgICAgICI8L2Rpdj4iICsKICAgICAgbG9jKAogICAgICAgICIlMSB0byByZXN1bWUgZnJvbSB5b3VyIHNhdmUgZmlsZS4iLAogICAgICAgICI8YSAiICsKICAgICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICAgJz0iR2FtZS5SZXN1bWUoKTsiPicgKwogICAgICAgICAgbG9jKCJDbGljayBoZXJlIikgKwogICAgICAgICAgIjwvYT4iCiAgICAgICkgKwogICAgICAnPGJyPjxkaXYgc3R5bGU9ImZvbnQtc3R5bGU6aXRhbGljO2ZvbnQtc2l6ZTo2NSU7bGluZS1oZWlnaHQ6MTEwJTtvcGFjaXR5OjAuNzU7Ij4nICsKICAgICAgbG9jKAogICAgICAgICIodGhpcyBoYXBwZW5zIHdoZW4gdG9vIG1hbnkgZnJhbWVzIGFyZSBza2lwcGVkIGF0IG9uY2UsPGJyPnVzdWFsbHkgd2hlbiB0aGUgZ2FtZSBoYXMgYmVlbiBydW5uaW5nIGluIHRoZSBiYWNrZ3JvdW5kIGZvciBhIHdoaWxlKTxicj4oeW91IGNhbiB0dXJuIHRoaXMgZmVhdHVyZSBvZmYgaW4gdGhlIHNldHRpbmdzIG1lbnUpIgogICAgICApICsKICAgICAgIjwvZGl2PiI7CiAgICBsKCJvZmZHYW1lTWVzc2FnZVdyYXAiKS5zdHlsZS5kaXNwbGF5ID0gInRhYmxlIjsKICAgIEdhbWUudGltZWRvdXQgPSB0cnVlOwogICAgY29uc29sZS5sb2coCiAgICAgICJbPT09IEdhbWUgdGltZWQgb3V0IGFuZCBoYXMgYmVlbiBwdXQgaW4gc2xlZXAgbW9kZS4gRGF0YSB3YXMgc2F2ZWQuID09PV0iCiAgICApOwogIH07CiAgR2FtZS5SZXN1bWUgPSBmdW5jdGlvbiAoKSB7CiAgICBsKCJvZmZHYW1lTWVzc2FnZSIpLmlubmVySFRNTCA9ICIiOwogICAgbCgib2ZmR2FtZU1lc3NhZ2VXcmFwIikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgIEdhbWUudGltZWRvdXQgPSBmYWxzZTsKICAgIEdhbWUudGltZSA9IERhdGUubm93KCk7CiAgICBHYW1lLmFjY3VtdWxhdGVkRGVsYXkgPSAwOwogICAgR2FtZS5kZWxheVRpbWVvdXRzID0gMDsKICAgIEdhbWUubGFzdEFjdGl2aXR5ID0gRGF0ZS5ub3coKTsKICAgIEdhbWUuTG9vcCgpOwogICAgR2FtZS5Mb2FkU2F2ZSgpOwogICAgY29uc29sZS5sb2coIls9PT0gR2FtZSByZXN1bWVkISBEYXRhIHdhcyBsb2FkZWQuID09PV0iKTsKICB9OwoKICBHYW1lLkluaXQgPSBmdW5jdGlvbiAoKSB7CiAgICBHYW1lLnJlYWR5ID0gMTsKCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCQlWQVJJQUJMRVMgQU5EIFBSRVNFVFMKCQk9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgR2FtZS5UID0gMDsKICAgIEdhbWUuZHJhd1QgPSAwOwogICAgR2FtZS5sb29wVCA9IDA7CiAgICBHYW1lLmZwcyA9IDMwOwoKICAgIEdhbWUuc2Vhc29uID0gR2FtZS5iYXNlU2Vhc29uOwoKICAgIEdhbWUubCA9IGwoImdhbWUiKTsKICAgIEdhbWUud3JhcHBlciA9IGwoIndyYXBwZXIiKTsKICAgIEdhbWUuYm91bmRzID0gMDsgLy9yZWN0YW5nbGUgZGVmaW5pbmcgc2NyZWVuIGxpbWl0cyAocmlnaHQsbGVmdCxib3R0b20sdG9wKSB1cGRhdGVkIGV2ZXJ5IGxvZ2ljIGZyYW1lCgogICAgVG9wQmFyT2Zmc2V0ID0gMzI7CiAgICBpZiAoIUFwcCkgR2FtZS53cmFwcGVyLmNsYXNzTGlzdC5hZGQoIm9uV2ViIik7CiAgICBlbHNlIHsKICAgICAgR2FtZS53cmFwcGVyLmNsYXNzTGlzdC5hZGQoIm9mZldlYiIpOwogICAgICBUb3BCYXJPZmZzZXQgPSAwOwogICAgfQoKICAgIGlmIChHYW1lLm1vYmlsZSA9PSAxKSB7CiAgICAgIEdhbWUud3JhcHBlci5jbGFzc05hbWUgPSAibW9iaWxlIjsKICAgIH0KICAgIEdhbWUuY2xpY2tTdHIgPSBHYW1lLnRvdWNoRXZlbnRzID8gIm9udG91Y2hlbmQiIDogIm9uY2xpY2siOwoKICAgIGwoInZlcnNpb25OdW1iZXIiKS5pbm5lckhUTUwgPQogICAgICAidi4gIiArCiAgICAgIEdhbWUudmVyc2lvbiArCiAgICAgICghQXBwCiAgICAgICAgPyAnPGRpdiBpZD0iaHR0cHNTd2l0Y2giIHN0eWxlPSJjdXJzb3I6cG9pbnRlcjtkaXNwbGF5OmlubGluZS1ibG9jaztiYWNrZ3JvdW5kOnVybChpbWcvJyArCiAgICAgICAgICAoR2FtZS5odHRwcyA/ICJsb2NrT24iIDogImxvY2tPZmYiKSArCiAgICAgICAgICAnLnBuZyk7d2lkdGg6MTZweDtoZWlnaHQ6MTZweDtwb3NpdGlvbjpyZWxhdGl2ZTt0b3A6NHB4O2xlZnQ6MHB4O21hcmdpbjowcHggLTJweDsiPjwvZGl2PicKICAgICAgICA6ICIiKSArCiAgICAgIChHYW1lLmJldGEgPyAnIDxzcGFuIHN0eWxlPSJjb2xvcjojZmYwOyI+YmV0YTwvc3Bhbj4nIDogIiIpOwoKICAgIGlmICghQXBwKSB7CiAgICAgIGlmIChHYW1lLmJldGEpIHsKICAgICAgICB2YXIgbWUgPSBsKCJsaW5rVmVyc2lvbkJldGEiKTsKICAgICAgICBtZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG1lKTsKICAgICAgfSBlbHNlIGlmIChHYW1lLnZlcnNpb24gPT0gMS4wNDY2KSB7CiAgICAgICAgdmFyIG1lID0gbCgibGlua1ZlcnNpb25PbGQiKTsKICAgICAgICBtZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG1lKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgbWUgPSBsKCJsaW5rVmVyc2lvbkxpdmUiKTsKICAgICAgICBtZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG1lKTsKICAgICAgfQogICAgfQoKICAgIEdhbWUubGFzdEFjdGl2aXR5ID0gRGF0ZS5ub3coKTsgLy9yZXNldCBvbiBtb3VzZSBtb3ZlLCBrZXkgcHJlc3Mgb3IgY2xpY2sKCiAgICAvL2xhdGVuY3kgY29tcGVuc2F0b3Igc3R1ZmYKICAgIEdhbWUudGltZSA9IERhdGUubm93KCk7CiAgICBHYW1lLmFjY3VtdWxhdGVkRGVsYXkgPSAwOwogICAgR2FtZS5kZWxheVRpbWVvdXRzID0gMDsgLy9ob3cgbWFueSB0aW1lcyB3ZSd2ZSBnb25lIG92ZXIgdGhlIHRpbWVvdXQgZGVsYXkKICAgIEdhbWUuY2F0Y2h1cExvZ2ljID0gMDsKICAgIEdhbWUuZnBzU3RhcnRUaW1lID0gMDsKICAgIEdhbWUuZnJhbWVOdW1iZXIgPSAwOwogICAgR2FtZS5jdXJyZW50RnBzID0gR2FtZS5mcHM7CiAgICBHYW1lLnByZXZpb3VzRnBzID0gR2FtZS5jdXJyZW50RnBzOwogICAgR2FtZS5nZXRGcHMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIEdhbWUuZnJhbWVOdW1iZXIrKzsKICAgICAgdmFyIGN1cnJlbnRUaW1lID0gKERhdGUubm93KCkgLSBHYW1lLmZwc1N0YXJ0VGltZSkgLyAxMDAwOwogICAgICB2YXIgcmVzdWx0ID0gTWF0aC5mbG9vcihHYW1lLmZyYW1lTnVtYmVyIC8gY3VycmVudFRpbWUpOwogICAgICBpZiAoY3VycmVudFRpbWUgPiAxKSB7CiAgICAgICAgR2FtZS5mcHNTdGFydFRpbWUgPSBEYXRlLm5vdygpOwogICAgICAgIEdhbWUuZnJhbWVOdW1iZXIgPSAwOwogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9OwoKICAgIEdhbWUuY29va2llc0Vhcm5lZCA9IDA7IC8vYWxsIGNvb2tpZXMgZWFybmVkIGR1cmluZyBnYW1lcGxheQogICAgR2FtZS5jb29raWVzID0gMDsgLy9jb29raWVzCiAgICBHYW1lLmNvb2tpZXNkID0gMDsgLy9jb29raWVzIGRpc3BsYXkKICAgIEdhbWUuY29va2llc1BzID0gMTsgLy9jb29raWVzIHBlciBzZWNvbmQgKHRvIHJlY2FsY3VsYXRlIHdpdGggZXZlcnkgbmV3IHB1cmNoYXNlKQogICAgR2FtZS5jb29raWVzUHNSYXcgPSAwOyAvL3JhdyBjb29raWVzIHBlciBzZWNvbmQKICAgIEdhbWUuY29va2llc1BzUmF3SGlnaGVzdCA9IDA7IC8vaGlnaGVzdCByYXcgY29va2llcyBwZXIgc2Vjb25kIHRoaXMgYXNjZW5zaW9uCiAgICBHYW1lLmNvb2tpZXNSZXNldCA9IDA7IC8vY29va2llcyBsb3N0IHRvIHJlc2V0dGluZyAodXNlZCB0byBkZXRlcm1pbmUgcHJlc3RpZ2UgYW5kIGhlYXZlbmx5IGNoaXBzKQogICAgR2FtZS5jb29raWVDbGlja3MgPSAwOyAvLysxIGZvciBlYWNoIGNsaWNrIG9uIHRoZSBjb29raWUKICAgIEdhbWUuZ29sZGVuQ2xpY2tzID0gMDsgLy8rMSBmb3IgZWFjaCBnb2xkZW4gY29va2llIGNsaWNrZWQgKGFsbCB0aW1lKQogICAgR2FtZS5nb2xkZW5DbGlja3NMb2NhbCA9IDA7IC8vKzEgZm9yIGVhY2ggZ29sZGVuIGNvb2tpZSBjbGlja2VkICh0aGlzIGdhbWUgb25seSkKICAgIEdhbWUubWlzc2VkR29sZGVuQ2xpY2tzID0gMDsgLy8rMSBmb3IgZWFjaCBnb2xkZW4gY29va2llIG1pc3NlZAogICAgR2FtZS5oYW5kbWFkZUNvb2tpZXMgPSAwOyAvL2FsbCB0aGUgY29va2llcyBtYWRlIGZyb20gY2xpY2tpbmcgdGhlIGNvb2tpZQogICAgR2FtZS5taWxrUHJvZ3Jlc3MgPSAwOyAvL3lvdSBnYWluIGEgbGl0dGxlIGJpdCBmb3IgZWFjaCBhY2hpZXZlbWVudC4gRWFjaCBpbmNyZW1lbnQgb2YgMSBpcyBhIGRpZmZlcmVudCBtaWxrIGRpc3BsYXllZC4KICAgIEdhbWUubWlsa0ggPSBHYW1lLm1pbGtQcm9ncmVzcyAvIDI7IC8vbWlsayBoZWlnaHQsIGJldHdlZW4gMCBhbmQgMSAoYWx0aG91Z2ggc2hvdWxkIG5ldmVyIGdvIGFib3ZlIDAuNSkKICAgIEdhbWUubWlsa0hkID0gMDsgLy9taWxrIGhlaWdodCBkaXNwbGF5CiAgICBHYW1lLm1pbGtUeXBlID0gMDsgLy9jdXN0b20gbWlsawogICAgR2FtZS5iZ1R5cGUgPSAwOyAvL2N1c3RvbSBiYWNrZ3JvdW5kCiAgICBHYW1lLmNoaW1lVHlwZSA9IDA7IC8vZ29sZGVuIGNvb2tpZSBjaGltZQogICAgR2FtZS5wcmVzdGlnZSA9IDA7IC8vcHJlc3RpZ2UgbGV2ZWwgKHJlY2FsY3VsYXRlZCBkZXBlbmRpbmcgb24gR2FtZS5jb29raWVzUmVzZXQpCiAgICBHYW1lLmhlYXZlbmx5Q2hpcHMgPSAwOyAvL2hlYXZlbmx5IGNoaXBzIHRoZSBwbGF5ZXIgY3VycmVudGx5IGhhcwogICAgR2FtZS5oZWF2ZW5seUNoaXBzRGlzcGxheWVkID0gMDsgLy90aWNrcyB1cCBvciBkb3duIHRvIG1hdGNoIEdhbWUuaGVhdmVubHlDaGlwcwogICAgR2FtZS5oZWF2ZW5seUNoaXBzU3BlbnQgPSAwOyAvL2hlYXZlbmx5IGNoaXBzIHNwZW50IG9uIGNvb2tpZXMsIHVwZ3JhZGVzIGFuZCBzdWNoCiAgICBHYW1lLmhlYXZlbmx5Q29va2llcyA9IDA7IC8vaG93IG1hbnkgY29va2llcyBoYXZlIHdlIGJha2VkIGZyb20gY2hpcHMgKHVudXNlZCkKICAgIEdhbWUucGVybWFuZW50VXBncmFkZXMgPSBbLTEsIC0xLCAtMSwgLTEsIC0xXTsKICAgIEdhbWUuYXNjZW5zaW9uTW9kZSA9IDA7IC8vdHlwZSBvZiBjaGFsbGVuZ2UgcnVuIGlmIGFueQogICAgR2FtZS5yZXNldHMgPSAwOyAvL3Jlc2V0IGNvdW50ZXIKICAgIEdhbWUubHVtcHMgPSAtMTsgLy9zdWdhciBsdW1wcwogICAgR2FtZS5sdW1wc1RvdGFsID0gLTE7IC8vc3VnYXIgbHVtcHMgZWFybmVkIGFjcm9zcyBhbGwgcGxheXRocm91Z2hzICgtMSBtZWFucyB0aGV5IGhhdmVuJ3QgZXZlbiBzdGFydGVkIHlldCkKICAgIEdhbWUubHVtcFQgPSBEYXRlLm5vdygpOyAvL3RpbWUgd2hlbiB0aGUgY3VycmVudCBsdW1wIHN0YXJ0ZWQgZm9ybWluZwogICAgR2FtZS5sdW1wUmVmaWxsID0gMDsgLy90aW1lIGxlZnQgYmVmb3JlIGEgc3VnYXIgbHVtcCBjYW4gYmUgdXNlZCBhZ2FpbiAob24gbWluaWdhbWUgcmVmaWxscyBldGMpIGluIGxvZ2ljIGZyYW1lcwoKICAgIEdhbWUubWFrZVNlZWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBjaGFycyA9ICJhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eiIuc3BsaXQoIiIpOwogICAgICB2YXIgc3RyID0gIiI7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNTsgaSsrKSB7CiAgICAgICAgc3RyICs9IGNob29zZShjaGFycyk7CiAgICAgIH0KICAgICAgcmV0dXJuIHN0cjsKICAgIH07CiAgICBHYW1lLnNlZWQgPSBHYW1lLm1ha2VTZWVkKCk7IC8vZWFjaCBydW4gaGFzIGl0cyBvd24gc2VlZCwgdXNlZCBmb3IgZGV0ZXJtaW5pc3RpYyByYW5kb20gc3R1ZmYKCiAgICBHYW1lLnZvbHVtZSA9IDc1OyAvL3NvdW5kIHZvbHVtZQogICAgR2FtZS52b2x1bWVNdXNpYyA9IDUwOyAvL211c2ljIHZvbHVtZQoKICAgIEdhbWUuZWxkZXJXcmF0aCA9IDA7CiAgICBHYW1lLmVsZGVyV3JhdGhPbGQgPSAwOwogICAgR2FtZS5lbGRlcldyYXRoRCA9IDA7CiAgICBHYW1lLnBsZWRnZXMgPSAwOwogICAgR2FtZS5wbGVkZ2VUID0gMDsKICAgIEdhbWUucmVzZWFyY2hUID0gMDsKICAgIEdhbWUubmV4dFJlc2VhcmNoID0gMDsKICAgIEdhbWUuY29va2llc1N1Y2tlZCA9IDA7IC8vY29va2llcyBzdWNrZWQgYnkgd3JpbmtsZXJzCiAgICBHYW1lLmNwc1N1Y2tlZCA9IDA7IC8vcGVyY2VudCBvZiBDcFMgYmVpbmcgc3Vja2VkIGJ5IHdyaW5rbGVycwogICAgR2FtZS53cmlua2xlcnNQb3BwZWQgPSAwOwogICAgR2FtZS5zYW50YUxldmVsID0gMDsKICAgIEdhbWUucmVpbmRlZXJDbGlja2VkID0gMDsKICAgIEdhbWUuc2Vhc29uVCA9IDA7CiAgICBHYW1lLnNlYXNvblVzZXMgPSAwOwogICAgR2FtZS5kcmFnb25MZXZlbCA9IDA7CiAgICBHYW1lLmRyYWdvbkF1cmEgPSAwOwogICAgR2FtZS5kcmFnb25BdXJhMiA9IDA7CgogICAgR2FtZS5mb3J0dW5lR0MgPSAwOwogICAgR2FtZS5mb3J0dW5lQ1BTID0gMDsKCiAgICBHYW1lLmJsZW5kTW9kZXNPbiA9CiAgICAgIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRldGVjdCIpLnN0eWxlLm1peEJsZW5kTW9kZSA9PT0gIiI7CgogICAgR2FtZS5iZyA9ICIiOyAvL2JhY2tncm91bmQgKGdyYW5kbWFzIGFuZCBzdWNoKQogICAgR2FtZS5iZ0ZhZGUgPSAiIjsgLy9mYWRpbmcgdG8gYmFja2dyb3VuZAogICAgR2FtZS5iZ1IgPSAwOyAvL3JhdGlvICgwIC0gbm90IGZhZGVkLCAxIC0gZnVsbHkgZmFkZWQpCiAgICBHYW1lLmJnUmQgPSAwOyAvL3JhdGlvIGRpc3BsYXllZAoKICAgIEdhbWUud2luZG93VyA9IHdpbmRvdy5pbm5lcldpZHRoOwogICAgR2FtZS53aW5kb3dIID0gd2luZG93LmlubmVySGVpZ2h0OwogICAgR2FtZS5zY2FsZSA9IDE7CgogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInJlc2l6ZSIsIGZ1bmN0aW9uIChlKSB7CiAgICAgIEdhbWUucmVzaXplKCk7CiAgICAgIGlmIChBcHAgJiYgQXBwLm9uUmVzaXplKSBBcHAub25SZXNpemUoKTsKICAgIH0pOwoKICAgIEdhbWUucmVzaXplID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgdyA9IHdpbmRvdy5pbm5lcldpZHRoOwogICAgICB2YXIgaCA9IHdpbmRvdy5pbm5lckhlaWdodDsKCiAgICAgIHZhciBwcmV2VyA9IEdhbWUud2luZG93VzsKICAgICAgdmFyIHByZXZIID0gR2FtZS53aW5kb3dIOwoKICAgICAgdmFyIHNjYWxlID0gTWF0aC5taW4odyAvIE1hdGgubWF4KDgwMCwgdyksIGggLyBNYXRoLm1heCgyMDAsIGgpKTsKICAgICAgR2FtZS53aW5kb3dXID0gTWF0aC5mbG9vcih3IC8gc2NhbGUpOwogICAgICBHYW1lLndpbmRvd0ggPSBNYXRoLmZsb29yKGggLyBzY2FsZSk7CiAgICAgIGlmIChzY2FsZSAhPSAxKSB7CiAgICAgICAgR2FtZS53cmFwcGVyLnN0eWxlLnRyYW5zZm9ybSA9ICJzY2FsZSgiICsgc2NhbGUgKyAiKSI7CiAgICAgICAgR2FtZS53cmFwcGVyLnN0eWxlLndpZHRoID0gR2FtZS53aW5kb3dXICsgInB4IjsKICAgICAgICBHYW1lLndyYXBwZXIuc3R5bGUuaGVpZ2h0ID0gR2FtZS53aW5kb3dIICsgInB4IjsKICAgICAgfSBlbHNlIHsKICAgICAgICBHYW1lLndyYXBwZXIuc3R5bGUucmVtb3ZlUHJvcGVydHkoInRyYW5zZm9ybSIpOwogICAgICAgIEdhbWUud3JhcHBlci5zdHlsZS53aWR0aCA9ICIxMDAlIjsKICAgICAgICBHYW1lLndyYXBwZXIuc3R5bGUuaGVpZ2h0ID0gIjEwMCUiOwogICAgICB9CiAgICAgIEdhbWUuc2NhbGUgPSBzY2FsZTsKCiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5PYmplY3RzW2ldOwogICAgICAgIG1lLnRvUmVzaXplID0gdHJ1ZTsKICAgICAgICBpZiAobWUubWluaWdhbWUgJiYgbWUubWluaWdhbWUub25SZXNpemUpIG1lLm1pbmlnYW1lLm9uUmVzaXplKCk7CiAgICAgIH0KCiAgICAgIGlmIChHYW1lLmdldE5ld1RpY2tlcikgewogICAgICAgIGlmICgKICAgICAgICAgIHByZXZXID49IEdhbWUudGlja2VyVG9vTmFycm93ICYmCiAgICAgICAgICBHYW1lLndpbmRvd1cgPCBHYW1lLnRpY2tlclRvb05hcnJvdwogICAgICAgICkKICAgICAgICAgIEdhbWUuZ2V0TmV3VGlja2VyKHRydWUpOwogICAgICAgIGVsc2UgaWYgKAogICAgICAgICAgcHJldlcgPCBHYW1lLnRpY2tlclRvb05hcnJvdyAmJgogICAgICAgICAgR2FtZS53aW5kb3dXID49IEdhbWUudGlja2VyVG9vTmFycm93CiAgICAgICAgKQogICAgICAgICAgR2FtZS5nZXROZXdUaWNrZXIodHJ1ZSk7CiAgICAgIH0KICAgIH07CiAgICBHYW1lLnJlc2l6ZSgpOwoKICAgIEdhbWUuc3RhcnREYXRlID0gcGFyc2VJbnQoRGF0ZS5ub3coKSk7IC8vd2hlbiB3ZSBzdGFydGVkIHBsYXlpbmcKICAgIEdhbWUuZnVsbERhdGUgPSBwYXJzZUludChEYXRlLm5vdygpKTsgLy93aGVuIHdlIHN0YXJ0ZWQgcGxheWluZyAoY2FycmllcyBvdmVyIHdpdGggcmVzZXRzKQogICAgR2FtZS5sYXN0RGF0ZSA9IHBhcnNlSW50KERhdGUubm93KCkpOyAvL3doZW4gd2UgbGFzdCBzYXZlZCB0aGUgZ2FtZSAodXNlZCB0byBjb21wdXRlICJjb29raWVzIG1hZGUgc2luY2Ugd2UgY2xvc2VkIHRoZSBnYW1lIiBldGMpCgogICAgR2FtZS5wcmVmcyA9IFtdOwogICAgR2FtZS5EZWZhdWx0UHJlZnMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIEdhbWUucHJlZnMucGFydGljbGVzID0gMTsgLy9wYXJ0aWNsZSBlZmZlY3RzIDogZmFsbGluZyBjb29raWVzIGV0YwogICAgICBHYW1lLnByZWZzLm51bWJlcnMgPSAxOyAvL251bWJlcnMgdGhhdCBwb3AgdXAgd2hlbiBjbGlja2luZyB0aGUgY29va2llCiAgICAgIEdhbWUucHJlZnMuYXV0b3NhdmUgPSAxOyAvL3NhdmUgdGhlIGdhbWUgZXZlcnkgbWludXRlIG9yIHNvCiAgICAgIEdhbWUucHJlZnMuYXV0b3VwZGF0ZSA9IDE7IC8vc2VuZCBhbiBBSkFYIHJlcXVlc3QgdG8gdGhlIHNlcnZlciBldmVyeSAzMCBtaW51dGVzIChub3RlIDogaWdub3JlZCkKICAgICAgR2FtZS5wcmVmcy5taWxrID0gMTsgLy9kaXNwbGF5IG1pbGsKICAgICAgR2FtZS5wcmVmcy5mYW5jeSA9IDE7IC8vQ1NTIHNoYWRvdyBlZmZlY3RzIChtaWdodCBiZSBoZWF2eSBvbiBzb21lIGJyb3dzZXJzKQogICAgICBHYW1lLnByZWZzLndhcm4gPSAwOyAvL3dhcm4gYmVmb3JlIGNsb3NpbmcgdGhlIHdpbmRvdwogICAgICBHYW1lLnByZWZzLmN1cnNvcnMgPSAxOyAvL2Rpc3BsYXkgY3Vyc29ycwogICAgICBHYW1lLnByZWZzLmZvY3VzID0gMTsgLy9tYWtlIHRoZSBnYW1lIHJlZnJlc2ggbGVzcyBmcmVxdWVudGx5IHdoZW4gb2ZmLWZvY3VzCiAgICAgIEdhbWUucHJlZnMucG9wdXBzID0gMDsgLy91c2Ugb2xkLXN0eWxlIHBvcHVwcyAobm8gbG9uZ2VyIHVzZWQpCiAgICAgIEdhbWUucHJlZnMuZm9ybWF0ID0gMDsgLy9zaG9ydGVuIG51bWJlcnMKICAgICAgR2FtZS5wcmVmcy5ub3RpZnMgPSAwOyAvL25vdGlmaWNhdGlvbnMgZmFkZSBmYXN0ZXIKICAgICAgR2FtZS5wcmVmcy5hbmltYXRlID0gMTsgLy9hbmltYXRlIGJ1aWxkaW5ncwogICAgICBHYW1lLnByZWZzLndvYmJseSA9IDE7IC8vd29iYmx5IGNvb2tpZQogICAgICBHYW1lLnByZWZzLm1vbm9zcGFjZSA9IDA7IC8vYWx0IG1vbm9zcGFjZSBmb250IGZvciBjb29raWVzCiAgICAgIEdhbWUucHJlZnMuZmlsdGVycyA9IDE7IC8vQ1NTIGZpbHRlciBlZmZlY3RzIChtaWdodCBiZSBoZWF2eSBvbiBzb21lIGJyb3dzZXJzKQogICAgICBHYW1lLnByZWZzLmNvb2tpZXNvdW5kID0gMTsgLy91c2UgbmV3IGNvb2tpZSBjbGljayBzb3VuZAogICAgICBHYW1lLnByZWZzLmNyYXRlcyA9IDA7IC8vc2hvdyBjcmF0ZXMgYXJvdW5kIGljb25zIGluIHN0YXRzCiAgICAgIEdhbWUucHJlZnMuYWx0RHJhdyA9IDA7IC8vdXNlIHJlcXVlc3RBbmltYXRpb25GcmFtZSB0byB1cGRhdGUgZHJhd2luZyBpbnN0ZWFkIG9mIGZpeGVkIDMwIGZwcyBzZXRUaW1lb3V0CiAgICAgIEdhbWUucHJlZnMuc2hvd0JhY2t1cFdhcm5pbmcgPSAxOyAvL2lmIHRydWUsIHNob3cgYSAiSGF2ZSB5b3UgYmFja2VkIHVwIHlvdXIgc2F2ZT8iIG1lc3NhZ2Ugb24gc2F2ZSBsb2FkOyBzZXQgdG8gZmFsc2Ugd2hlbiBzYXZlIGlzIGV4cG9ydGVkCiAgICAgIEdhbWUucHJlZnMuZXh0cmFCdXR0b25zID0gMTsgLy9pZiB0cnVlLCBzaG93IE11dGUgYnV0dG9ucyBhbmQgdGhlIGJ1aWxkaW5nIG1hc3RlciBiYXIKICAgICAgR2FtZS5wcmVmcy5hc2tMdW1wcyA9IDA7IC8vaWYgdHJ1ZSwgc2hvdyBhIHByb21wdCBiZWZvcmUgc3BlbmRpbmcgbHVtcHMKICAgICAgR2FtZS5wcmVmcy5jdXN0b21HcmFuZG1hcyA9IDE7IC8vaWYgdHJ1ZSwgc2hvdyBwYXRyZW9uIG5hbWVzIGZvciBncmFuZG1hcwogICAgICBHYW1lLnByZWZzLnRpbWVvdXQgPSAwOyAvL2lmIHRydWUsIGdhbWUgbWF5IHNob3cgcGF1c2Ugc2NyZWVuIHdoZW4gdGltZWQgb3V0CiAgICAgIEdhbWUucHJlZnMuY2xvdWRTYXZlID0gMTsgLy9pZiB0cnVlIGFuZCBvbiBTdGVhbSwgc2F2ZSBhbmQgbG9hZCB0byBjbG91ZAogICAgICBHYW1lLnByZWZzLmJnTXVzaWMgPSAxOyAvL2lmIHRydWUgYW5kIG9uIFN0ZWFtLCBwbGF5IG11c2ljIGV2ZW4gd2hlbiBnYW1lIGlzbid0IGZvY3VzZWQKICAgICAgR2FtZS5wcmVmcy5ub3RTY2FyeSA9IDA7IC8vaWYgdHJ1ZSwgbWFrZSBzb21lIG9mIHRoZSBzY2FyeSBzdHVmZiBsZXNzIHNjYXJ5ICgiZXllYnJvdyBtb2RlIikKICAgICAgR2FtZS5wcmVmcy5mdWxsc2NyZWVuID0gMDsgLy9pZiB0cnVlLCBTdGVhbSBnYW1lIHdpbGwgYmUgZnVsbHNjcmVlbgogICAgICBHYW1lLnByZWZzLnNjcmVlbnJlYWRlciA9IDA7IC8vaWYgdHJ1ZSwgYWRkIHNvbWUgRE9NIHN0dWZmIHRvIGZhY2lsaXRhdGUgc2NyZWVucmVhZGVyIGludGVyYWN0aW9uIChyZXF1aXJlcyByZWxvYWQpCiAgICAgIEdhbWUucHJlZnMuZGlzY29yZFByZXNlbmNlID0gMTsgLy9pZiB0cnVlIGFuZCBhcHBsaWNhYmxlLCBzaG93IGdhbWUgYWN0aXZpdHkgaW4gRGlzY29yZCBzdGF0dXMKICAgIH07CiAgICBHYW1lLkRlZmF1bHRQcmVmcygpOwoKICAgIHdpbmRvdy5vbmJlZm9yZXVubG9hZCA9IGZ1bmN0aW9uIChldmVudCkgewogICAgICBpZiAoR2FtZS5wcmVmcyAmJiBHYW1lLnByZWZzLndhcm4pIHsKICAgICAgICBpZiAodHlwZW9mIGV2ZW50ID09ICJ1bmRlZmluZWQiKSBldmVudCA9IHdpbmRvdy5ldmVudDsKICAgICAgICBpZiAoZXZlbnQpCiAgICAgICAgICBldmVudC5yZXR1cm5WYWx1ZSA9IGxvYygKICAgICAgICAgICAgIkFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBjbG9zZSBDb29raWUgQ2xpY2tlcj8iCiAgICAgICAgICApOwogICAgICB9CiAgICB9OwoKICAgIEdhbWUuTW9iaWxlID0gZnVuY3Rpb24gKCkgewogICAgICBpZiAoIUdhbWUubW9iaWxlKSB7CiAgICAgICAgR2FtZS53cmFwcGVyLmNsYXNzTmFtZSA9ICJtb2JpbGUiOwogICAgICAgIEdhbWUubW9iaWxlID0gMTsKICAgICAgfSBlbHNlIHsKICAgICAgICBHYW1lLndyYXBwZXIuY2xhc3NOYW1lID0gIiI7CiAgICAgICAgR2FtZS5tb2JpbGUgPSAwOwogICAgICB9CiAgICB9OwoKICAgIEdhbWUuc2hvd0JhY2t1cFdhcm5pbmcgPSBmdW5jdGlvbiAoKSB7CiAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgIGxvYygiQmFjayB1cCB5b3VyIHNhdmUhIiksCiAgICAgICAgbG9jKAogICAgICAgICAgJ0hlbGxvIGFnYWluISBKdXN0IGEgcmVtaW5kZXIgdGhhdCB5b3UgbWF5IHdhbnQgdG8gYmFjayB1cCB5b3VyIENvb2tpZSBDbGlja2VyIHNhdmUgZXZlcnkgb25jZSBpbiBhIHdoaWxlLCBqdXN0IGluIGNhc2UuPGJyPlRvIGRvIHNvLCBnbyB0byBPcHRpb25zIGFuZCBoaXQgIkV4cG9ydCBzYXZlIiBvciAiU2F2ZSB0byBmaWxlIiEnCiAgICAgICAgKSArCiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+PGEgc3R5bGU9ImZsb2F0OnJpZ2h0OyIgb25jbGljaz0iR2FtZS5wcmVmcy5zaG93QmFja3VwV2FybmluZz0wOz09Q0xPU0VUSElTKCk9PSI+JyArCiAgICAgICAgICBsb2MoIkRvbid0IHNob3cgdGhpcyBhZ2FpbiIpICsKICAgICAgICAgICI8L2E+IiwKICAgICAgICBbMjUsIDddCiAgICAgICk7CiAgICB9OwoKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJCUJBS0VSWSBOQU1FCgkJPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KICAgIEdhbWUuUmFuZG9tQmFrZXJ5TmFtZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHN0ciA9ICIiOwogICAgICBpZiAoRU4pIHsKICAgICAgICByZXR1cm4gKAogICAgICAgICAgKE1hdGgucmFuZG9tKCkgPiAwLjA1CiAgICAgICAgICAgID8gY2hvb3NlKFsKICAgICAgICAgICAgICAgICJNYWdpYyIsCiAgICAgICAgICAgICAgICAiRmFudGFzdGljIiwKICAgICAgICAgICAgICAgICJGYW5jeSIsCiAgICAgICAgICAgICAgICAiU2Fzc3kiLAogICAgICAgICAgICAgICAgIlNuYXp6eSIsCiAgICAgICAgICAgICAgICAiUHJldHR5IiwKICAgICAgICAgICAgICAgICJDdXRlIiwKICAgICAgICAgICAgICAgICJQaXJhdGUiLAogICAgICAgICAgICAgICAgIk5pbmphIiwKICAgICAgICAgICAgICAgICJab21iaWUiLAogICAgICAgICAgICAgICAgIlJvYm90IiwKICAgICAgICAgICAgICAgICJSYWRpY2FsIiwKICAgICAgICAgICAgICAgICJVcmJhbiIsCiAgICAgICAgICAgICAgICAiQ29vbCIsCiAgICAgICAgICAgICAgICAiSGVsbGEiLAogICAgICAgICAgICAgICAgIlN3ZWV0IiwKICAgICAgICAgICAgICAgICJBd2Z1bCIsCiAgICAgICAgICAgICAgICAiRG91YmxlIiwKICAgICAgICAgICAgICAgICJUcmlwbGUiLAogICAgICAgICAgICAgICAgIlR1cmJvIiwKICAgICAgICAgICAgICAgICJUZWNobm8iLAogICAgICAgICAgICAgICAgIkRpc2NvIiwKICAgICAgICAgICAgICAgICJFbGVjdHJvIiwKICAgICAgICAgICAgICAgICJEYW5jaW5nIiwKICAgICAgICAgICAgICAgICJXb25kZXIiLAogICAgICAgICAgICAgICAgIk11dGFudCIsCiAgICAgICAgICAgICAgICAiU3BhY2UiLAogICAgICAgICAgICAgICAgIlNjaWVuY2UiLAogICAgICAgICAgICAgICAgIk1lZGlldmFsIiwKICAgICAgICAgICAgICAgICJGdXR1cmUiLAogICAgICAgICAgICAgICAgIkNhcHRhaW4iLAogICAgICAgICAgICAgICAgIkJlYXJkZWQiLAogICAgICAgICAgICAgICAgIkxvdmVseSIsCiAgICAgICAgICAgICAgICAiVGlueSIsCiAgICAgICAgICAgICAgICAiQmlnIiwKICAgICAgICAgICAgICAgICJGaXJlIiwKICAgICAgICAgICAgICAgICJXYXRlciIsCiAgICAgICAgICAgICAgICAiRnJvemVuIiwKICAgICAgICAgICAgICAgICJNZXRhbCIsCiAgICAgICAgICAgICAgICAiUGxhc3RpYyIsCiAgICAgICAgICAgICAgICAiU29saWQiLAogICAgICAgICAgICAgICAgIkxpcXVpZCIsCiAgICAgICAgICAgICAgICAiTW9sZHkiLAogICAgICAgICAgICAgICAgIlNoaW55IiwKICAgICAgICAgICAgICAgICJIYXBweSIsCiAgICAgICAgICAgICAgICAiSGFwcHkgTGl0dGxlIiwKICAgICAgICAgICAgICAgICJTbGlteSIsCiAgICAgICAgICAgICAgICAiVGFzdHkiLAogICAgICAgICAgICAgICAgIkRlbGljaW91cyIsCiAgICAgICAgICAgICAgICAiSHVuZ3J5IiwKICAgICAgICAgICAgICAgICJHcmVlZHkiLAogICAgICAgICAgICAgICAgIkxldGhhbCIsCiAgICAgICAgICAgICAgICAiUHJvZmVzc29yIiwKICAgICAgICAgICAgICAgICJEb2N0b3IiLAogICAgICAgICAgICAgICAgIlBvd2VyIiwKICAgICAgICAgICAgICAgICJDaG9jb2xhdGUiLAogICAgICAgICAgICAgICAgIkNydW1ibHkiLAogICAgICAgICAgICAgICAgIkNob2tsaXQiLAogICAgICAgICAgICAgICAgIlJpZ2h0ZW91cyIsCiAgICAgICAgICAgICAgICAiR2xvcmlvdXMiLAogICAgICAgICAgICAgICAgIk1uZW1vbmljIiwKICAgICAgICAgICAgICAgICJQc3ljaGljIiwKICAgICAgICAgICAgICAgICJGcmVuZXRpYyIsCiAgICAgICAgICAgICAgICAiSGVjdGljIiwKICAgICAgICAgICAgICAgICJDcmF6eSIsCiAgICAgICAgICAgICAgICAiUm95YWwiLAogICAgICAgICAgICAgICAgIkVsIiwKICAgICAgICAgICAgICAgICJWb24iLAogICAgICAgICAgICAgIF0pICsgIiAiCiAgICAgICAgICAgIDogIk1jIikgKwogICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgIkNvb2tpZSIsCiAgICAgICAgICAgICJCaXNjdWl0IiwKICAgICAgICAgICAgIk11ZmZpbiIsCiAgICAgICAgICAgICJTY29uZSIsCiAgICAgICAgICAgICJDdXBjYWtlIiwKICAgICAgICAgICAgIlBhbmNha2UiLAogICAgICAgICAgICAiQ2hpcCIsCiAgICAgICAgICAgICJTcHJvY2tldCIsCiAgICAgICAgICAgICJHaXptbyIsCiAgICAgICAgICAgICJQdXBwZXQiLAogICAgICAgICAgICAiTWl0dGVuIiwKICAgICAgICAgICAgIlNvY2siLAogICAgICAgICAgICAiVGVhcG90IiwKICAgICAgICAgICAgIk15c3RlcnkiLAogICAgICAgICAgICAiQmFrZXIiLAogICAgICAgICAgICAiQ29vayIsCiAgICAgICAgICAgICJHcmFuZG1hIiwKICAgICAgICAgICAgIkNsaWNrIiwKICAgICAgICAgICAgIkNsaWNrZXIiLAogICAgICAgICAgICAiU3BhY2VzaGlwIiwKICAgICAgICAgICAgIkZhY3RvcnkiLAogICAgICAgICAgICAiUG9ydGFsIiwKICAgICAgICAgICAgIk1hY2hpbmUiLAogICAgICAgICAgICAiRXhwZXJpbWVudCIsCiAgICAgICAgICAgICJNb25zdGVyIiwKICAgICAgICAgICAgIlBhbmljIiwKICAgICAgICAgICAgIkJ1cmdsYXIiLAogICAgICAgICAgICAiQmFuZGl0IiwKICAgICAgICAgICAgIkJvb3R5IiwKICAgICAgICAgICAgIlBvdGF0byIsCiAgICAgICAgICAgICJQaXp6YSIsCiAgICAgICAgICAgICJCdXJnZXIiLAogICAgICAgICAgICAiU2F1c2FnZSIsCiAgICAgICAgICAgICJNZWF0YmFsbCIsCiAgICAgICAgICAgICJTcGFnaGV0dGkiLAogICAgICAgICAgICAiTWFjYXJvbmkiLAogICAgICAgICAgICAiS2l0dGVuIiwKICAgICAgICAgICAgIlB1cHB5IiwKICAgICAgICAgICAgIkdpcmFmZmUiLAogICAgICAgICAgICAiWmVicmEiLAogICAgICAgICAgICAiUGFycm90IiwKICAgICAgICAgICAgIkRvbHBoaW4iLAogICAgICAgICAgICAiRHVja2xpbmciLAogICAgICAgICAgICAiU2xvdGgiLAogICAgICAgICAgICAiVHVydGxlIiwKICAgICAgICAgICAgIkdvYmxpbiIsCiAgICAgICAgICAgICJQaXhpZSIsCiAgICAgICAgICAgICJHbm9tZSIsCiAgICAgICAgICAgICJDb21wdXRlciIsCiAgICAgICAgICAgICJQaXJhdGUiLAogICAgICAgICAgICAiTmluamEiLAogICAgICAgICAgICAiWm9tYmllIiwKICAgICAgICAgICAgIlJvYm90IiwKICAgICAgICAgIF0pCiAgICAgICAgKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoCiAgICAgICAgICBsb2NTdHJpbmdzWyJiYWtlcnkgcmFuZG9tIG5hbWUsIDFzdCBoYWxmIl0gJiYKICAgICAgICAgIGxvY1N0cmluZ3NbImJha2VyeSByYW5kb20gbmFtZSwgMm5kIGhhbGYiXQogICAgICAgICkKICAgICAgICAgIHN0ciArPQogICAgICAgICAgICBjaG9vc2UobG9jKCJiYWtlcnkgcmFuZG9tIG5hbWUsIDFzdCBoYWxmIikpICsKICAgICAgICAgICAgIiAiICsKICAgICAgICAgICAgY2hvb3NlKGxvYygiYmFrZXJ5IHJhbmRvbSBuYW1lLCAybmQgaGFsZiIpKTsKICAgICAgICBlbHNlIHN0ciArPSBjaG9vc2UobG9jKCJiYWtlcnkgcmFuZG9tIG5hbWUiKSk7CiAgICAgIH0KICAgICAgcmV0dXJuIHN0cjsKICAgIH07CiAgICBHYW1lLkdldEJha2VyeU5hbWUgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBHYW1lLlJhbmRvbUJha2VyeU5hbWUoKTsKICAgIH07CiAgICBHYW1lLmJha2VyeU5hbWVMID0gbCgiYmFrZXJ5TmFtZSIpOwogICAgR2FtZS5iYWtlcnlOYW1lU2V0ID0gZnVuY3Rpb24gKHdoYXQpIHsKICAgICAgdHJ5IHsKICAgICAgICB2YXIgZXhwID0gbmV3IFJlZ0V4cCgiW14nXFwtXzAtOSBcXHB7TH1dIiwgImd1Iik7CiAgICAgICAgR2FtZS5iYWtlcnlOYW1lID0gd2hhdC5yZXBsYWNlKGV4cCwgIiAiKTsKICAgICAgICAvL0dhbWUuYmFrZXJ5TmFtZT13aGF0LnJlcGxhY2UoL1teJ1wtXzAtOSBccHtMfV0vZ3UsJyAnKTsKICAgICAgICBHYW1lLmJha2VyeU5hbWUgPSBHYW1lLmJha2VyeU5hbWUudHJpbSgpLnN1YnN0cmluZygwLCAyOCk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICB2YXIgZXhwID0gbmV3IFJlZ0V4cCgiVysiLCAiZyIpOwogICAgICAgIEdhbWUuYmFrZXJ5TmFtZSA9IHdoYXQucmVwbGFjZShleHAsICIgIik7CiAgICAgICAgLy9HYW1lLmJha2VyeU5hbWU9d2hhdC5yZXBsYWNlKC9cVysvZywnICcpOwogICAgICAgIEdhbWUuYmFrZXJ5TmFtZSA9IEdhbWUuYmFrZXJ5TmFtZS5zdWJzdHJpbmcoMCwgMjgpOwogICAgICB9CiAgICAgIEdhbWUuYmFrZXJ5TmFtZVJlZnJlc2goKTsKICAgICAgaWYgKEdhbWUuYmFrZXJ5TmFtZSA9PSAiUkVTVE9SRSBCQUNLVVAiICYmIEFwcCAmJiBBcHAucmVzdG9yZUJhY2t1cCkKICAgICAgICBBcHAucmVzdG9yZUJhY2t1cCgpOwogICAgfTsKICAgIEdhbWUuYmFrZXJ5TmFtZVJlZnJlc2ggPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBuYW1lID0gR2FtZS5iYWtlcnlOYW1lOwogICAgICBpZiAoRU4pIHsKICAgICAgICBpZiAobmFtZS5zbGljZSgtMSkudG9Mb3dlckNhc2UoKSA9PSAicyIpIG5hbWUgKz0gIicgYmFrZXJ5IjsKICAgICAgICBlbHNlIG5hbWUgKz0gIidzIGJha2VyeSI7CiAgICAgIH0gZWxzZSBuYW1lID0gbG9jKCIlMSdzIGJha2VyeSIsIG5hbWUpOwogICAgICBHYW1lLmJha2VyeU5hbWVMLnRleHRDb250ZW50ID0gbmFtZTsKICAgICAgbmFtZSA9IEdhbWUuYmFrZXJ5TmFtZS50b0xvd2VyQ2FzZSgpOwogICAgICBpZiAobmFtZSA9PSAib3J0ZWlsIikgR2FtZS5XaW4oIkdvZCBjb21wbGV4Iik7CiAgICAgIGlmICgKICAgICAgICAhQXBwICYmCiAgICAgICAgbmFtZS5pbmRleE9mKCJzYXlzb3BlbnNlc2FtZSIsIG5hbWUubGVuZ3RoIC0gInNheXNvcGVuc2VzYW1lIi5sZW5ndGgpID4KICAgICAgICAgIDAgJiYKICAgICAgICAhR2FtZS5zZXNhbWUKICAgICAgKQogICAgICAgIEdhbWUuT3BlblNlc2FtZSgpOwogICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgfTsKICAgIEdhbWUuYmFrZXJ5TmFtZVByb21wdCA9IGZ1bmN0aW9uICgpIHsKICAgICAgUGxheVNvdW5kKCJzbmQvdGljay5tcDMiKTsKICAgICAgR2FtZS5Qcm9tcHQoCiAgICAgICAgIjxpZCBOYW1lQmFrZXJ5PjxoMz4iICsKICAgICAgICAgIGxvYygiTmFtZSB5b3VyIGJha2VyeSIpICsKICAgICAgICAgICc8L2gzPjxkaXYgY2xhc3M9ImJsb2NrIiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7Ij4nICsKICAgICAgICAgIGxvYygiV2hhdCBzaG91bGQgeW91ciBiYWtlcnkncyBuYW1lIGJlPyIpICsKICAgICAgICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJibG9jayI+PGlucHV0IHR5cGU9InRleHQiIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjt3aWR0aDoxMDAlOyIgaWQ9ImJha2VyeU5hbWVJbnB1dCIgdmFsdWU9IicgKwogICAgICAgICAgR2FtZS5iYWtlcnlOYW1lICsKICAgICAgICAgICciLz48L2Rpdj4nLAogICAgICAgIFsKICAgICAgICAgIFsKICAgICAgICAgICAgbG9jKCJDb25maXJtIiksCiAgICAgICAgICAgICJpZiAobCgnYmFrZXJ5TmFtZUlucHV0JykudmFsdWUubGVuZ3RoPjApIHtHYW1lLmJha2VyeU5hbWVTZXQobCgnYmFrZXJ5TmFtZUlucHV0JykudmFsdWUpO0dhbWUuV2luKCdXaGF0XFwncyBpbiBhIG5hbWUnKTtHYW1lLkNsb3NlUHJvbXB0KCk7fSIsCiAgICAgICAgICBdLAogICAgICAgICAgW2xvYygiUmFuZG9tIiksICJHYW1lLmJha2VyeU5hbWVQcm9tcHRSYW5kb20oKTsiXSwKICAgICAgICAgIGxvYygiQ2FuY2VsIiksCiAgICAgICAgXQogICAgICApOwogICAgICBsKCJiYWtlcnlOYW1lSW5wdXQiKS5mb2N1cygpOwogICAgICBsKCJiYWtlcnlOYW1lSW5wdXQiKS5zZWxlY3QoKTsKICAgIH07CiAgICBHYW1lLmJha2VyeU5hbWVQcm9tcHRSYW5kb20gPSBmdW5jdGlvbiAoKSB7CiAgICAgIGwoImJha2VyeU5hbWVJbnB1dCIpLnZhbHVlID0gR2FtZS5SYW5kb21CYWtlcnlOYW1lKCk7CiAgICB9OwogICAgQWRkRXZlbnQoR2FtZS5iYWtlcnlOYW1lTCwgImNsaWNrIiwgR2FtZS5iYWtlcnlOYW1lUHJvbXB0KTsKCiAgICBHYW1lLmJha2VyeU5hbWVTZXQoR2FtZS5HZXRCYWtlcnlOYW1lKCkpOwoKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJCVRPT0xUSVAKCQk9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgR2FtZS50b29sdGlwID0gewogICAgICB0ZXh0OiAiIiwKICAgICAgeDogMCwKICAgICAgeTogMCwKICAgICAgb3JpZ2luOiAiIiwKICAgICAgb246IDAsCiAgICAgIHR0OiBsKCJ0b29sdGlwIiksCiAgICAgIHR0YTogbCgidG9vbHRpcEFuY2hvciIpLAogICAgICBzaG91bGRIaWRlOiAxLAogICAgICBkeW5hbWljOiAwLAogICAgICBmcm9tOiAwLAogICAgfTsKICAgIEdhbWUudG9vbHRpcC5kcmF3ID0gZnVuY3Rpb24gKGZyb20sIHRleHQsIG9yaWdpbikgewogICAgICB0aGlzLnNob3VsZEhpZGUgPSAwOwogICAgICB0aGlzLnRleHQgPSB0ZXh0OwogICAgICB0aGlzLmZyb20gPSBmcm9tOwogICAgICAvL3RoaXMueD14OwogICAgICAvL3RoaXMueT15OwogICAgICB0aGlzLm9yaWdpbiA9IG9yaWdpbjsKICAgICAgdmFyIHR0ID0gdGhpcy50dDsKICAgICAgdmFyIHR0YSA9IHRoaXMudHRhOwogICAgICB0dC5zdHlsZS5sZWZ0ID0gImF1dG8iOwogICAgICB0dC5zdHlsZS50b3AgPSAiYXV0byI7CiAgICAgIHR0LnN0eWxlLnJpZ2h0ID0gImF1dG8iOwogICAgICB0dC5zdHlsZS5ib3R0b20gPSAiYXV0byI7CiAgICAgIGlmICh0eXBlb2YgdGhpcy50ZXh0ID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgdmFyIHRleHQgPSB0aGlzLnRleHQoKTsKICAgICAgICBpZiAodGV4dCA9PSAiIikgdHRhLnN0eWxlLm9wYWNpdHkgPSAiMCI7CiAgICAgICAgZWxzZSB7CiAgICAgICAgICB0dC5pbm5lckhUTUwgPSB1bmVzY2FwZSh0ZXh0KTsKICAgICAgICAgIHR0YS5zdHlsZS5vcGFjaXR5ID0gIjEiOwogICAgICAgIH0KICAgICAgfSBlbHNlIHR0LmlubmVySFRNTCA9IHVuZXNjYXBlKHRoaXMudGV4dCk7CiAgICAgIC8vdHQuaW5uZXJIVE1MPSh0eXBlb2YgdGhpcy50ZXh0PT09J2Z1bmN0aW9uJyk/dW5lc2NhcGUodGhpcy50ZXh0KCkpOnVuZXNjYXBlKHRoaXMudGV4dCk7CiAgICAgIHR0YS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgdHRhLnN0eWxlLnZpc2liaWxpdHkgPSAiaGlkZGVuIjsKICAgICAgR2FtZS50b29sdGlwLnVwZGF0ZSgpOwogICAgICB0dGEuc3R5bGUudmlzaWJpbGl0eSA9ICJ2aXNpYmxlIjsKICAgICAgdGhpcy5vbiA9IDE7CiAgICB9OwogICAgR2FtZS50b29sdGlwLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIFggPSAwOwogICAgICB2YXIgWSA9IDA7CiAgICAgIHZhciB3aWR0aCA9IHRoaXMudHQub2Zmc2V0V2lkdGg7CiAgICAgIHZhciBoZWlnaHQgPSB0aGlzLnR0Lm9mZnNldEhlaWdodDsKICAgICAgaWYgKHRoaXMub3JpZ2luID09ICJzdG9yZSIpIHsKICAgICAgICBYID0gR2FtZS53aW5kb3dXIC0gMzMyIC0gd2lkdGg7CiAgICAgICAgWSA9IEdhbWUubW91c2VZIC0gMzI7CiAgICAgICAgaWYgKEdhbWUub25DcmF0ZSkgWSA9IEdhbWUub25DcmF0ZS5nZXRCb3VuZHMoKS50b3AgLSA0MjsKICAgICAgICBZID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oR2FtZS53aW5kb3dIIC0gaGVpZ2h0IC0gNDQsIFkpKTsKICAgICAgICAvKnRoaXMudHRhLnN0eWxlLnJpZ2h0PSczMDhweCc7Ly8nNDY4cHgnOwoJCQkJdGhpcy50dGEuc3R5bGUubGVmdD0nYXV0byc7CgkJCQlpZiAoR2FtZS5vbkNyYXRlKSBZPUdhbWUub25DcmF0ZS5nZXRCb3VuZHMoKS50b3AtMjsKCQkJCXRoaXMudHRhLnN0eWxlLnRvcD1NYXRoLm1heCgwLE1hdGgubWluKEdhbWUud2luZG93SC10aGlzLnR0LmNsaWVudEhlaWdodC02NCxZLTQ4KSkrJ3B4JzsqLwogICAgICB9IGVsc2UgewogICAgICAgIGlmIChHYW1lLm9uQ3JhdGUpIHsKICAgICAgICAgIHZhciByZWN0ID0gR2FtZS5vbkNyYXRlLmdldEJvdW5kcygpOwogICAgICAgICAgaWYgKHJlY3QubGVmdCA9PSAwICYmIHJlY3QudG9wID09IDApIHsKICAgICAgICAgICAgLy9pZiB3ZSBnZXQgdGhhdCBidWcgd2hlcmUgd2UgZ2V0IHN0dWNrIGluIHRoZSB0b3AtbGVmdCwgbW92ZSB0byB0aGUgbW91c2UgKFJFVklTSU9OIDoganVzdCBkbyBub3RoaW5nKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7IC8qcmVjdC5sZWZ0PUdhbWUubW91c2VYLTI0O3JlY3QucmlnaHQ9R2FtZS5tb3VzZVgrMjQ7cmVjdC50b3A9R2FtZS5tb3VzZVktMjQ7cmVjdC5ib3R0b209R2FtZS5tb3VzZVkrMjQ7Ki8KICAgICAgICAgIH0KICAgICAgICAgIGlmICh0aGlzLm9yaWdpbiA9PSAibGVmdCIpIHsKICAgICAgICAgICAgWCA9IHJlY3QubGVmdCAtIHdpZHRoIC0gMTY7CiAgICAgICAgICAgIFkgPSByZWN0LnRvcCArIChyZWN0LmJvdHRvbSAtIHJlY3QudG9wKSAvIDIgLSBoZWlnaHQgLyAyIC0gMzg7CiAgICAgICAgICAgIFkgPSBNYXRoLm1heCgwLCBNYXRoLm1pbihHYW1lLndpbmRvd0ggLSBoZWlnaHQgLSAxOSwgWSkpOwogICAgICAgICAgICBpZiAoWCA8IDApIFggPSByZWN0LnJpZ2h0OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgWCA9IHJlY3QubGVmdCArIChyZWN0LnJpZ2h0IC0gcmVjdC5sZWZ0KSAvIDIgLSB3aWR0aCAvIDIgLSA4OwogICAgICAgICAgICBZID0gcmVjdC50b3AgLSBoZWlnaHQgLSBUb3BCYXJPZmZzZXQgLSAxNjsKICAgICAgICAgICAgWCA9IE1hdGgubWF4KDAsIE1hdGgubWluKEdhbWUud2luZG93VyAtIHdpZHRoIC0gMTYsIFgpKTsKICAgICAgICAgICAgaWYgKFkgPCAwKSBZID0gcmVjdC5ib3R0b20gLSBUb3BCYXJPZmZzZXQ7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICh0aGlzLm9yaWdpbiA9PSAiYm90dG9tLXJpZ2h0IikgewogICAgICAgICAgWCA9IEdhbWUubW91c2VYICsgODsKICAgICAgICAgIFkgPSBHYW1lLm1vdXNlWSAtIDMyOwogICAgICAgICAgWCA9IE1hdGgubWF4KDAsIE1hdGgubWluKEdhbWUud2luZG93VyAtIHdpZHRoIC0gMTYsIFgpKTsKICAgICAgICAgIFkgPSBNYXRoLm1heCgwLCBNYXRoLm1pbihHYW1lLndpbmRvd0ggLSBoZWlnaHQgLSA2NCwgWSkpOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy5vcmlnaW4gPT0gImJvdHRvbSIpIHsKICAgICAgICAgIFggPSBHYW1lLm1vdXNlWCAtIHdpZHRoIC8gMiAtIDg7CiAgICAgICAgICBZID0gR2FtZS5tb3VzZVkgKyAyNDsKICAgICAgICAgIFggPSBNYXRoLm1heCgwLCBNYXRoLm1pbihHYW1lLndpbmRvd1cgLSB3aWR0aCAtIDE2LCBYKSk7CiAgICAgICAgICBZID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oR2FtZS53aW5kb3dIIC0gaGVpZ2h0IC0gNjQsIFkpKTsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMub3JpZ2luID09ICJsZWZ0IikgewogICAgICAgICAgWCA9IEdhbWUubW91c2VYIC0gd2lkdGggLSAyNDsKICAgICAgICAgIFkgPSBHYW1lLm1vdXNlWSAtIGhlaWdodCAvIDIgLSA4OwogICAgICAgICAgWCA9IE1hdGgubWF4KDAsIE1hdGgubWluKEdhbWUud2luZG93VyAtIHdpZHRoIC0gMTYsIFgpKTsKICAgICAgICAgIFkgPSBNYXRoLm1heCgwLCBNYXRoLm1pbihHYW1lLndpbmRvd0ggLSBoZWlnaHQgLSA2NCwgWSkpOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy5vcmlnaW4gPT0gInRoaXMiICYmIHRoaXMuZnJvbSkgewogICAgICAgICAgdmFyIHJlY3QgPSB0aGlzLmZyb20uZ2V0Qm91bmRzKCk7CiAgICAgICAgICBYID0gKHJlY3QubGVmdCArIHJlY3QucmlnaHQpIC8gMiAtIHdpZHRoIC8gMiAtIDg7CiAgICAgICAgICBZID0gcmVjdC50b3AgLSB0aGlzLnR0LmNsaWVudEhlaWdodCAtIDQ4OwogICAgICAgICAgWCA9IE1hdGgubWF4KDAsIE1hdGgubWluKEdhbWUud2luZG93VyAtIHdpZHRoIC0gMTYsIFgpKTsKICAgICAgICAgIC8vWT1NYXRoLm1heCgwLE1hdGgubWluKEdhbWUud2luZG93SC10aGlzLnR0LmNsaWVudEhlaWdodC02NCxZKSk7CiAgICAgICAgICBpZiAoWSA8IDApIFkgPSByZWN0LmJvdHRvbSAtIDI0OwogICAgICAgICAgaWYgKFkgKyBoZWlnaHQgKyA0MCA+IEdhbWUud2luZG93SCkgewogICAgICAgICAgICBYID0gcmVjdC5yaWdodCArIDg7CiAgICAgICAgICAgIFkgPSByZWN0LnRvcCArIChyZWN0LmJvdHRvbSAtIHJlY3QudG9wKSAvIDIgLSBoZWlnaHQgLyAyIC0gMzg7CiAgICAgICAgICAgIFkgPSBNYXRoLm1heCgwLCBNYXRoLm1pbihHYW1lLndpbmRvd0ggLSBoZWlnaHQgLSAxOSwgWSkpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBYID0gR2FtZS5tb3VzZVggLSB3aWR0aCAvIDIgLSA4OwogICAgICAgICAgWSA9IEdhbWUubW91c2VZIC0gaGVpZ2h0IC0gMzI7CiAgICAgICAgICBYID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oR2FtZS53aW5kb3dXIC0gd2lkdGggLSAxNiwgWCkpOwogICAgICAgICAgWSA9IE1hdGgubWF4KDAsIE1hdGgubWluKEdhbWUud2luZG93SCAtIGhlaWdodCAtIDY0LCBZKSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMudHRhLnN0eWxlLmxlZnQgPSBYICsgInB4IjsKICAgICAgdGhpcy50dGEuc3R5bGUucmlnaHQgPSAiYXV0byI7CiAgICAgIHRoaXMudHRhLnN0eWxlLnRvcCA9IFkgKyAicHgiOwogICAgICB0aGlzLnR0YS5zdHlsZS5ib3R0b20gPSAiYXV0byI7CiAgICAgIGlmICh0aGlzLnNob3VsZEhpZGUpIHsKICAgICAgICB0aGlzLmhpZGUoKTsKICAgICAgICB0aGlzLnNob3VsZEhpZGUgPSAwOwogICAgICB9IGVsc2UgaWYgKEdhbWUuZHJhd1QgJSAxMCA9PSAwICYmIHR5cGVvZiB0aGlzLnRleHQgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICB2YXIgdGV4dCA9IHRoaXMudGV4dCgpOwogICAgICAgIGlmICh0ZXh0ID09ICIiKSB0aGlzLnR0YS5zdHlsZS5vcGFjaXR5ID0gIjAiOwogICAgICAgIGVsc2UgewogICAgICAgICAgdGhpcy50dC5pbm5lckhUTUwgPSB1bmVzY2FwZSh0ZXh0KTsKICAgICAgICAgIHRoaXMudHRhLnN0eWxlLm9wYWNpdHkgPSAiMSI7CiAgICAgICAgfQogICAgICB9CiAgICB9OwogICAgR2FtZS50b29sdGlwLmhpZGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICh0aGlzLnR0YSkgdGhpcy50dGEuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgdGhpcy5keW5hbWljID0gMDsKICAgICAgdGhpcy5vbiA9IDA7CiAgICB9OwogICAgR2FtZS5nZXRUb29sdGlwID0gZnVuY3Rpb24gKHRleHQsIG9yaWdpbiwgaXNDcmF0ZSkgewogICAgICBvcmlnaW4gPSBvcmlnaW4gPyBvcmlnaW4gOiAibWlkZGxlIjsKICAgICAgaWYgKGlzQ3JhdGUpCiAgICAgICAgcmV0dXJuICgKICAgICAgICAgICdvbk1vdXNlT3V0PSJHYW1lLnNldE9uQ3JhdGUoMCk7R2FtZS50b29sdGlwLnNob3VsZEhpZGU9MTsiIG9uTW91c2VPdmVyPSJpZiAoIUdhbWUubW91c2VEb3duKSB7R2FtZS5zZXRPbkNyYXRlKHRoaXMpO0dhbWUudG9vbHRpcC5keW5hbWljPTA7R2FtZS50b29sdGlwLmRyYXcodGhpcyxcJycgKwogICAgICAgICAgZXNjYXBlKHRleHQpICsKICAgICAgICAgICInLCciICsKICAgICAgICAgIG9yaWdpbiArCiAgICAgICAgICAiJyk7R2FtZS50b29sdGlwLndvYmJsZSgpO31cIiIKICAgICAgICApOwogICAgICBlbHNlCiAgICAgICAgcmV0dXJuICgKICAgICAgICAgICdvbk1vdXNlT3V0PSJHYW1lLnRvb2x0aXAuc2hvdWxkSGlkZT0xOyIgb25Nb3VzZU92ZXI9IkdhbWUudG9vbHRpcC5keW5hbWljPTA7R2FtZS50b29sdGlwLmRyYXcodGhpcyxcJycgKwogICAgICAgICAgZXNjYXBlKHRleHQpICsKICAgICAgICAgICInLCciICsKICAgICAgICAgIG9yaWdpbiArCiAgICAgICAgICAiJyk7R2FtZS50b29sdGlwLndvYmJsZSgpO1wiIgogICAgICAgICk7CiAgICB9OwogICAgR2FtZS5nZXREeW5hbWljVG9vbHRpcCA9IGZ1bmN0aW9uIChmdW5jLCBvcmlnaW4sIGlzQ3JhdGUpIHsKICAgICAgb3JpZ2luID0gb3JpZ2luID8gb3JpZ2luIDogIm1pZGRsZSI7CiAgICAgIGlmIChpc0NyYXRlKQogICAgICAgIHJldHVybiAoCiAgICAgICAgICAnb25Nb3VzZU91dD0iR2FtZS5zZXRPbkNyYXRlKDApO0dhbWUudG9vbHRpcC5zaG91bGRIaWRlPTE7IiBvbk1vdXNlT3Zlcj0iaWYgKCFHYW1lLm1vdXNlRG93bikge0dhbWUuc2V0T25DcmF0ZSh0aGlzKTtHYW1lLnRvb2x0aXAuZHluYW1pYz0xO0dhbWUudG9vbHRpcC5kcmF3KHRoaXMsJyArCiAgICAgICAgICAiZnVuY3Rpb24oKXtyZXR1cm4gIiArCiAgICAgICAgICBmdW5jICsKICAgICAgICAgICIoKTt9IiArCiAgICAgICAgICAiLCciICsKICAgICAgICAgIG9yaWdpbiArCiAgICAgICAgICAiJyk7R2FtZS50b29sdGlwLndvYmJsZSgpO31cIiIKICAgICAgICApOwogICAgICByZXR1cm4gKAogICAgICAgICdvbk1vdXNlT3V0PSJHYW1lLnRvb2x0aXAuc2hvdWxkSGlkZT0xOyIgb25Nb3VzZU92ZXI9IkdhbWUudG9vbHRpcC5keW5hbWljPTE7R2FtZS50b29sdGlwLmRyYXcodGhpcywnICsKICAgICAgICAiZnVuY3Rpb24oKXtyZXR1cm4gIiArCiAgICAgICAgZnVuYyArCiAgICAgICAgIigpO30iICsKICAgICAgICAiLCciICsKICAgICAgICBvcmlnaW4gKwogICAgICAgICInKTtHYW1lLnRvb2x0aXAud29iYmxlKCk7XCIiCiAgICAgICk7CiAgICB9OwogICAgR2FtZS5hdHRhY2hUb29sdGlwID0gZnVuY3Rpb24gKGVsLCBmdW5jLCBvcmlnaW4pIHsKICAgICAgaWYgKHR5cGVvZiBmdW5jID09PSAic3RyaW5nIikgewogICAgICAgIHZhciBzdHIgPSBmdW5jOwogICAgICAgIGZ1bmMgPSAoZnVuY3Rpb24gKHN0cikgewogICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIHN0cjsKICAgICAgICAgIH07CiAgICAgICAgfSkoc3RyKTsKICAgICAgfQogICAgICBvcmlnaW4gPSBvcmlnaW4gPyBvcmlnaW4gOiAibWlkZGxlIjsKICAgICAgQWRkRXZlbnQoCiAgICAgICAgZWwsCiAgICAgICAgIm1vdXNlb3ZlciIsCiAgICAgICAgKGZ1bmN0aW9uIChmdW5jLCBlbCwgb3JpZ2luKSB7CiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBHYW1lLnRvb2x0aXAuZHluYW1pYyA9IDE7CiAgICAgICAgICAgIEdhbWUudG9vbHRpcC5kcmF3KGVsLCBmdW5jLCBvcmlnaW4pOwogICAgICAgICAgfTsKICAgICAgICB9KShmdW5jLCBlbCwgb3JpZ2luKQogICAgICApOwogICAgICBBZGRFdmVudCgKICAgICAgICBlbCwKICAgICAgICAibW91c2VvdXQiLAogICAgICAgIChmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBHYW1lLnRvb2x0aXAuc2hvdWxkSGlkZSA9IDE7CiAgICAgICAgICB9OwogICAgICAgIH0pKCkKICAgICAgKTsKICAgIH07CiAgICBHYW1lLnRvb2x0aXAud29iYmxlID0gZnVuY3Rpb24gKCkgewogICAgICAvL2Rpc2FibGVkIGJlY2F1c2UgdGhpcyBlZmZlY3QgZG9lc24ndCBsb29rIGdvb2Qgd2l0aCB0aGUgc2xpZ2h0IHNsb3dkb3duIGl0IG1pZ2h0IG9yIG1pZ2h0IG5vdCBiZSBjYXVzaW5nLgogICAgICBpZiAoZmFsc2UpIHsKICAgICAgICB0aGlzLnR0LmNsYXNzTmFtZSA9ICJmcmFtZWQiOwogICAgICAgIHZvaWQgdGhpcy50dC5vZmZzZXRXaWR0aDsKICAgICAgICB0aGlzLnR0LmNsYXNzTmFtZSA9ICJmcmFtZWQgd29iYmxpbmciOwogICAgICB9CiAgICB9OwoKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJCVVQREFURSBDSEVDS0VSCgkJPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KICAgIEdhbWUuQ2hlY2tVcGRhdGVzID0gZnVuY3Rpb24gKCkgewogICAgICBpZiAoIUFwcCkgYWpheCgic2VydmVyLnBocD9xPWNoZWNrdXBkYXRlIiwgR2FtZS5DaGVja1VwZGF0ZXNSZXNwb25zZSk7CiAgICB9OwogICAgR2FtZS5DaGVja1VwZGF0ZXNSZXNwb25zZSA9IGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICB2YXIgciA9IHJlc3BvbnNlLnNwbGl0KCJ8Iik7CiAgICAgIHZhciBzdHIgPSAiIjsKICAgICAgaWYgKHJbMF0gPT0gImFsZXJ0IikgewogICAgICAgIGlmIChyWzFdKSBzdHIgPSByWzFdOwogICAgICB9IGVsc2UgaWYgKHBhcnNlRmxvYXQoclswXSkgPiBHYW1lLnZlcnNpb24pIHsKICAgICAgICBzdHIgPSAiPGI+IiArIGxvYygiTmV3IHZlcnNpb24gYXZhaWxhYmxlOiB2LiAlMSEiLCByWzBdKSArICI8L2I+IjsKICAgICAgICBpZiAoclsxXSkKICAgICAgICAgIHN0ciArPSAiPGJyPjxzbWFsbD4iICsgbG9jKCdVcGRhdGUgbm90ZTogIiUxIicsIHJbMV0pICsgIjwvc21hbGw+IjsKICAgICAgICBzdHIgKz0gIjxicj48Yj4iICsgbG9jKCJSZWZyZXNoIHRvIGdldCBpdCEiKSArICI8L2I+IjsKICAgICAgfQogICAgICBpZiAoc3RyICE9ICIiKSB7CiAgICAgICAgbCgiYWxlcnQiKS5pbm5lckhUTUwgPSBzdHI7CiAgICAgICAgbCgiYWxlcnQiKS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgfQogICAgfTsKCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCQlEQVRBIEdSQUJCRVIKCQk9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwoKICAgIEdhbWUuZXh0ZXJuYWxEYXRhTG9hZGVkID0gZmFsc2U7CgogICAgR2FtZS5ncmFuZG1hTmFtZXMgPSBbCiAgICAgICJHcmFubnkiLAogICAgICAiR3VzaGVyIiwKICAgICAgIkV0aGVsIiwKICAgICAgIkVkbmEiLAogICAgICAiRG9yaXMiLAogICAgICAiTWF1ZCIsCiAgICAgICJIaWxkYSIsCiAgICAgICJHbGFkeXMiLAogICAgICAiTWljaGVsbGUiLAogICAgICAiTWljaGVsZSIsCiAgICAgICJQaHlsbGlzIiwKICAgICAgIk1pbGxpY2VudCIsCiAgICAgICJNdXJpZWwiLAogICAgICAiTXlydGxlIiwKICAgICAgIk1pbGRyZWQiLAogICAgICAiTWF2aXMiLAogICAgICAiSGVsZW4iLAogICAgICAiR2xvcmlhIiwKICAgICAgIlNoZWlsYSIsCiAgICAgICJCZXR0eSIsCiAgICAgICJHZXJ0cnVkZSIsCiAgICAgICJBZ2F0aGEiLAogICAgICAiQmVyeWwiLAogICAgICAiQWduZXMiLAogICAgICAiUGVhcmwiLAogICAgICAiUHJlY2lvdXMiLAogICAgICAiUnVieSIsCiAgICAgICJWZXJhIiwKICAgICAgIkJvbm5pZSIsCiAgICAgICJBZGEiLAogICAgICAiQnVubnkiLAogICAgICAiQ29va2llIiwKICAgICAgIkRhcmxpbmciLAogICAgICAiR2FnYSIsCiAgICAgICJHYW1HYW0iLAogICAgICAiTWVtYXciLAogICAgICAiTWltc3kiLAogICAgICAiUGVhbnV0IiwKICAgICAgIk5hbmEiLAogICAgICAiTmFuIiwKICAgICAgIlRvb3RzaWUiLAogICAgICAiV2FydHkiLAogICAgICAiU3Rpbmt5IiwKICAgICAgIkhlaW5vdXMiLAogICAgXTsKICAgIEdhbWUuY3VzdG9tR3JhbmRtYU5hbWVzID0gW107CiAgICBHYW1lLmhlcmFsZHMgPSAwOwoKICAgIEdhbWUuR3JhYkRhdGEgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICghQXBwKSBhamF4KCIvcGF0cmVvbi9ncmFiLnBocCIsIEdhbWUuR3JhYkRhdGFSZXNwb25zZSk7CiAgICAgIGVsc2UKICAgICAgICBBcHAuZ3JhYkRhdGEoZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgR2FtZS5oZXJhbGRzID0gcmVzID8gcmVzLnBsYXllcnNOIHx8IDEgOiAxOwogICAgICAgICAgR2FtZS5oZXJhbGRzID0gTWF0aC5tYXgoCiAgICAgICAgICAgIDAsCiAgICAgICAgICAgIE1hdGgubWluKDEwMCwgTWF0aC5jZWlsKChHYW1lLmhlcmFsZHMgLyAxMDApICogMTAwKSAvIDEwMCkKICAgICAgICAgICk7CiAgICAgICAgICBsKCJoZXJhbGRzQW1vdW50IikudGV4dENvbnRlbnQgPSBNYXRoLmZsb29yKEdhbWUuaGVyYWxkcyk7CiAgICAgICAgfSk7CiAgICB9OwogICAgR2FtZS5HcmFiRGF0YVJlc3BvbnNlID0gZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgIC8qCgkJCQlyZXNwb25zZSBzaG91bGQgYmUgZm9ybWF0dGVkIGFzCgkJCQl7ImhlcmFsZCI6MywiZ3JhbmRtYSI6ImF8YnxjfC4uLn0KCQkJKi8KICAgICAgdmFyIHIgPSB7fTsKICAgICAgdHJ5IHsKICAgICAgICByID0gSlNPTi5wYXJzZShyZXNwb25zZSk7CiAgICAgICAgaWYgKHR5cGVvZiByWyJoZXJhbGQiXSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgIEdhbWUuaGVyYWxkcyA9IHBhcnNlSW50KHJbImhlcmFsZCJdKTsKICAgICAgICAgIEdhbWUuaGVyYWxkcyA9IE1hdGgubWF4KDAsIE1hdGgubWluKDEwMCwgR2FtZS5oZXJhbGRzKSk7CiAgICAgICAgfQogICAgICAgIGlmICh0eXBlb2YgclsiZ3JhbmRtYSJdICE9PSAidW5kZWZpbmVkIiAmJiByWyJncmFuZG1hIl0gIT0gIiIpIHsKICAgICAgICAgIEdhbWUuY3VzdG9tR3JhbmRtYU5hbWVzID0gclsiZ3JhbmRtYSJdLnNwbGl0KCJ8Iik7CiAgICAgICAgICBHYW1lLmN1c3RvbUdyYW5kbWFOYW1lcyA9IEdhbWUuY3VzdG9tR3JhbmRtYU5hbWVzLmZpbHRlcihmdW5jdGlvbiAoCiAgICAgICAgICAgIGVsCiAgICAgICAgICApIHsKICAgICAgICAgICAgcmV0dXJuIGVsICE9ICIiOwogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBsKCJoZXJhbGRzQW1vdW50IikudGV4dENvbnRlbnQgPSBNYXRoLmZsb29yKEdhbWUuaGVyYWxkcyk7CiAgICAgICAgR2FtZS5leHRlcm5hbERhdGFMb2FkZWQgPSB0cnVlOwogICAgICB9IGNhdGNoIChlKSB7fQogICAgfTsKCiAgICBpZiAoIUFwcCkgewogICAgICBHYW1lLmF0dGFjaFRvb2x0aXAoCiAgICAgICAgbCgiaHR0cHNTd2l0Y2giKSwKICAgICAgICAnPGRpdiBzdHlsZT0icGFkZGluZzo4cHg7d2lkdGg6MzUwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Zm9udC1zaXplOjExcHg7Ij4nICsKICAgICAgICAgIGxvYygKICAgICAgICAgICAgIllvdSBhcmUgY3VycmVudGx5IHBsYXlpbmcgQ29va2llIENsaWNrZXIgb24gdGhlIDxiPiUxPC9iPiBwcm90b2NvbC48YnI+VGhlIDxiPiUyPC9iPiB2ZXJzaW9uIHVzZXMgYSBkaWZmZXJlbnQgc2F2ZSBzbG90IHRoYW4gdGhpcyBvbmUuPGJyPkNsaWNrIHRoaXMgbG9jayB0byByZWxvYWQgdGhlIHBhZ2UgYW5kIHN3aXRjaCB0byB0aGUgPGI+JTI8L2I+IHZlcnNpb24hIiwKICAgICAgICAgICAgW0dhbWUuaHR0cHMgPyAiSFRUUFMiIDogIkhUVFAiLCBHYW1lLmh0dHBzID8gIkhUVFAiIDogIkhUVFBTIl0KICAgICAgICAgICkgKwogICAgICAgICAgIjwvZGl2PiIsCiAgICAgICAgInRoaXMiCiAgICAgICk7CiAgICAgIEFkZEV2ZW50KGwoImh0dHBzU3dpdGNoIiksICJjbGljayIsIGZ1bmN0aW9uICgpIHsKICAgICAgICBQbGF5U291bmQoInNuZC9wb3AiICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMyArIDEpICsgIi5tcDMiLCAwLjc1KTsKICAgICAgICBpZiAobG9jYXRpb24ucHJvdG9jb2wgPT0gImh0dHBzOiIpCiAgICAgICAgICBsb2NhdGlvbi5ocmVmID0KICAgICAgICAgICAgImh0dHA6IiArCiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmLnN1YnN0cmluZyh3aW5kb3cubG9jYXRpb24ucHJvdG9jb2wubGVuZ3RoKTsKICAgICAgICBlbHNlIGlmIChsb2NhdGlvbi5wcm90b2NvbCA9PSAiaHR0cDoiKQogICAgICAgICAgbG9jYXRpb24uaHJlZiA9CiAgICAgICAgICAgICJodHRwczoiICsKICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYuc3Vic3RyaW5nKHdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbC5sZW5ndGgpOwogICAgICB9KTsKCiAgICAgIEFkZEV2ZW50KGwoImNoYW5nZUxhbmd1YWdlIiksICJjbGljayIsIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLnNob3dMYW5nU2VsZWN0aW9uKCk7CiAgICAgIH0pOwoKICAgICAgR2FtZS5hdHRhY2hUb29sdGlwKAogICAgICAgIGwoInRvcGJhck9ydGVpbCIpLAogICAgICAgICc8ZGl2IHN0eWxlPSJwYWRkaW5nOjhweDt3aWR0aDoyNTBweDt0ZXh0LWFsaWduOmNlbnRlcjsiPkJhY2sgdG8gT3J0ZWlsXCdzIHN1YmRvbWFpbiE8YnI+TG90cyBvZiBvdGhlciBnYW1lcyBpbiB0aGVyZSE8L2Rpdj4nICsKICAgICAgICAgIHRpbnlJY29uKFsxNywgNV0sICJkaXNwbGF5OmJsb2NrO21hcmdpbjotMTJweCBhdXRvOyIpLAogICAgICAgICJ0aGlzIgogICAgICApOwogICAgICBHYW1lLmF0dGFjaFRvb2x0aXAoCiAgICAgICAgbCgidG9wYmFyRGFzaG5ldCIpLAogICAgICAgICc8ZGl2IHN0eWxlPSJwYWRkaW5nOjhweDt3aWR0aDoyNTBweDt0ZXh0LWFsaWduOmNlbnRlcjsiPkJhY2sgdG8gb3VyIGhvbWVwYWdlITwvZGl2PicsCiAgICAgICAgInRoaXMiCiAgICAgICk7CiAgICAgIEdhbWUuYXR0YWNoVG9vbHRpcCgKICAgICAgICBsKCJ0b3BiYXJUd2l0dGVyIiksCiAgICAgICAgJzxkaXYgc3R5bGU9InBhZGRpbmc6OHB4O3dpZHRoOjI1MHB4O3RleHQtYWxpZ246Y2VudGVyOyI+T3J0ZWlsXCdzIHR3aXR0ZXIsIHdoaWNoIGZyZXF1ZW50bHkgZmVhdHVyZXMgZ2FtZSB1cGRhdGVzLjwvZGl2PicsCiAgICAgICAgInRoaXMiCiAgICAgICk7CiAgICAgIEdhbWUuYXR0YWNoVG9vbHRpcCgKICAgICAgICBsKCJ0b3BiYXJUdW1ibHIiKSwKICAgICAgICAnPGRpdiBzdHlsZT0icGFkZGluZzo4cHg7d2lkdGg6MjUwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Ij5PcnRlaWxcJ3MgdHVtYmxyLCB3aGljaCBmcmVxdWVudGx5IGZlYXR1cmVzIGdhbWUgdXBkYXRlcy48L2Rpdj4nLAogICAgICAgICJ0aGlzIgogICAgICApOwogICAgICBHYW1lLmF0dGFjaFRvb2x0aXAoCiAgICAgICAgbCgidG9wYmFyRGlzY29yZCIpLAogICAgICAgICc8ZGl2IHN0eWxlPSJwYWRkaW5nOjhweDt3aWR0aDoyNTBweDt0ZXh0LWFsaWduOmNlbnRlcjsiPk91ciBvZmZpY2lhbCBkaXNjb3JkIHNlcnZlci48YnI+WW91IGNhbiBzaGFyZSB0aXBzIGFuZCBxdWVzdGlvbnMgYWJvdXQgQ29va2llIENsaWNrZXIgYW5kIGFsbCBvdXIgb3RoZXIgZ2FtZXMhPC9kaXY+JywKICAgICAgICAidGhpcyIKICAgICAgKTsKICAgICAgR2FtZS5hdHRhY2hUb29sdGlwKAogICAgICAgIGwoInRvcGJhclBhdHJlb24iKSwKICAgICAgICAnPGRpdiBzdHlsZT0icGFkZGluZzo4cHg7d2lkdGg6MjUwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Ij5TdXBwb3J0IHVzIG9uIFBhdHJlb24gYW5kIGhlbHAgdXMga2VlcCB1cGRhdGluZyBDb29raWUgQ2xpY2tlciE8YnI+VGhlcmVcJ3MgbmVhdCByZXdhcmRzIGZvciBwYXRyb25zIHRvbyE8L2Rpdj4nLAogICAgICAgICJ0aGlzIgogICAgICApOwogICAgICBHYW1lLmF0dGFjaFRvb2x0aXAoCiAgICAgICAgbCgidG9wYmFyTWVyY2giKSwKICAgICAgICAnPGRpdiBzdHlsZT0icGFkZGluZzo4cHg7d2lkdGg6MjUwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Ij5Db29raWUgQ2xpY2tlciBzaGlydHMsIGhvb2RpZXMgYW5kIHN0aWNrZXJzITwvZGl2PicsCiAgICAgICAgInRoaXMiCiAgICAgICk7CiAgICAgIEdhbWUuYXR0YWNoVG9vbHRpcCgKICAgICAgICBsKCJ0b3BiYXJNb2JpbGVDQyIpLAogICAgICAgICc8ZGl2IHN0eWxlPSJwYWRkaW5nOjhweDt3aWR0aDoyNTBweDt0ZXh0LWFsaWduOmNlbnRlcjsiPlBsYXkgQ29va2llIENsaWNrZXIgb24geW91ciBwaG9uZSE8YnI+KEFuZHJvaWQgb25seTsgaU9TIHZlcnNpb24gd2lsbCBiZSByZWxlYXNlZCBsYXRlcik8L2Rpdj4nLAogICAgICAgICJ0aGlzIgogICAgICApOwogICAgICBHYW1lLmF0dGFjaFRvb2x0aXAoCiAgICAgICAgbCgidG9wYmFyU3RlYW1DQyIpLAogICAgICAgICc8ZGl2IHN0eWxlPSJwYWRkaW5nOjhweDt3aWR0aDoyNTBweDt0ZXh0LWFsaWduOmNlbnRlcjsiPkdldCBDb29raWUgQ2xpY2tlciBvbiBTdGVhbSE8YnI+RmVhdHVyaW5nIG11c2ljIGJ5IEM0MTguPC9kaXY+JywKICAgICAgICAidGhpcyIKICAgICAgKTsKICAgICAgR2FtZS5hdHRhY2hUb29sdGlwKAogICAgICAgIGwoInRvcGJhclJhbmRvbWdlbiIpLAogICAgICAgICc8ZGl2IHN0eWxlPSJwYWRkaW5nOjhweDt3aWR0aDoyNTBweDt0ZXh0LWFsaWduOmNlbnRlcjsiPkEgdGhpbmcgd2UgbWFkZSB0aGF0IGxldHMgeW91IHdyaXRlIHJhbmRvbSBnZW5lcmF0b3JzLjwvZGl2PicsCiAgICAgICAgInRoaXMiCiAgICAgICk7CiAgICAgIEdhbWUuYXR0YWNoVG9vbHRpcCgKICAgICAgICBsKCJ0b3BiYXJJR00iKSwKICAgICAgICAnPGRpdiBzdHlsZT0icGFkZGluZzo4cHg7d2lkdGg6MjUwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Ij5BIHRoaW5nIHdlIG1hZGUgdGhhdCBsZXRzIHlvdSBjcmVhdGUgeW91ciBvd24gaWRsZSBnYW1lcyB1c2luZyBhIHNpbXBsZSBzY3JpcHRpbmcgbGFuZ3VhZ2UuPC9kaXY+JywKICAgICAgICAidGhpcyIKICAgICAgKTsKICAgICAgbCgiY2hhbmdlTGFuZ3VhZ2UiKS5pbm5lckhUTUwgPSBsb2MoIkNoYW5nZSBsYW5ndWFnZSIpOwogICAgICBsKCJsaW5rcyIpLmNoaWxkTm9kZXNbMF0ubm9kZVZhbHVlID0gbG9jKCJPdGhlciB2ZXJzaW9ucyIpOwogICAgICAvL2woJ2xpbmtWZXJzaW9uQmV0YScpLmlubmVySFRNTD1sb2MoIkJldGEiKTsKICAgIH0KCiAgICBHYW1lLmF0dGFjaFRvb2x0aXAoCiAgICAgIGwoImhlcmFsZHMiKSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBzdHIgPSAiIjsKCiAgICAgICAgaWYgKCFBcHAgJiYgIUdhbWUuZXh0ZXJuYWxEYXRhTG9hZGVkKQogICAgICAgICAgc3RyICs9IGxvYygKICAgICAgICAgICAgIkhlcmFsZHMgY291bGRuJ3QgYmUgbG9hZGVkLiBUaGVyZSBtYXkgYmUgYW4gaXNzdWUgd2l0aCBvdXIgc2VydmVycywgb3IgeW91IGFyZSBwbGF5aW5nIHRoZSBnYW1lIGxvY2FsbHkuIgogICAgICAgICAgKTsKICAgICAgICBlbHNlIHsKICAgICAgICAgIGlmICghQXBwICYmIEdhbWUuaGVyYWxkcyA9PSAwKQogICAgICAgICAgICBzdHIgKz0gbG9jKAogICAgICAgICAgICAgICdUaGVyZSBhcmUgbm8gaGVyYWxkcyBhdCB0aGUgbW9tZW50LiBQbGVhc2UgY29uc2lkZXIgPGIgc3R5bGU9ImNvbG9yOiNiYzNhZmY7Ij5kb25hdGluZyB0byBvdXIgUGF0cmVvbjwvYj4hJwogICAgICAgICAgICApOwogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHN0ciArPQogICAgICAgICAgICAgICc8YiBzdHlsZT0iY29sb3I6I2JjM2FmZjt0ZXh0LXNoYWRvdzowcHggMXB4IDBweCAjNmQwMDk2OyI+JyArCiAgICAgICAgICAgICAgbG9jKCIlMSBoZXJhbGQiLCBHYW1lLmhlcmFsZHMpICsKICAgICAgICAgICAgICAiPC9iPiAiICsKICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAic2VsZmxlc3NseSBpbnNwaXJpbmcgYSBib29zdCBpbiBwcm9kdWN0aW9uIGZvciBldmVyeW9uZSwgcmVzdWx0aW5nIGluICUxLiIsCiAgICAgICAgICAgICAgICAnPGJyPjxiIHN0eWxlPSJjb2xvcjojY2RhYTg5O3RleHQtc2hhZG93OjBweCAxcHggMHB4ICM3YzQ1MzIsMHB4IDBweCA2cHggIzdjNDUzMjsiPjxkaXYgc3R5bGU9IndpZHRoOjE2cHg7aGVpZ2h0OjE2cHg7ZGlzcGxheTppbmxpbmUtYmxvY2s7dmVydGljYWwtYWxpZ246bWlkZGxlO2JhY2tncm91bmQ6dXJsKGltZy9tb25leS5wbmcpOyI+PC9kaXY+JyArCiAgICAgICAgICAgICAgICAgIGxvYygiKyUxJSBjb29raWVzIHBlciBzZWNvbmQiLCBHYW1lLmhlcmFsZHMpICsKICAgICAgICAgICAgICAgICAgIjwvYj4iCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgc3RyICs9ICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nOwogICAgICAgICAgICBpZiAoR2FtZS5hc2NlbnNpb25Nb2RlID09IDEpCiAgICAgICAgICAgICAgc3RyICs9IGxvYygKICAgICAgICAgICAgICAgICJZb3UgYXJlIGluIGEgPGI+Qm9ybiBhZ2FpbjwvYj4gcnVuLCBhbmQgYXJlIG5vdCBjdXJyZW50bHkgYmVuZWZpdGluZyBmcm9tIGhlcmFsZHMuIgogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGVsc2UgaWYgKEdhbWUuSGFzKCJIZXJhbGRzIikpCiAgICAgICAgICAgICAgc3RyICs9IGxvYygKICAgICAgICAgICAgICAgICJZb3Ugb3duIHRoZSA8Yj5IZXJhbGRzPC9iPiB1cGdyYWRlLCBhbmQgdGhlcmVmb3JlIGJlbmVmaXQgZnJvbSB0aGUgcHJvZHVjdGlvbiBib29zdC4iCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgIHN0ciArPSBsb2MoCiAgICAgICAgICAgICAgICAiVG8gYmVuZWZpdCBmcm9tIHRoZSBoZXJhbGQgYm9udXMsIHlvdSBuZWVkIGEgc3BlY2lhbCB1cGdyYWRlIHlvdSBkbyBub3QgeWV0IG93bi4gWW91IHdpbGwgcGVybWFuZW50bHkgdW5sb2NrIGl0IGxhdGVyIGluIHRoZSBnYW1lLiIKICAgICAgICAgICAgICApOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBzdHIgKz0KICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj48c3BhbiBzdHlsZT0iZm9udC1zaXplOjkwJTtvcGFjaXR5OjAuNjsiPicgKwogICAgICAgICAgKCFBcHAKICAgICAgICAgICAgPyBsb2MoCiAgICAgICAgICAgICAgICAiPGI+SGVyYWxkczwvYj4gYXJlIHBlb3BsZSB3aG8gaGF2ZSBkb25hdGVkIHRvIG91ciBoaWdoZXN0IFBhdHJlb24gdGllciwgYW5kIGFyZSBsaW1pdGVkIHRvIDEwMC48YnI+RWFjaCBoZXJhbGQgZ2l2ZXMgZXZlcnlvbmUgKzElIENwUy48YnI+SGVyYWxkcyBiZW5lZml0IGV2ZXJ5b25lIHBsYXlpbmcgdGhlIGdhbWUsIHJlZ2FyZGxlc3Mgb2Ygd2hldGhlciB5b3UgZG9uYXRlZC4iCiAgICAgICAgICAgICAgKQogICAgICAgICAgICA6IGxvYygKICAgICAgICAgICAgICAgICJFdmVyeSAlMSBjdXJyZW50IHBsYXllcnMgb24gU3RlYW0gZ2VuZXJhdGVzIDxiPjEgaGVyYWxkPC9iPiwgdXAgdG8gJTIgaGVyYWxkcy48YnI+RWFjaCBoZXJhbGQgZ2l2ZXMgZXZlcnlvbmUgKzElIENwUy4iLAogICAgICAgICAgICAgICAgWzEwMCwgMTAwXQogICAgICAgICAgICAgICkpICsKICAgICAgICAgICc8L3NwYW4+PGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgICB0aW55SWNvbihbMjEsIDI5XSk7CgogICAgICAgIHN0ciArPQogICAgICAgICAgJzxkaXYgc3R5bGU9IndpZHRoOjMxcHg7aGVpZ2h0OjM5cHg7YmFja2dyb3VuZDp1cmwoaW1nL2hlcmFsZEZsYWcucG5nKTtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MHB4O2xlZnQ6OHB4OyI+PC9kaXY+PGRpdiBzdHlsZT0id2lkdGg6MzFweDtoZWlnaHQ6MzlweDtiYWNrZ3JvdW5kOnVybChpbWcvaGVyYWxkRmxhZy5wbmcpO3Bvc2l0aW9uOmFic29sdXRlO3RvcDowcHg7cmlnaHQ6OHB4OyI+PC9kaXY+JzsKCiAgICAgICAgcmV0dXJuICgKICAgICAgICAgICc8ZGl2IHN0eWxlPSJwYWRkaW5nOjhweDt3aWR0aDozMDBweDt0ZXh0LWFsaWduOmNlbnRlcjsiIGNsYXNzPSJwcm9tcHQiIGlkPSJ0b29sdGlwSGVyYWxkcyI+PGgzPicgKwogICAgICAgICAgbG9jKCJIZXJhbGRzIikgKwogICAgICAgICAgJzwvaDM+PGRpdiBjbGFzcz0iYmxvY2siPicgKwogICAgICAgICAgc3RyICsKICAgICAgICAgICI8L2Rpdj48L2Rpdj4iCiAgICAgICAgKTsKICAgICAgfSwKICAgICAgInRoaXMiCiAgICApOwogICAgbCgiaGVyYWxkc0Ftb3VudCIpLnRleHRDb250ZW50ID0gIj8iOwogICAgbCgiaGVyYWxkcyIpLnN0eWxlLmRpc3BsYXkgPSAiaW5saW5lLWJsb2NrIjsKICAgIGlmIChBcHApIHsKICAgICAgbCgiaGVyYWxkcyIpLnN0eWxlLnBhZGRpbmdUb3AgPSAiNHB4IjsKICAgICAgbCgiaGVyYWxkcyIpLnN0eWxlLnBvc2l0aW9uID0gImFic29sdXRlIjsKICAgICAgbCgiaGVyYWxkcyIpLnN0eWxlLnRvcCA9ICIwcHgiOwogICAgICBsKCJoZXJhbGRzIikuc3R5bGUucmlnaHQgPSAiMHB4IjsKICAgICAgbCgiaGVyYWxkcyIpLnN0eWxlLndpZHRoID0gIjI4cHgiOwogICAgICBsKCJoZXJhbGRzIikuc3R5bGUudGV4dEFsaWduID0gImNlbnRlciI7CiAgICAgIGwoImxlZnRCZWFtIikuYXBwZW5kQ2hpbGQobCgiaGVyYWxkcyIpKTsKCiAgICAgIGwoImJ1ZmZzIikuc3R5bGUudG9wID0gIjE2cHgiOwogICAgfQoKICAgIEdhbWUuR3JhYkRhdGEoKTsKCiAgICBHYW1lLnVzZUxvY2FsU3RvcmFnZSA9IDE7CiAgICAvL3dpbmRvdy5sb2NhbFN0b3JhZ2UuY2xlYXIoKTsvL3dvbid0IHN3aXRjaCBiYWNrIHRvIGNvb2tpZS1iYXNlZCBpZiB0aGVyZSBpcyBsb2NhbFN0b3JhZ2UgaW5mbwoKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJCVNBVkUKCQk9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgR2FtZS5FeHBvcnRTYXZlID0gZnVuY3Rpb24gKCkgewogICAgICAvL2lmIChBcHApIHJldHVybiBmYWxzZTsKICAgICAgR2FtZS5wcmVmcy5zaG93QmFja3VwV2FybmluZyA9IDA7CiAgICAgIEdhbWUuUHJvbXB0KAogICAgICAgICI8aWQgRXhwb3J0U2F2ZT48aDM+IiArCiAgICAgICAgICBsb2MoIkV4cG9ydCBzYXZlIikgKwogICAgICAgICAgJzwvaDM+PGRpdiBjbGFzcz0iYmxvY2siPicgKwogICAgICAgICAgbG9jKAogICAgICAgICAgICAiVGhpcyBpcyB5b3VyIHNhdmUgY29kZS48YnI+Q29weSBpdCBhbmQga2VlcCBpdCBzb21ld2hlcmUgc2FmZSEiCiAgICAgICAgICApICsKICAgICAgICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJibG9jayI+PHRleHRhcmVhIGlkPSJ0ZXh0YXJlYVByb21wdCIgc3R5bGU9IndpZHRoOjEwMCU7aGVpZ2h0OjEyOHB4OyIgcmVhZG9ubHk+JyArCiAgICAgICAgICBHYW1lLldyaXRlU2F2ZSgxKSArCiAgICAgICAgICAiPC90ZXh0YXJlYT48L2Rpdj4iLAogICAgICAgIFtsb2MoIkFsbCBkb25lISIpXQogICAgICApOyAvL3Byb21wdCgnQ29weSB0aGlzIHRleHQgYW5kIGtlZXAgaXQgc29tZXdoZXJlIHNhZmUhJyxHYW1lLldyaXRlU2F2ZSgxKSk7CiAgICAgIGwoInRleHRhcmVhUHJvbXB0IikuZm9jdXMoKTsKICAgICAgbCgidGV4dGFyZWFQcm9tcHQiKS5zZWxlY3QoKTsKICAgIH07CiAgICBHYW1lLkltcG9ydFNhdmUgPSBmdW5jdGlvbiAoZGVmKSB7CiAgICAgIC8vaWYgKEFwcCkgcmV0dXJuIGZhbHNlOwogICAgICBHYW1lLlByb21wdCgKICAgICAgICAiPGlkIEltcG9ydFNhdmU+PGgzPiIgKwogICAgICAgICAgbG9jKCJJbXBvcnQgc2F2ZSIpICsKICAgICAgICAgICc8L2gzPjxkaXYgY2xhc3M9ImJsb2NrIj4nICsKICAgICAgICAgIGxvYygKICAgICAgICAgICAgIlBsZWFzZSBwYXN0ZSBpbiB0aGUgY29kZSB0aGF0IHdhcyBnaXZlbiB0byB5b3Ugb24gc2F2ZSBleHBvcnQuIgogICAgICAgICAgKSArCiAgICAgICAgICAnPGRpdiBpZD0iaW1wb3J0RXJyb3IiIGNsYXNzPSJ3YXJuaW5nIiBzdHlsZT0iZm9udC13ZWlnaHQ6Ym9sZDtmb250LXNpemU6MTFweDsiPjwvZGl2PjwvZGl2PjxkaXYgY2xhc3M9ImJsb2NrIj48dGV4dGFyZWEgaWQ9InRleHRhcmVhUHJvbXB0IiBzdHlsZT0id2lkdGg6MTAwJTtoZWlnaHQ6MTI4cHg7Ij4nICsKICAgICAgICAgIChkZWYgfHwgIiIpICsKICAgICAgICAgICI8L3RleHRhcmVhPjwvZGl2PiIsCiAgICAgICAgWwogICAgICAgICAgWwogICAgICAgICAgICBsb2MoIkxvYWQiKSwKICAgICAgICAgICAgImlmIChsKCd0ZXh0YXJlYVByb21wdCcpLnZhbHVlLmxlbmd0aD09MCl7cmV0dXJuIGZhbHNlO31pZiAoR2FtZS5JbXBvcnRTYXZlQ29kZShsKCd0ZXh0YXJlYVByb21wdCcpLnZhbHVlKSl7R2FtZS5DbG9zZVByb21wdCgpO31lbHNle2woJ2ltcG9ydEVycm9yJykuaW5uZXJIVE1MPScoJytsb2MoXCJFcnJvciBpbXBvcnRpbmcgc2F2ZVwiKSsnKSc7fSIsCiAgICAgICAgICBdLAogICAgICAgICAgbG9jKCJOZXZlcm1pbmQiKSwKICAgICAgICBdCiAgICAgICk7IC8vcHJvbXB0KCdQbGVhc2UgcGFzdGUgaW4gdGhlIHRleHQgdGhhdCB3YXMgZ2l2ZW4gdG8geW91IG9uIHNhdmUgZXhwb3J0LicsJycpOwogICAgICBsKCJ0ZXh0YXJlYVByb21wdCIpLmZvY3VzKCk7CiAgICB9OwogICAgR2FtZS5JbXBvcnRTYXZlQ29kZSA9IGZ1bmN0aW9uIChzYXZlKSB7CiAgICAgIHZhciBvdXQgPSBmYWxzZTsKICAgICAgaWYgKHNhdmUgJiYgc2F2ZSAhPSAiIikgb3V0ID0gR2FtZS5Mb2FkU2F2ZShzYXZlKTsKICAgICAgaWYgKG91dCAmJiBBcHAgJiYgQXBwLm9uSW1wb3J0U2F2ZSkgQXBwLm9uSW1wb3J0U2F2ZShvdXQsIHNhdmUpOwogICAgICByZXR1cm4gb3V0OwogICAgfTsKCiAgICBHYW1lLkZpbGVTYXZlID0gZnVuY3Rpb24gKCkgewogICAgICBpZiAoQXBwKSByZXR1cm4gZmFsc2U7CiAgICAgIEdhbWUucHJlZnMuc2hvd0JhY2t1cFdhcm5pbmcgPSAwOwogICAgICB2YXIgZmlsZW5hbWUgPSBHYW1lLmJha2VyeU5hbWUucmVwbGFjZSgvW15hLXpBLVowLTldKy9nLCAiIikgKyAiQmFrZXJ5IjsKICAgICAgdmFyIHRleHQgPSBHYW1lLldyaXRlU2F2ZSgxKTsKICAgICAgdmFyIGJsb2IgPSBuZXcgQmxvYihbdGV4dF0sIHsgdHlwZTogInRleHQvcGxhaW47Y2hhcnNldD11dGYtOCIgfSk7CiAgICAgIHNhdmVBcyhibG9iLCBmaWxlbmFtZSArICIudHh0Iik7CiAgICB9OwogICAgR2FtZS5GaWxlTG9hZCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIGlmIChBcHApIHJldHVybiBmYWxzZTsKICAgICAgaWYgKGUudGFyZ2V0LmZpbGVzLmxlbmd0aCA9PSAwKSByZXR1cm4gZmFsc2U7CiAgICAgIHZhciBmaWxlID0gZS50YXJnZXQuZmlsZXNbMF07CiAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwogICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICBHYW1lLkltcG9ydFNhdmVDb2RlKGUudGFyZ2V0LnJlc3VsdCk7CiAgICAgIH07CiAgICAgIHJlYWRlci5yZWFkQXNUZXh0KGZpbGUpOwogICAgfTsKCiAgICBHYW1lLnRvUmVsb2FkID0gZmFsc2U7CiAgICBHYW1lLnRvU2F2ZSA9IGZhbHNlOwogICAgR2FtZS50b1F1aXQgPSBmYWxzZTsKICAgIEdhbWUuaXNTYXZpbmcgPSBmYWxzZTsgLy90cnVlIHdoaWxlIHdlJ3JlIHNhdmluZywgdG8gYmxvY2sgc29tZSBiZWhhdmlvcjsgd2hlbiBpbiBBcHAgbW9kZSBzYXZpbmcgbWF5IGJlIGFzeW5jaHJvbm91cwogICAgR2FtZS5sYXN0U2F2ZURhdGEgPSAiIjsKICAgIEdhbWUuV3JpdGVTYXZlID0gZnVuY3Rpb24gKHR5cGUpIHsKICAgICAgR2FtZS50b1NhdmUgPSBmYWxzZTsKICAgICAgLy90eXBlOiBub25lIGlzIGRlZmF1bHQsIDE9cmV0dXJuIHN0cmluZyBvbmx5LCAyPXJldHVybiB1bmNvbXByZXNzZWQgc3RyaW5nLCAzPXJldHVybiB1bmNvbXByZXNzZWQsIGNvbW1lbnRlZCBzdHJpbmcKICAgICAgR2FtZS5sYXN0RGF0ZSA9IHBhcnNlSW50KEdhbWUudGltZSk7CiAgICAgIHZhciBzdHIgPSAiIjsKICAgICAgaWYgKHR5cGUgPT0gMykgc3RyICs9ICJcbkdhbWUgdmVyc2lvblxuIjsKICAgICAgc3RyICs9IEdhbWUudmVyc2lvbiArICJ8IjsKICAgICAgc3RyICs9ICJ8IjsgLy9qdXN0IGluIGNhc2Ugd2UgbmVlZCBzb21lIG1vcmUgc3R1ZmYgaGVyZQogICAgICBpZiAodHlwZSA9PSAzKSBzdHIgKz0gIlxuXG5SdW4gZGV0YWlscyI7CiAgICAgIHN0ciArPSAvL3NhdmUgc3RhdHMKICAgICAgICAodHlwZSA9PSAzID8gIlxuCXJ1biBzdGFydCBkYXRlIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VJbnQoR2FtZS5zdGFydERhdGUpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JbGVnYWN5IHN0YXJ0IGRhdGUgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChHYW1lLmZ1bGxEYXRlKSArCiAgICAgICAgIjsiICsKICAgICAgICAodHlwZSA9PSAzID8gIlxuCWRhdGUgd2hlbiB3ZSBsYXN0IG9wZW5lZCB0aGUgZ2FtZSA6ICIgOiAiIikgKwogICAgICAgIHBhcnNlSW50KEdhbWUubGFzdERhdGUpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JYmFrZXJ5IG5hbWUgOiAiIDogIiIpICsKICAgICAgICBHYW1lLmJha2VyeU5hbWUgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbglzZWVkIDogIiA6ICIiKSArCiAgICAgICAgR2FtZS5zZWVkICsKICAgICAgICAifCI7CiAgICAgIGlmICh0eXBlID09IDMpIHN0ciArPSAiXG5cblBhY2tlZCBwcmVmZXJlbmNlcyBiaXRmaWVsZFxuCSI7CiAgICAgIHZhciBzdHIyID0gLy9wcmVmcwogICAgICAgIChHYW1lLnByZWZzLnBhcnRpY2xlcyA/ICIxIiA6ICIwIikgKwogICAgICAgIChHYW1lLnByZWZzLm51bWJlcnMgPyAiMSIgOiAiMCIpICsKICAgICAgICAoR2FtZS5wcmVmcy5hdXRvc2F2ZSA/ICIxIiA6ICIwIikgKwogICAgICAgIChHYW1lLnByZWZzLmF1dG91cGRhdGUgPyAiMSIgOiAiMCIpICsKICAgICAgICAoR2FtZS5wcmVmcy5taWxrID8gIjEiIDogIjAiKSArCiAgICAgICAgKEdhbWUucHJlZnMuZmFuY3kgPyAiMSIgOiAiMCIpICsKICAgICAgICAoR2FtZS5wcmVmcy53YXJuID8gIjEiIDogIjAiKSArCiAgICAgICAgKEdhbWUucHJlZnMuY3Vyc29ycyA/ICIxIiA6ICIwIikgKwogICAgICAgIChHYW1lLnByZWZzLmZvY3VzID8gIjEiIDogIjAiKSArCiAgICAgICAgKEdhbWUucHJlZnMuZm9ybWF0ID8gIjEiIDogIjAiKSArCiAgICAgICAgKEdhbWUucHJlZnMubm90aWZzID8gIjEiIDogIjAiKSArCiAgICAgICAgKEdhbWUucHJlZnMud29iYmx5ID8gIjEiIDogIjAiKSArCiAgICAgICAgKEdhbWUucHJlZnMubW9ub3NwYWNlID8gIjEiIDogIjAiKSArCiAgICAgICAgKEdhbWUucHJlZnMuZmlsdGVycyA/ICIxIiA6ICIwIikgKwogICAgICAgIChHYW1lLnByZWZzLmNvb2tpZXNvdW5kID8gIjEiIDogIjAiKSArCiAgICAgICAgKEdhbWUucHJlZnMuY3JhdGVzID8gIjEiIDogIjAiKSArCiAgICAgICAgKEdhbWUucHJlZnMuc2hvd0JhY2t1cFdhcm5pbmcgPyAiMSIgOiAiMCIpICsKICAgICAgICAoR2FtZS5wcmVmcy5leHRyYUJ1dHRvbnMgPyAiMSIgOiAiMCIpICsKICAgICAgICAoR2FtZS5wcmVmcy5hc2tMdW1wcyA/ICIxIiA6ICIwIikgKwogICAgICAgIChHYW1lLnByZWZzLmN1c3RvbUdyYW5kbWFzID8gIjEiIDogIjAiKSArCiAgICAgICAgKEdhbWUucHJlZnMudGltZW91dCA/ICIxIiA6ICIwIikgKwogICAgICAgIChHYW1lLnByZWZzLmNsb3VkU2F2ZSA/ICIxIiA6ICIwIikgKwogICAgICAgIChHYW1lLnByZWZzLmJnTXVzaWMgPyAiMSIgOiAiMCIpICsKICAgICAgICAoR2FtZS5wcmVmcy5ub3RTY2FyeSA/ICIxIiA6ICIwIikgKwogICAgICAgIChHYW1lLnByZWZzLmZ1bGxzY3JlZW4gPyAiMSIgOiAiMCIpICsKICAgICAgICAoR2FtZS5wcmVmcy5zY3JlZW5yZWFkZXIgPyAiMSIgOiAiMCIpICsKICAgICAgICAoR2FtZS5wcmVmcy5kaXNjb3JkUHJlc2VuY2UgPyAiMSIgOiAiMCIpICsKICAgICAgICAiIjsKICAgICAgc3RyMiA9IHBhY2szKHN0cjIpOwogICAgICBzdHIgKz0gc3RyMiArICJ8IjsKICAgICAgaWYgKHR5cGUgPT0gMykgc3RyICs9ICJcblxuTWlzYyBnYW1lIGRhdGEiOwogICAgICBzdHIgKz0KICAgICAgICAodHlwZSA9PSAzID8gIlxuCWNvb2tpZXMgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUZsb2F0KEdhbWUuY29va2llcykudG9TdHJpbmcoKSArCiAgICAgICAgIjsiICsKICAgICAgICAodHlwZSA9PSAzID8gIlxuCXRvdGFsIGNvb2tpZXMgZWFybmVkIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VGbG9hdChHYW1lLmNvb2tpZXNFYXJuZWQpLnRvU3RyaW5nKCkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgljb29raWUgY2xpY2tzIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLmNvb2tpZUNsaWNrcykpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JZ29sZGVuIGNvb2tpZSBjbGlja3MgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKEdhbWUuZ29sZGVuQ2xpY2tzKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgljb29raWVzIG1hZGUgYnkgY2xpY2tpbmcgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUZsb2F0KEdhbWUuaGFuZG1hZGVDb29raWVzKS50b1N0cmluZygpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JZ29sZGVuIGNvb2tpZXMgbWlzc2VkIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLm1pc3NlZEdvbGRlbkNsaWNrcykpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JYmFja2dyb3VuZCB0eXBlIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLmJnVHlwZSkpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JbWlsayB0eXBlIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLm1pbGtUeXBlKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgljb29raWVzIGZyb20gcGFzdCBydW5zIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VGbG9hdChHYW1lLmNvb2tpZXNSZXNldCkudG9TdHJpbmcoKSArCiAgICAgICAgIjsiICsKICAgICAgICAodHlwZSA9PSAzID8gIlxuCWVsZGVyIHdyYXRoIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLmVsZGVyV3JhdGgpKSArCiAgICAgICAgIjsiICsKICAgICAgICAodHlwZSA9PSAzID8gIlxuCXBsZWRnZXMgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKEdhbWUucGxlZGdlcykpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JcGxlZGdlIHRpbWUgbGVmdCA6ICIgOiAiIikgKwogICAgICAgIHBhcnNlSW50KE1hdGguZmxvb3IoR2FtZS5wbGVkZ2VUKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgljdXJyZW50bHkgcmVzZWFyY2hpbmcgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKEdhbWUubmV4dFJlc2VhcmNoKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbglyZXNlYXJjaCB0aW1lIGxlZnQgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKEdhbWUucmVzZWFyY2hUKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbglhc2NlbnNpb25zIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLnJlc2V0cykpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JZ29sZGVuIGNvb2tpZSBjbGlja3MgKHRoaXMgcnVuKSA6ICIgOiAiIikgKwogICAgICAgIHBhcnNlSW50KE1hdGguZmxvb3IoR2FtZS5nb2xkZW5DbGlja3NMb2NhbCkpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JY29va2llcyBzdWNrZWQgYnkgd3JpbmtsZXJzIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VGbG9hdChHYW1lLmNvb2tpZXNTdWNrZWQpLnRvU3RyaW5nKCkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgl3cmlua2xlcyBwb3BwZWQgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKEdhbWUud3JpbmtsZXJzUG9wcGVkKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbglzYW50YSBsZXZlbCA6ICIgOiAiIikgKwogICAgICAgIHBhcnNlSW50KE1hdGguZmxvb3IoR2FtZS5zYW50YUxldmVsKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbglyZWluZGVlciBjbGlja2VkIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLnJlaW5kZWVyQ2xpY2tlZCkpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4Jc2Vhc29uIHRpbWUgbGVmdCA6ICIgOiAiIikgKwogICAgICAgIHBhcnNlSW50KE1hdGguZmxvb3IoR2FtZS5zZWFzb25UKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbglzZWFzb24gc3dpdGNoZXIgdXNlcyA6ICIgOiAiIikgKwogICAgICAgIHBhcnNlSW50KE1hdGguZmxvb3IoR2FtZS5zZWFzb25Vc2VzKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgljdXJyZW50IHNlYXNvbiA6ICIgOiAiIikgKwogICAgICAgIChHYW1lLnNlYXNvbiA/IEdhbWUuc2Vhc29uIDogIiIpICsKICAgICAgICAiOyI7CiAgICAgIHZhciB3cmlua2xlcnMgPSBHYW1lLlNhdmVXcmlua2xlcnMoKTsKICAgICAgc3RyICs9CiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbglhbW91bnQgb2YgY29va2llcyBjb250YWluZWQgaW4gd3JpbmtsZXJzIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VGbG9hdChNYXRoLmZsb29yKHdyaW5rbGVycy5hbW91bnQpKSArCiAgICAgICAgIjsiICsKICAgICAgICAodHlwZSA9PSAzID8gIlxuCW51bWJlciBvZiB3cmlua2xlcnMgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKHdyaW5rbGVycy5udW1iZXIpKSArCiAgICAgICAgIjsiICsKICAgICAgICAodHlwZSA9PSAzID8gIlxuCXByZXN0aWdlIGxldmVsIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VGbG9hdChHYW1lLnByZXN0aWdlKS50b1N0cmluZygpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JaGVhdmVubHkgY2hpcHMgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUZsb2F0KEdhbWUuaGVhdmVubHlDaGlwcykudG9TdHJpbmcoKSArCiAgICAgICAgIjsiICsKICAgICAgICAodHlwZSA9PSAzID8gIlxuCWhlYXZlbmx5IGNoaXBzIHNwZW50IDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VGbG9hdChHYW1lLmhlYXZlbmx5Q2hpcHNTcGVudCkudG9TdHJpbmcoKSArCiAgICAgICAgIjsiICsKICAgICAgICAodHlwZSA9PSAzID8gIlxuCWhlYXZlbmx5IGNvb2tpZXMgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUZsb2F0KEdhbWUuaGVhdmVubHlDb29raWVzKS50b1N0cmluZygpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JYXNjZW5zaW9uIG1vZGUgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKEdhbWUuYXNjZW5zaW9uTW9kZSkpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JcGVybWFuZW50IHVwZ3JhZGVzIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLnBlcm1hbmVudFVwZ3JhZGVzWzBdKSkgKwogICAgICAgICI7IiArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLnBlcm1hbmVudFVwZ3JhZGVzWzFdKSkgKwogICAgICAgICI7IiArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLnBlcm1hbmVudFVwZ3JhZGVzWzJdKSkgKwogICAgICAgICI7IiArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLnBlcm1hbmVudFVwZ3JhZGVzWzNdKSkgKwogICAgICAgICI7IiArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLnBlcm1hbmVudFVwZ3JhZGVzWzRdKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbglkcmFnb24gbGV2ZWwgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKEdhbWUuZHJhZ29uTGV2ZWwpKSArCiAgICAgICAgIjsiICsKICAgICAgICAodHlwZSA9PSAzID8gIlxuCWRyYWdvbiBhdXJhIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLmRyYWdvbkF1cmEpKSArCiAgICAgICAgIjsiICsKICAgICAgICAodHlwZSA9PSAzID8gIlxuCWRyYWdvbiBhdXJhIDIgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKEdhbWUuZHJhZ29uQXVyYTIpKSArCiAgICAgICAgIjsiICsKICAgICAgICAodHlwZSA9PSAzID8gIlxuCWNoaW1lIHR5cGUgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKEdhbWUuY2hpbWVUeXBlKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgl2b2x1bWUgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKEdhbWUudm9sdW1lKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgludW1iZXIgb2Ygc2hpbnkgd3JpbmtsZXJzIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcih3cmlua2xlcnMuc2hpbmllcykpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMKICAgICAgICAgID8gIlxuCWFtb3VudCBvZiBjb29raWVzIGNvbnRhaW5lZCBpbiBzaGlueSB3cmlua2xlcnMgOiAiCiAgICAgICAgICA6ICIiKSArCiAgICAgICAgcGFyc2VGbG9hdChNYXRoLmZsb29yKHdyaW5rbGVycy5hbW91bnRTaGluaWVzKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgljdXJyZW50IGFtb3VudCBvZiBzdWdhciBsdW1wcyA6ICIgOiAiIikgKwogICAgICAgIHBhcnNlRmxvYXQoTWF0aC5mbG9vcihHYW1lLmx1bXBzKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgl0b3RhbCBhbW91bnQgb2Ygc3VnYXIgbHVtcHMgbWFkZSA6ICIgOiAiIikgKwogICAgICAgIHBhcnNlRmxvYXQoTWF0aC5mbG9vcihHYW1lLmx1bXBzVG90YWwpKSArCiAgICAgICAgIjsiICsKICAgICAgICAodHlwZSA9PSAzID8gIlxuCXRpbWUgd2hlbiBjdXJyZW50IHN1Z2FyIGx1bXAgc3RhcnRlZCA6ICIgOiAiIikgKwogICAgICAgIHBhcnNlRmxvYXQoTWF0aC5mbG9vcihHYW1lLmx1bXBUKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMwogICAgICAgICAgPyAiXG4JdGltZSB3aGVuIGxhc3QgcmVmaWxsZWQgYSBtaW5pZ2FtZSB3aXRoIGEgc3VnYXIgbHVtcCA6ICIKICAgICAgICAgIDogIiIpICsKICAgICAgICBwYXJzZUZsb2F0KE1hdGguZmxvb3IoR2FtZS5sdW1wUmVmaWxsKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbglzdWdhciBsdW1wIHR5cGUgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKEdhbWUubHVtcEN1cnJlbnRUeXBlKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgl2YXVsdCA6ICIgOiAiIikgKwogICAgICAgIEdhbWUudmF1bHQuam9pbigiLCIpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JaGVyYWxkcyA6ICIgOiAiIikgKwogICAgICAgIHBhcnNlSW50KEdhbWUuaGVyYWxkcykgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbglnb2xkZW4gY29va2llIGZvcnR1bmUgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChHYW1lLmZvcnR1bmVHQykgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbglDcFMgZm9ydHVuZSA6ICIgOiAiIikgKwogICAgICAgIHBhcnNlSW50KEdhbWUuZm9ydHVuZUNQUykgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgloaWdoZXN0IHJhdyBDcFMgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUZsb2F0KEdhbWUuY29va2llc1BzUmF3SGlnaGVzdCkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgltdXNpYyB2b2x1bWUgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKEdhbWUudm9sdW1lTXVzaWMpKSArCiAgICAgICAgIjsiICsKICAgICAgICAifCI7IC8vY29va2llcyBhbmQgbG90cyBvZiBvdGhlciBzdHVmZgoKICAgICAgaWYgKHR5cGUgPT0gMykKICAgICAgICBzdHIgKz0KICAgICAgICAgICJcblxuQnVpbGRpbmdzIDogYW1vdW50LCBib3VnaHQsIGNvb2tpZXMgcHJvZHVjZWQsIGxldmVsLCBtaW5pZ2FtZSBkYXRhIjsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsgLy9idWlsZGluZ3MKICAgICAgICB2YXIgbWUgPSBHYW1lLk9iamVjdHNbaV07CiAgICAgICAgaWYgKHR5cGUgPT0gMykgc3RyICs9ICJcbgkiICsgbWUubmFtZSArICIgOiAiOwogICAgICAgIGlmIChtZS52YW5pbGxhKSB7CiAgICAgICAgICBzdHIgKz0KICAgICAgICAgICAgbWUuYW1vdW50ICsKICAgICAgICAgICAgIiwiICsKICAgICAgICAgICAgbWUuYm91Z2h0ICsKICAgICAgICAgICAgIiwiICsKICAgICAgICAgICAgcGFyc2VGbG9hdChNYXRoLmZsb29yKG1lLnRvdGFsQ29va2llcykpICsKICAgICAgICAgICAgIiwiICsKICAgICAgICAgICAgcGFyc2VJbnQobWUubGV2ZWwpOwogICAgICAgICAgaWYgKEdhbWUuaXNNaW5pZ2FtZVJlYWR5KG1lKSkgc3RyICs9ICIsIiArIG1lLm1pbmlnYW1lLnNhdmUoKTsKICAgICAgICAgIGVsc2Ugc3RyICs9ICIsIiArIChtZS5taW5pZ2FtZVNhdmUgfHwgIiIpOwogICAgICAgICAgc3RyICs9ICIsIiArIChtZS5tdXRlZCA/ICIxIiA6ICIwIik7CiAgICAgICAgICBzdHIgKz0gIiwiICsgbWUuaGlnaGVzdDsKICAgICAgICAgIHN0ciArPSAiOyI7CiAgICAgICAgfQogICAgICB9CiAgICAgIHN0ciArPSAifCI7CiAgICAgIGlmICh0eXBlID09IDMpCiAgICAgICAgc3RyICs9ICJcblxuUGFja2VkIHVwZ3JhZGVzIGJpdGZpZWxkICh1bmxvY2tlZCBhbmQgYm91Z2h0KVxuCSI7CiAgICAgIHZhciB0b0NvbXByZXNzID0gW107CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5VcGdyYWRlc0J5SWQpIHsgLy91cGdyYWRlcwogICAgICAgIHZhciBtZSA9IEdhbWUuVXBncmFkZXNCeUlkW2ldOwogICAgICAgIGlmIChtZS52YW5pbGxhKQogICAgICAgICAgdG9Db21wcmVzcy5wdXNoKE1hdGgubWluKG1lLnVubG9ja2VkLCAxKSwgTWF0aC5taW4obWUuYm91Z2h0LCAxKSk7CiAgICAgIH0KCiAgICAgIHRvQ29tcHJlc3MgPSBwYWNrMyh0b0NvbXByZXNzLmpvaW4oIiIpKTsgLy90b0NvbXByZXNzPXBhY2sodG9Db21wcmVzcyk7Ly9Db21wcmVzc0xhcmdlQmluKHRvQ29tcHJlc3MpOwoKICAgICAgc3RyICs9IHRvQ29tcHJlc3M7CiAgICAgIHN0ciArPSAifCI7CiAgICAgIGlmICh0eXBlID09IDMpIHN0ciArPSAiXG5cblBhY2tlZCBhY2hpZXZlbWVudHMgYml0ZmllbGQgKHdvbilcbgkiOwogICAgICB2YXIgdG9Db21wcmVzcyA9IFtdOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUuQWNoaWV2ZW1lbnRzQnlJZCkgeyAvL2FjaGlldmVtZW50cwogICAgICAgIHZhciBtZSA9IEdhbWUuQWNoaWV2ZW1lbnRzQnlJZFtpXTsKICAgICAgICBpZiAobWUudmFuaWxsYSkgdG9Db21wcmVzcy5wdXNoKE1hdGgubWluKG1lLndvbikpOwogICAgICB9CiAgICAgIHRvQ29tcHJlc3MgPSBwYWNrMyh0b0NvbXByZXNzLmpvaW4oIiIpKTsgLy90b0NvbXByZXNzPXBhY2sodG9Db21wcmVzcyk7Ly9Db21wcmVzc0xhcmdlQmluKHRvQ29tcHJlc3MpOwogICAgICBzdHIgKz0gdG9Db21wcmVzczsKCiAgICAgIHN0ciArPSAifCI7CiAgICAgIGlmICh0eXBlID09IDMpIHN0ciArPSAiXG5cbkJ1ZmZzIDogdHlwZSwgbWF4VGltZSwgdGltZSwgYXJnMSwgYXJnMiwgYXJnMyI7CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5idWZmcykgewogICAgICAgIHZhciBtZSA9IEdhbWUuYnVmZnNbaV07CiAgICAgICAgaWYgKG1lLnR5cGUpIHsKICAgICAgICAgIGlmICh0eXBlID09IDMpIHN0ciArPSAiXG4JIiArIG1lLnR5cGUubmFtZSArICIgOiAiOwogICAgICAgICAgaWYgKG1lLnR5cGUudmFuaWxsYSkgewogICAgICAgICAgICBzdHIgKz0gbWUudHlwZS5pZCArICIsIiArIG1lLm1heFRpbWUgKyAiLCIgKyBtZS50aW1lOwogICAgICAgICAgICBpZiAodHlwZW9mIG1lLmFyZzEgIT09ICJ1bmRlZmluZWQiKQogICAgICAgICAgICAgIHN0ciArPSAiLCIgKyBwYXJzZUZsb2F0KG1lLmFyZzEpOwogICAgICAgICAgICBpZiAodHlwZW9mIG1lLmFyZzIgIT09ICJ1bmRlZmluZWQiKQogICAgICAgICAgICAgIHN0ciArPSAiLCIgKyBwYXJzZUZsb2F0KG1lLmFyZzIpOwogICAgICAgICAgICBpZiAodHlwZW9mIG1lLmFyZzMgIT09ICJ1bmRlZmluZWQiKQogICAgICAgICAgICAgIHN0ciArPSAiLCIgKyBwYXJzZUZsb2F0KG1lLmFyZzMpOwogICAgICAgICAgICBzdHIgKz0gIjsiOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHR5cGUgPT0gMykgc3RyICs9ICJcblxuQ3VzdG9tIDpcbiI7CgogICAgICBzdHIgKz0gInwiOwogICAgICBzdHIgKz0gR2FtZS5zYXZlTW9kRGF0YSgpOwoKICAgICAgR2FtZS5sYXN0U2F2ZURhdGEgPSBzdHI7CgogICAgICBpZiAodHlwZSA9PSAyIHx8IHR5cGUgPT0gMykgewogICAgICAgIHJldHVybiBzdHI7CiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSAxKSB7CiAgICAgICAgc3RyID0gZXNjYXBlKHV0ZjhfdG9fYjY0KHN0cikgKyAiIUVORCEiKTsKICAgICAgICByZXR1cm4gc3RyOwogICAgICB9IGVsc2UgewogICAgICAgIGlmIChHYW1lLnVzZUxvY2FsU3RvcmFnZSkgewogICAgICAgICAgLy9zbyB3ZSB1c2VkIHRvIHNhdmUgdGhlIGdhbWUgdXNpbmcgYnJvd3NlciBjb29raWVzLCB3aGljaCB3YXMganVzdCByZWFsbHkgbmVhdCBjb25zaWRlcmluZyB0aGUgZ2FtZSdzIG5hbWUKICAgICAgICAgIC8vd2UncmUgdXNpbmcgbG9jYWxzdG9yYWdlIG5vdywgd2hpY2ggaXMgbW9yZSBlZmZpY2llbnQgYnV0IG5vdCBhcyBjb29sCiAgICAgICAgICAvL2EgbW9tZW50IG9mIHNpbGVuY2UgZm9yIG91ciBmYWxsZW4gcHVucwogICAgICAgICAgc3RyID0gdXRmOF90b19iNjQoc3RyKSArICIhRU5EISI7CiAgICAgICAgICBpZiAoc3RyLmxlbmd0aCA8IDEwKSB7CiAgICAgICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgICAgICJTYXZpbmcgZmFpbGVkISIsCiAgICAgICAgICAgICAgIlB1cmNoYXNpbmcgYW4gdXBncmFkZSBhbmQgc2F2aW5nIGFnYWluIG1pZ2h0IGZpeCB0aGlzLjxicj5UaGlzIHJlYWxseSBzaG91bGRuJ3QgaGFwcGVuOyBwbGVhc2Ugbm90aWZ5IE9ydGVpbCBvbiBoaXMgdHVtYmxyLiIKICAgICAgICAgICAgKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN0ciA9IGVzY2FwZShzdHIpOwogICAgICAgICAgICBsb2NhbFN0b3JhZ2VTZXQoR2FtZS5TYXZlVG8sIHN0cik7IC8vYWFhbmQgc2F2ZQogICAgICAgICAgICBpZiAoQXBwKSBBcHAuc2F2ZShzdHIpOwogICAgICAgICAgICBpZiAoIWxvY2FsU3RvcmFnZUdldChHYW1lLlNhdmVUbykpIHsKICAgICAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgICAgIGxvYygiRXJyb3Igd2hpbGUgc2F2aW5nIiksCiAgICAgICAgICAgICAgICBsb2MoIkV4cG9ydCB5b3VyIHNhdmUgaW5zdGVhZCEiKQogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZG9jdW1lbnQuaGFzRm9jdXMoKSkgewogICAgICAgICAgICAgIEdhbWUuTm90aWZ5KGxvYygiR2FtZSBzYXZlZCIpLCAiIiwgIiIsIDEsIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSAvL2xlZ2FjeSBzeXN0ZW0KICAgICAgICBlbHNlIHsKICAgICAgICAgIC8vdGhhdCdzIHJpZ2h0CiAgICAgICAgICAvL3dlJ3JlIHVzaW5nIGNvb2tpZXMKICAgICAgICAgIC8veWVhaCBJIHdlbnQgdGhlcmUKICAgICAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpOyAvL3dlIHN0b3JpbiBkaXMgZm9yIDUgeWVhcnMsIHBlb3BsZQogICAgICAgICAgbm93LnNldEZ1bGxZZWFyKG5vdy5nZXRGdWxsWWVhcigpICsgNSk7IC8vbW1oIHN0YWxlIGNvb2tpZXMKICAgICAgICAgIHN0ciA9IHV0ZjhfdG9fYjY0KHN0cikgKyAiIUVORCEiOwogICAgICAgICAgR2FtZS5zYXZlRGF0YSA9IGVzY2FwZShzdHIpOwogICAgICAgICAgc3RyID0KICAgICAgICAgICAgR2FtZS5TYXZlVG8gKwogICAgICAgICAgICAiPSIgKwogICAgICAgICAgICBlc2NhcGUoc3RyKSArCiAgICAgICAgICAgICI7IGV4cGlyZXM9IiArCiAgICAgICAgICAgIG5vdy50b1VUQ1N0cmluZygpICsKICAgICAgICAgICAgIjsiOwogICAgICAgICAgZG9jdW1lbnQuY29va2llID0gc3RyOyAvL2FhYW5kIHNhdmUKICAgICAgICAgIGlmIChBcHApIEFwcC5zYXZlKHN0cik7CiAgICAgICAgICBpZiAoZG9jdW1lbnQuY29va2llLmluZGV4T2YoR2FtZS5TYXZlVG8pIDwgMCkgewogICAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgICBsb2MoIkVycm9yIHdoaWxlIHNhdmluZyIpLAogICAgICAgICAgICAgIGxvYygiRXhwb3J0IHlvdXIgc2F2ZSBpbnN0ZWFkISIpLAogICAgICAgICAgICAgICIiLAogICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgMQogICAgICAgICAgICApOwogICAgICAgICAgfSBlbHNlIGlmIChkb2N1bWVudC5oYXNGb2N1cygpKSB7CiAgICAgICAgICAgIEdhbWUuTm90aWZ5KGxvYygiR2FtZSBzYXZlZCIpLCAiIiwgIiIsIDEsIDEpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCQlMT0FECgkJPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KICAgIEdhbWUuc2FsdmFnZVNhdmUgPSBmdW5jdGlvbiAoKSB7CiAgICAgIC8vZm9yIHdoZW4gQ29va2llIENsaWNrZXIgd29uJ3QgbG9hZCBhbmQgeW91IG5lZWQgeW91ciBzYXZlCiAgICAgIGNvbnNvbGUubG9nKCI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iKTsKICAgICAgY29uc29sZS5sb2coCiAgICAgICAgJ1RoaXMgaXMgeW91ciBzYXZlIGRhdGEuIENvcHlwYXN0ZSBpdCAod2l0aG91dCBxdW90YXRpb24gbWFya3MpIGludG8gYW5vdGhlciB2ZXJzaW9uIHVzaW5nIHRoZSAiSW1wb3J0IHNhdmUiIGZlYXR1cmUuJwogICAgICApOwogICAgICBjb25zb2xlLmxvZyhsb2NhbFN0b3JhZ2VHZXQoR2FtZS5TYXZlVG8pKTsKICAgIH07CiAgICBHYW1lLkxvYWRTYXZlID0gZnVuY3Rpb24gKGRhdGEsIGlnbm9yZVZlcnNpb25Jc3N1ZXMpIHsKICAgICAgdmFyIHN0ciA9ICIiOwogICAgICBpZiAodHlwZW9mIGRhdGEgIT09ICJ1bmRlZmluZWQiKSBzdHIgPSB1bmVzY2FwZShkYXRhKTsKICAgICAgZWxzZSB7CiAgICAgICAgaWYgKEFwcCkgewogICAgICAgICAgQXBwLmdldE1vc3RSZWNlbnRTYXZlKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgIEdhbWUuTG9hZFNhdmUoZGF0YSwgdHJ1ZSk7CiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgaWYgKEdhbWUudXNlTG9jYWxTdG9yYWdlKSB7CiAgICAgICAgICB2YXIgbG9jYWwgPSBsb2NhbFN0b3JhZ2VHZXQoR2FtZS5TYXZlVG8pOwogICAgICAgICAgaWYgKCFsb2NhbCkgewogICAgICAgICAgICAvL25vIGxvY2Fsc3RvcmFnZSBzYXZlIGZvdW5kPyBsZXQncyBnZXQgdGhlIGNvb2tpZSBvbmUgbGFzdCB0aW1lCiAgICAgICAgICAgIGlmIChkb2N1bWVudC5jb29raWUuaW5kZXhPZihHYW1lLlNhdmVUbykgPj0gMCkgewogICAgICAgICAgICAgIHN0ciA9IHVuZXNjYXBlKGRvY3VtZW50LmNvb2tpZS5zcGxpdChHYW1lLlNhdmVUbyArICI9IilbMV0pOwogICAgICAgICAgICAgIGRvY3VtZW50LmNvb2tpZSA9CiAgICAgICAgICAgICAgICBHYW1lLlNhdmVUbyArICI9O2V4cGlyZXM9VGh1LCAwMSBKYW4gMTk3MCAwMDowMDowMSBHTVQ7IjsKICAgICAgICAgICAgfSBlbHNlIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN0ciA9IHVuZXNjYXBlKGxvY2FsKTsKICAgICAgICAgIH0KICAgICAgICB9IC8vbGVnYWN5IHN5c3RlbQogICAgICAgIGVsc2UgewogICAgICAgICAgaWYgKGRvY3VtZW50LmNvb2tpZS5pbmRleE9mKEdhbWUuU2F2ZVRvKSA+PSAwKQogICAgICAgICAgICBzdHIgPSB1bmVzY2FwZSgKICAgICAgICAgICAgICBkb2N1bWVudC5jb29raWUuc3BsaXQoR2FtZS5TYXZlVG8gKyAiPSIpWzFdCiAgICAgICAgICAgICk7IC8vZ2V0IGNvb2tpZSBoZXJlCiAgICAgICAgICBlbHNlIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHN0ciAhPSAiIikgewogICAgICAgIHZhciB2ZXJzaW9uID0gMDsKICAgICAgICB2YXIgb2xkc3RyID0gc3RyLnNwbGl0KCJ8Iik7CiAgICAgICAgaWYgKG9sZHN0clswXS5sZW5ndGggPCAxKSByZXR1cm4gZmFsc2U7CiAgICAgICAgZWxzZSB7CiAgICAgICAgICBzdHIgPSBzdHIuc3BsaXQoIiFFTkQhIilbMF07CiAgICAgICAgICBzdHIgPSBiNjRfdG9fdXRmOChzdHIpOwogICAgICAgIH0KICAgICAgICBpZiAoc3RyID09ICIiKSByZXR1cm4gZmFsc2U7CiAgICAgICAgZWxzZSB7CiAgICAgICAgICB2YXIgc3BsID0gIiI7CiAgICAgICAgICBzdHIgPSBzdHIuc3BsaXQoInwiKTsKICAgICAgICAgIHZlcnNpb24gPSBwYXJzZUZsb2F0KHN0clswXSk7CiAgICAgICAgICBHYW1lLmxvYWRlZEZyb21WZXJzaW9uID0gdmVyc2lvbjsKCiAgICAgICAgICBpZiAoaXNOYU4odmVyc2lvbikgfHwgc3RyLmxlbmd0aCA8IDUpIHsKICAgICAgICAgICAgR2FtZS5Ob3RpZnkoCiAgICAgICAgICAgICAgbG9jKCJFcnJvciBpbXBvcnRpbmcgc2F2ZSIpLAogICAgICAgICAgICAgIGxvYygiT29wcywgbG9va3MgbGlrZSB0aGUgaW1wb3J0IHN0cmluZyBpcyBhbGwgd3JvbmchIiksCiAgICAgICAgICAgICAgIiIsCiAgICAgICAgICAgICAgNiwKICAgICAgICAgICAgICAxCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICAgIGlmICh2ZXJzaW9uID49IDEgJiYgdmVyc2lvbiA+IEdhbWUudmVyc2lvbikgewogICAgICAgICAgICBpZiAoaWdub3JlVmVyc2lvbklzc3VlcykKICAgICAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgICAgICJSZXRyaWV2aW5nIHNhdmUgZnJvbSBhIGZ1dHVyZSB2ZXJzaW9uLiIsCiAgICAgICAgICAgICAgICAiVGhhdCdzLi4ub2RkLiIsCiAgICAgICAgICAgICAgICAiIiwKICAgICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgICAxCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgR2FtZS5Ob3RpZnkoCiAgICAgICAgICAgICAgICBsb2MoIkVycm9yIGltcG9ydGluZyBzYXZlIiksCiAgICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAgICJZb3UgYXJlIGF0dGVtcHRpbmcgdG8gbG9hZCBhIHNhdmUgZnJvbSBhIGZ1dHVyZSB2ZXJzaW9uICh2LiAlMTsgeW91IGFyZSB1c2luZyB2LiAlMikuIiwKICAgICAgICAgICAgICAgICAgW3ZlcnNpb24sIEdhbWUudmVyc2lvbl0KICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAiIiwKICAgICAgICAgICAgICAgIDYsCiAgICAgICAgICAgICAgICAxCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGlmICh2ZXJzaW9uID49IDEpIHsKICAgICAgICAgICAgR2FtZS5UID0gMDsKCiAgICAgICAgICAgIHNwbCA9IHN0clsyXS5zcGxpdCgiOyIpOyAvL3NhdmUgc3RhdHMKICAgICAgICAgICAgR2FtZS5zdGFydERhdGUgPSBwYXJzZUludChzcGxbMF0pOwogICAgICAgICAgICBHYW1lLmZ1bGxEYXRlID0gcGFyc2VJbnQoc3BsWzFdKTsKICAgICAgICAgICAgR2FtZS5sYXN0RGF0ZSA9IHBhcnNlSW50KHNwbFsyXSk7CiAgICAgICAgICAgIHZhciBiYWtlcnlOYW1lID0gc3BsWzNdID8gc3BsWzNdIDogR2FtZS5HZXRCYWtlcnlOYW1lKCk7CiAgICAgICAgICAgIEdhbWUuc2VlZCA9IHNwbFs0XSA/IHNwbFs0XSA6IEdhbWUubWFrZVNlZWQoKTsKICAgICAgICAgICAgLy9wcmVmcwogICAgICAgICAgICBpZiAodmVyc2lvbiA8IDEuMDUwMykgc3BsID0gc3RyWzNdLnNwbGl0KCIiKTsKICAgICAgICAgICAgZWxzZSBpZiAodmVyc2lvbiA8IDIuMDA0Nikgc3BsID0gdW5wYWNrMihzdHJbM10pLnNwbGl0KCIiKTsKICAgICAgICAgICAgZWxzZSBzcGwgPSBzdHJbM10uc3BsaXQoIiIpOwogICAgICAgICAgICBHYW1lLnByZWZzLnBhcnRpY2xlcyA9IHBhcnNlSW50KHNwbFswXSk7CiAgICAgICAgICAgIEdhbWUucHJlZnMubnVtYmVycyA9IHBhcnNlSW50KHNwbFsxXSk7CiAgICAgICAgICAgIEdhbWUucHJlZnMuYXV0b3NhdmUgPSBwYXJzZUludChzcGxbMl0pOwogICAgICAgICAgICBHYW1lLnByZWZzLmF1dG91cGRhdGUgPSBzcGxbM10gPyBwYXJzZUludChzcGxbM10pIDogMTsKICAgICAgICAgICAgR2FtZS5wcmVmcy5taWxrID0gc3BsWzRdID8gcGFyc2VJbnQoc3BsWzRdKSA6IDE7CiAgICAgICAgICAgIEdhbWUucHJlZnMuZmFuY3kgPSBwYXJzZUludChzcGxbNV0pOwogICAgICAgICAgICBpZiAoR2FtZS5wcmVmcy5mYW5jeSkgR2FtZS5yZW1vdmVDbGFzcygibm9GYW5jeSIpOwogICAgICAgICAgICBlbHNlIGlmICghR2FtZS5wcmVmcy5mYW5jeSkgR2FtZS5hZGRDbGFzcygibm9GYW5jeSIpOwogICAgICAgICAgICBHYW1lLnByZWZzLndhcm4gPSBzcGxbNl0gPyBwYXJzZUludChzcGxbNl0pIDogMDsKICAgICAgICAgICAgR2FtZS5wcmVmcy5jdXJzb3JzID0gc3BsWzddID8gcGFyc2VJbnQoc3BsWzddKSA6IDA7CiAgICAgICAgICAgIEdhbWUucHJlZnMuZm9jdXMgPSBzcGxbOF0gPyBwYXJzZUludChzcGxbOF0pIDogMDsKICAgICAgICAgICAgR2FtZS5wcmVmcy5mb3JtYXQgPSBzcGxbOV0gPyBwYXJzZUludChzcGxbOV0pIDogMDsKICAgICAgICAgICAgR2FtZS5wcmVmcy5ub3RpZnMgPSBzcGxbMTBdID8gcGFyc2VJbnQoc3BsWzEwXSkgOiAwOwogICAgICAgICAgICBHYW1lLnByZWZzLndvYmJseSA9IHNwbFsxMV0gPyBwYXJzZUludChzcGxbMTFdKSA6IDA7CiAgICAgICAgICAgIEdhbWUucHJlZnMubW9ub3NwYWNlID0gc3BsWzEyXSA/IHBhcnNlSW50KHNwbFsxMl0pIDogMDsKICAgICAgICAgICAgR2FtZS5wcmVmcy5maWx0ZXJzID0gc3BsWzEzXSA/IHBhcnNlSW50KHNwbFsxM10pIDogMTsKICAgICAgICAgICAgaWYgKEdhbWUucHJlZnMuZmlsdGVycykgR2FtZS5yZW1vdmVDbGFzcygibm9GaWx0ZXJzIik7CiAgICAgICAgICAgIGVsc2UgaWYgKCFHYW1lLnByZWZzLmZpbHRlcnMpIEdhbWUuYWRkQ2xhc3MoIm5vRmlsdGVycyIpOwogICAgICAgICAgICBHYW1lLnByZWZzLmNvb2tpZXNvdW5kID0gc3BsWzE0XSA/IHBhcnNlSW50KHNwbFsxNF0pIDogMTsKICAgICAgICAgICAgR2FtZS5wcmVmcy5jcmF0ZXMgPSBzcGxbMTVdID8gcGFyc2VJbnQoc3BsWzE1XSkgOiAwOwogICAgICAgICAgICBHYW1lLnByZWZzLnNob3dCYWNrdXBXYXJuaW5nID0gc3BsWzE2XSA/IHBhcnNlSW50KHNwbFsxNl0pIDogMTsKICAgICAgICAgICAgR2FtZS5wcmVmcy5leHRyYUJ1dHRvbnMgPSBzcGxbMTddID8gcGFyc2VJbnQoc3BsWzE3XSkgOiAxOwogICAgICAgICAgICBpZiAoIUdhbWUucHJlZnMuZXh0cmFCdXR0b25zKSBHYW1lLnJlbW92ZUNsYXNzKCJleHRyYUJ1dHRvbnMiKTsKICAgICAgICAgICAgZWxzZSBpZiAoR2FtZS5wcmVmcy5leHRyYUJ1dHRvbnMpIEdhbWUuYWRkQ2xhc3MoImV4dHJhQnV0dG9ucyIpOwogICAgICAgICAgICBHYW1lLnByZWZzLmFza0x1bXBzID0gc3BsWzE4XSA/IHBhcnNlSW50KHNwbFsxOF0pIDogMDsKICAgICAgICAgICAgR2FtZS5wcmVmcy5jdXN0b21HcmFuZG1hcyA9IHNwbFsxOV0gPyBwYXJzZUludChzcGxbMTldKSA6IDE7CiAgICAgICAgICAgIEdhbWUucHJlZnMudGltZW91dCA9IHNwbFsyMF0gPyBwYXJzZUludChzcGxbMjBdKSA6IDA7CiAgICAgICAgICAgIEdhbWUucHJlZnMuY2xvdWRTYXZlID0gc3BsWzIxXSA/IHBhcnNlSW50KHNwbFsyMV0pIDogMTsKICAgICAgICAgICAgR2FtZS5wcmVmcy5iZ011c2ljID0gc3BsWzIyXSA/IHBhcnNlSW50KHNwbFsyMl0pIDogMTsKICAgICAgICAgICAgR2FtZS5wcmVmcy5ub3RTY2FyeSA9IHNwbFsyM10gPyBwYXJzZUludChzcGxbMjNdKSA6IDA7CiAgICAgICAgICAgIEdhbWUucHJlZnMuZnVsbHNjcmVlbiA9IHNwbFsyNF0gPyBwYXJzZUludChzcGxbMjRdKSA6IDA7CiAgICAgICAgICAgIGlmIChBcHApIEFwcC5zZXRGdWxsc2NyZWVuKEdhbWUucHJlZnMuZnVsbHNjcmVlbik7CiAgICAgICAgICAgIEdhbWUucHJlZnMuc2NyZWVucmVhZGVyID0gc3BsWzI1XSA/IHBhcnNlSW50KHNwbFsyNV0pIDogMDsKICAgICAgICAgICAgR2FtZS5wcmVmcy5kaXNjb3JkUHJlc2VuY2UgPSBzcGxbMjZdID8gcGFyc2VJbnQoc3BsWzI2XSkgOiAxOwogICAgICAgICAgICBCZWF1dGlmeUFsbCgpOwogICAgICAgICAgICBzcGwgPSBzdHJbNF0uc3BsaXQoIjsiKTsgLy9jb29raWVzIGFuZCBsb3RzIG9mIG90aGVyIHN0dWZmCiAgICAgICAgICAgIEdhbWUuY29va2llcyA9IHBhcnNlRmxvYXQoc3BsWzBdKTsKICAgICAgICAgICAgR2FtZS5jb29raWVzRWFybmVkID0gcGFyc2VGbG9hdChzcGxbMV0pOwogICAgICAgICAgICBHYW1lLmNvb2tpZUNsaWNrcyA9IHNwbFsyXSA/IHBhcnNlSW50KHNwbFsyXSkgOiAwOwogICAgICAgICAgICBHYW1lLmdvbGRlbkNsaWNrcyA9IHNwbFszXSA/IHBhcnNlSW50KHNwbFszXSkgOiAwOwogICAgICAgICAgICBHYW1lLmhhbmRtYWRlQ29va2llcyA9IHNwbFs0XSA/IHBhcnNlRmxvYXQoc3BsWzRdKSA6IDA7CiAgICAgICAgICAgIEdhbWUubWlzc2VkR29sZGVuQ2xpY2tzID0gc3BsWzVdID8gcGFyc2VJbnQoc3BsWzVdKSA6IDA7CiAgICAgICAgICAgIEdhbWUuYmdUeXBlID0gc3BsWzZdID8gcGFyc2VJbnQoc3BsWzZdKSA6IDA7CiAgICAgICAgICAgIEdhbWUubWlsa1R5cGUgPSBzcGxbN10gPyBwYXJzZUludChzcGxbN10pIDogMDsKICAgICAgICAgICAgR2FtZS5jb29raWVzUmVzZXQgPSBzcGxbOF0gPyBwYXJzZUZsb2F0KHNwbFs4XSkgOiAwOwogICAgICAgICAgICBHYW1lLmVsZGVyV3JhdGggPSBzcGxbOV0gPyBwYXJzZUludChzcGxbOV0pIDogMDsKICAgICAgICAgICAgR2FtZS5wbGVkZ2VzID0gc3BsWzEwXSA/IHBhcnNlSW50KHNwbFsxMF0pIDogMDsKICAgICAgICAgICAgR2FtZS5wbGVkZ2VUID0gc3BsWzExXSA/IHBhcnNlSW50KHNwbFsxMV0pIDogMDsKICAgICAgICAgICAgR2FtZS5uZXh0UmVzZWFyY2ggPSBzcGxbMTJdID8gcGFyc2VJbnQoc3BsWzEyXSkgOiAwOwogICAgICAgICAgICBHYW1lLnJlc2VhcmNoVCA9IHNwbFsxM10gPyBwYXJzZUludChzcGxbMTNdKSA6IDA7CiAgICAgICAgICAgIEdhbWUucmVzZXRzID0gc3BsWzE0XSA/IHBhcnNlSW50KHNwbFsxNF0pIDogMDsKICAgICAgICAgICAgR2FtZS5nb2xkZW5DbGlja3NMb2NhbCA9IHNwbFsxNV0gPyBwYXJzZUludChzcGxbMTVdKSA6IDA7CiAgICAgICAgICAgIEdhbWUuY29va2llc1N1Y2tlZCA9IHNwbFsxNl0gPyBwYXJzZUZsb2F0KHNwbFsxNl0pIDogMDsKICAgICAgICAgICAgR2FtZS53cmlua2xlcnNQb3BwZWQgPSBzcGxbMTddID8gcGFyc2VJbnQoc3BsWzE3XSkgOiAwOwogICAgICAgICAgICBHYW1lLnNhbnRhTGV2ZWwgPSBzcGxbMThdID8gcGFyc2VJbnQoc3BsWzE4XSkgOiAwOwogICAgICAgICAgICBHYW1lLnJlaW5kZWVyQ2xpY2tlZCA9IHNwbFsxOV0gPyBwYXJzZUludChzcGxbMTldKSA6IDA7CiAgICAgICAgICAgIEdhbWUuc2Vhc29uVCA9IHNwbFsyMF0gPyBwYXJzZUludChzcGxbMjBdKSA6IDA7CiAgICAgICAgICAgIEdhbWUuc2Vhc29uVXNlcyA9IHNwbFsyMV0gPyBwYXJzZUludChzcGxbMjFdKSA6IDA7CiAgICAgICAgICAgIEdhbWUuc2Vhc29uID0gc3BsWzIyXSA/IHNwbFsyMl0gOiBHYW1lLmJhc2VTZWFzb247CiAgICAgICAgICAgIHZhciB3cmlua2xlcnMgPSB7CiAgICAgICAgICAgICAgYW1vdW50OiBzcGxbMjNdID8gcGFyc2VGbG9hdChzcGxbMjNdKSA6IDAsCiAgICAgICAgICAgICAgbnVtYmVyOiBzcGxbMjRdID8gcGFyc2VJbnQoc3BsWzI0XSkgOiAwLAogICAgICAgICAgICB9OwogICAgICAgICAgICBHYW1lLnByZXN0aWdlID0gc3BsWzI1XSA/IHBhcnNlRmxvYXQoc3BsWzI1XSkgOiAwOwogICAgICAgICAgICBHYW1lLmhlYXZlbmx5Q2hpcHMgPSBzcGxbMjZdID8gcGFyc2VGbG9hdChzcGxbMjZdKSA6IDA7CiAgICAgICAgICAgIEdhbWUuaGVhdmVubHlDaGlwc1NwZW50ID0gc3BsWzI3XSA/IHBhcnNlRmxvYXQoc3BsWzI3XSkgOiAwOwogICAgICAgICAgICBHYW1lLmhlYXZlbmx5Q29va2llcyA9IHNwbFsyOF0gPyBwYXJzZUZsb2F0KHNwbFsyOF0pIDogMDsKICAgICAgICAgICAgR2FtZS5hc2NlbnNpb25Nb2RlID0gc3BsWzI5XSA/IHBhcnNlSW50KHNwbFsyOV0pIDogMDsKICAgICAgICAgICAgR2FtZS5wZXJtYW5lbnRVcGdyYWRlc1swXSA9IHNwbFszMF0gPyBwYXJzZUludChzcGxbMzBdKSA6IC0xOwogICAgICAgICAgICBHYW1lLnBlcm1hbmVudFVwZ3JhZGVzWzFdID0gc3BsWzMxXSA/IHBhcnNlSW50KHNwbFszMV0pIDogLTE7CiAgICAgICAgICAgIEdhbWUucGVybWFuZW50VXBncmFkZXNbMl0gPSBzcGxbMzJdID8gcGFyc2VJbnQoc3BsWzMyXSkgOiAtMTsKICAgICAgICAgICAgR2FtZS5wZXJtYW5lbnRVcGdyYWRlc1szXSA9IHNwbFszM10gPyBwYXJzZUludChzcGxbMzNdKSA6IC0xOwogICAgICAgICAgICBHYW1lLnBlcm1hbmVudFVwZ3JhZGVzWzRdID0gc3BsWzM0XSA/IHBhcnNlSW50KHNwbFszNF0pIDogLTE7CiAgICAgICAgICAgIC8vaWYgKHZlcnNpb248MS4wNSkge0dhbWUuaGVhdmVubHlDaGlwc0Vhcm5lZD1HYW1lLkhvd011Y2hQcmVzdGlnZShHYW1lLmNvb2tpZXNSZXNldCk7R2FtZS5oZWF2ZW5seUNoaXBzPUdhbWUuaGVhdmVubHlDaGlwc0Vhcm5lZDt9CiAgICAgICAgICAgIEdhbWUuZHJhZ29uTGV2ZWwgPSBzcGxbMzVdID8gcGFyc2VJbnQoc3BsWzM1XSkgOiAwOwogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgdmVyc2lvbiA8IDIuMDA0MSAmJgogICAgICAgICAgICAgIEdhbWUuZHJhZ29uTGV2ZWwgPT0gR2FtZS5kcmFnb25MZXZlbHMubGVuZ3RoIC0gMgogICAgICAgICAgICApIHsKICAgICAgICAgICAgICBHYW1lLmRyYWdvbkxldmVsID0gR2FtZS5kcmFnb25MZXZlbHMubGVuZ3RoIC0gMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBHYW1lLmRyYWdvbkF1cmEgPSBzcGxbMzZdID8gcGFyc2VJbnQoc3BsWzM2XSkgOiAwOwogICAgICAgICAgICBHYW1lLmRyYWdvbkF1cmEyID0gc3BsWzM3XSA/IHBhcnNlSW50KHNwbFszN10pIDogMDsKICAgICAgICAgICAgR2FtZS5jaGltZVR5cGUgPSBzcGxbMzhdID8gcGFyc2VJbnQoc3BsWzM4XSkgOiAwOwogICAgICAgICAgICBHYW1lLnZvbHVtZSA9IHNwbFszOV0gPyBwYXJzZUludChzcGxbMzldKSA6IDc1OwogICAgICAgICAgICB3cmlua2xlcnMuc2hpbmllcyA9IHNwbFs0MF0gPyBwYXJzZUludChzcGxbNDBdKSA6IDA7CiAgICAgICAgICAgIHdyaW5rbGVycy5hbW91bnRTaGluaWVzID0gc3BsWzQxXSA/IHBhcnNlRmxvYXQoc3BsWzQxXSkgOiAwOwogICAgICAgICAgICBHYW1lLmx1bXBzID0gc3BsWzQyXSA/IHBhcnNlRmxvYXQoc3BsWzQyXSkgOiAtMTsKICAgICAgICAgICAgR2FtZS5sdW1wc1RvdGFsID0gc3BsWzQzXSA/IHBhcnNlRmxvYXQoc3BsWzQzXSkgOiAtMTsKICAgICAgICAgICAgR2FtZS5sdW1wVCA9IHNwbFs0NF0gPyBwYXJzZUludChzcGxbNDRdKSA6IERhdGUubm93KCk7CiAgICAgICAgICAgIEdhbWUubHVtcFJlZmlsbCA9IHNwbFs0NV0gPyBwYXJzZUludChzcGxbNDVdKSA6IDA7CiAgICAgICAgICAgIGlmICh2ZXJzaW9uIDwgMi4wMjIpIEdhbWUubHVtcFJlZmlsbCA9IEdhbWUuZnBzICogNjA7CiAgICAgICAgICAgIEdhbWUubHVtcEN1cnJlbnRUeXBlID0gc3BsWzQ2XSA/IHBhcnNlSW50KHNwbFs0Nl0pIDogMDsKICAgICAgICAgICAgR2FtZS52YXVsdCA9IHNwbFs0N10gPyBzcGxbNDddLnNwbGl0KCIsIikgOiBbXTsKICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLnZhdWx0KSB7CiAgICAgICAgICAgICAgR2FtZS52YXVsdFtpXSA9IHBhcnNlSW50KEdhbWUudmF1bHRbaV0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZhciBhY3R1YWxIZXJhbGRzID0gR2FtZS5oZXJhbGRzOyAvL3dlIHN0b3JlIHRoZSBhY3R1YWwgYW1vdW50IG9mIGhlcmFsZHMgdG8gcmVzdG9yZSBpdCBsYXRlcjsgaGVyZSB3ZSB1c2VkIHRoZSBhbW91bnQgcHJlc2VudCBpbiB0aGUgc2F2ZSB0byBjb21wdXRlIG9mZmxpbmUgQ3BTCiAgICAgICAgICAgIEdhbWUuaGVyYWxkcyA9IHNwbFs0OF0gPyBwYXJzZUZsb2F0KHNwbFs0OF0pIDogR2FtZS5oZXJhbGRzOwogICAgICAgICAgICBHYW1lLmZvcnR1bmVHQyA9IHNwbFs0OV0gPyBwYXJzZUludChzcGxbNDldKSA6IDA7CiAgICAgICAgICAgIEdhbWUuZm9ydHVuZUNQUyA9IHNwbFs1MF0gPyBwYXJzZUludChzcGxbNTBdKSA6IDA7CiAgICAgICAgICAgIEdhbWUuY29va2llc1BzUmF3SGlnaGVzdCA9IHNwbFs1MV0gPyBwYXJzZUZsb2F0KHNwbFs1MV0pIDogMDsKICAgICAgICAgICAgR2FtZS52b2x1bWVNdXNpYyA9IHNwbFs1Ml0gPyBwYXJzZUludChzcGxbNTJdKSA6IDUwOwoKICAgICAgICAgICAgc3BsID0gc3RyWzVdLnNwbGl0KCI7Iik7IC8vYnVpbGRpbmdzCiAgICAgICAgICAgIEdhbWUuQnVpbGRpbmdzT3duZWQgPSAwOwogICAgICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0c0J5SWQpIHsKICAgICAgICAgICAgICB2YXIgbWUgPSBHYW1lLk9iamVjdHNCeUlkW2ldOwogICAgICAgICAgICAgIG1lLnN3aXRjaE1pbmlnYW1lKGZhbHNlKTsKICAgICAgICAgICAgICBtZS5waWNzID0gW107CiAgICAgICAgICAgICAgaWYgKHNwbFtpXSkgewogICAgICAgICAgICAgICAgdmFyIG1lc3RyID0gc3BsW2ldLnRvU3RyaW5nKCkuc3BsaXQoIiwiKTsKICAgICAgICAgICAgICAgIG1lLmFtb3VudCA9IHBhcnNlSW50KG1lc3RyWzBdKTsKICAgICAgICAgICAgICAgIG1lLmJvdWdodCA9IHBhcnNlSW50KG1lc3RyWzFdKTsKICAgICAgICAgICAgICAgIG1lLnRvdGFsQ29va2llcyA9IHBhcnNlRmxvYXQobWVzdHJbMl0pOwogICAgICAgICAgICAgICAgbWUubGV2ZWwgPSBwYXJzZUludChtZXN0clszXSB8fCAwKTsKICAgICAgICAgICAgICAgIG1lLmhpZ2hlc3QgPSB2ZXJzaW9uID49IDIuMDI0ID8gcGFyc2VJbnQobWVzdHJbNl0pIDogbWUuYW1vdW50OwogICAgICAgICAgICAgICAgaWYgKG1lLm1pbmlnYW1lICYmIG1lLm1pbmlnYW1lTG9hZGVkICYmIG1lLm1pbmlnYW1lLnJlc2V0KSB7CiAgICAgICAgICAgICAgICAgIG1lLm1pbmlnYW1lLnJlc2V0KHRydWUpOwogICAgICAgICAgICAgICAgICBtZS5taW5pZ2FtZS5sb2FkKG1lc3RyWzRdIHx8ICIiKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBtZS5taW5pZ2FtZVNhdmUgPSBtZXN0cls0XSB8fCAwOwogICAgICAgICAgICAgICAgbWUubXV0ZWQgPSBwYXJzZUludChtZXN0cls1XSkgfHwgMDsKICAgICAgICAgICAgICAgIEdhbWUuQnVpbGRpbmdzT3duZWQgKz0gbWUuYW1vdW50OwogICAgICAgICAgICAgICAgaWYgKHZlcnNpb24gPCAyLjAwMykgbWUubGV2ZWwgPSAwOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBtZS5hbW91bnQgPSAwOwogICAgICAgICAgICAgICAgbWUudW5sb2NrZWQgPSAwOwogICAgICAgICAgICAgICAgbWUuYm91Z2h0ID0gMDsKICAgICAgICAgICAgICAgIG1lLmhpZ2hlc3QgPSAwOwogICAgICAgICAgICAgICAgbWUudG90YWxDb29raWVzID0gMDsKICAgICAgICAgICAgICAgIG1lLmxldmVsID0gMDsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEdhbWUuc2V0Vm9sdW1lTXVzaWMoR2FtZS52b2x1bWVNdXNpYyk7CgogICAgICAgICAgICBHYW1lLkxvYWRNaW5pZ2FtZXMoKTsKCiAgICAgICAgICAgIGlmICh2ZXJzaW9uIDwgMS4wMzUpIHsKICAgICAgICAgICAgICAvL29sZCBub24tYmluYXJ5IGFsZ29yaXRobQogICAgICAgICAgICAgIHNwbCA9IHN0cls2XS5zcGxpdCgiOyIpOyAvL3VwZ3JhZGVzCiAgICAgICAgICAgICAgR2FtZS5VcGdyYWRlc093bmVkID0gMDsKICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuVXBncmFkZXNCeUlkKSB7CiAgICAgICAgICAgICAgICB2YXIgbWUgPSBHYW1lLlVwZ3JhZGVzQnlJZFtpXTsKICAgICAgICAgICAgICAgIGlmIChzcGxbaV0pIHsKICAgICAgICAgICAgICAgICAgdmFyIG1lc3RyID0gc3BsW2ldLnNwbGl0KCIsIik7CiAgICAgICAgICAgICAgICAgIG1lLnVubG9ja2VkID0gcGFyc2VJbnQobWVzdHJbMF0pOwogICAgICAgICAgICAgICAgICBtZS5ib3VnaHQgPSBwYXJzZUludChtZXN0clsxXSk7CiAgICAgICAgICAgICAgICAgIGlmIChtZS5ib3VnaHQgJiYgR2FtZS5Db3VudHNBc1VwZ3JhZGVPd25lZChtZS5wb29sKSkKICAgICAgICAgICAgICAgICAgICBHYW1lLlVwZ3JhZGVzT3duZWQrKzsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIG1lLnVubG9ja2VkID0gMDsKICAgICAgICAgICAgICAgICAgbWUuYm91Z2h0ID0gMDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKHN0cls3XSkgc3BsID0gc3RyWzddLnNwbGl0KCI7Iik7CiAgICAgICAgICAgICAgZWxzZSBzcGwgPSBbXTsgLy9hY2hpZXZlbWVudHMKICAgICAgICAgICAgICBHYW1lLkFjaGlldmVtZW50c093bmVkID0gMDsKICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuQWNoaWV2ZW1lbnRzQnlJZCkgewogICAgICAgICAgICAgICAgdmFyIG1lID0gR2FtZS5BY2hpZXZlbWVudHNCeUlkW2ldOwogICAgICAgICAgICAgICAgaWYgKHNwbFtpXSkgewogICAgICAgICAgICAgICAgICB2YXIgbWVzdHIgPSBzcGxbaV0uc3BsaXQoIiwiKTsKICAgICAgICAgICAgICAgICAgbWUud29uID0gcGFyc2VJbnQobWVzdHJbMF0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgbWUud29uID0gMDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChtZS53b24gJiYgR2FtZS5Db3VudHNBc0FjaGlldmVtZW50T3duZWQobWUucG9vbCkpCiAgICAgICAgICAgICAgICAgIEdhbWUuQWNoaWV2ZW1lbnRzT3duZWQrKzsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSBpZiAodmVyc2lvbiA8IDEuMDUwMikgewogICAgICAgICAgICAgIC8vb2xkIGF3ZnVsIHBhY2tpbmcgc3lzdGVtCiAgICAgICAgICAgICAgaWYgKHN0cls2XSkgc3BsID0gc3RyWzZdOwogICAgICAgICAgICAgIGVsc2Ugc3BsID0gW107IC8vdXBncmFkZXMKICAgICAgICAgICAgICBpZiAodmVyc2lvbiA8IDEuMDUpIHNwbCA9IFVuY29tcHJlc3NMYXJnZUJpbihzcGwpOwogICAgICAgICAgICAgIGVsc2Ugc3BsID0gdW5wYWNrKHNwbCk7CiAgICAgICAgICAgICAgR2FtZS5VcGdyYWRlc093bmVkID0gMDsKICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuVXBncmFkZXNCeUlkKSB7CiAgICAgICAgICAgICAgICB2YXIgbWUgPSBHYW1lLlVwZ3JhZGVzQnlJZFtpXTsKICAgICAgICAgICAgICAgIGlmIChzcGxbaSAqIDJdKSB7CiAgICAgICAgICAgICAgICAgIHZhciBtZXN0ciA9IFtzcGxbaSAqIDJdLCBzcGxbaSAqIDIgKyAxXV07CiAgICAgICAgICAgICAgICAgIG1lLnVubG9ja2VkID0gcGFyc2VJbnQobWVzdHJbMF0pOwogICAgICAgICAgICAgICAgICBtZS5ib3VnaHQgPSBwYXJzZUludChtZXN0clsxXSk7CiAgICAgICAgICAgICAgICAgIGlmIChtZS5ib3VnaHQgJiYgR2FtZS5Db3VudHNBc1VwZ3JhZGVPd25lZChtZS5wb29sKSkKICAgICAgICAgICAgICAgICAgICBHYW1lLlVwZ3JhZGVzT3duZWQrKzsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIG1lLnVubG9ja2VkID0gMDsKICAgICAgICAgICAgICAgICAgbWUuYm91Z2h0ID0gMDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKHN0cls3XSkgc3BsID0gc3RyWzddOwogICAgICAgICAgICAgIGVsc2Ugc3BsID0gW107IC8vYWNoaWV2ZW1lbnRzCiAgICAgICAgICAgICAgaWYgKHZlcnNpb24gPCAxLjA1KSBzcGwgPSBVbmNvbXByZXNzTGFyZ2VCaW4oc3BsKTsKICAgICAgICAgICAgICBlbHNlIHNwbCA9IHVucGFjayhzcGwpOwogICAgICAgICAgICAgIEdhbWUuQWNoaWV2ZW1lbnRzT3duZWQgPSAwOwogICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5BY2hpZXZlbWVudHNCeUlkKSB7CiAgICAgICAgICAgICAgICB2YXIgbWUgPSBHYW1lLkFjaGlldmVtZW50c0J5SWRbaV07CiAgICAgICAgICAgICAgICBpZiAoc3BsW2ldKSB7CiAgICAgICAgICAgICAgICAgIHZhciBtZXN0ciA9IFtzcGxbaV1dOwogICAgICAgICAgICAgICAgICBtZS53b24gPSBwYXJzZUludChtZXN0clswXSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBtZS53b24gPSAwOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1lLndvbiAmJiBHYW1lLkNvdW50c0FzQWNoaWV2ZW1lbnRPd25lZChtZS5wb29sKSkKICAgICAgICAgICAgICAgICAgR2FtZS5BY2hpZXZlbWVudHNPd25lZCsrOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBpZiAoc3RyWzZdKSBzcGwgPSBzdHJbNl07CiAgICAgICAgICAgICAgZWxzZSBzcGwgPSBbXTsgLy91cGdyYWRlcwogICAgICAgICAgICAgIGlmICh2ZXJzaW9uIDwgMi4wMDQ2KSBzcGwgPSB1bnBhY2syKHNwbCkuc3BsaXQoIiIpOwogICAgICAgICAgICAgIGVsc2Ugc3BsID0gc3BsLnNwbGl0KCIiKTsKICAgICAgICAgICAgICBHYW1lLlVwZ3JhZGVzT3duZWQgPSAwOwogICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5VcGdyYWRlc0J5SWQpIHsKICAgICAgICAgICAgICAgIHZhciBtZSA9IEdhbWUuVXBncmFkZXNCeUlkW2ldOwogICAgICAgICAgICAgICAgaWYgKHNwbFtpICogMl0pIHsKICAgICAgICAgICAgICAgICAgdmFyIG1lc3RyID0gW3NwbFtpICogMl0sIHNwbFtpICogMiArIDFdXTsKICAgICAgICAgICAgICAgICAgbWUudW5sb2NrZWQgPSBwYXJzZUludChtZXN0clswXSk7CiAgICAgICAgICAgICAgICAgIG1lLmJvdWdodCA9IHBhcnNlSW50KG1lc3RyWzFdKTsKICAgICAgICAgICAgICAgICAgaWYgKG1lLmJvdWdodCAmJiBHYW1lLkNvdW50c0FzVXBncmFkZU93bmVkKG1lLnBvb2wpKQogICAgICAgICAgICAgICAgICAgIEdhbWUuVXBncmFkZXNPd25lZCsrOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgbWUudW5sb2NrZWQgPSAwOwogICAgICAgICAgICAgICAgICBtZS5ib3VnaHQgPSAwOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAoc3RyWzddKSBzcGwgPSBzdHJbN107CiAgICAgICAgICAgICAgZWxzZSBzcGwgPSBbXTsgLy9hY2hpZXZlbWVudHMKICAgICAgICAgICAgICBpZiAodmVyc2lvbiA8IDIuMDA0Nikgc3BsID0gdW5wYWNrMihzcGwpLnNwbGl0KCIiKTsKICAgICAgICAgICAgICBlbHNlIHNwbCA9IHNwbC5zcGxpdCgiIik7CiAgICAgICAgICAgICAgR2FtZS5BY2hpZXZlbWVudHNPd25lZCA9IDA7CiAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLkFjaGlldmVtZW50c0J5SWQpIHsKICAgICAgICAgICAgICAgIHZhciBtZSA9IEdhbWUuQWNoaWV2ZW1lbnRzQnlJZFtpXTsKICAgICAgICAgICAgICAgIGlmIChzcGxbaV0pIHsKICAgICAgICAgICAgICAgICAgdmFyIG1lc3RyID0gW3NwbFtpXV07CiAgICAgICAgICAgICAgICAgIG1lLndvbiA9IHBhcnNlSW50KG1lc3RyWzBdKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIG1lLndvbiA9IDA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAobWUud29uICYmIEdhbWUuQ291bnRzQXNBY2hpZXZlbWVudE93bmVkKG1lLnBvb2wpKQogICAgICAgICAgICAgICAgICBHYW1lLkFjaGlldmVtZW50c093bmVkKys7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBHYW1lLmtpbGxCdWZmcygpOwogICAgICAgICAgICB2YXIgYnVmZnNUb0xvYWQgPSBbXTsKICAgICAgICAgICAgc3BsID0gKHN0cls4XSB8fCAiIikuc3BsaXQoIjsiKTsgLy9idWZmcwogICAgICAgICAgICBmb3IgKHZhciBpIGluIHNwbCkgewogICAgICAgICAgICAgIGlmIChzcGxbaV0pIHsKICAgICAgICAgICAgICAgIHZhciBtZXN0ciA9IHNwbFtpXS50b1N0cmluZygpLnNwbGl0KCIsIik7CiAgICAgICAgICAgICAgICBidWZmc1RvTG9hZC5wdXNoKG1lc3RyKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHNwbCA9IChzdHJbOV0gfHwgIiIpLnNwbGl0KCI7Iik7IC8vbW9kIGRhdGEKCiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gc3BsKSB7CiAgICAgICAgICAgICAgaWYgKHNwbFtpXSkgewogICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBzcGxbaV0uc3BsaXQoIjoiKTsKICAgICAgICAgICAgICAgIHZhciBtb2RJZCA9IGRhdGFbMF07CiAgICAgICAgICAgICAgICBpZiAobW9kSWQgPT0gIk1FVEEiKSBjb250aW51ZTsKICAgICAgICAgICAgICAgIGRhdGEuc2hpZnQoKTsKICAgICAgICAgICAgICAgIGRhdGEgPSBHYW1lLnNhZmVMb2FkU3RyaW5nKGRhdGEuam9pbigiOiIpKTsKICAgICAgICAgICAgICAgIEdhbWUubW9kU2F2ZURhdGFbbW9kSWRdID0gZGF0YTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzQnlJZCkgewogICAgICAgICAgICAgIHZhciBtZSA9IEdhbWUuT2JqZWN0c0J5SWRbaV07CiAgICAgICAgICAgICAgaWYgKG1lLmJ1eUZ1bmN0aW9uKSBtZS5idXlGdW5jdGlvbigpOwogICAgICAgICAgICAgIG1lLnJlZnJlc2goKTsKICAgICAgICAgICAgICBpZiAobWUuaWQgPiAwKSB7CiAgICAgICAgICAgICAgICBpZiAobWUubXV0ZWQpIG1lLm11dGUoMSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAodmVyc2lvbiA8IDEuMDUwMykgewogICAgICAgICAgICAgIC8vdXBncmFkZXMgdGhhdCB1c2VkIHRvIGJlIHJlZ3VsYXIsIGJ1dCBhcmUgbm93IGhlYXZlbmx5CiAgICAgICAgICAgICAgdmFyIG1lID0gR2FtZS5VcGdyYWRlc1siUGVyc2lzdGVudCBtZW1vcnkiXTsKICAgICAgICAgICAgICBtZS51bmxvY2tlZCA9IDA7CiAgICAgICAgICAgICAgbWUuYm91Z2h0ID0gMDsKICAgICAgICAgICAgICB2YXIgbWUgPSBHYW1lLlVwZ3JhZGVzWyJTZWFzb24gc3dpdGNoZXIiXTsKICAgICAgICAgICAgICBtZS51bmxvY2tlZCA9IDA7CiAgICAgICAgICAgICAgbWUuYm91Z2h0ID0gMDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKEdhbWUuYmdUeXBlID09IC0xKSBHYW1lLmJnVHlwZSA9IDA7CiAgICAgICAgICAgIGlmIChHYW1lLm1pbGtUeXBlID09IC0xIHx8ICFHYW1lLkFsbE1pbGtzW0dhbWUubWlsa1R5cGVdKQogICAgICAgICAgICAgIEdhbWUubWlsa1R5cGUgPSAwOwoKICAgICAgICAgICAgLy9hZHZhbmNlIHRpbWVycwogICAgICAgICAgICB2YXIgZnJhbWVzRWxhcHNlZCA9IE1hdGguY2VpbCgKICAgICAgICAgICAgICAoKERhdGUubm93KCkgLSBHYW1lLmxhc3REYXRlKSAvIDEwMDApICogR2FtZS5mcHMKICAgICAgICAgICAgKTsKICAgICAgICAgICAgaWYgKEdhbWUucGxlZGdlVCA+IDApCiAgICAgICAgICAgICAgR2FtZS5wbGVkZ2VUID0gTWF0aC5tYXgoR2FtZS5wbGVkZ2VUIC0gZnJhbWVzRWxhcHNlZCwgMSk7CiAgICAgICAgICAgIGlmIChHYW1lLnNlYXNvblQgPiAwKQogICAgICAgICAgICAgIEdhbWUuc2Vhc29uVCA9IE1hdGgubWF4KEdhbWUuc2Vhc29uVCAtIGZyYW1lc0VsYXBzZWQsIDEpOwogICAgICAgICAgICBpZiAoR2FtZS5yZXNlYXJjaFQgPiAwKQogICAgICAgICAgICAgIEdhbWUucmVzZWFyY2hUID0gTWF0aC5tYXgoR2FtZS5yZXNlYXJjaFQgLSBmcmFtZXNFbGFwc2VkLCAxKTsKCiAgICAgICAgICAgIEdhbWUuUmVzZXRXcmlua2xlcnMoKTsKICAgICAgICAgICAgR2FtZS5Mb2FkV3JpbmtsZXJzKAogICAgICAgICAgICAgIHdyaW5rbGVycy5hbW91bnQsCiAgICAgICAgICAgICAgd3JpbmtsZXJzLm51bWJlciwKICAgICAgICAgICAgICB3cmlua2xlcnMuc2hpbmllcywKICAgICAgICAgICAgICB3cmlua2xlcnMuYW1vdW50U2hpbmllcwogICAgICAgICAgICApOwoKICAgICAgICAgICAgLy9yZWNvbXB1dGUgc2Vhc29uIHRyaWdnZXIgcHJpY2VzCiAgICAgICAgICAgIGlmIChHYW1lLkhhcygiU2Vhc29uIHN3aXRjaGVyIikpIHsKICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuc2Vhc29ucykgewogICAgICAgICAgICAgICAgR2FtZS5VbmxvY2soR2FtZS5zZWFzb25zW2ldLnRyaWdnZXIpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBHYW1lLmNvbXB1dGVTZWFzb25QcmljZXMoKTsKCiAgICAgICAgICAgIC8vcmVjb21wdXRlIHByZXN0aWdlCiAgICAgICAgICAgIEdhbWUucHJlc3RpZ2UgPSBNYXRoLmZsb29yKEdhbWUuSG93TXVjaFByZXN0aWdlKEdhbWUuY29va2llc1Jlc2V0KSk7CiAgICAgICAgICAgIC8vaWYgKChHYW1lLmhlYXZlbmx5Q2hpcHMrR2FtZS5oZWF2ZW5seUNoaXBzU3BlbnQpPEdhbWUucHJlc3RpZ2UpCiAgICAgICAgICAgIC8ve0dhbWUuaGVhdmVubHlDaGlwcz1HYW1lLnByZXN0aWdlO0dhbWUuaGVhdmVubHlDaGlwc1NwZW50PTA7fS8vY2hpcHMgb3duZWQgYW5kIHNwZW50IGRvbid0IGFkZCB1cCB0byB0b3RhbCBwcmVzdGlnZT8gc2V0IGNoaXBzIG93bmVkIHRvIHByZXN0aWdlCgogICAgICAgICAgICBHYW1lLmJha2VyeU5hbWVTZXQoYmFrZXJ5TmFtZSk7CgogICAgICAgICAgICBHYW1lLmxvYWRNb2REYXRhKCk7CgogICAgICAgICAgICBpZiAodmVyc2lvbiA9PSAxLjAzNyAmJiBHYW1lLmJldGEpIHsKICAgICAgICAgICAgICAvL2FyZSB3ZSBvcGVuaW5nIHRoZSBuZXcgYmV0YT8gaWYgc28sIHNhdmUgdGhlIG9sZCBiZXRhIHRvIC9iZXRhZHVuZ2VvbnMKICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oCiAgICAgICAgICAgICAgICAiQ29va2llQ2xpY2tlckdhbWVCZXRhRHVuZ2VvbnMiLAogICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCJDb29raWVDbGlja2VyR2FtZUJldGEiKQogICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgR2FtZS5Ob3RpZnkoCiAgICAgICAgICAgICAgICAiQmV0YSBzYXZlIGRhdGEiLAogICAgICAgICAgICAgICAgIllvdXIgYmV0YSBzYXZlIGRhdGEgaGFzIGJlZW4gc2FmZWx5IGV4cG9ydGVkIHRvIC9iZXRhZHVuZ2VvbnMuIiwKICAgICAgICAgICAgICAgIDIwCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfSBlbHNlIGlmICh2ZXJzaW9uID09IDEuMDUwMSAmJiBHYW1lLmJldGEpIHsKICAgICAgICAgICAgICAvL2FyZSB3ZSBvcGVuaW5nIHRoZSBuZXdlciBiZXRhPyBpZiBzbywgc2F2ZSB0aGUgb2xkIGJldGEgdG8gL29sZGJldGEKICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oCiAgICAgICAgICAgICAgICAiQ29va2llQ2xpY2tlckdhbWVPbGQiLAogICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCJDb29raWVDbGlja2VyR2FtZUJldGEiKQogICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgLy9HYW1lLk5vdGlmeSgnQmV0YSBzYXZlIGRhdGEnLCdZb3VyIGJldGEgc2F2ZSBkYXRhIGhhcyBiZWVuIHNhZmVseSBleHBvcnRlZCB0byAvb2xkYmV0YS4nLDIwKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAodmVyc2lvbiA8PSAxLjA0NjYgJiYgIUdhbWUuYmV0YSkgewogICAgICAgICAgICAgIC8vZXhwb3J0IHRoZSBvbGQgMjAxNCB2ZXJzaW9uIHRvIC92MTA0NjYKICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oCiAgICAgICAgICAgICAgICAiQ29va2llQ2xpY2tlckdhbWV2MTA0NjYiLAogICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCJDb29raWVDbGlja2VyR2FtZSIpCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAvL0dhbWUuTm90aWZ5KCdCZXRhIHNhdmUgZGF0YScsJ1lvdXIgc2F2ZSBkYXRhIGhhcyBiZWVuIHNhZmVseSBleHBvcnRlZCB0byAvdjEwNDY2LicsMjApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh2ZXJzaW9uID09IDEuOSkgewogICAgICAgICAgICAgIC8vYXJlIHdlIGltcG9ydGluZyBmcm9tIHRoZSAxLjkgYmV0YT8gcmVtb3ZlIGFsbCBoZWF2ZW5seSB1cGdyYWRlcyBhbmQgcmVmdW5kIGhlYXZlbmx5IGNoaXBzCiAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlVwZ3JhZGVzQnlJZCkgewogICAgICAgICAgICAgICAgdmFyIG1lID0gR2FtZS5VcGdyYWRlc0J5SWRbaV07CiAgICAgICAgICAgICAgICBpZiAobWUuYm91Z2h0ICYmIG1lLnBvb2wgPT0gInByZXN0aWdlIikgewogICAgICAgICAgICAgICAgICBtZS51bmxvY2tlZCA9IDA7CiAgICAgICAgICAgICAgICAgIG1lLmJvdWdodCA9IDA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIEdhbWUuaGVhdmVubHlDaGlwcyA9IEdhbWUucHJlc3RpZ2U7CiAgICAgICAgICAgICAgR2FtZS5oZWF2ZW5seUNoaXBzU3BlbnQgPSAwOwoKICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIEdhbWUuUHJvbXB0KAogICAgICAgICAgICAgICAgICAnPGgzPkJldGEgcGF0Y2g8L2gzPjxkaXYgY2xhc3M9ImJsb2NrIj5XZVwndmUgdHdlYWtlZCBzb21lIHRoaW5ncyBhbmQgZml4ZWQgc29tZSBvdGhlcnMsIHBsZWFzZSBjaGVjayB0aGUgdXBkYXRlIG5vdGVzITxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2Pk9mIG5vdGUgOiBkdWUgdG8gY2hhbmdlcyBpbiBwcmVzdGlnZSBiYWxhbmNpbmcsIGFsbCB5b3VyIGhlYXZlbmx5IHVwZ3JhZGVzIGhhdmUgYmVlbiByZW1vdmVkIGFuZCB5b3VyIGhlYXZlbmx5IGNoaXBzIHJlZnVuZGVkOyB5b3VcJ2xsIGJlIGFibGUgdG8gcmVhbGxvY2F0ZSB0aGVtIG5leHQgdGltZSB5b3UgYXNjZW5kLjxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PlRoYW5rIHlvdSBhZ2FpbiBmb3IgYmV0YS10ZXN0aW5nIENvb2tpZSBDbGlja2VyITwvZGl2PicsCiAgICAgICAgICAgICAgICAgIFtbIkFscmlnaHQgdGhlbiEiLCAiR2FtZS5DbG9zZVByb21wdCgpOyJdXQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICB9LCAyMDApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh2ZXJzaW9uIDw9IDEuMDQ2NikgewogICAgICAgICAgICAgIC8vYXJlIHdlIGxvYWRpbmcgZnJvbSB0aGUgb2xkIGxpdmUgdmVyc2lvbj8gcmVzZXQgSENzCiAgICAgICAgICAgICAgR2FtZS5oZWF2ZW5seUNoaXBzID0gR2FtZS5wcmVzdGlnZTsKICAgICAgICAgICAgICBHYW1lLmhlYXZlbmx5Q2hpcHNTcGVudCA9IDA7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChHYW1lLmFzY2Vuc2lvbk1vZGUgIT0gMSkgewogICAgICAgICAgICAgIGlmIChHYW1lLkhhcygiU3RhcnRlciBraXQiKSkgR2FtZS5PYmplY3RzWyJDdXJzb3IiXS5mcmVlID0gMTA7CiAgICAgICAgICAgICAgaWYgKEdhbWUuSGFzKCJTdGFydGVyIGtpdGNoZW4iKSkgR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0uZnJlZSA9IDU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEdhbWUuQ2FsY3VsYXRlR2FpbnMoKTsKCiAgICAgICAgICAgIHZhciB0aW1lT2ZmbGluZSA9IChEYXRlLm5vdygpIC0gR2FtZS5sYXN0RGF0ZSkgLyAxMDAwOwoKICAgICAgICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPCAxIC8gMTAwMDApIEdhbWUuVE9ZUyA9IDE7IC8vdGVlaGVlIQogICAgICAgICAgICBpZiAoTWF0aC5yYW5kb20oKSA8IDEgLyAxMDAwMCkgR2FtZS5XSU5LTEVSUyA9IDE7IC8vc3F1ZWFrCgogICAgICAgICAgICAvL2NvbXB1dGUgY29va2llcyBlYXJuZWQgd2hpbGUgdGhlIGdhbWUgd2FzIGNsb3NlZAogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgR2FtZS5tb2JpbGUgfHwKICAgICAgICAgICAgICBHYW1lLkhhcygiUGVyZmVjdCBpZGxpbmciKSB8fAogICAgICAgICAgICAgIEdhbWUuSGFzKCJUd2luIEdhdGVzIG9mIFRyYW5zY2VuZGVuY2UiKQogICAgICAgICAgICApIHsKICAgICAgICAgICAgICBpZiAoR2FtZS5IYXMoIlBlcmZlY3QgaWRsaW5nIikpIHsKICAgICAgICAgICAgICAgIHZhciBtYXhUaW1lID0gNjAgKiA2MCAqIDI0ICogMTAwMDAwMDAwMDsKICAgICAgICAgICAgICAgIHZhciBwZXJjZW50ID0gMTAwOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB2YXIgbWF4VGltZSA9IDYwICogNjA7CiAgICAgICAgICAgICAgICBpZiAoR2FtZS5IYXMoIkJlbHBoZWdvciIpKSBtYXhUaW1lICo9IDI7CiAgICAgICAgICAgICAgICBpZiAoR2FtZS5IYXMoIk1hbW1vbiIpKSBtYXhUaW1lICo9IDI7CiAgICAgICAgICAgICAgICBpZiAoR2FtZS5IYXMoIkFiYWRkb24iKSkgbWF4VGltZSAqPSAyOwogICAgICAgICAgICAgICAgaWYgKEdhbWUuSGFzKCJTYXRhbiIpKSBtYXhUaW1lICo9IDI7CiAgICAgICAgICAgICAgICBpZiAoR2FtZS5IYXMoIkFzbW9kZXVzIikpIG1heFRpbWUgKj0gMjsKICAgICAgICAgICAgICAgIGlmIChHYW1lLkhhcygiQmVlbHplYnViIikpIG1heFRpbWUgKj0gMjsKICAgICAgICAgICAgICAgIGlmIChHYW1lLkhhcygiTHVjaWZlciIpKSBtYXhUaW1lICo9IDI7CgogICAgICAgICAgICAgICAgdmFyIHBlcmNlbnQgPSA1OwogICAgICAgICAgICAgICAgaWYgKEdhbWUuSGFzKCJBbmdlbHMiKSkgcGVyY2VudCArPSAxMDsKICAgICAgICAgICAgICAgIGlmIChHYW1lLkhhcygiQXJjaGFuZ2VscyIpKSBwZXJjZW50ICs9IDEwOwogICAgICAgICAgICAgICAgaWYgKEdhbWUuSGFzKCJWaXJ0dWVzIikpIHBlcmNlbnQgKz0gMTA7CiAgICAgICAgICAgICAgICBpZiAoR2FtZS5IYXMoIkRvbWluaW9ucyIpKSBwZXJjZW50ICs9IDEwOwogICAgICAgICAgICAgICAgaWYgKEdhbWUuSGFzKCJDaGVydWJpbSIpKSBwZXJjZW50ICs9IDEwOwogICAgICAgICAgICAgICAgaWYgKEdhbWUuSGFzKCJTZXJhcGhpbSIpKSBwZXJjZW50ICs9IDEwOwogICAgICAgICAgICAgICAgaWYgKEdhbWUuSGFzKCJHb2QiKSkgcGVyY2VudCArPSAxMDsKCiAgICAgICAgICAgICAgICBpZiAoR2FtZS5IYXMoIkNoaW1lcmEiKSkgewogICAgICAgICAgICAgICAgICBtYXhUaW1lICs9IDYwICogNjAgKiAyNCAqIDI7CiAgICAgICAgICAgICAgICAgIHBlcmNlbnQgKz0gNTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoR2FtZS5IYXMoIkZlcm4gdGVhIikpIHBlcmNlbnQgKz0gMzsKICAgICAgICAgICAgICAgIGlmIChHYW1lLkhhcygiSWNob3Igc3lydXAiKSkgcGVyY2VudCArPSA3OwogICAgICAgICAgICAgICAgaWYgKEdhbWUuSGFzKCJGb3J0dW5lICMxMDIiKSkgcGVyY2VudCArPSAxOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdmFyIHRpbWVPZmZsaW5lT3B0aW1hbCA9IE1hdGgubWluKHRpbWVPZmZsaW5lLCBtYXhUaW1lKTsKICAgICAgICAgICAgICB2YXIgdGltZU9mZmxpbmVSZWR1Y2VkID0gTWF0aC5tYXgoCiAgICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgICAgdGltZU9mZmxpbmUgLSB0aW1lT2ZmbGluZU9wdGltYWwKICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIHZhciBhbW91bnQgPQogICAgICAgICAgICAgICAgKHRpbWVPZmZsaW5lT3B0aW1hbCArIHRpbWVPZmZsaW5lUmVkdWNlZCAqIDAuMSkgKgogICAgICAgICAgICAgICAgR2FtZS5jb29raWVzUHMgKgogICAgICAgICAgICAgICAgKHBlcmNlbnQgLyAxMDApOwoKICAgICAgICAgICAgICBpZiAoYW1vdW50ID4gMCkgewogICAgICAgICAgICAgICAgR2FtZS5Ob3RpZnkoCiAgICAgICAgICAgICAgICAgIGxvYygiV2VsY29tZSBiYWNrISIpLAogICAgICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAgICAgIllvdSBlYXJuZWQgPGI+JTE8L2I+IHdoaWxlIHlvdSB3ZXJlIGF3YXkuIiwKICAgICAgICAgICAgICAgICAgICBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeShhbW91bnQpKQogICAgICAgICAgICAgICAgICApICsKICAgICAgICAgICAgICAgICAgICAoRU4KICAgICAgICAgICAgICAgICAgICAgID8gIjxicj4oIiArCiAgICAgICAgICAgICAgICAgICAgICAgIEdhbWUuc2F5VGltZSh0aW1lT2ZmbGluZU9wdGltYWwgKiBHYW1lLmZwcywgLTEpICsKICAgICAgICAgICAgICAgICAgICAgICAgIiBhdCAiICsKICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5mbG9vcihwZXJjZW50KSArCiAgICAgICAgICAgICAgICAgICAgICAgICIlIENwUyIgKwogICAgICAgICAgICAgICAgICAgICAgICAodGltZU9mZmxpbmVSZWR1Y2VkCiAgICAgICAgICAgICAgICAgICAgICAgICAgPyAiLCBwbHVzICIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgR2FtZS5zYXlUaW1lKHRpbWVPZmZsaW5lUmVkdWNlZCAqIEdhbWUuZnBzLCAtMSkgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgIiBhdCAiICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGguZmxvb3IocGVyY2VudCAqIDEwKSAvIDEwMCArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiJSIKICAgICAgICAgICAgICAgICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAgICAgICAgICAgICAgICIuKSIKICAgICAgICAgICAgICAgICAgICAgIDogIiIpLAogICAgICAgICAgICAgICAgICBbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTYpLCAxMV0KICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICBHYW1lLkVhcm4oYW1vdW50KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vd2UgbG9hZCBidWZmcyBhZnRlciBldmVyeXRoaW5nIGFzIHdlIGRvIG5vdCB3YW50IHRoZW0gdG8gaW50ZXJmZXIgd2l0aCBvZmZsaW5lIENwUwogICAgICAgICAgICBmb3IgKHZhciBpIGluIGJ1ZmZzVG9Mb2FkKSB7CiAgICAgICAgICAgICAgdmFyIG1lc3RyID0gYnVmZnNUb0xvYWRbaV07CiAgICAgICAgICAgICAgdmFyIHR5cGUgPSBHYW1lLmJ1ZmZUeXBlc1twYXJzZUludChtZXN0clswXSldOwogICAgICAgICAgICAgIEdhbWUuZ2FpbkJ1ZmYoCiAgICAgICAgICAgICAgICB0eXBlLm5hbWUsCiAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KG1lc3RyWzFdKSAvIEdhbWUuZnBzLAogICAgICAgICAgICAgICAgcGFyc2VGbG9hdChtZXN0clszXSB8fCAwKSwKICAgICAgICAgICAgICAgIHBhcnNlRmxvYXQobWVzdHJbNF0gfHwgMCksCiAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KG1lc3RyWzVdIHx8IDApCiAgICAgICAgICAgICAgKS50aW1lID0gcGFyc2VGbG9hdChtZXN0clsyXSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEdhbWUubG9hZEx1bXBzKHRpbWVPZmZsaW5lKTsKCiAgICAgICAgICAgIEdhbWUuYmFrZXJ5TmFtZVJlZnJlc2goKTsKICAgICAgICAgIH0gLy9pbXBvcnRpbmcgb2xkIHZlcnNpb24gc2F2ZQogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgICAgIGxvYygiRXJyb3IgaW1wb3J0aW5nIHNhdmUiKSwKICAgICAgICAgICAgICBsb2MoIlNvcnJ5LCB5b3UgY2FuJ3QgaW1wb3J0IHNhdmVzIGZyb20gdGhlIGNsYXNzaWMgdmVyc2lvbi4iKSwKICAgICAgICAgICAgICAiIiwKICAgICAgICAgICAgICA2LAogICAgICAgICAgICAgIDEKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChHYW1lLnByZWZzLnNjcmVlbnJlYWRlcikgewogICAgICAgICAgICBHYW1lLkJ1aWxkU3RvcmUoKTsKICAgICAgICAgIH0KCiAgICAgICAgICBHYW1lLlJlYnVpbGRVcGdyYWRlcygpOwoKICAgICAgICAgIEdhbWUuVGlja2VyQWdlID0gMDsKICAgICAgICAgIEdhbWUuVGlja2VyRWZmZWN0ID0gMDsKCiAgICAgICAgICBHYW1lLmVsZGVyV3JhdGhEID0gMDsKICAgICAgICAgIEdhbWUucmVjYWxjdWxhdGVHYWlucyA9IDE7CiAgICAgICAgICBHYW1lLnN0b3JlVG9SZWZyZXNoID0gMTsKICAgICAgICAgIEdhbWUudXBncmFkZXNUb1JlYnVpbGQgPSAxOwoKICAgICAgICAgIEdhbWUuYnV5QnVsayA9IDE7CiAgICAgICAgICBHYW1lLmJ1eU1vZGUgPSAxOwogICAgICAgICAgR2FtZS5zdG9yZUJ1bGtCdXR0b24oLTEpOwoKICAgICAgICAgIEdhbWUuc3BlY2lhbFRhYiA9ICIiOwogICAgICAgICAgR2FtZS5Ub2dnbGVTcGVjaWFsTWVudSgwKTsKCiAgICAgICAgICBHYW1lLmtpbGxTaGltbWVycygpOwoKICAgICAgICAgIGlmIChHYW1lLlQgPiBHYW1lLmZwcyAqIDUgJiYgR2FtZS5SZWluY2FybmF0ZVRpbWVyID09IDApIHsKICAgICAgICAgICAgLy9mYWRlIG91dCBvZiBibGFjayBhbmQgcG9wIHRoZSBjb29raWUKICAgICAgICAgICAgR2FtZS5SZWluY2FybmF0ZVRpbWVyID0gMTsKICAgICAgICAgICAgR2FtZS5hZGRDbGFzcygicmVpbmNhcm5hdGluZyIpOwogICAgICAgICAgICBHYW1lLkJpZ0Nvb2tpZVNpemUgPSAwOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBwcmVzdGlnZVVwZ3JhZGVzT3duZWQgPSAwOwogICAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlVwZ3JhZGVzKSB7CiAgICAgICAgICAgIGlmIChHYW1lLlVwZ3JhZGVzW2ldLmJvdWdodCAmJiBHYW1lLlVwZ3JhZGVzW2ldLnBvb2wgPT0gInByZXN0aWdlIikKICAgICAgICAgICAgICBwcmVzdGlnZVVwZ3JhZGVzT3duZWQrKzsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChwcmVzdGlnZVVwZ3JhZGVzT3duZWQgPj0gMTAwKSBHYW1lLldpbigiQWxsIHRoZSBzdGFycyBpbiBoZWF2ZW4iKTsKCiAgICAgICAgICBpZiAodmVyc2lvbiA8IEdhbWUudmVyc2lvbikgbCgibG9nQnV0dG9uIikuY2xhc3NMaXN0LmFkZCgiaGFzVXBkYXRlIik7CgogICAgICAgICAgaWYgKEdhbWUuc2Vhc29uICE9ICIiICYmIEdhbWUuc2Vhc29uID09IEdhbWUuYmFzZVNlYXNvbikgewogICAgICAgICAgICBpZiAoR2FtZS5zZWFzb24gPT0gInZhbGVudGluZXMiKQogICAgICAgICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgICAgICAgbG9jKCJWYWxlbnRpbmUncyBEYXkhIiksCiAgICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAgICJJdCdzIDxiPlZhbGVudGluZSdzIHNlYXNvbjwvYj4hPGJyPkxvdmUncyBpbiB0aGUgYWlyIGFuZCBjb29raWVzIGFyZSBqdXN0IHRoYXQgbXVjaCBzd2VldGVyISIKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBbMjAsIDNdLAogICAgICAgICAgICAgICAgNjAgKiAzCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgZWxzZSBpZiAoR2FtZS5zZWFzb24gPT0gImZvb2xzIikKICAgICAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgICAgIGxvYygiQnVzaW5lc3MgRGF5ISIpLAogICAgICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICAgICAiSXQncyA8Yj5CdXNpbmVzcyBzZWFzb248L2I+ITxicj5Eb24ndCBwYW5pYyEgVGhpbmdzIGFyZSBnb25uYSBiZSBsb29raW5nIGEgbGl0dGxlIG1vcmUgY29ycG9yYXRlIGZvciBhIGZldyBkYXlzLiIKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBbMTcsIDZdLAogICAgICAgICAgICAgICAgNjAgKiAzCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgZWxzZSBpZiAoR2FtZS5zZWFzb24gPT0gImhhbGxvd2VlbiIpCiAgICAgICAgICAgICAgR2FtZS5Ob3RpZnkoCiAgICAgICAgICAgICAgICBsb2MoIkhhbGxvd2VlbiEiKSwKICAgICAgICAgICAgICAgIGxvYygKICAgICAgICAgICAgICAgICAgIkl0J3MgPGI+SGFsbG93ZWVuIHNlYXNvbjwvYj4hPGJyPkV2ZXJ5dGhpbmcgaXMganVzdCBhIGxpdHRsZSBiaXQgc3Bvb2tpZXIhIgogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIFsxMywgOF0sCiAgICAgICAgICAgICAgICA2MCAqIDMKICAgICAgICAgICAgICApOwogICAgICAgICAgICBlbHNlIGlmIChHYW1lLnNlYXNvbiA9PSAiY2hyaXN0bWFzIikKICAgICAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgICAgIGxvYygiQ2hyaXN0bWFzIHRpbWUhIiksCiAgICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAgICJJdCdzIDxiPkNocmlzdG1hcyBzZWFzb248L2I+ITxicj5CcmluZyBnb29kIGNoZWVyIHRvIGFsbCBhbmQgeW91IGp1c3QgbWF5IGdldCBjb29raWVzIGluIHlvdXIgc3RvY2tpbmdzISIKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBbMTIsIDEwXSwKICAgICAgICAgICAgICAgIDYwICogMwogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGVsc2UgaWYgKEdhbWUuc2Vhc29uID09ICJlYXN0ZXIiKQogICAgICAgICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgICAgICAgbG9jKCJFYXN0ZXIhIiksCiAgICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAgICJJdCdzIDxiPkVhc3RlciBzZWFzb248L2I+ITxicj5LZWVwIGFuIGV5ZSBvdXQgYW5kIHlvdSBqdXN0IG1pZ2h0IGNsaWNrIGEgcmFiYml0IG9yIHR3byEiCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgWzAsIDEyXSwKICAgICAgICAgICAgICAgIDYwICogMwogICAgICAgICAgICAgICk7CiAgICAgICAgICB9CgogICAgICAgICAgR2FtZS5oZXJhbGRzID0gYWN0dWFsSGVyYWxkczsKCiAgICAgICAgICBHYW1lLk5vdGlmeShsb2MoIkdhbWUgbG9hZGVkIiksICIiLCAiIiwgMSwgMSk7CgogICAgICAgICAgaWYgKCFBcHAgJiYgR2FtZS5wcmVmcy5zaG93QmFja3VwV2FybmluZyA9PSAxKQogICAgICAgICAgICBHYW1lLnNob3dCYWNrdXBXYXJuaW5nKCk7CgogICAgICAgICAgaWYgKEFwcCkgQXBwLmp1c3RMb2FkZWRTYXZlKCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgcmV0dXJuIGZhbHNlOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH07CgogICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkJUkVTRVQKCQk9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgR2FtZS5SZXNldCA9IGZ1bmN0aW9uIChoYXJkKSB7CiAgICAgIEdhbWUuVCA9IDA7CgogICAgICBpZiAoaGFyZCkgewogICAgICAgIEdhbWUubG9hZGVkRnJvbVZlcnNpb24gPSBHYW1lLnZlcnNpb247CiAgICAgIH0KCiAgICAgIHZhciBjb29raWVzRm9yZmVpdGVkID0gR2FtZS5jb29raWVzRWFybmVkOwogICAgICBpZiAoIWhhcmQpIHsKICAgICAgICBpZiAoY29va2llc0ZvcmZlaXRlZCA+PSAxMDAwMDAwKSBHYW1lLldpbigiU2FjcmlmaWNlIik7CiAgICAgICAgaWYgKGNvb2tpZXNGb3JmZWl0ZWQgPj0gMTAwMDAwMDAwMCkgR2FtZS5XaW4oIk9ibGl2aW9uIik7CiAgICAgICAgaWYgKGNvb2tpZXNGb3JmZWl0ZWQgPj0gMTAwMDAwMDAwMDAwMCkgR2FtZS5XaW4oIkZyb20gc2NyYXRjaCIpOwogICAgICAgIGlmIChjb29raWVzRm9yZmVpdGVkID49IDEwMDAwMDAwMDAwMDAwMDApIEdhbWUuV2luKCJOaWhpbGlzbSIpOwogICAgICAgIGlmIChjb29raWVzRm9yZmVpdGVkID49IDEwMDAwMDAwMDAwMDAwMDAwMDApIEdhbWUuV2luKCJEZW1hdGVyaWFsaXplIik7CiAgICAgICAgaWYgKGNvb2tpZXNGb3JmZWl0ZWQgPj0gMTAwMDAwMDAwMDAwMDAwMDAwMDAwMCkKICAgICAgICAgIEdhbWUuV2luKCJOaWwgemVybyB6aWxjaCIpOwogICAgICAgIGlmIChjb29raWVzRm9yZmVpdGVkID49IDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDApCiAgICAgICAgICBHYW1lLldpbigiVHJhbnNjZW5kZW5jZSIpOwogICAgICAgIGlmIChjb29raWVzRm9yZmVpdGVkID49IDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDApCiAgICAgICAgICBHYW1lLldpbigiT2JsaXRlcmF0ZSIpOwogICAgICAgIGlmIChjb29raWVzRm9yZmVpdGVkID49IDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDApCiAgICAgICAgICBHYW1lLldpbigiTmVnYXRpdmUgdm9pZCIpOwogICAgICAgIGlmIChjb29raWVzRm9yZmVpdGVkID49IDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDApCiAgICAgICAgICBHYW1lLldpbigiVG8gY3J1bWJzLCB5b3Ugc2F5PyIpOwogICAgICAgIGlmIChjb29raWVzRm9yZmVpdGVkID49IDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDApCiAgICAgICAgICBHYW1lLldpbigiWW91IGdldCBub3RoaW5nIik7CiAgICAgICAgaWYgKGNvb2tpZXNGb3JmZWl0ZWQgPj0gMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCkKICAgICAgICAgIEdhbWUuV2luKCJIdW1ibGUgcmViZWdpbm5pbmdzIik7CiAgICAgICAgaWYgKGNvb2tpZXNGb3JmZWl0ZWQgPj0gMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCkKICAgICAgICAgIEdhbWUuV2luKCJUaGUgZW5kIG9mIHRoZSB3b3JsZCIpOwogICAgICAgIGlmIChjb29raWVzRm9yZmVpdGVkID49IDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDApCiAgICAgICAgICBHYW1lLldpbigiT2gsIHlvdSdyZSBiYWNrIik7CiAgICAgICAgaWYgKAogICAgICAgICAgY29va2llc0ZvcmZlaXRlZCA+PSAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwCiAgICAgICAgKQogICAgICAgICAgR2FtZS5XaW4oIkxhemFydXMiKTsKICAgICAgICBpZiAoCiAgICAgICAgICBjb29raWVzRm9yZmVpdGVkID49CiAgICAgICAgICAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwCiAgICAgICAgKQogICAgICAgICAgR2FtZS5XaW4oIlNtdXJmIGFjY291bnQiKTsKICAgICAgICBpZiAoCiAgICAgICAgICBjb29raWVzRm9yZmVpdGVkID49CiAgICAgICAgICAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwCiAgICAgICAgKQogICAgICAgICAgR2FtZS5XaW4oIklmIGF0IGZpcnN0IHlvdSBkb24ndCBzdWNjZWVkIik7CgogICAgICAgIGlmIChNYXRoLnJvdW5kKEdhbWUuY29va2llcykgPT0gMTAwMDAwMDAwMDAwMCkKICAgICAgICAgIEdhbWUuV2luKCJXaGVuIHRoZSBjb29raWVzIGFzY2VuZCBqdXN0IHJpZ2h0Iik7CiAgICAgIH0KCiAgICAgIEdhbWUua2lsbEJ1ZmZzKCk7CgogICAgICBHYW1lLnNlZWQgPSBHYW1lLm1ha2VTZWVkKCk7CgogICAgICBHYW1lLmNvb2tpZXNSZXNldCArPSBHYW1lLmNvb2tpZXNFYXJuZWQ7CiAgICAgIEdhbWUuY29va2llcyA9IDA7CiAgICAgIEdhbWUuY29va2llc0Vhcm5lZCA9IDA7CiAgICAgIEdhbWUuY29va2llQ2xpY2tzID0gMDsKICAgICAgR2FtZS5nb2xkZW5DbGlja3NMb2NhbCA9IDA7CiAgICAgIC8vR2FtZS5nb2xkZW5DbGlja3M9MDsKICAgICAgLy9HYW1lLm1pc3NlZEdvbGRlbkNsaWNrcz0wOwogICAgICBHYW1lLmhhbmRtYWRlQ29va2llcyA9IDA7CiAgICAgIEdhbWUuY29va2llc1BzUmF3SGlnaGVzdCA9IDA7CiAgICAgIGlmIChoYXJkKSB7CiAgICAgICAgR2FtZS5iZ1R5cGUgPSAwOwogICAgICAgIEdhbWUubWlsa1R5cGUgPSAwOwogICAgICAgIEdhbWUuY2hpbWVUeXBlID0gMDsKCiAgICAgICAgR2FtZS52YXVsdCA9IFtdOwogICAgICB9CiAgICAgIEdhbWUucGxlZGdlcyA9IDA7CiAgICAgIEdhbWUucGxlZGdlVCA9IDA7CiAgICAgIEdhbWUuZWxkZXJXcmF0aCA9IDA7CiAgICAgIEdhbWUuZWxkZXJXcmF0aE9sZCA9IDA7CiAgICAgIEdhbWUuZWxkZXJXcmF0aEQgPSAwOwogICAgICBHYW1lLm5leHRSZXNlYXJjaCA9IDA7CiAgICAgIEdhbWUucmVzZWFyY2hUID0gMDsKICAgICAgR2FtZS5zZWFzb25UID0gMDsKICAgICAgR2FtZS5zZWFzb25Vc2VzID0gMDsKICAgICAgR2FtZS5zZWFzb24gPSBHYW1lLmJhc2VTZWFzb247CiAgICAgIEdhbWUuY29tcHV0ZVNlYXNvblByaWNlcygpOwoKICAgICAgR2FtZS5zdGFydERhdGUgPSBwYXJzZUludChEYXRlLm5vdygpKTsKICAgICAgR2FtZS5sYXN0RGF0ZSA9IHBhcnNlSW50KERhdGUubm93KCkpOwoKICAgICAgR2FtZS5jb29raWVzU3Vja2VkID0gMDsKICAgICAgR2FtZS53cmlua2xlcnNQb3BwZWQgPSAwOwogICAgICBHYW1lLlJlc2V0V3JpbmtsZXJzKCk7CgogICAgICBHYW1lLnNhbnRhTGV2ZWwgPSAwOwogICAgICBHYW1lLnJlaW5kZWVyQ2xpY2tlZCA9IDA7CgogICAgICBHYW1lLmRyYWdvbkxldmVsID0gMDsKICAgICAgR2FtZS5kcmFnb25BdXJhID0gMDsKICAgICAgR2FtZS5kcmFnb25BdXJhMiA9IDA7CgogICAgICBHYW1lLmZvcnR1bmVHQyA9IDA7CiAgICAgIEdhbWUuZm9ydHVuZUNQUyA9IDA7CgogICAgICBHYW1lLlRpY2tlckNsaWNrcyA9IDA7CgogICAgICBpZiAoR2FtZS5nYWluZWRQcmVzdGlnZSA+IDApIEdhbWUucmVzZXRzKys7CiAgICAgIGlmICghaGFyZCAmJiBHYW1lLmNhbkx1bXBzKCkgJiYgR2FtZS5hc2NlbnNpb25Nb2RlICE9IDEpCiAgICAgICAgR2FtZS5hZGRDbGFzcygibHVtcHNPbiIpOwogICAgICBlbHNlIEdhbWUucmVtb3ZlQ2xhc3MoImx1bXBzT24iKTsKICAgICAgR2FtZS5nYWluZWRQcmVzdGlnZSA9IDA7CgogICAgICBmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0c0J5SWQpIHsKICAgICAgICB2YXIgbWUgPSBHYW1lLk9iamVjdHNCeUlkW2ldOwogICAgICAgIG1lLmFtb3VudCA9IDA7CiAgICAgICAgbWUuYm91Z2h0ID0gMDsKICAgICAgICBtZS5oaWdoZXN0ID0gMDsKICAgICAgICBtZS5mcmVlID0gMDsKICAgICAgICBtZS50b3RhbENvb2tpZXMgPSAwOwogICAgICAgIG1lLnN3aXRjaE1pbmlnYW1lKGZhbHNlKTsKICAgICAgICBpZiAoaGFyZCkgewogICAgICAgICAgbWUubXV0ZWQgPSAwOwogICAgICAgIH0KICAgICAgICBtZS5waWNzID0gW107CiAgICAgICAgbWUucmVmcmVzaCgpOwogICAgICB9CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5VcGdyYWRlc0J5SWQpIHsKICAgICAgICB2YXIgbWUgPSBHYW1lLlVwZ3JhZGVzQnlJZFtpXTsKICAgICAgICBpZiAoaGFyZCB8fCBtZS5wb29sICE9ICJwcmVzdGlnZSIpIG1lLmJvdWdodCA9IDA7CiAgICAgICAgaWYgKGhhcmQpIG1lLnVubG9ja2VkID0gMDsKICAgICAgICBpZiAobWUucG9vbCAhPSAicHJlc3RpZ2UiICYmICFtZS5sYXN0aW5nKSB7CiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIEdhbWUuSGFzKCJLZWVwc2FrZXMiKSAmJgogICAgICAgICAgICBHYW1lLnNlYXNvbkRyb3BzLmluZGV4T2YobWUubmFtZSkgIT0gLTEgJiYKICAgICAgICAgICAgTWF0aC5yYW5kb20oKSA8IDEgLyA1CiAgICAgICAgICApIHsKICAgICAgICAgIH0gZWxzZSBpZiAoCiAgICAgICAgICAgIEdhbWUuYXNjZW5zaW9uTW9kZSA9PSAxICYmCiAgICAgICAgICAgIEdhbWUuSGFzQWNoaWV2KCJPIEZvcnR1bmEiKSAmJgogICAgICAgICAgICBtZS50aWVyID09ICJmb3J0dW5lIgogICAgICAgICAgKSB7CiAgICAgICAgICB9IGVsc2UgaWYgKAogICAgICAgICAgICBHYW1lLkhhc0FjaGlldigiTyBGb3J0dW5hIikgJiYKICAgICAgICAgICAgbWUudGllciA9PSAiZm9ydHVuZSIgJiYKICAgICAgICAgICAgTWF0aC5yYW5kb20oKSA8IDAuNAogICAgICAgICAgKSB7CiAgICAgICAgICB9IGVsc2UgbWUudW5sb2NrZWQgPSAwOwogICAgICAgIH0KICAgICAgfQoKICAgICAgR2FtZS5CdWlsZGluZ3NPd25lZCA9IDA7CiAgICAgIEdhbWUuVXBncmFkZXNPd25lZCA9IDA7CgogICAgICBHYW1lLmNvb2tpZXNQc0J5VHlwZSA9IHt9OwogICAgICBHYW1lLmNvb2tpZXNNdWx0QnlUeXBlID0ge307CgogICAgICBpZiAoIWhhcmQpIHsKICAgICAgICBpZiAoR2FtZS5hc2NlbnNpb25Nb2RlICE9IDEpIHsKICAgICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5wZXJtYW5lbnRVcGdyYWRlcykgewogICAgICAgICAgICBpZiAoR2FtZS5wZXJtYW5lbnRVcGdyYWRlc1tpXSAhPSAtMSkgewogICAgICAgICAgICAgIEdhbWUuVXBncmFkZXNCeUlkW0dhbWUucGVybWFuZW50VXBncmFkZXNbaV1dLmVhcm4oKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgaWYgKEdhbWUuSGFzKCJTZWFzb24gc3dpdGNoZXIiKSkgewogICAgICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuc2Vhc29ucykgewogICAgICAgICAgICAgIEdhbWUuVW5sb2NrKEdhbWUuc2Vhc29uc1tpXS50cmlnZ2VyKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGlmIChHYW1lLkhhcygiU3RhcnRlciBraXQiKSkgR2FtZS5PYmplY3RzWyJDdXJzb3IiXS5nZXRGcmVlKDEwKTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiU3RhcnRlciBraXRjaGVuIikpIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLmdldEZyZWUoNSk7CiAgICAgICAgfQogICAgICB9CgogICAgICAvKmZvciAodmFyIGkgaW4gR2FtZS5BY2hpZXZlbWVudHNCeUlkKQoJCQl7CgkJCQl2YXIgbWU9R2FtZS5BY2hpZXZlbWVudHNCeUlkW2ldOwoJCQkJbWUud29uPTA7CgkJCX0qLwogICAgICAvL0dhbWUuRGVmYXVsdFByZWZzKCk7CiAgICAgIEJlYXV0aWZ5QWxsKCk7CgogICAgICBHYW1lLlJlYnVpbGRVcGdyYWRlcygpOwogICAgICBHYW1lLlRpY2tlckFnZSA9IDA7CiAgICAgIEdhbWUuVGlja2VyRWZmZWN0ID0gMDsKICAgICAgR2FtZS5yZWNhbGN1bGF0ZUdhaW5zID0gMTsKICAgICAgR2FtZS5zdG9yZVRvUmVmcmVzaCA9IDE7CiAgICAgIEdhbWUudXBncmFkZXNUb1JlYnVpbGQgPSAxOwogICAgICBHYW1lLmtpbGxTaGltbWVycygpOwoKICAgICAgR2FtZS5idXlCdWxrID0gMTsKICAgICAgR2FtZS5idXlNb2RlID0gMTsKICAgICAgR2FtZS5zdG9yZUJ1bGtCdXR0b24oLTEpOwoKICAgICAgR2FtZS5Mb2FkTWluaWdhbWVzKCk7CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzQnlJZCkgewogICAgICAgIHZhciBtZSA9IEdhbWUuT2JqZWN0c0J5SWRbaV07CiAgICAgICAgaWYgKGhhcmQgJiYgbWUubWluaWdhbWUgJiYgbWUubWluaWdhbWUubGF1bmNoKSB7CiAgICAgICAgICBtZS5taW5pZ2FtZS5sYXVuY2goKTsKICAgICAgICAgIG1lLm1pbmlnYW1lLnJlc2V0KHRydWUpOwogICAgICAgIH0gZWxzZSBpZiAoIWhhcmQgJiYgbWUubWluaWdhbWUgJiYgbWUubWluaWdhbWUucmVzZXQpCiAgICAgICAgICBtZS5taW5pZ2FtZS5yZXNldCgpOwogICAgICB9CgogICAgICBsKCJ0b2dnbGVCb3giKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICBsKCJ0b2dnbGVCb3giKS5pbm5lckhUTUwgPSAiIjsKICAgICAgR2FtZS5jaG9pY2VTZWxlY3Rvck9uID0gLTE7CiAgICAgIEdhbWUuVG9nZ2xlU3BlY2lhbE1lbnUoMCk7CiAgICAgIEdhbWUuc3BlY2lhbFRhYiA9ICIiOwoKICAgICAgbCgibG9nQnV0dG9uIikuY2xhc3NMaXN0LnJlbW92ZSgiaGFzVXBkYXRlIik7CgogICAgICBHYW1lLnJ1bk1vZEhvb2soInJlc2V0IiwgaGFyZCk7CgogICAgICBpZiAoaGFyZCkgewogICAgICAgIEdhbWUuY2xpY2tzVGhpc1Nlc3Npb24gPSAwOwogICAgICAgIGlmIChHYW1lLlQgPiBHYW1lLmZwcyAqIDUgJiYgR2FtZS5SZWluY2FybmF0ZVRpbWVyID09IDApIHsKICAgICAgICAgIC8vZmFkZSBvdXQgb2YgYmxhY2sgYW5kIHBvcCB0aGUgY29va2llCiAgICAgICAgICBHYW1lLlJlaW5jYXJuYXRlVGltZXIgPSAxOwogICAgICAgICAgR2FtZS5hZGRDbGFzcygicmVpbmNhcm5hdGluZyIpOwogICAgICAgICAgR2FtZS5CaWdDb29raWVTaXplID0gMDsKICAgICAgICB9CiAgICAgICAgR2FtZS5Ob3RpZnkoCiAgICAgICAgICBsb2MoIkdhbWUgcmVzZXQiKSwKICAgICAgICAgIEVOID8gIlNvIGxvbmcsIGNvb2tpZXMuIiA6IGxvYygiR29vZCBieWUsIGNvb2tpZXMuIiksCiAgICAgICAgICBbMjEsIDZdLAogICAgICAgICAgNgogICAgICAgICk7CiAgICAgIH0gZWxzZSBHYW1lLmNsaWNrc1RoaXNTZXNzaW9uID0gTWF0aC5tYXgoR2FtZS5jbGlja3NUaGlzU2Vzc2lvbiwgMSk7CgogICAgICBHYW1lLmp1a2Vib3gucmVzZXQoKTsKICAgICAgaWYgKGhhcmQpIFBsYXlDdWUoImxhdW5jaCIpOwogICAgICBlbHNlIFBsYXlDdWUoInBsYXkiKTsKICAgIH07CiAgICBHYW1lLkhhcmRSZXNldCA9IGZ1bmN0aW9uIChieXBhc3MpIHsKICAgICAgaWYgKCFieXBhc3MpIHsKICAgICAgICBHYW1lLlByb21wdCgKICAgICAgICAgICI8aWQgV2lwZVNhdmU+PGgzPiIgKwogICAgICAgICAgICBsb2MoIldpcGUgc2F2ZSIpICsKICAgICAgICAgICAgJzwvaDM+PGRpdiBjbGFzcz0iYmxvY2siPicgKwogICAgICAgICAgICB0aW55SWNvbihbMTUsIDVdKSArCiAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICJEbyB5b3UgUkVBTExZIHdhbnQgdG8gd2lwZSB5b3VyIHNhdmU/PGJyPjxzbWFsbD5Zb3Ugd2lsbCBsb3NlIHlvdXIgcHJvZ3Jlc3MsIHlvdXIgYWNoaWV2ZW1lbnRzLCBhbmQgeW91ciBoZWF2ZW5seSBjaGlwcyE8L3NtYWxsPiIKICAgICAgICAgICAgKSArCiAgICAgICAgICAgICI8L2Rpdj4iLAogICAgICAgICAgWwogICAgICAgICAgICBbCiAgICAgICAgICAgICAgRU4gPyAiWWVzISIgOiBsb2MoIlllcyIpLAogICAgICAgICAgICAgICJHYW1lLkNsb3NlUHJvbXB0KCk7R2FtZS5IYXJkUmVzZXQoMSk7IiwKICAgICAgICAgICAgICAiZmxvYXQ6bGVmdCIsCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIFtsb2MoIk5vIiksIDAsICJmbG9hdDpyaWdodCJdLAogICAgICAgICAgXQogICAgICAgICk7CiAgICAgIH0gZWxzZSBpZiAoYnlwYXNzID09IDEpIHsKICAgICAgICBHYW1lLlByb21wdCgKICAgICAgICAgICI8aWQgUmVhbGx5V2lwZVNhdmU+PGgzPiIgKwogICAgICAgICAgICBsb2MoIldpcGUgc2F2ZSIpICsKICAgICAgICAgICAgJzwvaDM+PGRpdiBjbGFzcz0iYmxvY2siPicgKwogICAgICAgICAgICB0aW55SWNvbihbMTUsIDVdKSArCiAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICJXaG9haCBub3csIGFyZSB5b3UgcmVhbGx5LCA8Yj48aT5SRUFMTFk8L2k+PC9iPiBzdXJlIHlvdSB3YW50IHRvIGdvIHRocm91Z2ggd2l0aCB0aGlzPzxicj48c21hbGw+RG9uJ3Qgc2F5IHdlIGRpZG4ndCB3YXJuIHlvdSE8L3NtYWxsPiIKICAgICAgICAgICAgKSArCiAgICAgICAgICAgICI8L2Rpdj4iLAogICAgICAgICAgWwogICAgICAgICAgICBbCiAgICAgICAgICAgICAgRU4gPyAiRG8gaXQhIiA6IGxvYygiWWVzIiksCiAgICAgICAgICAgICAgIkdhbWUuQ2xvc2VQcm9tcHQoKTtHYW1lLkhhcmRSZXNldCgyKTsiLAogICAgICAgICAgICAgICJmbG9hdDpsZWZ0IiwKICAgICAgICAgICAgXSwKICAgICAgICAgICAgW2xvYygiTm8iKSwgMCwgImZsb2F0OnJpZ2h0Il0sCiAgICAgICAgICBdCiAgICAgICAgKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuQWNoaWV2ZW1lbnRzQnlJZCkgewogICAgICAgICAgdmFyIG1lID0gR2FtZS5BY2hpZXZlbWVudHNCeUlkW2ldOwogICAgICAgICAgbWUud29uID0gMDsKICAgICAgICB9CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHNCeUlkKSB7CiAgICAgICAgICB2YXIgbWUgPSBHYW1lLk9iamVjdHNCeUlkW2ldOwogICAgICAgICAgbWUubGV2ZWwgPSAwOwogICAgICAgIH0KCiAgICAgICAgR2FtZS5BY2hpZXZlbWVudHNPd25lZCA9IDA7CiAgICAgICAgR2FtZS5nb2xkZW5DbGlja3MgPSAwOwogICAgICAgIEdhbWUubWlzc2VkR29sZGVuQ2xpY2tzID0gMDsKICAgICAgICBHYW1lLlJlc2V0KDEpOwogICAgICAgIEdhbWUucmVzZXRzID0gMDsKICAgICAgICBHYW1lLmZ1bGxEYXRlID0gcGFyc2VJbnQoRGF0ZS5ub3coKSk7CiAgICAgICAgR2FtZS5iYWtlcnlOYW1lID0gR2FtZS5HZXRCYWtlcnlOYW1lKCk7CiAgICAgICAgR2FtZS5iYWtlcnlOYW1lUmVmcmVzaCgpOwogICAgICAgIEdhbWUuY29va2llc1Jlc2V0ID0gMDsKICAgICAgICBHYW1lLnByZXN0aWdlID0gMDsKICAgICAgICBHYW1lLmhlYXZlbmx5Q2hpcHMgPSAwOwogICAgICAgIEdhbWUuaGVhdmVubHlDaGlwc1NwZW50ID0gMDsKICAgICAgICBHYW1lLmhlYXZlbmx5Q29va2llcyA9IDA7CiAgICAgICAgR2FtZS5wZXJtYW5lbnRVcGdyYWRlcyA9IFstMSwgLTEsIC0xLCAtMSwgLTFdOwogICAgICAgIEdhbWUuYXNjZW5zaW9uTW9kZSA9IDA7CiAgICAgICAgR2FtZS5sdW1wcyA9IC0xOwogICAgICAgIEdhbWUubHVtcHNUb3RhbCA9IC0xOwogICAgICAgIEdhbWUubHVtcFQgPSBEYXRlLm5vdygpOwogICAgICAgIEdhbWUubHVtcFJlZmlsbCA9IDA7CiAgICAgICAgR2FtZS5yZW1vdmVDbGFzcygibHVtcHNPbiIpOwogICAgICAgIGlmIChBcHApIEFwcC5oYXJkUmVzZXQoKTsKICAgICAgfQogICAgfTsKCiAgICBHYW1lLm9uQ3JhdGUgPSAwOwogICAgR2FtZS5zZXRPbkNyYXRlID0gZnVuY3Rpb24gKHdoYXQpIHsKICAgICAgR2FtZS5vbkNyYXRlID0gd2hhdDsKICAgIH07CiAgICBHYW1lLmNyYXRlID0gZnVuY3Rpb24gKG1lLCBjb250ZXh0LCBmb3JjZUNsaWNrU3RyLCBpZCwgc3R5bGUpIHsKICAgICAgLy9wcm9kdWNlIGEgY3JhdGUgd2l0aCBhc3NvY2lhdGVkIHRvb2x0aXAgZm9yIGFuIHVwZ3JhZGUgb3IgYWNoaWV2ZW1lbnQKICAgICAgLy9tZSBpcyBhbiBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSB1cGdyYWRlIG9yIGFjaGlldmVtZW50CiAgICAgIC8vY29udGV4dCBjYW4gYmUgInN0b3JlIiwgImFzY2VuZCIsICJzdGF0cyIgb3IgdW5kZWZpbmVkCiAgICAgIC8vZm9yY2VDbGlja1N0ciBjaGFuZ2VzIHdoYXQgaXMgZG9uZSB3aGVuIHRoZSBjcmF0ZSBpcyBjbGlja2VkCiAgICAgIC8vaWQgaXMgdGhlIHJlc3VsdGluZyBkaXYncyBkZXNpcmVkIGlkCgogICAgICB2YXIgY2xhc3NlcyA9ICJjcmF0ZSI7CiAgICAgIHZhciBlbmFibGVkID0gMDsKICAgICAgdmFyIG5vRnJhbWUgPSAwOwogICAgICB2YXIgYXR0YWNobWVudCA9ICJ0b3AiOwogICAgICB2YXIgbmV1cm9tYW5jeSA9IDA7CiAgICAgIGlmICgKICAgICAgICBjb250ZXh0ID09ICJzdGF0cyIgJiYKICAgICAgICAoR2FtZS5IYXMoIk5ldXJvbWFuY3kiKSB8fCAoR2FtZS5zZXNhbWUgJiYgbWUucG9vbCA9PSAiZGVidWciKSkKICAgICAgKQogICAgICAgIG5ldXJvbWFuY3kgPSAxOwogICAgICB2YXIgbXlzdGVyaW91cyA9IDA7CiAgICAgIHZhciBjbGlja1N0ciA9ICIiOwoKICAgICAgaWYgKG1lLnR5cGUgPT0gInVwZ3JhZGUiKSB7CiAgICAgICAgdmFyIGNhbkJ1eSA9IGNvbnRleHQgPT0gInN0b3JlIiA/IG1lLmNhbkJ1eSgpIDogdHJ1ZTsKICAgICAgICBpZiAoCiAgICAgICAgICBjb250ZXh0ID09ICJzdGF0cyIgJiYKICAgICAgICAgIG1lLmJvdWdodCA9PSAwICYmCiAgICAgICAgICAhR2FtZS5IYXMoIk5ldXJvbWFuY3kiKSAmJgogICAgICAgICAgKCFHYW1lLnNlc2FtZSB8fCBtZS5wb29sICE9ICJkZWJ1ZyIpCiAgICAgICAgKQogICAgICAgICAgcmV0dXJuICIiOwogICAgICAgIGVsc2UgaWYgKAogICAgICAgICAgY29udGV4dCA9PSAic3RhdHMiICYmCiAgICAgICAgICAoR2FtZS5IYXMoIk5ldXJvbWFuY3kiKSB8fCAoR2FtZS5zZXNhbWUgJiYgbWUucG9vbCA9PSAiZGVidWciKSkKICAgICAgICApCiAgICAgICAgICBuZXVyb21hbmN5ID0gMTsKICAgICAgICBlbHNlIGlmIChjb250ZXh0ID09ICJzdG9yZSIgJiYgIWNhbkJ1eSkgZW5hYmxlZCA9IDA7CiAgICAgICAgZWxzZSBpZiAoY29udGV4dCA9PSAiYXNjZW5kIiAmJiBtZS5ib3VnaHQgPT0gMCkgZW5hYmxlZCA9IDA7CiAgICAgICAgZWxzZSBlbmFibGVkID0gMTsKICAgICAgICBpZiAobWUuYm91Z2h0ID4gMCkgZW5hYmxlZCA9IDE7CgogICAgICAgIGlmIChjb250ZXh0ID09ICJzdGF0cyIgJiYgIUdhbWUucHJlZnMuY3JhdGVzKSBub0ZyYW1lID0gMTsKCiAgICAgICAgY2xhc3NlcyArPSAiIHVwZ3JhZGUiOwogICAgICAgIGlmIChtZS5wb29sID09ICJwcmVzdGlnZSIpIGNsYXNzZXMgKz0gIiBoZWF2ZW5seSI7CgogICAgICAgIGlmIChuZXVyb21hbmN5KSBjbGlja1N0ciA9ICJHYW1lLlVwZ3JhZGVzQnlJZFsiICsgbWUuaWQgKyAiXS50b2dnbGUoKTsiOwogICAgICB9IGVsc2UgaWYgKG1lLnR5cGUgPT0gImFjaGlldmVtZW50IikgewogICAgICAgIGlmIChjb250ZXh0ID09ICJzdGF0cyIgJiYgbWUud29uID09IDAgJiYgbWUucG9vbCAhPSAibm9ybWFsIikgcmV0dXJuICIiOwogICAgICAgIGVsc2UgaWYgKGNvbnRleHQgIT0gInN0YXRzIikgZW5hYmxlZCA9IDE7CgogICAgICAgIGlmIChjb250ZXh0ID09ICJzdGF0cyIgJiYgIUdhbWUucHJlZnMuY3JhdGVzKSBub0ZyYW1lID0gMTsKCiAgICAgICAgY2xhc3NlcyArPSAiIGFjaGlldmVtZW50IjsKICAgICAgICBpZiAobWUucG9vbCA9PSAic2hhZG93IikgY2xhc3NlcyArPSAiIHNoYWRvdyI7CiAgICAgICAgaWYgKG1lLndvbiA+IDApIGVuYWJsZWQgPSAxOwogICAgICAgIGVsc2UgbXlzdGVyaW91cyA9IDE7CiAgICAgICAgaWYgKCFlbmFibGVkKQogICAgICAgICAgY2xpY2tTdHIgPSAiR2FtZS5BY2hpZXZlbWVudHNCeUlkWyIgKyBtZS5pZCArICJdLmNsaWNrKCk7IjsKCiAgICAgICAgaWYgKG5ldXJvbWFuY3kpCiAgICAgICAgICBjbGlja1N0ciA9ICJHYW1lLkFjaGlldmVtZW50c0J5SWRbIiArIG1lLmlkICsgIl0udG9nZ2xlKCk7IjsKICAgICAgfQoKICAgICAgaWYgKGNvbnRleHQgPT0gInN0b3JlIikgYXR0YWNobWVudCA9ICJzdG9yZSI7CgogICAgICBpZiAoZm9yY2VDbGlja1N0cikgY2xpY2tTdHIgPSBmb3JjZUNsaWNrU3RyOwoKICAgICAgaWYgKG1lLmNob2ljZXNGdW5jdGlvbikgY2xhc3NlcyArPSAiIHNlbGVjdG9yIjsKCiAgICAgIHZhciBpY29uID0gbWUuaWNvbjsKICAgICAgaWYgKG15c3RlcmlvdXMpIGljb24gPSBbMCwgN107CgogICAgICBpZiAobWUuaWNvbkZ1bmN0aW9uKSBpY29uID0gbWUuaWNvbkZ1bmN0aW9uKCk7CgogICAgICBpZiAobWUuYm91Z2h0ICYmIGNvbnRleHQgPT0gInN0b3JlIikgZW5hYmxlZCA9IDA7CgogICAgICBpZiAoZW5hYmxlZCkgY2xhc3NlcyArPSAiIGVuYWJsZWQiOyAvLyBlbHNlIGNsYXNzZXMrPScgZGlzYWJsZWQnOwogICAgICBpZiAobm9GcmFtZSkgY2xhc3NlcyArPSAiIG5vRnJhbWUiOwoKICAgICAgdmFyIHRleHQgPSBbXTsKICAgICAgaWYgKEdhbWUuc2VzYW1lKSB7CiAgICAgICAgaWYgKAogICAgICAgICAgR2FtZS5kZWJ1Z2dlZFVwZ3JhZGVDcFNbbWUubmFtZV0gfHwKICAgICAgICAgIEdhbWUuZGVidWdnZWRVcGdyYWRlQ3BDbGlja1ttZS5uYW1lXQogICAgICAgICkgewogICAgICAgICAgdGV4dC5wdXNoKCJ4IiArIEJlYXV0aWZ5KDEgKyBHYW1lLmRlYnVnZ2VkVXBncmFkZUNwU1ttZS5uYW1lXSwgMikpOwogICAgICAgICAgdGV4dC5wdXNoKAogICAgICAgICAgICBHYW1lLmRlYnVnQ29sb3JzWwogICAgICAgICAgICAgIE1hdGguZmxvb3IoCiAgICAgICAgICAgICAgICBNYXRoLm1heCgKICAgICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgICAgTWF0aC5taW4oCiAgICAgICAgICAgICAgICAgICAgR2FtZS5kZWJ1Z0NvbG9ycy5sZW5ndGggLSAxLAogICAgICAgICAgICAgICAgICAgIE1hdGgucG93KEdhbWUuZGVidWdnZWRVcGdyYWRlQ3BTW21lLm5hbWVdIC8gMiwgMC41KSAqCiAgICAgICAgICAgICAgICAgICAgICBHYW1lLmRlYnVnQ29sb3JzLmxlbmd0aAogICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgKQogICAgICAgICAgICBdCiAgICAgICAgICApOwogICAgICAgICAgdGV4dC5wdXNoKAogICAgICAgICAgICAieCIgKyBCZWF1dGlmeSgxICsgR2FtZS5kZWJ1Z2dlZFVwZ3JhZGVDcENsaWNrW21lLm5hbWVdLCAyKQogICAgICAgICAgKTsKICAgICAgICAgIHRleHQucHVzaCgKICAgICAgICAgICAgR2FtZS5kZWJ1Z0NvbG9yc1sKICAgICAgICAgICAgICBNYXRoLmZsb29yKAogICAgICAgICAgICAgICAgTWF0aC5tYXgoCiAgICAgICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgICAgIE1hdGgubWluKAogICAgICAgICAgICAgICAgICAgIEdhbWUuZGVidWdDb2xvcnMubGVuZ3RoIC0gMSwKICAgICAgICAgICAgICAgICAgICBNYXRoLnBvdyhHYW1lLmRlYnVnZ2VkVXBncmFkZUNwQ2xpY2tbbWUubmFtZV0gLyAyLCAwLjUpICoKICAgICAgICAgICAgICAgICAgICAgIEdhbWUuZGVidWdDb2xvcnMubGVuZ3RoCiAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICApCiAgICAgICAgICAgIF0KICAgICAgICAgICk7CiAgICAgICAgfQogICAgICAgIGlmIChHYW1lLmV4dHJhSW5mbykgewogICAgICAgICAgdGV4dC5wdXNoKAogICAgICAgICAgICBNYXRoLmZsb29yKG1lLm9yZGVyKSArIChtZS5wb3dlciA/ICI8YnI+UDoiICsgbWUucG93ZXIgOiAiIikKICAgICAgICAgICk7CiAgICAgICAgICB0ZXh0LnB1c2goIiNmZmYiKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgdmFyIHRleHRTdHIgPSAiIjsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0ZXh0Lmxlbmd0aDsgaSArPSAyKSB7CiAgICAgICAgdGV4dFN0ciArPQogICAgICAgICAgJzxkaXYgc3R5bGU9Im9wYWNpdHk6MC45O3otaW5kZXg6MTAwMDtwYWRkaW5nOjBweCAycHg7YmFja2dyb3VuZDonICsKICAgICAgICAgIHRleHRbaSArIDFdICsKICAgICAgICAgICI7Y29sb3I6IzAwMDtmb250LXNpemU6MTBweDtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6IiArCiAgICAgICAgICAoaSAvIDIpICogMTAgKwogICAgICAgICAgJ3B4O2xlZnQ6MHB4OyI+JyArCiAgICAgICAgICB0ZXh0W2ldICsKICAgICAgICAgICI8L2Rpdj4iOwogICAgICB9CiAgICAgIHJldHVybiAoCiAgICAgICAgKEdhbWUucHJlZnMuc2NyZWVucmVhZGVyCiAgICAgICAgICA/ICc8YnV0dG9uIGFyaWEtbGFiZWxsZWRieT0iYXJpYVJlYWRlci0nICsgbWUudHlwZSArICItIiArIG1lLmlkICsgJyInCiAgICAgICAgICA6ICI8ZGl2IikgKwogICAgICAgIChjbGlja1N0ciAhPSAiIiA/ICIgIiArIEdhbWUuY2xpY2tTdHIgKyAnPSInICsgY2xpY2tTdHIgKyAnIicgOiAiIikgKwogICAgICAgICcgY2xhc3M9IicgKwogICAgICAgIGNsYXNzZXMgKwogICAgICAgICciICcgKwogICAgICAgIEdhbWUuZ2V0RHluYW1pY1Rvb2x0aXAoCiAgICAgICAgICAiZnVuY3Rpb24oKXtyZXR1cm4gR2FtZS5jcmF0ZVRvb2x0aXAoR2FtZS4iICsKICAgICAgICAgICAgKG1lLnR5cGUgPT0gInVwZ3JhZGUiID8gIlVwZ3JhZGVzIiA6ICJBY2hpZXZlbWVudHMiKSArCiAgICAgICAgICAgICJCeUlkWyIgKwogICAgICAgICAgICBtZS5pZCArCiAgICAgICAgICAgICJdLCIgKwogICAgICAgICAgICAoY29udGV4dCA/ICInIiArIGNvbnRleHQgKyAiJyIgOiAiIikgKwogICAgICAgICAgICAiKTt9IiwKICAgICAgICAgIGF0dGFjaG1lbnQsCiAgICAgICAgICB0cnVlCiAgICAgICAgKSArCiAgICAgICAgKGlkID8gJ2lkPSInICsgaWQgKyAnIiAnIDogIiIpICsKICAgICAgICAnc3R5bGU9IicgKwogICAgICAgIChteXN0ZXJpb3VzCiAgICAgICAgICA/ICJiYWNrZ3JvdW5kLXBvc2l0aW9uOiIgKyAtMCAqIDQ4ICsgInB4ICIgKyAtNyAqIDQ4ICsgInB4OyIKICAgICAgICAgIDogd3JpdGVJY29uKGljb24pKSArCiAgICAgICAgKGNvbnRleHQgPT0gImFzY2VuZCIgJiYgbWUucG9vbCA9PSAicHJlc3RpZ2UiCiAgICAgICAgICA/ICJwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OiIgKyBtZS5wb3NYICsgInB4O3RvcDoiICsgbWUucG9zWSArICJweDsiCiAgICAgICAgICA6ICIiKSArCiAgICAgICAgKHN0eWxlIHx8ICIiKSArCiAgICAgICAgJyI+JyArCiAgICAgICAgdGV4dFN0ciArCiAgICAgICAgKEdhbWUucHJlZnMuc2NyZWVucmVhZGVyCiAgICAgICAgICA/ICc8bGFiZWwgY2xhc3M9InNyT25seSIgaWQ9ImFyaWFSZWFkZXItJyArCiAgICAgICAgICAgIG1lLnR5cGUgKwogICAgICAgICAgICAiLSIgKwogICAgICAgICAgICBtZS5pZCArCiAgICAgICAgICAgICciPjwvbGFiZWw+JwogICAgICAgICAgOiAiIikgKwogICAgICAgIChtZS5jaG9pY2VzRnVuY3Rpb24gPyAnPGRpdiBjbGFzcz0ic2VsZWN0b3JDb3JuZXIiPjwvZGl2PicgOiAiIikgKwogICAgICAgIChHYW1lLnByZWZzLnNjcmVlbnJlYWRlciA/ICI8L2J1dHRvbj4iIDogIjwvZGl2PiIpCiAgICAgICk7CiAgICB9OwogICAgR2FtZS5jcmF0ZVRvb2x0aXAgPSBmdW5jdGlvbiAobWUsIGNvbnRleHQpIHsKICAgICAgdmFyIHRhZ3MgPSBbXTsKICAgICAgbXlzdGVyaW91cyA9IDA7CiAgICAgIHZhciBuZXVyb21hbmN5ID0gMDsKICAgICAgdmFyIHByaWNlID0gIiI7CiAgICAgIGlmICgKICAgICAgICBjb250ZXh0ID09ICJzdGF0cyIgJiYKICAgICAgICAoR2FtZS5IYXMoIk5ldXJvbWFuY3kiKSB8fCAoR2FtZS5zZXNhbWUgJiYgbWUucG9vbCA9PSAiZGVidWciKSkKICAgICAgKQogICAgICAgIG5ldXJvbWFuY3kgPSAxOwoKICAgICAgdmFyIGFyaWFUZXh0ID0gIiI7CgogICAgICBpZiAobWUudHlwZSA9PSAidXBncmFkZSIpIHsKICAgICAgICBhcmlhVGV4dCArPSAiVXBncmFkZS4gIjsKCiAgICAgICAgaWYgKG1lLnBvb2wgPT0gInByZXN0aWdlIikKICAgICAgICAgIHRhZ3MucHVzaChsb2MoIltUYWddSGVhdmVubHkiLCAwLCAiSGVhdmVubHkiKSwgIiNlZmE0MzgiKTsKICAgICAgICBlbHNlIGlmIChtZS5wb29sID09ICJ0ZWNoIikKICAgICAgICAgIHRhZ3MucHVzaChsb2MoIltUYWddVGVjaCIsIDAsICJUZWNoIiksICIjMzZhNGZmIik7CiAgICAgICAgZWxzZSBpZiAobWUucG9vbCA9PSAiY29va2llIikKICAgICAgICAgIHRhZ3MucHVzaChsb2MoIltUYWddQ29va2llIiwgMCwgIkNvb2tpZSIpLCAwKTsKICAgICAgICBlbHNlIGlmIChtZS5wb29sID09ICJkZWJ1ZyIpCiAgICAgICAgICB0YWdzLnB1c2gobG9jKCJbVGFnXURlYnVnIiwgMCwgIkRlYnVnIiksICIjMDBjNDYyIik7CiAgICAgICAgZWxzZSBpZiAobWUucG9vbCA9PSAidG9nZ2xlIikKICAgICAgICAgIHRhZ3MucHVzaChsb2MoIltUYWddU3dpdGNoIiwgMCwgIlN3aXRjaCIpLCAwKTsKICAgICAgICBlbHNlIHRhZ3MucHVzaChsb2MoIltUYWddVXBncmFkZSIsIDAsICJVcGdyYWRlIiksIDApOwoKICAgICAgICBpZiAoR2FtZS5IYXMoIkxhYmVsIHByaW50ZXIiKSkgewogICAgICAgICAgaWYgKG1lLnRpZXIgIT0gMCkKICAgICAgICAgICAgdGFncy5wdXNoKAogICAgICAgICAgICAgIGxvYygiVGllcjoiKSArCiAgICAgICAgICAgICAgICAiICIgKwogICAgICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICAgICAiW1RpZXJdIiArIEdhbWUuVGllcnNbbWUudGllcl0ubmFtZSwKICAgICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgICAgR2FtZS5UaWVyc1ttZS50aWVyXS5uYW1lCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgIEdhbWUuVGllcnNbbWUudGllcl0uY29sb3IKICAgICAgICAgICAgKTsKICAgICAgICAgIGlmIChtZS5uYW1lID09ICJMYWJlbCBwcmludGVyIiB8fCBtZS5uYW1lID09ICJUaGlzIHVwZ3JhZGUiKQogICAgICAgICAgICB0YWdzLnB1c2goCiAgICAgICAgICAgICAgbG9jKCJUaWVyOiIpICsgIiAiICsgbG9jKCJbVGllcl1TZWxmLXJlZmVyZW50aWFsIiksCiAgICAgICAgICAgICAgIiNmZjAwZWEiCiAgICAgICAgICAgICk7CiAgICAgICAgfQoKICAgICAgICBpZiAobWUuaXNWYXVsdGVkKCkpIHRhZ3MucHVzaChsb2MoIlZhdWx0ZWQiKSwgIiM0ZTc1NjYiKTsKCiAgICAgICAgaWYgKG1lLmJvdWdodCA+IDApIHsKICAgICAgICAgIGFyaWFUZXh0ICs9ICJPd25lZC4gIjsKICAgICAgICAgIGlmIChtZS5wb29sID09ICJ0ZWNoIikgdGFncy5wdXNoKGxvYygiUmVzZWFyY2hlZCIpLCAwKTsKICAgICAgICAgIGVsc2UgaWYgKEVOICYmIG1lLmtpdHRlbikgdGFncy5wdXNoKCJQdXJyY2hhc2VkIiwgMCk7CiAgICAgICAgICBlbHNlIHRhZ3MucHVzaChsb2MoIlB1cmNoYXNlZCIpLCAwKTsKICAgICAgICB9CgogICAgICAgIGlmIChtZS5sYXN0aW5nICYmIG1lLnVubG9ja2VkKQogICAgICAgICAgdGFncy5wdXNoKGxvYygiVW5sb2NrZWQgZm9yZXZlciIpLCAiI2YyZmY4NyIpOwoKICAgICAgICBpZiAobmV1cm9tYW5jeSAmJiBtZS5ib3VnaHQgPT0gMCkKICAgICAgICAgIHRhZ3MucHVzaChsb2MoIkNsaWNrIHRvIGxlYXJuISIpLCAiIzAwYzQ2MiIpOwogICAgICAgIGVsc2UgaWYgKG5ldXJvbWFuY3kgJiYgbWUuYm91Z2h0ID4gMCkKICAgICAgICAgIHRhZ3MucHVzaChsb2MoIkNsaWNrIHRvIHVubGVhcm4hIiksICIjMDBjNDYyIik7CgogICAgICAgIHZhciBjYW5CdXkgPSBjb250ZXh0ID09ICJzdG9yZSIgPyBtZS5jYW5CdXkoKSA6IHRydWU7CiAgICAgICAgdmFyIGNvc3QgPSBtZS5nZXRQcmljZSgpOwogICAgICAgIGlmIChtZS5wcmljZUx1bXBzID4gMCkgY29zdCA9IG1lLnByaWNlTHVtcHM7CgogICAgICAgIGlmIChtZS5wcmljZUx1bXBzID09IDAgJiYgY29zdCA9PSAwKSBwcmljZSA9ICIiOwogICAgICAgIGVsc2UgewogICAgICAgICAgcHJpY2UgPQogICAgICAgICAgICAnPGRpdiBzdHlsZT0iZmxvYXQ6cmlnaHQ7dGV4dC1hbGlnbjpyaWdodDsiPjxzcGFuIGNsYXNzPSJwcmljZScgKwogICAgICAgICAgICAobWUucHJpY2VMdW1wcyA+IDAgPyAiIGx1bXAiIDogIiIpICsKICAgICAgICAgICAgKG1lLnBvb2wgPT0gInByZXN0aWdlIgogICAgICAgICAgICAgID8gbWUuYm91Z2h0IHx8IEdhbWUuaGVhdmVubHlDaGlwcyA+PSBjb3N0CiAgICAgICAgICAgICAgICA/ICIgaGVhdmVubHkiCiAgICAgICAgICAgICAgICA6ICIgaGVhdmVubHkgZGlzYWJsZWQiCiAgICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgICAoY29udGV4dCA9PSAic3RvcmUiID8gKGNhbkJ1eSA/ICIiIDogIiBkaXNhYmxlZCIpIDogIiIpICsKICAgICAgICAgICAgJyI+JyArCiAgICAgICAgICAgIEJlYXV0aWZ5KE1hdGgucm91bmQoY29zdCkpICsKICAgICAgICAgICAgIjwvc3Bhbj4iICsKICAgICAgICAgICAgKG1lLnBvb2wgIT0gInByZXN0aWdlIiAmJiBtZS5wcmljZUx1bXBzID09IDAKICAgICAgICAgICAgICA/IEdhbWUuY29zdERldGFpbHMoY29zdCkKICAgICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAgICI8L2Rpdj4iOwoKICAgICAgICAgIGFyaWFUZXh0ICs9CiAgICAgICAgICAgIChtZS5ib3VnaHQKICAgICAgICAgICAgICA/ICJCb3VnaHQgZm9yIgogICAgICAgICAgICAgIDogY2FuQnV5CiAgICAgICAgICAgICAgPyAiQ2FuIGJ1eSBmb3IiCiAgICAgICAgICAgICAgOiAiQ2Fubm90IGFmZm9yZCB0aGUiKSArCiAgICAgICAgICAgICIgIiArCiAgICAgICAgICAgIEJlYXV0aWZ5KE1hdGgucm91bmQoY29zdCkpICsKICAgICAgICAgICAgIiAiICsKICAgICAgICAgICAgKG1lLnByaWNlTHVtcHMgPiAwCiAgICAgICAgICAgICAgPyAic3VnYXIgbHVtcHMiCiAgICAgICAgICAgICAgOiBtZS5wb29sID09ICJwcmVzdGlnZSIKICAgICAgICAgICAgICA/ICJoZWF2ZW5seSBjaGlwcyIKICAgICAgICAgICAgICA6ICJjb29raWVzIikgKwogICAgICAgICAgICAiLiAiOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChtZS50eXBlID09ICJhY2hpZXZlbWVudCIpIHsKICAgICAgICBhcmlhVGV4dCArPSAiQWNoaWV2ZW1lbnQuICI7CiAgICAgICAgaWYgKG1lLnBvb2wgPT0gInNoYWRvdyIpCiAgICAgICAgICB0YWdzLnB1c2gobG9jKCJTaGFkb3cgQWNoaWV2ZW1lbnQiKSwgIiM5NzAwY2YiKTsKICAgICAgICBlbHNlIHRhZ3MucHVzaChsb2MoIkFjaGlldmVtZW50IiksIDApOwogICAgICAgIGlmIChtZS53b24gPiAwKSB7CiAgICAgICAgICB0YWdzLnB1c2gobG9jKCJVbmxvY2tlZCIpLCAwKTsKICAgICAgICAgIGFyaWFUZXh0ICs9ICJVbmxvY2tlZC4gIjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGFncy5wdXNoKGxvYygiTG9ja2VkIiksIDApOwogICAgICAgICAgbXlzdGVyaW91cyA9IDE7CiAgICAgICAgfQoKICAgICAgICBpZiAobmV1cm9tYW5jeSAmJiBtZS53b24gPT0gMCkKICAgICAgICAgIHRhZ3MucHVzaChsb2MoIkNsaWNrIHRvIHdpbiEiKSwgIiMwMGM0NjIiKTsKICAgICAgICBlbHNlIGlmIChuZXVyb21hbmN5ICYmIG1lLndvbiA+IDApCiAgICAgICAgICB0YWdzLnB1c2gobG9jKCJDbGljayB0byBsb3NlISIpLCAiIzAwYzQ2MiIpOwogICAgICB9CgogICAgICB2YXIgdGFnc1N0ciA9ICIiOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRhZ3MubGVuZ3RoOyBpICs9IDIpIHsKICAgICAgICBpZiAoaSAlIDIgPT0gMCkKICAgICAgICAgIHRhZ3NTdHIgKz0KICAgICAgICAgICAgJzxkaXYgY2xhc3M9InRhZyIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6JyArCiAgICAgICAgICAgICh0YWdzW2kgKyAxXSA9PSAwID8gIiNmZmYiIDogdGFnc1tpICsgMV0pICsKICAgICAgICAgICAgJzsiPicgKwogICAgICAgICAgICB0YWdzW2ldICsKICAgICAgICAgICAgIjwvZGl2PiI7CiAgICAgIH0KCiAgICAgIHZhciBpY29uID0gbWUuaWNvbjsKICAgICAgaWYgKG15c3RlcmlvdXMpIGljb24gPSBbMCwgN107CgogICAgICBpZiAobWUuaWNvbkZ1bmN0aW9uKSBpY29uID0gbWUuaWNvbkZ1bmN0aW9uKCk7CgogICAgICBhcmlhVGV4dCArPSAobXlzdGVyaW91cyA/ICJIaWRkZW4iIDogbWUuZG5hbWUpICsgIi4gIjsKCiAgICAgIHZhciB0aXAgPSAiIjsKICAgICAgaWYgKGNvbnRleHQgPT0gInN0b3JlIikgewogICAgICAgIGlmIChtZS5wb29sICE9ICJ0b2dnbGUiICYmIG1lLnBvb2wgIT0gInRlY2giKSB7CiAgICAgICAgICB2YXIgcHVyY2hhc2UgPSBtZS5raXR0ZW4gPyAicHVycmNoYXNlIiA6ICJwdXJjaGFzZSI7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIkluc3BpcmVkIGNoZWNrbGlzdCIpKSB7CiAgICAgICAgICAgIGlmIChtZS5pc1ZhdWx0ZWQoKSkKICAgICAgICAgICAgICB0aXAgPSBFTgogICAgICAgICAgICAgICAgPyAiVXBncmFkZSBpcyB2YXVsdGVkIGFuZCB3aWxsIG5vdCBiZSBhdXRvLSIgKwogICAgICAgICAgICAgICAgICBwdXJjaGFzZSArCiAgICAgICAgICAgICAgICAgICJkLjxicj5DbGljayB0byAiICsKICAgICAgICAgICAgICAgICAgcHVyY2hhc2UgKwogICAgICAgICAgICAgICAgICAiLiBTaGlmdC1jbGljayB0byB1bnZhdWx0LiIKICAgICAgICAgICAgICAgIDogbG9jKCJVcGdyYWRlIGlzIHZhdWx0ZWQgYW5kIHdpbGwgbm90IGJlIGF1dG8tcHVyY2hhc2VkLiIpICsKICAgICAgICAgICAgICAgICAgIjxicj4iICsKICAgICAgICAgICAgICAgICAgbG9jKCJDbGljayB0byBwdXJjaGFzZS4iKSArCiAgICAgICAgICAgICAgICAgICIgIiArCiAgICAgICAgICAgICAgICAgIGxvYygiJTEgdG8gdW52YXVsdC4iLCBsb2MoIlNoaWZ0LWNsaWNrIikpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgdGlwID0gRU4KICAgICAgICAgICAgICAgID8gIkNsaWNrIHRvICIgKyBwdXJjaGFzZSArICIuIFNoaWZ0LWNsaWNrIHRvIHZhdWx0LiIKICAgICAgICAgICAgICAgIDogbG9jKCJDbGljayB0byBwdXJjaGFzZS4iKSArCiAgICAgICAgICAgICAgICAgICIgIiArCiAgICAgICAgICAgICAgICAgIGxvYygiJTEgdG8gdmF1bHQuIiwgbG9jKCJTaGlmdC1jbGljayIpKTsKICAgICAgICAgICAgaWYgKEVOKSB7CiAgICAgICAgICAgICAgaWYgKEdhbWUua2V5c1sxNl0pIHRpcCArPSAiPGJyPihZb3UgYXJlIGhvbGRpbmcgU2hpZnQuKSI7CiAgICAgICAgICAgICAgZWxzZSB0aXAgKz0gIjxicj4oWW91IGFyZSBub3QgaG9sZGluZyBTaGlmdC4pIjsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlCiAgICAgICAgICAgIHRpcCA9IEVOID8gIkNsaWNrIHRvICIgKyBwdXJjaGFzZSArICIuIiA6IGxvYygiQ2xpY2sgdG8gcHVyY2hhc2UuIik7CiAgICAgICAgfSBlbHNlIGlmIChtZS5wb29sID09ICJ0b2dnbGUiICYmIG1lLmNob2ljZXNGdW5jdGlvbikKICAgICAgICAgIHRpcCA9IGxvYygiQ2xpY2sgdG8gb3BlbiBzZWxlY3Rvci4iKTsKICAgICAgICBlbHNlIGlmIChtZS5wb29sID09ICJ0b2dnbGUiKSB0aXAgPSBsb2MoIkNsaWNrIHRvIHRvZ2dsZS4iKTsKICAgICAgICBlbHNlIGlmIChtZS5wb29sID09ICJ0ZWNoIikgdGlwID0gbG9jKCJDbGljayB0byByZXNlYXJjaC4iKTsKICAgICAgfQoKICAgICAgaWYgKHRpcCAhPSAiIikgYXJpYVRleHQgKz0gdGlwICsgIiAiOwoKICAgICAgdmFyIGRlc2MgPSBtZS5kZGVzYzsKICAgICAgaWYgKG1lLmRlc2NGdW5jKSBkZXNjID0gbWUuZGVzY0Z1bmMoY29udGV4dCk7CiAgICAgIGlmIChtZS5ib3VnaHQgJiYgY29udGV4dCA9PSAic3RvcmUiICYmIG1lLmRpc3BsYXlGdW5jV2hlbk93bmVkKQogICAgICAgIGRlc2MgPSBtZS5kaXNwbGF5RnVuY1doZW5Pd25lZCgpICsgJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicgKyBkZXNjOwogICAgICBpZiAobWUudW5sb2NrQXQpIHsKICAgICAgICBpZiAobWUudW5sb2NrQXQucmVxdWlyZSkgewogICAgICAgICAgdmFyIGl0ID0gR2FtZS5VcGdyYWRlc1ttZS51bmxvY2tBdC5yZXF1aXJlXTsKICAgICAgICAgIGRlc2MgPQogICAgICAgICAgICAnPGRpdiBzdHlsZT0iZm9udC1zaXplOjgwJTt0ZXh0LWFsaWduOmNlbnRlcjsiPicgKwogICAgICAgICAgICAoRU4gPyAiRnJvbSIgOiBsb2MoIlNvdXJjZToiKSkgKwogICAgICAgICAgICAiICIgKwogICAgICAgICAgICB0aW55SWNvbihpdC5pY29uKSArCiAgICAgICAgICAgICIgIiArCiAgICAgICAgICAgIGl0LmRuYW1lICsKICAgICAgICAgICAgJzwvZGl2PjxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicgKwogICAgICAgICAgICBkZXNjOwogICAgICAgIH0gZWxzZSBpZiAobWUudW5sb2NrQXQudGV4dCkgewogICAgICAgICAgLy92YXIgaXQ9R2FtZS5VcGdyYWRlc1ttZS51bmxvY2tBdC5yZXF1aXJlXTsKICAgICAgICAgIGRlc2MgPQogICAgICAgICAgICAnPGRpdiBzdHlsZT0iZm9udC1zaXplOjgwJTt0ZXh0LWFsaWduOmNlbnRlcjsiPicgKwogICAgICAgICAgICAoRU4gPyAiRnJvbSIgOiBsb2MoIlNvdXJjZToiKSkgKwogICAgICAgICAgICAiIDxiPiIgKwogICAgICAgICAgICB0ZXh0ICsKICAgICAgICAgICAgJzwvYj48L2Rpdj48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICAgICAgZGVzYzsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICghbXlzdGVyaW91cykgYXJpYVRleHQgKz0gIkRlc2NyaXB0aW9uOiAiICsgZGVzYyArICIgIjsKCiAgICAgIGlmIChHYW1lLnByZWZzLnNjcmVlbnJlYWRlcikgewogICAgICAgIHZhciBhcmlhTGFiZWwgPSBsKCJhcmlhUmVhZGVyLSIgKyBtZS50eXBlICsgIi0iICsgbWUuaWQpOwogICAgICAgIGlmIChhcmlhTGFiZWwpCiAgICAgICAgICBhcmlhTGFiZWwuaW5uZXJIVE1MID0gYXJpYVRleHQucmVwbGFjZSgvKDwoW14+XSspPikvZ2ksICIgIik7CiAgICAgIH0KCiAgICAgIHJldHVybiAoCiAgICAgICAgJzxkaXYgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlO2xlZnQ6MXB4O3RvcDoxcHg7cmlnaHQ6MXB4O2JvdHRvbToxcHg7YmFja2dyb3VuZDpsaW5lYXItZ3JhZGllbnQoMTI1ZGVnLCcgKwogICAgICAgIChtZS5wb29sID09ICJwcmVzdGlnZSIKICAgICAgICAgID8gInJnYmEoMTUsMTE1LDEzMCwxKSAwJSxyZ2JhKDE1LDExNSwxMzAsMCkiCiAgICAgICAgICA6ICJyZ2JhKDUwLDQwLDQwLDEpIDAlLHJnYmEoNTAsNDAsNDAsMCkiKSArCiAgICAgICAgJyAyMCUpO21peC1ibGVuZC1tb2RlOnNjcmVlbjt6LWluZGV4OjE7Ij48L2Rpdj48ZGl2IHN0eWxlPSJ6LWluZGV4OjEwO3BhZGRpbmc6OHB4IDRweDttaW4td2lkdGg6MzUwcHg7cG9zaXRpb246cmVsYXRpdmU7IiBpZD0idG9vbHRpcENyYXRlIj4nICsKICAgICAgICAnPGRpdiBjbGFzcz0iaWNvbiIgc3R5bGU9ImZsb2F0OmxlZnQ7bWFyZ2luLWxlZnQ6LThweDttYXJnaW4tdG9wOi04cHg7JyArCiAgICAgICAgd3JpdGVJY29uKGljb24pICsKICAgICAgICAnIj48L2Rpdj4nICsKICAgICAgICAobWUuYm91Z2h0ICYmIGNvbnRleHQgPT0gInN0b3JlIiA/ICIiIDogcHJpY2UpICsKICAgICAgICAnPGRpdiBjbGFzcz0ibmFtZSI+JyArCiAgICAgICAgKG15c3RlcmlvdXMgPyAiPz8/IiA6IG1lLmRuYW1lKSArCiAgICAgICAgIjwvZGl2PiIgKwogICAgICAgIHRhZ3NTdHIgKwogICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj48ZGl2IGNsYXNzPSJkZXNjcmlwdGlvbiI+JyArCiAgICAgICAgKG15c3RlcmlvdXMgPyAiPz8/IiA6IGRlc2MpICsKICAgICAgICAiPC9kaXY+PC9kaXY+IiArCiAgICAgICAgKHRpcCAhPSAiIgogICAgICAgICAgPyAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+PGRpdiBzdHlsZT0iZm9udC1zaXplOjEwcHg7Zm9udC13ZWlnaHQ6Ym9sZDtjb2xvcjojOTk5O3RleHQtYWxpZ246Y2VudGVyO3BhZGRpbmctYm90dG9tOjRweDtsaW5lLWhlaWdodDoxMDAlOyIgY2xhc3M9ImNyYXRlVGlwIj4nICsKICAgICAgICAgICAgdGlwICsKICAgICAgICAgICAgIjwvZGl2PiIKICAgICAgICAgIDogIiIpICsKICAgICAgICAoR2FtZS5zZXNhbWUKICAgICAgICAgID8gJzxkaXYgc3R5bGU9ImZvbnQtc2l6ZTo5cHg7Ij5JZDogJyArCiAgICAgICAgICAgIG1lLmlkICsKICAgICAgICAgICAgIiB8IE9yZGVyOiAiICsKICAgICAgICAgICAgTWF0aC5mbG9vcihtZS5vcmRlcikgKwogICAgICAgICAgICAobWUudGllciA/ICIgfCBUaWVyOiAiICsgbWUudGllciA6ICIiKSArCiAgICAgICAgICAgICI8L2Rpdj4iCiAgICAgICAgICA6ICIiKQogICAgICApOwogICAgfTsKCiAgICBHYW1lLmNvc3REZXRhaWxzID0gZnVuY3Rpb24gKGNvc3QpIHsKICAgICAgaWYgKCFHYW1lLkhhcygiR2VuaXVzIGFjY291bnRpbmciKSkgcmV0dXJuICIiOwogICAgICBpZiAoIWNvc3QpIHJldHVybiAiIjsKICAgICAgdmFyIHByaWNlSW5mbyA9ICIiOwogICAgICB2YXIgY3BzID0gR2FtZS5jb29raWVzUHMgKiAoMSAtIEdhbWUuY3BzU3Vja2VkKTsKICAgICAgaWYgKGNvc3QgPiBHYW1lLmNvb2tpZXMpCiAgICAgICAgcHJpY2VJbmZvICs9CiAgICAgICAgICBsb2MoCiAgICAgICAgICAgICJpbiAlMSIsCiAgICAgICAgICAgIEdhbWUuc2F5VGltZSgoKGNvc3QgLSBHYW1lLmNvb2tpZXMpIC8gY3BzICsgMSkgKiBHYW1lLmZwcykKICAgICAgICAgICkgKyAiPGJyPiI7CiAgICAgIHByaWNlSW5mbyArPQogICAgICAgIGxvYygiJTEgd29ydGgiLCBHYW1lLnNheVRpbWUoKGNvc3QgLyBjcHMgKyAxKSAqIEdhbWUuZnBzKSkgKyAiPGJyPiI7CiAgICAgIHByaWNlSW5mbyArPQogICAgICAgIGxvYygiJTElIG9mIGJhbmsiLCBCZWF1dGlmeSgoY29zdCAvIEdhbWUuY29va2llcykgKiAxMDAsIDEpKSArICI8YnI+IjsKICAgICAgcmV0dXJuICgKICAgICAgICAnPGRpdiBzdHlsZT0iZm9udC1zaXplOjgwJTtvcGFjaXR5OjAuNztsaW5lLWhlaWdodDo5MCU7IiBjbGFzcz0iY29zdERldGFpbHMiPicgKwogICAgICAgIHByaWNlSW5mbyArCiAgICAgICAgIjwvZGl2PiIKICAgICAgKTsKICAgIH07CgogICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkJUFJFU1RJR0UKCQk9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwoKICAgIEdhbWUuSENmYWN0b3IgPSAzOwogICAgR2FtZS5Ib3dNdWNoUHJlc3RpZ2UgPSBmdW5jdGlvbiAoCiAgICAgIGNvb2tpZXMgLy9ob3cgbXVjaCBwcmVzdGlnZSBbY29va2llc10gc2hvdWxkIGxhbmQgeW91CiAgICApIHsKICAgICAgcmV0dXJuIE1hdGgucG93KGNvb2tpZXMgLyAxMDAwMDAwMDAwMDAwLCAxIC8gR2FtZS5IQ2ZhY3Rvcik7CiAgICB9OwogICAgR2FtZS5Ib3dNYW55Q29va2llc1Jlc2V0ID0gZnVuY3Rpb24gKAogICAgICBjaGlwcyAvL2hvdyBtYW55IGNvb2tpZXMgW2NoaXBzXSBhcmUgd29ydGgKICAgICkgewogICAgICAvL3RoaXMgbXVzdCBiZSB0aGUgaW52ZXJzZSBvZiB0aGUgYWJvdmUgZnVuY3Rpb24gKGllLiBpZiBjb29raWVzPWNoaXBzXjIsIGNoaXBzPWNvb2tpZXNeKDEvMikgKQogICAgICByZXR1cm4gTWF0aC5wb3coY2hpcHMsIEdhbWUuSENmYWN0b3IpICogMTAwMDAwMDAwMDAwMDsKICAgIH07CiAgICBHYW1lLmdhaW5lZFByZXN0aWdlID0gMDsKICAgIEdhbWUuRWFybkhlYXZlbmx5Q2hpcHMgPSBmdW5jdGlvbiAoY29va2llc0ZvcmZlaXRlZCwgc2lsZW50KSB7CiAgICAgIC8vcmVjYWxjdWxhdGUgcHJlc3RpZ2UgYW5kIGNoaXBzIG93bmVkCiAgICAgIHZhciBwcmVzdGlnZSA9IE1hdGguZmxvb3IoCiAgICAgICAgR2FtZS5Ib3dNdWNoUHJlc3RpZ2UoR2FtZS5jb29raWVzUmVzZXQgKyBjb29raWVzRm9yZmVpdGVkKQogICAgICApOwogICAgICBwcmVzdGlnZSA9IE1hdGgubWF4KDAsIHByZXN0aWdlKTsKICAgICAgaWYgKHByZXN0aWdlICE9IEdhbWUucHJlc3RpZ2UpIHsKICAgICAgICAvL2RpZCB3ZSBjaGFuZ2UgcHJlc3RpZ2UgbGV2ZWxzPwogICAgICAgIHZhciBwcmVzdGlnZURpZmZlcmVuY2UgPSBwcmVzdGlnZSAtIEdhbWUucHJlc3RpZ2U7CiAgICAgICAgR2FtZS5nYWluZWRQcmVzdGlnZSA9IHByZXN0aWdlRGlmZmVyZW5jZTsKICAgICAgICBHYW1lLmhlYXZlbmx5Q2hpcHMgKz0gcHJlc3RpZ2VEaWZmZXJlbmNlOwogICAgICAgIEdhbWUucHJlc3RpZ2UgPSBwcmVzdGlnZTsKICAgICAgICBpZiAoIXNpbGVudCAmJiBwcmVzdGlnZURpZmZlcmVuY2UgPiAwKQogICAgICAgICAgR2FtZS5Ob3RpZnkoCiAgICAgICAgICAgIGxvYygKICAgICAgICAgICAgICAiWW91IGZvcmZlaXQgeW91ciAlMS4iLAogICAgICAgICAgICAgIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KGNvb2tpZXNGb3JmZWl0ZWQpKQogICAgICAgICAgICApLAogICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgIllvdSBnYWluIDxiPiUxPC9iPiEiLAogICAgICAgICAgICAgIGxvYygiJTEgcHJlc3RpZ2UgbGV2ZWwiLCBMQmVhdXRpZnkocHJlc3RpZ2VEaWZmZXJlbmNlKSkKICAgICAgICAgICAgKSwKICAgICAgICAgICAgWzE5LCA3XQogICAgICAgICAgKTsKICAgICAgfQogICAgfTsKCiAgICBHYW1lLkdldEhlYXZlbmx5TXVsdGlwbGllciA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGhlYXZlbmx5TXVsdCA9IDA7CiAgICAgIGlmIChHYW1lLkhhcygiSGVhdmVubHkgY2hpcCBzZWNyZXQiKSkgaGVhdmVubHlNdWx0ICs9IDAuMDU7CiAgICAgIGlmIChHYW1lLkhhcygiSGVhdmVubHkgY29va2llIHN0YW5kIikpIGhlYXZlbmx5TXVsdCArPSAwLjI7CiAgICAgIGlmIChHYW1lLkhhcygiSGVhdmVubHkgYmFrZXJ5IikpIGhlYXZlbmx5TXVsdCArPSAwLjI1OwogICAgICBpZiAoR2FtZS5IYXMoIkhlYXZlbmx5IGNvbmZlY3Rpb25lcnkiKSkgaGVhdmVubHlNdWx0ICs9IDAuMjU7CiAgICAgIGlmIChHYW1lLkhhcygiSGVhdmVubHkga2V5IikpIGhlYXZlbmx5TXVsdCArPSAwLjI1OwogICAgICAvL2lmIChHYW1lLmhhc0F1cmEoJ0RyYWdvbiBHb2QnKSkgaGVhdmVubHlNdWx0Kj0xLjA1OwogICAgICBoZWF2ZW5seU11bHQgKj0gMSArIEdhbWUuYXVyYU11bHQoIkRyYWdvbiBHb2QiKSAqIDAuMDU7CiAgICAgIGlmIChHYW1lLkhhcygiTHVja3kgZGlnaXQiKSkgaGVhdmVubHlNdWx0ICo9IDEuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiTHVja3kgbnVtYmVyIikpIGhlYXZlbmx5TXVsdCAqPSAxLjAxOwogICAgICBpZiAoR2FtZS5IYXMoIkx1Y2t5IHBheW91dCIpKSBoZWF2ZW5seU11bHQgKj0gMS4wMTsKICAgICAgaWYgKEdhbWUuaGFzR29kKSB7CiAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJjcmVhdGlvbiIpOwogICAgICAgIGlmIChnb2RMdmwgPT0gMSkgaGVhdmVubHlNdWx0ICo9IDAuNzsKICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMikgaGVhdmVubHlNdWx0ICo9IDAuODsKICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMykgaGVhdmVubHlNdWx0ICo9IDAuOTsKICAgICAgfQogICAgICByZXR1cm4gaGVhdmVubHlNdWx0OwogICAgfTsKCiAgICBHYW1lLmFzY2Vuc2lvbk1vZGVzID0gewogICAgICAwOiB7CiAgICAgICAgbmFtZTogIk5vbmUiLAogICAgICAgIGRuYW1lOiBsb2MoIk5vbmUgW2FzY2Vuc2lvbiB0eXBlXSIpLAogICAgICAgIGRlc2M6IGxvYygiTm8gc3BlY2lhbCBtb2RpZmllcnMuIiksCiAgICAgICAgaWNvbjogWzEwLCAwXSwKICAgICAgfSwKICAgICAgMTogewogICAgICAgIG5hbWU6ICJCb3JuIGFnYWluIiwKICAgICAgICBkbmFtZTogbG9jKCJCb3JuIGFnYWluIFthc2NlbnNpb24gdHlwZV0iKSwKICAgICAgICBkZXNjOiBsb2MoCiAgICAgICAgICAnVGhpcyBydW4gd2lsbCBiZWhhdmUgYXMgaWYgeW91XCdkIGp1c3Qgc3RhcnRlZCB0aGUgZ2FtZSBmcm9tIHNjcmF0Y2guIFByZXN0aWdlIGxldmVscyBhbmQgaGVhdmVubHkgdXBncmFkZXMgd2lsbCBoYXZlIG5vIGVmZmVjdCwgYXMgd2lsbCBzdWdhciBsdW1wcyBhbmQgYnVpbGRpbmcgbGV2ZWxzLiBQZXJtYS11cGdyYWRlcyBhbmQgbWluaWdhbWVzIHdpbGwgYmUgdW5hdmFpbGFibGUuPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+U29tZSBhY2hpZXZlbWVudHMgYXJlIG9ubHkgYXZhaWxhYmxlIGluIHRoaXMgbW9kZS4nCiAgICAgICAgKSwKICAgICAgICBpY29uOiBbMiwgN10sCiAgICAgIH0gLyosCgkJMjp7bmFtZTonVHJpZ2dlciBmaW5nZXInLGRuYW1lOmxvYygiVHJpZ2dlciBmaW5nZXIgW2FzY2Vuc2lvbiB0eXBlXSIpLGRlc2M6bG9jKCJJbiB0aGlzIHJ1biwgc2Nyb2xsaW5nIHlvdXIgbW91c2Ugd2hlZWwgb24gdGhlIGNvb2tpZSBjb3VudHMgYXMgY2xpY2tpbmcgaXQuIFNvbWUgdXBncmFkZXMgaW50cm9kdWNlIG5ldyBjbGlja2luZyBiZWhhdmlvcnMuPGJyPk5vIGNsaWNraW5nIGFjaGlldmVtZW50cyBtYXkgYmUgb2J0YWluZWQgaW4gdGhpcyBtb2RlLjxkaXYgY2xhc3M9XCJsaW5lXCI+PC9kaXY+UmVhY2hpbmcgMSBxdWFkcmlsbGlvbiBjb29raWVzIGluIHRoaXMgbW9kZSB1bmxvY2tzIGEgc3BlY2lhbCBoZWF2ZW5seSB1cGdyYWRlLiIpLGljb246WzEyLDBdfSovLAogICAgfTsKCiAgICBHYW1lLmFzY2VuZE1ldGVyUGVyY2VudCA9IDA7CiAgICBHYW1lLmFzY2VuZE1ldGVyUGVyY2VudFQgPSAwOwogICAgR2FtZS5hc2NlbmRNZXRlckxldmVsID0gMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwOwoKICAgIEdhbWUubmV4dEFzY2Vuc2lvbk1vZGUgPSAwOwogICAgR2FtZS5VcGRhdGVBc2NlbnNpb25Nb2RlUHJvbXB0ID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgaWNvbiA9IEdhbWUuYXNjZW5zaW9uTW9kZXNbR2FtZS5uZXh0QXNjZW5zaW9uTW9kZV0uaWNvbjsKICAgICAgdmFyIG5hbWUgPSBHYW1lLmFzY2Vuc2lvbk1vZGVzW0dhbWUubmV4dEFzY2Vuc2lvbk1vZGVdLmRuYW1lOwogICAgICBsKCJhc2NlbmRNb2RlQnV0dG9uIikuaW5uZXJIVE1MID0KICAgICAgICAnPGRpdiBjbGFzcz0iY3JhdGUgbm9GcmFtZSBlbmFibGVkIiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJHYW1lLlBpY2tBc2NlbnNpb25Nb2RlKCk7IiAnICsKICAgICAgICBHYW1lLmdldFRvb2x0aXAoCiAgICAgICAgICAnPGRpdiBzdHlsZT0ibWluLXdpZHRoOjIwMHB4O3RleHQtYWxpZ246Y2VudGVyO2ZvbnQtc2l6ZToxMXB4OyIgaWQ9InRvb2x0aXBOZXh0Q2hhbGxlbmdlTW9kZSI+JyArCiAgICAgICAgICAgIGxvYygiQ2hhbGxlbmdlIG1vZGUgZm9yIHRoZSBuZXh0IHJ1bjoiKSArCiAgICAgICAgICAgICI8YnI+PGI+IiArCiAgICAgICAgICAgIG5hbWUgKwogICAgICAgICAgICAnPC9iPjxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicgKwogICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgIkNoYWxsZW5nZSBtb2RlcyBhcHBseSBzcGVjaWFsIG1vZGlmaWVycyB0byB5b3VyIG5leHQgYXNjZW5zaW9uLjxicj5DbGljayB0byBjaGFuZ2UuIgogICAgICAgICAgICApICsKICAgICAgICAgICAgIjwvZGl2PiIsCiAgICAgICAgICAiYm90dG9tLXJpZ2h0IgogICAgICAgICkgKwogICAgICAgICcgc3R5bGU9Im9wYWNpdHk6MTtmbG9hdDpub25lO2Rpc3BsYXk6YmxvY2s7YmFja2dyb3VuZC1wb3NpdGlvbjonICsKICAgICAgICAtaWNvblswXSAqIDQ4ICsKICAgICAgICAicHggIiArCiAgICAgICAgLWljb25bMV0gKiA0OCArCiAgICAgICAgJ3B4OyI+PC9kaXY+JzsKICAgIH07CiAgICBHYW1lLlBpY2tBc2NlbnNpb25Nb2RlID0gZnVuY3Rpb24gKCkgewogICAgICBQbGF5U291bmQoInNuZC90aWNrLm1wMyIpOwogICAgICBHYW1lLnRvb2x0aXAuaGlkZSgpOwoKICAgICAgdmFyIHN0ciA9ICIiOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUuYXNjZW5zaW9uTW9kZXMpIHsKICAgICAgICB2YXIgaWNvbiA9IEdhbWUuYXNjZW5zaW9uTW9kZXNbaV0uaWNvbjsKICAgICAgICBzdHIgKz0KICAgICAgICAgICc8ZGl2IGNsYXNzPSJjcmF0ZSBlbmFibGVkJyArCiAgICAgICAgICAoaSA9PSBHYW1lLm5leHRBc2NlbnNpb25Nb2RlID8gIiBoaWdobGlnaHRlZCIgOiAiIikgKwogICAgICAgICAgJyIgaWQ9ImNoYWxsZW5nZU1vZGVTZWxlY3RvcicgKwogICAgICAgICAgaSArCiAgICAgICAgICAnIiBzdHlsZT0ib3BhY2l0eToxO2Zsb2F0Om5vbmU7ZGlzcGxheTppbmxpbmUtYmxvY2s7YmFja2dyb3VuZC1wb3NpdGlvbjonICsKICAgICAgICAgIC1pY29uWzBdICogNDggKwogICAgICAgICAgInB4ICIgKwogICAgICAgICAgLWljb25bMV0gKiA0OCArCiAgICAgICAgICAncHg7IiAnICsKICAgICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICAgJz0iR2FtZS5uZXh0QXNjZW5zaW9uTW9kZT0nICsKICAgICAgICAgIGkgKwogICAgICAgICAgIjtHYW1lLlBpY2tBc2NlbnNpb25Nb2RlKCk7UGxheVNvdW5kKCdzbmQvdGljay5tcDMnKTtHYW1lLmNob2ljZVNlbGVjdG9yT249LTE7XCIgb25Nb3VzZU91dD1cImwoJ2NoYWxsZW5nZVNlbGVjdGVkTmFtZScpLmlubmVySFRNTD1HYW1lLmFzY2Vuc2lvbk1vZGVzW0dhbWUubmV4dEFzY2Vuc2lvbk1vZGVdLmRuYW1lO2woJ2NoYWxsZW5nZVNlbGVjdGVkRGVzYycpLmlubmVySFRNTD1HYW1lLmFzY2Vuc2lvbk1vZGVzW0dhbWUubmV4dEFzY2Vuc2lvbk1vZGVdLmRlc2M7XCIgb25Nb3VzZU92ZXI9XCJsKCdjaGFsbGVuZ2VTZWxlY3RlZE5hbWUnKS5pbm5lckhUTUw9R2FtZS5hc2NlbnNpb25Nb2Rlc1siICsKICAgICAgICAgIGkgKwogICAgICAgICAgIl0uZG5hbWU7bCgnY2hhbGxlbmdlU2VsZWN0ZWREZXNjJykuaW5uZXJIVE1MPUdhbWUuYXNjZW5zaW9uTW9kZXNbIiArCiAgICAgICAgICBpICsKICAgICAgICAgICddLmRlc2M7IicgKwogICAgICAgICAgIj48L2Rpdj4iOwogICAgICB9CiAgICAgIEdhbWUuUHJvbXB0KAogICAgICAgICI8aWQgUGlja0NoYWxsZW5nZU1vZGU+PGgzPiIgKwogICAgICAgICAgbG9jKCJTZWxlY3QgYSBjaGFsbGVuZ2UgbW9kZSIpICsKICAgICAgICAgICI8L2gzPiIgKwogICAgICAgICAgJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PjxkaXYgY2xhc3M9ImNyYXRlQm94Ij4nICsKICAgICAgICAgIHN0ciArCiAgICAgICAgICAnPC9kaXY+PGg0IGlkPSJjaGFsbGVuZ2VTZWxlY3RlZE5hbWUiPicgKwogICAgICAgICAgR2FtZS5hc2NlbnNpb25Nb2Rlc1tHYW1lLm5leHRBc2NlbnNpb25Nb2RlXS5kbmFtZSArCiAgICAgICAgICAnPC9oND48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj48ZGl2IGlkPSJjaGFsbGVuZ2VTZWxlY3RlZERlc2MiIHN0eWxlPSJtaW4taGVpZ2h0OjEyOHB4OyI+JyArCiAgICAgICAgICBHYW1lLmFzY2Vuc2lvbk1vZGVzW0dhbWUubmV4dEFzY2Vuc2lvbk1vZGVdLmRlc2MgKwogICAgICAgICAgJzwvZGl2PjxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicsCiAgICAgICAgWwogICAgICAgICAgWwogICAgICAgICAgICBsb2MoIkNvbmZpcm0iKSwKICAgICAgICAgICAgIkdhbWUuVXBkYXRlQXNjZW5zaW9uTW9kZVByb21wdCgpO0dhbWUuQ2xvc2VQcm9tcHQoKTsiLAogICAgICAgICAgXSwKICAgICAgICBdLAogICAgICAgIDAsCiAgICAgICAgIndpZGVQcm9tcHQiCiAgICAgICk7CiAgICB9OwoKICAgIGwoImFzY2VuZE92ZXJsYXkiKS5pbm5lckhUTUwgPQogICAgICAnPGRpdiBpZD0iYXNjZW5kQm94Ij4nICsKICAgICAgJzxkaXYgaWQ9ImFzY2VuZERhdGExIiBjbGFzcz0iYXNjZW5kRGF0YSBzbWFsbEZyYW1lZCBwcm9tcHQiIHN0eWxlPSJtYXJnaW4tdG9wOjhweDsiPjxoMyBpZD0iYXNjZW5kUHJlc3RpZ2UiPjwvaDM+PC9kaXY+JyArCiAgICAgICc8ZGl2IGlkPSJhc2NlbmREYXRhMiIgY2xhc3M9ImFzY2VuZERhdGEgc21hbGxGcmFtZWQgcHJvbXB0Ij48aDMgaWQ9ImFzY2VuZEhDcyI+PC9oMz48L2Rpdj4nICsKICAgICAgJzxhIGlkPSJhc2NlbmRCdXR0b24iIGNsYXNzPSJvcHRpb24gZnJhbWVkIGxhcmdlIHJlZCIgJyArCiAgICAgIEdhbWUuZ2V0VG9vbHRpcCgKICAgICAgICAnPGRpdiBzdHlsZT0ibWluLXdpZHRoOjMwMHB4O3RleHQtYWxpZ246Y2VudGVyO2ZvbnQtc2l6ZToxMXB4O3BhZGRpbmc6OHB4OyIgaWQ9InRvb2x0aXBSZWluY2FybmF0ZSI+JyArCiAgICAgICAgICBsb2MoIkNsaWNrIHRoaXMgb25jZSB5b3UndmUgYm91Z2h0PGJyPmV2ZXJ5dGhpbmcgeW91IG5lZWQhIikgKwogICAgICAgICAgIjwvZGl2PiIsCiAgICAgICAgImJvdHRvbS1yaWdodCIKICAgICAgKSArCiAgICAgICcgc3R5bGU9ImZvbnQtc2l6ZToxNnB4O21hcmdpbi10b3A6MHB4OyI+PHNwYW4gY2xhc3M9ImZhbmN5VGV4dCIgc3R5bGU9ImZvbnQtc2l6ZToyMHB4OyI+JyArCiAgICAgIGxvYygiUmVpbmNhcm5hdGUiKSArCiAgICAgICI8L3NwYW4+PC9hPiIgKwogICAgICAnPGRpdiBpZD0iYXNjZW5kTW9kZUJ1dHRvbiIgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlO3JpZ2h0OjM0cHg7Ym90dG9tOjI1cHg7ZGlzcGxheTpub25lOyI+PC9kaXY+JyArCiAgICAgICc8aW5wdXQgdHlwZT0idGV4dCIgc3R5bGU9ImRpc3BsYXk6YmxvY2s7IiBpZD0idXBncmFkZVBvc2l0aW9ucyIvPjwvZGl2PicgKwogICAgICAnPGRpdiBpZD0iYXNjZW5kSW5mbyI+PGRpdiBjbGFzcz0iYXNjZW5kRGF0YSBzbWFsbEZyYW1lZCIgc3R5bGU9Im1hcmdpbi10b3A6MjJweDt3aWR0aDo3NSU7Zm9udC1zaXplOjExcHg7Ij4nICsKICAgICAgbG9jKAogICAgICAgICJZb3UgYXJlIGFzY2VuZGluZy48YnI+RHJhZyB0aGUgc2NyZWVuIGFyb3VuZDxicj5vciB1c2UgYXJyb3cga2V5cyE8YnI+V2hlbiB5b3UncmUgcmVhZHksPGJyPmNsaWNrIFJlaW5jYXJuYXRlLiIKICAgICAgKSArCiAgICAgICI8L2Rpdj48L2Rpdj4iOwoKICAgIEdhbWUuYXR0YWNoVG9vbHRpcCgKICAgICAgbCgiYXNjZW5kRGF0YTEiKSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiAoCiAgICAgICAgICAnPGRpdiBzdHlsZT0ibWluLXdpZHRoOjMwMHB4O3RleHQtYWxpZ246Y2VudGVyO2ZvbnQtc2l6ZToxMXB4O3BhZGRpbmc6OHB4OyIgaWQ9InRvb2x0aXBBc2NlbmREYXRhMSI+KDxiPicgKwogICAgICAgICAgQmVhdXRpZnkoR2FtZS5oZWF2ZW5seUNoaXBzKSArCiAgICAgICAgICAnPC9iPik8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICAgIGxvYygKICAgICAgICAgICAgIkVhY2ggcHJlc3RpZ2UgbGV2ZWwgZ3JhbnRzIHlvdSBhIHBlcm1hbmVudCA8Yj4rJTElIENwUzwvYj4uPGJyPlRoZSBtb3JlIGxldmVscyB5b3UgaGF2ZSwgdGhlIG1vcmUgY29va2llcyB0aGV5IHJlcXVpcmUuIiwKICAgICAgICAgICAgMQogICAgICAgICAgKSArCiAgICAgICAgICAiPC9kaXY+IgogICAgICAgICk7CiAgICAgIH0sCiAgICAgICJib3R0b20tcmlnaHQiCiAgICApOwogICAgR2FtZS5hdHRhY2hUb29sdGlwKAogICAgICBsKCJhc2NlbmREYXRhMiIpLAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuICgKICAgICAgICAgICc8ZGl2IHN0eWxlPSJtaW4td2lkdGg6MzAwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Zm9udC1zaXplOjExcHg7cGFkZGluZzo4cHg7IiBpZD0idG9vbHRpcEFzY2VuZERhdGEyIj4oPGI+JyArCiAgICAgICAgICBsb2MoIiUxIGhlYXZlbmx5IGNoaXAiLCBMQmVhdXRpZnkoR2FtZS5oZWF2ZW5seUNoaXBzKSkgKwogICAgICAgICAgJzwvYj4pPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgICBsb2MoCiAgICAgICAgICAgICJIZWF2ZW5seSBjaGlwcyBhcmUgdXNlZCB0byBidXkgaGVhdmVubHkgdXBncmFkZXMuPGJyPllvdSBnYWluIDxiPjEgY2hpcDwvYj4gZXZlcnkgdGltZSB5b3UgZ2FpbiBhIHByZXN0aWdlIGxldmVsLiIKICAgICAgICAgICkgKwogICAgICAgICAgIjwvZGl2PiIKICAgICAgICApOwogICAgICB9LAogICAgICAiYm90dG9tLXJpZ2h0IgogICAgKTsKCiAgICBHYW1lLlVwZGF0ZUFzY2Vuc2lvbk1vZGVQcm9tcHQoKTsKCiAgICBBZGRFdmVudChsKCJhc2NlbmRCdXR0b24iKSwgImNsaWNrIiwgZnVuY3Rpb24gKCkgewogICAgICBQbGF5U291bmQoInNuZC90aWNrLm1wMyIpOwogICAgICBHYW1lLlJlaW5jYXJuYXRlKCk7CiAgICB9KTsKCiAgICBHYW1lLmFzY2VuZGwgPSBsKCJhc2NlbmQiKTsKICAgIEdhbWUuYXNjZW5kQ29udGVudGwgPSBsKCJhc2NlbmRDb250ZW50Iik7CiAgICBHYW1lLmFzY2VuZFpvb21hYmxlbCA9IGwoImFzY2VuZFpvb21hYmxlIik7CiAgICBHYW1lLmFzY2VuZFVwZ3JhZGVzbCA9IGwoImFzY2VuZFVwZ3JhZGVzIik7CiAgICBHYW1lLk9uQXNjZW5kID0gMDsKICAgIEdhbWUuQXNjZW5kVGltZXIgPSAwOyAvL2hvdyBmYXIgd2UgYXJlIGludG8gdGhlIGFzY2VuZCBhbmltYXRpb24KICAgIEdhbWUuQXNjZW5kRHVyYXRpb24gPSBHYW1lLmZwcyAqIDU7IC8vaG93IGxvbmcgdGhlIGFzY2VuZCBhbmltYXRpb24gaXMKICAgIEdhbWUuQXNjZW5kQnJlYWtwb2ludCA9IEdhbWUuQXNjZW5kRHVyYXRpb24gKiAwLjU7IC8vYXQgd2hpY2ggcG9pbnQgdGhlIGNvb2tpZSBleHBsb2RlcyBkdXJpbmcgdGhlIGFzY2VuZCBhbmltYXRpb24KICAgIEdhbWUuVXBkYXRlQXNjZW5kSW50cm8gPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChHYW1lLkFzY2VuZFRpbWVyID09IDEpIFBsYXlTb3VuZCgic25kL2NoYXJnaW5nLm1wMyIpOwogICAgICBpZiAoR2FtZS5Bc2NlbmRUaW1lciA9PSBNYXRoLmZsb29yKEdhbWUuQXNjZW5kQnJlYWtwb2ludCkpCiAgICAgICAgUGxheVNvdW5kKCJzbmQvdGh1ZC5tcDMiKTsKICAgICAgR2FtZS5Bc2NlbmRUaW1lcisrOwogICAgICBpZiAoR2FtZS5Bc2NlbmRUaW1lciA+IEdhbWUuQXNjZW5kRHVyYXRpb24pIHsKICAgICAgICAvL2VuZCBhbmltYXRpb24gYW5kIGxhdW5jaCBhc2NlbmQgc2NyZWVuCiAgICAgICAgUGxheUN1ZSgiYXNjZW5kIik7CiAgICAgICAgUGxheU11c2ljU291bmQoInNuZC9jeW1iYWxSZXYubXAzIik7CiAgICAgICAgaWYgKCFBcHAgfHwgR2FtZS52b2x1bWVNdXNpYyA9PSAwKSBQbGF5U291bmQoInNuZC9jaG9pci5tcDMiKTsKICAgICAgICBHYW1lLkVhcm5IZWF2ZW5seUNoaXBzKEdhbWUuY29va2llc0Vhcm5lZCk7CiAgICAgICAgR2FtZS5Bc2NlbmRUaW1lciA9IDA7CiAgICAgICAgR2FtZS5PbkFzY2VuZCA9IDE7CiAgICAgICAgR2FtZS5yZW1vdmVDbGFzcygiYXNjZW5kSW50cm8iKTsKICAgICAgICBHYW1lLmFkZENsYXNzKCJhc2NlbmRpbmciKTsKICAgICAgICBHYW1lLkJ1aWxkQXNjZW5kVHJlZSgpOwogICAgICAgIEdhbWUuaGVhdmVubHlDaGlwc0Rpc3BsYXllZCA9IEdhbWUuaGVhdmVubHlDaGlwczsKICAgICAgICBHYW1lLm5leHRBc2NlbnNpb25Nb2RlID0gMDsKICAgICAgICBHYW1lLmFzY2Vuc2lvbk1vZGUgPSAwOwogICAgICAgIEdhbWUuVXBkYXRlQXNjZW5zaW9uTW9kZVByb21wdCgpOwogICAgICB9CiAgICB9OwogICAgR2FtZS5SZWluY2FybmF0ZVRpbWVyID0gMDsgLy9ob3cgZmFyIHdlIGFyZSBpbnRvIHRoZSByZWluY2FybmF0aW9uIGFuaW1hdGlvbgogICAgR2FtZS5SZWluY2FybmF0ZUR1cmF0aW9uID0gR2FtZS5mcHMgKiAxOyAvL2hvdyBsb25nIHRoZSByZWluY2FybmF0aW9uIGFuaW1hdGlvbiBpcwogICAgR2FtZS5VcGRhdGVSZWluY2FybmF0ZUludHJvID0gZnVuY3Rpb24gKCkgewogICAgICBpZiAoR2FtZS5SZWluY2FybmF0ZVRpbWVyID09IDEpCiAgICAgICAgUGxheVNvdW5kKCJzbmQvcG9wIiArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDMgKyAxKSArICIubXAzIiwgMC43NSk7CiAgICAgIEdhbWUuUmVpbmNhcm5hdGVUaW1lcisrOwogICAgICBpZiAoR2FtZS5SZWluY2FybmF0ZVRpbWVyID4gR2FtZS5SZWluY2FybmF0ZUR1cmF0aW9uKSB7CiAgICAgICAgLy9lbmQgYW5pbWF0aW9uIGFuZCBsYXVuY2ggcmVndWxhciBnYW1lCiAgICAgICAgR2FtZS5SZWluY2FybmF0ZVRpbWVyID0gMDsKICAgICAgICBHYW1lLnJlbW92ZUNsYXNzKCJyZWluY2FybmF0aW5nIik7CiAgICAgIH0KICAgIH07CiAgICBHYW1lLlJlaW5jYXJuYXRlID0gZnVuY3Rpb24gKGJ5cGFzcykgewogICAgICBpZiAoIWJ5cGFzcykKICAgICAgICBHYW1lLlByb21wdCgKICAgICAgICAgICI8aWQgUmVpbmNhcm5hdGU+PGgzPiIgKwogICAgICAgICAgICBsb2MoIlJlaW5jYXJuYXRlIikgKwogICAgICAgICAgICAnPC9oMz48ZGl2IGNsYXNzPSJibG9jayI+JyArCiAgICAgICAgICAgIGxvYygiQXJlIHlvdSByZWFkeSB0byByZXR1cm4gdG8gdGhlIG1vcnRhbCB3b3JsZD8iKSArCiAgICAgICAgICAgICI8L2Rpdj4iLAogICAgICAgICAgW1tsb2MoIlllcyIpLCAiR2FtZS5DbG9zZVByb21wdCgpO0dhbWUuUmVpbmNhcm5hdGUoMSk7Il0sIGxvYygiTm8iKV0KICAgICAgICApOwogICAgICBlbHNlIHsKICAgICAgICBHYW1lLmFzY2VuZFVwZ3JhZGVzbC5pbm5lckhUTUwgPSAiIjsKICAgICAgICBHYW1lLmFzY2Vuc2lvbk1vZGUgPSBHYW1lLm5leHRBc2NlbnNpb25Nb2RlOwogICAgICAgIEdhbWUubmV4dEFzY2Vuc2lvbk1vZGUgPSAwOwogICAgICAgIEdhbWUuUmVzZXQoKTsKICAgICAgICBpZiAoR2FtZS5IYXNBY2hpZXYoIlJlYmlydGgiKSkgewogICAgICAgICAgR2FtZS5Ob3RpZnkoIlJlaW5jYXJuYXRlZCIsIGxvYygiSGVsbG8sIGNvb2tpZXMhIiksIFsxMCwgMF0sIDQpOwogICAgICAgIH0KICAgICAgICBpZiAoR2FtZS5yZXNldHMgPj0gMTAwMCkgR2FtZS5XaW4oIkVuZGxlc3MgY3ljbGUiKTsKICAgICAgICBpZiAoR2FtZS5yZXNldHMgPj0gMTAwKSBHYW1lLldpbigiUmVpbmNhcm5hdGlvbiIpOwogICAgICAgIGlmIChHYW1lLnJlc2V0cyA+PSAxMCkgR2FtZS5XaW4oIlJlc3VycmVjdGlvbiIpOwogICAgICAgIGlmIChHYW1lLnJlc2V0cyA+PSAxKSBHYW1lLldpbigiUmViaXJ0aCIpOwoKICAgICAgICB2YXIgcHJlc3RpZ2VVcGdyYWRlc093bmVkID0gMDsKICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuVXBncmFkZXMpIHsKICAgICAgICAgIGlmIChHYW1lLlVwZ3JhZGVzW2ldLmJvdWdodCAmJiBHYW1lLlVwZ3JhZGVzW2ldLnBvb2wgPT0gInByZXN0aWdlIikKICAgICAgICAgICAgcHJlc3RpZ2VVcGdyYWRlc093bmVkKys7CiAgICAgICAgfQogICAgICAgIGlmIChwcmVzdGlnZVVwZ3JhZGVzT3duZWQgPj0gMTAwKSBHYW1lLldpbigiQWxsIHRoZSBzdGFycyBpbiBoZWF2ZW4iKTsKCiAgICAgICAgR2FtZS5yZW1vdmVDbGFzcygiYXNjZW5kaW5nIik7CiAgICAgICAgR2FtZS5PbkFzY2VuZCA9IDA7CiAgICAgICAgLy90cmlnZ2VyIHRoZSByZWluY2FybmF0ZSBhbmltYXRpb24KICAgICAgICBHYW1lLlJlaW5jYXJuYXRlVGltZXIgPSAxOwogICAgICAgIEdhbWUuYWRkQ2xhc3MoInJlaW5jYXJuYXRpbmciKTsKICAgICAgICBHYW1lLkJpZ0Nvb2tpZVNpemUgPSAwOwoKICAgICAgICBHYW1lLnJ1bk1vZEhvb2soInJlaW5jYXJuYXRlIik7CiAgICAgIH0KICAgIH07CiAgICBHYW1lLkFzY2VuZCA9IGZ1bmN0aW9uIChieXBhc3MpIHsKICAgICAgaWYgKCFieXBhc3MpCiAgICAgICAgR2FtZS5Qcm9tcHQoCiAgICAgICAgICAiPGlkIEFzY2VuZD48aDM+IiArCiAgICAgICAgICAgIGxvYygiQXNjZW5kIikgKwogICAgICAgICAgICAnPC9oMz48ZGl2IGNsYXNzPSJibG9jayI+JyArCiAgICAgICAgICAgIHRpbnlJY29uKFsxOSwgN10pICsKICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicgKwogICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgJ0RvIHlvdSBSRUFMTFkgd2FudCB0byBhc2NlbmQ/PGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+WW91IHdpbGwgbG9zZSB5b3VyIHByb2dyZXNzIGFuZCBzdGFydCBvdmVyIGZyb20gc2NyYXRjaC48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj5BbGwgeW91ciBjb29raWVzIHdpbGwgYmUgY29udmVydGVkIGludG8gcHJlc3RpZ2UgYW5kIGhlYXZlbmx5IGNoaXBzLicKICAgICAgICAgICAgKSArCiAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICAgICAgKEdhbWUuY2FuTHVtcHMoKQogICAgICAgICAgICAgID8gbG9jKAogICAgICAgICAgICAgICAgICAiWW91IHdpbGwga2VlcCB5b3VyIGFjaGlldmVtZW50cywgYnVpbGRpbmcgbGV2ZWxzIGFuZCBzdWdhciBsdW1wcy4iCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgOiBsb2MoIllvdSB3aWxsIGtlZXAgeW91ciBhY2hpZXZlbWVudHMuIikpICsKICAgICAgICAgICAgJzxkaXYgY2xhc3M9Im9wdGlvbkJveCI+PGEgY2xhc3M9Im9wdGlvbiBzbWFsbEZhbmN5QnV0dG9uIiBzdHlsZT0ibWFyZ2luOjE2cHg7cGFkZGluZzo4cHggMTZweDthbmltYXRpb246cmFpbmJvd0N5Y2xlIDVzIGluZmluaXRlIGVhc2UtaW4tb3V0LHB1Y2tlciAwLjJzIGVhc2Utb3V0O2JveC1zaGFkb3c6MHB4IDBweCAwcHggMXB4ICMwMDAsMHB4IDBweCAxcHggMnB4IGN1cnJlbnRjb2xvcjtiYWNrZ3JvdW5kOmxpbmVhci1ncmFkaWVudCh0byBib3R0b20sdHJhbnNwYXJlbnQgMCUsY3VycmVudENvbG9yIDUwMCUpO3dpZHRoOmF1dG87dGV4dC1hbGlnbjpjZW50ZXI7IiAnICsKICAgICAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgICAgICc9IlBsYXlTb3VuZChcJ3NuZC90aWNrLm1wM1wnKTtHYW1lLkNsb3NlUHJvbXB0KCk7R2FtZS5Bc2NlbmQoMSk7IiBpZD0icHJvbXB0T3B0aW9uMCI+JyArCiAgICAgICAgICAgIGxvYygiQXNjZW5kIikgKwogICAgICAgICAgICAiPC9hPjwvZGl2PjwvZGl2PiIsCiAgICAgICAgICBbCiAgICAgICAgICAgIFsKICAgICAgICAgICAgICBsb2MoIlllcyIpLAogICAgICAgICAgICAgICJHYW1lLkNsb3NlUHJvbXB0KCk7R2FtZS5Bc2NlbmQoMSk7IiwKICAgICAgICAgICAgICAiZmxvYXQ6bGVmdDtkaXNwbGF5Om5vbmU7IiwKICAgICAgICAgICAgXSwKICAgICAgICAgICAgW2xvYygiQ2FuY2VsIiksIDAsICJmbG9hdDpyaWdodCJdLAogICAgICAgICAgXQogICAgICAgICk7CiAgICAgIGVsc2UgewogICAgICAgIEdhbWUuTm90aWZ5KGxvYygiQXNjZW5kaW5nIiksIGxvYygiU28gbG9uZywgY29va2llcy4iKSwgWzIwLCA3XSwgNCk7CiAgICAgICAgR2FtZS5PbkFzY2VuZCA9IDA7CiAgICAgICAgR2FtZS5yZW1vdmVDbGFzcygiYXNjZW5kaW5nIik7CiAgICAgICAgR2FtZS5hZGRDbGFzcygiYXNjZW5kSW50cm8iKTsKICAgICAgICAvL3RyaWdnZXIgdGhlIGFzY2VuZCBhbmltYXRpb24KICAgICAgICBHYW1lLkFzY2VuZFRpbWVyID0gMTsKICAgICAgICBHYW1lLmtpbGxTaGltbWVycygpOwogICAgICAgIGwoInRvZ2dsZUJveCIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgbCgidG9nZ2xlQm94IikuaW5uZXJIVE1MID0gIiI7CiAgICAgICAgR2FtZS5jaG9pY2VTZWxlY3Rvck9uID0gLTE7CiAgICAgICAgR2FtZS5Ub2dnbGVTcGVjaWFsTWVudSgwKTsKICAgICAgICBHYW1lLkFzY2VuZE9mZlggPSAwOwogICAgICAgIEdhbWUuQXNjZW5kT2ZmWSA9IDA7CiAgICAgICAgR2FtZS5Bc2NlbmRPZmZYVCA9IDA7CiAgICAgICAgR2FtZS5Bc2NlbmRPZmZZVCA9IDA7CiAgICAgICAgR2FtZS5Bc2NlbmRab29tVCA9IDE7CiAgICAgICAgR2FtZS5Bc2NlbmRab29tID0gMC4yOwoKICAgICAgICBHYW1lLmp1a2Vib3gucmVzZXQoKTsKICAgICAgICBQbGF5Q3VlKCJwcmVhc2NlbmQiKTsKICAgICAgfQogICAgfTsKCiAgICBHYW1lLkRlYnVnZ2luZ1ByZXN0aWdlID0gMDsKICAgIEdhbWUuQXNjZW5kRHJhZ1ggPSAwOwogICAgR2FtZS5Bc2NlbmREcmFnWSA9IDA7CiAgICBHYW1lLkFzY2VuZE9mZlggPSAwOwogICAgR2FtZS5Bc2NlbmRPZmZZID0gMDsKICAgIEdhbWUuQXNjZW5kWm9vbSA9IDE7CiAgICBHYW1lLkFzY2VuZE9mZlhUID0gMDsKICAgIEdhbWUuQXNjZW5kT2ZmWVQgPSAwOwogICAgR2FtZS5Bc2NlbmRab29tVCA9IDE7CiAgICBHYW1lLkFzY2VuZERyYWdnaW5nID0gMDsKICAgIEdhbWUuQXNjZW5kR3JpZFNuYXAgPSAyNDsKICAgIEdhbWUuaGVhdmVubHlCb3VuZHMgPSB7IGxlZnQ6IDAsIHJpZ2h0OiAwLCB0b3A6IDAsIGJvdHRvbTogMCB9OwogICAgR2FtZS5VcGRhdGVBc2NlbmQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChHYW1lLmtleXNbMzddKSBHYW1lLkFzY2VuZE9mZlhUICs9IDE2ICogKDEgLyBHYW1lLkFzY2VuZFpvb21UKTsKICAgICAgaWYgKEdhbWUua2V5c1szOF0pIEdhbWUuQXNjZW5kT2ZmWVQgKz0gMTYgKiAoMSAvIEdhbWUuQXNjZW5kWm9vbVQpOwogICAgICBpZiAoR2FtZS5rZXlzWzM5XSkgR2FtZS5Bc2NlbmRPZmZYVCAtPSAxNiAqICgxIC8gR2FtZS5Bc2NlbmRab29tVCk7CiAgICAgIGlmIChHYW1lLmtleXNbNDBdKSBHYW1lLkFzY2VuZE9mZllUIC09IDE2ICogKDEgLyBHYW1lLkFzY2VuZFpvb21UKTsKCiAgICAgIGlmIChHYW1lLkFzY2VuZE9mZlhUID4gLUdhbWUuaGVhdmVubHlCb3VuZHMubGVmdCkKICAgICAgICBHYW1lLkFzY2VuZE9mZlhUID0gLUdhbWUuaGVhdmVubHlCb3VuZHMubGVmdDsKICAgICAgaWYgKEdhbWUuQXNjZW5kT2ZmWFQgPCAtR2FtZS5oZWF2ZW5seUJvdW5kcy5yaWdodCkKICAgICAgICBHYW1lLkFzY2VuZE9mZlhUID0gLUdhbWUuaGVhdmVubHlCb3VuZHMucmlnaHQ7CiAgICAgIGlmIChHYW1lLkFzY2VuZE9mZllUID4gLUdhbWUuaGVhdmVubHlCb3VuZHMudG9wKQogICAgICAgIEdhbWUuQXNjZW5kT2ZmWVQgPSAtR2FtZS5oZWF2ZW5seUJvdW5kcy50b3A7CiAgICAgIGlmIChHYW1lLkFzY2VuZE9mZllUIDwgLUdhbWUuaGVhdmVubHlCb3VuZHMuYm90dG9tKQogICAgICAgIEdhbWUuQXNjZW5kT2ZmWVQgPSAtR2FtZS5oZWF2ZW5seUJvdW5kcy5ib3R0b207CiAgICAgIEdhbWUuQXNjZW5kT2ZmWCArPSAoR2FtZS5Bc2NlbmRPZmZYVCAtIEdhbWUuQXNjZW5kT2ZmWCkgKiAwLjU7CiAgICAgIEdhbWUuQXNjZW5kT2ZmWSArPSAoR2FtZS5Bc2NlbmRPZmZZVCAtIEdhbWUuQXNjZW5kT2ZmWSkgKiAwLjU7CiAgICAgIEdhbWUuQXNjZW5kWm9vbSArPSAoR2FtZS5Bc2NlbmRab29tVCAtIEdhbWUuQXNjZW5kWm9vbSkgKiAwLjI1OwogICAgICBpZiAoTWF0aC5hYnMoR2FtZS5Bc2NlbmRab29tVCAtIEdhbWUuQXNjZW5kWm9vbSkgPCAwLjAwNSkKICAgICAgICBHYW1lLkFzY2VuZFpvb20gPSBHYW1lLkFzY2VuZFpvb21UOwoKICAgICAgaWYgKEdhbWUubW91c2VEb3duICYmICFHYW1lLnByb21wdE9uKSB7CiAgICAgICAgaWYgKCFHYW1lLkFzY2VuZERyYWdnaW5nKSB7CiAgICAgICAgICBHYW1lLkFzY2VuZERyYWdYID0gR2FtZS5tb3VzZVg7CiAgICAgICAgICBHYW1lLkFzY2VuZERyYWdZID0gR2FtZS5tb3VzZVk7CiAgICAgICAgfQogICAgICAgIEdhbWUuQXNjZW5kRHJhZ2dpbmcgPSAxOwoKICAgICAgICBpZiAoR2FtZS5EZWJ1Z2dpbmdQcmVzdGlnZSkgewogICAgICAgICAgaWYgKEdhbWUuU2VsZWN0ZWRIZWF2ZW5seVVwZ3JhZGUpIHsKICAgICAgICAgICAgR2FtZS50b29sdGlwLmhpZGUoKTsKICAgICAgICAgICAgLy9kcmFnIHVwZ3JhZGVzIGFyb3VuZAogICAgICAgICAgICB2YXIgbWUgPSBHYW1lLlNlbGVjdGVkSGVhdmVubHlVcGdyYWRlOwogICAgICAgICAgICBtZS5wb3NYICs9CiAgICAgICAgICAgICAgKEdhbWUubW91c2VYIC0gR2FtZS5Bc2NlbmREcmFnWCkgKiAoMSAvIEdhbWUuQXNjZW5kWm9vbVQpOwogICAgICAgICAgICBtZS5wb3NZICs9CiAgICAgICAgICAgICAgKEdhbWUubW91c2VZIC0gR2FtZS5Bc2NlbmREcmFnWSkgKiAoMSAvIEdhbWUuQXNjZW5kWm9vbVQpOwogICAgICAgICAgICB2YXIgcG9zWCA9IG1lLnBvc1g7IC8vTWF0aC5yb3VuZChtZS5wb3NYL0dhbWUuQXNjZW5kR3JpZFNuYXApKkdhbWUuQXNjZW5kR3JpZFNuYXA7CiAgICAgICAgICAgIHZhciBwb3NZID0gbWUucG9zWTsgLy9NYXRoLnJvdW5kKG1lLnBvc1kvR2FtZS5Bc2NlbmRHcmlkU25hcCkqR2FtZS5Bc2NlbmRHcmlkU25hcDsKICAgICAgICAgICAgbCgiaGVhdmVubHlVcGdyYWRlIiArIG1lLmlkKS5zdHlsZS5sZWZ0ID0gTWF0aC5mbG9vcihwb3NYKSArICJweCI7CiAgICAgICAgICAgIGwoImhlYXZlbmx5VXBncmFkZSIgKyBtZS5pZCkuc3R5bGUudG9wID0gTWF0aC5mbG9vcihwb3NZKSArICJweCI7CiAgICAgICAgICAgIGZvciAodmFyIGlpIGluIG1lLnBhcmVudHMpIHsKICAgICAgICAgICAgICB2YXIgb3JpZ1ggPSAwOwogICAgICAgICAgICAgIHZhciBvcmlnWSA9IDA7CiAgICAgICAgICAgICAgdmFyIHRhcmdYID0gbWUucG9zWCArIDI4OwogICAgICAgICAgICAgIHZhciB0YXJnWSA9IG1lLnBvc1kgKyAyODsKICAgICAgICAgICAgICBpZiAobWUucGFyZW50c1tpaV0gIT0gLTEpIHsKICAgICAgICAgICAgICAgIG9yaWdYID0gbWUucGFyZW50c1tpaV0ucG9zWCArIDI4OwogICAgICAgICAgICAgICAgb3JpZ1kgPSBtZS5wYXJlbnRzW2lpXS5wb3NZICsgMjg7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHZhciByb3QgPQogICAgICAgICAgICAgICAgLShNYXRoLmF0YW4oKHRhcmdZIC0gb3JpZ1kpIC8gKG9yaWdYIC0gdGFyZ1gpKSAvIE1hdGguUEkpICogMTgwOwogICAgICAgICAgICAgIGlmICh0YXJnWCA8PSBvcmlnWCkgcm90ICs9IDE4MDsKICAgICAgICAgICAgICB2YXIgZGlzdCA9IE1hdGguZmxvb3IoCiAgICAgICAgICAgICAgICBNYXRoLnNxcnQoCiAgICAgICAgICAgICAgICAgICh0YXJnWCAtIG9yaWdYKSAqICh0YXJnWCAtIG9yaWdYKSArCiAgICAgICAgICAgICAgICAgICAgKHRhcmdZIC0gb3JpZ1kpICogKHRhcmdZIC0gb3JpZ1kpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgbCgiaGVhdmVubHlMaW5rIiArIG1lLmlkICsgIi0iICsgaWkpLnN0eWxlID0KICAgICAgICAgICAgICAgICJ3aWR0aDoiICsKICAgICAgICAgICAgICAgIGRpc3QgKwogICAgICAgICAgICAgICAgInB4O3RyYW5zZm9ybTpyb3RhdGUoIiArCiAgICAgICAgICAgICAgICByb3QgKwogICAgICAgICAgICAgICAgImRlZyk7bGVmdDoiICsKICAgICAgICAgICAgICAgIG9yaWdYICsKICAgICAgICAgICAgICAgICJweDt0b3A6IiArCiAgICAgICAgICAgICAgICBvcmlnWSArCiAgICAgICAgICAgICAgICAicHg7IjsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoIUdhbWUuU2VsZWN0ZWRIZWF2ZW5seVVwZ3JhZGUpIHsKICAgICAgICAgIEdhbWUuQXNjZW5kT2ZmWFQgKz0KICAgICAgICAgICAgKEdhbWUubW91c2VYIC0gR2FtZS5Bc2NlbmREcmFnWCkgKiAoMSAvIEdhbWUuQXNjZW5kWm9vbVQpOwogICAgICAgICAgR2FtZS5Bc2NlbmRPZmZZVCArPQogICAgICAgICAgICAoR2FtZS5tb3VzZVkgLSBHYW1lLkFzY2VuZERyYWdZKSAqICgxIC8gR2FtZS5Bc2NlbmRab29tVCk7CiAgICAgICAgfQogICAgICAgIEdhbWUuQXNjZW5kRHJhZ1ggPSBHYW1lLm1vdXNlWDsKICAgICAgICBHYW1lLkFzY2VuZERyYWdZID0gR2FtZS5tb3VzZVk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLyppZiAoR2FtZS5TZWxlY3RlZEhlYXZlbmx5VXBncmFkZSkKCQkJCXsKCQkJCQl2YXIgbWU9R2FtZS5TZWxlY3RlZEhlYXZlbmx5VXBncmFkZTsKCQkJCQltZS5wb3NYPU1hdGgucm91bmQobWUucG9zWC9HYW1lLkFzY2VuZEdyaWRTbmFwKSpHYW1lLkFzY2VuZEdyaWRTbmFwOwoJCQkJCW1lLnBvc1k9TWF0aC5yb3VuZChtZS5wb3NZL0dhbWUuQXNjZW5kR3JpZFNuYXApKkdhbWUuQXNjZW5kR3JpZFNuYXA7CgkJCQkJbCgnaGVhdmVubHlVcGdyYWRlJyttZS5pZCkuc3R5bGUubGVmdD1tZS5wb3NYKydweCc7CgkJCQkJbCgnaGVhdmVubHlVcGdyYWRlJyttZS5pZCkuc3R5bGUudG9wPW1lLnBvc1krJ3B4JzsKCQkJCX0qLwogICAgICAgIEdhbWUuQXNjZW5kRHJhZ2dpbmcgPSAwOwogICAgICAgIEdhbWUuU2VsZWN0ZWRIZWF2ZW5seVVwZ3JhZGUgPSAwOwogICAgICB9CiAgICAgIGlmIChHYW1lLkNsaWNrIHx8IEdhbWUucHJvbXB0T24pIHsKICAgICAgICBHYW1lLkFzY2VuZERyYWdnaW5nID0gMDsKICAgICAgfQoKICAgICAgLy9HYW1lLmFzY2VuZGwuc3R5bGUuYmFja2dyb3VuZFBvc2l0aW9uPU1hdGguZmxvb3IoR2FtZS5Bc2NlbmRPZmZYLzIpKydweCAnK01hdGguZmxvb3IoR2FtZS5Bc2NlbmRPZmZZLzIpKydweCc7CiAgICAgIC8vR2FtZS5hc2NlbmRsLnN0eWxlLmJhY2tncm91bmRQb3NpdGlvbj1NYXRoLmZsb29yKEdhbWUuQXNjZW5kT2ZmWC8yKSsncHggJytNYXRoLmZsb29yKEdhbWUuQXNjZW5kT2ZmWS8yKSsncHgsJytNYXRoLmZsb29yKEdhbWUuQXNjZW5kT2ZmWC80KSsncHggJytNYXRoLmZsb29yKEdhbWUuQXNjZW5kT2ZmWS80KSsncHgnOwogICAgICAvL0dhbWUuYXNjZW5kQ29udGVudGwuc3R5bGUubGVmdD1NYXRoLmZsb29yKEdhbWUuQXNjZW5kT2ZmWCkrJ3B4JzsKICAgICAgLy9HYW1lLmFzY2VuZENvbnRlbnRsLnN0eWxlLnRvcD1NYXRoLmZsb29yKEdhbWUuQXNjZW5kT2ZmWSkrJ3B4JzsKICAgICAgR2FtZS5hc2NlbmRDb250ZW50bC5zdHlsZS53ZWJraXRUcmFuc2Zvcm0gPQogICAgICAgICJ0cmFuc2xhdGUoIiArCiAgICAgICAgTWF0aC5mbG9vcihHYW1lLkFzY2VuZE9mZlgpICsKICAgICAgICAicHgsIiArCiAgICAgICAgTWF0aC5mbG9vcihHYW1lLkFzY2VuZE9mZlkpICsKICAgICAgICAicHgpIjsKICAgICAgR2FtZS5hc2NlbmRDb250ZW50bC5zdHlsZS5tc1RyYW5zZm9ybSA9CiAgICAgICAgInRyYW5zbGF0ZSgiICsKICAgICAgICBNYXRoLmZsb29yKEdhbWUuQXNjZW5kT2ZmWCkgKwogICAgICAgICJweCwiICsKICAgICAgICBNYXRoLmZsb29yKEdhbWUuQXNjZW5kT2ZmWSkgKwogICAgICAgICJweCkiOwogICAgICBHYW1lLmFzY2VuZENvbnRlbnRsLnN0eWxlLm9UcmFuc2Zvcm0gPQogICAgICAgICJ0cmFuc2xhdGUoIiArCiAgICAgICAgTWF0aC5mbG9vcihHYW1lLkFzY2VuZE9mZlgpICsKICAgICAgICAicHgsIiArCiAgICAgICAgTWF0aC5mbG9vcihHYW1lLkFzY2VuZE9mZlkpICsKICAgICAgICAicHgpIjsKICAgICAgR2FtZS5hc2NlbmRDb250ZW50bC5zdHlsZS5tb3pUcmFuc2Zvcm0gPQogICAgICAgICJ0cmFuc2xhdGUoIiArCiAgICAgICAgTWF0aC5mbG9vcihHYW1lLkFzY2VuZE9mZlgpICsKICAgICAgICAicHgsIiArCiAgICAgICAgTWF0aC5mbG9vcihHYW1lLkFzY2VuZE9mZlkpICsKICAgICAgICAicHgpIjsKICAgICAgR2FtZS5hc2NlbmRDb250ZW50bC5zdHlsZS50cmFuc2Zvcm0gPQogICAgICAgICJ0cmFuc2xhdGUoIiArCiAgICAgICAgTWF0aC5mbG9vcihHYW1lLkFzY2VuZE9mZlgpICsKICAgICAgICAicHgsIiArCiAgICAgICAgTWF0aC5mbG9vcihHYW1lLkFzY2VuZE9mZlkpICsKICAgICAgICAicHgpIjsKICAgICAgR2FtZS5hc2NlbmRab29tYWJsZWwuc3R5bGUud2Via2l0VHJhbnNmb3JtID0KICAgICAgICAic2NhbGUoIiArIEdhbWUuQXNjZW5kWm9vbSArICIsIiArIEdhbWUuQXNjZW5kWm9vbSArICIpIjsKICAgICAgR2FtZS5hc2NlbmRab29tYWJsZWwuc3R5bGUubWFyZ2luTGVmdCA9IEdhbWUud2luZG93VyAvIDIgKyAicHgiOwogICAgICBHYW1lLmFzY2VuZFpvb21hYmxlbC5zdHlsZS5tYXJnaW5Ub3AgPSBHYW1lLndpbmRvd0ggLyAyICsgInB4IjsKICAgICAgR2FtZS5hc2NlbmRab29tYWJsZWwuc3R5bGUubXNUcmFuc2Zvcm0gPQogICAgICAgICJzY2FsZSgiICsgR2FtZS5Bc2NlbmRab29tICsgIiwiICsgR2FtZS5Bc2NlbmRab29tICsgIikiOwogICAgICBHYW1lLmFzY2VuZFpvb21hYmxlbC5zdHlsZS5vVHJhbnNmb3JtID0KICAgICAgICAic2NhbGUoIiArIEdhbWUuQXNjZW5kWm9vbSArICIsIiArIEdhbWUuQXNjZW5kWm9vbSArICIpIjsKICAgICAgR2FtZS5hc2NlbmRab29tYWJsZWwuc3R5bGUubW96VHJhbnNmb3JtID0KICAgICAgICAic2NhbGUoIiArIEdhbWUuQXNjZW5kWm9vbSArICIsIiArIEdhbWUuQXNjZW5kWm9vbSArICIpIjsKICAgICAgR2FtZS5hc2NlbmRab29tYWJsZWwuc3R5bGUudHJhbnNmb3JtID0KICAgICAgICAic2NhbGUoIiArIEdhbWUuQXNjZW5kWm9vbSArICIsIiArIEdhbWUuQXNjZW5kWm9vbSArICIpIjsKCiAgICAgIC8vaWYgKEdhbWUuU2Nyb2xsIT0wKSBHYW1lLmFzY2VuZENvbnRlbnRsLnN0eWxlLnRyYW5zZm9ybU9yaWdpbj1NYXRoLmZsb29yKEdhbWUud2luZG93Vy8yLUdhbWUubW91c2VYKSsncHggJytNYXRoLmZsb29yKEdhbWUud2luZG93SC8yLUdhbWUubW91c2VZKSsncHgnOwogICAgICBpZiAoR2FtZS5TY3JvbGwgPCAwICYmICFHYW1lLnByb21wdE9uKSB7CiAgICAgICAgR2FtZS5Bc2NlbmRab29tVCA9IDAuNTsKICAgICAgfQogICAgICBpZiAoR2FtZS5TY3JvbGwgPiAwICYmICFHYW1lLnByb21wdE9uKSB7CiAgICAgICAgR2FtZS5Bc2NlbmRab29tVCA9IDE7CiAgICAgIH0KCiAgICAgIGlmIChHYW1lLlQgJSAyID09IDApIHsKICAgICAgICBsKCJhc2NlbmRQcmVzdGlnZSIpLmlubmVySFRNTCA9CiAgICAgICAgICBsb2MoIlByZXN0aWdlIGxldmVsOiIpICsgIjxicj4iICsgU2ltcGxlQmVhdXRpZnkoR2FtZS5wcmVzdGlnZSk7CiAgICAgICAgbCgiYXNjZW5kSENzIikuaW5uZXJIVE1MID0KICAgICAgICAgIGxvYygiSGVhdmVubHkgY2hpcHM6IikgKwogICAgICAgICAgJzxicj48c3BhbiBjbGFzcz0icHJpY2UgaGVhdmVubHkiPicgKwogICAgICAgICAgU2ltcGxlQmVhdXRpZnkoTWF0aC5yb3VuZChHYW1lLmhlYXZlbmx5Q2hpcHNEaXNwbGF5ZWQpKSArCiAgICAgICAgICAiPC9zcGFuPiI7CiAgICAgICAgaWYgKEdhbWUucHJlc3RpZ2UgPiAwKSBsKCJhc2NlbmRNb2RlQnV0dG9uIikuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgICAgZWxzZSBsKCJhc2NlbmRNb2RlQnV0dG9uIikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgfQogICAgICBHYW1lLmhlYXZlbmx5Q2hpcHNEaXNwbGF5ZWQgKz0KICAgICAgICAoR2FtZS5oZWF2ZW5seUNoaXBzIC0gR2FtZS5oZWF2ZW5seUNoaXBzRGlzcGxheWVkKSAqIDAuNDsKCiAgICAgIGlmIChHYW1lLkRlYnVnZ2luZ1ByZXN0aWdlICYmIEdhbWUuVCAlIDEwID09IDApIHsKICAgICAgICB2YXIgc3RyID0gIiI7CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlByZXN0aWdlVXBncmFkZXMpIHsKICAgICAgICAgIHZhciBtZSA9IEdhbWUuUHJlc3RpZ2VVcGdyYWRlc1tpXTsKICAgICAgICAgIGlmIChtZS5wbGFjZWRCeUNvZGUpIGNvbnRpbnVlOwogICAgICAgICAgc3RyICs9CiAgICAgICAgICAgIG1lLmlkICsKICAgICAgICAgICAgIjpbIiArCiAgICAgICAgICAgIE1hdGguZmxvb3IobWUucG9zWCkgKwogICAgICAgICAgICAiLCIgKwogICAgICAgICAgICBNYXRoLmZsb29yKG1lLnBvc1kpICsKICAgICAgICAgICAgIl0sIjsKICAgICAgICB9CiAgICAgICAgbCgidXBncmFkZVBvc2l0aW9ucyIpLnZhbHVlID0gIkdhbWUuVXBncmFkZVBvc2l0aW9ucz17IiArIHN0ciArICJ9OyI7CiAgICAgIH0KICAgICAgLy9pZiAoR2FtZS5UJTU9PTApIEdhbWUuQnVpbGRBc2NlbmRUcmVlKCk7CiAgICB9OwogICAgR2FtZS5Bc2NlbmRSZWZvY3VzID0gZnVuY3Rpb24gKCkgewogICAgICBHYW1lLkFzY2VuZE9mZlggPSAwOwogICAgICBHYW1lLkFzY2VuZE9mZlkgPSAwOwogICAgICBHYW1lLmFzY2VuZGwuY2xhc3NOYW1lID0gIiI7CiAgICB9OwoKICAgIEdhbWUuU2VsZWN0ZWRIZWF2ZW5seVVwZ3JhZGUgPSAwOwogICAgR2FtZS5QdXJjaGFzZUhlYXZlbmx5VXBncmFkZSA9IGZ1bmN0aW9uICh3aGF0KSB7CiAgICAgIC8vaWYgKEdhbWUuSGFzKCdOZXVyb21hbmN5JykpIEdhbWUuVXBncmFkZXNCeUlkW3doYXRdLnRvZ2dsZSgpOyBlbHNlCiAgICAgIGlmIChHYW1lLlVwZ3JhZGVzQnlJZFt3aGF0XS5idXkoKSkgewogICAgICAgIGlmIChsKCJoZWF2ZW5seVVwZ3JhZGUiICsgd2hhdCkpIHsKICAgICAgICAgIHZhciByZWN0ID0gbCgiaGVhdmVubHlVcGdyYWRlIiArIHdoYXQpLmdldEJvdW5kcygpOwogICAgICAgICAgR2FtZS5TcGFya2xlQXQoCiAgICAgICAgICAgIChyZWN0LmxlZnQgKyByZWN0LnJpZ2h0KSAvIDIsCiAgICAgICAgICAgIChyZWN0LnRvcCArIHJlY3QuYm90dG9tKSAvIDIgLSAyNAogICAgICAgICAgKTsKICAgICAgICB9CiAgICAgICAgLy9HYW1lLkJ1aWxkQXNjZW5kVHJlZSgpOwogICAgICB9CiAgICB9OwogICAgR2FtZS5CdWlsZEFzY2VuZFRyZWUgPSBmdW5jdGlvbiAoanVzdEJvdWdodCkgewogICAgICB2YXIgc3RyID0gIiI7CiAgICAgIEdhbWUuaGVhdmVubHlCb3VuZHMgPSB7IGxlZnQ6IDAsIHJpZ2h0OiAwLCB0b3A6IDAsIGJvdHRvbTogMCB9OwoKICAgICAgaWYgKEdhbWUuRGVidWdnaW5nUHJlc3RpZ2UpIGwoInVwZ3JhZGVQb3NpdGlvbnMiKS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgZWxzZSBsKCJ1cGdyYWRlUG9zaXRpb25zIikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKCiAgICAgIHZhciB0b1BvcCA9IFtdOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUuUHJlc3RpZ2VVcGdyYWRlcykgewogICAgICAgIHZhciBtZSA9IEdhbWUuUHJlc3RpZ2VVcGdyYWRlc1tpXTsKICAgICAgICB2YXIgcHJldkNhbkJlUHVyY2hhc2VkID0gbWUuY2FuQmVQdXJjaGFzZWQ7CiAgICAgICAgbWUuY2FuQmVQdXJjaGFzZWQgPSAxOwogICAgICAgIGlmICghbWUuYm91Z2h0ICYmICFHYW1lLkRlYnVnZ2luZ1ByZXN0aWdlKSB7CiAgICAgICAgICBpZiAobWUuc2hvd0lmICYmICFtZS5zaG93SWYoKSkgbWUuY2FuQmVQdXJjaGFzZWQgPSAwOwogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGZvciAodmFyIGlpIGluIG1lLnBhcmVudHMpIHsKICAgICAgICAgICAgICBpZiAobWUucGFyZW50c1tpaV0gIT0gLTEgJiYgIW1lLnBhcmVudHNbaWldLmJvdWdodCkKICAgICAgICAgICAgICAgIG1lLmNhbkJlUHVyY2hhc2VkID0gMDsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoCiAgICAgICAgICBqdXN0Qm91Z2h0ICYmCiAgICAgICAgICBtZS5wYXJlbnRzLmluZGV4T2YoanVzdEJvdWdodCkgIT0gLTEgJiYKICAgICAgICAgICFwcmV2Q2FuQmVQdXJjaGFzZWQgJiYKICAgICAgICAgIG1lLmNhbkJlUHVyY2hhc2VkICYmCiAgICAgICAgICAhbWUuYm91Z2h0CiAgICAgICAgKQogICAgICAgICAgdG9Qb3AucHVzaChtZSk7CiAgICAgIH0KICAgICAgdG9Qb3Auc29ydCgKICAgICAgICAoZnVuY3Rpb24gKHBhcmVudCkgewogICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgICAgIHZhciByb3QgPQogICAgICAgICAgICAgIE1hdGguYXRhbjIoYS5wb3NZIC0gcGFyZW50LnBvc1ksIHBhcmVudC5wb3NYIC0gYS5wb3NYKSAtCiAgICAgICAgICAgICAgTWF0aC5QSSAvIDI7CiAgICAgICAgICAgIHZhciByb3QyID0KICAgICAgICAgICAgICBNYXRoLmF0YW4yKGIucG9zWSAtIHBhcmVudC5wb3NZLCBwYXJlbnQucG9zWCAtIGIucG9zWCkgLQogICAgICAgICAgICAgIE1hdGguUEkgLyAyOwogICAgICAgICAgICByZXR1cm4gcm90IDwgcm90MjsKICAgICAgICAgIH07CiAgICAgICAgfSkoanVzdEJvdWdodCkKICAgICAgKTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b1BvcC5sZW5ndGg7IGkrKykgewogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgUGxheVNvdW5kKAogICAgICAgICAgICAic25kL3BvcCIgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAzICsgMSkgKyAiLm1wMyIsCiAgICAgICAgICAgIDAuNQogICAgICAgICAgKTsKICAgICAgICB9LCAoMC4yICsgaSAqIDAuMSkgKiAxMDAwKTsKICAgICAgfQogICAgICBzdHIgKz0KICAgICAgICAnPGRpdiBjbGFzcz0iY3JhdGUgdXBncmFkZSBoZWF2ZW5seSBlbmFibGVkIiBzdHlsZT0icG9zaXRpb246YWJzb2x1dGU7bGVmdDotMzBweDt0b3A6LTMwcHg7b3BhY2l0eTowLjg7cG9pbnRlci1ldmVudHM6bm9uZTt0cmFuc2Zvcm06c2NhbGUoMS4zKTtiYWNrZ3JvdW5kOnRyYW5zcGFyZW50OyI+PC9kaXY+JzsKICAgICAgc3RyICs9ICc8ZGl2IGNsYXNzPSJjcmF0ZUJveCIgc3R5bGU9ImZpbHRlcjpub25lOy13ZWJraXQtZmlsdGVyOm5vbmU7Ij4nOyAvL2Nocm9tZSBpcyBzdGlsbCBiYWQgYXQgdGhlc2UKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlByZXN0aWdlVXBncmFkZXMpIHsKICAgICAgICB2YXIgbWUgPSBHYW1lLlByZXN0aWdlVXBncmFkZXNbaV07CgogICAgICAgIHZhciBnaG9zdGVkID0gMDsKICAgICAgICBpZiAobWUuY2FuQmVQdXJjaGFzZWQgfHwgR2FtZS5IYXMoIk5ldXJvbWFuY3kiKSkgewogICAgICAgICAgc3RyICs9IEdhbWUuY3JhdGUoCiAgICAgICAgICAgIG1lLAogICAgICAgICAgICAiYXNjZW5kIiwKICAgICAgICAgICAgIkdhbWUuUHVyY2hhc2VIZWF2ZW5seVVwZ3JhZGUoIiArIG1lLmlkICsgIik7IiwKICAgICAgICAgICAgImhlYXZlbmx5VXBncmFkZSIgKyBtZS5pZCwKICAgICAgICAgICAgdG9Qb3AuaW5kZXhPZihtZSkgIT0gLTEKICAgICAgICAgICAgICA/ICJhbmltYXRpb246cHVja2VyIDAuMnMgZWFzZS1vdXQ7YW5pbWF0aW9uLWRlbGF5OiIgKwogICAgICAgICAgICAgICAgICAodG9Qb3AuaW5kZXhPZihtZSkgKiAwLjEgKyAwLjIpICsKICAgICAgICAgICAgICAgICAgInM7IgogICAgICAgICAgICAgIDogIiIKICAgICAgICAgICk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGZvciAodmFyIGlpIGluIG1lLnBhcmVudHMpIHsKICAgICAgICAgICAgaWYgKG1lLnBhcmVudHNbaWldICE9IC0xICYmIG1lLnBhcmVudHNbaWldLmNhbkJlUHVyY2hhc2VkKQogICAgICAgICAgICAgIGdob3N0ZWQgPSAxOwogICAgICAgICAgfQogICAgICAgICAgaWYgKG1lLnNob3dJZiAmJiAhbWUuc2hvd0lmKCkpIGdob3N0ZWQgPSAwOwogICAgICAgICAgaWYgKGdob3N0ZWQpIHsKICAgICAgICAgICAgLy9tYXliZSByZXBsYWNlIHRoaXMgd2l0aCBHYW1lLmNyYXRlKCkKICAgICAgICAgICAgc3RyICs9CiAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImNyYXRlIHVwZ3JhZGUgaGVhdmVubHkgZ2hvc3RlZCIgaWQ9ImhlYXZlbmx5VXBncmFkZScgKwogICAgICAgICAgICAgIG1lLmlkICsKICAgICAgICAgICAgICAnIiBzdHlsZT0icG9zaXRpb246YWJzb2x1dGU7bGVmdDonICsKICAgICAgICAgICAgICBtZS5wb3NYICsKICAgICAgICAgICAgICAicHg7dG9wOiIgKwogICAgICAgICAgICAgIG1lLnBvc1kgKwogICAgICAgICAgICAgICJweDsiICsKICAgICAgICAgICAgICB3cml0ZUljb24obWUuaWNvbikgKwogICAgICAgICAgICAgICciPjwvZGl2Pic7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChtZS5jYW5CZVB1cmNoYXNlZCB8fCBHYW1lLkhhcygiTmV1cm9tYW5jeSIpIHx8IGdob3N0ZWQpIHsKICAgICAgICAgIGlmIChtZS5wb3NYIDwgR2FtZS5oZWF2ZW5seUJvdW5kcy5sZWZ0KQogICAgICAgICAgICBHYW1lLmhlYXZlbmx5Qm91bmRzLmxlZnQgPSBtZS5wb3NYOwogICAgICAgICAgaWYgKG1lLnBvc1ggPiBHYW1lLmhlYXZlbmx5Qm91bmRzLnJpZ2h0KQogICAgICAgICAgICBHYW1lLmhlYXZlbmx5Qm91bmRzLnJpZ2h0ID0gbWUucG9zWDsKICAgICAgICAgIGlmIChtZS5wb3NZIDwgR2FtZS5oZWF2ZW5seUJvdW5kcy50b3ApCiAgICAgICAgICAgIEdhbWUuaGVhdmVubHlCb3VuZHMudG9wID0gbWUucG9zWTsKICAgICAgICAgIGlmIChtZS5wb3NZID4gR2FtZS5oZWF2ZW5seUJvdW5kcy5ib3R0b20pCiAgICAgICAgICAgIEdhbWUuaGVhdmVubHlCb3VuZHMuYm90dG9tID0gbWUucG9zWTsKICAgICAgICB9CiAgICAgICAgZm9yICh2YXIgaWkgaW4gbWUucGFyZW50cykgeyAvL2NyZWF0ZSBwdWxzaW5nIGxpbmtzCiAgICAgICAgICBpZiAobWUucGFyZW50c1tpaV0gIT0gLTEgJiYgKG1lLmNhbkJlUHVyY2hhc2VkIHx8IGdob3N0ZWQpKSB7CiAgICAgICAgICAgIHZhciBvcmlnWCA9IDA7CiAgICAgICAgICAgIHZhciBvcmlnWSA9IDA7CiAgICAgICAgICAgIHZhciB0YXJnWCA9IG1lLnBvc1ggKyAyODsKICAgICAgICAgICAgdmFyIHRhcmdZID0gbWUucG9zWSArIDI4OwogICAgICAgICAgICBpZiAobWUucGFyZW50c1tpaV0gIT0gLTEpIHsKICAgICAgICAgICAgICBvcmlnWCA9IG1lLnBhcmVudHNbaWldLnBvc1ggKyAyODsKICAgICAgICAgICAgICBvcmlnWSA9IG1lLnBhcmVudHNbaWldLnBvc1kgKyAyODsKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgcm90ID0KICAgICAgICAgICAgICAtKE1hdGguYXRhbigodGFyZ1kgLSBvcmlnWSkgLyAob3JpZ1ggLSB0YXJnWCkpIC8gTWF0aC5QSSkgKiAxODA7CiAgICAgICAgICAgIGlmICh0YXJnWCA8PSBvcmlnWCkgcm90ICs9IDE4MDsKICAgICAgICAgICAgdmFyIGRpc3QgPSBNYXRoLmZsb29yKAogICAgICAgICAgICAgIE1hdGguc3FydCgKICAgICAgICAgICAgICAgICh0YXJnWCAtIG9yaWdYKSAqICh0YXJnWCAtIG9yaWdYKSArCiAgICAgICAgICAgICAgICAgICh0YXJnWSAtIG9yaWdZKSAqICh0YXJnWSAtIG9yaWdZKQogICAgICAgICAgICAgICkKICAgICAgICAgICAgKTsKICAgICAgICAgICAgc3RyICs9CiAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9InBhcmVudExpbmsiIGlkPSJoZWF2ZW5seUxpbmsnICsKICAgICAgICAgICAgICBtZS5pZCArCiAgICAgICAgICAgICAgIi0iICsKICAgICAgICAgICAgICBpaSArCiAgICAgICAgICAgICAgJyIgc3R5bGU9IicgKwogICAgICAgICAgICAgIChnaG9zdGVkID8gIm9wYWNpdHk6MC4xOyIgOiAiIikgKwogICAgICAgICAgICAgICJ3aWR0aDoiICsKICAgICAgICAgICAgICBkaXN0ICsKICAgICAgICAgICAgICAicHg7LXdlYmtpdC10cmFuc2Zvcm06cm90YXRlKCIgKwogICAgICAgICAgICAgIHJvdCArCiAgICAgICAgICAgICAgImRlZyk7LW1vei10cmFuc2Zvcm06cm90YXRlKCIgKwogICAgICAgICAgICAgIHJvdCArCiAgICAgICAgICAgICAgImRlZyk7LW1zLXRyYW5zZm9ybTpyb3RhdGUoIiArCiAgICAgICAgICAgICAgcm90ICsKICAgICAgICAgICAgICAiZGVnKTstby10cmFuc2Zvcm06cm90YXRlKCIgKwogICAgICAgICAgICAgIHJvdCArCiAgICAgICAgICAgICAgImRlZyk7dHJhbnNmb3JtOnJvdGF0ZSgiICsKICAgICAgICAgICAgICByb3QgKwogICAgICAgICAgICAgICJkZWcpO2xlZnQ6IiArCiAgICAgICAgICAgICAgb3JpZ1ggKwogICAgICAgICAgICAgICJweDt0b3A6IiArCiAgICAgICAgICAgICAgb3JpZ1kgKwogICAgICAgICAgICAgICdweDsiPjwvZGl2Pic7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIEdhbWUuaGVhdmVubHlCb3VuZHMubGVmdCAtPSAxMjg7CiAgICAgIEdhbWUuaGVhdmVubHlCb3VuZHMudG9wIC09IDEyODsKICAgICAgR2FtZS5oZWF2ZW5seUJvdW5kcy5yaWdodCArPSAxMjggKyA2NDsKICAgICAgR2FtZS5oZWF2ZW5seUJvdW5kcy5ib3R0b20gKz0gMTI4ICsgNjQ7CiAgICAgIC8vc3RyKz0nPGRpdiBzdHlsZT0iYm9yZGVyOjFweCBzb2xpZCByZWQ7cG9zaXRpb246YWJzb2x1dGU7bGVmdDonK0dhbWUuaGVhdmVubHlCb3VuZHMubGVmdCsncHg7d2lkdGg6JysoR2FtZS5oZWF2ZW5seUJvdW5kcy5yaWdodC1HYW1lLmhlYXZlbmx5Qm91bmRzLmxlZnQpKydweDt0b3A6JytHYW1lLmhlYXZlbmx5Qm91bmRzLnRvcCsncHg7aGVpZ2h0OicrKEdhbWUuaGVhdmVubHlCb3VuZHMuYm90dG9tLUdhbWUuaGVhdmVubHlCb3VuZHMudG9wKSsncHg7Ij48L2Rpdj4nOwogICAgICBzdHIgKz0gIjwvZGl2PiI7CiAgICAgIEdhbWUuYXNjZW5kVXBncmFkZXNsLmlubmVySFRNTCA9IHN0cjsKCiAgICAgIGlmIChHYW1lLkRlYnVnZ2luZ1ByZXN0aWdlKSB7CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlByZXN0aWdlVXBncmFkZXMpIHsKICAgICAgICAgIHZhciBtZSA9IEdhbWUuUHJlc3RpZ2VVcGdyYWRlc1tpXTsKICAgICAgICAgIEFkZEV2ZW50KAogICAgICAgICAgICBsKCJoZWF2ZW5seVVwZ3JhZGUiICsgbWUuaWQpLAogICAgICAgICAgICAibW91c2Vkb3duIiwKICAgICAgICAgICAgKGZ1bmN0aW9uIChtZSkgewogICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBpZiAoIUdhbWUuRGVidWdnaW5nUHJlc3RpZ2UpIHJldHVybjsKICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgR2FtZS5rZXlzWzE2XSAmJgogICAgICAgICAgICAgICAgICB0eXBlb2YgTEFTVEhFQVZFTkxZU0VMRUNURUQgIT09ICJ1bmRlZmluZWQiICYmCiAgICAgICAgICAgICAgICAgIG1lICE9IExBU1RIRUFWRU5MWVNFTEVDVEVECiAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgLy93aGVuIGNsaWNraW5nIGFuIHVwZ3JhZGUgd2l0aCBjdHJsLCBzZXQgaXQgYXMgcmVmZXJlbmNlIHBvaW50OyBjbGlja2luZyBhbnkgc2libGluZyB1cGdyYWRlIHdpdGggc2hpZnQgd2lsbCBhbGlnbiBpdCBpbiBhIG5pY2UgYXJjIGFyb3VuZCB0aGVpciBzaGFyZWQgcGFyZW50CiAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSAwOwogICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1lLnBhcmVudHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgICBMQVNUSEVBVkVOTFlTRUxFQ1RFRC5wYXJlbnRzLmluZGV4T2YobWUucGFyZW50c1tpXSkgIT0gLTEKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQgPSBtZS5wYXJlbnRzW2ldOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnQpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgb3JpZ1ggPSBwYXJlbnQucG9zWDsKICAgICAgICAgICAgICAgICAgICB2YXIgb3JpZ1kgPSBwYXJlbnQucG9zWTsKICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ1ggPSBMQVNUSEVBVkVOTFlTRUxFQ1RFRC5wb3NYOwogICAgICAgICAgICAgICAgICAgIHZhciB0YXJnWSA9IExBU1RIRUFWRU5MWVNFTEVDVEVELnBvc1k7CiAgICAgICAgICAgICAgICAgICAgdmFyIHJvdCA9CiAgICAgICAgICAgICAgICAgICAgICBNYXRoLmF0YW4yKHRhcmdZIC0gb3JpZ1ksIG9yaWdYIC0gdGFyZ1gpIC0gTWF0aC5QSSAvIDI7CiAgICAgICAgICAgICAgICAgICAgdmFyIGRpc3QgPSBNYXRoLmZsb29yKAogICAgICAgICAgICAgICAgICAgICAgTWF0aC5zcXJ0KAogICAgICAgICAgICAgICAgICAgICAgICAodGFyZ1ggLSBvcmlnWCkgKiAodGFyZ1ggLSBvcmlnWCkgKwogICAgICAgICAgICAgICAgICAgICAgICAgICh0YXJnWSAtIG9yaWdZKSAqICh0YXJnWSAtIG9yaWdZKQogICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgbWUucG9zWCA9CiAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQucG9zWCArIE1hdGguc2luKHJvdCAtIChNYXRoLlBJICogMikgLyA4KSAqIGRpc3Q7CiAgICAgICAgICAgICAgICAgICAgbWUucG9zWSA9CiAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQucG9zWSArIE1hdGguY29zKHJvdCAtIChNYXRoLlBJICogMikgLyA4KSAqIGRpc3Q7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgTEFTVEhFQVZFTkxZU0VMRUNURUQgPSBtZTsKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIlNldCByZWZlcmVuY2UgcG9pbnQgdG8iLCBtZS5uYW1lLCAiLiIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKEdhbWUua2V5c1sxN10pIHsKICAgICAgICAgICAgICAgICAgTEFTVEhFQVZFTkxZU0VMRUNURUQgPSBtZTsKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIlNldCByZWZlcmVuY2UgcG9pbnQgdG8iLCBtZS5uYW1lLCAiLiIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgR2FtZS5TZWxlY3RlZEhlYXZlbmx5VXBncmFkZSA9IG1lOwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0pKG1lKQogICAgICAgICAgKTsKICAgICAgICAgIEFkZEV2ZW50KAogICAgICAgICAgICBsKCJoZWF2ZW5seVVwZ3JhZGUiICsgbWUuaWQpLAogICAgICAgICAgICAibW91c2V1cCIsCiAgICAgICAgICAgIChmdW5jdGlvbiAobWUpIHsKICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgaWYgKEdhbWUuU2VsZWN0ZWRIZWF2ZW5seVVwZ3JhZGUgPT0gbWUpIHsKICAgICAgICAgICAgICAgICAgR2FtZS5TZWxlY3RlZEhlYXZlbmx5VXBncmFkZSA9IDA7CiAgICAgICAgICAgICAgICAgIEdhbWUuQnVpbGRBc2NlbmRUcmVlKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfSkobWUpCiAgICAgICAgICApOwogICAgICAgIH0KICAgICAgfQogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLnRvb2x0aXAuc2hvdWxkSGlkZSA9IHRydWU7CiAgICAgIH0sIDEwMCk7CiAgICB9OwoKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJCUNPQUxFU0NJTkcgU1VHQVIgTFVNUFMKCQk9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgR2FtZS5sdW1wTWF0dXJlQWdlID0gMTsKICAgIEdhbWUubHVtcFJpcGVBZ2UgPSAxOwogICAgR2FtZS5sdW1wT3ZlcnJpcGVBZ2UgPSAxOwogICAgR2FtZS5sdW1wQ3VycmVudFR5cGUgPSAwOwogICAgbCgiY29tbWVudHMiKS5pbm5lckhUTUwgPQogICAgICBsKCJjb21tZW50cyIpLmlubmVySFRNTCArCiAgICAgICc8ZGl2IGlkPSJsdW1wcyIgb25jbGljaz0iR2FtZS5jbGlja0x1bXAoKTsiICcgKwogICAgICBHYW1lLmdldER5bmFtaWNUb29sdGlwKCJHYW1lLmx1bXBUb29sdGlwIiwgImJvdHRvbSIpICsKICAgICAgJz48ZGl2IGlkPSJsdW1wc0ljb24iIGNsYXNzPSJ1c2VzSWNvbiI+PC9kaXY+PGRpdiBpZD0ibHVtcHNJY29uMiIgY2xhc3M9InVzZXNJY29uIj48L2Rpdj48ZGl2IGlkPSJsdW1wc0Ftb3VudCI+MDwvZGl2PjwvZGl2Pic7CiAgICBHYW1lLmx1bXBUb29sdGlwID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgc3RyID0KICAgICAgICAnPGRpdiBzdHlsZT0icGFkZGluZzo4cHg7d2lkdGg6NDAwcHg7Zm9udC1zaXplOjExcHg7dGV4dC1hbGlnbjpjZW50ZXI7IiBpZD0idG9vbHRpcEx1bXBzIj4nICsKICAgICAgICBsb2MoCiAgICAgICAgICAiWW91IGhhdmUgJTEuIiwKICAgICAgICAgICc8c3BhbiBjbGFzcz0icHJpY2UgbHVtcCI+JyArCiAgICAgICAgICAgIGxvYygiJTEgc3VnYXIgbHVtcCIsIExCZWF1dGlmeShHYW1lLmx1bXBzKSkgKwogICAgICAgICAgICAiPC9zcGFuPiIKICAgICAgICApICsKICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgbG9jKAogICAgICAgICAgIkEgPGI+c3VnYXIgbHVtcDwvYj4gaXMgY29hbGVzY2luZyBoZXJlLCBhdHRyYWN0ZWQgYnkgeW91ciBhY2NvbXBsaXNobWVudHMuIgogICAgICAgICk7CgogICAgICB2YXIgYWdlID0gRGF0ZS5ub3coKSAtIEdhbWUubHVtcFQ7CiAgICAgIHN0ciArPSAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JzsKICAgICAgaWYgKGFnZSA8IDApCiAgICAgICAgc3RyICs9IGxvYygKICAgICAgICAgICJUaGlzIHN1Z2FyIGx1bXAgaGFzIGJlZW4gZXhwb3NlZCB0byB0aW1lIHRyYXZlbCBzaGVuYW5pZ2FucyBhbmQgd2lsbCB0YWtlIGFuIGV4Y3J1Y2lhdGluZyA8Yj4lMTwvYj4gdG8gcmVhY2ggbWF0dXJpdHkuIiwKICAgICAgICAgIEdhbWUuc2F5VGltZSgoKEdhbWUubHVtcE1hdHVyZUFnZSAtIGFnZSkgLyAxMDAwICsgMSkgKiBHYW1lLmZwcywgLTEpCiAgICAgICAgKTsKICAgICAgZWxzZSBpZiAoYWdlIDwgR2FtZS5sdW1wTWF0dXJlQWdlKQogICAgICAgIHN0ciArPSBsb2MoCiAgICAgICAgICAiVGhpcyBzdWdhciBsdW1wIGlzIHN0aWxsIGdyb3dpbmcgYW5kIHdpbGwgdGFrZSA8Yj4lMTwvYj4gdG8gcmVhY2ggbWF0dXJpdHkuIiwKICAgICAgICAgIEdhbWUuc2F5VGltZSgoKEdhbWUubHVtcE1hdHVyZUFnZSAtIGFnZSkgLyAxMDAwICsgMSkgKiBHYW1lLmZwcywgLTEpCiAgICAgICAgKTsKICAgICAgZWxzZSBpZiAoYWdlIDwgR2FtZS5sdW1wUmlwZUFnZSkKICAgICAgICBzdHIgKz0gbG9jKAogICAgICAgICAgIlRoaXMgc3VnYXIgbHVtcCBpcyBtYXR1cmUgYW5kIHdpbGwgYmUgcmlwZSBpbiA8Yj4lMTwvYj4uPGJyPllvdSBtYXkgPGI+Y2xpY2sgaXQgdG8gaGFydmVzdCBpdCBub3c8L2I+LCBidXQgdGhlcmUgaXMgYSA8Yj41MCUgY2hhbmNlIHlvdSB3b24ndCBnZXQgYW55dGhpbmc8L2I+LiIsCiAgICAgICAgICBHYW1lLnNheVRpbWUoKChHYW1lLmx1bXBSaXBlQWdlIC0gYWdlKSAvIDEwMDAgKyAxKSAqIEdhbWUuZnBzLCAtMSkKICAgICAgICApOwogICAgICBlbHNlIGlmIChhZ2UgPCBHYW1lLmx1bXBPdmVycmlwZUFnZSkKICAgICAgICBzdHIgKz0gbG9jKAogICAgICAgICAgIjxiPlRoaXMgc3VnYXIgbHVtcCBpcyByaXBlISBDbGljayBpdCB0byBoYXJ2ZXN0IGl0LjwvYj48YnI+SWYgeW91IGRvIG5vdGhpbmcsIGl0IHdpbGwgYXV0by1oYXJ2ZXN0IGluIDxiPiUxPC9iPi4iLAogICAgICAgICAgR2FtZS5zYXlUaW1lKCgoR2FtZS5sdW1wT3ZlcnJpcGVBZ2UgLSBhZ2UpIC8gMTAwMCArIDEpICogR2FtZS5mcHMsIC0xKQogICAgICAgICk7CgogICAgICB2YXIgcGhhc2UgPSAoYWdlIC8gR2FtZS5sdW1wT3ZlcnJpcGVBZ2UpICogNzsKICAgICAgaWYgKHBoYXNlID49IDMpIHsKICAgICAgICBpZiAoR2FtZS5sdW1wQ3VycmVudFR5cGUgIT0gMCkgc3RyICs9ICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nOwogICAgICAgIGlmIChHYW1lLmx1bXBDdXJyZW50VHlwZSA9PSAxKQogICAgICAgICAgc3RyICs9IGxvYygKICAgICAgICAgICAgIlRoaXMgc3VnYXIgbHVtcCBncmV3IHRvIGJlIDxiPmJpZnVyY2F0ZWQ8L2I+OyBoYXJ2ZXN0aW5nIGl0IGhhcyBhIDUwJSBjaGFuY2Ugb2YgeWllbGRpbmcgdHdvIGx1bXBzLiIKICAgICAgICAgICk7CiAgICAgICAgZWxzZSBpZiAoR2FtZS5sdW1wQ3VycmVudFR5cGUgPT0gMikKICAgICAgICAgIHN0ciArPSBsb2MoCiAgICAgICAgICAgICJUaGlzIHN1Z2FyIGx1bXAgZ3JldyB0byBiZSA8Yj5nb2xkZW48L2I+OyBoYXJ2ZXN0aW5nIGl0IHdpbGwgeWllbGQgMiB0byA3IGx1bXBzLCB5b3VyIGN1cnJlbnQgY29va2llcyB3aWxsIGJlIGRvdWJsZWQgKGNhcHBlZCB0byBhIGdhaW4gb2YgMjQgaG91cnMgb2YgeW91ciBDcFMpLCBhbmQgeW91IHdpbGwgZmluZCAxMCUgbW9yZSBnb2xkZW4gY29va2llcyBmb3IgdGhlIG5leHQgMjQgaG91cnMuIgogICAgICAgICAgKTsKICAgICAgICBlbHNlIGlmIChHYW1lLmx1bXBDdXJyZW50VHlwZSA9PSAzKQogICAgICAgICAgc3RyICs9IGxvYygKICAgICAgICAgICAgIlRoaXMgc3VnYXIgbHVtcCB3YXMgYWZmZWN0ZWQgYnkgdGhlIGVsZGVycyBhbmQgZ3JldyB0byBiZSA8Yj5tZWF0eTwvYj47IGhhcnZlc3RpbmcgaXQgd2lsbCB5aWVsZCBiZXR3ZWVuIDAgYW5kIDIgbHVtcHMuIgogICAgICAgICAgKTsKICAgICAgICBlbHNlIGlmIChHYW1lLmx1bXBDdXJyZW50VHlwZSA9PSA0KQogICAgICAgICAgc3RyICs9IGxvYygKICAgICAgICAgICAgIlRoaXMgc3VnYXIgbHVtcCBpcyA8Yj5jYXJhbWVsaXplZDwvYj4sIGl0cyBzdGlja2luZXNzIGJpbmRpbmcgaXQgdG8gdW5leHBlY3RlZCB0aGluZ3M7IGhhcnZlc3RpbmcgaXQgd2lsbCB5aWVsZCBiZXR3ZWVuIDEgYW5kIDMgbHVtcHMgYW5kIHdpbGwgcmVmaWxsIHlvdXIgc3VnYXIgbHVtcCBjb29sZG93bnMuIgogICAgICAgICAgKTsKICAgICAgfQoKICAgICAgc3RyICs9ICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nOwogICAgICBzdHIgKz0gbG9jKAogICAgICAgICJZb3VyIHN1Z2FyIGx1bXBzIG1hdHVyZSBhZnRlciA8Yj4lMTwvYj4sPGJyPnJpcGVuIGFmdGVyIDxiPiUyPC9iPiw8YnI+YW5kIGZhbGwgYWZ0ZXIgPGI+JTM8L2I+LiIsCiAgICAgICAgWwogICAgICAgICAgR2FtZS5zYXlUaW1lKChHYW1lLmx1bXBNYXR1cmVBZ2UgLyAxMDAwKSAqIEdhbWUuZnBzLCAtMSksCiAgICAgICAgICBHYW1lLnNheVRpbWUoKEdhbWUubHVtcFJpcGVBZ2UgLyAxMDAwKSAqIEdhbWUuZnBzLCAtMSksCiAgICAgICAgICBHYW1lLnNheVRpbWUoKEdhbWUubHVtcE92ZXJyaXBlQWdlIC8gMTAwMCkgKiBHYW1lLmZwcywgLTEpLAogICAgICAgIF0KICAgICAgKTsKCiAgICAgIHN0ciArPQogICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICBsb2MoCiAgICAgICAgICAiJmJ1bGw7IFN1Z2FyIGx1bXBzIGNhbiBiZSBoYXJ2ZXN0ZWQgd2hlbiBtYXR1cmUsIHRob3VnaCBpZiBsZWZ0IGFsb25lIGJleW9uZCB0aGF0IHBvaW50IHRoZXkgd2lsbCBzdGFydCByaXBlbmluZyAoaW5jcmVhc2luZyB0aGUgY2hhbmNlIG9mIGhhcnZlc3RpbmcgdGhlbSkgYW5kIHdpbGwgZXZlbnR1YWxseSBmYWxsIGFuZCBiZSBhdXRvLWhhcnZlc3RlZCBhZnRlciBzb21lIHRpbWUuPGJyPiZidWxsOyBTdWdhciBsdW1wcyBhcmUgZGVsaWNpb3VzIGFuZCBtYXkgYmUgdXNlZCBhcyBjdXJyZW5jeSBmb3IgYWxsIHNvcnRzIG9mIHRoaW5ncy48YnI+JmJ1bGw7IE9uY2UgYSBzdWdhciBsdW1wIGlzIGhhcnZlc3RlZCwgYW5vdGhlciBvbmUgd2lsbCBzdGFydCBncm93aW5nIGluIGl0cyBwbGFjZS48YnI+JmJ1bGw7IE5vdGUgdGhhdCBzdWdhciBsdW1wcyBrZWVwIGdyb3dpbmcgd2hlbiB0aGUgZ2FtZSBpcyBjbG9zZWQuIgogICAgICAgICkgKwogICAgICAgICI8L2Rpdj4iOwogICAgICByZXR1cm4gc3RyOwogICAgfTsKICAgIEdhbWUuY29tcHV0ZUx1bXBUaW1lcyA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGhvdXIgPSAxMDAwICogNjAgKiA2MDsKICAgICAgR2FtZS5sdW1wTWF0dXJlQWdlID0gaG91ciAqIDIwOwogICAgICBHYW1lLmx1bXBSaXBlQWdlID0gaG91ciAqIDIzOwogICAgICBpZiAoR2FtZS5IYXMoIlN0ZXZpYSBDYWVsZXN0aXMiKSkgR2FtZS5sdW1wUmlwZUFnZSAtPSBob3VyOwogICAgICBpZiAoR2FtZS5IYXMoIkRpYWJldGljYSBEYWVtb25pY3VzIikpIEdhbWUubHVtcE1hdHVyZUFnZSAtPSBob3VyOwogICAgICBpZiAoR2FtZS5IYXMoIkljaG9yIHN5cnVwIikpIEdhbWUubHVtcE1hdHVyZUFnZSAtPSAxMDAwICogNjAgKiA3OwogICAgICBpZiAoR2FtZS5IYXMoIlN1Z2FyIGFnaW5nIHByb2Nlc3MiKSkKICAgICAgICBHYW1lLmx1bXBSaXBlQWdlIC09CiAgICAgICAgICA2MDAwICogTWF0aC5taW4oNjAwLCBHYW1lLk9iamVjdHNbIkdyYW5kbWEiXS5hbW91bnQpOyAvL2NhcHBlZCBhdCA2MDAgZ3JhbmRtYXMKICAgICAgaWYgKEdhbWUuaGFzR29kICYmIEdhbWUuQnVpbGRpbmdzT3duZWQgJSAxMCA9PSAwKSB7CiAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJvcmRlciIpOwogICAgICAgIGlmIChnb2RMdmwgPT0gMSkgR2FtZS5sdW1wUmlwZUFnZSAtPSBob3VyOwogICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAyKSBHYW1lLmx1bXBSaXBlQWdlIC09IChob3VyIC8gMykgKiAyOwogICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAzKSBHYW1lLmx1bXBSaXBlQWdlIC09IGhvdXIgLyAzOwogICAgICB9CiAgICAgIC8vaWYgKEdhbWUuaGFzQXVyYSgnRHJhZ29uXCdzIEN1cnZlJykpIHtHYW1lLmx1bXBNYXR1cmVBZ2UvPTEuMDU7R2FtZS5sdW1wUmlwZUFnZS89MS4wNTt9CiAgICAgIEdhbWUubHVtcE1hdHVyZUFnZSAvPSAxICsgR2FtZS5hdXJhTXVsdCgiRHJhZ29uJ3MgQ3VydmUiKSAqIDAuMDU7CiAgICAgIEdhbWUubHVtcFJpcGVBZ2UgLz0gMSArIEdhbWUuYXVyYU11bHQoIkRyYWdvbidzIEN1cnZlIikgKiAwLjA1OwogICAgICBHYW1lLmx1bXBPdmVycmlwZUFnZSA9IEdhbWUubHVtcFJpcGVBZ2UgKyBob3VyOwogICAgICBpZiAoR2FtZS5IYXMoIkdsdWNvc2UtY2hhcmdlZCBhaXIiKSkgewogICAgICAgIEdhbWUubHVtcE1hdHVyZUFnZSAvPSAyMDAwOwogICAgICAgIEdhbWUubHVtcFJpcGVBZ2UgLz0gMjAwMDsKICAgICAgICBHYW1lLmx1bXBPdmVycmlwZUFnZSAvPSAyMDAwOwogICAgICB9CiAgICB9OwogICAgR2FtZS5sb2FkTHVtcHMgPSBmdW5jdGlvbiAodGltZSkgewogICAgICBHYW1lLmNvbXB1dGVMdW1wVGltZXMoKTsKICAgICAgLy9HYW1lLmNvbXB1dGVMdW1wVHlwZSgpOwogICAgICBpZiAoIUdhbWUuY2FuTHVtcHMoKSkgR2FtZS5yZW1vdmVDbGFzcygibHVtcHNPbiIpOwogICAgICBlbHNlIHsKICAgICAgICBpZiAoR2FtZS5hc2NlbnNpb25Nb2RlICE9IDEpIEdhbWUuYWRkQ2xhc3MoImx1bXBzT24iKTsKICAgICAgICBHYW1lLmx1bXBUID0gTWF0aC5taW4oRGF0ZS5ub3coKSwgR2FtZS5sdW1wVCk7CiAgICAgICAgdmFyIGFnZSA9IE1hdGgubWF4KERhdGUubm93KCkgLSBHYW1lLmx1bXBULCAwKTsKICAgICAgICB2YXIgYW1vdW50ID0gTWF0aC5mbG9vcihhZ2UgLyBHYW1lLmx1bXBPdmVycmlwZUFnZSk7IC8vaG93IG1hbnkgbHVtcHMgZGlkIHdlIGhhcnZlc3Qgc2luY2Ugd2UgY2xvc2VkIHRoZSBnYW1lPwogICAgICAgIGlmIChhbW91bnQgPj0gMSkgewogICAgICAgICAgR2FtZS5oYXJ2ZXN0THVtcHMoMSwgdHJ1ZSk7CiAgICAgICAgICBHYW1lLmx1bXBDdXJyZW50VHlwZSA9IDA7IC8vYWxsIG9mZmxpbmUgbHVtcHMgYWZ0ZXIgdGhlIGZpcnN0IG9uZSBoYXZlIGEgbm9ybWFsIHR5cGUKICAgICAgICAgIGlmIChhbW91bnQgPiAxKSBHYW1lLmhhcnZlc3RMdW1wcyhhbW91bnQgLSAxLCB0cnVlKTsKICAgICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgICAiIiwKICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICJZb3UgaGFydmVzdGVkIDxiPiUxPC9iPiB3aGlsZSB5b3Ugd2VyZSBhd2F5LiIsCiAgICAgICAgICAgICAgbG9jKCIlMSBzdWdhciBsdW1wIiwgTEJlYXV0aWZ5KGFtb3VudCkpCiAgICAgICAgICAgICksCiAgICAgICAgICAgIFsyOSwgMTRdCiAgICAgICAgICApOwogICAgICAgICAgR2FtZS5sdW1wVCA9IERhdGUubm93KCkgLSAoYWdlIC0gYW1vdW50ICogR2FtZS5sdW1wT3ZlcnJpcGVBZ2UpOwogICAgICAgICAgR2FtZS5jb21wdXRlTHVtcFR5cGUoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgICBHYW1lLmdhaW5MdW1wcyA9IGZ1bmN0aW9uICh0b3RhbCkgewogICAgICBpZiAoR2FtZS5sdW1wc1RvdGFsID09IC0xKSB7CiAgICAgICAgR2FtZS5sdW1wc1RvdGFsID0gMDsKICAgICAgICBHYW1lLmx1bXBzID0gMDsKICAgICAgfQogICAgICBHYW1lLmx1bXBzICs9IHRvdGFsOwogICAgICBHYW1lLmx1bXBzVG90YWwgKz0gdG90YWw7CgogICAgICBpZiAoR2FtZS5sdW1wc1RvdGFsID49IDcpIEdhbWUuV2luKCJEdWRlLCBzd2VldCIpOwogICAgICBpZiAoR2FtZS5sdW1wc1RvdGFsID49IDMwKSBHYW1lLldpbigiU3VnYXIgcnVzaCIpOwogICAgICBpZiAoR2FtZS5sdW1wc1RvdGFsID49IDM2NSkgR2FtZS5XaW4oIlllYXIncyB3b3J0aCBvZiBjYXZpdGllcyIpOwogICAgfTsKICAgIEdhbWUuY2xpY2tMdW1wID0gZnVuY3Rpb24gKCkgewogICAgICB0cmlnZ2VyQW5pbShsKCJsdW1wc0ljb24iKSwgInB1Y2tlciIpOwogICAgICB0cmlnZ2VyQW5pbShsKCJsdW1wc0ljb24yIiksICJwdWNrZXIiKTsKICAgICAgaWYgKCFHYW1lLmNhbkx1bXBzKCkpIHJldHVybjsKICAgICAgdmFyIGFnZSA9IERhdGUubm93KCkgLSBHYW1lLmx1bXBUOwogICAgICBpZiAoYWdlIDwgR2FtZS5sdW1wTWF0dXJlQWdlKSB7CiAgICAgIH0gZWxzZSBpZiAoYWdlIDwgR2FtZS5sdW1wUmlwZUFnZSkgewogICAgICAgIHZhciBhbW91bnQgPSBjaG9vc2UoWzAsIDFdKTsKICAgICAgICBpZiAoYW1vdW50ICE9IDApIEdhbWUuV2luKCJIYW5kLXBpY2tlZCIpOwogICAgICAgIEdhbWUuaGFydmVzdEx1bXBzKGFtb3VudCk7CiAgICAgICAgR2FtZS5jb21wdXRlTHVtcFR5cGUoKTsKICAgICAgfSBlbHNlIGlmIChhZ2UgPCBHYW1lLmx1bXBPdmVycmlwZUFnZSkgewogICAgICAgIEdhbWUuaGFydmVzdEx1bXBzKDEpOwogICAgICAgIEdhbWUuY29tcHV0ZUx1bXBUeXBlKCk7CiAgICAgIH0KICAgIH07CiAgICBHYW1lLmhhcnZlc3RMdW1wcyA9IGZ1bmN0aW9uIChhbW91bnQsIHNpbGVudCkgewogICAgICBpZiAoIUdhbWUuY2FuTHVtcHMoKSkgcmV0dXJuOwogICAgICBHYW1lLmx1bXBUID0gRGF0ZS5ub3coKTsKICAgICAgdmFyIHRvdGFsID0gYW1vdW50OwogICAgICBpZiAoCiAgICAgICAgR2FtZS5sdW1wQ3VycmVudFR5cGUgPT0gMSAmJgogICAgICAgIEdhbWUuSGFzKCJTdWNyYWxvc2lhIEludXRpbGlzIikgJiYKICAgICAgICBNYXRoLnJhbmRvbSgpIDwgMC4wNQogICAgICApCiAgICAgICAgdG90YWwgKj0gMjsKICAgICAgZWxzZSBpZiAoR2FtZS5sdW1wQ3VycmVudFR5cGUgPT0gMSkgdG90YWwgKj0gY2hvb3NlKFsxLCAyXSk7CiAgICAgIGVsc2UgaWYgKEdhbWUubHVtcEN1cnJlbnRUeXBlID09IDIpIHsKICAgICAgICB0b3RhbCAqPSBjaG9vc2UoWzIsIDMsIDQsIDUsIDYsIDddKTsKICAgICAgICBHYW1lLmdhaW5CdWZmKCJzdWdhciBibGVzc2luZyIsIDI0ICogNjAgKiA2MCwgMSk7CiAgICAgICAgR2FtZS5FYXJuKE1hdGgubWluKEdhbWUuY29va2llc1BzICogNjAgKiA2MCAqIDI0LCBHYW1lLmNvb2tpZXMpKTsKICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgIGxvYygiU3VnYXIgYmxlc3NpbmcgYWN0aXZhdGVkISIpLAogICAgICAgICAgbG9jKAogICAgICAgICAgICAiWW91ciBjb29raWVzIGhhdmUgYmVlbiBkb3VibGVkLjxicj4rMTAlIGdvbGRlbiBjb29raWVzIGZvciB0aGUgbmV4dCAyNCBob3Vycy4iCiAgICAgICAgICApLAogICAgICAgICAgWzI5LCAxNl0KICAgICAgICApOwogICAgICB9IGVsc2UgaWYgKEdhbWUubHVtcEN1cnJlbnRUeXBlID09IDMpIHRvdGFsICo9IGNob29zZShbMCwgMCwgMSwgMiwgMl0pOwogICAgICBlbHNlIGlmIChHYW1lLmx1bXBDdXJyZW50VHlwZSA9PSA0KSB7CiAgICAgICAgdG90YWwgKj0gY2hvb3NlKFsxLCAyLCAzXSk7CiAgICAgICAgR2FtZS5sdW1wUmVmaWxsID0gMDsgLy9EYXRlLm5vdygpLUdhbWUuZ2V0THVtcFJlZmlsbE1heCgpOwogICAgICAgIEdhbWUuTm90aWZ5KGxvYygiU3VnYXIgbHVtcCBjb29sZG93bnMgY2xlYXJlZCEiKSwgIiIsIFsyOSwgMjddKTsKICAgICAgfQogICAgICB0b3RhbCA9IE1hdGguZmxvb3IodG90YWwpOwogICAgICBHYW1lLmdhaW5MdW1wcyh0b3RhbCk7CiAgICAgIGlmIChHYW1lLmx1bXBDdXJyZW50VHlwZSA9PSAxKSBHYW1lLldpbigiU3VnYXIgc3VnYXIiKTsKICAgICAgZWxzZSBpZiAoR2FtZS5sdW1wQ3VycmVudFR5cGUgPT0gMikgR2FtZS5XaW4oIkFsbC1uYXR1cmFsIGNhbmUgc3VnYXIiKTsKICAgICAgZWxzZSBpZiAoR2FtZS5sdW1wQ3VycmVudFR5cGUgPT0gMykgR2FtZS5XaW4oIlN3ZWV0bWVhdHMiKTsKICAgICAgZWxzZSBpZiAoR2FtZS5sdW1wQ3VycmVudFR5cGUgPT0gNCkgR2FtZS5XaW4oIk1haWxsYXJkIHJlYWN0aW9uIik7CgogICAgICBpZiAoIXNpbGVudCkgewogICAgICAgIHZhciByZWN0ID0gbCgibHVtcHNJY29uMiIpLmdldEJvdW5kcygpOwogICAgICAgIEdhbWUuU3BhcmtsZUF0KAogICAgICAgICAgKHJlY3QubGVmdCArIHJlY3QucmlnaHQpIC8gMiwKICAgICAgICAgIChyZWN0LnRvcCArIHJlY3QuYm90dG9tKSAvIDIgLSAyNCArIDMyIC0gVG9wQmFyT2Zmc2V0CiAgICAgICAgKTsKICAgICAgICBpZiAodG90YWwgPiAwKQogICAgICAgICAgR2FtZS5Qb3B1cCgKICAgICAgICAgICAgIjxzbWFsbD4rIiArIGxvYygiJTEgc3VnYXIgbHVtcCIsIExCZWF1dGlmeSh0b3RhbCkpICsgIjwvc21hbGw+IiwKICAgICAgICAgICAgKHJlY3QubGVmdCArIHJlY3QucmlnaHQpIC8gMiwKICAgICAgICAgICAgKHJlY3QudG9wICsgcmVjdC5ib3R0b20pIC8gMiAtIDQ4CiAgICAgICAgICApOwogICAgICAgIGVsc2UKICAgICAgICAgIEdhbWUuUG9wdXAoCiAgICAgICAgICAgICI8c21hbGw+IiArIGxvYygiQm90Y2hlZCBoYXJ2ZXN0ISIpICsgIjwvc21hbGw+IiwKICAgICAgICAgICAgKHJlY3QubGVmdCArIHJlY3QucmlnaHQpIC8gMiwKICAgICAgICAgICAgKHJlY3QudG9wICsgcmVjdC5ib3R0b20pIC8gMiAtIDQ4CiAgICAgICAgICApOwogICAgICAgIFBsYXlTb3VuZCgic25kL3BvcCIgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAzICsgMSkgKyAiLm1wMyIsIDAuNzUpOwogICAgICB9CiAgICAgIEdhbWUuY29tcHV0ZUx1bXBUaW1lcygpOwogICAgfTsKICAgIEdhbWUuY29tcHV0ZUx1bXBUeXBlID0gZnVuY3Rpb24gKCkgewogICAgICBNYXRoLnNlZWRyYW5kb20oR2FtZS5zZWVkICsgIi8iICsgR2FtZS5sdW1wVCk7CiAgICAgIHZhciB0eXBlcyA9IFswXTsKICAgICAgdmFyIGxvb3AgPSAxOwogICAgICAvL2lmIChHYW1lLmhhc0F1cmEoJ0RyYWdvblwncyBDdXJ2ZScpKSBsb29wPTI7CiAgICAgIGxvb3AgKz0gR2FtZS5hdXJhTXVsdCgiRHJhZ29uJ3MgQ3VydmUiKTsKICAgICAgbG9vcCA9IHJhbmRvbUZsb29yKGxvb3ApOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxvb3A7IGkrKykgewogICAgICAgIGlmIChNYXRoLnJhbmRvbSgpIDwgKEdhbWUuSGFzKCJTdWNyYWxvc2lhIEludXRpbGlzIikgPyAwLjE1IDogMC4xKSkKICAgICAgICAgIHR5cGVzLnB1c2goMSk7IC8vYmlmdXJjYXRlZAogICAgICAgIGlmIChNYXRoLnJhbmRvbSgpIDwgMyAvIDEwMDApIHR5cGVzLnB1c2goMik7IC8vZ29sZGVuCiAgICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPCAwLjEgKiBHYW1lLmVsZGVyV3JhdGgpIHR5cGVzLnB1c2goMyk7IC8vbWVhdHkKICAgICAgICBpZiAoTWF0aC5yYW5kb20oKSA8IDEgLyA1MCkgdHlwZXMucHVzaCg0KTsgLy9jYXJhbWVsaXplZAogICAgICB9CiAgICAgIEdhbWUubHVtcEN1cnJlbnRUeXBlID0gY2hvb3NlKHR5cGVzKTsKICAgICAgTWF0aC5zZWVkcmFuZG9tKCk7CiAgICB9OwoKICAgIEdhbWUuY2FuTHVtcHMgPSBmdW5jdGlvbiAoKSAvL2dyYW1tYXRpY2FsbHkgcGxlYXNpbmcgZnVuY3Rpb24gbmFtZQogICAgewogICAgICBpZiAoCiAgICAgICAgR2FtZS5sdW1wc1RvdGFsID4gLTEgfHwKICAgICAgICAoR2FtZS5hc2NlbnNpb25Nb2RlICE9IDEgJiYKICAgICAgICAgIEdhbWUuY29va2llc0Vhcm5lZCArIEdhbWUuY29va2llc1Jlc2V0ID49IDEwMDAwMDAwMDApCiAgICAgICkKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfTsKCiAgICBHYW1lLmdldEx1bXBSZWZpbGxNYXggPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBHYW1lLmZwcyAqIDYwICogMTU7IC8vMTAwMCo2MCoxNTsvLzE1IG1pbnV0ZXMKICAgIH07CiAgICBHYW1lLmdldEx1bXBSZWZpbGxSZW1haW5pbmcgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBHYW1lLmx1bXBSZWZpbGw7IC8vR2FtZS5nZXRMdW1wUmVmaWxsTWF4KCktKERhdGUubm93KCktR2FtZS5sdW1wUmVmaWxsKTsKICAgIH07CiAgICBHYW1lLmNhblJlZmlsbEx1bXAgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBHYW1lLmx1bXBSZWZpbGwgPD0gMDsgLy8oKERhdGUubm93KCktR2FtZS5sdW1wUmVmaWxsKT49R2FtZS5nZXRMdW1wUmVmaWxsTWF4KCkpOwogICAgfTsKICAgIEdhbWUucmVmaWxsTHVtcCA9IGZ1bmN0aW9uIChuLCBmdW5jKSB7CiAgICAgIGlmIChHYW1lLmx1bXBzID49IG4gJiYgR2FtZS5jYW5SZWZpbGxMdW1wKCkpIHsKICAgICAgICBHYW1lLnNwZW5kTHVtcChuLCAicmVmaWxsIiwgZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKCFHYW1lLnNlc2FtZSkgR2FtZS5sdW1wUmVmaWxsID0gR2FtZS5nZXRMdW1wUmVmaWxsTWF4KCk7IC8vRGF0ZS5ub3coKTsKICAgICAgICAgIGZ1bmMoKTsKICAgICAgICB9KSgpOwogICAgICB9CiAgICB9OwogICAgR2FtZS5zcGVuZEx1bXAgPSBmdW5jdGlvbiAobiwgc3RyLCBmdW5jLCBmcmVlKSB7CiAgICAgIC8vYXNrIGlmIHdlIHdhbnQgdG8gc3BlbmQgTiBsdW1wcyAodW5sZXNzIGZyZWUpCiAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKCFmcmVlICYmIEdhbWUubHVtcHMgPCBuKSByZXR1cm4gZmFsc2U7CiAgICAgICAgaWYgKCFmcmVlICYmIEdhbWUucHJlZnMuYXNrTHVtcHMpIHsKICAgICAgICAgIFBsYXlTb3VuZCgic25kL3RpY2subXAzIik7CiAgICAgICAgICBHYW1lLnByb21wdENvbmZpcm1GdW5jID0gZnVuYzsgLy9iaXQgZHVtYgogICAgICAgICAgR2FtZS5Qcm9tcHQoCiAgICAgICAgICAgICc8aWQgU3BlbmRMdW1wPjxkaXYgY2xhc3M9Imljb24iIHN0eWxlPSJiYWNrZ3JvdW5kOnVybChpbWcvaWNvbnMucG5nP3Y9JyArCiAgICAgICAgICAgICAgR2FtZS52ZXJzaW9uICsKICAgICAgICAgICAgICAiKTtmbG9hdDpsZWZ0O21hcmdpbi1sZWZ0Oi04cHg7bWFyZ2luLXRvcDotOHB4O2JhY2tncm91bmQtcG9zaXRpb246IiArCiAgICAgICAgICAgICAgLTI5ICogNDggKwogICAgICAgICAgICAgICJweCAiICsKICAgICAgICAgICAgICAtMTQgKiA0OCArCiAgICAgICAgICAgICAgJ3B4OyI+PC9kaXY+PGRpdiBzdHlsZT0ibWFyZ2luOjE2cHggOHB4OyI+JyArCiAgICAgICAgICAgICAgbG9jKCJEbyB5b3Ugd2FudCB0byBzcGVuZCAlMSB0byAlMj8iLCBbCiAgICAgICAgICAgICAgICAiPGI+IiArIGxvYygiJTEgc3VnYXIgbHVtcCIsIExCZWF1dGlmeShuKSkgKyAiPC9iPiIsCiAgICAgICAgICAgICAgICBzdHIsCiAgICAgICAgICAgICAgXSkgKwogICAgICAgICAgICAgICI8L2Rpdj4iLAogICAgICAgICAgICBbCiAgICAgICAgICAgICAgWwogICAgICAgICAgICAgICAgbG9jKCJZZXMiKSwKICAgICAgICAgICAgICAgICJHYW1lLmx1bXBzLT0iICsKICAgICAgICAgICAgICAgICAgbiArCiAgICAgICAgICAgICAgICAgICI7R2FtZS5wcm9tcHRDb25maXJtRnVuYygpO0dhbWUucHJvbXB0Q29uZmlybUZ1bmM9MDtHYW1lLnJlY2FsY3VsYXRlR2FpbnM9MTtHYW1lLkNsb3NlUHJvbXB0KCk7IiwKICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgIGxvYygiTm8iKSwKICAgICAgICAgICAgXQogICAgICAgICAgKTsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKCFmcmVlKSBHYW1lLmx1bXBzIC09IG47CiAgICAgICAgICBmdW5jKCk7CiAgICAgICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICAgIH0KICAgICAgfTsKICAgIH07CgogICAgR2FtZS5kb0x1bXBzID0gZnVuY3Rpb24gKCkgewogICAgICBpZiAoR2FtZS5sdW1wUmVmaWxsID4gMCkgR2FtZS5sdW1wUmVmaWxsLS07CgogICAgICBpZiAoIUdhbWUuY2FuTHVtcHMoKSkgewogICAgICAgIEdhbWUucmVtb3ZlQ2xhc3MoImx1bXBzT24iKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKEdhbWUubHVtcHNUb3RhbCA9PSAtMSkgewogICAgICAgIC8vZmlyc3QgdGltZSAhCiAgICAgICAgaWYgKEdhbWUuYXNjZW5zaW9uTW9kZSAhPSAxKSBHYW1lLmFkZENsYXNzKCJsdW1wc09uIik7CiAgICAgICAgR2FtZS5sdW1wVCA9IERhdGUubm93KCk7CiAgICAgICAgR2FtZS5sdW1wc1RvdGFsID0gMDsKICAgICAgICBHYW1lLmx1bXBzID0gMDsKICAgICAgICBHYW1lLmNvbXB1dGVMdW1wVHlwZSgpOwoKICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgIGxvYygiU3VnYXIgbHVtcHMhIiksCiAgICAgICAgICBsb2MoCiAgICAgICAgICAgICJCZWNhdXNlIHlvdSd2ZSBiYWtlZCBhIDxiPmJpbGxpb24gY29va2llczwvYj4gaW4gdG90YWwsIHlvdSBhcmUgbm93IGF0dHJhY3RpbmcgPGI+c3VnYXIgbHVtcHM8L2I+LiBUaGV5IGNvYWxlc2NlIHF1aWV0bHkgbmVhciB0aGUgdG9wIG9mIHlvdXIgc2NyZWVuLCB1bmRlciB0aGUgU3RhdHMgYnV0dG9uLjxicj5Zb3Ugd2lsbCBiZSBhYmxlIHRvIGhhcnZlc3QgdGhlbSB3aGVuIHRoZXkncmUgcmlwZSwgYWZ0ZXIgd2hpY2ggeW91IG1heSBzcGVuZCB0aGVtIG9uIGFsbCBzb3J0cyBvZiB0aGluZ3MhIgogICAgICAgICAgKSwKICAgICAgICAgIFsyMywgMTRdCiAgICAgICAgKTsKICAgICAgfQogICAgICB2YXIgYWdlID0gRGF0ZS5ub3coKSAtIEdhbWUubHVtcFQ7CiAgICAgIGlmIChhZ2UgPiBHYW1lLmx1bXBPdmVycmlwZUFnZSkgewogICAgICAgIGFnZSA9IDA7CiAgICAgICAgR2FtZS5oYXJ2ZXN0THVtcHMoMSk7CiAgICAgICAgR2FtZS5jb21wdXRlTHVtcFR5cGUoKTsKICAgICAgfQoKICAgICAgdmFyIHBoYXNlID0gTWF0aC5taW4oNiwgTWF0aC5mbG9vcigoYWdlIC8gR2FtZS5sdW1wT3ZlcnJpcGVBZ2UpICogNykpOwogICAgICB2YXIgcGhhc2UyID0gTWF0aC5taW4oCiAgICAgICAgNiwKICAgICAgICBNYXRoLmZsb29yKChhZ2UgLyBHYW1lLmx1bXBPdmVycmlwZUFnZSkgKiA3KSArIDEKICAgICAgKTsKICAgICAgdmFyIHJvdyA9IDE0OwogICAgICB2YXIgcm93MiA9IDE0OwogICAgICB2YXIgdHlwZSA9IEdhbWUubHVtcEN1cnJlbnRUeXBlOwogICAgICBpZiAodHlwZSA9PSAxKSB7CiAgICAgICAgLy9kb3VibGUKICAgICAgICAvL2lmIChwaGFzZT49Nikgcm93PTE1OwogICAgICAgIGlmIChwaGFzZTIgPj0gNikgcm93MiA9IDE1OwogICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gMikgewogICAgICAgIC8vZ29sZGVuCiAgICAgICAgaWYgKHBoYXNlID49IDQpIHJvdyA9IDE2OwogICAgICAgIGlmIChwaGFzZTIgPj0gNCkgcm93MiA9IDE2OwogICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gMykgewogICAgICAgIC8vbWVhdHkKICAgICAgICBpZiAocGhhc2UgPj0gNCkgcm93ID0gMTc7CiAgICAgICAgaWYgKHBoYXNlMiA+PSA0KSByb3cyID0gMTc7CiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSA0KSB7CiAgICAgICAgLy9jYXJhbWVsaXplZAogICAgICAgIGlmIChwaGFzZSA+PSA0KSByb3cgPSAyNzsKICAgICAgICBpZiAocGhhc2UyID49IDQpIHJvdzIgPSAyNzsKICAgICAgfQogICAgICB2YXIgaWNvbiA9IFsyMyArIE1hdGgubWluKHBoYXNlLCA1KSwgcm93XTsKICAgICAgdmFyIGljb24yID0gWzIzICsgcGhhc2UyLCByb3cyXTsKICAgICAgaWYgKGFnZSA8IDApIHsKICAgICAgICBpY29uID0gWzE3LCA1XTsKICAgICAgICBpY29uMiA9IFsxNywgNV07CiAgICAgIH0KICAgICAgdmFyIG9wYWNpdHkgPSBNYXRoLm1pbig2LCAoYWdlIC8gR2FtZS5sdW1wT3ZlcnJpcGVBZ2UpICogNykgJSAxOwogICAgICBpZiAocGhhc2UgPj0gNikgewogICAgICAgIG9wYWNpdHkgPSAxOwogICAgICB9CiAgICAgIGwoImx1bXBzSWNvbiIpLnN0eWxlLmJhY2tncm91bmRQb3NpdGlvbiA9CiAgICAgICAgLWljb25bMF0gKiA0OCArICJweCAiICsgLWljb25bMV0gKiA0OCArICJweCI7CiAgICAgIGwoImx1bXBzSWNvbjIiKS5zdHlsZS5iYWNrZ3JvdW5kUG9zaXRpb24gPQogICAgICAgIC1pY29uMlswXSAqIDQ4ICsgInB4ICIgKyAtaWNvbjJbMV0gKiA0OCArICJweCI7CiAgICAgIGwoImx1bXBzSWNvbjIiKS5zdHlsZS5vcGFjaXR5ID0gb3BhY2l0eTsKICAgICAgbCgibHVtcHNBbW91bnQiKS50ZXh0Q29udGVudCA9IEJlYXV0aWZ5KEdhbWUubHVtcHMpOwogICAgfTsKCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCQlDT09LSUUgRUNPTk9NSUNTCgkJPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KICAgIEdhbWUuRWFybiA9IGZ1bmN0aW9uIChob3dtdWNoKSB7CiAgICAgIEdhbWUuY29va2llcyArPSBob3dtdWNoOwogICAgICBHYW1lLmNvb2tpZXNFYXJuZWQgKz0gaG93bXVjaDsKICAgIH07CiAgICBHYW1lLlNwZW5kID0gZnVuY3Rpb24gKGhvd211Y2gpIHsKICAgICAgR2FtZS5jb29raWVzIC09IGhvd211Y2g7CiAgICB9OwogICAgR2FtZS5EaXNzb2x2ZSA9IGZ1bmN0aW9uIChob3dtdWNoKSB7CiAgICAgIEdhbWUuY29va2llcyAtPSBob3dtdWNoOwogICAgICBHYW1lLmNvb2tpZXNFYXJuZWQgLT0gaG93bXVjaDsKICAgICAgR2FtZS5jb29raWVzID0gTWF0aC5tYXgoMCwgR2FtZS5jb29raWVzKTsKICAgICAgR2FtZS5jb29raWVzRWFybmVkID0gTWF0aC5tYXgoMCwgR2FtZS5jb29raWVzRWFybmVkKTsKICAgIH07CiAgICBHYW1lLm1vdXNlQ3BzID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgYWRkID0gMDsKICAgICAgaWYgKEdhbWUuSGFzKCJUaG91c2FuZCBmaW5nZXJzIikpIGFkZCArPSAwLjE7CiAgICAgIGlmIChHYW1lLkhhcygiTWlsbGlvbiBmaW5nZXJzIikpIGFkZCAqPSA1OwogICAgICBpZiAoR2FtZS5IYXMoIkJpbGxpb24gZmluZ2VycyIpKSBhZGQgKj0gMTA7CiAgICAgIGlmIChHYW1lLkhhcygiVHJpbGxpb24gZmluZ2VycyIpKSBhZGQgKj0gMjA7CiAgICAgIGlmIChHYW1lLkhhcygiUXVhZHJpbGxpb24gZmluZ2VycyIpKSBhZGQgKj0gMjA7CiAgICAgIGlmIChHYW1lLkhhcygiUXVpbnRpbGxpb24gZmluZ2VycyIpKSBhZGQgKj0gMjA7CiAgICAgIGlmIChHYW1lLkhhcygiU2V4dGlsbGlvbiBmaW5nZXJzIikpIGFkZCAqPSAyMDsKICAgICAgaWYgKEdhbWUuSGFzKCJTZXB0aWxsaW9uIGZpbmdlcnMiKSkgYWRkICo9IDIwOwogICAgICBpZiAoR2FtZS5IYXMoIk9jdGlsbGlvbiBmaW5nZXJzIikpIGFkZCAqPSAyMDsKICAgICAgaWYgKEdhbWUuSGFzKCJOb25pbGxpb24gZmluZ2VycyIpKSBhZGQgKj0gMjA7CiAgICAgIGlmIChHYW1lLkhhcygiRGVjaWxsaW9uIGZpbmdlcnMiKSkgYWRkICo9IDIwOwogICAgICBpZiAoR2FtZS5IYXMoIlVuc2hhY2tsZWQgY3Vyc29ycyIpKSBhZGQgKj0gMjU7CgogICAgICB2YXIgbnVtID0gMDsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICBudW0gKz0gR2FtZS5PYmplY3RzW2ldLmFtb3VudDsKICAgICAgfQogICAgICBudW0gLT0gR2FtZS5PYmplY3RzWyJDdXJzb3IiXS5hbW91bnQ7CiAgICAgIGFkZCA9IGFkZCAqIG51bTsKICAgICAgaWYgKEdhbWUuSGFzKCJQbGFzdGljIG1vdXNlIikpIGFkZCArPSBHYW1lLmNvb2tpZXNQcyAqIDAuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiSXJvbiBtb3VzZSIpKSBhZGQgKz0gR2FtZS5jb29raWVzUHMgKiAwLjAxOwogICAgICBpZiAoR2FtZS5IYXMoIlRpdGFuaXVtIG1vdXNlIikpIGFkZCArPSBHYW1lLmNvb2tpZXNQcyAqIDAuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiQWRhbWFudGl1bSBtb3VzZSIpKSBhZGQgKz0gR2FtZS5jb29raWVzUHMgKiAwLjAxOwogICAgICBpZiAoR2FtZS5IYXMoIlVub2J0YWluaXVtIG1vdXNlIikpIGFkZCArPSBHYW1lLmNvb2tpZXNQcyAqIDAuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiRWx1ZGl1bSBtb3VzZSIpKSBhZGQgKz0gR2FtZS5jb29raWVzUHMgKiAwLjAxOwogICAgICBpZiAoR2FtZS5IYXMoIldpc2hhbGxveSBtb3VzZSIpKSBhZGQgKz0gR2FtZS5jb29raWVzUHMgKiAwLjAxOwogICAgICBpZiAoR2FtZS5IYXMoIkZhbnRhc3RlZWwgbW91c2UiKSkgYWRkICs9IEdhbWUuY29va2llc1BzICogMC4wMTsKICAgICAgaWYgKEdhbWUuSGFzKCJOZXZlcmNyYWNrIG1vdXNlIikpIGFkZCArPSBHYW1lLmNvb2tpZXNQcyAqIDAuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiQXJteXRocmlsIG1vdXNlIikpIGFkZCArPSBHYW1lLmNvb2tpZXNQcyAqIDAuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiVGVjaG5vYnNpZGlhbiBtb3VzZSIpKSBhZGQgKz0gR2FtZS5jb29raWVzUHMgKiAwLjAxOwogICAgICBpZiAoR2FtZS5IYXMoIlBsYXNtYXJibGUgbW91c2UiKSkgYWRkICs9IEdhbWUuY29va2llc1BzICogMC4wMTsKICAgICAgaWYgKEdhbWUuSGFzKCJNaXJhY3VsaXRlIG1vdXNlIikpIGFkZCArPSBHYW1lLmNvb2tpZXNQcyAqIDAuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiQWV0aGVyaWNlIG1vdXNlIikpIGFkZCArPSBHYW1lLmNvb2tpZXNQcyAqIDAuMDE7CgogICAgICBpZiAoR2FtZS5IYXMoIkZvcnR1bmUgIzEwNCIpKSBhZGQgKz0gR2FtZS5jb29raWVzUHMgKiAwLjAxOwogICAgICB2YXIgbXVsdCA9IDE7CgogICAgICBpZiAoR2FtZS5IYXMoIlNhbnRhJ3MgaGVscGVycyIpKSBtdWx0ICo9IDEuMTsKICAgICAgaWYgKEdhbWUuSGFzKCJDb29raWUgZWdnIikpIG11bHQgKj0gMS4xOwogICAgICBpZiAoR2FtZS5IYXMoIkhhbG8gZ2xvdmVzIikpIG11bHQgKj0gMS4xOwogICAgICBpZiAoR2FtZS5IYXMoIkRyYWdvbiBjbGF3IikpIG11bHQgKj0gMS4wMzsKCiAgICAgIGlmIChHYW1lLkhhcygiQXVyYSBnbG92ZXMiKSkgewogICAgICAgIG11bHQgKj0KICAgICAgICAgIDEgKwogICAgICAgICAgMC4wNSAqCiAgICAgICAgICAgIE1hdGgubWluKAogICAgICAgICAgICAgIEdhbWUuT2JqZWN0c1siQ3Vyc29yIl0ubGV2ZWwsCiAgICAgICAgICAgICAgR2FtZS5IYXMoIkx1bWlub3VzIGdsb3ZlcyIpID8gMjAgOiAxMAogICAgICAgICAgICApOwogICAgICB9CgogICAgICBtdWx0ICo9IEdhbWUuZWZmKCJjbGljayIpOwoKICAgICAgaWYgKEdhbWUuaGFzR29kKSB7CiAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJsYWJvciIpOwogICAgICAgIGlmIChnb2RMdmwgPT0gMSkgbXVsdCAqPSAxLjE1OwogICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAyKSBtdWx0ICo9IDEuMTsKICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMykgbXVsdCAqPSAxLjA1OwogICAgICB9CgogICAgICBmb3IgKHZhciBpIGluIEdhbWUuYnVmZnMpIHsKICAgICAgICBpZiAodHlwZW9mIEdhbWUuYnVmZnNbaV0ubXVsdENsaWNrICE9ICJ1bmRlZmluZWQiKQogICAgICAgICAgbXVsdCAqPSBHYW1lLmJ1ZmZzW2ldLm11bHRDbGljazsKICAgICAgfQoKICAgICAgLy9pZiAoR2FtZS5oYXNBdXJhKCdEcmFnb24gQ3Vyc29yJykpIG11bHQqPTEuMDU7CiAgICAgIG11bHQgKj0gMSArIEdhbWUuYXVyYU11bHQoIkRyYWdvbiBDdXJzb3IiKSAqIDAuMDU7CgogICAgICB2YXIgb3V0ID0KICAgICAgICBtdWx0ICoKICAgICAgICBHYW1lLkNvbXB1dGVDcHMoCiAgICAgICAgICAxLAogICAgICAgICAgR2FtZS5IYXMoIlJlaW5mb3JjZWQgaW5kZXggZmluZ2VyIikgKwogICAgICAgICAgICBHYW1lLkhhcygiQ2FycGFsIHR1bm5lbCBwcmV2ZW50aW9uIGNyZWFtIikgKwogICAgICAgICAgICBHYW1lLkhhcygiQW1iaWRleHRyb3VzIiksCiAgICAgICAgICBhZGQKICAgICAgICApOwoKICAgICAgb3V0ID0gR2FtZS5ydW5Nb2RIb29rT25WYWx1ZSgiY29va2llc1BlckNsaWNrIiwgb3V0KTsKCiAgICAgIGlmIChHYW1lLmhhc0J1ZmYoIkN1cnNlZCBmaW5nZXIiKSkKICAgICAgICBvdXQgPSBHYW1lLmJ1ZmZzWyJDdXJzZWQgZmluZ2VyIl0ucG93ZXI7CiAgICAgIHJldHVybiBvdXQ7CiAgICB9OwogICAgR2FtZS5jb21wdXRlZE1vdXNlQ3BzID0gMTsKICAgIEdhbWUuZ2xvYmFsQ3BzTXVsdCA9IDE7CiAgICBHYW1lLnVuYnVmZmVkQ3BzID0gMDsKICAgIEdhbWUuYnVpbGRpbmdDcHMgPSAwOwogICAgR2FtZS5sYXN0Q2xpY2sgPSAwOwogICAgR2FtZS5DYW5DbGljayA9IDE7CiAgICBHYW1lLmF1dG9jbGlja2VyRGV0ZWN0ZWQgPSAwOwogICAgR2FtZS5CaWdDb29raWVTdGF0ZSA9IDA7IC8vMCA9IG5vcm1hbCwgMSA9IGNsaWNrZWQgKHNtYWxsKSwgMiA9IHJlbGVhc2VkL2hvdmVyZWQgKGJpZykKICAgIEdhbWUuQmlnQ29va2llU2l6ZSA9IDA7CiAgICBHYW1lLkJpZ0Nvb2tpZVNpemVEID0gMDsKICAgIEdhbWUuQmlnQ29va2llU2l6ZVQgPSAxOwogICAgR2FtZS5jb29raWVDbGlja1NvdW5kID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNykgKyAxOwogICAgR2FtZS5wbGF5Q29va2llQ2xpY2tTb3VuZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKEdhbWUucHJlZnMuY29va2llc291bmQpCiAgICAgICAgUGxheVNvdW5kKCJzbmQvY2xpY2tiIiArIEdhbWUuY29va2llQ2xpY2tTb3VuZCArICIubXAzIiwgMC41KTsKICAgICAgZWxzZSBQbGF5U291bmQoInNuZC9jbGljayIgKyBHYW1lLmNvb2tpZUNsaWNrU291bmQgKyAiLm1wMyIsIDAuNSk7CiAgICAgIEdhbWUuY29va2llQ2xpY2tTb3VuZCArPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA0KSArIDE7CiAgICAgIGlmIChHYW1lLmNvb2tpZUNsaWNrU291bmQgPiA3KSBHYW1lLmNvb2tpZUNsaWNrU291bmQgLT0gNzsKICAgIH07CiAgICBHYW1lLkNsaWNrQ29va2llID0gZnVuY3Rpb24gKGUsIGFtb3VudCkgewogICAgICB2YXIgbm93ID0gRGF0ZS5ub3coKTsKICAgICAgaWYgKGUpIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgaWYgKAogICAgICAgIEdhbWUuT25Bc2NlbmQgfHwKICAgICAgICBHYW1lLkFzY2VuZFRpbWVyID4gMCB8fAogICAgICAgIEdhbWUuVCA8IDMgfHwKICAgICAgICBub3cgLSBHYW1lLmxhc3RDbGljayA8IDEwMDAgLyAoKGUgPyBlLmRldGFpbCA6IDEpID09PSAwID8gMyA6IDUwKQogICAgICApIHsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAobm93IC0gR2FtZS5sYXN0Q2xpY2sgPCAxMDAwIC8gMTUpIHsKICAgICAgICAgIEdhbWUuYXV0b2NsaWNrZXJEZXRlY3RlZCArPSBHYW1lLmZwczsKICAgICAgICAgIGlmIChHYW1lLmF1dG9jbGlja2VyRGV0ZWN0ZWQgPj0gR2FtZS5mcHMgKiA1KQogICAgICAgICAgICBHYW1lLldpbigiVW5jYW5ueSBjbGlja2VyIik7CiAgICAgICAgfQogICAgICAgIEdhbWUubG9zZVNoaW1tZXJpbmdWZWlsKCJjbGljayIpOwogICAgICAgIHZhciBhbW91bnQgPSBhbW91bnQgPyBhbW91bnQgOiBHYW1lLmNvbXB1dGVkTW91c2VDcHM7CiAgICAgICAgR2FtZS5FYXJuKGFtb3VudCk7CiAgICAgICAgR2FtZS5oYW5kbWFkZUNvb2tpZXMgKz0gYW1vdW50OwogICAgICAgIGlmIChHYW1lLnByZWZzLnBhcnRpY2xlcykgewogICAgICAgICAgR2FtZS5wYXJ0aWNsZUFkZCgpOwogICAgICAgICAgR2FtZS5wYXJ0aWNsZUFkZCgKICAgICAgICAgICAgR2FtZS5tb3VzZVgsCiAgICAgICAgICAgIEdhbWUubW91c2VZLAogICAgICAgICAgICBNYXRoLnJhbmRvbSgpICogNCAtIDIsCiAgICAgICAgICAgIE1hdGgucmFuZG9tKCkgKiAtMiAtIDIsCiAgICAgICAgICAgIE1hdGgucmFuZG9tKCkgKiAwLjUgKyAwLjc1LAogICAgICAgICAgICAxLAogICAgICAgICAgICAyCiAgICAgICAgICApOwogICAgICAgIH0KICAgICAgICBpZiAoR2FtZS5wcmVmcy5udW1iZXJzKQogICAgICAgICAgR2FtZS5wYXJ0aWNsZUFkZCgKICAgICAgICAgICAgR2FtZS5tb3VzZVggKyBNYXRoLnJhbmRvbSgpICogOCAtIDQsCiAgICAgICAgICAgIEdhbWUubW91c2VZIC0gOCArIE1hdGgucmFuZG9tKCkgKiA4IC0gNCwKICAgICAgICAgICAgMCwKICAgICAgICAgICAgLTIsCiAgICAgICAgICAgIDEsCiAgICAgICAgICAgIDQsCiAgICAgICAgICAgIDIsCiAgICAgICAgICAgICIiLAogICAgICAgICAgICAiKyIgKyBCZWF1dGlmeShhbW91bnQsIDEpCiAgICAgICAgICApOwoKICAgICAgICBHYW1lLnJ1bk1vZEhvb2soImNsaWNrIik7CgogICAgICAgIEdhbWUucGxheUNvb2tpZUNsaWNrU291bmQoKTsKICAgICAgICBHYW1lLmNvb2tpZUNsaWNrcysrOwoKICAgICAgICBpZiAoR2FtZS5jbGlja3NUaGlzU2Vzc2lvbiA9PSAwKSBQbGF5Q3VlKCJwcmVwbGF5Iik7CiAgICAgICAgR2FtZS5jbGlja3NUaGlzU2Vzc2lvbisrOwogICAgICAgIEdhbWUubGFzdENsaWNrID0gbm93OwogICAgICB9CiAgICAgIEdhbWUuQ2xpY2sgPSAwOwogICAgfTsKICAgIEdhbWUubW91c2VYID0gMDsKICAgIEdhbWUubW91c2VZID0gMDsKICAgIEdhbWUubW91c2VYMiA9IDA7CiAgICBHYW1lLm1vdXNlWTIgPSAwOwogICAgR2FtZS5tb3VzZU1vdmVkID0gMDsKICAgIEdhbWUuR2V0TW91c2VDb29yZHMgPSBmdW5jdGlvbiAoZSkgewogICAgICB2YXIgcG9zeCA9IDA7CiAgICAgIHZhciBwb3N5ID0gMDsKICAgICAgaWYgKCFlKSB2YXIgZSA9IHdpbmRvdy5ldmVudDsKICAgICAgaWYgKGUucGFnZVggfHwgZS5wYWdlWSkgewogICAgICAgIHBvc3ggPSBlLnBhZ2VYOwogICAgICAgIHBvc3kgPSBlLnBhZ2VZOwogICAgICB9IGVsc2UgaWYgKGUuY2xpZW50WCB8fCBlLmNsaWVudFkpIHsKICAgICAgICBwb3N4ID0KICAgICAgICAgIGUuY2xpZW50WCArCiAgICAgICAgICBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQgKwogICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQ7CiAgICAgICAgcG9zeSA9CiAgICAgICAgICBlLmNsaWVudFkgKwogICAgICAgICAgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AgKwogICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDsKICAgICAgfQogICAgICB2YXIgeCA9IDA7CiAgICAgIHZhciB5ID0gVG9wQmFyT2Zmc2V0OwogICAgICAvKgoJCQl2YXIgZWw9bCgnc2VjdGlvbkxlZnQnKTsKCQkJd2hpbGUoZWwgJiYgIWlzTmFOKGVsLm9mZnNldExlZnQpICYmICFpc05hTihlbC5vZmZzZXRUb3ApKQoJCQl7CgkJCQl4Kz1lbC5vZmZzZXRMZWZ0LWVsLnNjcm9sbExlZnQ7CgkJCQl5Kz1lbC5vZmZzZXRUb3AtZWwuc2Nyb2xsVG9wOwoJCQkJZWw9ZWwub2Zmc2V0UGFyZW50OwoJCQl9Ki8KICAgICAgR2FtZS5tb3VzZVgyID0gR2FtZS5tb3VzZVg7CiAgICAgIEdhbWUubW91c2VZMiA9IEdhbWUubW91c2VZOwogICAgICBHYW1lLm1vdXNlWCA9IChwb3N4IC0geCkgLyBHYW1lLnNjYWxlOwogICAgICBHYW1lLm1vdXNlWSA9IChwb3N5IC0geSkgLyBHYW1lLnNjYWxlOwogICAgICBHYW1lLm1vdXNlTW92ZWQgPSAxOwogICAgICBHYW1lLmxhc3RBY3Rpdml0eSA9IEdhbWUudGltZTsKICAgIH07CiAgICB2YXIgYmlnQ29va2llID0gbCgiYmlnQ29va2llIik7CiAgICBpZiAoR2FtZS5wcmVmcy5zY3JlZW5yZWFkZXIpIHsKICAgICAgYmlnQ29va2llLmFyaWFMYWJlbGxlZGJ5ID0gImJpZ0Nvb2tpZUxhYmVsIjsKICAgICAgYmlnQ29va2llLmluc2VydEFkamFjZW50SFRNTCgKICAgICAgICAiYmVmb3JlZW5kIiwKICAgICAgICAnPGxhYmVsIGlkPSJiaWdDb29raWVMYWJlbCIgc3R5bGU9ImZvbnQtc2l6ZToxMDBweCAhaW1wb3J0YW50OyIgY2xhc3M9InNyT25seSI+JyArCiAgICAgICAgICBsb2MoIkJpZyBjbGlja2FibGUgY29va2llIikgKwogICAgICAgICAgIjwvbGFiZWw+IgogICAgICApOwogICAgICBiaWdDb29raWUudGFiSW5kZXggPSAxOwogICAgfQogICAgR2FtZS5DbGljayA9IDA7CiAgICBHYW1lLmxhc3RDbGlja2VkRWwgPSAwOwogICAgR2FtZS5jbGlja3NUaGlzU2Vzc2lvbiA9IDA7CiAgICBHYW1lLmNsaWNrRnJvbSA9IDA7CiAgICBHYW1lLlNjcm9sbCA9IDA7CiAgICBHYW1lLm1vdXNlRG93biA9IDA7CiAgICBpZiAoIUdhbWUudG91Y2hFdmVudHMpIHsKICAgICAgQWRkRXZlbnQoYmlnQ29va2llLCAiY2xpY2siLCBHYW1lLkNsaWNrQ29va2llKTsKICAgICAgQWRkRXZlbnQoYmlnQ29va2llLCAibW91c2Vkb3duIiwgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgR2FtZS5CaWdDb29raWVTdGF0ZSA9IDE7CiAgICAgICAgaWYgKEdhbWUucHJlZnMuY29va2llc291bmQpIHsKICAgICAgICAgIEdhbWUucGxheUNvb2tpZUNsaWNrU291bmQoKTsKICAgICAgICB9CiAgICAgICAgaWYgKGV2ZW50KSBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICB9KTsKICAgICAgQWRkRXZlbnQoYmlnQ29va2llLCAibW91c2V1cCIsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgIEdhbWUuQmlnQ29va2llU3RhdGUgPSAyOwogICAgICAgIGlmIChldmVudCkgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgfSk7CiAgICAgIEFkZEV2ZW50KGJpZ0Nvb2tpZSwgIm1vdXNlb3V0IiwgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgR2FtZS5CaWdDb29raWVTdGF0ZSA9IDA7CiAgICAgIH0pOwogICAgICBBZGRFdmVudChiaWdDb29raWUsICJtb3VzZW92ZXIiLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICBHYW1lLkJpZ0Nvb2tpZVN0YXRlID0gMjsKICAgICAgfSk7CiAgICAgIEFkZEV2ZW50KGRvY3VtZW50LCAibW91c2Vtb3ZlIiwgR2FtZS5HZXRNb3VzZUNvb3Jkcyk7CiAgICAgIEFkZEV2ZW50KGRvY3VtZW50LCAibW91c2Vkb3duIiwgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgR2FtZS5sYXN0QWN0aXZpdHkgPSBHYW1lLnRpbWU7CiAgICAgICAgR2FtZS5tb3VzZURvd24gPSAxOwogICAgICAgIEdhbWUuY2xpY2tGcm9tID0gZXZlbnQudGFyZ2V0OwogICAgICB9KTsKICAgICAgQWRkRXZlbnQoZG9jdW1lbnQsICJtb3VzZXVwIiwgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgR2FtZS5sYXN0QWN0aXZpdHkgPSBHYW1lLnRpbWU7CiAgICAgICAgR2FtZS5tb3VzZURvd24gPSAwOwogICAgICAgIEdhbWUuY2xpY2tGcm9tID0gMDsKICAgICAgfSk7CiAgICAgIEFkZEV2ZW50KGRvY3VtZW50LCAiY2xpY2siLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICBHYW1lLmxhc3RBY3Rpdml0eSA9IEdhbWUudGltZTsKICAgICAgICBHYW1lLkNsaWNrID0gMTsKICAgICAgICBHYW1lLmxhc3RDbGlja2VkRWwgPSBldmVudC50YXJnZXQ7CiAgICAgICAgR2FtZS5jbGlja0Zyb20gPSAwOwogICAgICB9KTsKICAgICAgR2FtZS5oYW5kbGVTY3JvbGwgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIGlmICghZSkgZSA9IGV2ZW50OwogICAgICAgIEdhbWUuU2Nyb2xsID0gZS5kZXRhaWwgPCAwIHx8IGUud2hlZWxEZWx0YSA+IDAgPyAxIDogLTE7CiAgICAgICAgR2FtZS5sYXN0QWN0aXZpdHkgPSBHYW1lLnRpbWU7CiAgICAgIH07CiAgICAgIEFkZEV2ZW50KGRvY3VtZW50LCAiRE9NTW91c2VTY3JvbGwiLCBHYW1lLmhhbmRsZVNjcm9sbCk7CiAgICAgIEFkZEV2ZW50KGRvY3VtZW50LCAibW91c2V3aGVlbCIsIEdhbWUuaGFuZGxlU2Nyb2xsKTsKICAgIH0gZWxzZSB7CiAgICAgIC8vdG91Y2ggZXZlbnRzCiAgICAgIEFkZEV2ZW50KGJpZ0Nvb2tpZSwgInRvdWNoZW5kIiwgR2FtZS5DbGlja0Nvb2tpZSk7CiAgICAgIEFkZEV2ZW50KGJpZ0Nvb2tpZSwgInRvdWNoc3RhcnQiLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICBHYW1lLkJpZ0Nvb2tpZVN0YXRlID0gMTsKICAgICAgICBpZiAoZXZlbnQpIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIH0pOwogICAgICBBZGRFdmVudChiaWdDb29raWUsICJ0b3VjaGVuZCIsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgIEdhbWUuQmlnQ29va2llU3RhdGUgPSAwOwogICAgICAgIGlmIChldmVudCkgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgfSk7CiAgICAgIC8vQWRkRXZlbnQoZG9jdW1lbnQsJ3RvdWNobW92ZScsR2FtZS5HZXRNb3VzZUNvb3Jkcyk7CiAgICAgIEFkZEV2ZW50KGRvY3VtZW50LCAibW91c2Vtb3ZlIiwgR2FtZS5HZXRNb3VzZUNvb3Jkcyk7CiAgICAgIEFkZEV2ZW50KGRvY3VtZW50LCAidG91Y2hzdGFydCIsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgIEdhbWUubGFzdEFjdGl2aXR5ID0gR2FtZS50aW1lOwogICAgICAgIEdhbWUubW91c2VEb3duID0gMTsKICAgICAgfSk7CiAgICAgIEFkZEV2ZW50KGRvY3VtZW50LCAidG91Y2hlbmQiLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICBHYW1lLmxhc3RBY3Rpdml0eSA9IEdhbWUudGltZTsKICAgICAgICBHYW1lLm1vdXNlRG93biA9IDA7CiAgICAgIH0pOwogICAgICBBZGRFdmVudChkb2N1bWVudCwgInRvdWNoZW5kIiwgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgR2FtZS5sYXN0QWN0aXZpdHkgPSBHYW1lLnRpbWU7CiAgICAgICAgR2FtZS5DbGljayA9IDE7CiAgICAgIH0pOwogICAgfQoKICAgIEdhbWUua2V5cyA9IFtdOwogICAgQWRkRXZlbnQod2luZG93LCAia2V5dXAiLCBmdW5jdGlvbiAoZSkgewogICAgICBHYW1lLmxhc3RBY3Rpdml0eSA9IEdhbWUudGltZTsKICAgICAgaWYgKGUua2V5Q29kZSA9PSAyNykgewogICAgICAgIGlmIChHYW1lLnByb21wdE9uICYmICFHYW1lLnByb21wdE5vQ2xvc2UpIHsKICAgICAgICAgIEdhbWUuQ2xvc2VQcm9tcHQoKTsKICAgICAgICAgIFBsYXlTb3VuZCgic25kL3RpY2tPZmYubXAzIik7CiAgICAgICAgfQogICAgICAgIGlmIChHYW1lLkFzY2VuZFRpbWVyID4gMCkgR2FtZS5Bc2NlbmRUaW1lciA9IEdhbWUuQXNjZW5kRHVyYXRpb247CiAgICAgIH0gLy9lc2MgY2xvc2VzIHByb21wdAogICAgICBpZiAoR2FtZS5wcm9tcHRPbikgewogICAgICAgIGlmIChlLmtleUNvZGUgPT0gMTMpIEdhbWUuQ29uZmlybVByb21wdCgpOyAvL2VudGVyIGNvbmZpcm1zIHByb21wdAogICAgICB9CiAgICAgIEdhbWUua2V5c1tlLmtleUNvZGVdID0gMDsKICAgIH0pOwogICAgQWRkRXZlbnQod2luZG93LCAia2V5ZG93biIsIGZ1bmN0aW9uIChlKSB7CiAgICAgIGlmIChHYW1lLnByb21wdE9uKSB7CiAgICAgICAgaWYgKGUua2V5Q29kZSA9PSA5KSB7CiAgICAgICAgICAvL3RhYiB0byBzaGlmdCB0aHJvdWdoIHByb21wdCBidXR0b25zCiAgICAgICAgICBpZiAoZS5zaGlmdEtleSkgR2FtZS5Gb2N1c1Byb21wdE9wdGlvbigtMSk7CiAgICAgICAgICBlbHNlIEdhbWUuRm9jdXNQcm9tcHRPcHRpb24oMSk7CiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICghR2FtZS5PbkFzY2VuZCAmJiBHYW1lLkFzY2VuZFRpbWVyID09IDApIHsKICAgICAgICBpZiAoZS5jdHJsS2V5ICYmIGUua2V5Q29kZSA9PSA4MykgewogICAgICAgICAgR2FtZS50b1NhdmUgPSB0cnVlOwogICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIH0gLy9jdHJsLXMgc2F2ZXMgdGhlIGdhbWUKICAgICAgICBlbHNlIGlmIChlLmN0cmxLZXkgJiYgZS5rZXlDb2RlID09IDc5KSB7CiAgICAgICAgICBHYW1lLkltcG9ydFNhdmUoKTsKICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICB9IC8vY3RybC1vIG9wZW5zIHRoZSBpbXBvcnQgbWVudQogICAgICB9CiAgICAgIGlmICgoZS5rZXlDb2RlID09IDE2IHx8IGUua2V5Q29kZSA9PSAxNykgJiYgR2FtZS50b29sdGlwLmR5bmFtaWMpCiAgICAgICAgR2FtZS50b29sdGlwLnVwZGF0ZSgpOwogICAgICBHYW1lLmtleXNbZS5rZXlDb2RlXSA9IDE7CiAgICAgIGlmIChlLmtleUNvZGUgPT0gOSkgR2FtZS5rZXlzID0gW107IC8vcmVzZXQga2V5cyBvbiB0YWIgcHJlc3MKICAgIH0pOwoKICAgIEFkZEV2ZW50KHdpbmRvdywgInZpc2liaWxpdHljaGFuZ2UiLCBmdW5jdGlvbiAoZSkgewogICAgICBHYW1lLmtleXMgPSBbXTsgLy9yZXNldCBhbGwga2V5IHByZXNzZWQgb24gdmlzaWJpbGl0eSBjaGFuZ2UgKHNob3VsZCBoZWxwIHByZXZlbnQgY3RybCBzdGlsbCBiZWluZyBkb3duIGFmdGVyIGN0cmwtdGFiKQogICAgfSk7CgogICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkJQ1BTIFJFQ0FMQ1VMQVRPUgoJCT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCgogICAgR2FtZS5oZWF2ZW5seVBvd2VyID0gMTsgLy9ob3cgbWFueSBDcFMgcGVyY2VudHMgYSBzaW5nbGUgaGVhdmVubHkgY2hpcCBnaXZlcwogICAgR2FtZS5yZWNhbGN1bGF0ZUdhaW5zID0gMTsKICAgIEdhbWUuY29va2llc1BzQnlUeXBlID0ge307CiAgICBHYW1lLmNvb2tpZXNNdWx0QnlUeXBlID0ge307CiAgICAvL2Rpc3BsYXkgYmFycyB3aXRoIGh0dHA6Ly9jb2RlcGVuLmlvL2Fub24vcGVuL3dhR3lFSgogICAgR2FtZS5lZmZzID0ge307CiAgICBHYW1lLmVmZiA9IGZ1bmN0aW9uIChuYW1lLCBkZWYpIHsKICAgICAgaWYgKHR5cGVvZiBHYW1lLmVmZnNbbmFtZV0gPT09ICJ1bmRlZmluZWQiKQogICAgICAgIHJldHVybiB0eXBlb2YgZGVmID09PSAidW5kZWZpbmVkIiA/IDEgOiBkZWY7CiAgICAgIGVsc2UgcmV0dXJuIEdhbWUuZWZmc1tuYW1lXTsKICAgIH07CgogICAgR2FtZS5DYWxjdWxhdGVHYWlucyA9IGZ1bmN0aW9uICgpIHsKICAgICAgR2FtZS5jb29raWVzUHMgPSAwOwogICAgICB2YXIgbXVsdCA9IDE7CiAgICAgIC8vYWRkIHVwIGVmZmVjdCBib251c2VzIGZyb20gYnVpbGRpbmcgbWluaWdhbWVzCiAgICAgIHZhciBlZmZzID0ge307CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKSB7CiAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1tpXS5taW5pZ2FtZUxvYWRlZCAmJiBHYW1lLk9iamVjdHNbaV0ubWluaWdhbWUuZWZmcykgewogICAgICAgICAgdmFyIG15RWZmcyA9IEdhbWUuT2JqZWN0c1tpXS5taW5pZ2FtZS5lZmZzOwogICAgICAgICAgZm9yICh2YXIgaWkgaW4gbXlFZmZzKSB7CiAgICAgICAgICAgIGlmIChlZmZzW2lpXSkgZWZmc1tpaV0gKj0gbXlFZmZzW2lpXTsKICAgICAgICAgICAgZWxzZSBlZmZzW2lpXSA9IG15RWZmc1tpaV07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIEdhbWUuZWZmcyA9IGVmZnM7CgogICAgICBpZiAoR2FtZS5hc2NlbnNpb25Nb2RlICE9IDEpCiAgICAgICAgbXVsdCArPQogICAgICAgICAgcGFyc2VGbG9hdChHYW1lLnByZXN0aWdlKSAqCiAgICAgICAgICAwLjAxICoKICAgICAgICAgIEdhbWUuaGVhdmVubHlQb3dlciAqCiAgICAgICAgICBHYW1lLkdldEhlYXZlbmx5TXVsdGlwbGllcigpOwoKICAgICAgbXVsdCAqPSBHYW1lLmVmZigiY3BzIik7CgogICAgICBpZiAoR2FtZS5IYXMoIkhlcmFsZHMiKSAmJiBHYW1lLmFzY2Vuc2lvbk1vZGUgIT0gMSkKICAgICAgICBtdWx0ICo9IDEgKyAwLjAxICogR2FtZS5oZXJhbGRzOwoKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLmNvb2tpZVVwZ3JhZGVzKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5jb29raWVVcGdyYWRlc1tpXTsKICAgICAgICBpZiAoR2FtZS5IYXMobWUubmFtZSkpIHsKICAgICAgICAgIG11bHQgKj0KICAgICAgICAgICAgMSArCiAgICAgICAgICAgICh0eXBlb2YgbWUucG93ZXIgPT09ICJmdW5jdGlvbiIgPyBtZS5wb3dlcihtZSkgOiBtZS5wb3dlcikgKiAwLjAxOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKEdhbWUuSGFzKCJTcGVjaWFsaXplZCBjaG9jb2xhdGUgY2hpcHMiKSkgbXVsdCAqPSAxLjAxOwogICAgICBpZiAoR2FtZS5IYXMoIkRlc2lnbmVyIGNvY29hIGJlYW5zIikpIG11bHQgKj0gMS4wMjsKICAgICAgaWYgKEdhbWUuSGFzKCJVbmRlcndvcmxkIG92ZW5zIikpIG11bHQgKj0gMS4wMzsKICAgICAgaWYgKEdhbWUuSGFzKCJFeG90aWMgbnV0cyIpKSBtdWx0ICo9IDEuMDQ7CiAgICAgIGlmIChHYW1lLkhhcygiQXJjYW5lIHN1Z2FyIikpIG11bHQgKj0gMS4wNTsKCiAgICAgIGlmIChHYW1lLkhhcygiSW5jcmVhc2VkIG1lcnJpbmVzcyIpKSBtdWx0ICo9IDEuMTU7CiAgICAgIGlmIChHYW1lLkhhcygiSW1wcm92ZWQgam9sbGluZXNzIikpIG11bHQgKj0gMS4xNTsKICAgICAgaWYgKEdhbWUuSGFzKCJBIGx1bXAgb2YgY29hbCIpKSBtdWx0ICo9IDEuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiQW4gaXRjaHkgc3dlYXRlciIpKSBtdWx0ICo9IDEuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiU2FudGEncyBkb21pbmlvbiIpKSBtdWx0ICo9IDEuMjsKCiAgICAgIGlmIChHYW1lLkhhcygiRm9ydHVuZSAjMTAwIikpIG11bHQgKj0gMS4wMTsKICAgICAgaWYgKEdhbWUuSGFzKCJGb3J0dW5lICMxMDEiKSkgbXVsdCAqPSAxLjA3OwoKICAgICAgaWYgKEdhbWUuSGFzKCJEcmFnb24gc2NhbGUiKSkgbXVsdCAqPSAxLjAzOwoKICAgICAgdmFyIGJ1aWxkTXVsdCA9IDE7CiAgICAgIGlmIChHYW1lLmhhc0dvZCkgewogICAgICAgIHZhciBnb2RMdmwgPSBHYW1lLmhhc0dvZCgiYXNjZXRpY2lzbSIpOwogICAgICAgIGlmIChnb2RMdmwgPT0gMSkgbXVsdCAqPSAxLjE1OwogICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAyKSBtdWx0ICo9IDEuMTsKICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMykgbXVsdCAqPSAxLjA1OwoKICAgICAgICB2YXIgZ29kTHZsID0gR2FtZS5oYXNHb2QoImFnZXMiKTsKICAgICAgICBpZiAoZ29kTHZsID09IDEpCiAgICAgICAgICBtdWx0ICo9CiAgICAgICAgICAgIDEgKwogICAgICAgICAgICAwLjE1ICogTWF0aC5zaW4oKERhdGUubm93KCkgLyAxMDAwIC8gKDYwICogNjAgKiAzKSkgKiBNYXRoLlBJICogMik7CiAgICAgICAgZWxzZSBpZiAoZ29kTHZsID09IDIpCiAgICAgICAgICBtdWx0ICo9CiAgICAgICAgICAgIDEgKwogICAgICAgICAgICAwLjE1ICogTWF0aC5zaW4oKERhdGUubm93KCkgLyAxMDAwIC8gKDYwICogNjAgKiAxMikpICogTWF0aC5QSSAqIDIpOwogICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAzKQogICAgICAgICAgbXVsdCAqPQogICAgICAgICAgICAxICsKICAgICAgICAgICAgMC4xNSAqIE1hdGguc2luKChEYXRlLm5vdygpIC8gMTAwMCAvICg2MCAqIDYwICogMjQpKSAqIE1hdGguUEkgKiAyKTsKCiAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJkZWNhZGVuY2UiKTsKICAgICAgICBpZiAoZ29kTHZsID09IDEpIGJ1aWxkTXVsdCAqPSAwLjkzOwogICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAyKSBidWlsZE11bHQgKj0gMC45NTsKICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMykgYnVpbGRNdWx0ICo9IDAuOTg7CgogICAgICAgIHZhciBnb2RMdmwgPSBHYW1lLmhhc0dvZCgiaW5kdXN0cnkiKTsKICAgICAgICBpZiAoZ29kTHZsID09IDEpIGJ1aWxkTXVsdCAqPSAxLjE7CiAgICAgICAgZWxzZSBpZiAoZ29kTHZsID09IDIpIGJ1aWxkTXVsdCAqPSAxLjA2OwogICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAzKSBidWlsZE11bHQgKj0gMS4wMzsKCiAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJsYWJvciIpOwogICAgICAgIGlmIChnb2RMdmwgPT0gMSkgYnVpbGRNdWx0ICo9IDAuOTc7CiAgICAgICAgZWxzZSBpZiAoZ29kTHZsID09IDIpIGJ1aWxkTXVsdCAqPSAwLjk4OwogICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAzKSBidWlsZE11bHQgKj0gMC45OTsKICAgICAgfQoKICAgICAgaWYgKEdhbWUuSGFzKCJTYW50YSdzIGxlZ2FjeSIpKSBtdWx0ICo9IDEgKyAoR2FtZS5zYW50YUxldmVsICsgMSkgKiAwLjAzOwoKICAgICAgR2FtZS5taWxrUHJvZ3Jlc3MgPSBHYW1lLkFjaGlldmVtZW50c093bmVkIC8gMjU7CiAgICAgIHZhciBtaWxrTXVsdCA9IDE7CiAgICAgIGlmIChHYW1lLkhhcygiU2FudGEncyBtaWxrIGFuZCBjb29raWVzIikpIG1pbGtNdWx0ICo9IDEuMDU7CiAgICAgIC8vaWYgKEdhbWUuaGFzQXVyYSgnQnJlYXRoIG9mIE1pbGsnKSkgbWlsa011bHQqPTEuMDU7CiAgICAgIG1pbGtNdWx0ICo9IDEgKyBHYW1lLmF1cmFNdWx0KCJCcmVhdGggb2YgTWlsayIpICogMC4wNTsKICAgICAgaWYgKEdhbWUuaGFzR29kKSB7CiAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJtb3RoZXIiKTsKICAgICAgICBpZiAoZ29kTHZsID09IDEpIG1pbGtNdWx0ICo9IDEuMTsKICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMikgbWlsa011bHQgKj0gMS4wNTsKICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMykgbWlsa011bHQgKj0gMS4wMzsKICAgICAgfQogICAgICBtaWxrTXVsdCAqPSBHYW1lLmVmZigibWlsayIpOwoKICAgICAgdmFyIGNhdE11bHQgPSAxOwoKICAgICAgaWYgKEdhbWUuSGFzKCJLaXR0ZW4gaGVscGVycyIpKQogICAgICAgIGNhdE11bHQgKj0gMSArIEdhbWUubWlsa1Byb2dyZXNzICogMC4xICogbWlsa011bHQ7CiAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIHdvcmtlcnMiKSkKICAgICAgICBjYXRNdWx0ICo9IDEgKyBHYW1lLm1pbGtQcm9ncmVzcyAqIDAuMTI1ICogbWlsa011bHQ7CiAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIGVuZ2luZWVycyIpKQogICAgICAgIGNhdE11bHQgKj0gMSArIEdhbWUubWlsa1Byb2dyZXNzICogMC4xNSAqIG1pbGtNdWx0OwogICAgICBpZiAoR2FtZS5IYXMoIktpdHRlbiBvdmVyc2VlcnMiKSkKICAgICAgICBjYXRNdWx0ICo9IDEgKyBHYW1lLm1pbGtQcm9ncmVzcyAqIDAuMTc1ICogbWlsa011bHQ7CiAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIG1hbmFnZXJzIikpCiAgICAgICAgY2F0TXVsdCAqPSAxICsgR2FtZS5taWxrUHJvZ3Jlc3MgKiAwLjIgKiBtaWxrTXVsdDsKICAgICAgaWYgKEdhbWUuSGFzKCJLaXR0ZW4gYWNjb3VudGFudHMiKSkKICAgICAgICBjYXRNdWx0ICo9IDEgKyBHYW1lLm1pbGtQcm9ncmVzcyAqIDAuMiAqIG1pbGtNdWx0OwogICAgICBpZiAoR2FtZS5IYXMoIktpdHRlbiBzcGVjaWFsaXN0cyIpKQogICAgICAgIGNhdE11bHQgKj0gMSArIEdhbWUubWlsa1Byb2dyZXNzICogMC4yICogbWlsa011bHQ7CiAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIGV4cGVydHMiKSkKICAgICAgICBjYXRNdWx0ICo9IDEgKyBHYW1lLm1pbGtQcm9ncmVzcyAqIDAuMiAqIG1pbGtNdWx0OwogICAgICBpZiAoR2FtZS5IYXMoIktpdHRlbiBjb25zdWx0YW50cyIpKQogICAgICAgIGNhdE11bHQgKj0gMSArIEdhbWUubWlsa1Byb2dyZXNzICogMC4yICogbWlsa011bHQ7CiAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIGFzc2lzdGFudHMgdG8gdGhlIHJlZ2lvbmFsIG1hbmFnZXIiKSkKICAgICAgICBjYXRNdWx0ICo9IDEgKyBHYW1lLm1pbGtQcm9ncmVzcyAqIDAuMTc1ICogbWlsa011bHQ7CiAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIG1hcmtldGVlcnMiKSkKICAgICAgICBjYXRNdWx0ICo9IDEgKyBHYW1lLm1pbGtQcm9ncmVzcyAqIDAuMTUgKiBtaWxrTXVsdDsKICAgICAgaWYgKEdhbWUuSGFzKCJLaXR0ZW4gYW5hbHlzdHMiKSkKICAgICAgICBjYXRNdWx0ICo9IDEgKyBHYW1lLm1pbGtQcm9ncmVzcyAqIDAuMTI1ICogbWlsa011bHQ7CiAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIGV4ZWN1dGl2ZXMiKSkKICAgICAgICBjYXRNdWx0ICo9IDEgKyBHYW1lLm1pbGtQcm9ncmVzcyAqIDAuMTE1ICogbWlsa011bHQ7CiAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIGFkbWlucyIpKQogICAgICAgIGNhdE11bHQgKj0gMSArIEdhbWUubWlsa1Byb2dyZXNzICogMC4xMSAqIG1pbGtNdWx0OwogICAgICBpZiAoR2FtZS5IYXMoIktpdHRlbiBhbmdlbHMiKSkKICAgICAgICBjYXRNdWx0ICo9IDEgKyBHYW1lLm1pbGtQcm9ncmVzcyAqIDAuMSAqIG1pbGtNdWx0OwogICAgICBpZiAoR2FtZS5IYXMoIkZvcnR1bmUgIzEwMyIpKQogICAgICAgIGNhdE11bHQgKj0gMSArIEdhbWUubWlsa1Byb2dyZXNzICogMC4wNSAqIG1pbGtNdWx0OwoKICAgICAgR2FtZS5jb29raWVzTXVsdEJ5VHlwZVsia2l0dGVucyJdID0gY2F0TXVsdDsKCiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5PYmplY3RzW2ldOwogICAgICAgIG1lLnN0b3JlZENwcyA9IG1lLmNwcyhtZSk7CiAgICAgICAgaWYgKEdhbWUuYXNjZW5zaW9uTW9kZSAhPSAxKQogICAgICAgICAgbWUuc3RvcmVkQ3BzICo9ICgxICsgbWUubGV2ZWwgKiAwLjAxKSAqIGJ1aWxkTXVsdDsKICAgICAgICBpZiAoCiAgICAgICAgICBtZS5pZCA9PSAxICYmCiAgICAgICAgICBHYW1lLkhhcygiTWlsa2hlbHAmcmVnOyBsYWN0b3NlIGludG9sZXJhbmNlIHJlbGllZiB0YWJsZXRzIikKICAgICAgICApCiAgICAgICAgICBtZS5zdG9yZWRDcHMgKj0gMSArIDAuMDUgKiBHYW1lLm1pbGtQcm9ncmVzcyAqIG1pbGtNdWx0OyAvL3RoaXMgdXNlZCB0byBiZSAibWUuc3RvcmVkQ3BzKj0xKzAuMSpNYXRoLnBvdyhjYXRNdWx0LTEsMC41KSIgd2hpY2ggd2FzLiBobW0KICAgICAgICBtZS5zdG9yZWRUb3RhbENwcyA9IG1lLmFtb3VudCAqIG1lLnN0b3JlZENwczsKICAgICAgICBHYW1lLmNvb2tpZXNQcyArPSBtZS5zdG9yZWRUb3RhbENwczsKICAgICAgICBHYW1lLmNvb2tpZXNQc0J5VHlwZVttZS5uYW1lXSA9IG1lLnN0b3JlZFRvdGFsQ3BzOwogICAgICB9CiAgICAgIC8vY3BzIGZyb20gYnVpbGRpbmdzIG9ubHkKICAgICAgR2FtZS5idWlsZGluZ0NwcyA9IEdhbWUuY29va2llc1BzOwoKICAgICAgaWYgKEdhbWUuSGFzKCciZWdnIicpKSB7CiAgICAgICAgR2FtZS5jb29raWVzUHMgKz0gOTsKICAgICAgICBHYW1lLmNvb2tpZXNQc0J5VHlwZVsnImVnZyInXSA9IDk7CiAgICAgIH0gLy8iZWdnIgoKICAgICAgbXVsdCAqPSBjYXRNdWx0OwoKICAgICAgdmFyIGVnZ011bHQgPSAxOwogICAgICBpZiAoR2FtZS5IYXMoIkNoaWNrZW4gZWdnIikpIGVnZ011bHQgKj0gMS4wMTsKICAgICAgaWYgKEdhbWUuSGFzKCJEdWNrIGVnZyIpKSBlZ2dNdWx0ICo9IDEuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiVHVya2V5IGVnZyIpKSBlZ2dNdWx0ICo9IDEuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiUXVhaWwgZWdnIikpIGVnZ011bHQgKj0gMS4wMTsKICAgICAgaWYgKEdhbWUuSGFzKCJSb2JpbiBlZ2ciKSkgZWdnTXVsdCAqPSAxLjAxOwogICAgICBpZiAoR2FtZS5IYXMoIk9zdHJpY2ggZWdnIikpIGVnZ011bHQgKj0gMS4wMTsKICAgICAgaWYgKEdhbWUuSGFzKCJDYXNzb3dhcnkgZWdnIikpIGVnZ011bHQgKj0gMS4wMTsKICAgICAgaWYgKEdhbWUuSGFzKCJTYWxtb24gcm9lIikpIGVnZ011bHQgKj0gMS4wMTsKICAgICAgaWYgKEdhbWUuSGFzKCJGcm9nc3Bhd24iKSkgZWdnTXVsdCAqPSAxLjAxOwogICAgICBpZiAoR2FtZS5IYXMoIlNoYXJrIGVnZyIpKSBlZ2dNdWx0ICo9IDEuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiVHVydGxlIGVnZyIpKSBlZ2dNdWx0ICo9IDEuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiQW50IGxhcnZhIikpIGVnZ011bHQgKj0gMS4wMTsKICAgICAgaWYgKEdhbWUuSGFzKCJDZW50dXJ5IGVnZyIpKSB7CiAgICAgICAgLy90aGUgYm9vc3QgaW5jcmVhc2VzIGEgbGl0dGxlIGV2ZXJ5IGRheSwgd2l0aCBkaW1pbmlzaGluZyByZXR1cm5zIHVwIHRvICsxMCUgb24gdGhlIDEwMHRoIGRheQogICAgICAgIHZhciBkYXkgPQogICAgICAgICAgKE1hdGguZmxvb3IoKERhdGUubm93KCkgLSBHYW1lLnN0YXJ0RGF0ZSkgLyAxMDAwIC8gMTApICogMTApIC8KICAgICAgICAgIDYwIC8KICAgICAgICAgIDYwIC8KICAgICAgICAgIDI0OwogICAgICAgIGRheSA9IE1hdGgubWluKGRheSwgMTAwKTsKICAgICAgICBlZ2dNdWx0ICo9IDEgKyAoMSAtIE1hdGgucG93KDEgLSBkYXkgLyAxMDAsIDMpKSAqIDAuMTsKICAgICAgfQoKICAgICAgR2FtZS5jb29raWVzTXVsdEJ5VHlwZVsiZWdncyJdID0gZWdnTXVsdDsKICAgICAgbXVsdCAqPSBlZ2dNdWx0OwoKICAgICAgaWYgKEdhbWUuSGFzKCJTdWdhciBiYWtpbmciKSkKICAgICAgICBtdWx0ICo9IDEgKyBNYXRoLm1pbigxMDAsIEdhbWUubHVtcHMpICogMC4wMTsKCiAgICAgIC8vaWYgKEdhbWUuaGFzQXVyYSgnUmFkaWFudCBBcHBldGl0ZScpKSBtdWx0Kj0yOwogICAgICBtdWx0ICo9IDEgKyBHYW1lLmF1cmFNdWx0KCJSYWRpYW50IEFwcGV0aXRlIik7CgogICAgICB2YXIgcmF3Q29va2llc1BzID0gR2FtZS5jb29raWVzUHMgKiBtdWx0OwogICAgICBmb3IgKHZhciBpIGluIEdhbWUuQ3BzQWNoaWV2ZW1lbnRzKSB7CiAgICAgICAgaWYgKHJhd0Nvb2tpZXNQcyA+PSBHYW1lLkNwc0FjaGlldmVtZW50c1tpXS50aHJlc2hvbGQpCiAgICAgICAgICBHYW1lLldpbihHYW1lLkNwc0FjaGlldmVtZW50c1tpXS5uYW1lKTsKICAgICAgfQogICAgICBHYW1lLmNvb2tpZXNQc1JhdyA9IHJhd0Nvb2tpZXNQczsKICAgICAgR2FtZS5jb29raWVzUHNSYXdIaWdoZXN0ID0gTWF0aC5tYXgoCiAgICAgICAgR2FtZS5jb29raWVzUHNSYXdIaWdoZXN0LAogICAgICAgIHJhd0Nvb2tpZXNQcwogICAgICApOwoKICAgICAgdmFyIG4gPSBHYW1lLnNoaW1tZXJUeXBlc1siZ29sZGVuIl0ubjsKICAgICAgdmFyIGF1cmFNdWx0ID0gR2FtZS5hdXJhTXVsdCgiRHJhZ29uJ3MgRm9ydHVuZSIpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG47IGkrKykgewogICAgICAgIG11bHQgKj0gMSArIGF1cmFNdWx0ICogMS4yMzsKICAgICAgfQoKICAgICAgbmFtZSA9IEdhbWUuYmFrZXJ5TmFtZS50b0xvd2VyQ2FzZSgpOwogICAgICBpZiAobmFtZSA9PSAib3J0ZWlsIikgbXVsdCAqPSAwLjk5OwogICAgICBlbHNlIGlmIChuYW1lID09ICJvcnRpZWwiKSBtdWx0ICo9IDAuOTg7IC8vb3Igc28gaGVscCBtZQoKICAgICAgdmFyIHN1Y2tpbmcgPSAwOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUud3JpbmtsZXJzKSB7CiAgICAgICAgaWYgKEdhbWUud3JpbmtsZXJzW2ldLnBoYXNlID09IDIpIHsKICAgICAgICAgIHN1Y2tpbmcrKzsKICAgICAgICB9CiAgICAgIH0KICAgICAgdmFyIHN1Y2tSYXRlID0gMSAvIDIwOyAvL2VhY2ggd3JpbmtsZXIgZWF0cyBhIHR3ZW50aWV0aCBvZiB5b3VyIENwUwogICAgICBzdWNrUmF0ZSAqPSBHYW1lLmVmZigid3JpbmtsZXJFYXQiKTsKCiAgICAgIEdhbWUuY3BzU3Vja2VkID0gc3Vja2luZyAqIHN1Y2tSYXRlOwoKICAgICAgaWYgKEdhbWUuSGFzKCJFbGRlciBDb3ZlbmFudCIpKSBtdWx0ICo9IDAuOTU7CgogICAgICBpZiAoR2FtZS5IYXMoIkdvbGRlbiBzd2l0Y2ggW29mZl0iKSkgewogICAgICAgIHZhciBnb2xkZW5Td2l0Y2hNdWx0ID0gMS41OwogICAgICAgIGlmIChHYW1lLkhhcygiUmVzaWR1YWwgbHVjayIpKSB7CiAgICAgICAgICB2YXIgdXBncmFkZXMgPSBHYW1lLmdvbGRlbkNvb2tpZVVwZ3JhZGVzOwogICAgICAgICAgZm9yICh2YXIgaSBpbiB1cGdyYWRlcykgewogICAgICAgICAgICBpZiAoR2FtZS5IYXModXBncmFkZXNbaV0pKSBnb2xkZW5Td2l0Y2hNdWx0ICs9IDAuMTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgbXVsdCAqPSBnb2xkZW5Td2l0Y2hNdWx0OwogICAgICB9CiAgICAgIGlmIChHYW1lLkhhcygiU2hpbW1lcmluZyB2ZWlsIFtvZmZdIikpIHsKICAgICAgICBtdWx0ICo9IDEgKyBHYW1lLmdldFZlaWxCb29zdCgpOwogICAgICB9CiAgICAgIGlmIChHYW1lLkhhcygiTWFnaWMgc2hlbmFuaWdhbnMiKSkgbXVsdCAqPSAxMDAwOwogICAgICBpZiAoR2FtZS5IYXMoIk9jY3VsdCBvYnN0cnVjdGlvbiIpKSBtdWx0ICo9IDA7CgogICAgICBHYW1lLmNvb2tpZXNQcyA9IEdhbWUucnVuTW9kSG9va09uVmFsdWUoImNwcyIsIEdhbWUuY29va2llc1BzKTsKCiAgICAgIC8vY3BzIHdpdGhvdXQgZ29sZGVuIGNvb2tpZSBlZmZlY3RzCiAgICAgIEdhbWUudW5idWZmZWRDcHMgPSBHYW1lLmNvb2tpZXNQcyAqIG11bHQ7CgogICAgICBmb3IgKHZhciBpIGluIEdhbWUuYnVmZnMpIHsKICAgICAgICBpZiAodHlwZW9mIEdhbWUuYnVmZnNbaV0ubXVsdENwUyAhPT0gInVuZGVmaW5lZCIpCiAgICAgICAgICBtdWx0ICo9IEdhbWUuYnVmZnNbaV0ubXVsdENwUzsKICAgICAgfQoKICAgICAgR2FtZS5nbG9iYWxDcHNNdWx0ID0gbXVsdDsKICAgICAgR2FtZS5jb29raWVzUHMgKj0gR2FtZS5nbG9iYWxDcHNNdWx0OwoKICAgICAgLy9pZiAoR2FtZS5oYXNCdWZmKCdDdXJzZWQgZmluZ2VyJykpIEdhbWUuY29va2llc1BzPTA7CgogICAgICBHYW1lLmNvbXB1dGVkTW91c2VDcHMgPSBHYW1lLm1vdXNlQ3BzKCk7CgogICAgICBHYW1lLmNvbXB1dGVMdW1wVGltZXMoKTsKCiAgICAgIEdhbWUucmVjYWxjdWxhdGVHYWlucyA9IDA7CiAgICB9OwoKICAgIEdhbWUuZHJvcFJhdGVNdWx0ID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgcmF0ZSA9IDE7CiAgICAgIGlmIChHYW1lLkhhcygiR3JlZW4geWVhc3QgZGlnZXN0aXZlcyIpKSByYXRlICo9IDEuMDM7CiAgICAgIGlmIChHYW1lLkhhcygiRHJhZ29uIHRlZGR5IGJlYXIiKSkgcmF0ZSAqPSAxLjAzOwogICAgICByYXRlICo9IEdhbWUuZWZmKCJpdGVtRHJvcHMiKTsKICAgICAgLy9pZiAoR2FtZS5oYXNBdXJhKCdNaW5kIE92ZXIgTWF0dGVyJykpIHJhdGUqPTEuMjU7CiAgICAgIHJhdGUgKj0gMSArIEdhbWUuYXVyYU11bHQoIk1pbmQgT3ZlciBNYXR0ZXIiKSAqIDAuMjU7CiAgICAgIGlmIChHYW1lLkhhcygiU2FudGEncyBib3R0b21sZXNzIGJhZyIpKSByYXRlICo9IDEuMTsKICAgICAgaWYgKAogICAgICAgIEdhbWUuSGFzKCJDb3NtaWMgYmVnaW5uZXIncyBsdWNrIikgJiYKICAgICAgICAhR2FtZS5IYXMoIkhlYXZlbmx5IGNoaXAgc2VjcmV0IikKICAgICAgKQogICAgICAgIHJhdGUgKj0gNTsKICAgICAgcmV0dXJuIHJhdGU7CiAgICB9OwogICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkJU0hJTU1FUlMgKEdPTERFTiBDT09LSUVTICYgU1VDSCkKCQk9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgR2FtZS5zaGltbWVyc0wgPSBsKCJzaGltbWVycyIpOwogICAgR2FtZS5zaGltbWVycyA9IFtdOyAvL2FsbCBzaGltbWVycyBjdXJyZW50bHkgb24gdGhlIHNjcmVlbgogICAgR2FtZS5zaGltbWVyc04gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMCk7CiAgICBHYW1lLnNoaW1tZXIgPSBmdW5jdGlvbiAodHlwZSwgb2JqLCBub0NvdW50KSB7CiAgICAgIHRoaXMudHlwZSA9IHR5cGU7CgogICAgICB0aGlzLmwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgdGhpcy5sLmNsYXNzTmFtZSA9ICJzaGltbWVyIjsKICAgICAgaWYgKCFHYW1lLnRvdWNoRXZlbnRzKSB7CiAgICAgICAgQWRkRXZlbnQoCiAgICAgICAgICB0aGlzLmwsCiAgICAgICAgICAiY2xpY2siLAogICAgICAgICAgKGZ1bmN0aW9uICh3aGF0KSB7CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgICB3aGF0LnBvcChldmVudCk7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9KSh0aGlzKQogICAgICAgICk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgQWRkRXZlbnQoCiAgICAgICAgICB0aGlzLmwsCiAgICAgICAgICAidG91Y2hlbmQiLAogICAgICAgICAgKGZ1bmN0aW9uICh3aGF0KSB7CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgICB3aGF0LnBvcChldmVudCk7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9KSh0aGlzKQogICAgICAgICk7CiAgICAgIH0gLy90b3VjaCBldmVudHMKCiAgICAgIHRoaXMueCA9IDA7CiAgICAgIHRoaXMueSA9IDA7CiAgICAgIHRoaXMuaWQgPSBHYW1lLnNoaW1tZXJzTjsKCiAgICAgIHRoaXMuZm9yY2UgPSAiIjsKICAgICAgdGhpcy5mb3JjZU9iaiA9IG9iaiB8fCAwOwogICAgICBpZiAodGhpcy5mb3JjZU9iai50eXBlKSB0aGlzLmZvcmNlID0gdGhpcy5mb3JjZU9iai50eXBlOwogICAgICB0aGlzLm5vQ291bnQgPSBub0NvdW50OwogICAgICBpZiAoIXRoaXMubm9Db3VudCkgewogICAgICAgIEdhbWUuc2hpbW1lclR5cGVzW3RoaXMudHlwZV0ubisrOwogICAgICAgIEdhbWUucmVjYWxjdWxhdGVHYWlucyA9IDE7CiAgICAgIH0KCiAgICAgIHRoaXMuaW5pdCgpOwoKICAgICAgR2FtZS5zaGltbWVyc0wuYXBwZW5kQ2hpbGQodGhpcy5sKTsKICAgICAgR2FtZS5zaGltbWVycy5wdXNoKHRoaXMpOwogICAgICBHYW1lLnNoaW1tZXJzTisrOwogICAgfTsKICAgIEdhbWUuc2hpbW1lci5wcm90b3R5cGUuaW5pdCA9CiAgICAgIGZ1bmN0aW9uICgpIC8vZXhlY3V0ZWQgd2hlbiB0aGUgc2hpbW1lciBpcyBjcmVhdGVkCiAgICAgIHsKICAgICAgICBHYW1lLnNoaW1tZXJUeXBlc1t0aGlzLnR5cGVdLmluaXRGdW5jKHRoaXMpOwogICAgICB9OwogICAgR2FtZS5zaGltbWVyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSAvL2V4ZWN1dGVkIGV2ZXJ5IGZyYW1lCiAgICB7CiAgICAgIEdhbWUuc2hpbW1lclR5cGVzW3RoaXMudHlwZV0udXBkYXRlRnVuYyh0aGlzKTsKICAgIH07CiAgICBHYW1lLnNoaW1tZXIucHJvdG90eXBlLnBvcCA9IGZ1bmN0aW9uICgKICAgICAgZXZlbnQgLy9leGVjdXRlZCB3aGVuIHRoZSBzaGltbWVyIGlzIHBvcHBlZCBieSB0aGUgcGxheWVyCiAgICApIHsKICAgICAgaWYgKGV2ZW50KSBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBHYW1lLmxvc2VTaGltbWVyaW5nVmVpbCgic2hpbW1lciIpOwogICAgICBHYW1lLkNsaWNrID0gMDsKICAgICAgR2FtZS5zaGltbWVyVHlwZXNbdGhpcy50eXBlXS5wb3BGdW5jKHRoaXMpOwogICAgfTsKICAgIEdhbWUuc2hpbW1lci5wcm90b3R5cGUuZGllID0KICAgICAgZnVuY3Rpb24gKCkgLy9leGVjdXRlZCBhZnRlciB0aGUgc2hpbW1lciBkaXNhcHBlYXJzIChmcm9tIG9sZCBhZ2Ugb3IgcG9wcGluZykKICAgICAgewogICAgICAgIGlmIChHYW1lLnNoaW1tZXJUeXBlc1t0aGlzLnR5cGVdLnNwYXduc09uVGltZXIgJiYgdGhpcy5zcGF3bkxlYWQpIHsKICAgICAgICAgIC8vaWYgdGhpcyB3YXMgdGhlIHNwYXduIGxlYWQgZm9yIHRoaXMgc2hpbW1lciB0eXBlLCBzZXQgdGhlIHNoaW1tZXIgdHlwZSdzICJzcGF3bmVkIiB0byAwIGFuZCByZXN0YXJ0IGl0cyBzcGF3biB0aW1lcgogICAgICAgICAgdmFyIHR5cGUgPSBHYW1lLnNoaW1tZXJUeXBlc1t0aGlzLnR5cGVdOwogICAgICAgICAgdHlwZS50aW1lID0gMDsKICAgICAgICAgIHR5cGUuc3Bhd25lZCA9IDA7CiAgICAgICAgICB0eXBlLm1pblRpbWUgPSB0eXBlLmdldE1pblRpbWUodGhpcyk7CiAgICAgICAgICB0eXBlLm1heFRpbWUgPSB0eXBlLmdldE1heFRpbWUodGhpcyk7CiAgICAgICAgfQogICAgICAgIEdhbWUuc2hpbW1lcnNMLnJlbW92ZUNoaWxkKHRoaXMubCk7CiAgICAgICAgaWYgKEdhbWUuc2hpbW1lcnMuaW5kZXhPZih0aGlzKSAhPSAtMSkKICAgICAgICAgIEdhbWUuc2hpbW1lcnMuc3BsaWNlKEdhbWUuc2hpbW1lcnMuaW5kZXhPZih0aGlzKSwgMSk7CiAgICAgICAgaWYgKCF0aGlzLm5vQ291bnQpIHsKICAgICAgICAgIEdhbWUuc2hpbW1lclR5cGVzW3RoaXMudHlwZV0ubiA9IE1hdGgubWF4KAogICAgICAgICAgICAwLAogICAgICAgICAgICBHYW1lLnNoaW1tZXJUeXBlc1t0aGlzLnR5cGVdLm4gLSAxCiAgICAgICAgICApOwogICAgICAgICAgR2FtZS5yZWNhbGN1bGF0ZUdhaW5zID0gMTsKICAgICAgICB9CiAgICAgIH07CgogICAgR2FtZS51cGRhdGVTaGltbWVycyA9CiAgICAgIGZ1bmN0aW9uICgpIC8vcnVuIHNoaW1tZXIgZnVuY3Rpb25zLCBraWxsIG92ZXJ0aW1lZCBzaGltbWVycyBhbmQgc3Bhd24gbmV3IG9uZXMKICAgICAgewogICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5zaGltbWVycykgewogICAgICAgICAgR2FtZS5zaGltbWVyc1tpXS51cGRhdGUoKTsKICAgICAgICB9CgogICAgICAgIC8vY29va2llIHN0b3JtIQogICAgICAgIGlmIChHYW1lLmhhc0J1ZmYoIkNvb2tpZSBzdG9ybSIpICYmIE1hdGgucmFuZG9tKCkgPCAwLjUpIHsKICAgICAgICAgIHZhciBuZXdTaGltbWVyID0gbmV3IEdhbWUuc2hpbW1lcigKICAgICAgICAgICAgImdvbGRlbiIsCiAgICAgICAgICAgIHsgdHlwZTogImNvb2tpZSBzdG9ybSBkcm9wIiB9LAogICAgICAgICAgICAxCiAgICAgICAgICApOwogICAgICAgICAgbmV3U2hpbW1lci5kdXIgPSBNYXRoLmNlaWwoTWF0aC5yYW5kb20oKSAqIDQgKyAxKTsKICAgICAgICAgIG5ld1NoaW1tZXIubGlmZSA9IE1hdGguY2VpbChHYW1lLmZwcyAqIG5ld1NoaW1tZXIuZHVyKTsKICAgICAgICAgIC8vbmV3U2hpbW1lci5mb3JjZT0nY29va2llIHN0b3JtIGRyb3AnOwogICAgICAgICAgbmV3U2hpbW1lci5zaXplTXVsdCA9IE1hdGgucmFuZG9tKCkgKiAwLjc1ICsgMC4yNTsKICAgICAgICB9CgogICAgICAgIC8vc3Bhd24gc2hpbW1lcnMKICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuc2hpbW1lclR5cGVzKSB7CiAgICAgICAgICB2YXIgbWUgPSBHYW1lLnNoaW1tZXJUeXBlc1tpXTsKICAgICAgICAgIGlmIChtZS5zcGF3bnNPblRpbWVyICYmIG1lLnNwYXduQ29uZGl0aW9ucygpKSB7CiAgICAgICAgICAgIC8vb25seSBydW4gb24gc2hpbW1lciB0eXBlcyB0aGF0IHdvcmsgb24gYSB0aW1lcgogICAgICAgICAgICBpZiAoIW1lLnNwYXduZWQpIHsKICAgICAgICAgICAgICAvL25vIHNoaW1tZXIgc3Bhd25lZCBmb3IgdGhpcyB0eXBlPyBjaGVjayB0aGUgdGltZXIgYW5kIHRyeSB0byBzcGF3biBvbmUKICAgICAgICAgICAgICBtZS50aW1lKys7CiAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgTWF0aC5yYW5kb20oKSA8CiAgICAgICAgICAgICAgICBNYXRoLnBvdygKICAgICAgICAgICAgICAgICAgTWF0aC5tYXgoCiAgICAgICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgICAgICAobWUudGltZSAtIG1lLm1pblRpbWUpIC8gKG1lLm1heFRpbWUgLSBtZS5taW5UaW1lKQogICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICA1CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICB2YXIgbmV3U2hpbW1lciA9IG5ldyBHYW1lLnNoaW1tZXIoaSk7CiAgICAgICAgICAgICAgICBuZXdTaGltbWVyLnNwYXduTGVhZCA9IDE7CiAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgIEdhbWUuSGFzKCJEaXN0aWxsZWQgZXNzZW5jZSBvZiByZWRvdWJsZWQgbHVjayIpICYmCiAgICAgICAgICAgICAgICAgIE1hdGgucmFuZG9tKCkgPCAwLjAxCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgIHZhciBuZXdTaGltbWVyID0gbmV3IEdhbWUuc2hpbW1lcihpKTsKICAgICAgICAgICAgICAgIG1lLnNwYXduZWQgPSAxOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfTsKICAgIEdhbWUua2lsbFNoaW1tZXJzID0KICAgICAgZnVuY3Rpb24gKCkgLy9zdG9wIGFuZCBkZWxldGUgYWxsIHNoaW1tZXJzICh1c2VkIG9uIHJlc2V0dGluZyBldGMpCiAgICAgIHsKICAgICAgICBmb3IgKHZhciBpID0gR2FtZS5zaGltbWVycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgICAgR2FtZS5zaGltbWVyc1tpXS5kaWUoKTsKICAgICAgICB9CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLnNoaW1tZXJUeXBlcykgewogICAgICAgICAgdmFyIG1lID0gR2FtZS5zaGltbWVyVHlwZXNbaV07CiAgICAgICAgICBpZiAobWUucmVzZXQpIG1lLnJlc2V0KCk7CiAgICAgICAgICBtZS5uID0gMDsKICAgICAgICAgIGlmIChtZS5zcGF3bnNPblRpbWVyKSB7CiAgICAgICAgICAgIG1lLnRpbWUgPSAwOwogICAgICAgICAgICBtZS5zcGF3bmVkID0gMDsKICAgICAgICAgICAgbWUubWluVGltZSA9IG1lLmdldE1pblRpbWUobWUpOwogICAgICAgICAgICBtZS5tYXhUaW1lID0gbWUuZ2V0TWF4VGltZShtZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9OwoKICAgIEdhbWUuc2hpbW1lclR5cGVzID0gewogICAgICAvL2luIHRoZXNlLCAibWUiIHJlZmVycyB0byB0aGUgc2hpbW1lciBpdHNlbGYsIGFuZCAidGhpcyIgdG8gdGhlIHNoaW1tZXIncyB0eXBlIG9iamVjdAogICAgICBnb2xkZW46IHsKICAgICAgICByZXNldDogZnVuY3Rpb24gKCkgewogICAgICAgICAgdGhpcy5jaGFpbiA9IDA7CiAgICAgICAgICB0aGlzLnRvdGFsRnJvbUNoYWluID0gMDsKICAgICAgICAgIHRoaXMubGFzdCA9ICIiOwogICAgICAgIH0sCiAgICAgICAgaW5pdEZ1bmM6IGZ1bmN0aW9uIChtZSkgewogICAgICAgICAgaWYgKAogICAgICAgICAgICAhdGhpcy5zcGF3bmVkICYmCiAgICAgICAgICAgIG1lLmZvcmNlICE9ICJjb29raWUgc3Rvcm0gZHJvcCIgJiYKICAgICAgICAgICAgR2FtZS5jaGltZVR5cGUgIT0gMCAmJgogICAgICAgICAgICBHYW1lLmFzY2Vuc2lvbk1vZGUgIT0gMQogICAgICAgICAgKQogICAgICAgICAgICBHYW1lLnBsYXlHb2xkZW5Db29raWVDaGltZSgpOwoKICAgICAgICAgIC8vc2V0IGltYWdlCiAgICAgICAgICB2YXIgYmdQaWMgPSAiaW1nL2dvbGRDb29raWUucG5nIjsKICAgICAgICAgIHZhciBwaWNYID0gMDsKICAgICAgICAgIHZhciBwaWNZID0gMDsKCiAgICAgICAgICBpZiAoCiAgICAgICAgICAgICghbWUuZm9yY2VPYmogfHwgIW1lLmZvcmNlT2JqLm5vV3JhdGgpICYmCiAgICAgICAgICAgICgobWUuZm9yY2VPYmogJiYgbWUuZm9yY2VPYmoud3JhdGgpIHx8CiAgICAgICAgICAgICAgKEdhbWUuZWxkZXJXcmF0aCA9PSAxICYmIE1hdGgucmFuZG9tKCkgPCAxIC8gMykgfHwKICAgICAgICAgICAgICAoR2FtZS5lbGRlcldyYXRoID09IDIgJiYgTWF0aC5yYW5kb20oKSA8IDIgLyAzKSB8fAogICAgICAgICAgICAgIEdhbWUuZWxkZXJXcmF0aCA9PSAzIHx8CiAgICAgICAgICAgICAgKEdhbWUuaGFzR29kICYmIEdhbWUuaGFzR29kKCJzY29ybiIpKSkKICAgICAgICAgICkgewogICAgICAgICAgICBtZS53cmF0aCA9IDE7CiAgICAgICAgICAgIGlmIChHYW1lLnNlYXNvbiA9PSAiaGFsbG93ZWVuIikgYmdQaWMgPSAiaW1nL3Nwb29reUNvb2tpZS5wbmciOwogICAgICAgICAgICBlbHNlIGJnUGljID0gImltZy93cmF0aENvb2tpZS5wbmciOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbWUud3JhdGggPSAwOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChHYW1lLnNlYXNvbiA9PSAidmFsZW50aW5lcyIpIHsKICAgICAgICAgICAgYmdQaWMgPSAiaW1nL2hlYXJ0cy5wbmciOwogICAgICAgICAgICBwaWNYID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogOCk7CiAgICAgICAgICB9IGVsc2UgaWYgKEdhbWUuc2Vhc29uID09ICJmb29scyIpIHsKICAgICAgICAgICAgYmdQaWMgPSAiaW1nL2NvbnRyYWN0LnBuZyI7CiAgICAgICAgICAgIGlmIChtZS53cmF0aCkgYmdQaWMgPSAiaW1nL3dyYXRoQ29udHJhY3QucG5nIjsKICAgICAgICAgIH0gZWxzZSBpZiAoR2FtZS5zZWFzb24gPT0gImVhc3RlciIpIHsKICAgICAgICAgICAgYmdQaWMgPSAiaW1nL2J1bm5pZXMucG5nIjsKICAgICAgICAgICAgcGljWCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDQpOwogICAgICAgICAgICBwaWNZID0gMDsKICAgICAgICAgICAgaWYgKG1lLndyYXRoKSBwaWNZID0gMTsKICAgICAgICAgIH0KCiAgICAgICAgICBtZS54ID0KICAgICAgICAgICAgTWF0aC5mbG9vcigKICAgICAgICAgICAgICBNYXRoLnJhbmRvbSgpICoKICAgICAgICAgICAgICAgIE1hdGgubWF4KDAsIEdhbWUuYm91bmRzLnJpZ2h0IC0gMzAwIC0gR2FtZS5ib3VuZHMubGVmdCAtIDEyOCkgKwogICAgICAgICAgICAgICAgR2FtZS5ib3VuZHMubGVmdCArCiAgICAgICAgICAgICAgICA2NAogICAgICAgICAgICApIC0gNjQ7CiAgICAgICAgICBtZS55ID0KICAgICAgICAgICAgTWF0aC5mbG9vcigKICAgICAgICAgICAgICBNYXRoLnJhbmRvbSgpICoKICAgICAgICAgICAgICAgIE1hdGgubWF4KDAsIEdhbWUuYm91bmRzLmJvdHRvbSAtIEdhbWUuYm91bmRzLnRvcCAtIDEyOCkgKwogICAgICAgICAgICAgICAgR2FtZS5ib3VuZHMudG9wICsKICAgICAgICAgICAgICAgIDY0CiAgICAgICAgICAgICkgLSA2NDsKICAgICAgICAgIG1lLmwuc3R5bGUubGVmdCA9IG1lLnggKyAicHgiOwogICAgICAgICAgbWUubC5zdHlsZS50b3AgPSBtZS55ICsgInB4IjsKICAgICAgICAgIG1lLmwuc3R5bGUud2lkdGggPSAiOTZweCI7CiAgICAgICAgICBtZS5sLnN0eWxlLmhlaWdodCA9ICI5NnB4IjsKICAgICAgICAgIG1lLmwuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gInVybCgiICsgYmdQaWMgKyAiKSI7CiAgICAgICAgICBtZS5sLnN0eWxlLmJhY2tncm91bmRQb3NpdGlvbiA9CiAgICAgICAgICAgIC1waWNYICogOTYgKyAicHggIiArIC1waWNZICogOTYgKyAicHgiOwogICAgICAgICAgbWUubC5zdHlsZS5vcGFjaXR5ID0gIjAiOwogICAgICAgICAgbWUubC5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICAgIG1lLmwuc2V0QXR0cmlidXRlKAogICAgICAgICAgICAiYWx0IiwKICAgICAgICAgICAgbG9jKG1lLndyYXRoID8gIldyYXRoIGNvb2tpZSIgOiAiR29sZGVuIGNvb2tpZSIpCiAgICAgICAgICApOwoKICAgICAgICAgIG1lLmxpZmUgPSAxOyAvL3RoZSBjb29raWUncyBjdXJyZW50IHByb2dyZXNzaW9uIHRocm91Z2ggaXRzIGxpZmVzcGFuIChpbiBmcmFtZXMpCiAgICAgICAgICBtZS5kdXIgPSAxMzsgLy9kdXJhdGlvbjsgdGhlIGNvb2tpZSdzIGxpZmVzcGFuIGluIHNlY29uZHMgYmVmb3JlIGl0IGRlc3Bhd25zCgogICAgICAgICAgdmFyIGR1ciA9IDEzOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJMdWNreSBkYXkiKSkgZHVyICo9IDI7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIlNlcmVuZGlwaXR5IikpIGR1ciAqPSAyOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJEZWNpc2l2ZSBmYXRlIikpIGR1ciAqPSAxLjA1OwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJMdWNreSBkaWdpdCIpKSBkdXIgKj0gMS4wMTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiTHVja3kgbnVtYmVyIikpIGR1ciAqPSAxLjAxOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJMdWNreSBwYXlvdXQiKSkgZHVyICo9IDEuMDE7CiAgICAgICAgICBpZiAoIW1lLndyYXRoKSBkdXIgKj0gR2FtZS5lZmYoImdvbGRlbkNvb2tpZUR1ciIpOwogICAgICAgICAgZWxzZSBkdXIgKj0gR2FtZS5lZmYoIndyYXRoQ29va2llRHVyIik7CiAgICAgICAgICBkdXIgKj0gTWF0aC5wb3coMC45NSwgR2FtZS5zaGltbWVyVHlwZXNbImdvbGRlbiJdLm4gLSAxKTsgLy81JSBzaG9ydGVyIGZvciBldmVyeSBvdGhlciBnb2xkZW4gY29va2llIG9uIHRoZSBzY3JlZW4KICAgICAgICAgIGlmICh0aGlzLmNoYWluID4gMCkgZHVyID0gTWF0aC5tYXgoMiwgMTAgLyB0aGlzLmNoYWluKTsgLy90aGlzIGlzIGhpbGFyaW91cwogICAgICAgICAgbWUuZHVyID0gZHVyOwogICAgICAgICAgbWUubGlmZSA9IE1hdGguY2VpbChHYW1lLmZwcyAqIG1lLmR1cik7CiAgICAgICAgICBtZS5zaXplTXVsdCA9IDE7CiAgICAgICAgfSwKICAgICAgICB1cGRhdGVGdW5jOiBmdW5jdGlvbiAobWUpIHsKICAgICAgICAgIHZhciBjdXJ2ZSA9IDEgLSBNYXRoLnBvdygobWUubGlmZSAvIChHYW1lLmZwcyAqIG1lLmR1cikpICogMiAtIDEsIDQpOwogICAgICAgICAgbWUubC5zdHlsZS5vcGFjaXR5ID0gY3VydmU7CiAgICAgICAgICAvL3RoaXMgbGluZSBtYWtlcyBlYWNoIGdvbGRlbiBjb29raWUgcHVsc2UgaW4gYSB1bmlxdWUgd2F5CiAgICAgICAgICBpZiAoR2FtZS5wcmVmcy5mYW5jeSkKICAgICAgICAgICAgbWUubC5zdHlsZS50cmFuc2Zvcm0gPQogICAgICAgICAgICAgICJyb3RhdGUoIiArCiAgICAgICAgICAgICAgKE1hdGguc2luKG1lLmlkICogMC42OSkgKiAyNCArCiAgICAgICAgICAgICAgICBNYXRoLnNpbigKICAgICAgICAgICAgICAgICAgR2FtZS5UICogKDAuMzUgKyBNYXRoLnNpbihtZS5pZCAqIDAuOTcpICogMC4xNSkgKwogICAgICAgICAgICAgICAgICAgIG1lLmlkIC8qK01hdGguc2luKEdhbWUuVCowLjA3KSoyKzIqLwogICAgICAgICAgICAgICAgKSAqCiAgICAgICAgICAgICAgICAgICgzICsgTWF0aC5zaW4obWUuaWQgKiAwLjM2KSAqIDIpKSArCiAgICAgICAgICAgICAgImRlZykgc2NhbGUoIiArCiAgICAgICAgICAgICAgbWUuc2l6ZU11bHQgKgogICAgICAgICAgICAgICAgKDEgKyBNYXRoLnNpbihtZS5pZCAqIDAuNTMpICogMC4yKSAqCiAgICAgICAgICAgICAgICBjdXJ2ZSAqCiAgICAgICAgICAgICAgICAoMSArCiAgICAgICAgICAgICAgICAgICgwLjA2ICsgTWF0aC5zaW4obWUuaWQgKiAwLjQxKSAqIDAuMDUpICoKICAgICAgICAgICAgICAgICAgICBNYXRoLnNpbigKICAgICAgICAgICAgICAgICAgICAgIEdhbWUuVCAqICgwLjI1ICsgTWF0aC5zaW4obWUuaWQgKiAwLjczKSAqIDAuMTUpICsgbWUuaWQKICAgICAgICAgICAgICAgICAgICApKSArCiAgICAgICAgICAgICAgIikiOwogICAgICAgICAgbWUubGlmZS0tOwogICAgICAgICAgaWYgKG1lLmxpZmUgPD0gMCkgewogICAgICAgICAgICB0aGlzLm1pc3NGdW5jKG1lKTsKICAgICAgICAgICAgbWUuZGllKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBwb3BGdW5jOiBmdW5jdGlvbiAobWUpIHsKICAgICAgICAgIC8vZ2V0IGFjaGlldnMgYW5kIHN0YXRzCiAgICAgICAgICBpZiAobWUuc3Bhd25MZWFkKSB7CiAgICAgICAgICAgIEdhbWUuZ29sZGVuQ2xpY2tzKys7CiAgICAgICAgICAgIEdhbWUuZ29sZGVuQ2xpY2tzTG9jYWwrKzsKCiAgICAgICAgICAgIGlmIChHYW1lLmdvbGRlbkNsaWNrcyA+PSAxKSBHYW1lLldpbigiR29sZGVuIGNvb2tpZSIpOwogICAgICAgICAgICBpZiAoR2FtZS5nb2xkZW5DbGlja3MgPj0gNykgR2FtZS5XaW4oIkx1Y2t5IGNvb2tpZSIpOwogICAgICAgICAgICBpZiAoR2FtZS5nb2xkZW5DbGlja3MgPj0gMjcpIEdhbWUuV2luKCJBIHN0cm9rZSBvZiBsdWNrIik7CiAgICAgICAgICAgIGlmIChHYW1lLmdvbGRlbkNsaWNrcyA+PSA3NykgR2FtZS5XaW4oIkZvcnR1bmUiKTsKICAgICAgICAgICAgaWYgKEdhbWUuZ29sZGVuQ2xpY2tzID49IDc3NykgR2FtZS5XaW4oIkxlcHJlY2hhdW4iKTsKICAgICAgICAgICAgaWYgKEdhbWUuZ29sZGVuQ2xpY2tzID49IDc3NzcpIEdhbWUuV2luKCJCbGFjayBjYXQncyBwYXciKTsKICAgICAgICAgICAgaWYgKEdhbWUuZ29sZGVuQ2xpY2tzID49IDI3Nzc3KSBHYW1lLldpbigiU2V2ZW4gaG9yc2VzaG9lcyIpOwoKICAgICAgICAgICAgaWYgKEdhbWUuZ29sZGVuQ2xpY2tzID49IDcpIEdhbWUuVW5sb2NrKCJMdWNreSBkYXkiKTsKICAgICAgICAgICAgaWYgKEdhbWUuZ29sZGVuQ2xpY2tzID49IDI3KSBHYW1lLlVubG9jaygiU2VyZW5kaXBpdHkiKTsKICAgICAgICAgICAgaWYgKEdhbWUuZ29sZGVuQ2xpY2tzID49IDc3KSBHYW1lLlVubG9jaygiR2V0IGx1Y2t5Iik7CgogICAgICAgICAgICBpZiAobWUubGlmZSAvIEdhbWUuZnBzID4gbWUuZHVyIC0gMSkgR2FtZS5XaW4oIkVhcmx5IGJpcmQiKTsKICAgICAgICAgICAgaWYgKG1lLmxpZmUgPCBHYW1lLmZwcykgR2FtZS5XaW4oIkZhZGluZyBsdWNrIik7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKEdhbWUuZm9yY2VVbnNsb3RHb2QpIHsKICAgICAgICAgICAgaWYgKEdhbWUuZm9yY2VVbnNsb3RHb2QoImFzY2V0aWNpc20iKSkgR2FtZS51c2VTd2FwKDEwMDAwMDApOwogICAgICAgICAgfQoKICAgICAgICAgIC8vc2VsZWN0IGFuIGVmZmVjdAogICAgICAgICAgdmFyIGxpc3QgPSBbXTsKICAgICAgICAgIGlmIChtZS53cmF0aCA+IDApCiAgICAgICAgICAgIGxpc3QucHVzaCgiY2xvdCIsICJtdWx0aXBseSBjb29raWVzIiwgInJ1aW4gY29va2llcyIpOwogICAgICAgICAgZWxzZSBsaXN0LnB1c2goImZyZW56eSIsICJtdWx0aXBseSBjb29raWVzIik7CiAgICAgICAgICBpZiAobWUud3JhdGggPiAwICYmIEdhbWUuaGFzR29kICYmIEdhbWUuaGFzR29kKCJzY29ybiIpKQogICAgICAgICAgICBsaXN0LnB1c2goImNsb3QiLCAicnVpbiBjb29raWVzIiwgImNsb3QiLCAicnVpbiBjb29raWVzIik7CiAgICAgICAgICBpZiAobWUud3JhdGggPiAwICYmIE1hdGgucmFuZG9tKCkgPCAwLjMpCiAgICAgICAgICAgIGxpc3QucHVzaCgiYmxvb2QgZnJlbnp5IiwgImNoYWluIGNvb2tpZSIsICJjb29raWUgc3Rvcm0iKTsKICAgICAgICAgIGVsc2UgaWYgKE1hdGgucmFuZG9tKCkgPCAwLjAzICYmIEdhbWUuY29va2llc0Vhcm5lZCA+PSAxMDAwMDApCiAgICAgICAgICAgIGxpc3QucHVzaCgiY2hhaW4gY29va2llIiwgImNvb2tpZSBzdG9ybSIpOwogICAgICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPCAwLjA1ICYmIEdhbWUuc2Vhc29uID09ICJmb29scyIpCiAgICAgICAgICAgIGxpc3QucHVzaCgiZXZlcnl0aGluZyBtdXN0IGdvIik7CiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIE1hdGgucmFuZG9tKCkgPCAwLjEgJiYKICAgICAgICAgICAgKE1hdGgucmFuZG9tKCkgPCAwLjA1IHx8ICFHYW1lLmhhc0J1ZmYoIkRyYWdvbmZsaWdodCIpKQogICAgICAgICAgKQogICAgICAgICAgICBsaXN0LnB1c2goImNsaWNrIGZyZW56eSIpOwogICAgICAgICAgaWYgKG1lLndyYXRoICYmIE1hdGgucmFuZG9tKCkgPCAwLjEpIGxpc3QucHVzaCgiY3Vyc2VkIGZpbmdlciIpOwoKICAgICAgICAgIGlmIChHYW1lLkJ1aWxkaW5nc093bmVkID49IDEwICYmIE1hdGgucmFuZG9tKCkgPCAwLjI1KQogICAgICAgICAgICBsaXN0LnB1c2goImJ1aWxkaW5nIHNwZWNpYWwiKTsKCiAgICAgICAgICBpZiAoR2FtZS5jYW5MdW1wcygpICYmIE1hdGgucmFuZG9tKCkgPCAwLjAwMDUpCiAgICAgICAgICAgIGxpc3QucHVzaCgiZnJlZSBzdWdhciBsdW1wIik7CgogICAgICAgICAgaWYgKChtZS53cmF0aCA9PSAwICYmIE1hdGgucmFuZG9tKCkgPCAwLjE1KSB8fCBNYXRoLnJhbmRvbSgpIDwgMC4wNSkgewogICAgICAgICAgICAvL2lmIChHYW1lLmhhc0F1cmEoJ1JlYXBlciBvZiBGaWVsZHMnKSkgbGlzdC5wdXNoKCdkcmFnb24gaGFydmVzdCcpOwogICAgICAgICAgICBpZiAoTWF0aC5yYW5kb20oKSA8IEdhbWUuYXVyYU11bHQoIlJlYXBlciBvZiBGaWVsZHMiKSkKICAgICAgICAgICAgICBsaXN0LnB1c2goImRyYWdvbiBoYXJ2ZXN0Iik7CiAgICAgICAgICAgIC8vaWYgKEdhbWUuaGFzQXVyYSgnRHJhZ29uZmxpZ2h0JykpIGxpc3QucHVzaCgnZHJhZ29uZmxpZ2h0Jyk7CiAgICAgICAgICAgIGlmIChNYXRoLnJhbmRvbSgpIDwgR2FtZS5hdXJhTXVsdCgiRHJhZ29uZmxpZ2h0IikpCiAgICAgICAgICAgICAgbGlzdC5wdXNoKCJkcmFnb25mbGlnaHQiKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIHRoaXMubGFzdCAhPSAiIiAmJgogICAgICAgICAgICBNYXRoLnJhbmRvbSgpIDwgMC44ICYmCiAgICAgICAgICAgIGxpc3QuaW5kZXhPZih0aGlzLmxhc3QpICE9IC0xCiAgICAgICAgICApCiAgICAgICAgICAgIGxpc3Quc3BsaWNlKGxpc3QuaW5kZXhPZih0aGlzLmxhc3QpLCAxKTsgLy84MCUgY2hhbmNlIHRvIGZvcmNlIGEgZGlmZmVyZW50IG9uZQogICAgICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPCAwLjAwMDEpIGxpc3QucHVzaCgiYmxhYiIpOwogICAgICAgICAgdmFyIGNob2ljZSA9IGNob29zZShsaXN0KTsKCiAgICAgICAgICBpZiAodGhpcy5jaGFpbiA+IDApIGNob2ljZSA9ICJjaGFpbiBjb29raWUiOwogICAgICAgICAgaWYgKG1lLmZvcmNlICE9ICIiKSB7CiAgICAgICAgICAgIHRoaXMuY2hhaW4gPSAwOwogICAgICAgICAgICBjaG9pY2UgPSBtZS5mb3JjZTsKICAgICAgICAgICAgbWUuZm9yY2UgPSAiIjsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChjaG9pY2UgIT0gImNoYWluIGNvb2tpZSIpIHRoaXMuY2hhaW4gPSAwOwoKICAgICAgICAgIHRoaXMubGFzdCA9IGNob2ljZTsKCiAgICAgICAgICAvL2NyZWF0ZSBidWZmIGZvciBlZmZlY3QKICAgICAgICAgIC8vYnVmZiBkdXJhdGlvbiBtdWx0aXBsaWVyCiAgICAgICAgICB2YXIgZWZmZWN0RHVyTW9kID0gMTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiR2V0IGx1Y2t5IikpIGVmZmVjdER1ck1vZCAqPSAyOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJMYXN0aW5nIGZvcnR1bmUiKSkgZWZmZWN0RHVyTW9kICo9IDEuMTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiTHVja3kgZGlnaXQiKSkgZWZmZWN0RHVyTW9kICo9IDEuMDE7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIkx1Y2t5IG51bWJlciIpKSBlZmZlY3REdXJNb2QgKj0gMS4wMTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiR3JlZW4geWVhc3QgZGlnZXN0aXZlcyIpKSBlZmZlY3REdXJNb2QgKj0gMS4wMTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiTHVja3kgcGF5b3V0IikpIGVmZmVjdER1ck1vZCAqPSAxLjAxOwogICAgICAgICAgLy9pZiAoR2FtZS5oYXNBdXJhKCdFcG9jaCBNYW5pcHVsYXRvcicpKSBlZmZlY3REdXJNb2QqPTEuMDU7CiAgICAgICAgICBlZmZlY3REdXJNb2QgKj0gMSArIEdhbWUuYXVyYU11bHQoIkVwb2NoIE1hbmlwdWxhdG9yIikgKiAwLjA1OwogICAgICAgICAgaWYgKCFtZS53cmF0aCkgZWZmZWN0RHVyTW9kICo9IEdhbWUuZWZmKCJnb2xkZW5Db29raWVFZmZEdXIiKTsKICAgICAgICAgIGVsc2UgZWZmZWN0RHVyTW9kICo9IEdhbWUuZWZmKCJ3cmF0aENvb2tpZUVmZkR1ciIpOwoKICAgICAgICAgIGlmIChHYW1lLmhhc0dvZCkgewogICAgICAgICAgICB2YXIgZ29kTHZsID0gR2FtZS5oYXNHb2QoImRlY2FkZW5jZSIpOwogICAgICAgICAgICBpZiAoZ29kTHZsID09IDEpIGVmZmVjdER1ck1vZCAqPSAxLjA3OwogICAgICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMikgZWZmZWN0RHVyTW9kICo9IDEuMDU7CiAgICAgICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAzKSBlZmZlY3REdXJNb2QgKj0gMS4wMjsKICAgICAgICAgIH0KCiAgICAgICAgICAvL2VmZmVjdCBtdWx0aXBsaWVyIChmcm9tIGx1Y2t5IGV0YykKICAgICAgICAgIHZhciBtdWx0ID0gMTsKICAgICAgICAgIC8vaWYgKG1lLndyYXRoPjAgJiYgR2FtZS5oYXNBdXJhKCdVbmhvbHkgRG9taW5pb24nKSkgbXVsdCo9MS4xOwogICAgICAgICAgLy9lbHNlIGlmIChtZS53cmF0aD09MCAmJiBHYW1lLmhhc0F1cmEoJ0FuY2VzdHJhbCBNZXRhbW9ycGhvc2lzJykpIG11bHQqPTEuMTsKICAgICAgICAgIGlmIChtZS53cmF0aCA+IDApIG11bHQgKj0gMSArIEdhbWUuYXVyYU11bHQoIlVuaG9seSBEb21pbmlvbiIpICogMC4xOwogICAgICAgICAgZWxzZSBpZiAobWUud3JhdGggPT0gMCkKICAgICAgICAgICAgbXVsdCAqPSAxICsgR2FtZS5hdXJhTXVsdCgiQW5jZXN0cmFsIE1ldGFtb3JwaG9zaXMiKSAqIDAuMTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiR3JlZW4geWVhc3QgZGlnZXN0aXZlcyIpKSBtdWx0ICo9IDEuMDE7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIkRyYWdvbiBmYW5nIikpIG11bHQgKj0gMS4wMzsKICAgICAgICAgIGlmICghbWUud3JhdGgpIG11bHQgKj0gR2FtZS5lZmYoImdvbGRlbkNvb2tpZUdhaW4iKTsKICAgICAgICAgIGVsc2UgbXVsdCAqPSBHYW1lLmVmZigid3JhdGhDb29raWVHYWluIik7CgogICAgICAgICAgdmFyIHBvcHVwID0gIiI7CiAgICAgICAgICB2YXIgYnVmZiA9IDA7CgogICAgICAgICAgaWYgKGNob2ljZSA9PSAiYnVpbGRpbmcgc3BlY2lhbCIpIHsKICAgICAgICAgICAgdmFyIHRpbWUgPSBNYXRoLmNlaWwoMzAgKiBlZmZlY3REdXJNb2QpOwogICAgICAgICAgICB2YXIgbGlzdCA9IFtdOwogICAgICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0cykgewogICAgICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbaV0uYW1vdW50ID49IDEwKSBsaXN0LnB1c2goR2FtZS5PYmplY3RzW2ldLmlkKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAobGlzdC5sZW5ndGggPT0gMCkgewogICAgICAgICAgICAgIGNob2ljZSA9ICJmcmVuenkiOwogICAgICAgICAgICB9IC8vZGVmYXVsdCB0byBmcmVuenkgaWYgbm8gcHJvcGVyIGJ1aWxkaW5nCiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgIHZhciBvYmogPSBjaG9vc2UobGlzdCk7CiAgICAgICAgICAgICAgdmFyIHBvdyA9IEdhbWUuT2JqZWN0c0J5SWRbb2JqXS5hbW91bnQgLyAxMCArIDE7CiAgICAgICAgICAgICAgaWYgKG1lLndyYXRoICYmIE1hdGgucmFuZG9tKCkgPCAwLjMpIHsKICAgICAgICAgICAgICAgIGJ1ZmYgPSBHYW1lLmdhaW5CdWZmKCJidWlsZGluZyBkZWJ1ZmYiLCB0aW1lLCBwb3csIG9iaik7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGJ1ZmYgPSBHYW1lLmdhaW5CdWZmKCJidWlsZGluZyBidWZmIiwgdGltZSwgcG93LCBvYmopOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGlmIChjaG9pY2UgPT0gImZyZWUgc3VnYXIgbHVtcCIpIHsKICAgICAgICAgICAgR2FtZS5nYWluTHVtcHMoMSk7CiAgICAgICAgICAgIHBvcHVwID0gbG9jKCJTd2VldCE8YnI+PHNtYWxsPkZvdW5kIDEgc3VnYXIgbHVtcCE8L3NtYWxsPiIpOwogICAgICAgICAgfSBlbHNlIGlmIChjaG9pY2UgPT0gImZyZW56eSIpIHsKICAgICAgICAgICAgYnVmZiA9IEdhbWUuZ2FpbkJ1ZmYoImZyZW56eSIsIE1hdGguY2VpbCg3NyAqIGVmZmVjdER1ck1vZCksIDcpOwogICAgICAgICAgfSBlbHNlIGlmIChjaG9pY2UgPT0gImRyYWdvbiBoYXJ2ZXN0IikgewogICAgICAgICAgICBidWZmID0gR2FtZS5nYWluQnVmZigKICAgICAgICAgICAgICAiZHJhZ29uIGhhcnZlc3QiLAogICAgICAgICAgICAgIE1hdGguY2VpbCg2MCAqIGVmZmVjdER1ck1vZCksCiAgICAgICAgICAgICAgMTUKICAgICAgICAgICAgKTsKICAgICAgICAgIH0gZWxzZSBpZiAoY2hvaWNlID09ICJldmVyeXRoaW5nIG11c3QgZ28iKSB7CiAgICAgICAgICAgIGJ1ZmYgPSBHYW1lLmdhaW5CdWZmKAogICAgICAgICAgICAgICJldmVyeXRoaW5nIG11c3QgZ28iLAogICAgICAgICAgICAgIE1hdGguY2VpbCg4ICogZWZmZWN0RHVyTW9kKSwKICAgICAgICAgICAgICA1CiAgICAgICAgICAgICk7CiAgICAgICAgICB9IGVsc2UgaWYgKGNob2ljZSA9PSAibXVsdGlwbHkgY29va2llcyIpIHsKICAgICAgICAgICAgdmFyIG1vbmkgPQogICAgICAgICAgICAgIG11bHQgKiBNYXRoLm1pbihHYW1lLmNvb2tpZXMgKiAwLjE1LCBHYW1lLmNvb2tpZXNQcyAqIDYwICogMTUpICsKICAgICAgICAgICAgICAxMzsgLy9hZGQgMTUlIHRvIGNvb2tpZXMgb3duZWQgKCsxMyksIG9yIDE1IG1pbnV0ZXMgb2YgY29va2llIHByb2R1Y3Rpb24gLSB3aGljaGV2ZXIgaXMgbG93ZXN0CiAgICAgICAgICAgIEdhbWUuRWFybihtb25pKTsKICAgICAgICAgICAgcG9wdXAgPQogICAgICAgICAgICAgIGxvYygiTHVja3khIikgKwogICAgICAgICAgICAgICI8YnI+PHNtYWxsPiIgKwogICAgICAgICAgICAgIGxvYygiKyUxISIsIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KG1vbmkpKSkgKwogICAgICAgICAgICAgICI8L3NtYWxsPiI7CiAgICAgICAgICB9IGVsc2UgaWYgKGNob2ljZSA9PSAicnVpbiBjb29raWVzIikgewogICAgICAgICAgICB2YXIgbW9uaSA9CiAgICAgICAgICAgICAgTWF0aC5taW4oR2FtZS5jb29raWVzICogMC4wNSwgR2FtZS5jb29raWVzUHMgKiA2MCAqIDEwKSArIDEzOyAvL2xvc2UgNSUgb2YgY29va2llcyBvd25lZCAoLTEzKSwgb3IgMTAgbWludXRlcyBvZiBjb29raWUgcHJvZHVjdGlvbiAtIHdoaWNoZXZlciBpcyBsb3dlc3QKICAgICAgICAgICAgbW9uaSA9IE1hdGgubWluKEdhbWUuY29va2llcywgbW9uaSk7CiAgICAgICAgICAgIEdhbWUuU3BlbmQobW9uaSk7CiAgICAgICAgICAgIHBvcHVwID0KICAgICAgICAgICAgICBsb2MoIlJ1aW4hIikgKwogICAgICAgICAgICAgICI8YnI+PHNtYWxsPiIgKwogICAgICAgICAgICAgIGxvYygiTG9zdCAlMSEiLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeShtb25pKSkpICsKICAgICAgICAgICAgICAiPC9zbWFsbD4iOwogICAgICAgICAgfSBlbHNlIGlmIChjaG9pY2UgPT0gImJsb29kIGZyZW56eSIpIHsKICAgICAgICAgICAgYnVmZiA9IEdhbWUuZ2FpbkJ1ZmYoCiAgICAgICAgICAgICAgImJsb29kIGZyZW56eSIsCiAgICAgICAgICAgICAgTWF0aC5jZWlsKDYgKiBlZmZlY3REdXJNb2QpLAogICAgICAgICAgICAgIDY2NgogICAgICAgICAgICApOwogICAgICAgICAgfSBlbHNlIGlmIChjaG9pY2UgPT0gImNsb3QiKSB7CiAgICAgICAgICAgIGJ1ZmYgPSBHYW1lLmdhaW5CdWZmKCJjbG90IiwgTWF0aC5jZWlsKDY2ICogZWZmZWN0RHVyTW9kKSwgMC41KTsKICAgICAgICAgIH0gZWxzZSBpZiAoY2hvaWNlID09ICJjdXJzZWQgZmluZ2VyIikgewogICAgICAgICAgICBidWZmID0gR2FtZS5nYWluQnVmZigKICAgICAgICAgICAgICAiY3Vyc2VkIGZpbmdlciIsCiAgICAgICAgICAgICAgTWF0aC5jZWlsKDEwICogZWZmZWN0RHVyTW9kKSwKICAgICAgICAgICAgICBHYW1lLmNvb2tpZXNQcyAqIE1hdGguY2VpbCgxMCAqIGVmZmVjdER1ck1vZCkKICAgICAgICAgICAgKTsKICAgICAgICAgIH0gZWxzZSBpZiAoY2hvaWNlID09ICJjbGljayBmcmVuenkiKSB7CiAgICAgICAgICAgIGJ1ZmYgPSBHYW1lLmdhaW5CdWZmKAogICAgICAgICAgICAgICJjbGljayBmcmVuenkiLAogICAgICAgICAgICAgIE1hdGguY2VpbCgxMyAqIGVmZmVjdER1ck1vZCksCiAgICAgICAgICAgICAgNzc3CiAgICAgICAgICAgICk7CiAgICAgICAgICB9IGVsc2UgaWYgKGNob2ljZSA9PSAiZHJhZ29uZmxpZ2h0IikgewogICAgICAgICAgICBidWZmID0gR2FtZS5nYWluQnVmZigKICAgICAgICAgICAgICAiZHJhZ29uZmxpZ2h0IiwKICAgICAgICAgICAgICBNYXRoLmNlaWwoMTAgKiBlZmZlY3REdXJNb2QpLAogICAgICAgICAgICAgIDExMTEKICAgICAgICAgICAgKTsKICAgICAgICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPCAwLjgpIEdhbWUua2lsbEJ1ZmYoIkNsaWNrIGZyZW56eSIpOwogICAgICAgICAgfSBlbHNlIGlmIChjaG9pY2UgPT0gImNoYWluIGNvb2tpZSIpIHsKICAgICAgICAgICAgLy9maXggYnkgSWNlaGF3azc4CiAgICAgICAgICAgIGlmICh0aGlzLmNoYWluID09IDApIHRoaXMudG90YWxGcm9tQ2hhaW4gPSAwOwogICAgICAgICAgICB0aGlzLmNoYWluKys7CiAgICAgICAgICAgIHZhciBkaWdpdCA9IG1lLndyYXRoID8gNiA6IDc7CiAgICAgICAgICAgIGlmICh0aGlzLmNoYWluID09IDEpCiAgICAgICAgICAgICAgdGhpcy5jaGFpbiArPSBNYXRoLm1heCgKICAgICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgICBNYXRoLmNlaWwoTWF0aC5sb2coR2FtZS5jb29raWVzKSAvIE1hdGguTE4xMCkgLSAxMAogICAgICAgICAgICAgICk7CgogICAgICAgICAgICB2YXIgbWF4UGF5b3V0ID0KICAgICAgICAgICAgICBNYXRoLm1pbihHYW1lLmNvb2tpZXNQcyAqIDYwICogNjAgKiA2LCBHYW1lLmNvb2tpZXMgKiAwLjUpICogbXVsdDsKICAgICAgICAgICAgdmFyIG1vbmkgPSBNYXRoLm1heCgKICAgICAgICAgICAgICBkaWdpdCwKICAgICAgICAgICAgICBNYXRoLm1pbigKICAgICAgICAgICAgICAgIE1hdGguZmxvb3IoKDEgLyA5KSAqIE1hdGgucG93KDEwLCB0aGlzLmNoYWluKSAqIGRpZ2l0ICogbXVsdCksCiAgICAgICAgICAgICAgICBtYXhQYXlvdXQKICAgICAgICAgICAgICApCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHZhciBuZXh0TW9uaSA9IE1hdGgubWF4KAogICAgICAgICAgICAgIGRpZ2l0LAogICAgICAgICAgICAgIE1hdGgubWluKAogICAgICAgICAgICAgICAgTWF0aC5mbG9vcigKICAgICAgICAgICAgICAgICAgKDEgLyA5KSAqIE1hdGgucG93KDEwLCB0aGlzLmNoYWluICsgMSkgKiBkaWdpdCAqIG11bHQKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBtYXhQYXlvdXQKICAgICAgICAgICAgICApCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHRoaXMudG90YWxGcm9tQ2hhaW4gKz0gbW9uaTsKCiAgICAgICAgICAgIC8vYnJlYWsgdGhlIGNoYWluIGlmIHdlJ3JlIGFib3ZlIDUgZGlnaXRzIEFORCBpdCdzIG1vcmUgdGhhbiA1MCUgb2Ygb3VyIGJhbmssIGl0IGdyYW50cyBtb3JlIHRoYW4gNiBob3VycyBvZiBvdXIgQ3BTLCBvciBqdXN0IGEgMSUgY2hhbmNlIGVhY2ggZGlnaXQgKHVwZGF0ZSA6IHJlbW92ZWQgZGlnaXQgbGltaXQpCiAgICAgICAgICAgIGlmIChNYXRoLnJhbmRvbSgpIDwgMC4wMSB8fCBuZXh0TW9uaSA+PSBtYXhQYXlvdXQpIHsKICAgICAgICAgICAgICB0aGlzLmNoYWluID0gMDsKICAgICAgICAgICAgICBwb3B1cCA9CiAgICAgICAgICAgICAgICBsb2MoIkNvb2tpZSBjaGFpbiIpICsKICAgICAgICAgICAgICAgICI8YnI+PHNtYWxsPiIgKwogICAgICAgICAgICAgICAgbG9jKCIrJTEhIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkobW9uaSkpKSArCiAgICAgICAgICAgICAgICAiPGJyPiIgKwogICAgICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICAgICAiQ29va2llIGNoYWluIG92ZXIuIFlvdSBtYWRlICUxLiIsCiAgICAgICAgICAgICAgICAgIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KHRoaXMudG90YWxGcm9tQ2hhaW4pKQogICAgICAgICAgICAgICAgKSArCiAgICAgICAgICAgICAgICAiPC9zbWFsbD4iOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHBvcHVwID0KICAgICAgICAgICAgICAgIGxvYygiQ29va2llIGNoYWluIikgKwogICAgICAgICAgICAgICAgIjxicj48c21hbGw+IiArCiAgICAgICAgICAgICAgICBsb2MoIislMSEiLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeShtb25pKSkpICsKICAgICAgICAgICAgICAgICI8L3NtYWxsPiI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgR2FtZS5FYXJuKG1vbmkpOwogICAgICAgICAgfSBlbHNlIGlmIChjaG9pY2UgPT0gImNvb2tpZSBzdG9ybSIpIHsKICAgICAgICAgICAgYnVmZiA9IEdhbWUuZ2FpbkJ1ZmYoCiAgICAgICAgICAgICAgImNvb2tpZSBzdG9ybSIsCiAgICAgICAgICAgICAgTWF0aC5jZWlsKDcgKiBlZmZlY3REdXJNb2QpLAogICAgICAgICAgICAgIDcKICAgICAgICAgICAgKTsKICAgICAgICAgIH0gZWxzZSBpZiAoY2hvaWNlID09ICJjb29raWUgc3Rvcm0gZHJvcCIpIHsKICAgICAgICAgICAgdmFyIG1vbmkgPSBNYXRoLm1heCgKICAgICAgICAgICAgICBtdWx0ICogKEdhbWUuY29va2llc1BzICogNjAgKiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3ICsgMSkpLAogICAgICAgICAgICAgIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcgKyAxKQogICAgICAgICAgICApOyAvL2VpdGhlciAxLTcgY29va2llcyBvciAxLTcgbWludXRlcyBvZiBjb29raWUgcHJvZHVjdGlvbiwgd2hpY2hldmVyIGlzIGhpZ2hlc3QKICAgICAgICAgICAgR2FtZS5FYXJuKG1vbmkpOwogICAgICAgICAgICBwb3B1cCA9CiAgICAgICAgICAgICAgJzxkaXYgc3R5bGU9ImZvbnQtc2l6ZTo3NSU7Ij4nICsKICAgICAgICAgICAgICBsb2MoIislMSEiLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeShtb25pKSkpICsKICAgICAgICAgICAgICAiPC9kaXY+IjsKICAgICAgICAgIH0gZWxzZSBpZiAoY2hvaWNlID09ICJibGFiIikgewogICAgICAgICAgICAvL3NvcnJ5IChpdCdzIHJlYWxseSByYXJlKQogICAgICAgICAgICB2YXIgc3RyID0gRU4KICAgICAgICAgICAgICA/IGNob29zZShbCiAgICAgICAgICAgICAgICAgICJDb29raWUgY3J1bWJsaW5lc3MgeDMgZm9yIDYwIHNlY29uZHMhIiwKICAgICAgICAgICAgICAgICAgIkNob2NvbGF0aW5lc3MgeDcgZm9yIDc3IHNlY29uZHMhIiwKICAgICAgICAgICAgICAgICAgIkRvdWdoIGVsYXN0aWNpdHkgaGFsdmVkIGZvciA2NiBzZWNvbmRzISIsCiAgICAgICAgICAgICAgICAgICJHb2xkZW4gY29va2llIHNoaW5pbmVzcyBkb3VibGVkIGZvciAzIHNlY29uZHMhIiwKICAgICAgICAgICAgICAgICAgIldvcmxkIGVjb25vbXkgaGFsdmVkIGZvciAzMCBzZWNvbmRzISIsCiAgICAgICAgICAgICAgICAgICJHcmFuZG1hIGtpc3NlcyAyMyUgc3RpbmdpZXIgZm9yIDQ1IHNlY29uZHMhIiwKICAgICAgICAgICAgICAgICAgIlRoYW5rcyBmb3IgY2xpY2tpbmchIiwKICAgICAgICAgICAgICAgICAgIkZvb2xlZCB5b3UhIFRoaXMgb25lIHdhcyBqdXN0IGEgdGVzdC4iLAogICAgICAgICAgICAgICAgICAiR29sZGVuIGNvb2tpZXMgY2xpY2tlZCArMSEiLAogICAgICAgICAgICAgICAgICAiWW91ciBjbGljayBoYXMgYmVlbiByZWdpc3RlcmVkLiBUaGFuayB5b3UgZm9yIHlvdXIgY29vcGVyYXRpb24uIiwKICAgICAgICAgICAgICAgICAgIlRoYW5rcyEgVGhhdCBoaXQgdGhlIHNwb3QhIiwKICAgICAgICAgICAgICAgICAgIlRoYW5rIHlvdS4gQSB0ZWFtIGhhcyBiZWVuIGRpc3BhdGNoZWQuIiwKICAgICAgICAgICAgICAgICAgIlRoZXkga25vdy4iLAogICAgICAgICAgICAgICAgICAiT29wcy4gVGhpcyB3YXMganVzdCBhIGNob2NvbGF0ZSBjb29raWUgd2l0aCBzaGlueSBhbHVtaW5pdW0gZm9pbC4iLAogICAgICAgICAgICAgICAgICAiRXNjaGF0b24gaW1tYW5lbnRpemVkISIsCiAgICAgICAgICAgICAgICAgICJPaCwgdGhhdCB0aWNrbGVkISIsCiAgICAgICAgICAgICAgICAgICJBZ2Fpbi4iLAogICAgICAgICAgICAgICAgICAiWW91J3ZlIG1hZGUgYSBncmF2ZSBtaXN0YWtlLiIsCiAgICAgICAgICAgICAgICAgICJDaG9jb2xhdGUgY2hpcHMgcmVzaHVmZmxlZCEiLAogICAgICAgICAgICAgICAgICAiUmFuZG9taXplZCBjaGFuY2UgY2FyZCBvdXRjb21lISIsCiAgICAgICAgICAgICAgICAgICJNb3VzZSBhY2NlbGVyYXRpb24gKzAuMDMlISIsCiAgICAgICAgICAgICAgICAgICJBc2NlbnNpb24gYm9udXNlcyB4NSwwMDAgZm9yIDAuMSBzZWNvbmRzISIsCiAgICAgICAgICAgICAgICAgICJHYWluZWQgMSBleHRyYSEiLAogICAgICAgICAgICAgICAgICAiU29ycnksIGJldHRlciBsdWNrIG5leHQgdGltZSEiLAogICAgICAgICAgICAgICAgICAiSSBmZWx0IHRoYXQuIiwKICAgICAgICAgICAgICAgICAgIk5pY2UgdHJ5LCBidXQgbm8uIiwKICAgICAgICAgICAgICAgICAgIldhaXQsIHNvcnJ5LCBJIHdhc24ndCByZWFkeSB5ZXQuIiwKICAgICAgICAgICAgICAgICAgIllpcHBlZSEiLAogICAgICAgICAgICAgICAgICAiQm9uZXMgcmVtb3ZlZC4iLAogICAgICAgICAgICAgICAgICAiT3JnYW5zIGFkZGVkLiIsCiAgICAgICAgICAgICAgICAgICJEaWQgeW91IGp1c3QgY2xpY2sgdGhhdD8iLAogICAgICAgICAgICAgICAgICAiSHVoPyBPaCwgdGhlcmUgd2FzIG5vdGhpbmcgdGhlcmUuIiwKICAgICAgICAgICAgICAgICAgIllvdSBzYXcgbm90aGluZy4iLAogICAgICAgICAgICAgICAgICAiSXQgc2VlbXMgeW91IGhhbGx1Y2luYXRlZCB0aGF0IGdvbGRlbiBjb29raWUuIiwKICAgICAgICAgICAgICAgICAgIlRoaXMgZ29sZGVuIGNvb2tpZSB3YXMgYSBjb21wbGV0ZSBmYWJyaWNhdGlvbi4iLAogICAgICAgICAgICAgICAgICAiSW4gdGhlb3J5IHRoZXJlJ3Mgbm8gd3Jvbmcgd2F5IHRvIGNsaWNrIGEgZ29sZGVuIGNvb2tpZSwgYnV0IHlvdSBqdXN0IGRpZCB0aGF0LCBzb21laG93LiIsCiAgICAgICAgICAgICAgICAgICJBbGwgY29va2llcyBtdWx0aXBsaWVkIGJ5IDk5OSE8YnI+QWxsIGNvb2tpZXMgZGl2aWRlZCBieSA5OTkhIiwKICAgICAgICAgICAgICAgICAgIldoeT8iLAogICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICA6IGNob29zZShsb2MoIkNvb2tpZSBibGFiIikpOwogICAgICAgICAgICBwb3B1cCA9IHN0cjsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAocG9wdXAgPT0gIiIgJiYgYnVmZiAmJiBidWZmLm5hbWUgJiYgYnVmZi5kZXNjKQogICAgICAgICAgICBwb3B1cCA9CiAgICAgICAgICAgICAgYnVmZi5kbmFtZSArCiAgICAgICAgICAgICAgJzxkaXYgc3R5bGU9ImZvbnQtc2l6ZTo2NSU7Ij4nICsKICAgICAgICAgICAgICBidWZmLmRlc2MgKwogICAgICAgICAgICAgICI8L2Rpdj4iOwogICAgICAgICAgaWYgKHBvcHVwICE9ICIiKSBHYW1lLlBvcHVwKHBvcHVwLCBtZS54ICsgbWUubC5vZmZzZXRXaWR0aCAvIDIsIG1lLnkpOwoKICAgICAgICAgIEdhbWUuRHJvcEVnZygwLjkpOwoKICAgICAgICAgIC8vc3BhcmtsZSBhbmQga2lsbCB0aGUgc2hpbW1lcgogICAgICAgICAgR2FtZS5TcGFya2xlQXQobWUueCArIDQ4LCBtZS55ICsgNDgpOwogICAgICAgICAgaWYgKGNob2ljZSA9PSAiY29va2llIHN0b3JtIGRyb3AiKSB7CiAgICAgICAgICAgIGlmIChHYW1lLnByZWZzLmNvb2tpZXNvdW5kKQogICAgICAgICAgICAgIFBsYXlTb3VuZCgKICAgICAgICAgICAgICAgICJzbmQvY2xpY2tiIiArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcgKyAxKSArICIubXAzIiwKICAgICAgICAgICAgICAgIDAuNzUKICAgICAgICAgICAgICApOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgUGxheVNvdW5kKAogICAgICAgICAgICAgICAgInNuZC9jbGljayIgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3ICsgMSkgKyAiLm1wMyIsCiAgICAgICAgICAgICAgICAwLjc1CiAgICAgICAgICAgICAgKTsKICAgICAgICAgIH0gZWxzZSBQbGF5U291bmQoInNuZC9zaGltbWVyQ2xpY2subXAzIik7CiAgICAgICAgICBtZS5kaWUoKTsKICAgICAgICB9LAogICAgICAgIG1pc3NGdW5jOiBmdW5jdGlvbiAobWUpIHsKICAgICAgICAgIGlmICh0aGlzLmNoYWluID4gMCAmJiB0aGlzLnRvdGFsRnJvbUNoYWluID4gMCkgewogICAgICAgICAgICBHYW1lLlBvcHVwKAogICAgICAgICAgICAgIGxvYygKICAgICAgICAgICAgICAgICJDb29raWUgY2hhaW4gYnJva2VuLjxicj48c21hbGw+WW91IG1hZGUgJTEuPC9zbWFsbD4iLAogICAgICAgICAgICAgICAgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkodGhpcy50b3RhbEZyb21DaGFpbikpCiAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICBtZS54ICsgbWUubC5vZmZzZXRXaWR0aCAvIDIsCiAgICAgICAgICAgICAgbWUueQogICAgICAgICAgICApOwogICAgICAgICAgICB0aGlzLmNoYWluID0gMDsKICAgICAgICAgICAgdGhpcy50b3RhbEZyb21DaGFpbiA9IDA7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAobWUuc3Bhd25MZWFkKSBHYW1lLm1pc3NlZEdvbGRlbkNsaWNrcysrOwogICAgICAgIH0sCiAgICAgICAgc3Bhd25zT25UaW1lcjogdHJ1ZSwKICAgICAgICBzcGF3bkNvbmRpdGlvbnM6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGlmICghR2FtZS5IYXMoIkdvbGRlbiBzd2l0Y2ggW29mZl0iKSkgcmV0dXJuIHRydWU7CiAgICAgICAgICBlbHNlIHJldHVybiBmYWxzZTsKICAgICAgICB9LAogICAgICAgIHNwYXduZWQ6IDAsCiAgICAgICAgdGltZTogMCwKICAgICAgICBtaW5UaW1lOiAwLAogICAgICAgIG1heFRpbWU6IDAsCiAgICAgICAgZ2V0VGltZU1vZDogZnVuY3Rpb24gKG1lLCBtKSB7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIkx1Y2t5IGRheSIpKSBtIC89IDI7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIlNlcmVuZGlwaXR5IikpIG0gLz0gMjsKICAgICAgICAgIGlmIChHYW1lLkhhcygiR29sZGVuIGdvb3NlIGVnZyIpKSBtICo9IDAuOTU7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIkhlYXZlbmx5IGx1Y2siKSkgbSAqPSAwLjk1OwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJHcmVlbiB5ZWFzdCBkaWdlc3RpdmVzIikpIG0gKj0gMC45OTsKICAgICAgICAgIC8vaWYgKEdhbWUuaGFzQXVyYSgnQXJjYW5lIEF1cmEnKSkgbSo9MC45NTsKICAgICAgICAgIG0gKj0gMSAtIEdhbWUuYXVyYU11bHQoIkFyY2FuZSBBdXJhIikgKiAwLjA1OwogICAgICAgICAgaWYgKEdhbWUuaGFzQnVmZigiU3VnYXIgYmxlc3NpbmciKSkgbSAqPSAwLjk7CiAgICAgICAgICBpZiAoR2FtZS5zZWFzb24gPT0gImVhc3RlciIgJiYgR2FtZS5IYXMoIlN0YXJzcGF3biIpKSBtICo9IDAuOTg7CiAgICAgICAgICBlbHNlIGlmIChHYW1lLnNlYXNvbiA9PSAiaGFsbG93ZWVuIiAmJiBHYW1lLkhhcygiU3RhcnRlcnJvciIpKQogICAgICAgICAgICBtICo9IDAuOTg7CiAgICAgICAgICBlbHNlIGlmIChHYW1lLnNlYXNvbiA9PSAidmFsZW50aW5lcyIgJiYgR2FtZS5IYXMoIlN0YXJsb3ZlIikpCiAgICAgICAgICAgIG0gKj0gMC45ODsKICAgICAgICAgIGVsc2UgaWYgKEdhbWUuc2Vhc29uID09ICJmb29scyIgJiYgR2FtZS5IYXMoIlN0YXJ0cmFkZSIpKSBtICo9IDAuOTU7CiAgICAgICAgICBpZiAoIW1lLndyYXRoKSBtICo9IDEgLyBHYW1lLmVmZigiZ29sZGVuQ29va2llRnJlcSIpOwogICAgICAgICAgZWxzZSBtICo9IDEgLyBHYW1lLmVmZigid3JhdGhDb29raWVGcmVxIik7CiAgICAgICAgICBpZiAoR2FtZS5oYXNHb2QpIHsKICAgICAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJpbmR1c3RyeSIpOwogICAgICAgICAgICBpZiAoZ29kTHZsID09IDEpIG0gKj0gMS4xOwogICAgICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMikgbSAqPSAxLjA2OwogICAgICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMykgbSAqPSAxLjAzOwogICAgICAgICAgICB2YXIgZ29kTHZsID0gR2FtZS5oYXNHb2QoIm1vdGhlciIpOwogICAgICAgICAgICBpZiAoZ29kTHZsID09IDEpIG0gKj0gMS4xNTsKICAgICAgICAgICAgZWxzZSBpZiAoZ29kTHZsID09IDIpIG0gKj0gMS4xOwogICAgICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMykgbSAqPSAxLjA1OwoKICAgICAgICAgICAgaWYgKEdhbWUuc2Vhc29uICE9ICIiKSB7CiAgICAgICAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJzZWFzb25zIik7CiAgICAgICAgICAgICAgaWYgKEdhbWUuc2Vhc29uICE9ICJmb29scyIpIHsKICAgICAgICAgICAgICAgIGlmIChnb2RMdmwgPT0gMSkgbSAqPSAwLjk3OwogICAgICAgICAgICAgICAgZWxzZSBpZiAoZ29kTHZsID09IDIpIG0gKj0gMC45ODsKICAgICAgICAgICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAzKSBtICo9IDAuOTk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlmIChnb2RMdmwgPT0gMSkgbSAqPSAwLjk1NTsKICAgICAgICAgICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAyKSBtICo9IDAuOTc7CiAgICAgICAgICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMykgbSAqPSAwLjk4NTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGlmICh0aGlzLmNoYWluID4gMCkgbSA9IDAuMDU7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIkdvbGQgaG9hcmQiKSkgbSA9IDAuMDE7CiAgICAgICAgICByZXR1cm4gTWF0aC5jZWlsKEdhbWUuZnBzICogNjAgKiBtKTsKICAgICAgICB9LAogICAgICAgIGdldE1pblRpbWU6IGZ1bmN0aW9uIChtZSkgewogICAgICAgICAgdmFyIG0gPSA1OwogICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VGltZU1vZChtZSwgbSk7CiAgICAgICAgfSwKICAgICAgICBnZXRNYXhUaW1lOiBmdW5jdGlvbiAobWUpIHsKICAgICAgICAgIHZhciBtID0gMTU7CiAgICAgICAgICByZXR1cm4gdGhpcy5nZXRUaW1lTW9kKG1lLCBtKTsKICAgICAgICB9LAogICAgICAgIGxhc3Q6ICIiLAogICAgICB9LAogICAgICByZWluZGVlcjogewogICAgICAgIHJlc2V0OiBmdW5jdGlvbiAoKSB7fSwKICAgICAgICBpbml0RnVuYzogZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgICBpZiAoIXRoaXMuc3Bhd25lZCAmJiBHYW1lLmNoaW1lVHlwZSAhPSAwICYmIEdhbWUuYXNjZW5zaW9uTW9kZSAhPSAxKQogICAgICAgICAgICBQbGF5U291bmQoInNuZC9qaW5nbGUubXAzIik7CgogICAgICAgICAgbWUueCA9IC0xMjg7CiAgICAgICAgICBtZS55ID0KICAgICAgICAgICAgTWF0aC5mbG9vcigKICAgICAgICAgICAgICBNYXRoLnJhbmRvbSgpICoKICAgICAgICAgICAgICAgIE1hdGgubWF4KDAsIEdhbWUuYm91bmRzLmJvdHRvbSAtIEdhbWUuYm91bmRzLnRvcCAtIDI1NikgKwogICAgICAgICAgICAgICAgR2FtZS5ib3VuZHMudG9wICsKICAgICAgICAgICAgICAgIDEyOAogICAgICAgICAgICApIC0gMTI4OwogICAgICAgICAgLy9tZS5sLnN0eWxlLmxlZnQ9bWUueCsncHgnOwogICAgICAgICAgLy9tZS5sLnN0eWxlLnRvcD1tZS55KydweCc7CiAgICAgICAgICBtZS5sLnN0eWxlLndpZHRoID0gIjE2N3B4IjsKICAgICAgICAgIG1lLmwuc3R5bGUuaGVpZ2h0ID0gIjIxMnB4IjsKICAgICAgICAgIG1lLmwuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gInVybChpbWcvZnJvc3RlZFJlaW5kZWVyLnBuZykiOwogICAgICAgICAgbWUubC5zdHlsZS5vcGFjaXR5ID0gIjAiOwogICAgICAgICAgLy9tZS5sLnN0eWxlLnRyYW5zZm9ybT0ncm90YXRlKCcrKE1hdGgucmFuZG9tKCkqNjAtMzApKydkZWcpIHNjYWxlKCcrKE1hdGgucmFuZG9tKCkqMSswLjI1KSsnKSc7CiAgICAgICAgICBtZS5sLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICAgICAgbWUubC5zZXRBdHRyaWJ1dGUoImFsdCIsIGxvYygiUmVpbmRlZXIiKSk7CgogICAgICAgICAgbWUubGlmZSA9IDE7IC8vdGhlIHJlaW5kZWVyJ3MgY3VycmVudCBwcm9ncmVzc2lvbiB0aHJvdWdoIGl0cyBsaWZlc3BhbiAoaW4gZnJhbWVzKQogICAgICAgICAgbWUuZHVyID0gNDsgLy9kdXJhdGlvbjsgdGhlIGNvb2tpZSdzIGxpZmVzcGFuIGluIHNlY29uZHMgYmVmb3JlIGl0IGRlc3Bhd25zCgogICAgICAgICAgdmFyIGR1ciA9IDQ7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIldlaWdodGVkIHNsZWlnaHMiKSkgZHVyICo9IDI7CiAgICAgICAgICBkdXIgKj0gR2FtZS5lZmYoInJlaW5kZWVyRHVyIik7CiAgICAgICAgICBtZS5kdXIgPSBkdXI7CiAgICAgICAgICBtZS5saWZlID0gTWF0aC5jZWlsKEdhbWUuZnBzICogbWUuZHVyKTsKICAgICAgICAgIG1lLnNpemVNdWx0ID0gMTsKICAgICAgICB9LAogICAgICAgIHVwZGF0ZUZ1bmM6IGZ1bmN0aW9uIChtZSkgewogICAgICAgICAgdmFyIGN1cnZlID0gMSAtIE1hdGgucG93KChtZS5saWZlIC8gKEdhbWUuZnBzICogbWUuZHVyKSkgKiAyIC0gMSwgMTIpOwogICAgICAgICAgbWUubC5zdHlsZS5vcGFjaXR5ID0gY3VydmU7CiAgICAgICAgICBtZS5sLnN0eWxlLnRyYW5zZm9ybSA9CiAgICAgICAgICAgICJ0cmFuc2xhdGUoIiArCiAgICAgICAgICAgIChtZS54ICsKICAgICAgICAgICAgICAoR2FtZS5ib3VuZHMucmlnaHQgLSBHYW1lLmJvdW5kcy5sZWZ0KSAqCiAgICAgICAgICAgICAgICAoMSAtIG1lLmxpZmUgLyAoR2FtZS5mcHMgKiBtZS5kdXIpKSkgKwogICAgICAgICAgICAicHgsIiArCiAgICAgICAgICAgIChtZS55IC0gTWF0aC5hYnMoTWF0aC5zaW4obWUubGlmZSAqIDAuMSkpICogMTI4KSArCiAgICAgICAgICAgICJweCkgcm90YXRlKCIgKwogICAgICAgICAgICBNYXRoLnNpbihtZS5saWZlICogMC4yICsgMC4zKSAqIDEwICsKICAgICAgICAgICAgImRlZykgc2NhbGUoIiArCiAgICAgICAgICAgIG1lLnNpemVNdWx0ICogKDEgKyBNYXRoLnNpbihtZS5pZCAqIDAuNTMpICogMC4xKSArCiAgICAgICAgICAgICIpIjsKICAgICAgICAgIG1lLmxpZmUtLTsKICAgICAgICAgIGlmIChtZS5saWZlIDw9IDApIHsKICAgICAgICAgICAgdGhpcy5taXNzRnVuYyhtZSk7CiAgICAgICAgICAgIG1lLmRpZSgpOwogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgcG9wRnVuYzogZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgICAvL2dldCBhY2hpZXZzIGFuZCBzdGF0cwogICAgICAgICAgaWYgKG1lLnNwYXduTGVhZCkgewogICAgICAgICAgICBHYW1lLnJlaW5kZWVyQ2xpY2tlZCsrOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciB2YWwgPSBHYW1lLmNvb2tpZXNQcyAqIDYwOwogICAgICAgICAgaWYgKEdhbWUuaGFzQnVmZigiRWxkZXIgZnJlbnp5IikpIHZhbCAqPSAwLjU7IC8vdmVyeSBzb3JyeQogICAgICAgICAgaWYgKEdhbWUuaGFzQnVmZigiRnJlbnp5IikpIHZhbCAqPSAwLjc1OyAvL0kgc2luY2VyZWx5IGFwb2xvZ2l6ZQogICAgICAgICAgdmFyIG1vbmkgPSBNYXRoLm1heCgyNSwgdmFsKTsgLy8xIG1pbnV0ZSBvZiBjb29raWUgcHJvZHVjdGlvbiwgb3IgMjUgY29va2llcyAtIHdoaWNoZXZlciBpcyBoaWdoZXN0CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIkhvIGhvIGhvLWZsYXZvcmVkIGZyb3N0aW5nIikpIG1vbmkgKj0gMjsKICAgICAgICAgIG1vbmkgKj0gR2FtZS5lZmYoInJlaW5kZWVyR2FpbiIpOwogICAgICAgICAgR2FtZS5FYXJuKG1vbmkpOwogICAgICAgICAgaWYgKEdhbWUuaGFzQnVmZigiRWxkZXIgZnJlbnp5IikpIEdhbWUuV2luKCJFbGRlZXIiKTsKCiAgICAgICAgICB2YXIgY29va2llID0gIiI7CiAgICAgICAgICB2YXIgZmFpbFJhdGUgPSAwLjg7CiAgICAgICAgICBpZiAoR2FtZS5IYXNBY2hpZXYoIkxldCBpdCBzbm93IikpIGZhaWxSYXRlID0gMC42OwogICAgICAgICAgZmFpbFJhdGUgKj0gMSAvIEdhbWUuZHJvcFJhdGVNdWx0KCk7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIlN0YXJzbm93IikpIGZhaWxSYXRlICo9IDAuOTU7CiAgICAgICAgICBpZiAoR2FtZS5oYXNHb2QpIHsKICAgICAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJzZWFzb25zIik7CiAgICAgICAgICAgIGlmIChnb2RMdmwgPT0gMSkgZmFpbFJhdGUgKj0gMC45OwogICAgICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMikgZmFpbFJhdGUgKj0gMC45NTsKICAgICAgICAgICAgZWxzZSBpZiAoZ29kTHZsID09IDMpIGZhaWxSYXRlICo9IDAuOTc7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoTWF0aC5yYW5kb20oKSA+IGZhaWxSYXRlKSB7CiAgICAgICAgICAgIC8vY2hyaXN0bWFzIGNvb2tpZSBkcm9wcwogICAgICAgICAgICBjb29raWUgPSBjaG9vc2UoWwogICAgICAgICAgICAgICJDaHJpc3RtYXMgdHJlZSBiaXNjdWl0cyIsCiAgICAgICAgICAgICAgIlNub3dmbGFrZSBiaXNjdWl0cyIsCiAgICAgICAgICAgICAgIlNub3dtYW4gYmlzY3VpdHMiLAogICAgICAgICAgICAgICJIb2xseSBiaXNjdWl0cyIsCiAgICAgICAgICAgICAgIkNhbmR5IGNhbmUgYmlzY3VpdHMiLAogICAgICAgICAgICAgICJCZWxsIGJpc2N1aXRzIiwKICAgICAgICAgICAgICAiUHJlc2VudCBiaXNjdWl0cyIsCiAgICAgICAgICAgIF0pOwogICAgICAgICAgICBpZiAoIUdhbWUuSGFzVW5sb2NrZWQoY29va2llKSAmJiAhR2FtZS5IYXMoY29va2llKSkgewogICAgICAgICAgICAgIEdhbWUuVW5sb2NrKGNvb2tpZSk7CiAgICAgICAgICAgIH0gZWxzZSBjb29raWUgPSAiIjsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgcG9wdXAgPSAiIjsKCiAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgbG9jKCJZb3UgZm91bmQgJTEhIiwgY2hvb3NlKGxvYygiUmVpbmRlZXIgbmFtZXMiKSkpLAogICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgIlRoZSByZWluZGVlciBnaXZlcyB5b3UgJTEuIiwKICAgICAgICAgICAgICBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeShtb25pKSkKICAgICAgICAgICAgKSArCiAgICAgICAgICAgICAgKGNvb2tpZSA9PSAiIgogICAgICAgICAgICAgICAgPyAiIgogICAgICAgICAgICAgICAgOiAiPGJyPiIgKwogICAgICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAgICAgIllvdSBhcmUgYWxzbyByZXdhcmRlZCB3aXRoICUxISIsCiAgICAgICAgICAgICAgICAgICAgR2FtZS5VcGdyYWRlc1tjb29raWVdLmRuYW1lCiAgICAgICAgICAgICAgICAgICkpLAogICAgICAgICAgICBbMTIsIDldLAogICAgICAgICAgICA2CiAgICAgICAgICApOwogICAgICAgICAgcG9wdXAgPQogICAgICAgICAgICAnPGRpdiBzdHlsZT0iZm9udC1zaXplOjgwJTsiPicgKwogICAgICAgICAgICBsb2MoIislMSEiLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeShtb25pKSkpICsKICAgICAgICAgICAgIjwvZGl2PiI7CgogICAgICAgICAgaWYgKHBvcHVwICE9ICIiKSBHYW1lLlBvcHVwKHBvcHVwLCBHYW1lLm1vdXNlWCwgR2FtZS5tb3VzZVkpOwoKICAgICAgICAgIC8vc3BhcmtsZSBhbmQga2lsbCB0aGUgc2hpbW1lcgogICAgICAgICAgR2FtZS5TcGFya2xlQXQoR2FtZS5tb3VzZVgsIEdhbWUubW91c2VZKTsKICAgICAgICAgIFBsYXlTb3VuZCgic25kL2ppbmdsZUNsaWNrLm1wMyIpOwogICAgICAgICAgbWUuZGllKCk7CiAgICAgICAgfSwKICAgICAgICBtaXNzRnVuYzogZnVuY3Rpb24gKG1lKSB7fSwKICAgICAgICBzcGF3bnNPblRpbWVyOiB0cnVlLAogICAgICAgIHNwYXduQ29uZGl0aW9uczogZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKEdhbWUuc2Vhc29uID09ICJjaHJpc3RtYXMiKSByZXR1cm4gdHJ1ZTsKICAgICAgICAgIGVsc2UgcmV0dXJuIGZhbHNlOwogICAgICAgIH0sCiAgICAgICAgc3Bhd25lZDogMCwKICAgICAgICB0aW1lOiAwLAogICAgICAgIG1pblRpbWU6IDAsCiAgICAgICAgbWF4VGltZTogMCwKICAgICAgICBnZXRUaW1lTW9kOiBmdW5jdGlvbiAobWUsIG0pIHsKICAgICAgICAgIGlmIChHYW1lLkhhcygiUmVpbmRlZXIgYmFraW5nIGdyb3VuZHMiKSkgbSAvPSAyOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJTdGFyc25vdyIpKSBtICo9IDAuOTU7CiAgICAgICAgICBpZiAoR2FtZS5oYXNHb2QpIHsKICAgICAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJzZWFzb25zIik7CiAgICAgICAgICAgIGlmIChnb2RMdmwgPT0gMSkgbSAqPSAwLjk7CiAgICAgICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAyKSBtICo9IDAuOTU7CiAgICAgICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAzKSBtICo9IDAuOTc7CiAgICAgICAgICB9CiAgICAgICAgICBtICo9IDEgLyBHYW1lLmVmZigicmVpbmRlZXJGcmVxIik7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIlJlaW5kZWVyIHNlYXNvbiIpKSBtID0gMC4wMTsKICAgICAgICAgIHJldHVybiBNYXRoLmNlaWwoR2FtZS5mcHMgKiA2MCAqIG0pOwogICAgICAgIH0sCiAgICAgICAgZ2V0TWluVGltZTogZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgICB2YXIgbSA9IDM7CiAgICAgICAgICByZXR1cm4gdGhpcy5nZXRUaW1lTW9kKG1lLCBtKTsKICAgICAgICB9LAogICAgICAgIGdldE1heFRpbWU6IGZ1bmN0aW9uIChtZSkgewogICAgICAgICAgdmFyIG0gPSA2OwogICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VGltZU1vZChtZSwgbSk7CiAgICAgICAgfSwKICAgICAgfSwKICAgIH07CgogICAgR2FtZS5nb2xkZW5Db29raWVDaG9pY2VzID0gWwogICAgICAiRnJlbnp5IiwKICAgICAgImZyZW56eSIsCiAgICAgICJMdWNreSIsCiAgICAgICJtdWx0aXBseSBjb29raWVzIiwKICAgICAgIlJ1aW4iLAogICAgICAicnVpbiBjb29raWVzIiwKICAgICAgIkVsZGVyIGZyZW56eSIsCiAgICAgICJibG9vZCBmcmVuenkiLAogICAgICAiQ2xvdCIsCiAgICAgICJjbG90IiwKICAgICAgIkNsaWNrIGZyZW56eSIsCiAgICAgICJjbGljayBmcmVuenkiLAogICAgICAiQ3Vyc2VkIGZpbmdlciIsCiAgICAgICJjdXJzZWQgZmluZ2VyIiwKICAgICAgIkNvb2tpZSBjaGFpbiIsCiAgICAgICJjaGFpbiBjb29raWUiLAogICAgICAiQ29va2llIHN0b3JtIiwKICAgICAgImNvb2tpZSBzdG9ybSIsCiAgICAgICJCdWlsZGluZyBzcGVjaWFsIiwKICAgICAgImJ1aWxkaW5nIHNwZWNpYWwiLAogICAgICAiRHJhZ29uIEhhcnZlc3QiLAogICAgICAiZHJhZ29uIGhhcnZlc3QiLAogICAgICAiRHJhZ29uZmxpZ2h0IiwKICAgICAgImRyYWdvbmZsaWdodCIsCiAgICAgICJTd2VldCIsCiAgICAgICJmcmVlIHN1Z2FyIGx1bXAiLAogICAgICAiQmxhYiIsCiAgICAgICJibGFiIiwKICAgIF07CiAgICBHYW1lLmdvbGRlbkNvb2tpZUJ1aWxkaW5nQnVmZnMgPSB7CiAgICAgIEN1cnNvcjogWyJIaWdoLWZpdmUiLCAiU2xhcCB0byB0aGUgZmFjZSJdLAogICAgICBHcmFuZG1hOiBbIkNvbmdyZWdhdGlvbiIsICJTZW5pbGl0eSJdLAogICAgICBGYXJtOiBbIkx1eHVyaWFudCBoYXJ2ZXN0IiwgIkxvY3VzdHMiXSwKICAgICAgTWluZTogWyJPcmUgdmVpbiIsICJDYXZlLWluIl0sCiAgICAgIEZhY3Rvcnk6IFsiT2lsZWQtdXAiLCAiSmFtbWVkIG1hY2hpbmVyeSJdLAogICAgICBCYW5rOiBbIkp1aWN5IHByb2ZpdHMiLCAiUmVjZXNzaW9uIl0sCiAgICAgIFRlbXBsZTogWyJGZXJ2ZW50IGFkb3JhdGlvbiIsICJDcmlzaXMgb2YgZmFpdGgiXSwKICAgICAgIldpemFyZCB0b3dlciI6IFsiTWFuYWJsb29tIiwgIk1hZ2l2b3JlcyJdLAogICAgICBTaGlwbWVudDogWyJEZWxpY2lvdXMgbGlmZWZvcm1zIiwgIkJsYWNrIGhvbGVzIl0sCiAgICAgICJBbGNoZW15IGxhYiI6IFsiQnJlYWt0aHJvdWdoIiwgIkxhYiBkaXNhc3RlciJdLAogICAgICBQb3J0YWw6IFsiUmlnaHRlb3VzIGNhdGFjbHlzbSIsICJEaW1lbnNpb25hbCBjYWxhbWl0eSJdLAogICAgICAiVGltZSBtYWNoaW5lIjogWyJHb2xkZW4gYWdlcyIsICJUaW1lIGphbSJdLAogICAgICAiQW50aW1hdHRlciBjb25kZW5zZXIiOiBbIkV4dHJhIGN5Y2xlcyIsICJQcmVkaWN0YWJsZSB0cmFnZWR5Il0sCiAgICAgIFByaXNtOiBbIlNvbGFyIGZsYXJlIiwgIkVjbGlwc2UiXSwKICAgICAgQ2hhbmNlbWFrZXI6IFsiV2lubmluZyBzdHJlYWsiLCAiRHJ5IHNwZWxsIl0sCiAgICAgICJGcmFjdGFsIGVuZ2luZSI6IFsiTWFjcm9jb3NtIiwgIk1pY3JvY29zbSJdLAogICAgICAiSmF2YXNjcmlwdCBjb25zb2xlIjogWyJSZWZhY3RvcmluZyIsICJBbnRpcGF0dGVybiJdLAogICAgICBJZGxldmVyc2U6IFsiQ29zbWljIG51cnNlcnkiLCAiQmlnIGNydW5jaCJdLAogICAgICAiQ29ydGV4IGJha2VyIjogWyJCcmFpbnN0b3JtIiwgIkJyYWluIGZyZWV6ZSJdLAogICAgfTsKCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCQlQQVJUSUNMRVMKCQk9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgLy9nZW5lcmljIHBhcnRpY2xlcyAoZmFsbGluZyBjb29raWVzIGV0YykKICAgIC8vb25seSBkaXNwbGF5ZWQgb24gbGVmdCBzZWN0aW9uCiAgICBHYW1lLnBhcnRpY2xlcyA9IFtdOwogICAgR2FtZS5wYXJ0aWNsZXNOID0gNTA7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IEdhbWUucGFydGljbGVzTjsgaSsrKSB7CiAgICAgIEdhbWUucGFydGljbGVzW2ldID0gewogICAgICAgIHg6IDAsCiAgICAgICAgeTogMCwKICAgICAgICB4ZDogMCwKICAgICAgICB5ZDogMCwKICAgICAgICB3OiA2NCwKICAgICAgICBoOiA2NCwKICAgICAgICB6OiAwLAogICAgICAgIHNpemU6IDEsCiAgICAgICAgZHVyOiAyLAogICAgICAgIGxpZmU6IC0xLAogICAgICAgIHI6IDAsCiAgICAgICAgcGljOiAic21hbGxDb29raWVzLnBuZyIsCiAgICAgICAgcGljSWQ6IDAsCiAgICAgICAgcGljUG9zOiBbMCwgMF0sCiAgICAgIH07CiAgICB9CgogICAgR2FtZS5wYXJ0aWNsZXNVcGRhdGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgR2FtZS5wYXJ0aWNsZXNOOyBpKyspIHsKICAgICAgICB2YXIgbWUgPSBHYW1lLnBhcnRpY2xlc1tpXTsKICAgICAgICBpZiAobWUubGlmZSAhPSAtMSkgewogICAgICAgICAgaWYgKCFtZS50ZXh0KSBtZS55ZCArPSAwLjIgKyBNYXRoLnJhbmRvbSgpICogMC4xOwogICAgICAgICAgbWUueCArPSBtZS54ZDsKICAgICAgICAgIG1lLnkgKz0gbWUueWQ7CiAgICAgICAgICAvL21lLnkrPW1lLmxpZmUqMC4yNStNYXRoLnJhbmRvbSgpKjAuMjU7CiAgICAgICAgICBtZS5saWZlKys7CiAgICAgICAgICBpZiAobWUubGlmZSA+PSBHYW1lLmZwcyAqIG1lLmR1cikgewogICAgICAgICAgICBtZS5saWZlID0gLTE7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9OwogICAgR2FtZS5wYXJ0aWNsZUFkZCA9IGZ1bmN0aW9uICh4LCB5LCB4ZCwgeWQsIHNpemUsIGR1ciwgeiwgcGljLCB0ZXh0KSB7CiAgICAgIC8vR2FtZS5wYXJ0aWNsZUFkZChwb3MgWCxwb3MgWSxzcGVlZCBYLHNwZWVkIFksc2l6ZSAobXVsdGlwbGllciksZHVyYXRpb24gKHNlY29uZHMpLGxheWVyLHBpY3R1cmUsdGV4dCk7CiAgICAgIC8vcGljayB0aGUgZmlyc3QgZnJlZSAob3IgdGhlIG9sZGVzdCkgcGFydGljbGUgdG8gcmVwbGFjZSBpdAogICAgICBpZiAodHJ1ZSkgewogICAgICAgIC8vR2FtZS5wcmVmcy5wYXJ0aWNsZXMpCiAgICAgICAgdmFyIGhpZ2hlc3QgPSAwOwogICAgICAgIHZhciBoaWdoZXN0SSA9IDA7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBHYW1lLnBhcnRpY2xlc047IGkrKykgewogICAgICAgICAgaWYgKEdhbWUucGFydGljbGVzW2ldLmxpZmUgPT0gLTEpIHsKICAgICAgICAgICAgaGlnaGVzdEkgPSBpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChHYW1lLnBhcnRpY2xlc1tpXS5saWZlID4gaGlnaGVzdCkgewogICAgICAgICAgICBoaWdoZXN0ID0gR2FtZS5wYXJ0aWNsZXNbaV0ubGlmZTsKICAgICAgICAgICAgaGlnaGVzdEkgPSBpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB2YXIgYXV0byA9IDA7CiAgICAgICAgaWYgKHgpIGF1dG8gPSAxOwogICAgICAgIHZhciBpID0gaGlnaGVzdEk7CiAgICAgICAgdmFyIHggPSB4IHx8IC02NDsKICAgICAgICBpZiAoR2FtZS5MZWZ0QmFja2dyb3VuZCAmJiAhYXV0bykKICAgICAgICAgIHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBHYW1lLkxlZnRCYWNrZ3JvdW5kLmNhbnZhcy53aWR0aCk7CiAgICAgICAgdmFyIHkgPSB5IHx8IC02NDsKICAgICAgICB2YXIgbWUgPSBHYW1lLnBhcnRpY2xlc1tpXTsKICAgICAgICBtZS5saWZlID0gMDsKICAgICAgICBtZS54ID0geDsKICAgICAgICBtZS55ID0geTsKICAgICAgICBtZS54ZCA9IHhkIHx8IDA7CiAgICAgICAgbWUueWQgPSB5ZCB8fCAwOwogICAgICAgIG1lLnNpemUgPSBzaXplIHx8IDE7CiAgICAgICAgbWUueiA9IHogfHwgMDsKICAgICAgICBtZS5kdXIgPSBkdXIgfHwgMjsKICAgICAgICBtZS5yID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMzYwKTsKICAgICAgICBtZS5waWNJZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwKTsKICAgICAgICBpZiAoIXBpYykgewogICAgICAgICAgaWYgKEdhbWUuc2Vhc29uID09ICJmb29scyIpIHBpYyA9ICJzbWFsbERvbGxhcnMucG5nIjsKICAgICAgICAgIGVsc2UgewogICAgICAgICAgICB2YXIgY29va2llcyA9IFtbMTAsIDBdXTsKICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlVwZ3JhZGVzKSB7CiAgICAgICAgICAgICAgdmFyIGNvb2tpZSA9IEdhbWUuVXBncmFkZXNbaV07CiAgICAgICAgICAgICAgaWYgKGNvb2tpZS5ib3VnaHQgPiAwICYmIGNvb2tpZS5wb29sID09ICJjb29raWUiKQogICAgICAgICAgICAgICAgY29va2llcy5wdXNoKGNvb2tpZS5pY29uKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBtZS5waWNQb3MgPSBjaG9vc2UoY29va2llcyk7CiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICBHYW1lLmJha2VyeU5hbWUudG9Mb3dlckNhc2UoKSA9PSAib3J0aWVsIiB8fAogICAgICAgICAgICAgIE1hdGgucmFuZG9tKCkgPCAxIC8gMTAwMDAKICAgICAgICAgICAgKQogICAgICAgICAgICAgIG1lLnBpY1BvcyA9IFsxNywgNV07CiAgICAgICAgICAgIHBpYyA9ICJpY29ucy5wbmciOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHBpYyAhPT0gInN0cmluZyIpIHsKICAgICAgICAgIG1lLnBpY1BvcyA9IHBpYzsKICAgICAgICAgIHBpYyA9ICJpY29ucy5wbmciOwogICAgICAgIH0KICAgICAgICBtZS5waWMgPSBwaWMgfHwgInNtYWxsQ29va2llcy5wbmciOwogICAgICAgIG1lLnRleHQgPSB0ZXh0IHx8IDA7CiAgICAgICAgcmV0dXJuIG1lOwogICAgICB9CiAgICAgIHJldHVybiB7fTsKICAgIH07CiAgICBHYW1lLnBhcnRpY2xlc0RyYXcgPSBmdW5jdGlvbiAoeikgewogICAgICB2YXIgY3R4ID0gR2FtZS5MZWZ0QmFja2dyb3VuZDsKICAgICAgY3R4LmZpbGxTdHlsZSA9ICIjZmZmIjsKICAgICAgY3R4LmZvbnQgPSAiMjBweCBNZXJyaXdlYXRoZXIiOwogICAgICBjdHgudGV4dEFsaWduID0gImNlbnRlciI7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IEdhbWUucGFydGljbGVzTjsgaSsrKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5wYXJ0aWNsZXNbaV07CiAgICAgICAgaWYgKG1lLnogPT0geikgewogICAgICAgICAgaWYgKG1lLmxpZmUgIT0gLTEpIHsKICAgICAgICAgICAgdmFyIG9wYWNpdHkgPSAxIC0gbWUubGlmZSAvIChHYW1lLmZwcyAqIG1lLmR1cik7CiAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IG9wYWNpdHk7CiAgICAgICAgICAgIGlmIChtZS50ZXh0KSB7CiAgICAgICAgICAgICAgY3R4LmZpbGxUZXh0KG1lLnRleHQsIG1lLngsIG1lLnkpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGN0eC5zYXZlKCk7CiAgICAgICAgICAgICAgY3R4LnRyYW5zbGF0ZShtZS54LCBtZS55KTsKICAgICAgICAgICAgICBjdHgucm90YXRlKChtZS5yIC8gMzYwKSAqIE1hdGguUEkgKiAyKTsKICAgICAgICAgICAgICB2YXIgdyA9IDY0OwogICAgICAgICAgICAgIHZhciBoID0gNjQ7CiAgICAgICAgICAgICAgaWYgKG1lLnBpYyA9PSAiaWNvbnMucG5nIikgewogICAgICAgICAgICAgICAgdyA9IDQ4OwogICAgICAgICAgICAgICAgaCA9IDQ4OwogICAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZSgKICAgICAgICAgICAgICAgICAgUGljKG1lLnBpYyksCiAgICAgICAgICAgICAgICAgIG1lLnBpY1Bvc1swXSAqIHcsCiAgICAgICAgICAgICAgICAgIG1lLnBpY1Bvc1sxXSAqIGgsCiAgICAgICAgICAgICAgICAgIHcsCiAgICAgICAgICAgICAgICAgIGgsCiAgICAgICAgICAgICAgICAgICgtdyAvIDIpICogbWUuc2l6ZSwKICAgICAgICAgICAgICAgICAgKC1oIC8gMikgKiBtZS5zaXplLAogICAgICAgICAgICAgICAgICB3ICogbWUuc2l6ZSwKICAgICAgICAgICAgICAgICAgaCAqIG1lLnNpemUKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgbWUucGljID09ICJ3cmlua2xlckJpdHMucG5nIiB8fAogICAgICAgICAgICAgICAgICBtZS5waWMgPT0gInNoaW55V3JpbmtsZXJCaXRzLnBuZyIKICAgICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgICB3ID0gMTAwOwogICAgICAgICAgICAgICAgICBoID0gMjAwOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZSgKICAgICAgICAgICAgICAgICAgUGljKG1lLnBpYyksCiAgICAgICAgICAgICAgICAgIChtZS5waWNJZCAlIDgpICogdywKICAgICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgICAgdywKICAgICAgICAgICAgICAgICAgaCwKICAgICAgICAgICAgICAgICAgKC13IC8gMikgKiBtZS5zaXplLAogICAgICAgICAgICAgICAgICAoLWggLyAyKSAqIG1lLnNpemUsCiAgICAgICAgICAgICAgICAgIHcgKiBtZS5zaXplLAogICAgICAgICAgICAgICAgICBoICogbWUuc2l6ZQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICAvL3RleHQgcGFydGljbGVzIChwb3B1cHMgZXRjKQogICAgR2FtZS50ZXh0UGFydGljbGVzID0gW107CiAgICBHYW1lLnRleHRQYXJ0aWNsZXNZID0gMDsKICAgIHZhciBzdHIgPSAiIjsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMjA7IGkrKykgewogICAgICBHYW1lLnRleHRQYXJ0aWNsZXNbaV0gPSB7IHg6IDAsIHk6IDAsIGxpZmU6IC0xLCB0ZXh0OiAiIiB9OwogICAgICBzdHIgKz0gJzxkaXYgaWQ9InBhcnRpY2xlJyArIGkgKyAnIiBjbGFzcz0icGFydGljbGUgdGl0bGUiPjwvZGl2Pic7CiAgICB9CiAgICBsKCJwYXJ0aWNsZXMiKS5pbm5lckhUTUwgPSBzdHI7CiAgICBHYW1lLnRleHRQYXJ0aWNsZXNVcGRhdGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS50ZXh0UGFydGljbGVzKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS50ZXh0UGFydGljbGVzW2ldOwogICAgICAgIGlmIChtZS5saWZlICE9IC0xKSB7CiAgICAgICAgICBtZS5saWZlKys7CiAgICAgICAgICBpZiAobWUubGlmZSA+PSBHYW1lLmZwcyAqIDQpIHsKICAgICAgICAgICAgdmFyIGVsID0gbWUubDsKICAgICAgICAgICAgbWUubGlmZSA9IC0xOwogICAgICAgICAgICBlbC5zdHlsZS5vcGFjaXR5ID0gMDsKICAgICAgICAgICAgZWwuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgICBHYW1lLnRleHRQYXJ0aWNsZXNBZGQgPSBmdW5jdGlvbiAodGV4dCwgZWwsIHBvc1gsIHBvc1kpIHsKICAgICAgLy9waWNrIHRoZSBmaXJzdCBmcmVlIChvciB0aGUgb2xkZXN0KSBwYXJ0aWNsZSB0byByZXBsYWNlIGl0CiAgICAgIHZhciBoaWdoZXN0ID0gMDsKICAgICAgdmFyIGhpZ2hlc3RJID0gMDsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLnRleHRQYXJ0aWNsZXMpIHsKICAgICAgICBpZiAoR2FtZS50ZXh0UGFydGljbGVzW2ldLmxpZmUgPT0gLTEpIHsKICAgICAgICAgIGhpZ2hlc3RJID0gaTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBpZiAoR2FtZS50ZXh0UGFydGljbGVzW2ldLmxpZmUgPiBoaWdoZXN0KSB7CiAgICAgICAgICBoaWdoZXN0ID0gR2FtZS50ZXh0UGFydGljbGVzW2ldLmxpZmU7CiAgICAgICAgICBoaWdoZXN0SSA9IGk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHZhciBpID0gaGlnaGVzdEk7CiAgICAgIHZhciBub1N0YWNrID0gMDsKICAgICAgaWYgKHR5cGVvZiBwb3NYICE9PSAidW5kZWZpbmVkIiAmJiB0eXBlb2YgcG9zWSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICB4ID0gcG9zWDsKICAgICAgICB5ID0gcG9zWTsKICAgICAgICBub1N0YWNrID0gMTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgeCA9IChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIDQwOwogICAgICAgIHZhciB5ID0gMDsgLy8rKE1hdGgucmFuZG9tKCktMC41KSo0MDsKICAgICAgICBpZiAoIWVsKSB7CiAgICAgICAgICB2YXIgcmVjdCA9IEdhbWUuYm91bmRzOwogICAgICAgICAgdmFyIHggPSBNYXRoLmZsb29yKChyZWN0LmxlZnQgKyByZWN0LnJpZ2h0KSAvIDIpOwogICAgICAgICAgdmFyIHkgPSBNYXRoLmZsb29yKHJlY3QuYm90dG9tKSAtIEdhbWUubW9iaWxlICogNjQ7CiAgICAgICAgICB4ICs9IChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIDQwOwogICAgICAgICAgeSArPSAwOyAvLyhNYXRoLnJhbmRvbSgpLTAuNSkqNDA7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICghbm9TdGFjaykgeSAtPSBHYW1lLnRleHRQYXJ0aWNsZXNZOwoKICAgICAgeCA9IE1hdGgubWF4KEdhbWUuYm91bmRzLmxlZnQgKyAyMDAsIHgpOwogICAgICB4ID0gTWF0aC5taW4oR2FtZS5ib3VuZHMucmlnaHQgLSAyMDAsIHgpOwogICAgICB5ID0gTWF0aC5tYXgoR2FtZS5ib3VuZHMudG9wICsgMzIgKyAoQXBwID8gMzIgOiAwKSwgeSk7CgogICAgICB2YXIgbWUgPSBHYW1lLnRleHRQYXJ0aWNsZXNbaV07CiAgICAgIGlmICghbWUubCkgbWUubCA9IGwoInBhcnRpY2xlIiArIGkpOwogICAgICBtZS5saWZlID0gMDsKICAgICAgbWUueCA9IHg7CiAgICAgIG1lLnkgPSB5OwogICAgICBtZS50ZXh0ID0gdGV4dDsKICAgICAgbWUubC5pbm5lckhUTUwgPSB0ZXh0OwogICAgICBtZS5sLnN0eWxlLmxlZnQgPSBNYXRoLmZsb29yKEdhbWUudGV4dFBhcnRpY2xlc1tpXS54IC0gMjAwKSArICJweCI7CiAgICAgIG1lLmwuc3R5bGUuYm90dG9tID0gTWF0aC5mbG9vcigtR2FtZS50ZXh0UGFydGljbGVzW2ldLnkpICsgInB4IjsKICAgICAgZm9yICh2YXIgaWkgaW4gR2FtZS50ZXh0UGFydGljbGVzKSB7CiAgICAgICAgaWYgKGlpICE9IGkpCiAgICAgICAgICAoCiAgICAgICAgICAgIEdhbWUudGV4dFBhcnRpY2xlc1tpaV0ubCB8fCBsKCJwYXJ0aWNsZSIgKyBpaSkKICAgICAgICAgICkuc3R5bGUuekluZGV4ID0gMTAwMDAwMDAwOwogICAgICB9CiAgICAgIG1lLmwuc3R5bGUuekluZGV4ID0gMTAwMDAwMDAxOwogICAgICBtZS5sLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICBtZS5sLmNsYXNzTmFtZSA9ICJwYXJ0aWNsZSB0aXRsZSI7CiAgICAgIHZvaWQgbWUubC5vZmZzZXRXaWR0aDsKICAgICAgbWUubC5jbGFzc05hbWUgPSAicGFydGljbGUgdGl0bGUgcmlzaW5nVXBMaW5nZXIiOwogICAgICBpZiAoIW5vU3RhY2spIEdhbWUudGV4dFBhcnRpY2xlc1kgKz0gNjA7CiAgICB9OwogICAgR2FtZS5wb3B1cHMgPSAxOwogICAgR2FtZS5Qb3B1cCA9IGZ1bmN0aW9uICh0ZXh0LCB4LCB5KSB7CiAgICAgIGlmIChHYW1lLnBvcHVwcykgR2FtZS50ZXh0UGFydGljbGVzQWRkKHRleHQsIDAsIHgsIHkpOwogICAgfTsKCiAgICAvL2Rpc3BsYXkgc3BhcmtsZXMgYXQgYSBzZXQgcG9zaXRpb24KICAgIEdhbWUuc3BhcmtsZXMgPSBsKCJzcGFya2xlcyIpOwogICAgR2FtZS5zcGFya2xlc1QgPSAwOwogICAgR2FtZS5zcGFya2xlc0ZyYW1lcyA9IDE2OwogICAgR2FtZS5TcGFya2xlQXQgPSBmdW5jdGlvbiAoeCwgeSkgewogICAgICBpZiAoR2FtZS5ibGVuZE1vZGVzT24pIHsKICAgICAgICBHYW1lLnNwYXJrbGVzVCA9IEdhbWUuc3BhcmtsZXNGcmFtZXMgKyAxOwogICAgICAgIEdhbWUuc3BhcmtsZXMuc3R5bGUuYmFja2dyb3VuZFBvc2l0aW9uID0gIjBweCAwcHgiOwogICAgICAgIEdhbWUuc3BhcmtsZXMuc3R5bGUubGVmdCA9IE1hdGguZmxvb3IoeCAtIDY0KSArICJweCI7CiAgICAgICAgR2FtZS5zcGFya2xlcy5zdHlsZS50b3AgPSBNYXRoLmZsb29yKHkgLSA2NCkgKyAicHgiOwogICAgICAgIEdhbWUuc3BhcmtsZXMuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgIH0KICAgIH07CiAgICBHYW1lLlNwYXJrbGVPbiA9IGZ1bmN0aW9uIChlbCkgewogICAgICB2YXIgcmVjdCA9IGVsLmdldEJvdW5kcygpOwogICAgICBHYW1lLlNwYXJrbGVBdCgKICAgICAgICAocmVjdC5sZWZ0ICsgcmVjdC5yaWdodCkgLyAyLAogICAgICAgIChyZWN0LnRvcCArIHJlY3QuYm90dG9tKSAvIDIgLSAyNAogICAgICApOwogICAgfTsKCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCQlOT1RJRklDQVRJT05TCgkJPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KICAgIC8vbWF5YmUgZG8gYWxsIHRoaXMgbWVzcyB3aXRoIHByb3BlciBET00gaW5zdGVhZCBvZiByZXdyaXRpbmcgdGhlIGlubmVySFRNTAogICAgR2FtZS5Ob3RlcyA9IFtdOwogICAgR2FtZS5Ob3Rlc0J5SWQgPSBbXTsKICAgIEdhbWUubm90ZUlkID0gMDsKICAgIEdhbWUubm90ZUwgPSBsKCJub3RlcyIpOwogICAgR2FtZS5Ob3RlID0gZnVuY3Rpb24gKHRpdGxlLCBkZXNjLCBwaWMsIHF1aWNrKSB7CiAgICAgIHRoaXMudGl0bGUgPSB0aXRsZTsKICAgICAgdGhpcy5kZXNjID0gZGVzYyB8fCAiIjsKICAgICAgdGhpcy5waWMgPSBwaWMgfHwgIiI7CiAgICAgIHRoaXMuaWQgPSBHYW1lLm5vdGVJZDsKICAgICAgdGhpcy5kYXRlID0gRGF0ZS5ub3coKTsKICAgICAgdGhpcy5xdWljayA9IHF1aWNrIHx8IDA7CiAgICAgIHRoaXMubGlmZSA9ICh0aGlzLnF1aWNrIHx8IDEpICogR2FtZS5mcHM7CiAgICAgIHRoaXMubCA9IDA7CiAgICAgIHRoaXMuaGVpZ2h0ID0gMDsKICAgICAgdGhpcy50b29sdGlwID0gMDsKICAgICAgR2FtZS5ub3RlSWQrKzsKICAgICAgR2FtZS5Ob3Rlc0J5SWRbdGhpcy5pZF0gPSB0aGlzOwogICAgICBHYW1lLk5vdGVzLnVuc2hpZnQodGhpcyk7CiAgICAgIGlmIChHYW1lLk5vdGVzLmxlbmd0aCA+IDUwKSBHYW1lLk5vdGVzLnBvcCgpOwogICAgICAvL0dhbWUuTm90ZXMucHVzaCh0aGlzKTsKICAgICAgLy9pZiAoR2FtZS5Ob3Rlcy5sZW5ndGg+NTApIEdhbWUuTm90ZXMuc2hpZnQoKTsKICAgICAgR2FtZS5VcGRhdGVOb3RlcygpOwogICAgfTsKICAgIEdhbWUuQ2xvc2VOb3RlID0gZnVuY3Rpb24gKGlkKSB7CiAgICAgIHZhciBtZSA9IEdhbWUuTm90ZXNCeUlkW2lkXTsKICAgICAgaWYgKEdhbWUudG9vbHRpcC5mcm9tICYmIEdhbWUudG9vbHRpcC5mcm9tLmlkLmluZGV4T2YoIm5vdGUtIikgPT0gMCkKICAgICAgICBHYW1lLnRvb2x0aXAuaGlkZSgpOwogICAgICBHYW1lLk5vdGVzLnNwbGljZShHYW1lLk5vdGVzLmluZGV4T2YobWUpLCAxKTsKICAgICAgLy9HYW1lLk5vdGVzQnlJZC5zcGxpY2UoR2FtZS5Ob3Rlc0J5SWQuaW5kZXhPZihtZSksMSk7CiAgICAgIEdhbWUuTm90ZXNCeUlkW2lkXSA9IG51bGw7CiAgICAgIEdhbWUuVXBkYXRlTm90ZXMoKTsKICAgIH07CiAgICBHYW1lLkNsb3NlTm90ZXMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIEdhbWUuTm90ZXMgPSBbXTsKICAgICAgR2FtZS5Ob3Rlc0J5SWQgPSBbXTsKICAgICAgR2FtZS50b29sdGlwLmhpZGUoKTsKICAgICAgR2FtZS5VcGRhdGVOb3RlcygpOwogICAgfTsKICAgIEdhbWUuVXBkYXRlTm90ZXMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBzdHIgPSAiIjsKICAgICAgdmFyIHJlbWFpbmluZyA9IEdhbWUuTm90ZXMubGVuZ3RoOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUuTm90ZXMpIHsKICAgICAgICBpZiAoaSA8IDUpIHsKICAgICAgICAgIHZhciBtZSA9IEdhbWUuTm90ZXNbaV07CiAgICAgICAgICB2YXIgcGljID0gIiI7CiAgICAgICAgICBpZiAobWUucGljICE9ICIiKQogICAgICAgICAgICBwaWMgPSAnPGRpdiBjbGFzcz0iaWNvbiIgc3R5bGU9IicgKyB3cml0ZUljb24obWUucGljKSArICciPjwvZGl2Pic7CiAgICAgICAgICBzdHIgPQogICAgICAgICAgICAnPGRpdiBpZD0ibm90ZS0nICsKICAgICAgICAgICAgbWUuaWQgKwogICAgICAgICAgICAnIiAnICsKICAgICAgICAgICAgKG1lLnRvb2x0aXAKICAgICAgICAgICAgICA/IEdhbWUuZ2V0RHluYW1pY1Rvb2x0aXAobWUudG9vbHRpcCwgInRoaXMiLCB0cnVlKSArICIgIgogICAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICAgJ2NsYXNzPSJmcmFtZWQgbm90ZSAnICsKICAgICAgICAgICAgKG1lLnBpYyAhPSAiIiA/ICJoYXNwaWMiIDogIm5vcGljIikgKwogICAgICAgICAgICAiICIgKwogICAgICAgICAgICAobWUuZGVzYyAhPSAiIiA/ICJoYXNkZXNjIiA6ICJub2Rlc2MiKSArCiAgICAgICAgICAgICciPjxkaXYgY2xhc3M9ImNsb3NlIiBvbmNsaWNrPSJQbGF5U291bmQoXCdzbmQvdGljay5tcDNcJyk7R2FtZS5DbG9zZU5vdGUoJyArCiAgICAgICAgICAgIG1lLmlkICsKICAgICAgICAgICAgJyk7Ij54PC9kaXY+JyArCiAgICAgICAgICAgIHBpYyArCiAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJ0ZXh0Ij48aDM+JyArCiAgICAgICAgICAgIG1lLnRpdGxlICsKICAgICAgICAgICAgIjwvaDM+IiArCiAgICAgICAgICAgIChtZS5kZXNjICE9ICIiCiAgICAgICAgICAgICAgPyAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+PGg1PicgKyBtZS5kZXNjICsgIjwvaDU+IgogICAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICAgIjwvZGl2PjwvZGl2PiIgKwogICAgICAgICAgICBzdHI7CiAgICAgICAgICByZW1haW5pbmctLTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHJlbWFpbmluZyA+IDApCiAgICAgICAgc3RyID0KICAgICAgICAgICc8ZGl2IGNsYXNzPSJyZW1haW5pbmciPicgKwogICAgICAgICAgbG9jKCIrJTEgbW9yZSBub3RpZmljYXRpb24uIiwgTEJlYXV0aWZ5KHJlbWFpbmluZykpICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgIHN0cjsKICAgICAgaWYgKEdhbWUuTm90ZXMubGVuZ3RoID4gMSkgewogICAgICAgIHN0ciArPQogICAgICAgICAgJzxkaXYgY2xhc3M9ImZyYW1lZCBjbG9zZSBzaWRlbm90ZSIgb25jbGljaz0iUGxheVNvdW5kKFwnc25kL3RpY2subXAzXCcpO0dhbWUuQ2xvc2VOb3RlcygpOyI+eDwvZGl2Pic7CiAgICAgIH0KICAgICAgR2FtZS5ub3RlTC5pbm5lckhUTUwgPSBzdHI7CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5Ob3RlcykgewogICAgICAgIG1lLmwgPSAwOwogICAgICAgIGlmIChpIDwgNSkgewogICAgICAgICAgdmFyIG1lID0gR2FtZS5Ob3Rlc1tpXTsKICAgICAgICAgIG1lLmwgPSBsKCJub3RlLSIgKyBtZS5pZCk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwogICAgR2FtZS5Ob3Rlc0xvZ2ljID0gZnVuY3Rpb24gKCkgewogICAgICBmb3IgKHZhciBpIGluIEdhbWUuTm90ZXMpIHsKICAgICAgICBpZiAoR2FtZS5Ob3Rlc1tpXS5xdWljayA+IDApIHsKICAgICAgICAgIHZhciBtZSA9IEdhbWUuTm90ZXNbaV07CiAgICAgICAgICBtZS5saWZlLS07CiAgICAgICAgICBpZiAobWUubGlmZSA8PSAwKSBHYW1lLkNsb3NlTm90ZShtZS5pZCk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwogICAgR2FtZS5Ob3Rlc0RyYXcgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5Ob3RlcykgewogICAgICAgIGlmIChHYW1lLk5vdGVzW2ldLnF1aWNrID4gMCkgewogICAgICAgICAgdmFyIG1lID0gR2FtZS5Ob3Rlc1tpXTsKICAgICAgICAgIGlmIChtZS5sKSB7CiAgICAgICAgICAgIGlmIChtZS5saWZlIDwgMTApIHsKICAgICAgICAgICAgICBtZS5sLnN0eWxlLm9wYWNpdHkgPSBtZS5saWZlIC8gMTA7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgICBHYW1lLk5vdGlmeSA9IGZ1bmN0aW9uICh0aXRsZSwgZGVzYywgcGljLCBxdWljaywgbm9Mb2cpIHsKICAgICAgaWYgKEdhbWUucHJlZnMubm90aWZzKSB7CiAgICAgICAgcXVpY2sgPSBNYXRoLm1pbig2LCBxdWljayk7CiAgICAgICAgaWYgKCFxdWljaykgcXVpY2sgPSA2OwogICAgICB9CiAgICAgIGRlc2MgPSByZXBsYWNlQWxsKAogICAgICAgICI9PUNMT1NFVEhJUygpPT0iLAogICAgICAgICJHYW1lLkNsb3NlTm90ZSgiICsgR2FtZS5ub3RlSWQgKyAiKTsiLAogICAgICAgIGRlc2MKICAgICAgKTsKICAgICAgaWYgKEdhbWUucG9wdXBzKSBuZXcgR2FtZS5Ob3RlKHRpdGxlLCBkZXNjLCBwaWMsIHF1aWNrKTsKICAgICAgaWYgKCFub0xvZykgR2FtZS5BZGRUb0xvZygiPGI+IiArIHRpdGxlICsgIjwvYj4gfCAiICsgZGVzYyk7CiAgICB9OwogICAgR2FtZS5Ob3RpZnlUb29sdGlwID0gZnVuY3Rpb24gKGNvbnRlbnQpIHsKICAgICAgLy9hdHRhY2hlcyBhIHRvb2x0aXAgdG8gdGhlIGxhc3Qgc3Bhd25lZCBub3RlCiAgICAgIGlmICghR2FtZS5Ob3Rlc0J5SWRbR2FtZS5ub3RlSWQgLSAxXSkgcmV0dXJuIGZhbHNlOwogICAgICB2YXIgbWUgPSBHYW1lLk5vdGVzQnlJZFtHYW1lLm5vdGVJZCAtIDFdOwogICAgICBtZS50b29sdGlwID0gY29udGVudDsKICAgICAgR2FtZS5VcGRhdGVOb3RlcygpOwogICAgfTsKCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCQlQUk9NUFQKCQk9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgR2FtZS5kYXJrZW5MID0gbCgiZGFya2VuIik7CiAgICBBZGRFdmVudChHYW1lLmRhcmtlbkwsICJjbGljayIsIGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKEdhbWUucHJvbXB0Tm9DbG9zZSkgewogICAgICB9IGVsc2UgewogICAgICAgIEdhbWUuQ2xpY2sgPSAwOwogICAgICAgIFBsYXlTb3VuZCgic25kL3RpY2tPZmYubXAzIik7CiAgICAgICAgR2FtZS5DbG9zZVByb21wdCgpOwogICAgICB9CiAgICB9KTsKICAgIEdhbWUucHJvbXB0TCA9IGwoInByb21wdENvbnRlbnQiKTsKICAgIEdhbWUucHJvbXB0QW5jaG9yTCA9IGwoInByb21wdEFuY2hvciIpOwogICAgR2FtZS5wcm9tcHRXcmFwTCA9IGwoInByb21wdCIpOwogICAgR2FtZS5wcm9tcHRDb25maXJtID0gIiI7CiAgICBHYW1lLnByb21wdE9uID0gMDsKICAgIEdhbWUucHJvbXB0VXBkYXRlRnVuYyA9IDA7CiAgICBHYW1lLnByb21wdE9wdGlvbnNOID0gMDsKICAgIEdhbWUucHJvbXB0T3B0aW9uRm9jdXMgPSAwOwogICAgR2FtZS5wcm9tcHROb0Nsb3NlID0gZmFsc2U7CiAgICBHYW1lLlVwZGF0ZVByb21wdCA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKEdhbWUucHJvbXB0VXBkYXRlRnVuYykgR2FtZS5wcm9tcHRVcGRhdGVGdW5jKCk7CiAgICAgIEdhbWUucHJvbXB0QW5jaG9yTC5zdHlsZS50b3AgPQogICAgICAgIE1hdGguZmxvb3IoKEdhbWUud2luZG93SCAtIEdhbWUucHJvbXB0V3JhcEwub2Zmc2V0SGVpZ2h0KSAvIDIgLSAxNikgKwogICAgICAgICJweCI7CiAgICB9OwogICAgR2FtZS5Qcm9tcHQgPSBmdW5jdGlvbiAoY29udGVudCwgb3B0aW9ucywgdXBkYXRlRnVuYywgc3R5bGUpIHsKICAgICAgR2FtZS5wcm9tcHROb0Nsb3NlID0gZmFsc2U7CiAgICAgIGlmICh1cGRhdGVGdW5jKSBHYW1lLnByb21wdFVwZGF0ZUZ1bmMgPSB1cGRhdGVGdW5jOwogICAgICBpZiAoc3R5bGUpIEdhbWUucHJvbXB0V3JhcEwuY2xhc3NOYW1lID0gImZyYW1lZCAiICsgc3R5bGU7CiAgICAgIGVsc2UgR2FtZS5wcm9tcHRXcmFwTC5jbGFzc05hbWUgPSAiZnJhbWVkIjsKICAgICAgdmFyIHN0ciA9ICIiOwogICAgICBzdHIgKz0gY29udGVudDsKICAgICAgaWYgKHN0ci5pbmRleE9mKCI8aWQgIikgPT0gMCkgewogICAgICAgIHZhciBpZCA9IHN0ci5zdWJzdHJpbmcoNCwgc3RyLmluZGV4T2YoIj4iKSk7CiAgICAgICAgc3RyID0gc3RyLnN1YnN0cmluZyhzdHIuaW5kZXhPZigiPiIpICsgMSk7CiAgICAgICAgc3RyID0gJzxkaXYgaWQ9InByb21wdENvbnRlbnQnICsgaWQgKyAnIj4nICsgc3RyICsgIjwvZGl2PiI7CiAgICAgIH0KICAgICAgaWYgKHN0ci5pbmRleE9mKCI8bm9DbG9zZT4iKSAhPSAtMSkgewogICAgICAgIHN0ciA9IHN0ci5yZXBsYWNlKCI8bm9DbG9zZT4iLCAiIik7CiAgICAgICAgR2FtZS5wcm9tcHROb0Nsb3NlID0gdHJ1ZTsKICAgICAgfQogICAgICB2YXIgb3B0cyA9ICIiOwogICAgICBHYW1lLnByb21wdE9wdGlvbnNOID0gMDsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvcHRpb25zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKG9wdGlvbnNbaV0gPT0gImJyIikgewogICAgICAgICAgLy9qdXN0IGEgbGluZWJyZWFrCiAgICAgICAgICBvcHRzICs9ICI8YnI+IjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zW2ldID09ICJzdHJpbmciKQogICAgICAgICAgICBvcHRpb25zW2ldID0gWwogICAgICAgICAgICAgIG9wdGlvbnNbaV0sCiAgICAgICAgICAgICAgIlBsYXlTb3VuZCgnc25kL3RpY2tPZmYubXAzJyk7R2FtZS5DbG9zZVByb21wdCgpOyIsCiAgICAgICAgICAgIF07CiAgICAgICAgICBlbHNlIGlmICghb3B0aW9uc1tpXVsxXSkKICAgICAgICAgICAgb3B0aW9uc1tpXSA9IFsKICAgICAgICAgICAgICBvcHRpb25zW2ldWzBdLAogICAgICAgICAgICAgICJQbGF5U291bmQoJ3NuZC90aWNrT2ZmLm1wMycpO0dhbWUuQ2xvc2VQcm9tcHQoKTsiLAogICAgICAgICAgICAgIG9wdGlvbnNbaV1bMl0sCiAgICAgICAgICAgIF07CiAgICAgICAgICBlbHNlIG9wdGlvbnNbaV1bMV0gPSAiUGxheVNvdW5kKCdzbmQvdGljay5tcDMnKTsiICsgb3B0aW9uc1tpXVsxXTsKICAgICAgICAgIG9wdGlvbnNbaV1bMV0gPSBvcHRpb25zW2ldWzFdCiAgICAgICAgICAgIC5yZXBsYWNlKC8nL2csICImIzM5OyIpCiAgICAgICAgICAgIC5yZXBsYWNlKC8iL2csICImIzM0OyIpOwogICAgICAgICAgb3B0cyArPQogICAgICAgICAgICAnPGEgaWQ9InByb21wdE9wdGlvbicgKwogICAgICAgICAgICBpICsKICAgICAgICAgICAgJyIgY2xhc3M9Im9wdGlvbiIgJyArCiAgICAgICAgICAgIChvcHRpb25zW2ldWzJdID8gJ3N0eWxlPSInICsgb3B0aW9uc1tpXVsyXSArICciICcgOiAiIikgKwogICAgICAgICAgICAiIiArCiAgICAgICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICAgICAnPSInICsKICAgICAgICAgICAgb3B0aW9uc1tpXVsxXSArCiAgICAgICAgICAgICciPicgKwogICAgICAgICAgICBvcHRpb25zW2ldWzBdICsKICAgICAgICAgICAgIjwvYT4iOwogICAgICAgICAgR2FtZS5wcm9tcHRPcHRpb25zTisrOwogICAgICAgIH0KICAgICAgfQogICAgICBHYW1lLnByb21wdEwuaW5uZXJIVE1MID0KICAgICAgICBzdHIgKyAnPGRpdiBjbGFzcz0ib3B0aW9uQm94Ij4nICsgb3B0cyArICI8L2Rpdj4iOwogICAgICBHYW1lLnByb21wdEFuY2hvckwuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgIEdhbWUuZGFya2VuTC5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgR2FtZS5wcm9tcHRMLmZvY3VzKCk7CiAgICAgIEdhbWUucHJvbXB0T24gPSAxOwogICAgICBHYW1lLnByb21wdE9wdGlvbkZvY3VzID0gMDsKICAgICAgR2FtZS5Gb2N1c1Byb21wdE9wdGlvbigwKTsKICAgICAgR2FtZS5VcGRhdGVQcm9tcHQoKTsKICAgICAgaWYgKCFHYW1lLnByb21wdE5vQ2xvc2UpIGwoInByb21wdENsb3NlIikuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgIGVsc2UgbCgicHJvbXB0Q2xvc2UiKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgfTsKICAgIEdhbWUuQ2xvc2VQcm9tcHQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICghR2FtZS5wcm9tcHRPbikgcmV0dXJuIGZhbHNlOwogICAgICBHYW1lLnByb21wdEFuY2hvckwuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgR2FtZS5kYXJrZW5MLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgIEdhbWUucHJvbXB0T24gPSAwOwogICAgICBHYW1lLnByb21wdFVwZGF0ZUZ1bmMgPSAwOwogICAgICBHYW1lLnByb21wdE9wdGlvbkZvY3VzID0gMDsKICAgICAgR2FtZS5wcm9tcHRPcHRpb25zTiA9IDA7CiAgICAgIEdhbWUucHJvbXB0Tm9DbG9zZSA9IGZhbHNlOwogICAgfTsKICAgIEdhbWUuQ29uZmlybVByb21wdCA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKAogICAgICAgIEdhbWUucHJvbXB0T24gJiYKICAgICAgICBsKCJwcm9tcHRPcHRpb24iICsgR2FtZS5wcm9tcHRPcHRpb25Gb2N1cykgJiYKICAgICAgICBsKCJwcm9tcHRPcHRpb24iICsgR2FtZS5wcm9tcHRPcHRpb25Gb2N1cykuc3R5bGUuZGlzcGxheSAhPSAibm9uZSIKICAgICAgKQogICAgICAgIEZpcmVFdmVudChsKCJwcm9tcHRPcHRpb24iICsgR2FtZS5wcm9tcHRPcHRpb25Gb2N1cyksICJjbGljayIpOwogICAgfTsKICAgIEdhbWUuRm9jdXNQcm9tcHRPcHRpb24gPSBmdW5jdGlvbiAoZGlyLCB0cnlOKSB7CiAgICAgIHZhciBpZCA9IEdhbWUucHJvbXB0T3B0aW9uRm9jdXMgKyBkaXI7CiAgICAgIGlmIChpZCA8IDApIGlkID0gR2FtZS5wcm9tcHRPcHRpb25zTiAtIDE7CiAgICAgIGlmIChpZCA+PSBHYW1lLnByb21wdE9wdGlvbnNOKSBpZCA9IDA7CiAgICAgIHdoaWxlICgKICAgICAgICBpZCA+PSAwICYmCiAgICAgICAgaWQgPCBHYW1lLnByb21wdE9wdGlvbnNOICYmCiAgICAgICAgKCFsKCJwcm9tcHRPcHRpb24iICsgaWQpIHx8CiAgICAgICAgICBsKCJwcm9tcHRPcHRpb24iICsgaWQpLnN0eWxlLmRpc3BsYXkgPT0gIm5vbmUiKQogICAgICApIHsKICAgICAgICBpZCArPSBkaXIgfHwgMTsKICAgICAgfQogICAgICBpZiAoCiAgICAgICAgbCgicHJvbXB0T3B0aW9uIiArIGlkKSAmJgogICAgICAgIGwoInByb21wdE9wdGlvbiIgKyBpZCkuc3R5bGUuZGlzcGxheSAhPSAibm9uZSIKICAgICAgKSB7CiAgICAgICAgaWYgKGwoInByb21wdE9wdGlvbiIgKyBHYW1lLnByb21wdE9wdGlvbkZvY3VzKSkKICAgICAgICAgIGwoInByb21wdE9wdGlvbiIgKyBHYW1lLnByb21wdE9wdGlvbkZvY3VzKS5jbGFzc0xpc3QucmVtb3ZlKAogICAgICAgICAgICAiZm9jdXNlZCIKICAgICAgICAgICk7CiAgICAgICAgR2FtZS5wcm9tcHRPcHRpb25Gb2N1cyA9IGlkOwogICAgICAgIGlmIChsKCJwcm9tcHRPcHRpb24iICsgR2FtZS5wcm9tcHRPcHRpb25Gb2N1cykpCiAgICAgICAgICBsKCJwcm9tcHRPcHRpb24iICsgR2FtZS5wcm9tcHRPcHRpb25Gb2N1cykuY2xhc3NMaXN0LmFkZCgiZm9jdXNlZCIpOwogICAgICB9IGVsc2UgaWYgKCF0cnlOICYmIGRpciAhPSAwKSB7CiAgICAgICAgR2FtZS5wcm9tcHRPcHRpb25Gb2N1cyA9IGlkOwogICAgICAgIEdhbWUuRm9jdXNQcm9tcHRPcHRpb24oZGlyLCAxKTsKICAgICAgfQogICAgfTsKCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCQlNRU5VUwoJCT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCiAgICBHYW1lLmNzc0NsYXNzZXMgPSBbXTsKICAgIEdhbWUuYWRkQ2xhc3MgPSBmdW5jdGlvbiAod2hhdCkgewogICAgICBpZiAoR2FtZS5jc3NDbGFzc2VzLmluZGV4T2Yod2hhdCkgPT0gLTEpIEdhbWUuY3NzQ2xhc3Nlcy5wdXNoKHdoYXQpOwogICAgICBHYW1lLnVwZGF0ZUNsYXNzZXMoKTsKICAgIH07CiAgICBHYW1lLnJlbW92ZUNsYXNzID0gZnVuY3Rpb24gKHdoYXQpIHsKICAgICAgdmFyIGkgPSBHYW1lLmNzc0NsYXNzZXMuaW5kZXhPZih3aGF0KTsKICAgICAgaWYgKGkgIT0gLTEpIHsKICAgICAgICBHYW1lLmNzc0NsYXNzZXMuc3BsaWNlKGksIDEpOwogICAgICB9CiAgICAgIEdhbWUudXBkYXRlQ2xhc3NlcygpOwogICAgfTsKICAgIEdhbWUudXBkYXRlQ2xhc3NlcyA9IGZ1bmN0aW9uICgpIHsKICAgICAgR2FtZS5sLmNsYXNzTmFtZSA9IEdhbWUuY3NzQ2xhc3Nlcy5qb2luKCIgIik7CiAgICB9OwoKICAgIEdhbWUuV3JpdGVQcmVmQnV0dG9uID0gZnVuY3Rpb24gKAogICAgICBwcmVmTmFtZSwKICAgICAgYnV0dG9uLAogICAgICBvbiwKICAgICAgb2ZmLAogICAgICBjYWxsYmFjaywKICAgICAgaW52ZXJ0CiAgICApIHsKICAgICAgdmFyIGludmVydCA9IGludmVydCA/IDEgOiAwOwogICAgICBpZiAoIWNhbGxiYWNrKSBjYWxsYmFjayA9ICIiOwogICAgICBjYWxsYmFjayArPSAiUGxheVNvdW5kKCdzbmQvdGljay5tcDMnKTsiOwogICAgICByZXR1cm4gKAogICAgICAgICc8YSBjbGFzcz0ic21hbGxGYW5jeUJ1dHRvbiBwcmVmQnV0dG9uIG9wdGlvbicgKwogICAgICAgIChHYW1lLnByZWZzW3ByZWZOYW1lXSBeIGludmVydCA/ICIiIDogIiBvZmYiKSArCiAgICAgICAgJyIgaWQ9IicgKwogICAgICAgIGJ1dHRvbiArCiAgICAgICAgJyIgJyArCiAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgIj1cIkdhbWUuVG9nZ2xlKCciICsKICAgICAgICBwcmVmTmFtZSArCiAgICAgICAgIicsJyIgKwogICAgICAgIGJ1dHRvbiArCiAgICAgICAgIicsJyIgKwogICAgICAgIG9uICsKICAgICAgICAiJywnIiArCiAgICAgICAgb2ZmICsKICAgICAgICAiJywnIiArCiAgICAgICAgaW52ZXJ0ICsKICAgICAgICAiJyk7IiArCiAgICAgICAgY2FsbGJhY2sgKwogICAgICAgICciPicgKwogICAgICAgIChHYW1lLnByZWZzW3ByZWZOYW1lXSA/IG9uIDogb2ZmKSArCiAgICAgICAgIjwvYT4iCiAgICAgICk7CiAgICB9OwogICAgR2FtZS5Ub2dnbGUgPSBmdW5jdGlvbiAocHJlZk5hbWUsIGJ1dHRvbiwgb24sIG9mZiwgaW52ZXJ0KSB7CiAgICAgIGlmIChHYW1lLnByZWZzW3ByZWZOYW1lXSkgewogICAgICAgIGwoYnV0dG9uKS5pbm5lckhUTUwgPSBvZmY7CiAgICAgICAgR2FtZS5wcmVmc1twcmVmTmFtZV0gPSAwOwogICAgICB9IGVsc2UgewogICAgICAgIGwoYnV0dG9uKS5pbm5lckhUTUwgPSBvbjsKICAgICAgICBHYW1lLnByZWZzW3ByZWZOYW1lXSA9IDE7CiAgICAgIH0KICAgICAgbChidXR0b24pLmNsYXNzTmFtZSA9CiAgICAgICAgInNtYWxsRmFuY3lCdXR0b24gcHJlZkJ1dHRvbiBvcHRpb24iICsKICAgICAgICAoR2FtZS5wcmVmc1twcmVmTmFtZV0gXiBpbnZlcnQgPyAiIiA6ICIgb2ZmIik7CiAgICB9OwogICAgR2FtZS5Ub2dnbGVGYW5jeSA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKEdhbWUucHJlZnMuZmFuY3kpIEdhbWUucmVtb3ZlQ2xhc3MoIm5vRmFuY3kiKTsKICAgICAgZWxzZSBpZiAoIUdhbWUucHJlZnMuZmFuY3kpIEdhbWUuYWRkQ2xhc3MoIm5vRmFuY3kiKTsKICAgIH07CiAgICBHYW1lLlRvZ2dsZUZpbHRlcnMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChHYW1lLnByZWZzLmZpbHRlcnMpIEdhbWUucmVtb3ZlQ2xhc3MoIm5vRmlsdGVycyIpOwogICAgICBlbHNlIGlmICghR2FtZS5wcmVmcy5maWx0ZXJzKSBHYW1lLmFkZENsYXNzKCJub0ZpbHRlcnMiKTsKICAgIH07CiAgICBHYW1lLlRvZ2dsZUV4dHJhQnV0dG9ucyA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCFHYW1lLnByZWZzLmV4dHJhQnV0dG9ucykgR2FtZS5yZW1vdmVDbGFzcygiZXh0cmFCdXR0b25zIik7CiAgICAgIGVsc2UgaWYgKEdhbWUucHJlZnMuZXh0cmFCdXR0b25zKSBHYW1lLmFkZENsYXNzKCJleHRyYUJ1dHRvbnMiKTsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICBHYW1lLk9iamVjdHNbaV0ubXV0ZSgwKTsKICAgICAgfQogICAgfTsKICAgIEdhbWUuVG9nZ2xlRnVsbHNjcmVlbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKEFwcCkgQXBwLnNldEZ1bGxzY3JlZW4oR2FtZS5wcmVmcy5mdWxsc2NyZWVuKTsKICAgIH07CgogICAgR2FtZS5Xcml0ZVNsaWRlciA9IGZ1bmN0aW9uICgKICAgICAgc2xpZGVyLAogICAgICBsZWZ0VGV4dCwKICAgICAgcmlnaHRUZXh0LAogICAgICBzdGFydFZhbHVlRnVuY3Rpb24sCiAgICAgIGNhbGxiYWNrCiAgICApIHsKICAgICAgaWYgKCFjYWxsYmFjaykgY2FsbGJhY2sgPSAiIjsKICAgICAgcmV0dXJuICgKICAgICAgICAnPGRpdiBjbGFzcz0ic2xpZGVyQm94Ij48ZGl2IHN0eWxlPSJmbG9hdDpsZWZ0OyIgY2xhc3M9InNtYWxsRmFuY3lCdXR0b24iPicgKwogICAgICAgIGxlZnRUZXh0ICsKICAgICAgICAnPC9kaXY+PGRpdiBzdHlsZT0iZmxvYXQ6cmlnaHQ7IiBjbGFzcz0ic21hbGxGYW5jeUJ1dHRvbiIgaWQ9IicgKwogICAgICAgIHNsaWRlciArCiAgICAgICAgJ1JpZ2h0VGV4dCI+JyArCiAgICAgICAgcmlnaHRUZXh0LnJlcGxhY2UoIlskXSIsIHN0YXJ0VmFsdWVGdW5jdGlvbigpKSArCiAgICAgICAgJzwvZGl2PjxpbnB1dCBjbGFzcz0ic2xpZGVyIiBzdHlsZT0iY2xlYXI6Ym90aDsiIHR5cGU9InJhbmdlIiBtaW49IjAiIG1heD0iMTAwIiBzdGVwPSIxIiB2YWx1ZT0iJyArCiAgICAgICAgc3RhcnRWYWx1ZUZ1bmN0aW9uKCkgKwogICAgICAgICciIG9uY2hhbmdlPSInICsKICAgICAgICBjYWxsYmFjayArCiAgICAgICAgJyIgb25pbnB1dD0iJyArCiAgICAgICAgY2FsbGJhY2sgKwogICAgICAgICciIG9ubW91c2V1cD0iUGxheVNvdW5kKFwnc25kL3RpY2subXAzXCcpOyIgaWQ9IicgKwogICAgICAgIHNsaWRlciArCiAgICAgICAgJyIvPjwvZGl2PicKICAgICAgKTsKICAgIH07CgogICAgR2FtZS5vblBhbmVsID0gIkxlZnQiOwogICAgR2FtZS5hZGRDbGFzcygiZm9jdXMiICsgR2FtZS5vblBhbmVsKTsKICAgIEdhbWUuU2hvd1BhbmVsID0gZnVuY3Rpb24gKHdoYXQpIHsKICAgICAgaWYgKCF3aGF0KSB3aGF0ID0gIiI7CiAgICAgIGlmIChHYW1lLm9uUGFuZWwgIT0gd2hhdCkgewogICAgICAgIEdhbWUucmVtb3ZlQ2xhc3MoImZvY3VzIiArIEdhbWUub25QYW5lbCk7CiAgICAgICAgR2FtZS5hZGRDbGFzcygiZm9jdXMiICsgd2hhdCk7CiAgICAgIH0KICAgICAgR2FtZS5vblBhbmVsID0gd2hhdDsKICAgIH07CgogICAgR2FtZS5vbk1lbnUgPSAiIjsKICAgIEdhbWUuU2hvd01lbnUgPSBmdW5jdGlvbiAod2hhdCkgewogICAgICBpZiAoIXdoYXQgfHwgd2hhdCA9PSAiIikgd2hhdCA9IEdhbWUub25NZW51OwogICAgICBpZiAoR2FtZS5vbk1lbnUgPT0gIiIgJiYgd2hhdCAhPSAiIikgR2FtZS5hZGRDbGFzcygib25NZW51Iik7CiAgICAgIGVsc2UgaWYgKEdhbWUub25NZW51ICE9ICIiICYmIHdoYXQgIT0gR2FtZS5vbk1lbnUpCiAgICAgICAgR2FtZS5hZGRDbGFzcygib25NZW51Iik7CiAgICAgIGVsc2UgaWYgKHdoYXQgPT0gR2FtZS5vbk1lbnUpIHsKICAgICAgICBHYW1lLnJlbW92ZUNsYXNzKCJvbk1lbnUiKTsKICAgICAgICB3aGF0ID0gIiI7CiAgICAgIH0KICAgICAgLy9pZiAod2hhdD09J2xvZycpIGwoJ2RvbmF0ZUJveCcpLmNsYXNzTmFtZT0nb24nOyBlbHNlIGwoJ2RvbmF0ZUJveCcpLmNsYXNzTmFtZT0nJzsKICAgICAgR2FtZS5vbk1lbnUgPSB3aGF0OwoKICAgICAgbCgicHJlZnNCdXR0b24iKS5jbGFzc05hbWUgPQogICAgICAgIEdhbWUub25NZW51ID09ICJwcmVmcyIgPyAicGFuZWxCdXR0b24gc2VsZWN0ZWQiIDogInBhbmVsQnV0dG9uIjsKICAgICAgbCgic3RhdHNCdXR0b24iKS5jbGFzc05hbWUgPQogICAgICAgIEdhbWUub25NZW51ID09ICJzdGF0cyIgPyAicGFuZWxCdXR0b24gc2VsZWN0ZWQiIDogInBhbmVsQnV0dG9uIjsKICAgICAgbCgibG9nQnV0dG9uIikuY2xhc3NOYW1lID0KICAgICAgICBHYW1lLm9uTWVudSA9PSAibG9nIiA/ICJwYW5lbEJ1dHRvbiBzZWxlY3RlZCIgOiAicGFuZWxCdXR0b24iOwoKICAgICAgaWYgKEdhbWUub25NZW51ID09ICIiKSBQbGF5U291bmQoInNuZC9jbGlja09mZjIubXAzIik7CiAgICAgIGVsc2UgUGxheVNvdW5kKCJzbmQvY2xpY2tPbjIubXAzIik7CgogICAgICBHYW1lLlVwZGF0ZU1lbnUoKTsKCiAgICAgIGlmICh3aGF0ID09ICIiKSB7CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICAgIHZhciBtZSA9IEdhbWUuT2JqZWN0c1tpXTsKICAgICAgICAgIGlmIChtZS5taW5pZ2FtZSAmJiBtZS5taW5pZ2FtZS5vblJlc2l6ZSkgbWUubWluaWdhbWUub25SZXNpemUoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgICBHYW1lLnNheVRpbWUgPSBmdW5jdGlvbiAodGltZSwgZGV0YWlsKSB7CiAgICAgIC8vdGltZSBpcyBhIHZhbHVlIHdoZXJlIG9uZSBzZWNvbmQgaXMgZXF1YWwgdG8gR2FtZS5mcHMgKDMwKS4KICAgICAgLy9kZXRhaWwgc2tpcHMgZGF5cyB3aGVuID4xLCBob3VycyB3aGVuID4yLCBtaW51dGVzIHdoZW4gPjMgYW5kIHNlY29uZHMgd2hlbiA+NC4KICAgICAgLy9pZiBkZXRhaWwgaXMgLTEsIG91dHB1dCBzb21ldGhpbmcgbGlrZSAiMyBob3VycywgOSBtaW51dGVzLCA0OCBzZWNvbmRzIgogICAgICBpZiAodGltZSA8PSAwKSByZXR1cm4gIiI7CiAgICAgIHZhciBzdHIgPSAiIjsKICAgICAgdmFyIGRldGFpbCA9IGRldGFpbCB8fCAwOwogICAgICB0aW1lID0gTWF0aC5mbG9vcih0aW1lKTsKICAgICAgaWYgKGRldGFpbCA9PSAtMSkgewogICAgICAgIC8vdmFyIG1vbnRocz0wOwogICAgICAgIHZhciBkYXlzID0gMDsKICAgICAgICB2YXIgaG91cnMgPSAwOwogICAgICAgIHZhciBtaW51dGVzID0gMDsKICAgICAgICB2YXIgc2Vjb25kcyA9IDA7CiAgICAgICAgLy9pZiAodGltZT49R2FtZS5mcHMqNjAqNjAqMjQqMzApIG1vbnRocz0oTWF0aC5mbG9vcih0aW1lLyhHYW1lLmZwcyo2MCo2MCoyNCozMCkpKTsKICAgICAgICBpZiAodGltZSA+PSBHYW1lLmZwcyAqIDYwICogNjAgKiAyNCkKICAgICAgICAgIGRheXMgPSBNYXRoLmZsb29yKHRpbWUgLyAoR2FtZS5mcHMgKiA2MCAqIDYwICogMjQpKTsKICAgICAgICBpZiAodGltZSA+PSBHYW1lLmZwcyAqIDYwICogNjApCiAgICAgICAgICBob3VycyA9IE1hdGguZmxvb3IodGltZSAvIChHYW1lLmZwcyAqIDYwICogNjApKTsKICAgICAgICBpZiAodGltZSA+PSBHYW1lLmZwcyAqIDYwKSBtaW51dGVzID0gTWF0aC5mbG9vcih0aW1lIC8gKEdhbWUuZnBzICogNjApKTsKICAgICAgICBpZiAodGltZSA+PSBHYW1lLmZwcykgc2Vjb25kcyA9IE1hdGguZmxvb3IodGltZSAvIEdhbWUuZnBzKTsKICAgICAgICAvL2RheXMtPW1vbnRocyozMDsKICAgICAgICBob3VycyAtPSBkYXlzICogMjQ7CiAgICAgICAgbWludXRlcyAtPSBob3VycyAqIDYwICsgZGF5cyAqIDI0ICogNjA7CiAgICAgICAgc2Vjb25kcyAtPSBtaW51dGVzICogNjAgKyBob3VycyAqIDYwICogNjAgKyBkYXlzICogMjQgKiA2MCAqIDYwOwogICAgICAgIGlmIChkYXlzID4gMTApIHsKICAgICAgICAgIGhvdXJzID0gMDsKICAgICAgICB9CiAgICAgICAgaWYgKGRheXMpIHsKICAgICAgICAgIG1pbnV0ZXMgPSAwOwogICAgICAgICAgc2Vjb25kcyA9IDA7CiAgICAgICAgfQogICAgICAgIGlmIChob3VycykgewogICAgICAgICAgc2Vjb25kcyA9IDA7CiAgICAgICAgfQogICAgICAgIHZhciBiaXRzID0gW107CiAgICAgICAgLy9pZiAobW9udGhzPjApIGJpdHMucHVzaChCZWF1dGlmeShtb250aHMpKycgbW9udGgnKyhkYXlzPT0xPycnOidzJykpOwogICAgICAgIGlmIChkYXlzID4gMCkgYml0cy5wdXNoKGxvYygiJTEgZGF5IiwgTEJlYXV0aWZ5KGRheXMpKSk7CiAgICAgICAgaWYgKGhvdXJzID4gMCkgYml0cy5wdXNoKGxvYygiJTEgaG91ciIsIExCZWF1dGlmeShob3VycykpKTsKICAgICAgICBpZiAobWludXRlcyA+IDApIGJpdHMucHVzaChsb2MoIiUxIG1pbnV0ZSIsIExCZWF1dGlmeShtaW51dGVzKSkpOwogICAgICAgIGlmIChzZWNvbmRzID4gMCkgYml0cy5wdXNoKGxvYygiJTEgc2Vjb25kIiwgTEJlYXV0aWZ5KHNlY29uZHMpKSk7CiAgICAgICAgaWYgKGJpdHMubGVuZ3RoID09IDApIHN0ciA9IGxvYygibGVzcyB0aGFuIDEgc2Vjb25kIik7CiAgICAgICAgZWxzZSBzdHIgPSBiaXRzLmpvaW4oIiwgIik7CiAgICAgICAgLyovL2lmIChtb250aHM+MCkgYml0cy5wdXNoKEJlYXV0aWZ5KG1vbnRocykrJyBtb250aCcrKGRheXM9PTE/Jyc6J3MnKSk7CgkJCQlpZiAoZGF5cz4wKSBiaXRzLnB1c2goQmVhdXRpZnkoZGF5cykrJyBkYXknKyhkYXlzPT0xPycnOidzJykpOwoJCQkJaWYgKGhvdXJzPjApIGJpdHMucHVzaChCZWF1dGlmeShob3VycykrJyBob3VyJysoaG91cnM9PTE/Jyc6J3MnKSk7CgkJCQlpZiAobWludXRlcz4wKSBiaXRzLnB1c2goQmVhdXRpZnkobWludXRlcykrJyBtaW51dGUnKyhtaW51dGVzPT0xPycnOidzJykpOwoJCQkJaWYgKHNlY29uZHM+MCkgYml0cy5wdXNoKEJlYXV0aWZ5KHNlY29uZHMpKycgc2Vjb25kJysoc2Vjb25kcz09MT8nJzoncycpKTsKCQkJCWlmIChiaXRzLmxlbmd0aD09MCkgc3RyPSdsZXNzIHRoYW4gMSBzZWNvbmQnOwoJCQkJZWxzZSBzdHI9Yml0cy5qb2luKCcsICcpOyovCiAgICAgIH0gZWxzZSB7CiAgICAgICAgLyppZiAodGltZT49R2FtZS5mcHMqNjAqNjAqMjQqMzAqMiAmJiBkZXRhaWw8MSkgc3RyPUJlYXV0aWZ5KE1hdGguZmxvb3IodGltZS8oR2FtZS5mcHMqNjAqNjAqMjQqMzApKSkrJyBtb250aHMnOwoJCQkJZWxzZSBpZiAodGltZT49R2FtZS5mcHMqNjAqNjAqMjQqMzAgJiYgZGV0YWlsPDEpIHN0cj0nMSBtb250aCc7CgkJCQllbHNlICovIGlmICh0aW1lID49IEdhbWUuZnBzICogNjAgKiA2MCAqIDI0ICYmIGRldGFpbCA8IDIpCiAgICAgICAgICBzdHIgPSBsb2MoCiAgICAgICAgICAgICIlMSBkYXkiLAogICAgICAgICAgICBMQmVhdXRpZnkoTWF0aC5mbG9vcih0aW1lIC8gKEdhbWUuZnBzICogNjAgKiA2MCAqIDI0KSkpCiAgICAgICAgICApOyAvL0JlYXV0aWZ5KE1hdGguZmxvb3IodGltZS8oR2FtZS5mcHMqNjAqNjAqMjQpKSkrJyBkYXlzJzsKICAgICAgICBlbHNlIGlmICh0aW1lID49IEdhbWUuZnBzICogNjAgKiA2MCAmJiBkZXRhaWwgPCAzKQogICAgICAgICAgc3RyID0gbG9jKAogICAgICAgICAgICAiJTEgaG91ciIsCiAgICAgICAgICAgIExCZWF1dGlmeShNYXRoLmZsb29yKHRpbWUgLyAoR2FtZS5mcHMgKiA2MCAqIDYwKSkpCiAgICAgICAgICApOyAvL0JlYXV0aWZ5KE1hdGguZmxvb3IodGltZS8oR2FtZS5mcHMqNjAqNjApKSkrJyBob3Vycyc7CiAgICAgICAgZWxzZSBpZiAodGltZSA+PSBHYW1lLmZwcyAqIDYwICYmIGRldGFpbCA8IDQpCiAgICAgICAgICBzdHIgPSBsb2MoCiAgICAgICAgICAgICIlMSBtaW51dGUiLAogICAgICAgICAgICBMQmVhdXRpZnkoTWF0aC5mbG9vcih0aW1lIC8gKEdhbWUuZnBzICogNjApKSkKICAgICAgICAgICk7IC8vQmVhdXRpZnkoTWF0aC5mbG9vcih0aW1lLyhHYW1lLmZwcyo2MCkpKSsnIG1pbnV0ZXMnOwogICAgICAgIGVsc2UgaWYgKHRpbWUgPj0gR2FtZS5mcHMgJiYgZGV0YWlsIDwgNSkKICAgICAgICAgIHN0ciA9IGxvYygKICAgICAgICAgICAgIiUxIHNlY29uZCIsCiAgICAgICAgICAgIExCZWF1dGlmeShNYXRoLmZsb29yKHRpbWUgLyBHYW1lLmZwcykpCiAgICAgICAgICApOyAvL0JlYXV0aWZ5KE1hdGguZmxvb3IodGltZS8oR2FtZS5mcHMpKSkrJyBzZWNvbmRzJzsKICAgICAgICBlbHNlIHN0ciA9IGxvYygibGVzcyB0aGFuIDEgc2Vjb25kIik7CiAgICAgIH0KICAgICAgcmV0dXJuIHN0cjsKICAgIH07CgogICAgR2FtZS50aW55Q29va2llID0gZnVuY3Rpb24gKCkgewogICAgICBpZiAoIUdhbWUuSGFzQWNoaWV2KCJUaW55IGNvb2tpZSIpKSB7CiAgICAgICAgcmV0dXJuICgKICAgICAgICAgICc8ZGl2IGNsYXNzPSJ0aW55Q29va2llIiAnICsKICAgICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICAgJz0iR2FtZS5DbGlja1RpbnlDb29raWUoKTsiPjwvZGl2PicKICAgICAgICApOwogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH07CiAgICBHYW1lLkNsaWNrVGlueUNvb2tpZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCFHYW1lLkhhc0FjaGlldigiVGlueSBjb29raWUiKSkgewogICAgICAgIFBsYXlTb3VuZCgic25kL3RpY2subXAzIik7CiAgICAgICAgR2FtZS5XaW4oIlRpbnkgY29va2llIik7CiAgICAgIH0KICAgIH07CgogICAgR2FtZS5zZXRWb2x1bWUgPSBmdW5jdGlvbiAod2hhdCkgewogICAgICBHYW1lLnZvbHVtZSA9IHdoYXQ7CiAgICAgIC8qZm9yICh2YXIgaSBpbiBTb3VuZHMpCgkJCXsKCQkJCVNvdW5kc1tpXS52b2x1bWU9R2FtZS52b2x1bWU7CgkJCX0qLwogICAgfTsKICAgIEdhbWUuc2V0Vm9sdW1lTXVzaWMgPSBmdW5jdGlvbiAod2hhdCkgewogICAgICBHYW1lLnZvbHVtZU11c2ljID0gd2hhdDsKICAgICAgaWYgKE11c2ljKSBNdXNpYy5zZXRWb2x1bWUod2hhdCAvIDEwMCk7CiAgICB9OwogICAgR2FtZS5zZXRXdWJNdXNpYyA9IGZ1bmN0aW9uICh3aGF0KSB7CiAgICAgIGlmIChNdXNpYykgTXVzaWMuc2V0RmlsdGVyKHdoYXQgLyAxMDApOwogICAgfTsKCiAgICBHYW1lLnNob3dMYW5nU2VsZWN0aW9uID0gZnVuY3Rpb24gKGZpcnN0TGF1bmNoKSB7CiAgICAgIHZhciBzdHIgPSAiIjsKICAgICAgZm9yICh2YXIgaSBpbiBMYW5ncykgewogICAgICAgIHZhciBsYW5nID0gTGFuZ3NbaV07CiAgICAgICAgc3RyICs9CiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGFuZ1NlbGVjdEJ1dHRvbiB0aXRsZScgKwogICAgICAgICAgKCFmaXJzdExhdW5jaCAmJiBsb2NJZCA9PSBsYW5nLmZpbGUgPyAiIHNlbGVjdGVkIiA6ICIiKSArCiAgICAgICAgICAnIiBzdHlsZT0icGFkZGluZzo0cHg7IiBpZD0ibGFuZ1NlbGVjdC0nICsKICAgICAgICAgIGkgKwogICAgICAgICAgJyI+JyArCiAgICAgICAgICBsYW5nLm5hbWUgKwogICAgICAgICAgIjwvZGl2PiI7CiAgICAgIH0KICAgICAgR2FtZS5Qcm9tcHQoCiAgICAgICAgIjxpZCBDaGFuZ2VMYW5ndWFnZT4iICsKICAgICAgICAgIChmaXJzdExhdW5jaCA/ICI8bm9DbG9zZT4iIDogIiIpICsKICAgICAgICAgICc8aDMgaWQ9Imxhbmd1YWdlU2VsZWN0SGVhZGVyIj4nICsKICAgICAgICAgIGxvYygiQ2hhbmdlIGxhbmd1YWdlIikgKwogICAgICAgICAgIjwvaDM+IiArCiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgICAoZmlyc3RMYXVuY2gKICAgICAgICAgICAgPyAiIgogICAgICAgICAgICA6ICc8ZGl2IHN0eWxlPSJmb250LXNpemU6MTFweDtvcGFjaXR5OjAuNTttYXJnaW4tYm90dG9tOjEycHg7Ij4oJyArCiAgICAgICAgICAgICAgbG9jKCJub3RlOiB0aGlzIHdpbGwgc2F2ZSBhbmQgcmVsb2FkIHlvdXIgZ2FtZSIpICsKICAgICAgICAgICAgICAiKTwvZGl2PiIpICsKICAgICAgICAgIHN0ciwKICAgICAgICBmaXJzdExhdW5jaCA/IDAgOiBbbG9jKCJDYW5jZWwiKV0KICAgICAgKTsKCiAgICAgIGZvciAodmFyIGkgaW4gTGFuZ3MpIHsKICAgICAgICB2YXIgbGFuZyA9IExhbmdzW2ldOwogICAgICAgIEFkZEV2ZW50KAogICAgICAgICAgbCgibGFuZ1NlbGVjdC0iICsgaSksCiAgICAgICAgICAiY2xpY2siLAogICAgICAgICAgKGZ1bmN0aW9uIChsYW5nKSB7CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgaWYgKHRydWUpIHsKICAgICAgICAgICAgICAgIC8vbGFuZyE9bG9jSWQpCiAgICAgICAgICAgICAgICBQbGF5U291bmQoInNuZC90aWNrLm1wMyIpOwogICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlU2V0KCJDb29raWVDbGlja2VyTGFuZyIsIGxhbmcpOwogICAgICAgICAgICAgICAgR2FtZS50b1NhdmUgPSB0cnVlOwogICAgICAgICAgICAgICAgR2FtZS50b1JlbG9hZCA9IHRydWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgfSkoaSkKICAgICAgICApOwogICAgICAgIEFkZEV2ZW50KAogICAgICAgICAgbCgibGFuZ1NlbGVjdC0iICsgaSksCiAgICAgICAgICAibW91c2VvdmVyIiwKICAgICAgICAgIChmdW5jdGlvbiAobGFuZykgewogICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIFBsYXlTb3VuZCgic25kL3NtYWxsVGljay5tcDMiLCAwLjc1KTsKICAgICAgICAgICAgICBsKCJsYW5ndWFnZVNlbGVjdEhlYWRlciIpLmlubmVySFRNTCA9IExhbmdzW2xhbmddLmNoYW5nZUxhbmd1YWdlOwogICAgICAgICAgICB9OwogICAgICAgICAgfSkoaSkKICAgICAgICApOwogICAgICB9CiAgICB9OwoKICAgIE9OID0gIiAiICsgbG9jKCJPTiIpOwogICAgT0ZGID0gIiAiICsgbG9jKCJPRkYiKTsKICAgIEdhbWUuVXBkYXRlTWVudSA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHN0ciA9ICIiOwogICAgICBpZiAoR2FtZS5vbk1lbnUgIT0gIiIpIHsKICAgICAgICBzdHIgKz0KICAgICAgICAgICc8ZGl2IGNsYXNzPSJjbG9zZSBtZW51Q2xvc2UiICcgKwogICAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgICAnPSJHYW1lLlNob3dNZW51KCk7Ij54PC9kaXY+JzsKICAgICAgICAvL3N0cis9JzxkaXYgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlO3RvcDo4cHg7cmlnaHQ6OHB4O2N1cnNvcjpwb2ludGVyO2ZvbnQtc2l6ZToxNnB4OyIgJytHYW1lLmNsaWNrU3RyKyc9IkdhbWUuU2hvd01lbnUoKTsiPlg8L2Rpdj4nOwogICAgICB9CiAgICAgIGlmIChHYW1lLm9uTWVudSA9PSAicHJlZnMiKSB7CiAgICAgICAgc3RyICs9ICc8ZGl2IGNsYXNzPSJzZWN0aW9uIj4nICsgbG9jKCJPcHRpb25zIikgKyAiPC9kaXY+IjsKCiAgICAgICAgc3RyICs9CiAgICAgICAgICAnPGRpdiBjbGFzcz0iYmxvY2siIHN0eWxlPSJwYWRkaW5nOjBweDttYXJnaW46OHB4IDRweDsiPicgKwogICAgICAgICAgJzxkaXYgY2xhc3M9InN1YnNlY3Rpb24iIHN0eWxlPSJwYWRkaW5nOjBweDsiPicgKwogICAgICAgICAgJzxkaXYgY2xhc3M9InRpdGxlIj4nICsKICAgICAgICAgIGxvYygiR2VuZXJhbCIpICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7Ij48ZGl2IHN0eWxlPSJkaXNwbGF5OmlubGluZS1ibG9jaztwYWRkaW5nOjJweCA4cHg7b3BhY2l0eTowLjc1O2ZvbnQtc2l6ZToxMnB4O3ZlcnRpY2FsLWFsaWduOm1pZGRsZTsiIGNsYXNzPSJzbWFsbEZhbmN5QnV0dG9uIj4nICsKICAgICAgICAgIGxvYygiTGFuZ3VhZ2U6ICUxIiwgIjxiPiIgKyBMYW5nc1tsb2NJZF0ubmFtZSArICI8L2I+IikgKwogICAgICAgICAgJzwvZGl2PjxkaXYgY2xhc3M9Imljb24iIHN0eWxlPSJ2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7ZGlzcGxheTppbmxpbmUtYmxvY2s7YmFja2dyb3VuZC1wb3NpdGlvbjonICsKICAgICAgICAgIC0zMCAqIDQ4ICsKICAgICAgICAgICJweCAiICsKICAgICAgICAgIC0yOSAqIDQ4ICsKICAgICAgICAgICdweDt0cmFuc2Zvcm06c2NhbGUoMC41KTttYXJnaW46LTE2cHggLTEycHg7Ij48L2Rpdj48YSBzdHlsZT0iZm9udC1zaXplOjE1cHg7dGV4dC1hbGlnbjpjZW50ZXI7d2lkdGg6YXV0bzttaW4td2lkdGg6MTMwcHg7IiBjbGFzcz0ib3B0aW9uIHNtYWxsRmFuY3lCdXR0b24iIGlkPSJjaGFuZ2VMYW5ndWFnZU9wdGlvbiIgJyArCiAgICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAgICI9XCJQbGF5U291bmQoJ3NuZC90aWNrLm1wMycpO0dhbWUuc2hvd0xhbmdTZWxlY3Rpb24oKTtcIj4iICsKICAgICAgICAgICghRU4gPyAnQ2hhbmdlIGxhbmd1YWdlPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyA6ICIiKSArCiAgICAgICAgICBsb2MoIkNoYW5nZSBsYW5ndWFnZSIpICsKICAgICAgICAgICc8L2E+PGRpdiBzdHlsZT0iY2xlYXI6Ym90aDt0ZXh0LWFsaWduOnJpZ2h0O3BhZGRpbmctYm90dG9tOjJweDsiPjwvZGl2PjwvZGl2PicgKwogICAgICAgICAgKEFwcAogICAgICAgICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48YSBjbGFzcz0ib3B0aW9uIHNtYWxsRmFuY3lCdXR0b24iICcgKwogICAgICAgICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICAgICAgICI9XCJQbGF5U291bmQoJ3NuZC90aWNrLm1wMycpO0dhbWUudG9TYXZlPXRydWU7R2FtZS50b1F1aXQ9dHJ1ZTtcIj4iICsKICAgICAgICAgICAgICBsb2MoIlNhdmUgJiBRdWl0IikgKwogICAgICAgICAgICAgICI8L2E+PC9kaXY+IgogICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGEgY2xhc3M9Im9wdGlvbiBzbWFsbEZhbmN5QnV0dG9uIiAnICsKICAgICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICAgIj1cIkdhbWUudG9TYXZlPXRydWU7UGxheVNvdW5kKCdzbmQvdGljay5tcDMnKTtcIj4iICsKICAgICAgICAgIGxvYygiU2F2ZSIpICsKICAgICAgICAgICI8L2E+PGxhYmVsPiIgKwogICAgICAgICAgbG9jKAogICAgICAgICAgICAiU2F2ZSBtYW51YWxseSAodGhlIGdhbWUgYXV0b3NhdmVzIGV2ZXJ5IDYwIHNlY29uZHM7IHNob3J0Y3V0OiBjdHJsK1MpIgogICAgICAgICAgKSArCiAgICAgICAgICAiPC9sYWJlbD48L2Rpdj4iICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48YSBjbGFzcz0ib3B0aW9uIHNtYWxsRmFuY3lCdXR0b24iICcgKwogICAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgICAiPVwiR2FtZS5FeHBvcnRTYXZlKCk7UGxheVNvdW5kKCdzbmQvdGljay5tcDMnKTtcIj4iICsKICAgICAgICAgIGxvYygiRXhwb3J0IHNhdmUiKSArCiAgICAgICAgICAnPC9hPjxhIGNsYXNzPSJvcHRpb24gc21hbGxGYW5jeUJ1dHRvbiIgJyArCiAgICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAgICI9XCJHYW1lLkltcG9ydFNhdmUoKTtQbGF5U291bmQoJ3NuZC90aWNrLm1wMycpO1wiPiIgKwogICAgICAgICAgbG9jKCJJbXBvcnQgc2F2ZSIpICsKICAgICAgICAgICI8L2E+PGxhYmVsPiIgKwogICAgICAgICAgbG9jKAogICAgICAgICAgICAiWW91IGNhbiB1c2UgdGhpcyB0byBiYWNrdXAgeW91ciBzYXZlIG9yIHRvIHRyYW5zZmVyIGl0IHRvIGFub3RoZXIgY29tcHV0ZXIgKHNob3J0Y3V0IGZvciBpbXBvcnQ6IGN0cmwrTykiCiAgICAgICAgICApICsKICAgICAgICAgICI8L2xhYmVsPjwvZGl2PiIgKwogICAgICAgICAgKCFBcHAKICAgICAgICAgICAgPyAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGEgY2xhc3M9Im9wdGlvbiBzbWFsbEZhbmN5QnV0dG9uIiAnICsKICAgICAgICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAgICAgICAiPVwiR2FtZS5GaWxlU2F2ZSgpO1BsYXlTb3VuZCgnc25kL3RpY2subXAzJyk7XCI+IiArCiAgICAgICAgICAgICAgbG9jKCJTYXZlIHRvIGZpbGUiKSArCiAgICAgICAgICAgICAgJzwvYT48YSBjbGFzcz0ib3B0aW9uIHNtYWxsRmFuY3lCdXR0b24iIHN0eWxlPSJwb3NpdGlvbjpyZWxhdGl2ZTsiPjxpbnB1dCBpZD0iRmlsZUxvYWRJbnB1dCIgdHlwZT0iZmlsZSIgc3R5bGU9ImN1cnNvcjpwb2ludGVyO29wYWNpdHk6MDtwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OjBweDt0b3A6MHB4O3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7IiBvbmNoYW5nZT0iR2FtZS5GaWxlTG9hZChldmVudCk7IiAnICsKICAgICAgICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAgICAgICAiPVwiUGxheVNvdW5kKCdzbmQvdGljay5tcDMnKTtcIi8+IiArCiAgICAgICAgICAgICAgbG9jKCJMb2FkIGZyb20gZmlsZSIpICsKICAgICAgICAgICAgICAiPC9hPjxsYWJlbD4iICsKICAgICAgICAgICAgICBsb2MoIlVzZSB0aGlzIHRvIGtlZXAgYmFja3VwcyBvbiB5b3VyIGNvbXB1dGVyIikgKwogICAgICAgICAgICAgICI8L2xhYmVsPjwvZGl2PiIKICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciIHN0eWxlPSJ0ZXh0LWFsaWduOnJpZ2h0OyI+PGxhYmVsPicgKwogICAgICAgICAgbG9jKCJEZWxldGUgYWxsIHlvdXIgcHJvZ3Jlc3MsIGluY2x1ZGluZyB5b3VyIGFjaGlldmVtZW50cyIpICsKICAgICAgICAgICc8L2xhYmVsPjxhIGNsYXNzPSJvcHRpb24gc21hbGxGYW5jeUJ1dHRvbiB3YXJuaW5nIiAnICsKICAgICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICAgIj1cIkdhbWUuSGFyZFJlc2V0KCk7UGxheVNvdW5kKCdzbmQvdGljay5tcDMnKTtcIj4iICsKICAgICAgICAgIGxvYygiV2lwZSBzYXZlIikgKwogICAgICAgICAgIjwvYT48L2Rpdj4iICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJibG9jayIgc3R5bGU9InBhZGRpbmc6MHB4O21hcmdpbjo4cHggNHB4OyI+JyArCiAgICAgICAgICAnPGRpdiBjbGFzcz0ic3Vic2VjdGlvbiIgc3R5bGU9InBhZGRpbmc6MHB4OyI+JyArCiAgICAgICAgICAnPGRpdiBjbGFzcz0idGl0bGUiPicgKwogICAgICAgICAgbG9jKCJTZXR0aW5ncyIpICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgIChBcHAgJiYgQXBwLndyaXRlQ2xvdWRVSSA/IEFwcC53cml0ZUNsb3VkVUkoKSA6ICIiKSArCiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JyArCiAgICAgICAgICBHYW1lLldyaXRlU2xpZGVyKAogICAgICAgICAgICAidm9sdW1lU2xpZGVyIiwKICAgICAgICAgICAgbG9jKCJWb2x1bWUiKSwKICAgICAgICAgICAgIlskXSUiLAogICAgICAgICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIEdhbWUudm9sdW1lOwogICAgICAgICAgICB9LAogICAgICAgICAgICAiR2FtZS5zZXRWb2x1bWUoTWF0aC5yb3VuZChsKCd2b2x1bWVTbGlkZXInKS52YWx1ZSkpO2woJ3ZvbHVtZVNsaWRlclJpZ2h0VGV4dCcpLmlubmVySFRNTD1HYW1lLnZvbHVtZSsnJSc7IgogICAgICAgICAgKSArCiAgICAgICAgICAoQXBwCiAgICAgICAgICAgID8gR2FtZS5Xcml0ZVNsaWRlcigKICAgICAgICAgICAgICAgICJ2b2x1bWVNdXNpY1NsaWRlciIsCiAgICAgICAgICAgICAgICBsb2MoIlZvbHVtZSAobXVzaWMpIiksCiAgICAgICAgICAgICAgICAiWyRdJSIsCiAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBHYW1lLnZvbHVtZU11c2ljOwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICJHYW1lLnNldFZvbHVtZU11c2ljKE1hdGgucm91bmQobCgndm9sdW1lTXVzaWNTbGlkZXInKS52YWx1ZSkpO2woJ3ZvbHVtZU11c2ljU2xpZGVyUmlnaHRUZXh0JykuaW5uZXJIVE1MPUdhbWUudm9sdW1lTXVzaWMrJyUnOyIKICAgICAgICAgICAgICApCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgIC8qKEFwcD9HYW1lLldyaXRlU2xpZGVyKCd3dWJNdXNpY1NsaWRlcicsbG9jKCJXdWIiKSwnWyRdJScsZnVuY3Rpb24oKXtyZXR1cm4gMTAwO30sJ0dhbWUuc2V0V3ViTXVzaWMoTWF0aC5yb3VuZChsKFwnd3ViTXVzaWNTbGlkZXJcJykudmFsdWUpKTtsKFwnd3ViTXVzaWNTbGlkZXJSaWdodFRleHRcJykuaW5uZXJIVE1MPShNYXRoLnJvdW5kKGwoXCd3dWJNdXNpY1NsaWRlclwnKS52YWx1ZSkpK1wnJVwnOycpOicnKSsqLwogICAgICAgICAgIjxicj4iICsKICAgICAgICAgIChBcHAKICAgICAgICAgICAgPyBHYW1lLldyaXRlUHJlZkJ1dHRvbigKICAgICAgICAgICAgICAgICJiZ011c2ljIiwKICAgICAgICAgICAgICAgICJiZ011c2ljQnV0dG9uIiwKICAgICAgICAgICAgICAgIGxvYygiTXVzaWMgaW4gYmFja2dyb3VuZCIpICsgT04sCiAgICAgICAgICAgICAgICBsb2MoIk11c2ljIGluIGJhY2tncm91bmQiKSArIE9GRiwKICAgICAgICAgICAgICAgICIiCiAgICAgICAgICAgICAgKSArCiAgICAgICAgICAgICAgIjxsYWJlbD4oIiArCiAgICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICAgIm11c2ljIHdpbGwga2VlcCBwbGF5aW5nIGV2ZW4gd2hlbiB0aGUgZ2FtZSB3aW5kb3cgaXNuJ3QgZm9jdXNlZCIKICAgICAgICAgICAgICApICsKICAgICAgICAgICAgICAiKTwvbGFiZWw+PGJyPiIKICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgKEFwcAogICAgICAgICAgICA/IEdhbWUuV3JpdGVQcmVmQnV0dG9uKAogICAgICAgICAgICAgICAgImZ1bGxzY3JlZW4iLAogICAgICAgICAgICAgICAgImZ1bGxzY3JlZW5CdXR0b24iLAogICAgICAgICAgICAgICAgbG9jKCJGdWxsc2NyZWVuIikgKyBPTiwKICAgICAgICAgICAgICAgIGxvYygiRnVsbHNjcmVlbiIpICsgT0ZGLAogICAgICAgICAgICAgICAgIkdhbWUuVG9nZ2xlRnVsbHNjcmVlbigpOyIKICAgICAgICAgICAgICApICsgIjxicj4iCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgIEdhbWUuV3JpdGVQcmVmQnV0dG9uKAogICAgICAgICAgICAiZmFuY3kiLAogICAgICAgICAgICAiZmFuY3lCdXR0b24iLAogICAgICAgICAgICBsb2MoIkZhbmN5IGdyYXBoaWNzIikgKyBPTiwKICAgICAgICAgICAgbG9jKCJGYW5jeSBncmFwaGljcyIpICsgT0ZGLAogICAgICAgICAgICAiR2FtZS5Ub2dnbGVGYW5jeSgpOyIKICAgICAgICAgICkgKwogICAgICAgICAgIjxsYWJlbD4oIiArCiAgICAgICAgICBsb2MoInZpc3VhbCBpbXByb3ZlbWVudHM7IGRpc2FibGluZyBtYXkgaW1wcm92ZSBwZXJmb3JtYW5jZSIpICsKICAgICAgICAgICIpPC9sYWJlbD48YnI+IiArCiAgICAgICAgICBHYW1lLldyaXRlUHJlZkJ1dHRvbigKICAgICAgICAgICAgImZpbHRlcnMiLAogICAgICAgICAgICAiZmlsdGVyc0J1dHRvbiIsCiAgICAgICAgICAgIGxvYygiQ1NTIGZpbHRlcnMiKSArIE9OLAogICAgICAgICAgICBsb2MoIkNTUyBmaWx0ZXJzIikgKyBPRkYsCiAgICAgICAgICAgICJHYW1lLlRvZ2dsZUZpbHRlcnMoKTsiCiAgICAgICAgICApICsKICAgICAgICAgICI8bGFiZWw+KCIgKwogICAgICAgICAgKEVOCiAgICAgICAgICAgID8gImN1dHRpbmctZWRnZSB2aXN1YWwgaW1wcm92ZW1lbnRzOyBkaXNhYmxpbmcgbWF5IGltcHJvdmUgcGVyZm9ybWFuY2UiCiAgICAgICAgICAgIDogbG9jKCJ2aXN1YWwgaW1wcm92ZW1lbnRzOyBkaXNhYmxpbmcgbWF5IGltcHJvdmUgcGVyZm9ybWFuY2UiKSkgKwogICAgICAgICAgIik8L2xhYmVsPjxicj4iICsKICAgICAgICAgIEdhbWUuV3JpdGVQcmVmQnV0dG9uKAogICAgICAgICAgICAicGFydGljbGVzIiwKICAgICAgICAgICAgInBhcnRpY2xlc0J1dHRvbiIsCiAgICAgICAgICAgIGxvYygiUGFydGljbGVzIikgKyBPTiwKICAgICAgICAgICAgbG9jKCJQYXJ0aWNsZXMiKSArIE9GRgogICAgICAgICAgKSArCiAgICAgICAgICAoRU4KICAgICAgICAgICAgPyAiPGxhYmVsPihjb29raWVzIGZhbGxpbmcgZG93biwgZXRjOyBkaXNhYmxpbmcgbWF5IGltcHJvdmUgcGVyZm9ybWFuY2UpPC9sYWJlbD4iCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICI8YnI+IiArCiAgICAgICAgICBHYW1lLldyaXRlUHJlZkJ1dHRvbigKICAgICAgICAgICAgIm51bWJlcnMiLAogICAgICAgICAgICAibnVtYmVyc0J1dHRvbiIsCiAgICAgICAgICAgIGxvYygiTnVtYmVycyIpICsgT04sCiAgICAgICAgICAgIGxvYygiTnVtYmVycyIpICsgT0ZGCiAgICAgICAgICApICsKICAgICAgICAgICI8bGFiZWw+KCIgKwogICAgICAgICAgbG9jKCJudW1iZXJzIHRoYXQgcG9wIHVwIHdoZW4gY2xpY2tpbmcgdGhlIGNvb2tpZSIpICsKICAgICAgICAgICIpPC9sYWJlbD48YnI+IiArCiAgICAgICAgICBHYW1lLldyaXRlUHJlZkJ1dHRvbigKICAgICAgICAgICAgIm1pbGsiLAogICAgICAgICAgICAibWlsa0J1dHRvbiIsCiAgICAgICAgICAgIGxvYygiTWlsayBbc2V0dGluZ10iKSArIE9OLAogICAgICAgICAgICBsb2MoIk1pbGsgW3NldHRpbmddIikgKyBPRkYKICAgICAgICAgICkgKwogICAgICAgICAgKEVOID8gIjxsYWJlbD4ob25seSBhcHBlYXJzIHdpdGggZW5vdWdoIGFjaGlldmVtZW50cyk8L2xhYmVsPiIgOiAiIikgKwogICAgICAgICAgIjxicj4iICsKICAgICAgICAgIEdhbWUuV3JpdGVQcmVmQnV0dG9uKAogICAgICAgICAgICAiY3Vyc29ycyIsCiAgICAgICAgICAgICJjdXJzb3JzQnV0dG9uIiwKICAgICAgICAgICAgbG9jKCJDdXJzb3JzIFtzZXR0aW5nXSIpICsgT04sCiAgICAgICAgICAgIGxvYygiQ3Vyc29ycyBbc2V0dGluZ10iKSArIE9GRgogICAgICAgICAgKSArCiAgICAgICAgICAiPGxhYmVsPigiICsKICAgICAgICAgIGxvYygidmlzdWFsIGRpc3BsYXkgb2YgeW91ciBjdXJzb3JzIikgKwogICAgICAgICAgIik8L2xhYmVsPjxicj4iICsKICAgICAgICAgIEdhbWUuV3JpdGVQcmVmQnV0dG9uKAogICAgICAgICAgICAid29iYmx5IiwKICAgICAgICAgICAgIndvYmJseUJ1dHRvbiIsCiAgICAgICAgICAgIGxvYygiV29iYmx5IGNvb2tpZSIpICsgT04sCiAgICAgICAgICAgIGxvYygiV29iYmx5IGNvb2tpZSIpICsgT0ZGCiAgICAgICAgICApICsKICAgICAgICAgIChFTgogICAgICAgICAgICA/ICI8bGFiZWw+KHlvdXIgY29va2llIHdpbGwgcmVhY3Qgd2hlbiB5b3UgY2xpY2sgaXQpPC9sYWJlbD4iCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICI8YnI+IiArCiAgICAgICAgICBHYW1lLldyaXRlUHJlZkJ1dHRvbigKICAgICAgICAgICAgImNvb2tpZXNvdW5kIiwKICAgICAgICAgICAgImNvb2tpZXNvdW5kQnV0dG9uIiwKICAgICAgICAgICAgbG9jKCJBbHQgY29va2llIHNvdW5kIikgKyBPTiwKICAgICAgICAgICAgbG9jKCJBbHQgY29va2llIHNvdW5kIikgKyBPRkYKICAgICAgICAgICkgKwogICAgICAgICAgKEVOCiAgICAgICAgICAgID8gIjxsYWJlbD4oaG93IHlvdXIgY29va2llIHNvdW5kcyB3aGVuIHlvdSBjbGljayBvbiBpdCk8L2xhYmVsPiIKICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgIjxicj4iICsKICAgICAgICAgIEdhbWUuV3JpdGVQcmVmQnV0dG9uKAogICAgICAgICAgICAiY3JhdGVzIiwKICAgICAgICAgICAgImNyYXRlc0J1dHRvbiIsCiAgICAgICAgICAgIGxvYygiSWNvbiBjcmF0ZXMiKSArIE9OLAogICAgICAgICAgICBsb2MoIkljb24gY3JhdGVzIikgKyBPRkYKICAgICAgICAgICkgKwogICAgICAgICAgIjxsYWJlbD4oIiArCiAgICAgICAgICBsb2MoImRpc3BsYXkgYm94ZXMgYXJvdW5kIHVwZ3JhZGVzIGFuZCBhY2hpZXZlbWVudHMgaW4gU3RhdHMiKSArCiAgICAgICAgICAiKTwvbGFiZWw+PGJyPiIgKwogICAgICAgICAgR2FtZS5Xcml0ZVByZWZCdXR0b24oCiAgICAgICAgICAgICJtb25vc3BhY2UiLAogICAgICAgICAgICAibW9ub3NwYWNlQnV0dG9uIiwKICAgICAgICAgICAgbG9jKCJBbHQgZm9udCIpICsgT04sCiAgICAgICAgICAgIGxvYygiQWx0IGZvbnQiKSArIE9GRgogICAgICAgICAgKSArCiAgICAgICAgICAiPGxhYmVsPigiICsKICAgICAgICAgIGxvYygieW91ciBjb29raWVzIGFyZSBkaXNwbGF5ZWQgdXNpbmcgYSBtb25vc3BhY2UgZm9udCIpICsKICAgICAgICAgICIpPC9sYWJlbD48YnI+IiArCiAgICAgICAgICBHYW1lLldyaXRlUHJlZkJ1dHRvbigKICAgICAgICAgICAgImZvcm1hdCIsCiAgICAgICAgICAgICJmb3JtYXRCdXR0b24iLAogICAgICAgICAgICBsb2MoIlNob3J0IG51bWJlcnMiKSArIE9GRiwKICAgICAgICAgICAgbG9jKCJTaG9ydCBudW1iZXJzIikgKyBPTiwKICAgICAgICAgICAgIkJlYXV0aWZ5QWxsKCk7R2FtZS5SZWZyZXNoU3RvcmUoKTtHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkPTE7IiwKICAgICAgICAgICAgMQogICAgICAgICAgKSArCiAgICAgICAgICAoRU4gPyAiPGxhYmVsPihzaG9ydGVuIGJpZyBudW1iZXJzKTwvbGFiZWw+IiA6ICIiKSArCiAgICAgICAgICAiPGJyPiIgKwogICAgICAgICAgR2FtZS5Xcml0ZVByZWZCdXR0b24oCiAgICAgICAgICAgICJub3RpZnMiLAogICAgICAgICAgICAibm90aWZzQnV0dG9uIiwKICAgICAgICAgICAgbG9jKCJGYXN0IG5vdGVzIikgKyBPTiwKICAgICAgICAgICAgbG9jKCJGYXN0IG5vdGVzIikgKyBPRkYKICAgICAgICAgICkgKwogICAgICAgICAgIjxsYWJlbD4oIiArCiAgICAgICAgICBsb2MoIm5vdGlmaWNhdGlvbnMgZGlzYXBwZWFyIG11Y2ggZmFzdGVyIikgKwogICAgICAgICAgIik8L2xhYmVsPjxicj4iICsKICAgICAgICAgIC8vR2FtZS5Xcml0ZVByZWZCdXR0b24oJ2F1dG91cGRhdGUnLCdhdXRvdXBkYXRlQnV0dG9uJywnT2ZmbGluZSBtb2RlIE9GRicsJ09mZmxpbmUgbW9kZSBPTicsMCwxKSsnPGxhYmVsPihkaXNhYmxlcyB1cGRhdGUgbm90aWZpY2F0aW9ucyk8L2xhYmVsPjxicj4nKwogICAgICAgICAgKCFBcHAKICAgICAgICAgICAgPyBHYW1lLldyaXRlUHJlZkJ1dHRvbigKICAgICAgICAgICAgICAgICJ3YXJuIiwKICAgICAgICAgICAgICAgICJ3YXJuQnV0dG9uIiwKICAgICAgICAgICAgICAgIGxvYygiQ2xvc2luZyB3YXJuaW5nIikgKyBPTiwKICAgICAgICAgICAgICAgIGxvYygiQ2xvc2luZyB3YXJuaW5nIikgKyBPRkYKICAgICAgICAgICAgICApICsKICAgICAgICAgICAgICAiPGxhYmVsPigiICsKICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAidGhlIGdhbWUgd2lsbCBhc2sgeW91IHRvIGNvbmZpcm0gd2hlbiB5b3UgY2xvc2UgdGhlIHdpbmRvdyIKICAgICAgICAgICAgICApICsKICAgICAgICAgICAgICAiKTwvbGFiZWw+PGJyPiIKICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgLy9HYW1lLldyaXRlUHJlZkJ1dHRvbignZm9jdXMnLCdmb2N1c0J1dHRvbicsbG9jKCJEZWZvY3VzIikrT0ZGLGxvYygiRGVmb2N1cyIpK09OLDAsMSkrJzxsYWJlbD4oJytsb2MoInRoZSBnYW1lIHdpbGwgYmUgbGVzcyByZXNvdXJjZS1pbnRlbnNpdmUgd2hlbiBvdXQgb2YgZm9jdXMiKSsnKTwvbGFiZWw+PGJyPicrCiAgICAgICAgICBHYW1lLldyaXRlUHJlZkJ1dHRvbigKICAgICAgICAgICAgImV4dHJhQnV0dG9ucyIsCiAgICAgICAgICAgICJleHRyYUJ1dHRvbnNCdXR0b24iLAogICAgICAgICAgICBsb2MoIkV4dHJhIGJ1dHRvbnMiKSArIE9OLAogICAgICAgICAgICBsb2MoIkV4dHJhIGJ1dHRvbnMiKSArIE9GRiwKICAgICAgICAgICAgIkdhbWUuVG9nZ2xlRXh0cmFCdXR0b25zKCk7IgogICAgICAgICAgKSArCiAgICAgICAgICAiPGxhYmVsPigiICsKICAgICAgICAgIGxvYygiYWRkIG9wdGlvbnMgb24gYnVpbGRpbmdzIGxpa2UgTXV0ZSIpICsKICAgICAgICAgICIpPC9sYWJlbD48YnI+IiArCiAgICAgICAgICBHYW1lLldyaXRlUHJlZkJ1dHRvbigKICAgICAgICAgICAgImFza0x1bXBzIiwKICAgICAgICAgICAgImFza0x1bXBzQnV0dG9uIiwKICAgICAgICAgICAgbG9jKCJMdW1wIGNvbmZpcm1hdGlvbiIpICsgT04sCiAgICAgICAgICAgIGxvYygiTHVtcCBjb25maXJtYXRpb24iKSArIE9GRgogICAgICAgICAgKSArCiAgICAgICAgICAiPGxhYmVsPigiICsKICAgICAgICAgIGxvYygidGhlIGdhbWUgd2lsbCBhc2sgeW91IHRvIGNvbmZpcm0gYmVmb3JlIHNwZW5kaW5nIHN1Z2FyIGx1bXBzIikgKwogICAgICAgICAgIik8L2xhYmVsPjxicj4iICsKICAgICAgICAgICghQXBwCiAgICAgICAgICAgID8gR2FtZS5Xcml0ZVByZWZCdXR0b24oCiAgICAgICAgICAgICAgICAiY3VzdG9tR3JhbmRtYXMiLAogICAgICAgICAgICAgICAgImN1c3RvbUdyYW5kbWFzQnV0dG9uIiwKICAgICAgICAgICAgICAgIGxvYygiQ3VzdG9tIGdyYW5kbWFzIikgKyBPTiwKICAgICAgICAgICAgICAgIGxvYygiQ3VzdG9tIGdyYW5kbWFzIikgKyBPRkYKICAgICAgICAgICAgICApICsKICAgICAgICAgICAgICAiPGxhYmVsPigiICsKICAgICAgICAgICAgICBsb2MoInNvbWUgZ3JhbmRtYXMgd2lsbCBiZSBuYW1lZCBhZnRlciBQYXRyZW9uIHN1cHBvcnRlcnMiKSArCiAgICAgICAgICAgICAgIik8L2xhYmVsPjxicj4iCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgIEdhbWUuV3JpdGVQcmVmQnV0dG9uKAogICAgICAgICAgICAibm90U2NhcnkiLAogICAgICAgICAgICAibm90U2NhcnlCdXR0b24iLAogICAgICAgICAgICBsb2MoIlNjYXJ5IHN0dWZmIikgKyBPRkYsCiAgICAgICAgICAgIGxvYygiU2Nhcnkgc3R1ZmYiKSArIE9OLAogICAgICAgICAgICAwLAogICAgICAgICAgICAxCiAgICAgICAgICApICsKICAgICAgICAgICI8YnI+IiArCiAgICAgICAgICBHYW1lLldyaXRlUHJlZkJ1dHRvbigKICAgICAgICAgICAgInRpbWVvdXQiLAogICAgICAgICAgICAidGltZW91dEJ1dHRvbiIsCiAgICAgICAgICAgIGxvYygiU2xlZXAgbW9kZSB0aW1lb3V0IikgKyBPTiwKICAgICAgICAgICAgbG9jKCJTbGVlcCBtb2RlIHRpbWVvdXQiKSArIE9GRgogICAgICAgICAgKSArCiAgICAgICAgICAiPGxhYmVsPigiICsKICAgICAgICAgIGxvYygKICAgICAgICAgICAgIm9uIHNsb3dlciBjb21wdXRlcnMsIHRoZSBnYW1lIHdpbGwgcHV0IGl0c2VsZiBpbiBzbGVlcCBtb2RlIHdoZW4gaXQncyBpbmFjdGl2ZSBhbmQgc3RhcnRzIHRvIGxhZyBvdXQ7IG9mZmxpbmUgQ3BTIHByb2R1Y3Rpb24ga2lja3MgaW4gZHVyaW5nIHNsZWVwIG1vZGUiCiAgICAgICAgICApICsKICAgICAgICAgICIpPC9sYWJlbD48YnI+IiArCiAgICAgICAgICBHYW1lLldyaXRlUHJlZkJ1dHRvbigKICAgICAgICAgICAgInNjcmVlbnJlYWRlciIsCiAgICAgICAgICAgICJzY3JlZW5yZWFkZXJCdXR0b24iLAogICAgICAgICAgICBsb2MoIlNjcmVlbiByZWFkZXIgbW9kZSIpICsgT04sCiAgICAgICAgICAgIGxvYygiU2NyZWVuIHJlYWRlciBtb2RlIikgKyBPRkYsCiAgICAgICAgICAgICJHYW1lLnRvU2F2ZT10cnVlO0dhbWUudG9SZWxvYWQ9dHJ1ZTsiCiAgICAgICAgICApICsKICAgICAgICAgICI8bGFiZWw+KCIgKwogICAgICAgICAgbG9jKCJhbGxvd3Mgb3B0aW1pemF0aW9ucyBmb3Igc2NyZWVuIHJlYWRlcnM7IGdhbWUgd2lsbCByZWxvYWQiKSArCiAgICAgICAgICAiKTwvbGFiZWw+PGJyPiIgKwogICAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICAgLy8nPGRpdiBjbGFzcz0ibGlzdGluZyI+JytHYW1lLldyaXRlUHJlZkJ1dHRvbignYXV0b3NhdmUnLCdhdXRvc2F2ZUJ1dHRvbicsJ0F1dG9zYXZlIE9OJywnQXV0b3NhdmUgT0ZGJykrJzwvZGl2PicrCiAgICAgICAgICAoIUFwcAogICAgICAgICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48YSBjbGFzcz0ib3B0aW9uIHNtYWxsRmFuY3lCdXR0b24iICcgKwogICAgICAgICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICAgICAgICI9XCJHYW1lLkNoZWNrTW9kRGF0YSgpO1BsYXlTb3VuZCgnc25kL3RpY2subXAzJyk7XCI+IiArCiAgICAgICAgICAgICAgbG9jKCJDaGVjayBtb2QgZGF0YSIpICsKICAgICAgICAgICAgICAiPC9hPjxsYWJlbD4oIiArCiAgICAgICAgICAgICAgbG9jKCJ2aWV3IGFuZCBkZWxldGUgc2F2ZSBkYXRhIGNyZWF0ZWQgYnkgbW9kcyIpICsKICAgICAgICAgICAgICAiKTwvbGFiZWw+PC9kaXY+IgogICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAiPC9kaXY+IjsKCiAgICAgICAgaWYgKEFwcCAmJiBBcHAud3JpdGVNb2RVSSkgewogICAgICAgICAgc3RyICs9CiAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJibG9jayIgc3R5bGU9InBhZGRpbmc6MHB4O21hcmdpbjo4cHggNHB4OyI+JyArCiAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIiBzdHlsZT0icGFkZGluZzowcHg7Ij4nICsKICAgICAgICAgICAgJzxkaXYgY2xhc3M9InRpdGxlIj4nICsKICAgICAgICAgICAgbG9jKCJNb2RzIikgKwogICAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAgIEFwcC53cml0ZU1vZFVJKCkgKwogICAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAgICI8L2Rpdj4iOwogICAgICAgIH0KCiAgICAgICAgc3RyICs9ICc8ZGl2IHN0eWxlPSJoZWlnaHQ6MTI4cHg7Ij48L2Rpdj4nOwogICAgICB9IGVsc2UgaWYgKEdhbWUub25NZW51ID09ICJsb2ciKSB7CiAgICAgICAgLy9zdHIrPXJlcGxhY2VBbGwoJ1tiYWtlcnlOYW1lXScsR2FtZS5iYWtlcnlOYW1lLEdhbWUudXBkYXRlTG9nKTsKICAgICAgICBzdHIgKz0gR2FtZS51cGRhdGVMb2c7CiAgICAgICAgaWYgKCFHYW1lLkhhc0FjaGlldigiT2xkZW4gZGF5cyIpKQogICAgICAgICAgc3RyICs9CiAgICAgICAgICAgICc8ZGl2IGlkPSJvbGRlbkRheXMiIHN0eWxlPSJ0ZXh0LWFsaWduOnJpZ2h0O3dpZHRoOjEwMCU7Ij48ZGl2ICcgKwogICAgICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAgICAgIj1cIkdhbWUuU3BhcmtsZUF0KEdhbWUubW91c2VYLEdhbWUubW91c2VZKTtQbGF5U291bmQoJ3NuZC90aWNrLm1wMycpO1BsYXlTb3VuZCgnc25kL3NoaW1tZXJDbGljay5tcDMnKTtHYW1lLldpbignT2xkZW4gZGF5cycpO0dhbWUuVXBkYXRlTWVudSgpO1wiIGNsYXNzPVwiaWNvblwiIHN0eWxlPVwiZGlzcGxheTppbmxpbmUtYmxvY2s7dHJhbnNmb3JtOnNjYWxlKDAuNSk7Y3Vyc29yOnBvaW50ZXI7d2lkdGg6NDhweDtoZWlnaHQ6NDhweDtiYWNrZ3JvdW5kLXBvc2l0aW9uOiIgKwogICAgICAgICAgICAtMTIgKiA0OCArCiAgICAgICAgICAgICJweCAiICsKICAgICAgICAgICAgLTMgKiA0OCArCiAgICAgICAgICAgICdweDsiPjwvZGl2PjwvZGl2Pic7CiAgICAgIH0gZWxzZSBpZiAoR2FtZS5vbk1lbnUgPT0gInN0YXRzIikgewogICAgICAgIHZhciBidWlsZGluZ3NPd25lZCA9IDA7CiAgICAgICAgYnVpbGRpbmdzT3duZWQgPSBHYW1lLkJ1aWxkaW5nc093bmVkOwogICAgICAgIHZhciB1cGdyYWRlcyA9ICIiOwogICAgICAgIHZhciBjb29raWVVcGdyYWRlcyA9ICIiOwogICAgICAgIHZhciBoaWRkZW5VcGdyYWRlcyA9ICIiOwogICAgICAgIHZhciBwcmVzdGlnZVVwZ3JhZGVzID0gIiI7CiAgICAgICAgdmFyIHVwZ3JhZGVzVG90YWwgPSAwOwogICAgICAgIHZhciB1cGdyYWRlc093bmVkID0gMDsKICAgICAgICB2YXIgcHJlc3RpZ2VVcGdyYWRlc1RvdGFsID0gMDsKICAgICAgICB2YXIgcHJlc3RpZ2VVcGdyYWRlc093bmVkID0gMDsKCiAgICAgICAgdmFyIGxpc3QgPSBbXTsKICAgICAgICAvL3NvcnQgdGhlIHVwZ3JhZGVzCiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlVwZ3JhZGVzKSB7CiAgICAgICAgICBsaXN0LnB1c2goR2FtZS5VcGdyYWRlc1tpXSk7CiAgICAgICAgfSAvL2Nsb25lIGZpcnN0CiAgICAgICAgdmFyIHNvcnRNYXAgPSBmdW5jdGlvbiAoYSwgYikgewogICAgICAgICAgaWYgKGEub3JkZXIgPiBiLm9yZGVyKSByZXR1cm4gMTsKICAgICAgICAgIGVsc2UgaWYgKGEub3JkZXIgPCBiLm9yZGVyKSByZXR1cm4gLTE7CiAgICAgICAgICBlbHNlIHJldHVybiAwOwogICAgICAgIH07CiAgICAgICAgbGlzdC5zb3J0KHNvcnRNYXApOwogICAgICAgIGZvciAodmFyIGkgaW4gbGlzdCkgewogICAgICAgICAgdmFyIHN0cjIgPSAiIjsKICAgICAgICAgIHZhciBtZSA9IGxpc3RbaV07CgogICAgICAgICAgc3RyMiArPSBHYW1lLmNyYXRlKG1lLCAic3RhdHMiKTsKCiAgICAgICAgICBpZiAobWUuYm91Z2h0KSB7CiAgICAgICAgICAgIGlmIChHYW1lLkNvdW50c0FzVXBncmFkZU93bmVkKG1lLnBvb2wpKSB1cGdyYWRlc093bmVkKys7CiAgICAgICAgICAgIGVsc2UgaWYgKG1lLnBvb2wgPT0gInByZXN0aWdlIikgcHJlc3RpZ2VVcGdyYWRlc093bmVkKys7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKG1lLnBvb2wgPT0gIiIgfHwgbWUucG9vbCA9PSAiY29va2llIiB8fCBtZS5wb29sID09ICJ0ZWNoIikKICAgICAgICAgICAgdXBncmFkZXNUb3RhbCsrOwogICAgICAgICAgaWYgKG1lLnBvb2wgPT0gImRlYnVnIikgaGlkZGVuVXBncmFkZXMgKz0gc3RyMjsKICAgICAgICAgIGVsc2UgaWYgKG1lLnBvb2wgPT0gInByZXN0aWdlIikgewogICAgICAgICAgICBwcmVzdGlnZVVwZ3JhZGVzICs9IHN0cjI7CiAgICAgICAgICAgIHByZXN0aWdlVXBncmFkZXNUb3RhbCsrOwogICAgICAgICAgfSBlbHNlIGlmIChtZS5wb29sID09ICJjb29raWUiKSBjb29raWVVcGdyYWRlcyArPSBzdHIyOwogICAgICAgICAgZWxzZSBpZiAobWUucG9vbCAhPSAidG9nZ2xlIiAmJiBtZS5wb29sICE9ICJ1bnVzZWQiKSB1cGdyYWRlcyArPSBzdHIyOwogICAgICAgIH0KICAgICAgICB2YXIgYWNoaWV2ZW1lbnRzID0gW107CiAgICAgICAgdmFyIGFjaGlldmVtZW50c093bmVkID0gMDsKICAgICAgICB2YXIgYWNoaWV2ZW1lbnRzT3duZWRPdGhlciA9IDA7CiAgICAgICAgdmFyIGFjaGlldmVtZW50c1RvdGFsID0gMDsKCiAgICAgICAgdmFyIGxpc3QgPSBbXTsKICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuQWNoaWV2ZW1lbnRzKSB7IC8vc29ydCB0aGUgYWNoaWV2ZW1lbnRzCiAgICAgICAgICBsaXN0LnB1c2goR2FtZS5BY2hpZXZlbWVudHNbaV0pOwogICAgICAgIH0KICAgICAgICB2YXIgc29ydE1hcCA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgICBpZiAoYS5vcmRlciA+IGIub3JkZXIpIHJldHVybiAxOwogICAgICAgICAgZWxzZSBpZiAoYS5vcmRlciA8IGIub3JkZXIpIHJldHVybiAtMTsKICAgICAgICAgIGVsc2UgcmV0dXJuIDA7CiAgICAgICAgfTsKICAgICAgICBsaXN0LnNvcnQoc29ydE1hcCk7CgogICAgICAgIGZvciAodmFyIGkgaW4gbGlzdCkgewogICAgICAgICAgdmFyIG1lID0gbGlzdFtpXTsKICAgICAgICAgIC8vaWYgKG1lLnBvb2w9PSdub3JtYWwnIHx8IG1lLndvbj4wKSBhY2hpZXZlbWVudHNUb3RhbCsrOwogICAgICAgICAgaWYgKEdhbWUuQ291bnRzQXNBY2hpZXZlbWVudE93bmVkKG1lLnBvb2wpKSBhY2hpZXZlbWVudHNUb3RhbCsrOwogICAgICAgICAgdmFyIHBvb2wgPSBtZS5wb29sOwogICAgICAgICAgaWYgKCFhY2hpZXZlbWVudHNbcG9vbF0pIGFjaGlldmVtZW50c1twb29sXSA9ICIiOwogICAgICAgICAgYWNoaWV2ZW1lbnRzW3Bvb2xdICs9IEdhbWUuY3JhdGUobWUsICJzdGF0cyIpOwoKICAgICAgICAgIGlmIChtZS53b24pIHsKICAgICAgICAgICAgaWYgKEdhbWUuQ291bnRzQXNBY2hpZXZlbWVudE93bmVkKG1lLnBvb2wpKSBhY2hpZXZlbWVudHNPd25lZCsrOwogICAgICAgICAgICBlbHNlIGFjaGlldmVtZW50c093bmVkT3RoZXIrKzsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHZhciBhY2hpZXZlbWVudHNTdHIgPSAiIjsKICAgICAgICB2YXIgcG9vbHMgPSB7CiAgICAgICAgICBkdW5nZW9uOiBFTgogICAgICAgICAgICA/ICI8Yj5EdW5nZW9uIGFjaGlldmVtZW50czwvYj4gPHNtYWxsPihOb3QgdGVjaG5pY2FsbHkgYWNoaWV2YWJsZSB5ZXQuKTwvc21hbGw+IgogICAgICAgICAgICA6ICI8Yj4/Pz88L2I+IiwKICAgICAgICAgIHNoYWRvdzoKICAgICAgICAgICAgIjxiPiIgKwogICAgICAgICAgICBsb2MoIlNoYWRvdyBhY2hpZXZlbWVudHMiKSArCiAgICAgICAgICAgICI8L2I+IDxzbWFsbD4oIiArCiAgICAgICAgICAgIGxvYygKICAgICAgICAgICAgICAiVGhlc2UgYXJlIGZlYXRzIHRoYXQgYXJlIGVpdGhlciB1bmZhaXIgb3IgZGlmZmljdWx0IHRvIGF0dGFpbi4gVGhleSBkbyBub3QgZ2l2ZSBtaWxrLiIKICAgICAgICAgICAgKSArCiAgICAgICAgICAgICIpPC9zbWFsbD4iLAogICAgICAgIH07CiAgICAgICAgZm9yICh2YXIgaSBpbiBhY2hpZXZlbWVudHMpIHsKICAgICAgICAgIGlmIChhY2hpZXZlbWVudHNbaV0gIT0gIiIpIHsKICAgICAgICAgICAgaWYgKHBvb2xzW2ldKQogICAgICAgICAgICAgIGFjaGlldmVtZW50c1N0ciArPSAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JyArIHBvb2xzW2ldICsgIjwvZGl2PiI7CiAgICAgICAgICAgIGFjaGlldmVtZW50c1N0ciArPQogICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIGNyYXRlQm94Ij4nICsgYWNoaWV2ZW1lbnRzW2ldICsgIjwvZGl2PiI7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB2YXIgbWlsa1N0ciA9ICIiOwogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgR2FtZS5NaWxrcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgaWYgKEdhbWUubWlsa1Byb2dyZXNzID49IGkpIHsKICAgICAgICAgICAgdmFyIG1pbGsgPSBHYW1lLk1pbGtzW2ldOwogICAgICAgICAgICBtaWxrU3RyICs9CiAgICAgICAgICAgICAgIjxkaXYgIiArCiAgICAgICAgICAgICAgR2FtZS5nZXRUb29sdGlwKAogICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9InByb21wdCIgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyO3BhZGRpbmctYm90dG9tOjZweDt3aGl0ZS1zcGFjZTpub3dyYXA7bWFyZ2luOjBweDtwYWRkaW5nLWJvdHRvbTo5NnB4OyIgaWQ9InRvb2x0aXBNaWxrIj48aDMgc3R5bGU9Im1hcmdpbjo2cHggMzJweCAwcHggMzJweDsiPicgKwogICAgICAgICAgICAgICAgICAobG9jKCJSYW5rICUxIiwgcm9tYW5pemUoaSArIDEpKSArICIgLSAiICsgbWlsay5uYW1lKSArCiAgICAgICAgICAgICAgICAgICc8L2gzPjxkaXYgc3R5bGU9Im9wYWNpdHk6MC43NTtmb250LXNpemU6OXB4OyI+KCcgKwogICAgICAgICAgICAgICAgICAoaSA9PSAwCiAgICAgICAgICAgICAgICAgICAgPyBsb2MoInN0YXJ0ZXIgbWlsayIpCiAgICAgICAgICAgICAgICAgICAgOiBsb2MoImZvciAlMSBhY2hpZXZlbWVudHMiLCBCZWF1dGlmeShpICogMjUpKSkgKwogICAgICAgICAgICAgICAgICAnKTwvZGl2PjxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PjxkaXYgc3R5bGU9IndpZHRoOjEwMCU7aGVpZ2h0Ojk2cHg7cG9zaXRpb246YWJzb2x1dGU7bGVmdDowcHg7Ym90dG9tOjBweDtiYWNrZ3JvdW5kOnVybChpbWcvJyArCiAgICAgICAgICAgICAgICAgIG1pbGsucGljICsKICAgICAgICAgICAgICAgICAgJyk7Ij48L2Rpdj48L2Rpdj4nLAogICAgICAgICAgICAgICAgInRvcCIKICAgICAgICAgICAgICApICsKICAgICAgICAgICAgICAnIHN0eWxlPSJiYWNrZ3JvdW5kOnVybChpbWcvaWNvbnMucG5nP3Y9JyArCiAgICAgICAgICAgICAgR2FtZS52ZXJzaW9uICsKICAgICAgICAgICAgICAiKSAiICsKICAgICAgICAgICAgICAtbWlsay5pY29uWzBdICogNDggKwogICAgICAgICAgICAgICJweCAiICsKICAgICAgICAgICAgICAtbWlsay5pY29uWzFdICogNDggKwogICAgICAgICAgICAgICdweDttYXJnaW46MnB4IDBweDsiIGNsYXNzPSJ0cm9waHkiPjwvZGl2Pic7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIG1pbGtTdHIgKz0gJzxkaXYgc3R5bGU9ImNsZWFyOmJvdGg7Ij48L2Rpdj4nOwoKICAgICAgICB2YXIgc2FudGFTdHIgPSAiIjsKICAgICAgICB2YXIgZnJhbWVzID0gMTU7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJBIGZlc3RpdmUgaGF0IikpIHsKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDw9IEdhbWUuc2FudGFMZXZlbDsgaSsrKSB7CiAgICAgICAgICAgIHNhbnRhU3RyICs9CiAgICAgICAgICAgICAgIjxkaXYgIiArCiAgICAgICAgICAgICAgR2FtZS5nZXRUb29sdGlwKAogICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9InByb21wdCIgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyO3BhZGRpbmctYm90dG9tOjZweDt3aGl0ZS1zcGFjZTpub3dyYXA7bWFyZ2luOjBweCAzMnB4OyI+PGRpdiBzdHlsZT0id2lkdGg6OTZweDtoZWlnaHQ6OTZweDttYXJnaW46NHB4IGF1dG87YmFja2dyb3VuZDp1cmwoaW1nL3NhbnRhLnBuZykgJyArCiAgICAgICAgICAgICAgICAgIC1pICogOTYgKwogICAgICAgICAgICAgICAgICAncHggMHB4O2ZpbHRlcjpkcm9wLXNoYWRvdygwcHggM3B4IDJweCAjMDAwKTstd2Via2l0LWZpbHRlcjpkcm9wLXNoYWRvdygwcHggM3B4IDJweCAjMDAwKTsiIGlkPSJ0b29sdGlwU2FudGEiPjwvZGl2PjxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PjxoMz4nICsKICAgICAgICAgICAgICAgICAgR2FtZS5zYW50YUxldmVsc1tpXSArCiAgICAgICAgICAgICAgICAgICI8L2gzPjwvZGl2PiIsCiAgICAgICAgICAgICAgICAidG9wIgogICAgICAgICAgICAgICkgKwogICAgICAgICAgICAgICcgc3R5bGU9ImJhY2tncm91bmQ6dXJsKGltZy9zYW50YS5wbmcpICcgKwogICAgICAgICAgICAgIC1pICogNDggKwogICAgICAgICAgICAgICJweCAwcHg7YmFja2dyb3VuZC1zaXplOiIgKwogICAgICAgICAgICAgIGZyYW1lcyAqIDQ4ICsKICAgICAgICAgICAgICAncHggNDhweDsiIGNsYXNzPSJ0cm9waHkiPjwvZGl2Pic7CiAgICAgICAgICB9CiAgICAgICAgICBzYW50YVN0ciArPSAnPGRpdiBzdHlsZT0iY2xlYXI6Ym90aDsiPjwvZGl2Pic7CiAgICAgICAgfQogICAgICAgIHZhciBkcmFnb25TdHIgPSAiIjsKICAgICAgICB2YXIgZnJhbWVzID0gOTsKICAgICAgICB2YXIgbWFpbkxldmVscyA9IFsKICAgICAgICAgIDAsCiAgICAgICAgICA0LAogICAgICAgICAgOCwKICAgICAgICAgIEdhbWUuZHJhZ29uTGV2ZWxzLmxlbmd0aCAtIDMsCiAgICAgICAgICBHYW1lLmRyYWdvbkxldmVscy5sZW5ndGggLSAyLAogICAgICAgICAgR2FtZS5kcmFnb25MZXZlbHMubGVuZ3RoIC0gMSwKICAgICAgICBdOwogICAgICAgIGlmIChHYW1lLkhhcygiQSBjcnVtYmx5IGVnZyIpKSB7CiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8PSBtYWluTGV2ZWxzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChHYW1lLmRyYWdvbkxldmVsID49IG1haW5MZXZlbHNbaV0pIHsKICAgICAgICAgICAgICB2YXIgbGV2ZWwgPSBHYW1lLmRyYWdvbkxldmVsc1ttYWluTGV2ZWxzW2ldXTsKICAgICAgICAgICAgICBkcmFnb25TdHIgKz0KICAgICAgICAgICAgICAgICI8ZGl2ICIgKwogICAgICAgICAgICAgICAgR2FtZS5nZXRUb29sdGlwKAogICAgICAgICAgICAgICAgICAvLyc8ZGl2IHN0eWxlPSJ3aWR0aDo5NnB4O2hlaWdodDo5NnB4O21hcmdpbjo0cHggYXV0bztiYWNrZ3JvdW5kOnVybChpbWcvZHJhZ29uLnBuZz92PScrR2FtZS52ZXJzaW9uKycpICcrKC1sZXZlbC5waWMqOTYpKydweCAwcHg7Ij48L2Rpdj48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj48ZGl2IHN0eWxlPSJtaW4td2lkdGg6MjAwcHg7dGV4dC1hbGlnbjpjZW50ZXI7bWFyZ2luLWJvdHRvbTo2cHg7Ij4nK2xldmVsLm5hbWUrJzwvZGl2PicKICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9InByb21wdCIgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyO3BhZGRpbmctYm90dG9tOjZweDt3aGl0ZS1zcGFjZTpub3dyYXA7bWFyZ2luOjBweCAzMnB4OyIgaWQ9InRvb2x0aXBEcmFnb24iPjxkaXYgc3R5bGU9IndpZHRoOjk2cHg7aGVpZ2h0Ojk2cHg7bWFyZ2luOjRweCBhdXRvO2JhY2tncm91bmQ6dXJsKGltZy9kcmFnb24ucG5nP3Y9JyArCiAgICAgICAgICAgICAgICAgICAgR2FtZS52ZXJzaW9uICsKICAgICAgICAgICAgICAgICAgICAiKSAiICsKICAgICAgICAgICAgICAgICAgICAtbGV2ZWwucGljICogOTYgKwogICAgICAgICAgICAgICAgICAgICdweCAwcHg7ZmlsdGVyOmRyb3Atc2hhZG93KDBweCAzcHggMnB4ICMwMDApOy13ZWJraXQtZmlsdGVyOmRyb3Atc2hhZG93KDBweCAzcHggMnB4ICMwMDApOyI+PC9kaXY+PGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+PGgzPicgKwogICAgICAgICAgICAgICAgICAgIGxldmVsLm5hbWUgKwogICAgICAgICAgICAgICAgICAgICI8L2gzPjwvZGl2PiIsCiAgICAgICAgICAgICAgICAgICJ0b3AiCiAgICAgICAgICAgICAgICApICsKICAgICAgICAgICAgICAgICcgc3R5bGU9ImJhY2tncm91bmQ6dXJsKGltZy9kcmFnb24ucG5nP3Y9JyArCiAgICAgICAgICAgICAgICBHYW1lLnZlcnNpb24gKwogICAgICAgICAgICAgICAgIikgIiArCiAgICAgICAgICAgICAgICAtbGV2ZWwucGljICogNDggKwogICAgICAgICAgICAgICAgInB4IDBweDtiYWNrZ3JvdW5kLXNpemU6IiArCiAgICAgICAgICAgICAgICBmcmFtZXMgKiA0OCArCiAgICAgICAgICAgICAgICAncHggNDhweDsiIGNsYXNzPSJ0cm9waHkiPjwvZGl2Pic7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGRyYWdvblN0ciArPSAnPGRpdiBzdHlsZT0iY2xlYXI6Ym90aDsiPjwvZGl2Pic7CiAgICAgICAgfQogICAgICAgIHZhciBhc2NlbnNpb25Nb2RlU3RyID0gIiI7CiAgICAgICAgdmFyIGljb24gPSBHYW1lLmFzY2Vuc2lvbk1vZGVzW0dhbWUuYXNjZW5zaW9uTW9kZV0uaWNvbjsKICAgICAgICBpZiAoR2FtZS5yZXNldHMgPiAwKQogICAgICAgICAgYXNjZW5zaW9uTW9kZVN0ciA9CiAgICAgICAgICAgICc8c3BhbiBzdHlsZT0iY3Vyc29yOnBvaW50ZXI7IiAnICsKICAgICAgICAgICAgR2FtZS5nZXRUb29sdGlwKAogICAgICAgICAgICAgICc8ZGl2IHN0eWxlPSJtaW4td2lkdGg6MjAwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Zm9udC1zaXplOjExcHg7IiBpZD0idG9vbHRpcENoYWxsZW5nZU1vZGUiPicgKwogICAgICAgICAgICAgICAgR2FtZS5hc2NlbnNpb25Nb2Rlc1tHYW1lLmFzY2Vuc2lvbk1vZGVdLmRlc2MgKwogICAgICAgICAgICAgICAgIjwvZGl2PiIsCiAgICAgICAgICAgICAgInRvcCIKICAgICAgICAgICAgKSArCiAgICAgICAgICAgICc+PGRpdiBjbGFzcz0iaWNvbiIgc3R5bGU9ImRpc3BsYXk6aW5saW5lLWJsb2NrO2Zsb2F0Om5vbmU7dHJhbnNmb3JtOnNjYWxlKDAuNSk7bWFyZ2luOi0yNHB4IC0xNnB4IC0xOXB4IC04cHg7JyArCiAgICAgICAgICAgIHdyaXRlSWNvbihpY29uKSArCiAgICAgICAgICAgICciPjwvZGl2PicgKwogICAgICAgICAgICBHYW1lLmFzY2Vuc2lvbk1vZGVzW0dhbWUuYXNjZW5zaW9uTW9kZV0uZG5hbWUgKwogICAgICAgICAgICAiPC9zcGFuPiI7CgogICAgICAgIHZhciBtaWxrTmFtZSA9IEdhbWUuTWlsay5uYW1lOwoKICAgICAgICB2YXIgcmVzZWFyY2hTdHIgPSBHYW1lLnNheVRpbWUoR2FtZS5yZXNlYXJjaFQsIC0xKTsKICAgICAgICB2YXIgcGxlZGdlU3RyID0gR2FtZS5zYXlUaW1lKEdhbWUucGxlZGdlVCwgLTEpOwogICAgICAgIHZhciB3cmF0aFN0ciA9ICIiOwogICAgICAgIGlmIChHYW1lLmVsZGVyV3JhdGggPT0gMSkgd3JhdGhTdHIgPSBsb2MoImF3b2tlbiIpOwogICAgICAgIGVsc2UgaWYgKEdhbWUuZWxkZXJXcmF0aCA9PSAyKSB3cmF0aFN0ciA9IGxvYygiZGlzcGxlYXNlZCIpOwogICAgICAgIGVsc2UgaWYgKEdhbWUuZWxkZXJXcmF0aCA9PSAzKSB3cmF0aFN0ciA9IGxvYygiYW5nZXJlZCIpOwogICAgICAgIGVsc2UgaWYgKEdhbWUuZWxkZXJXcmF0aCA9PSAwICYmIEdhbWUucGxlZGdlcyA+IDApCiAgICAgICAgICB3cmF0aFN0ciA9IGxvYygiYXBwZWFzZWQiKTsKCiAgICAgICAgdmFyIGRyb3BNdWx0ID0gR2FtZS5kcm9wUmF0ZU11bHQoKTsKCiAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgpOwogICAgICAgIGRhdGUuc2V0VGltZShEYXRlLm5vdygpIC0gR2FtZS5zdGFydERhdGUpOwogICAgICAgIHZhciB0aW1lSW5TZWNvbmRzID0gZGF0ZS5nZXRUaW1lKCkgLyAxMDAwOwogICAgICAgIHZhciBzdGFydERhdGUgPSBHYW1lLnNheVRpbWUodGltZUluU2Vjb25kcyAqIEdhbWUuZnBzLCAtMSk7CiAgICAgICAgZGF0ZS5zZXRUaW1lKERhdGUubm93KCkgLSBHYW1lLmZ1bGxEYXRlKTsKICAgICAgICB2YXIgZnVsbERhdGUgPSBHYW1lLnNheVRpbWUoKGRhdGUuZ2V0VGltZSgpIC8gMTAwMCkgKiBHYW1lLmZwcywgLTEpOwogICAgICAgIGlmICghR2FtZS5mdWxsRGF0ZSB8fCAhZnVsbERhdGUgfHwgZnVsbERhdGUubGVuZ3RoIDwgMSkKICAgICAgICAgIGZ1bGxEYXRlID0gbG9jKCJhIGxvbmcgd2hpbGUiKTsKICAgICAgICAvKmRhdGUuc2V0VGltZShuZXcgRGF0ZSgpLmdldFRpbWUoKS1HYW1lLmxhc3REYXRlKTsKCQkJCXZhciBsYXN0RGF0ZT1HYW1lLnNheVRpbWUoZGF0ZS5nZXRUaW1lKCkvMTAwMCpHYW1lLmZwcywyKTsqLwoKICAgICAgICB2YXIgaGVhdmVubHlNdWx0ID0gR2FtZS5HZXRIZWF2ZW5seU11bHRpcGxpZXIoKTsKCiAgICAgICAgdmFyIHNlYXNvblN0ciA9IEdhbWUuc2F5VGltZShHYW1lLnNlYXNvblQsIC0xKTsKCiAgICAgICAgc3RyICs9CiAgICAgICAgICAnPGRpdiBjbGFzcz0ic2VjdGlvbiI+JyArCiAgICAgICAgICAoRU4gPyAiU3RhdGlzdGljcyIgOiBsb2MoIlN0YXRzIikpICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIj4nICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+JyArCiAgICAgICAgICBsb2MoIkdlbmVyYWwiKSArCiAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAnPGRpdiBpZD0ic3RhdHNHZW5lcmFsIj4nICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj4nICsKICAgICAgICAgIGxvYygiQ29va2llcyBpbiBiYW5rOiIpICsKICAgICAgICAgICc8L2I+IDxkaXYgY2xhc3M9InByaWNlIHBsYWluIj4nICsKICAgICAgICAgIEdhbWUudGlueUNvb2tpZSgpICsKICAgICAgICAgIEJlYXV0aWZ5KEdhbWUuY29va2llcykgKwogICAgICAgICAgIjwvZGl2PjwvZGl2PiIgKwogICAgICAgICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPjxiPicgKwogICAgICAgICAgbG9jKCJDb29raWVzIGJha2VkICh0aGlzIGFzY2Vuc2lvbik6IikgKwogICAgICAgICAgJzwvYj4gPGRpdiBjbGFzcz0icHJpY2UgcGxhaW4iPicgKwogICAgICAgICAgR2FtZS50aW55Q29va2llKCkgKwogICAgICAgICAgQmVhdXRpZnkoR2FtZS5jb29raWVzRWFybmVkKSArCiAgICAgICAgICAiPC9kaXY+PC9kaXY+IiArCiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGI+JyArCiAgICAgICAgICBsb2MoIkNvb2tpZXMgYmFrZWQgKGFsbCB0aW1lKToiKSArCiAgICAgICAgICAnPC9iPiA8ZGl2IGNsYXNzPSJwcmljZSBwbGFpbiI+JyArCiAgICAgICAgICBHYW1lLnRpbnlDb29raWUoKSArCiAgICAgICAgICBCZWF1dGlmeShHYW1lLmNvb2tpZXNFYXJuZWQgKyBHYW1lLmNvb2tpZXNSZXNldCkgKwogICAgICAgICAgIjwvZGl2PjwvZGl2PiIgKwogICAgICAgICAgKEdhbWUuY29va2llc1Jlc2V0ID4gMAogICAgICAgICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj4nICsKICAgICAgICAgICAgICBsb2MoIkNvb2tpZXMgZm9yZmVpdGVkIGJ5IGFzY2VuZGluZzoiKSArCiAgICAgICAgICAgICAgJzwvYj4gPGRpdiBjbGFzcz0icHJpY2UgcGxhaW4iPicgKwogICAgICAgICAgICAgIEdhbWUudGlueUNvb2tpZSgpICsKICAgICAgICAgICAgICBCZWF1dGlmeShHYW1lLmNvb2tpZXNSZXNldCkgKwogICAgICAgICAgICAgICI8L2Rpdj48L2Rpdj4iCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgIChHYW1lLnJlc2V0cwogICAgICAgICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj4nICsKICAgICAgICAgICAgICBsb2MoIkxlZ2FjeSBzdGFydGVkOiIpICsKICAgICAgICAgICAgICAiPC9iPiAiICsKICAgICAgICAgICAgICAoZnVsbERhdGUgPT0gIiIgPyBsb2MoImp1c3Qgbm93IikgOiBsb2MoIiUxIGFnbyIsIGZ1bGxEYXRlKSkgKwogICAgICAgICAgICAgICIsICIgKwogICAgICAgICAgICAgIGxvYygid2l0aCAlMSBhc2NlbnNpb24iLCBMQmVhdXRpZnkoR2FtZS5yZXNldHMpKSArCiAgICAgICAgICAgICAgIjwvZGl2PiIKICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPjxiPicgKwogICAgICAgICAgbG9jKCJSdW4gc3RhcnRlZDoiKSArCiAgICAgICAgICAiPC9iPiAiICsKICAgICAgICAgIChzdGFydERhdGUgPT0gIiIgPyBsb2MoImp1c3Qgbm93IikgOiBsb2MoIiUxIGFnbyIsIHN0YXJ0RGF0ZSkpICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj4nICsKICAgICAgICAgIGxvYygiQnVpbGRpbmdzIG93bmVkOiIpICsKICAgICAgICAgICI8L2I+ICIgKwogICAgICAgICAgQmVhdXRpZnkoYnVpbGRpbmdzT3duZWQpICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj4nICsKICAgICAgICAgIGxvYygiQ29va2llcyBwZXIgc2Vjb25kOiIpICsKICAgICAgICAgICI8L2I+ICIgKwogICAgICAgICAgQmVhdXRpZnkoR2FtZS5jb29raWVzUHMsIDEpICsKICAgICAgICAgICIgPHNtYWxsPiIgKwogICAgICAgICAgIigiICsKICAgICAgICAgIGxvYygibXVsdGlwbGllcjoiKSArCiAgICAgICAgICAiICIgKwogICAgICAgICAgQmVhdXRpZnkoTWF0aC5yb3VuZChHYW1lLmdsb2JhbENwc011bHQgKiAxMDApLCAxKSArCiAgICAgICAgICAiJSkiICsKICAgICAgICAgIChHYW1lLmNwc1N1Y2tlZCA+IDAKICAgICAgICAgICAgPyAnIDxzcGFuIGNsYXNzPSJ3YXJuaW5nIj4oJyArCiAgICAgICAgICAgICAgbG9jKCJ3aXRoZXJlZDoiKSArCiAgICAgICAgICAgICAgIiAiICsKICAgICAgICAgICAgICBCZWF1dGlmeShNYXRoLnJvdW5kKEdhbWUuY3BzU3Vja2VkICogMTAwKSwgMSkgKwogICAgICAgICAgICAgICIlKTwvc3Bhbj4iCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICI8L3NtYWxsPjwvZGl2PiIgKwogICAgICAgICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPjxiPicgKwogICAgICAgICAgbG9jKCJSYXcgY29va2llcyBwZXIgc2Vjb25kOiIpICsKICAgICAgICAgICI8L2I+ICIgKwogICAgICAgICAgQmVhdXRpZnkoR2FtZS5jb29raWVzUHNSYXcsIDEpICsKICAgICAgICAgICIgPHNtYWxsPiIgKwogICAgICAgICAgIigiICsKICAgICAgICAgIGxvYygiaGlnaGVzdCB0aGlzIGFzY2Vuc2lvbjoiKSArCiAgICAgICAgICAiICIgKwogICAgICAgICAgQmVhdXRpZnkoR2FtZS5jb29raWVzUHNSYXdIaWdoZXN0LCAxKSArCiAgICAgICAgICAiKSIgKwogICAgICAgICAgIjwvc21hbGw+PC9kaXY+IiArCiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGI+JyArCiAgICAgICAgICBsb2MoIkNvb2tpZXMgcGVyIGNsaWNrOiIpICsKICAgICAgICAgICI8L2I+ICIgKwogICAgICAgICAgQmVhdXRpZnkoR2FtZS5jb21wdXRlZE1vdXNlQ3BzLCAxKSArCiAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGI+JyArCiAgICAgICAgICBsb2MoIkNvb2tpZSBjbGlja3M6IikgKwogICAgICAgICAgIjwvYj4gIiArCiAgICAgICAgICBCZWF1dGlmeShHYW1lLmNvb2tpZUNsaWNrcykgKwogICAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPjxiPicgKwogICAgICAgICAgbG9jKCJIYW5kLW1hZGUgY29va2llczoiKSArCiAgICAgICAgICAiPC9iPiAiICsKICAgICAgICAgIEJlYXV0aWZ5KEdhbWUuaGFuZG1hZGVDb29raWVzKSArCiAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGI+JyArCiAgICAgICAgICBsb2MoIkdvbGRlbiBjb29raWUgY2xpY2tzOiIpICsKICAgICAgICAgICI8L2I+ICIgKwogICAgICAgICAgQmVhdXRpZnkoR2FtZS5nb2xkZW5DbGlja3NMb2NhbCkgKwogICAgICAgICAgIiA8c21hbGw+KCIgKwogICAgICAgICAgbG9jKCJhbGwgdGltZToiKSArCiAgICAgICAgICAiICIgKwogICAgICAgICAgQmVhdXRpZnkoR2FtZS5nb2xkZW5DbGlja3MpICsKICAgICAgICAgICIpPC9zbWFsbD48L2Rpdj4iICsgLy8nIDxzcGFuIGNsYXNzPSJoaWRkZW4iPig8Yj5NaXNzZWQgZ29sZGVuIGNvb2tpZXMgOjwvYj4gJytCZWF1dGlmeShHYW1lLm1pc3NlZEdvbGRlbkNsaWNrcykrJyk8L3NwYW4+PC9kaXY+JysKICAgICAgICAgIChkcm9wTXVsdCAhPSAxCiAgICAgICAgICAgID8gJzxkaXYgY2xhc3M9Imxpc3RpbmciPjxiPicgKwogICAgICAgICAgICAgIGxvYygiUmFuZG9tIGRyb3AgbXVsdGlwbGllcjoiKSArCiAgICAgICAgICAgICAgIjwvYj4gPHNtYWxsPng8L3NtYWxsPiIgKwogICAgICAgICAgICAgIEJlYXV0aWZ5KGRyb3BNdWx0LCAyKSArCiAgICAgICAgICAgICAgIjwvZGl2PiIKICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICAgJzxicj48ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj4nICsKICAgICAgICAgIGxvYygiUnVubmluZyB2ZXJzaW9uOiIpICsKICAgICAgICAgICI8L2I+ICIgKwogICAgICAgICAgR2FtZS52ZXJzaW9uICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgIChyZXNlYXJjaFN0ciAhPSAiIiB8fAogICAgICAgICAgd3JhdGhTdHIgIT0gIiIgfHwKICAgICAgICAgIHBsZWRnZVN0ciAhPSAiIiB8fAogICAgICAgICAgc2FudGFTdHIgIT0gIiIgfHwKICAgICAgICAgIGRyYWdvblN0ciAhPSAiIiB8fAogICAgICAgICAgR2FtZS5zZWFzb24gIT0gIiIgfHwKICAgICAgICAgIGFzY2Vuc2lvbk1vZGVTdHIgIT0gIiIgfHwKICAgICAgICAgIEdhbWUuY2FuTHVtcHMoKQogICAgICAgICAgICA/ICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIj4nICsKICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0idGl0bGUiPicgKwogICAgICAgICAgICAgIGxvYygiU3BlY2lhbCIpICsKICAgICAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAgICAgJzxkaXYgaWQ9InN0YXRzU3BlY2lhbCI+JyArCiAgICAgICAgICAgICAgKGFzY2Vuc2lvbk1vZGVTdHIgIT0gIiIKICAgICAgICAgICAgICAgID8gJzxkaXYgY2xhc3M9Imxpc3RpbmciPjxiPicgKwogICAgICAgICAgICAgICAgICBsb2MoIkNoYWxsZW5nZSBtb2RlOiIpICsKICAgICAgICAgICAgICAgICAgIjwvYj4iICsKICAgICAgICAgICAgICAgICAgYXNjZW5zaW9uTW9kZVN0ciArCiAgICAgICAgICAgICAgICAgICI8L2Rpdj4iCiAgICAgICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAgICAgKEdhbWUuc2Vhc29uICE9ICIiCiAgICAgICAgICAgICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj4nICsKICAgICAgICAgICAgICAgICAgbG9jKCJTZWFzb25hbCBldmVudDoiKSArCiAgICAgICAgICAgICAgICAgICI8L2I+ICIgKwogICAgICAgICAgICAgICAgICBHYW1lLnNlYXNvbnNbR2FtZS5zZWFzb25dLm5hbWUgKwogICAgICAgICAgICAgICAgICAoc2Vhc29uU3RyICE9ICIiCiAgICAgICAgICAgICAgICAgICAgPyAiIDxzbWFsbD4oIiArIGxvYygiJTEgcmVtYWluaW5nIiwgc2Vhc29uU3RyKSArICIpPC9zbWFsbD4iCiAgICAgICAgICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgICAgICAgICAiPC9kaXY+IgogICAgICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgICAgIChFTiAmJiBHYW1lLnNlYXNvbiA9PSAiZm9vbHMiCiAgICAgICAgICAgICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj5Nb25leSBtYWRlIGZyb20gc2VsbGluZyBjb29raWVzIDo8L2I+ICcgKwogICAgICAgICAgICAgICAgICBCZWF1dGlmeShHYW1lLmNvb2tpZXNFYXJuZWQgKiAwLjA4LCAyKSArCiAgICAgICAgICAgICAgICAgICIgY29va2llIGRvbGxhcnM8L2Rpdj4iICsKICAgICAgICAgICAgICAgICAgKEdhbWUuT2JqZWN0c1siUG9ydGFsIl0uaGlnaGVzdCA+IDAKICAgICAgICAgICAgICAgICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj5UViBzaG93IHNlYXNvbnMgcHJvZHVjZWQgOjwvYj4gJyArCiAgICAgICAgICAgICAgICAgICAgICBCZWF1dGlmeSgKICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5mbG9vcigKICAgICAgICAgICAgICAgICAgICAgICAgICAodGltZUluU2Vjb25kcyAvIDYwIC8gNjApICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIChHYW1lLk9iamVjdHNbIlBvcnRhbCJdLmhpZ2hlc3QgKiAwLjEzKSArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICkgKwogICAgICAgICAgICAgICAgICAgICAgIjwvZGl2PiIKICAgICAgICAgICAgICAgICAgICA6ICIiKQogICAgICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgICAgIChyZXNlYXJjaFN0ciAhPSAiIgogICAgICAgICAgICAgICAgPyAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGI+JyArCiAgICAgICAgICAgICAgICAgIGxvYygiUmVzZWFyY2g6IikgKwogICAgICAgICAgICAgICAgICAiPC9iPiAiICsKICAgICAgICAgICAgICAgICAgbG9jKCIlMSByZW1haW5pbmciLCByZXNlYXJjaFN0cikgKwogICAgICAgICAgICAgICAgICAiPC9kaXY+IgogICAgICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgICAgICh3cmF0aFN0ciAhPSAiIgogICAgICAgICAgICAgICAgPyAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGI+JyArCiAgICAgICAgICAgICAgICAgIGxvYygiR3JhbmRtYXRyaWFyY2hzIHN0YXR1czoiKSArCiAgICAgICAgICAgICAgICAgICI8L2I+ICIgKwogICAgICAgICAgICAgICAgICB3cmF0aFN0ciArCiAgICAgICAgICAgICAgICAgICI8L2Rpdj4iCiAgICAgICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAgICAgKHBsZWRnZVN0ciAhPSAiIgogICAgICAgICAgICAgICAgPyAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGI+JyArCiAgICAgICAgICAgICAgICAgIGxvYygiUGxlZGdlOiIpICsKICAgICAgICAgICAgICAgICAgIjwvYj4gIiArCiAgICAgICAgICAgICAgICAgIGxvYygiJTEgcmVtYWluaW5nIiwgcGxlZGdlU3RyKSArCiAgICAgICAgICAgICAgICAgICI8L2Rpdj4iCiAgICAgICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAgICAgKEdhbWUud3JpbmtsZXJzUG9wcGVkID4gMAogICAgICAgICAgICAgICAgPyAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGI+JyArCiAgICAgICAgICAgICAgICAgIGxvYygiV3JpbmtsZXJzIHBvcHBlZDoiKSArCiAgICAgICAgICAgICAgICAgICI8L2I+ICIgKwogICAgICAgICAgICAgICAgICBCZWF1dGlmeShHYW1lLndyaW5rbGVyc1BvcHBlZCkgKwogICAgICAgICAgICAgICAgICAiPC9kaXY+IgogICAgICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgICAgIChHYW1lLmNhbkx1bXBzKCkgJiYgR2FtZS5sdW1wc1RvdGFsID4gLTEKICAgICAgICAgICAgICAgID8gJzxkaXYgY2xhc3M9Imxpc3RpbmciPjxiPicgKwogICAgICAgICAgICAgICAgICBsb2MoIlN1Z2FyIGx1bXBzIGhhcnZlc3RlZDoiKSArCiAgICAgICAgICAgICAgICAgICc8L2I+IDxkaXYgY2xhc3M9InByaWNlIGx1bXAgcGxhaW4iPicgKwogICAgICAgICAgICAgICAgICBCZWF1dGlmeShHYW1lLmx1bXBzVG90YWwpICsKICAgICAgICAgICAgICAgICAgIjwvZGl2PjwvZGl2PiIKICAgICAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICAgICAvLyhHYW1lLmNvb2tpZXNTdWNrZWQ+MD8nPGRpdiBjbGFzcz0ibGlzdGluZyB3YXJuaW5nIj48Yj5XaXRoZXJlZCA6PC9iPiAnK0JlYXV0aWZ5KEdhbWUuY29va2llc1N1Y2tlZCkrJyBjb29raWVzPC9kaXY+JzonJykrCiAgICAgICAgICAgICAgKEdhbWUucmVpbmRlZXJDbGlja2VkID4gMAogICAgICAgICAgICAgICAgPyAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGI+JyArCiAgICAgICAgICAgICAgICAgIGxvYygiUmVpbmRlZXIgZm91bmQ6IikgKwogICAgICAgICAgICAgICAgICAiPC9iPiAiICsKICAgICAgICAgICAgICAgICAgQmVhdXRpZnkoR2FtZS5yZWluZGVlckNsaWNrZWQpICsKICAgICAgICAgICAgICAgICAgIjwvZGl2PiIKICAgICAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICAgICAoc2FudGFTdHIgIT0gIiIKICAgICAgICAgICAgICAgID8gJzxkaXYgY2xhc3M9Imxpc3RpbmciPjxiPicgKwogICAgICAgICAgICAgICAgICBsb2MoIlNhbnRhIHN0YWdlcyB1bmxvY2tlZDoiKSArCiAgICAgICAgICAgICAgICAgICI8L2I+PC9kaXY+PGRpdj4iICsKICAgICAgICAgICAgICAgICAgc2FudGFTdHIgKwogICAgICAgICAgICAgICAgICAiPC9kaXY+IgogICAgICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgICAgIChkcmFnb25TdHIgIT0gIiIKICAgICAgICAgICAgICAgID8gJzxkaXYgY2xhc3M9Imxpc3RpbmciPjxiPicgKwogICAgICAgICAgICAgICAgICBsb2MoIkRyYWdvbiB0cmFpbmluZzoiKSArCiAgICAgICAgICAgICAgICAgICI8L2I+PC9kaXY+PGRpdj4iICsKICAgICAgICAgICAgICAgICAgZHJhZ29uU3RyICsKICAgICAgICAgICAgICAgICAgIjwvZGl2PiIKICAgICAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICAgICAiPC9kaXY+IgogICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAoR2FtZS5wcmVzdGlnZSA+IDAgfHwgcHJlc3RpZ2VVcGdyYWRlcyAhPSAiIgogICAgICAgICAgICA/ICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIj4nICsKICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0idGl0bGUiPicgKwogICAgICAgICAgICAgIGxvYygiUHJlc3RpZ2UiKSArCiAgICAgICAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICAgICAgICc8ZGl2IGlkPSJzdGF0c1ByZXN0aWdlIj4nICsKICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGRpdiBjbGFzcz0iaWNvbiIgc3R5bGU9ImZsb2F0OmxlZnQ7YmFja2dyb3VuZC1wb3NpdGlvbjonICsKICAgICAgICAgICAgICAtMTkgKiA0OCArCiAgICAgICAgICAgICAgInB4ICIgKwogICAgICAgICAgICAgIC03ICogNDggKwogICAgICAgICAgICAgICdweDsiPjwvZGl2PicgKwogICAgICAgICAgICAgICc8ZGl2IHN0eWxlPSJtYXJnaW4tdG9wOjhweDsiPjxzcGFuIGNsYXNzPSJ0aXRsZSIgc3R5bGU9ImZvbnQtc2l6ZToyMnB4OyI+JyArCiAgICAgICAgICAgICAgbG9jKCJQcmVzdGlnZSBsZXZlbDoiKSArCiAgICAgICAgICAgICAgIiAiICsKICAgICAgICAgICAgICBCZWF1dGlmeShHYW1lLnByZXN0aWdlKSArCiAgICAgICAgICAgICAgIjwvc3Bhbj4gIiArCiAgICAgICAgICAgICAgbG9jKCJhdCAlMSUgb2YgaXRzIHBvdGVudGlhbCA8Yj4oKyUyJSBDcFMpPC9iPiIsIFsKICAgICAgICAgICAgICAgIEJlYXV0aWZ5KGhlYXZlbmx5TXVsdCAqIDEwMCwgMSksCiAgICAgICAgICAgICAgICBCZWF1dGlmeSgKICAgICAgICAgICAgICAgICAgcGFyc2VGbG9hdChHYW1lLnByZXN0aWdlKSAqIEdhbWUuaGVhdmVubHlQb3dlciAqIGhlYXZlbmx5TXVsdCwKICAgICAgICAgICAgICAgICAgMQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgIjxicj4iICsKICAgICAgICAgICAgICBsb2MoIkhlYXZlbmx5IGNoaXBzOiIpICsKICAgICAgICAgICAgICAiIDxiPiIgKwogICAgICAgICAgICAgIEJlYXV0aWZ5KEdhbWUuaGVhdmVubHlDaGlwcykgKwogICAgICAgICAgICAgICI8L2I+PC9kaXY+IiArCiAgICAgICAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICAgICAgIChwcmVzdGlnZVVwZ3JhZGVzICE9ICIiCiAgICAgICAgICAgICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIiBzdHlsZT0iY2xlYXI6bGVmdDsiPjxiPicgKwogICAgICAgICAgICAgICAgICBsb2MoIlByZXN0aWdlIHVwZ3JhZGVzIHVubG9ja2VkOiIpICsKICAgICAgICAgICAgICAgICAgIjwvYj4gIiArCiAgICAgICAgICAgICAgICAgIHByZXN0aWdlVXBncmFkZXNPd25lZCArCiAgICAgICAgICAgICAgICAgICIvIiArCiAgICAgICAgICAgICAgICAgIHByZXN0aWdlVXBncmFkZXNUb3RhbCArCiAgICAgICAgICAgICAgICAgICIgKCIgKwogICAgICAgICAgICAgICAgICBNYXRoLmZsb29yKAogICAgICAgICAgICAgICAgICAgIChwcmVzdGlnZVVwZ3JhZGVzT3duZWQgLyBwcmVzdGlnZVVwZ3JhZGVzVG90YWwpICogMTAwCiAgICAgICAgICAgICAgICAgICkgKwogICAgICAgICAgICAgICAgICAiJSk8L2Rpdj4iICsKICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9Imxpc3RpbmcgY3JhdGVCb3giPicgKwogICAgICAgICAgICAgICAgICBwcmVzdGlnZVVwZ3JhZGVzICsKICAgICAgICAgICAgICAgICAgIjwvZGl2PiIKICAgICAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICAgICAiPC9kaXY+IgogICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiI+JyArCiAgICAgICAgICAnPGRpdiBjbGFzcz0idGl0bGUiPicgKwogICAgICAgICAgbG9jKCJVcGdyYWRlcyIpICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICc8ZGl2IGlkPSJzdGF0c1VwZ3JhZGVzIj4nICsKICAgICAgICAgIChoaWRkZW5VcGdyYWRlcyAhPSAiIgogICAgICAgICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj5EZWJ1ZzwvYj48L2Rpdj4nICsKICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyBjcmF0ZUJveCI+JyArCiAgICAgICAgICAgICAgaGlkZGVuVXBncmFkZXMgKwogICAgICAgICAgICAgICI8L2Rpdj4iCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj4nICsKICAgICAgICAgIGxvYygiVXBncmFkZXMgdW5sb2NrZWQ6IikgKwogICAgICAgICAgIjwvYj4gIiArCiAgICAgICAgICB1cGdyYWRlc093bmVkICsKICAgICAgICAgICIvIiArCiAgICAgICAgICB1cGdyYWRlc1RvdGFsICsKICAgICAgICAgICIgKCIgKwogICAgICAgICAgTWF0aC5mbG9vcigodXBncmFkZXNPd25lZCAvIHVwZ3JhZGVzVG90YWwpICogMTAwKSArCiAgICAgICAgICAiJSk8L2Rpdj4iICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIGNyYXRlQm94Ij4nICsKICAgICAgICAgIHVwZ3JhZGVzICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgIChjb29raWVVcGdyYWRlcyAhPSAiIgogICAgICAgICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj4nICsKICAgICAgICAgICAgICBsb2MoIkNvb2tpZXMiKSArCiAgICAgICAgICAgICAgIjwvYj48L2Rpdj4iICsKICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyBjcmF0ZUJveCI+JyArCiAgICAgICAgICAgICAgY29va2llVXBncmFkZXMgKwogICAgICAgICAgICAgICI8L2Rpdj4iCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIj4nICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+JyArCiAgICAgICAgICBsb2MoIkFjaGlldmVtZW50cyIpICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICc8ZGl2IGlkPSJzdGF0c0FjaGlldnMiPicgKwogICAgICAgICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPjxiPicgKwogICAgICAgICAgbG9jKCJBY2hpZXZlbWVudHMgdW5sb2NrZWQ6IikgKwogICAgICAgICAgIjwvYj4gIiArCiAgICAgICAgICBhY2hpZXZlbWVudHNPd25lZCArCiAgICAgICAgICAiLyIgKwogICAgICAgICAgYWNoaWV2ZW1lbnRzVG90YWwgKwogICAgICAgICAgIiAoIiArCiAgICAgICAgICBNYXRoLmZsb29yKChhY2hpZXZlbWVudHNPd25lZCAvIGFjaGlldmVtZW50c1RvdGFsKSAqIDEwMCkgKwogICAgICAgICAgIiUpIiArCiAgICAgICAgICAoYWNoaWV2ZW1lbnRzT3duZWRPdGhlciA+IDAKICAgICAgICAgICAgPyAnPHNwYW4gc3R5bGU9ImZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1zaXplOjEwcHg7Y29sb3I6IzcwYTsiPiAoKycgKwogICAgICAgICAgICAgIGFjaGlldmVtZW50c093bmVkT3RoZXIgKwogICAgICAgICAgICAgICIpPC9zcGFuPiIKICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICAgKEdhbWUuY29va2llc011bHRCeVR5cGVbImtpdHRlbnMiXSA+IDEKICAgICAgICAgICAgPyAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGI+JyArCiAgICAgICAgICAgICAgbG9jKCJLaXR0ZW4gbXVsdGlwbGllcjoiKSArCiAgICAgICAgICAgICAgIjwvYj4gIiArCiAgICAgICAgICAgICAgQmVhdXRpZnkoR2FtZS5jb29raWVzTXVsdEJ5VHlwZVsia2l0dGVucyJdICogMTAwKSArCiAgICAgICAgICAgICAgIiU8L2Rpdj4iCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj4nICsKICAgICAgICAgIGxvYygiTWlsayIpICsKICAgICAgICAgICI6PC9iPiAiICsKICAgICAgICAgIG1pbGtOYW1lICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgIChtaWxrU3RyICE9ICIiCiAgICAgICAgICAgID8gJzxkaXYgY2xhc3M9Imxpc3RpbmciPjxiPicgKwogICAgICAgICAgICAgIGxvYygiTWlsayBmbGF2b3JzIHVubG9ja2VkOiIpICsKICAgICAgICAgICAgICAiPC9iPjwvZGl2PjxkaXY+IiArCiAgICAgICAgICAgICAgbWlsa1N0ciArCiAgICAgICAgICAgICAgIjwvZGl2PiIKICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPjxzbWFsbCBzdHlsZT0ib3BhY2l0eTowLjc1OyI+KCcgKwogICAgICAgICAgbG9jKAogICAgICAgICAgICAiTWlsayBpcyBnYWluZWQgd2l0aCBlYWNoIGFjaGlldmVtZW50LiBJdCBjYW4gdW5sb2NrIHVuaXF1ZSB1cGdyYWRlcyBvdmVyIHRpbWUuIgogICAgICAgICAgKSArCiAgICAgICAgICAiKTwvc21hbGw+PC9kaXY+IiArCiAgICAgICAgICBhY2hpZXZlbWVudHNTdHIgKwogICAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICAgJzxkaXYgc3R5bGU9InBhZGRpbmctYm90dG9tOjEyOHB4OyI+PC9kaXY+JzsKICAgICAgfQogICAgICAvL3N0cj0nPGRpdiBpZD0ic2VsZWN0aW9uS2VlcGVyIiBjbGFzcz0ic2VsZWN0YWJsZSI+JytzdHIrJzwvZGl2Pic7CiAgICAgIGwoIm1lbnUiKS5pbm5lckhUTUwgPSBzdHI7CiAgICAgIGlmIChBcHApIHsKICAgICAgICB2YXIgYW5jaG9ycyA9IGwoIm1lbnUiKS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYSIpOwogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYW5jaG9ycy5sZW5ndGg7IGkrKykgewogICAgICAgICAgdmFyIGl0ID0gYW5jaG9yc1tpXTsKICAgICAgICAgIGlmIChpdC5ocmVmKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGl0LmhyZWYpOwogICAgICAgICAgICBBZGRFdmVudCgKICAgICAgICAgICAgICBpdCwKICAgICAgICAgICAgICAiY2xpY2siLAogICAgICAgICAgICAgIChmdW5jdGlvbiAoaHJlZikgewogICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgQXBwLm9wZW5MaW5rKGhyZWYpOwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICB9KShpdC5ocmVmKQogICAgICAgICAgICApOwogICAgICAgICAgICBpdC5yZW1vdmVBdHRyaWJ1dGUoImhyZWYiKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgLypBZGRFdmVudChsKCdzZWxlY3Rpb25LZWVwZXInKSwnbW91c2V1cCcsZnVuY3Rpb24oZSl7CgkJCQljb25zb2xlLmxvZygnc2VsZWN0aW9uOicsd2luZG93LmdldFNlbGVjdGlvbigpKTsKCQkJfSk7Ki8KICAgIH07CgogICAgQWRkRXZlbnQobCgicHJlZnNCdXR0b24iKSwgImNsaWNrIiwgZnVuY3Rpb24gKCkgewogICAgICBHYW1lLlNob3dNZW51KCJwcmVmcyIpOwogICAgfSk7CiAgICBBZGRFdmVudChsKCJzdGF0c0J1dHRvbiIpLCAiY2xpY2siLCBmdW5jdGlvbiAoKSB7CiAgICAgIEdhbWUuU2hvd01lbnUoInN0YXRzIik7CiAgICB9KTsKICAgIEFkZEV2ZW50KGwoImxvZ0J1dHRvbiIpLCAiY2xpY2siLCBmdW5jdGlvbiAoKSB7CiAgICAgIEdhbWUuU2hvd01lbnUoImxvZyIpOwogICAgfSk7CiAgICBBZGRFdmVudChsKCJsZWdhY3lCdXR0b24iKSwgImNsaWNrIiwgZnVuY3Rpb24gKCkgewogICAgICBQbGF5U291bmQoInNuZC90aWNrLm1wMyIpOwogICAgICBHYW1lLkFzY2VuZCgpOwogICAgfSk7CiAgICBHYW1lLmFzY2VuZE1ldGVyID0gbCgiYXNjZW5kTWV0ZXIiKTsKICAgIEdhbWUuYXNjZW5kTnVtYmVyID0gbCgiYXNjZW5kTnVtYmVyIik7CgogICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkJTkVXUyBUSUNLRVIKCQk9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgR2FtZS5UaWNrZXIgPSAiIjsKICAgIEdhbWUuVGlja2VyQWdlID0gMDsKICAgIEdhbWUuVGlja2VyRWZmZWN0ID0gMDsKICAgIEdhbWUuVGlja2VyTiA9IDA7CiAgICBHYW1lLlRpY2tlckNsaWNrcyA9IDA7CiAgICBHYW1lLlVwZGF0ZVRpY2tlciA9IGZ1bmN0aW9uICgpIHsKICAgICAgR2FtZS5UaWNrZXJBZ2UtLTsKICAgICAgaWYgKEdhbWUuVGlja2VyQWdlIDw9IDApIEdhbWUuZ2V0TmV3VGlja2VyKCk7CiAgICAgIGVsc2UgaWYgKEdhbWUuVGlja2VyID09ICIiKSBHYW1lLmdldE5ld1RpY2tlcih0cnVlKTsKICAgIH07CiAgICBHYW1lLmdldE5ld1RpY2tlciA9IGZ1bmN0aW9uICgKICAgICAgbWFudWFsIC8vbm90ZSA6ICJtYW51YWwiIGlzIHRydWUgaWYgdGhlIHRpY2tlciB3YXMgY2xpY2tlZCwgYnV0IG1heSBhbHNvIGJlIHRydWUgb24gc3RhcnR1cCBldGMKICAgICkgewogICAgICB2YXIgbGlzdCA9IFtdOwoKICAgICAgdmFyIE5FV1MgPSBsb2MoIk5ld3MgOiIpLnJlcGxhY2UoIiAiLCAiJm5ic3A7IikgKyAiICI7CgogICAgICB2YXIgbG9yZVByb2dyZXNzID0gTWF0aC5yb3VuZCgKICAgICAgICAoTWF0aC5sb2coR2FtZS5jb29raWVzRWFybmVkIC8gMTApICogTWF0aC5MT0cxMEUgKyAxKSB8IDAKICAgICAgKTsKCiAgICAgIGlmIChHYW1lLlRpY2tlck4gJSAyID09IDAgfHwgbG9yZVByb2dyZXNzID4gMTQpIHsKICAgICAgICB2YXIgYW5pbWFscyA9IFsKICAgICAgICAgICJuZXd0cyIsCiAgICAgICAgICAicGVuZ3VpbnMiLAogICAgICAgICAgInNjb3JwaW9ucyIsCiAgICAgICAgICAiYXhvbG90bHMiLAogICAgICAgICAgInB1ZmZpbnMiLAogICAgICAgICAgInBvcnBvaXNlcyIsCiAgICAgICAgICAiYmxvd2Zpc2giLAogICAgICAgICAgImhvcnNlcyIsCiAgICAgICAgICAiY3JheWZpc2giLAogICAgICAgICAgInNsdWdzIiwKICAgICAgICAgICJodW1wYmFjayB3aGFsZXMiLAogICAgICAgICAgIm51cnNlIHNoYXJrcyIsCiAgICAgICAgICAiZ2lhbnQgc3F1aWRzIiwKICAgICAgICAgICJwb2xhciBiZWFycyIsCiAgICAgICAgICAiZnJ1aXQgYmF0cyIsCiAgICAgICAgICAiZnJvZ3MiLAogICAgICAgICAgInNlYSBzcXVpcnRzIiwKICAgICAgICAgICJ2ZWx2ZXQgd29ybXMiLAogICAgICAgICAgIm1vbGUgcmF0cyIsCiAgICAgICAgICAicGFyYW1lY2lhIiwKICAgICAgICAgICJuZW1hdG9kZXMiLAogICAgICAgICAgInRhcmRpZ3JhZGVzIiwKICAgICAgICAgICJnaXJhZmZlcyIsCiAgICAgICAgICAibW9ua2Zpc2giLAogICAgICAgICAgIndvbGZtZW4iLAogICAgICAgICAgImdvYmxpbnMiLAogICAgICAgICAgImhpcHBpZXMiLAogICAgICAgIF07CgogICAgICAgIGlmIChNYXRoLnJhbmRvbSgpIDwgMC43NSB8fCBHYW1lLmNvb2tpZXNFYXJuZWQgPCAxMDAwMCkgewogICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLmFtb3VudCA+IDApCiAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAiPHE+IiArCiAgICAgICAgICAgICAgICBjaG9vc2UobG9jKCJUaWNrZXIgKGdyYW5kbWEpIikpICsKICAgICAgICAgICAgICAgICI8L3E+PHNpZz4iICsKICAgICAgICAgICAgICAgIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLnNpbmdsZSArCiAgICAgICAgICAgICAgICAiPC9zaWc+IgogICAgICAgICAgICApOwoKICAgICAgICAgIGlmICghR2FtZS5wcmVmcy5ub3RTY2FyeSAmJiBHYW1lLk9iamVjdHNbIkdyYW5kbWEiXS5hbW91bnQgPj0gNTApCiAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAiPHE+IiArCiAgICAgICAgICAgICAgICBjaG9vc2UobG9jKCJUaWNrZXIgKHRocmVhdGVuaW5nIGdyYW5kbWEpIikpICsKICAgICAgICAgICAgICAgICI8L3E+PHNpZz4iICsKICAgICAgICAgICAgICAgIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLnNpbmdsZSArCiAgICAgICAgICAgICAgICAiPC9zaWc+IgogICAgICAgICAgICApOwoKICAgICAgICAgIGlmIChFTiAmJiBHYW1lLkhhc0FjaGlldigiSnVzdCB3cm9uZyIpICYmIE1hdGgucmFuZG9tKCkgPCAwLjA1KQogICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgTkVXUyArICJjb29raWUgbWFudWZhY3R1cmVyIGRvd25zaXplcywgc2VsbHMgb3duIGdyYW5kbW90aGVyISIKICAgICAgICAgICAgKTsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgIUdhbWUucHJlZnMubm90U2NhcnkgJiYKICAgICAgICAgICAgR2FtZS5IYXNBY2hpZXYoIkp1c3Qgd3JvbmciKSAmJgogICAgICAgICAgICBNYXRoLnJhbmRvbSgpIDwgMC40CiAgICAgICAgICApCiAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAiPHE+IiArCiAgICAgICAgICAgICAgICBjaG9vc2UobG9jKCJUaWNrZXIgKGFuZ3J5IGdyYW5kbWEpIikpICsKICAgICAgICAgICAgICAgICI8L3E+PHNpZz4iICsKICAgICAgICAgICAgICAgIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLnNpbmdsZSArCiAgICAgICAgICAgICAgICAiPC9zaWc+IgogICAgICAgICAgICApOwoKICAgICAgICAgIGlmICgKICAgICAgICAgICAgIUdhbWUucHJlZnMubm90U2NhcnkgJiYKICAgICAgICAgICAgR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0uYW1vdW50ID49IDEgJiYKICAgICAgICAgICAgR2FtZS5wbGVkZ2VzID4gMCAmJgogICAgICAgICAgICBHYW1lLmVsZGVyV3JhdGggPT0gMAogICAgICAgICAgKQogICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgIjxxPiIgKwogICAgICAgICAgICAgICAgY2hvb3NlKGxvYygiVGlja2VyIChncmFuZG1hcyByZXR1cm4pIikpICsKICAgICAgICAgICAgICAgICI8L3E+PHNpZz4iICsKICAgICAgICAgICAgICAgIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLnNpbmdsZSArCiAgICAgICAgICAgICAgICAiPC9zaWc+IgogICAgICAgICAgICApOwoKICAgICAgICAgIGlmICghRU4pIHsKICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICAgICAgICBpZiAoaSAhPSAiQ3Vyc29yIiAmJiBpICE9ICJHcmFuZG1hIiAmJiBHYW1lLk9iamVjdHNbaV0uYW1vdW50ID4gMCkKICAgICAgICAgICAgICAgIGxpc3QucHVzaChORVdTICsgY2hvb3NlKGxvYygiVGlja2VyICgiICsgaSArICIpIikpKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKEdhbWUuY29va2llc0Vhcm5lZCA+PSAxMDAwKSB7CiAgICAgICAgICAgICAgaWYgKEdhbWUuc2Vhc29uID09ICJoYWxsb3dlZW4iKQogICAgICAgICAgICAgICAgbGlzdC5wdXNoKE5FV1MgKyBjaG9vc2UobG9jKCJUaWNrZXIgKEhhbGxvd2VlbikiKSkpOwogICAgICAgICAgICAgIGlmIChHYW1lLnNlYXNvbiA9PSAiY2hyaXN0bWFzIikKICAgICAgICAgICAgICAgIGxpc3QucHVzaChORVdTICsgY2hvb3NlKGxvYygiVGlja2VyIChDaHJpc3RtYXMpIikpKTsKICAgICAgICAgICAgICBpZiAoR2FtZS5zZWFzb24gPT0gInZhbGVudGluZXMiKQogICAgICAgICAgICAgICAgbGlzdC5wdXNoKE5FV1MgKyBjaG9vc2UobG9jKCJUaWNrZXIgKFZhbGVudGluZXMpIikpKTsKICAgICAgICAgICAgICBpZiAoR2FtZS5zZWFzb24gPT0gImVhc3RlciIpCiAgICAgICAgICAgICAgICBsaXN0LnB1c2goTkVXUyArIGNob29zZShsb2MoIlRpY2tlciAoRWFzdGVyKSIpKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIkZhcm0iXS5hbW91bnQgPiAwKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICJOZXdzIDogY29va2llIGZhcm1zIHN1c3BlY3RlZCBvZiBlbXBsb3lpbmcgdW5kZWNsYXJlZCBlbGRlcmx5IHdvcmtmb3JjZSEiLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGNvb2tpZSBmYXJtcyByZWxlYXNlIGhhcm1mdWwgY2hvY29sYXRlIGluIG91ciByaXZlcnMsIHNheXMgc2NpZW50aXN0ISIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogZ2VuZXRpY2FsbHktbW9kaWZpZWQgY2hvY29sYXRlIGNvbnRyb3ZlcnN5IHN0cmlrZXMgY29va2llIGZhcm1lcnMhIiwKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBmcmVlLXJhbmdlIGZhcm0gY29va2llcyBwb3B1bGFyIHdpdGggdG9kYXkncyBoaXAgeW91dGgsIHNheXMgc3BlY2lhbGlzdC4iLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGZhcm0gY29va2llcyBkZWVtZWQgdW5maXQgZm9yIHZlZ2Fucywgc2F5cyBudXRyaXRpb25pc3QuIiwKICAgICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIk1pbmUiXS5hbW91bnQgPiAwKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICJOZXdzIDogaXMgb3VyIHBsYW5ldCBnZXR0aW5nIGxpZ2h0ZXI/IEV4cGVydHMgZXhhbWluZSB0aGUgZWZmZWN0cyBvZiBpbnRlbnNpdmUgY2hvY29sYXRlIG1pbmluZy4iLAogICAgICAgICAgICAgICAgICAiTmV3cyA6ICIgKwogICAgICAgICAgICAgICAgICAgIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAgKyAyKSArCiAgICAgICAgICAgICAgICAgICAgIiBtaW5lcnMgdHJhcHBlZCBpbiBjb2xsYXBzZWQgY2hvY29sYXRlIG1pbmUhIiwKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBjaG9jb2xhdGUgbWluZXMgZm91bmQgdG8gY2F1c2UgZWFydGhxdWFrZXMgYW5kIHNpbmtob2xlcyEiLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGNob2NvbGF0ZSBtaW5lIGdvZXMgYXdyeSwgZmxvb2RzIHZpbGxhZ2UgaW4gY2hvY29sYXRlISIsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogZGVwdGhzIG9mIGNob2NvbGF0ZSBtaW5lcyBmb3VuZCB0byBob3VzZSAicGVjdWxpYXIsIGNob2NvbGF0eSBiZWluZ3MiIScsCiAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICk7CgogICAgICAgICAgICBpZiAoR2FtZS5PYmplY3RzWyJGYWN0b3J5Il0uYW1vdW50ID4gMCkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAiTmV3cyA6IGNvb2tpZSBmYWN0b3JpZXMgbGlua2VkIHRvIGdsb2JhbCB3YXJtaW5nISIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogY29va2llIGZhY3RvcmllcyBpbnZvbHZlZCBpbiBjaG9jb2xhdGUgd2VhdGhlciBjb250cm92ZXJzeSEiLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGNvb2tpZSBmYWN0b3JpZXMgb24gc3RyaWtlLCByb2JvdGljIG1pbmlvbnMgZW1wbG95ZWQgdG8gcmVwbGFjZSB3b3JrZm9yY2UhIiwKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBjb29raWUgZmFjdG9yaWVzIG9uIHN0cmlrZSAtIHdvcmtlcnMgZGVtYW5kIHRvIHN0b3AgYmVpbmcgcGFpZCBpbiBjb29raWVzISIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogZmFjdG9yeS1tYWRlIGNvb2tpZXMgbGlua2VkIHRvIG9iZXNpdHksIHNheXMgc3R1ZHkuIiwKICAgICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIkJhbmsiXS5hbW91bnQgPiAwKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICJOZXdzIDogY29va2llIGxvYW5zIG9uIHRoZSByaXNlIGFzIHBlb3BsZSBjYW4gbm8gbG9uZ2VyIGFmZm9yZCB0aGVtIHdpdGggcmVndWxhciBtb25leS4iLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGNvb2tpZXMgc2xvd2x5IGNyZWVwaW5nIHVwIHRoZWlyIHdheSBhcyBhIGNvbXBldGl0b3IgdG8gdHJhZGl0aW9uYWwgY3VycmVuY3khIiwKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBtb3N0IGJha2VyaWVzIG5vdyBmaXR0ZWQgd2l0aCBBVE1zIHRvIGFsbG93IGZvciBlYXN5IGNvb2tpZSB3aXRoZHJhd2FscyBhbmQgZGVwb3NpdHMuIiwKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBjb29raWUgZWNvbm9teSBub3cgc3Ryb25nIGVub3VnaCB0byBhbGxvdyBmb3IgbWFzc2l2ZSB2YXVsdHMgZG91YmxpbmcgYXMgc3dpbW1pbmcgcG9vbHMhIiwKICAgICAgICAgICAgICAgICAgJ05ld3MgOiAiVG9tb3Jyb3dcJ3Mgd2VhbHRoaWVzdCBwZW9wbGUgd2lsbCBiZSBjYWxjdWxhdGVkIGJ5IHRoZWlyIHdvcnRoIGluIGNvb2tpZXMiLCBwcmVkaWN0IGVjb25vbWlzdHMuJywKICAgICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIlRlbXBsZSJdLmFtb3VudCA+IDApCiAgICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBleHBsb3JlcnMgYnJpbmcgYmFjayBhbmNpZW50IGFydGlmYWN0IGZyb20gYWJhbmRvbmVkIHRlbXBsZTsgYXJjaGVvbG9naXN0cyBtYXJ2ZWwgYXQgdGhlIGNlbnR1cmllcy1vbGQgIiArCiAgICAgICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgICAgICJtYWdpYyIsCiAgICAgICAgICAgICAgICAgICAgICAiY2FydmVkIiwKICAgICAgICAgICAgICAgICAgICAgICJlbmdyYXZlZCIsCiAgICAgICAgICAgICAgICAgICAgICAic2N1bHB0ZWQiLAogICAgICAgICAgICAgICAgICAgICAgInJveWFsIiwKICAgICAgICAgICAgICAgICAgICAgICJpbXBlcmlhbCIsCiAgICAgICAgICAgICAgICAgICAgICAibXVtbWlmaWVkIiwKICAgICAgICAgICAgICAgICAgICAgICJyaXR1YWwiLAogICAgICAgICAgICAgICAgICAgICAgImdvbGRlbiIsCiAgICAgICAgICAgICAgICAgICAgICAic2lsdmVyIiwKICAgICAgICAgICAgICAgICAgICAgICJzdG9uZSIsCiAgICAgICAgICAgICAgICAgICAgICAiY3Vyc2VkIiwKICAgICAgICAgICAgICAgICAgICAgICJwbGFzdGljIiwKICAgICAgICAgICAgICAgICAgICAgICJib25lIiwKICAgICAgICAgICAgICAgICAgICAgICJibG9vZCIsCiAgICAgICAgICAgICAgICAgICAgICAiaG9seSIsCiAgICAgICAgICAgICAgICAgICAgICAic2FjcmVkIiwKICAgICAgICAgICAgICAgICAgICAgICJzYWNyaWZpY2lhbCIsCiAgICAgICAgICAgICAgICAgICAgICAiZWxlY3Ryb25pYyIsCiAgICAgICAgICAgICAgICAgICAgICAic2luZ2luZyIsCiAgICAgICAgICAgICAgICAgICAgICAidGFwZGFuY2luZyIsCiAgICAgICAgICAgICAgICAgICAgXSkgKwogICAgICAgICAgICAgICAgICAgICIgIiArCiAgICAgICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgICAgICJzcG9vbiIsCiAgICAgICAgICAgICAgICAgICAgICAiZm9yayIsCiAgICAgICAgICAgICAgICAgICAgICAicGl6emEiLAogICAgICAgICAgICAgICAgICAgICAgIndhc2hpbmcgbWFjaGluZSIsCiAgICAgICAgICAgICAgICAgICAgICAiY2FsY3VsYXRvciIsCiAgICAgICAgICAgICAgICAgICAgICAiaGF0IiwKICAgICAgICAgICAgICAgICAgICAgICJwaWFubyIsCiAgICAgICAgICAgICAgICAgICAgICAibmFwa2luIiwKICAgICAgICAgICAgICAgICAgICAgICJza2VsZXRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAiZ293biIsCiAgICAgICAgICAgICAgICAgICAgICAiZGFnZ2VyIiwKICAgICAgICAgICAgICAgICAgICAgICJzd29yZCIsCiAgICAgICAgICAgICAgICAgICAgICAic2hpZWxkIiwKICAgICAgICAgICAgICAgICAgICAgICJza3VsbCIsCiAgICAgICAgICAgICAgICAgICAgICAiZW1lcmFsZCIsCiAgICAgICAgICAgICAgICAgICAgICAiYmF0aHR1YiIsCiAgICAgICAgICAgICAgICAgICAgICAibWFzayIsCiAgICAgICAgICAgICAgICAgICAgICAicm9sbGVyc2thdGVzIiwKICAgICAgICAgICAgICAgICAgICAgICJsaXR0ZXJib3giLAogICAgICAgICAgICAgICAgICAgICAgImJhaXQgYm94IiwKICAgICAgICAgICAgICAgICAgICAgICJjdWJlIiwKICAgICAgICAgICAgICAgICAgICAgICJzcGhlcmUiLAogICAgICAgICAgICAgICAgICAgICAgImZ1bmd1cyIsCiAgICAgICAgICAgICAgICAgICAgXSkgKwogICAgICAgICAgICAgICAgICAgICIhIiwKICAgICAgICAgICAgICAgICAgIk5ld3MgOiByZWNlbnRseS1kaXNjb3ZlcmVkIGNob2NvbGF0ZSB0ZW1wbGVzIG5vdyBzcGFya2luZyBuZXcgY29va2llLXJlbGF0ZWQgY3VsdDsgdGhvdXNhbmRzIHByYXkgdG8gQmFrZXIgaW4gdGhlIHNreSEiLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGp1c3QgaG93IGV4dGVuc2l2ZSBpcyB0aGUgY29va2llIHBhbnRoZW9uPyBUaGVvbG9naWFucyBzcGVjdWxhdGUgYWJvdXQgcG9zc2libGUgIiArCiAgICAgICAgICAgICAgICAgICAgY2hvb3NlKFsiZ29kIiwgImdvZGRlc3MiXSkgKwogICAgICAgICAgICAgICAgICAgICIgb2YgIiArCiAgICAgICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgICAgIGNob29zZShhbmltYWxzKSwKICAgICAgICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICAgICAgICJrYXpvb3MiLAogICAgICAgICAgICAgICAgICAgICAgICAid2ViIGRlc2lnbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWIgYnJvd3NlcnMiLAogICAgICAgICAgICAgICAgICAgICAgICAia2l0dGVucyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJhdGhlaXNtIiwKICAgICAgICAgICAgICAgICAgICAgICAgImhhbmRicmFrZXMiLAogICAgICAgICAgICAgICAgICAgICAgICAiaGF0cyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJhZ2xldHMiLAogICAgICAgICAgICAgICAgICAgICAgICAiZWxldmF0b3IgbXVzaWMiLAogICAgICAgICAgICAgICAgICAgICAgICAiaWRsZSBnYW1lcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICd0aGUgbGV0dGVyICJQIicsCiAgICAgICAgICAgICAgICAgICAgICAgICJtZW1lcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJoYW1idXJnZXJzIiwKICAgICAgICAgICAgICAgICAgICAgICAgImJhZCBwdW5zIiwKICAgICAgICAgICAgICAgICAgICAgICAgImtlcm5pbmciLAogICAgICAgICAgICAgICAgICAgICAgICAic3RhbmQtdXAgY29tZWR5IiwKICAgICAgICAgICAgICAgICAgICAgICAgImZhaWxlZCBidXJnbGFyeSBhdHRlbXB0cyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJjbGlja2JhaXQiLAogICAgICAgICAgICAgICAgICAgICAgICAib25lIHdlaXJkIHRyaWNrcyIsCiAgICAgICAgICAgICAgICAgICAgICBdKSwKICAgICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICAgIi4iLAogICAgICAgICAgICAgICAgICAnTmV3cyA6IHRoZWlzdHMgb2YgdGhlIHdvcmxkIGRpc2NvdmVyIG5ldyBjb29raWUgcmVsaWdpb24gLSAiT2ggYm95LCBndWVzcyB3ZSB3ZXJlIHdyb25nIGFsbCBhbG9uZyEiJywKICAgICAgICAgICAgICAgICAgJ05ld3MgOiBjb29raWUgaGVhdmVuIGFsbGVnZWRseSAic3BvcnRzIGVsZXZhdG9yIGluc3RlYWQgb2Ygc3RhaXJ3YXkiOyBjb29raWUgaGVsbCAicGF2ZWQgd2l0aCBmbGFnc3RvbmUsIGFzIGdvb2QgaW50ZW50aW9ucyBtYWtlIGZvciBwb29yIGJ1aWxkaW5nIG1hdGVyaWFsIi4nLAogICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siV2l6YXJkIHRvd2VyIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAiTmV3cyA6IGFsbCAiICsKICAgICAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAgICAgY2hvb3NlKGFuaW1hbHMpLAogICAgICAgICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgICAgICAgInB1YmxpYyByZXN0cm9vbXMiLAogICAgICAgICAgICAgICAgICAgICAgICAiY2xvdWRzIiwKICAgICAgICAgICAgICAgICAgICAgICAgInBvbGl0aWNpYW5zIiwKICAgICAgICAgICAgICAgICAgICAgICAgIm1vdXN0YWNoZXMiLAogICAgICAgICAgICAgICAgICAgICAgICAiaGF0cyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJzaG9lcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJwYW50cyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJjbG93bnMiLAogICAgICAgICAgICAgICAgICAgICAgICAiZW5jeWNsb3BlZGlhcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWJzaXRlcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJwb3R0ZWQgcGxhbnRzIiwKICAgICAgICAgICAgICAgICAgICAgICAgImxlbW9ucyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJob3VzZWhvbGQgaXRlbXMiLAogICAgICAgICAgICAgICAgICAgICAgICAiYm9kaWx5IGZsdWlkcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJjdXRsZXJ5IiwKICAgICAgICAgICAgICAgICAgICAgICAgIm5hdGlvbmFsIGxhbmRtYXJrcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ5b2d1cnQiLAogICAgICAgICAgICAgICAgICAgICAgICAicmFwIG11c2ljIiwKICAgICAgICAgICAgICAgICAgICAgICAgInVuZGVyd2VhciIsCiAgICAgICAgICAgICAgICAgICAgICBdKSwKICAgICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICAgIiB0dXJuZWQgaW50byAiICsKICAgICAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAgICAgY2hvb3NlKGFuaW1hbHMpLAogICAgICAgICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgICAgICAgInB1YmxpYyByZXN0cm9vbXMiLAogICAgICAgICAgICAgICAgICAgICAgICAiY2xvdWRzIiwKICAgICAgICAgICAgICAgICAgICAgICAgInBvbGl0aWNpYW5zIiwKICAgICAgICAgICAgICAgICAgICAgICAgIm1vdXN0YWNoZXMiLAogICAgICAgICAgICAgICAgICAgICAgICAiaGF0cyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJzaG9lcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJwYW50cyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJjbG93bnMiLAogICAgICAgICAgICAgICAgICAgICAgICAiZW5jeWNsb3BlZGlhcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWJzaXRlcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJwb3R0ZWQgcGxhbnRzIiwKICAgICAgICAgICAgICAgICAgICAgICAgImxlbW9ucyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJob3VzZWhvbGQgaXRlbXMiLAogICAgICAgICAgICAgICAgICAgICAgICAiYm9kaWx5IGZsdWlkcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJjdXRsZXJ5IiwKICAgICAgICAgICAgICAgICAgICAgICAgIm5hdGlvbmFsIGxhbmRtYXJrcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ5b2d1cnQiLAogICAgICAgICAgICAgICAgICAgICAgICAicmFwIG11c2ljIiwKICAgICAgICAgICAgICAgICAgICAgICAgInVuZGVyd2VhciIsCiAgICAgICAgICAgICAgICAgICAgICBdKSwKICAgICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICAgIiBpbiBmcmVhayBtYWdpYyBjYXRhc3Ryb3BoZSEiLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGhlYXZ5IGRpc3NlbnQgcmFnZXMgYmV0d2VlbiB0aGUgc2Nob29scyBvZiAiICsKICAgICAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAgICAgIndhdGVyIiwKICAgICAgICAgICAgICAgICAgICAgICJmaXJlIiwKICAgICAgICAgICAgICAgICAgICAgICJlYXJ0aCIsCiAgICAgICAgICAgICAgICAgICAgICAiYWlyIiwKICAgICAgICAgICAgICAgICAgICAgICJsaWdodG5pbmciLAogICAgICAgICAgICAgICAgICAgICAgImFjaWQiLAogICAgICAgICAgICAgICAgICAgICAgInNvbmciLAogICAgICAgICAgICAgICAgICAgICAgImJhdHRsZSIsCiAgICAgICAgICAgICAgICAgICAgICAicGVhY2UiLAogICAgICAgICAgICAgICAgICAgICAgInBlbmNpbCIsCiAgICAgICAgICAgICAgICAgICAgICAiaW50ZXJuZXQiLAogICAgICAgICAgICAgICAgICAgICAgInNwYWNlIiwKICAgICAgICAgICAgICAgICAgICAgICJ0aW1lIiwKICAgICAgICAgICAgICAgICAgICAgICJicmFpbiIsCiAgICAgICAgICAgICAgICAgICAgICAibmF0dXJlIiwKICAgICAgICAgICAgICAgICAgICAgICJ0ZWNobm8iLAogICAgICAgICAgICAgICAgICAgICAgInBsYW50IiwKICAgICAgICAgICAgICAgICAgICAgICJidWciLAogICAgICAgICAgICAgICAgICAgICAgImljZSIsCiAgICAgICAgICAgICAgICAgICAgICAicG9pc29uIiwKICAgICAgICAgICAgICAgICAgICAgICJjcmFiIiwKICAgICAgICAgICAgICAgICAgICAgICJraXR0ZW4iLAogICAgICAgICAgICAgICAgICAgICAgImRvbHBoaW4iLAogICAgICAgICAgICAgICAgICAgICAgImJpcmQiLAogICAgICAgICAgICAgICAgICAgICAgInB1bmNoIiwKICAgICAgICAgICAgICAgICAgICAgICJmYXJ0IiwKICAgICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICAgIiBtYWdpYyBhbmQgIiArCiAgICAgICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgICAgICJ3YXRlciIsCiAgICAgICAgICAgICAgICAgICAgICAiZmlyZSIsCiAgICAgICAgICAgICAgICAgICAgICAiZWFydGgiLAogICAgICAgICAgICAgICAgICAgICAgImFpciIsCiAgICAgICAgICAgICAgICAgICAgICAibGlnaHRuaW5nIiwKICAgICAgICAgICAgICAgICAgICAgICJhY2lkIiwKICAgICAgICAgICAgICAgICAgICAgICJzb25nIiwKICAgICAgICAgICAgICAgICAgICAgICJiYXR0bGUiLAogICAgICAgICAgICAgICAgICAgICAgInBlYWNlIiwKICAgICAgICAgICAgICAgICAgICAgICJwZW5jaWwiLAogICAgICAgICAgICAgICAgICAgICAgImludGVybmV0IiwKICAgICAgICAgICAgICAgICAgICAgICJzcGFjZSIsCiAgICAgICAgICAgICAgICAgICAgICAidGltZSIsCiAgICAgICAgICAgICAgICAgICAgICAiYnJhaW4iLAogICAgICAgICAgICAgICAgICAgICAgIm5hdHVyZSIsCiAgICAgICAgICAgICAgICAgICAgICAidGVjaG5vIiwKICAgICAgICAgICAgICAgICAgICAgICJwbGFudCIsCiAgICAgICAgICAgICAgICAgICAgICAiYnVnIiwKICAgICAgICAgICAgICAgICAgICAgICJpY2UiLAogICAgICAgICAgICAgICAgICAgICAgInBvaXNvbiIsCiAgICAgICAgICAgICAgICAgICAgICAiY3JhYiIsCiAgICAgICAgICAgICAgICAgICAgICAia2l0dGVuIiwKICAgICAgICAgICAgICAgICAgICAgICJkb2xwaGluIiwKICAgICAgICAgICAgICAgICAgICAgICJiaXJkIiwKICAgICAgICAgICAgICAgICAgICAgICJwdW5jaCIsCiAgICAgICAgICAgICAgICAgICAgICAiZmFydCIsCiAgICAgICAgICAgICAgICAgICAgXSkgKwogICAgICAgICAgICAgICAgICAgICIgbWFnaWMhIiwKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBnZXQgeW91ciBuZXcgY2hhcm1zIGFuZCBjdXJzZXMgYXQgdGhlIHllYXJseSBOYXRpb25hbCBTcGVsbGNyYWZ0aW5nIEZhaXIhIEV4Y2x1c2l2ZSBwcmljZXMgb24gcnVuZXMgYW5kIHNwZWxsYm9va3MuIiwKICAgICAgICAgICAgICAgICAgJ05ld3MgOiBjb29raWUgd2l6YXJkcyBkZW55IGludm9sdmVtZW50IGluIHNob2NraW5nbHkgdWdseSBuZXdib3JuIC0gaW5mYW50IGlzICJob25lc3RseSBncm9keS1sb29raW5nLCBidXQgbmF0dXJhbCIsIHNheSBkb2N0b3JzLicsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogIkFueSBzdWZmaWNpZW50bHkgY3J1ZGUgbWFnaWMgaXMgaW5kaXN0aW5ndWlzaGFibGUgZnJvbSB0ZWNobm9sb2d5IiwgY2xhaW1zIHJlbm93bmVkIHRlY2hub3dpemFyZC4nLAogICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siU2hpcG1lbnQiXS5hbW91bnQgPiAwKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICJOZXdzIDogbmV3IGNob2NvbGF0ZSBwbGFuZXQgZm91bmQsIGJlY29tZXMgdGFyZ2V0IG9mIGNvb2tpZS10cmFkaW5nIHNwYWNlc2hpcHMhIiwKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBtYXNzaXZlIGNob2NvbGF0ZSBwbGFuZXQgZm91bmQgd2l0aCA5OS44JSBjZXJ0aWZpZWQgcHVyZSBkYXJrIGNob2NvbGF0ZSBjb3JlISIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogc3BhY2UgdG91cmlzbSBib29taW5nIGFzIGRpc3RhbnQgcGxhbmV0cyBhdHRyYWN0IG1vcmUgYm9yZWQgbWlsbGlvbmFpcmVzISIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogY2hvY29sYXRlLWJhc2VkIG9yZ2FuaXNtcyBmb3VuZCBvbiBkaXN0YW50IHBsYW5ldCEiLAogICAgICAgICAgICAgICAgICAnTmV3cyA6IGFuY2llbnQgYmFraW5nIGFydGlmYWN0cyBmb3VuZCBvbiBkaXN0YW50IHBsYW5ldDsgInRlcnJpZnlpbmcgaW1wbGljYXRpb25zIiwgZXhwZXJ0cyBzYXkuJywKICAgICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIkFsY2hlbXkgbGFiIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAiTmV3cyA6IG5hdGlvbmFsIGdvbGQgcmVzZXJ2ZXMgZHdpbmRsZSBhcyBtb3JlIGFuZCBtb3JlIG9mIHRoZSBwcmVjaW91cyBtaW5lcmFsIGlzIHR1cm5lZCB0byBjb29raWVzISIsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogY2hvY29sYXRlIGpld2VscnkgZm91bmQgZmFzaGlvbmFibGUsIGdvbGQgYW5kIGRpYW1vbmRzICJqdXN0IGEgZmFkIiwgc2F5cyBzcGVjaWFsaXN0LicsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogc2lsdmVyIGZvdW5kIHRvIGFsc28gYmUgdHJhbnNtdXRhYmxlIGludG8gd2hpdGUgY2hvY29sYXRlISIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogZGVmZWN0aXZlIGFsY2hlbXkgbGFiIHNodXQgZG93biwgZm91bmQgdG8gY29udmVydCBjb29raWVzIHRvIHVzZWxlc3MgZ29sZC4iLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGFsY2hlbXktbWFkZSBjb29raWVzIHNodW5uZWQgYnkgcHVyaXN0cyEiLAogICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siUG9ydGFsIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAiTmV3cyA6IG5hdGlvbiB3b3JyaWVkIGFzIG1vcmUgYW5kIG1vcmUgdW5zZXR0bGluZyBjcmVhdHVyZXMgZW1lcmdlIGZyb20gZGltZW5zaW9uYWwgcG9ydGFscyEiLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGRpbWVuc2lvbmFsIHBvcnRhbHMgaW52b2x2ZWQgaW4gY2l0eS1lbmd1bGZpbmcgZGlzYXN0ZXIhIiwKICAgICAgICAgICAgICAgICAgIk5ld3MgOiB0b3VyaXNtIHRvIGNvb2tpZXZlcnNlIHBvcHVsYXIgd2l0aCBib3JlZCB0ZWVuYWdlcnMhIENhc3VhbHR5IHJhdGUgYXMgaGlnaCBhcyA3MyUhIiwKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBjb29raWV2ZXJzZSBwb3J0YWxzIHN1c3BlY3RlZCB0byBjYXVzZSBmYXN0IGFnaW5nIGFuZCBvYnNlc3Npb24gd2l0aCBiYWtpbmcsIHNheXMgc3R1ZHkuIiwKICAgICAgICAgICAgICAgICAgJ05ld3MgOiAiZG8gbm90IHNldHRsZSBuZWFyIHBvcnRhbHMsIiBzYXlzIHNwZWNpYWxpc3Q7ICJ5b3VyIGNoaWxkcmVuIHdpbGwgYmVjb21lIHN0cmFuZ2UgYW5kIGNvcnJ1cHRlZCBpbnNpZGUuIicsCiAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICk7CgogICAgICAgICAgICBpZiAoR2FtZS5PYmplY3RzWyJUaW1lIG1hY2hpbmUiXS5hbW91bnQgPiAwKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICJOZXdzIDogdGltZSBtYWNoaW5lcyBpbnZvbHZlZCBpbiBoaXN0b3J5LXJld3JpdGluZyBzY2FuZGFsISBPciBhcmUgdGhleT8iLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IHRpbWUgbWFjaGluZXMgdXNlZCBpbiB1bmxhd2Z1bCB0aW1lIHRvdXJpc20hIiwKICAgICAgICAgICAgICAgICAgJ05ld3MgOiBjb29raWVzIGJyb3VnaHQgYmFjayBmcm9tIHRoZSBwYXN0ICJ1bmZpdCBmb3IgaHVtYW4gY29uc3VtcHRpb24iLCBzYXlzIGhpc3Rvcmlhbi4nLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IHZhcmlvdXMgaGlzdG9yaWNhbCBmaWd1cmVzIGluZXhwbGljYWJseSByZXBsYWNlZCB3aXRoIHRhbGtpbmcgbHVtcHMgb2YgZG91Z2ghIiwKICAgICAgICAgICAgICAgICAgJ05ld3MgOiAiSSBoYXZlIHNlZW4gdGhlIGZ1dHVyZSwiIHNheXMgdGltZSBtYWNoaW5lIG9wZXJhdG9yLCAiYW5kIEkgZG8gbm90IHdpc2ggdG8gZ28gdGhlcmUgYWdhaW4uIicsCiAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICk7CgogICAgICAgICAgICBpZiAoR2FtZS5PYmplY3RzWyJBbnRpbWF0dGVyIGNvbmRlbnNlciJdLmFtb3VudCA+IDApCiAgICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgJ05ld3MgOiB3aG9sZSB0b3duIHNlZW1pbmdseSBzd2FsbG93ZWQgYnkgYW50aW1hdHRlci1pbmR1Y2VkIGJsYWNrIGhvbGU7IG1vcmUgcmVsaWFibGUgc291cmNlcyBhZmZpcm0gdG93biAibmV2ZXIgcmVhbGx5IGV4aXN0ZWQiIScsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogImV4cGxhaW4gdG8gbWUgYWdhaW4gd2h5IHdlIG5lZWQgcGFydGljbGUgYWNjZWxlcmF0b3JzIHRvIGJha2UgY29va2llcz8iIGFza3MgbWlzZ3VpZGVkIGxvY2FsIHdvbWFuLicsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogZmlyc3QgYW50aW1hdHRlciBjb25kZW5zZXIgc3VjY2Vzc2Z1bGx5IHR1cm5lZCBvbiwgZG9lc24ndCByaXAgYXBhcnQgcmVhbGl0eSEiLAogICAgICAgICAgICAgICAgICAnTmV3cyA6IHJlc2VhcmNoZXJzIGNvbmNsdWRlIHRoYXQgd2hhdCB0aGUgY29va2llIGluZHVzdHJ5IG5lZWRzLCBmaXJzdCBhbmQgZm9yZW1vc3QsIGlzICJtb3JlIG1hZ25ldHMiLicsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogInVucmF2ZWxsaW5nIHRoZSBmYWJyaWMgb2YgcmVhbGl0eSBqdXN0IG1ha2VzIHRoZXNlIGNvb2tpZXMgc28gbXVjaCB0YXN0aWVyIiwgY2xhaW1zIHNjaWVudGlzdC4nLAogICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siUHJpc20iXS5hbW91bnQgPiAwKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICJOZXdzIDogbmV3IGNvb2tpZS1wcm9kdWNpbmcgcHJpc21zIGxpbmtlZCB0byBvdXRicmVhayBvZiByYWluYm93LXJlbGF0ZWQgdmlyYWwgdmlkZW9zLiIsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogc2NpZW50aXN0cyB3YXJuIGFnYWluc3Qgc3lzdGVtYXRpY2FsbHkgdHVybmluZyBsaWdodCBpbnRvIG1hdHRlciAtICJPbmUgZGF5LCB3ZVwnbGwgZW5kIHVwIHdpdGggYWxsIG1hdHRlciBhbmQgbm8gbGlnaHQhIicsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogY29va2llcyBub3cgYmVpbmcgYmFrZWQgYXQgdGhlIGxpdGVyYWwgc3BlZWQgb2YgbGlnaHQgdGhhbmtzIHRvIG5ldyBwcmlzbWF0aWMgY29udHJhcHRpb25zLiIsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogIkNhblwndCB5b3Ugc2Vuc2UgdGhlIHByaXNtIHdhdGNoaW5nIHVzPyIsIHJhbWJsZXMgaW5zYW5lIGxvY2FsIG1hbi4gIk5vIGlkZWEgd2hhdCBoZVwncyB0YWxraW5nIGFib3V0Iiwgc2hydWdzIGNvb2tpZSBtYWduYXRlL2dvdmVybm1lbnQgb2ZmaWNpYWwuJywKICAgICAgICAgICAgICAgICAgJ05ld3MgOiB3b3JsZCBjaXRpemVucyBhZHZpc2VkICJub3QgdG8gd29ycnkiIGFib3V0IGZyZXF1ZW50IGF0bW9zcGhlcmljIGZsYXNoZXMuJywKICAgICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIkNoYW5jZW1ha2VyIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAiTmV3cyA6IHN0cmFuZ2Ugc3RhdGlzdGljYWwgYW5vbWFsaWVzIGNvbnRpbnVlIGFzIHdlYXRoZXIgZm9yZWNhc3QgcHJvdmVzIGFjY3VyYXRlIGFuIHVucHJlY2VkZW50ZWQgMyBkYXlzIGluIGEgcm93ISIsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogbG9jYWwgY2FzaW5vIHJ1aW5lZCBhcyBhbGwgZ2FtYmxlcnMgc29tZWhvdyBoaXQgYSB3ZWVrLWxvbmcgd2lubmluZyBzdHJlYWshICJXZSBtaWdodCBzdGlsbCBiZSBva2F5Iiwgc2F5cyBvd25lciBiZWZvcmUgYmVpbmcgaGl0IGJ5IGxpZ2h0bmluZyA0NyB0aW1lcy4nLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IG5laWdoYm9yaW5nIG5hdGlvbiBzb21laG93IGVsZWN0cyBwcmVzaWRlbnQgd2l0aCBzZW5zaWJsZSBwb2xpY2llcyBpbiBmcmVhayBhY2NpZGVudCBvZiByYW5kb20gY2hhbmNlISIsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogbWlsbGlvbi10by1vbmUgZXZlbnQgc2VlcyBncml0dHkgbW92aWUgcmVib290IHR1cm5pbmcgb3V0IGJldHRlciB0aGFuIHRoZSBvcmlnaW5hbCEgIldlIGhhdmUgbm8gaWRlYSBob3cgdGhpcyBoYXBwZW5lZCIsIHNheSBtb3ZpZSBleGVjcy4nLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGFsbCBzY3JhdGNoaW5nIHRpY2tldHMgcHJpbnRlZCBhcyB3aW5uZXJzLCBwcm9tcHRpbmcgbmF0aW9uYWwgZWNvbm9teSB0byBjcmFzaCBhbmQsIGFnYWluc3QgYWxsIG9kZHMsIHJlY292ZXIgb3Zlcm5pZ2h0LiIsCiAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICk7CgogICAgICAgICAgICBpZiAoR2FtZS5PYmplY3RzWyJGcmFjdGFsIGVuZ2luZSJdLmFtb3VudCA+IDApCiAgICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgJ05ld3MgOiBsb2NhbCBtYW4gImRvbmUgd2l0aCBDb29raWUgQ2xpY2tlciIsIGZpbmRzIHRoZSBjb25zdGFudCBzZWxmLXJlZmVyZW5jZXMgImdyYXRpbmcgYW5kIG9uLXRoZS1ub3NlIi4nLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGxvY2FsIG1hbiBzYWlscyBhcm91bmQgdGhlIHdvcmxkIHRvIGZpbmQgaGltc2VsZiAtIHJpZ2h0IHdoZXJlIGhlIGxlZnQgaXQuIiwKICAgICAgICAgICAgICAgICAgJ05ld3MgOiBsb2NhbCBndXJ1IGNsYWltcyAidGhlcmVcJ3MgYSBsaXR0bGUgYml0IG9mIG91cnNlbHZlcyBpbiBldmVyeW9uZSIsIHVuZGVyIGludmVzdGlnYXRpb24gZm9yIGFsbGVnZWQgY2FubmliYWxpc20uJywKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBuZXdzIHdyaXRlciBmaW5kcyBoZXJzZWxmIGRheWRyZWFtaW5nIGFib3V0IG5ldyBjYXJlZXIuIE9yIGF0IGxlYXN0IGEgcmFpc2UuIiwKICAgICAgICAgICAgICAgICAgJ05ld3MgOiBwb2xscyBmaW5kIGlkZWEgb2YgY29va2llcyBtYWRlIG9mIGNvb2tpZXMgImFjY2VwdGFibGUiIC0gImF0IGxlYXN0IHdlIGZpbmFsbHkga25vdyB3aGF0XCdzIGluIHRoZW0iLCBzYXlzIGludGVydmlld2VkIGNpdGl6ZW4uJywKICAgICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIkphdmFzY3JpcHQgY29uc29sZSJdLmFtb3VudCA+IDApCiAgICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBzdHJhbmdlIGZhZCBoYXMgcGFyZW50cyBnaXZpbmcgdGhlaXIgbmV3Ym9ybnMgbmFtZXMgc3VjaCBhcyBFbW1hLmpzIG9yIExpYW0uanMuIEF0IGxlYXN0IG9uZSBCYWJ5LmpzIHJlcG9ydGVkLiIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogY29kaW5nIGlzIGhpcCEgTW9yZSBhbmQgbW9yZSB0ZWVuYWdlcnMgdHVybiB0byB0ZWNobmljYWwgZmllbGRzIGxpa2UgcHJvZ3JhbW1pbmcsIGVuc3VyaW5nIGEgZnV0dXJlIHJvYm90IGFwb2NhbHlwc2UgYW5kIHRoZSBkb29tIG9mIGFsbCBtYW5raW5kLiIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogZGV2ZWxvcGVycyB1bnN1cmUgd2hhdCB0byBjYWxsIHRoZWlyIG5ldyBqYXZhc2NyaXB0IGxpYnJhcmllcyBhcyBhbGwgY29tYmluYXRpb25zIG9mIGFueSAzIGRpY3Rpb25hcnkgd29yZHMgaGF2ZSBhbHJlYWR5IGJlZW4gdGFrZW4uIiwKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBuYXRpb24gaG9sZHMgYnJlYXRoIGFzIG5lc3RlZCBpZnMgYWJvdXQgdG8gaGF0Y2guIiwKICAgICAgICAgICAgICAgICAgJ05ld3MgOiBjbHVlbGVzcyBjb3B5d3JpdGVyIGZvcmdldHMgdG8gZXNjYXBlIGEgcXVvdGUsIGVuZHMgbmV3cyBsaW5lIHByZW1hdHVyZWx5OyBsYXN0IHdvcmRzIHJlcG9ydGVkIHRvIGJlICJIdWgsIHdoeSBpc24nLAogICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siSWRsZXZlcnNlIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAiTmV3cyA6IGlzIGFub3RoZXIgeW91IGxpdmluZyBvdXQgdGhlaXIgZHJlYW1zIGluIGFuIGFsdGVybmF0ZSB1bml2ZXJzZT8gUHJvYmFibHksIHlvdSBsYXp5IGJ1bSEiLAogICAgICAgICAgICAgICAgICAnTmV3cyA6IHB1YmxpYyByZWNvaWxzIGF0IHRoZSBub3Rpb24gb2YgYSBjb3Ntb3MgbWFkZSBvZiBpbmZpbml0ZSBpZGxlIGdhbWVzLiAiSSBraW5kYSBob3BlZCB0aGVyZVwnZCBiZSBtb3JlIHRvIGl0Iiwgc2F5cyBkaXN0cmF1Z2h0IGNpdGl6ZW4uJywKICAgICAgICAgICAgICAgICAgJ05ld3MgOiB3aXRoIGFuIGluZmluaXR5IG9mIHBhcmFsbGVsIHVuaXZlcnNlcywgcGVvcGxlIHR1cm4gdG8gcmVhc3N1cmluZyBhbHRlcm5hdGUgZGltZW5zaW9ucywgd2hpY2ggb25seSBudW1iZXIgImluIHRoZSBoaWdoIDUwcyIuJywKICAgICAgICAgICAgICAgICAgJ05ld3MgOiAiSSBmaW5kIHNvbGFjZSBpbiB0aGUga25vd2xlZGdlIHRoYXQgYXQgbGVhc3Qgc29tZSBvZiBteSBhbHRlcm5hdGUgc2VsdmVzIGFyZSBwcm9iYWJseSBkb2luZyBmaW5lIG91dCB0aGVyZSIsIHNheXMgY2l0aXplblwncyBsYXN0IHJlbWFpbmluZyBleGVtcGxhciBpbiB0aGUgbXVsdGl2ZXJzZS4nLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGNvbWljIGJvb2sgd3JpdGVycyBwb2ludCB0byBhY3R1YWwgbXVsdGl2ZXJzZSBpbiBkZWZlbnNlIG9mIGR1YmlvdXMgcGxvdCBwb2ludHMuIFwiU2VlPyBJIHRvbGQgeW91IGl0IHdhc24ndCAnaGFja25leWVkIGFuZCBjb250cml2ZWQnIVwiIiwKICAgICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIkNvcnRleCBiYWtlciJdLmFtb3VudCA+IDApCiAgICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBjb3J0ZXggYmFrZXIgd3JhbmdsZXJzIGtpbmRseSByZW1pbmQgZW1wbG95ZWVzIHRoYXQgY29ydGV4IGJha2VycyBhcmUgdGhlIGJha2VyeSdzIG1hdGVyaWFsIHByb3BlcnR5IGFuZCBzaG91bGQgbm90IGJlIGVuZGVhcmVkIHdpdGggbmlja25hbWVzLiIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogc3BhY2UtZmFyaW5nIGVtcGxveWVlcyBhZHZpc2VkIHRvIGlnbm9yZSB1bnVzdWFsIHRob3VnaHRzIGFuZCB1cmdlcyBleHBlcmllbmNlZCB3aXRoaW4gMiBwYXJzZWNzIG9mIGdpZ2FudGljIGNvcnRleCBiYWtlcnMsIHNheSBndWlkZWxpbmVzLiIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogYXN0cm9ub21lcnMgd2FybiBvZiBjb3J0ZXggYmFrZXIgdHJhamVjdG9yeSBkcmlmdCwgZmVhciBmdXR1cmUgaGVhZC1vbiBjb2xsaXNpb25zIHJlc3VsdGluZyBpbiBjb3N0bHkgY29uY3Vzc2lvbnMuIiwKICAgICAgICAgICAgICAgICAgJ05ld3MgOiBydW50IGNvcnRleCBiYWtlciBpZGVudGlmaWVkIHdpdGggYW4gSVEgb2Ygb25seSBxdWludHVwbGUgZGlnaXRzOiAianVzdCBhIGJpdCBvZiBhIGR1bW15Iiwgc2F5IHNwZWNpYWxpc3RzLicsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogYXJlIHlvdSBzbWFydGVyIHRoYW4gYSBjb3J0ZXggYmFrZXI/IE5ldyBnYW1lIHNob3cgZGVlbWVkICJ1bmZhaXIiIGJ5IGNvbnRlc3RhbnRzLicsCiAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICk7CgogICAgICAgICAgICBpZiAoR2FtZS5zZWFzb24gPT0gImhhbGxvd2VlbiIgJiYgR2FtZS5jb29raWVzRWFybmVkID49IDEwMDApCiAgICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBzdHJhbmdlIHR3aXN0aW5nIGNyZWF0dXJlcyBhbWFzcyBhcm91bmQgY29va2llIGZhY3RvcmllcywgbmliYmxlIGF0IGFzc2VtYmx5IGxpbmVzLiIsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogb21pbm91cyB3cmlua2x5IG1vbnN0ZXJzIHRha2UgbWFzc2l2ZSBiaXRlcyBvdXQgb2YgY29va2llIHByb2R1Y3Rpb247ICJ0aGlzIGNhblwndCBiZSBoeWdpZW5pYyIsIHdvcnJpZXMgd29ya2VyLicsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogcGFnYW4gcml0dWFscyBvbiB0aGUgcmlzZSBhcyBjaGlsZHJlbiBhcm91bmQgdGhlIHdvcmxkIGRyZXNzIHVwIGluIHN0cmFuZ2UgY29zdHVtZXMgYW5kIGJsYWNrbWFpbCBob21lb3duZXJzIGZvciBjYW5keS4iLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IG5ldy1hZ2UgdGVycm9yaXNtIHN0cmlrZXMgc3VidXJicyBhcyBob3VzZXMgZmluZCB0aGVtc2VsdmVzIGNvdmVyZWQgaW4gZWdncyBhbmQgdG9pbGV0IHBhcGVyLiIsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogY2hpbGRyZW4gYXJvdW5kIHRoZSB3b3JsZCAibG9zdCBhbmQgY29uZnVzZWQiIGFzIGFueSBhbmQgYWxsIEhhbGxvd2VlbiB0cmVhdHMgaGF2ZSBiZWVuIHJlcGxhY2VkIGJ5IGNvb2tpZXMuJywKICAgICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmIChHYW1lLnNlYXNvbiA9PSAiY2hyaXN0bWFzIiAmJiBHYW1lLmNvb2tpZXNFYXJuZWQgPj0gMTAwMCkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAiTmV3cyA6IGJlYXJkZWQgbWFuaWFjIHNwb3R0ZWQgc3BlZWRpbmcgb24gZmx5aW5nIHNsZWlnaCEgSW52ZXN0aWdhdGlvbiBwZW5kaW5nLiIsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogU2FudGEgQ2xhdXMgYW5ub3VuY2VzIG5ldyBicmFuZCBvZiBicmVha2Zhc3QgdHJlYXRzIHRvIGNvbXBldGUgd2l0aCBjb29raWUtZmxhdm9yZWQgY2VyZWFscyEgIlRoZXlcJ3JlIGhvLWhvLWhvcnJpYmxlISIgc2F5cyBTYW50YS4nLAogICAgICAgICAgICAgICAgICAnTmV3cyA6ICJZb3UgbWVhbiBoZSBqdXN0IGdpdmVzIHN0dWZmIGF3YXkgZm9yIGZyZWU/ISIsIGNvbmNlcm5lZCBtb21zIGFzay4gIlBlcnNvbmFsbHksIEkgZG9uXCd0IHRydXN0IGhpcyBiZWFyZC4iJywKICAgICAgICAgICAgICAgICAgJ05ld3MgOiBvYmVzZSBqb2xseSBsdW5hdGljIHN0aWxsIG9uIHRoZSBsb29zZSwgd2FybiBvZmZpY2lhbHMuICJLZWVwIHlvdXIga2lkcyBzYWZlIGFuZCBib2FyZCB1cCB5b3VyIGNoaW1uZXlzLiBXZSBtZWFuIGl0LiInLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGNoaWxkcmVuIHNob2NrZWQgYXMgdGhleSBkaXNjb3ZlciBTYW50YSBDbGF1cyBpc24ndCBqdXN0IHRoZWlyIGRhZCBpbiBhIGNvc3R1bWUgYWZ0ZXIgYWxsITxicj5cIkknbSByZWFzc2Vzc2luZyBteSBsaWZlIHJpZ2h0IG5vd1wiLCBjb25maWRlcyBMYXVyYSwgYWdlZCA2LiIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogbXlzdGVyaW91cyBmZXN0aXZlIGVudGl0eSB3aXRoIHF1YW50dW0gcG93ZXJzIHN0aWxsIHdyZWNraW5nIGhhdm9jIHdpdGggYXJteSBvZiByZWluZGVlciwgb2ZmaWNpYWxzIHNheS4iLAogICAgICAgICAgICAgICAgICAnTmV3cyA6IGVsdmVzIG9uIHN0cmlrZSBhdCB0b3kgZmFjdG9yeSEgIldlIHdpbGwgbm90IGJlIGFjY2VwdGluZyByZWluZGVlciBjaG93IGFzIHBheW1lbnQgYW55bW9yZS4gQW5kIHN0b3AgY2FsbGluZyB1cyBlbHZlcyEiJywKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBlbHZlcyBwcm90ZXN0IGFyb3VuZCB0aGUgbmF0aW9uOyB3ZWUgbGl0dGxlIGZvbGtzIGluIHNpbGx5IGxpdHRsZSBvdXRmaXRzIHNwcmVhZCBtYXloZW0sIGRlc3RydWN0aW9uOyByYWJpZCByZWluZGVlciBydW5uaW5nIHJhbXBhbnQgdGhyb3VnaCBzdHJlZXRzLiIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogc2Nob2xhcnMgZGViYXRlIHJlZ2FyZGluZyB0aGUgcGx1cmFsIG9mIHJlaW5kZWVyKHMpIGluIHRoZSBtaWRzdCBvZiBlbHZlbiB3b3JsZCB3YXIuIiwKICAgICAgICAgICAgICAgICAgJ05ld3MgOiBlbHZlcyAidW5yZWxhdGVkIHRvIGdub21lcyBkZXNwaXRlIHNtYWxsIHN0YXR1cmUgYW5kIG1lcnJ5IGRpc3Bvc2l0aW9uIiwgZmluZCBzY2llbnRpc3RzLicsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogZWx2ZXMgc2Fib3RhZ2UgcmFkaW9hY3RpdmUgZnJvc3RpbmcgZmFjdG9yeSwgdHVybiBodW5kcmVkcyBibGluZCBpbiB2aWNpbml0eSAtICJXaG8gaW4gdGhlaXIgcmlnaHQgbWluZCB3b3VsZCBkbyBzdWNoIGEgdGhpbmc/IiBsYW1lbnRzIG91dHJhZ2VkIG1heW9yLicsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogZHJhbWEgdW5mb2xkcyBhdCBOb3J0aCBQb2xlIGFzIHJ1bW9ycyBjcm9wIHVwIGFyb3VuZCBSdWRvbHBoXCdzIHJlZCBub3NlOyAiSSBtYXkgaGF2ZSBhbiBhZGRpY3Rpb24gb3IgdHdvIiwgYWRtaXRzIHJlaW5kZWVyLicsCiAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICk7CgogICAgICAgICAgICBpZiAoR2FtZS5zZWFzb24gPT0gInZhbGVudGluZXMiICYmIEdhbWUuY29va2llc0Vhcm5lZCA+PSAxMDAwKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICJOZXdzIDogb3JnYW4tc2hhcGVkIGNvbmZlY3Rpb25lcmllcyBiZWluZyB0cmFkZWQgaW4gc2Nob29scyBhbGwgb3ZlciB0aGUgd29ybGQ7IGdydWVzb21lIHByYWN0aWNlIHVuZGVyZ29pbmcgaW52ZXN0aWdhdGlvbi4iLAogICAgICAgICAgICAgICAgICAnTmV3cyA6IGhlYXJ0LXNoYXBlZCBjYW5kaWVzIG92ZXJ0YWtpbmcgc3dlZXRzIGJ1c2luZXNzLCBvZmZlcmluZyBjb21wZXRpdGlvbiB0byBjb29raWUgZW1waXJlLiAiSXRcJ3MgdGhlIGVjb25vbXksIGN1cGlkISInLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGxvdmUncyBpbiB0aGUgYWlyLCBhY2NvcmRpbmcgdG8gd2VhdGhlciBzcGVjaWFsaXN0cy4gRmFjZSBtYXNrcyBub3cgb2ZmZXJlZCBpbiBldmVyeSBjaXR5IHRvIHN0dW50IGFpcmJvcm5lIGluZmVjdGlvbi4iLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IG1hcnJ5aW5nIGEgY29va2llIC0gZGVyYW5nZWQgcHJhY3RpY2UsIG9yIGdsaW1wc2Ugb2YgdGhlIGZ1dHVyZT8iLAogICAgICAgICAgICAgICAgICAnTmV3cyA6IGJveWZyaWVuZCBkdW1wZWQgYWZ0ZXIgb2ZmZXJpbmcgaGlzIGxvdmVyIGNvb2tpZXMgZm9yIFZhbGVudGluZVwncyBEYXksIHJlcG9ydHMgc2F5LiAiVGhleSB3ZXJlIG9mZi1icmFuZCIsIHNocnVncyBleC1naXJsZnJpZW5kLicsCiAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICk7CgogICAgICAgICAgICBpZiAoR2FtZS5zZWFzb24gPT0gImVhc3RlciIgJiYgR2FtZS5jb29raWVzRWFybmVkID49IDEwMDApCiAgICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBsb25nLWVhcmVkIGNyaXR0ZXJzIHdpdGggZnV6enkgdGFpbHMgaW52YWRlIHN1YnVyYnMsIHNwcmVhZCB0ZXJyb3IgYW5kIGNob2NvbGF0ZSEiLAogICAgICAgICAgICAgICAgICAnTmV3cyA6IGVnZ3MgaGF2ZSBiZWd1biB0byBtYXRlcmlhbGl6ZSBpbiB0aGUgbW9zdCB1bmV4cGVjdGVkIHBsYWNlczsgIm5vIHBsYWNlIGlzIHNhZmUiLCB3YXJuIGV4cGVydHMuJywKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBwYWNrcyBvZiByYW1wYWdpbmcgcmFiYml0cyBjYXVzZSBiaWxsaW9ucyBpbiBwcm9wZXJ0eSBkYW1hZ2U7IG5ldyBzdHJhaW4gb2YgbXl4b21hdG9zaXMgYmVpbmcgZGV2ZWxvcGVkLiIsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogZWdnLWxheWluZyByYWJiaXRzICJub3QgcXVpdGUgZnJvbSB0aGlzIGRpbWVuc2lvbiIsIHdhcm5zIGJpb2xvZ2lzdDsgYWR2aXNlcyBhZ2FpbnN0IHBldHRpbmcsIGZlZWRpbmcsIG9yIGNvb2tpbmcgdGhlIGNyZWF0dXJlcy4nLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IG15c3RlcmlvdXMgcmFiYml0cyBmb3VuZCB0byBiZSBlZ2ctbGF5ZXJzLCBidXQgbWFtbWFsaWFuLCBoaW50aW5nIGF0IHBvc3NpYmxlIHBsYXR5cHVzIGFuY2VzdHJ5LiIsCiAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICghRU4pIHsKICAgICAgICAgIGlmIChHYW1lLmNvb2tpZXNFYXJuZWQgPj0gMTAwMDApIHsKICAgICAgICAgICAgbGlzdC5wdXNoKE5FV1MgKyBjaG9vc2UobG9jKCJUaWNrZXIgKG1pc2MpIikpKTsKICAgICAgICAgICAgbGlzdC5wdXNoKE5FV1MgKyBjaG9vc2UobG9jKCJUaWNrZXIgKG1pc2MpIikpKTsKICAgICAgICAgICAgbGlzdC5wdXNoKE5FV1MgKyBjaG9vc2UobG9jKCJUaWNrZXIgKG1pc2MpIikpKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPCAwLjA1KSB7CiAgICAgICAgICAgIGlmIChHYW1lLkhhc0FjaGlldigiQmFzZSAxMCIpKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgICJOZXdzIDogY29va2llIG1hbnVmYWN0dXJlciBjb21wbGV0ZWx5IGZvcmdvZXMgY29tbW9uIHNlbnNlLCBsZXRzIHN0cmFuZ2Ugb2JzZXNzaW9uIHdpdGggcm91bmQgbnVtYmVycyBkcml2ZSBidWlsZGluZyBkZWNpc2lvbnMhIgogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmIChHYW1lLkhhc0FjaGlldigiRnJvbSBzY3JhdGNoIikpCiAgICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgICAgIk5ld3MgOiBmb2xsb3cgdGhlIHRlYXItamVya2luZywgcmljaGVzLXRvLXJhZ3Mgc3RvcnkgYWJvdXQgYSBsb2NhbCBjb29raWUgbWFudWZhY3R1cmVyIHdobyBkZWNpZGVkIHRvIGdpdmUgaXQgYWxsIHVwISIKICAgICAgICAgICAgICApOwogICAgICAgICAgICBpZiAoR2FtZS5IYXNBY2hpZXYoIkEgd29ybGQgZmlsbGVkIHdpdGggY29va2llcyIpKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgICJOZXdzIDoga25vd24gdW5pdmVyc2Ugbm93IGphbW1lZCB3aXRoIGNvb2tpZXMhIE5vIHZhY2FuY2llcyEiCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgaWYgKEdhbWUuSGFzQWNoaWV2KCJMYXN0IENoYW5jZSB0byBTZWUiKSkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICAiTmV3cyA6IGluY3JlZGlibHkgcmFyZSBhbGJpbm8gd3JpbmtsZXIgb24gdGhlIGJyaW5rIG9mIGV4dGluY3Rpb24gcG9hY2hlZCBieSBjb29raWUtY3JhemVkIHBhc3RyeSBtYWduYXRlISIKICAgICAgICAgICAgICApOwogICAgICAgICAgICBpZiAoR2FtZS5IYXMoIlNlcmVuZGlwaXR5IikpCiAgICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgICAgIk5ld3MgOiBsb2NhbCBjb29raWUgbWFudWZhY3R1cmVyIGJlY29tZXMgbHVja2llc3QgYmVpbmcgYWxpdmUhIgogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmIChHYW1lLkhhcygiU2Vhc29uIHN3aXRjaGVyIikpCiAgICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgICAgJ05ld3MgOiBzZWFzb25zIGFyZSBhbGwgb3V0IG9mIHdoYWNrISAiV2UgbmVlZCB0byBnZXQgc29tZSB3aGFjayBiYWNrIGludG8gdGhlbSBzZWFzb25zIiwgc2F5cyBsb2NhbCByZXNpZGVudC4nCiAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIGhlbHBlcnMiKSkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICAiTmV3cyA6IGZhaW50IG1lb3dpbmcgaGVhcmQgYXJvdW5kIGxvY2FsIGNvb2tpZSBmYWNpbGl0aWVzOyBzdWdnZXN0cyBuZXcgaW5ncmVkaWVudCBiZWluZyB0ZXN0ZWQuIgogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIHdvcmtlcnMiKSkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICAiTmV3cyA6IGNyb3dkcyBvZiBtZW93aW5nIGtpdHRlbnMgd2l0aCBsaXR0bGUgaGFyZCBoYXRzIHJlcG9ydGVkIG5lYXIgbG9jYWwgY29va2llIGZhY2lsaXRpZXMuIgogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIGVuZ2luZWVycyIpKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgICJOZXdzIDogc3Vycm91bmRpbmdzIG9mIGxvY2FsIGNvb2tpZSBmYWNpbGl0aWVzIG5vdyBvdmVycnVuIHdpdGgga2l0dGVucyBpbiBhZG9yYWJsZSBsaXR0bGUgc3VpdHMuIEF1dGhvcml0aWVzIGFkdmlzZSB0byBzdGF5IGF3YXkgZnJvbSB0aGUgcHJlbWlzZXMuIgogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIG92ZXJzZWVycyIpKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgICJOZXdzIDogbG9jYWxzIHJlcG9ydCB0cm91cGUgb2YgYm9zc3kga2l0dGVucyBtZW93aW5nIGFkb3JhYmxlIG9yZGVycyBhdCBwYXNzZXJzYnkuIgogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIG1hbmFnZXJzIikpCiAgICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgICAgJ05ld3MgOiBsb2NhbCBvZmZpY2UgY3ViaWNsZXMgaW52YWRlZCB3aXRoIGFybWllcyBvZiBzdGVybi1sb29raW5nIGtpdHRlbnMgYXNraW5nIGVtcGxveWVlcyAid2hhdFwncyBoYXBwZW5pbmcsIG1lb3ciLicKICAgICAgICAgICAgICApOwogICAgICAgICAgICBpZiAoR2FtZS5IYXMoIktpdHRlbiBhY2NvdW50YW50cyIpKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgICJOZXdzIDogdGlueSBmZWxpbmVzIHNob3cgc3VkZGVuIGFuZCBhbWF6aW5nIHByb2ZpY2llbmN5IHdpdGggZnV6enkgbWF0aGVtYXRpY3MgYW5kIHBhd2xpbm9taWFscywgYmFmZmxpbmcgc2NpZW50aXN0cyBhbmQgcGV0IHN0b3JlIG93bmVycy4iCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgaWYgKEdhbWUuSGFzKCJLaXR0ZW4gc3BlY2lhbGlzdHMiKSkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICAiTmV3cyA6IG5ldyBraXR0ZW4gY29sbGVnZSBvcGVuaW5nIG5leHQgd2Vlaywgb2ZmZXJzIGNvdXJzZXMgb24gY29va2llLW1ha2luZyBhbmQgY2F0bmlwIHN0dWRpZXMuIgogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIGV4cGVydHMiKSkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICAiTmV3cyA6IHVuZW1wbG95bWVudCByYXRlcyBzb2FyaW5nIGFzIHdvZWZ1bGx5IGFkb3JhYmxlIGxpdHRsZSBjYXRzIG5hYiBqb2JzIG9uIGFsbCBsZXZlbHMgb2YgZXhwZXJ0aXNlLCBzYXlzIHN0dWR5LiIKICAgICAgICAgICAgICApOwogICAgICAgICAgICBpZiAoR2FtZS5IYXMoIktpdHRlbiBjb25zdWx0YW50cyIpKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgICdOZXdzIDogIkluIHRoZSBmdXR1cmUsIHlvdXIgam9iIHdpbGwgbW9zdCBsaWtlbHkgYmUgZG9uZSBieSBhIGNhdCIsIHByZWRpY3RzIHN1c3BpY2lvdXNseSBmdXJyeSBmdXR1cm9sb2dpc3QuJwogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIGFzc2lzdGFudHMgdG8gdGhlIHJlZ2lvbmFsIG1hbmFnZXIiKSkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICAiTmV3cyA6IHN0cmFuZ2Uga2l0dGVucyB3aXRoIHBlY3VsaWFyIG9waW5pb25zIG9uIG1hcnRpYWwgYXJ0cyBzcG90dGVkIGxvaXRlcmluZyBvbiBsb2NhbCBiZWV0IGZhcm1zISIKICAgICAgICAgICAgICApOwogICAgICAgICAgICBpZiAoR2FtZS5IYXMoIktpdHRlbiBtYXJrZXRlZXJzIikpCiAgICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgICAgIk5ld3MgOiBub25zZW5zaWNhbCBraXR0ZW4gYmlsbGJvYXJkcyBjcm9wIHVwIGFsbCBvdmVyIGNvdW50cnlzaWRlLCB0cnlpbmcgdG8gc2VsbCBwZW9wbGUgdGhlIGNvb2tpZXMgdGhleSBhbHJlYWR5IGdldCBmb3IgZnJlZSEiCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgaWYgKEdhbWUuSGFzKCJLaXR0ZW4gYW5hbHlzdHMiKSkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICAiTmV3cyA6IGFyZSB5b3VyIHNwZW5kaW5nIGhhYml0cyBzZW5zaWJsZT8gRm9yIGEgaGVmdHkgZmVlLCB0aGVzZSBraXR0ZW4gYW5hbHlzdHMgd2lsbCB0ZWxsIHlvdSEiCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgaWYgKEdhbWUuSGFzKCJLaXR0ZW4gZXhlY3V0aXZlcyIpKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgICJOZXdzIDoga2l0dGVucyBzdHJ1dHRpbmcgYXJvdW5kIGluIGhvdCBsaXR0bGUgYnVzaW5lc3Mgc3VpdHMgc2hvdXRpbmcgY3V0LXRocm9hdCBvcmRlcnMgYXQgdGhlaXIgYXNzaXN0YW50cywgcG9zc2libHkgdGhlIGN1dGVzdCB0aGluZyB0aGlzIHJlcG9ydGVyIGhhcyBldmVyIHNlZW4hIgogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIGFkbWlucyIpKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgICJOZXdzIDogYWxsIHN5c3RlbXMgbm9taW5hbCwgY2xhaW0ga2l0dGVuIGFkbWlucyBvYnZpb3VzbHkgaW4gd2F5IG92ZXIgdGhlaXIgaGVhZHMuIgogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIGFuZ2VscyIpKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgICdOZXdzIDogIlRyeSB0byBpZ25vcmUgYW55IGdob3N0bHkgZmVsaW5lcyB0aGF0IG1heSBiZSBwdXJyaW5nIGluc2lkZSB5b3VyIGVhcnMsIiB3YXJuIHNjaWVudGlzdHMuICJUaGV5XCdsbCBqdXN0IGx1cmUgeW91IGludG8gbWFraW5nIHBvb3IgbGlmZSBjaG9pY2VzLiInCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgaWYgKEdhbWUuSGFzKCJLaXR0ZW4gd2FnZXMiKSkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICAiTmV3cyA6IGtpdHRlbnMgYnJlYWsgZ2xhc3MgY2VpbGluZyEgRG8gdGhleSBoYXZlIGFueSBpZGVhIGhvdyBleHBlbnNpdmUgdGhvc2UgYXJlISIKICAgICAgICAgICAgICApOwogICAgICAgICAgICBpZiAoR2FtZS5IYXNBY2hpZXYoIkplbGxpY2xlcyIpKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgICJOZXdzIDogbG9jYWwga2l0dGVucyBpbnZvbHZlZCBpbiBtaXNndWlkZWQgbXVzaWNhbCBwcm9kdWN0aW9uLCBsZWF2ZSBhdWRpZW5jZSBwZXJ0dXJiZWQgYW5kIHVubmVydmVkLiIKICAgICAgICAgICAgICApOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChHYW1lLkhhc0FjaGlldigiRHVkZSwgc3dlZXQiKSAmJiBNYXRoLnJhbmRvbSgpIDwgMC4yKQogICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICJOZXdzIDogbWFqb3Igc3VnYXItc211Z2dsaW5nIHJpbmcgZGlzbWFudGxlZCBieSBhdXRob3JpdGllczsgIiArCiAgICAgICAgICAgICAgICAgIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDMwICsgMykgKwogICAgICAgICAgICAgICAgICAiIHRvbnMgb2Ygc3VnYXIgbHVtcHMgc2VpemVkLCAiICsKICAgICAgICAgICAgICAgICAgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNDggKyAyKSArCiAgICAgICAgICAgICAgICAgICIgc3VzcGVjdHMgYXBwcmVoZW5kZWQuIiwKICAgICAgICAgICAgICAgICJOZXdzIDogYXV0aG9yaXRpZXMgd2FybiB0b3VyaXN0cyBub3QgdG8gYnV5IGJvb3RsZWcgc3VnYXIgbHVtcHMgZnJvbSBzdHJlZXQgcGVkZGxlcnMgLSBcIllvdSB0aGluayB5b3UncmUgZ2V0dGluZyBhIHN3ZWV0IGRlYWwsIGJ1dCB3aGF0IHlvdSdyZSBiZWluZyBzb2xkIGlzIHJlYWxseSBqdXN0IG9yZGluYXJ5IGNvY2FpbmVcIiwgc2F5cyBhZ2VudC4iLAogICAgICAgICAgICAgICAgIk5ld3MgOiBwcm8tZGlhYmV0ZXMgbW92ZW1lbnQgcHJvdGVzdHMgYWdhaW5zdCBzdWdhci1zaGFtaW5nLiBcIkkndmUgZWF0ZW4gbm90aGluZyBidXQgc3VnYXIgbHVtcHMgZm9yIHRoZSBwYXN0ICIgKwogICAgICAgICAgICAgICAgICBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCArIDQpICsKICAgICAgICAgICAgICAgICAgIiB5ZWFycyBhbmQgSSdtIGZlZWxpbmcgZ3JlYXQhXCIsIHNheXMgd29tYW4gd2l0aCBmcmlhYmxlIHNraW4uIiwKICAgICAgICAgICAgICAgICJOZXdzIDogZXhwZXJ0cyBpbiBiaXR0ZXIgZGlzYWdyZWVtZW50IG92ZXIgd2hldGhlciBzdWdhciBjb25zdW1wdGlvbiB0dXJucyBjaGlsZHJlbiBzbHVnZ2lzaCBvciBoeXBlcmFjdGl2ZS4iLAogICAgICAgICAgICAgICAgIk5ld3MgOiBmaXNoZXJtZW4gZGVwbG9yZSB1cHR1cm4gaW4gZmlzaCB0b290aCBkZWNheSBhcyBzdWdhciBsdW1wcy1oYXVsaW5nIGNhcmdvIHNpbmtzIGludG8gdGhlIG9jZWFuLiIsCiAgICAgICAgICAgICAgICAiTmV3cyA6IHJhcmUgYmxhY2sgc3VnYXIgbHVtcCB0aGF0IGNhcHRpdmF0ZWQgbWlsbGlvbnMgaW4gdW5wcmVjZWRlbnRlZCBhdWN0aW9uIHJldmVhbGVkIHRvIGJlIGNvbW1vbiB0b3hpYyBmdW5ndXMuIiwKICAgICAgICAgICAgICAgICdOZXdzIDogIkJhY2sgaW4gbXkgZGF5LCBzdWdhciBsdW1wcyB3ZXJlIHRoZXNlIGxpdHRsZSBjdWJlcyB5b3VcJ2QgcHV0IGluIHlvdXIgdGVhLCBub3QgdGhvc2UgZmlzdC1zaXplZCBtb25zdHJvc2l0aWVzIHBlb3BsZSBlYXQgZm9yIGx1bmNoIiwgd2hpbmVzIGN1cm11ZGdlb24gd2l0aCBmYWlsaW5nIG1lbW9yeS4nLAogICAgICAgICAgICAgICAgIk5ld3MgOiBzdWdhciBsdW1wLXNuYWNraW5nIGZhZCBzd2VlcHMgdGhlIG5hdGlvbjsgZGVudGlzdHMgZXZlcnl3aGVyZSByZWpvaWNlLiIsCiAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgKTsKCiAgICAgICAgICBpZiAoTWF0aC5yYW5kb20oKSA8IDAuMDAxKSB7CiAgICAgICAgICAgIC8vYXBvbG9naWVzIHRvIFdpbGwgV3JpZ2h0CiAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAiWW91IGhhdmUgYmVlbiBjaG9zZW4uIFRoZXkgd2lsbCBjb21lIHNvb24uIiwKICAgICAgICAgICAgICAiVGhleSdyZSBjb21pbmcgc29vbi4gTWF5YmUgeW91IHNob3VsZCB0aGluayB0d2ljZSBhYm91dCBvcGVuaW5nIHRoZSBkb29yLiIsCiAgICAgICAgICAgICAgIlRoZSBlbmQgaXMgbmVhci4gTWFrZSBwcmVwYXJhdGlvbnMuIiwKICAgICAgICAgICAgICAiTmV3cyA6IGJyb2Njb2xpIHRvcHMgZm9yIG1vbXMsIGxhc3QgZm9yIGtpZHM7IGRhZHMgaW5kaWZmZXJlbnQuIiwKICAgICAgICAgICAgICAiTmV3cyA6IG1pZGRsZSBhZ2UgYSBob2F4LCBkZWNsYXJlcyBzdHVkeTsgdHVybnMgb3V0IHRvIGJlIGJhZCBwb3N0dXJlIGFmdGVyIGFsbC4iLAogICAgICAgICAgICAgICJOZXdzIDoga2l0dGllcyB3YW50IGFuc3dlcnMgaW4gcG9zc2libGUgS2l0dHkgS2liYmxlIHNob3J0YWdlLiIKICAgICAgICAgICAgKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoR2FtZS5jb29raWVzRWFybmVkID49IDEwMDAwKQogICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgIk5ld3MgOiAiICsKICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICJjb29raWVzIGZvdW5kIHRvICIgKwogICAgICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICAgICAiaW5jcmVhc2UgbGlmZXNwYW4iLAogICAgICAgICAgICAgICAgICAgICAgInNlbnNpYmx5IGluY3JlYXNlIGludGVsbGlnZW5jZSIsCiAgICAgICAgICAgICAgICAgICAgICAicmV2ZXJzZSBhZ2luZyIsCiAgICAgICAgICAgICAgICAgICAgICAiZGVjcmVhc2UgaGFpciBsb3NzIiwKICAgICAgICAgICAgICAgICAgICAgICJwcmV2ZW50IGFydGhyaXRpcyIsCiAgICAgICAgICAgICAgICAgICAgICAiY3VyZSBibGluZG5lc3MiLAogICAgICAgICAgICAgICAgICAgIF0pICsKICAgICAgICAgICAgICAgICAgICAiIGluICIgKwogICAgICAgICAgICAgICAgICAgIGNob29zZShhbmltYWxzKSArCiAgICAgICAgICAgICAgICAgICAgIiEiLAogICAgICAgICAgICAgICAgICAiY29va2llcyBmb3VuZCB0byBtYWtlICIgKwogICAgICAgICAgICAgICAgICAgIGNob29zZShhbmltYWxzKSArCiAgICAgICAgICAgICAgICAgICAgIiAiICsKICAgICAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAgICAgIm1vcmUgZG9jaWxlIiwKICAgICAgICAgICAgICAgICAgICAgICJtb3JlIGhhbmRzb21lIiwKICAgICAgICAgICAgICAgICAgICAgICJuaWNlciIsCiAgICAgICAgICAgICAgICAgICAgICAibGVzcyBodW5ncnkiLAogICAgICAgICAgICAgICAgICAgICAgIm1vcmUgcHJhZ21hdGljIiwKICAgICAgICAgICAgICAgICAgICAgICJ0YXN0aWVyIiwKICAgICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICAgIiEiLAogICAgICAgICAgICAgICAgICAiY29va2llcyB0ZXN0ZWQgb24gIiArCiAgICAgICAgICAgICAgICAgICAgY2hvb3NlKGFuaW1hbHMpICsKICAgICAgICAgICAgICAgICAgICAiLCBmb3VuZCB0byBoYXZlIG5vIGlsbCBlZmZlY3RzLiIsCiAgICAgICAgICAgICAgICAgICJjb29raWVzIHVuZXhwZWN0ZWRseSBwb3B1bGFyIGFtb25nICIgKyBjaG9vc2UoYW5pbWFscykgKyAiISIsCiAgICAgICAgICAgICAgICAgICJ1bnNpZ2h0bHkgbHVtcHMgZm91bmQgb24gIiArCiAgICAgICAgICAgICAgICAgICAgY2hvb3NlKGFuaW1hbHMpICsKICAgICAgICAgICAgICAgICAgICAnIG5lYXIgY29va2llIGZhY2lsaXR5OyAidGhleVwndmUgcHJldHR5IG11Y2ggYWx3YXlzIGxvb2tlZCBsaWtlIHRoYXQiLCBzYXkgYmlvbG9naXN0cy4nLAogICAgICAgICAgICAgICAgICAibmV3IHNwZWNpZXMgb2YgIiArCiAgICAgICAgICAgICAgICAgICAgY2hvb3NlKGFuaW1hbHMpICsKICAgICAgICAgICAgICAgICAgICAnIGRpc2NvdmVyZWQgaW4gZGlzdGFudCBjb3VudHJ5OyAieXVwLCB0YXN0ZXMgbGlrZSBjb29raWVzIiwgc2F5cyBiaW9sb2dpc3QuJywKICAgICAgICAgICAgICAgICAgImNvb2tpZXMgZ28gd2VsbCB3aXRoICIgKwogICAgICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAgICAgICAicm9hc3RlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ0b2FzdGVkIiwKICAgICAgICAgICAgICAgICAgICAgICAgImJvaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJzYXV0ZWVkIiwKICAgICAgICAgICAgICAgICAgICAgICAgIm1pbmNlZCIsCiAgICAgICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICAgICAgICIgIiArCiAgICAgICAgICAgICAgICAgICAgICAgIGNob29zZShhbmltYWxzKSwKICAgICAgICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICAgICAgICJzdXNoaSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJzb3VwIiwKICAgICAgICAgICAgICAgICAgICAgICAgImNhcnBhY2NpbyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJzdGVhayIsCiAgICAgICAgICAgICAgICAgICAgICAgICJudWdnZXRzIiwKICAgICAgICAgICAgICAgICAgICAgIF0pICsKICAgICAgICAgICAgICAgICAgICAgICAgIiBtYWRlIGZyb20gIiArCiAgICAgICAgICAgICAgICAgICAgICAgIGNob29zZShhbmltYWxzKSwKICAgICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICAgIiwgc2F5cyBjb250cm92ZXJzaWFsIGNoZWYuIiwKICAgICAgICAgICAgICAgICAgJyJkbyB5b3VyIGNvb2tpZXMgY29udGFpbiAnICsKICAgICAgICAgICAgICAgICAgICBjaG9vc2UoYW5pbWFscykgKwogICAgICAgICAgICAgICAgICAgICc/IiwgYXNrcyBQU0Egd2FybmluZyBhZ2FpbnN0IGNvdW50ZXJmZWl0IGNvb2tpZXMuJywKICAgICAgICAgICAgICAgICAgImRvY3RvcnMgcmVjb21tZW5kIHR3aWNlLWRhaWx5IGNvbnN1bXB0aW9uIG9mIGZyZXNoIGNvb2tpZXMuIiwKICAgICAgICAgICAgICAgICAgImRvY3RvcnMgd2FybiBhZ2FpbnN0IGNob2NvbGF0ZSBjaGlwLXNub3J0aW5nIHRlZW4gZmFkLiIsCiAgICAgICAgICAgICAgICAgICJkb2N0b3JzIGFkdmlzZSBhZ2FpbnN0IG5ldyBjb29raWUtZnJlZSBmYWQgZGlldC4iLAogICAgICAgICAgICAgICAgICAnZG9jdG9ycyB3YXJuIG1vdGhlcnMgYWJvdXQgdGhlIGRhbmdlcnMgb2YgImhvbWUtbWFkZSBjb29raWVzIi4nLAogICAgICAgICAgICAgICAgXSksCiAgICAgICAgICAgICAgJ05ld3MgOiAiJyArCiAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAiSSdtIGFsbCBhYm91dCBjb29raWVzIiwKICAgICAgICAgICAgICAgICAgIkkganVzdCBjYW4ndCBzdG9wIGVhdGluZyBjb29raWVzLiBJIHRoaW5rIEkgc2VyaW91c2x5IG5lZWQgaGVscCIsCiAgICAgICAgICAgICAgICAgICJJIGd1ZXNzIEkgaGF2ZSBhIGNvb2tpZSBwcm9ibGVtIiwKICAgICAgICAgICAgICAgICAgIkknbSBub3QgYWRkaWN0ZWQgdG8gY29va2llcy4gVGhhdCdzIGp1c3Qgc3BlY3VsYXRpb24gYnkgZmFucyB3aXRoIHRvbyBtdWNoIGZyZWUgdGltZSIsCiAgICAgICAgICAgICAgICAgICJteSB1cGNvbWluZyBhbGJ1bSBjb250YWlucyAzIHNvbmdzIGFib3V0IGNvb2tpZXMiLAogICAgICAgICAgICAgICAgICAiSSd2ZSBoYWQgZHJlYW1zIGFib3V0IGNvb2tpZXMgMyBuaWdodHMgaW4gYSByb3cgbm93LiBJJ20gYSBiaXQgd29ycmllZCBob25lc3RseSIsCiAgICAgICAgICAgICAgICAgICJhY2N1c2F0aW9ucyBvZiBjb29raWUgYWJ1c2UgYXJlIG9ubHkgdmlsZSBzbGFuZGVyIiwKICAgICAgICAgICAgICAgICAgImNvb2tpZXMgcmVhbGx5IGhlbHBlZCBtZSB3aGVuIEkgd2FzIGZlZWxpbmcgbG93IiwKICAgICAgICAgICAgICAgICAgImNvb2tpZXMgYXJlIHRoZSBzZWNyZXQgYmVoaW5kIG15IHBlcmZlY3Qgc2tpbiIsCiAgICAgICAgICAgICAgICAgICJjb29raWVzIGhlbHBlZCBtZSBzdGF5IHNhbmUgd2hpbGUgZmlsbWluZyBteSB1cGNvbWluZyBtb3ZpZSIsCiAgICAgICAgICAgICAgICAgICJjb29raWVzIGhlbHBlZCBtZSBzdGF5IHRoaW4gYW5kIGhlYWx0aHkiLAogICAgICAgICAgICAgICAgICAiSSdsbCBzYXkgb25lIHdvcmQsIGp1c3Qgb25lIDogY29va2llcyIsCiAgICAgICAgICAgICAgICAgICJhbHJpZ2h0LCBJJ2xsIHNheSBpdCAtIEkndmUgbmV2ZXIgZWF0ZW4gYSBzaW5nbGUgY29va2llIGluIG15IGxpZmUiLAogICAgICAgICAgICAgICAgXSkgKwogICAgICAgICAgICAgICAgJyIsIHJldmVhbHMgY2VsZWJyaXR5LicsCiAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICdOZXdzIDogc2NpZW50aXN0IHByZWRpY3RzIGltbWluZW50IGNvb2tpZS1yZWxhdGVkICJlbmQgb2YgdGhlIHdvcmxkIjsgYmVjb21lcyBqb2tlIGFtb25nIHBlZXJzLicsCiAgICAgICAgICAgICAgICAiTmV3cyA6IG1hbiByb2JzIGJhbmssIGJ1eXMgY29va2llcy4iLAogICAgICAgICAgICAgICAgIk5ld3MgOiBzY2llbnRpc3RzIGVzdGFibGlzaCB0aGF0IHRoZSBkZWFsIHdpdGggYWlybGluZSBmb29kIGlzLCBpbiBmYWN0LCBhIGNyaXRpY2FsIGxhY2sgb2YgY29va2llcy4iLAogICAgICAgICAgICAgICAgIk5ld3MgOiBodW5kcmVkcyBvZiB0b25zIG9mIGNvb2tpZXMgZHVtcGVkIGludG8gc3RhcnZpbmcgY291bnRyeSBmcm9tIGFpcnBsYW5lczsgdGhvdXNhbmRzIGRlYWQsIG5hdGlvbiBncmF0ZWZ1bC4iLAogICAgICAgICAgICAgICAgJ05ld3MgOiBuZXcgc3R1ZHkgc3VnZ2VzdHMgY29va2llcyBuZWl0aGVyIHNwZWVkIHVwIG5vciBzbG93IGRvd24gYWdpbmcsIGJ1dCBpbnN0ZWFkICJ0YWtlIHlvdSBpbiBhIGRpZmZlcmVudCBkaXJlY3Rpb24iLicsCiAgICAgICAgICAgICAgICAiTmV3cyA6IG92ZXJncm93biBjb29raWVzIGZvdW5kIGluIGZpc2hpbmcgbmV0cywgcmFpc2UgcXVlc3Rpb25zIGFib3V0IGhvcm1vbmUgYmFraW5nLiIsCiAgICAgICAgICAgICAgICAnTmV3cyA6ICJhbGwteW91LWNhbi1lYXQiIGNvb2tpZSByZXN0YXVyYW50IG9wZW5zIGluIGJpZyBjaXR5OyB3YWl0ZXJzIHRyYW1wbGVkIGluIG1pbnV0ZXMuJywKICAgICAgICAgICAgICAgICdOZXdzIDogbWFuIGRpZXMgaW4gY29va2llLWVhdGluZyBjb250ZXN0OyAiYSBsZXNzLXRoYW4taW1wcmVzc2l2ZSBwZXJmb3JtYW5jZSIsIHNheXMganVkZ2UuJywKICAgICAgICAgICAgICAgICdOZXdzIDogd2hhdCBtYWtlcyBjb29raWVzIHRhc3RlIHNvIHJpZ2h0PyAiUHJvYmFibHkgYWxsIHRoZSBbKioqKipdIHRoZXkgcHV0IGluIHRoZW0iLCBzYXlzIGFub255bW91cyB0aXBwZXIuJywKICAgICAgICAgICAgICAgICdOZXdzIDogbWFuIGZvdW5kIGFsbGVyZ2ljIHRvIGNvb2tpZXM7ICJ3aGF0IGEgd2VpcmRvIiwgc2F5cyBmYW1pbHkuJywKICAgICAgICAgICAgICAgICJOZXdzIDogZm9yZWlnbiBwb2xpdGljaWFuIGludm9sdmVkIGluIGNvb2tpZS1zbXVnZ2xpbmcgc2NhbmRhbC4iLAogICAgICAgICAgICAgICAgIk5ld3MgOiBjb29raWVzIG5vdyBtb3JlIHBvcHVsYXIgdGhhbiAiICsKICAgICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgICAiY291Z2ggZHJvcHMiLAogICAgICAgICAgICAgICAgICAgICJicm9jY29saSIsCiAgICAgICAgICAgICAgICAgICAgInNtb2tlZCBoZXJyaW5nIiwKICAgICAgICAgICAgICAgICAgICAiY2hlZXNlIiwKICAgICAgICAgICAgICAgICAgICAidmlkZW8gZ2FtZXMiLAogICAgICAgICAgICAgICAgICAgICJzdGFibGUgam9icyIsCiAgICAgICAgICAgICAgICAgICAgInJlbGF0aW9uc2hpcHMiLAogICAgICAgICAgICAgICAgICAgICJ0aW1lIHRyYXZlbCIsCiAgICAgICAgICAgICAgICAgICAgImNhdCB2aWRlb3MiLAogICAgICAgICAgICAgICAgICAgICJ0YW5nbyIsCiAgICAgICAgICAgICAgICAgICAgImZhc2hpb24iLAogICAgICAgICAgICAgICAgICAgICJ0ZWxldmlzaW9uIiwKICAgICAgICAgICAgICAgICAgICAibnVjbGVhciB3YXJmYXJlIiwKICAgICAgICAgICAgICAgICAgICAid2hhdGV2ZXIgaXQgaXMgd2UgYXRlIGJlZm9yZSIsCiAgICAgICAgICAgICAgICAgICAgInBvbGl0aWNzIiwKICAgICAgICAgICAgICAgICAgICAib3h5Z2VuIiwKICAgICAgICAgICAgICAgICAgICAibGFtcHMiLAogICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICIsIHNheXMgc3R1ZHkuIiwKICAgICAgICAgICAgICAgICJOZXdzIDogb2Jlc2l0eSBlcGlkZW1pYyBzdHJpa2VzIG5hdGlvbjsgZXhwZXJ0cyBibGFtZSAiICsKICAgICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgICAidHdlcmtpbmciLAogICAgICAgICAgICAgICAgICAgICJ0aGF0IGRhcm4gcmFwIG11c2ljIiwKICAgICAgICAgICAgICAgICAgICAidmlkZW8tZ2FtZXMiLAogICAgICAgICAgICAgICAgICAgICJsYWNrIG9mIGNvb2tpZXMiLAogICAgICAgICAgICAgICAgICAgICJteXN0ZXJpb3VzIGdob3N0bHkgZW50aXRpZXMiLAogICAgICAgICAgICAgICAgICAgICJhbGllbnMiLAogICAgICAgICAgICAgICAgICAgICJwYXJlbnRzIiwKICAgICAgICAgICAgICAgICAgICAic2Nob29scyIsCiAgICAgICAgICAgICAgICAgICAgImNvbWljLWJvb2tzIiwKICAgICAgICAgICAgICAgICAgICAiY29va2llLXNub3J0aW5nIGZhZCIsCiAgICAgICAgICAgICAgICAgIF0pICsKICAgICAgICAgICAgICAgICAgIi4iLAogICAgICAgICAgICAgICAgJ05ld3MgOiBjb29raWUgc2hvcnRhZ2Ugc3RyaWtlcyB0b3duLCBwZW9wbGUgZm9yY2VkIHRvIGVhdCBjdXBjYWtlczsgImp1c3Qgbm90IHRoZSBzYW1lIiwgY29uY2VkZXMgbWF5b3IuJywKICAgICAgICAgICAgICAgICdOZXdzIDogInlvdSBnb3R0YSBhZG1pdCwgYWxsIHRoaXMgY29va2llIHN0dWZmIGlzIGEgYml0IG9taW5vdXMiLCBzYXlzIGNvbmZ1c2VkIGlkaW90LicsCiAgICAgICAgICAgICAgICAvLydOZXdzIDogc2NpZW50aXN0cyBhZHZpc2UgZ2V0dGluZyB1c2VkIHRvIGNvb2tpZXMgc3VmZnVzaW5nIGV2ZXJ5IGFzcGVjdCBvZiBsaWZlOyAidGhpcyBpcyB0aGUgbmV3IG5vcm1hbCIsIGV4cGVydCBzYXlzLicsCiAgICAgICAgICAgICAgICAvLydOZXdzIDogZG9jdG9ycyBhZHZpc2UgYWdhaW5zdCB3ZWFyaW5nIGZhY2UgbWFza3Mgd2hlbiBnb2luZyBvdXRzaWRlLiAiWW91IG5ldmVyIGtub3cgd2hlbiB5b3UgbWlnaHQgbmVlZCBhIGNvb2tpZS4uLiBhIG1hc2sgd291bGQganVzdCBnZXQgaW4gdGhlIHdheS4iJywvL3RoZXNlIHdlcmUgd3JpdHRlbiBiYWNrIHdoZW4gY292aWQgaGFkbid0IHJlYWxseSBkb25lIG11Y2ggZGFtYWdlIHlldCBidXQgdGhleSBqdXN0IGZlZWwgaW4gcG9vciB0YXN0ZSBub3cKICAgICAgICAgICAgICAgICJOZXdzIDogaXMgdGhlcmUgbGlmZSBvbiBNYXJzPyBWYXJpb3VzIGNob2NvbGF0ZSBiYXIgbWFudWZhY3R1cmVycyBjdXJyZW50bHkgdW5kZXIgaW52ZXN0aWdhdGlvbiBmb3IgYmFjdGVyaWFsIGNvbnRhbWluYW50cy4iLAogICAgICAgICAgICAgICAgJ05ld3MgOiAic28gSSBndWVzcyB0aGF0XCdzIGEgdGhpbmcgbm93Iiwgc2NpZW50aXN0IGNvbW1lbnRzIG9uIGNvb2tpZSBwYXJ0aWNsZXMgbm93IHByZXNlbnQgaW4gdmlydHVhbGx5IGFsbCBzdGVlbCBtYW51ZmFjdHVyZWQgc2luY2UgY29va2llIHByb2R1Y3Rpb24gcmFtcGVkIHVwIHdvcmxkd2lkZS4nLAogICAgICAgICAgICAgICAgIk5ld3MgOiB0cmFjZSBhbW91bnRzIG9mIGNvb2tpZSBwYXJ0aWNsZXMgZGV0ZWN0ZWQgaW4gbW9zdCBsaXZpbmcgY3JlYXR1cmVzLCBzb21lIG9mIHdoaWNoIGFkYXB0aW5nIHRoZW0gYXMgcGFydCBvZiBuZXcgYW5kIGV4b3RpYyBtZXRhYm9saWMgcHJvY2Vzc2VzLiIsCiAgICAgICAgICAgICAgXSksCiAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICdOZXdzIDogbW92aWUgY2FuY2VsbGVkIGZyb20gbGFjayBvZiBhY3RvcnM7ICJldmVyeWJvZHlcJ3MgYXQgaG9tZSBlYXRpbmcgY29va2llcyIsIGxhbWVudHMgZGlyZWN0b3IuJywKICAgICAgICAgICAgICAgICJOZXdzIDogY29tZWRpYW4gZm9yY2VkIHRvIGNhbmNlbCBjb29raWUgcm91dGluZSBkdWUgdG8gdW5yZWxhdGVkIGluZGlnZXN0aW9uLiIsCiAgICAgICAgICAgICAgICAiTmV3cyA6IG5ldyBjb29raWUtYmFzZWQgcmVsaWdpb24gc3dlZXBzIHRoZSBuYXRpb24uIiwKICAgICAgICAgICAgICAgICJOZXdzIDogZm9zc2lsIHJlY29yZHMgc2hvdyBjb29raWUtYmFzZWQgb3JnYW5pc21zIHByZXZhbGVudCBkdXJpbmcgQ2FtYnJpYW4gZXhwbG9zaW9uLCBzY2llbnRpc3RzIHNheS4iLAogICAgICAgICAgICAgICAgJ05ld3MgOiBteXN0ZXJpb3VzIGlsbGVnYWwgY29va2llcyBzZWl6ZWQ7ICJ0YXN0ZXMgdGVycmlibGUiLCBzYXlzIHBvbGljZS4nLAogICAgICAgICAgICAgICAgJ05ld3MgOiBtYW4gZm91bmQgZGVhZCBhZnRlciBpbmdlc3RpbmcgY29va2llOyBpbnZlc3RpZ2F0b3JzIGZhdm9yICJtYWZpYSBzbml0Y2giIGh5cG90aGVzaXMuJywKICAgICAgICAgICAgICAgICdOZXdzIDogInRoZSB1bml2ZXJzZSBwcmV0dHkgbXVjaCBsb29wcyBvbiBpdHNlbGYsIiBzdWdnZXN0cyByZXNlYXJjaGVyOyAiaXRcJ3MgY29va2llcyBhbGwgdGhlIHdheSBkb3duLiInLAogICAgICAgICAgICAgICAgIk5ld3MgOiBtaW5vciBjb29raWUtcmVsYXRlZCBpbmNpZGVudCB0dXJucyB3aG9sZSB0b3duIHRvIGFzaGVzOyBuZWlnaGJvcmluZyBjaXRpZXMgYXNrZWQgdG8gY2hpcCBpbiBmb3IgcmVjb25zdHJ1Y3Rpb24uIiwKICAgICAgICAgICAgICAgICJOZXdzIDogaXMgb3VyIG1lZGlhIGNvbnRyb2xsZWQgYnkgdGhlIGNvb2tpZSBpbmR1c3RyeT8gVGhpcyBjb3VsZCB2ZXJ5IHdlbGwgYmUgdGhlIGNhc2UsIHNheXMgY3JhY2twb3QgY29uc3BpcmFjeSB0aGVvcmlzdC4iLAogICAgICAgICAgICAgICAgIk5ld3MgOiAiICsKICAgICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgICAnY29va2llLWZsYXZvcmVkIHBvcGNvcm4gcHJldHR5IGRhbW4gcG9wdWxhcjsgIndlIGtpbmRhIGV4cGVjdGVkIHRoYXQiLCBzYXkgc2NpZW50aXN0cy4nLAogICAgICAgICAgICAgICAgICAgICJjb29raWUtZmxhdm9yZWQgY2VyZWFscyBicmVhayBhbGwga25vd24gY2VyZWFsLXJlbGF0ZWQgcmVjb3JkcyIsCiAgICAgICAgICAgICAgICAgICAgImNvb2tpZXMgcG9wdWxhciBhbW9uZyBhbGwgYWdlIGdyb3VwcywgaW5jbHVkaW5nIGZldHVzZXMsIHNheXMgc3R1ZHkuIiwKICAgICAgICAgICAgICAgICAgICAiY29va2llLWZsYXZvcmVkIHBvcGNvcm4gc2FsZXMgZXhwbG9kZWQgZHVyaW5nIHNjcmVlbmluZyBvZiBHcmFuZG1vdGhlcnMgSUkgOiBUaGUgTW9pc3RlbmluZy4iLAogICAgICAgICAgICAgICAgICBdKSwKICAgICAgICAgICAgICAgICJOZXdzIDogYWxsLWNvb2tpZSByZXN0YXVyYW50IG9wZW5pbmcgZG93bnRvd24uIERpc2hlcyBzdWNoIGFzIGJyYWlzZWQgY29va2llcywgY29va2llIHRoZXJtaWRvciwgYW5kIGZvciBkZXNzZXJ0IDogY3JlcGVzLiIsCiAgICAgICAgICAgICAgICAnTmV3cyA6ICJPb2siLCBzYXlzIGludGVydmlld2VkIG9yYW5ndXRhbi4nLAogICAgICAgICAgICAgICAgIk5ld3MgOiBjb29raWVzIGNvdWxkIGJlIHRoZSBrZXkgdG8gIiArCiAgICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICAgImV0ZXJuYWwgbGlmZSIsCiAgICAgICAgICAgICAgICAgICAgImluZmluaXRlIHJpY2hlcyIsCiAgICAgICAgICAgICAgICAgICAgImV0ZXJuYWwgeW91dGgiLAogICAgICAgICAgICAgICAgICAgICJldGVybmFsIGJlYXV0eSIsCiAgICAgICAgICAgICAgICAgICAgImN1cmluZyBiYWxkbmVzcyIsCiAgICAgICAgICAgICAgICAgICAgIndvcmxkIHBlYWNlIiwKICAgICAgICAgICAgICAgICAgICAic29sdmluZyB3b3JsZCBodW5nZXIiLAogICAgICAgICAgICAgICAgICAgICJlbmRpbmcgYWxsIHdhcnMgd29ybGQtd2lkZSIsCiAgICAgICAgICAgICAgICAgICAgIm1ha2luZyBjb250YWN0IHdpdGggZXh0cmF0ZXJyZXN0cmlhbCBsaWZlIiwKICAgICAgICAgICAgICAgICAgICAibWluZC1yZWFkaW5nIiwKICAgICAgICAgICAgICAgICAgICAiYmV0dGVyIGxpdmluZyIsCiAgICAgICAgICAgICAgICAgICAgImJldHRlciBlYXRpbmciLAogICAgICAgICAgICAgICAgICAgICJtb3JlIGludGVyZXN0aW5nIFRWIHNob3dzIiwKICAgICAgICAgICAgICAgICAgICAiZmFzdGVyLXRoYW4tbGlnaHQgdHJhdmVsIiwKICAgICAgICAgICAgICAgICAgICAicXVhbnR1bSBiYWtpbmciLAogICAgICAgICAgICAgICAgICAgICJjaG9jb2xhdHkgZ29vZG5lc3MiLAogICAgICAgICAgICAgICAgICAgICJnb29kZXIgdGhvdWdodG5lc3MiLAogICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICIsIHNheSBzY2llbnRpc3RzLiIsCiAgICAgICAgICAgICAgICAiTmV3cyA6IGZsYXZvciB0ZXh0ICIgKwogICAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAgICJub3QgcGFydGljdWxhcmx5IGZsYXZvcmZ1bCIsCiAgICAgICAgICAgICAgICAgICAgImtpbmQgb2YgdW5zYXZvcnkiLAogICAgICAgICAgICAgICAgICAgICcicmF0aGVyIGJsYW5kIicsCiAgICAgICAgICAgICAgICAgICAgInByZXR0eSBzcGljeSBsYXRlbHkiLAogICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICIsIHN0dWR5IGZpbmRzLiIsCiAgICAgICAgICAgICAgXSksCiAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICdOZXdzIDogd2hhdCBkbyBnb2xkZW4gY29va2llcyB0YXN0ZSBsaWtlPyBTdHVkeSByZXZlYWxzIGEgZmxhdm9yICJzb21ld2hlcmUgYmV0d2VlbiBzcGVhcm1pbnQgYW5kIGxpcXVvcmljZSIuJywKICAgICAgICAgICAgICAgICdOZXdzIDogd2hhdCBkbyB3cmF0aCBjb29raWVzIHRhc3RlIGxpa2U/IFN0dWR5IHJldmVhbHMgYSBmbGF2b3IgInNvbWV3aGVyZSBiZXR3ZWVuIGJsb29kIHNhdXNhZ2UgYW5kIHNlYXdhdGVyIi4nLAogICAgICAgICAgICAgICAgIk5ld3MgOiAiICsKICAgICAgICAgICAgICAgICAgR2FtZS5iYWtlcnlOYW1lICsKICAgICAgICAgICAgICAgICAgJy1icmFuZCBjb29raWVzICInICsKICAgICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgICAibXVjaCBsZXNzIHNvZ2d5IiwKICAgICAgICAgICAgICAgICAgICAibXVjaCB0YXN0aWVyIiwKICAgICAgICAgICAgICAgICAgICAicmVsYXRpdmVseSBsZXNzIGNyYXBweSIsCiAgICAgICAgICAgICAgICAgICAgIm1hcmdpbmFsbHkgbGVzcyBhd2Z1bCIsCiAgICAgICAgICAgICAgICAgICAgImxlc3MgdG94aWMiLAogICAgICAgICAgICAgICAgICAgICJwb3NzaWJseSBtb3JlIGVkaWJsZSIsCiAgICAgICAgICAgICAgICAgICAgIm1vcmUgZmFzaGlvbmFibGUiLAogICAgICAgICAgICAgICAgICAgICJzbGlnaHRseSBuaWNlciIsCiAgICAgICAgICAgICAgICAgICAgInRyZW5kaWVyIiwKICAgICAgICAgICAgICAgICAgICAiYXJndWFibHkgaGVhbHRoaWVyIiwKICAgICAgICAgICAgICAgICAgICAib2JqZWN0aXZlbHkgYmV0dGVyIGNob2ljZSIsCiAgICAgICAgICAgICAgICAgICAgInNsaWdodGx5IGxlc3MgdGVycmlibGUiLAogICAgICAgICAgICAgICAgICAgICJkZWNpZGVkbHkgY29va2llciIsCiAgICAgICAgICAgICAgICAgICAgImEgdGFkIGNoZWFwZXIiLAogICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICcgdGhhbiBjb21wZXRpdG9ycyIsIHNheXMgY29uc3VtZXIgc3VydmV5LicsCiAgICAgICAgICAgICAgICAnTmV3cyA6ICInICsKICAgICAgICAgICAgICAgICAgR2FtZS5iYWtlcnlOYW1lICsKICAgICAgICAgICAgICAgICAgIlwiIHNldCB0byBiZSB0aGlzIHllYXIncyBtb3N0IHBvcHVsYXIgYmFieSBuYW1lLiIsCiAgICAgICAgICAgICAgICAiTmV3cyA6IG5ldyBwb3B1bGFyaXR5IHN1cnZleSBzYXlzICIgKwogICAgICAgICAgICAgICAgICBHYW1lLmJha2VyeU5hbWUgKwogICAgICAgICAgICAgICAgICAiJ3MgdGhlIHdvcmQgd2hlbiBpdCBjb21lcyB0byBjb29raWVzLiIsCiAgICAgICAgICAgICAgICAiTmV3cyA6IG1ham9yIGNpdHkgYmVpbmcgcmVuYW1lZCAiICsKICAgICAgICAgICAgICAgICAgR2FtZS5iYWtlcnlOYW1lICsKICAgICAgICAgICAgICAgICAgInZpbGxlIGFmdGVyIHdvcmxkLWZhbW91cyBjb29raWUgbWFudWZhY3R1cmVyLiIsCiAgICAgICAgICAgICAgICAiTmV3cyA6ICIgKwogICAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAgICJzdHJlZXQiLAogICAgICAgICAgICAgICAgICAgICJzY2hvb2wiLAogICAgICAgICAgICAgICAgICAgICJudXJzaW5nIGhvbWUiLAogICAgICAgICAgICAgICAgICAgICJzdGFkaXVtIiwKICAgICAgICAgICAgICAgICAgICAibmV3IGZhc3QgZm9vZCBjaGFpbiIsCiAgICAgICAgICAgICAgICAgICAgIm5ldyBwbGFuZXQiLAogICAgICAgICAgICAgICAgICAgICJuZXcgZGlzZWFzZSIsCiAgICAgICAgICAgICAgICAgICAgImZsZXNoLWVhdGluZyBiYWN0ZXJpYSIsCiAgICAgICAgICAgICAgICAgICAgImRlYWRseSB2aXJ1cyIsCiAgICAgICAgICAgICAgICAgICAgIm5ldyBzcGVjaWVzIG9mICIgKyBjaG9vc2UoYW5pbWFscyksCiAgICAgICAgICAgICAgICAgICAgIm5ldyBsYXciLAogICAgICAgICAgICAgICAgICAgICJiYWJ5IiwKICAgICAgICAgICAgICAgICAgICAicHJvZ3JhbW1pbmcgbGFuZ3VhZ2UiLAogICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICIgdG8gYmUgbmFtZWQgYWZ0ZXIgIiArCiAgICAgICAgICAgICAgICAgIEdhbWUuYmFrZXJ5TmFtZSArCiAgICAgICAgICAgICAgICAgICIsIHRoZSB3b3JsZC1mYW1vdXMgY29va2llIG1hbnVmYWN0dXJlci4iLAogICAgICAgICAgICAgICAgIk5ld3MgOiBkb24ndCBtaXNzIHRvbmlnaHQncyBiaW9waWMgb24gIiArCiAgICAgICAgICAgICAgICAgIEdhbWUuYmFrZXJ5TmFtZSArCiAgICAgICAgICAgICAgICAgICIncyBpcnJlc2lzdGlibGUgcmlzZSB0byBzdWNjZXNzISIsCiAgICAgICAgICAgICAgICAiTmV3cyA6IGRvbid0IG1pc3MgdG9uaWdodCdzIGludGVydmlldyBvZiAiICsKICAgICAgICAgICAgICAgICAgR2FtZS5iYWtlcnlOYW1lICsKICAgICAgICAgICAgICAgICAgIiBieSAiICsKICAgICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgICAiQmxvcHJhaCIsCiAgICAgICAgICAgICAgICAgICAgIkJsYXZpZCBCbGV0dGVybWFuIiwKICAgICAgICAgICAgICAgICAgICAiQmxpbW15IEJsaW1tZWwiLAogICAgICAgICAgICAgICAgICAgICJCbGVsbGVuIEJsZWdlbmVyZXMiLAogICAgICAgICAgICAgICAgICAgICJCbGltbXkgQmxhbGxvbiIsCiAgICAgICAgICAgICAgICAgICAgIkJsb25hbiBCbG8nQnJpZW4iLAogICAgICAgICAgICAgICAgICAgICJCbGF5IEJsZW5vIiwKICAgICAgICAgICAgICAgICAgICAiQmxvbiBCbGV3YXJ0IiwKICAgICAgICAgICAgICAgICAgICAiQmxldmVuIEJsb2xiZXJ0IiwKICAgICAgICAgICAgICAgICAgICAiTG9yZCBUb3hpa2hyb24gb2YgZGltZW5zaW9uIDctQjE5IiwKICAgICAgICAgICAgICAgICAgICBHYW1lLmJha2VyeU5hbWUgKyAiJ3Mgb3duIGV2aWwgY2xvbmUiLAogICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICIhIiwKICAgICAgICAgICAgICAgICdOZXdzIDogcGVvcGxlIGFsbCBvdmVyIHRoZSBpbnRlcm5ldCBzdGlsbCBzY3JhdGNoaW5nIHRoZWlyIGhlYWRzIG92ZXIgbm9uc2Vuc2ljYWwgcmVmZXJlbmNlIDogIk9rYXksIGJ1dCB3aHkgYW4gZWdnPyInLAogICAgICAgICAgICAgICAgJ05ld3MgOiB2aXJhbCB2aWRlbyAiVG9vIE1hbnkgQ29va2llcyIgY291bGQgYmUgImEgZ3JpbSBjb21tZW50YXJ5IG9uIHRoZSBpbXBlbmRpbmcgY3Jpc2lzIG91ciB3b3JsZCBpcyBhYm91dCB0byBmYWNlIiwgc2F5cyBmYW1vdXMgZWNvbm9taXN0LicsCiAgICAgICAgICAgICAgICAnTmV3cyA6ICJtZW1lcyBmcm9tIGxhc3QgeWVhciBzb21laG93IHN0aWxsIHJlbGV2YW50IiwgZGVwbG9yZSBleHBlcnRzLicsCiAgICAgICAgICAgICAgICAnTmV3cyA6IGNvb2tpZSBlbW9qaSBtb3N0IHBvcHVsYXIgYW1vbmcgdGVlbmFnZXJzLCBmYXIgYWhlYWQgb2YgImp1ZGdtZW50YWwgT0sgaGFuZCBzaWduIiBhbmQgInNoaWZ0eS1sb29raW5nIGRhcmsgbW9vbiIsIHNheXMgc3R1ZHkuJywKICAgICAgICAgICAgICBdKSwKICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgIk5ld3MgOiBiaXJ0aHMgb2Ygc3VzcGljaW91c2x5IGJhbGQgYmFiaWVzIG9uIHRoZSByaXNlOyBhbmNpZW50IGFsaWVuIGNhYmFsIGRlbmllcyBpbnZvbHZlbWVudC4iLAogICAgICAgICAgICAgICAgJ05ld3MgOiAiYXQgdGhpcyBwb2ludCwgY29va2llcyBwZXJtZWF0ZSB0aGUgZWNvbm9teSIsIHNheXMgZWNvbm9taXN0LiAiSWYgd2Ugc3RhcnQgZWF0aW5nIGFueXRoaW5nIGVsc2UsIHdlXCdyZSBhbGwgZGVhZC4iJywKICAgICAgICAgICAgICAgICJOZXdzIDogcHVuIGluIGhlYWRsaW5lIGluZnVyaWF0ZXMgdG93biwgY2F1c2VzIHJpb3QuIDIxIHdvdW5kZWQsIDUgZGVhZDsgbWF5b3Igc3RpbGwgbWlzc2luZy4iLAogICAgICAgICAgICAgICAgIk53cyA6IGt5IGJ0d24gVyBhbmQgUiBicm9rbiwgcGxhcyBzbmQgbncgdHlwd3JpdHIgQVNBUC4iLAogICAgICAgICAgICAgICAgJ05lZWVlZXdzIDogIm5lZWVldyBFRUVFRUUga2VlZWVleSB3b3JraW5nIGZpbmVlZWVlZWVlZSIsIHJlZWVwb3J0cyBnbGVlZWVlZWVlZnVsIGpvdXJuYWxpc3QuJywKICAgICAgICAgICAgICAgICJOZXdzIDogY29va2llcyBub3cgaWxsZWdhbCBpbiBzb21lIGJhY2t3YXJkcyBjb3VudHJ5IG5vYm9keSBjYXJlcyBhYm91dC4gUG9saXRpY2FsIHRlbnNpb25zIHJpc2luZzsgd2FyIHNvb24sIGhvcGVmdWxseS4iLAogICAgICAgICAgICAgICAgIk5ld3MgOiBpcmF0ZSByYWRpbyBob3N0IHJhbWJsZXMgYWJvdXQgcGl4ZWxhdGVkIGljb25zLiBcIk5vbmUgb2YgdGhlIGNvb2tpZXMgYXJlIGFsaWduZWQhIENhbid0IGFueW9uZSBlbHNlIHNlZSBpdD8gSSBmZWVsIGxpa2UgSSdtIHRha2luZyBjcmF6eSBwaWxscyFcIiIsCiAgICAgICAgICAgICAgICAiTmV3cyA6IG5hdGlvbiBjaGVlcnMgYXMgbGVnaXNsYXRvcnMgZmluYWxseSBvdXRsYXcgIiArCiAgICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICAgImNvb2tpZSBjcml0aWNpc20iLAogICAgICAgICAgICAgICAgICAgICJwbGF5aW5nIG90aGVyIGdhbWVzIHRoYW4gQ29va2llIENsaWNrZXIiLAogICAgICAgICAgICAgICAgICAgICJwaW5lYXBwbGUgb24gcGl6emEiLAogICAgICAgICAgICAgICAgICAgICJsYWNrIG9mIGNoZWVyZnVsbmVzcyIsCiAgICAgICAgICAgICAgICAgICAgIm1vc3F1aXRvZXMiLAogICAgICAgICAgICAgICAgICAgICJicm9jY29saSIsCiAgICAgICAgICAgICAgICAgICAgInRoZSBodW1hbiBzcGxlZW4iLAogICAgICAgICAgICAgICAgICAgICJiYWQgd2VhdGhlciIsCiAgICAgICAgICAgICAgICAgICAgImNsaWNrYmFpdCIsCiAgICAgICAgICAgICAgICAgICAgImRhYmJpbmciLAogICAgICAgICAgICAgICAgICAgICJ0aGUgaW50ZXJuZXQiLAogICAgICAgICAgICAgICAgICAgICJtZW1lcyIsCiAgICAgICAgICAgICAgICAgICAgIm1pbGxlbm5pYWxzIiwKICAgICAgICAgICAgICAgICAgXSkgKwogICAgICAgICAgICAgICAgICAiISIsCiAgICAgICAgICAgICAgICAiTmV3cyA6ICIgKwogICAgICAgICAgICAgICAgICBjaG9vc2UoWyJsb2NhbCIsICJhcmVhIl0pICsKICAgICAgICAgICAgICAgICAgIiAiICsKICAgICAgICAgICAgICAgICAgY2hvb3NlKFsibWFuIiwgIndvbWFuIl0pICsKICAgICAgICAgICAgICAgICAgJyBnb2VzIG9uIGpvdXJuZXkgb2YgaW50cm9zcGVjdGlvbiwgZmluZHMgY29va2llcyA6ICJJIGhvbmVzdGx5IGRvblwndCBrbm93IHdoYXQgSSB3YXMgZXhwZWN0aW5nLiInLAogICAgICAgICAgICAgICAgIk5ld3MgOiAiICsKICAgICAgICAgICAgICAgICAgY2hvb3NlKFsibWFuIiwgIndvbWFuIl0pICsKICAgICAgICAgICAgICAgICAgIiB3YWtlcyB1cCBmcm9tIGNvbWEsICIgKwogICAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAgICJ0cmllcyBjb29raWUgZm9yIHRoZSBmaXJzdCB0aW1lLCBkaWVzLiIsCiAgICAgICAgICAgICAgICAgICAgInJlZ3JldHMgaXQgaW5zdGFudGx5LiIsCiAgICAgICAgICAgICAgICAgICAgJ3dvbmRlcnMgIndoeSBldmVyeXRoaW5nIGlzIGNvb2tpZXMgbm93Ii4nLAogICAgICAgICAgICAgICAgICAgICdiYWJibGVzIGluY29oZXJlbnRseSBhYm91dCBzb21lIHN1cHBvc2VkICJub24tY29va2llIGZvb2QiIHdlIHVzZWQgdG8gZWF0LicsCiAgICAgICAgICAgICAgICAgICAgImNpdGVzIGNvb2tpZXMgYXMgbWFpbiBtb3RpdmF0b3IuIiwKICAgICAgICAgICAgICAgICAgICAiYXNrcyBmb3IgY29va2llcy4iLAogICAgICAgICAgICAgICAgICBdKSwKICAgICAgICAgICAgICAgICJOZXdzIDogcGV0ICIgKwogICAgICAgICAgICAgICAgICBjaG9vc2UoYW5pbWFscykgKwogICAgICAgICAgICAgICAgICAiLCBkYW5nZXJvdXMgZmFkIG9yIGp1aWN5IG5ldyBtYXJrZXQ/IiwKICAgICAgICAgICAgICAgICJOZXdzIDogcGVyc29uIHR5cGluZyB0aGVzZSB3b3VsZG4ndCBtaW5kIHNvbWVvbmUgZWxzZSBicmVha2luZyB0aGUgbmV3cyB0byBUSEVNLCBmb3IgYSBjaGFuZ2UuIiwKICAgICAgICAgICAgICAgICdOZXdzIDogImF2ZXJhZ2UgcGVyc29uIGJha2VzICcgKwogICAgICAgICAgICAgICAgICBCZWF1dGlmeShNYXRoLmNlaWwoR2FtZS5jb29raWVzRWFybmVkIC8gNzMwMDAwMDAwMCkpICsKICAgICAgICAgICAgICAgICAgIiBjb29raWUiICsKICAgICAgICAgICAgICAgICAgKE1hdGguY2VpbChHYW1lLmNvb2tpZXNFYXJuZWQgLyA3MzAwMDAwMDAwKSA9PSAxID8gIiIgOiAicyIpICsKICAgICAgICAgICAgICAgICAgJyBhIHllYXIiIGZhY3RvaWQgYWN0dWFsbHkganVzdCBzdGF0aXN0aWNhbCBlcnJvcjsgJyArCiAgICAgICAgICAgICAgICAgIEdhbWUuYmFrZXJ5TmFtZSArCiAgICAgICAgICAgICAgICAgICIsIHdobyBoYXMgcHJvZHVjZWQgIiArCiAgICAgICAgICAgICAgICAgIEJlYXV0aWZ5KEdhbWUuY29va2llc0Vhcm5lZCkgKwogICAgICAgICAgICAgICAgICAiIGNvb2tpZXMgaW4gdGhlaXIgbGlmZXRpbWUsIGlzIGFuIG91dGxpZXIgYW5kIHNob3VsZCBub3QgaGF2ZSBiZWVuIGNvdW50ZWQuIiwKICAgICAgICAgICAgICBdKQogICAgICAgICAgICApOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGxpc3QubGVuZ3RoID09IDApIHsKICAgICAgICBpZiAobG9yZVByb2dyZXNzIDw9IDApCiAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgIGxvYygKICAgICAgICAgICAgICAiWW91IGZlZWwgbGlrZSBtYWtpbmcgY29va2llcy4gQnV0IG5vYm9keSB3YW50cyB0byBlYXQgeW91ciBjb29raWVzLiIKICAgICAgICAgICAgKQogICAgICAgICAgKTsKICAgICAgICBlbHNlIGlmIChsb3JlUHJvZ3Jlc3MgPD0gMSkKICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICJZb3VyIGZpcnN0IGJhdGNoIGdvZXMgdG8gdGhlIHRyYXNoLiBUaGUgbmVpZ2hib3Job29kIHJhY2Nvb24gYmFyZWx5IHRvdWNoZXMgaXQuIgogICAgICAgICAgICApCiAgICAgICAgICApOwogICAgICAgIGVsc2UgaWYgKGxvcmVQcm9ncmVzcyA8PSAyKQogICAgICAgICAgbGlzdC5wdXNoKGxvYygiWW91ciBmYW1pbHkgYWNjZXB0cyB0byB0cnkgc29tZSBvZiB5b3VyIGNvb2tpZXMuIikpOwogICAgICAgIGVsc2UgaWYgKGxvcmVQcm9ncmVzcyA8PSAzKQogICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICBsb2MoIllvdXIgY29va2llcyBhcmUgcG9wdWxhciBpbiB0aGUgbmVpZ2hib3Job29kLiIpLAogICAgICAgICAgICBsb2MoIlBlb3BsZSBhcmUgc3RhcnRpbmcgdG8gdGFsayBhYm91dCB5b3VyIGNvb2tpZXMuIikKICAgICAgICAgICk7CiAgICAgICAgZWxzZSBpZiAobG9yZVByb2dyZXNzIDw9IDQpCiAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgIGxvYygiWW91ciBjb29raWVzIGFyZSB0YWxrZWQgYWJvdXQgZm9yIG1pbGVzIGFyb3VuZC4iKSwKICAgICAgICAgICAgbG9jKCJZb3VyIGNvb2tpZXMgYXJlIHJlbm93bmVkIGluIHRoZSB3aG9sZSB0b3duISIpCiAgICAgICAgICApOwogICAgICAgIGVsc2UgaWYgKGxvcmVQcm9ncmVzcyA8PSA1KQogICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICBsb2MoIllvdXIgY29va2llcyBicmluZyBhbGwgdGhlIGJveXMgdG8gdGhlIHlhcmQuIiksCiAgICAgICAgICAgIGxvYygiWW91ciBjb29raWVzIG5vdyBoYXZlIHRoZWlyIG93biB3ZWJzaXRlISIpCiAgICAgICAgICApOwogICAgICAgIGVsc2UgaWYgKGxvcmVQcm9ncmVzcyA8PSA2KQogICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICBsb2MoIllvdXIgY29va2llcyBhcmUgd29ydGggYSBsb3Qgb2YgbW9uZXkuIiksCiAgICAgICAgICAgIGxvYygiWW91ciBjb29raWVzIHNlbGwgdmVyeSB3ZWxsIGluIGRpc3RhbnQgY291bnRyaWVzLiIpCiAgICAgICAgICApOwogICAgICAgIGVsc2UgaWYgKGxvcmVQcm9ncmVzcyA8PSA3KQogICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgIlBlb3BsZSBjb21lIGZyb20gdmVyeSBmYXIgYXdheSB0byBnZXQgYSB0YXN0ZSBvZiB5b3VyIGNvb2tpZXMuIgogICAgICAgICAgICApLAogICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgIktpbmdzIGFuZCBxdWVlbnMgZnJvbSBhbGwgb3ZlciB0aGUgd29ybGQgYXJlIGVuam95aW5nIHlvdXIgY29va2llcy4iCiAgICAgICAgICAgICkKICAgICAgICAgICk7CiAgICAgICAgZWxzZSBpZiAobG9yZVByb2dyZXNzIDw9IDgpCiAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgIGxvYygiVGhlcmUgYXJlIG5vdyBtdXNldW1zIGRlZGljYXRlZCB0byB5b3VyIGNvb2tpZXMuIiksCiAgICAgICAgICAgIGxvYygiQSBuYXRpb25hbCBkYXkgaGFzIGJlZW4gY3JlYXRlZCBpbiBob25vciBvZiB5b3VyIGNvb2tpZXMuIikKICAgICAgICAgICk7CiAgICAgICAgZWxzZSBpZiAobG9yZVByb2dyZXNzIDw9IDkpCiAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgIGxvYygiWW91ciBjb29raWVzIGhhdmUgYmVlbiBuYW1lZCBhIHBhcnQgb2YgdGhlIHdvcmxkIHdvbmRlcnMuIiksCiAgICAgICAgICAgIGxvYygiSGlzdG9yeSBib29rcyBub3cgaW5jbHVkZSBhIHdob2xlIGNoYXB0ZXIgYWJvdXQgeW91ciBjb29raWVzLiIpCiAgICAgICAgICApOwogICAgICAgIGVsc2UgaWYgKGxvcmVQcm9ncmVzcyA8PSAxMCkKICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgbG9jKCJZb3VyIGNvb2tpZXMgaGF2ZSBiZWVuIHBsYWNlZCB1bmRlciBnb3Zlcm5tZW50IHN1cnZlaWxsYW5jZS4iKSwKICAgICAgICAgICAgbG9jKCJUaGUgd2hvbGUgcGxhbmV0IGlzIGVuam95aW5nIHlvdXIgY29va2llcyEiKQogICAgICAgICAgKTsKICAgICAgICBlbHNlIGlmIChsb3JlUHJvZ3Jlc3MgPD0gMTEpCiAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgIGxvYygKICAgICAgICAgICAgICAiU3RyYW5nZSBjcmVhdHVyZXMgZnJvbSBuZWlnaGJvcmluZyBwbGFuZXRzIHdpc2ggdG8gdHJ5IHlvdXIgY29va2llcy4iCiAgICAgICAgICAgICksCiAgICAgICAgICAgIGxvYygKICAgICAgICAgICAgICAiRWxkZXIgZ29kcyBmcm9tIHRoZSB3aG9sZSBjb3Ntb3MgaGF2ZSBhd29rZW4gdG8gdGFzdGUgeW91ciBjb29raWVzLiIKICAgICAgICAgICAgKQogICAgICAgICAgKTsKICAgICAgICBlbHNlIGlmIChsb3JlUHJvZ3Jlc3MgPD0gMTIpCiAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgIGxvYygKICAgICAgICAgICAgICAiQmVpbmdzIGZyb20gb3RoZXIgZGltZW5zaW9ucyBsYXBzZSBpbnRvIGV4aXN0ZW5jZSBqdXN0IHRvIGdldCBhIHRhc3RlIG9mIHlvdXIgY29va2llcy4iCiAgICAgICAgICAgICksCiAgICAgICAgICAgIGxvYygiWW91ciBjb29raWVzIGhhdmUgYWNoaWV2ZWQgc2VudGllbmNlLiIpCiAgICAgICAgICApOwogICAgICAgIGVsc2UgaWYgKGxvcmVQcm9ncmVzcyA8PSAxMykKICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICJUaGUgdW5pdmVyc2UgaGFzIG5vdyB0dXJuZWQgaW50byBjb29raWUgZG91Z2gsIHRvIHRoZSBtb2xlY3VsYXIgbGV2ZWwuIgogICAgICAgICAgICApLAogICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgIllvdXIgY29va2llcyBhcmUgcmV3cml0aW5nIHRoZSBmdW5kYW1lbnRhbCBsYXdzIG9mIHRoZSB1bml2ZXJzZS4iCiAgICAgICAgICAgICkKICAgICAgICAgICk7CiAgICAgICAgZWxzZSBpZiAobG9yZVByb2dyZXNzIDw9IDE0KQogICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgIkEgbG9jYWwgbmV3cyBzdGF0aW9uIHJ1bnMgYSAxMC1taW51dGUgc2VnbWVudCBhYm91dCB5b3VyIGNvb2tpZXMuIFN1Y2Nlc3MhPGJyPjxzbWFsbD4oeW91IHdpbiBhIGNvb2tpZSk8L3NtYWxsPiIKICAgICAgICAgICAgKSwKICAgICAgICAgICAgbG9jKCJpdCdzIHRpbWUgdG8gc3RvcCBwbGF5aW5nIikKICAgICAgICAgICk7CiAgICAgIH0KCiAgICAgIC8vaWYgKEdhbWUuZWxkZXJXcmF0aD4wICYmIChHYW1lLnBsZWRnZXM9PTAgfHwgTWF0aC5yYW5kb20oKTwwLjIpKQogICAgICBpZiAoCiAgICAgICAgR2FtZS5lbGRlcldyYXRoID4gMCAmJgogICAgICAgICgoR2FtZS5wbGVkZ2VzID09IDAgJiYgR2FtZS5yZXNldHMgPT0gMCAmJiBNYXRoLnJhbmRvbSgpIDwgMC4zKSB8fAogICAgICAgICAgTWF0aC5yYW5kb20oKSA8IDAuMDMpCiAgICAgICkgewogICAgICAgIGxpc3QgPSBbXTsKICAgICAgICBpZiAoR2FtZS5lbGRlcldyYXRoID09IDEpCiAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgIEVOCiAgICAgICAgICAgICAgPyBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAiTmV3cyA6IG1pbGxpb25zIG9mIG9sZCBsYWRpZXMgcmVwb3J0ZWQgbWlzc2luZyEiLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IHByb2Nlc3Npb25zIG9mIG9sZCBsYWRpZXMgc2lnaHRlZCBhcm91bmQgY29va2llIGZhY2lsaXRpZXMhIiwKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBmYW1pbGllcyBhcm91bmQgdGhlIGNvbnRpbmVudCByZXBvcnQgYWdpdGF0ZWQsIHRyYW5zZml4ZWQgZ3JhbmRtb3RoZXJzISIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogZG9jdG9ycyBzd2FybWVkIGJ5IGNhc2VzIG9mIG9sZCB3b21lbiB3aXRoIGdsYXNzeSBleWVzIGFuZCBhIGZvYW15IG1vdXRoISIsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogbnVyc2VzIHJlcG9ydCAic3RyYW5nZSBzY2VudCBvZiBjb29raWUgZG91Z2giIGFyb3VuZCBmZW1hbGUgZWxkZXJseSBwYXRpZW50cyEnLAogICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICA6IE5FV1MgKyBjaG9vc2UobG9jKCJUaWNrZXIgKGdyYW5kbWEgaW52YXNpb24gc3RhcnQpIikpCiAgICAgICAgICApOwogICAgICAgIGlmIChHYW1lLmVsZGVyV3JhdGggPT0gMikKICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgRU4KICAgICAgICAgICAgICA/IGNob29zZShbCiAgICAgICAgICAgICAgICAgICJOZXdzIDogdG93biBpbiBkaXNhcnJheSBhcyBzdHJhbmdlIG9sZCBsYWRpZXMgYnJlYWsgaW50byBob21lcyB0byBhYmR1Y3QgaW5mYW50cyBhbmQgYmFraW5nIHV0ZW5zaWxzISIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogc2lnaHRpbmdzIG9mIG9sZCBsYWRpZXMgd2l0aCBnbG93aW5nIGV5ZXMgdGVycmlmeSBsb2NhbCBwb3B1bGF0aW9uISIsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogcmV0aXJlbWVudCBob21lcyByZXBvcnQgImZlbWFsZSByZXNpZGVudHMgc2xvd2x5IGNvbmdlYWxpbmcgaW4gdGhlaXIgc2VhdHMiIScsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogd2hvbGUgY29udGluZW50IHVuZGVyZ29pbmcgbWFzcyBleG9kdXMgb2Ygb2xkIGxhZGllcyEiLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IG9sZCB3b21lbiBmcmVlemUgaW4gcGxhY2UgaW4gc3RyZWV0cywgb296ZSB3YXJtIHN1Z2FyeSBzeXJ1cCEiLAogICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICA6IE5FV1MgKyBjaG9vc2UobG9jKCJUaWNrZXIgKGdyYW5kbWEgaW52YXNpb24gcmlzZSkiKSkKICAgICAgICAgICk7CiAgICAgICAgaWYgKEdhbWUuZWxkZXJXcmF0aCA9PSAzKQogICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICBFTgogICAgICAgICAgICAgID8gY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgJ05ld3MgOiBsYXJnZSAiZmxlc2ggaGlnaHdheXMiIHNjYXIgY29udGluZW50LCBzdHJldGNoIGJldHdlZW4gdmFyaW91cyBjb29raWUgZmFjaWxpdGllcyEnLAogICAgICAgICAgICAgICAgICAnTmV3cyA6IHdyaW5rbGVkICJmbGVzaCB0ZW5kcmlscyIgdmlzaWJsZSBmcm9tIHNwYWNlIScsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogcmVtYWlucyBvZiAib2xkIGxhZGllcyIgZm91bmQgZnJvemVuIGluIHRoZSBtaWRkbGUgb2YgZ3Jvd2luZyBmbGVzaHkgc3RydWN0dXJlcyEnLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGFsbCBob3BlIGxvc3QgYXMgd3JpdGhpbmcgbWFzcyBvZiBmbGVzaCBhbmQgZG91Z2ggZW5ndWxmcyB3aG9sZSBjaXR5ISIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogbmlnaHRtYXJlIGNvbnRpbnVlcyBhcyB3cmlua2xlZCBhY3JlcyBvZiBmbGVzaCBleHBhbmQgYXQgYWxhcm1pbmcgc3BlZWRzISIsCiAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgIDogTkVXUyArIGNob29zZShsb2MoIlRpY2tlciAoZ3JhbmRtYSBpbnZhc2lvbiBmdWxsKSIpKQogICAgICAgICAgKTsKICAgICAgfQoKICAgICAgaWYgKEVOICYmIEdhbWUuc2Vhc29uID09ICJmb29scyIpIHsKICAgICAgICBsaXN0ID0gW107CgogICAgICAgIGlmIChHYW1lLmNvb2tpZXNFYXJuZWQgPj0gMTAwMCkKICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgIllvdXIgb2ZmaWNlIGNoYWlyIGlzIHJlYWxseSBjb21mb3J0YWJsZS4iLAogICAgICAgICAgICAgICAgIlByb2ZpdCdzIGluIHRoZSBhaXIhIiwKICAgICAgICAgICAgICAgICJCdXNpbmVzcyBtZWV0aW5ncyBhcmUgc3VjaCBhIGpveSEiLAogICAgICAgICAgICAgICAgIldoYXQgYSBncmVhdCB2aWV3IGZyb20geW91ciBvZmZpY2UhIiwKICAgICAgICAgICAgICAgICJTbWVsbCB0aGF0PyBUaGF0J3MgY2FwaXRhbGlzbSwgYmFieSEiLAogICAgICAgICAgICAgICAgIllvdSB0cnVseSBsb3ZlIGFuc3dlcmluZyBlbWFpbHMuIiwKICAgICAgICAgICAgICAgICJXb3JraW5nIGhhcmQsIG9yIGhhcmRseSB3b3JraW5nPyIsCiAgICAgICAgICAgICAgICAiQW5vdGhlciBkYXkgaW4gcGFyYWRpc2UhIiwKICAgICAgICAgICAgICAgICJFeHBlbnNpdmUgbHVuY2ggdGltZSEiLAogICAgICAgICAgICAgICAgIkFub3RoZXIgZ292ZXJubWVudCBiYWlsb3V0IGNvbWluZyB1cCEgU3BsZW5kaWQhIiwKICAgICAgICAgICAgICAgICJUaGVzZSBwcm9maXRzIGFyZSBkb2luZyB3b25kZXJmdWwgdGhpbmdzIGZvciB5b3VyIHNraW4uIiwKICAgICAgICAgICAgICAgICJZb3UgZGF5ZHJlYW0gZm9yIGEgbW9tZW50IGFib3V0IGEgd29ybGQgd2l0aG91dCB0YXhlcy4iLAogICAgICAgICAgICAgICAgIllvdSdsbCB3b3JyeSBhYm91dCBlbnZpcm9ubWVudGFsIGRhbWFnZSB3aGVuIHlvdSdyZSBkZWFkISIsCiAgICAgICAgICAgICAgICAiWWF5LCBvZmZpY2Ugc3VwcGxpZXMhIiwKICAgICAgICAgICAgICAgICJTd2VldCwgdGhvc2UgbmV3IHN0YXBsZXJzIGp1c3QgY2FtZSBpbiEiLAogICAgICAgICAgICAgICAgIk9oaCwgY29mZmVlIGJyZWFrISIsCiAgICAgICAgICAgICAgXSksCiAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICJZb3UndmUgc3BlbnQgdGhlIHdob2xlIGRheSIsCiAgICAgICAgICAgICAgICAiQW5vdGhlciBncmVhdCBkYXkiLAogICAgICAgICAgICAgICAgIkZpcnN0IG9yZGVyIG9mIGJ1c2luZXNzIHRvZGF5OiIsCiAgICAgICAgICAgICAgICAiV2h5LCB5b3UgdHJ1bHkgZW5qb3kiLAogICAgICAgICAgICAgICAgIldoYXQgbmV4dD8gVGhhdCdzIHJpZ2h0LCIsCiAgICAgICAgICAgICAgICAiWW91IGNoZWNrIHdoYXQncyBuZXh0IG9uIHRoZSBhZ2VuZGEuIE9oIGJveSwiLAogICAgICAgICAgICAgIF0pICsKICAgICAgICAgICAgICAgICIgIiArCiAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAic2lnbmluZyBjb250cmFjdHMiLAogICAgICAgICAgICAgICAgICAiZmlsbGluZyBvdXQgZm9ybXMiLAogICAgICAgICAgICAgICAgICAidG91Y2hpbmcgYmFzZSB3aXRoIHRoZSB0ZWFtIiwKICAgICAgICAgICAgICAgICAgImV4YW1pbmluZyBleGNpdGluZyBuZXcgcHJvc3BlY3RzIiwKICAgICAgICAgICAgICAgICAgInBsYXlpbmcgd2l0aCB5b3VyIGRlc2sgdG95cyIsCiAgICAgICAgICAgICAgICAgICJnZXR0aW5nIG5ldyBuYW1lcGxhdGVzIGRvbmUiLAogICAgICAgICAgICAgICAgICAiYXR0ZW5kaW5nIHNlbWluYXJzIiwKICAgICAgICAgICAgICAgICAgInZpZGVvY29uZmVyZW5jaW5nIiwKICAgICAgICAgICAgICAgICAgImhpcmluZyBkeW5hbWljIHlvdW5nIGV4ZWN1dGl2ZXMiLAogICAgICAgICAgICAgICAgICAibWVldGluZyBuZXcgaW52ZXN0b3JzIiwKICAgICAgICAgICAgICAgICAgInVwZGF0aW5nIHlvdXIgcm9sb2RleCIsCiAgICAgICAgICAgICAgICAgICJwdW1waW5nIHVwIHRob3NlIG51bWJlcnMiLAogICAgICAgICAgICAgICAgICAicHVuY2hpbmcgaW4gc29tZSBudW1iZXJzIiwKICAgICAgICAgICAgICAgICAgImdldHRpbmcgaW52ZXN0aWdhdGVkIGZvciB3b3JrZXJzJyByaWdodHMgdmlvbGF0aW9ucyIsCiAgICAgICAgICAgICAgICAgICJyZW9yZ2FuaXppbmcgZG9jdW1lbnRzIiwKICAgICAgICAgICAgICAgICAgImJlbGl0dGxpbmcgdW5kZXJsaW5ncyIsCiAgICAgICAgICAgICAgICAgICJyZXZpZXdpbmcgZW1wbG95ZWUgcGVyZm9ybWFuY2UiLAogICAgICAgICAgICAgICAgICAicmV2aXNpbmcgY29tcGFueSBwb2xpY2llcyIsCiAgICAgICAgICAgICAgICAgICJkb3duc2l6aW5nIiwKICAgICAgICAgICAgICAgICAgInB1bGxpbmcgeW91cnNlbGYgdXAgYnkgeW91ciBib290c3RyYXBzIiwKICAgICAgICAgICAgICAgICAgImFkanVzdGluZyB5b3VyIHRpZSIsCiAgICAgICAgICAgICAgICAgICJwZXJmb3JtaW5nIHRvdGFsbHkgbm9ybWFsIGh1bWFuIGFjdGl2aXRpZXMiLAogICAgICAgICAgICAgICAgICAicmVjZW50ZXJpbmcgeW91cnNlbGYgaW4gdGhlIHNjcmVhbSByb29tIiwKICAgICAgICAgICAgICAgICAgImltbWFuZW50aXppbmcgdGhlIGVzY2hhdG9uIiwKICAgICAgICAgICAgICAgICAgInNocmVkZGluZyBzb21lIHNlbnNpdGl2ZSBkb2N1bWVudHMiLAogICAgICAgICAgICAgICAgICAiY29tcGFyaW5nIGJ1c2luZXNzIGNhcmRzIiwKICAgICAgICAgICAgICAgICAgInBvbmRlcmluZyB0aGUgbWVhbmluZyBvZiB5b3VyIGV4aXN0ZW5jZSIsCiAgICAgICAgICAgICAgICAgICJsaXN0ZW5pbmcgdG8gdGhlIHJvYXJpbmcgZW1wdGluZXNzIGluc2lkZSB5b3VyIHNvdWwiLAogICAgICAgICAgICAgICAgICAicGxheWluZyBtaW5pZ29sZiBpbiB5b3VyIG9mZmljZSIsCiAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAiISIsCiAgICAgICAgICAgICAgIlRoZSB3b3JkIG9mIHRoZSBkYXkgaXM6ICIgKwogICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgInZpcmFsIiwKICAgICAgICAgICAgICAgICAgInNlYXJjaCBlbmdpbmUgb3B0aW1pemF0aW9uIiwKICAgICAgICAgICAgICAgICAgImJsYWdzIGFuZCB3b2JzaXRlcyIsCiAgICAgICAgICAgICAgICAgICJzb2NpYWwgbmV0d29ya3MiLAogICAgICAgICAgICAgICAgICAid2ViaW5ldHRlIiwKICAgICAgICAgICAgICAgICAgInN0YXljYXRpb24iLAogICAgICAgICAgICAgICAgICAidXNlciBleHBlcmllbmNlIiwKICAgICAgICAgICAgICAgICAgImNyb3dkZnVuZGluZyIsCiAgICAgICAgICAgICAgICAgICJjYXJib24gbmV1dHJhbCIsCiAgICAgICAgICAgICAgICAgICJiaWcgZGF0YSIsCiAgICAgICAgICAgICAgICAgICJtYWNoaW5lIGxlYXJuaW5nIiwKICAgICAgICAgICAgICAgICAgImRpc3J1cHRpbmciLAogICAgICAgICAgICAgICAgICAiaW5mbHVlbmNlcnMiLAogICAgICAgICAgICAgICAgICAibW9ub2NvbnNlbnN1YWwgdHJhbnNhY3Rpb25zIiwKICAgICAgICAgICAgICAgICAgInN1c3RhaW5hYmxlIiwKICAgICAgICAgICAgICAgICAgImZyZWVtaXVtIiwKICAgICAgICAgICAgICAgICAgImluY2VudGl2ZXMiLAogICAgICAgICAgICAgICAgICAiZ3Jhc3Nyb290cyIsCiAgICAgICAgICAgICAgICAgICJ3ZWIgMy4wIiAvKnRoaXMgd2FzIGJlZm9yZSB0aGlzIHdob2xlIGNyeXB0byBtZXNzIGknbSBzbyBzb3JyeSovLAogICAgICAgICAgICAgICAgICAibG9naXN0aWNzIiwKICAgICAgICAgICAgICAgICAgImxldmVyYWdpbmciLAogICAgICAgICAgICAgICAgICAiYnJhbmRpbmciLAogICAgICAgICAgICAgICAgICAicHJvYWN0aXZlIiwKICAgICAgICAgICAgICAgICAgInN5bmVyZ2l6aW5nIiwKICAgICAgICAgICAgICAgICAgIm1hcmtldCByZXNlYXJjaCIsCiAgICAgICAgICAgICAgICAgICJkZW1vZ3JhcGhpY3MiLAogICAgICAgICAgICAgICAgICAicGllIGNoYXJ0cyIsCiAgICAgICAgICAgICAgICAgICJibG9ndWxhciIsCiAgICAgICAgICAgICAgICAgICJibG9ndWxhY2lvdXMiLAogICAgICAgICAgICAgICAgICAiYmxvZ2FzdGljIiwKICAgICAgICAgICAgICAgICAgImF1dGhlbnRpY2l0eSIsCiAgICAgICAgICAgICAgICAgICJwbGFzdGljcyIsCiAgICAgICAgICAgICAgICAgICJlbGVjdHJvbmljIG1haWwiLAogICAgICAgICAgICAgICAgICAiY2VsbHVsYXIgcGhvbmVzIiwKICAgICAgICAgICAgICAgICAgInJhcCBtdXNpYyIsCiAgICAgICAgICAgICAgICAgICJidWxicyIsCiAgICAgICAgICAgICAgICAgICJnb2JsaW5pemF0aW9uIiwKICAgICAgICAgICAgICAgICAgInN0cmFpZ2h0LXRvLWJha2VyeSIsCiAgICAgICAgICAgICAgICAgICJtaWNyb2Jha2VyaWVzIiwKICAgICAgICAgICAgICAgICAgImNob2NvbGF0aXZpdHkiLAogICAgICAgICAgICAgICAgICAiZmxhdm9yZnVsbmVzcyIsCiAgICAgICAgICAgICAgICAgICJ0YXN0eWZpY2F0aW9uIiwKICAgICAgICAgICAgICAgICAgInN1Z2FyIG9mZnNldHMiLAogICAgICAgICAgICAgICAgICAiYWN0aXZhdGVkIHdoZWF0IiwKICAgICAgICAgICAgICAgICAgInJlaWZpY2F0aW9uIiwKICAgICAgICAgICAgICAgICAgImltbWFuZW50aXplIHRoZSBlc2NoYXRvbiIsCiAgICAgICAgICAgICAgICAgICJjb29raWVzLCBJIGd1ZXNzIiwKICAgICAgICAgICAgICAgIF0pICsKICAgICAgICAgICAgICAgICIuIiwKICAgICAgICAgICAgXSkKICAgICAgICAgICk7CiAgICAgICAgaWYgKEdhbWUuY29va2llc0Vhcm5lZCA+PSAxMDAwICYmIE1hdGgucmFuZG9tKCkgPCAwLjA1KQogICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICJJZiB5b3UgY291bGQgZ2V0IHNvbWUgbW9yZSBjb29raWVzIGJha2VkLCB0aGF0J2QgYmUgZ3JlYXQuIiwKICAgICAgICAgICAgICAiU28uIEFib3V0IHRob3NlIFRQUyByZXBvcnRzLiIsCiAgICAgICAgICAgICAgIkhtbSwgeW91J3ZlIGdvdCBzb21lIHZpZGVvIHRhcGVzIHRvIHJldHVybi4iLAogICAgICAgICAgICAgICJUaGV5J2xsIHBheS4gVGhleSdsbCBhbGwgcGF5LiIsCiAgICAgICAgICAgICAgIllvdSBoYXZlbid0IGV2ZW4gYmVndW4gdG8gcGVhay4iLAogICAgICAgICAgICAgICJUaGVyZSBpcyBhbiBpZGVhIG9mIGEgIiArCiAgICAgICAgICAgICAgICBHYW1lLmJha2VyeU5hbWUgKwogICAgICAgICAgICAgICAgIi4gU29tZSBraW5kIG9mIGFic3RyYWN0aW9uLiBCdXQgdGhlcmUgaXMgbm8gcmVhbCB5b3UsIG9ubHkgYW4gZW50aXR5LiBTb21ldGhpbmcgaWxsdXNvcnkuIiwKICAgICAgICAgICAgICAiVGhpcyB3YXMgYSB0ZXJyaWJsZSBpZGVhISIsCiAgICAgICAgICAgIF0pCiAgICAgICAgICApOwoKICAgICAgICBpZiAoR2FtZS5UaWNrZXJOICUgMiA9PSAwKSB7CiAgICAgICAgICBpZiAoR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAiWW91ciByb2xsaW5nIHBpbnMgYXJlIHJvbGxpbmcgYW5kIHBpbm5pbmchIiwKICAgICAgICAgICAgICAgICJQcm9kdWN0aW9uIGlzIHN0ZWFkeSEiLAogICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICk7CgogICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLmFtb3VudCA+IDApCiAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgIllvdXIgb3ZlbnMgYXJlIGRpbGlnZW50bHkgYmFraW5nIG1vcmUgYW5kIG1vcmUgY29va2llcy4iLAogICAgICAgICAgICAgICAgIllvdXIgb3ZlbnMgYnVybiBhIHdob2xlIGJhdGNoLiBBaCB3ZWxsISBTdGlsbCBnb29kLiIsCiAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgKTsKCiAgICAgICAgICBpZiAoR2FtZS5PYmplY3RzWyJGYXJtIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAiU2NvcmVzIG9mIGNvb2tpZXMgY29tZSBvdXQgb2YgeW91ciBraXRjaGVucy4iLAogICAgICAgICAgICAgICAgIlRvZGF5LCBuZXcgcmVjcnVpdHMgYXJlIGpvaW5pbmcgeW91ciBraXRjaGVucyEiLAogICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICk7CgogICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siRmFjdG9yeSJdLmFtb3VudCA+IDApCiAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgIllvdXIgZmFjdG9yaWVzIGFyZSBwcm9kdWNpbmcgYW4gdW5lbmRpbmcgc3RyZWFtIG9mIGJha2VkIGdvb2RzLiIsCiAgICAgICAgICAgICAgICAiWW91ciBmYWN0b3J5IHdvcmtlcnMgZGVjaWRlIHRvIGdvIG9uIHN0cmlrZSEiLAogICAgICAgICAgICAgICAgIkl0J3Mgc2FmZXR5IGluc3BlY3Rpb24gZGF5IGluIHlvdXIgZmFjdG9yaWVzLiIsCiAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgKTsKCiAgICAgICAgICBpZiAoR2FtZS5PYmplY3RzWyJNaW5lIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAiWW91ciBzZWNyZXQgcmVjaXBlcyBhcmUga2VwdCBzYWZlbHkgaW5zaWRlIGEgZ2lhbnQgdW5kZXJncm91bmQgdmF1bHQuIiwKICAgICAgICAgICAgICAgICJZb3VyIGNoZWZzIGFyZSB3b3JraW5nIG9uIG5ldyBzZWNyZXQgcmVjaXBlcyEiLAogICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICk7CgogICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siU2hpcG1lbnQiXS5hbW91bnQgPiAwKQogICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICJZb3VyIHN1cGVybWFya2V0cyBhcmUgYnVzdGxpbmcgd2l0aCBoYXBweSwgaHVuZ3J5IGN1c3RvbWVycy4iLAogICAgICAgICAgICAgICAgIllvdXIgc3VwZXJtYXJrZXRzIGFyZSBmdWxsIG9mIGNvb2tpZSBtZXJjaCEiLAogICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICk7CgogICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siQWxjaGVteSBsYWIiXS5hbW91bnQgPiAwKQogICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICJJdCdzIGEgbmV3IHRyYWRpbmcgZGF5IGF0IHRoZSBzdG9jayBleGNoYW5nZSwgYW5kIHRyYWRlcnMgY2FuJ3QgZ2V0IGVub3VnaCBvZiB5b3VyIHNoYXJlcyEiLAogICAgICAgICAgICAgICAgIllvdXIgc3RvY2sgaXMgZG91YmxpbmcgaW4gdmFsdWUgYnkgdGhlIG1pbnV0ZSEiLAogICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICk7CgogICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siUG9ydGFsIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAiWW91IGp1c3QgcmVsZWFzZWQgYSBuZXcgVFYgc2hvdyBlcGlzb2RlISIsCiAgICAgICAgICAgICAgICAiWW91ciBjb29raWUtdGhlbWVkIFRWIHNob3cgaXMgYmVpbmcgYWRhcHRlZCBpbnRvIGEgbmV3IG1vdmllISIsCiAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgKTsKCiAgICAgICAgICBpZiAoR2FtZS5PYmplY3RzWyJUaW1lIG1hY2hpbmUiXS5hbW91bnQgPiAwKQogICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICJZb3VyIHRoZW1lIHBhcmtzIGFyZSBkb2luZyB3ZWxsIC0gcHVkZGxlcyBvZiB2b21pdCBhbmQgcm9sbGVyLWNvYXN0ZXIgY2FzdWFsdGllcyBhcmUgYmVpbmcgc3dlcHQgdW5kZXIgdGhlIHJ1ZyEiLAogICAgICAgICAgICAgICAgIlZpc2l0b3JzIGFyZSBzdHVmZmluZyB0aGVtc2VsdmVzIHdpdGggY29va2llcyBiZWZvcmUgcmlkaW5nIHlvdXIgcm9sbGVyLWNvYXN0ZXJzLiBZb3UgbWlnaHQgd2FudCB0byBoaXJlIG1vcmUgY2xlYW4tdXAgY3Jld3MuIiwKICAgICAgICAgICAgICBdKQogICAgICAgICAgICApOwoKICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIkFudGltYXR0ZXIgY29uZGVuc2VyIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAiQ29va2llY29pbiBpcyBvZmZpY2lhbGx5IHRoZSBtb3N0IG1pbmVkIGRpZ2l0YWwgY3VycmVuY3kgaW4gdGhlIGhpc3Rvcnkgb2YgbWFua2luZCEiLAogICAgICAgICAgICAgICAgIkNvb2tpZWNvaW4gcGlyYWN5IGlzIHJhbXBhbnQhIiwKICAgICAgICAgICAgICBdKQogICAgICAgICAgICApOwoKICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIlByaXNtIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAiWW91ciBjb3Jwb3JhdGUgbmF0aW9ucyBqdXN0IGdhaW5lZCBhIG5ldyBwYXJsaWFtZW50ISIsCiAgICAgICAgICAgICAgICAiWW91J3ZlIGp1c3QgYW5uZXhlZCBhIG5ldyBuYXRpb24hIiwKICAgICAgICAgICAgICAgICJBIG5ldyBuYXRpb24gam9pbnMgdGhlIGdyYW5kIGNvb2tpZSBjb25nbG9tZXJhdGUhIiwKICAgICAgICAgICAgICBdKQogICAgICAgICAgICApOwoKICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIkNoYW5jZW1ha2VyIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAiWW91ciBpbnRlcmdhbGFjdGljIGZlZGVyYXRpb24gb2YgY29va2llLXNwb25zb3JlZCBwbGFuZXRzIHJlcG9ydHMgcmVjb3JkLWJyZWFraW5nIHByb2ZpdHMhIiwKICAgICAgICAgICAgICAgICJCaWxsaW9ucyBvZiB1bndhc2hlZCBhbGllbnMgYXJlIHBsZWFzZWQgdG8gam9pbiB5b3VyIHdvcmtmb3JjZSBhcyB5b3UgYW5uZXggdGhlaXIgcGxhbmV0ISIsCiAgICAgICAgICAgICAgICAiTmV3IHRvbGwgb3BlbmVkIG9uIGludGVyc3RlbGxhciBoaWdod2F5LCBmdW5uZWxsaW5nIG1vcmUgcHJvZml0cyBpbnRvIHRoZSBjb29raWUgZWNvbm9teSEiLAogICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICk7CgogICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siRnJhY3RhbCBlbmdpbmUiXS5hbW91bnQgPiAwKQogICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICJZb3VyIGNvb2tpZS1iYXNlZCBwb2xpdGljYWwgcGFydHkgaXMgZG9pbmcgZmFudGFzdGljIGluIHRoZSBwb2xscyEiLAogICAgICAgICAgICAgICAgIk5ldyBwcm8tY29va2llIGxhdyBwYXNzZXMgd2l0aG91dCBhIGhpdGNoIHRoYW5rcyB0byB5b3VyIGZpcm0gZ3Jhc3Agb2YgdGhlIHBvbGl0aWNhbCBlY29zeXN0ZW0hIiwKICAgICAgICAgICAgICAgICJZb3VyIGFwcG9pbnRlZCBzZW5hdG9ycyBhcmUgb3ZlcnR1cm5pbmcgY29va2llIGJhbnMgbGVmdCBhbmQgcmlnaHQhIiwKICAgICAgICAgICAgICBdKQogICAgICAgICAgICApOwoKICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIkphdmFzY3JpcHQgY29uc29sZSJdLmFtb3VudCA+IDApCiAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgIkNvb2tpZXMgYXJlIG5vdyBvbmUgb2YgdGhlIGRlZmluaW5nIGFzcGVjdHMgb2YgbWFua2luZCEgQ29uZ3JhdHVsYXRpb25zISIsCiAgICAgICAgICAgICAgICAiVGltZSB0cmF2ZWxlcnMgcmVwb3J0IHRoYXQgdGhpcyBlcmEgd2lsbCBsYXRlciBjb21lIHRvIGJlIGtub3duLCB0aGFua3MgdG8geW91LCBhcyB0aGUgY29va2llIG1pbGxlbm5pdW0hIiwKICAgICAgICAgICAgICAgICJDb29raWVzIG5vdyBkZWVwbHkgcm9vdGVkIGluIGh1bWFuIGN1bHR1cmUsIGxpa2VseSBwdXp6bGluZyBmdXR1cmUgaGlzdG9yaWFucyEiLAogICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICk7CgogICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siSWRsZXZlcnNlIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAiUHVibGljIGFnaGFzdCBhcyBhbGwgcmVtYWluaW5nIGFzcGVjdHMgb2YgdGhlaXIgbGl2ZXMgb3ZlcnRha2VuIGJ5IHVuaXZlcnNhbCBjb29raWUgaW5kdXN0cnkhIiwKICAgICAgICAgICAgICAgICJFdmVyeSBzaW5nbGUgcHJvZHVjdCBjdXJyZW50bHkgc29sZCBpbiB0aGUgb2JzZXJ2YWJsZSB1bml2ZXJzZSBjYW4gYmUgdHJhY2VkIGJhY2sgdG8geW91ciBjb21wYW55ISBBbmQgdGhhdCdzIGEgZ29vZCB0aGluZy4iLAogICAgICAgICAgICAgICAgIkFudGl0cnVzdCBsYXdzIGxldCBvdXQgYSBoZWxwbGVzcyB3aGltcGVyIGJlZm9yZSBiZWluZyBlbmd1bGZlZCBieSB5b3VyIHNwcmF3bGluZyBlbXBpcmUhIiwKICAgICAgICAgICAgICBdKQogICAgICAgICAgICApOwoKICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIkNvcnRleCBiYWtlciJdLmFtb3VudCA+IDApCiAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgIkJvbGQgbmV3IGxhdyBwcm9wb3NhbCB3b3VsZCBncmFudCBkZWZhdWx0IG93bmVyc2hpcCBvZiBldmVyeSBuZXcgaWRlYSBieSBhbnlvbmUgYW55d2hlcmUgdG8gIiArCiAgICAgICAgICAgICAgICAgIEdhbWUuYmFrZXJ5TmFtZSArCiAgICAgICAgICAgICAgICAgICIncyBiYWtlcnkhIiwKICAgICAgICAgICAgICAgICJCYWtlcnkgdGhpbmsgdGFua3MgYWNjaWRlbnRhbGx5IHJlaW52ZW50IGNvb2tpZXMgZm9yIHRoZSA1N3RoIHRpbWUgdGhpcyB3ZWVrISIsCiAgICAgICAgICAgICAgICAiQmFrZXJ5IHRoaW5rIHRhbmtzIGludmVudCBlbnRpcmUgbmV3IGZvcm0gb2YgaHVtYW4gY29tbXVuaWNhdGlvbiB0byBhZHZlcnRpc2UgYW5kIGJvb3N0IGNvb2tpZSBzYWxlcyEiLAogICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICk7CiAgICAgICAgfQoKICAgICAgICBpZiAobG9yZVByb2dyZXNzIDw9IDApCiAgICAgICAgICBsaXN0LnB1c2goIlN1Y2ggYSBncmFuZCBkYXkgdG8gYmVnaW4gYSBuZXcgYnVzaW5lc3MuIik7CiAgICAgICAgZWxzZSBpZiAobG9yZVByb2dyZXNzIDw9IDEpIGxpc3QucHVzaCgiWW91J3JlIGJha2luZyB1cCBhIHN0b3JtISIpOwogICAgICAgIGVsc2UgaWYgKGxvcmVQcm9ncmVzcyA8PSAyKQogICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAiWW91IGFyZSBjb25maWRlbnQgdGhhdCBvbmUgZGF5LCB5b3VyIGNvb2tpZSBjb21wYW55IHdpbGwgYmUgdGhlIGdyZWF0ZXN0IG9uIHRoZSBtYXJrZXQhIgogICAgICAgICAgKTsKICAgICAgICBlbHNlIGlmIChsb3JlUHJvZ3Jlc3MgPD0gMykgbGlzdC5wdXNoKCJCdXNpbmVzcyBpcyBwaWNraW5nIHVwISIpOwogICAgICAgIGVsc2UgaWYgKGxvcmVQcm9ncmVzcyA8PSA0KQogICAgICAgICAgbGlzdC5wdXNoKCJZb3UncmUgbWFraW5nIHNhbGVzIGxlZnQgYW5kIHJpZ2h0ISIpOwogICAgICAgIGVsc2UgaWYgKGxvcmVQcm9ncmVzcyA8PSA1KQogICAgICAgICAgbGlzdC5wdXNoKCJFdmVyeW9uZSB3YW50cyB0byBidXkgeW91ciBjb29raWVzISIpOwogICAgICAgIGVsc2UgaWYgKGxvcmVQcm9ncmVzcyA8PSA2KQogICAgICAgICAgbGlzdC5wdXNoKCJZb3UgYXJlIG5vdyBzcGVuZGluZyBtb3N0IG9mIHlvdXIgZGF5IHNpZ25pbmcgY29udHJhY3RzISIpOwogICAgICAgIGVsc2UgaWYgKGxvcmVQcm9ncmVzcyA8PSA3KQogICAgICAgICAgbGlzdC5wdXNoKCdZb3VcJ3ZlIGJlZW4gZWxlY3RlZCAiYnVzaW5lc3MgdHljb29uIG9mIHRoZSB5ZWFyIiEnKTsKICAgICAgICBlbHNlIGlmIChsb3JlUHJvZ3Jlc3MgPD0gOCkKICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgIllvdXIgY29va2llcyBhcmUgYSB3b3JsZHdpZGUgc2Vuc2F0aW9uISBXZWxsIGRvbmUsIG9sZCBjaGFwISIKICAgICAgICAgICk7CiAgICAgICAgZWxzZSBpZiAobG9yZVByb2dyZXNzIDw9IDkpCiAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICJZb3VyIGJyYW5kIGhhcyBtYWRlIGl0cyB3YXkgaW50byBwb3B1bGFyIGN1bHR1cmUuIENoaWxkcmVuIHJlY2l0ZSB5b3VyIHNsb2dhbnMgYW5kIGFkdWx0cyByZW1pbmlzY2UgdGhlbSBmb25kbHkhIgogICAgICAgICAgKTsKICAgICAgICBlbHNlIGlmIChsb3JlUHJvZ3Jlc3MgPD0gMTApCiAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICJBIGJ1c2luZXNzIGRheSBsaWtlIGFueSBvdGhlci4gSXQncyBnb29kIHRvIGJlIGF0IHRoZSB0b3AhIgogICAgICAgICAgKTsKICAgICAgICBlbHNlIGlmIChsb3JlUHJvZ3Jlc3MgPD0gMTEpCiAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICJZb3UgbG9vayBiYWNrIG9uIHlvdXIgY2FyZWVyLiBJdCdzIGJlZW4gYSBmYXNjaW5hdGluZyBqb3VybmV5LCBidWlsZGluZyB5b3VyIGJha2luZyBlbXBpcmUgZnJvbSB0aGUgZ3JvdW5kIHVwLiIKICAgICAgICAgICk7CiAgICAgIH0KCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgR2FtZS5tb2RIb29rc1sidGlja2VyIl0ubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgYXJyID0gR2FtZS5tb2RIb29rc1sidGlja2VyIl1baV0oKTsKICAgICAgICBpZiAoYXJyKSBsaXN0ID0gbGlzdC5jb25jYXQoYXJyKTsKICAgICAgfQoKICAgICAgR2FtZS5UaWNrZXJFZmZlY3QgPSAwOwoKICAgICAgaWYgKAogICAgICAgICFtYW51YWwgJiYKICAgICAgICBHYW1lLlQgPiBHYW1lLmZwcyAqIDEwICYmCiAgICAgICAgR2FtZS5IYXMoIkZvcnR1bmUgY29va2llcyIpICYmCiAgICAgICAgTWF0aC5yYW5kb20oKSA8IChHYW1lLkhhc0FjaGlldigiTyBGb3J0dW5hIikgPyAwLjA0IDogMC4wMikKICAgICAgKSB7CiAgICAgICAgdmFyIGZvcnR1bmVzID0gW107CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlRpZXJzWyJmb3J0dW5lIl0udXBncmFkZXMpIHsKICAgICAgICAgIHZhciBpdCA9IEdhbWUuVGllcnNbImZvcnR1bmUiXS51cGdyYWRlc1tpXTsKICAgICAgICAgIGlmICghR2FtZS5IYXNVbmxvY2tlZChpdC5uYW1lKSkgZm9ydHVuZXMucHVzaChpdCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoIUdhbWUuZm9ydHVuZUdDKSBmb3J0dW5lcy5wdXNoKCJmb3J0dW5lR0MiKTsKICAgICAgICBpZiAoIUdhbWUuZm9ydHVuZUNQUykgZm9ydHVuZXMucHVzaCgiZm9ydHVuZUNQUyIpOwoKICAgICAgICBpZiAoZm9ydHVuZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgbGlzdCA9IFtdOwogICAgICAgICAgdmFyIG1lID0gY2hvb3NlKGZvcnR1bmVzKTsKICAgICAgICAgIEdhbWUuVGlja2VyRWZmZWN0ID0geyB0eXBlOiAiZm9ydHVuZSIsIHN1YjogbWUgfTsKCiAgICAgICAgICBpZiAobWUgPT0gImZvcnR1bmVHQyIpCiAgICAgICAgICAgIG1lID0gbG9jKAogICAgICAgICAgICAgICJUb2RheSBpcyB5b3VyIGx1Y2t5IGRheSEiCiAgICAgICAgICAgICk7IC8qPGJyPkNsaWNrIGhlcmUgZm9yIGEgZ29sZGVuIGNvb2tpZS4nOyovCiAgICAgICAgICBlbHNlIGlmIChtZSA9PSAiZm9ydHVuZUNQUyIpIHsKICAgICAgICAgICAgTWF0aC5zZWVkcmFuZG9tKEdhbWUuc2VlZCArICItZm9ydHVuZSIpOwogICAgICAgICAgICBtZSA9CiAgICAgICAgICAgICAgbG9jKCJZb3VyIGx1Y2t5IG51bWJlcnMgYXJlOiIpICsKICAgICAgICAgICAgICAiICIgKwogICAgICAgICAgICAgIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCkgKwogICAgICAgICAgICAgICIgIiArCiAgICAgICAgICAgICAgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKSArCiAgICAgICAgICAgICAgIiAiICsKICAgICAgICAgICAgICBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApICsKICAgICAgICAgICAgICAiICIgKwogICAgICAgICAgICAgIE1hdGguZmxvb3IoCiAgICAgICAgICAgICAgICBNYXRoLnJhbmRvbSgpICogMTAwCiAgICAgICAgICAgICAgKSAvKisnPGJyPkNsaWNrIGhlcmUgdG8gZ2FpbiBvbmUgaG91ciBvZiB5b3VyIENwUy4nKi87CiAgICAgICAgICAgIE1hdGguc2VlZHJhbmRvbSgpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKEVOKSB7CiAgICAgICAgICAgICAgbWUgPQogICAgICAgICAgICAgICAgbWUuZG5hbWUuc3Vic3RyaW5nKG1lLm5hbWUuaW5kZXhPZigiIyIpKSArCiAgICAgICAgICAgICAgICAiIDogIiArCiAgICAgICAgICAgICAgICBtZS5iYXNlRGVzYy5zdWJzdHJpbmcobWUuYmFzZURlc2MuaW5kZXhPZigiPHE+IikgKyAzKTsKICAgICAgICAgICAgICBtZSA9IG1lLnN1YnN0cmluZygwLCBtZS5sZW5ndGggLSA0KTsKICAgICAgICAgICAgfSBlbHNlIGlmIChtZS5idWlsZGluZ1RpZSkKICAgICAgICAgICAgICBtZSA9CiAgICAgICAgICAgICAgICBtZS5kbmFtZSArCiAgICAgICAgICAgICAgICAiIDogIiArCiAgICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICAgIk5ldmVyIGZvcmdldCB5b3VyICUxLiIsCiAgICAgICAgICAgICAgICAgICAgIlBheSBjbG9zZSBhdHRlbnRpb24gdG8gdGhlIGh1bWJsZSAlMS4iLAogICAgICAgICAgICAgICAgICAgICJZb3UndmUgYmVlbiBuZWdsZWN0aW5nIHlvdXIgJTEuIiwKICAgICAgICAgICAgICAgICAgICAiUmVtZW1iZXIgdG8gdmlzaXQgeW91ciAlMSBzb21ldGltZXMuIiwKICAgICAgICAgICAgICAgICAgXSksCiAgICAgICAgICAgICAgICAgIG1lLmJ1aWxkaW5nVGllLnNpbmdsZQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgIG1lID0KICAgICAgICAgICAgICAgIG1lLmRuYW1lICsKICAgICAgICAgICAgICAgICIgOiAiICsKICAgICAgICAgICAgICAgIGxvYygKICAgICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgICAiWW91IGRvbid0IGtub3cgd2hhdCB5b3UgaGF2ZSB1bnRpbCB5b3UndmUgbG9zdCBpdC4iLAogICAgICAgICAgICAgICAgICAgICJSZW1lbWJlciB0byB0YWtlIGJyZWFrcy4iLAogICAgICAgICAgICAgICAgICAgICJIZXksIHdoYXQncyB1cC4gSSdtIGEgZm9ydHVuZSBjb29raWUuIiwKICAgICAgICAgICAgICAgICAgICAiWW91IHRoaW5rIHlvdSBoYXZlIGl0IGJhZD8gTG9vayBhdCBtZS4iLAogICAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgIH0KICAgICAgICAgIG1lID0KICAgICAgICAgICAgJzxzcGFuIGNsYXNzPSJmb3J0dW5lIj48ZGl2IGNsYXNzPSJpY29uIiBzdHlsZT0idmVydGljYWwtYWxpZ246bWlkZGxlO2Rpc3BsYXk6aW5saW5lLWJsb2NrO2JhY2tncm91bmQtcG9zaXRpb246JyArCiAgICAgICAgICAgIC0yOSAqIDQ4ICsKICAgICAgICAgICAgInB4ICIgKwogICAgICAgICAgICAtOCAqIDQ4ICsKICAgICAgICAgICAgJ3B4O3RyYW5zZm9ybTpzY2FsZSgwLjUpO21hcmdpbjotMTZweDtwb3NpdGlvbjpyZWxhdGl2ZTtsZWZ0Oi00cHg7dG9wOi0ycHg7Ij48L2Rpdj4nICsKICAgICAgICAgICAgbWUgKwogICAgICAgICAgICAiPC9zcGFuPiI7CiAgICAgICAgICBsaXN0ID0gW21lXTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChHYW1lLndpbmRvd1cgPCBHYW1lLnRpY2tlclRvb05hcnJvdykKICAgICAgICBsaXN0ID0gWwogICAgICAgICAgJzxkaXYgc3R5bGU9InRyYW5zZm9ybTpzY2FsZSgwLjgsMS4yKTsiPicgKwogICAgICAgICAgICBORVdTICsKICAgICAgICAgICAgKEVOID8gImhlbHAhIiA6IGxvYygiaGVscCBtZSEiKSkgKwogICAgICAgICAgICAiPC9kaXY+IiwKICAgICAgICBdOwoKICAgICAgR2FtZS5UaWNrZXJBZ2UgPSBHYW1lLmZwcyAqIDEwOwogICAgICBHYW1lLlRpY2tlciA9IGNob29zZShsaXN0KTsKICAgICAgR2FtZS5BZGRUb0xvZyhHYW1lLlRpY2tlcik7CiAgICAgIEdhbWUuVGlja2VyTisrOwogICAgICBHYW1lLlRpY2tlckRyYXcoKTsKICAgIH07CiAgICBHYW1lLnRpY2tlckwgPSBsKCJjb21tZW50c1RleHQxIik7CiAgICBHYW1lLnRpY2tlckJlbG93TCA9IGwoImNvbW1lbnRzVGV4dDIiKTsKICAgIEdhbWUudGlja2VyVG9vTmFycm93ID0gOTAwOwogICAgR2FtZS5UaWNrZXJEcmF3ID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgc3RyID0gIiI7CiAgICAgIGlmIChHYW1lLlRpY2tlciAhPSAiIikgc3RyID0gR2FtZS5UaWNrZXI7CiAgICAgIEdhbWUudGlja2VyQmVsb3dMLmlubmVySFRNTCA9IEdhbWUudGlja2VyTC5pbm5lckhUTUw7CiAgICAgIEdhbWUudGlja2VyTC5pbm5lckhUTUwgPSBzdHI7CgogICAgICBHYW1lLnRpY2tlckJlbG93TC5jbGFzc05hbWUgPSAiY29tbWVudHNUZXh0IjsKICAgICAgdm9pZCBHYW1lLnRpY2tlckJlbG93TC5vZmZzZXRXaWR0aDsKICAgICAgR2FtZS50aWNrZXJCZWxvd0wuY2xhc3NOYW1lID0gImNvbW1lbnRzVGV4dCByaXNpbmdBd2F5IjsKICAgICAgR2FtZS50aWNrZXJMLmNsYXNzTmFtZSA9ICJjb21tZW50c1RleHQiOwogICAgICB2b2lkIEdhbWUudGlja2VyTC5vZmZzZXRXaWR0aDsKICAgICAgR2FtZS50aWNrZXJMLmNsYXNzTmFtZSA9ICJjb21tZW50c1RleHQgcmlzaW5nVXAiOwogICAgfTsKICAgIEFkZEV2ZW50KEdhbWUudGlja2VyTCwgImNsaWNrIiwgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIEdhbWUuVGlja2VyID0gIiI7CiAgICAgIEdhbWUuVGlja2VyQ2xpY2tzKys7CiAgICAgIGlmIChHYW1lLndpbmRvd1cgPCBHYW1lLnRpY2tlclRvb05hcnJvdykgewogICAgICAgIEdhbWUuV2luKCJTdGlmbGluZyB0aGUgcHJlc3MiKTsKICAgICAgfSBlbHNlIGlmIChHYW1lLlRpY2tlckNsaWNrcyA+PSA1MCkgewogICAgICAgIEdhbWUuV2luKCJUYWJsb2lkIGFkZGljdGlvbiIpOwogICAgICB9CgogICAgICBpZiAoR2FtZS5UaWNrZXJFZmZlY3QgJiYgR2FtZS5UaWNrZXJFZmZlY3QudHlwZSA9PSAiZm9ydHVuZSIpIHsKICAgICAgICBQbGF5U291bmQoInNuZC9mb3J0dW5lLm1wMyIsIDEpOwogICAgICAgIEdhbWUuU3BhcmtsZUF0KEdhbWUubW91c2VYLCBHYW1lLm1vdXNlWSk7CiAgICAgICAgdmFyIGVmZmVjdCA9IEdhbWUuVGlja2VyRWZmZWN0LnN1YjsKICAgICAgICBpZiAoZWZmZWN0ID09ICJmb3J0dW5lR0MiKSB7CiAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgbG9jKCJGb3J0dW5lISIpLAogICAgICAgICAgICBsb2MoIkEgZ29sZGVuIGNvb2tpZSBoYXMgYXBwZWFyZWQuIiksCiAgICAgICAgICAgIFsxMCwgMzJdCiAgICAgICAgICApOwogICAgICAgICAgR2FtZS5mb3J0dW5lR0MgPSAxOwogICAgICAgICAgdmFyIG5ld1NoaW1tZXIgPSBuZXcgR2FtZS5zaGltbWVyKCJnb2xkZW4iLCB7IG5vV3JhdGg6IHRydWUgfSk7CiAgICAgICAgfSBlbHNlIGlmIChlZmZlY3QgPT0gImZvcnR1bmVDUFMiKSB7CiAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgbG9jKCJGb3J0dW5lISIpLAogICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgIllvdSBnYWluIDxiPm9uZSBob3VyPC9iPiBvZiB5b3VyIENwUyAoY2FwcGVkIGF0IGRvdWJsZSB5b3VyIGJhbmspLiIKICAgICAgICAgICAgKSwKICAgICAgICAgICAgWzEwLCAzMl0KICAgICAgICAgICk7CiAgICAgICAgICBHYW1lLmZvcnR1bmVDUFMgPSAxOwogICAgICAgICAgR2FtZS5FYXJuKE1hdGgubWluKEdhbWUuY29va2llc1BzICogNjAgKiA2MCwgR2FtZS5jb29raWVzKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgICBlZmZlY3QuZG5hbWUsCiAgICAgICAgICAgIGxvYygiWW91J3ZlIHVubG9ja2VkIGEgbmV3IHVwZ3JhZGUuIiksCiAgICAgICAgICAgIGVmZmVjdC5pY29uCiAgICAgICAgICApOwogICAgICAgICAgZWZmZWN0LnVubG9jaygpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgR2FtZS5UaWNrZXJFZmZlY3QgPSAwOwogICAgfSk7CgogICAgR2FtZS5Mb2cgPSBbXTsKICAgIEdhbWUuQWRkVG9Mb2cgPSBmdW5jdGlvbiAod2hhdCkgewogICAgICBHYW1lLkxvZy51bnNoaWZ0KHdoYXQpOwogICAgICBpZiAoR2FtZS5Mb2cubGVuZ3RoID4gMTAwKSBHYW1lLkxvZy5wb3AoKTsKICAgIH07CgogICAgR2FtZS52YW5pbGxhID0gMTsKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJCUJVSUxESU5HUwoJCT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCiAgICBHYW1lLmxhc3QgPSAwOwoKICAgIEdhbWUuc3RvcmVUb1JlZnJlc2ggPSAxOwogICAgR2FtZS5wcmljZUluY3JlYXNlID0gMS4xNTsKICAgIEdhbWUuYnV5QnVsayA9IDE7CiAgICBHYW1lLmJ1eU1vZGUgPSAxOyAvLzEgZm9yIGJ1eSwgLTEgZm9yIHNlbGwKICAgIEdhbWUuYnV5QnVsa09sZCA9IEdhbWUuYnV5QnVsazsgLy91c2VkIHRvIHVuZG8gY2hhbmdlcyBmcm9tIGhvbGRpbmcgU2hpZnQgb3IgQ3RybAogICAgR2FtZS5idXlCdWxrU2hvcnRjdXQgPSAwOyAvL2FyZSB3ZSBwcmVzc2luZyBTaGlmdCBvciBDdHJsPwoKICAgIEdhbWUuT2JqZWN0cyA9IHt9OwogICAgR2FtZS5PYmplY3RzQnlJZCA9IFtdOwogICAgR2FtZS5PYmplY3RzTiA9IDA7CiAgICBHYW1lLkJ1aWxkaW5nc093bmVkID0gMDsKICAgIEdhbWUuT2JqZWN0ID0gZnVuY3Rpb24gKAogICAgICBuYW1lLAogICAgICBjb21tb25OYW1lLAogICAgICBkZXNjLAogICAgICBpY29uLAogICAgICBpY29uQ29sdW1uLAogICAgICBhcnQsCiAgICAgIHByaWNlLAogICAgICBjcHMsCiAgICAgIGJ1eUZ1bmN0aW9uCiAgICApIHsKICAgICAgdGhpcy5pZCA9IEdhbWUuT2JqZWN0c047CiAgICAgIHRoaXMubmFtZSA9IG5hbWU7CiAgICAgIHRoaXMuZG5hbWUgPSBuYW1lOwogICAgICB0aGlzLmRpc3BsYXlOYW1lID0gdGhpcy5uYW1lOwogICAgICBjb21tb25OYW1lID0gY29tbW9uTmFtZS5zcGxpdCgifCIpOwogICAgICB0aGlzLnNpbmdsZSA9IGNvbW1vbk5hbWVbMF07CiAgICAgIHRoaXMucGx1cmFsID0gY29tbW9uTmFtZVsxXTsKICAgICAgdGhpcy5ic2luZ2xlID0gdGhpcy5zaW5nbGU7CiAgICAgIHRoaXMuYnBsdXJhbCA9IHRoaXMucGx1cmFsOyAvL3N0b3JlIHVudHJhbnNsYXRlZCBhcyB3ZSB1c2UgdGhvc2UgdG9vCiAgICAgIHRoaXMuYWN0aW9uTmFtZSA9IGNvbW1vbk5hbWVbMl07CiAgICAgIHRoaXMuZXh0cmFOYW1lID0gY29tbW9uTmFtZVszXTsKICAgICAgdGhpcy5leHRyYVBsdXJhbCA9IGNvbW1vbk5hbWVbNF07CiAgICAgIHRoaXMuZGVzYyA9IGRlc2M7CiAgICAgIGlmICh0cnVlKSB7CiAgICAgICAgLy9pZiAoRU4pCiAgICAgICAgdGhpcy5kbmFtZSA9IGxvYyh0aGlzLm5hbWUpOwogICAgICAgIHRoaXMuc2luZ2xlID0gbG9jKHRoaXMuc2luZ2xlKTsKICAgICAgICB0aGlzLnBsdXJhbCA9IGxvYyh0aGlzLnBsdXJhbCk7CiAgICAgICAgdGhpcy5kZXNjID0gbG9jKEZpbmRMb2NTdHJpbmdCeVBhcnQodGhpcy5uYW1lICsgIiBxdW90ZSIpKTsKICAgICAgfQogICAgICB0aGlzLmJhc2VQcmljZSA9IHByaWNlOwogICAgICB0aGlzLnByaWNlID0gdGhpcy5iYXNlUHJpY2U7CiAgICAgIHRoaXMuYnVsa1ByaWNlID0gdGhpcy5wcmljZTsKICAgICAgdGhpcy5jcHMgPSBjcHM7CiAgICAgIHRoaXMuYmFzZUNwcyA9IHRoaXMuY3BzOwogICAgICB0aGlzLm1vdXNlT24gPSBmYWxzZTsKICAgICAgdGhpcy5tb3VzZVBvcyA9IFstMTAwLCAtMTAwXTsKICAgICAgdGhpcy5wcm9kdWN0aW9uQWNoaWV2cyA9IFtdOwoKICAgICAgdGhpcy5uID0gdGhpcy5pZDsKICAgICAgaWYgKHRoaXMubiAhPSAwKSB7CiAgICAgICAgLy9uZXcgYXV0b21hdGVkIHByaWNlIGFuZCBDcFMgY3VydmVzCiAgICAgICAgLy90aGlzLmJhc2VDcHM9TWF0aC5jZWlsKCgodGhpcy5uKjAuNSkqTWF0aC5wb3codGhpcy5uKjEsdGhpcy5uKjAuOSkpKjEwKS8xMDsKICAgICAgICAvL3RoaXMuYmFzZUNwcz1NYXRoLmNlaWwoKE1hdGgucG93KHRoaXMubioxLHRoaXMubiowLjUrMi4zNSkpKjEwKS8xMDsvL2J5IGEgZm9ydHVuYXRlIGNvaW5jaWRlbmNlLCB0aGlzIGdpdmVzIHRoZSAzcmQsIDR0aCBhbmQgNXRoIGJ1aWxkaW5ncyBhIENwUyBvZiAxMCwgNjkgYW5kIDQyMAogICAgICAgIHRoaXMuYmFzZUNwcyA9CiAgICAgICAgICBNYXRoLmNlaWwoTWF0aC5wb3codGhpcy5uICogMSwgdGhpcy5uICogMC41ICsgMikgKiAxMCkgLyAxMDsgLy8wLjQ1IHVzZWQgdG8gYmUgMC41CiAgICAgICAgLy90aGlzLmJhc2VDcHM9TWF0aC5jZWlsKChNYXRoLnBvdyh0aGlzLm4qMSx0aGlzLm4qMC40NSsyLjEwKSkqMTApLzEwOwogICAgICAgIC8vY2xhbXAgMTQsNDY3LDE5OSB0byAxNCwwMDAsMDAwICh0aGVyZSdzIHByb2JhYmx5IGEgbW9yZSBlbGVnYW50IHdheSB0byBkbyB0aGF0KQogICAgICAgIHZhciBkaWdpdHMgPQogICAgICAgICAgTWF0aC5wb3coCiAgICAgICAgICAgIDEwLAogICAgICAgICAgICBNYXRoLmNlaWwoTWF0aC5sb2coTWF0aC5jZWlsKHRoaXMuYmFzZUNwcykpIC8gTWF0aC5MTjEwKQogICAgICAgICAgKSAvIDEwMDsKICAgICAgICB0aGlzLmJhc2VDcHMgPSBNYXRoLnJvdW5kKHRoaXMuYmFzZUNwcyAvIGRpZ2l0cykgKiBkaWdpdHM7CgogICAgICAgIHRoaXMuYmFzZVByaWNlID0KICAgICAgICAgICh0aGlzLm4gKiAxICsgOSArICh0aGlzLm4gPCA1ID8gMCA6IE1hdGgucG93KHRoaXMubiAtIDUsIDEuNzUpICogNSkpICoKICAgICAgICAgIE1hdGgucG93KDEwLCB0aGlzLm4pICoKICAgICAgICAgIE1hdGgubWF4KDEsIHRoaXMubiAtIDE0KTsKICAgICAgICAvL3RoaXMuYmFzZVByaWNlPSh0aGlzLm4qMi41KzcuNSkqTWF0aC5wb3coMTAsdGhpcy5uKTsKICAgICAgICB2YXIgZGlnaXRzID0KICAgICAgICAgIE1hdGgucG93KAogICAgICAgICAgICAxMCwKICAgICAgICAgICAgTWF0aC5jZWlsKE1hdGgubG9nKE1hdGguY2VpbCh0aGlzLmJhc2VQcmljZSkpIC8gTWF0aC5MTjEwKQogICAgICAgICAgKSAvIDEwMDsKICAgICAgICB0aGlzLmJhc2VQcmljZSA9IE1hdGgucm91bmQodGhpcy5iYXNlUHJpY2UgLyBkaWdpdHMpICogZGlnaXRzOwogICAgICAgIGlmICh0aGlzLmlkID49IDE2KSB0aGlzLmJhc2VQcmljZSAqPSAxMDsKICAgICAgICBpZiAodGhpcy5pZCA+PSAxNykgdGhpcy5iYXNlUHJpY2UgKj0gMTA7CiAgICAgICAgaWYgKHRoaXMuaWQgPj0gMTgpIHRoaXMuYmFzZVByaWNlICo9IDEwOwogICAgICAgIGlmICh0aGlzLmlkID49IDE5KSB0aGlzLmJhc2VQcmljZSAqPSAxMDsKICAgICAgICB0aGlzLnByaWNlID0gdGhpcy5iYXNlUHJpY2U7CiAgICAgICAgdGhpcy5idWxrUHJpY2UgPSB0aGlzLnByaWNlOwogICAgICB9CgogICAgICB0aGlzLnRvdGFsQ29va2llcyA9IDA7CiAgICAgIHRoaXMuc3RvcmVkQ3BzID0gMDsKICAgICAgdGhpcy5zdG9yZWRUb3RhbENwcyA9IDA7CiAgICAgIHRoaXMuaWNvbiA9IGljb247CiAgICAgIHRoaXMuaWNvbkNvbHVtbiA9IGljb25Db2x1bW47CiAgICAgIHRoaXMuYXJ0ID0gYXJ0OwogICAgICBpZiAoYXJ0LmJhc2UpIHsKICAgICAgICBhcnQucGljID0gYXJ0LmJhc2UgKyAiLnBuZyI7CiAgICAgICAgYXJ0LmJnID0gYXJ0LmJhc2UgKyAiQmFja2dyb3VuZC5wbmciOwogICAgICB9CiAgICAgIHRoaXMuYnV5RnVuY3Rpb24gPSBidXlGdW5jdGlvbjsKICAgICAgdGhpcy5sb2NrZWQgPSAxOwogICAgICB0aGlzLmxldmVsID0gMDsKICAgICAgdGhpcy52YW5pbGxhID0gR2FtZS52YW5pbGxhOwoKICAgICAgdGhpcy50aWVyZWRVcGdyYWRlcyA9IHt9OwogICAgICB0aGlzLnRpZXJlZEFjaGlldnMgPSB7fTsKICAgICAgdGhpcy5zeW5lcmdpZXMgPSBbXTsKICAgICAgdGhpcy5mb3J0dW5lID0gMDsKCiAgICAgIHRoaXMuYW1vdW50ID0gMDsKICAgICAgdGhpcy5ib3VnaHQgPSAwOwogICAgICB0aGlzLmhpZ2hlc3QgPSAwOwogICAgICB0aGlzLmZyZWUgPSAwOwoKICAgICAgdGhpcy5lYWNoRnJhbWUgPSAwOwoKICAgICAgdGhpcy5taW5pZ2FtZVVybCA9IDA7IC8vaWYgdGhpcyBpcyBkZWZpbmVkLCBsb2FkIHRoZSBzcGVjaWZpZWQgc2NyaXB0IGlmIHRoZSBidWlsZGluZydzIGxldmVsIGlzIGF0IGxlYXN0IDEKICAgICAgdGhpcy5taW5pZ2FtZU5hbWUgPSAwOwogICAgICB0aGlzLm9uTWluaWdhbWUgPSBmYWxzZTsKICAgICAgdGhpcy5taW5pZ2FtZUxvYWRlZCA9IGZhbHNlOwoKICAgICAgdGhpcy5zd2l0Y2hNaW5pZ2FtZSA9IGZ1bmN0aW9uICgKICAgICAgICBvbiAvL2NoYW5nZSB3aGV0aGVyIHdlJ3JlIG9uIHRoZSBidWlsZGluZydzIG1pbmlnYW1lCiAgICAgICkgewogICAgICAgIGlmICghR2FtZS5pc01pbmlnYW1lUmVhZHkodGhpcykpIG9uID0gZmFsc2U7CiAgICAgICAgaWYgKG9uID09IC0xKSBvbiA9ICF0aGlzLm9uTWluaWdhbWU7CiAgICAgICAgdGhpcy5vbk1pbmlnYW1lID0gb247CiAgICAgICAgaWYgKHRoaXMuaWQgIT0gMCkgewogICAgICAgICAgaWYgKHRoaXMub25NaW5pZ2FtZSkgewogICAgICAgICAgICBsKCJyb3ciICsgdGhpcy5pZCkuY2xhc3NMaXN0LmFkZCgib25NaW5pZ2FtZSIpOwogICAgICAgICAgICAvL2woJ3Jvd1NwZWNpYWwnK3RoaXMuaWQpLnN0eWxlLmRpc3BsYXk9J2Jsb2NrJzsKICAgICAgICAgICAgLy9sKCdyb3dDYW52YXMnK3RoaXMuaWQpLnN0eWxlLmRpc3BsYXk9J25vbmUnOwogICAgICAgICAgICBpZiAodGhpcy5taW5pZ2FtZS5vblJlc2l6ZSkgdGhpcy5taW5pZ2FtZS5vblJlc2l6ZSgpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbCgicm93IiArIHRoaXMuaWQpLmNsYXNzTGlzdC5yZW1vdmUoIm9uTWluaWdhbWUiKTsKICAgICAgICAgICAgLy9sKCdyb3dTcGVjaWFsJyt0aGlzLmlkKS5zdHlsZS5kaXNwbGF5PSdub25lJzsKICAgICAgICAgICAgLy9sKCdyb3dDYW52YXMnK3RoaXMuaWQpLnN0eWxlLmRpc3BsYXk9J2Jsb2NrJzsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdGhpcy5yZWZyZXNoKCk7CiAgICAgIH07CgogICAgICB0aGlzLmdldFByaWNlID0gZnVuY3Rpb24gKG4pIHsKICAgICAgICB2YXIgcHJpY2UgPQogICAgICAgICAgdGhpcy5iYXNlUHJpY2UgKgogICAgICAgICAgTWF0aC5wb3coR2FtZS5wcmljZUluY3JlYXNlLCBNYXRoLm1heCgwLCB0aGlzLmFtb3VudCAtIHRoaXMuZnJlZSkpOwogICAgICAgIHByaWNlID0gR2FtZS5tb2RpZnlCdWlsZGluZ1ByaWNlKHRoaXMsIHByaWNlKTsKICAgICAgICByZXR1cm4gTWF0aC5jZWlsKHByaWNlKTsKICAgICAgfTsKICAgICAgdGhpcy5nZXRTdW1QcmljZSA9IGZ1bmN0aW9uICgKICAgICAgICBhbW91bnQgLy9yZXR1cm4gaG93IG11Y2ggaXQgd291bGQgY29zdCB0byBidXkgW2Ftb3VudF0gbW9yZSBvZiB0aGlzIGJ1aWxkaW5nCiAgICAgICkgewogICAgICAgIHZhciBwcmljZSA9IDA7CiAgICAgICAgZm9yICgKICAgICAgICAgIHZhciBpID0gTWF0aC5tYXgoMCwgdGhpcy5hbW91bnQpOwogICAgICAgICAgaSA8IE1hdGgubWF4KDAsIHRoaXMuYW1vdW50ICsgYW1vdW50KTsKICAgICAgICAgIGkrKwogICAgICAgICkgewogICAgICAgICAgcHJpY2UgKz0KICAgICAgICAgICAgdGhpcy5iYXNlUHJpY2UgKgogICAgICAgICAgICBNYXRoLnBvdyhHYW1lLnByaWNlSW5jcmVhc2UsIE1hdGgubWF4KDAsIGkgLSB0aGlzLmZyZWUpKTsKICAgICAgICB9CiAgICAgICAgcHJpY2UgPSBHYW1lLm1vZGlmeUJ1aWxkaW5nUHJpY2UodGhpcywgcHJpY2UpOwogICAgICAgIHJldHVybiBNYXRoLmNlaWwocHJpY2UpOwogICAgICB9OwogICAgICB0aGlzLmdldFJldmVyc2VTdW1QcmljZSA9IGZ1bmN0aW9uICgKICAgICAgICBhbW91bnQgLy9yZXR1cm4gaG93IG11Y2ggeW91J2QgZ2V0IGZyb20gc2VsbGluZyBbYW1vdW50XSBvZiB0aGlzIGJ1aWxkaW5nCiAgICAgICkgewogICAgICAgIHZhciBwcmljZSA9IDA7CiAgICAgICAgZm9yICgKICAgICAgICAgIHZhciBpID0gTWF0aC5tYXgoMCwgdGhpcy5hbW91bnQgLSBhbW91bnQpOwogICAgICAgICAgaSA8IE1hdGgubWF4KDAsIHRoaXMuYW1vdW50KTsKICAgICAgICAgIGkrKwogICAgICAgICkgewogICAgICAgICAgcHJpY2UgKz0KICAgICAgICAgICAgdGhpcy5iYXNlUHJpY2UgKgogICAgICAgICAgICBNYXRoLnBvdyhHYW1lLnByaWNlSW5jcmVhc2UsIE1hdGgubWF4KDAsIGkgLSB0aGlzLmZyZWUpKTsKICAgICAgICB9CiAgICAgICAgcHJpY2UgPSBHYW1lLm1vZGlmeUJ1aWxkaW5nUHJpY2UodGhpcywgcHJpY2UpOwogICAgICAgIHByaWNlICo9IHRoaXMuZ2V0U2VsbE11bHRpcGxpZXIoKTsKICAgICAgICByZXR1cm4gTWF0aC5jZWlsKHByaWNlKTsKICAgICAgfTsKICAgICAgdGhpcy5nZXRTZWxsTXVsdGlwbGllciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgZ2l2ZUJhY2sgPSAwLjI1OwogICAgICAgIC8vaWYgKEdhbWUuaGFzQXVyYSgnRWFydGggU2hhdHRlcmVyJykpIGdpdmVCYWNrPTAuNTsKICAgICAgICBnaXZlQmFjayAqPSAxICsgR2FtZS5hdXJhTXVsdCgiRWFydGggU2hhdHRlcmVyIik7CiAgICAgICAgcmV0dXJuIGdpdmVCYWNrOwogICAgICB9OwoKICAgICAgdGhpcy5idXkgPSBmdW5jdGlvbiAoYW1vdW50KSB7CiAgICAgICAgaWYgKEdhbWUuYnV5TW9kZSA9PSAtMSkgewogICAgICAgICAgdGhpcy5zZWxsKEdhbWUuYnV5QnVsaywgMSk7CiAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CiAgICAgICAgdmFyIHN1Y2Nlc3MgPSAwOwogICAgICAgIHZhciBtb25pID0gMDsKICAgICAgICB2YXIgYm91Z2h0ID0gMDsKICAgICAgICBpZiAoIWFtb3VudCkgYW1vdW50ID0gR2FtZS5idXlCdWxrOwogICAgICAgIGlmIChhbW91bnQgPT0gLTEpIGFtb3VudCA9IDEwMDA7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhbW91bnQ7IGkrKykgewogICAgICAgICAgdmFyIHByaWNlID0gdGhpcy5nZXRQcmljZSgpOwogICAgICAgICAgaWYgKEdhbWUuY29va2llcyA+PSBwcmljZSkgewogICAgICAgICAgICBib3VnaHQrKzsKICAgICAgICAgICAgbW9uaSArPSBwcmljZTsKICAgICAgICAgICAgR2FtZS5TcGVuZChwcmljZSk7CiAgICAgICAgICAgIHRoaXMuYW1vdW50Kys7CiAgICAgICAgICAgIHRoaXMuYm91Z2h0Kys7CiAgICAgICAgICAgIHByaWNlID0gdGhpcy5nZXRQcmljZSgpOwogICAgICAgICAgICB0aGlzLnByaWNlID0gcHJpY2U7CiAgICAgICAgICAgIGlmICh0aGlzLmJ1eUZ1bmN0aW9uKSB0aGlzLmJ1eUZ1bmN0aW9uKCk7CiAgICAgICAgICAgIEdhbWUucmVjYWxjdWxhdGVHYWlucyA9IDE7CiAgICAgICAgICAgIGlmICh0aGlzLmFtb3VudCA9PSAxICYmIHRoaXMuaWQgIT0gMCkKICAgICAgICAgICAgICBsKCJyb3ciICsgdGhpcy5pZCkuY2xhc3NMaXN0LmFkZCgiZW5hYmxlZCIpOwogICAgICAgICAgICB0aGlzLmhpZ2hlc3QgPSBNYXRoLm1heCh0aGlzLmhpZ2hlc3QsIHRoaXMuYW1vdW50KTsKICAgICAgICAgICAgR2FtZS5CdWlsZGluZ3NPd25lZCsrOwogICAgICAgICAgICBzdWNjZXNzID0gMTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKHN1Y2Nlc3MpIHsKICAgICAgICAgIFBsYXlTb3VuZCgic25kL2J1eSIgKyBjaG9vc2UoWzEsIDIsIDMsIDRdKSArICIubXAzIiwgMC43NSk7CiAgICAgICAgICB0aGlzLnJlZnJlc2goKTsKICAgICAgICB9CiAgICAgICAgLy9pZiAobW9uaT4wICYmIGFtb3VudD4xKSBHYW1lLk5vdGlmeSh0aGlzLm5hbWUsJ0JvdWdodCA8Yj4nK2JvdWdodCsnPC9iPiBmb3IgJytCZWF1dGlmeShtb25pKSsnIGNvb2tpZXMnLCcnLDIpOwogICAgICB9OwogICAgICB0aGlzLnNlbGwgPSBmdW5jdGlvbiAoYW1vdW50LCBieXBhc3MpIHsKICAgICAgICB2YXIgc3VjY2VzcyA9IDA7CiAgICAgICAgdmFyIG1vbmkgPSAwOwogICAgICAgIHZhciBzb2xkID0gMDsKICAgICAgICBpZiAoYW1vdW50ID09IC0xKSBhbW91bnQgPSB0aGlzLmFtb3VudDsKICAgICAgICBpZiAoIWFtb3VudCkgYW1vdW50ID0gR2FtZS5idXlCdWxrOwogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYW1vdW50OyBpKyspIHsKICAgICAgICAgIHZhciBwcmljZSA9IHRoaXMuZ2V0UHJpY2UoKTsKICAgICAgICAgIHZhciBnaXZlQmFjayA9IHRoaXMuZ2V0U2VsbE11bHRpcGxpZXIoKTsKICAgICAgICAgIHByaWNlID0gTWF0aC5mbG9vcihwcmljZSAqIGdpdmVCYWNrKTsKICAgICAgICAgIGlmICh0aGlzLmFtb3VudCA+IDApIHsKICAgICAgICAgICAgc29sZCsrOwogICAgICAgICAgICBtb25pICs9IHByaWNlOwogICAgICAgICAgICBHYW1lLmNvb2tpZXMgKz0gcHJpY2U7CiAgICAgICAgICAgIEdhbWUuY29va2llc0Vhcm5lZCA9IE1hdGgubWF4KEdhbWUuY29va2llcywgR2FtZS5jb29raWVzRWFybmVkKTsgLy90aGlzIGlzIHRvIGF2b2lkIHBsYXllcnMgZ2V0dGluZyB0aGUgY2hlYXRlciBhY2hpZXZlbWVudCB3aGVuIHNlbGxpbmcgYnVpbGRpbmdzIHRoYXQgaGF2ZSBhIGhpZ2hlciBwcmljZSB0aGFuIHRoZXkgdXNlZCB0bwogICAgICAgICAgICB0aGlzLmFtb3VudC0tOwogICAgICAgICAgICBwcmljZSA9IHRoaXMuZ2V0UHJpY2UoKTsKICAgICAgICAgICAgdGhpcy5wcmljZSA9IHByaWNlOwogICAgICAgICAgICBpZiAodGhpcy5zZWxsRnVuY3Rpb24pIHRoaXMuc2VsbEZ1bmN0aW9uKCk7CiAgICAgICAgICAgIEdhbWUucmVjYWxjdWxhdGVHYWlucyA9IDE7CiAgICAgICAgICAgIGlmICh0aGlzLmFtb3VudCA9PSAwICYmIHRoaXMuaWQgIT0gMCkKICAgICAgICAgICAgICBsKCJyb3ciICsgdGhpcy5pZCkuY2xhc3NMaXN0LnJlbW92ZSgiZW5hYmxlZCIpOwogICAgICAgICAgICBHYW1lLkJ1aWxkaW5nc093bmVkLS07CiAgICAgICAgICAgIHN1Y2Nlc3MgPSAxOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoc3VjY2VzcyAmJiBHYW1lLmhhc0dvZCkgewogICAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJydWluIik7CiAgICAgICAgICB2YXIgb2xkID0gR2FtZS5oYXNCdWZmKCJEZXZhc3RhdGlvbiIpOwogICAgICAgICAgaWYgKG9sZCkgewogICAgICAgICAgICBpZiAoZ29kTHZsID09IDEpIG9sZC5tdWx0Q2xpY2sgKz0gc29sZCAqIDAuMDE7CiAgICAgICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAyKSBvbGQubXVsdENsaWNrICs9IHNvbGQgKiAwLjAwNTsKICAgICAgICAgICAgZWxzZSBpZiAoZ29kTHZsID09IDMpIG9sZC5tdWx0Q2xpY2sgKz0gc29sZCAqIDAuMDAyNTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmIChnb2RMdmwgPT0gMSkgR2FtZS5nYWluQnVmZigiZGV2YXN0YXRpb24iLCAxMCwgMSArIHNvbGQgKiAwLjAxKTsKICAgICAgICAgICAgZWxzZSBpZiAoZ29kTHZsID09IDIpCiAgICAgICAgICAgICAgR2FtZS5nYWluQnVmZigiZGV2YXN0YXRpb24iLCAxMCwgMSArIHNvbGQgKiAwLjAwNSk7CiAgICAgICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAzKQogICAgICAgICAgICAgIEdhbWUuZ2FpbkJ1ZmYoImRldmFzdGF0aW9uIiwgMTAsIDEgKyBzb2xkICogMC4wMDI1KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKAogICAgICAgICAgc3VjY2VzcyAmJgogICAgICAgICAgR2FtZS5zaGltbWVyVHlwZXNbImdvbGRlbiJdLm4gPD0gMCAmJgogICAgICAgICAgR2FtZS5hdXJhTXVsdCgiRHJhZ29uIE9yYnMiKSA+IDAKICAgICAgICApIHsKICAgICAgICAgIHZhciBoaWdoZXN0QnVpbGRpbmcgPSAwOwogICAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1tpXS5hbW91bnQgPiAwKSBoaWdoZXN0QnVpbGRpbmcgPSBHYW1lLk9iamVjdHNbaV07CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIGhpZ2hlc3RCdWlsZGluZyA9PSB0aGlzICYmCiAgICAgICAgICAgIE1hdGgucmFuZG9tKCkgPCBHYW1lLmF1cmFNdWx0KCJEcmFnb24gT3JicyIpICogMC4xCiAgICAgICAgICApIHsKICAgICAgICAgICAgdmFyIGJ1ZmZzTiA9IDA7CiAgICAgICAgICAgIGZvciAodmFyIGlpIGluIEdhbWUuYnVmZnMpIHsKICAgICAgICAgICAgICBidWZmc04rKzsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoYnVmZnNOID09IDApIHsKICAgICAgICAgICAgICBuZXcgR2FtZS5zaGltbWVyKCJnb2xkZW4iKTsKICAgICAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgICAgIEVOID8gIkRyYWdvbiBPcmJzISIgOiBsb2MoIkRyYWdvbiBPcmJzIiksCiAgICAgICAgICAgICAgICBsb2MoIldpc2ggZ3JhbnRlZC4gR29sZGVuIGNvb2tpZSBzcGF3bmVkLiIpLAogICAgICAgICAgICAgICAgWzMzLCAyNV0KICAgICAgICAgICAgICApOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChzdWNjZXNzKSB7CiAgICAgICAgICBQbGF5U291bmQoInNuZC9zZWxsIiArIGNob29zZShbMSwgMiwgMywgNF0pICsgIi5tcDMiLCAwLjc1KTsKICAgICAgICAgIHRoaXMucmVmcmVzaCgpOwogICAgICAgIH0KICAgICAgICAvL2lmIChtb25pPjApIEdhbWUuTm90aWZ5KHRoaXMubmFtZSwnU29sZCA8Yj4nK3NvbGQrJzwvYj4gZm9yICcrQmVhdXRpZnkobW9uaSkrJyBjb29raWVzJywnJywyKTsKICAgICAgfTsKICAgICAgdGhpcy5zYWNyaWZpY2UgPSBmdW5jdGlvbiAoCiAgICAgICAgYW1vdW50IC8vc2VsbCB3aXRob3V0IGdldHRpbmcgYmFjayBhbnkgbW9uZXkKICAgICAgKSB7CiAgICAgICAgdmFyIHN1Y2Nlc3MgPSAwOwogICAgICAgIC8vdmFyIG1vbmk9MDsKICAgICAgICB2YXIgc29sZCA9IDA7CiAgICAgICAgaWYgKGFtb3VudCA9PSAtMSkgYW1vdW50ID0gdGhpcy5hbW91bnQ7CiAgICAgICAgaWYgKCFhbW91bnQpIGFtb3VudCA9IDE7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhbW91bnQ7IGkrKykgewogICAgICAgICAgdmFyIHByaWNlID0gdGhpcy5nZXRQcmljZSgpOwogICAgICAgICAgcHJpY2UgPSBNYXRoLmZsb29yKHByaWNlICogMC41KTsKICAgICAgICAgIGlmICh0aGlzLmFtb3VudCA+IDApIHsKICAgICAgICAgICAgc29sZCsrOwogICAgICAgICAgICAvL21vbmkrPXByaWNlOwogICAgICAgICAgICAvL0dhbWUuY29va2llcys9cHJpY2U7CiAgICAgICAgICAgIC8vR2FtZS5jb29raWVzRWFybmVkPU1hdGgubWF4KEdhbWUuY29va2llcyxHYW1lLmNvb2tpZXNFYXJuZWQpOwogICAgICAgICAgICB0aGlzLmFtb3VudC0tOwogICAgICAgICAgICBwcmljZSA9IHRoaXMuZ2V0UHJpY2UoKTsKICAgICAgICAgICAgdGhpcy5wcmljZSA9IHByaWNlOwogICAgICAgICAgICBpZiAodGhpcy5zZWxsRnVuY3Rpb24pIHRoaXMuc2VsbEZ1bmN0aW9uKCk7CiAgICAgICAgICAgIEdhbWUucmVjYWxjdWxhdGVHYWlucyA9IDE7CiAgICAgICAgICAgIGlmICh0aGlzLmFtb3VudCA9PSAwICYmIHRoaXMuaWQgIT0gMCkKICAgICAgICAgICAgICBsKCJyb3ciICsgdGhpcy5pZCkuY2xhc3NMaXN0LnJlbW92ZSgiZW5hYmxlZCIpOwogICAgICAgICAgICBHYW1lLkJ1aWxkaW5nc093bmVkLS07CiAgICAgICAgICAgIHN1Y2Nlc3MgPSAxOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoc3VjY2VzcykgewogICAgICAgICAgdGhpcy5yZWZyZXNoKCk7CiAgICAgICAgfQogICAgICAgIC8vaWYgKG1vbmk+MCkgR2FtZS5Ob3RpZnkodGhpcy5uYW1lLCdTb2xkIDxiPicrc29sZCsnPC9iPiBmb3IgJytCZWF1dGlmeShtb25pKSsnIGNvb2tpZXMnLCcnLDIpOwogICAgICB9OwogICAgICB0aGlzLmJ1eUZyZWUgPSBmdW5jdGlvbiAoCiAgICAgICAgYW1vdW50IC8vdW5saWtlIGdldEZyZWUsIHRoaXMgc3RpbGwgaW5jcmVhc2VzIHRoZSBwcmljZQogICAgICApIHsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFtb3VudDsgaSsrKSB7CiAgICAgICAgICBpZiAoR2FtZS5jb29raWVzID49IHByaWNlKSB7CiAgICAgICAgICAgIHRoaXMuYW1vdW50Kys7CiAgICAgICAgICAgIHRoaXMuYm91Z2h0Kys7CiAgICAgICAgICAgIHRoaXMucHJpY2UgPSB0aGlzLmdldFByaWNlKCk7CiAgICAgICAgICAgIEdhbWUucmVjYWxjdWxhdGVHYWlucyA9IDE7CiAgICAgICAgICAgIGlmICh0aGlzLmFtb3VudCA9PSAxICYmIHRoaXMuaWQgIT0gMCkKICAgICAgICAgICAgICBsKCJyb3ciICsgdGhpcy5pZCkuY2xhc3NMaXN0LmFkZCgiZW5hYmxlZCIpOwogICAgICAgICAgICB0aGlzLmhpZ2hlc3QgPSBNYXRoLm1heCh0aGlzLmhpZ2hlc3QsIHRoaXMuYW1vdW50KTsKICAgICAgICAgICAgR2FtZS5CdWlsZGluZ3NPd25lZCsrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0aGlzLnJlZnJlc2goKTsKICAgICAgfTsKICAgICAgdGhpcy5nZXRGcmVlID0gZnVuY3Rpb24gKAogICAgICAgIGFtb3VudCAvL2dldCBYIG9mIHRoaXMgYnVpbGRpbmcgZm9yIGZyZWUsIHdpdGggdGhlIHByaWNlIGJlaGF2aW5nIGFzIGlmIHlvdSBzdGlsbCBkaWRuJ3QgaGF2ZSB0aGVtCiAgICAgICkgewogICAgICAgIHRoaXMuYW1vdW50ICs9IGFtb3VudDsKICAgICAgICB0aGlzLmJvdWdodCArPSBhbW91bnQ7CiAgICAgICAgdGhpcy5mcmVlICs9IGFtb3VudDsKICAgICAgICB0aGlzLmhpZ2hlc3QgPSBNYXRoLm1heCh0aGlzLmhpZ2hlc3QsIHRoaXMuYW1vdW50KTsKICAgICAgICBHYW1lLkJ1aWxkaW5nc093bmVkICs9IGFtb3VudDsKICAgICAgICB0aGlzLmhpZ2hlc3QgPSBNYXRoLm1heCh0aGlzLmhpZ2hlc3QsIHRoaXMuYW1vdW50KTsKICAgICAgICB0aGlzLnJlZnJlc2goKTsKICAgICAgfTsKICAgICAgdGhpcy5nZXRGcmVlUmFua3MgPSBmdW5jdGlvbiAoCiAgICAgICAgYW1vdW50IC8vdGhpcyBidWlsZGluZydzIHByaWNlIGJlaGF2ZXMgYXMgaWYgeW91IGhhZCBYIGxlc3Mgb2YgaXQKICAgICAgKSB7CiAgICAgICAgdGhpcy5mcmVlICs9IGFtb3VudDsKICAgICAgICB0aGlzLnJlZnJlc2goKTsKICAgICAgfTsKCiAgICAgIHRoaXMudG9vbHRpcCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgbWUgPSB0aGlzOwogICAgICAgIHZhciBhcmlhVGV4dCA9ICIiOwogICAgICAgIHZhciBkZXNjID0gbWUuZGVzYzsKICAgICAgICB2YXIgbmFtZSA9IG1lLmRuYW1lOwogICAgICAgIGlmIChHYW1lLnNlYXNvbiA9PSAiZm9vbHMiKSB7CiAgICAgICAgICBpZiAoIUdhbWUuZm9vbE9iamVjdHNbbWUubmFtZV0pIHsKICAgICAgICAgICAgbmFtZSA9IEdhbWUuZm9vbE9iamVjdHNbIlVua25vd24iXS5uYW1lOwogICAgICAgICAgICBkZXNjID0gR2FtZS5mb29sT2JqZWN0c1siVW5rbm93biJdLmRlc2M7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuYW1lID0gR2FtZS5mb29sT2JqZWN0c1ttZS5uYW1lXS5uYW1lOwogICAgICAgICAgICBkZXNjID0gR2FtZS5mb29sT2JqZWN0c1ttZS5uYW1lXS5kZXNjOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB2YXIgaWNvbiA9IFttZS5pY29uQ29sdW1uLCAwXTsKICAgICAgICBpZiAobWUubG9ja2VkKSB7CiAgICAgICAgICBuYW1lID0gIj8/PyI7CiAgICAgICAgICBkZXNjID0gIj8/PyI7CiAgICAgICAgICBpY29uID0gWzAsIDddOwogICAgICAgIH0KICAgICAgICAvL2lmIChsKCdyb3dJbmZvJyttZS5pZCkgJiYgR2FtZS5kcmF3VCUxMD09MCkgbCgncm93SW5mb0NvbnRlbnQnK21lLmlkKS5pbm5lckhUTUw9JyZidWxsOyAnK21lLmFtb3VudCsnICcrKG1lLmFtb3VudD09MT9tZS5zaW5nbGU6bWUucGx1cmFsKSsnPGJyPiZidWxsOyBwcm9kdWNpbmcgJytCZWF1dGlmeShtZS5zdG9yZWRUb3RhbENwcywxKSsnICcrKG1lLnN0b3JlZFRvdGFsQ3BzPT0xPydjb29raWUnOidjb29raWVzJykrJyBwZXIgc2Vjb25kPGJyPiZidWxsOyB0b3RhbCA6ICcrQmVhdXRpZnkobWUudG90YWxDb29raWVzKSsnICcrKE1hdGguZmxvb3IobWUudG90YWxDb29raWVzKT09MT8nY29va2llJzonY29va2llcycpKycgJyttZS5hY3Rpb25OYW1lOwoKICAgICAgICB2YXIgY2FuQnV5ID0gZmFsc2U7CiAgICAgICAgdmFyIHByaWNlID0gbWUuYnVsa1ByaWNlOwogICAgICAgIGlmICgKICAgICAgICAgIChHYW1lLmJ1eU1vZGUgPT0gMSAmJiBHYW1lLmNvb2tpZXMgPj0gcHJpY2UpIHx8CiAgICAgICAgICAoR2FtZS5idXlNb2RlID09IC0xICYmIG1lLmFtb3VudCA+IDApCiAgICAgICAgKQogICAgICAgICAgY2FuQnV5ID0gdHJ1ZTsKCiAgICAgICAgdmFyIHN5bmVyZ2llc1N0ciA9ICIiOwogICAgICAgIC8vbm90ZSA6IG1pZ2h0IG5vdCBiZSBlbnRpcmVseSBhY2N1cmF0ZSwgbWF0aCBtYXkgbmVlZCBjaGVja2luZwogICAgICAgIGlmIChtZS5hbW91bnQgPiAwKSB7CiAgICAgICAgICB2YXIgc3luZXJnaWVzV2l0aCA9IHt9OwogICAgICAgICAgdmFyIHN5bmVyZ3lCb29zdCA9IDA7CgogICAgICAgICAgaWYgKG1lLm5hbWUgPT0gIkdyYW5kbWEiKSB7CiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5HcmFuZG1hU3luZXJnaWVzKSB7CiAgICAgICAgICAgICAgaWYgKEdhbWUuSGFzKEdhbWUuR3JhbmRtYVN5bmVyZ2llc1tpXSkpIHsKICAgICAgICAgICAgICAgIHZhciBvdGhlciA9IEdhbWUuVXBncmFkZXNbR2FtZS5HcmFuZG1hU3luZXJnaWVzW2ldXS5idWlsZGluZ1RpZTsKICAgICAgICAgICAgICAgIHZhciBtdWx0ID0gbWUuYW1vdW50ICogMC4wMSAqICgxIC8gKG90aGVyLmlkIC0gMSkpOwogICAgICAgICAgICAgICAgdmFyIGJvb3N0ID0KICAgICAgICAgICAgICAgICAgb3RoZXIuc3RvcmVkVG90YWxDcHMgKiBHYW1lLmdsb2JhbENwc011bHQgLQogICAgICAgICAgICAgICAgICAob3RoZXIuc3RvcmVkVG90YWxDcHMgKiBHYW1lLmdsb2JhbENwc011bHQpIC8gKDEgKyBtdWx0KTsKICAgICAgICAgICAgICAgIHN5bmVyZ3lCb29zdCArPSBib29zdDsKICAgICAgICAgICAgICAgIGlmICghc3luZXJnaWVzV2l0aFtvdGhlci5wbHVyYWxdKQogICAgICAgICAgICAgICAgICBzeW5lcmdpZXNXaXRoW290aGVyLnBsdXJhbF0gPSAwOwogICAgICAgICAgICAgICAgc3luZXJnaWVzV2l0aFtvdGhlci5wbHVyYWxdICs9IG11bHQ7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKG1lLm5hbWUgPT0gIlBvcnRhbCIgJiYgR2FtZS5IYXMoIkVsZGVyIFBhY3QiKSkgewogICAgICAgICAgICB2YXIgb3RoZXIgPSBHYW1lLk9iamVjdHNbIkdyYW5kbWEiXTsKICAgICAgICAgICAgdmFyIGJvb3N0ID0gbWUuYW1vdW50ICogMC4wNSAqIG90aGVyLmFtb3VudCAqIEdhbWUuZ2xvYmFsQ3BzTXVsdDsKICAgICAgICAgICAgc3luZXJneUJvb3N0ICs9IGJvb3N0OwogICAgICAgICAgICBpZiAoIXN5bmVyZ2llc1dpdGhbb3RoZXIucGx1cmFsXSkgc3luZXJnaWVzV2l0aFtvdGhlci5wbHVyYWxdID0gMDsKICAgICAgICAgICAgc3luZXJnaWVzV2l0aFtvdGhlci5wbHVyYWxdICs9CiAgICAgICAgICAgICAgYm9vc3QgLyAob3RoZXIuc3RvcmVkVG90YWxDcHMgKiBHYW1lLmdsb2JhbENwc011bHQpOwogICAgICAgICAgfQoKICAgICAgICAgIGZvciAodmFyIGkgaW4gbWUuc3luZXJnaWVzKSB7CiAgICAgICAgICAgIHZhciBpdCA9IG1lLnN5bmVyZ2llc1tpXTsKICAgICAgICAgICAgaWYgKEdhbWUuSGFzKGl0Lm5hbWUpKSB7CiAgICAgICAgICAgICAgdmFyIHdlaWdodCA9IDAuMDU7CiAgICAgICAgICAgICAgdmFyIG90aGVyID0gaXQuYnVpbGRpbmdUaWUxOwogICAgICAgICAgICAgIGlmIChtZSA9PSBpdC5idWlsZGluZ1RpZTEpIHsKICAgICAgICAgICAgICAgIHdlaWdodCA9IDAuMDAxOwogICAgICAgICAgICAgICAgb3RoZXIgPSBpdC5idWlsZGluZ1RpZTI7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHZhciBib29zdCA9CiAgICAgICAgICAgICAgICBvdGhlci5zdG9yZWRUb3RhbENwcyAqIEdhbWUuZ2xvYmFsQ3BzTXVsdCAtCiAgICAgICAgICAgICAgICAob3RoZXIuc3RvcmVkVG90YWxDcHMgKiBHYW1lLmdsb2JhbENwc011bHQpIC8KICAgICAgICAgICAgICAgICAgKDEgKyBtZS5hbW91bnQgKiB3ZWlnaHQpOwogICAgICAgICAgICAgIHN5bmVyZ3lCb29zdCArPSBib29zdDsKICAgICAgICAgICAgICBpZiAoIXN5bmVyZ2llc1dpdGhbb3RoZXIucGx1cmFsXSkgc3luZXJnaWVzV2l0aFtvdGhlci5wbHVyYWxdID0gMDsKICAgICAgICAgICAgICBzeW5lcmdpZXNXaXRoW290aGVyLnBsdXJhbF0gKz0gbWUuYW1vdW50ICogd2VpZ2h0OwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoc3luZXJneUJvb3N0ID4gMCkgewogICAgICAgICAgICBmb3IgKHZhciBpIGluIHN5bmVyZ2llc1dpdGgpIHsKICAgICAgICAgICAgICBpZiAoc3luZXJnaWVzU3RyICE9ICIiKSBzeW5lcmdpZXNTdHIgKz0gIiwgIjsKICAgICAgICAgICAgICBzeW5lcmdpZXNTdHIgKz0KICAgICAgICAgICAgICAgICc8c3BhbiBzdHlsZT0iY29sb3I6I2ZmZjtmb250LXdlaWdodDpib2xkO2ZvbnQtc2l6ZTo4MCU7YmFja2dyb3VuZDojMDAwO2JveC1zaGFkb3c6MHB4IDBweCAwcHggMXB4IHJnYmEoMjU1LDI1NSwyNTUsMC4yKTtib3JkZXItcmFkaXVzOjNweDtwYWRkaW5nOjBweCAycHg7ZGlzcGxheTppbmxpbmUtYmxvY2s7Ij4nICsKICAgICAgICAgICAgICAgIGkgKwogICAgICAgICAgICAgICAgIiArIiArCiAgICAgICAgICAgICAgICBCZWF1dGlmeShzeW5lcmdpZXNXaXRoW2ldICogMTAwLCAxKSArCiAgICAgICAgICAgICAgICAiJTwvc3Bhbj4iOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHN5bmVyZ2llc1N0ciA9CiAgICAgICAgICAgICAgbG9jKCIuLi5hbHNvIGJvb3N0aW5nIHNvbWUgb3RoZXIgYnVpbGRpbmdzOiIpICsKICAgICAgICAgICAgICAiICIgKwogICAgICAgICAgICAgIHN5bmVyZ2llc1N0ciArCiAgICAgICAgICAgICAgIiAtICIgKwogICAgICAgICAgICAgIGxvYygKICAgICAgICAgICAgICAgICJhbGwgY29tYmluZWQsIHRoZXNlIGJvb3N0cyBhY2NvdW50IGZvciA8Yj4lMTwvYj4gcGVyIHNlY29uZCAoPGI+JTIlPC9iPiBvZiB0b3RhbCBDcFMpIiwKICAgICAgICAgICAgICAgIFsKICAgICAgICAgICAgICAgICAgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoc3luZXJneUJvb3N0LCAxKSksCiAgICAgICAgICAgICAgICAgIEJlYXV0aWZ5KChzeW5lcmd5Qm9vc3QgLyBHYW1lLmNvb2tpZXNQcykgKiAxMDAsIDEpLAogICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoR2FtZS5wcmVmcy5zY3JlZW5yZWFkZXIpIHsKICAgICAgICAgIGlmIChtZS5sb2NrZWQpIGFyaWFUZXh0ID0gIlRoaXMgYnVpbGRpbmcgaXMgbm90IHlldCB1bmxvY2tlZC4gIjsKICAgICAgICAgIGVsc2UgYXJpYVRleHQgPSBuYW1lICsgIi4gIjsKICAgICAgICAgIGlmICghbWUubG9ja2VkKSBhcmlhVGV4dCArPSAiWW91IG93biAiICsgbWUuYW1vdW50ICsgIi4gIjsKICAgICAgICAgIGFyaWFUZXh0ICs9CiAgICAgICAgICAgIChjYW5CdXkgPyAiQ2FuIGJ1eSAxIGZvciIgOiAiQ2Fubm90IGFmZm9yZCB0aGUiKSArCiAgICAgICAgICAgICIgIiArCiAgICAgICAgICAgIEJlYXV0aWZ5KE1hdGgucm91bmQocHJpY2UpKSArCiAgICAgICAgICAgICIgY29va2llcy4gIjsKICAgICAgICAgIGlmICghbWUubG9ja2VkICYmIG1lLnRvdGFsQ29va2llcyA+IDApIHsKICAgICAgICAgICAgYXJpYVRleHQgKz0KICAgICAgICAgICAgICAiRWFjaCAiICsKICAgICAgICAgICAgICBtZS5zaW5nbGUgKwogICAgICAgICAgICAgICIgcHJvZHVjZXMgIiArCiAgICAgICAgICAgICAgQmVhdXRpZnkoCiAgICAgICAgICAgICAgICAobWUuc3RvcmVkVG90YWxDcHMgLyBtZS5hbW91bnQpICogR2FtZS5nbG9iYWxDcHNNdWx0LAogICAgICAgICAgICAgICAgMQogICAgICAgICAgICAgICkgKwogICAgICAgICAgICAgICIgY29va2llcyBwZXIgc2Vjb25kLiAiOwogICAgICAgICAgICBhcmlhVGV4dCArPQogICAgICAgICAgICAgIEJlYXV0aWZ5KG1lLnRvdGFsQ29va2llcykgKwogICAgICAgICAgICAgICIgY29va2llcyAiICsKICAgICAgICAgICAgICBtZS5hY3Rpb25OYW1lICsKICAgICAgICAgICAgICAiIHNvIGZhci4gIjsKICAgICAgICAgIH0KICAgICAgICAgIGlmICghbWUubG9ja2VkKSBhcmlhVGV4dCArPSBkZXNjOwoKICAgICAgICAgIHZhciBhcmlhTGFiZWwgPSBsKCJhcmlhUmVhZGVyLXByb2R1Y3QtIiArIG1lLmlkKTsKICAgICAgICAgIGlmIChhcmlhTGFiZWwpCiAgICAgICAgICAgIGFyaWFMYWJlbC5pbm5lckhUTUwgPSBhcmlhVGV4dC5yZXBsYWNlKC8oPChbXj5dKyk+KS9naSwgIiAiKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiAoCiAgICAgICAgICAnPGRpdiBzdHlsZT0icG9zaXRpb246YWJzb2x1dGU7bGVmdDoxcHg7dG9wOjFweDtyaWdodDoxcHg7Ym90dG9tOjFweDtiYWNrZ3JvdW5kOmxpbmVhci1ncmFkaWVudCgxMjVkZWcsJyArCiAgICAgICAgICAoZmFsc2UKICAgICAgICAgICAgPyAicmdiYSgxNSwxMTUsMTMwLDEpIDAlLHJnYmEoMTUsMTE1LDEzMCwwKSIKICAgICAgICAgICAgOiAicmdiYSg1MCw0MCw0MCwxKSAwJSxyZ2JhKDUwLDQwLDQwLDApIikgKwogICAgICAgICAgJyAyMCUpO21peC1ibGVuZC1tb2RlOnNjcmVlbjt6LWluZGV4OjE7Ij48L2Rpdj48ZGl2IHN0eWxlPSJ6LWluZGV4OjEwO21pbi13aWR0aDozNTBweDtwYWRkaW5nOjhweDtwb3NpdGlvbjpyZWxhdGl2ZTsiIGlkPSJ0b29sdGlwQnVpbGRpbmciPjxkaXYgY2xhc3M9Imljb24iIHN0eWxlPSJmbG9hdDpsZWZ0O21hcmdpbi1sZWZ0Oi04cHg7bWFyZ2luLXRvcDotOHB4OycgKwogICAgICAgICAgd3JpdGVJY29uKGljb24pICsKICAgICAgICAgICciPjwvZGl2PjxkaXYgc3R5bGU9ImZsb2F0OnJpZ2h0O3RleHQtYWxpZ246cmlnaHQ7Ij48c3BhbiBjbGFzcz0icHJpY2UnICsKICAgICAgICAgIChjYW5CdXkgPyAiIiA6ICIgZGlzYWJsZWQiKSArCiAgICAgICAgICAnIj4nICsKICAgICAgICAgIEJlYXV0aWZ5KE1hdGgucm91bmQocHJpY2UpKSArCiAgICAgICAgICAiPC9zcGFuPiIgKwogICAgICAgICAgR2FtZS5jb3N0RGV0YWlscyhwcmljZSkgKwogICAgICAgICAgJzwvZGl2PjxkaXYgY2xhc3M9Im5hbWUiPicgKwogICAgICAgICAgbmFtZSArCiAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAnPHNtYWxsPjxkaXYgY2xhc3M9InRhZyI+JyArCiAgICAgICAgICBsb2MoIm93bmVkOiAlMSIsIG1lLmFtb3VudCkgKwogICAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICAgKG1lLmZyZWUgPiAwCiAgICAgICAgICAgID8gJzxkaXYgY2xhc3M9InRhZyI+JyArIGxvYygiZnJlZTogJTEhIiwgbWUuZnJlZSkgKyAiPC9kaXY+IgogICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAiPC9zbWFsbD4iICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj48ZGl2IGNsYXNzPSJkZXNjcmlwdGlvbiI+PHE+JyArCiAgICAgICAgICBkZXNjICsKICAgICAgICAgICI8L3E+PC9kaXY+IiArCiAgICAgICAgICAobWUudG90YWxDb29raWVzID4gMAogICAgICAgICAgICA/ICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICAgICAgICAobWUuYW1vdW50ID4gMAogICAgICAgICAgICAgICAgPyAnPGRpdiBjbGFzcz0iZGVzY3JpcHRpb25CbG9jayI+JyArCiAgICAgICAgICAgICAgICAgIGxvYygiZWFjaCAlMSBwcm9kdWNlcyA8Yj4lMjwvYj4gcGVyIHNlY29uZCIsIFsKICAgICAgICAgICAgICAgICAgICBtZS5zaW5nbGUsCiAgICAgICAgICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICAgICAgICAgIiUxIGNvb2tpZSIsCiAgICAgICAgICAgICAgICAgICAgICBMQmVhdXRpZnkoCiAgICAgICAgICAgICAgICAgICAgICAgIChtZS5zdG9yZWRUb3RhbENwcyAvIG1lLmFtb3VudCkgKiBHYW1lLmdsb2JhbENwc011bHQsCiAgICAgICAgICAgICAgICAgICAgICAgIDEKICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICI8L2Rpdj4iCiAgICAgICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImRlc2NyaXB0aW9uQmxvY2siPicgKwogICAgICAgICAgICAgIGxvYygiJTEgcHJvZHVjaW5nIDxiPiUyPC9iPiBwZXIgc2Vjb25kIiwgWwogICAgICAgICAgICAgICAgbG9jKCIlMSAiICsgbWUuYnNpbmdsZSwgTEJlYXV0aWZ5KG1lLmFtb3VudCkpLAogICAgICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICAgICAiJTEgY29va2llIiwKICAgICAgICAgICAgICAgICAgTEJlYXV0aWZ5KG1lLnN0b3JlZFRvdGFsQ3BzICogR2FtZS5nbG9iYWxDcHNNdWx0LCAxKQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgIiAoIiArCiAgICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICAgIjxiPiUxJTwvYj4gb2YgdG90YWwgQ3BTIiwKICAgICAgICAgICAgICAgIEJlYXV0aWZ5KAogICAgICAgICAgICAgICAgICBHYW1lLmNvb2tpZXNQcyA+IDAKICAgICAgICAgICAgICAgICAgICA/IChtZS5hbW91bnQgPiAwCiAgICAgICAgICAgICAgICAgICAgICAgID8gKG1lLnN0b3JlZFRvdGFsQ3BzICogR2FtZS5nbG9iYWxDcHNNdWx0KSAvCiAgICAgICAgICAgICAgICAgICAgICAgICAgR2FtZS5jb29raWVzUHMKICAgICAgICAgICAgICAgICAgICAgICAgOiAwKSAqIDEwMAogICAgICAgICAgICAgICAgICAgIDogMCwKICAgICAgICAgICAgICAgICAgMQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICkgKwogICAgICAgICAgICAgICIpPC9kaXY+IiArCiAgICAgICAgICAgICAgKHN5bmVyZ2llc1N0cgogICAgICAgICAgICAgICAgPyAnPGRpdiBjbGFzcz0iZGVzY3JpcHRpb25CbG9jayI+JyArIHN5bmVyZ2llc1N0ciArICI8L2Rpdj4iCiAgICAgICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAgICAgKEVOCiAgICAgICAgICAgICAgICA/ICc8ZGl2IGNsYXNzPSJkZXNjcmlwdGlvbkJsb2NrIj48Yj4nICsKICAgICAgICAgICAgICAgICAgQmVhdXRpZnkobWUudG90YWxDb29raWVzKSArCiAgICAgICAgICAgICAgICAgICI8L2I+ICIgKwogICAgICAgICAgICAgICAgICAoTWF0aC5mbG9vcihtZS50b3RhbENvb2tpZXMpID09IDEgPyAiY29va2llIiA6ICJjb29raWVzIikgKwogICAgICAgICAgICAgICAgICAiICIgKwogICAgICAgICAgICAgICAgICBtZS5hY3Rpb25OYW1lICsKICAgICAgICAgICAgICAgICAgIiBzbyBmYXI8L2Rpdj4iCiAgICAgICAgICAgICAgICA6ICc8ZGl2IGNsYXNzPSJkZXNjcmlwdGlvbkJsb2NrIj4nICsKICAgICAgICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICAgICAgICI8Yj4lMTwvYj4gcHJvZHVjZWQgc28gZmFyIiwKICAgICAgICAgICAgICAgICAgICBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeShtZS50b3RhbENvb2tpZXMpKQogICAgICAgICAgICAgICAgICApICsKICAgICAgICAgICAgICAgICAgIjwvZGl2PiIpCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICI8L2Rpdj4iCiAgICAgICAgKTsKICAgICAgfTsKICAgICAgdGhpcy5sZXZlbFRvb2x0aXAgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgICByZXR1cm4gKAogICAgICAgICAgJzxkaXYgc3R5bGU9IndpZHRoOjI4MHB4O3BhZGRpbmc6OHB4OyIgaWQ9InRvb2x0aXBMZXZlbCI+PGI+JyArCiAgICAgICAgICBsb2MoIkxldmVsICUxICUyIiwgW0JlYXV0aWZ5KG1lLmxldmVsKSwgbWUucGx1cmFsXSkgKwogICAgICAgICAgJzwvYj48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICAgIChFTgogICAgICAgICAgICA/IChtZS5sZXZlbCA9PSAxID8gbWUuZXh0cmFOYW1lIDogbWUuZXh0cmFQbHVyYWwpLnJlcGxhY2UoCiAgICAgICAgICAgICAgICAiW1hdIiwKICAgICAgICAgICAgICAgIEJlYXV0aWZ5KG1lLmxldmVsKQogICAgICAgICAgICAgICkgKwogICAgICAgICAgICAgICIgZ3JhbnRpbmcgPGI+KyIgKwogICAgICAgICAgICAgIEJlYXV0aWZ5KG1lLmxldmVsKSArCiAgICAgICAgICAgICAgIiUgIiArCiAgICAgICAgICAgICAgbWUuZG5hbWUgKwogICAgICAgICAgICAgICIgQ3BTPC9iPi4iCiAgICAgICAgICAgIDogbG9jKCJHcmFudGluZyA8Yj4rJTElICUyIENwUzwvYj4uIiwgWwogICAgICAgICAgICAgICAgQmVhdXRpZnkobWUubGV2ZWwpLAogICAgICAgICAgICAgICAgbWUuc2luZ2xlLAogICAgICAgICAgICAgIF0pKSArCiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgICBsb2MoCiAgICAgICAgICAgICJDbGljayB0byBsZXZlbCB1cCBmb3IgJTEuIiwKICAgICAgICAgICAgJzxzcGFuIGNsYXNzPSJwcmljZSBsdW1wJyArCiAgICAgICAgICAgICAgKEdhbWUubHVtcHMgPj0gbWUubGV2ZWwgKyAxID8gIiIgOiAiIGRpc2FibGVkIikgKwogICAgICAgICAgICAgICciPicgKwogICAgICAgICAgICAgIGxvYygiJTEgc3VnYXIgbHVtcCIsIExCZWF1dGlmeShtZS5sZXZlbCArIDEpKSArCiAgICAgICAgICAgICAgIjwvc3Bhbj4iCiAgICAgICAgICApICsKICAgICAgICAgIChtZS5sZXZlbCA9PSAwICYmIG1lLm1pbmlnYW1lVXJsCiAgICAgICAgICAgID8gJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PjxiPicgKwogICAgICAgICAgICAgIGxvYygiTGV2ZWxsaW5nIHVwIHRoaXMgYnVpbGRpbmcgdW5sb2NrcyBhIG1pbmlnYW1lLiIpICsKICAgICAgICAgICAgICAiPC9iPiIKICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgIjwvZGl2PiIKICAgICAgICApOwogICAgICB9OwogICAgICB0aGlzLmxldmVsVXAgPSAoZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChmcmVlKSB7CiAgICAgICAgICBHYW1lLnNwZW5kTHVtcCgKICAgICAgICAgICAgbWUubGV2ZWwgKyAxLAogICAgICAgICAgICBsb2MoImxldmVsIHVwIHlvdXIgJTEiLCBtZS5wbHVyYWwpLAogICAgICAgICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgbWUubGV2ZWwgKz0gMTsKICAgICAgICAgICAgICBpZiAobWUubGV2ZWwgPj0gMTAgJiYgbWUubGV2ZWxBY2hpZXYxMCkKICAgICAgICAgICAgICAgIEdhbWUuV2luKG1lLmxldmVsQWNoaWV2MTAubmFtZSk7CiAgICAgICAgICAgICAgaWYgKCFmcmVlKSBQbGF5U291bmQoInNuZC91cGdyYWRlLm1wMyIsIDAuNik7CiAgICAgICAgICAgICAgR2FtZS5Mb2FkTWluaWdhbWVzKCk7CiAgICAgICAgICAgICAgbWUucmVmcmVzaCgpOwogICAgICAgICAgICAgIGlmIChsKCJwcm9kdWN0TGV2ZWwiICsgbWUuaWQpKSB7CiAgICAgICAgICAgICAgICB2YXIgcmVjdCA9IGwoInByb2R1Y3RMZXZlbCIgKyBtZS5pZCkuZ2V0Qm91bmRzKCk7CiAgICAgICAgICAgICAgICBHYW1lLlNwYXJrbGVBdCgKICAgICAgICAgICAgICAgICAgKHJlY3QubGVmdCArIHJlY3QucmlnaHQpIC8gMiwKICAgICAgICAgICAgICAgICAgKHJlY3QudG9wICsgcmVjdC5ib3R0b20pIC8gMiAtIDI0ICsgMzIgLSBUb3BCYXJPZmZzZXQKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmIChtZS5taW5pZ2FtZSAmJiBtZS5taW5pZ2FtZS5vbkxldmVsKQogICAgICAgICAgICAgICAgbWUubWluaWdhbWUub25MZXZlbChtZS5sZXZlbCk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGZyZWUKICAgICAgICAgICkoKTsKICAgICAgICB9OwogICAgICB9KSh0aGlzKTsKCiAgICAgIHRoaXMucmVmcmVzaCA9CiAgICAgICAgZnVuY3Rpb24gKCkgLy9zaG93L2hpZGUgdGhlIGJ1aWxkaW5nIGRpc3BsYXkgYmFzZWQgb24gaXRzIGFtb3VudCwgYW5kIHJlZHJhdyBpdAogICAgICAgIHsKICAgICAgICAgIHRoaXMucHJpY2UgPSB0aGlzLmdldFByaWNlKCk7CiAgICAgICAgICBpZiAoR2FtZS5idXlNb2RlID09IDEpCiAgICAgICAgICAgIHRoaXMuYnVsa1ByaWNlID0gdGhpcy5nZXRTdW1QcmljZShHYW1lLmJ1eUJ1bGspOwogICAgICAgICAgZWxzZSBpZiAoR2FtZS5idXlNb2RlID09IC0xICYmIEdhbWUuYnV5QnVsayA9PSAtMSkKICAgICAgICAgICAgdGhpcy5idWxrUHJpY2UgPSB0aGlzLmdldFJldmVyc2VTdW1QcmljZSgxMDAwKTsKICAgICAgICAgIGVsc2UgaWYgKEdhbWUuYnV5TW9kZSA9PSAtMSkKICAgICAgICAgICAgdGhpcy5idWxrUHJpY2UgPSB0aGlzLmdldFJldmVyc2VTdW1QcmljZShHYW1lLmJ1eUJ1bGspOwogICAgICAgICAgdGhpcy5yZWJ1aWxkKCk7CiAgICAgICAgICBpZiAodGhpcy5hbW91bnQgPT0gMCAmJiB0aGlzLmlkICE9IDApCiAgICAgICAgICAgIGwoInJvdyIgKyB0aGlzLmlkKS5jbGFzc0xpc3QucmVtb3ZlKCJlbmFibGVkIik7CiAgICAgICAgICBlbHNlIGlmICh0aGlzLmFtb3VudCA+IDAgJiYgdGhpcy5pZCAhPSAwKQogICAgICAgICAgICBsKCJyb3ciICsgdGhpcy5pZCkuY2xhc3NMaXN0LmFkZCgiZW5hYmxlZCIpOwogICAgICAgICAgaWYgKHRoaXMubXV0ZWQgPiAwICYmIHRoaXMuaWQgIT0gMCkgewogICAgICAgICAgICBsKCJyb3ciICsgdGhpcy5pZCkuY2xhc3NMaXN0LmFkZCgibXV0ZWQiKTsKICAgICAgICAgICAgbCgibXV0ZWRQcm9kdWN0IiArIHRoaXMuaWQpLnN0eWxlLmRpc3BsYXkgPSAiaW5saW5lLWJsb2NrIjsKICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5pZCAhPSAwKSB7CiAgICAgICAgICAgIGwoInJvdyIgKyB0aGlzLmlkKS5jbGFzc0xpc3QucmVtb3ZlKCJtdXRlZCIpOwogICAgICAgICAgICBsKCJtdXRlZFByb2R1Y3QiICsgdGhpcy5pZCkuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICAgIH0KICAgICAgICAgIC8vaWYgKCF0aGlzLm9uTWluaWdhbWUgJiYgIXRoaXMubXV0ZWQpIHt9CiAgICAgICAgICAvL2Vsc2UgdGhpcy5waWNzPVtdOwogICAgICAgIH07CiAgICAgIHRoaXMucmVidWlsZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgbWUgPSB0aGlzOwogICAgICAgIC8vdmFyIGNsYXNzZXM9J3Byb2R1Y3QnOwogICAgICAgIHZhciBwcmljZSA9IG1lLmJ1bGtQcmljZTsKICAgICAgICAvKmlmIChHYW1lLmNvb2tpZXNFYXJuZWQ+PW1lLmJhc2VQcmljZSB8fCBtZS5ib3VnaHQ+MCkge2NsYXNzZXMrPScgdW5sb2NrZWQnO21lLmxvY2tlZD0wO30gZWxzZSB7Y2xhc3Nlcys9JyBsb2NrZWQnO21lLmxvY2tlZD0xO30KCQkJCWlmIChHYW1lLmNvb2tpZXM+PXByaWNlKSBjbGFzc2VzKz0nIGVuYWJsZWQnOyBlbHNlIGNsYXNzZXMrPScgZGlzYWJsZWQnOwoJCQkJaWYgKG1lLmwuY2xhc3NOYW1lLmluZGV4T2YoJ3RvZ2dsZWRPZmYnKSE9LTEpIGNsYXNzZXMrPScgdG9nZ2xlZE9mZic7CgkJCQkqLwogICAgICAgIHZhciBpY29uID0gWzAsIG1lLmljb25dOwogICAgICAgIHZhciBpY29uT2ZmID0gWzEsIG1lLmljb25dOwogICAgICAgIGlmIChtZS5pY29uRnVuYykgaWNvbiA9IG1lLmljb25GdW5jKCk7CgogICAgICAgIHZhciBkZXNjID0gbWUuZGVzYzsKICAgICAgICB2YXIgbmFtZSA9IG1lLmRuYW1lOwogICAgICAgIHZhciBkaXNwbGF5TmFtZSA9IG1lLmRpc3BsYXlOYW1lOwogICAgICAgIGlmIChHYW1lLnNlYXNvbiA9PSAiZm9vbHMiKSB7CiAgICAgICAgICBpZiAoIUdhbWUuZm9vbE9iamVjdHNbbWUubmFtZV0pIHsKICAgICAgICAgICAgaWNvbiA9IFsyLCAwXTsKICAgICAgICAgICAgaWNvbk9mZiA9IFszLCAwXTsKICAgICAgICAgICAgbmFtZSA9IEdhbWUuZm9vbE9iamVjdHNbIlVua25vd24iXS5uYW1lOwogICAgICAgICAgICBkZXNjID0gR2FtZS5mb29sT2JqZWN0c1siVW5rbm93biJdLmRlc2M7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpY29uID0gWzIsIG1lLmljb25dOwogICAgICAgICAgICBpY29uT2ZmID0gWzMsIG1lLmljb25dOwogICAgICAgICAgICBuYW1lID0gR2FtZS5mb29sT2JqZWN0c1ttZS5uYW1lXS5uYW1lOwogICAgICAgICAgICBkZXNjID0gR2FtZS5mb29sT2JqZWN0c1ttZS5uYW1lXS5kZXNjOwogICAgICAgICAgfQogICAgICAgICAgZGlzcGxheU5hbWUgPSBuYW1lOwogICAgICAgICAgLy9pZiAobmFtZS5sZW5ndGg+MTYpIGRpc3BsYXlOYW1lPSc8c3BhbiBzdHlsZT0iZm9udC1zaXplOjc1JTsiPicrbmFtZSsnPC9zcGFuPic7CiAgICAgICAgfSBlbHNlIGlmICghRU4pIGRpc3BsYXlOYW1lID0gbmFtZTsKICAgICAgICAvL2Vsc2UgaWYgKCFFTiAmJiBuYW1lLmxlbmd0aD4xNikgZGlzcGxheU5hbWU9JzxzcGFuIHN0eWxlPSJmb250LXNpemU6NzUlOyI+JytuYW1lKyc8L3NwYW4+JzsKICAgICAgICBpY29uID0gW2ljb25bMF0gKiA2NCwgaWNvblsxXSAqIDY0XTsKICAgICAgICBpY29uT2ZmID0gW2ljb25PZmZbMF0gKiA2NCwgaWNvbk9mZlsxXSAqIDY0XTsKCiAgICAgICAgLy9tZS5sLmNsYXNzTmFtZT1jbGFzc2VzOwogICAgICAgIC8vbCgncHJvZHVjdEljb24nK21lLmlkKS5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2U9J3VybChpbWcvJytpY29uKycpJzsKICAgICAgICBsKCJwcm9kdWN0SWNvbiIgKyBtZS5pZCkuc3R5bGUuYmFja2dyb3VuZFBvc2l0aW9uID0KICAgICAgICAgICItIiArIGljb25bMF0gKyAicHggLSIgKyBpY29uWzFdICsgInB4IjsKICAgICAgICAvL2woJ3Byb2R1Y3RJY29uT2ZmJyttZS5pZCkuc3R5bGUuYmFja2dyb3VuZEltYWdlPSd1cmwoaW1nLycraWNvbk9mZisnKSc7CiAgICAgICAgbCgicHJvZHVjdEljb25PZmYiICsgbWUuaWQpLnN0eWxlLmJhY2tncm91bmRQb3NpdGlvbiA9CiAgICAgICAgICAiLSIgKyBpY29uT2ZmWzBdICsgInB4IC0iICsgaWNvbk9mZlsxXSArICJweCI7CiAgICAgICAgbCgicHJvZHVjdE5hbWUiICsgbWUuaWQpLmlubmVySFRNTCA9IGRpc3BsYXlOYW1lOwogICAgICAgIGlmICgKICAgICAgICAgIG5hbWUubGVuZ3RoID4gMTIgLyBMYW5nc1tsb2NJZF0udyAmJgogICAgICAgICAgKEdhbWUuc2Vhc29uID09ICJmb29scyIgfHwgIUVOKQogICAgICAgICkKICAgICAgICAgIGwoInByb2R1Y3ROYW1lIiArIG1lLmlkKS5jbGFzc0xpc3QuYWRkKCJsb25nUHJvZHVjdE5hbWUiKTsKICAgICAgICBlbHNlIGwoInByb2R1Y3ROYW1lIiArIG1lLmlkKS5jbGFzc0xpc3QucmVtb3ZlKCJsb25nUHJvZHVjdE5hbWUiKTsKICAgICAgICBsKCJwcm9kdWN0T3duZWQiICsgbWUuaWQpLnRleHRDb250ZW50ID0gbWUuYW1vdW50ID8gbWUuYW1vdW50IDogIiI7CiAgICAgICAgbCgicHJvZHVjdFByaWNlIiArIG1lLmlkKS50ZXh0Q29udGVudCA9IEJlYXV0aWZ5KE1hdGgucm91bmQocHJpY2UpKTsKICAgICAgICBsKCJwcm9kdWN0UHJpY2VNdWx0IiArIG1lLmlkKS50ZXh0Q29udGVudCA9CiAgICAgICAgICBHYW1lLmJ1eUJ1bGsgPiAxID8gIngiICsgR2FtZS5idXlCdWxrICsgIiAiIDogIiI7CiAgICAgICAgbCgicHJvZHVjdExldmVsIiArIG1lLmlkKS50ZXh0Q29udGVudCA9ICJsdmwgIiArIEJlYXV0aWZ5KG1lLmxldmVsKTsKICAgICAgICBpZiAoR2FtZS5pc01pbmlnYW1lUmVhZHkobWUpICYmIEdhbWUuYXNjZW5zaW9uTW9kZSAhPSAxKSB7CiAgICAgICAgICBsKCJwcm9kdWN0TWluaWdhbWVCdXR0b24iICsgbWUuaWQpLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICAgICAgaWYgKCFtZS5vbk1pbmlnYW1lKQogICAgICAgICAgICBsKCJwcm9kdWN0TWluaWdhbWVCdXR0b24iICsgbWUuaWQpLnRleHRDb250ZW50ID0gbG9jKAogICAgICAgICAgICAgICJWaWV3ICUxIiwKICAgICAgICAgICAgICBtZS5taW5pZ2FtZU5hbWUKICAgICAgICAgICAgKTsKICAgICAgICAgIGVsc2UKICAgICAgICAgICAgbCgicHJvZHVjdE1pbmlnYW1lQnV0dG9uIiArIG1lLmlkKS50ZXh0Q29udGVudCA9IGxvYygKICAgICAgICAgICAgICAiQ2xvc2UgJTEiLAogICAgICAgICAgICAgIG1lLm1pbmlnYW1lTmFtZQogICAgICAgICAgICApOwogICAgICAgIH0gZWxzZSBsKCJwcm9kdWN0TWluaWdhbWVCdXR0b24iICsgbWUuaWQpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgaWYgKAogICAgICAgICAgR2FtZS5pc01pbmlnYW1lUmVhZHkobWUpICYmCiAgICAgICAgICBHYW1lLmFzY2Vuc2lvbk1vZGUgIT0gMSAmJgogICAgICAgICAgbWUubWluaWdhbWUuZHJhZ29uQm9vc3RUb29sdGlwICYmCiAgICAgICAgICBHYW1lLmhhc0F1cmEoIlN1cHJlbWUgSW50ZWxsZWN0IikKICAgICAgICApIHsKICAgICAgICAgIGwoInByb2R1Y3REcmFnb25Cb29zdCIgKyBtZS5pZCkuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgICAgfSBlbHNlIGwoInByb2R1Y3REcmFnb25Cb29zdCIgKyBtZS5pZCkuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgfTsKICAgICAgdGhpcy5tdXRlZCA9IGZhbHNlOwogICAgICB0aGlzLm11dGUgPSBmdW5jdGlvbiAodmFsKSB7CiAgICAgICAgaWYgKHRoaXMuaWQgPT0gMCkgcmV0dXJuIGZhbHNlOwogICAgICAgIHRoaXMubXV0ZWQgPSB2YWw7CiAgICAgICAgaWYgKHZhbCkgewogICAgICAgICAgbCgicHJvZHVjdE11dGUiICsgdGhpcy5pZCkuY2xhc3NMaXN0LmFkZCgib24iKTsKICAgICAgICAgIGwoInJvdyIgKyB0aGlzLmlkKS5jbGFzc0xpc3QuYWRkKCJtdXRlZCIpOwogICAgICAgICAgbCgibXV0ZWRQcm9kdWN0IiArIHRoaXMuaWQpLnN0eWxlLmRpc3BsYXkgPSAiaW5saW5lLWJsb2NrIjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbCgicHJvZHVjdE11dGUiICsgdGhpcy5pZCkuY2xhc3NMaXN0LnJlbW92ZSgib24iKTsKICAgICAgICAgIGwoInJvdyIgKyB0aGlzLmlkKS5jbGFzc0xpc3QucmVtb3ZlKCJtdXRlZCIpOwogICAgICAgICAgbCgibXV0ZWRQcm9kdWN0IiArIHRoaXMuaWQpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgfQogICAgICB9OwoKICAgICAgdGhpcy5kcmF3ID0gZnVuY3Rpb24gKCkge307CgogICAgICB2YXIgc3RyID0gIiI7CiAgICAgIGlmICh0aGlzLmlkICE9IDApCiAgICAgICAgc3RyICs9CiAgICAgICAgICAnPGRpdiBjbGFzcz0icm93IiBpZD0icm93JyArCiAgICAgICAgICB0aGlzLmlkICsKICAgICAgICAgICciPjxkaXYgY2xhc3M9InNlcGFyYXRvckJvdHRvbSI+PC9kaXY+JzsKICAgICAgc3RyICs9ICc8ZGl2IGNsYXNzPSJwcm9kdWN0QnV0dG9ucyI+JzsKICAgICAgc3RyICs9CiAgICAgICAgJzxkaXYgaWQ9InByb2R1Y3RMZXZlbCcgKwogICAgICAgIHRoaXMuaWQgKwogICAgICAgICciIGNsYXNzPSJwcm9kdWN0QnV0dG9uIHByb2R1Y3RMZXZlbCBsdW1wc09ubHkiIG9uY2xpY2s9IkdhbWUuT2JqZWN0c0J5SWRbJyArCiAgICAgICAgdGhpcy5pZCArCiAgICAgICAgJ10ubGV2ZWxVcCgpIiAnICsKICAgICAgICBHYW1lLmdldER5bmFtaWNUb29sdGlwKAogICAgICAgICAgIkdhbWUuT2JqZWN0c0J5SWRbIiArIHRoaXMuaWQgKyAiXS5sZXZlbFRvb2x0aXAiLAogICAgICAgICAgInRoaXMiCiAgICAgICAgKSArCiAgICAgICAgIj48L2Rpdj4iOwogICAgICBzdHIgKz0KICAgICAgICAnPGRpdiBpZD0icHJvZHVjdE1pbmlnYW1lQnV0dG9uJyArCiAgICAgICAgdGhpcy5pZCArCiAgICAgICAgJyIgY2xhc3M9InByb2R1Y3RCdXR0b24gcHJvZHVjdE1pbmlnYW1lQnV0dG9uIGx1bXBzT25seSIgb25jbGljaz0iR2FtZS5PYmplY3RzQnlJZFsnICsKICAgICAgICB0aGlzLmlkICsKICAgICAgICAiXS5zd2l0Y2hNaW5pZ2FtZSgtMSk7UGxheVNvdW5kKEdhbWUuT2JqZWN0c0J5SWRbIiArCiAgICAgICAgdGhpcy5pZCArCiAgICAgICAgIl0ub25NaW5pZ2FtZT8nc25kL2NsaWNrT24yLm1wMyc6J3NuZC9jbGlja09mZjIubXAzJyk7XCI+PC9kaXY+IjsKICAgICAgaWYgKHRoaXMuaWQgIT0gMCkKICAgICAgICBzdHIgKz0KICAgICAgICAgICc8ZGl2IGNsYXNzPSJwcm9kdWN0QnV0dG9uIHByb2R1Y3RNdXRlIiAnICsKICAgICAgICAgIEdhbWUuZ2V0VG9vbHRpcCgKICAgICAgICAgICAgJzxkaXYgc3R5bGU9IndpZHRoOjE1MHB4O3RleHQtYWxpZ246Y2VudGVyO2ZvbnQtc2l6ZToxMXB4OyIgaWQ9InRvb2x0aXBNdXRlQnVpbGRpbmciPjxiPicgKwogICAgICAgICAgICAgIGxvYygiTXV0ZSIpICsKICAgICAgICAgICAgICAiPC9iPjxicj4oIiArCiAgICAgICAgICAgICAgbG9jKCJNaW5pbWl6ZSB0aGlzIGJ1aWxkaW5nIikgKwogICAgICAgICAgICAgICIpPC9kaXY+IiwKICAgICAgICAgICAgInRoaXMiCiAgICAgICAgICApICsKICAgICAgICAgICcgb25jbGljaz0iR2FtZS5PYmplY3RzQnlJZFsnICsKICAgICAgICAgIHRoaXMuaWQgKwogICAgICAgICAgIl0ubXV0ZSgxKTtQbGF5U291bmQoR2FtZS5PYmplY3RzQnlJZFsiICsKICAgICAgICAgIHRoaXMuaWQgKwogICAgICAgICAgIl0ubXV0ZWQ/J3NuZC9jbGlja09mZjIubXAzJzonc25kL2NsaWNrT24yLm1wMycpO1wiIGlkPVwicHJvZHVjdE11dGUiICsKICAgICAgICAgIHRoaXMuaWQgKwogICAgICAgICAgJyI+JyArCiAgICAgICAgICBsb2MoIk11dGUiKSArCiAgICAgICAgICAiPC9kaXY+IjsKICAgICAgc3RyICs9CiAgICAgICAgJzxkaXYgaWQ9InByb2R1Y3REcmFnb25Cb29zdCcgKwogICAgICAgIHRoaXMuaWQgKwogICAgICAgICciIHN0eWxlPSJkaXNwbGF5Om5vbmU7IiBjbGFzcz0icHJvZHVjdEJ1dHRvbiBwcm9kdWN0RHJhZ29uQm9vc3QiICcgKwogICAgICAgIEdhbWUuZ2V0RHluYW1pY1Rvb2x0aXAoCiAgICAgICAgICAiZnVuY3Rpb24oKXtpZiAoR2FtZS5PYmplY3RzQnlJZFsiICsKICAgICAgICAgICAgdGhpcy5pZCArCiAgICAgICAgICAgICJdLm1pbmlnYW1lICYmIEdhbWUuT2JqZWN0c0J5SWRbIiArCiAgICAgICAgICAgIHRoaXMuaWQgKwogICAgICAgICAgICAiXS5taW5pZ2FtZS5kcmFnb25Cb29zdFRvb2x0aXApIHJldHVybiBHYW1lLk9iamVjdHNCeUlkWyIgKwogICAgICAgICAgICB0aGlzLmlkICsKICAgICAgICAgICAgIl0ubWluaWdhbWUuZHJhZ29uQm9vc3RUb29sdGlwKCk7IGVsc2UgcmV0dXJuIDA7fSIsCiAgICAgICAgICAidGhpcyIKICAgICAgICApICsKICAgICAgICAnPjxkaXYgY2xhc3M9Imljb24iIHN0eWxlPSJ2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7ZGlzcGxheTppbmxpbmUtYmxvY2s7YmFja2dyb3VuZC1wb3NpdGlvbjonICsKICAgICAgICAtMzAgKiA0OCArCiAgICAgICAgInB4ICIgKwogICAgICAgIC0xMiAqIDQ4ICsKICAgICAgICAncHg7dHJhbnNmb3JtOnNjYWxlKDAuNSk7bWFyZ2luOi0yMHB4IC0xNnB4OyI+PC9kaXY+PC9kaXY+JzsKICAgICAgc3RyICs9ICI8L2Rpdj4iOwogICAgICBpZiAodGhpcy5pZCA9PSAwKQogICAgICAgIGwoInNlY3Rpb25MZWZ0RXh0cmEiKS5pbm5lckhUTUwgPSBsKCJzZWN0aW9uTGVmdEV4dHJhIikuaW5uZXJIVE1MICsgc3RyOwogICAgICBlbHNlIHsKICAgICAgICBzdHIgKz0KICAgICAgICAgICc8Y2FudmFzIGNsYXNzPSJyb3dDYW52YXMiIGlkPSJyb3dDYW52YXMnICsgdGhpcy5pZCArICciPjwvY2FudmFzPic7CiAgICAgICAgc3RyICs9ICc8ZGl2IGNsYXNzPSJyb3dTcGVjaWFsIiBpZD0icm93U3BlY2lhbCcgKyB0aGlzLmlkICsgJyI+PC9kaXY+JzsKICAgICAgICBzdHIgKz0gIjwvZGl2PiI7CiAgICAgICAgbCgicm93cyIpLmlubmVySFRNTCA9IGwoInJvd3MiKS5pbm5lckhUTUwgKyBzdHI7CgogICAgICAgIC8vYnVpbGRpbmcgY2FudmFzCiAgICAgICAgdGhpcy5waWNzID0gW107CgogICAgICAgIHRoaXMudG9SZXNpemUgPSB0cnVlOwogICAgICAgIHRoaXMucmVkcmF3ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgICAgIG1lLnBpY3MgPSBbXTsKICAgICAgICB9OwogICAgICAgIHRoaXMuZHJhdyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGlmICh0aGlzLmFtb3VudCA8PSAwKSByZXR1cm4gZmFsc2U7CiAgICAgICAgICBpZiAodGhpcy50b1Jlc2l6ZSkgewogICAgICAgICAgICB0aGlzLmNhbnZhcy53aWR0aCA9IHRoaXMuY2FudmFzLmNsaWVudFdpZHRoOwogICAgICAgICAgICB0aGlzLmNhbnZhcy5oZWlnaHQgPSB0aGlzLmNhbnZhcy5jbGllbnRIZWlnaHQ7CiAgICAgICAgICAgIHRoaXMudG9SZXNpemUgPSBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICAgIHZhciBjdHggPSB0aGlzLmN0eDsKICAgICAgICAgIC8vY2xlYXIKICAgICAgICAgIC8vY3R4LmNsZWFyUmVjdCgwLDAsdGhpcy5jYW52YXMud2lkdGgsdGhpcy5jYW52YXMuaGVpZ2h0KTsKICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDE7CgogICAgICAgICAgLy9waWMgOiBhIGxvYWRlZCBwaWN0dXJlIG9yIGEgZnVuY3Rpb24gcmV0dXJuaW5nIGEgbG9hZGVkIHBpY3R1cmUKICAgICAgICAgIC8vYmcgOiBhIGxvYWRlZCBwaWN0dXJlIG9yIGEgZnVuY3Rpb24gcmV0dXJuaW5nIGEgbG9hZGVkIHBpY3R1cmUgLSB0aWxlZCBhcyB0aGUgYmFja2dyb3VuZCwgMTI4eDEyOAogICAgICAgICAgLy94ViA6IHRoZSBwaWN0dXJlcyB3aWxsIGhhdmUgYSByYW5kb20gaG9yaXpvbnRhbCBzaGlmdCBieSB0aGlzIG1hbnkgcGl4ZWxzCiAgICAgICAgICAvL3lWIDogdGhlIHBpY3R1cmVzIHdpbGwgaGF2ZSBhIHJhbmRvbSB2ZXJ0aWNhbCBzaGlmdCBieSB0aGlzIG1hbnkgcGl4ZWxzCiAgICAgICAgICAvL3cgOiBob3cgbWFueSBwaXhlbHMgYmV0d2VlbiBlYWNoIHBpY3R1cmUgKG9yIHJvdyBvZiBwaWN0dXJlcykKICAgICAgICAgIC8veCA6IGhvcml6b250YWwgb2Zmc2V0CiAgICAgICAgICAvL3kgOiB2ZXJ0aWNhbCBvZmZzZXQgKCszMikKICAgICAgICAgIC8vcm93cyA6IGlmID4xLCBhcnJhbmdlIHRoZSBwaWN0dXJlcyBpbiByb3dzIGNvbnRhaW5pbmcgdGhpcyBtYW55IHBpY3R1cmVzCiAgICAgICAgICAvL2ZyYW1lcyA6IGlmIHByZXNlbnQsIHNsaWNlIHRoZSBwaWMgaW4gW2ZyYW1lc10gaG9yaXpvbnRhbCBzbGljZXMgYW5kIHBpY2sgb25lIGF0IHJhbmRvbQoKICAgICAgICAgIHZhciBwaWMgPSB0aGlzLmFydC5waWM7CiAgICAgICAgICB2YXIgYmcgPSB0aGlzLmFydC5iZzsKICAgICAgICAgIHZhciB4ViA9IHRoaXMuYXJ0LnhWIHx8IDA7CiAgICAgICAgICB2YXIgeVYgPSB0aGlzLmFydC55ViB8fCAwOwogICAgICAgICAgdmFyIHcgPSB0aGlzLmFydC53IHx8IDQ4OwogICAgICAgICAgdmFyIGggPSB0aGlzLmFydC5oIHx8IDQ4OwogICAgICAgICAgdmFyIG9mZlggPSB0aGlzLmFydC54IHx8IDA7CiAgICAgICAgICB2YXIgb2ZmWSA9IHRoaXMuYXJ0LnkgfHwgMDsKICAgICAgICAgIHZhciByb3dzID0gdGhpcy5hcnQucm93cyB8fCAxOwogICAgICAgICAgdmFyIGZyYW1lcyA9IHRoaXMuYXJ0LmZyYW1lcyB8fCAxOwoKICAgICAgICAgIGlmICh0eXBlb2YgYmcgPT0gInN0cmluZyIpCiAgICAgICAgICAgIGN0eC5maWxsUGF0dGVybigKICAgICAgICAgICAgICBQaWModGhpcy5hcnQuYmcpLAogICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICB0aGlzLmNhbnZhcy53aWR0aCwKICAgICAgICAgICAgICB0aGlzLmNhbnZhcy5oZWlnaHQsCiAgICAgICAgICAgICAgMTI4LAogICAgICAgICAgICAgIDEyOAogICAgICAgICAgICApOwogICAgICAgICAgZWxzZSBiZyh0aGlzLCBjdHgpOwogICAgICAgICAgLyoKCQkJCQljdHguZ2xvYmFsQWxwaGE9MC41OwoJCQkJCWlmICh0eXBlb2YoYmcpPT0nc3RyaW5nJykvL3Rlc3QKCQkJCQl7CgkJCQkJCWN0eC5maWxsUGF0dGVybihQaWModGhpcy5hcnQuYmcpLC0xMjgrR2FtZS5UJTEyOCwwLHRoaXMuY2FudmFzLndpZHRoKzEyOCx0aGlzLmNhbnZhcy5oZWlnaHQsMTI4LDEyOCk7CgkJCQkJCWN0eC5maWxsUGF0dGVybihQaWModGhpcy5hcnQuYmcpLC0xMjgrTWF0aC5mbG9vcihHYW1lLlQvMiklMTI4LC0xMjgrTWF0aC5mbG9vcihHYW1lLlQvMiklMTI4LHRoaXMuY2FudmFzLndpZHRoKzEyOCx0aGlzLmNhbnZhcy5oZWlnaHQrMTI4LDEyOCwxMjgpOwoJCQkJCX0KCQkJCQljdHguZ2xvYmFsQWxwaGE9MTsKCQkJCQkqLwogICAgICAgICAgdmFyIG1heEkgPSBNYXRoLmZsb29yKHRoaXMuY2FudmFzLndpZHRoIC8gKHcgLyByb3dzKSArIDEpOwogICAgICAgICAgdmFyIGlUID0gTWF0aC5taW4odGhpcy5hbW91bnQsIG1heEkpOwogICAgICAgICAgdmFyIGkgPSB0aGlzLnBpY3MubGVuZ3RoOwoKICAgICAgICAgIHZhciB4ID0gMDsKICAgICAgICAgIHZhciB5ID0gMDsKICAgICAgICAgIHZhciBhZGRlZCA9IDA7CiAgICAgICAgICBpZiAoaSAhPSBpVCkgewogICAgICAgICAgICAvL2ZvciAodmFyIGl0ZXI9MDtpdGVyPDM7aXRlcisrKQogICAgICAgICAgICAvL3sKICAgICAgICAgICAgdmFyIHByZXZGcmFtZSA9IDA7CiAgICAgICAgICAgIHdoaWxlIChpIDwgaVQpIHsKICAgICAgICAgICAgICAvL2lmIChpPGlUKQogICAgICAgICAgICAgIE1hdGguc2VlZHJhbmRvbShHYW1lLnNlZWQgKyAiICIgKyB0aGlzLmlkICsgIiAiICsgaSk7CiAgICAgICAgICAgICAgaWYgKHJvd3MgIT0gMSkgewogICAgICAgICAgICAgICAgeCA9CiAgICAgICAgICAgICAgICAgIE1hdGguZmxvb3IoaSAvIHJvd3MpICogdyArCiAgICAgICAgICAgICAgICAgICgoaSAlIHJvd3MpIC8gcm93cykgKiB3ICsKICAgICAgICAgICAgICAgICAgTWF0aC5mbG9vcigoTWF0aC5yYW5kb20oKSAtIDAuNSkgKiB4VikgKwogICAgICAgICAgICAgICAgICBvZmZYOwogICAgICAgICAgICAgICAgeSA9CiAgICAgICAgICAgICAgICAgIDMyICsKICAgICAgICAgICAgICAgICAgTWF0aC5mbG9vcigoTWF0aC5yYW5kb20oKSAtIDAuNSkgKiB5VikgKwogICAgICAgICAgICAgICAgICAoKCgtcm93cyAvIDIpICogMzIpIC8gMiArICgoaSAlIHJvd3MpICogMzIpIC8gMikgKwogICAgICAgICAgICAgICAgICBvZmZZOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB4ID0gaSAqIHcgKyBNYXRoLmZsb29yKChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIHhWKSArIG9mZlg7CiAgICAgICAgICAgICAgICB5ID0gMzIgKyBNYXRoLmZsb29yKChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIHlWKSArIG9mZlk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHZhciB1c2VkUGljID0gdHlwZW9mIHBpYyA9PSAic3RyaW5nIiA/IHBpYyA6IHBpYyh0aGlzLCBpKTsKICAgICAgICAgICAgICB2YXIgZnJhbWUgPSAtMTsKICAgICAgICAgICAgICAvL2lmIChmcmFtZXM+MSkgZnJhbWU9TWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKmZyYW1lcyk7CiAgICAgICAgICAgICAgaWYgKGZyYW1lcyA+IDEpIHsKICAgICAgICAgICAgICAgIGZyYW1lID0KICAgICAgICAgICAgICAgICAgcHJldkZyYW1lICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKGZyYW1lcyAtIDEpICsgMSk7CiAgICAgICAgICAgICAgICBmcmFtZSA9IGZyYW1lICUgZnJhbWVzOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBwcmV2RnJhbWUgPSBmcmFtZTsKICAgICAgICAgICAgICB0aGlzLnBpY3MucHVzaCh7CiAgICAgICAgICAgICAgICB4OiBNYXRoLmZsb29yKHgpLAogICAgICAgICAgICAgICAgeTogTWF0aC5mbG9vcih5KSwKICAgICAgICAgICAgICAgIHo6IHksCiAgICAgICAgICAgICAgICBwaWM6IHVzZWRQaWMsCiAgICAgICAgICAgICAgICBpZDogaSwKICAgICAgICAgICAgICAgIGZyYW1lOiBmcmFtZSwKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBpKys7CiAgICAgICAgICAgICAgYWRkZWQrKzsKICAgICAgICAgICAgfQogICAgICAgICAgICB3aGlsZSAoaSA+IGlUKSB7CiAgICAgICAgICAgICAgLy9lbHNlIGlmIChpPmlUKQogICAgICAgICAgICAgIHRoaXMucGljcy5zb3J0KEdhbWUuc29ydFNwcml0ZXNCeUlkKTsKICAgICAgICAgICAgICB0aGlzLnBpY3MucG9wKCk7CiAgICAgICAgICAgICAgaS0tOwogICAgICAgICAgICAgIGFkZGVkLS07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy99CiAgICAgICAgICAgIHRoaXMucGljcy5zb3J0KEdhbWUuc29ydFNwcml0ZXMpOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBsZW4gPSB0aGlzLnBpY3MubGVuZ3RoOwoKICAgICAgICAgIGlmICh0aGlzLm1vdXNlT24pIHsKICAgICAgICAgICAgdmFyIHNlbGVjdGVkID0gLTE7CiAgICAgICAgICAgIGlmICh0aGlzLm5hbWUgPT0gIkdyYW5kbWEiKSB7CiAgICAgICAgICAgICAgLy9tb3VzZSBkZXRlY3Rpb24gb25seSBmaXRzIGdyYW5kbWEgc3ByaXRlcyBmb3Igbm93CiAgICAgICAgICAgICAgdmFyIG1hcmdpblcgPSAtMTg7CiAgICAgICAgICAgICAgdmFyIG1hcmdpbkggPSAtMTA7CiAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgewogICAgICAgICAgICAgICAgdmFyIHBpYyA9IHRoaXMucGljc1tpXTsKICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgdGhpcy5tb3VzZVBvc1swXSA+PSBwaWMueCAtIG1hcmdpblcgJiYKICAgICAgICAgICAgICAgICAgdGhpcy5tb3VzZVBvc1swXSA8IHBpYy54ICsgNjQgKyBtYXJnaW5XICYmCiAgICAgICAgICAgICAgICAgIHRoaXMubW91c2VQb3NbMV0gPj0gcGljLnkgLSBtYXJnaW5IICYmCiAgICAgICAgICAgICAgICAgIHRoaXMubW91c2VQb3NbMV0gPCBwaWMueSArIDY0ICsgbWFyZ2luSAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICBzZWxlY3RlZCA9IGk7CiAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgIHNlbGVjdGVkID09IGkgJiYKICAgICAgICAgICAgICAgICAgcGljLnBpYyA9PSAiZWxmR3JhbmRtYS5wbmciICYmCiAgICAgICAgICAgICAgICAgIEdhbWUubW91c2VEb3duCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgIEdhbWUuV2luKCJCYWJ5IGl0J3Mgb2xkIG91dHNpZGUiKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgR2FtZS5wcmVmcy5jdXN0b21HcmFuZG1hcyAmJgogICAgICAgICAgICAgICAgR2FtZS5jdXN0b21HcmFuZG1hTmFtZXMubGVuZ3RoID4gMAogICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgdmFyIHN0ciA9IGxvYygKICAgICAgICAgICAgICAgICAgIk5hbWVzIGluIHdoaXRlIHdlcmUgc3VibWl0dGVkIGJ5IG91ciBzdXBwb3J0ZXJzIG9uIFBhdHJlb24uIgogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDAuNzU7CiAgICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gIiMwMDAiOwogICAgICAgICAgICAgICAgY3R4LmZvbnQgPSAiOXB4IE1lcnJpd2VhdGhlciI7CiAgICAgICAgICAgICAgICBjdHgudGV4dEFsaWduID0gImxlZnQiOwogICAgICAgICAgICAgICAgY3R4LmZpbGxSZWN0KDAsIDAsIGN0eC5tZWFzdXJlVGV4dChzdHIpLndpZHRoICsgNCwgMTIpOwogICAgICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMTsKICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSAicmdiYSgyNTUsMjU1LDI1NSwwLjcpIjsKICAgICAgICAgICAgICAgIGN0eC5maWxsVGV4dChzdHIsIDIsIDgpOwogICAgICAgICAgICAgICAgaWYgKEVOKSB7CiAgICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSAicmdiYSgyNTUsMjU1LDI1NSwxKSI7CiAgICAgICAgICAgICAgICAgIGN0eC5maWxsVGV4dCgKICAgICAgICAgICAgICAgICAgICAid2hpdGUiLAogICAgICAgICAgICAgICAgICAgIDIgKyBjdHgubWVhc3VyZVRleHQoIk5hbWVzIGluICIpLndpZHRoLAogICAgICAgICAgICAgICAgICAgIDgKICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBNYXRoLnNlZWRyYW5kb20oKTsKCiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgICAgIHZhciBwaWMgPSB0aGlzLnBpY3NbaV07CiAgICAgICAgICAgIHZhciBzcHJpdGUgPSBQaWMocGljLnBpYyk7CiAgICAgICAgICAgIGlmIChzZWxlY3RlZCA9PSBpICYmIHRoaXMubmFtZSA9PSAiR3JhbmRtYSIpIHsKICAgICAgICAgICAgICBjdHguZm9udCA9ICIxNHB4IE1lcnJpd2VhdGhlciI7CiAgICAgICAgICAgICAgY3R4LnRleHRBbGlnbiA9ICJjZW50ZXIiOwogICAgICAgICAgICAgIE1hdGguc2VlZHJhbmRvbShHYW1lLnNlZWQgKyAiICIgKyBwaWMuaWQgLyorJyAnK3BpYy5pZCovKTsgLy8oR2FtZS5zZWVkKycgJytwaWMuaWQrJyAnK3BpYy54KycgJytwaWMueSk7CiAgICAgICAgICAgICAgdmFyIHllYXJzID0KICAgICAgICAgICAgICAgIChEYXRlLm5vdygpIC0gbmV3IERhdGUoMjAxMywgNywgOCkpIC8KICAgICAgICAgICAgICAgICAgKDEwMDAgKiA2MCAqIDYwICogMjQgKiAzNjUpICsKICAgICAgICAgICAgICAgIE1hdGgucmFuZG9tKCk7IC8vdGhlIGdyYW5kbWFzIGFnZSB3aXRoIHRoZSBnYW1lCiAgICAgICAgICAgICAgdmFyIG5hbWUgPSBjaG9vc2UoR2FtZS5ncmFuZG1hTmFtZXMpOwogICAgICAgICAgICAgIHZhciBjdXN0b20gPSBmYWxzZTsKICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICBHYW1lLnByZWZzLmN1c3RvbUdyYW5kbWFzICYmCiAgICAgICAgICAgICAgICBHYW1lLmN1c3RvbUdyYW5kbWFOYW1lcy5sZW5ndGggPiAwICYmCiAgICAgICAgICAgICAgICBNYXRoLnJhbmRvbSgpIDwgMC4yCiAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICBuYW1lID0gY2hvb3NlKEdhbWUuY3VzdG9tR3JhbmRtYU5hbWVzKTsKICAgICAgICAgICAgICAgIGN1c3RvbSA9IHRydWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHZhciB0ZXh0ID0gbG9jKCIlMSwgYWdlICUyIiwgWwogICAgICAgICAgICAgICAgbmFtZSwKICAgICAgICAgICAgICAgIEJlYXV0aWZ5KAogICAgICAgICAgICAgICAgICBNYXRoLmZsb29yKDcwICsgTWF0aC5yYW5kb20oKSAqIDMwICsgeWVhcnMgKyB0aGlzLmxldmVsKQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICBdKTsKICAgICAgICAgICAgICB2YXIgd2lkdGggPSBjdHgubWVhc3VyZVRleHQodGV4dCkud2lkdGggKyAxMjsKICAgICAgICAgICAgICB2YXIgeCA9IE1hdGgubWF4KAogICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgIE1hdGgubWluKAogICAgICAgICAgICAgICAgICBwaWMueCArIDMyIC0gd2lkdGggLyAyICsgTWF0aC5yYW5kb20oKSAqIDMyIC0gMTYsCiAgICAgICAgICAgICAgICAgIHRoaXMuY2FudmFzLndpZHRoIC0gd2lkdGgKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIHZhciB5ID0gNCArIE1hdGgucmFuZG9tKCkgKiA4IC0gNDsKICAgICAgICAgICAgICBNYXRoLnNlZWRyYW5kb20oKTsKICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gIiMwMDAiOwogICAgICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9ICIjMDAwIjsKICAgICAgICAgICAgICBjdHgubGluZVdpZHRoID0gODsKICAgICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAwLjc1OwogICAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTsKICAgICAgICAgICAgICBjdHgubW92ZVRvKHBpYy54ICsgMzIsIHBpYy55ICsgMzIpOwogICAgICAgICAgICAgIGN0eC5saW5lVG8oTWF0aC5mbG9vcih4ICsgd2lkdGggLyAyKSwgTWF0aC5mbG9vcih5ICsgMjApKTsKICAgICAgICAgICAgICBjdHguc3Ryb2tlKCk7CiAgICAgICAgICAgICAgY3R4LmZpbGxSZWN0KE1hdGguZmxvb3IoeCksIE1hdGguZmxvb3IoeSksIE1hdGguZmxvb3Iod2lkdGgpLCAyNCk7CiAgICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMTsKICAgICAgICAgICAgICBpZiAoY3VzdG9tKSBjdHguZmlsbFN0eWxlID0gIiNmZmYiOwogICAgICAgICAgICAgIGVsc2UgY3R4LmZpbGxTdHlsZSA9ICJyZ2JhKDI1NSwyNTUsMjU1LDAuNykiOwogICAgICAgICAgICAgIGN0eC5maWxsVGV4dCh0ZXh0LCBNYXRoLmZsb29yKHggKyB3aWR0aCAvIDIpLCBNYXRoLmZsb29yKHkgKyAxNikpOwoKICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKAogICAgICAgICAgICAgICAgc3ByaXRlLAogICAgICAgICAgICAgICAgTWF0aC5mbG9vcihwaWMueCArIE1hdGgucmFuZG9tKCkgKiA0IC0gMiksCiAgICAgICAgICAgICAgICBNYXRoLmZsb29yKHBpYy55ICsgTWF0aC5yYW5kb20oKSAqIDQgLSAyKQogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy9lbHNlIGlmICgxKSBjdHguZHJhd0ltYWdlKHNwcml0ZSwwLDAsc3ByaXRlLndpZHRoLHNwcml0ZS5oZWlnaHQscGljLngscGljLnksc3ByaXRlLndpZHRoLHNwcml0ZS5oZWlnaHQpOwogICAgICAgICAgICBlbHNlIGlmIChwaWMuZnJhbWUgIT0gLTEpCiAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZSgKICAgICAgICAgICAgICAgIHNwcml0ZSwKICAgICAgICAgICAgICAgIChzcHJpdGUud2lkdGggLyBmcmFtZXMpICogcGljLmZyYW1lLAogICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgIHNwcml0ZS53aWR0aCAvIGZyYW1lcywKICAgICAgICAgICAgICAgIHNwcml0ZS5oZWlnaHQsCiAgICAgICAgICAgICAgICBwaWMueCwKICAgICAgICAgICAgICAgIHBpYy55LAogICAgICAgICAgICAgICAgc3ByaXRlLndpZHRoIC8gZnJhbWVzLAogICAgICAgICAgICAgICAgc3ByaXRlLmhlaWdodAogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGVsc2UgY3R4LmRyYXdJbWFnZShzcHJpdGUsIHBpYy54LCBwaWMueSk7CiAgICAgICAgICB9CgogICAgICAgICAgLyoKCQkJCQl2YXIgcGljWD10aGlzLmlkOwoJCQkJCXZhciBwaWNZPTEyOwoJCQkJCXZhciB3PTE7CgkJCQkJdmFyIGg9MTsKCQkJCQl2YXIgdz1NYXRoLmFicyhNYXRoLmNvcyhHYW1lLlQqMC4yK3RoaXMuaWQqMi0wLjMpKSowLjIrMC44OwoJCQkJCXZhciBoPU1hdGguYWJzKE1hdGguc2luKEdhbWUuVCowLjIrdGhpcy5pZCoyKSkqMC4zKzAuNzsKCQkJCQl2YXIgeD02NCtNYXRoLmNvcyhHYW1lLlQqMC4xOSt0aGlzLmlkKjIpKjgtMjQqdzsKCQkJCQl2YXIgeT0xMjgtTWF0aC5hYnMoTWF0aC5wb3coTWF0aC5zaW4oR2FtZS5UKjAuMit0aGlzLmlkKjIpLDUpKjE2KS00OCpoOwoJCQkJCWN0eC5kcmF3SW1hZ2UoUGljKCdpY29ucy5wbmcnKSxwaWNYKjQ4LHBpY1kqNDgsNDgsNDgsTWF0aC5mbG9vcih4KSxNYXRoLmZsb29yKHkpLDQ4KncsNDgqaCk7CgkJCQkJKi8KICAgICAgICB9OwogICAgICB9CgogICAgICBHYW1lLmxhc3QgPSB0aGlzOwogICAgICBHYW1lLk9iamVjdHNbdGhpcy5uYW1lXSA9IHRoaXM7CiAgICAgIEdhbWUuT2JqZWN0c0J5SWQucHVzaCh0aGlzKTsKICAgICAgR2FtZS5PYmplY3RzTisrOwogICAgICByZXR1cm4gdGhpczsKICAgIH07CgogICAgR2FtZS5EcmF3QnVpbGRpbmdzID0gZnVuY3Rpb24gKCkgLy9kcmF3IGJ1aWxkaW5nIGRpc3BsYXlzIHdpdGggY2FudmFzCiAgICB7CiAgICAgIGlmIChHYW1lLmRyYXdUICUgMyA9PSAwKSB7CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICAgIHZhciBtZSA9IEdhbWUuT2JqZWN0c1tpXTsKICAgICAgICAgIGlmIChtZS5pZCA+IDAgJiYgIW1lLm9uTWluaWdhbWUgJiYgIW1lLm11dGVkKSBtZS5kcmF3KCk7CiAgICAgICAgICBlbHNlIG1lLnBpY3MgPSBbXTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgR2FtZS5zb3J0U3ByaXRlcyA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgIGlmIChhLnogPiBiLnopIHJldHVybiAxOwogICAgICBlbHNlIGlmIChhLnogPCBiLnopIHJldHVybiAtMTsKICAgICAgZWxzZSByZXR1cm4gMDsKICAgIH07CiAgICBHYW1lLnNvcnRTcHJpdGVzQnlJZCA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgIGlmIChhLmlkID4gYi5pZCkgcmV0dXJuIDE7CiAgICAgIGVsc2UgaWYgKGEuaWQgPCBiLmlkKSByZXR1cm4gLTE7CiAgICAgIGVsc2UgcmV0dXJuIDA7CiAgICB9OwoKICAgIEdhbWUubW9kaWZ5QnVpbGRpbmdQcmljZSA9IGZ1bmN0aW9uIChidWlsZGluZywgcHJpY2UpIHsKICAgICAgaWYgKEdhbWUuSGFzKCJTZWFzb24gc2F2aW5ncyIpKSBwcmljZSAqPSAwLjk5OwogICAgICBpZiAoR2FtZS5IYXMoIlNhbnRhJ3MgZG9taW5pb24iKSkgcHJpY2UgKj0gMC45OTsKICAgICAgaWYgKEdhbWUuSGFzKCJGYWJlcmdlIGVnZyIpKSBwcmljZSAqPSAwLjk5OwogICAgICBpZiAoR2FtZS5IYXMoIkRpdmluZSBkaXNjb3VudCIpKSBwcmljZSAqPSAwLjk5OwogICAgICBpZiAoR2FtZS5IYXMoIkZvcnR1bmUgIzEwMCIpKSBwcmljZSAqPSAwLjk5OwogICAgICAvL2lmIChHYW1lLmhhc0F1cmEoJ0ZpZXJjZSBIb2FyZGVyJykpIHByaWNlKj0wLjk4OwogICAgICBwcmljZSAqPSAxIC0gR2FtZS5hdXJhTXVsdCgiRmllcmNlIEhvYXJkZXIiKSAqIDAuMDI7CiAgICAgIGlmIChHYW1lLmhhc0J1ZmYoIkV2ZXJ5dGhpbmcgbXVzdCBnbyIpKSBwcmljZSAqPSAwLjk1OwogICAgICBpZiAoR2FtZS5oYXNCdWZmKCJDcmFmdHkgcGl4aWVzIikpIHByaWNlICo9IDAuOTg7CiAgICAgIGlmIChHYW1lLmhhc0J1ZmYoIk5hc3R5IGdvYmxpbnMiKSkgcHJpY2UgKj0gMS4wMjsKICAgICAgaWYgKGJ1aWxkaW5nLmZvcnR1bmUgJiYgR2FtZS5IYXMoYnVpbGRpbmcuZm9ydHVuZS5uYW1lKSkgcHJpY2UgKj0gMC45MzsKICAgICAgcHJpY2UgKj0gR2FtZS5lZmYoImJ1aWxkaW5nQ29zdCIpOwogICAgICBpZiAoR2FtZS5oYXNHb2QpIHsKICAgICAgICB2YXIgZ29kTHZsID0gR2FtZS5oYXNHb2QoImNyZWF0aW9uIik7CiAgICAgICAgaWYgKGdvZEx2bCA9PSAxKSBwcmljZSAqPSAwLjkzOwogICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAyKSBwcmljZSAqPSAwLjk1OwogICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAzKSBwcmljZSAqPSAwLjk4OwogICAgICB9CiAgICAgIHJldHVybiBwcmljZTsKICAgIH07CgogICAgR2FtZS5zdG9yZUJ1bGtCdXR0b24gPSBmdW5jdGlvbiAoaWQpIHsKICAgICAgaWYgKGlkID09IDApIEdhbWUuYnV5TW9kZSA9IDE7CiAgICAgIGVsc2UgaWYgKGlkID09IDEpIEdhbWUuYnV5TW9kZSA9IC0xOwogICAgICBlbHNlIGlmIChpZCA9PSAyKSBHYW1lLmJ1eUJ1bGsgPSAxOwogICAgICBlbHNlIGlmIChpZCA9PSAzKSBHYW1lLmJ1eUJ1bGsgPSAxMDsKICAgICAgZWxzZSBpZiAoaWQgPT0gNCkgR2FtZS5idXlCdWxrID0gMTAwOwogICAgICBlbHNlIGlmIChpZCA9PSA1KSBHYW1lLmJ1eUJ1bGsgPSAtMTsKCiAgICAgIGlmIChHYW1lLmJ1eU1vZGUgPT0gMSAmJiBHYW1lLmJ1eUJ1bGsgPT0gLTEpIEdhbWUuYnV5QnVsayA9IDEwMDsKCiAgICAgIGlmIChHYW1lLmJ1eU1vZGUgPT0gMSkKICAgICAgICBsKCJzdG9yZUJ1bGtCdXkiKS5jbGFzc05hbWUgPSAic3RvcmVQcmVCdXR0b24gc3RvcmVCdWxrTW9kZSBzZWxlY3RlZCI7CiAgICAgIGVsc2UgbCgic3RvcmVCdWxrQnV5IikuY2xhc3NOYW1lID0gInN0b3JlUHJlQnV0dG9uIHN0b3JlQnVsa01vZGUiOwogICAgICBpZiAoR2FtZS5idXlNb2RlID09IC0xKQogICAgICAgIGwoInN0b3JlQnVsa1NlbGwiKS5jbGFzc05hbWUgPSAic3RvcmVQcmVCdXR0b24gc3RvcmVCdWxrTW9kZSBzZWxlY3RlZCI7CiAgICAgIGVsc2UgbCgic3RvcmVCdWxrU2VsbCIpLmNsYXNzTmFtZSA9ICJzdG9yZVByZUJ1dHRvbiBzdG9yZUJ1bGtNb2RlIjsKCiAgICAgIGlmIChHYW1lLmJ1eUJ1bGsgPT0gMSkKICAgICAgICBsKCJzdG9yZUJ1bGsxIikuY2xhc3NOYW1lID0gInN0b3JlUHJlQnV0dG9uIHN0b3JlQnVsa0Ftb3VudCBzZWxlY3RlZCI7CiAgICAgIGVsc2UgbCgic3RvcmVCdWxrMSIpLmNsYXNzTmFtZSA9ICJzdG9yZVByZUJ1dHRvbiBzdG9yZUJ1bGtBbW91bnQiOwogICAgICBpZiAoR2FtZS5idXlCdWxrID09IDEwKQogICAgICAgIGwoInN0b3JlQnVsazEwIikuY2xhc3NOYW1lID0gInN0b3JlUHJlQnV0dG9uIHN0b3JlQnVsa0Ftb3VudCBzZWxlY3RlZCI7CiAgICAgIGVsc2UgbCgic3RvcmVCdWxrMTAiKS5jbGFzc05hbWUgPSAic3RvcmVQcmVCdXR0b24gc3RvcmVCdWxrQW1vdW50IjsKICAgICAgaWYgKEdhbWUuYnV5QnVsayA9PSAxMDApCiAgICAgICAgbCgic3RvcmVCdWxrMTAwIikuY2xhc3NOYW1lID0gInN0b3JlUHJlQnV0dG9uIHN0b3JlQnVsa0Ftb3VudCBzZWxlY3RlZCI7CiAgICAgIGVsc2UgbCgic3RvcmVCdWxrMTAwIikuY2xhc3NOYW1lID0gInN0b3JlUHJlQnV0dG9uIHN0b3JlQnVsa0Ftb3VudCI7CiAgICAgIGlmIChHYW1lLmJ1eUJ1bGsgPT0gLTEpCiAgICAgICAgbCgic3RvcmVCdWxrTWF4IikuY2xhc3NOYW1lID0gInN0b3JlUHJlQnV0dG9uIHN0b3JlQnVsa0Ftb3VudCBzZWxlY3RlZCI7CiAgICAgIGVsc2UgbCgic3RvcmVCdWxrTWF4IikuY2xhc3NOYW1lID0gInN0b3JlUHJlQnV0dG9uIHN0b3JlQnVsa0Ftb3VudCI7CgogICAgICBpZiAoR2FtZS5idXlNb2RlID09IDEpIHsKICAgICAgICBsKCJzdG9yZUJ1bGtNYXgiKS5zdHlsZS52aXNpYmlsaXR5ID0gImhpZGRlbiI7CiAgICAgICAgbCgicHJvZHVjdHMiKS5jbGFzc05hbWUgPSAic3RvcmVTZWN0aW9uIjsKICAgICAgfSBlbHNlIHsKICAgICAgICBsKCJzdG9yZUJ1bGtNYXgiKS5zdHlsZS52aXNpYmlsaXR5ID0gInZpc2libGUiOwogICAgICAgIGwoInByb2R1Y3RzIikuY2xhc3NOYW1lID0gInN0b3JlU2VjdGlvbiBzZWxsaW5nIjsKICAgICAgfQoKICAgICAgR2FtZS5zdG9yZVRvUmVmcmVzaCA9IDE7CiAgICAgIGlmIChpZCAhPSAtMSkgUGxheVNvdW5kKCJzbmQvdGljay5tcDMiKTsKICAgIH07CiAgICBHYW1lLkJ1aWxkU3RvcmUgPSBmdW5jdGlvbiAoKSAvL2NyZWF0ZSB0aGUgRE9NIGZvciB0aGUgc3RvcmUncyBidWlsZGluZ3MKICAgIHsKICAgICAgLy9pZiAodHlwZW9mIHNob3dBZHMhPT0ndW5kZWZpbmVkJykgbCgnc3RvcmUnKS5zY3JvbGxUb3A9MTAwOwoKICAgICAgdmFyIHN0ciA9ICIiOwogICAgICBzdHIgKz0KICAgICAgICAnPGRpdiBpZD0ic3RvcmVCdWxrIiBjbGFzcz0ic3RvcmVQcmUiICcgKwogICAgICAgIEdhbWUuZ2V0VG9vbHRpcCgKICAgICAgICAgICc8ZGl2IHN0eWxlPSJwYWRkaW5nOjhweDttaW4td2lkdGg6MjAwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Zm9udC1zaXplOjExcHg7IiBpZD0idG9vbHRpcFN0b3JlQnVsayI+JyArCiAgICAgICAgICAgIGxvYygKICAgICAgICAgICAgICAiWW91IGNhbiBhbHNvIHByZXNzICUxIHRvIGJ1bGstYnV5IG9yIHNlbGwgJTIgb2YgYSBidWlsZGluZyBhdCBhIHRpbWUsIG9yICUzIGZvciAlNC4iLAogICAgICAgICAgICAgIFsKICAgICAgICAgICAgICAgICI8Yj4iICsgbG9jKCJDdHJsIikgKyAiPC9iPiIsCiAgICAgICAgICAgICAgICAiPGI+MTA8L2I+IiwKICAgICAgICAgICAgICAgICI8Yj4iICsgbG9jKCJTaGlmdCIpICsgIjwvYj4iLAogICAgICAgICAgICAgICAgIjxiPjEwMDwvYj4iLAogICAgICAgICAgICAgIF0KICAgICAgICAgICAgKSArCiAgICAgICAgICAgICI8L2Rpdj4iLAogICAgICAgICAgInN0b3JlIgogICAgICAgICkgKwogICAgICAgICI+IiArCiAgICAgICAgJzxkaXYgaWQ9InN0b3JlQnVsa0J1eSIgY2xhc3M9InN0b3JlUHJlQnV0dG9uIHN0b3JlQnVsa01vZGUiICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICc9IkdhbWUuc3RvcmVCdWxrQnV0dG9uKDApOyI+JyArCiAgICAgICAgbG9jKCJCdXkiKSArCiAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICc8ZGl2IGlkPSJzdG9yZUJ1bGtTZWxsIiBjbGFzcz0ic3RvcmVQcmVCdXR0b24gc3RvcmVCdWxrTW9kZSIgJyArCiAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgJz0iR2FtZS5zdG9yZUJ1bGtCdXR0b24oMSk7Ij4nICsKICAgICAgICBsb2MoIlNlbGwiKSArCiAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICc8ZGl2IGlkPSJzdG9yZUJ1bGsxIiBjbGFzcz0ic3RvcmVQcmVCdXR0b24gc3RvcmVCdWxrQW1vdW50IiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJHYW1lLnN0b3JlQnVsa0J1dHRvbigyKTsiPjE8L2Rpdj4nICsKICAgICAgICAnPGRpdiBpZD0ic3RvcmVCdWxrMTAiIGNsYXNzPSJzdG9yZVByZUJ1dHRvbiBzdG9yZUJ1bGtBbW91bnQiICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICc9IkdhbWUuc3RvcmVCdWxrQnV0dG9uKDMpOyI+MTA8L2Rpdj4nICsKICAgICAgICAnPGRpdiBpZD0ic3RvcmVCdWxrMTAwIiBjbGFzcz0ic3RvcmVQcmVCdXR0b24gc3RvcmVCdWxrQW1vdW50IiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJHYW1lLnN0b3JlQnVsa0J1dHRvbig0KTsiPjEwMDwvZGl2PicgKwogICAgICAgICc8ZGl2IGlkPSJzdG9yZUJ1bGtNYXgiIGNsYXNzPSJzdG9yZVByZUJ1dHRvbiBzdG9yZUJ1bGtBbW91bnQiICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICc9IkdhbWUuc3RvcmVCdWxrQnV0dG9uKDUpOyI+JyArCiAgICAgICAgbG9jKCJhbGwiKSArCiAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICI8L2Rpdj4iOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0cykgewogICAgICAgIHZhciBtZSA9IEdhbWUuT2JqZWN0c1tpXTsKICAgICAgICBzdHIgKz0KICAgICAgICAgIChHYW1lLnByZWZzLnNjcmVlbnJlYWRlcgogICAgICAgICAgICA/ICc8YnV0dG9uIGFyaWEtbGFiZWxsZWRieT0iYXJpYVJlYWRlci1wcm9kdWN0LScgKyBtZS5pZCArICciJwogICAgICAgICAgICA6ICI8ZGl2IikgKwogICAgICAgICAgJyBjbGFzcz0icHJvZHVjdCB0b2dnbGVkT2ZmIiAnICsKICAgICAgICAgIEdhbWUuZ2V0RHluYW1pY1Rvb2x0aXAoCiAgICAgICAgICAgICJHYW1lLk9iamVjdHNCeUlkWyIgKyBtZS5pZCArICJdLnRvb2x0aXAiLAogICAgICAgICAgICAic3RvcmUiCiAgICAgICAgICApICsKICAgICAgICAgICcgaWQ9InByb2R1Y3QnICsKICAgICAgICAgIG1lLmlkICsKICAgICAgICAgICciPjxkaXYgY2xhc3M9Imljb24gb2ZmIiBpZD0icHJvZHVjdEljb25PZmYnICsKICAgICAgICAgIG1lLmlkICsKICAgICAgICAgICciIHN0eWxlPSIiPjwvZGl2PjxkaXYgY2xhc3M9Imljb24iIGlkPSJwcm9kdWN0SWNvbicgKwogICAgICAgICAgbWUuaWQgKwogICAgICAgICAgJyIgc3R5bGU9IiI+PC9kaXY+PGRpdiBjbGFzcz0iY29udGVudCI+PGRpdiBjbGFzcz0ibG9ja2VkVGl0bGUiPj8/PzwvZGl2PjxkaXYgY2xhc3M9InRpdGxlIHByb2R1Y3ROYW1lIiBpZD0icHJvZHVjdE5hbWUnICsKICAgICAgICAgIG1lLmlkICsKICAgICAgICAgICciPjwvZGl2PjxzcGFuIGNsYXNzPSJwcmljZU11bHQiIGlkPSJwcm9kdWN0UHJpY2VNdWx0JyArCiAgICAgICAgICBtZS5pZCArCiAgICAgICAgICAnIj48L3NwYW4+PHNwYW4gY2xhc3M9InByaWNlIiBpZD0icHJvZHVjdFByaWNlJyArCiAgICAgICAgICBtZS5pZCArCiAgICAgICAgICAnIj48L3NwYW4+PGRpdiBjbGFzcz0idGl0bGUgb3duZWQiIGlkPSJwcm9kdWN0T3duZWQnICsKICAgICAgICAgIG1lLmlkICsKICAgICAgICAgICciPjwvZGl2PicgKwogICAgICAgICAgKEdhbWUucHJlZnMuc2NyZWVucmVhZGVyCiAgICAgICAgICAgID8gJzxsYWJlbCBjbGFzcz0ic3JPbmx5IiBzdHlsZT0id2lkdGg6NjRweDtsZWZ0Oi02NHB4OyIgaWQ9ImFyaWFSZWFkZXItcHJvZHVjdC0nICsKICAgICAgICAgICAgICBtZS5pZCArCiAgICAgICAgICAgICAgJyI+PC9sYWJlbD4nCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgIC8qJzxkaXYgY2xhc3M9ImJ1eVNlbGwiPjxkaXYgc3R5bGU9ImxlZnQ6MHB4OyIgaWQ9ImJ1dHRvbkJ1eTEwLScrbWUuaWQrJyI+QnV5IDEwPC9kaXY+PGRpdiBzdHlsZT0ibGVmdDoxMDBweDsiIGlkPSJidXR0b25TZWxsLScrbWUuaWQrJyI+U2VsbCAxPC9kaXY+PGRpdiBzdHlsZT0ibGVmdDoyMDBweDsiIGlkPSJidXR0b25TZWxsQWxsLScrbWUuaWQrJyI+U2VsbCBhbGw8L2Rpdj48L2Rpdj4nKyovCiAgICAgICAgICAoR2FtZS5wcmVmcy5zY3JlZW5yZWFkZXIgPyAiPC9idXR0b24+IiA6ICI8L2Rpdj4iKTsKICAgICAgfQogICAgICBsKCJwcm9kdWN0cyIpLmlubmVySFRNTCA9IHN0cjsKCiAgICAgIEdhbWUuc3RvcmVCdWxrQnV0dG9uKC0xKTsKCiAgICAgIC8qdmFyIFNlbGxBbGxQcm9tcHQ9ZnVuY3Rpb24oaWQpCgkJCXsKCQkJCXJldHVybiBmdW5jdGlvbihpZCl7R2FtZS5Qcm9tcHQoJzxkaXYgY2xhc3M9ImJsb2NrIj5EbyB5b3UgcmVhbGx5IHdhbnQgdG8gc2VsbCB5b3VyICcrbG9jKCIlMSAiK0dhbWUuT2JqZWN0c0J5SWRbaWRdLmJzaW5nbGUsTEJlYXV0aWZ5KEdhbWUuT2JqZWN0c0J5SWRbaWRdLmFtb3VudCkpKyc/PC9kaXY+JyxbWydZZXMnLCdHYW1lLk9iamVjdHNCeUlkWycraWQrJ10uc2VsbCgtMSk7R2FtZS5DbG9zZVByb21wdCgpOyddLFsnTm8nLCdHYW1lLkNsb3NlUHJvbXB0KCk7J11dKTt9KGlkKTsKCQkJfSovCgogICAgICBmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0cykgewogICAgICAgIHZhciBtZSA9IEdhbWUuT2JqZWN0c1tpXTsKICAgICAgICBtZS5sID0gbCgicHJvZHVjdCIgKyBtZS5pZCk7CgogICAgICAgIC8vdGhlc2UgYXJlIGEgYml0IG1lc3N5IGJ1dCBhaCB3ZWxsCiAgICAgICAgaWYgKCFHYW1lLnRvdWNoRXZlbnRzKSB7CiAgICAgICAgICBBZGRFdmVudCgKICAgICAgICAgICAgbWUubCwKICAgICAgICAgICAgImNsaWNrIiwKICAgICAgICAgICAgKGZ1bmN0aW9uICh3aGF0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICBHYW1lLkNsaWNrUHJvZHVjdCh3aGF0KTsKICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9KShtZS5pZCkKICAgICAgICAgICk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIEFkZEV2ZW50KAogICAgICAgICAgICBtZS5sLAogICAgICAgICAgICAidG91Y2hlbmQiLAogICAgICAgICAgICAoZnVuY3Rpb24gKHdoYXQpIHsKICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgIEdhbWUuQ2xpY2tQcm9kdWN0KHdoYXQpOwogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0pKG1lLmlkKQogICAgICAgICAgKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgR2FtZS5DbGlja1Byb2R1Y3QgPSBmdW5jdGlvbiAod2hhdCkgewogICAgICBHYW1lLk9iamVjdHNCeUlkW3doYXRdLmJ1eSgpOwogICAgfTsKCiAgICBHYW1lLlJlZnJlc2hTdG9yZSA9IGZ1bmN0aW9uICgpIC8vcmVmcmVzaCB0aGUgc3RvcmUncyBidWlsZGluZ3MKICAgIHsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICBHYW1lLk9iamVjdHNbaV0ucmVmcmVzaCgpOwogICAgICB9CiAgICAgIEdhbWUuc3RvcmVUb1JlZnJlc2ggPSAwOwogICAgfTsKCiAgICBHYW1lLkNvbXB1dGVDcHMgPSBmdW5jdGlvbiAoYmFzZSwgbXVsdCwgYm9udXMpIHsKICAgICAgaWYgKCFib251cykgYm9udXMgPSAwOwogICAgICByZXR1cm4gYmFzZSAqIE1hdGgucG93KDIsIG11bHQpICsgYm9udXM7CiAgICB9OwoKICAgIEdhbWUuaXNNaW5pZ2FtZVJlYWR5ID0gZnVuY3Rpb24gKG1lKSB7CiAgICAgIHJldHVybiBtZS5taW5pZ2FtZVVybCAmJiBtZS5taW5pZ2FtZUxvYWRlZCAmJiBtZS5sZXZlbCA+IDA7CiAgICB9OwogICAgR2FtZS5zY3JpcHRCaW5kaW5ncyA9IFtdOwogICAgR2FtZS5zaG93ZWRTY3JpcHRMb2FkRXJyb3IgPSBmYWxzZTsKICAgIEdhbWUuTG9hZE1pbmlnYW1lcyA9IGZ1bmN0aW9uICgpIC8vbG9hZCBzY3JpcHRzIGZvciBlYWNoIG1pbmlnYW1lCiAgICB7CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5PYmplY3RzW2ldOwogICAgICAgIGlmICgKICAgICAgICAgIG1lLm1pbmlnYW1lVXJsICYmCiAgICAgICAgICBtZS5sZXZlbCA+IDAgJiYKICAgICAgICAgICFtZS5taW5pZ2FtZUxvYWRlZCAmJgogICAgICAgICAgIW1lLm1pbmlnYW1lTG9hZGluZyAmJgogICAgICAgICAgIWwoIm1pbmlnYW1lU2NyaXB0LSIgKyBtZS5pZCkKICAgICAgICApIHsKICAgICAgICAgIG1lLm1pbmlnYW1lTG9hZGluZyA9IHRydWU7CiAgICAgICAgICAvL3dlJ3JlIG9ubHkgbG9hZGluZyB0aGUgbWluaWdhbWUgc2NyaXB0cyB0aGF0IGFyZW4ndCBsb2FkZWQgeWV0IGFuZCB3aGljaCBoYXZlIGVub3VnaCBidWlsZGluZyBsZXZlbAogICAgICAgICAgLy93ZSBjYWxsIHRoaXMgZnVuY3Rpb24gb24gYnVpbGRpbmcgbGV2ZWwgdXAgYW5kIG9uIGxvYWQKICAgICAgICAgIC8vY29uc29sZS5sb2coJ0xvYWRpbmcgc2NyaXB0ICcrbWUubWluaWdhbWVVcmwrJy4uLicpOwogICAgICAgICAgc2V0VGltZW91dCgKICAgICAgICAgICAgKGZ1bmN0aW9uIChtZSkgewogICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB2YXIgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7CiAgICAgICAgICAgICAgICBzY3JpcHQuaWQgPSAibWluaWdhbWVTY3JpcHQtIiArIG1lLmlkOwogICAgICAgICAgICAgICAgR2FtZS5zY3JpcHRCaW5kaW5nc1sibWluaWdhbWVTY3JpcHQtIiArIG1lLmlkXSA9IG1lOwogICAgICAgICAgICAgICAgc2NyaXB0LnNldEF0dHJpYnV0ZSgKICAgICAgICAgICAgICAgICAgInNyYyIsCiAgICAgICAgICAgICAgICAgIG1lLm1pbmlnYW1lVXJsICsgIj9yPSIgKyBHYW1lLnZlcnNpb24KICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICBzY3JpcHQub25sb2FkID0gKGZ1bmN0aW9uIChtZSwgc2NyaXB0KSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCFtZS5taW5pZ2FtZUxvYWRlZCkgR2FtZS5zY3JpcHRMb2FkZWQobWUsIHNjcmlwdCk7CiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9KShtZSwgIm1pbmlnYW1lU2NyaXB0LSIgKyBtZS5pZCk7CiAgICAgICAgICAgICAgICBzY3JpcHQub25lcnJvciA9IChmdW5jdGlvbiAobWUsIHNjcmlwdCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIG1lLm1pbmlnYW1lTG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIGlmICghbWUubWluaWdhbWVMb2FkZWQgJiYgIUdhbWUuc2hvd2VkU2NyaXB0TG9hZEVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICBHYW1lLnNob3dlZFNjcmlwdExvYWRFcnJvciA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgICAgICAgICAgICAgbG9jKCJFcnJvciEiKSwKICAgICAgICAgICAgICAgICAgICAgICAgIkNvdWxkbid0IGxvYWQgbWluaWdhbWVzLiBUcnkgcmVsb2FkaW5nLiIKICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgfSkobWUsICJtaW5pZ2FtZVNjcmlwdC0iICsgbWUuaWQpOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzY3JpcHQpOwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0pKG1lKSwKICAgICAgICAgICAgMTAKICAgICAgICAgICk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwogICAgR2FtZS5zY3JpcHRMb2FkZWQgPSBmdW5jdGlvbiAod2hvLCBzY3JpcHQpIHsKICAgICAgd2hvLm1pbmlnYW1lTG9hZGluZyA9IGZhbHNlOwogICAgICB3aG8ubWluaWdhbWVMb2FkZWQgPSB0cnVlOwogICAgICB3aG8ucmVmcmVzaCgpOwogICAgICB3aG8ubWluaWdhbWUubGF1bmNoKCk7CiAgICAgIGlmICh3aG8ubWluaWdhbWVTYXZlKSB7CiAgICAgICAgd2hvLm1pbmlnYW1lLnJlc2V0KHRydWUpOwogICAgICAgIHdoby5taW5pZ2FtZS5sb2FkKHdoby5taW5pZ2FtZVNhdmUpOwogICAgICAgIHdoby5taW5pZ2FtZVNhdmUgPSAwOwogICAgICB9CiAgICB9OwoKICAgIEdhbWUubWFnaWNDcFMgPSBmdW5jdGlvbiAod2hhdCkgewogICAgICAvKgoJCQlpZiAoR2FtZS5PYmplY3RzW3doYXRdLmFtb3VudD49MjUwKQoJCQl7CgkJCQkvL3RoaXMgbWFrZXMgYnVpbGRpbmdzIGdpdmUgMSUgbW9yZSBjb29raWVzIGZvciBldmVyeSBidWlsZGluZyBvdmVyIDI1MC4KCQkJCS8vdGhpcyB0dXJucyBvdXQgdG8gYmUgcmF0aGVyIHN0dXBpZGx5IG92ZXJwb3dlcmVkLgoJCQkJdmFyIG49R2FtZS5PYmplY3RzW3doYXRdLmFtb3VudC0yNTA7CgkJCQlyZXR1cm4gMStNYXRoLnBvdygxLjAxLG4pOwoJCQl9CgkJCWVsc2UgcmV0dXJuIDE7CgkJCSovCiAgICAgIHJldHVybiAxOwogICAgfTsKCiAgICAvL2RlZmluZSBvYmplY3RzCiAgICBuZXcgR2FtZS5PYmplY3QoCiAgICAgICJDdXJzb3IiLAogICAgICAiY3Vyc29yfGN1cnNvcnN8Y2xpY2tlZHxbWF0gZXh0cmEgZmluZ2VyfFtYXSBleHRyYSBmaW5nZXJzIiwKICAgICAgIkF1dG9jbGlja3Mgb25jZSBldmVyeSAxMCBzZWNvbmRzLiIsCiAgICAgIDAsCiAgICAgIDAsCiAgICAgIHt9LAogICAgICAxNSwKICAgICAgZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgdmFyIGFkZCA9IDA7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJUaG91c2FuZCBmaW5nZXJzIikpIGFkZCArPSAwLjE7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJNaWxsaW9uIGZpbmdlcnMiKSkgYWRkICo9IDU7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJCaWxsaW9uIGZpbmdlcnMiKSkgYWRkICo9IDEwOwogICAgICAgIGlmIChHYW1lLkhhcygiVHJpbGxpb24gZmluZ2VycyIpKSBhZGQgKj0gMjA7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJRdWFkcmlsbGlvbiBmaW5nZXJzIikpIGFkZCAqPSAyMDsKICAgICAgICBpZiAoR2FtZS5IYXMoIlF1aW50aWxsaW9uIGZpbmdlcnMiKSkgYWRkICo9IDIwOwogICAgICAgIGlmIChHYW1lLkhhcygiU2V4dGlsbGlvbiBmaW5nZXJzIikpIGFkZCAqPSAyMDsKICAgICAgICBpZiAoR2FtZS5IYXMoIlNlcHRpbGxpb24gZmluZ2VycyIpKSBhZGQgKj0gMjA7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJPY3RpbGxpb24gZmluZ2VycyIpKSBhZGQgKj0gMjA7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJOb25pbGxpb24gZmluZ2VycyIpKSBhZGQgKj0gMjA7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJEZWNpbGxpb24gZmluZ2VycyIpKSBhZGQgKj0gMjA7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJVbnNoYWNrbGVkIGN1cnNvcnMiKSkgYWRkICo9IDI1OwogICAgICAgIHZhciBtdWx0ID0gMTsKICAgICAgICB2YXIgbnVtID0gMDsKICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0cykgewogICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1tpXS5uYW1lICE9ICJDdXJzb3IiKSBudW0gKz0gR2FtZS5PYmplY3RzW2ldLmFtb3VudDsKICAgICAgICB9CiAgICAgICAgYWRkID0gYWRkICogbnVtOwogICAgICAgIG11bHQgKj0gR2FtZS5HZXRUaWVyZWRDcHNNdWx0KG1lKTsKICAgICAgICBtdWx0ICo9IEdhbWUubWFnaWNDcFMoIkN1cnNvciIpOwogICAgICAgIG11bHQgKj0gR2FtZS5lZmYoImN1cnNvckNwcyIpOwogICAgICAgIHJldHVybiAoCiAgICAgICAgICBHYW1lLkNvbXB1dGVDcHMoCiAgICAgICAgICAgIDAuMSwKICAgICAgICAgICAgR2FtZS5IYXMoIlJlaW5mb3JjZWQgaW5kZXggZmluZ2VyIikgKwogICAgICAgICAgICAgIEdhbWUuSGFzKCJDYXJwYWwgdHVubmVsIHByZXZlbnRpb24gY3JlYW0iKSArCiAgICAgICAgICAgICAgR2FtZS5IYXMoIkFtYmlkZXh0cm91cyIpLAogICAgICAgICAgICBhZGQKICAgICAgICAgICkgKiBtdWx0CiAgICAgICAgKTsKICAgICAgfSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIGlmICh0aGlzLmFtb3VudCA+PSAxKQogICAgICAgICAgR2FtZS5VbmxvY2soWwogICAgICAgICAgICAiUmVpbmZvcmNlZCBpbmRleCBmaW5nZXIiLAogICAgICAgICAgICAiQ2FycGFsIHR1bm5lbCBwcmV2ZW50aW9uIGNyZWFtIiwKICAgICAgICAgIF0pOwogICAgICAgIGlmICh0aGlzLmFtb3VudCA+PSAxMCkgR2FtZS5VbmxvY2soIkFtYmlkZXh0cm91cyIpOwogICAgICAgIGlmICh0aGlzLmFtb3VudCA+PSAyNSkgR2FtZS5VbmxvY2soIlRob3VzYW5kIGZpbmdlcnMiKTsKICAgICAgICBpZiAodGhpcy5hbW91bnQgPj0gNTApIEdhbWUuVW5sb2NrKCJNaWxsaW9uIGZpbmdlcnMiKTsKICAgICAgICBpZiAodGhpcy5hbW91bnQgPj0gMTAwKSBHYW1lLlVubG9jaygiQmlsbGlvbiBmaW5nZXJzIik7CiAgICAgICAgaWYgKHRoaXMuYW1vdW50ID49IDE1MCkgR2FtZS5VbmxvY2soIlRyaWxsaW9uIGZpbmdlcnMiKTsKICAgICAgICBpZiAodGhpcy5hbW91bnQgPj0gMjAwKSBHYW1lLlVubG9jaygiUXVhZHJpbGxpb24gZmluZ2VycyIpOwogICAgICAgIGlmICh0aGlzLmFtb3VudCA+PSAyNTApIEdhbWUuVW5sb2NrKCJRdWludGlsbGlvbiBmaW5nZXJzIik7CiAgICAgICAgaWYgKHRoaXMuYW1vdW50ID49IDMwMCkgR2FtZS5VbmxvY2soIlNleHRpbGxpb24gZmluZ2VycyIpOwogICAgICAgIGlmICh0aGlzLmFtb3VudCA+PSAzNTApIEdhbWUuVW5sb2NrKCJTZXB0aWxsaW9uIGZpbmdlcnMiKTsKICAgICAgICBpZiAodGhpcy5hbW91bnQgPj0gNDAwKSBHYW1lLlVubG9jaygiT2N0aWxsaW9uIGZpbmdlcnMiKTsKICAgICAgICBpZiAodGhpcy5hbW91bnQgPj0gNDUwKSBHYW1lLlVubG9jaygiTm9uaWxsaW9uIGZpbmdlcnMiKTsKICAgICAgICBpZiAodGhpcy5hbW91bnQgPj0gNTAwKSBHYW1lLlVubG9jaygiRGVjaWxsaW9uIGZpbmdlcnMiKTsKCiAgICAgICAgaWYgKHRoaXMuYW1vdW50ID49IDEpIEdhbWUuV2luKCJDbGljayIpOwogICAgICAgIGlmICh0aGlzLmFtb3VudCA+PSAyKSBHYW1lLldpbigiRG91YmxlLWNsaWNrIik7CiAgICAgICAgaWYgKHRoaXMuYW1vdW50ID49IDUwKSBHYW1lLldpbigiTW91c2Ugd2hlZWwiKTsKICAgICAgICBpZiAodGhpcy5hbW91bnQgPj0gMTAwKSBHYW1lLldpbigiT2YgTWljZSBhbmQgTWVuIik7CiAgICAgICAgaWYgKHRoaXMuYW1vdW50ID49IDIwMCkgR2FtZS5XaW4oIlRoZSBEaWdpdGFsIik7CiAgICAgICAgaWYgKHRoaXMuYW1vdW50ID49IDMwMCkgR2FtZS5XaW4oIkV4dHJlbWUgcG9seWRhY3R5bHkiKTsKICAgICAgICBpZiAodGhpcy5hbW91bnQgPj0gNDAwKSBHYW1lLldpbigiRHIuIFQiKTsKICAgICAgICBpZiAodGhpcy5hbW91bnQgPj0gNTAwKSBHYW1lLldpbigiVGh1bWJzLCBwaGFsYW5nZXMsIG1ldGFjYXJwYWxzIik7CiAgICAgICAgaWYgKHRoaXMuYW1vdW50ID49IDYwMCkgR2FtZS5XaW4oIldpdGggaGVyIGZpbmdlciBhbmQgaGVyIHRodW1iIik7CiAgICAgICAgaWYgKHRoaXMuYW1vdW50ID49IDcwMCkgR2FtZS5XaW4oIkdvdHRhIGhhbmQgaXQgdG8geW91Iik7CiAgICAgICAgaWYgKHRoaXMuYW1vdW50ID49IDgwMCkgR2FtZS5XaW4oIlRoZSBkZXZpbCdzIHdvcmtzaG9wIik7CiAgICAgIH0KICAgICk7CgogICAgR2FtZS5TcGVjaWFsR3JhbmRtYVVubG9jayA9IDE1OwogICAgbmV3IEdhbWUuT2JqZWN0KAogICAgICAiR3JhbmRtYSIsCiAgICAgICJncmFuZG1hfGdyYW5kbWFzfGJha2VkfEdyYW5kbWFzIGFyZSBbWF0geWVhciBvbGRlcnxHcmFuZG1hcyBhcmUgW1hdIHllYXJzIG9sZGVyIiwKICAgICAgIkEgbmljZSBncmFuZG1hIHRvIGJha2UgbW9yZSBjb29raWVzLiIsCiAgICAgIDEsCiAgICAgIDEsCiAgICAgIHsKICAgICAgICBwaWM6IGZ1bmN0aW9uIChpKSB7CiAgICAgICAgICB2YXIgbGlzdCA9IFsiZ3JhbmRtYSJdOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJGYXJtZXIgZ3JhbmRtYXMiKSkgbGlzdC5wdXNoKCJmYXJtZXJHcmFuZG1hIik7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIldvcmtlciBncmFuZG1hcyIpKSBsaXN0LnB1c2goIndvcmtlckdyYW5kbWEiKTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiTWluZXIgZ3JhbmRtYXMiKSkgbGlzdC5wdXNoKCJtaW5lckdyYW5kbWEiKTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiQ29zbWljIGdyYW5kbWFzIikpIGxpc3QucHVzaCgiY29zbWljR3JhbmRtYSIpOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJUcmFuc211dGVkIGdyYW5kbWFzIikpIGxpc3QucHVzaCgidHJhbnNtdXRlZEdyYW5kbWEiKTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiQWx0ZXJlZCBncmFuZG1hcyIpKSBsaXN0LnB1c2goImFsdGVyZWRHcmFuZG1hIik7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIkdyYW5kbWFzJyBncmFuZG1hcyIpKSBsaXN0LnB1c2goImdyYW5kbWFzR3JhbmRtYSIpOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJBbnRpZ3JhbmRtYXMiKSkgbGlzdC5wdXNoKCJhbnRpR3JhbmRtYSIpOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJSYWluYm93IGdyYW5kbWFzIikpIGxpc3QucHVzaCgicmFpbmJvd0dyYW5kbWEiKTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiQmFua2VyIGdyYW5kbWFzIikpIGxpc3QucHVzaCgiYmFua0dyYW5kbWEiKTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiUHJpZXN0ZXNzIGdyYW5kbWFzIikpIGxpc3QucHVzaCgidGVtcGxlR3JhbmRtYSIpOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJXaXRjaCBncmFuZG1hcyIpKSBsaXN0LnB1c2goIndpdGNoR3JhbmRtYSIpOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJMdWNreSBncmFuZG1hcyIpKSBsaXN0LnB1c2goImx1Y2t5R3JhbmRtYSIpOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJNZXRhZ3JhbmRtYXMiKSkgbGlzdC5wdXNoKCJtZXRhR3JhbmRtYSIpOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJTY3JpcHQgZ3Jhbm5pZXMiKSkgbGlzdC5wdXNoKCJzY3JpcHRHcmFuZG1hIik7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIkFsdGVybmF0ZSBncmFuZG1hcyIpKSBsaXN0LnB1c2goImFsdGVybmF0ZUdyYW5kbWEiKTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiQnJhaW55IGdyYW5kbWFzIikpIGxpc3QucHVzaCgiYnJhaW55R3JhbmRtYSIpOwogICAgICAgICAgaWYgKEdhbWUuc2Vhc29uID09ICJjaHJpc3RtYXMiKSBsaXN0LnB1c2goImVsZkdyYW5kbWEiKTsKICAgICAgICAgIGlmIChHYW1lLnNlYXNvbiA9PSAiZWFzdGVyIikgbGlzdC5wdXNoKCJidW5ueUdyYW5kbWEiKTsKICAgICAgICAgIHJldHVybiBjaG9vc2UobGlzdCkgKyAiLnBuZyI7CiAgICAgICAgfSwKICAgICAgICBiZzogImdyYW5kbWFCYWNrZ3JvdW5kLnBuZyIsCiAgICAgICAgeFY6IDgsCiAgICAgICAgeVY6IDgsCiAgICAgICAgdzogMzIsCiAgICAgICAgcm93czogMywKICAgICAgICB4OiAwLAogICAgICAgIHk6IDE2LAogICAgICB9LAogICAgICAxMDAsCiAgICAgIGZ1bmN0aW9uIChtZSkgewogICAgICAgIHZhciBtdWx0ID0gMTsKICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuR3JhbmRtYVN5bmVyZ2llcykgewogICAgICAgICAgaWYgKEdhbWUuSGFzKEdhbWUuR3JhbmRtYVN5bmVyZ2llc1tpXSkpIG11bHQgKj0gMjsKICAgICAgICB9CiAgICAgICAgaWYgKEdhbWUuSGFzKCJCaW5nbyBjZW50ZXIvUmVzZWFyY2ggZmFjaWxpdHkiKSkgbXVsdCAqPSA0OwogICAgICAgIGlmIChHYW1lLkhhcygiUml0dWFsIHJvbGxpbmcgcGlucyIpKSBtdWx0ICo9IDI7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJOYXVnaHR5IGxpc3QiKSkgbXVsdCAqPSAyOwoKICAgICAgICBpZiAoR2FtZS5IYXMoIkVsZGVyd29ydCBiaXNjdWl0cyIpKSBtdWx0ICo9IDEuMDI7CgogICAgICAgIG11bHQgKj0gR2FtZS5lZmYoImdyYW5kbWFDcHMiKTsKCiAgICAgICAgaWYgKEdhbWUuSGFzKCJDYXQgbGFkaWVzIikpIHsKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgR2FtZS5VcGdyYWRlc0J5UG9vbFsia2l0dGVuIl0ubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKEdhbWUuSGFzKEdhbWUuVXBncmFkZXNCeVBvb2xbImtpdHRlbiJdW2ldLm5hbWUpKSBtdWx0ICo9IDEuMjk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBtdWx0ICo9IEdhbWUuR2V0VGllcmVkQ3BzTXVsdChtZSk7CgogICAgICAgIHZhciBhZGQgPSAwOwogICAgICAgIGlmIChHYW1lLkhhcygiT25lIG1pbmQiKSkgYWRkICs9IEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLmFtb3VudCAqIDAuMDI7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJDb21tdW5hbCBicmFpbnN3ZWVwIikpCiAgICAgICAgICBhZGQgKz0gR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0uYW1vdW50ICogMC4wMjsKICAgICAgICBpZiAoR2FtZS5IYXMoIkVsZGVyIFBhY3QiKSkgYWRkICs9IEdhbWUuT2JqZWN0c1siUG9ydGFsIl0uYW1vdW50ICogMC4wNTsKCiAgICAgICAgdmFyIG51bSA9IDA7CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbaV0ubmFtZSAhPSAiR3JhbmRtYSIpIG51bSArPSBHYW1lLk9iamVjdHNbaV0uYW1vdW50OwogICAgICAgIH0KICAgICAgICAvL2lmIChHYW1lLmhhc0F1cmEoJ0VsZGVyIEJhdHRhbGlvbicpKSBtdWx0Kj0xKzAuMDEqbnVtOwogICAgICAgIG11bHQgKj0gMSArIEdhbWUuYXVyYU11bHQoIkVsZGVyIEJhdHRhbGlvbiIpICogMC4wMSAqIG51bTsKCiAgICAgICAgbXVsdCAqPSBHYW1lLm1hZ2ljQ3BTKG1lLm5hbWUpOwoKICAgICAgICByZXR1cm4gKG1lLmJhc2VDcHMgKyBhZGQpICogbXVsdDsKICAgICAgfSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuVW5sb2NrVGllcmVkKHRoaXMpOwogICAgICB9CiAgICApOwogICAgR2FtZS5sYXN0LnNlbGxGdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgR2FtZS5XaW4oIkp1c3Qgd3JvbmciKTsKICAgICAgaWYgKHRoaXMuYW1vdW50ID09IDApIHsKICAgICAgICBHYW1lLkxvY2soIkVsZGVyIFBsZWRnZSIpOwogICAgICAgIEdhbWUuQ29sbGVjdFdyaW5rbGVycygpOwogICAgICAgIEdhbWUucGxlZGdlVCA9IDA7CiAgICAgIH0KICAgIH07CiAgICBHYW1lLmxhc3QuaWNvbkZ1bmMgPSBmdW5jdGlvbiAodHlwZSkgewogICAgICB2YXIgZ3JhbmRtYUljb25zID0gWwogICAgICAgIFswLCAxXSwKICAgICAgICBbMCwgMl0sCiAgICAgICAgWzEsIDJdLAogICAgICAgIFsyLCAyXSwKICAgICAgXTsKICAgICAgaWYgKHR5cGUgPT0gIm9mZiIpIHJldHVybiBbMCwgMV07CiAgICAgIGlmIChHYW1lLnByZWZzLm5vdFNjYXJ5ICYmIEdhbWUuZWxkZXJXcmF0aCA+IDApIHJldHVybiBbMywgMl07CiAgICAgIHJldHVybiBncmFuZG1hSWNvbnNbR2FtZS5lbGRlcldyYXRoXTsKICAgIH07CgogICAgbmV3IEdhbWUuT2JqZWN0KAogICAgICAiRmFybSIsCiAgICAgICJmYXJtfGZhcm1zfGhhcnZlc3RlZHxbWF0gbW9yZSBhY3JlfFtYXSBtb3JlIGFjcmVzIiwKICAgICAgIkdyb3dzIGNvb2tpZSBwbGFudHMgZnJvbSBjb29raWUgc2VlZHMuIiwKICAgICAgMywKICAgICAgMiwKICAgICAgeyBiYXNlOiAiZmFybSIsIHhWOiA4LCB5VjogOCwgdzogNjQsIHJvd3M6IDIsIHg6IDAsIHk6IDE2IH0sCiAgICAgIDUwMCwKICAgICAgZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgdmFyIG11bHQgPSAxOwogICAgICAgIG11bHQgKj0gR2FtZS5HZXRUaWVyZWRDcHNNdWx0KG1lKTsKICAgICAgICBtdWx0ICo9IEdhbWUubWFnaWNDcFMobWUubmFtZSk7CiAgICAgICAgcmV0dXJuIG1lLmJhc2VDcHMgKiBtdWx0OwogICAgICB9LAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5VbmxvY2tUaWVyZWQodGhpcyk7CiAgICAgICAgaWYgKAogICAgICAgICAgdGhpcy5hbW91bnQgPj0gR2FtZS5TcGVjaWFsR3JhbmRtYVVubG9jayAmJgogICAgICAgICAgR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0uYW1vdW50ID4gMAogICAgICAgICkKICAgICAgICAgIEdhbWUuVW5sb2NrKHRoaXMuZ3JhbmRtYS5uYW1lKTsKICAgICAgfQogICAgKTsKICAgIEdhbWUubGFzdC5taW5pZ2FtZVVybCA9ICJtaW5pZ2FtZUdhcmRlbi5qcyI7CiAgICBHYW1lLmxhc3QubWluaWdhbWVOYW1lID0gbG9jKCJHYXJkZW4iKTsKCiAgICBuZXcgR2FtZS5PYmplY3QoCiAgICAgICJNaW5lIiwKICAgICAgIm1pbmV8bWluZXN8bWluZWR8W1hdIG1pbGUgZGVlcGVyfFtYXSBtaWxlcyBkZWVwZXIiLAogICAgICAiTWluZXMgb3V0IGNvb2tpZSBkb3VnaCBhbmQgY2hvY29sYXRlIGNoaXBzLiIsCiAgICAgIDQsCiAgICAgIDMsCiAgICAgIHsgYmFzZTogIm1pbmUiLCB4VjogMTYsIHlWOiAxNiwgdzogNjQsIHJvd3M6IDIsIHg6IDAsIHk6IDI0IH0sCiAgICAgIDEwMDAwLAogICAgICBmdW5jdGlvbiAobWUpIHsKICAgICAgICB2YXIgbXVsdCA9IDE7CiAgICAgICAgbXVsdCAqPSBHYW1lLkdldFRpZXJlZENwc011bHQobWUpOwogICAgICAgIG11bHQgKj0gR2FtZS5tYWdpY0NwUyhtZS5uYW1lKTsKICAgICAgICByZXR1cm4gbWUuYmFzZUNwcyAqIG11bHQ7CiAgICAgIH0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLlVubG9ja1RpZXJlZCh0aGlzKTsKICAgICAgICBpZiAoCiAgICAgICAgICB0aGlzLmFtb3VudCA+PSBHYW1lLlNwZWNpYWxHcmFuZG1hVW5sb2NrICYmCiAgICAgICAgICBHYW1lLk9iamVjdHNbIkdyYW5kbWEiXS5hbW91bnQgPiAwCiAgICAgICAgKQogICAgICAgICAgR2FtZS5VbmxvY2sodGhpcy5ncmFuZG1hLm5hbWUpOwogICAgICB9CiAgICApOwoKICAgIG5ldyBHYW1lLk9iamVjdCgKICAgICAgIkZhY3RvcnkiLAogICAgICAiZmFjdG9yeXxmYWN0b3JpZXN8bWFzcy1wcm9kdWNlZHxbWF0gYWRkaXRpb25hbCBwYXRlbnR8W1hdIGFkZGl0aW9uYWwgcGF0ZW50cyIsCiAgICAgICJQcm9kdWNlcyBsYXJnZSBxdWFudGl0aWVzIG9mIGNvb2tpZXMuIiwKICAgICAgNSwKICAgICAgNCwKICAgICAgeyBiYXNlOiAiZmFjdG9yeSIsIHhWOiA4LCB5VjogMCwgdzogNjQsIHJvd3M6IDEsIHg6IDAsIHk6IC0yMiB9LAogICAgICAzMDAwLAogICAgICBmdW5jdGlvbiAobWUpIHsKICAgICAgICB2YXIgbXVsdCA9IDE7CiAgICAgICAgbXVsdCAqPSBHYW1lLkdldFRpZXJlZENwc011bHQobWUpOwogICAgICAgIG11bHQgKj0gR2FtZS5tYWdpY0NwUyhtZS5uYW1lKTsKICAgICAgICByZXR1cm4gbWUuYmFzZUNwcyAqIG11bHQ7CiAgICAgIH0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLlVubG9ja1RpZXJlZCh0aGlzKTsKICAgICAgICBpZiAoCiAgICAgICAgICB0aGlzLmFtb3VudCA+PSBHYW1lLlNwZWNpYWxHcmFuZG1hVW5sb2NrICYmCiAgICAgICAgICBHYW1lLk9iamVjdHNbIkdyYW5kbWEiXS5hbW91bnQgPiAwCiAgICAgICAgKQogICAgICAgICAgR2FtZS5VbmxvY2sodGhpcy5ncmFuZG1hLm5hbWUpOwogICAgICB9CiAgICApOwogICAgLy9HYW1lLmxhc3QubWluaWdhbWVVcmw9J21pbmlnYW1lRHVuZ2Vvbi5qcyc7Ly9ub3QgeWV0CiAgICBHYW1lLmxhc3QubWluaWdhbWVOYW1lID0gbG9jKCJEdW5nZW9uIik7CgogICAgbmV3IEdhbWUuT2JqZWN0KAogICAgICAiQmFuayIsCiAgICAgICJiYW5rfGJhbmtzfGJhbmtlZHxJbnRlcmVzdCByYXRlcyBbWF0lIGJldHRlcnxJbnRlcmVzdCByYXRlcyBbWF0lIGJldHRlciIsCiAgICAgICJHZW5lcmF0ZXMgY29va2llcyBmcm9tIGludGVyZXN0LiIsCiAgICAgIDYsCiAgICAgIDE1LAogICAgICB7IGJhc2U6ICJiYW5rIiwgeFY6IDgsIHlWOiA0LCB3OiA1Niwgcm93czogMSwgeDogMCwgeTogMTMgfSwKICAgICAgMCwKICAgICAgZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgdmFyIG11bHQgPSAxOwogICAgICAgIG11bHQgKj0gR2FtZS5HZXRUaWVyZWRDcHNNdWx0KG1lKTsKICAgICAgICBtdWx0ICo9IEdhbWUubWFnaWNDcFMobWUubmFtZSk7CiAgICAgICAgcmV0dXJuIG1lLmJhc2VDcHMgKiBtdWx0OwogICAgICB9LAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5VbmxvY2tUaWVyZWQodGhpcyk7CiAgICAgICAgaWYgKAogICAgICAgICAgdGhpcy5hbW91bnQgPj0gR2FtZS5TcGVjaWFsR3JhbmRtYVVubG9jayAmJgogICAgICAgICAgR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0uYW1vdW50ID4gMAogICAgICAgICkKICAgICAgICAgIEdhbWUuVW5sb2NrKHRoaXMuZ3JhbmRtYS5uYW1lKTsKICAgICAgfQogICAgKTsKICAgIEdhbWUubGFzdC5taW5pZ2FtZVVybCA9ICJtaW5pZ2FtZU1hcmtldC5qcyI7CiAgICBHYW1lLmxhc3QubWluaWdhbWVOYW1lID0gbG9jKCJTdG9jayBNYXJrZXQiKTsKCiAgICBuZXcgR2FtZS5PYmplY3QoCiAgICAgICJUZW1wbGUiLAogICAgICAidGVtcGxlfHRlbXBsZXN8ZGlzY292ZXJlZHxbWF0gc2FjcmVkIGFydGlmYWN0IHJldHJpZXZlZHxbWF0gc2FjcmVkIGFydGlmYWN0cyByZXRyaWV2ZWQiLAogICAgICAiRnVsbCBvZiBwcmVjaW91cywgYW5jaWVudCBjaG9jb2xhdGUuIiwKICAgICAgNywKICAgICAgMTYsCiAgICAgIHsgYmFzZTogInRlbXBsZSIsIHhWOiA4LCB5VjogNCwgdzogNzIsIHJvd3M6IDIsIHg6IDAsIHk6IC01IH0sCiAgICAgIDAsCiAgICAgIGZ1bmN0aW9uIChtZSkgewogICAgICAgIHZhciBtdWx0ID0gMTsKICAgICAgICBtdWx0ICo9IEdhbWUuR2V0VGllcmVkQ3BzTXVsdChtZSk7CiAgICAgICAgbXVsdCAqPSBHYW1lLm1hZ2ljQ3BTKG1lLm5hbWUpOwogICAgICAgIHJldHVybiBtZS5iYXNlQ3BzICogbXVsdDsKICAgICAgfSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuVW5sb2NrVGllcmVkKHRoaXMpOwogICAgICAgIGlmICgKICAgICAgICAgIHRoaXMuYW1vdW50ID49IEdhbWUuU3BlY2lhbEdyYW5kbWFVbmxvY2sgJiYKICAgICAgICAgIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLmFtb3VudCA+IDAKICAgICAgICApCiAgICAgICAgICBHYW1lLlVubG9jayh0aGlzLmdyYW5kbWEubmFtZSk7CiAgICAgIH0KICAgICk7CiAgICBHYW1lLmxhc3QubWluaWdhbWVVcmwgPSAibWluaWdhbWVQYW50aGVvbi5qcyI7CiAgICBHYW1lLmxhc3QubWluaWdhbWVOYW1lID0gbG9jKCJQYW50aGVvbiIpOwoKICAgIG5ldyBHYW1lLk9iamVjdCgKICAgICAgIldpemFyZCB0b3dlciIsCiAgICAgICJ3aXphcmQgdG93ZXJ8d2l6YXJkIHRvd2Vyc3xzdW1tb25lZHxJbmNhbnRhdGlvbnMgaGF2ZSBbWF0gbW9yZSBzeWxsYWJsZXxJbmNhbnRhdGlvbnMgaGF2ZSBbWF0gbW9yZSBzeWxsYWJsZXMiLAogICAgICAiU3VtbW9ucyBjb29raWVzIHdpdGggbWFnaWMgc3BlbGxzLiIsCiAgICAgIDgsCiAgICAgIDE3LAogICAgICB7IGJhc2U6ICJ3aXphcmR0b3dlciIsIHhWOiAxNiwgeVY6IDE2LCB3OiA0OCwgcm93czogMiwgeDogMCwgeTogMjAgfSwKICAgICAgMCwKICAgICAgZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgdmFyIG11bHQgPSAxOwogICAgICAgIG11bHQgKj0gR2FtZS5HZXRUaWVyZWRDcHNNdWx0KG1lKTsKICAgICAgICBtdWx0ICo9IEdhbWUubWFnaWNDcFMobWUubmFtZSk7CiAgICAgICAgcmV0dXJuIG1lLmJhc2VDcHMgKiBtdWx0OwogICAgICB9LAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5VbmxvY2tUaWVyZWQodGhpcyk7CiAgICAgICAgaWYgKAogICAgICAgICAgdGhpcy5hbW91bnQgPj0gR2FtZS5TcGVjaWFsR3JhbmRtYVVubG9jayAmJgogICAgICAgICAgR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0uYW1vdW50ID4gMAogICAgICAgICkKICAgICAgICAgIEdhbWUuVW5sb2NrKHRoaXMuZ3JhbmRtYS5uYW1lKTsKICAgICAgfQogICAgKTsKICAgIEdhbWUubGFzdC5kaXNwbGF5TmFtZSA9CiAgICAgICc8c3BhbiBzdHlsZT0iZm9udC1zaXplOjkwJTtsZXR0ZXItc3BhY2luZzotMXB4O3Bvc2l0aW9uOnJlbGF0aXZlO2JvdHRvbToycHg7Ij5XaXphcmQgdG93ZXI8L3NwYW4+JzsgLy9zaHJpbmsKICAgIEdhbWUubGFzdC5taW5pZ2FtZVVybCA9ICJtaW5pZ2FtZUdyaW1vaXJlLmpzIjsKICAgIEdhbWUubGFzdC5taW5pZ2FtZU5hbWUgPSBsb2MoIkdyaW1vaXJlIik7CgogICAgbmV3IEdhbWUuT2JqZWN0KAogICAgICAiU2hpcG1lbnQiLAogICAgICAic2hpcG1lbnR8c2hpcG1lbnRzfHNoaXBwZWR8W1hdIGdhbGF4eSBmdWxseSBleHBsb3JlZHxbWF0gZ2FsYXhpZXMgZnVsbHkgZXhwbG9yZWQiLAogICAgICAiQnJpbmdzIGluIGZyZXNoIGNvb2tpZXMgZnJvbSB0aGUgY29va2llIHBsYW5ldC4iLAogICAgICA5LAogICAgICA1LAogICAgICB7IGJhc2U6ICJzaGlwbWVudCIsIHhWOiAxNiwgeVY6IDE2LCB3OiA2NCwgcm93czogMSwgeDogMCwgeTogMCB9LAogICAgICA0MDAwMCwKICAgICAgZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgdmFyIG11bHQgPSAxOwogICAgICAgIG11bHQgKj0gR2FtZS5HZXRUaWVyZWRDcHNNdWx0KG1lKTsKICAgICAgICBtdWx0ICo9IEdhbWUubWFnaWNDcFMobWUubmFtZSk7CiAgICAgICAgcmV0dXJuIG1lLmJhc2VDcHMgKiBtdWx0OwogICAgICB9LAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5VbmxvY2tUaWVyZWQodGhpcyk7CiAgICAgICAgaWYgKAogICAgICAgICAgdGhpcy5hbW91bnQgPj0gR2FtZS5TcGVjaWFsR3JhbmRtYVVubG9jayAmJgogICAgICAgICAgR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0uYW1vdW50ID4gMAogICAgICAgICkKICAgICAgICAgIEdhbWUuVW5sb2NrKHRoaXMuZ3JhbmRtYS5uYW1lKTsKICAgICAgfQogICAgKTsKCiAgICBuZXcgR2FtZS5PYmplY3QoCiAgICAgICJBbGNoZW15IGxhYiIsCiAgICAgICJhbGNoZW15IGxhYnxhbGNoZW15IGxhYnN8dHJhbnNtdXRlZHxbWF0gcHJpbW9yZGlhbCBlbGVtZW50IG1hc3RlcmVkfFtYXSBwcmltb3JkaWFsIGVsZW1lbnRzIG1hc3RlcmVkIiwKICAgICAgIlR1cm5zIGdvbGQgaW50byBjb29raWVzISIsCiAgICAgIDEwLAogICAgICA2LAogICAgICB7IGJhc2U6ICJhbGNoZW15bGFiIiwgeFY6IDE2LCB5VjogMTYsIHc6IDY0LCByb3dzOiAyLCB4OiAwLCB5OiAxNiB9LAogICAgICAyMDAwMDAsCiAgICAgIGZ1bmN0aW9uIChtZSkgewogICAgICAgIHZhciBtdWx0ID0gMTsKICAgICAgICBtdWx0ICo9IEdhbWUuR2V0VGllcmVkQ3BzTXVsdChtZSk7CiAgICAgICAgbXVsdCAqPSBHYW1lLm1hZ2ljQ3BTKG1lLm5hbWUpOwogICAgICAgIHJldHVybiBtZS5iYXNlQ3BzICogbXVsdDsKICAgICAgfSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuVW5sb2NrVGllcmVkKHRoaXMpOwogICAgICAgIGlmICgKICAgICAgICAgIHRoaXMuYW1vdW50ID49IEdhbWUuU3BlY2lhbEdyYW5kbWFVbmxvY2sgJiYKICAgICAgICAgIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLmFtb3VudCA+IDAKICAgICAgICApCiAgICAgICAgICBHYW1lLlVubG9jayh0aGlzLmdyYW5kbWEubmFtZSk7CiAgICAgIH0KICAgICk7CiAgICBHYW1lLmxhc3QuZGlzcGxheU5hbWUgPQogICAgICAnPHNwYW4gc3R5bGU9ImZvbnQtc2l6ZTo5MCU7bGV0dGVyLXNwYWNpbmc6LTFweDtwb3NpdGlvbjpyZWxhdGl2ZTtib3R0b206MnB4OyI+QWxjaGVteSBsYWI8L3NwYW4+JzsgLy9zaHJpbmsKCiAgICBuZXcgR2FtZS5PYmplY3QoCiAgICAgICJQb3J0YWwiLAogICAgICAicG9ydGFsfHBvcnRhbHN8cmV0cmlldmVkfFtYXSBkaW1lbnNpb24gZW5zbGF2ZWR8W1hdIGRpbWVuc2lvbnMgZW5zbGF2ZWQiLAogICAgICAiT3BlbnMgYSBkb29yIHRvIHRoZSBDb29raWV2ZXJzZS4iLAogICAgICAxMSwKICAgICAgNywKICAgICAgeyBiYXNlOiAicG9ydGFsIiwgeFY6IDMyLCB5VjogMzIsIHc6IDY0LCByb3dzOiAyLCB4OiAwLCB5OiAwIH0sCiAgICAgIDE2NjY2NjYsCiAgICAgIGZ1bmN0aW9uIChtZSkgewogICAgICAgIHZhciBtdWx0ID0gMTsKICAgICAgICBtdWx0ICo9IEdhbWUuR2V0VGllcmVkQ3BzTXVsdChtZSk7CiAgICAgICAgbXVsdCAqPSBHYW1lLm1hZ2ljQ3BTKG1lLm5hbWUpOwogICAgICAgIHJldHVybiBtZS5iYXNlQ3BzICogbXVsdDsKICAgICAgfSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuVW5sb2NrVGllcmVkKHRoaXMpOwogICAgICAgIGlmICgKICAgICAgICAgIHRoaXMuYW1vdW50ID49IEdhbWUuU3BlY2lhbEdyYW5kbWFVbmxvY2sgJiYKICAgICAgICAgIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLmFtb3VudCA+IDAKICAgICAgICApCiAgICAgICAgICBHYW1lLlVubG9jayh0aGlzLmdyYW5kbWEubmFtZSk7CiAgICAgIH0KICAgICk7CgogICAgbmV3IEdhbWUuT2JqZWN0KAogICAgICAiVGltZSBtYWNoaW5lIiwKICAgICAgInRpbWUgbWFjaGluZXx0aW1lIG1hY2hpbmVzfHJlY292ZXJlZHxbWF0gY2VudHVyeSBzZWN1cmVkfFtYXSBjZW50dXJpZXMgc2VjdXJlZCIsCiAgICAgICJCcmluZ3MgY29va2llcyBmcm9tIHRoZSBwYXN0LCBiZWZvcmUgdGhleSB3ZXJlIGV2ZW4gZWF0ZW4uIiwKICAgICAgMTIsCiAgICAgIDgsCiAgICAgIHsgYmFzZTogInRpbWVtYWNoaW5lIiwgeFY6IDMyLCB5VjogMzIsIHc6IDY0LCByb3dzOiAxLCB4OiAwLCB5OiAwIH0sCiAgICAgIDEyMzQ1Njc4OSwKICAgICAgZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgdmFyIG11bHQgPSAxOwogICAgICAgIG11bHQgKj0gR2FtZS5HZXRUaWVyZWRDcHNNdWx0KG1lKTsKICAgICAgICBtdWx0ICo9IEdhbWUubWFnaWNDcFMobWUubmFtZSk7CiAgICAgICAgcmV0dXJuIG1lLmJhc2VDcHMgKiBtdWx0OwogICAgICB9LAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5VbmxvY2tUaWVyZWQodGhpcyk7CiAgICAgICAgaWYgKAogICAgICAgICAgdGhpcy5hbW91bnQgPj0gR2FtZS5TcGVjaWFsR3JhbmRtYVVubG9jayAmJgogICAgICAgICAgR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0uYW1vdW50ID4gMAogICAgICAgICkKICAgICAgICAgIEdhbWUuVW5sb2NrKHRoaXMuZ3JhbmRtYS5uYW1lKTsKICAgICAgfQogICAgKTsKICAgIEdhbWUubGFzdC5kaXNwbGF5TmFtZSA9CiAgICAgICc8c3BhbiBzdHlsZT0iZm9udC1zaXplOjgwJTtsZXR0ZXItc3BhY2luZzotMXB4O3Bvc2l0aW9uOnJlbGF0aXZlO2JvdHRvbTozcHg7Ij5UaW1lIG1hY2hpbmU8L3NwYW4+JzsgLy9zaHJpbmsKCiAgICBuZXcgR2FtZS5PYmplY3QoCiAgICAgICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsCiAgICAgICJhbnRpbWF0dGVyIGNvbmRlbnNlcnxhbnRpbWF0dGVyIGNvbmRlbnNlcnN8Y29uZGVuc2VkfFtYXSBleHRyYSBxdWFyayBmbGF2b3J8W1hdIGV4dHJhIHF1YXJrIGZsYXZvcnMiLAogICAgICAiQ29uZGVuc2VzIHRoZSBhbnRpbWF0dGVyIGluIHRoZSB1bml2ZXJzZSBpbnRvIGNvb2tpZXMuIiwKICAgICAgMTMsCiAgICAgIDEzLAogICAgICB7CiAgICAgICAgYmFzZTogImFudGltYXR0ZXJjb25kZW5zZXIiLAogICAgICAgIHhWOiAwLAogICAgICAgIHlWOiA2NCwKICAgICAgICB3OiA2NCwKICAgICAgICByb3dzOiAxLAogICAgICAgIHg6IDAsCiAgICAgICAgeTogMCwKICAgICAgfSwKICAgICAgMzk5OTk5OTk5OSwKICAgICAgZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgdmFyIG11bHQgPSAxOwogICAgICAgIG11bHQgKj0gR2FtZS5HZXRUaWVyZWRDcHNNdWx0KG1lKTsKICAgICAgICBtdWx0ICo9IEdhbWUubWFnaWNDcFMobWUubmFtZSk7CiAgICAgICAgcmV0dXJuIG1lLmJhc2VDcHMgKiBtdWx0OwogICAgICB9LAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5VbmxvY2tUaWVyZWQodGhpcyk7CiAgICAgICAgaWYgKAogICAgICAgICAgdGhpcy5hbW91bnQgPj0gR2FtZS5TcGVjaWFsR3JhbmRtYVVubG9jayAmJgogICAgICAgICAgR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0uYW1vdW50ID4gMAogICAgICAgICkKICAgICAgICAgIEdhbWUuVW5sb2NrKHRoaXMuZ3JhbmRtYS5uYW1lKTsKICAgICAgfQogICAgKTsKICAgIEdhbWUubGFzdC5kaXNwbGF5TmFtZSA9CiAgICAgICc8c3BhbiBzdHlsZT0iZm9udC1zaXplOjY1JTtsZXR0ZXItc3BhY2luZzotMXB4O3Bvc2l0aW9uOnJlbGF0aXZlO2JvdHRvbTo0cHg7Ij5BbnRpbS4gY29uZGVuc2VyPC9zcGFuPic7IC8vc2hyaW5rCgogICAgbmV3IEdhbWUuT2JqZWN0KAogICAgICAiUHJpc20iLAogICAgICAicHJpc218cHJpc21zfGNvbnZlcnRlZHxbWF0gbmV3IGNvbG9yIGRpc2NvdmVyZWR8W1hdIG5ldyBjb2xvcnMgZGlzY292ZXJlZCIsCiAgICAgICJDb252ZXJ0cyBsaWdodCBpdHNlbGYgaW50byBjb29raWVzLiIsCiAgICAgIDE0LAogICAgICAxNCwKICAgICAgeyBiYXNlOiAicHJpc20iLCB4VjogMTYsIHlWOiA0LCB3OiA2NCwgcm93czogMSwgeDogMCwgeTogMjAgfSwKICAgICAgNzUwMDAwMDAwMDAsCiAgICAgIGZ1bmN0aW9uIChtZSkgewogICAgICAgIHZhciBtdWx0ID0gMTsKICAgICAgICBtdWx0ICo9IEdhbWUuR2V0VGllcmVkQ3BzTXVsdChtZSk7CiAgICAgICAgbXVsdCAqPSBHYW1lLm1hZ2ljQ3BTKG1lLm5hbWUpOwogICAgICAgIHJldHVybiBtZS5iYXNlQ3BzICogbXVsdDsKICAgICAgfSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuVW5sb2NrVGllcmVkKHRoaXMpOwogICAgICAgIGlmICgKICAgICAgICAgIHRoaXMuYW1vdW50ID49IEdhbWUuU3BlY2lhbEdyYW5kbWFVbmxvY2sgJiYKICAgICAgICAgIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLmFtb3VudCA+IDAKICAgICAgICApCiAgICAgICAgICBHYW1lLlVubG9jayh0aGlzLmdyYW5kbWEubmFtZSk7CiAgICAgIH0KICAgICk7CgogICAgbmV3IEdhbWUuT2JqZWN0KAogICAgICAiQ2hhbmNlbWFrZXIiLAogICAgICAiY2hhbmNlbWFrZXJ8Y2hhbmNlbWFrZXJzfHNwb250YW5lb3VzbHkgZ2VuZXJhdGVkfENoYW5jZW1ha2VycyBhcmUgcG93ZXJlZCBieSBbWF0tbGVhZiBjbG92ZXJzfENoYW5jZW1ha2VycyBhcmUgcG93ZXJlZCBieSBbWF0tbGVhZiBjbG92ZXJzIiwKICAgICAgIkdlbmVyYXRlcyBjb29raWVzIG91dCBvZiB0aGluIGFpciB0aHJvdWdoIHNoZWVyIGx1Y2suIiwKICAgICAgMTUsCiAgICAgIDE5LAogICAgICB7CiAgICAgICAgYmFzZTogImNoYW5jZW1ha2VyIiwKICAgICAgICB4VjogOCwKICAgICAgICB5VjogNjQsCiAgICAgICAgdzogNjQsCiAgICAgICAgcm93czogMSwKICAgICAgICB4OiAwLAogICAgICAgIHk6IDAsCiAgICAgICAgcm93czogMiwKICAgICAgfSwKICAgICAgNzc3Nzc3Nzc3NzcsCiAgICAgIGZ1bmN0aW9uIChtZSkgewogICAgICAgIHZhciBtdWx0ID0gMTsKICAgICAgICBtdWx0ICo9IEdhbWUuR2V0VGllcmVkQ3BzTXVsdChtZSk7CiAgICAgICAgbXVsdCAqPSBHYW1lLm1hZ2ljQ3BTKG1lLm5hbWUpOwogICAgICAgIHJldHVybiBtZS5iYXNlQ3BzICogbXVsdDsKICAgICAgfSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuVW5sb2NrVGllcmVkKHRoaXMpOwogICAgICAgIGlmICgKICAgICAgICAgIHRoaXMuYW1vdW50ID49IEdhbWUuU3BlY2lhbEdyYW5kbWFVbmxvY2sgJiYKICAgICAgICAgIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLmFtb3VudCA+IDAKICAgICAgICApCiAgICAgICAgICBHYW1lLlVubG9jayh0aGlzLmdyYW5kbWEubmFtZSk7CiAgICAgIH0KICAgICk7CiAgICBHYW1lLmxhc3QuZGlzcGxheU5hbWUgPQogICAgICAnPHNwYW4gc3R5bGU9ImZvbnQtc2l6ZTo4NSU7bGV0dGVyLXNwYWNpbmc6LTFweDtwb3NpdGlvbjpyZWxhdGl2ZTtib3R0b206MnB4OyI+Q2hhbmNlbWFrZXI8L3NwYW4+JzsgLy9zaHJpbmsKCiAgICBuZXcgR2FtZS5PYmplY3QoCiAgICAgICJGcmFjdGFsIGVuZ2luZSIsCiAgICAgICJmcmFjdGFsIGVuZ2luZXxmcmFjdGFsIGVuZ2luZXN8bWFkZSBmcm9tIGNvb2tpZXN8W1hdIGl0ZXJhdGlvbiBkZWVwfFtYXSBpdGVyYXRpb25zIGRlZXAiLAogICAgICAiVHVybnMgY29va2llcyBpbnRvIGV2ZW4gbW9yZSBjb29raWVzLiIsCiAgICAgIDE2LAogICAgICAyMCwKICAgICAgeyBiYXNlOiAiZnJhY3RhbEVuZ2luZSIsIHhWOiA4LCB5VjogNjQsIHc6IDY0LCByb3dzOiAxLCB4OiAwLCB5OiAwIH0sCiAgICAgIDEyMzQ1Njc4OTg3NjU0MzIxLAogICAgICBmdW5jdGlvbiAobWUpIHsKICAgICAgICB2YXIgbXVsdCA9IDE7CiAgICAgICAgbXVsdCAqPSBHYW1lLkdldFRpZXJlZENwc011bHQobWUpOwogICAgICAgIG11bHQgKj0gR2FtZS5tYWdpY0NwUyhtZS5uYW1lKTsKICAgICAgICByZXR1cm4gbWUuYmFzZUNwcyAqIG11bHQ7CiAgICAgIH0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLlVubG9ja1RpZXJlZCh0aGlzKTsKICAgICAgICBpZiAoCiAgICAgICAgICB0aGlzLmFtb3VudCA+PSBHYW1lLlNwZWNpYWxHcmFuZG1hVW5sb2NrICYmCiAgICAgICAgICBHYW1lLk9iamVjdHNbIkdyYW5kbWEiXS5hbW91bnQgPiAwCiAgICAgICAgKQogICAgICAgICAgR2FtZS5VbmxvY2sodGhpcy5ncmFuZG1hLm5hbWUpOwogICAgICB9CiAgICApOwogICAgR2FtZS5sYXN0LmRpc3BsYXlOYW1lID0KICAgICAgJzxzcGFuIHN0eWxlPSJmb250LXNpemU6ODAlO2xldHRlci1zcGFjaW5nOi0xcHg7cG9zaXRpb246cmVsYXRpdmU7Ym90dG9tOjRweDsiPkZyYWN0YWwgZW5naW5lPC9zcGFuPic7IC8vc2hyaW5rCgogICAgbmV3IEdhbWUuT2JqZWN0KAogICAgICAiSmF2YXNjcmlwdCBjb25zb2xlIiwKICAgICAgImphdmFzY3JpcHQgY29uc29sZXxqYXZhc2NyaXB0IGNvbnNvbGVzfHByb2dyYW1tZWR8RXF1aXBwZWQgd2l0aCBbWF0gZXh0ZXJuYWwgbGlicmFyeXxFcXVpcHBlZCB3aXRoIFtYXSBleHRlcm5hbCBsaWJyYXJpZXMiLAogICAgICAiQ3JlYXRlcyBjb29raWVzIGZyb20gdGhlIHZlcnkgY29kZSB0aGlzIGdhbWUgd2FzIHdyaXR0ZW4gaW4uIiwKICAgICAgMTcsCiAgICAgIDMyLAogICAgICB7CiAgICAgICAgYmFzZTogImphdmFzY3JpcHRjb25zb2xlIiwKICAgICAgICB4VjogOCwKICAgICAgICB5VjogNjQsCiAgICAgICAgdzogMTQsCiAgICAgICAgcm93czogMSwKICAgICAgICB4OiA4LAogICAgICAgIHk6IC0zMiwKICAgICAgICBmcmFtZXM6IDIsCiAgICAgIH0sCiAgICAgIDEyMzQ1Njc4OTg3NjU0MzIxLAogICAgICBmdW5jdGlvbiAobWUpIHsKICAgICAgICB2YXIgbXVsdCA9IDE7CiAgICAgICAgbXVsdCAqPSBHYW1lLkdldFRpZXJlZENwc011bHQobWUpOwogICAgICAgIG11bHQgKj0gR2FtZS5tYWdpY0NwUyhtZS5uYW1lKTsKICAgICAgICByZXR1cm4gbWUuYmFzZUNwcyAqIG11bHQ7CiAgICAgIH0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLlVubG9ja1RpZXJlZCh0aGlzKTsKICAgICAgICBpZiAoCiAgICAgICAgICB0aGlzLmFtb3VudCA+PSBHYW1lLlNwZWNpYWxHcmFuZG1hVW5sb2NrICYmCiAgICAgICAgICBHYW1lLk9iamVjdHNbIkdyYW5kbWEiXS5hbW91bnQgPiAwCiAgICAgICAgKQogICAgICAgICAgR2FtZS5VbmxvY2sodGhpcy5ncmFuZG1hLm5hbWUpOwogICAgICB9CiAgICApOwogICAgR2FtZS5sYXN0LmRpc3BsYXlOYW1lID0KICAgICAgJzxzcGFuIHN0eWxlPSJmb250LXNpemU6NjUlO2xldHRlci1zcGFjaW5nOi0xcHg7cG9zaXRpb246cmVsYXRpdmU7Ym90dG9tOjRweDsiPkphdmFzY3JpcHQgY29uc29sZTwvc3Bhbj4nOyAvL3NocmluawoKICAgIG5ldyBHYW1lLk9iamVjdCgKICAgICAgIklkbGV2ZXJzZSIsCiAgICAgICJpZGxldmVyc2V8aWRsZXZlcnNlc3xoaWphY2tlZHxbWF0gbWFuaWZvbGR8W1hdIG1hbmlmb2xkcyIsCiAgICAgICJUaGVyZSdzIGJlZW4gY291bnRsZXNzIG90aGVyIGlkbGUgdW5pdmVyc2VzIHJ1bm5pbmcgYWxvbmdzaWRlIG91ciBvd24uIFlvdSd2ZSBmaW5hbGx5IGZvdW5kIGEgd2F5IHRvIGhpamFjayB0aGVpciBwcm9kdWN0aW9uIGFuZCBjb252ZXJ0IHdoYXRldmVyIHRoZXkndmUgYmVlbiBtYWtpbmcgaW50byBjb29raWVzISIsCiAgICAgIDE4LAogICAgICAzMywKICAgICAgewogICAgICAgIGJhc2U6ICJpZGxldmVyc2UiLAogICAgICAgIHhWOiA4LAogICAgICAgIHlWOiA5NiwKICAgICAgICB3OiA0OCwKICAgICAgICByb3dzOiAyLAogICAgICAgIHg6IDAsCiAgICAgICAgeTogMCwKICAgICAgICBmcmFtZXM6IDQsCiAgICAgIH0sCiAgICAgIDEyMzQ1Njc4OTg3NjU0MzIxLAogICAgICBmdW5jdGlvbiAobWUpIHsKICAgICAgICB2YXIgbXVsdCA9IDE7CiAgICAgICAgbXVsdCAqPSBHYW1lLkdldFRpZXJlZENwc011bHQobWUpOwogICAgICAgIG11bHQgKj0gR2FtZS5tYWdpY0NwUyhtZS5uYW1lKTsKICAgICAgICByZXR1cm4gbWUuYmFzZUNwcyAqIG11bHQ7CiAgICAgIH0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLlVubG9ja1RpZXJlZCh0aGlzKTsKICAgICAgICBpZiAoCiAgICAgICAgICB0aGlzLmFtb3VudCA+PSBHYW1lLlNwZWNpYWxHcmFuZG1hVW5sb2NrICYmCiAgICAgICAgICBHYW1lLk9iamVjdHNbIkdyYW5kbWEiXS5hbW91bnQgPiAwCiAgICAgICAgKQogICAgICAgICAgR2FtZS5VbmxvY2sodGhpcy5ncmFuZG1hLm5hbWUpOwogICAgICB9CiAgICApOwoKICAgIG5ldyBHYW1lLk9iamVjdCgKICAgICAgIkNvcnRleCBiYWtlciIsCiAgICAgICJjb3J0ZXggYmFrZXJ8Y29ydGV4IGJha2Vyc3xpbWFnaW5lZHxbWF0gZXh0cmEgSVEgcG9pbnR8W1hdIGV4dHJhIElRIHBvaW50cyIsCiAgICAgICJUaGVzZSBhcnRpZmljaWFsIGJyYWlucyB0aGUgc2l6ZSBvZiBwbGFuZXRzIGFyZSBjYXBhYmxlIG9mIHNpbXBseSBkcmVhbWluZyB1cCBjb29raWVzIGludG8gZXhpc3RlbmNlLiBUaW1lIGFuZCBzcGFjZSBhcmUgaW5jb25zZXF1ZW50aWFsLiBSZWFsaXR5IGlzIGFyYml0cmFyeS4iLAogICAgICAxOSwKICAgICAgMzQsCiAgICAgIHsgYmFzZTogImNvcnRleCIsIHhWOiA4LCB5VjogOTYsIHc6IDQ4LCByb3dzOiAxLCB4OiAwLCB5OiAwLCBmcmFtZXM6IDQgfSwKICAgICAgMTIzNDU2Nzg5ODc2NTQzMjEsCiAgICAgIGZ1bmN0aW9uIChtZSkgewogICAgICAgIHZhciBtdWx0ID0gMTsKICAgICAgICBtdWx0ICo9IEdhbWUuR2V0VGllcmVkQ3BzTXVsdChtZSk7CiAgICAgICAgbXVsdCAqPSBHYW1lLm1hZ2ljQ3BTKG1lLm5hbWUpOwogICAgICAgIHJldHVybiBtZS5iYXNlQ3BzICogbXVsdDsKICAgICAgfSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuVW5sb2NrVGllcmVkKHRoaXMpOwogICAgICAgIGlmICgKICAgICAgICAgIHRoaXMuYW1vdW50ID49IEdhbWUuU3BlY2lhbEdyYW5kbWFVbmxvY2sgJiYKICAgICAgICAgIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLmFtb3VudCA+IDAKICAgICAgICApCiAgICAgICAgICBHYW1lLlVubG9jayh0aGlzLmdyYW5kbWEubmFtZSk7CiAgICAgIH0KICAgICk7CgogICAgR2FtZS5mb29sT2JqZWN0cyA9IHsKICAgICAgVW5rbm93bjogewogICAgICAgIG5hbWU6ICJJbnZlc3RtZW50IiwKICAgICAgICBkZXNjOiAiWW91J3JlIG5vdCBzdXJlIHdoYXQgdGhpcyBkb2VzLCB5b3UganVzdCBrbm93IGl0IG1lYW5zIHByb2ZpdC4iLAogICAgICAgIGljb246IDAsCiAgICAgIH0sCiAgICAgIEN1cnNvcjogewogICAgICAgIG5hbWU6ICJSb2xsaW5nIHBpbiIsCiAgICAgICAgZGVzYzogIkVzc2VudGlhbCBpbiBmbGF0dGVuaW5nIGRvdWdoLiBUaGUgZmlyc3Qgc3RlcCBpbiBjb29raWUtbWFraW5nLiIsCiAgICAgICAgaWNvbjogMCwKICAgICAgfSwKICAgICAgR3JhbmRtYTogewogICAgICAgIG5hbWU6ICJPdmVuIiwKICAgICAgICBkZXNjOiAiQSBjcnVjaWFsIGVsZW1lbnQgb2YgYmFraW5nIGNvb2tpZXMuIiwKICAgICAgICBpY29uOiAxLAogICAgICB9LAogICAgICBGYXJtOiB7CiAgICAgICAgbmFtZTogIktpdGNoZW4iLAogICAgICAgIGRlc2M6ICJUaGUgbW9yZSBraXRjaGVucywgdGhlIG1vcmUgY29va2llcyB5b3VyIGVtcGxveWVlcyBjYW4gcHJvZHVjZS4iLAogICAgICAgIGljb246IDIsCiAgICAgIH0sCiAgICAgIE1pbmU6IHsKICAgICAgICBuYW1lOiAiU2VjcmV0IHJlY2lwZSIsCiAgICAgICAgZGVzYzogIlRoZXNlIGdpdmUgeW91IHRoZSBlZGdlIHlvdSBuZWVkIHRvIG91dHNlbGwgdGhvc2UgcGVza3kgY29tcGV0aXRvcnMuIiwKICAgICAgICBpY29uOiAzLAogICAgICB9LAogICAgICBGYWN0b3J5OiB7CiAgICAgICAgbmFtZTogIkZhY3RvcnkiLAogICAgICAgIGRlc2M6ICJNYXNzIHByb2R1Y3Rpb24gaXMgdGhlIGZ1dHVyZSBvZiBiYWtpbmcuIFNlaXplIHRoZSBkYXksIGFuZCBzeW5lcmdpemUhIiwKICAgICAgICBpY29uOiA0LAogICAgICB9LAogICAgICBCYW5rOiB7CiAgICAgICAgbmFtZTogIkludmVzdG9yIiwKICAgICAgICBkZXNjOiAiQnVzaW5lc3MgZm9sa3Mgd2l0aCBhIG5vc2UgZm9yIHByb2ZpdCwgcmVhZHkgdG8gZmluYW5jZSB5b3VyIHZlbnR1cmUgYXMgbG9uZyBhcyB0aGVyZSdzIG1vbmV5IHRvIGJlIG1hZGUuIiwKICAgICAgICBpY29uOiA1LAogICAgICB9LAogICAgICBUZW1wbGU6IHsKICAgICAgICBuYW1lOiAiTGlrZSIsCiAgICAgICAgZGVzYzogIllvdXIgc29jaWFsIG1lZGlhIHBhZ2UgaXMgZ29pbmcgdmlyYWwhIEFtYXNzaW5nIGxpa2VzIGlzIHRoZSBrZXkgdG8gYSBsYXN0aW5nIG9ubGluZSBwcmVzZW5jZSBhbmQganVpY3kgYWR2ZXJ0aXNpbmcgZGVhbHMuIiwKICAgICAgICBpY29uOiA5LAogICAgICB9LAogICAgICAiV2l6YXJkIHRvd2VyIjogewogICAgICAgIG5hbWU6ICJNZW1lIiwKICAgICAgICBkZXNjOiAiQ29va2llIG1lbWVzIGFyZSBhbGwgdGhlIHJhZ2UhIFdpdGgganVzdCB0aGUgcmlnaHQgYW1vdW50IG9mIHNvY2lhbCBtZWRpYSBhc3Ryb3R1cmZpbmcsIHlvdXIgYnJhbmQgaW1hZ2Ugd2lsbCBiZSBhbGwgb3ZlciB0aGUgY3liZXJzcGFjZS4iLAogICAgICAgIGljb246IDYsCiAgICAgIH0sCiAgICAgIFNoaXBtZW50OiB7CiAgICAgICAgbmFtZTogIlN1cGVybWFya2V0IiwKICAgICAgICBkZXNjOiAiQSBnaWdhbnRpYyBjb29raWUgZW1wb3JpdW0gLSB5b3VyIHZlcnkgb3duIHJldGFpbCBjaGFpbi4iLAogICAgICAgIGljb246IDcsCiAgICAgIH0sCiAgICAgICJBbGNoZW15IGxhYiI6IHsKICAgICAgICBuYW1lOiAiU3RvY2sgc2hhcmUiLAogICAgICAgIGRlc2M6ICJZb3UncmUgb2ZmaWNpYWxseSBvbiB0aGUgc3RvY2sgbWFya2V0LCBhbmQgZXZlcnlvbmUgd2FudHMgYSBwaWVjZSEiLAogICAgICAgIGljb246IDgsCiAgICAgIH0sCiAgICAgIFBvcnRhbDogewogICAgICAgIG5hbWU6ICJUViBzaG93IiwKICAgICAgICBkZXNjOiAiWW91ciBjb29raWVzIGhhdmUgdGhlaXIgb3duIHNpdGNvbSEgSGlsYXJpb3VzIGJha2luZyBoaWppbmtzIHNldCB0byB0aGUgY2hlZXNpZXN0IGxhdWdodHJhY2suIiwKICAgICAgICBpY29uOiAxMCwKICAgICAgfSwKICAgICAgIlRpbWUgbWFjaGluZSI6IHsKICAgICAgICBuYW1lOiAiVGhlbWUgcGFyayIsCiAgICAgICAgZGVzYzogIkNvb2tpZSB0aGVtZSBwYXJrcywgZnVsbCBvZiBtYXNjb3RzIGFuZCByb2xsZXItY29hc3RlcnMuIEJ1aWxkIG9uZSwgYnVpbGQgYSBodW5kcmVkISIsCiAgICAgICAgaWNvbjogMTEsCiAgICAgIH0sCiAgICAgICJBbnRpbWF0dGVyIGNvbmRlbnNlciI6IHsKICAgICAgICBuYW1lOiAiQ29va2llY29pbiIsCiAgICAgICAgZGVzYzogIkEgdmlydHVhbCBjdXJyZW5jeSwgYWxyZWFkeSByZXBsYWNpbmcgcmVndWxhciBtb25leSBpbiBzb21lIHNtYWxsIGNvdW50cmllcy4iLAogICAgICAgIGljb246IDEyLAogICAgICB9LAogICAgICBQcmlzbTogewogICAgICAgIG5hbWU6ICJDb3Jwb3JhdGUgY291bnRyeSIsCiAgICAgICAgZGVzYzogIllvdSd2ZSBtYWRlIGl0IHRvIHRoZSB0b3AsIGFuZCB5b3UgY2FuIG5vdyBidXkgZW50aXJlIG5hdGlvbnMgdG8gZnVydGhlciB5b3VyIGNvcnBvcmF0ZSBncmVlZC4gR29kc3BlZWQuIiwKICAgICAgICBpY29uOiAxMywKICAgICAgfSwKICAgICAgQ2hhbmNlbWFrZXI6IHsKICAgICAgICBuYW1lOiAiUHJpdmF0aXplZCBwbGFuZXQiLAogICAgICAgIGRlc2M6ICJBY3R1YWxseSwgeW91IGtub3cgd2hhdCdzIGNvb2w/IEEgd2hvbGUgcGxhbmV0IGRlZGljYXRlZCB0byBwcm9kdWNpbmcsIGFkdmVydGlzaW5nLCBzZWxsaW5nLCBhbmQgY29uc3VtaW5nIHlvdXIgY29va2llcy4iLAogICAgICAgIGljb246IDE1LAogICAgICB9LAogICAgICAiRnJhY3RhbCBlbmdpbmUiOiB7CiAgICAgICAgbmFtZTogIlNlbmF0ZSBzZWF0IiwKICAgICAgICBkZXNjOiAiT25seSB0aHJvdWdoIHBvbGl0aWNhbCBkb21pbmlvbiBjYW4geW91IHRydWx5IGFsdGVyIHRoaXMgd29ybGQgdG8gY3JlYXRlIGEgYnJpZ2h0ZXIsIG1vcmUgY29va2llLWZyaWVuZGx5IGZ1dHVyZS4iLAogICAgICAgIGljb246IDE2LAogICAgICB9LAogICAgICAiSmF2YXNjcmlwdCBjb25zb2xlIjogewogICAgICAgIG5hbWU6ICJEb2N0cmluZSIsCiAgICAgICAgZGVzYzogIlRha2luZyBtYW55IGZvcm1zIC1yZWxpZ2lvbiwgY3VsdHVyZSwgcGhpbG9zb3BoeS0gYSBkb2N0cmluZSBtYXksIHdoZW4gaGFuZGxlZCBwcm9wZXJseSwgY2F1c2UgYSBsYXN0aW5nIGltcGFjdCBvbiBjaXZpbGl6YXRpb25zLCByZXNoYXBpbmcgbWluZHMgYW5kIHBlb3BsZSBhbmQgZW5zdXJpbmcgYWxsIGZ1dHVyZSBnZW5lcmF0aW9ucyBzaGFyZSBhIHNpbmd1bGFyIGdvYWwgLSB0aGUgcHJvZHVjdGlvbiwgYW5kIGFjcXVpc2l0aW9uLCBvZiBtb3JlIGNvb2tpZXMuIiwKICAgICAgICBpY29uOiAxNywKICAgICAgfSwKICAgICAgSWRsZXZlcnNlOiB7CiAgICAgICAgbmFtZTogIkxhdGVyYWwgZXhwYW5zaW9ucyIsCiAgICAgICAgZGVzYzogIlNvbWV0aW1lcyB0aGUgYmVzdCB3YXkgdG8ga2VlcCBnb2luZyB1cCBpcyBzaWRld2F5cy4gRGl2ZXJzaWZ5IHlvdXIgdmVudHVyZXMgdGhyb3VnaCBub24tY29va2llIGludmVzdG1lbnRzLiIsCiAgICAgICAgaWNvbjogMTgsCiAgICAgIH0sCiAgICAgICJDb3J0ZXggYmFrZXIiOiB7CiAgICAgICAgbmFtZTogIlRoaW5rIHRhbmsiLAogICAgICAgIGRlc2M6ICJUaGVyZSdzIG9ubHkgc28gbWFueSB3YXlzIHlvdSBjYW4gYnJpbmcgaW4gbW9yZSBwcm9maXQuIE9yIGlzIHRoZXJlPyBIaXJlIHRoZSBtb3N0IGJyaWxsaWFudCBleHBlcnRzIGluIHRoZSBrbm93biB1bml2ZXJzZSBhbmQgbGV0IHRoZW0gc2NyYXBlIHRoZWlyIGJyYWlucyBmb3IgeW91ISIsCiAgICAgICAgaWNvbjogMTksCiAgICAgIH0sCiAgICB9OwoKICAgIGlmICh0cnVlKSB7CiAgICAgIC8vaWYgKCFFTikKICAgICAgR2FtZS5mb29sT2JqZWN0c1siVW5rbm93biJdLm5hbWUgPSBsb2MoIkludmVzdG1lbnQiKTsKICAgICAgR2FtZS5mb29sT2JqZWN0c1siVW5rbm93biJdLmRlc2MgPSBsb2MoCiAgICAgICAgIllvdSdyZSBub3Qgc3VyZSB3aGF0IHRoaXMgZG9lcywgeW91IGp1c3Qga25vdyBpdCBtZWFucyBwcm9maXQuIgogICAgICApOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0cykgewogICAgICAgIEdhbWUuZm9vbE9iamVjdHNbaV0ubmFtZSA9CiAgICAgICAgICBsb2MoRmluZExvY1N0cmluZ0J5UGFydChHYW1lLk9iamVjdHNbaV0ubmFtZSArICIgYnVzaW5lc3MgbmFtZSIpKSB8fAogICAgICAgICAgR2FtZS5mb29sT2JqZWN0c1tpXS5uYW1lOwogICAgICAgIEdhbWUuZm9vbE9iamVjdHNbaV0uZGVzYyA9CiAgICAgICAgICBsb2MoRmluZExvY1N0cmluZ0J5UGFydChHYW1lLk9iamVjdHNbaV0ubmFtZSArICIgYnVzaW5lc3MgcXVvdGUiKSkgfHwKICAgICAgICAgIEdhbWUuZm9vbE9iamVjdHNbaV0uZGVzYzsKICAgICAgfQogICAgfQoKICAgIC8vYnVpbGQgc3RvcmUKICAgIEdhbWUuQnVpbGRTdG9yZSgpOwoKICAgIC8vYnVpbGQgbWFzdGVyIGJhcgogICAgdmFyIHN0ciA9ICIiOwogICAgc3RyICs9CiAgICAgICc8ZGl2IGlkPSJidWlsZGluZ3NNdXRlIiBjbGFzcz0ic2hhZG93RmlsdGVyIiBzdHlsZT0icG9zaXRpb246cmVsYXRpdmU7ei1pbmRleDoxMDA7cGFkZGluZzo0cHggMTZweCAwcHggNjRweDsiPjwvZGl2Pic7CiAgICBzdHIgKz0KICAgICAgJzxkaXYgY2xhc3M9InNlcGFyYXRvckJvdHRvbSIgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlO2JvdHRvbTotOHB4O3otaW5kZXg6MDsiPjwvZGl2Pic7CiAgICBsKCJidWlsZGluZ3NNYXN0ZXIiKS5pbm5lckhUTUwgPSBzdHI7CgogICAgLy9idWlsZCBvYmplY3QgZGlzcGxheXMKICAgIHZhciBtdXRlU3RyID0KICAgICAgJzxkaXYgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlO2xlZnQ6OHB4O2JvdHRvbToxMnB4O29wYWNpdHk6MC41OyI+JyArCiAgICAgIGxvYygiTXV0ZWQ6IikgKwogICAgICAiPC9kaXY+IjsKICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKSB7CiAgICAgIHZhciBtZSA9IEdhbWUuT2JqZWN0c1tpXTsKCiAgICAgIGlmIChsb2NTdHJpbmdzW21lLm5hbWUgKyAiIChzaG9ydCkiXSkKICAgICAgICBtZS5kaXNwbGF5TmFtZSA9IGxvYyhtZS5uYW1lICsgIiAoc2hvcnQpIik7CgogICAgICBpZiAobWUuaWQgPiAwKSB7CiAgICAgICAgbWUuY2FudmFzID0gbCgicm93Q2FudmFzIiArIG1lLmlkKTsKICAgICAgICBtZS5jdHggPSBtZS5jYW52YXMuZ2V0Q29udGV4dCgiMmQiLCB7IGFscGhhOiBmYWxzZSB9KTsKICAgICAgICBtZS5waWNzID0gW107CiAgICAgICAgdmFyIGljb24gPSBbMCAqIDY0LCBtZS5pY29uICogNjRdOwogICAgICAgIG11dGVTdHIgKz0KICAgICAgICAgICc8ZGl2IGNsYXNzPSJ0aW55UHJvZHVjdEljb24iIGlkPSJtdXRlZFByb2R1Y3QnICsKICAgICAgICAgIG1lLmlkICsKICAgICAgICAgICciIHN0eWxlPSJkaXNwbGF5Om5vbmU7YmFja2dyb3VuZC1wb3NpdGlvbjotJyArCiAgICAgICAgICBpY29uWzBdICsKICAgICAgICAgICJweCAtIiArCiAgICAgICAgICBpY29uWzFdICsKICAgICAgICAgICdweDsiICcgKwogICAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgICAnPSJHYW1lLk9iamVjdHNCeUlkWycgKwogICAgICAgICAgbWUuaWQgKwogICAgICAgICAgIl0ubXV0ZSgwKTtQbGF5U291bmQoR2FtZS5PYmplY3RzQnlJZFsiICsKICAgICAgICAgIG1lLmlkICsKICAgICAgICAgICJdLm11dGVkPydzbmQvY2xpY2tPZmYyLm1wMyc6J3NuZC9jbGlja09uMi5tcDMnKTtcIiAiICsKICAgICAgICAgIEdhbWUuZ2V0RHluYW1pY1Rvb2x0aXAoCiAgICAgICAgICAgICJHYW1lLm11dGVkQnVpbGRpbmdUb29sdGlwKCIgKyBtZS5pZCArICIpIiwKICAgICAgICAgICAgInRoaXMiCiAgICAgICAgICApICsKICAgICAgICAgICI+PC9kaXY+IjsKICAgICAgICAvL211dGVTdHIrPSc8ZGl2IGNsYXNzPSJ0aW55UHJvZHVjdEljb24iIGlkPSJtdXRlZFByb2R1Y3QnK21lLmlkKyciIHN0eWxlPSJkaXNwbGF5Om5vbmU7YmFja2dyb3VuZC1wb3NpdGlvbjotJytpY29uWzBdKydweCAtJytpY29uWzFdKydweDsiICcrR2FtZS5jbGlja1N0cisnPSJHYW1lLk9iamVjdHNCeUlkWycrbWUuaWQrJ10ubXV0ZSgwKTtQbGF5U291bmQoR2FtZS5PYmplY3RzQnlJZFsnK21lLmlkKyddLm11dGVkP1wnc25kL2NsaWNrT2ZmMi5tcDNcJzpcJ3NuZC9jbGlja09uMi5tcDNcJyk7IiAnK0dhbWUuZ2V0VG9vbHRpcCgnPGRpdiBzdHlsZT0id2lkdGg6MTUwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Zm9udC1zaXplOjExcHg7Ij48Yj5Vbm11dGUgJyttZS5wbHVyYWwrJzwvYj48YnI+KERpc3BsYXkgdGhpcyBidWlsZGluZyk8L2Rpdj4nKSsnPjwvZGl2Pic7CgogICAgICAgIEFkZEV2ZW50KAogICAgICAgICAgbWUuY2FudmFzLAogICAgICAgICAgIm1vdXNlb3ZlciIsCiAgICAgICAgICAoZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgbWUubW91c2VPbiA9IHRydWU7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9KShtZSkKICAgICAgICApOwogICAgICAgIEFkZEV2ZW50KAogICAgICAgICAgbWUuY2FudmFzLAogICAgICAgICAgIm1vdXNlb3V0IiwKICAgICAgICAgIChmdW5jdGlvbiAobWUpIHsKICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBtZS5tb3VzZU9uID0gZmFsc2U7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9KShtZSkKICAgICAgICApOwogICAgICAgIEFkZEV2ZW50KAogICAgICAgICAgbWUuY2FudmFzLAogICAgICAgICAgIm1vdXNlbW92ZSIsCiAgICAgICAgICAoZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIHZhciBib3ggPSB0aGlzLmdldEJvdW5kcygpOwogICAgICAgICAgICAgIG1lLm1vdXNlUG9zWzBdID0gZS5wYWdlWCAtIGJveC5sZWZ0OwogICAgICAgICAgICAgIG1lLm1vdXNlUG9zWzFdID0gZS5wYWdlWSAtIGJveC50b3A7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9KShtZSkKICAgICAgICApOwogICAgICB9CiAgICB9CiAgICBHYW1lLm11dGVkQnVpbGRpbmdUb29sdGlwID0gZnVuY3Rpb24gKGlkKSB7CiAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5PYmplY3RzQnlJZFtpZF07CiAgICAgICAgcmV0dXJuICgKICAgICAgICAgICc8ZGl2IHN0eWxlPSJ3aWR0aDoxNTBweDt0ZXh0LWFsaWduOmNlbnRlcjtmb250LXNpemU6MTFweDsiIGlkPSJ0b29sdGlwTXV0ZWRCdWlsZGluZyI+JyArCiAgICAgICAgICAoRU4KICAgICAgICAgICAgPyAiPGI+IiArCiAgICAgICAgICAgICAgY2FwKG1lLnBsdXJhbCkgKwogICAgICAgICAgICAgIChtZS5sZXZlbCA+IDAgPyAiIChsdmwuJm5ic3A7IiArIG1lLmxldmVsICsgIikiIDogIiIpICsKICAgICAgICAgICAgICAnPC9iPjxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PkNsaWNrIHRvIHVubXV0ZSAnICsKICAgICAgICAgICAgICBtZS5wbHVyYWwgKwogICAgICAgICAgICAgICI8YnI+KGRpc3BsYXkgdGhpcyBidWlsZGluZykiCiAgICAgICAgICAgIDogIjxiPiIgKwogICAgICAgICAgICAgIGxvYygiTGV2ZWwgJTEgJTIiLCBbQmVhdXRpZnkobWUubGV2ZWwpLCBtZS5wbHVyYWxdKSArCiAgICAgICAgICAgICAgJzwvYj48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICAgICAgICBsb2MoIkNsaWNrIHRvIHVubXV0ZSIpKSArCiAgICAgICAgICAiPC9kaXY+IgogICAgICAgICk7CiAgICAgIH07CiAgICB9OwogICAgbCgiYnVpbGRpbmdzTXV0ZSIpLmlubmVySFRNTCA9IG11dGVTdHI7CgogICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkJVVBHUkFERVMKCQk9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgR2FtZS51cGdyYWRlc1RvUmVidWlsZCA9IDE7CiAgICBHYW1lLlVwZ3JhZGVzID0ge307CiAgICBHYW1lLlVwZ3JhZGVzQnlJZCA9IHt9OwogICAgR2FtZS5VcGdyYWRlc04gPSAwOwogICAgR2FtZS5VcGdyYWRlc0luU3RvcmUgPSBbXTsKICAgIEdhbWUuVXBncmFkZXNPd25lZCA9IDA7CiAgICBHYW1lLlVwZ3JhZGUgPSBmdW5jdGlvbiAobmFtZSwgZGVzYywgcHJpY2UsIGljb24sIGJ1eUZ1bmN0aW9uKSB7CiAgICAgIHRoaXMuaWQgPSBHYW1lLlVwZ3JhZGVzTjsKICAgICAgdGhpcy5uYW1lID0gbmFtZTsKICAgICAgdGhpcy5kbmFtZSA9IHRoaXMubmFtZTsKICAgICAgdGhpcy5kZXNjID0gZGVzYzsKICAgICAgdGhpcy5iYXNlRGVzYyA9IHRoaXMuZGVzYzsKICAgICAgdGhpcy5iYXNlUHJpY2UgPSBwcmljZTsKICAgICAgdGhpcy5wcmljZUx1bXBzID0gMDsgLy9ub3RlIDogZG9lc24ndCBkbyBtdWNoIG9uIGl0cyBvd24sIHlvdSBzdGlsbCBuZWVkIHRvIGhhbmRsZSB0aGUgYnV5aW5nIHlvdXJzZWxmCiAgICAgIHRoaXMuaWNvbiA9IGljb247CiAgICAgIHRoaXMuaWNvbkZ1bmN0aW9uID0gMDsKICAgICAgdGhpcy5idXlGdW5jdGlvbiA9IGJ1eUZ1bmN0aW9uOwogICAgICAvKnRoaXMudW5sb2NrRnVuY3Rpb249dW5sb2NrRnVuY3Rpb247CgkJCXRoaXMudW5sb2NrZWQ9KHRoaXMudW5sb2NrRnVuY3Rpb24/MDoxKTsqLwogICAgICB0aGlzLnVubG9ja2VkID0gMDsKICAgICAgdGhpcy5ib3VnaHQgPSAwOwogICAgICB0aGlzLm9yZGVyID0gdGhpcy5pZDsKICAgICAgaWYgKG9yZGVyKSB0aGlzLm9yZGVyID0gb3JkZXIgKyB0aGlzLmlkICogMC4wMDE7CiAgICAgIHRoaXMucG9vbCA9ICIiOyAvL2NhbiBiZSAnJywgY29va2llLCB0b2dnbGUsIGRlYnVnLCBwcmVzdGlnZSwgcHJlc3RpZ2VEZWNvciwgdGVjaCwgb3IgdW51c2VkCiAgICAgIGlmIChwb29sKSB0aGlzLnBvb2wgPSBwb29sOwogICAgICB0aGlzLnBvd2VyID0gMDsKICAgICAgaWYgKHBvd2VyKSB0aGlzLnBvd2VyID0gcG93ZXI7CiAgICAgIHRoaXMudmFuaWxsYSA9IEdhbWUudmFuaWxsYTsKICAgICAgdGhpcy51bmxvY2tBdCA9IDA7CiAgICAgIHRoaXMudGVjaFVubG9jayA9IFtdOwogICAgICB0aGlzLnBhcmVudHMgPSBbXTsKICAgICAgdGhpcy50eXBlID0gInVwZ3JhZGUiOwogICAgICB0aGlzLnRpZXIgPSAwOwogICAgICB0aGlzLmJ1aWxkaW5nVGllID0gMDsgLy9vZiB3aGF0IGJ1aWxkaW5nIGlzIHRoaXMgYSB0aWVyZWQgdXBncmFkZSBvZiA/CgogICAgICBHYW1lLmxhc3QgPSB0aGlzOwogICAgICBHYW1lLlVwZ3JhZGVzW3RoaXMubmFtZV0gPSB0aGlzOwogICAgICBHYW1lLlVwZ3JhZGVzQnlJZFt0aGlzLmlkXSA9IHRoaXM7CiAgICAgIEdhbWUuVXBncmFkZXNOKys7CiAgICAgIHJldHVybiB0aGlzOwogICAgfTsKICAgIEdhbWUuVXBncmFkZS5wcm90b3R5cGUuZ2V0VHlwZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuICJVcGdyYWRlIjsKICAgIH07CgogICAgR2FtZS5VcGdyYWRlLnByb3RvdHlwZS5nZXRQcmljZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHByaWNlID0gdGhpcy5iYXNlUHJpY2U7CiAgICAgIGlmICh0aGlzLnByaWNlRnVuYykgcHJpY2UgPSB0aGlzLnByaWNlRnVuYyh0aGlzKTsKICAgICAgaWYgKHByaWNlID09IDApIHJldHVybiAwOwogICAgICBpZiAodGhpcy5wb29sICE9ICJwcmVzdGlnZSIpIHsKICAgICAgICBpZiAoR2FtZS5IYXMoIlRveSB3b3Jrc2hvcCIpKSBwcmljZSAqPSAwLjk1OwogICAgICAgIGlmIChHYW1lLkhhcygiRml2ZS1maW5nZXIgZGlzY291bnQiKSkKICAgICAgICAgIHByaWNlICo9IE1hdGgucG93KDAuOTksIEdhbWUuT2JqZWN0c1siQ3Vyc29yIl0uYW1vdW50IC8gMTAwKTsKICAgICAgICBpZiAoR2FtZS5IYXMoIlNhbnRhJ3MgZG9taW5pb24iKSkgcHJpY2UgKj0gMC45ODsKICAgICAgICBpZiAoR2FtZS5IYXMoIkZhYmVyZ2UgZWdnIikpIHByaWNlICo9IDAuOTk7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJEaXZpbmUgc2FsZXMiKSkgcHJpY2UgKj0gMC45OTsKICAgICAgICBpZiAoR2FtZS5IYXMoIkZvcnR1bmUgIzEwMCIpKSBwcmljZSAqPSAwLjk5OwogICAgICAgIGlmICh0aGlzLmtpdHRlbiAmJiBHYW1lLkhhcygiS2l0dGVuIHdhZ2VzIikpIHByaWNlICo9IDAuOTsKICAgICAgICBpZiAoR2FtZS5oYXNCdWZmKCJIYWdnbGVyJ3MgbHVjayIpKSBwcmljZSAqPSAwLjk4OwogICAgICAgIGlmIChHYW1lLmhhc0J1ZmYoIkhhZ2dsZXIncyBtaXNlcnkiKSkgcHJpY2UgKj0gMS4wMjsKICAgICAgICAvL2lmIChHYW1lLmhhc0F1cmEoJ01hc3RlciBvZiB0aGUgQXJtb3J5JykpIHByaWNlKj0wLjk4OwogICAgICAgIHByaWNlICo9IDEgLSBHYW1lLmF1cmFNdWx0KCJNYXN0ZXIgb2YgdGhlIEFybW9yeSIpICogMC4wMjsKICAgICAgICBwcmljZSAqPSBHYW1lLmVmZigidXBncmFkZUNvc3QiKTsKICAgICAgICBpZiAodGhpcy5wb29sID09ICJjb29raWUiICYmIEdhbWUuSGFzKCJEaXZpbmUgYmFrZXJpZXMiKSkgcHJpY2UgLz0gNTsKICAgICAgfQogICAgICByZXR1cm4gTWF0aC5jZWlsKHByaWNlKTsKICAgIH07CgogICAgR2FtZS5VcGdyYWRlLnByb3RvdHlwZS5jYW5CdXkgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICh0aGlzLmNhbkJ1eUZ1bmMpIHJldHVybiB0aGlzLmNhbkJ1eUZ1bmMoKTsKICAgICAgaWYgKEdhbWUuY29va2llcyA+PSB0aGlzLmdldFByaWNlKCkpIHJldHVybiB0cnVlOwogICAgICBlbHNlIHJldHVybiBmYWxzZTsKICAgIH07CgogICAgR2FtZS5zdG9yZUJ1eUFsbCA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCFHYW1lLkhhcygiSW5zcGlyZWQgY2hlY2tsaXN0IikpIHJldHVybiBmYWxzZTsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlVwZ3JhZGVzSW5TdG9yZSkgewogICAgICAgIHZhciBtZSA9IEdhbWUuVXBncmFkZXNJblN0b3JlW2ldOwogICAgICAgIGlmICghbWUuaXNWYXVsdGVkKCkgJiYgbWUucG9vbCAhPSAidG9nZ2xlIiAmJiBtZS5wb29sICE9ICJ0ZWNoIikKICAgICAgICAgIG1lLmJ1eSgxKTsKICAgICAgfQogICAgfTsKCiAgICBHYW1lLnZhdWx0ID0gW107CiAgICBHYW1lLlVwZ3JhZGUucHJvdG90eXBlLmlzVmF1bHRlZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKEdhbWUudmF1bHQuaW5kZXhPZih0aGlzLmlkKSAhPSAtMSkgcmV0dXJuIHRydWU7CiAgICAgIGVsc2UgcmV0dXJuIGZhbHNlOwogICAgfTsKICAgIEdhbWUuVXBncmFkZS5wcm90b3R5cGUudmF1bHQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICghdGhpcy5pc1ZhdWx0ZWQoKSkgR2FtZS52YXVsdC5wdXNoKHRoaXMuaWQpOwogICAgfTsKICAgIEdhbWUuVXBncmFkZS5wcm90b3R5cGUudW52YXVsdCA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKHRoaXMuaXNWYXVsdGVkKCkpIEdhbWUudmF1bHQuc3BsaWNlKEdhbWUudmF1bHQuaW5kZXhPZih0aGlzLmlkKSwgMSk7CiAgICB9OwoKICAgIEdhbWUuVXBncmFkZS5wcm90b3R5cGUuY2xpY2sgPSBmdW5jdGlvbiAoZSkgewogICAgICBpZiAoKGUgJiYgZS5zaGlmdEtleSkgfHwgR2FtZS5rZXlzWzE2XSkgewogICAgICAgIGlmICh0aGlzLnBvb2wgPT0gInRvZ2dsZSIgfHwgdGhpcy5wb29sID09ICJ0ZWNoIikgewogICAgICAgIH0gZWxzZSBpZiAoR2FtZS5IYXMoIkluc3BpcmVkIGNoZWNrbGlzdCIpKSB7CiAgICAgICAgICBpZiAodGhpcy5pc1ZhdWx0ZWQoKSkgdGhpcy51bnZhdWx0KCk7CiAgICAgICAgICBlbHNlIHRoaXMudmF1bHQoKTsKICAgICAgICAgIEdhbWUudXBncmFkZXNUb1JlYnVpbGQgPSAxOwogICAgICAgICAgUGxheVNvdW5kKCJzbmQvdGljay5tcDMiKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB0aGlzLmJ1eSgpOwogICAgfTsKCiAgICBHYW1lLlVwZ3JhZGUucHJvdG90eXBlLmJ1eSA9IGZ1bmN0aW9uIChieXBhc3MpIHsKICAgICAgdmFyIHN1Y2Nlc3MgPSAwOwogICAgICB2YXIgY2FuY2VsUHVyY2hhc2UgPSAwOwogICAgICBpZiAodGhpcy5jbGlja0Z1bmN0aW9uICYmICFieXBhc3MpIGNhbmNlbFB1cmNoYXNlID0gIXRoaXMuY2xpY2tGdW5jdGlvbigpOwogICAgICBpZiAoIWNhbmNlbFB1cmNoYXNlKSB7CiAgICAgICAgaWYgKHRoaXMuY2hvaWNlc0Z1bmN0aW9uKSB7CiAgICAgICAgICBpZiAoR2FtZS5jaG9pY2VTZWxlY3Rvck9uID09IHRoaXMuaWQpIHsKICAgICAgICAgICAgbCgidG9nZ2xlQm94Iikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICAgICAgbCgidG9nZ2xlQm94IikuaW5uZXJIVE1MID0gIiI7CiAgICAgICAgICAgIEdhbWUuY2hvaWNlU2VsZWN0b3JPbiA9IC0xOwogICAgICAgICAgICBQbGF5U291bmQoInNuZC90aWNrT2ZmLm1wMyIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgR2FtZS5jaG9pY2VTZWxlY3Rvck9uID0gdGhpcy5pZDsKICAgICAgICAgICAgdmFyIGNob2ljZXMgPSB0aGlzLmNob2ljZXNGdW5jdGlvbigpOwogICAgICAgICAgICB2YXIgc3RyID0gIiI7CiAgICAgICAgICAgIHN0ciArPQogICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJjbG9zZSIgb25jbGljaz0iR2FtZS5VcGdyYWRlc0J5SWRbJyArCiAgICAgICAgICAgICAgdGhpcy5pZCArCiAgICAgICAgICAgICAgJ10uYnV5KCk7Ij54PC9kaXY+JzsKICAgICAgICAgICAgc3RyICs9ICI8aDM+IiArIHRoaXMuZG5hbWUgKyAiPC9oMz4iICsgJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2Pic7CiAgICAgICAgICAgIGlmICh0eXBlb2YgY2hvaWNlcyA9PT0gInN0cmluZyIpIHsKICAgICAgICAgICAgICBzdHIgKz0gY2hvaWNlczsKICAgICAgICAgICAgfSBlbHNlIGlmIChjaG9pY2VzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWQgPSAwOwogICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gY2hvaWNlcykgewogICAgICAgICAgICAgICAgaWYgKGNob2ljZXNbaV0uc2VsZWN0ZWQpIHNlbGVjdGVkID0gaTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgR2FtZS5jaG9pY2VTZWxlY3RvckNob2ljZXMgPSBjaG9pY2VzOyAvL3RoaXMgaXMgYSByZWFsbHkgZHVtYiB3YXkgb2YgZG9pbmcgdGhpcyBpIGFtIHNvIHNvcnJ5CiAgICAgICAgICAgICAgR2FtZS5jaG9pY2VTZWxlY3RvclNlbGVjdGVkID0gc2VsZWN0ZWQ7CiAgICAgICAgICAgICAgc3RyICs9CiAgICAgICAgICAgICAgICAnPGg0IGlkPSJjaG9pY2VTZWxlY3RlZE5hbWUiPicgKwogICAgICAgICAgICAgICAgY2hvaWNlc1tzZWxlY3RlZF0ubmFtZSArCiAgICAgICAgICAgICAgICAiPC9oND4iICsKICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nOwoKICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIGNob2ljZXMpIHsKICAgICAgICAgICAgICAgIGNob2ljZXNbaV0uaWQgPSBpOwogICAgICAgICAgICAgICAgY2hvaWNlc1tpXS5vcmRlciA9IGNob2ljZXNbaV0ub3JkZXIgfHwgMDsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHZhciBzb3J0TWFwID0gZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICAgICAgICAgIGlmIChhLm9yZGVyID4gYi5vcmRlcikgcmV0dXJuIDE7CiAgICAgICAgICAgICAgICBlbHNlIGlmIChhLm9yZGVyIDwgYi5vcmRlcikgcmV0dXJuIC0xOwogICAgICAgICAgICAgICAgZWxzZSByZXR1cm4gMDsKICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIGNob2ljZXMuc29ydChzb3J0TWFwKTsKCiAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaG9pY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAoIWNob2ljZXNbaV0pIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgdmFyIGljb24gPSBjaG9pY2VzW2ldLmljb247CiAgICAgICAgICAgICAgICB2YXIgaWQgPSBjaG9pY2VzW2ldLmlkOwogICAgICAgICAgICAgICAgaWYgKGNob2ljZXNbaV0uZGl2KSBzdHIgKz0gJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2Pic7CiAgICAgICAgICAgICAgICBzdHIgKz0KICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImNyYXRlIG5vRnJhbWUgZW5hYmxlZCcgKwogICAgICAgICAgICAgICAgICAoaWQgPT0gc2VsZWN0ZWQgPyAiIGhpZ2hsaWdodGVkIiA6ICIiKSArCiAgICAgICAgICAgICAgICAgICciIHN0eWxlPSJvcGFjaXR5OjE7ZmxvYXQ6bm9uZTtkaXNwbGF5OmlubGluZS1ibG9jazsnICsKICAgICAgICAgICAgICAgICAgd3JpdGVJY29uKGljb24pICsKICAgICAgICAgICAgICAgICAgJyIgJyArCiAgICAgICAgICAgICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICAgICAgICAgICAnPSJHYW1lLlVwZ3JhZGVzQnlJZFsnICsKICAgICAgICAgICAgICAgICAgdGhpcy5pZCArCiAgICAgICAgICAgICAgICAgICJdLmNob2ljZXNQaWNrKCIgKwogICAgICAgICAgICAgICAgICBpZCArCiAgICAgICAgICAgICAgICAgICIpO0dhbWUuY2hvaWNlU2VsZWN0b3JPbj0tMTtHYW1lLlVwZ3JhZGVzQnlJZFsiICsKICAgICAgICAgICAgICAgICAgdGhpcy5pZCArCiAgICAgICAgICAgICAgICAgICJdLmJ1eSgpO1wiIG9uTW91c2VPdXQ9XCJsKCdjaG9pY2VTZWxlY3RlZE5hbWUnKS5pbm5lckhUTUw9R2FtZS5jaG9pY2VTZWxlY3RvckNob2ljZXNbR2FtZS5jaG9pY2VTZWxlY3RvclNlbGVjdGVkXS5uYW1lO1wiIG9uTW91c2VPdmVyPVwibCgnY2hvaWNlU2VsZWN0ZWROYW1lJykuaW5uZXJIVE1MPUdhbWUuY2hvaWNlU2VsZWN0b3JDaG9pY2VzWyIgKwogICAgICAgICAgICAgICAgICBpICsKICAgICAgICAgICAgICAgICAgJ10ubmFtZTsiJyArCiAgICAgICAgICAgICAgICAgICI+PC9kaXY+IjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbCgidG9nZ2xlQm94IikuaW5uZXJIVE1MID0gc3RyOwogICAgICAgICAgICBsKCJ0b2dnbGVCb3giKS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICAgICAgbCgidG9nZ2xlQm94IikuZm9jdXMoKTsKICAgICAgICAgICAgR2FtZS50b29sdGlwLmhpZGUoKTsKICAgICAgICAgICAgUGxheVNvdW5kKCJzbmQvdGljay5tcDMiKTsKICAgICAgICAgICAgc3VjY2VzcyA9IDE7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnBvb2wgIT0gInByZXN0aWdlIikgewogICAgICAgICAgdmFyIHByaWNlID0gdGhpcy5nZXRQcmljZSgpOwogICAgICAgICAgaWYgKHRoaXMuY2FuQnV5KCkgJiYgIXRoaXMuYm91Z2h0KSB7CiAgICAgICAgICAgIEdhbWUuU3BlbmQocHJpY2UpOwogICAgICAgICAgICB0aGlzLmJvdWdodCA9IDE7CiAgICAgICAgICAgIGlmICh0aGlzLmJ1eUZ1bmN0aW9uKSB0aGlzLmJ1eUZ1bmN0aW9uKCk7CiAgICAgICAgICAgIGlmICh0aGlzLnRvZ2dsZUludG8pIHsKICAgICAgICAgICAgICBHYW1lLkxvY2sodGhpcy50b2dnbGVJbnRvKTsKICAgICAgICAgICAgICBHYW1lLlVubG9jayh0aGlzLnRvZ2dsZUludG8pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIEdhbWUudXBncmFkZXNUb1JlYnVpbGQgPSAxOwogICAgICAgICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICAgICAgICBpZiAoR2FtZS5Db3VudHNBc1VwZ3JhZGVPd25lZCh0aGlzLnBvb2wpKSBHYW1lLlVwZ3JhZGVzT3duZWQrKzsKICAgICAgICAgICAgR2FtZS5zZXRPbkNyYXRlKDApOwogICAgICAgICAgICBHYW1lLnRvb2x0aXAuaGlkZSgpOwogICAgICAgICAgICBQbGF5U291bmQoInNuZC9idXkiICsgY2hvb3NlKFsxLCAyLCAzLCA0XSkgKyAiLm1wMyIsIDAuNzUpOwogICAgICAgICAgICBzdWNjZXNzID0gMTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIHByaWNlID0gdGhpcy5nZXRQcmljZSgpOwogICAgICAgICAgaWYgKEdhbWUuaGVhdmVubHlDaGlwcyA+PSBwcmljZSAmJiAhdGhpcy5ib3VnaHQpIHsKICAgICAgICAgICAgR2FtZS5oZWF2ZW5seUNoaXBzIC09IHByaWNlOwogICAgICAgICAgICBHYW1lLmhlYXZlbmx5Q2hpcHNTcGVudCArPSBwcmljZTsKICAgICAgICAgICAgdGhpcy51bmxvY2tlZCA9IDE7CiAgICAgICAgICAgIHRoaXMuYm91Z2h0ID0gMTsKICAgICAgICAgICAgaWYgKHRoaXMuYnV5RnVuY3Rpb24pIHRoaXMuYnV5RnVuY3Rpb24oKTsKICAgICAgICAgICAgR2FtZS5CdWlsZEFzY2VuZFRyZWUodGhpcyk7CiAgICAgICAgICAgIFBsYXlTb3VuZCgic25kL2J1eSIgKyBjaG9vc2UoWzEsIDIsIDMsIDRdKSArICIubXAzIiwgMC43NSk7CiAgICAgICAgICAgIFBsYXlTb3VuZCgic25kL3NoaW1tZXJDbGljay5tcDMiKTsKICAgICAgICAgICAgLy9QbGF5U291bmQoJ3NuZC9idXlIZWF2ZW5seS5tcDMnKTsKICAgICAgICAgICAgc3VjY2VzcyA9IDE7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICh0aGlzLmJvdWdodCAmJiB0aGlzLmFjdGl2YXRlRnVuY3Rpb24pIHRoaXMuYWN0aXZhdGVGdW5jdGlvbigpOwogICAgICByZXR1cm4gc3VjY2VzczsKICAgIH07CiAgICBHYW1lLlVwZ3JhZGUucHJvdG90eXBlLmVhcm4gPQogICAgICBmdW5jdGlvbiAoKSAvL2p1c3Qgd2luIHRoZSB1cGdyYWRlcyB3aXRob3V0IHNwZW5kaW5nIGFueXRoaW5nCiAgICAgIHsKICAgICAgICB0aGlzLnVubG9ja2VkID0gMTsKICAgICAgICB0aGlzLmJvdWdodCA9IDE7CiAgICAgICAgaWYgKHRoaXMuYnV5RnVuY3Rpb24pIHRoaXMuYnV5RnVuY3Rpb24oKTsKICAgICAgICBHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkID0gMTsKICAgICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICAgIGlmIChHYW1lLkNvdW50c0FzVXBncmFkZU93bmVkKHRoaXMucG9vbCkpIEdhbWUuVXBncmFkZXNPd25lZCsrOwogICAgICB9OwogICAgR2FtZS5VcGdyYWRlLnByb3RvdHlwZS51bmVhcm4gPQogICAgICBmdW5jdGlvbiAoKSAvL3JlbW92ZSB0aGUgdXBncmFkZSwgYnV0IGtlZXAgaXQgdW5sb2NrZWQKICAgICAgewogICAgICAgIHRoaXMuYm91Z2h0ID0gMDsKICAgICAgICBHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkID0gMTsKICAgICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICAgIGlmIChHYW1lLkNvdW50c0FzVXBncmFkZU93bmVkKHRoaXMucG9vbCkpIEdhbWUuVXBncmFkZXNPd25lZC0tOwogICAgICB9OwogICAgR2FtZS5VcGdyYWRlLnByb3RvdHlwZS51bmxvY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMudW5sb2NrZWQgPSAxOwogICAgICBHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkID0gMTsKICAgIH07CiAgICBHYW1lLlVwZ3JhZGUucHJvdG90eXBlLmxvc2UgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMudW5sb2NrZWQgPSAwOwogICAgICB0aGlzLmJvdWdodCA9IDA7CiAgICAgIEdhbWUudXBncmFkZXNUb1JlYnVpbGQgPSAxOwogICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICBpZiAoR2FtZS5Db3VudHNBc1VwZ3JhZGVPd25lZCh0aGlzLnBvb2wpKSBHYW1lLlVwZ3JhZGVzT3duZWQtLTsKICAgIH07CiAgICBHYW1lLlVwZ3JhZGUucHJvdG90eXBlLnRvZ2dsZSA9IGZ1bmN0aW9uICgpIC8vY2hlYXRpbmcgb25seQogICAgewogICAgICBpZiAoIXRoaXMuYm91Z2h0KSB7CiAgICAgICAgdGhpcy5ib3VnaHQgPSAxOwogICAgICAgIGlmICh0aGlzLmJ1eUZ1bmN0aW9uKSB0aGlzLmJ1eUZ1bmN0aW9uKCk7CiAgICAgICAgR2FtZS51cGdyYWRlc1RvUmVidWlsZCA9IDE7CiAgICAgICAgR2FtZS5yZWNhbGN1bGF0ZUdhaW5zID0gMTsKICAgICAgICBpZiAoR2FtZS5Db3VudHNBc1VwZ3JhZGVPd25lZCh0aGlzLnBvb2wpKSBHYW1lLlVwZ3JhZGVzT3duZWQrKzsKICAgICAgICBQbGF5U291bmQoInNuZC9idXkiICsgY2hvb3NlKFsxLCAyLCAzLCA0XSkgKyAiLm1wMyIsIDAuNzUpOwogICAgICAgIGlmICh0aGlzLnBvb2wgPT0gInByZXN0aWdlIiB8fCB0aGlzLnBvb2wgPT0gImRlYnVnIikKICAgICAgICAgIFBsYXlTb3VuZCgic25kL3NoaW1tZXJDbGljay5tcDMiKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmJvdWdodCA9IDA7CiAgICAgICAgR2FtZS51cGdyYWRlc1RvUmVidWlsZCA9IDE7CiAgICAgICAgR2FtZS5yZWNhbGN1bGF0ZUdhaW5zID0gMTsKICAgICAgICBpZiAoR2FtZS5Db3VudHNBc1VwZ3JhZGVPd25lZCh0aGlzLnBvb2wpKSBHYW1lLlVwZ3JhZGVzT3duZWQtLTsKICAgICAgICBQbGF5U291bmQoInNuZC9zZWxsIiArIGNob29zZShbMSwgMiwgMywgNF0pICsgIi5tcDMiLCAwLjc1KTsKICAgICAgICBpZiAodGhpcy5wb29sID09ICJwcmVzdGlnZSIgfHwgdGhpcy5wb29sID09ICJkZWJ1ZyIpCiAgICAgICAgICBQbGF5U291bmQoInNuZC9zaGltbWVyQ2xpY2subXAzIik7CiAgICAgIH0KICAgICAgaWYgKEdhbWUub25NZW51ID09ICJzdGF0cyIpIEdhbWUuVXBkYXRlTWVudSgpOwogICAgfTsKCiAgICBHYW1lLkNvdW50c0FzVXBncmFkZU93bmVkID0gZnVuY3Rpb24gKHBvb2wpIHsKICAgICAgaWYgKHBvb2wgPT0gIiIgfHwgcG9vbCA9PSAiY29va2llIiB8fCBwb29sID09ICJ0ZWNoIikgcmV0dXJuIHRydWU7CiAgICAgIGVsc2UgcmV0dXJuIGZhbHNlOwogICAgfTsKCiAgICAvKkFkZEV2ZW50KGwoJ3RvZ2dsZUJveCcpLCdibHVyJyxmdW5jdGlvbigpLy9pZiB3ZSBjbGljayBvdXRzaWRlIG9mIHRoZSBzZWxlY3RvciwgY2xvc2UgaXQKCQkJewoJCQkJLy90aGlzIGhhcyBhIGNvdXBsZSBwcm9ibGVtcywgc3VjaCBhcyB3aGVuIGNsaWNraW5nIG9uIHRoZSB1cGdyYWRlIC0gdGhpcyB0b2dnbGVzIGl0IG9mZiBhbmQgYmFjayBvbiBpbnN0YW50bHkKCQkJCWwoJ3RvZ2dsZUJveCcpLnN0eWxlLmRpc3BsYXk9J25vbmUnOwoJCQkJbCgndG9nZ2xlQm94JykuaW5uZXJIVE1MPScnOwoJCQkJR2FtZS5jaG9pY2VTZWxlY3Rvck9uPS0xOwoJCQl9CgkJKTsqLwoKICAgIEdhbWUuUmVxdWlyZXNDb25maXJtYXRpb24gPSBmdW5jdGlvbiAodXBncmFkZSwgcHJvbXB0KSB7CiAgICAgIHVwZ3JhZGUuY2xpY2tGdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLlByb21wdCgiPGlkIFJlcXVpcmVzQ29uZmlybWF0aW9uPiIgKyBwcm9tcHQsIFsKICAgICAgICAgIFsKICAgICAgICAgICAgbG9jKCJZZXMiKSwKICAgICAgICAgICAgIkdhbWUuVXBncmFkZXNCeUlkWyIgKyB1cGdyYWRlLmlkICsgIl0uYnV5KDEpO0dhbWUuQ2xvc2VQcm9tcHQoKTsiLAogICAgICAgICAgXSwKICAgICAgICAgIGxvYygiTm8iKSwKICAgICAgICBdKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH07CiAgICB9OwoKICAgIEdhbWUuVW5sb2NrID0gZnVuY3Rpb24gKHdoYXQpIHsKICAgICAgaWYgKHR5cGVvZiB3aGF0ID09PSAic3RyaW5nIikgewogICAgICAgIGlmIChHYW1lLlVwZ3JhZGVzW3doYXRdKSB7CiAgICAgICAgICBpZiAoR2FtZS5VcGdyYWRlc1t3aGF0XS51bmxvY2tlZCA9PSAwKSB7CiAgICAgICAgICAgIEdhbWUuVXBncmFkZXNbd2hhdF0udW5sb2NrZWQgPSAxOwogICAgICAgICAgICBHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkID0gMTsKICAgICAgICAgICAgR2FtZS5yZWNhbGN1bGF0ZUdhaW5zID0gMTsKICAgICAgICAgICAgLypHYW1lLk5vdGlmeSgnVXBncmFkZSB1bmxvY2tlZCcsJzxkaXYgY2xhc3M9InRpdGxlIiBzdHlsZT0iZm9udC1zaXplOjE4cHg7bWFyZ2luLXRvcDotMnB4OyI+JytHYW1lLlVwZ3JhZGVzW3doYXRdLmRuYW1lKyc8L2Rpdj4nLEdhbWUuVXBncmFkZXNbd2hhdF0uaWNvbiw2KTsqLwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKHZhciBpIGluIHdoYXQpIHsKICAgICAgICAgIEdhbWUuVW5sb2NrKHdoYXRbaV0pOwogICAgICAgIH0KICAgICAgfQogICAgfTsKICAgIEdhbWUuTG9jayA9IGZ1bmN0aW9uICh3aGF0KSB7CiAgICAgIGlmICh0eXBlb2Ygd2hhdCA9PT0gInN0cmluZyIpIHsKICAgICAgICBpZiAoR2FtZS5VcGdyYWRlc1t3aGF0XSkgewogICAgICAgICAgR2FtZS5VcGdyYWRlc1t3aGF0XS51bmxvY2tlZCA9IDA7CiAgICAgICAgICBHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkID0gMTsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgR2FtZS5VcGdyYWRlc1t3aGF0XS5ib3VnaHQgPT0gMSAmJgogICAgICAgICAgICBHYW1lLkNvdW50c0FzVXBncmFkZU93bmVkKEdhbWUuVXBncmFkZXNbd2hhdF0ucG9vbCkKICAgICAgICAgICkKICAgICAgICAgICAgR2FtZS5VcGdyYWRlc093bmVkLS07CiAgICAgICAgICBHYW1lLlVwZ3JhZGVzW3doYXRdLmJvdWdodCA9IDA7CiAgICAgICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKHZhciBpIGluIHdoYXQpIHsKICAgICAgICAgIEdhbWUuTG9jayh3aGF0W2ldKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgR2FtZS5IYXMgPSBmdW5jdGlvbiAod2hhdCkgewogICAgICB2YXIgaXQgPSBHYW1lLlVwZ3JhZGVzW3doYXRdOwogICAgICBpZiAoCiAgICAgICAgaXQgJiYKICAgICAgICBHYW1lLmFzY2Vuc2lvbk1vZGUgPT0gMSAmJgogICAgICAgIChpdC5wb29sID09ICJwcmVzdGlnZSIgfHwgaXQudGllciA9PSAiZm9ydHVuZSIpCiAgICAgICkKICAgICAgICByZXR1cm4gMDsKICAgICAgcmV0dXJuIGl0ID8gaXQuYm91Z2h0IDogMDsKICAgIH07CiAgICBHYW1lLkhhc1VubG9ja2VkID0gZnVuY3Rpb24gKHdoYXQpIHsKICAgICAgcmV0dXJuIEdhbWUuVXBncmFkZXNbd2hhdF0gPyBHYW1lLlVwZ3JhZGVzW3doYXRdLnVubG9ja2VkIDogMDsKICAgIH07CgogICAgR2FtZS5SZWJ1aWxkVXBncmFkZXMgPSBmdW5jdGlvbiAoKSAvL3JlY2FsY3VsYXRlIHRoZSB1cGdyYWRlcyB5b3UgY2FuIGJ1eQogICAgewogICAgICBHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkID0gMDsKICAgICAgdmFyIGxpc3QgPSBbXTsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlVwZ3JhZGVzKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5VcGdyYWRlc1tpXTsKICAgICAgICBpZiAoCiAgICAgICAgICAhbWUuYm91Z2h0ICYmCiAgICAgICAgICBtZS5wb29sICE9ICJkZWJ1ZyIgJiYKICAgICAgICAgIG1lLnBvb2wgIT0gInByZXN0aWdlIiAmJgogICAgICAgICAgbWUucG9vbCAhPSAicHJlc3RpZ2VEZWNvciIgJiYKICAgICAgICAgIChHYW1lLmFzY2Vuc2lvbk1vZGUgIT0gMSB8fCAoIW1lLmxhc3RpbmcgJiYgbWUudGllciAhPSAiZm9ydHVuZSIpKQogICAgICAgICkgewogICAgICAgICAgaWYgKG1lLnVubG9ja2VkKSBsaXN0LnB1c2gobWUpOwogICAgICAgIH0gZWxzZSBpZiAobWUuZGlzcGxheUZ1bmNXaGVuT3duZWQgJiYgbWUuYm91Z2h0KSBsaXN0LnB1c2gobWUpOwogICAgICB9CiAgICAgIHZhciBzb3J0TWFwID0gZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICB2YXIgYXAgPSBhLnBvb2wgPT0gInRvZ2dsZSIgPyBhLm9yZGVyIDogYS5nZXRQcmljZSgpOwogICAgICAgIHZhciBicCA9IGIucG9vbCA9PSAidG9nZ2xlIiA/IGIub3JkZXIgOiBiLmdldFByaWNlKCk7CiAgICAgICAgaWYgKGFwID4gYnApIHJldHVybiAxOwogICAgICAgIGVsc2UgaWYgKGFwIDwgYnApIHJldHVybiAtMTsKICAgICAgICBlbHNlIHJldHVybiAwOwogICAgICB9OwogICAgICBsaXN0LnNvcnQoc29ydE1hcCk7CgogICAgICBHYW1lLlVwZ3JhZGVzSW5TdG9yZSA9IFtdOwogICAgICBmb3IgKHZhciBpIGluIGxpc3QpIHsKICAgICAgICBHYW1lLlVwZ3JhZGVzSW5TdG9yZS5wdXNoKGxpc3RbaV0pOwogICAgICB9CiAgICAgIHZhciBzdG9yZVN0ciA9ICIiOwogICAgICB2YXIgdG9nZ2xlU3RyID0gIiI7CiAgICAgIHZhciB0ZWNoU3RyID0gIiI7CiAgICAgIHZhciB2YXVsdFN0ciA9ICIiOwoKICAgICAgaWYgKEdhbWUuSGFzKCJJbnNwaXJlZCBjaGVja2xpc3QiKSkgewogICAgICAgIHN0b3JlU3RyICs9CiAgICAgICAgICAnPGRpdiBpZD0ic3RvcmVCdXlBbGwiIGNsYXNzPSJzdG9yZVByZSIgJyArCiAgICAgICAgICBHYW1lLmdldFRvb2x0aXAoCiAgICAgICAgICAgICc8ZGl2IHN0eWxlPSJwYWRkaW5nOjhweDttaW4td2lkdGg6MjUwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Zm9udC1zaXplOjExcHg7IiBpZD0idG9vbHRpcFN0b3JlUHJlIj4nICsKICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAiV2lsbCA8Yj5pbnN0YW50bHkgcHVyY2hhc2U8L2I+IGV2ZXJ5IHVwZ3JhZGUgeW91IGNhbiBhZmZvcmQsIHN0YXJ0aW5nIGZyb20gdGhlIGNoZWFwZXN0IG9uZS48YnI+VXBncmFkZXMgaW4gdGhlIDxiPnZhdWx0PC9iPiB3aWxsIG5vdCBiZSBhdXRvLXB1cmNoYXNlZC48YnI+WW91IG1heSBwbGFjZSBhbiB1cGdyYWRlIGludG8gdGhlIHZhdWx0IGJ5IDxiPlNoaWZ0LWNsaWNraW5nPC9iPiBvbiBpdC4iCiAgICAgICAgICAgICAgKSArCiAgICAgICAgICAgICAgIjwvZGl2PiIsCiAgICAgICAgICAgICJzdG9yZSIKICAgICAgICAgICkgKwogICAgICAgICAgIj4iICsKICAgICAgICAgICc8ZGl2IGlkPSJzdG9yZUJ1eUFsbEJ1dHRvbiIgY2xhc3M9InN0b3JlUHJlQnV0dG9uIiAnICsKICAgICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICAgJz0iR2FtZS5zdG9yZUJ1eUFsbCgpOyI+JyArCiAgICAgICAgICBsb2MoIkJ1eSBhbGwgdXBncmFkZXMiKSArCiAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAiPC9kaXY+IjsKICAgICAgICBsKCJ1cGdyYWRlcyIpLmNsYXNzTGlzdC5hZGQoImhhc01lbnUiKTsKICAgICAgfSBlbHNlIGwoInVwZ3JhZGVzIikuY2xhc3NMaXN0LnJlbW92ZSgiaGFzTWVudSIpOwoKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlVwZ3JhZGVzSW5TdG9yZSkgewogICAgICAgIC8vaWYgKCFHYW1lLlVwZ3JhZGVzSW5TdG9yZVtpXSkgYnJlYWs7CiAgICAgICAgdmFyIG1lID0gR2FtZS5VcGdyYWRlc0luU3RvcmVbaV07CiAgICAgICAgdmFyIHN0ciA9IEdhbWUuY3JhdGUoCiAgICAgICAgICBtZSwKICAgICAgICAgICJzdG9yZSIsCiAgICAgICAgICAiR2FtZS5VcGdyYWRlc0J5SWRbIiArIG1lLmlkICsgIl0uY2xpY2soZXZlbnQpOyIsCiAgICAgICAgICAidXBncmFkZSIgKyBpCiAgICAgICAgKTsKCiAgICAgICAgLyp2YXIgc3RyPSc8ZGl2IGNsYXNzPSJjcmF0ZSB1cGdyYWRlIiAnK0dhbWUuZ2V0VG9vbHRpcCgKCQkJCSc8ZGl2IHN0eWxlPSJtaW4td2lkdGg6MjAwcHg7Ij48ZGl2IHN0eWxlPSJmbG9hdDpyaWdodDsiPjxzcGFuIGNsYXNzPSJwcmljZSI+JytCZWF1dGlmeShNYXRoLnJvdW5kKG1lLmdldFByaWNlKCkpKSsnPC9zcGFuPjwvZGl2PjxzbWFsbD4nKyhtZS5wb29sPT0ndG9nZ2xlJz8nW1RvZ2dsYWJsZV0nOidbVXBncmFkZV0nKSsnPC9zbWFsbD48ZGl2IGNsYXNzPSJuYW1lIj4nK21lLmRuYW1lKyc8L2Rpdj48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj48ZGl2IGNsYXNzPSJkZXNjcmlwdGlvbiI+JyttZS5kZXNjKyc8L2Rpdj48L2Rpdj4nCgkJCQksJ3N0b3JlJykrJyAnK0dhbWUuY2xpY2tTdHIrJz0iR2FtZS5VcGdyYWRlc0J5SWRbJyttZS5pZCsnXS5idXkoKTsiIGlkPSJ1cGdyYWRlJytpKyciIHN0eWxlPSInK3dyaXRlSWNvbihtZS5pY29uKSsnIj48L2Rpdj4nOyovCiAgICAgICAgaWYgKG1lLnBvb2wgPT0gInRvZ2dsZSIpIHRvZ2dsZVN0ciArPSBzdHI7CiAgICAgICAgZWxzZSBpZiAobWUucG9vbCA9PSAidGVjaCIpIHRlY2hTdHIgKz0gc3RyOwogICAgICAgIGVsc2UgewogICAgICAgICAgaWYgKG1lLmlzVmF1bHRlZCgpICYmIEdhbWUuSGFzKCJJbnNwaXJlZCBjaGVja2xpc3QiKSkgdmF1bHRTdHIgKz0gc3RyOwogICAgICAgICAgZWxzZSBzdG9yZVN0ciArPSBzdHI7CiAgICAgICAgfQogICAgICB9CgogICAgICBsKCJ1cGdyYWRlcyIpLmlubmVySFRNTCA9IHN0b3JlU3RyOwogICAgICBsKCJ0b2dnbGVVcGdyYWRlcyIpLmlubmVySFRNTCA9IHRvZ2dsZVN0cjsKICAgICAgaWYgKHRvZ2dsZVN0ciA9PSAiIikgbCgidG9nZ2xlVXBncmFkZXMiKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICBlbHNlIGwoInRvZ2dsZVVwZ3JhZGVzIikuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgIGwoInRlY2hVcGdyYWRlcyIpLmlubmVySFRNTCA9IHRlY2hTdHI7CiAgICAgIGlmICh0ZWNoU3RyID09ICIiKSBsKCJ0ZWNoVXBncmFkZXMiKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICBlbHNlIGwoInRlY2hVcGdyYWRlcyIpLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICBsKCJ2YXVsdFVwZ3JhZGVzIikuaW5uZXJIVE1MID0gdmF1bHRTdHI7CiAgICAgIGlmICh2YXVsdFN0ciA9PSAiIikgbCgidmF1bHRVcGdyYWRlcyIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgIGVsc2UgbCgidmF1bHRVcGdyYWRlcyIpLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgfTsKCiAgICBHYW1lLlVubG9ja0F0ID0gW107IC8vdGhpcyBjb250YWlucyBhbiBhcnJheSBvZiBldmVyeSB1cGdyYWRlIHdpdGggYSBjb29raWUgcmVxdWlyZW1lbnQgaW4gdGhlIGZvcm0gb2Yge2Nvb2tpZXM6KGFtb3VudCBvZiBjb29raWVzIGVhcm5lZCByZXF1aXJlZCksbmFtZToobmFtZSBvZiB1cGdyYWRlIG9yIGFjaGlldmVtZW50IHRvIHVubG9jayl9IChhbmQgcG9zc2libHkgcmVxdWlyZToobmFtZSBvZiB1cGdyYWRlIG9mIGFjaGlldmVtZW50IHRvIG93bikpCiAgICAvL25vdGUgOiB0aGUgY29va2llIHdpbGwgbm90IGJlIGFkZGVkIHRvIHRoZSBsaXN0IGlmIGl0IGNvbnRhaW5zIGxvY2tlZDoxICh1c2UgZm9yIHNlYXNvbmFsIGNvb2tpZXMgYW5kIHN1Y2gpCgogICAgdmFyIHN0ckNvb2tpZVByb2R1Y3Rpb25NdWx0aXBsaWVyUGx1cyA9IGxvYygKICAgICAgIkNvb2tpZSBwcm9kdWN0aW9uIG11bHRpcGxpZXIgPGI+KyUxJTwvYj4uIiwKICAgICAgIlt4XSIKICAgICk7CiAgICB2YXIgZ2V0U3RyQ29va2llUHJvZHVjdGlvbk11bHRpcGxpZXJQbHVzID0gZnVuY3Rpb24gKHgpIHsKICAgICAgcmV0dXJuIHN0ckNvb2tpZVByb2R1Y3Rpb25NdWx0aXBsaWVyUGx1cy5yZXBsYWNlKCJbeF0iLCB4KTsKICAgIH07CiAgICB2YXIgZ2V0U3RyVGhvdXNhbmRGaW5nZXJzR2FpbiA9IGZ1bmN0aW9uICh4KSB7CiAgICAgIHJldHVybiBsb2MoIk11bHRpcGxpZXMgdGhlIGdhaW4gZnJvbSAlMSBieSA8Yj4lMjwvYj4uIiwgWwogICAgICAgIGdldFVwZ3JhZGVOYW1lKCJUaG91c2FuZCBmaW5nZXJzIiksCiAgICAgICAgeCwKICAgICAgXSk7CiAgICB9OwogICAgdmFyIHN0cktpdHRlbkRlc2MgPSBsb2MoIllvdSBnYWluIDxiPm1vcmUgQ3BTPC9iPiB0aGUgbW9yZSBtaWxrIHlvdSBoYXZlLiIpOwogICAgdmFyIGdldFN0ckNsaWNraW5nR2FpbnMgPSBmdW5jdGlvbiAoeCkgewogICAgICByZXR1cm4gbG9jKCJDbGlja2luZyBnYWlucyA8Yj4rJTElIG9mIHlvdXIgQ3BTPC9iPi4iLCB4KTsKICAgIH07CgogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llID0gZnVuY3Rpb24gKG9iaikgewogICAgICB2YXIgdXBncmFkZSA9IG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICAgb2JqLm5hbWUsCiAgICAgICAgZ2V0U3RyQ29va2llUHJvZHVjdGlvbk11bHRpcGxpZXJQbHVzKAogICAgICAgICAgQmVhdXRpZnkoCiAgICAgICAgICAgIHR5cGVvZiBvYmoucG93ZXIgPT09ICJmdW5jdGlvbiIgPyBvYmoucG93ZXIob2JqKSA6IG9iai5wb3dlciwKICAgICAgICAgICAgMQogICAgICAgICAgKQogICAgICAgICkgKyAoRU4gPyAiPHE+IiArIG9iai5kZXNjICsgIjwvcT4iIDogIiIpLAogICAgICAgIG9iai5wcmljZSwKICAgICAgICBvYmouaWNvbgogICAgICApOwogICAgICB1cGdyYWRlLnBvd2VyID0gb2JqLnBvd2VyOwogICAgICB1cGdyYWRlLnBvb2wgPSAiY29va2llIjsKICAgICAgdmFyIHRvUHVzaCA9IHsgY29va2llczogb2JqLnByaWNlIC8gMjAsIG5hbWU6IG9iai5uYW1lIH07CiAgICAgIGlmIChvYmoucmVxdWlyZSkgdG9QdXNoLnJlcXVpcmUgPSBvYmoucmVxdWlyZTsKICAgICAgaWYgKG9iai5zZWFzb24pIHRvUHVzaC5zZWFzb24gPSBvYmouc2Vhc29uOwogICAgICBpZiAoIW9iai5sb2NrZWQpIEdhbWUuVW5sb2NrQXQucHVzaCh0b1B1c2gpOwogICAgICByZXR1cm4gdXBncmFkZTsKICAgIH07CgogICAgLy90aWVyZWQgdXBncmFkZXMgc3lzdGVtCiAgICAvL2VhY2ggYnVpbGRpbmcgaGFzIHNldmVyYWwgdXBncmFkZSB0aWVycwogICAgLy9hbGwgdXBncmFkZXMgaW4gdGhlIHNhbWUgdGllciBoYXZlIHRoZSBzYW1lIGNvbG9yLCB1bmxvY2sgdGhyZXNob2xkIGFuZCBwcmljZSBtdWx0aXBsaWVyCiAgICBHYW1lLlRpZXJzID0gewogICAgICAxOiB7CiAgICAgICAgbmFtZTogIlBsYWluIiwKICAgICAgICB1bmxvY2s6IDEsCiAgICAgICAgYWNoaWV2VW5sb2NrOiAxLAogICAgICAgIGljb25Sb3c6IDAsCiAgICAgICAgY29sb3I6ICIjY2NiM2FjIiwKICAgICAgICBwcmljZTogMTAsCiAgICAgIH0sCiAgICAgIDI6IHsKICAgICAgICBuYW1lOiAiQmVycnlsaXVtIiwKICAgICAgICB1bmxvY2s6IDUsCiAgICAgICAgYWNoaWV2VW5sb2NrOiA1MCwKICAgICAgICBpY29uUm93OiAxLAogICAgICAgIGNvbG9yOiAiI2ZmODllNyIsCiAgICAgICAgcHJpY2U6IDUwLAogICAgICB9LAogICAgICAzOiB7CiAgICAgICAgbmFtZTogIkJsdWViZXJyeWxpdW0iLAogICAgICAgIHVubG9jazogMjUsCiAgICAgICAgYWNoaWV2VW5sb2NrOiAxMDAsCiAgICAgICAgaWNvblJvdzogMiwKICAgICAgICBjb2xvcjogIiMwMGRlZmYiLAogICAgICAgIHByaWNlOiA1MDAsCiAgICAgIH0sCiAgICAgIDQ6IHsKICAgICAgICBuYW1lOiAiQ2hhbGNlZGhvbmV5IiwKICAgICAgICB1bmxvY2s6IDUwLAogICAgICAgIGFjaGlldlVubG9jazogMTUwLAogICAgICAgIGljb25Sb3c6IDEzLAogICAgICAgIGNvbG9yOiAiI2ZmY2MyZiIsCiAgICAgICAgcHJpY2U6IDUwMDAwLAogICAgICB9LAogICAgICA1OiB7CiAgICAgICAgbmFtZTogIkJ1dHRlcmdvbGQiLAogICAgICAgIHVubG9jazogMTAwLAogICAgICAgIGFjaGlldlVubG9jazogMjAwLAogICAgICAgIGljb25Sb3c6IDE0LAogICAgICAgIGNvbG9yOiAiI2U5ZDY3MyIsCiAgICAgICAgcHJpY2U6IDUwMDAwMDAsCiAgICAgIH0sCiAgICAgIDY6IHsKICAgICAgICBuYW1lOiAiU3VnYXJtdWNrIiwKICAgICAgICB1bmxvY2s6IDE1MCwKICAgICAgICBhY2hpZXZVbmxvY2s6IDI1MCwKICAgICAgICBpY29uUm93OiAxNSwKICAgICAgICBjb2xvcjogIiNhOGJmOTEiLAogICAgICAgIHByaWNlOiA1MDAwMDAwMDAsCiAgICAgIH0sCiAgICAgIDc6IHsKICAgICAgICBuYW1lOiAiSmV0bWludCIsCiAgICAgICAgdW5sb2NrOiAyMDAsCiAgICAgICAgYWNoaWV2VW5sb2NrOiAzMDAsCiAgICAgICAgaWNvblJvdzogMTYsCiAgICAgICAgY29sb3I6ICIjNjBmZjUwIiwKICAgICAgICBwcmljZTogNTAwMDAwMDAwMDAwLAogICAgICB9LAogICAgICA4OiB7CiAgICAgICAgbmFtZTogIkNoZXJyeXNpbHZlciIsCiAgICAgICAgdW5sb2NrOiAyNTAsCiAgICAgICAgYWNoaWV2VW5sb2NrOiAzNTAsCiAgICAgICAgaWNvblJvdzogMTcsCiAgICAgICAgY29sb3I6ICIjZjAxNzAwIiwKICAgICAgICBwcmljZTogNTAwMDAwMDAwMDAwMDAwLAogICAgICB9LAogICAgICA5OiB7CiAgICAgICAgbmFtZTogIkhhemVscmFsZCIsCiAgICAgICAgdW5sb2NrOiAzMDAsCiAgICAgICAgYWNoaWV2VW5sb2NrOiA0MDAsCiAgICAgICAgaWNvblJvdzogMTgsCiAgICAgICAgY29sb3I6ICIjOWFiODM0IiwKICAgICAgICBwcmljZTogNTAwMDAwMDAwMDAwMDAwMDAwLAogICAgICB9LAogICAgICAxMDogewogICAgICAgIG5hbWU6ICJNb29uY2FuZHkiLAogICAgICAgIHVubG9jazogMzUwLAogICAgICAgIGFjaGlldlVubG9jazogNDUwLAogICAgICAgIGljb25Sb3c6IDE5LAogICAgICAgIGNvbG9yOiAiIzdlN2FiOSIsCiAgICAgICAgcHJpY2U6IDUwMDAwMDAwMDAwMDAwMDAwMDAwMCwKICAgICAgfSwKICAgICAgMTE6IHsKICAgICAgICBuYW1lOiAiQXN0cm9mdWRnZSIsCiAgICAgICAgdW5sb2NrOiA0MDAsCiAgICAgICAgYWNoaWV2VW5sb2NrOiA1MDAsCiAgICAgICAgaWNvblJvdzogMjgsCiAgICAgICAgY29sb3I6ICIjOWEzMzE2IiwKICAgICAgICBwcmljZTogNTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCwKICAgICAgfSwKICAgICAgMTI6IHsKICAgICAgICBuYW1lOiAiQWxhYmFzY3JlYW0iLAogICAgICAgIHVubG9jazogNDUwLAogICAgICAgIGFjaGlldlVubG9jazogNTUwLAogICAgICAgIGljb25Sb3c6IDMwLAogICAgICAgIGNvbG9yOiAiI2MxYTg4YyIsCiAgICAgICAgcHJpY2U6IDUwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwLAogICAgICB9LAogICAgICAxMzogewogICAgICAgIG5hbWU6ICJJcmlkeXVtIiwKICAgICAgICB1bmxvY2s6IDUwMCwKICAgICAgICBhY2hpZXZVbmxvY2s6IDYwMCwKICAgICAgICBpY29uUm93OiAzMSwKICAgICAgICBjb2xvcjogIiNhZGIxYjMiLAogICAgICAgIHByaWNlOiA1MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIH0sCiAgICAgIDE0OiB7CiAgICAgICAgbmFtZTogIkdsdWNvc21pdW0iLAogICAgICAgIHVubG9jazogNTUwLAogICAgICAgIGFjaGlldlVubG9jazogNjUwLAogICAgICAgIGljb25Sb3c6IDM0LAogICAgICAgIGNvbG9yOiAiI2ZmODllNyIsCiAgICAgICAgcHJpY2U6IDUwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIH0sCiAgICAgIHN5bmVyZ3kxOiB7CiAgICAgICAgbmFtZTogIlN5bmVyZ3kgSSIsCiAgICAgICAgdW5sb2NrOiAxNSwKICAgICAgICBpY29uUm93OiAyMCwKICAgICAgICBjb2xvcjogIiMwMDg1OTUiLAogICAgICAgIHNwZWNpYWw6IDEsCiAgICAgICAgcmVxOiAiU3luZXJnaWVzIFZvbC4gSSIsCiAgICAgICAgcHJpY2U6IDIwMDAwMCwKICAgICAgfSwKICAgICAgc3luZXJneTI6IHsKICAgICAgICBuYW1lOiAiU3luZXJneSBJSSIsCiAgICAgICAgdW5sb2NrOiA3NSwKICAgICAgICBpY29uUm93OiAyOSwKICAgICAgICBjb2xvcjogIiMwMDg1OTUiLAogICAgICAgIHNwZWNpYWw6IDEsCiAgICAgICAgcmVxOiAiU3luZXJnaWVzIFZvbC4gSUkiLAogICAgICAgIHByaWNlOiAyMDAwMDAwMDAwMDAsCiAgICAgIH0sCiAgICAgIGZvcnR1bmU6IHsKICAgICAgICBuYW1lOiAiRm9ydHVuZSIsCiAgICAgICAgdW5sb2NrOiAtMSwKICAgICAgICBpY29uUm93OiAzMiwKICAgICAgICBjb2xvcjogIiM5YWI4MzQiLAogICAgICAgIHNwZWNpYWw6IDEsCiAgICAgICAgcHJpY2U6IDc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3LAogICAgICB9LAogICAgfTsKICAgIGZvciAodmFyIGkgaW4gR2FtZS5UaWVycykgewogICAgICBHYW1lLlRpZXJzW2ldLnVwZ3JhZGVzID0gW107CiAgICB9CiAgICBHYW1lLkdldEljb24gPSBmdW5jdGlvbiAodHlwZSwgdGllcikgewogICAgICB2YXIgY29sID0gMDsKICAgICAgaWYgKHR5cGUgPT0gIktpdHRlbiIpIGNvbCA9IDE4OwogICAgICBlbHNlIGNvbCA9IEdhbWUuT2JqZWN0c1t0eXBlXS5pY29uQ29sdW1uOwogICAgICByZXR1cm4gW2NvbCwgR2FtZS5UaWVyc1t0aWVyXS5pY29uUm93XTsKICAgIH07CiAgICBHYW1lLlNldFRpZXIgPSBmdW5jdGlvbiAoYnVpbGRpbmcsIHRpZXIpIHsKICAgICAgaWYgKCFHYW1lLk9iamVjdHNbYnVpbGRpbmddKQogICAgICAgIGNvbnNvbGUubG9nKCJXYXJuaW5nOiBObyBidWlsZGluZyBuYW1lZCIsIGJ1aWxkaW5nKTsKICAgICAgR2FtZS5sYXN0LnRpZXIgPSB0aWVyOwogICAgICBHYW1lLmxhc3QuYnVpbGRpbmdUaWUgPSBHYW1lLk9iamVjdHNbYnVpbGRpbmddOwogICAgICBpZiAoR2FtZS5sYXN0LnR5cGUgPT0gImFjaGlldmVtZW50IikKICAgICAgICBHYW1lLk9iamVjdHNbYnVpbGRpbmddLnRpZXJlZEFjaGlldnNbdGllcl0gPSBHYW1lLmxhc3Q7CiAgICAgIGVsc2UgR2FtZS5PYmplY3RzW2J1aWxkaW5nXS50aWVyZWRVcGdyYWRlc1t0aWVyXSA9IEdhbWUubGFzdDsKICAgIH07CiAgICBHYW1lLk1ha2VUaWVyZWQgPSBmdW5jdGlvbiAodXBncmFkZSwgdGllciwgY29sKSB7CiAgICAgIHVwZ3JhZGUudGllciA9IHRpZXI7CiAgICAgIGlmICh0eXBlb2YgY29sICE9PSAidW5kZWZpbmVkIikKICAgICAgICB1cGdyYWRlLmljb24gPSBbY29sLCBHYW1lLlRpZXJzW3RpZXJdLmljb25Sb3ddOwogICAgfTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSA9IGZ1bmN0aW9uIChuYW1lLCBkZXNjLCBidWlsZGluZywgdGllcikgewogICAgICBpZiAodGllciA9PSAiZm9ydHVuZSIgJiYgYnVpbGRpbmcpCiAgICAgICAgZGVzYyA9CiAgICAgICAgICBsb2MoIiUxIGFyZSA8Yj4lMiU8L2I+IG1vcmUgZWZmaWNpZW50IGFuZCA8Yj4lMyU8L2I+IGNoZWFwZXIuIiwgWwogICAgICAgICAgICBjYXAoR2FtZS5PYmplY3RzW2J1aWxkaW5nXS5wbHVyYWwpLAogICAgICAgICAgICA3LAogICAgICAgICAgICA3LAogICAgICAgICAgXSkgKyBkZXNjOwogICAgICBlbHNlCiAgICAgICAgZGVzYyA9CiAgICAgICAgICBsb2MoCiAgICAgICAgICAgICIlMSBhcmUgPGI+dHdpY2U8L2I+IGFzIGVmZmljaWVudC4iLAogICAgICAgICAgICBjYXAoR2FtZS5PYmplY3RzW2J1aWxkaW5nXS5wbHVyYWwpCiAgICAgICAgICApICsgZGVzYzsKICAgICAgdmFyIHVwZ3JhZGUgPSBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAgIG5hbWUsCiAgICAgICAgZGVzYywKICAgICAgICBHYW1lLk9iamVjdHNbYnVpbGRpbmddLmJhc2VQcmljZSAqIEdhbWUuVGllcnNbdGllcl0ucHJpY2UsCiAgICAgICAgR2FtZS5HZXRJY29uKGJ1aWxkaW5nLCB0aWVyKQogICAgICApOwogICAgICBpZiAodGllciAhPSAiZm9ydHVuZSIpIHsKICAgICAgICB1cGdyYWRlLmRlc2NGdW5jID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgKEdhbWUuYXNjZW5zaW9uTW9kZSAhPSAxICYmCiAgICAgICAgICAgIEdhbWUuSGFzKHRoaXMuYnVpbGRpbmdUaWUxLnVuc2hhY2tsZVVwZ3JhZGUpICYmCiAgICAgICAgICAgIEdhbWUuSGFzKEdhbWUuVGllcnNbdGhpcy50aWVyXS51bnNoYWNrbGVVcGdyYWRlKQogICAgICAgICAgICAgID8gJzxkaXYgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyI+JyArCiAgICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAgICJVbnNoYWNrbGVkISA8Yj4rJTElPC9iPiBleHRyYSBwcm9kdWN0aW9uLiIsCiAgICAgICAgICAgICAgICAgIE1hdGgucm91bmQoCiAgICAgICAgICAgICAgICAgICAgKHRoaXMuYnVpbGRpbmdUaWUuaWQgPT0gMQogICAgICAgICAgICAgICAgICAgICAgPyAwLjUKICAgICAgICAgICAgICAgICAgICAgIDogKDIwIC0gdGhpcy5idWlsZGluZ1RpZS5pZCkgKiAwLjEpICogMTAwCiAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICkgKwogICAgICAgICAgICAgICAgJzwvZGl2PjxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicKICAgICAgICAgICAgICA6ICIiKSArIHRoaXMuZGRlc2MKICAgICAgICAgICk7CiAgICAgICAgfTsKICAgICAgfQoKICAgICAgR2FtZS5TZXRUaWVyKGJ1aWxkaW5nLCB0aWVyKTsKICAgICAgaWYgKCF1cGdyYWRlLmJ1aWxkaW5nVGllMSAmJiBidWlsZGluZykKICAgICAgICB1cGdyYWRlLmJ1aWxkaW5nVGllMSA9IEdhbWUuT2JqZWN0c1tidWlsZGluZ107CiAgICAgIGlmICh0aWVyID09ICJmb3J0dW5lIiAmJiBidWlsZGluZykKICAgICAgICBHYW1lLk9iamVjdHNbYnVpbGRpbmddLmZvcnR1bmUgPSB1cGdyYWRlOwogICAgICByZXR1cm4gdXBncmFkZTsKICAgIH07CiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlID0gZnVuY3Rpb24gKG5hbWUsIGRlc2MsIGJ1aWxkaW5nMSwgYnVpbGRpbmcyLCB0aWVyKSB7CiAgICAgIC8qCgkJCQljcmVhdGVzIGEgbmV3IHVwZ3JhZGUgdGhhdCA6CgkJCQktdW5sb2NrcyB3aGVuIHlvdSBoYXZlIHRpZXIudW5sb2NrIG9mIGJ1aWxkaW5nMSBhbmQgYnVpbGRpbmcyCgkJCQktaXMgcHJpY2VkIGF0IChidWlsZGluZzEucHJpY2UqMTArYnVpbGRpbmcyLnByaWNlKjEpKnRpZXIucHJpY2UgKGZvcm1lcmx5IDogTWF0aC5zcXJ0KGJ1aWxkaW5nMS5wcmljZSpidWlsZGluZzIucHJpY2UpKnRpZXIucHJpY2UpCgkJCQktZ2l2ZXMgKygwLjEqYnVpbGRpbmcxKSUgY3BzIHRvIGJ1aWxkaW5nMiBhbmQgKyg1KmJ1aWxkaW5nMiklIGNwcyB0byBidWlsZGluZzEKCQkJCS1pZiBidWlsZGluZzIgaXMgYmVsb3cgYnVpbGRpbmcxIGluIHdvcnRoLCBzd2FwIHRoZW0KCQkJKi8KICAgICAgLy9pZiAoR2FtZS5PYmplY3RzW2J1aWxkaW5nMV0uYmFzZVByaWNlPkdhbWUuT2JqZWN0c1tidWlsZGluZzJdLmJhc2VQcmljZSkge3ZhciB0ZW1wPWJ1aWxkaW5nMjtidWlsZGluZzI9YnVpbGRpbmcxO2J1aWxkaW5nMT10ZW1wO30KICAgICAgdmFyIGIxID0gR2FtZS5PYmplY3RzW2J1aWxkaW5nMV07CiAgICAgIHZhciBiMiA9IEdhbWUuT2JqZWN0c1tidWlsZGluZzJdOwogICAgICBpZiAoYjEuYmFzZVByaWNlID4gYjIuYmFzZVByaWNlKSB7CiAgICAgICAgYjEgPSBHYW1lLk9iamVjdHNbYnVpbGRpbmcyXTsKICAgICAgICBiMiA9IEdhbWUuT2JqZWN0c1tidWlsZGluZzFdOwogICAgICB9IC8vc3dhcAoKICAgICAgZGVzYyA9CiAgICAgICAgbG9jKCIlMSBnYWluIDxiPislMiU8L2I+IENwUyBwZXIgJTMuIiwgW2NhcChiMS5wbHVyYWwpLCA1LCBiMi5zaW5nbGVdKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoIiUxIGdhaW4gPGI+KyUyJTwvYj4gQ3BTIHBlciAlMy4iLCBbCiAgICAgICAgICBjYXAoYjIucGx1cmFsKSwKICAgICAgICAgIDAuMSwKICAgICAgICAgIGIxLnNpbmdsZSwKICAgICAgICBdKSArCiAgICAgICAgKEVOID8gZGVzYyA6ICIiKTsKICAgICAgdmFyIHVwZ3JhZGUgPSBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAgIG5hbWUsCiAgICAgICAgZGVzYywKICAgICAgICAoYjEuYmFzZVByaWNlICogMTAgKyBiMi5iYXNlUHJpY2UgKiAxKSAqIEdhbWUuVGllcnNbdGllcl0ucHJpY2UsCiAgICAgICAgR2FtZS5HZXRJY29uKGJ1aWxkaW5nMSwgdGllcikKICAgICAgKTsgLy9NYXRoLnNxcnQoYjEuYmFzZVByaWNlKmIyLmJhc2VQcmljZSkqR2FtZS5UaWVyc1t0aWVyXS5wcmljZQogICAgICB1cGdyYWRlLnRpZXIgPSB0aWVyOwogICAgICB1cGdyYWRlLmJ1aWxkaW5nVGllMSA9IGIxOwogICAgICB1cGdyYWRlLmJ1aWxkaW5nVGllMiA9IGIyOwogICAgICB1cGdyYWRlLnByaWNlRnVuYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gKAogICAgICAgICAgKHRoaXMuYnVpbGRpbmdUaWUxLmJhc2VQcmljZSAqIDEwICsgdGhpcy5idWlsZGluZ1RpZTIuYmFzZVByaWNlICogMSkgKgogICAgICAgICAgR2FtZS5UaWVyc1t0aGlzLnRpZXJdLnByaWNlICoKICAgICAgICAgIChHYW1lLkhhcygiQ2hpbWVyYSIpID8gMC45OCA6IDEpCiAgICAgICAgKTsKICAgICAgfTsKICAgICAgR2FtZS5PYmplY3RzW2J1aWxkaW5nMV0uc3luZXJnaWVzLnB1c2godXBncmFkZSk7CiAgICAgIEdhbWUuT2JqZWN0c1tidWlsZGluZzJdLnN5bmVyZ2llcy5wdXNoKHVwZ3JhZGUpOwogICAgICAvL0dhbWUuU2V0VGllcihidWlsZGluZzEsdGllcik7CiAgICAgIHJldHVybiB1cGdyYWRlOwogICAgfTsKICAgIEdhbWUuR2V0VGllcmVkQ3BzTXVsdCA9IGZ1bmN0aW9uIChtZSkgewogICAgICB2YXIgbXVsdCA9IDE7CiAgICAgIGZvciAodmFyIGkgaW4gbWUudGllcmVkVXBncmFkZXMpIHsKICAgICAgICBpZiAoCiAgICAgICAgICAhR2FtZS5UaWVyc1ttZS50aWVyZWRVcGdyYWRlc1tpXS50aWVyXS5zcGVjaWFsICYmCiAgICAgICAgICBHYW1lLkhhcyhtZS50aWVyZWRVcGdyYWRlc1tpXS5uYW1lKQogICAgICAgICkgewogICAgICAgICAgdmFyIHRpZXJNdWx0ID0gMjsKICAgICAgICAgIC8vdW5zaGFja2xlZAogICAgICAgICAgaWYgKAogICAgICAgICAgICBHYW1lLmFzY2Vuc2lvbk1vZGUgIT0gMSAmJgogICAgICAgICAgICBHYW1lLkhhcyhtZS51bnNoYWNrbGVVcGdyYWRlKSAmJgogICAgICAgICAgICBHYW1lLkhhcyhHYW1lLlRpZXJzW21lLnRpZXJlZFVwZ3JhZGVzW2ldLnRpZXJdLnVuc2hhY2tsZVVwZ3JhZGUpCiAgICAgICAgICApCiAgICAgICAgICAgIHRpZXJNdWx0ICs9IG1lLmlkID09IDEgPyAwLjUgOiAoMjAgLSBtZS5pZCkgKiAwLjE7CiAgICAgICAgICBtdWx0ICo9IHRpZXJNdWx0OwogICAgICAgIH0KICAgICAgfQogICAgICBmb3IgKHZhciBpIGluIG1lLnN5bmVyZ2llcykgewogICAgICAgIHZhciBzeW4gPSBtZS5zeW5lcmdpZXNbaV07CiAgICAgICAgaWYgKEdhbWUuSGFzKHN5bi5uYW1lKSkgewogICAgICAgICAgaWYgKHN5bi5idWlsZGluZ1RpZTEubmFtZSA9PSBtZS5uYW1lKQogICAgICAgICAgICBtdWx0ICo9IDEgKyAwLjA1ICogc3luLmJ1aWxkaW5nVGllMi5hbW91bnQ7CiAgICAgICAgICBlbHNlIGlmIChzeW4uYnVpbGRpbmdUaWUyLm5hbWUgPT0gbWUubmFtZSkKICAgICAgICAgICAgbXVsdCAqPSAxICsgMC4wMDEgKiBzeW4uYnVpbGRpbmdUaWUxLmFtb3VudDsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKG1lLmZvcnR1bmUgJiYgR2FtZS5IYXMobWUuZm9ydHVuZS5uYW1lKSkgbXVsdCAqPSAxLjA3OwogICAgICBpZiAobWUuZ3JhbmRtYSAmJiBHYW1lLkhhcyhtZS5ncmFuZG1hLm5hbWUpKQogICAgICAgIG11bHQgKj0gMSArIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLmFtb3VudCAqIDAuMDEgKiAoMSAvIChtZS5pZCAtIDEpKTsKICAgICAgcmV0dXJuIG11bHQ7CiAgICB9OwogICAgR2FtZS5VbmxvY2tUaWVyZWQgPSBmdW5jdGlvbiAobWUpIHsKICAgICAgZm9yICh2YXIgaSBpbiBtZS50aWVyZWRVcGdyYWRlcykgewogICAgICAgIGlmICgKICAgICAgICAgIEdhbWUuVGllcnNbbWUudGllcmVkVXBncmFkZXNbaV0udGllcl0udW5sb2NrICE9IC0xICYmCiAgICAgICAgICBtZS5hbW91bnQgPj0gR2FtZS5UaWVyc1ttZS50aWVyZWRVcGdyYWRlc1tpXS50aWVyXS51bmxvY2sKICAgICAgICApCiAgICAgICAgICBHYW1lLlVubG9jayhtZS50aWVyZWRVcGdyYWRlc1tpXS5uYW1lKTsKICAgICAgfQogICAgICBmb3IgKHZhciBpIGluIG1lLnRpZXJlZEFjaGlldnMpIHsKICAgICAgICBpZiAobWUuYW1vdW50ID49IEdhbWUuVGllcnNbbWUudGllcmVkQWNoaWV2c1tpXS50aWVyXS5hY2hpZXZVbmxvY2spCiAgICAgICAgICBHYW1lLldpbihtZS50aWVyZWRBY2hpZXZzW2ldLm5hbWUpOwogICAgICB9CiAgICAgIGZvciAodmFyIGkgaW4gbWUuc3luZXJnaWVzKSB7CiAgICAgICAgdmFyIHN5biA9IG1lLnN5bmVyZ2llc1tpXTsKICAgICAgICBpZiAoCiAgICAgICAgICBHYW1lLkhhcyhHYW1lLlRpZXJzW3N5bi50aWVyXS5yZXEpICYmCiAgICAgICAgICBzeW4uYnVpbGRpbmdUaWUxLmFtb3VudCA+PSBHYW1lLlRpZXJzW3N5bi50aWVyXS51bmxvY2sgJiYKICAgICAgICAgIHN5bi5idWlsZGluZ1RpZTIuYW1vdW50ID49IEdhbWUuVGllcnNbc3luLnRpZXJdLnVubG9jawogICAgICAgICkKICAgICAgICAgIEdhbWUuVW5sb2NrKHN5bi5uYW1lKTsKICAgICAgfQogICAgfTsKCiAgICB2YXIgcG9vbCA9ICIiOwogICAgdmFyIHBvd2VyID0gMDsKCiAgICAvL2RlZmluZSB1cGdyYWRlcwogICAgLy9XQVJOSU5HIDogZG8gTk9UIGFkZCBuZXcgdXBncmFkZXMgaW4gYmV0d2VlbiwgdGhpcyBicmVha3MgdGhlIHNhdmVzLiBBZGQgdGhlbSBhdCB0aGUgZW5kICEKICAgIHZhciBvcmRlciA9IDEwMDsgLy90aGlzIGlzIHVzZWQgdG8gc2V0IHRoZSBvcmRlciBpbiB3aGljaCB0aGUgaXRlbXMgYXJlIGxpc3RlZAogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlJlaW5mb3JjZWQgaW5kZXggZmluZ2VyIiwKICAgICAgbG9jKCJUaGUgbW91c2UgYW5kIGN1cnNvcnMgYXJlIDxiPnR3aWNlPC9iPiBhcyBlZmZpY2llbnQuIikgKwogICAgICAgICI8cT5wcm9kIHByb2Q8L3E+IiwKICAgICAgMTAwLAogICAgICBbMCwgMF0KICAgICk7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCAxLCAwKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJDYXJwYWwgdHVubmVsIHByZXZlbnRpb24gY3JlYW0iLAogICAgICBsb2MoIlRoZSBtb3VzZSBhbmQgY3Vyc29ycyBhcmUgPGI+dHdpY2U8L2I+IGFzIGVmZmljaWVudC4iKSArCiAgICAgICAgIjxxPml0Li4uIGl0IGh1cnRzIHRvIGNsaWNrLi4uPC9xPiIsCiAgICAgIDUwMCwKICAgICAgWzAsIDFdCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgMiwgMCk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQW1iaWRleHRyb3VzIiwKICAgICAgbG9jKCJUaGUgbW91c2UgYW5kIGN1cnNvcnMgYXJlIDxiPnR3aWNlPC9iPiBhcyBlZmZpY2llbnQuIikgKwogICAgICAgICI8cT5Mb29rIG1hLCBib3RoIGhhbmRzITwvcT4iLAogICAgICAxMDAwMCwKICAgICAgWzAsIDJdCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgMywgMCk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiVGhvdXNhbmQgZmluZ2VycyIsCiAgICAgIGxvYygKICAgICAgICAiVGhlIG1vdXNlIGFuZCBjdXJzb3JzIGdhaW4gPGI+KyUxPC9iPiBjb29raWVzIGZvciBlYWNoIG5vbi1jdXJzb3IgYnVpbGRpbmcgb3duZWQuIiwKICAgICAgICAwLjEKICAgICAgKSArICI8cT5jbGlja2l0eTwvcT4iLAogICAgICAxMDAwMDAsCiAgICAgIFswLCAxM10KICAgICk7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCA0LCAwKTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiTWlsbGlvbiBmaW5nZXJzIiwKICAgICAgZ2V0U3RyVGhvdXNhbmRGaW5nZXJzR2Fpbig1KSArICI8cT5jbGlja2l0eWNsaWNraXR5PC9xPiIsCiAgICAgIDEwMDAwMDAwLAogICAgICBbMCwgMTRdCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgNSwgMCk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQmlsbGlvbiBmaW5nZXJzIiwKICAgICAgZ2V0U3RyVGhvdXNhbmRGaW5nZXJzR2FpbigxMCkgKyAiPHE+Y2xpY2tpdHljbGlja2l0eWNsaWNraXR5PC9xPiIsCiAgICAgIDEwMDAwMDAwMCwKICAgICAgWzAsIDE1XQogICAgKTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDYsIDApOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlRyaWxsaW9uIGZpbmdlcnMiLAogICAgICBnZXRTdHJUaG91c2FuZEZpbmdlcnNHYWluKDIwKSArICI8cT5jbGlja2l0eWNsaWNraXR5Y2xpY2tpdHljbGlja2l0eTwvcT4iLAogICAgICAxMDAwMDAwMDAwLAogICAgICBbMCwgMTZdCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgNywgMCk7CgogICAgb3JkZXIgPSAyMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJGb3J3YXJkcyBmcm9tIGdyYW5kbWEiLAogICAgICAiPHE+UkU6UkU6dGhvdWdodCB5b3UnZCBnZXQgYSBraWNrIG91dCBvZiB0aGlzIDspKTwvcT4iLAogICAgICAiR3JhbmRtYSIsCiAgICAgIDEKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJTdGVlbC1wbGF0ZWQgcm9sbGluZyBwaW5zIiwKICAgICAgIjxxPkp1c3Qgd2hhdCB5b3Uga25lYWRlZC48L3E+IiwKICAgICAgIkdyYW5kbWEiLAogICAgICAyCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKCJMdWJyaWNhdGVkIGRlbnR1cmVzIiwgIjxxPnNxdWlzaDwvcT4iLCAiR3JhbmRtYSIsIDMpOwoKICAgIG9yZGVyID0gMzAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKCJDaGVhcCBob2VzIiwgIjxxPlJha2UgaW4gdGhlIGRvdWdoITwvcT4iLCAiRmFybSIsIDEpOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRmVydGlsaXplciIsCiAgICAgICI8cT5JdCdzIGNob2NvbGF0ZSwgSSBzd2Vhci48L3E+IiwKICAgICAgIkZhcm0iLAogICAgICAyCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQ29va2llIHRyZWVzIiwKICAgICAgIjxxPkEgcmVsYXRpdmUgb2YgdGhlIGJyZWFkZnJ1aXQuPC9xPiIsCiAgICAgICJGYXJtIiwKICAgICAgMwogICAgKTsKCiAgICBvcmRlciA9IDUwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlN0dXJkaWVyIGNvbnZleW9yIGJlbHRzIiwKICAgICAgIjxxPllvdSdyZSBnb2luZyBwbGFjZXMuPC9xPiIsCiAgICAgICJGYWN0b3J5IiwKICAgICAgMQogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkNoaWxkIGxhYm9yIiwKICAgICAgIjxxPkNoZWFwZXIsIGhlYWx0aGllciB3b3JrZm9yY2UuPC9xPiIsCiAgICAgICJGYWN0b3J5IiwKICAgICAgMgogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlN3ZWF0c2hvcCIsCiAgICAgICI8cT5TbGFja2VycyB3aWxsIGJlIHRlcm1pbmF0ZWQuPC9xPiIsCiAgICAgICJGYWN0b3J5IiwKICAgICAgMwogICAgKTsKCiAgICBvcmRlciA9IDQwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlN1Z2FyIGdhcyIsCiAgICAgICI8cT5BIHBpbmssIHZvbGF0aWxlIGdhcywgZm91bmQgaW4gdGhlIGRlcHRocyBvZiBzb21lIGNob2NvbGF0ZSBjYXZlcy48L3E+IiwKICAgICAgIk1pbmUiLAogICAgICAxCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKCJNZWdhZHJpbGwiLCAiPHE+WW91J3JlIGluIGRlZXAuPC9xPiIsICJNaW5lIiwgMik7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoIlVsdHJhZHJpbGwiLCAiPHE+RmluYWxseSBjYXZlZCBpbj88L3E+IiwgIk1pbmUiLCAzKTsKCiAgICBvcmRlciA9IDYwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlZhbmlsbGEgbmVidWxhZSIsCiAgICAgICI8cT5JZiB5b3UgcmVtb3ZlZCB5b3VyIHNwYWNlIGhlbG1ldCwgeW91IGNvdWxkIHByb2JhYmx5IHNtZWxsIGl0ITxicj4oTm90ZSA6IGRvbid0IGRvIHRoYXQuKTwvcT4iLAogICAgICAiU2hpcG1lbnQiLAogICAgICAxCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiV29ybWhvbGVzIiwKICAgICAgIjxxPkJ5IHVzaW5nIHRoZXNlIGFzIHNob3J0Y3V0cywgeW91ciBzaGlwcyBjYW4gdHJhdmVsIG11Y2ggZmFzdGVyLjwvcT4iLAogICAgICAiU2hpcG1lbnQiLAogICAgICAyCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRnJlcXVlbnQgZmx5ZXIiLAogICAgICAiPHE+Q29tZSBiYWNrIHNvb24hPC9xPiIsCiAgICAgICJTaGlwbWVudCIsCiAgICAgIDMKICAgICk7CgogICAgb3JkZXIgPSA3MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJBbnRpbW9ueSIsCiAgICAgICI8cT5BY3R1YWxseSB3b3J0aCBhIGxvdCBvZiBtb255LjwvcT4iLAogICAgICAiQWxjaGVteSBsYWIiLAogICAgICAxCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRXNzZW5jZSBvZiBkb3VnaCIsCiAgICAgICI8cT5FeHRyYWN0ZWQgdGhyb3VnaCB0aGUgNSBhbmNpZW50IHN0ZXBzIG9mIGFsY2hlbWljYWwgYmFraW5nLjwvcT4iLAogICAgICAiQWxjaGVteSBsYWIiLAogICAgICAyCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiVHJ1ZSBjaG9jb2xhdGUiLAogICAgICAiPHE+VGhlIHB1cmVzdCBmb3JtIG9mIGNhY2FvLjwvcT4iLAogICAgICAiQWxjaGVteSBsYWIiLAogICAgICAzCiAgICApOwoKICAgIG9yZGVyID0gODAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQW5jaWVudCB0YWJsZXQiLAogICAgICAiPHE+QSBzdHJhbmdlIHNsYWIgb2YgcGVhbnV0IGJyaXR0bGUsIGhvbGRpbmcgYW4gYW5jaWVudCBjb29raWUgcmVjaXBlLiBOZWF0ITwvcT4iLAogICAgICAiUG9ydGFsIiwKICAgICAgMQogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkluc2FuZSBvYXRsaW5nIHdvcmtlcnMiLAogICAgICAiPHE+QVJJU0UsIE1ZIE1JTklPTlMhPC9xPiIsCiAgICAgICJQb3J0YWwiLAogICAgICAyCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiU291bCBib25kIiwKICAgICAgIjxxPlNvIEkganVzdCBzaWduIHVwIGFuZCBnZXQgbW9yZSBjb29raWVzPyBTdXJlLCB3aGF0ZXZlciE8L3E+IiwKICAgICAgIlBvcnRhbCIsCiAgICAgIDMKICAgICk7CgogICAgb3JkZXIgPSA5MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJGbHV4IGNhcGFjaXRvcnMiLAogICAgICAiPHE+QmFrZSB0byB0aGUgZnV0dXJlLjwvcT4iLAogICAgICAiVGltZSBtYWNoaW5lIiwKICAgICAgMQogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRpbWUgcGFyYWRveCByZXNvbHZlciIsCiAgICAgICI8cT5ObyBtb3JlIGZvb2xpbmcgYXJvdW5kIHdpdGggeW91ciBvd24gZ3JhbmRtb3RoZXIhPC9xPiIsCiAgICAgICJUaW1lIG1hY2hpbmUiLAogICAgICAyCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiUXVhbnR1bSBjb251bmRydW0iLAogICAgICAiPHE+VGhlcmUgaXMgb25seSBvbmUgY29uc3RhbnQsIGFuZCB0aGF0IGlzIHVuaXZlcnNhbCB1bmNlcnRhaW50eS48YnI+T3IgaXMgaXQ/PC9xPiIsCiAgICAgICJUaW1lIG1hY2hpbmUiLAogICAgICAzCiAgICApOwoKICAgIG9yZGVyID0gMjAwMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiS2l0dGVuIGhlbHBlcnMiLAogICAgICBzdHJLaXR0ZW5EZXNjICsgIjxxPm1lb3cgbWF5IEkgaGVscCB5b3U8L3E+IiwKICAgICAgOTAwMDAwMCwKICAgICAgR2FtZS5HZXRJY29uKCJLaXR0ZW4iLCAxKQogICAgKTsKICAgIEdhbWUubGFzdC5raXR0ZW4gPSAxOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgMSwgMTgpOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIktpdHRlbiB3b3JrZXJzIiwKICAgICAgc3RyS2l0dGVuRGVzYyArICI8cT5tZW93IG1lb3cgbWVvdyBtZW93PC9xPiIsCiAgICAgIDkwMDAwMDAwMDAsCiAgICAgIEdhbWUuR2V0SWNvbigiS2l0dGVuIiwgMikKICAgICk7CiAgICBHYW1lLmxhc3Qua2l0dGVuID0gMTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDIsIDE4KTsKCiAgICBvcmRlciA9IDEwMDAwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlBsYWluIGNvb2tpZXMiLAogICAgICBkZXNjOiAiV2UgYWxsIGdvdHRhIHN0YXJ0IHNvbWV3aGVyZS4iLAogICAgICBpY29uOiBbMiwgM10sCiAgICAgIHBvd2VyOiAxLAogICAgICBwcmljZTogOTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiU3VnYXIgY29va2llcyIsCiAgICAgIGRlc2M6ICJUYXN0eSwgaWYgYSBsaXR0bGUgdW5pbWFnaW5hdGl2ZS4iLAogICAgICBpY29uOiBbNywgM10sCiAgICAgIHBvd2VyOiAxLAogICAgICBwcmljZTogOTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIk9hdG1lYWwgcmFpc2luIGNvb2tpZXMiLAogICAgICBkZXNjOiAiTm8gcmFpc2luIHRvIGhhdGUgdGhlc2UuIiwKICAgICAgaWNvbjogWzAsIDNdLAogICAgICBwb3dlcjogMSwKICAgICAgcHJpY2U6IDk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJQZWFudXQgYnV0dGVyIGNvb2tpZXMiLAogICAgICBkZXNjOiAiR2V0IHlvdXJzZWxmIHNvbWUgamFtIGNvb2tpZXMhIiwKICAgICAgaWNvbjogWzEsIDNdLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQ29jb251dCBjb29raWVzIiwKICAgICAgZGVzYzogIkZsYWt5LCBidXQgbm90IHVucmVsaWFibGUuIFNvbWUgcGVvcGxlIGdvIGNyYXp5IGZvciB0aGVzZS4iLAogICAgICBpY29uOiBbMywgM10sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTksCiAgICB9KTsKICAgIG9yZGVyID0gMTAwMDE7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiV2hpdGUgY2hvY29sYXRlIGNvb2tpZXMiLAogICAgICBkZXNjOiAiSSBrbm93IHdoYXQgeW91J2xsIHNheS4gSXQncyBqdXN0IGNvY29hIGJ1dHRlciEgSXQncyBub3QgcmVhbCBjaG9jb2xhdGUhPGJyPk9oIHBsZWFzZS4iLAogICAgICBpY29uOiBbNCwgM10sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBvcmRlciA9IDEwMDAwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIk1hY2FkYW1pYSBudXQgY29va2llcyIsCiAgICAgIGRlc2M6ICJUaGV5J3JlIG1hY2FkYW1uIGRlbGljaW91cyEiLAogICAgICBpY29uOiBbNSwgM10sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTksCiAgICB9KTsKICAgIG9yZGVyID0gMTAwMDI7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiRG91YmxlLWNoaXAgY29va2llcyIsCiAgICAgIGRlc2M6ICJET1VCTEUgVEhFIENISVBTPGJyPkRPVUJMRSBUSEUgVEFTVFk8YnI+KGRvdWJsZSB0aGUgY2Fsb3JpZXMpIiwKICAgICAgaWNvbjogWzYsIDNdLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTk5OSAqIDUsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJXaGl0ZSBjaG9jb2xhdGUgbWFjYWRhbWlhIG51dCBjb29raWVzIiwKICAgICAgZGVzYzogIk9ydGVpbCdzIGZhdm9yaXRlLiIsCiAgICAgIGljb246IFs4LCAzXSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQWxsLWNob2NvbGF0ZSBjb29raWVzIiwKICAgICAgZGVzYzogIkNIT0NPVkVSRE9TRS4iLAogICAgICBpY29uOiBbOSwgM10sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTk5OSAqIDUsCiAgICB9KTsKCiAgICBvcmRlciA9IDEwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJRdWFkcmlsbGlvbiBmaW5nZXJzIiwKICAgICAgZ2V0U3RyVGhvdXNhbmRGaW5nZXJzR2FpbigyMCkgKwogICAgICAgICI8cT5jbGlja2l0eWNsaWNraXR5Y2xpY2tpdHljbGlja2l0eWNsaWNrPC9xPiIsCiAgICAgIDEwMDAwMDAwMDAwLAogICAgICBbMCwgMTddCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgOCwgMCk7CgogICAgb3JkZXIgPSAyMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoIlBydW5lIGp1aWNlIiwgIjxxPkdldHMgbWUgZ29pbmcuPC9xPiIsICJHcmFuZG1hIiwgNCk7CiAgICBvcmRlciA9IDMwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkdlbmV0aWNhbGx5LW1vZGlmaWVkIGNvb2tpZXMiLAogICAgICAiPHE+QWxsLW5hdHVyYWwgbXV0YXRpb25zLjwvcT4iLAogICAgICAiRmFybSIsCiAgICAgIDQKICAgICk7CiAgICBvcmRlciA9IDUwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlJhZGl1bSByZWFjdG9ycyIsCiAgICAgICI8cT5HaXZlcyB5b3VyIGNvb2tpZXMgYSBoZWFsdGh5IGdsb3cuPC9xPiIsCiAgICAgICJGYWN0b3J5IiwKICAgICAgNAogICAgKTsKICAgIG9yZGVyID0gNDAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiVWx0aW1hZHJpbGwiLAogICAgICAiPHE+UGllcmNlIHRoZSBoZWF2ZW5zLCBldGMuPC9xPiIsCiAgICAgICJNaW5lIiwKICAgICAgNAogICAgKTsKICAgIG9yZGVyID0gNjAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKCJXYXJwIGRyaXZlIiwgIjxxPlRvIGJvbGRseSBiYWtlLjwvcT4iLCAiU2hpcG1lbnQiLCA0KTsKICAgIG9yZGVyID0gNzAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQW1icm9zaWEiLAogICAgICAiPHE+QWRkaW5nIHRoaXMgdG8gdGhlIGNvb2tpZSBtaXggaXMgc3VyZSB0byBtYWtlIHRoZW0gZXZlbiBtb3JlIGFkZGljdGl2ZSE8YnI+UGVyaGFwcyBkYW5nZXJvdXNseSBzby48YnI+TGV0J3MgaG9wZSB5b3UgY2FuIGtlZXAgc2VsbGluZyB0aGVzZSBsZWdhbGx5LjwvcT4iLAogICAgICAiQWxjaGVteSBsYWIiLAogICAgICA0CiAgICApOwogICAgb3JkZXIgPSA4MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJTYW5pdHkgZGFuY2UiLAogICAgICAiPHE+V2UgY2FuIGNoYW5nZSBpZiB3ZSB3YW50IHRvLjxicj5XZSBjYW4gbGVhdmUgb3VyIGJyYWlucyBiZWhpbmQuPC9xPiIsCiAgICAgICJQb3J0YWwiLAogICAgICA0CiAgICApOwogICAgb3JkZXIgPSA5MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJDYXVzYWxpdHkgZW5mb3JjZXIiLAogICAgICAiPHE+V2hhdCBoYXBwZW5lZCwgaGFwcGVuZWQuPC9xPiIsCiAgICAgICJUaW1lIG1hY2hpbmUiLAogICAgICA0CiAgICApOwoKICAgIG9yZGVyID0gNTAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJMdWNreSBkYXkiLAogICAgICBsb2MoCiAgICAgICAgIkdvbGRlbiBjb29raWVzIGFwcGVhciA8Yj50d2ljZSBhcyBvZnRlbjwvYj4gYW5kIHN0YXkgPGI+dHdpY2UgYXMgbG9uZzwvYj4uIgogICAgICApICsgIjxxPk9oIGhleSwgYSBmb3VyLWxlYWYgcGVubnkhPC9xPiIsCiAgICAgIDc3Nzc3Nzc3NywKICAgICAgWzI3LCA2XQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTZXJlbmRpcGl0eSIsCiAgICAgIGxvYygKICAgICAgICAiR29sZGVuIGNvb2tpZXMgYXBwZWFyIDxiPnR3aWNlIGFzIG9mdGVuPC9iPiBhbmQgc3RheSA8Yj50d2ljZSBhcyBsb25nPC9iPi4iCiAgICAgICkgKyAiPHE+V2hhdCBqb3khIFNldmVuIGhvcnNlc2hvZXMhPC9xPiIsCiAgICAgIDc3Nzc3Nzc3Nzc3LAogICAgICBbMjcsIDZdCiAgICApOwoKICAgIG9yZGVyID0gMjAwMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiS2l0dGVuIGVuZ2luZWVycyIsCiAgICAgIHN0cktpdHRlbkRlc2MgKyAiPHE+bWVvdyBtZW93IG1lb3cgbWVvdywgc2lyPC9xPiIsCiAgICAgIDkwMDAwMDAwMDAwMDAwLAogICAgICBHYW1lLkdldEljb24oIktpdHRlbiIsIDMpCiAgICApOwogICAgR2FtZS5sYXN0LmtpdHRlbiA9IDE7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCAzLCAxOCk7CgogICAgb3JkZXIgPSAxMDAyMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJEYXJrIGNob2NvbGF0ZS1jb2F0ZWQgY29va2llcyIsCiAgICAgIGRlc2M6ICJUaGVzZSBhYnNvcmIgbGlnaHQgc28gd2VsbCB5b3UgYWxtb3N0IG5lZWQgdG8gc3F1aW50IHRvIHNlZSB0aGVtLiIsCiAgICAgIGljb246IFsxMCwgM10sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogOTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJXaGl0ZSBjaG9jb2xhdGUtY29hdGVkIGNvb2tpZXMiLAogICAgICBkZXNjOiAiVGhlc2UgZGF6emxpbmcgY29va2llcyBhYnNvbHV0ZWx5IGdsaXN0ZW4gd2l0aCBmbGF2b3IuIiwKICAgICAgaWNvbjogWzExLCAzXSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OSwKICAgIH0pOwoKICAgIEdhbWUuR3JhbmRtYVN5bmVyZ2llcyA9IFtdOwogICAgR2FtZS5HcmFuZG1hU3luZXJneSA9IGZ1bmN0aW9uIChuYW1lLCBkZXNjLCBidWlsZGluZykgewogICAgICB2YXIgYnVpbGRpbmcgPSBHYW1lLk9iamVjdHNbYnVpbGRpbmddOwogICAgICB2YXIgZ3JhbmRtYU51bWJlciA9IGxvYygiJTEgZ3JhbmRtYSIsIExCZWF1dGlmeShidWlsZGluZy5pZCAtIDEpKTsKICAgICAgZGVzYyA9CiAgICAgICAgbG9jKAogICAgICAgICAgIiUxIGFyZSA8Yj50d2ljZTwvYj4gYXMgZWZmaWNpZW50LiIsCiAgICAgICAgICBjYXAoR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0ucGx1cmFsKQogICAgICAgICkgKwogICAgICAgICIgIiArCiAgICAgICAgbG9jKCIlMSBnYWluIDxiPislMiU8L2I+IENwUyBwZXIgJTMuIiwgWwogICAgICAgICAgY2FwKGJ1aWxkaW5nLnBsdXJhbCksCiAgICAgICAgICAxLAogICAgICAgICAgZ3JhbmRtYU51bWJlciwKICAgICAgICBdKSArCiAgICAgICAgIjxxPiIgKwogICAgICAgIGRlc2MgKwogICAgICAgICI8L3E+IjsKCiAgICAgIHZhciB1cGdyYWRlID0gbmV3IEdhbWUuVXBncmFkZSgKICAgICAgICBuYW1lLAogICAgICAgIGRlc2MsCiAgICAgICAgYnVpbGRpbmcuYmFzZVByaWNlICogR2FtZS5UaWVyc1syXS5wcmljZSwKICAgICAgICBbMTAsIDldLAogICAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLnJlZHJhdygpOwogICAgICAgIH0KICAgICAgKTsKICAgICAgYnVpbGRpbmcuZ3JhbmRtYSA9IHVwZ3JhZGU7CiAgICAgIHVwZ3JhZGUuYnVpbGRpbmdUaWUgPSBidWlsZGluZzsKICAgICAgR2FtZS5HcmFuZG1hU3luZXJnaWVzLnB1c2godXBncmFkZS5uYW1lKTsKICAgICAgcmV0dXJuIHVwZ3JhZGU7CiAgICB9OwoKICAgIG9yZGVyID0gMjUwOwogICAgR2FtZS5HcmFuZG1hU3luZXJneSgKICAgICAgIkZhcm1lciBncmFuZG1hcyIsCiAgICAgICJBIG5pY2UgZmFybWVyIHRvIGdyb3cgbW9yZSBjb29raWVzLiIsCiAgICAgICJGYXJtIgogICAgKTsKICAgIEdhbWUuR3JhbmRtYVN5bmVyZ3koCiAgICAgICJNaW5lciBncmFuZG1hcyIsCiAgICAgICJBIG5pY2UgbWluZXIgdG8gZGlnIG1vcmUgY29va2llcy4iLAogICAgICAiTWluZSIKICAgICk7CiAgICBHYW1lLkdyYW5kbWFTeW5lcmd5KAogICAgICAiV29ya2VyIGdyYW5kbWFzIiwKICAgICAgIkEgbmljZSB3b3JrZXIgdG8gbWFudWZhY3R1cmUgbW9yZSBjb29raWVzLiIsCiAgICAgICJGYWN0b3J5IgogICAgKTsKICAgIEdhbWUuR3JhbmRtYVN5bmVyZ3koCiAgICAgICJDb3NtaWMgZ3JhbmRtYXMiLAogICAgICAiQSBuaWNlIHRoaW5nIHRvLi4uIHVoLi4uIGNvb2tpZXMuIiwKICAgICAgIlNoaXBtZW50IgogICAgKTsKICAgIEdhbWUuR3JhbmRtYVN5bmVyZ3koCiAgICAgICJUcmFuc211dGVkIGdyYW5kbWFzIiwKICAgICAgIkEgbmljZSBnb2xkZW4gZ3JhbmRtYSB0byBjb252ZXJ0IGludG8gbW9yZSBjb29raWVzLiIsCiAgICAgICJBbGNoZW15IGxhYiIKICAgICk7CiAgICBHYW1lLkdyYW5kbWFTeW5lcmd5KAogICAgICAiQWx0ZXJlZCBncmFuZG1hcyIsCiAgICAgICJhIE5pQ2UgR3JBbkRtQSB0TyBiQSMjIyMjIyMjIyMiLAogICAgICAiUG9ydGFsIgogICAgKTsKICAgIEdhbWUuR3JhbmRtYVN5bmVyZ3koCiAgICAgICJHcmFuZG1hcycgZ3JhbmRtYXMiLAogICAgICAiQSBuaWNlIGdyYW5kbWEncyBuaWNlIGdyYW5kbWEgdG8gYmFrZSBkb3VibGUgdGhlIGNvb2tpZXMuIiwKICAgICAgIlRpbWUgbWFjaGluZSIKICAgICk7CgogICAgb3JkZXIgPSAxNDAwMDsKICAgIEdhbWUuYmFzZVJlc2VhcmNoVGltZSA9IEdhbWUuZnBzICogNjAgKiAzMDsKICAgIEdhbWUuU2V0UmVzZWFyY2ggPSBmdW5jdGlvbiAod2hhdCwgdGltZSkgewogICAgICBpZiAoR2FtZS5VcGdyYWRlc1t3aGF0XSAmJiAhR2FtZS5IYXMod2hhdCkpIHsKICAgICAgICBHYW1lLnJlc2VhcmNoVCA9IEdhbWUuYmFzZVJlc2VhcmNoVGltZTsKICAgICAgICBpZiAoR2FtZS5IYXMoIlBlcnNpc3RlbnQgbWVtb3J5IikpCiAgICAgICAgICBHYW1lLnJlc2VhcmNoVCA9IE1hdGguY2VpbChHYW1lLmJhc2VSZXNlYXJjaFRpbWUgLyAxMCk7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJVbHRyYXNjaWVuY2UiKSkgR2FtZS5yZXNlYXJjaFQgPSBHYW1lLmZwcyAqIDU7CiAgICAgICAgR2FtZS5uZXh0UmVzZWFyY2ggPSBHYW1lLlVwZ3JhZGVzW3doYXRdLmlkOwogICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgbG9jKCJSZXNlYXJjaCBoYXMgYmVndW4iKSwKICAgICAgICAgIGxvYygiWW91ciBiaW5nbyBjZW50ZXIvcmVzZWFyY2ggZmFjaWxpdHkgaXMgY29uZHVjdGluZyBleHBlcmltZW50cy4iKSwKICAgICAgICAgIFs5LCAwXQogICAgICAgICk7CiAgICAgIH0KICAgIH07CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkJpbmdvIGNlbnRlci9SZXNlYXJjaCBmYWNpbGl0eSIsCiAgICAgIGxvYygKICAgICAgICAiR3JhbmRtYS1vcGVyYXRlZCBzY2llbmNlIGxhYiBhbmQgbGVpc3VyZSBjbHViLjxicj5HcmFuZG1hcyBhcmUgPGI+NCB0aW1lczwvYj4gYXMgZWZmaWNpZW50Ljxicj48Yj5SZWd1bGFybHkgdW5sb2NrcyBuZXcgdXBncmFkZXM8L2I+LiIKICAgICAgKSArCiAgICAgICAgIjxxPldoYXQgY291bGQgcG9zc2libHkga2VlcCB0aG9zZSBncmFuZG1vdGhlcnMgaW4gY2hlY2s/Li4uPGJyPkJpbmdvLjwvcT4iLAogICAgICAxMDAwMDAwMDAwMDAwMDAwLAogICAgICBbMTEsIDldLAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5TZXRSZXNlYXJjaCgiU3BlY2lhbGl6ZWQgY2hvY29sYXRlIGNoaXBzIik7CiAgICAgIH0KICAgICk7CiAgICBHYW1lLmxhc3Qubm9QZXJtID0gMTsKCiAgICBvcmRlciA9IDE1MDAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlNwZWNpYWxpemVkIGNob2NvbGF0ZSBjaGlwcyIsCiAgICAgIGdldFN0ckNvb2tpZVByb2R1Y3Rpb25NdWx0aXBsaWVyUGx1cygxKSArCiAgICAgICAgIjxxPkNvbXB1dGVyLWRlc2lnbmVkIGNob2NvbGF0ZSBjaGlwcy4gQ29tcHV0ZXIgY2hpcHMsIGlmIHlvdSB3aWxsLjwvcT4iLAogICAgICAxMDAwMDAwMDAwMDAwMDAwLAogICAgICBbMCwgOV0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLlNldFJlc2VhcmNoKCJEZXNpZ25lciBjb2NvYSBiZWFucyIpOwogICAgICB9CiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAidGVjaCI7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRGVzaWduZXIgY29jb2EgYmVhbnMiLAogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMikgKwogICAgICAgICI8cT5Ob3cgbW9yZSBhZXJvZHluYW1pYyB0aGFuIGV2ZXIhPC9xPiIsCiAgICAgIDIwMDAwMDAwMDAwMDAwMDAsCiAgICAgIFsxLCA5XSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuU2V0UmVzZWFyY2goIlJpdHVhbCByb2xsaW5nIHBpbnMiKTsKICAgICAgfQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInRlY2giOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlJpdHVhbCByb2xsaW5nIHBpbnMiLAogICAgICBsb2MoCiAgICAgICAgIiUxIGFyZSA8Yj50d2ljZTwvYj4gYXMgZWZmaWNpZW50LiIsCiAgICAgICAgY2FwKEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLnBsdXJhbCkKICAgICAgKSArICI8cT5UaGUgcmVzdWx0IG9mIHllYXJzIG9mIHNjaWVudGlmaWMgcmVzZWFyY2ghPC9xPiIsCiAgICAgIDQwMDAwMDAwMDAwMDAwMDAsCiAgICAgIFsyLCA5XSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuU2V0UmVzZWFyY2goIlVuZGVyd29ybGQgb3ZlbnMiKTsKICAgICAgfQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInRlY2giOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlVuZGVyd29ybGQgb3ZlbnMiLAogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMykgKwogICAgICAgICI8cT5Qb3dlcmVkIGJ5IHNjaWVuY2UsIG9mIGNvdXJzZSE8L3E+IiwKICAgICAgODAwMDAwMDAwMDAwMDAwMCwKICAgICAgWzMsIDldLAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5TZXRSZXNlYXJjaCgiT25lIG1pbmQiKTsKICAgICAgfQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInRlY2giOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIk9uZSBtaW5kIiwKICAgICAgbG9jKCJFYWNoICUxIGdhaW5zIDxiPislMiBiYXNlIENwUyBwZXIgJTM8L2I+LiIsIFsKICAgICAgICBsb2MoImdyYW5kbWEiKSwKICAgICAgICAiMC4wPHNwYW4+PC9zcGFuPjIiLAogICAgICAgIGxvYygiZ3JhbmRtYSIpLAogICAgICBdKSArCiAgICAgICAgJzxkaXYgY2xhc3M9Indhcm5pbmciPicgKwogICAgICAgIGxvYygKICAgICAgICAgICJOb3RlOiB0aGUgZ3JhbmRtb3RoZXJzIGFyZSBncm93aW5nIHJlc3RsZXNzLiBEbyBub3QgZW5jb3VyYWdlIHRoZW0uIgogICAgICAgICkgKwogICAgICAgICI8L2Rpdj48cT5XZSBhcmUgb25lLiBXZSBhcmUgbWFueS48L3E+IiwKICAgICAgMTYwMDAwMDAwMDAwMDAwMDAsCiAgICAgIFs0LCA5XSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuZWxkZXJXcmF0aCA9IDE7CiAgICAgICAgR2FtZS5TZXRSZXNlYXJjaCgiRXhvdGljIG51dHMiKTsKICAgICAgICBHYW1lLnN0b3JlVG9SZWZyZXNoID0gMTsKICAgICAgfQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInRlY2giOwogICAgLy9HYW1lLmxhc3QuY2xpY2tGdW5jdGlvbj1mdW5jdGlvbigpe3JldHVybiBjb25maXJtKCdXYXJuaW5nIDogcHVyY2hhc2luZyB0aGlzIHdpbGwgaGF2ZSB1bmV4cGVjdGVkLCBhbmQgcG90ZW50aWFsbHkgdW5kZXNpcmFibGUgcmVzdWx0cyFcbkl0XCdzIGFsbCBkb3duaGlsbCBmcm9tIGhlcmUuIFlvdSBoYXZlIGJlZW4gd2FybmVkIVxuUHVyY2hhc2UgYW55d2F5PycpO307CiAgICBHYW1lLlJlcXVpcmVzQ29uZmlybWF0aW9uKAogICAgICBHYW1lLmxhc3QsCiAgICAgICc8ZGl2IGNsYXNzPSJibG9jayI+JyArCiAgICAgICAgbG9jKAogICAgICAgICAgIjxiPldhcm5pbmc6PC9iPiBwdXJjaGFzaW5nIHRoaXMgd2lsbCBoYXZlIHVuZXhwZWN0ZWQsIGFuZCBwb3RlbnRpYWxseSB1bmRlc2lyYWJsZSByZXN1bHRzITxicj48c21hbGw+SXQncyBhbGwgZG93bmhpbGwgZnJvbSBoZXJlLiBZb3UgaGF2ZSBiZWVuIHdhcm5lZCE8L3NtYWxsPjxicj48YnI+UHVyY2hhc2UgYW55d2F5PyIKICAgICAgICApICsKICAgICAgICAiPC9kaXY+IgogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJFeG90aWMgbnV0cyIsCiAgICAgIGdldFN0ckNvb2tpZVByb2R1Y3Rpb25NdWx0aXBsaWVyUGx1cyg0KSArCiAgICAgICAgIjxxPllvdSdsbCBnbyBjcmF6eSBvdmVyIHRoZXNlITwvcT4iLAogICAgICAzMjAwMDAwMDAwMDAwMDAwMCwKICAgICAgWzUsIDldLAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5TZXRSZXNlYXJjaCgiQ29tbXVuYWwgYnJhaW5zd2VlcCIpOwogICAgICB9CiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAidGVjaCI7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQ29tbXVuYWwgYnJhaW5zd2VlcCIsCiAgICAgIChFTgogICAgICAgID8gIkVhY2ggZ3JhbmRtYSBnYWlucyBhbm90aGVyIDxiPiswLjA8c3Bhbj48L3NwYW4+MiBiYXNlIENwUyBwZXIgZ3JhbmRtYTwvYj4uIgogICAgICAgIDogbG9jKCJFYWNoICUxIGdhaW5zIDxiPislMiBiYXNlIENwUyBwZXIgJTM8L2I+LiIsIFsKICAgICAgICAgICAgbG9jKCJncmFuZG1hIiksCiAgICAgICAgICAgICIwLjA8c3Bhbj48L3NwYW4+MiIsCiAgICAgICAgICAgIGxvYygiZ3JhbmRtYSIpLAogICAgICAgICAgXSkpICsKICAgICAgICAnPGRpdiBjbGFzcz0id2FybmluZyI+JyArCiAgICAgICAgbG9jKAogICAgICAgICAgIk5vdGU6IHByb2NlZWRpbmcgYW55IGZ1cnRoZXIgaW4gc2NpZW50aWZpYyByZXNlYXJjaCBtYXkgaGF2ZSB1bmV4cGVjdGVkIHJlc3VsdHMuIFlvdSBoYXZlIGJlZW4gd2FybmVkLiIKICAgICAgICApICsKICAgICAgICAiPC9kaXY+PHE+V2UgZnVzZS4gV2UgbWVyZ2UuIFdlIGdyb3cuPC9xPiIsCiAgICAgIDY0MDAwMDAwMDAwMDAwMDAwLAogICAgICBbNiwgOV0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLmVsZGVyV3JhdGggPSAyOwogICAgICAgIEdhbWUuU2V0UmVzZWFyY2goIkFyY2FuZSBzdWdhciIpOwogICAgICAgIEdhbWUuc3RvcmVUb1JlZnJlc2ggPSAxOwogICAgICB9CiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAidGVjaCI7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQXJjYW5lIHN1Z2FyIiwKICAgICAgZ2V0U3RyQ29va2llUHJvZHVjdGlvbk11bHRpcGxpZXJQbHVzKDUpICsKICAgICAgICAiPHE+VGFzdGVzIGxpa2UgaW5zZWN0cywgbGlnYW1lbnRzLCBhbmQgbW9sYXNzZXMuPC9xPiIsCiAgICAgIDEyODAwMDAwMDAwMDAwMDAwMCwKICAgICAgWzcsIDldLAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5TZXRSZXNlYXJjaCgiRWxkZXIgUGFjdCIpOwogICAgICB9CiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAidGVjaCI7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRWxkZXIgUGFjdCIsCiAgICAgIGxvYygiRWFjaCAlMSBnYWlucyA8Yj4rJTIgYmFzZSBDcFMgcGVyICUzPC9iPi4iLCBbCiAgICAgICAgbG9jKCJncmFuZG1hIiksCiAgICAgICAgIjAuMDxzcGFuPjwvc3Bhbj41IiwKICAgICAgICBsb2MoInBvcnRhbCIpLAogICAgICBdKSArCiAgICAgICAgJzxkaXYgY2xhc3M9Indhcm5pbmciPicgKwogICAgICAgIGxvYygiTm90ZTogdGhpcyBpcyBhIGJhZCBpZGVhLiIpICsKICAgICAgICAiPC9kaXY+PHE+c3F1aXJtIGNyYXdsIHNsaXRoZXIgd3JpdGhlPGJyPnRvZGF5IHdlIHJpc2U8L3E+IiwKICAgICAgMjU2MDAwMDAwMDAwMDAwMDAwLAogICAgICBbOCwgOV0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLmVsZGVyV3JhdGggPSAzOwogICAgICAgIEdhbWUuc3RvcmVUb1JlZnJlc2ggPSAxOwogICAgICB9CiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAidGVjaCI7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRWxkZXIgUGxlZGdlIiwKICAgICAgbG9jKCJDb250YWlucyB0aGUgd3JhdGggb2YgdGhlIGVsZGVycywgYXQgbGVhc3QgZm9yIGEgd2hpbGUuIikgKwogICAgICAgICI8cT5UaGlzIGlzIGEgc2ltcGxlIHJpdHVhbCBpbnZvbHZpbmcgYW50aS1hZ2luZyBjcmVhbSwgY29va2llIGJhdHRlciBtaXhlZCBpbiB0aGUgbW9vbmxpZ2h0LCBhbmQgYSBsaXZlIGNoaWNrZW4uPC9xPiIsCiAgICAgIDEsCiAgICAgIFs5LCA5XSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuZWxkZXJXcmF0aCA9IDA7CiAgICAgICAgR2FtZS5wbGVkZ2VzKys7CiAgICAgICAgR2FtZS5wbGVkZ2VUID0gR2FtZS5nZXRQbGVkZ2VEdXJhdGlvbigpOwogICAgICAgIEdhbWUuVW5sb2NrKCJFbGRlciBDb3ZlbmFudCIpOwogICAgICAgIEdhbWUuQ29sbGVjdFdyaW5rbGVycygpOwogICAgICAgIEdhbWUuc3RvcmVUb1JlZnJlc2ggPSAxOwogICAgICB9CiAgICApOwogICAgR2FtZS5nZXRQbGVkZ2VEdXJhdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIEdhbWUuZnBzICogNjAgKiAoR2FtZS5IYXMoIlNhY3JpZmljaWFsIHJvbGxpbmcgcGlucyIpID8gNjAgOiAzMCk7CiAgICB9OwogICAgR2FtZS5sYXN0LnBvb2wgPSAidG9nZ2xlIjsKICAgIEdhbWUubGFzdC5kaXNwbGF5RnVuY1doZW5Pd25lZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuICgKICAgICAgICAnPGRpdiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7Ij4nICsKICAgICAgICBsb2MoIlRpbWUgcmVtYWluaW5nIHVudGlsIHBsZWRnZSBydW5zIG91dDoiKSArCiAgICAgICAgIjxicj48Yj4iICsKICAgICAgICBHYW1lLnNheVRpbWUoR2FtZS5wbGVkZ2VULCAtMSkgKwogICAgICAgICI8L2I+PC9kaXY+IgogICAgICApOwogICAgfTsKICAgIEdhbWUubGFzdC50aW1lckRpc3BsYXkgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICghR2FtZS5VcGdyYWRlc1siRWxkZXIgUGxlZGdlIl0uYm91Z2h0KSByZXR1cm4gLTE7CiAgICAgIGVsc2UgcmV0dXJuIDEgLSBHYW1lLnBsZWRnZVQgLyBHYW1lLmdldFBsZWRnZUR1cmF0aW9uKCk7CiAgICB9OwogICAgR2FtZS5sYXN0LnByaWNlRnVuYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIE1hdGgucG93KDgsIE1hdGgubWluKEdhbWUucGxlZGdlcyArIDIsIDE0KSk7CiAgICB9OwoKICAgIEdhbWUubGFzdC5kZXNjRnVuYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuICgKICAgICAgICAnPGRpdiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7Ij4nICsKICAgICAgICAoR2FtZS5wbGVkZ2VzID09IDAKICAgICAgICAgID8gbG9jKCJZb3UgaGF2ZW4ndCBwbGVkZ2VkIHRvIHRoZSBlbGRlcnMgeWV0LiIpCiAgICAgICAgICA6IGxvYygKICAgICAgICAgICAgICAiWW91J3ZlIHBsZWRnZWQgdG8gdGhlIGVsZGVycyA8Yj4lMSB0aW1lczwvYj4uIiwKICAgICAgICAgICAgICBMQmVhdXRpZnkoR2FtZS5wbGVkZ2VzKQogICAgICAgICAgICApKSArCiAgICAgICAgJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PjwvZGl2PicgKwogICAgICAgIHRoaXMuZGRlc2MKICAgICAgKTsKICAgIH07CgogICAgb3JkZXIgPSAxNTA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiUGxhc3RpYyBtb3VzZSIsCiAgICAgIGdldFN0ckNsaWNraW5nR2FpbnMoMSkgKyAiPHE+U2xpZ2h0bHkgc3F1ZWFreS48L3E+IiwKICAgICAgNTAwMDAsCiAgICAgIFsxMSwgMF0KICAgICk7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCAxLCAxMSk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiSXJvbiBtb3VzZSIsCiAgICAgIGdldFN0ckNsaWNraW5nR2FpbnMoMSkgKyAiPHE+Q2xpY2sgbGlrZSBpdCdzIDEzNDkhPC9xPiIsCiAgICAgIDUwMDAwMDAsCiAgICAgIFsxMSwgMV0KICAgICk7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCAyLCAxMSk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiVGl0YW5pdW0gbW91c2UiLAogICAgICBnZXRTdHJDbGlja2luZ0dhaW5zKDEpICsgIjxxPkhlYXZ5LCBidXQgcG93ZXJmdWwuPC9xPiIsCiAgICAgIDUwMDAwMDAwMCwKICAgICAgWzExLCAyXQogICAgKTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDMsIDExKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJBZGFtYW50aXVtIG1vdXNlIiwKICAgICAgZ2V0U3RyQ2xpY2tpbmdHYWlucygxKSArICI8cT5Zb3UgY291bGQgY3V0IGRpYW1vbmQgd2l0aCB0aGVzZS48L3E+IiwKICAgICAgNTAwMDAwMDAwMDAsCiAgICAgIFsxMSwgMTNdCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgNCwgMTEpOwoKICAgIG9yZGVyID0gNDAwMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiVWx0cmFzY2llbmNlIiwKICAgICAgbG9jKCJSZXNlYXJjaCB0YWtlcyBvbmx5IDxiPjUgc2Vjb25kczwvYj4uIikgKyAiPHE+WUVBSCwgU0NJRU5DRSE8L3E+IiwKICAgICAgNywKICAgICAgWzksIDJdCiAgICApOyAvL2RlYnVnIHB1cnBvc2VzIG9ubHkKICAgIEdhbWUubGFzdC5wb29sID0gImRlYnVnIjsKCiAgICBvcmRlciA9IDEwMDIwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkVjbGlwc2UgY29va2llcyIsCiAgICAgIGRlc2M6ICJMb29rIHRvIHRoZSBjb29raWUuIiwKICAgICAgaWNvbjogWzAsIDRdLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlplYnJhIGNvb2tpZXMiLAogICAgICBkZXNjOiAiLi4uIiwKICAgICAgaWNvbjogWzEsIDRdLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OSwKICAgIH0pOwoKICAgIG9yZGVyID0gMTAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlF1aW50aWxsaW9uIGZpbmdlcnMiLAogICAgICBnZXRTdHJUaG91c2FuZEZpbmdlcnNHYWluKDIwKSArCiAgICAgICAgIjxxPm1hbiwganVzdCBnbyBjbGljayBjbGljayBjbGljayBjbGljayBjbGljaywgaXQncyByZWFsIGVhc3ksIG1hbi48L3E+IiwKICAgICAgMTAwMDAwMDAwMDAwMDAsCiAgICAgIFswLCAxOF0KICAgICk7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCA5LCAwKTsKCiAgICBvcmRlciA9IDQwMDAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkdvbGQgaG9hcmQiLAogICAgICBsb2MoIkdvbGRlbiBjb29raWVzIGFwcGVhciA8Yj5yZWFsbHkgb2Z0ZW48L2I+LiIpICsKICAgICAgICAiPHE+VGhhdCdzIGVudGlyZWx5IHRvbyBtYW55LjwvcT4iLAogICAgICA3LAogICAgICBbMTAsIDE0XQogICAgKTsgLy9kZWJ1ZyBwdXJwb3NlcyBvbmx5CiAgICBHYW1lLmxhc3QucG9vbCA9ICJkZWJ1ZyI7CgogICAgb3JkZXIgPSAxNTAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJFbGRlciBDb3ZlbmFudCIsCiAgICAgIGxvYygKICAgICAgICAiUHV0cyBhIHBlcm1hbmVudCBlbmQgdG8gdGhlIGVsZGVycycgd3JhdGgsIGF0IHRoZSBjb3N0IG9mICUxJSBvZiB5b3VyIENwUy4iLAogICAgICAgIDUKICAgICAgKSArCiAgICAgICAgIjxxPlRoaXMgaXMgYSBjb21wbGljYXRlZCByaXR1YWwgaW52b2x2aW5nIHNpbGx5LCBpbmNvbnNlcXVlbnRpYWwgdHJpdmlhbGl0aWVzIHN1Y2ggYXMgY3Vyc2VkIGxheGF0aXZlcywgY2VudHVyeS1vbGQgY2FjYW8sIGFuZCBhbiBpbmZhbnQuPGJyPkRvbid0IHF1ZXN0aW9uIGl0LjwvcT4iLAogICAgICA2NjY2NjY2NjY2NjY2NiwKICAgICAgWzgsIDldLAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5wbGVkZ2VUID0gMDsKICAgICAgICBHYW1lLkxvY2soIlJldm9rZSBFbGRlciBDb3ZlbmFudCIpOwogICAgICAgIEdhbWUuVW5sb2NrKCJSZXZva2UgRWxkZXIgQ292ZW5hbnQiKTsKICAgICAgICBHYW1lLkxvY2soIkVsZGVyIFBsZWRnZSIpOwogICAgICAgIEdhbWUuV2luKCJFbGRlciBjYWxtIik7CiAgICAgICAgR2FtZS5Db2xsZWN0V3JpbmtsZXJzKCk7CiAgICAgICAgR2FtZS5zdG9yZVRvUmVmcmVzaCA9IDE7CiAgICAgIH0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJ0b2dnbGUiOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJSZXZva2UgRWxkZXIgQ292ZW5hbnQiLAogICAgICBsb2MoCiAgICAgICAgIllvdSB3aWxsIGdldCAlMSUgb2YgeW91ciBDcFMgYmFjaywgYnV0IHRoZSBncmFuZG1hdHJpYXJjaHMgd2lsbCByZXR1cm4uIiwKICAgICAgICA1CiAgICAgICkgKyAiPHE+d2U8YnI+cmlzZTxicj5hZ2FpbjwvcT4iLAogICAgICA2NjY2NjY2NjY2LAogICAgICBbOCwgOV0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLkxvY2soIkVsZGVyIENvdmVuYW50Iik7CiAgICAgICAgR2FtZS5VbmxvY2soIkVsZGVyIENvdmVuYW50Iik7CiAgICAgIH0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJ0b2dnbGUiOwoKICAgIG9yZGVyID0gNTAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJHZXQgbHVja3kiLAogICAgICBsb2MoIkdvbGRlbiBjb29raWUgZWZmZWN0cyBsYXN0IDxiPnR3aWNlIGFzIGxvbmc8L2I+LiIpICsKICAgICAgICAiPHE+WW91J3ZlIGJlZW4gdXAgYWxsIG5pZ2h0LCBoYXZlbid0IHlvdT88L3E+IiwKICAgICAgNzc3Nzc3Nzc3Nzc3NzcsCiAgICAgIFsyNywgNl0KICAgICk7CgogICAgb3JkZXIgPSAxNTAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTYWNyaWZpY2lhbCByb2xsaW5nIHBpbnMiLAogICAgICBsb2MoIkVsZGVyIHBsZWRnZXMgbGFzdCA8Yj50d2ljZTwvYj4gYXMgbG9uZy4iKSArCiAgICAgICAgIjxxPlRoZXNlIGFyZSBtb3N0bHkganVzdCBmb3Igc3ByZWFkaW5nIHRoZSBhbnRpLWFnaW5nIGNyZWFtLjxicj4oQW5kIGFjY2Vzc29yaWx5LCBzaG9ydGVuaW5nIHRoZSBjaGlja2VuJ3Mgc3VmZmVyaW5nLik8L3E+IiwKICAgICAgMjg4ODg4ODg4ODg4OCwKICAgICAgWzIsIDldCiAgICApOwoKICAgIG9yZGVyID0gMTAwMjA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiU25pY2tlcmRvb2RsZXMiLAogICAgICBkZXNjOiAiVHJ1ZSB0byB0aGVpciBuYW1lLiIsCiAgICAgIGljb246IFsyLCA0XSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiU3Ryb29wd2FmZWxzIiwKICAgICAgZGVzYzogIklmIGl0IGFpbid0IGR1dGNoLCBpdCBhaW4ndCBtdWNoLiIsCiAgICAgIGljb246IFszLCA0XSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiTWFjYXJvb25zIiwKICAgICAgZGVzYzogIk5vdCB0byBiZSBjb25mdXNlZCB3aXRoIG1hY2Fyb25zLjxicj5UaGVzZSBoYXZlIGNvY29udXQsIG9rYXk/IiwKICAgICAgaWNvbjogWzQsIDRdLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CgogICAgb3JkZXIgPSA0MDAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJOZXVyb21hbmN5IiwKICAgICAgbG9jKCJDYW4gdG9nZ2xlIHVwZ3JhZGVzIG9uIGFuZCBvZmYgYXQgd2lsbCBpbiB0aGUgc3RhdHMgbWVudS4iKSArCiAgICAgICAgIjxxPkNhbiBhbHNvIGNvbWUgaW4gaGFuZHkgdG8gdW5zZWUgdGhpbmdzIHRoYXQgY2FuJ3QgYmUgdW5zZWVuLjwvcT4iLAogICAgICA3LAogICAgICBbNCwgOV0KICAgICk7IC8vZGVidWcgcHVycG9zZXMgb25seQogICAgR2FtZS5sYXN0LnBvb2wgPSAiZGVidWciOwoKICAgIG9yZGVyID0gMTAwMjA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiRW1waXJlIGJpc2N1aXRzIiwKICAgICAgZGVzYzogIkZvciB5b3VyIGdyb3dpbmcgY29va2llIGVtcGlyZSwgb2YgY291cnNlISIsCiAgICAgIGljb246IFs1LCA0XSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgb3JkZXIgPSAxMDAzMTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJCcml0aXNoIHRlYSBiaXNjdWl0cyIsCiAgICAgIGRlc2M6ICJRdWl0ZS4iLAogICAgICBpY29uOiBbNiwgNF0sCiAgICAgIHJlcXVpcmU6ICJUaW4gb2YgYnJpdGlzaCB0ZWEgYmlzY3VpdHMiLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQ2hvY29sYXRlIGJyaXRpc2ggdGVhIGJpc2N1aXRzIiwKICAgICAgZGVzYzogIlllcywgcXVpdGUuIiwKICAgICAgaWNvbjogWzcsIDRdLAogICAgICByZXF1aXJlOiBHYW1lLmxhc3QubmFtZSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlJvdW5kIGJyaXRpc2ggdGVhIGJpc2N1aXRzIiwKICAgICAgZGVzYzogIlllcywgcXVpdGUgcml2ZXRpbmcuIiwKICAgICAgaWNvbjogWzgsIDRdLAogICAgICByZXF1aXJlOiBHYW1lLmxhc3QubmFtZSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlJvdW5kIGNob2NvbGF0ZSBicml0aXNoIHRlYSBiaXNjdWl0cyIsCiAgICAgIGRlc2M6ICJZZXMsIHF1aXRlIHJpdmV0aW5nIGluZGVlZC4iLAogICAgICBpY29uOiBbOSwgNF0sCiAgICAgIHJlcXVpcmU6IEdhbWUubGFzdC5uYW1lLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiUm91bmQgYnJpdGlzaCB0ZWEgYmlzY3VpdHMgd2l0aCBoZWFydCBtb3RpZiIsCiAgICAgIGRlc2M6ICJZZXMsIHF1aXRlIHJpdmV0aW5nIGluZGVlZCwgb2xkIGNoYXAuIiwKICAgICAgaWNvbjogWzEwLCA0XSwKICAgICAgcmVxdWlyZTogR2FtZS5sYXN0Lm5hbWUsCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJSb3VuZCBjaG9jb2xhdGUgYnJpdGlzaCB0ZWEgYmlzY3VpdHMgd2l0aCBoZWFydCBtb3RpZiIsCiAgICAgIGRlc2M6ICJJIGxpa2UgY29va2llcy4iLAogICAgICBpY29uOiBbMTEsIDRdLAogICAgICByZXF1aXJlOiBHYW1lLmxhc3QubmFtZSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwoKICAgIG9yZGVyID0gMTAwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlN1Z2FyIGJvc29ucyIsCiAgICAgICI8cT5Td2VldCBmaXJtIGJvc29ucy48L3E+IiwKICAgICAgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwKICAgICAgMQogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlN0cmluZyB0aGVvcnkiLAogICAgICAiPHE+UmV2ZWFscyBuZXcgaW5zaWdodCBhYm91dCB0aGUgdHJ1ZSBtZWFuaW5nIG9mIGJha2luZyBjb29raWVzIChhbmQsIGFzIGEgYm9udXMsIHRoZSBzdHJ1Y3R1cmUgb2YgdGhlIHVuaXZlcnNlKS48L3E+IiwKICAgICAgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwKICAgICAgMgogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkxhcmdlIG1hY2Fyb24gY29sbGlkZXIiLAogICAgICAiPHE+SG93IHNpbmd1bGFyITwvcT4iLAogICAgICAiQW50aW1hdHRlciBjb25kZW5zZXIiLAogICAgICAzCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQmlnIGJhbmcgYmFrZSIsCiAgICAgICI8cT5BbmQgdGhhdCdzIGhvdyBpdCBhbGwgYmVnYW4uPC9xPiIsCiAgICAgICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsCiAgICAgIDQKICAgICk7CgogICAgb3JkZXIgPSAyNTU7CiAgICBHYW1lLkdyYW5kbWFTeW5lcmd5KAogICAgICAiQW50aWdyYW5kbWFzIiwKICAgICAgIkEgbWVhbiBhbnRpZ3JhbmRtYSB0byB2b21pdCBtb3JlIGNvb2tpZXMuIiwKICAgICAgIkFudGltYXR0ZXIgY29uZGVuc2VyIgogICAgKTsKCiAgICBvcmRlciA9IDEwMDIwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIk1hZGVsZWluZXMiLAogICAgICBkZXNjOiAiVW5mb3JnZXR0YWJsZSEiLAogICAgICBpY29uOiBbMTIsIDNdLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlBhbG1pZXJzIiwKICAgICAgZGVzYzogIlBhbG1pZXIgdGhhbiB5b3UhIiwKICAgICAgaWNvbjogWzEzLCAzXSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OSAqIDUsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJQYWxldHMiLAogICAgICBkZXNjOiAiWW91IGNvdWxkIHByb2JhYmx5IHBsYXkgaG9ja2V5IHdpdGggdGhlc2UuPGJyPkkgbWVhbiwgeW91J3JlIHdlbGNvbWUgdG8gdHJ5LiIsCiAgICAgIGljb246IFsxMiwgNF0sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiU2FibCZlYWN1dGU7cyIsCiAgICAgIGRlc2M6ICJUaGUgbmFtZSBpbXBsaWVzIHRoZXkncmUgbWFkZSBvZiBzYW5kLiBCdXQgeW91IGtub3cgYmV0dGVyLCBkb24ndCB5b3U/IiwKICAgICAgaWNvbjogWzEzLCA0XSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKCiAgICBvcmRlciA9IDIwMDAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIktpdHRlbiBvdmVyc2VlcnMiLAogICAgICBzdHJLaXR0ZW5EZXNjICsgIjxxPm15IHB1cnJwb3NlIGlzIHRvIHNlcnZlIHlvdSwgc2lyPC9xPiIsCiAgICAgIDkwMDAwMDAwMDAwMDAwMDAwLAogICAgICBHYW1lLkdldEljb24oIktpdHRlbiIsIDQpCiAgICApOwogICAgR2FtZS5sYXN0LmtpdHRlbiA9IDE7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCA0LCAxOCk7CgogICAgb3JkZXIgPSAxMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiU2V4dGlsbGlvbiBmaW5nZXJzIiwKICAgICAgZ2V0U3RyVGhvdXNhbmRGaW5nZXJzR2FpbigyMCkgKwogICAgICAgICI8cT5zb21ldGltZXM8YnI+dGhpbmdzIGp1c3Q8YnI+Y2xpY2s8L3E+IiwKICAgICAgMTAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIFswLCAxOV0KICAgICk7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCAxMCwgMCk7CgogICAgb3JkZXIgPSAyMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJEb3VibGUtdGhpY2sgZ2xhc3NlcyIsCiAgICAgICI8cT5PaC4uLiBzbyBUSEFUJ3Mgd2hhdCBJJ3ZlIGJlZW4gYmFraW5nLjwvcT4iLAogICAgICAiR3JhbmRtYSIsCiAgICAgIDUKICAgICk7CiAgICBvcmRlciA9IDMwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkdpbmdlcmJyZWFkIHNjYXJlY3Jvd3MiLAogICAgICAiPHE+U3RhcmluZyBhdCB5b3VyIGNyb3BzIHdpdGggbWlzY2hpZXZvdXMgZ2xlZS48L3E+IiwKICAgICAgIkZhcm0iLAogICAgICA1CiAgICApOwogICAgb3JkZXIgPSA1MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJSZWNvbWJvYnVsYXRvcnMiLAogICAgICAiPHE+QSBtYWpvciBwYXJ0IG9mIGNvb2tpZSByZWNvbWJvYnVsYXRpb24uPC9xPiIsCiAgICAgICJGYWN0b3J5IiwKICAgICAgNQogICAgKTsKICAgIG9yZGVyID0gNDAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiSC1ib21iIG1pbmluZyIsCiAgICAgICI8cT5RdWVzdGlvbmFibGUgZWZmaWNpZW5jeSwgYnV0IHNwZWN0YWN1bGFyIG5vbmV0aGVsZXNzLjwvcT4iLAogICAgICAiTWluZSIsCiAgICAgIDUKICAgICk7CiAgICBvcmRlciA9IDYwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkNob2NvbGF0ZSBtb25vbGl0aHMiLAogICAgICAiPHE+TXkgZ29kLiBJdCdzIGZ1bGwgb2YgY2hvY29sYXRlIGJhcnMuPC9xPiIsCiAgICAgICJTaGlwbWVudCIsCiAgICAgIDUKICAgICk7CiAgICBvcmRlciA9IDcwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkFxdWEgY3J1c3R1bGFlIiwKICAgICAgIjxxPkNhcmVmdWwgd2l0aCB0aGUgZG9zaW5nIC0gb25lIGRyb3AgdG9vIG11Y2ggYW5kIHlvdSBnZXQgbXVmZmlucy48YnI+QW5kIG5vYm9keSBsaWtlcyBtdWZmaW5zLjwvcT4iLAogICAgICAiQWxjaGVteSBsYWIiLAogICAgICA1CiAgICApOwogICAgb3JkZXIgPSA4MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJCcmFuZSB0cmFuc3BsYW50IiwKICAgICAgJzxxPlRoaXMgcmVmZXJzIHRvIHRoZSBwcmFjdGljZSBvZiBtZXJnaW5nIGhpZ2hlciBkaW1lbnNpb25hbCB1bml2ZXJzZXMsIG9yICJicmFuZXMiLCB3aXRoIG91ciBvd24sIGluIG9yZGVyIHRvIGZhY2lsaXRhdGUgdHJhbnNpdCAoYW5kIGhhcnZlc3Rpbmcgb2YgcHJlY2lvdXMgY29va2llIGRvdWdoKS48L3E+JywKICAgICAgIlBvcnRhbCIsCiAgICAgIDUKICAgICk7CiAgICBvcmRlciA9IDkwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlllc3Rlcm1vcnJvdyBjb21wYXJhdG9ycyIsCiAgICAgICI8cT5Gb3J0bmlnaHRzIGludG8gbWlsbGVubmlhLjwvcT4iLAogICAgICAiVGltZSBtYWNoaW5lIiwKICAgICAgNQogICAgKTsKICAgIG9yZGVyID0gMTAwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlJldmVyc2UgY3ljbG90cm9ucyIsCiAgICAgICI8cT5UaGVzZSBjYW4gdW5jb2xsaXNpb24gcGFydGljbGVzIGFuZCB1bnNwaW4gYXRvbXMuIEZvci4uLiB1aC4uLiBiZXR0ZXIgZmxhdm9yLCBhbmQgc3R1ZmYuPC9xPiIsCiAgICAgICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsCiAgICAgIDUKICAgICk7CgogICAgb3JkZXIgPSAxNTA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiVW5vYnRhaW5pdW0gbW91c2UiLAogICAgICBnZXRTdHJDbGlja2luZ0dhaW5zKDEpICsgIjxxPlRoZXNlIG5pY2UgbWljZSBzaG91bGQgc3VmZmljZS48L3E+IiwKICAgICAgNTAwMDAwMDAwMDAwMCwKICAgICAgWzExLCAxNF0KICAgICk7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCA1LCAxMSk7CgogICAgb3JkZXIgPSAxMDAzMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJDYXJhbW9hcyIsCiAgICAgIGRlc2M6ICJZZWFoLiBUaGF0J3MgZ290IGEgbmljZSByaW5nIHRvIGl0LiIsCiAgICAgIGljb246IFsxNCwgNF0sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgYnJhbmQgYmlzY3VpdHMiLAogICAgICBwb3dlcjogMywKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJTYWdhbG9uZ3MiLAogICAgICBkZXNjOiAiR3JhbmRtYSdzIGZhdm9yaXRlPyIsCiAgICAgIGljb246IFsxNSwgM10sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgYnJhbmQgYmlzY3VpdHMiLAogICAgICBwb3dlcjogMywKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJTaG9ydGZvaWxzIiwKICAgICAgZGVzYzogIkZvaWxlZCBhZ2FpbiEiLAogICAgICBpY29uOiBbMTUsIDRdLAogICAgICByZXF1aXJlOiAiQm94IG9mIGJyYW5kIGJpc2N1aXRzIiwKICAgICAgcG93ZXI6IDMsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiV2luIG1pbnRzIiwKICAgICAgZGVzYzogIlRoZXkncmUgdGhlIGx1Y2tpZXN0IGNvb2tpZXMgeW91J3ZlIGV2ZXIgdGFzdGVkISIsCiAgICAgIGljb246IFsxNCwgM10sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgYnJhbmQgYmlzY3VpdHMiLAogICAgICBwb3dlcjogMywKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKCiAgICBvcmRlciA9IDQwMDAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlBlcmZlY3QgaWRsaW5nIiwKICAgICAgbG9jKCJZb3Uga2VlcCBwcm9kdWNpbmcgY29va2llcyBldmVuIHdoaWxlIHRoZSBnYW1lIGlzIGNsb3NlZC4iKSArCiAgICAgICAgIjxxPkl0J3MgdGhlIG1vc3QgYmVhdXRpZnVsIHRoaW5nIEkndmUgZXZlciBzZWVuLjwvcT4iLAogICAgICA3LAogICAgICBbMTAsIDBdCiAgICApOyAvL2RlYnVnIHB1cnBvc2VzIG9ubHkKICAgIEdhbWUubGFzdC5wb29sID0gImRlYnVnIjsKCiAgICBvcmRlciA9IDEwMDMwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkZpZyBnbHV0dG9ucyIsCiAgICAgIGRlc2M6ICJHb3QgaXQgYWxsIGZpZ3VyZWQgb3V0LiIsCiAgICAgIGljb246IFsxNywgNF0sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgYnJhbmQgYmlzY3VpdHMiLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OSAqIDUsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJMb3Jlb2xzIiwKICAgICAgZGVzYzogIkJlY2F1c2UsIHVoLi4uIHRoZXkncmUgd29ydGggaXQ/IiwKICAgICAgaWNvbjogWzE2LCAzXSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBicmFuZCBiaXNjdWl0cyIsCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkphZmZhIGNha2VzIiwKICAgICAgZGVzYzogIklmIHlvdSB3YW50IHRvIGJha2UgYSBjb29raWUgZnJvbSBzY3JhdGNoLCB5b3UgbXVzdCBmaXJzdCBidWlsZCBhIGZhY3RvcnkuIiwKICAgICAgaWNvbjogWzE3LCAzXSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBicmFuZCBiaXNjdWl0cyIsCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkdyZWFzZSdzIGN1cHMiLAogICAgICBkZXNjOiAiRXh0cmEtZ3JlYXN5IHBlYW51dCBidXR0ZXIuIiwKICAgICAgaWNvbjogWzE2LCA0XSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBicmFuZCBiaXNjdWl0cyIsCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwoKICAgIG9yZGVyID0gMzAwMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiSGVhdmVubHkgY2hpcCBzZWNyZXQiLAogICAgICBsb2MoIlVubG9ja3MgPGI+JTElPC9iPiBvZiB0aGUgcG90ZW50aWFsIG9mIHlvdXIgcHJlc3RpZ2UgbGV2ZWwuIiwgNSkgKwogICAgICAgICI8cT5HcmFudHMgdGhlIGtub3dsZWRnZSBvZiBoZWF2ZW5seSBjaGlwcywgYW5kIGhvdyB0byB1c2UgdGhlbSB0byBtYWtlIGJha2luZyBtb3JlIGVmZmljaWVudC48YnI+SXQncyBhIHNlY3JldCB0byBldmVyeW9uZS48L3E+IiwKICAgICAgMTEsCiAgICAgIFsxOSwgN10KICAgICk7CiAgICBHYW1lLmxhc3Qubm9QZXJtID0gMTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJIZWF2ZW5seSBjb29raWUgc3RhbmQiLAogICAgICBsb2MoIlVubG9ja3MgPGI+JTElPC9iPiBvZiB0aGUgcG90ZW50aWFsIG9mIHlvdXIgcHJlc3RpZ2UgbGV2ZWwuIiwgMjUpICsKICAgICAgICAiPHE+RG9uJ3QgZm9yZ2V0IHRvIHZpc2l0IHRoZSBoZWF2ZW5seSBsZW1vbmFkZSBzdGFuZCBhZnRlcndhcmRzLiBXaGVuIGFmdGVybGlmZSBnaXZlcyB5b3UgbGVtb25zLi4uPC9xPiIsCiAgICAgIDExMTEsCiAgICAgIFsxOCwgN10KICAgICk7CiAgICBHYW1lLmxhc3Qubm9QZXJtID0gMTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJIZWF2ZW5seSBiYWtlcnkiLAogICAgICBsb2MoIlVubG9ja3MgPGI+JTElPC9iPiBvZiB0aGUgcG90ZW50aWFsIG9mIHlvdXIgcHJlc3RpZ2UgbGV2ZWwuIiwgNTApICsKICAgICAgICAiPHE+QWxzbyBzZWxscyBnb2RseSBjYWtlcyBhbmQgZGl2aW5lIHBhc3RyaWVzLiBUaGUgcHJldHplbHMgYXJlbid0IHRvbyBiYWQgZWl0aGVyLjwvcT4iLAogICAgICAxMTExMTEsCiAgICAgIFsxNywgN10KICAgICk7CiAgICBHYW1lLmxhc3Qubm9QZXJtID0gMTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJIZWF2ZW5seSBjb25mZWN0aW9uZXJ5IiwKICAgICAgbG9jKCJVbmxvY2tzIDxiPiUxJTwvYj4gb2YgdGhlIHBvdGVudGlhbCBvZiB5b3VyIHByZXN0aWdlIGxldmVsLiIsIDc1KSArCiAgICAgICAgIjxxPlRoZXkgc2F5IGFuZ2VsIGJha2VycyB3b3JrIHRoZXJlLiBUaGV5IHRha2UgYW5nZWwgbHVuY2ggYnJlYWtzIGFuZCBzb21ldGltZXMgZ28gb24gYW5nZWwgc3RyaWtlcy48L3E+IiwKICAgICAgMTExMTExMTEsCiAgICAgIFsxNiwgN10KICAgICk7CiAgICBHYW1lLmxhc3Qubm9QZXJtID0gMTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJIZWF2ZW5seSBrZXkiLAogICAgICBsb2MoIlVubG9ja3MgPGI+JTElPC9iPiBvZiB0aGUgcG90ZW50aWFsIG9mIHlvdXIgcHJlc3RpZ2UgbGV2ZWwuIiwgMTAwKSArCiAgICAgICAgIjxxPlRoaXMgaXMgdGhlIGtleSB0byB0aGUgcGVhcmx5IChhbmQgdGFzdHkpIGdhdGVzIG9mIHBhc3RyeSBoZWF2ZW4sIGdyYW50aW5nIHlvdSBhY2Nlc3MgdG8geW91ciBlbnRpcmUgc3RvY2twaWxlIG9mIGhlYXZlbmx5IGNoaXBzIGZvciBiYWtpbmcgcHVycG9zZXMuPGJyPk1heSB5b3UgdXNlIHRoZW0gd2lzZWx5LjwvcT4iLAogICAgICAxMTExMTExMTExLAogICAgICBbMTUsIDddCiAgICApOwogICAgR2FtZS5sYXN0Lm5vUGVybSA9IDE7CgogICAgb3JkZXIgPSAxMDEwMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJTa3VsbCBjb29raWVzIiwKICAgICAgZGVzYzogIldhbm5hIGtub3cgc29tZXRoaW5nIHNwb29reT8gWW91J3ZlIGdvdCBvbmUgb2YgdGhlc2UgaW5zaWRlIHlvdXIgaGVhZCBSSUdIVCBOT1cuIiwKICAgICAgbG9ja2VkOiAxLAogICAgICBpY29uOiBbMTIsIDhdLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDQ0NDQ0NDQ0NDQ0NCwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkdob3N0IGNvb2tpZXMiLAogICAgICBkZXNjOiAiVGhleSdyZSBzb21ldGhpbmcgc3RyYW5nZSwgYnV0IHRoZXkgbG9vayBwcmV0dHkgZ29vZCEiLAogICAgICBsb2NrZWQ6IDEsCiAgICAgIGljb246IFsxMywgOF0sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogNDQ0NDQ0NDQ0NDQ0LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQmF0IGNvb2tpZXMiLAogICAgICBkZXNjOiAiVGhlIGNvb2tpZXMgdGhpcyB0b3duIGRlc2VydmVzLiIsCiAgICAgIGxvY2tlZDogMSwKICAgICAgaWNvbjogWzE0LCA4XSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA0NDQ0NDQ0NDQ0NDQsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJTbGltZSBjb29raWVzIiwKICAgICAgZGVzYzogIlRoZSBpbmNyZWRpYmxlIG1lbHRpbmcgY29va2llcyEiLAogICAgICBsb2NrZWQ6IDEsCiAgICAgIGljb246IFsxNSwgOF0sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogNDQ0NDQ0NDQ0NDQ0LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiUHVtcGtpbiBjb29raWVzIiwKICAgICAgZGVzYzogIk5vdCBldmVuIHB1bXBraW4tZmxhdm9yZWQuIFRhc3RlcyBsaWtlIGdsYXppbmcuIFlldWdoLiIsCiAgICAgIGxvY2tlZDogMSwKICAgICAgaWNvbjogWzE2LCA4XSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA0NDQ0NDQ0NDQ0NDQsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJFeWViYWxsIGNvb2tpZXMiLAogICAgICBkZXNjOiAiV2hlbiB5b3Ugc3RhcmUgaW50byB0aGUgY29va2llLCB0aGUgY29va2llIHN0YXJlcyBiYWNrIGF0IHlvdS4iLAogICAgICBsb2NrZWQ6IDEsCiAgICAgIGljb246IFsxNywgOF0sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogNDQ0NDQ0NDQ0NDQ0LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiU3BpZGVyIGNvb2tpZXMiLAogICAgICBkZXNjOiAiWW91IGZvdW5kIHRoZSByZWNpcGUgb24gdGhlIHdlYi4gVGhleSBkbyB3aGF0ZXZlciBhIGNvb2tpZSBjYW4uIiwKICAgICAgbG9ja2VkOiAxLAogICAgICBpY29uOiBbMTgsIDhdLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDQ0NDQ0NDQ0NDQ0NCwKICAgIH0pOwoKICAgIEdhbWUuaGFsbG93ZWVuRHJvcHMgPSBbCiAgICAgICJTa3VsbCBjb29raWVzIiwKICAgICAgIkdob3N0IGNvb2tpZXMiLAogICAgICAiQmF0IGNvb2tpZXMiLAogICAgICAiU2xpbWUgY29va2llcyIsCiAgICAgICJQdW1wa2luIGNvb2tpZXMiLAogICAgICAiRXllYmFsbCBjb29raWVzIiwKICAgICAgIlNwaWRlciBjb29raWVzIiwKICAgIF07CgogICAgR2FtZS5HZXRIb3dNYW55SGFsbG93ZWVuRHJvcHMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBudW0gPSAwOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUuaGFsbG93ZWVuRHJvcHMpIHsKICAgICAgICBpZiAoR2FtZS5IYXMoR2FtZS5oYWxsb3dlZW5Ecm9wc1tpXSkpIG51bSsrOwogICAgICB9CiAgICAgIHJldHVybiBudW07CiAgICB9OwogICAgLypmb3IgKHZhciBpIGluIEdhbWUuaGFsbG93ZWVuRHJvcHMpCgkJewoJCQlHYW1lLlVwZ3JhZGVzW0dhbWUuaGFsbG93ZWVuRHJvcHNbaV1dLmRlc2NGdW5jPWZ1bmN0aW9uKCl7cmV0dXJuICc8ZGl2IHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsiPllvdSBjdXJyZW50bHkgb3duIDxiPicrR2FtZS5HZXRIb3dNYW55SGFsbG93ZWVuRHJvcHMoKSsnLycrR2FtZS5oYWxsb3dlZW5Ecm9wcy5sZW5ndGgrJzwvYj4gaGFsbG93ZWVuIGNvb2tpZXMuPC9kaXY+PGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+Jyt0aGlzLmRkZXNjO307CgkJfSovCgogICAgb3JkZXIgPSAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlBlcnNpc3RlbnQgbWVtb3J5IiwKICAgICAgbG9jKCJTdWJzZXF1ZW50IHJlc2VhcmNoIHdpbGwgYmUgPGI+JTEgdGltZXM8L2I+IGFzIGZhc3QuIiwgMTApICsKICAgICAgICAiPHE+SXQncyBhbGwgbWFraW5nIHNlbnNlITxicj5BZ2FpbiE8L3E+IiwKICAgICAgNTAwLAogICAgICBbOSwgMl0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CgogICAgb3JkZXIgPSA0MDAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJXcmlua2xlciBkb29ybWF0IiwKICAgICAgbG9jKCJXcmlua2xlcnMgc3Bhd24gbXVjaCBtb3JlIGZyZXF1ZW50bHkuIikgKwogICAgICAgICI8cT5Zb3UncmUgc3VjaCBhIHB1c2hvdmVyLjwvcT4iLAogICAgICA3LAogICAgICBbMTksIDhdCiAgICApOyAvL2RlYnVnIHB1cnBvc2VzIG9ubHkKICAgIEdhbWUubGFzdC5wb29sID0gImRlYnVnIjsKCiAgICBvcmRlciA9IDEwMjAwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkNocmlzdG1hcyB0cmVlIGJpc2N1aXRzIiwKICAgICAgZGVzYzogIldob3NlIHBpbmUgaXMgaXQgYW55d2F5PyIsCiAgICAgIGxvY2tlZDogMSwKICAgICAgaWNvbjogWzEyLCAxMF0sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogMjUyNTI1MjUyNTI1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiU25vd2ZsYWtlIGJpc2N1aXRzIiwKICAgICAgZGVzYzogIk1hc3MtcHJvZHVjZWQgdG8gYmUgdW5pcXVlIGluIGV2ZXJ5IHdheS4iLAogICAgICBsb2NrZWQ6IDEsCiAgICAgIGljb246IFsxMywgMTBdLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDI1MjUyNTI1MjUyNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlNub3dtYW4gYmlzY3VpdHMiLAogICAgICBkZXNjOiAiSXQncyBmcm9zdGVkLiBEb3VibHkgc28uIiwKICAgICAgbG9ja2VkOiAxLAogICAgICBpY29uOiBbMTQsIDEwXSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiAyNTI1MjUyNTI1MjUsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJIb2xseSBiaXNjdWl0cyIsCiAgICAgIGRlc2M6ICJZb3UgZG9uJ3Qgc21vb2NoIHVuZGVyIHRoZXNlIG9uZXMuIFRoYXQgd291bGQgYmUgdGhlIG1pc3RsZXRvZSAod2hpY2gsIGJvdGFuaWNhbGx5LCBpcyBhIHNtZWxsaWVyIHZhcmlhbnQgb2YgdGhlIG1pc3RsZWZpbmdlcikuIiwKICAgICAgbG9ja2VkOiAxLAogICAgICBpY29uOiBbMTUsIDEwXSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiAyNTI1MjUyNTI1MjUsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJDYW5keSBjYW5lIGJpc2N1aXRzIiwKICAgICAgZGVzYzogIkl0J3MgdHdvIHRyZWF0cyBpbiBvbmUhPGJyPihGdXJ0aGVyIGluc3BlY3Rpb24gcmV2ZWFscyB0aGUgZnJvc3RpbmcgZG9lcyBub3QgYWN0dWFsbHkgdGFzdGUgbGlrZSBwZXBwZXJtaW50LCBidXQgbGlrZSBtdW5kYW5lIHN1Z2FyeSBmcm9zdGluZy4pIiwKICAgICAgbG9ja2VkOiAxLAogICAgICBpY29uOiBbMTYsIDEwXSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiAyNTI1MjUyNTI1MjUsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJCZWxsIGJpc2N1aXRzIiwKICAgICAgZGVzYzogIldoYXQgZG8gdGhlc2UgZXZlbiBoYXZlIHRvIGRvIHdpdGggY2hyaXN0bWFzPyBXaG8gY2FyZXMsIHJpbmcgdGhlbSBpbiEiLAogICAgICBsb2NrZWQ6IDEsCiAgICAgIGljb246IFsxNywgMTBdLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDI1MjUyNTI1MjUyNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlByZXNlbnQgYmlzY3VpdHMiLAogICAgICBkZXNjOiAiVGhlIHByZXF1ZWwgdG8gZnV0dXJlIGJpc2N1aXRzLiBXYXRjaCBvdXQhIiwKICAgICAgbG9ja2VkOiAxLAogICAgICBpY29uOiBbMTgsIDEwXSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiAyNTI1MjUyNTI1MjUsCiAgICB9KTsKCiAgICBvcmRlciA9IDEwMDIwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkdpbmdlcmJyZWFkIG1lbiIsCiAgICAgIGRlc2M6ICJZb3UgbGlrZSB0byBiaXRlIHRoZSBsZWdzIG9mZiBmaXJzdCwgcmlnaHQ/IEhvdyBhYm91dCB0ZWFyaW5nIG9mZiB0aGUgYXJtcz8gWW91IHNpY2sgbW9uc3Rlci4iLAogICAgICBpY29uOiBbMTgsIDRdLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJHaW5nZXJicmVhZCB0cmVlcyIsCiAgICAgIGRlc2M6ICJFdmVyZ3JlZW5zIGluIHBhc3RyeSBmb3JtLiBZdWxlIGJlIHN1cnByaXNlZCB3aGF0IHlvdSBjYW4gY29tZSB1cCB3aXRoLiIsCiAgICAgIGljb246IFsxOCwgM10sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwoKICAgIG9yZGVyID0gMjUwMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQSBmZXN0aXZlIGhhdCIsCiAgICAgICI8Yj4iICsKICAgICAgICBsb2MoIlVubG9ja3MuLi4gc29tZXRoaW5nLiIpICsKICAgICAgICAiPC9iPjxxPk5vdCBhIGNyZWF0dXJlIHdhcyBzdGlycmluZywgbm90IGV2ZW4gYSBtb3VzZS48L3E+IiwKICAgICAgMjUsCiAgICAgIFsxOSwgOV0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgZHJvcCA9IGNob29zZShHYW1lLnNhbnRhRHJvcHMpOwogICAgICAgIEdhbWUuVW5sb2NrKGRyb3ApOwogICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgbG9jKCJJbiB0aGUgZmVzdGl2ZSBoYXQsIHlvdSBmaW5kLi4uIiksCiAgICAgICAgICBsb2MoImEgZmVzdGl2ZSB0ZXN0IHR1YmU8YnI+YW5kIDxiPiUxPC9iPi4iLCBkcm9wKSwKICAgICAgICAgIEdhbWUuVXBncmFkZXNbZHJvcF0uaWNvbgogICAgICAgICk7CiAgICAgIH0KICAgICk7CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkluY3JlYXNlZCBtZXJyaW5lc3MiLAogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMTUpICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBTYW50YSBsZXZlbC4iKSArCiAgICAgICAgIjxxPkl0IHR1cm5zIG91dCB0aGF0IHRoZSBrZXkgdG8gaW5jcmVhc2VkIG1lcnJpbmVzcywgc3RyYW5nZWx5IGVub3VnaCwgaGFwcGVucyB0byBiZSBhIGdvb2QgY2FtcGZpcmUgYW5kIHNvbWUgcydtb3Jlcy48YnI+WW91IGtub3cgd2hhdCB0aGV5IHNheSwgYWZ0ZXIgYWxsOyB0aGUgcydtb3JlLCB0aGUgbWVycmllci48L3E+IiwKICAgICAgMjUyNSwKICAgICAgWzE3LCA5XQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJJbXByb3ZlZCBqb2xsaW5lc3MiLAogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMTUpICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBTYW50YSBsZXZlbC4iKSArCiAgICAgICAgIjxxPkEgbmljZSB3b2JibHkgYmVsbHkgZ29lcyBhIGxvbmcgd2F5Ljxicj5Zb3Ugam9sbHk/PC9xPiIsCiAgICAgIDI1MjUsCiAgICAgIFsxNywgOV0KICAgICk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQSBsdW1wIG9mIGNvYWwiLAogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMSkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIFNhbnRhIGxldmVsLiIpICsKICAgICAgICAiPHE+U29tZSBvZiB0aGUgd29ybGQncyB3b3JzdCBzdG9ja2luZyBzdHVmZmluZy48YnI+SSBndWVzcyB5b3UgY291bGQgdHJ5IHN0YXJ0aW5nIHlvdXIgb3duIGxpdHRsZSBpbmR1c3RyaWFsIHJldm9sdXRpb24sIG9yIHNvbWV0aGluZz8uLi48L3E+IiwKICAgICAgMjUyNSwKICAgICAgWzEzLCA5XQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJBbiBpdGNoeSBzd2VhdGVyIiwKICAgICAgZ2V0U3RyQ29va2llUHJvZHVjdGlvbk11bHRpcGxpZXJQbHVzKDEpICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBTYW50YSBsZXZlbC4iKSArCiAgICAgICAgIjxxPllvdSBkb24ndCBrbm93IHdoYXQncyB3b3JzZSA6IHRoZSBlbWJhcnJhc3NpbmdseSBxdWFpbnQgXCJlbGYgb24gcmVpbmRlZXJcIiBtb3RpZiwgb3IgdGhlIGZhY3QgdGhhdCB3ZWFyaW5nIGl0IG1ha2VzIHlvdSBmZWVsIGxpa2UgeW91J3JlIHdyYXBwZWQgaW4gYSBkZWFkIHNhc3F1YXRjaC48L3E+IiwKICAgICAgMjUyNSwKICAgICAgWzE0LCA5XQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJSZWluZGVlciBiYWtpbmcgZ3JvdW5kcyIsCiAgICAgIGxvYygiUmVpbmRlZXIgYXBwZWFyIDxiPnR3aWNlIGFzIGZyZXF1ZW50bHk8L2I+LiIpICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBTYW50YSBsZXZlbC4iKSArCiAgICAgICAgIjxxPk1hbGUgcmVpbmRlZXIgYXJlIGZyb20gTWFyczsgZmVtYWxlIHJlaW5kZWVyIGFyZSBmcm9tIHZlbmlzb24uPC9xPiIsCiAgICAgIDI1MjUsCiAgICAgIFsxMiwgOV0KICAgICk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiV2VpZ2h0ZWQgc2xlaWdocyIsCiAgICAgIGxvYygiUmVpbmRlZXIgYXJlIDxiPnR3aWNlIGFzIHNsb3c8L2I+LiIpICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBTYW50YSBsZXZlbC4iKSArCiAgICAgICAgIjxxPkhvcGUgaXQgd2FzIHdvcnRoIHRoZSB3ZWlnaHQuPGJyPihTb21ldGhpbmcgc29tZXRoaW5nIGZvcmNlZCBpbnRvIGNlcnZpZHVkZSk8L3E+IiwKICAgICAgMjUyNSwKICAgICAgWzEyLCA5XQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJIbyBobyBoby1mbGF2b3JlZCBmcm9zdGluZyIsCiAgICAgIGxvYygiUmVpbmRlZXIgZ2l2ZSA8Yj50d2ljZSBhcyBtdWNoPC9iPi4iKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoIkNvc3Qgc2NhbGVzIHdpdGggU2FudGEgbGV2ZWwuIikgKwogICAgICAgICI8cT5JdCdzIHRpbWUgdG8gdXAgdGhlIGFudGxlci48L3E+IiwKICAgICAgMjUyNSwKICAgICAgWzEyLCA5XQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTZWFzb24gc2F2aW5ncyIsCiAgICAgIGxvYygiQWxsIGJ1aWxkaW5ncyBhcmUgPGI+JTElIGNoZWFwZXI8L2I+LiIsIDEpICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBTYW50YSBsZXZlbC4iKSArCiAgICAgICAgIjxxPkJ5IFNhbnRhJ3MgYmVhcmQsIHdoYXQgc2F2aW5ncyE8YnI+QnV0IHdobyB3aWxsIHNhdmUgdXM/PC9xPiIsCiAgICAgIDI1MjUsCiAgICAgIFsxNiwgOV0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLnN0b3JlVG9SZWZyZXNoID0gMTsKICAgICAgfQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJUb3kgd29ya3Nob3AiLAogICAgICBsb2MoIkFsbCB1cGdyYWRlcyBhcmUgPGI+JTElIGNoZWFwZXI8L2I+LiIsIDUpICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBTYW50YSBsZXZlbC4iKSArCiAgICAgICAgIjxxPldhdGNoIHlvdXJzLWVsZiBhcm91bmQgZWx2ZXNkcm9wcGVycyB3aG8gbWlnaHQgc3RlYWwgb3VyIHByb2R1Y3Rpb24gc2VjcmV0cy48YnI+T3IgZWx2ZW4gd29yc2UhPC9xPiIsCiAgICAgIDI1MjUsCiAgICAgIFsxNiwgOV0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkID0gMTsKICAgICAgfQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJOYXVnaHR5IGxpc3QiLAogICAgICBsb2MoIiUxIGFyZSA8Yj50d2ljZTwvYj4gYXMgZWZmaWNpZW50LiIsIGNhcChsb2MoImdyYW5kbWFzIikpKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoIkNvc3Qgc2NhbGVzIHdpdGggU2FudGEgbGV2ZWwuIikgKwogICAgICAgICI8cT5UaGlzIGxpc3QgY29udGFpbnMgZXZlcnkgdW5ob2x5IGRlZWQgcGVycGV0dWF0ZWQgYnkgZ3JhbmRtYWtpbmQuPGJyPkhlIHdvbid0IGJlIGNoZWNraW5nIHRoaXMgb25lIHR3aWNlLjxicj5PbmNlLiBPbmNlIGlzIGVub3VnaC48L3E+IiwKICAgICAgMjUyNSwKICAgICAgWzE1LCA5XQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTYW50YSdzIGJvdHRvbWxlc3MgYmFnIiwKICAgICAgbG9jKCJSYW5kb20gZHJvcHMgYXJlIDxiPiUxJSBtb3JlIGNvbW1vbjwvYj4uIiwgMTApICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBTYW50YSBsZXZlbC4iKSArCiAgICAgICAgIjxxPlRoaXMgaXMgb25lIGJvdHRvbSB5b3UgY2FuJ3QgY2hlY2sgb3V0LjwvcT4iLAogICAgICAyNTI1LAogICAgICBbMTksIDldCiAgICApOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlNhbnRhJ3MgaGVscGVycyIsCiAgICAgIGxvYygiQ2xpY2tpbmcgaXMgPGI+JTElPC9iPiBtb3JlIHBvd2VyZnVsLiIsIDEwKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoIkNvc3Qgc2NhbGVzIHdpdGggU2FudGEgbGV2ZWwuIikgKwogICAgICAgICI8cT5Tb21lIGNob29zZSB0byBoZWxwIGhhbWJ1cmdlcjsgc29tZSBjaG9vc2UgdG8gaGVscCB5b3UuPGJyPlRvIGVhY2ggdGhlaXIgb3duLCBJIGd1ZXNzLjwvcT4iLAogICAgICAyNTI1LAogICAgICBbMTksIDldCiAgICApOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlNhbnRhJ3MgbGVnYWN5IiwKICAgICAgbG9jKCJDb29raWUgcHJvZHVjdGlvbiBtdWx0aXBsaWVyIDxiPislMSUgcGVyIFNhbnRhJ3MgbGV2ZWxzLjwvYj4iLCAzKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoIkNvc3Qgc2NhbGVzIHdpdGggU2FudGEgbGV2ZWwuIikgKwogICAgICAgICI8cT5JbiB0aGUgbm9ydGggcG9sZSwgeW91IGdvdHRhIGdldCB0aGUgZWx2ZXMgZmlyc3QuIFRoZW4gd2hlbiB5b3UgZ2V0IHRoZSBlbHZlcywgeW91IHN0YXJ0IG1ha2luZyB0aGUgdG95cy4gVGhlbiB3aGVuIHlvdSBnZXQgdGhlIHRveXMuLi4gdGhlbiB5b3UgZ2V0IHRoZSBjb29raWVzLjwvcT4iLAogICAgICAyNTI1LAogICAgICBbMTksIDldCiAgICApOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlNhbnRhJ3MgbWlsayBhbmQgY29va2llcyIsCiAgICAgIGxvYygiTWlsayBpcyA8Yj4lMSUgbW9yZSBwb3dlcmZ1bDwvYj4uIiwgNSkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIFNhbnRhIGxldmVsLiIpICsKICAgICAgICAiPHE+UGFydCBvZiBTYW50YSdzIGRyZWFkZnVsbHkgdW5iYWxhbmNlZCBkaWV0LjwvcT4iLAogICAgICAyNTI1LAogICAgICBbMTksIDldCiAgICApOwoKICAgIG9yZGVyID0gNDAwMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiUmVpbmRlZXIgc2Vhc29uIiwKICAgICAgbG9jKCJSZWluZGVlciBzcGF3biBtdWNoIG1vcmUgZnJlcXVlbnRseS4iKSArCiAgICAgICAgIjxxPkdvLCBDaGVhdGVyISBHbywgSGFja2VyIGFuZCBGYWtlciE8L3E+IiwKICAgICAgNywKICAgICAgWzEyLCA5XQogICAgKTsgLy9kZWJ1ZyBwdXJwb3NlcyBvbmx5CiAgICBHYW1lLmxhc3QucG9vbCA9ICJkZWJ1ZyI7CgogICAgb3JkZXIgPSAyNTAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTYW50YSdzIGRvbWluaW9uIiwKICAgICAgZ2V0U3RyQ29va2llUHJvZHVjdGlvbk11bHRpcGxpZXJQbHVzKDIwKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoIkFsbCBidWlsZGluZ3MgYXJlIDxiPiUxJSBjaGVhcGVyPC9iPi4iLCAxKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoIkFsbCB1cGdyYWRlcyBhcmUgPGI+JTElIGNoZWFwZXI8L2I+LiIsIDIpICsKICAgICAgICAiPHE+TXkgbmFtZSBpcyBDbGF1cywga2luZyBvZiBraW5nczs8YnI+TG9vayBvbiBteSB0b3lzLCB5ZSBNaWdodHksIGFuZCBkZXNwYWlyITwvcT4iLAogICAgICAyNTI1MjUyNTI1MjUyNTI1LAogICAgICBbMTksIDEwXSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuc3RvcmVUb1JlZnJlc2ggPSAxOwogICAgICB9CiAgICApOwoKICAgIG9yZGVyID0gMTAzMDA7CiAgICB2YXIgaGVhcnRQb3dlciA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHBvdyA9IDI7CiAgICAgIGlmIChHYW1lLkhhcygiU3RhcmxvdmUiKSkgcG93ID0gMzsKICAgICAgaWYgKEdhbWUuaGFzR29kKSB7CiAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJzZWFzb25zIik7CiAgICAgICAgaWYgKGdvZEx2bCA9PSAxKSBwb3cgKj0gMS4zOwogICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAyKSBwb3cgKj0gMS4yOwogICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAzKSBwb3cgKj0gMS4xOwogICAgICB9CiAgICAgIHJldHVybiBwb3c7CiAgICB9OwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlB1cmUgaGVhcnQgYmlzY3VpdHMiLAogICAgICBkZXNjOiAnTWVsdHkgd2hpdGUgY2hvY29sYXRlPGJyPnRoYXQgc2F5cyAiSSAqbGlrZSogbGlrZSB5b3UiLicsCiAgICAgIHNlYXNvbjogInZhbGVudGluZXMiLAogICAgICBpY29uOiBbMTksIDNdLAogICAgICBwb3dlcjogaGVhcnRQb3dlciwKICAgICAgcHJpY2U6IDEwMDAwMDAsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJBcmRlbnQgaGVhcnQgYmlzY3VpdHMiLAogICAgICBkZXNjOiAiQSByZWQgaG90IGNoZXJyeSBiaXNjdWl0IHRoYXQgd2lsbCBudWRnZSB0aGUgdGFyZ2V0IG9mIHlvdXIgYWZmZWN0aW9uIGluIGludGVyZXN0aW5nIGRpcmVjdGlvbnMuIiwKICAgICAgcmVxdWlyZTogR2FtZS5sYXN0Lm5hbWUsCiAgICAgIHNlYXNvbjogInZhbGVudGluZXMiLAogICAgICBpY29uOiBbMjAsIDNdLAogICAgICBwb3dlcjogaGVhcnRQb3dlciwKICAgICAgcHJpY2U6IDEwMDAwMDAwMDAsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJTb3VyIGhlYXJ0IGJpc2N1aXRzIiwKICAgICAgZGVzYzogIkEgYml0dGVyIGxpbWUgYmlzY3VpdCBmb3IgdGhlIGxvbmVseSBhbmQgdGhlIGhlYXJ0LWJyb2tlbi4iLAogICAgICByZXF1aXJlOiBHYW1lLmxhc3QubmFtZSwKICAgICAgc2Vhc29uOiAidmFsZW50aW5lcyIsCiAgICAgIGljb246IFsyMCwgNF0sCiAgICAgIHBvd2VyOiBoZWFydFBvd2VyLAogICAgICBwcmljZTogMTAwMDAwMDAwMDAwMCwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIldlZXBpbmcgaGVhcnQgYmlzY3VpdHMiLAogICAgICBkZXNjOiAiQW4gaWNlLWNvbGQgYmx1ZWJlcnJ5IGJpc2N1aXQsIHN5bWJvbCBvZiBhIG1lbmRpbmcgaGVhcnQuIiwKICAgICAgcmVxdWlyZTogR2FtZS5sYXN0Lm5hbWUsCiAgICAgIHNlYXNvbjogInZhbGVudGluZXMiLAogICAgICBpY29uOiBbMjEsIDNdLAogICAgICBwb3dlcjogaGVhcnRQb3dlciwKICAgICAgcHJpY2U6IDEwMDAwMDAwMDAwMDAwMDAsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJHb2xkZW4gaGVhcnQgYmlzY3VpdHMiLAogICAgICBkZXNjOiAiQSBiZWF1dGlmdWwgYmlzY3VpdCB0byBzeW1ib2xpemUga2luZG5lc3MsIHRydWUgbG92ZSwgYW5kIHNpbmNlcml0eS4iLAogICAgICByZXF1aXJlOiBHYW1lLmxhc3QubmFtZSwKICAgICAgc2Vhc29uOiAidmFsZW50aW5lcyIsCiAgICAgIGljb246IFsyMSwgNF0sCiAgICAgIHBvd2VyOiBoZWFydFBvd2VyLAogICAgICBwcmljZTogMTAwMDAwMDAwMDAwMDAwMDAwMCwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkV0ZXJuYWwgaGVhcnQgYmlzY3VpdHMiLAogICAgICBkZXNjOiAiU2lsdmVyIGljaW5nIGZvciBhIHZlcnkgc3BlY2lhbCBzb21lb25lIHlvdSd2ZSBsaWtlZCBmb3IgYSBsb25nLCBsb25nIHRpbWUuIiwKICAgICAgcmVxdWlyZTogR2FtZS5sYXN0Lm5hbWUsCiAgICAgIHNlYXNvbjogInZhbGVudGluZXMiLAogICAgICBpY29uOiBbMTksIDRdLAogICAgICBwb3dlcjogaGVhcnRQb3dlciwKICAgICAgcHJpY2U6IDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICB9KTsKCiAgICBHYW1lLmhlYXJ0RHJvcHMgPSBbCiAgICAgICJQdXJlIGhlYXJ0IGJpc2N1aXRzIiwKICAgICAgIkFyZGVudCBoZWFydCBiaXNjdWl0cyIsCiAgICAgICJTb3VyIGhlYXJ0IGJpc2N1aXRzIiwKICAgICAgIldlZXBpbmcgaGVhcnQgYmlzY3VpdHMiLAogICAgICAiR29sZGVuIGhlYXJ0IGJpc2N1aXRzIiwKICAgICAgIkV0ZXJuYWwgaGVhcnQgYmlzY3VpdHMiLAogICAgICAiUHJpc20gaGVhcnQgYmlzY3VpdHMiLAogICAgXTsKCiAgICBHYW1lLkdldEhvd01hbnlIZWFydERyb3BzID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgbnVtID0gMDsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLmhlYXJ0RHJvcHMpIHsKICAgICAgICBpZiAoR2FtZS5IYXMoR2FtZS5oZWFydERyb3BzW2ldKSkgbnVtKys7CiAgICAgIH0KICAgICAgcmV0dXJuIG51bTsKICAgIH07CgogICAgb3JkZXIgPSAxMTAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiR2VtIHBvbGlzaCIsCiAgICAgICI8cT5HZXQgcmlkIG9mIHRoZSBncmltZSBhbmQgbGV0IG1vcmUgbGlnaHQgaW4uPGJyPlRydWx5LCB0cnVseSBvdXRyYWdlb3VzLjwvcT4iLAogICAgICAiUHJpc20iLAogICAgICAxCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiOXRoIGNvbG9yIiwKICAgICAgIjxxPkRlbHZlIGludG8gdW50b3VjaGVkIG9wdGljYWwgZGVwdGhzIHdoZXJlIGV2ZW4gdGhlIG1hbnRpcyBzaHJpbXAgaGFzbid0IHNldCBhbiBleWUhPC9xPiIsCiAgICAgICJQcmlzbSIsCiAgICAgIDIKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJDaG9jb2xhdGUgbGlnaHQiLAogICAgICAiPHE+QmFzayBpbnRvIGl0cyBjb2NvYWxlc2NlbmNlLjxicj4oV2FybmluZyA6IG1heSBjYXVzZSB2YXJpb3VzIGludGVyZXN0aW5nIGFsYmVpdCBkZWFkbHkgc2tpbiBjb25kaXRpb25zLik8L3E+IiwKICAgICAgIlByaXNtIiwKICAgICAgMwogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkdyYWluYm93IiwKICAgICAgIjxxPlJlbWVtYmVyIHRoZSBkaWZmZXJlbnQgZ3JhaW5zIHVzaW5nIHRoZSBoYW5keSBSb3kgRy4gQml2IG1uZW1vbmljIDogUiBpcyBmb3IgcmljZSwgTyBpcyBmb3Igb2F0cy4uLiB1aCwgQiBmb3IgYmFybGV5Py4uLjwvcT4iLAogICAgICAiUHJpc20iLAogICAgICA0CiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiUHVyZSBjb3NtaWMgbGlnaHQiLAogICAgICAiPHE+WW91ciBwcmlzbXMgbm93IHJlY2VpdmUgcHJpc3RpbmUsIHVuYWR1bHRlcmF0ZWQgcGhvdG9ucyBmcm9tIHRoZSBvdGhlciBlbmQgb2YgdGhlIHVuaXZlcnNlLjwvcT4iLAogICAgICAiUHJpc20iLAogICAgICA1CiAgICApOwoKICAgIG9yZGVyID0gMjU1OwogICAgR2FtZS5HcmFuZG1hU3luZXJneSgKICAgICAgIlJhaW5ib3cgZ3JhbmRtYXMiLAogICAgICAiQSBsdW1pbm91cyBncmFuZG1hIHRvIHNwYXJrbGUgaW50byBjb29raWVzLiIsCiAgICAgICJQcmlzbSIKICAgICk7CgogICAgb3JkZXIgPSAyNDAwMDsKICAgIEdhbWUuc2Vhc29uVHJpZ2dlckJhc2VQcmljZSA9IDEwMDAwMDAwMDA7IC8vMTExMTExMTExMTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTZWFzb24gc3dpdGNoZXIiLAogICAgICBsb2MoCiAgICAgICAgIkFsbG93cyB5b3UgdG8gPGI+dHJpZ2dlciBzZWFzb25hbCBldmVudHM8L2I+IGF0IHdpbGwsIGZvciBhIHByaWNlLiIKICAgICAgKSArICI8cT5UaGVyZSB3aWxsIGFsd2F5cyBiZSB0aW1lLjwvcT4iLAogICAgICAxMTExLAogICAgICBbMTYsIDZdLAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLnNlYXNvbnMpIHsKICAgICAgICAgIEdhbWUuVW5sb2NrKEdhbWUuc2Vhc29uc1tpXS50cmlnZ2VyKTsKICAgICAgICB9CiAgICAgIH0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiSGVyYWxkcyJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkZlc3RpdmUgYmlzY3VpdCIsCiAgICAgIGxvYygKICAgICAgICAiVHJpZ2dlcnMgPGI+JTEgc2Vhc29uPC9iPiBmb3IgdGhlIG5leHQgMjQgaG91cnMuPGJyPlRyaWdnZXJpbmcgYW5vdGhlciBzZWFzb24gd2lsbCBjYW5jZWwgdGhpcyBvbmUuPGJyPkNvc3Qgc2NhbGVzIHdpdGggdW5idWZmZWQgQ3BTIGFuZCBpbmNyZWFzZXMgd2l0aCBldmVyeSBzZWFzb24gc3dpdGNoLiIsCiAgICAgICAgbG9jKCJDaHJpc3RtYXMiKQogICAgICApICsgIjxxPidUd2FzIHRoZSBuaWdodCBiZWZvcmUgQ2hyaXN0bWFzLSBvciB3YXMgaXQ/PC9xPiIsCiAgICAgIEdhbWUuc2Vhc29uVHJpZ2dlckJhc2VQcmljZSwKICAgICAgWzEyLCAxMF0KICAgICk7CiAgICBHYW1lLmxhc3Quc2Vhc29uID0gImNocmlzdG1hcyI7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJ0b2dnbGUiOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkdob3N0bHkgYmlzY3VpdCIsCiAgICAgIGxvYygKICAgICAgICAiVHJpZ2dlcnMgPGI+JTEgc2Vhc29uPC9iPiBmb3IgdGhlIG5leHQgMjQgaG91cnMuPGJyPlRyaWdnZXJpbmcgYW5vdGhlciBzZWFzb24gd2lsbCBjYW5jZWwgdGhpcyBvbmUuPGJyPkNvc3Qgc2NhbGVzIHdpdGggdW5idWZmZWQgQ3BTIGFuZCBpbmNyZWFzZXMgd2l0aCBldmVyeSBzZWFzb24gc3dpdGNoLiIsCiAgICAgICAgbG9jKCJIYWxsb3dlZW4iKQogICAgICApICsgIjxxPnNwb29reSBzY2FyeSBza2VsZXRvbnM8YnI+d2lsbCB3YWtlIHlvdSB3aXRoIGEgYm9vPC9xPiIsCiAgICAgIEdhbWUuc2Vhc29uVHJpZ2dlckJhc2VQcmljZSwKICAgICAgWzEzLCA4XQogICAgKTsKICAgIEdhbWUubGFzdC5zZWFzb24gPSAiaGFsbG93ZWVuIjsKICAgIEdhbWUubGFzdC5wb29sID0gInRvZ2dsZSI7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiTG92ZXNpY2sgYmlzY3VpdCIsCiAgICAgIGxvYygKICAgICAgICAiVHJpZ2dlcnMgPGI+JTEgc2Vhc29uPC9iPiBmb3IgdGhlIG5leHQgMjQgaG91cnMuPGJyPlRyaWdnZXJpbmcgYW5vdGhlciBzZWFzb24gd2lsbCBjYW5jZWwgdGhpcyBvbmUuPGJyPkNvc3Qgc2NhbGVzIHdpdGggdW5idWZmZWQgQ3BTIGFuZCBpbmNyZWFzZXMgd2l0aCBldmVyeSBzZWFzb24gc3dpdGNoLiIsCiAgICAgICAgbG9jKCJWYWxlbnRpbmUncyBkYXkiKQogICAgICApICsgIjxxPlJvbWFuY2UgbmV2ZXIgZ29lcyBvdXQgb2YgZmFzaGlvbi48L3E+IiwKICAgICAgR2FtZS5zZWFzb25UcmlnZ2VyQmFzZVByaWNlLAogICAgICBbMjAsIDNdCiAgICApOwogICAgR2FtZS5sYXN0LnNlYXNvbiA9ICJ2YWxlbnRpbmVzIjsKICAgIEdhbWUubGFzdC5wb29sID0gInRvZ2dsZSI7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRm9vbCdzIGJpc2N1aXQiLAogICAgICBsb2MoCiAgICAgICAgIlRyaWdnZXJzIDxiPiUxIHNlYXNvbjwvYj4gZm9yIHRoZSBuZXh0IDI0IGhvdXJzLjxicj5UcmlnZ2VyaW5nIGFub3RoZXIgc2Vhc29uIHdpbGwgY2FuY2VsIHRoaXMgb25lLjxicj5Db3N0IHNjYWxlcyB3aXRoIHVuYnVmZmVkIENwUyBhbmQgaW5jcmVhc2VzIHdpdGggZXZlcnkgc2Vhc29uIHN3aXRjaC4iLAogICAgICAgIGxvYygiQnVzaW5lc3MgZGF5IikKICAgICAgKSArCiAgICAgICAgIjxxPkJ1c2luZXNzLiBTZXJpb3VzIGJ1c2luZXNzLiBUaGlzIGlzIGFic29sdXRlbHkgYWxsIG9mIHlvdXIgYnVzaW5lc3MuPC9xPiIsCiAgICAgIEdhbWUuc2Vhc29uVHJpZ2dlckJhc2VQcmljZSwKICAgICAgWzE3LCA2XQogICAgKTsKICAgIEdhbWUubGFzdC5zZWFzb24gPSAiZm9vbHMiOwogICAgR2FtZS5sYXN0LnBvb2wgPSAidG9nZ2xlIjsKCiAgICBvcmRlciA9IDQwMDAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkV0ZXJuYWwgc2Vhc29ucyIsCiAgICAgIGxvYygiU2Vhc29ucyBub3cgbGFzdCBmb3JldmVyLiIpICsgIjxxPlNlYXNvbiB0byB0YXN0ZS48L3E+IiwKICAgICAgNywKICAgICAgWzE2LCA2XSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5zZWFzb25zKSB7CiAgICAgICAgICBHYW1lLlVubG9jayhHYW1lLnNlYXNvbnNbaV0udHJpZ2dlcik7CiAgICAgICAgfQogICAgICB9CiAgICApOyAvL2RlYnVnIHB1cnBvc2VzIG9ubHkKICAgIEdhbWUubGFzdC5wb29sID0gImRlYnVnIjsKCiAgICBvcmRlciA9IDIwMDAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIktpdHRlbiBtYW5hZ2VycyIsCiAgICAgIHN0cktpdHRlbkRlc2MgKyAiPHE+dGhhdCdzIG5vdCBnb25uYSBwYXdzIGFueSBwcm9ibGVtLCBzaXI8L3E+IiwKICAgICAgOTAwMDAwMDAwMDAwMDAwMDAwMDAwLAogICAgICBHYW1lLkdldEljb24oIktpdHRlbiIsIDUpCiAgICApOwogICAgR2FtZS5sYXN0LmtpdHRlbiA9IDE7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCA1LCAxOCk7CgogICAgb3JkZXIgPSAxMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiU2VwdGlsbGlvbiBmaW5nZXJzIiwKICAgICAgZ2V0U3RyVGhvdXNhbmRGaW5nZXJzR2FpbigyMCkgKyAiPHE+W2N1cnNvcnkgZmxhdm9yIHRleHRdPC9xPiIsCiAgICAgIDEwMDAwMDAwMDAwMDAwMDAwMDAwLAogICAgICBbMTIsIDIwXQogICAgKTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDExLCAwKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJPY3RpbGxpb24gZmluZ2VycyIsCiAgICAgIGdldFN0clRob3VzYW5kRmluZ2Vyc0dhaW4oMjApICsKICAgICAgICAiPHE+VHVybnMgb3V0IHlvdSA8Yj5jYW48L2I+IHF1aXRlIHB1dCB5b3VyIGZpbmdlciBvbiBpdC48L3E+IiwKICAgICAgMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIFsxMiwgMTldCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgMTIsIDApOwoKICAgIG9yZGVyID0gMTUwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkVsdWRpdW0gbW91c2UiLAogICAgICBnZXRTdHJDbGlja2luZ0dhaW5zKDEpICsgIjxxPkkgcm9kZW50IGRvIHRoYXQgaWYgSSB3ZXJlIHlvdS48L3E+IiwKICAgICAgNTAwMDAwMDAwMDAwMDAwLAogICAgICBbMTEsIDE1XQogICAgKTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDYsIDExKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJXaXNoYWxsb3kgbW91c2UiLAogICAgICBnZXRTdHJDbGlja2luZ0dhaW5zKDEpICsKICAgICAgICAiPHE+Q2xpY2tpbmcgaXMgZmluZSBhbmQgZGFuZHksIGJ1dCBkb24ndCBzbWFzaCB5b3VyIG1vdXNlIG92ZXIgaXQuIEdldCB5b3VyIGdhbWUgb24uIEdvIHBsYXkuPC9xPiIsCiAgICAgIDUwMDAwMDAwMDAwMDAwMDAwLAogICAgICBbMTEsIDE2XQogICAgKTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDcsIDExKTsKICAgIG9yZGVyID0gMjAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQWdpbmcgYWdlbnRzIiwKICAgICAgIjxxPkNvdW50ZXItaW50dWl0aXZlbHksIGdyYW5kbWFzIGhhdmUgdGhlIHVuY2FubnkgYWJpbGl0eSB0byBiZWNvbWUgbW9yZSBwb3dlcmZ1bCB0aGUgb2xkZXIgdGhleSBnZXQuPC9xPiIsCiAgICAgICJHcmFuZG1hIiwKICAgICAgNgogICAgKTsKICAgIG9yZGVyID0gMzAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiUHVsc2FyIHNwcmlua2xlcnMiLAogICAgICAiPHE+VGhlcmUncyBubyBzdWNoIHRoaW5nIGFzIG92ZXItd2F0ZXJpbmcuIFRoZSBtb2lzdGVzdCBpcyB0aGUgYmVzdGVzdC48L3E+IiwKICAgICAgIkZhcm0iLAogICAgICA2CiAgICApOwogICAgb3JkZXIgPSA1MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJEZWVwLWJha2UgcHJvY2VzcyIsCiAgICAgICI8cT5BIHBhdGVudGVkIHByb2Nlc3MgaW5jcmVhc2luZyBjb29raWUgeWllbGQgdHdvLWZvbGQgZm9yIHRoZSBzYW1lIGFtb3VudCBvZiBpbmdyZWRpZW50cy4gRG9uJ3QgYXNrIGhvdywgZG9uJ3QgdGFrZSBwaWN0dXJlcywgYW5kIGJlIHN1cmUgdG8gd2VhciB5b3VyIHByb3RlY3RpdmUgc3VpdC48L3E+IiwKICAgICAgIkZhY3RvcnkiLAogICAgICA2CiAgICApOwogICAgb3JkZXIgPSA0MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJDb3JlZm9yZ2UiLAogICAgICAiPHE+WW91J3ZlIGZpbmFsbHkgZHVnIGEgdHVubmVsIGRvd24gdG8gdGhlIEVhcnRoJ3MgY29yZS4gSXQncyBwcmV0dHkgd2FybSBkb3duIGhlcmUuPC9xPiIsCiAgICAgICJNaW5lIiwKICAgICAgNgogICAgKTsKICAgIG9yZGVyID0gNjAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiR2VuZXJhdGlvbiBzaGlwIiwKICAgICAgIjxxPkJ1aWx0IHRvIGxhc3QsIHRoaXMgaHVtb25nb3VzIHNwYWNlY3JhZnQgd2lsbCBzdXJlbHkgZGVsaXZlciB5b3VyIGNvb2tpZXMgdG8gdGhlIGRlZXAgZW5kcyBvZiBzcGFjZSwgb25lIGRheS48L3E+IiwKICAgICAgIlNoaXBtZW50IiwKICAgICAgNgogICAgKTsKICAgIG9yZGVyID0gNzAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiT3JpZ2luIGNydWNpYmxlIiwKICAgICAgIjxxPkJ1aWx0IGZyb20gdGhlIHJhcmVzdCBvZiBlYXJ0aHMgYW5kIGxvY2F0ZWQgYXQgdGhlIHZlcnkgZGVlcGVzdCBvZiB0aGUgbGFyZ2VzdCBtb3VudGFpbiwgdGhpcyBsZWdlbmRhcnkgY3J1Y2libGUgaXMgc2FpZCB0byByZXRhaW4gcHJvcGVydGllcyBmcm9tIHRoZSBiaWctYmFuZyBpdHNlbGYuPC9xPiIsCiAgICAgICJBbGNoZW15IGxhYiIsCiAgICAgIDYKICAgICk7CiAgICBvcmRlciA9IDgwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkRlaXR5LXNpemVkIHBvcnRhbHMiLAogICAgICAiPHE+SXQncyBhbG1vc3QgbGlrZSwgc2F5LCBhbiBlbGRlciBnb2QgY291bGQgZml0IHRocm91Z2ggdGhpcyB0aGluZyBub3cuIEh5cG90aGV0aWNhbGx5LjwvcT4iLAogICAgICAiUG9ydGFsIiwKICAgICAgNgogICAgKTsKICAgIG9yZGVyID0gOTAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRmFyIGZ1dHVyZSBlbmFjdG1lbnQiLAogICAgICAiPHE+VGhlIGZhciBmdXR1cmUgZW5hY3RtZW50IGF1dGhvcml6ZXMgeW91IHRvIGRlbHZlIGRlZXAgaW50byB0aGUgZnV0dXJlIC0gd2hlcmUgY2l2aWxpemF0aW9uIGhhcyBmYWxsZW4gYW5kIHJpc2VuIGFnYWluLCBhbmQgY29va2llcyBhcmUgcGxlbnRpZnVsLjwvcT4iLAogICAgICAiVGltZSBtYWNoaW5lIiwKICAgICAgNgogICAgKTsKICAgIG9yZGVyID0gMTAwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIk5hbm9jb3NtaWNzIiwKICAgICAgIjxxPlRoZSB0aGVvcnkgb2YgbmFub2Nvc21pY3MgcG9zaXRzIHRoYXQgZWFjaCBzdWJhdG9taWMgcGFydGljbGUgaXMgaW4gZmFjdCBpdHMgb3duIHNlbGYtY29udGFpbmVkIHVuaXZlcnNlLCBob2xkaW5nIHVuZmF0aG9tYWJsZSBhbW91bnRzIG9mIGVuZXJneS48YnI+VGhpcyBzb21laG93IHN0YWNrcyB3aXRoIHRoZSBuZXN0ZWQgdW5pdmVyc2UgdGhlb3J5LCBiZWNhdXNlIHBoeXNpY3MuPC9xPiIsCiAgICAgICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsCiAgICAgIDYKICAgICk7CiAgICBvcmRlciA9IDExMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJHbG93LWluLXRoZS1kYXJrIiwKICAgICAgIjxxPllvdXIgcHJpc21zIG5vdyBnbG93IGluIHRoZSBkYXJrLCBlZmZlY3RpdmVseSBkb3VibGluZyB0aGVpciBvdXRwdXQhPC9xPiIsCiAgICAgICJQcmlzbSIsCiAgICAgIDYKICAgICk7CgogICAgb3JkZXIgPSAxMDAzMjsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJSb3NlIG1hY2Fyb25zIiwKICAgICAgZGVzYzogIkFsdGhvdWdoIGFuIG9kZCBmbGF2b3IsIHRoZXNlIHBhc3RyaWVzIHJlY2VudGx5IHJvc2UgaW4gcG9wdWxhcml0eS4iLAogICAgICBpY29uOiBbMjIsIDNdLAogICAgICByZXF1aXJlOiAiQm94IG9mIG1hY2Fyb25zIiwKICAgICAgcG93ZXI6IDMsCiAgICAgIHByaWNlOiA5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiTGVtb24gbWFjYXJvbnMiLAogICAgICBkZXNjOiAiVGFzdGVmdWxseSBzb3VyLCBkZWxpZ2h0ZnVsIHRyZWF0cy4iLAogICAgICBpY29uOiBbMjMsIDNdLAogICAgICByZXF1aXJlOiAiQm94IG9mIG1hY2Fyb25zIiwKICAgICAgcG93ZXI6IDMsCiAgICAgIHByaWNlOiA5OTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQ2hvY29sYXRlIG1hY2Fyb25zIiwKICAgICAgZGVzYzogIlRoZXkncmUgbGlrZSB0aW55IHN1Z2FyeSBidXJnZXJzISIsCiAgICAgIGljb246IFsyNCwgM10sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgbWFjYXJvbnMiLAogICAgICBwb3dlcjogMywKICAgICAgcHJpY2U6IDk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJQaXN0YWNoaW8gbWFjYXJvbnMiLAogICAgICBkZXNjOiAiUGlzdGFjaGlvIHNoZWxscyBub3cgcmVtb3ZlZCBhZnRlciBtdWx0aXBsZSBjb21wbGFpbnRzLiIsCiAgICAgIGljb246IFsyMiwgNF0sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgbWFjYXJvbnMiLAogICAgICBwb3dlcjogMywKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJIYXplbG51dCBtYWNhcm9ucyIsCiAgICAgIGRlc2M6ICJUaGVzZSBnbyBlc3BlY2lhbGx5IHdlbGwgd2l0aCBjb2ZmZWUuIiwKICAgICAgaWNvbjogWzIzLCA0XSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBtYWNhcm9ucyIsCiAgICAgIHBvd2VyOiAzLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlZpb2xldCBtYWNhcm9ucyIsCiAgICAgIGRlc2M6ICJJdCdzIGxpa2Ugc3ByYXlpbmcgcGVyZnVtZSBpbnRvIHlvdXIgbW91dGghIiwKICAgICAgaWNvbjogWzI0LCA0XSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBtYWNhcm9ucyIsCiAgICAgIHBvd2VyOiAzLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwoKICAgIG9yZGVyID0gNDAwMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiTWFnaWMgc2hlbmFuaWdhbnMiLAogICAgICBsb2MoIkNvb2tpZSBwcm9kdWN0aW9uIDxiPm11bHRpcGxpZWQgYnkgMSwwMDA8L2I+LiIpICsKICAgICAgICAiPHE+SXQncyBtYWdpYy4gSSBhaW4ndCBnb3R0YSBleHBsYWluIHNoPGRpdiBzdHlsZT1cImRpc3BsYXk6aW5saW5lLWJsb2NrO2JhY2tncm91bmQ6dXJsKGltZy9tb25leS5wbmcpO3dpZHRoOjE2cHg7aGVpZ2h0OjE2cHg7cG9zaXRpb246cmVsYXRpdmU7dG9wOjRweDtsZWZ0OjBweDttYXJnaW46MHB4IC0ycHg7XCI+PC9kaXY+dC48L3E+IiwKICAgICAgNywKICAgICAgWzE3LCA1XQogICAgKTsgLy9kZWJ1ZyBwdXJwb3NlcyBvbmx5CiAgICBHYW1lLmxhc3QucG9vbCA9ICJkZWJ1ZyI7CgogICAgb3JkZXIgPSAyNDAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJCdW5ueSBiaXNjdWl0IiwKICAgICAgbG9jKAogICAgICAgICJUcmlnZ2VycyA8Yj4lMSBzZWFzb248L2I+IGZvciB0aGUgbmV4dCAyNCBob3Vycy48YnI+VHJpZ2dlcmluZyBhbm90aGVyIHNlYXNvbiB3aWxsIGNhbmNlbCB0aGlzIG9uZS48YnI+Q29zdCBzY2FsZXMgd2l0aCB1bmJ1ZmZlZCBDcFMgYW5kIGluY3JlYXNlcyB3aXRoIGV2ZXJ5IHNlYXNvbiBzd2l0Y2guIiwKICAgICAgICBsb2MoIkVhc3RlciIpCiAgICAgICkgKwogICAgICAgICI8cT5BbGwgdGhlIHdvcmxkIHdpbGwgYmUgeW91ciBlbmVteTxicj5hbmQgd2hlbiB0aGV5IGNhdGNoIHlvdSw8YnI+dGhleSB3aWxsIGtpbGwgeW91Li4uPGJyPmJ1dCBmaXJzdCB0aGV5IG11c3QgY2F0Y2ggeW91LjwvcT4iLAogICAgICBHYW1lLnNlYXNvblRyaWdnZXJCYXNlUHJpY2UsCiAgICAgIFswLCAxMl0KICAgICk7CiAgICBHYW1lLmxhc3Quc2Vhc29uID0gImVhc3RlciI7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJ0b2dnbGUiOwoKICAgIHZhciBlZ2dQcmljZSA9IDk5OTk5OTk5OTk5OTsKICAgIHZhciBlZ2dQcmljZTIgPSA5OTk5OTk5OTk5OTk5OTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJDaGlja2VuIGVnZyIsCiAgICAgIGdldFN0ckNvb2tpZVByb2R1Y3Rpb25NdWx0aXBsaWVyUGx1cygxKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoIkNvc3Qgc2NhbGVzIHdpdGggaG93IG1hbnkgZWdncyB5b3Ugb3duLiIpICsKICAgICAgICAiPHE+VGhlIGVnZy4gVGhlIGVnZyBjYW1lIGZpcnN0LiBHZXQgb3ZlciBpdC48L3E+IiwKICAgICAgZWdnUHJpY2UsCiAgICAgIFsxLCAxMl0KICAgICk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRHVjayBlZ2ciLAogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMSkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIGhvdyBtYW55IGVnZ3MgeW91IG93bi4iKSArCiAgICAgICAgIjxxPlRoZW4gaGUgd2FkZGxlZCBhd2F5LjwvcT4iLAogICAgICBlZ2dQcmljZSwKICAgICAgWzIsIDEyXQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJUdXJrZXkgZWdnIiwKICAgICAgZ2V0U3RyQ29va2llUHJvZHVjdGlvbk11bHRpcGxpZXJQbHVzKDEpICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBob3cgbWFueSBlZ2dzIHlvdSBvd24uIikgKwogICAgICAgICI8cT5UaGVzZSBoYXRjaCBpbnRvIHN0cmFuZ2UsIGhhbmQtc2hhcGVkIGNyZWF0dXJlcy48L3E+IiwKICAgICAgZWdnUHJpY2UsCiAgICAgIFszLCAxMl0KICAgICk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiUXVhaWwgZWdnIiwKICAgICAgZ2V0U3RyQ29va2llUHJvZHVjdGlvbk11bHRpcGxpZXJQbHVzKDEpICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBob3cgbWFueSBlZ2dzIHlvdSBvd24uIikgKwogICAgICAgICI8cT5UaGVzZSBlZ2dzIGFyZSBwb3NpdGl2ZWx5IHRpbnkuIEkgbWVhbiBsb29rIGF0IHRoZW0uIEhvdyBkb2VzIHRoaXMgaGFwcGVuPyBXaG9zZSBpZGVhIHdhcyB0aGF0PzwvcT4iLAogICAgICBlZ2dQcmljZSwKICAgICAgWzQsIDEyXQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJSb2JpbiBlZ2ciLAogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMSkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIGhvdyBtYW55IGVnZ3MgeW91IG93bi4iKSArCiAgICAgICAgIjxxPkhvbHkgYXp1cmUtaHVlZCBzaGVsbGVkIGVtYnJ5b3MhPC9xPiIsCiAgICAgIGVnZ1ByaWNlLAogICAgICBbNSwgMTJdCiAgICApOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIk9zdHJpY2ggZWdnIiwKICAgICAgZ2V0U3RyQ29va2llUHJvZHVjdGlvbk11bHRpcGxpZXJQbHVzKDEpICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBob3cgbWFueSBlZ2dzIHlvdSBvd24uIikgKwogICAgICAgICI8cT5PbmUgb2YgdGhlIGxhcmdlc3QgZWdncyBpbiB0aGUgd29ybGQuIE1vcmUgbGlrZSBvc3Ryb3VjaCwgYW0gSSByaWdodD88YnI+R3V5cz88L3E+IiwKICAgICAgZWdnUHJpY2UsCiAgICAgIFs2LCAxMl0KICAgICk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQ2Fzc293YXJ5IGVnZyIsCiAgICAgIGdldFN0ckNvb2tpZVByb2R1Y3Rpb25NdWx0aXBsaWVyUGx1cygxKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoIkNvc3Qgc2NhbGVzIHdpdGggaG93IG1hbnkgZWdncyB5b3Ugb3duLiIpICsKICAgICAgICAiPHE+VGhlIGNhc3Nvd2FyeSBpcyB0YWxsZXIgdGhhbiB5b3UsIHBvc3Nlc3NlcyBtdXJkZXJvdXMgY2xhd3MgYW5kIGNhbiBlYXNpbHkgb3V0cnVuIHlvdS48YnI+WW91J2QgZG8gd2VsbCB0byBiZSBjYXNzby13YXJ5IG9mIHRoZW0uPC9xPiIsCiAgICAgIGVnZ1ByaWNlLAogICAgICBbNywgMTJdCiAgICApOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlNhbG1vbiByb2UiLAogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMSkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIGhvdyBtYW55IGVnZ3MgeW91IG93bi4iKSArCiAgICAgICAgIjxxPkRvIHRoZSBpbXBvc3NpYmxlLCBzZWUgdGhlIGludmlzaWJsZS48YnI+Um9lIHJvZSwgZmlnaHQgdGhlIHBvd2VyPzwvcT4iLAogICAgICBlZ2dQcmljZSwKICAgICAgWzgsIDEyXQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJGcm9nc3Bhd24iLAogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMSkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIGhvdyBtYW55IGVnZ3MgeW91IG93bi4iKSArCiAgICAgICAgJzxxPkkgd2FzIGdvaW5nIHRvIG1ha2UgYSBwdW4gYWJvdXQgaG93IHRoZXNlICJ0b2FkYWxseSBsb29rIGxpa2UgZXllYmFsbHMiLCBidXQgZnJvZ2V0IGl0LjwvcT4nLAogICAgICBlZ2dQcmljZSwKICAgICAgWzksIDEyXQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTaGFyayBlZ2ciLAogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMSkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIGhvdyBtYW55IGVnZ3MgeW91IG93bi4iKSArCiAgICAgICAgIjxxPkhFTExPIElTIFRISVMgRk9PRD88YnI+TEVUIE1FIFRFTEwgWU9VIEFCT1VUIEZPT0QuPGJyPldIWSBETyBJIEtFRVAgRUFUSU5HIE1ZIEZSSUVORFM8L3E+IiwKICAgICAgZWdnUHJpY2UsCiAgICAgIFsxMCwgMTJdCiAgICApOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlR1cnRsZSBlZ2ciLAogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMSkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIGhvdyBtYW55IGVnZ3MgeW91IG93bi4iKSArCiAgICAgICAgIjxxPlR1cnRsZXMsIHJpZ2h0PyBIYXRjaCBmcm9tIHNoZWxscy4gR3JvdyBpbnRvIHNoZWxscy4gV2hhdCdzIHVwIHdpdGggdGhhdD88YnI+Tm93IGZvciBteSBza2l0IGFib3V0IGFpcnBsYW5lIGZvb2QuPC9xPiIsCiAgICAgIGVnZ1ByaWNlLAogICAgICBbMTEsIDEyXQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJBbnQgbGFydmEiLAogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMSkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIGhvdyBtYW55IGVnZ3MgeW91IG93bi4iKSArCiAgICAgICAgIjxxPlRoZXNlIGFyZSBhIGRlbGljYWN5IGluIHNvbWUgY291bnRyaWVzLCBJIHN3ZWFyLiBZb3Ugd2lsbCBsZXQgdGhlc2UgaW52YWRlIHlvdXIgZGlnZXN0aXZlIHRyYWN0LCBhbmQgeW91IHdpbGwgZGVyaXZlIGdyZWF0IHBsZWFzdXJlIGZyb20gaXQuPGJyPkFuZCBhbGwgd2lsbCBiZSB3ZWxsLjwvcT4iLAogICAgICBlZ2dQcmljZSwKICAgICAgWzEyLCAxMl0KICAgICk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiR29sZGVuIGdvb3NlIGVnZyIsCiAgICAgIGxvYygiR29sZGVuIGNvb2tpZXMgYXBwZWFyIDxiPiUxJTwvYj4gbW9yZSBvZnRlbi4iLCA1KSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoIkNvc3Qgc2NhbGVzIHdpdGggaG93IG1hbnkgZWdncyB5b3Ugb3duLiIpICsKICAgICAgICAiPHE+VGhlIHNvbGUgdmVzdGlnZSBvZiBhIHRyYWdpYyB0YWxlIGludm9sdmluZyBtaXNndWlkZWQgaW52ZXN0bWVudHMuPC9xPiIsCiAgICAgIGVnZ1ByaWNlMiwKICAgICAgWzEzLCAxMl0KICAgICk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRmFiZXJnZSBlZ2ciLAogICAgICBsb2MoIkFsbCBidWlsZGluZ3MgYW5kIHVwZ3JhZGVzIGFyZSA8Yj4lMSUgY2hlYXBlcjwvYj4uIiwgMSkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIGhvdyBtYW55IGVnZ3MgeW91IG93bi4iKSArCiAgICAgICAgIjxxPlRoaXMgb3V0cmFnZW91cyBlZ2cgaXMgZGVmaW5pdGVseSBmYWIuPC9xPiIsCiAgICAgIGVnZ1ByaWNlMiwKICAgICAgWzE0LCAxMl0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLnN0b3JlVG9SZWZyZXNoID0gMTsKICAgICAgfQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJXcmlua2xlcnNwYXduIiwKICAgICAgbG9jKCJXcmlua2xlcnMgZXhwbG9kZSBpbnRvIDxiPiUxJSBtb3JlIGNvb2tpZXM8L2I+LiIsIDUpICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBob3cgbWFueSBlZ2dzIHlvdSBvd24uIikgKwogICAgICAgICI8cT5Mb29rIGF0IHRoaXMgbGl0dGxlIGd1eSEgSXQncyBnb25uYSBiZSBhIGJpZyBib3kgc29tZWRheSEgWWVzIGl0IGlzITwvcT4iLAogICAgICBlZ2dQcmljZTIsCiAgICAgIFsxNSwgMTJdCiAgICApOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkNvb2tpZSBlZ2ciLAogICAgICBsb2MoIkNsaWNraW5nIGlzIDxiPiUxJTwvYj4gbW9yZSBwb3dlcmZ1bC4iLCAxMCkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIGhvdyBtYW55IGVnZ3MgeW91IG93bi4iKSArCiAgICAgICAgIjxxPlRoZSBzaGVsbCBhcHBlYXJzIHRvIGJlIGNoaXBwZWQuPGJyPkkgd29uZGVyIHdoYXQncyBpbnNpZGUgdGhpcyBvbmUhPC9xPiIsCiAgICAgIGVnZ1ByaWNlMiwKICAgICAgWzE2LCAxMl0KICAgICk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiT21lbGV0dGUiLAogICAgICBsb2MoIk90aGVyIGVnZ3MgYXBwZWFyIDxiPiUxJSBtb3JlIGZyZXF1ZW50bHk8L2I+LiIsIDEwKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoIkNvc3Qgc2NhbGVzIHdpdGggaG93IG1hbnkgZWdncyB5b3Ugb3duLiIpICsKICAgICAgICAiPHE+RnJvbWFnZSBub3QgaW5jbHVkZWQuPC9xPiIsCiAgICAgIGVnZ1ByaWNlMiwKICAgICAgWzE3LCAxMl0KICAgICk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQ2hvY29sYXRlIGVnZyIsCiAgICAgIGxvYygiQ29udGFpbnMgPGI+YSBsb3Qgb2YgY29va2llczwvYj4uIikgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIGhvdyBtYW55IGVnZ3MgeW91IG93bi4iKSArCiAgICAgICAgIjxxPkxhaWQgYnkgdGhlIGVsdXNpdmUgY29jb2EgYmlyZC4gVGhlcmUncyBhIHN1cnByaXNlIGluc2lkZSE8L3E+IiwKICAgICAgZWdnUHJpY2UyLAogICAgICBbMTgsIDEyXSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBjb29raWVzID0gR2FtZS5jb29raWVzICogMC4wNTsKICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICJDaG9jb2xhdGUgZWdnIiwKICAgICAgICAgIGxvYygiVGhlIGVnZyBidXJzdHMgaW50byA8Yj4lMTwvYj4gY29va2llcyEiLCBCZWF1dGlmeShjb29raWVzKSksCiAgICAgICAgICBHYW1lLlVwZ3JhZGVzWyJDaG9jb2xhdGUgZWdnIl0uaWNvbgogICAgICAgICk7CiAgICAgICAgR2FtZS5FYXJuKGNvb2tpZXMpOwogICAgICB9CiAgICApOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkNlbnR1cnkgZWdnIiwKICAgICAgbG9jKAogICAgICAgICJZb3UgY29udGludWFsbHkgZ2FpbiA8Yj5tb3JlIENwUyB0aGUgbG9uZ2VyIHlvdSd2ZSBwbGF5ZWQ8L2I+IGluIHRoZSBjdXJyZW50IGFzY2Vuc2lvbi4iCiAgICAgICkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIGhvdyBtYW55IGVnZ3MgeW91IG93bi4iKSArCiAgICAgICAgIjxxPkFjdHVhbGx5IG5vdCBjZW50dXJpZXMtb2xkLiBUaGlzIG9uZSBpc24ndCBhIGRheSBvdmVyIDg2ITwvcT4iLAogICAgICBlZ2dQcmljZTIsCiAgICAgIFsxOSwgMTJdCiAgICApOwogICAgR2FtZS5sYXN0LmRlc2NGdW5jID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgZGF5ID0KICAgICAgICAoTWF0aC5mbG9vcigoRGF0ZS5ub3coKSAtIEdhbWUuc3RhcnREYXRlKSAvIDEwMDAgLyAxMCkgKiAxMCkgLwogICAgICAgIDYwIC8KICAgICAgICA2MCAvCiAgICAgICAgMjQ7CiAgICAgIGRheSA9IE1hdGgubWluKGRheSwgMTAwKTsKICAgICAgdmFyIG4gPSAoMSAtIE1hdGgucG93KDEgLSBkYXkgLyAxMDAsIDMpKSAqIDAuMTsKICAgICAgcmV0dXJuICgKICAgICAgICAnPGRpdiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7Ij4nICsKICAgICAgICBsb2MoIkN1cnJlbnQgYm9vc3Q6IikgKwogICAgICAgICIgPGI+KyIgKwogICAgICAgIEJlYXV0aWZ5KG4gKiAxMDAsIDEpICsKICAgICAgICAnJTwvYj48L2Rpdj48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICB0aGlzLmRkZXNjCiAgICAgICk7CiAgICB9OwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgJyJlZ2ciJywKICAgICAgIjxiPiIgKyBsb2MoIislMSBDcFMiLCA5KSArICc8L2I+PHE+aGV5IGl0XCdzICJlZ2ciPC9xPicsCiAgICAgIGVnZ1ByaWNlMiwKICAgICAgWzIwLCAxMl0KICAgICk7CgogICAgR2FtZS5lYXN0ZXJFZ2dzID0gWwogICAgICAiQ2hpY2tlbiBlZ2ciLAogICAgICAiRHVjayBlZ2ciLAogICAgICAiVHVya2V5IGVnZyIsCiAgICAgICJRdWFpbCBlZ2ciLAogICAgICAiUm9iaW4gZWdnIiwKICAgICAgIk9zdHJpY2ggZWdnIiwKICAgICAgIkNhc3Nvd2FyeSBlZ2ciLAogICAgICAiU2FsbW9uIHJvZSIsCiAgICAgICJGcm9nc3Bhd24iLAogICAgICAiU2hhcmsgZWdnIiwKICAgICAgIlR1cnRsZSBlZ2ciLAogICAgICAiQW50IGxhcnZhIiwKICAgICAgIkdvbGRlbiBnb29zZSBlZ2ciLAogICAgICAiRmFiZXJnZSBlZ2ciLAogICAgICAiV3JpbmtsZXJzcGF3biIsCiAgICAgICJDb29raWUgZWdnIiwKICAgICAgIk9tZWxldHRlIiwKICAgICAgIkNob2NvbGF0ZSBlZ2ciLAogICAgICAiQ2VudHVyeSBlZ2ciLAogICAgICAnImVnZyInLAogICAgXTsKICAgIEdhbWUuZWdnRHJvcHMgPSBbCiAgICAgICJDaGlja2VuIGVnZyIsCiAgICAgICJEdWNrIGVnZyIsCiAgICAgICJUdXJrZXkgZWdnIiwKICAgICAgIlF1YWlsIGVnZyIsCiAgICAgICJSb2JpbiBlZ2ciLAogICAgICAiT3N0cmljaCBlZ2ciLAogICAgICAiQ2Fzc293YXJ5IGVnZyIsCiAgICAgICJTYWxtb24gcm9lIiwKICAgICAgIkZyb2dzcGF3biIsCiAgICAgICJTaGFyayBlZ2ciLAogICAgICAiVHVydGxlIGVnZyIsCiAgICAgICJBbnQgbGFydmEiLAogICAgXTsKICAgIEdhbWUucmFyZUVnZ0Ryb3BzID0gWwogICAgICAiR29sZGVuIGdvb3NlIGVnZyIsCiAgICAgICJGYWJlcmdlIGVnZyIsCiAgICAgICJXcmlua2xlcnNwYXduIiwKICAgICAgIkNvb2tpZSBlZ2ciLAogICAgICAiT21lbGV0dGUiLAogICAgICAiQ2hvY29sYXRlIGVnZyIsCiAgICAgICJDZW50dXJ5IGVnZyIsCiAgICAgICciZWdnIicsCiAgICBdOwoKICAgIEdhbWUuR2V0SG93TWFueUVnZ3MgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBudW0gPSAwOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUuZWFzdGVyRWdncykgewogICAgICAgIGlmIChHYW1lLkhhcyhHYW1lLmVhc3RlckVnZ3NbaV0pKSBudW0rKzsKICAgICAgfQogICAgICByZXR1cm4gbnVtOwogICAgfTsKICAgIGZvciAodmFyIGkgaW4gR2FtZS5lZ2dEcm9wcykgeyAvL3NjYWxlIGVnZyBwcmljZXMgdG8gaG93IG1hbnkgZWdncyB5b3UgaGF2ZQogICAgICBHYW1lLlVwZ3JhZGVzW0dhbWUuZWdnRHJvcHNbaV1dLnByaWNlRnVuYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gTWF0aC5wb3coMiwgR2FtZS5HZXRIb3dNYW55RWdncygpKSAqIDk5OTsKICAgICAgfTsKICAgIH0KCiAgICBmb3IgKHZhciBpIGluIEdhbWUucmFyZUVnZ0Ryb3BzKSB7CiAgICAgIEdhbWUuVXBncmFkZXNbR2FtZS5yYXJlRWdnRHJvcHNbaV1dLnByaWNlRnVuYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gTWF0aC5wb3coMywgR2FtZS5HZXRIb3dNYW55RWdncygpKSAqIDk5OTsKICAgICAgfTsKICAgIH0KCiAgICBHYW1lLkRyb3BFZ2cgPSBmdW5jdGlvbiAoZmFpbFJhdGUpIHsKICAgICAgZmFpbFJhdGUgKj0gMSAvIEdhbWUuZHJvcFJhdGVNdWx0KCk7CiAgICAgIGlmIChHYW1lLnNlYXNvbiAhPSAiZWFzdGVyIikgcmV0dXJuOwogICAgICBpZiAoR2FtZS5IYXNBY2hpZXYoIkhpZGUgJiBzZWVrIGNoYW1waW9uIikpIGZhaWxSYXRlICo9IDAuNzsKICAgICAgaWYgKEdhbWUuSGFzKCJPbWVsZXR0ZSIpKSBmYWlsUmF0ZSAqPSAwLjk7CiAgICAgIGlmIChHYW1lLkhhcygiU3RhcnNwYXduIikpIGZhaWxSYXRlICo9IDAuOTsKICAgICAgaWYgKEdhbWUuaGFzR29kKSB7CiAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJzZWFzb25zIik7CiAgICAgICAgaWYgKGdvZEx2bCA9PSAxKSBmYWlsUmF0ZSAqPSAwLjk7CiAgICAgICAgZWxzZSBpZiAoZ29kTHZsID09IDIpIGZhaWxSYXRlICo9IDAuOTU7CiAgICAgICAgZWxzZSBpZiAoZ29kTHZsID09IDMpIGZhaWxSYXRlICo9IDAuOTc7CiAgICAgIH0KICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPj0gZmFpbFJhdGUpIHsKICAgICAgICB2YXIgZHJvcCA9ICIiOwogICAgICAgIGlmIChNYXRoLnJhbmRvbSgpIDwgMC4xKSBkcm9wID0gY2hvb3NlKEdhbWUucmFyZUVnZ0Ryb3BzKTsKICAgICAgICBlbHNlIGRyb3AgPSBjaG9vc2UoR2FtZS5lZ2dEcm9wcyk7CiAgICAgICAgaWYgKEdhbWUuSGFzKGRyb3ApIHx8IEdhbWUuSGFzVW5sb2NrZWQoZHJvcCkpIHsKICAgICAgICAgIC8vcmVyb2xsIGlmIHdlIGhhdmUgaXQKICAgICAgICAgIGlmIChNYXRoLnJhbmRvbSgpIDwgMC4xKSBkcm9wID0gY2hvb3NlKEdhbWUucmFyZUVnZ0Ryb3BzKTsKICAgICAgICAgIGVsc2UgZHJvcCA9IGNob29zZShHYW1lLmVnZ0Ryb3BzKTsKICAgICAgICB9CiAgICAgICAgaWYgKEdhbWUuSGFzKGRyb3ApIHx8IEdhbWUuSGFzVW5sb2NrZWQoZHJvcCkpIHJldHVybjsKICAgICAgICBHYW1lLlVubG9jayhkcm9wKTsKICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgIGxvYygiWW91IGZvdW5kIGFuIGVnZyEiKSwKICAgICAgICAgICI8Yj4iICsgZHJvcCArICI8L2I+IiwKICAgICAgICAgIEdhbWUuVXBncmFkZXNbZHJvcF0uaWNvbgogICAgICAgICk7CiAgICAgIH0KICAgIH07CgogICAgb3JkZXIgPSAxMDAzMjsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJDYXJhbWVsIG1hY2Fyb25zIiwKICAgICAgZGVzYzogIlRoZSBzYWx0aWVzdCwgY2hld2llc3Qgb2YgdGhlbSBhbGwuIiwKICAgICAgaWNvbjogWzI1LCAzXSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBtYWNhcm9ucyIsCiAgICAgIHBvd2VyOiAzLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkxpY29yaWNlIG1hY2Fyb25zIiwKICAgICAgZGVzYzogJ0Fsc28ga25vd24gYXMgImJsYWNrYXJvbnMiLicsCiAgICAgIGljb246IFsyNSwgNF0sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgbWFjYXJvbnMiLAogICAgICBwb3dlcjogMywKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKCiAgICBvcmRlciA9IDUyNTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRhbGxlciB0ZWxsZXJzIiwKICAgICAgIjxxPkFibGUgdG8gcHJvY2VzcyBhIGhpZ2hlciBhbW91bnQgb2YgdHJhbnNhY3Rpb25zLiBDYXJlZnVsIHRob3VnaCwgYXMgdGFsbGVyIHRlbGxlcnMgdGVsbCB0YWxsIHRhbGVzLjwvcT4iLAogICAgICAiQmFuayIsCiAgICAgIDEKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJTY2lzc29yLXJlc2lzdGFudCBjcmVkaXQgY2FyZHMiLAogICAgICAiPHE+Rm9yIHRob3NlIHRydWx5IHZhbHVlZCBjdXN0b21lcnMuPC9xPiIsCiAgICAgICJCYW5rIiwKICAgICAgMgogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkFjaWQtcHJvb2YgdmF1bHRzIiwKICAgICAgIjxxPllvdSBrbm93IHdoYXQgdGhleSBzYXkgOiBiZXR0ZXIgc2FmZSB0aGFuIHNvcnJ5LjwvcT4iLAogICAgICAiQmFuayIsCiAgICAgIDMKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJDaG9jb2xhdGUgY29pbnMiLAogICAgICAiPHE+VGhpcyByZXZvbHV0aW9uYXJ5IGN1cnJlbmN5IGlzIG11Y2ggZWFzaWVyIHRvIG1lbHQgZnJvbSBhbmQgaW50byBpbmdvdHMgLSBhbmQgdGFzdGVzIG11Y2ggYmV0dGVyLCBmb3IgYSBjaGFuZ2UuPC9xPiIsCiAgICAgICJCYW5rIiwKICAgICAgNAogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkV4cG9uZW50aWFsIGludGVyZXN0IHJhdGVzIiwKICAgICAgIjxxPkNhbid0IGFyZ3VlIHdpdGggbWF0aGVtYXRpY3MhIE5vdyBmb3JrIGl0IG92ZXIuPC9xPiIsCiAgICAgICJCYW5rIiwKICAgICAgNQogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkZpbmFuY2lhbCB6ZW4iLAogICAgICAiPHE+VGhlIHVsdGltYXRlIGdyYWlsIG9mIGVjb25vbWljIHRob3VnaHQ7IHRoZSBmZW5nIHNodWkgb2YgYmlnIG1vbmV5LCB0aGUgc3RvY2sgbWFya2V0IHlvZ2EgLSB0aGUgSGVpbWxpY2ggbWFuZXV2ZXIgb2YgZGltZXMgYW5kIG5pY2tlbHMuPC9xPiIsCiAgICAgICJCYW5rIiwKICAgICAgNgogICAgKTsKCiAgICBvcmRlciA9IDU1MDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkdvbGRlbiBpZG9scyIsCiAgICAgICI8cT5MdXJlIGV2ZW4gZ3JlZWRpZXIgYWR2ZW50dXJlcnMgdG8gcmV0cmlldmUgeW91ciBjb29raWVzLiBOb3cgdGhhdCdzIGEgcmVhbCBpZG9sIGdhbWUhPC9xPiIsCiAgICAgICJUZW1wbGUiLAogICAgICAxCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiU2FjcmlmaWNlcyIsCiAgICAgICI8cT5XaGF0J3MgYSBsaWZlIHRvIGEgZ2lnYXRvbiBvZiBjb29raWVzPzwvcT4iLAogICAgICAiVGVtcGxlIiwKICAgICAgMgogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkRlbGljaW91cyBibGVzc2luZyIsCiAgICAgICI8cT5BbmQgbG8sIHRoZSBCYWtlcidzIGFsbWlnaHR5IHNwb29uIGNhbWUgZG93biBhbmQgZGlzdHJpYnV0ZWQgaG9seSBnaWZ0cyB1bnRvIHRoZSBiZWxpZXZlcnMgLSBzaGltbWVyaW5nIHN1Z2FyLCBhbmQgY2hvY29sYXRlIGRhcmsgYXMgbmlnaHQsIGFuZCBhbGwgbWFubmVyIG9mIHdoZWF0cy4gQW5kIGJveSBsZXQgbWUgdGVsbCB5b3UsIHRoYXQgcGFydHkgd2FzIG1pZ2h0eSBnbmFybHkuPC9xPiIsCiAgICAgICJUZW1wbGUiLAogICAgICAzCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiU3VuIGZlc3RpdmFsIiwKICAgICAgIjxxPkZyZWUgdGhlIHByaW1vcmRpYWwgcG93ZXJzIG9mIHlvdXIgdGVtcGxlcyB3aXRoIHRoZXNlIGFubnVhbCBjZWxlYnJhdGlvbnMgaW52b2x2aW5nIGZpcmUtYnJlYXRoZXJzLCB0cmFkaXRpb25hbCBkYW5jaW5nLCByaXR1YWwgYmVoZWFkaW5ncyBhbmQgb3RoZXIgbWVycmltZW50cyE8L3E+IiwKICAgICAgIlRlbXBsZSIsCiAgICAgIDQKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJFbmxhcmdlZCBwYW50aGVvbiIsCiAgICAgICI8cT5Fbm91Z2ggc3Bpcml0dWFsIGluYWRlcXVhY3khIE1vcmUgZGl2aW5pdGllcyB0aGFuIHlvdSdsbCBldmVyIG5lZWQsIG9yIHlvdXIgbW9uZXkgYmFjayEgMTAwJSBndWFyYW50ZWVkITwvcT4iLAogICAgICAiVGVtcGxlIiwKICAgICAgNQogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkdyZWF0IEJha2VyIGluIHRoZSBza3kiLAogICAgICAiPHE+VGhpcyBpcyBpdC4gVGhlIHVsdGltYXRlIGRlaXR5IGhhcyBmaW5hbGx5IGNhc3QgVGhlaXIgc3VibGltZWx5IGRpdmluZSBleWUgdXBvbiB5b3VyIG9wZXJhdGlvbjsgd2hldGhlciB0aGlzIGlzIGEgZ29vZCB0aGluZyBvciBwb3NzaWJseSB0aGUgZW5kIG9mIGRheXMgaXMgc29tZXRoaW5nIHlvdSBzaG91bGQgZmluZCBvdXQgdmVyeSBzb29uLjwvcT4iLAogICAgICAiVGVtcGxlIiwKICAgICAgNgogICAgKTsKCiAgICBvcmRlciA9IDU3NTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlBvaW50aWVyIGhhdHMiLAogICAgICAiPHE+VGVzdHMgaGF2ZSBzaG93biBpbmNyZWFzZWQgdGhhdW1pYyByZWNlcHRpdml0eSByZWxhdGl2ZSB0byB0aGUgZ2VvbWV0cmljIHByb3BvcnRpb25zIG9mIHdpemFyZGx5IGNvbmljIGltcGxlbWVudHMuPC9xPiIsCiAgICAgICJXaXphcmQgdG93ZXIiLAogICAgICAxCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQmVhcmRsaWVyIGJlYXJkcyIsCiAgICAgICI8cT5IYXZlbid0IHlvdSBoZWFyZD8gVGhlIGJlYXJkIGlzIHRoZSB3b3JkLjwvcT4iLAogICAgICAiV2l6YXJkIHRvd2VyIiwKICAgICAgMgogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkFuY2llbnQgZ3JpbW9pcmVzIiwKICAgICAgJzxxPkNvbnRhaW4gaW50ZXJlc3Rpbmcgc3BlbGxzIHN1Y2ggYXMgIlR1cm4gV2F0ZXIgVG8gRHJvb2wiLCAiR3JvdyBFeWVicm93cyBPbiBGdXJuaXR1cmUiIGFuZCAiU3VtbW9uIFBvbGl0aWNpYW4iLjwvcT4nLAogICAgICAiV2l6YXJkIHRvd2VyIiwKICAgICAgMwogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIktpdGNoZW4gY3Vyc2VzIiwKICAgICAgIjxxPkV4b3RpYyBtYWdpYyBpbnZvbHZlZCBpbiBhbGwgdGhpbmdzIHBhc3RyeS1yZWxhdGVkLiBIZXhjZWxsZW50ITwvcT4iLAogICAgICAiV2l6YXJkIHRvd2VyIiwKICAgICAgNAogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlNjaG9vbCBvZiBzb3JjZXJ5IiwKICAgICAgIjxxPlRoaXMgY29va2llLWZ1bmRlZCBhY2FkZW15IG9mIHdpdGNoY3JhZnQgaXMgaG9tZSB0byB0aGUgNCBwcmVzdGlnaW91cyBob3VzZXMgb2YgbWFnaWMgOiB0aGUgSm9ja3MsIHRoZSBOZXJkcywgdGhlIFByZXBzLCBhbmQgdGhlIERlYXRobXVuY2hlcnMuPC9xPiIsCiAgICAgICJXaXphcmQgdG93ZXIiLAogICAgICA1CiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRGFyayBmb3JtdWxhcyIsCiAgICAgICI8cT5FbGRyaXRjaCBmb3JjZXMgYXJlIGF0IHdvcmsgYmVoaW5kIHRoZXNlIHNwZWxscyAtIHlvdSBnZXQgdGhlIGZlZWxpbmcgeW91IHJlYWxseSBzaG91bGRuJ3QgYmUgbWVzc2luZyB3aXRoIHRob3NlLiBCdXQgSSBtZWFuLCBmcmVlIGNvb2tpZXMsIHJpZ2h0PzwvcT4iLAogICAgICAiV2l6YXJkIHRvd2VyIiwKICAgICAgNgogICAgKTsKCiAgICBvcmRlciA9IDI1MDsKICAgIEdhbWUuR3JhbmRtYVN5bmVyZ3koCiAgICAgICJCYW5rZXIgZ3JhbmRtYXMiLAogICAgICAiQSBuaWNlIGJhbmtlciB0byBjYXNoIGluIG1vcmUgY29va2llcy4iLAogICAgICAiQmFuayIKICAgICk7CiAgICBHYW1lLkdyYW5kbWFTeW5lcmd5KAogICAgICAiUHJpZXN0ZXNzIGdyYW5kbWFzIiwKICAgICAgIkEgbmljZSBwcmllc3Rlc3MgdG8gcHJhaXNlIHRoZSBvbmUgdHJ1ZSBCYWtlciBpbiB0aGUgc2t5LiIsCiAgICAgICJUZW1wbGUiCiAgICApOwogICAgR2FtZS5HcmFuZG1hU3luZXJneSgKICAgICAgIldpdGNoIGdyYW5kbWFzIiwKICAgICAgIkEgbmljZSB3aXRjaCB0byBjYXN0IGEgemlwLCBhbmQgYSB6b29wLCBhbmQgcG9vZiEgQ29va2llcy4iLAogICAgICAiV2l6YXJkIHRvd2VyIgogICAgKTsKCiAgICBvcmRlciA9IDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiVGluIG9mIGJyaXRpc2ggdGVhIGJpc2N1aXRzIiwKICAgICAgbG9jKCJDb250YWlucyBhbiBhc3NvcnRtZW50IG9mIGZhbmN5IGJpc2N1aXRzLiIpICsKICAgICAgICAiPHE+RXZlcnkgdGltZSBpcyB0ZWEgdGltZS48L3E+IiwKICAgICAgMjUsCiAgICAgIFsyMSwgOF0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiSGVhdmVubHkgY29va2llcyJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkJveCBvZiBtYWNhcm9ucyIsCiAgICAgIGxvYygiQ29udGFpbnMgYW4gYXNzb3J0bWVudCBvZiBtYWNhcm9ucy4iKSArCiAgICAgICAgIjxxPk11bHRpY29sb3JlZCBkZWxpY2FjaWVzIGZpbGxlZCB3aXRoIHZhcmlvdXMga2luZHMgb2YgamFtLjxicj5Ob3QgdG8gYmUgY29uZnVzZWQgd2l0aCBtYWNhcm9vbnMsIG1hY2Fyb25pLCBtYWNhcmVuYSBvciBhbnkgb2YgdGhhdCBub25zZW5zZS48L3E+IiwKICAgICAgMjUsCiAgICAgIFsyMCwgOF0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiSGVhdmVubHkgY29va2llcyJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkJveCBvZiBicmFuZCBiaXNjdWl0cyIsCiAgICAgIGxvYygiQ29udGFpbnMgYW4gYXNzb3J0bWVudCBvZiBwb3B1bGFyIGJpc2N1aXRzLiIpICsKICAgICAgICAiPHE+VGhleSdyZSBicmFuZCBuZXchPC9xPiIsCiAgICAgIDI1LAogICAgICBbMjAsIDldCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkhlYXZlbmx5IGNvb2tpZXMiXTsKCiAgICBvcmRlciA9IDEwMDIwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlB1cmUgYmxhY2sgY2hvY29sYXRlIGNvb2tpZXMiLAogICAgICBkZXNjOiAnRGlwcGVkIGluIGEgbGFiLW1hZGUgc3Vic3RhbmNlIGRhcmtlciB0aGFuIHRoZSBkYXJrZXN0IGNvY29hIChkdWJiZWQgImNob2NvYWxhdGUiKS4nLAogICAgICBpY29uOiBbMjYsIDNdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiUHVyZSB3aGl0ZSBjaG9jb2xhdGUgY29va2llcyIsCiAgICAgIGRlc2M6ICJFbGFib3JhdGVkIG9uIHRoZSBuYW5vLXNjYWxlLCB0aGUgY29hdGluZyBvbiB0aGlzIGJpc2N1aXQgaXMgYWJsZSB0byByZWZyYWN0IGxpZ2h0IGV2ZW4gaW4gYSBwaXRjaC1ibGFjayBlbnZpcm9ubWVudC4iLAogICAgICBpY29uOiBbMjYsIDRdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiTGFkeWZpbmdlcnMiLAogICAgICBkZXNjOiAiQ2xlYW5lZCBhbmQgc2FuaXRpemVkIHNvIHdlbGwgeW91J2Qgc3dlYXIgdGhleSdyZSBhY3R1YWwgYmlzY3VpdHMuIiwKICAgICAgaWNvbjogWzI3LCAzXSwKICAgICAgcG93ZXI6IDMsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlR1aWxlcyIsCiAgICAgIGRlc2M6ICJUaGVzZSBuZXZlciBnbyBvdXQgb2YgdGlsZS4iLAogICAgICBpY29uOiBbMjcsIDRdLAogICAgICBwb3dlcjogMywKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkNob2NvbGF0ZS1zdHVmZmVkIGJpc2N1aXRzIiwKICAgICAgZGVzYzogIkEgcHJpbmNlbHkgc25hY2shPGJyPlRoZSBob2xlcyBhcmUgc28gdGhlIGNob2NvbGF0ZSBzdHVmZmluZyBjYW4gYnJlYXRoZS4iLAogICAgICBpY29uOiBbMjgsIDNdLAogICAgICBwb3dlcjogMywKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkNoZWNrZXIgY29va2llcyIsCiAgICAgIGRlc2M6ICJBIHNxdWFyZSBjb29raWU/IFRoaXMgc29sdmVzIHNvIG1hbnkgc3RvcmFnZSBhbmQgcGFja2FnaW5nIHByb2JsZW1zISBZb3UncmUgYSBnZW5pdXMhIiwKICAgICAgaWNvbjogWzI4LCA0XSwKICAgICAgcG93ZXI6IDMsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQnV0dGVyIGNvb2tpZXMiLAogICAgICBkZXNjOiAiVGhlc2UgbWVsdCByaWdodCBvZmYgeW91ciBtb3V0aCBhbmQgaW50byB5b3VyIGhlYXJ0LiAoTGV0J3MgZmFjZSBpdCwgdGhleSdyZSByYXRoZXIgZmF0dGVuaW5nLikiLAogICAgICBpY29uOiBbMjksIDNdLAogICAgICBwb3dlcjogMywKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJDcmVhbSBjb29raWVzIiwKICAgICAgZGVzYzogIkl0J3MgbGlrZSB0d28gY2hvY29sYXRlIGNoaXAgY29va2llcyEgQnV0IGJyb3VnaHQgdG9nZXRoZXIgd2l0aCB0aGUgbWFnaWMgb2YgY3JlYW0hIEl0J3MgZmllbmRpc2hseSBwZXJmZWN0ISIsCiAgICAgIGljb246IFsyOSwgNF0sCiAgICAgIHBvd2VyOiAzLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OSAqIDUsCiAgICB9KTsKCiAgICBvcmRlciA9IDA7CiAgICB2YXIgZGVzYyA9IGxvYygKICAgICAgIlBsYWNpbmcgYW4gdXBncmFkZSBpbiB0aGlzIHNsb3Qgd2lsbCBtYWtlIGl0cyBlZmZlY3RzIDxiPnBlcm1hbmVudDwvYj4gYWNyb3NzIGFsbCBwbGF5dGhyb3VnaHMuIgogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoIlBlcm1hbmVudCB1cGdyYWRlIHNsb3QgSSIsIGRlc2MsIDEwMCwgWzAsIDEwXSk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QuaWNvbkZ1bmN0aW9uID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gR2FtZS5QZXJtYW5lbnRTbG90SWNvbigwKTsKICAgIH07CiAgICBHYW1lLmxhc3QuYWN0aXZhdGVGdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgR2FtZS5Bc3NpZ25QZXJtYW5lbnRTbG90KDApOwogICAgfTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoIlBlcm1hbmVudCB1cGdyYWRlIHNsb3QgSUkiLCBkZXNjLCAyMDAwMCwgWzEsIDEwXSk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiUGVybWFuZW50IHVwZ3JhZGUgc2xvdCBJIl07CiAgICBHYW1lLmxhc3QuaWNvbkZ1bmN0aW9uID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gR2FtZS5QZXJtYW5lbnRTbG90SWNvbigxKTsKICAgIH07CiAgICBHYW1lLmxhc3QuYWN0aXZhdGVGdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgR2FtZS5Bc3NpZ25QZXJtYW5lbnRTbG90KDEpOwogICAgfTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoIlBlcm1hbmVudCB1cGdyYWRlIHNsb3QgSUlJIiwgZGVzYywgMzAwMDAwMCwgWzIsIDEwXSk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiUGVybWFuZW50IHVwZ3JhZGUgc2xvdCBJSSJdOwogICAgR2FtZS5sYXN0Lmljb25GdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIEdhbWUuUGVybWFuZW50U2xvdEljb24oMik7CiAgICB9OwogICAgR2FtZS5sYXN0LmFjdGl2YXRlRnVuY3Rpb24gPSBmdW5jdGlvbiAoKSB7CiAgICAgIEdhbWUuQXNzaWduUGVybWFuZW50U2xvdCgyKTsKICAgIH07CiAgICBuZXcgR2FtZS5VcGdyYWRlKCJQZXJtYW5lbnQgdXBncmFkZSBzbG90IElWIiwgZGVzYywgNDAwMDAwMDAwLCBbMywgMTBdKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJQZXJtYW5lbnQgdXBncmFkZSBzbG90IElJSSJdOwogICAgR2FtZS5sYXN0Lmljb25GdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIEdhbWUuUGVybWFuZW50U2xvdEljb24oMyk7CiAgICB9OwogICAgR2FtZS5sYXN0LmFjdGl2YXRlRnVuY3Rpb24gPSBmdW5jdGlvbiAoKSB7CiAgICAgIEdhbWUuQXNzaWduUGVybWFuZW50U2xvdCgzKTsKICAgIH07CiAgICBuZXcgR2FtZS5VcGdyYWRlKCJQZXJtYW5lbnQgdXBncmFkZSBzbG90IFYiLCBkZXNjLCA1MDAwMDAwMDAwMCwgWzQsIDEwXSk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiUGVybWFuZW50IHVwZ3JhZGUgc2xvdCBJViJdOwogICAgR2FtZS5sYXN0Lmljb25GdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIEdhbWUuUGVybWFuZW50U2xvdEljb24oNCk7CiAgICB9OwogICAgR2FtZS5sYXN0LmFjdGl2YXRlRnVuY3Rpb24gPSBmdW5jdGlvbiAoKSB7CiAgICAgIEdhbWUuQXNzaWduUGVybWFuZW50U2xvdCg0KTsKICAgIH07CgogICAgdmFyIHNsb3RzID0gWwogICAgICAiUGVybWFuZW50IHVwZ3JhZGUgc2xvdCBJIiwKICAgICAgIlBlcm1hbmVudCB1cGdyYWRlIHNsb3QgSUkiLAogICAgICAiUGVybWFuZW50IHVwZ3JhZGUgc2xvdCBJSUkiLAogICAgICAiUGVybWFuZW50IHVwZ3JhZGUgc2xvdCBJViIsCiAgICAgICJQZXJtYW5lbnQgdXBncmFkZSBzbG90IFYiLAogICAgXTsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2xvdHMubGVuZ3RoOyBpKyspIHsKICAgICAgR2FtZS5VcGdyYWRlc1tzbG90c1tpXV0uZGVzY0Z1bmMgPSAoZnVuY3Rpb24gKGkpIHsKICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGNvbnRleHQpIHsKICAgICAgICAgIGlmIChHYW1lLnBlcm1hbmVudFVwZ3JhZGVzW2ldID09IC0xKQogICAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAgIHRoaXMuZGVzYyArCiAgICAgICAgICAgICAgKGNvbnRleHQgPT0gInN0YXRzIgogICAgICAgICAgICAgICAgPyAiIgogICAgICAgICAgICAgICAgOiAiPGJyPjxiPiIgKyBsb2MoIkNsaWNrIHRvIGFjdGl2YXRlLiIpICsgIjwvYj4iKQogICAgICAgICAgICApOwogICAgICAgICAgdmFyIHVwZ3JhZGUgPSBHYW1lLlVwZ3JhZGVzQnlJZFtHYW1lLnBlcm1hbmVudFVwZ3JhZGVzW2ldXTsKICAgICAgICAgIHJldHVybiAoCiAgICAgICAgICAgICc8ZGl2IHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsiPicgKwogICAgICAgICAgICBsb2MoIkN1cnJlbnQ6IikgKwogICAgICAgICAgICAiICIgKwogICAgICAgICAgICB0aW55SWNvbih1cGdyYWRlLmljb24pICsKICAgICAgICAgICAgIiA8Yj4iICsKICAgICAgICAgICAgdXBncmFkZS5kbmFtZSArCiAgICAgICAgICAgICc8L2I+PGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+PC9kaXY+JyArCiAgICAgICAgICAgIHRoaXMuZGRlc2MgKwogICAgICAgICAgICAoY29udGV4dCA9PSAic3RhdHMiCiAgICAgICAgICAgICAgPyAiIgogICAgICAgICAgICAgIDogIjxicj48Yj4iICsgbG9jKCJDbGljayB0byBhY3RpdmF0ZS4iKSArICI8L2I+IikKICAgICAgICAgICk7CiAgICAgICAgfTsKICAgICAgfSkoaSk7CiAgICB9CgogICAgR2FtZS5QZXJtYW5lbnRTbG90SWNvbiA9IGZ1bmN0aW9uIChzbG90KSB7CiAgICAgIGlmIChHYW1lLnBlcm1hbmVudFVwZ3JhZGVzW3Nsb3RdID09IC0xKSByZXR1cm4gW3Nsb3QsIDEwXTsKICAgICAgcmV0dXJuIEdhbWUuVXBncmFkZXNCeUlkW0dhbWUucGVybWFuZW50VXBncmFkZXNbc2xvdF1dLmljb247CiAgICB9OwogICAgR2FtZS5Bc3NpZ25QZXJtYW5lbnRTbG90ID0gZnVuY3Rpb24gKHNsb3QpIHsKICAgICAgUGxheVNvdW5kKCJzbmQvdGljay5tcDMiKTsKICAgICAgR2FtZS50b29sdGlwLmhpZGUoKTsKICAgICAgdmFyIGxpc3QgPSBbXTsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlVwZ3JhZGVzKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5VcGdyYWRlc1tpXTsKICAgICAgICBpZiAoCiAgICAgICAgICBtZS5ib3VnaHQgJiYKICAgICAgICAgIG1lLnVubG9ja2VkICYmCiAgICAgICAgICAhbWUubm9QZXJtICYmCiAgICAgICAgICAobWUucG9vbCA9PSAiIiB8fCBtZS5wb29sID09ICJjb29raWUiKQogICAgICAgICkgewogICAgICAgICAgdmFyIGZhaWwgPSAwOwogICAgICAgICAgZm9yICh2YXIgaWkgaW4gR2FtZS5wZXJtYW5lbnRVcGdyYWRlcykgewogICAgICAgICAgICBpZiAoR2FtZS5wZXJtYW5lbnRVcGdyYWRlc1tpaV0gPT0gbWUuaWQpIGZhaWwgPSAxOwogICAgICAgICAgfSAvL2NoZWNrIGlmIG5vdCBhbHJlYWR5IGluIGFub3RoZXIgcGVybWFzbG90CiAgICAgICAgICBpZiAoIWZhaWwpIGxpc3QucHVzaChtZSk7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgc29ydE1hcCA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgaWYgKGEub3JkZXIgPiBiLm9yZGVyKSByZXR1cm4gMTsKICAgICAgICBlbHNlIGlmIChhLm9yZGVyIDwgYi5vcmRlcikgcmV0dXJuIC0xOwogICAgICAgIGVsc2UgcmV0dXJuIDA7CiAgICAgIH07CiAgICAgIGxpc3Quc29ydChzb3J0TWFwKTsKCiAgICAgIHZhciB1cGdyYWRlcyA9ICIiOwogICAgICBmb3IgKHZhciBpIGluIGxpc3QpIHsKICAgICAgICB2YXIgbWUgPSBsaXN0W2ldOwogICAgICAgIHVwZ3JhZGVzICs9IEdhbWUuY3JhdGUoCiAgICAgICAgICBtZSwKICAgICAgICAgICIiLAogICAgICAgICAgIlBsYXlTb3VuZCgnc25kL3RpY2subXAzJyk7R2FtZS5QdXRVcGdyYWRlSW5QZXJtYW5lbnRTbG90KCIgKwogICAgICAgICAgICBtZS5pZCArCiAgICAgICAgICAgICIsIiArCiAgICAgICAgICAgIHNsb3QgKwogICAgICAgICAgICAiKTsiLAogICAgICAgICAgInVwZ3JhZGVGb3JQZXJtYW5lbnQiICsgbWUuaWQKICAgICAgICApOwogICAgICB9CiAgICAgIHZhciB1cGdyYWRlID0gR2FtZS5wZXJtYW5lbnRVcGdyYWRlc1tzbG90XTsKICAgICAgR2FtZS5TZWxlY3RpbmdQZXJtYW5lbnRVcGdyYWRlID0gdXBncmFkZTsKICAgICAgR2FtZS5Qcm9tcHQoCiAgICAgICAgIjxpZCBQaWNrUGVybWFVcGdyYWRlPjxoMz4iICsKICAgICAgICAgIGxvYygiUGljayBhbiB1cGdyYWRlIHRvIG1ha2UgcGVybWFuZW50IikgKwogICAgICAgICAgIjwvaDM+IiArCiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+PGRpdiBzdHlsZT0ibWFyZ2luOjRweCBhdXRvO2NsZWFyOmJvdGg7d2lkdGg6MTIwcHg7Ij48ZGl2IGNsYXNzPSJjcmF0ZSB1cGdyYWRlIGVuYWJsZWQiIHN0eWxlPSJiYWNrZ3JvdW5kLXBvc2l0aW9uOicgKwogICAgICAgICAgLXNsb3QgKiA0OCArCiAgICAgICAgICAicHggIiArCiAgICAgICAgICAtMTAgKiA0OCArCiAgICAgICAgICAncHg7Ij48L2Rpdj48ZGl2IGlkPSJ1cGdyYWRlVG9TbG90Tm9uZSIgY2xhc3M9ImNyYXRlIHVwZ3JhZGUgZW5hYmxlZCIgc3R5bGU9ImJhY2tncm91bmQtcG9zaXRpb246JyArCiAgICAgICAgICAtMCAqIDQ4ICsKICAgICAgICAgICJweCAiICsKICAgICAgICAgIC03ICogNDggKwogICAgICAgICAgInB4O2Rpc3BsYXk6IiArCiAgICAgICAgICAodXBncmFkZSAhPSAtMSA/ICJub25lIiA6ICJibG9jayIpICsKICAgICAgICAgICc7Ij48L2Rpdj48ZGl2IGlkPSJ1cGdyYWRlVG9TbG90V3JhcCIgc3R5bGU9ImZsb2F0OmxlZnQ7ZGlzcGxheTonICsKICAgICAgICAgICh1cGdyYWRlID09IC0xID8gIm5vbmUiIDogImJsb2NrIikgKwogICAgICAgICAgJzsiPicgKwogICAgICAgICAgR2FtZS5jcmF0ZSgKICAgICAgICAgICAgR2FtZS5VcGdyYWRlc0J5SWRbdXBncmFkZSA9PSAtMSA/IDAgOiB1cGdyYWRlXSwKICAgICAgICAgICAgIiIsCiAgICAgICAgICAgICIiLAogICAgICAgICAgICAidXBncmFkZVRvU2xvdCIKICAgICAgICAgICkgKwogICAgICAgICAgIjwvZGl2PjwvZGl2PiIgKwogICAgICAgICAgJzxkaXYgY2xhc3M9ImJsb2NrIGNyYXRlQm94IiBzdHlsZT0ib3ZlcmZsb3cteTpzY3JvbGw7ZmxvYXQ6bGVmdDtjbGVhcjpsZWZ0O3dpZHRoOjMxN3B4O3BhZGRpbmc6MHB4O2hlaWdodDoyNTBweDsiPicgKwogICAgICAgICAgdXBncmFkZXMgKwogICAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICAgJzxkaXYgY2xhc3M9ImJsb2NrIiBzdHlsZT0iZmxvYXQ6cmlnaHQ7d2lkdGg6MTUycHg7Y2xlYXI6cmlnaHQ7aGVpZ2h0OjIzNHB4OyI+JyArCiAgICAgICAgICBsb2MoCiAgICAgICAgICAgICdIZXJlIGFyZSBhbGwgdGhlIHVwZ3JhZGVzIHlvdVwndmUgcHVyY2hhc2VkIGxhc3QgcGxheXRocm91Z2guPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+UGljayBvbmUgdG8gcGVybWFuZW50bHkgZ2FpbiBpdHMgZWZmZWN0cyE8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj5Zb3UgY2FuIHJlYXNzaWduIHRoaXMgc2xvdCBhbnl0aW1lIHlvdSBhc2NlbmQuJwogICAgICAgICAgKSArCiAgICAgICAgICAiPC9kaXY+IiwKICAgICAgICBbCiAgICAgICAgICBbCiAgICAgICAgICAgIGxvYygiQ29uZmlybSIpLAogICAgICAgICAgICAiR2FtZS5wZXJtYW5lbnRVcGdyYWRlc1siICsKICAgICAgICAgICAgICBzbG90ICsKICAgICAgICAgICAgICAiXT1HYW1lLlNlbGVjdGluZ1Blcm1hbmVudFVwZ3JhZGU7R2FtZS5CdWlsZEFzY2VuZFRyZWUoKTtHYW1lLkNsb3NlUHJvbXB0KCk7IiwKICAgICAgICAgIF0sCiAgICAgICAgICBsb2MoIkNhbmNlbCIpLAogICAgICAgIF0sCiAgICAgICAgMCwKICAgICAgICAid2lkZVByb21wdCIKICAgICAgKTsKICAgIH07CiAgICBHYW1lLlNlbGVjdGluZ1Blcm1hbmVudFVwZ3JhZGUgPSAtMTsKICAgIEdhbWUuUHV0VXBncmFkZUluUGVybWFuZW50U2xvdCA9IGZ1bmN0aW9uICh1cGdyYWRlLCBzbG90KSB7CiAgICAgIEdhbWUuU2VsZWN0aW5nUGVybWFuZW50VXBncmFkZSA9IHVwZ3JhZGU7CiAgICAgIGwoInVwZ3JhZGVUb1Nsb3RXcmFwIikuaW5uZXJIVE1MID0gIiI7CiAgICAgIGwoInVwZ3JhZGVUb1Nsb3RXcmFwIikuc3R5bGUuZGlzcGxheSA9IHVwZ3JhZGUgPT0gLTEgPyAibm9uZSIgOiAiYmxvY2siOwogICAgICBsKCJ1cGdyYWRlVG9TbG90Tm9uZSIpLnN0eWxlLmRpc3BsYXkgPSB1cGdyYWRlICE9IC0xID8gIm5vbmUiIDogImJsb2NrIjsKICAgICAgbCgidXBncmFkZVRvU2xvdFdyYXAiKS5pbm5lckhUTUwgPSBHYW1lLmNyYXRlKAogICAgICAgIEdhbWUuVXBncmFkZXNCeUlkW3VwZ3JhZGUgPT0gLTEgPyAwIDogdXBncmFkZV0sCiAgICAgICAgIiIsCiAgICAgICAgIiIsCiAgICAgICAgInVwZ3JhZGVUb1Nsb3QiCiAgICAgICk7CiAgICB9OwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTdGFyc3Bhd24iLAogICAgICBsb2MoIkVnZ3MgZHJvcCA8Yj4lMSU8L2I+IG1vcmUgb2Z0ZW4uIiwgMTApICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiR29sZGVuIGNvb2tpZXMgYXBwZWFyIDxiPiUxJTwvYj4gbW9yZSBvZnRlbiBkdXJpbmcgJTIuIiwgWwogICAgICAgICAgMiwKICAgICAgICAgIGxvYygiRWFzdGVyIiksCiAgICAgICAgXSksCiAgICAgIDExMTExMSwKICAgICAgWzAsIDEyXQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJTZWFzb24gc3dpdGNoZXIiXTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTdGFyc25vdyIsCiAgICAgIGxvYygiQ2hyaXN0bWFzIGNvb2tpZXMgZHJvcCA8Yj4lMSU8L2I+IG1vcmUgb2Z0ZW4uIiwgNSkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJSZWluZGVlciBhcHBlYXIgPGI+JTElPC9iPiBtb3JlIG9mdGVuLiIsIDUpLAogICAgICAxMTExMTEsCiAgICAgIFsxMiwgOV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiU2Vhc29uIHN3aXRjaGVyIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiU3RhcnRlcnJvciIsCiAgICAgIGxvYygiU3Bvb2t5IGNvb2tpZXMgZHJvcCA8Yj4lMSU8L2I+IG1vcmUgb2Z0ZW4uIiwgMTApICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiR29sZGVuIGNvb2tpZXMgYXBwZWFyIDxiPiUxJTwvYj4gbW9yZSBvZnRlbiBkdXJpbmcgJTIuIiwgWwogICAgICAgICAgMiwKICAgICAgICAgIGxvYygiSGFsbG93ZWVuIiksCiAgICAgICAgXSksCiAgICAgIDExMTExMSwKICAgICAgWzEzLCA4XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJTZWFzb24gc3dpdGNoZXIiXTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTdGFybG92ZSIsCiAgICAgIGxvYygiSGVhcnQgY29va2llcyBhcmUgPGI+JTElPC9iPiBtb3JlIHBvd2VyZnVsLiIsIDUwKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoIkdvbGRlbiBjb29raWVzIGFwcGVhciA8Yj4lMSU8L2I+IG1vcmUgb2Z0ZW4gZHVyaW5nICUyLiIsIFsKICAgICAgICAgIDIsCiAgICAgICAgICBsb2MoIlZhbGVudGluZSdzIGRheSIpLAogICAgICAgIF0pLAogICAgICAxMTExMTEsCiAgICAgIFsyMCwgM10KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiU2Vhc29uIHN3aXRjaGVyIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiU3RhcnRyYWRlIiwKICAgICAgbG9jKCJHb2xkZW4gY29va2llcyBhcHBlYXIgPGI+JTElPC9iPiBtb3JlIG9mdGVuIGR1cmluZyAlMi4iLCBbCiAgICAgICAgNSwKICAgICAgICBsb2MoIkJ1c2luZXNzIGRheSIpLAogICAgICBdKSwKICAgICAgMTExMTExLAogICAgICBbMTcsIDZdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIlNlYXNvbiBzd2l0Y2hlciJdOwoKICAgIHZhciBhbmdlbFByaWNlRmFjdG9yID0gNzsKICAgIHZhciBkZXNjID0gZnVuY3Rpb24gKHBlcmNlbnQsIHRvdGFsKSB7CiAgICAgIHJldHVybiBsb2MoCiAgICAgICAgIllvdSBnYWluIGFub3RoZXIgPGI+KyUxJTwvYj4gb2YgeW91ciByZWd1bGFyIENwUyB3aGlsZSB0aGUgZ2FtZSBpcyBjbG9zZWQsIGZvciBhIHRvdGFsIG9mIDxiPiUyJTwvYj4uIiwKICAgICAgICBbcGVyY2VudCwgdG90YWxdCiAgICAgICk7CiAgICB9OwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkFuZ2VscyIsCiAgICAgIGRlc2MoMTAsIDE1KSArCiAgICAgICAgIjxxPkxvd2VzdC1yYW5raW5nIGF0IHRoZSBmaXJzdCBzcGhlcmUgb2YgcGFzdHJ5IGhlYXZlbiwgYW5nZWxzIGFyZSB0YXNrZWQgd2l0aCBkZWxpdmVyaW5nIG5ldyByZWNpcGVzIHRvIHRoZSBtb3J0YWxzIHRoZXkgZGVlbSB3b3J0aHkuPC9xPiIsCiAgICAgIE1hdGgucG93KGFuZ2VsUHJpY2VGYWN0b3IsIDEpLAogICAgICBbMCwgMTFdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIlR3aW4gR2F0ZXMgb2YgVHJhbnNjZW5kZW5jZSJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkFyY2hhbmdlbHMiLAogICAgICBkZXNjKDEwLCAyNSkgKwogICAgICAgICI8cT5NZW1iZXJzIG9mIHRoZSBmaXJzdCBzcGhlcmUgb2YgcGFzdHJ5IGhlYXZlbiwgYXJjaGFuZ2VscyBhcmUgcmVzcG9uc2libGUgZm9yIHRoZSBzbW9vdGggZnVuY3Rpb25pbmcgb2YgdGhlIHdvcmxkJ3MgbGFyZ2VzdCBiYWtlcmllcy48L3E+IiwKICAgICAgTWF0aC5wb3coYW5nZWxQcmljZUZhY3RvciwgMiksCiAgICAgIFsxLCAxMV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiQW5nZWxzIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiVmlydHVlcyIsCiAgICAgIGRlc2MoMTAsIDM1KSArCiAgICAgICAgIjxxPkZvdW5kIGF0IHRoZSBzZWNvbmQgc3BoZXJlIG9mIHBhc3RyeSBoZWF2ZW4sIHZpcnR1ZXMgbWFrZSB1c2Ugb2YgdGhlaXIgaGVhdmVubHkgc3RyZW5ndGggdG8gcHVzaCBhbmQgZHJhZyB0aGUgc3RhcnMgb2YgdGhlIGNvc21vcy48L3E+IiwKICAgICAgTWF0aC5wb3coYW5nZWxQcmljZUZhY3RvciwgMyksCiAgICAgIFsyLCAxMV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiQXJjaGFuZ2VscyJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkRvbWluaW9ucyIsCiAgICAgIGRlc2MoMTAsIDQ1KSArCiAgICAgICAgIjxxPlJ1bGluZyBvdmVyIHRoZSBzZWNvbmQgc3BoZXJlIG9mIHBhc3RyeSBoZWF2ZW4sIGRvbWluaW9ucyBob2xkIGEgbWFuYWdlcmlhbCBwb3NpdGlvbiBhbmQgYXJlIGluIGNoYXJnZSBvZiBhY2NvdW50aW5nIGFuZCByZWd1bGF0aW5nIHNjaGVkdWxlcy48L3E+IiwKICAgICAgTWF0aC5wb3coYW5nZWxQcmljZUZhY3RvciwgNCksCiAgICAgIFszLCAxMV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiVmlydHVlcyJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkNoZXJ1YmltIiwKICAgICAgZGVzYygxMCwgNTUpICsKICAgICAgICAiPHE+U2llZ2luZyBhdCB0aGUgZmlyc3Qgc3BoZXJlIG9mIHBhc3RyeSBoZWF2ZW4sIHRoZSBmb3VyLWZhY2VkIGNoZXJ1YmltIHNlcnZlIGFzIGhlYXZlbmx5IGJvdW5jZXJzIGFuZCBib2R5Z3VhcmRzLjwvcT4iLAogICAgICBNYXRoLnBvdyhhbmdlbFByaWNlRmFjdG9yLCA1KSwKICAgICAgWzQsIDExXQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJEb21pbmlvbnMiXTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTZXJhcGhpbSIsCiAgICAgIGRlc2MoMTAsIDY1KSArCiAgICAgICAgIjxxPkxlYWRpbmcgdGhlIGZpcnN0IHNwaGVyZSBvZiBwYXN0cnkgaGVhdmVuLCBzZXJhcGhpbSBwb3NzZXNzIHVsdGltYXRlIGtub3dsZWRnZSBvZiBldmVyeXRoaW5nIHBlcnRhaW5pbmcgdG8gYmFraW5nLjwvcT4iLAogICAgICBNYXRoLnBvdyhhbmdlbFByaWNlRmFjdG9yLCA2KSwKICAgICAgWzUsIDExXQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJDaGVydWJpbSJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkdvZCIsCiAgICAgIGRlc2MoMTAsIDc1KSArICI8cT5MaWtlIFNhbnRhLCBidXQgbGVzcyBmdW4uPC9xPiIsCiAgICAgIE1hdGgucG93KGFuZ2VsUHJpY2VGYWN0b3IsIDcpLAogICAgICBbNiwgMTFdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIlNlcmFwaGltIl07CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlR3aW4gR2F0ZXMgb2YgVHJhbnNjZW5kZW5jZSIsCiAgICAgIGxvYygKICAgICAgICAiWW91IG5vdyA8Yj5rZWVwIG1ha2luZyBjb29raWVzIHdoaWxlIHRoZSBnYW1lIGlzIGNsb3NlZDwvYj4sIGF0IHRoZSByYXRlIG9mIDxiPiUxJTwvYj4gb2YgeW91ciByZWd1bGFyIENwUyBhbmQgdXAgdG8gPGI+MSBob3VyPC9iPiBhZnRlciB0aGUgZ2FtZSBpcyBjbG9zZWQuPGJyPihCZXlvbmQgMSBob3VyLCB0aGlzIGlzIHJlZHVjZWQgYnkgYSBmdXJ0aGVyICUyJSAtIHlvdXIgcmF0ZSBnb2VzIGRvd24gdG8gPGI+JTMlPC9iPiBvZiB5b3VyIENwUy4pIiwKICAgICAgICBbNSwgOTAsIDAuNV0KICAgICAgKSArCiAgICAgICAgIjxxPlRoaXMgaXMgb25lIG9jY2FzaW9uIHlvdSdyZSBhbHdheXMgdW5kZXJkcmVzc2VkIGZvci4gRG9uJ3Qgd29ycnksIGp1c3QgcnVzaCBpbiBwYXN0IHRoZSBib3VuY2VyIGFuZCBwcmV0ZW5kIHlvdSBrbm93IHBlb3BsZS48L3E+IiwKICAgICAgMSwKICAgICAgWzE1LCAxMV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkhlYXZlbmx5IGx1Y2siLAogICAgICBsb2MoIkdvbGRlbiBjb29raWVzIGFwcGVhciA8Yj4lMSU8L2I+IG1vcmUgb2Z0ZW4uIiwgNSkgKwogICAgICAgICI8cT5Tb21lb25lIHVwIHRoZXJlIGxpa2VzIHlvdS48L3E+IiwKICAgICAgNzcsCiAgICAgIFsyMiwgNl0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiTGFzdGluZyBmb3J0dW5lIiwKICAgICAgbG9jKCJHb2xkZW4gY29va2llIGVmZmVjdHMgbGFzdCA8Yj4lMSU8L2I+IGxvbmdlci4iLCAxMCkgKwogICAgICAgICI8cT5UaGlzIGlzbid0IHlvdXIgYXZlcmFnZSBldmVyeWRheSBsdWNrLiBUaGlzIGlzLi4uIGFkdmFuY2VkIGx1Y2suPC9xPiIsCiAgICAgIDc3NywKICAgICAgWzIzLCA2XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJIZWF2ZW5seSBsdWNrIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRGVjaXNpdmUgZmF0ZSIsCiAgICAgIGxvYygiR29sZGVuIGNvb2tpZXMgc3RheSA8Yj4lMSU8L2I+IGxvbmdlci4iLCA1KSArCiAgICAgICAgIjxxPkxpZmUganVzdCBnb3QgYSBiaXQgbW9yZSBpbnRlbnNlLjwvcT4iLAogICAgICA3Nzc3LAogICAgICBbMTAsIDE0XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJMYXN0aW5nIGZvcnR1bmUiXTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRGl2aW5lIGRpc2NvdW50IiwKICAgICAgbG9jKCJBbGwgYnVpbGRpbmdzIGFyZSA8Yj4lMSUgY2hlYXBlcjwvYj4uIiwgMSkgKwogICAgICAgICI8cT5Tb21lb25lIHNwZWNpYWwgZGVzZXJ2ZXMgYSBzcGVjaWFsIHByaWNlLjwvcT4iLAogICAgICA5OTk5OSwKICAgICAgWzIxLCA3XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJEZWNpc2l2ZSBmYXRlIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRGl2aW5lIHNhbGVzIiwKICAgICAgbG9jKCJBbGwgdXBncmFkZXMgYXJlIDxiPiUxJSBjaGVhcGVyPC9iPi4iLCAxKSArCiAgICAgICAgIjxxPkV2ZXJ5dGhpbmcgbXVzdCBnbyE8L3E+IiwKICAgICAgOTk5OTksCiAgICAgIFsxOCwgN10KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiRGVjaXNpdmUgZmF0ZSJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkRpdmluZSBiYWtlcmllcyIsCiAgICAgIGxvYygiQ29va2llIHVwZ3JhZGVzIGFyZSA8Yj4lMSB0aW1lcyBjaGVhcGVyPC9iPi4iLCA1KSArCiAgICAgICAgIjxxPlRoZXkgc3VyZSBrbm93IHdoYXQgdGhleSdyZSBkb2luZy48L3E+IiwKICAgICAgMzk5OTk5LAogICAgICBbMTcsIDddCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkRpdmluZSBzYWxlcyIsICJEaXZpbmUgZGlzY291bnQiXTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiU3RhcnRlciBraXQiLAogICAgICBsb2MoIllvdSBzdGFydCB3aXRoIDxiPiUxPC9iPi4iLCBsb2MoIiUxIGN1cnNvciIsIDEwKSkgKwogICAgICAgICI8cT5UaGlzIGNhbiBjb21lIGluIGhhbmR5LjwvcT4iLAogICAgICA1MCwKICAgICAgWzAsIDE0XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWwogICAgICAiVGluIG9mIGJyaXRpc2ggdGVhIGJpc2N1aXRzIiwKICAgICAgIkJveCBvZiBtYWNhcm9ucyIsCiAgICAgICJCb3ggb2YgYnJhbmQgYmlzY3VpdHMiLAogICAgICAiVGluIG9mIGJ1dHRlciBjb29raWVzIiwKICAgIF07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiU3RhcnRlciBraXRjaGVuIiwKICAgICAgbG9jKCJZb3Ugc3RhcnQgd2l0aCA8Yj4lMTwvYj4uIiwgbG9jKCIlMSBncmFuZG1hIiwgNSkpICsKICAgICAgICAiPHE+V2hlcmUgZGlkIHRoZXNlIGNvbWUgZnJvbT88L3E+IiwKICAgICAgNTAwMCwKICAgICAgWzEsIDE0XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJTdGFydGVyIGtpdCJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkhhbG8gZ2xvdmVzIiwKICAgICAgbG9jKCJDbGlja2luZyBpcyA8Yj4lMSU8L2I+IG1vcmUgcG93ZXJmdWwuIiwgMTApICsKICAgICAgICAiPHE+U21pdGUgdGhhdCBjb29raWUuPC9xPiIsCiAgICAgIDU1NTU1LAogICAgICBbMjIsIDddCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIlN0YXJ0ZXIga2l0Il07CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIktpdHRlbiBhbmdlbHMiLAogICAgICBzdHJLaXR0ZW5EZXNjICsgIjxxPkFsbCBjYXRzIGdvIHRvIGhlYXZlbi48L3E+IiwKICAgICAgOTAwMCwKICAgICAgWzIzLCA3XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJEb21pbmlvbnMiXTsKICAgIEdhbWUubGFzdC5raXR0ZW4gPSAxOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJVbmhvbHkgYmFpdCIsCiAgICAgIGxvYygiV3JpbmtsZXJzIGFwcGVhciA8Yj4lMSB0aW1lczwvYj4gYXMgZmFzdC4iLCA1KSArCiAgICAgICAgIjxxPk5vIHdyaW5rbGVyIGNhbiByZXNpc3QgdGhlIHNjZW50IG9mIHdvcm0gYmlzY3VpdHMuPC9xPiIsCiAgICAgIDQ0NDQ0LAogICAgICBbMTUsIDEyXQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJTdGFydGVyIGtpdGNoZW4iXTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTYWNyaWxlZ2lvdXMgY29ycnVwdGlvbiIsCiAgICAgIGxvYygiV3JpbmtsZXJzIGV4cGxvZGUgaW50byA8Yj4lMSUgbW9yZSBjb29raWVzPC9iPi4iLCA1KSArCiAgICAgICAgIjxxPlVuaXF1ZSBpbiB0aGUgYW5pbWFsIGtpbmdkb20sIHRoZSB3cmlua2xlciBkaWdlc3RpdmUgdHJhY3QgaXMgYWJsZSB0byB3aXRoc3RhbmQgYW4gaW5jcmVkaWJsZSBkZWdyZWUgb2YgZGlsYXRpb24gLSBwcm92aWRlZCB5b3UgcHJvZCB0aGVtIGFwcHJvcHJpYXRlbHkuPC9xPiIsCiAgICAgIDQ0NDQ0NCwKICAgICAgWzE5LCA4XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJVbmhvbHkgYmFpdCJdOwoKICAgIG9yZGVyID0gMjAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiWHRyZW1lIHdhbGtlcnMiLAogICAgICAnPHE+Q29tcGxldGUgd2l0aCBmbGFtZSBkZWNhbHMgYW5kIGEgbGl0dGxlIGhvcm4gdGhhdCBnb2VzICJ0b290Ii48L3E+JywKICAgICAgIkdyYW5kbWEiLAogICAgICA3CiAgICApOwogICAgb3JkZXIgPSAzMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJGdWRnZSBmdW5ndXMiLAogICAgICAiPHE+QSBzdWdhcnkgcGFyYXNpdGUgd2hvc2UgdGVuZHJpbHMgaGVscCBjb29raWUgZ3Jvd3RoLjxicj5QbGVhc2UgZG8gbm90IGJyZWF0aGUgaW4gdGhlIHNwb3Jlcy4gSW4gY2FzZSBvZiBzcG9yZSBpbmdlc3Rpb24sIHNlZWsgbWVkaWNhbCBoZWxwIHdpdGhpbiB0aGUgbmV4dCAzNiBzZWNvbmRzLjwvcT4iLAogICAgICAiRmFybSIsCiAgICAgIDcKICAgICk7CiAgICBvcmRlciA9IDQwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlBsYW5ldHNwbGl0dGVycyIsCiAgICAgICI8cT5UaGVzZSBuZXcgc3RhdGUtb2YtdGhlLWFydCBleGNhdmF0b3JzIGhhdmUgYmVlbiB0ZXN0ZWQgb24gTWVydWxhLCBHbG9ib3J0IGFuZCBGbHdhbnphIFZJLCBhbW9uZyBvdGhlciBkaXN0YW50IHBsYW5ldHMgd2hpY2ggaGF2ZSBiZWVuIGN1cmlvdXNseSBxdWlldCBsYXRlbHkuPC9xPiIsCiAgICAgICJNaW5lIiwKICAgICAgNwogICAgKTsKICAgIG9yZGVyID0gNTAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQ3lib3JnIHdvcmtmb3JjZSIsCiAgICAgICI8cT5TZW1pLXN5bnRoZXRpYyBvcmdhbmlzbXMgZG9uJ3Qgc2xhY2sgb2ZmLCBkb24ndCB1bmlvbml6ZSwgYW5kIGhhdmUgMjAlIHNob3J0ZXIgbHVuY2ggYnJlYWtzLCBtYWtpbmcgdGhlbSBpZGVhbCBsYWJvciBmb2RkZXIuPC9xPiIsCiAgICAgICJGYWN0b3J5IiwKICAgICAgNwogICAgKTsKICAgIG9yZGVyID0gNTI1OwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiV2F5IG9mIHRoZSB3YWxsZXQiLAogICAgICAiPHE+VGhpcyBuZXcgbW9uZXRhcnkgc2Nob29sIG9mIHRob3VnaHQgaXMgYWxsIHRoZSByYWdlIG9uIHRoZSBiYW5raW5nIHNjZW5lOyBmb2xsb3cgaXRzIHByZWNlcHRzIGFuZCB5b3UgbWF5IGp1c3QgcHJvZml0IGZyb20gaXQuPC9xPiIsCiAgICAgICJCYW5rIiwKICAgICAgNwogICAgKTsKICAgIG9yZGVyID0gNTUwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQ3JlYXRpb24gbXl0aCIsCiAgICAgICI8cT5TdG9yaWVzIGhhdmUgYmVlbiBjaXJjdWxhdGluZyBhYm91dCB0aGUgb3JpZ2lucyBvZiB0aGUgdmVyeSBmaXJzdCBjb29raWUgdGhhdCB3YXMgZXZlciBiYWtlZDsgdGFsZXMgb2YgaG93IGl0IGFsbCBiZWdhbiwgaW4gdGhlIERvdWdoIGJleW9uZCB0aW1lIGFuZCB0aGUgT3ZlbnMgb2YgZGVzdGlueS48L3E+IiwKICAgICAgIlRlbXBsZSIsCiAgICAgIDcKICAgICk7CiAgICBvcmRlciA9IDU3NTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkNvb2tpZW1hbmN5IiwKICAgICAgIjxxPlRoZXJlIGl0IGlzOyB0aGUgcGVyZmVjdGVkIHNjaG9vbCBvZiBiYWtpbmcgbWFnaWMuIEZyb20gc3VtbW9uaW5nIGNoaXBzIHRvIGhleGluZyBudXRzLCB0aGVyZSBpcyBub3QgYSBzaW5nbGUgcGFydCBvZiBjb29raWUtbWFraW5nIHRoYXQgaGFzbid0IGJlZW4gaW1wcm92ZWQgdGVuZm9sZCBieSBtYWdpYyB0cmlja3MuPC9xPiIsCiAgICAgICJXaXphcmQgdG93ZXIiLAogICAgICA3CiAgICApOwogICAgb3JkZXIgPSA2MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJEeXNvbiBzcGhlcmUiLAogICAgICAiPHE+WW91J3ZlIGZvdW5kIGEgd2F5IHRvIGFwcGx5IHlvdXIga25vd2xlZGdlIG9mIGNvc21pYyB0ZWNobm9sb2d5IHRvIHNsaWdodGx5IG1vcmUgbG9jYWwgZW5kZWF2b3JzOyB0aGlzIGdpZ2FudGljIHNwaGVyZSBvZiBtZXRhLW1hdGVyaWFscywgd3JhcHBpbmcgdGhlIHNvbGFyIHN5c3RlbSwgaXMgc3VyZSB0byBraWNrIHlvdXIgYmFraW5nIGFiaWxpdGllcyB1cCBhIG5vdGNoLjwvcT4iLAogICAgICAiU2hpcG1lbnQiLAogICAgICA3CiAgICApOwogICAgb3JkZXIgPSA3MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJUaGVvcnkgb2YgYXRvbWljIGZsdWlkaXR5IiwKICAgICAgIjxxPlB1c2hpbmcgYWxjaGVteSB0byBpdHMgbW9zdCBleHRyZW1lIGxpbWl0cywgeW91IGZpbmQgdGhhdCBldmVyeXRoaW5nIGlzIHRyYW5zbXV0YWJsZSBpbnRvIGFueXRoaW5nIGVsc2UgLSBsZWFkIHRvIGdvbGQsIG1lcmN1cnkgdG8gd2F0ZXI7IG1vcmUgaW1wb3J0YW50bHksIHlvdSByZWFsaXplIHRoYXQgYW55dGhpbmcgY2FuIC1hbmQgc2hvdWxkLSBiZSBjb252ZXJ0ZWQgdG8gY29va2llcy48L3E+IiwKICAgICAgIkFsY2hlbXkgbGFiIiwKICAgICAgNwogICAgKTsKICAgIG9yZGVyID0gODAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRW5kIG9mIHRpbWVzIGJhY2stdXAgcGxhbiIsCiAgICAgICI8cT5KdXN0IGluIGNhc2UsIGFscmlnaHQ/PC9xPiIsCiAgICAgICJQb3J0YWwiLAogICAgICA3CiAgICApOwogICAgb3JkZXIgPSA5MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJHcmVhdCBsb29wIGh5cG90aGVzaXMiLAogICAgICAiPHE+V2hhdCBpZiBvdXIgdW5pdmVyc2UgaXMganVzdCBvbmUgaW5zdGFuY2Ugb2YgYW4gaW5maW5pdGUgY3ljbGU/IFdoYXQgaWYsIGJlZm9yZSBhbmQgYWZ0ZXIgaXQsIHN0cmV0Y2hlZCBpbmZpbml0ZSBhbW91bnRzIG9mIHRoZSBzYW1lIHVuaXZlcnNlLCB0aGVtc2VsdmVzIGNvbnRhaW5pbmcgaW5maW5pdGUgYW1vdW50cyBvZiBjb29raWVzPzwvcT4iLAogICAgICAiVGltZSBtYWNoaW5lIiwKICAgICAgNwogICAgKTsKICAgIG9yZGVyID0gMTAwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRoZSBQdWxzZSIsCiAgICAgICI8cT5Zb3UndmUgdGFwcGVkIGludG8gdGhlIHZlcnkgcHVsc2Ugb2YgdGhlIGNvc21vcywgYSB0aW1lbGVzcyByaHl0aG0gYWxvbmcgd2hpY2ggZXZlcnkgbWF0ZXJpYWwgYW5kIGFudGltYXRlcmlhbCB0aGluZyBiZWF0cyBpbiB1bmlzb24uIFRoaXMsIHNvbWVob3csIG1lYW5zIG1vcmUgY29va2llcy48L3E+IiwKICAgICAgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwKICAgICAgNwogICAgKTsKICAgIG9yZGVyID0gMTEwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkx1eCBzYW5jdG9ydW0iLAogICAgICAiPHE+WW91ciBwcmlzbSBhdHRlbmRhbnRzIGhhdmUgYmVjb21lIGluY3JlYXNpbmdseSBtZXNtZXJpemVkIHdpdGggc29tZXRoaW5nIGluIHRoZSBsaWdodCAtIG9yIG1heWJlIHNvbWV0aGluZyBiZXlvbmQgaXQ7IGJleW9uZCB1cyBhbGwsIHBlcmhhcHM/PC9xPiIsCiAgICAgICJQcmlzbSIsCiAgICAgIDcKICAgICk7CgogICAgb3JkZXIgPSAyMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJUaGUgVW5icmlkbGluZyIsCiAgICAgICI8cT5JdCBtaWdodCBiZSBhIGNsYXNzaWMgdGFsZSBvZiBiYWQgcGFyZW50aW5nLCBidXQgbGV0J3Mgc2VlIHdoZXJlIGdyYW5kbWEgaXMgZ29pbmcgd2l0aCB0aGlzLjwvcT4iLAogICAgICAiR3JhbmRtYSIsCiAgICAgIDgKICAgICk7CiAgICBvcmRlciA9IDMwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIldoZWF0IHRyaWZmaWRzIiwKICAgICAgIjxxPlRha2luZyBjYXJlIG9mIGNyb3BzIGlzIHNvIG11Y2ggZWFzaWVyIHdoZW4geW91ciBwbGFudHMgY2FuIGp1c3Qgd2FsayBhYm91dCBhbmQgaGVscCBhcm91bmQgdGhlIGZhcm0uPGJyPkRvIG5vdCBwZXQuIERvIG5vdCBmZWVkLiBEbyBub3QgYXR0ZW1wdCB0byBjb252ZXJzZSB3aXRoLjwvcT4iLAogICAgICAiRmFybSIsCiAgICAgIDgKICAgICk7CiAgICBvcmRlciA9IDQwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkNhbm9sYSBvaWwgd2VsbHMiLAogICAgICAiPHE+QSBwcmV2aW91c2x5IHVudGFwcGVkIHJlc291cmNlLCBjYW5vbGEgb2lsIHBlcm1lYXRlcyB0aGUgdW5kZXJncm91bmQgb2xpZmVycyB3aGljaCBncmFudCBpdCBpdHMgcGFydGljdWxhciB0YXN0ZSBhbmQgbHVjcmF0aXZlIHByb3BlcnRpZXMuPC9xPiIsCiAgICAgICJNaW5lIiwKICAgICAgOAogICAgKTsKICAgIG9yZGVyID0gNTAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiNzgtaG91ciBkYXlzIiwKICAgICAgIjxxPldoeSBkaWRuJ3Qgd2UgdGhpbmsgb2YgdGhpcyBlYXJsaWVyPzwvcT4iLAogICAgICAiRmFjdG9yeSIsCiAgICAgIDgKICAgICk7CiAgICBvcmRlciA9IDUyNTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRoZSBzdHVmZiByYXRpb25hbGUiLAogICAgICAiPHE+SWYgbm90IG5vdywgd2hlbj8gSWYgbm90IGl0LCB3aGF0PyBJZiBub3QgdGhpbmdzLi4uIHN0dWZmPzwvcT4iLAogICAgICAiQmFuayIsCiAgICAgIDgKICAgICk7CiAgICBvcmRlciA9IDU1MDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRoZW9jcmFjeSIsCiAgICAgICI8cT5Zb3UndmUgdHVybmVkIHlvdXIgY29va2llIGVtcGlyZSBpbnRvIGEgcGVyZmVjdCB0aGVvY3JhY3ksIGdhdGhlcmluZyB0aGUgYWRvcmF0aW9uIG9mIHppbGxpb25zIG9mIGZvbGxvd2VycyBmcm9tIGV2ZXJ5IGNvcm5lciBvZiB0aGUgdW5pdmVyc2UuPGJyPkRvbid0IGxldCBpdCBnbyB0byB5b3VyIGhlYWQuPC9xPiIsCiAgICAgICJUZW1wbGUiLAogICAgICA4CiAgICApOwogICAgb3JkZXIgPSA1NzU7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJSYWJiaXQgdHJpY2siLAogICAgICAiPHE+VXNpbmcgbm90aGluZyBtb3JlIHRoYW4gYSBmYW5jeSB0b3AgaGF0LCB5b3VyIHdpemFyZHMgaGF2ZSBmb3VuZCBhIHdheSB0byBzaW11bHRhbmVvdXNseSBjdXJiIHJhYmJpdCBwb3B1bGF0aW9uIGFuZCBwcm9kdWNlIGhlYXBzIG9mIGV4dHJhIGNvb2tpZXMgZm9yIGJhc2ljYWxseSBmcmVlITxicj5SZXN1bHRpbmcgY29va2llcyBtYXkgb3IgbWF5IG5vdCBiZSBmaXQgZm9yIHZlZ2Fucy48L3E+IiwKICAgICAgIldpemFyZCB0b3dlciIsCiAgICAgIDgKICAgICk7CiAgICBvcmRlciA9IDYwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRoZSBmaW5hbCBmcm9udGllciIsCiAgICAgICI8cT5JdCdzIGJlZW4gYSBsb25nIHJvYWQsIGdldHRpbmcgZnJvbSB0aGVyZSB0byBoZXJlLiBJdCdzIGFsbCB3b3J0aCBpdCB0aG91Z2ggLSB0aGUgc2lnaHRzIGFyZSBsb3ZlbHkgYW5kIHRoZSBvaWwgcHJpY2VzIHNsaWdodGx5IG1vcmUgcmVhc29uYWJsZS48L3E+IiwKICAgICAgIlNoaXBtZW50IiwKICAgICAgOAogICAgKTsKICAgIG9yZGVyID0gNzAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQmVpZ2UgZ29vIiwKICAgICAgIjxxPldlbGwgbm93IHlvdSd2ZSBkb25lIGl0LiBHb29kIGpvYi4gVmVyeSBuaWNlLiBUaGF0J3MgMyBnYWxheGllcyB5b3UndmUganVzdCBjb252ZXJ0ZWQgaW50byBjb29raWVzLiBHb29kIHRoaW5nIHlvdSBjYW4gaG9wIGZyb20gdW5pdmVyc2UgdG8gdW5pdmVyc2UuPC9xPiIsCiAgICAgICJBbGNoZW15IGxhYiIsCiAgICAgIDgKICAgICk7CiAgICBvcmRlciA9IDgwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIk1hZGRlbmluZyBjaGFudHMiLAogICAgICAiPHE+QSBwb3B1bGFyIHZlcnNlIGdvZXMgbGlrZSBzbyA6IFwiamF1J2huIG1hZGRlbiBqYXUnaG4gbWFkZGVuIGFlaW91YWVpb3VhZWlvdSBicmJyYnJicmJyYnJiclwiPC9xPiIsCiAgICAgICJQb3J0YWwiLAogICAgICA4CiAgICApOwogICAgb3JkZXIgPSA5MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJDb29raWV0b3BpYW4gbW9tZW50cyBvZiBtYXliZSIsCiAgICAgICI8cT5SZW1pbmlzY2luZyBob3cgdGhpbmdzIGNvdWxkIGhhdmUgYmVlbiwgc2hvdWxkIGhhdmUgYmVlbiwgd2lsbCBoYXZlIGJlZW4uPC9xPiIsCiAgICAgICJUaW1lIG1hY2hpbmUiLAogICAgICA4CiAgICApOwogICAgb3JkZXIgPSAxMDAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiU29tZSBvdGhlciBzdXBlci10aW55IGZ1bmRhbWVudGFsIHBhcnRpY2xlPyBQcm9iYWJseT8iLAogICAgICAiPHE+V2hlbiBldmVuIHRoZSB1bml2ZXJzZSBpcyBydW5uaW5nIG91dCBvZiBpZGVhcywgdGhhdCdzIHdoZW4geW91IGtub3cgeW91J3JlIG5lYXJpbmcgdGhlIGVuZC48L3E+IiwKICAgICAgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwKICAgICAgOAogICAgKTsKICAgIG9yZGVyID0gMTEwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlJldmVyc2Ugc2hhZG93cyIsCiAgICAgICI8cT5PaCBtYW4sIHRoaXMgaXMgcmVhbGx5IG1lc3Npbmcgd2l0aCB5b3VyIGV5ZXMuPC9xPiIsCiAgICAgICJQcmlzbSIsCiAgICAgIDgKICAgICk7CgogICAgb3JkZXIgPSAyMDAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJLaXR0ZW4gYWNjb3VudGFudHMiLAogICAgICBzdHJLaXR0ZW5EZXNjICsgIjxxPmJ1c2luZXNzIGdvaW5nIGdyZWF0LCBzaXI8L3E+IiwKICAgICAgOTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwLAogICAgICBHYW1lLkdldEljb24oIktpdHRlbiIsIDYpCiAgICApOwogICAgR2FtZS5sYXN0LmtpdHRlbiA9IDE7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCA2LCAxOCk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiS2l0dGVuIHNwZWNpYWxpc3RzIiwKICAgICAgc3RyS2l0dGVuRGVzYyArICI8cT5vcHRpbWVvd3ppbmcgeW91ciB3b3JrZmxvdyBsaWtlIHdob2FoLCBzaXI8L3E+IiwKICAgICAgOTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwLAogICAgICBHYW1lLkdldEljb24oIktpdHRlbiIsIDcpCiAgICApOwogICAgR2FtZS5sYXN0LmtpdHRlbiA9IDE7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCA3LCAxOCk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiS2l0dGVuIGV4cGVydHMiLAogICAgICBzdHJLaXR0ZW5EZXNjICsgIjxxPjEwIHllYXJzIGV4cHVycnJ0aXNlIGluIHRoZSBjb29raWUgYnVzaW5lc3MsIHNpcjwvcT4iLAogICAgICA5MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIEdhbWUuR2V0SWNvbigiS2l0dGVuIiwgOCkKICAgICk7CiAgICBHYW1lLmxhc3Qua2l0dGVuID0gMTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDgsIDE4KTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiSG93IHRvIGJha2UgeW91ciBkcmFnb24iLAogICAgICBsb2MoCiAgICAgICAgIkFsbG93cyB5b3UgdG8gcHVyY2hhc2UgYSA8Yj5jcnVtYmx5IGVnZzwvYj4gb25jZSB5b3UgaGF2ZSBlYXJuZWQgMSBtaWxsaW9uIGNvb2tpZXMuIgogICAgICApICsKICAgICAgICAnPHE+QSB0b21lIGZ1bGwgb2YgaGVscGZ1bCB0aXBzIHN1Y2ggYXMgIm9oIGdvZCwgc3RheSBhd2F5IGZyb20gaXQiLCAid2h5IGRpZCB3ZSBidXkgdGhpcyB0aGluZywgaXRcJ3Mgbm90IGV2ZW4gaG91c2UtYnJva2VuIiBhbmQgImdyb29tIHR3aWNlIGEgd2VlayBpbiB0aGUgZGlyZWN0aW9uIG9mIHRoZSBzY2FsZXMiLjwvcT4nLAogICAgICA5LAogICAgICBbMjIsIDEyXQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKCiAgICBvcmRlciA9IDI1MTAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkEgY3J1bWJseSBlZ2ciLAogICAgICBsb2MoIlVubG9ja3MgdGhlIDxiPmNvb2tpZSBkcmFnb24gZWdnPC9iPi4iKSArCiAgICAgICAgIjxxPlRoYW5rIHlvdSBmb3IgYWRvcHRpbmcgdGhpcyByb2J1c3QsIGZ1bi1sb3ZpbmcgY29va2llIGRyYWdvbiEgSXQgd2lsbCBicmluZyB5b3UgeWVhcnMgb2Ygam95IGFuZCBlbnRlcnRhaW5tZW50Ljxicj5LZWVwIGluIGEgZHJ5IGFuZCBjb29sIHBsYWNlLCBhbmQgYXdheSBmcm9tIG90aGVyIGhvdXNlIHBldHMuIFN1YnNjcmlwdGlvbiB0byBob21lIGluc3VyYW5jZSBpcyBzdHJvbmdseSBhZHZpc2VkLjwvcT4iLAogICAgICAyNSwKICAgICAgWzIxLCAxMl0KICAgICk7CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkNoaW1lcmEiLAogICAgICBsb2MoIlN5bmVyZ3kgdXBncmFkZXMgYXJlIDxiPiUxJSBjaGVhcGVyPC9iPi4iLCAyKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoCiAgICAgICAgICAiWW91IGdhaW4gYW5vdGhlciA8Yj4rJTElPC9iPiBvZiB5b3VyIHJlZ3VsYXIgQ3BTIHdoaWxlIHRoZSBnYW1lIGlzIGNsb3NlZC4iLAogICAgICAgICAgNQogICAgICAgICkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKAogICAgICAgICAgIllvdSByZXRhaW4gb3B0aW1hbCBjb29raWUgcHJvZHVjdGlvbiB3aGlsZSB0aGUgZ2FtZSBpcyBjbG9zZWQgZm9yIDxiPiUxIG1vcmUgZGF5czwvYj4uIiwKICAgICAgICAgIDIKICAgICAgICApICsKICAgICAgICAiPHE+TW9yZSB0aGFuIHRoZSBzdW0gb2YgaXRzIHBhcnRzLjwvcT4iLAogICAgICBNYXRoLnBvdyhhbmdlbFByaWNlRmFjdG9yLCA5KSwKICAgICAgWzI0LCA3XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJHb2QiLCAiTHVjaWZlciIsICJTeW5lcmdpZXMgVm9sLiBJSSJdOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJUaW4gb2YgYnV0dGVyIGNvb2tpZXMiLAogICAgICBsb2MoIkNvbnRhaW5zIGFuIGFzc29ydG1lbnQgb2YgcmljaCBidXR0ZXIgY29va2llcy4iKSArCiAgICAgICAgIjxxPkZpdmUgdmFyaWV0aWVzIG9mIGRhbmlzaCBjb29raWVzLjxicj5Db21wbGV0ZSB3aXRoIGxpdHRsZSBwYXBlciBjdXBzLjwvcT4iLAogICAgICAyNSwKICAgICAgWzIxLCA5XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJIZWF2ZW5seSBjb29raWVzIl07CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkdvbGRlbiBzd2l0Y2giLAogICAgICBsb2MoCiAgICAgICAgIlVubG9ja3MgdGhlIDxiPmdvbGRlbiBzd2l0Y2g8L2I+LCB3aGljaCBwYXNzaXZlbHkgYm9vc3RzIHlvdXIgQ3BTIGJ5ICUxJSBidXQgZGlzYWJsZXMgZ29sZGVuIGNvb2tpZXMuIiwKICAgICAgICA1MAogICAgICApICsgIjxxPkxlc3MgY2xpY2tpbmcsIG1vcmUgaWRsaW5nLjwvcT4iLAogICAgICA5OTksCiAgICAgIFsyMSwgMTBdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkhlYXZlbmx5IGx1Y2siXTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQ2xhc3NpYyBkYWlyeSBzZWxlY3Rpb24iLAogICAgICBsb2MoCiAgICAgICAgIlVubG9ja3MgdGhlIDxiPm1pbGsgc2VsZWN0b3I8L2I+LCBsZXR0aW5nIHlvdSBwaWNrIHdoaWNoIG1pbGsgaXMgZGlzcGxheWVkIHVuZGVyIHlvdXIgY29va2llLjxicj5Db21lcyB3aXRoIGEgdmFyaWV0eSBvZiBiYXNpYyBmbGF2b3JzLiIKICAgICAgKSArICI8cT5Eb24ndCBoYXZlIGEgY293LCBtYW4uPC9xPiIsCiAgICAgIDksCiAgICAgIFsxLCA4XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gW107CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkZhbmNpZnVsIGRhaXJ5IHNlbGVjdGlvbiIsCiAgICAgIGxvYygiQ29udGFpbnMgbW9yZSBleG90aWMgZmxhdm9ycyBmb3IgeW91ciBtaWxrIHNlbGVjdG9yLiIpICsKICAgICAgICAiPHE+U3Ryb25nIGJvbmVzIGZvciB0aGUgc2tlbGV0b24gYXJteS48L3E+IiwKICAgICAgMTAwMDAwMCwKICAgICAgWzksIDddCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkNsYXNzaWMgZGFpcnkgc2VsZWN0aW9uIl07CgogICAgb3JkZXIgPSAxMDMwMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJEcmFnb24gY29va2llIiwKICAgICAgZGVzYzogIkltYnVlZCB3aXRoIHRoZSB2aWdvciBhbmQgdml0YWxpdHkgb2YgYSBmdWxsLWdyb3duIGNvb2tpZSBkcmFnb24sIHRoaXMgbXlzdGljYWwgY29va2llIHdpbGwgZW1ib2xkZW4geW91ciBlbXBpcmUgZm9yIHRoZSBnZW5lcmF0aW9ucyB0byBjb21lLiIsCiAgICAgIGljb246IFsxMCwgMjVdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTkgKiA3LAogICAgICBsb2NrZWQ6IDEsCiAgICB9KTsKCiAgICBvcmRlciA9IDQwMDAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkdvbGRlbiBzd2l0Y2ggW29mZl0iLAogICAgICBsb2MoCiAgICAgICAgIlR1cm5pbmcgdGhpcyBvbiB3aWxsIGdpdmUgeW91IGEgcGFzc2l2ZSA8Yj4rJTElIENwUzwvYj4sIGJ1dCBwcmV2ZW50cyBnb2xkZW4gY29va2llcyBmcm9tIHNwYXduaW5nLjxicj5Db3N0IGlzIGVxdWFsIHRvIDEgaG91ciBvZiBwcm9kdWN0aW9uLiIsCiAgICAgICAgNTAKICAgICAgKSwKICAgICAgMTAwMDAwMCwKICAgICAgWzIwLCAxMF0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJ0b2dnbGUiOwogICAgR2FtZS5sYXN0LnRvZ2dsZUludG8gPSAiR29sZGVuIHN3aXRjaCBbb25dIjsKICAgIEdhbWUubGFzdC5wcmljZUZ1bmMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBHYW1lLmNvb2tpZXNQcyAqIDYwICogNjA7CiAgICB9OwogICAgdmFyIGZ1bmMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChHYW1lLkhhcygiUmVzaWR1YWwgbHVjayIpKSB7CiAgICAgICAgdmFyIGJvbnVzID0gMDsKICAgICAgICB2YXIgdXBncmFkZXMgPSBHYW1lLmdvbGRlbkNvb2tpZVVwZ3JhZGVzOwogICAgICAgIGZvciAodmFyIGkgaW4gdXBncmFkZXMpIHsKICAgICAgICAgIGlmIChHYW1lLkhhcyh1cGdyYWRlc1tpXSkpIGJvbnVzKys7CiAgICAgICAgfQogICAgICAgIHJldHVybiAoCiAgICAgICAgICAnPGRpdiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7Ij4nICsKICAgICAgICAgIEdhbWUubGlzdFRpbnlPd25lZFVwZ3JhZGVzKEdhbWUuZ29sZGVuQ29va2llVXBncmFkZXMpICsKICAgICAgICAgICI8YnI+PGJyPlRoZSBlZmZlY3RpdmUgYm9vc3QgaXMgPGI+KyIgKwogICAgICAgICAgQmVhdXRpZnkoTWF0aC5yb3VuZCg1MCArIGJvbnVzICogMTApKSArCiAgICAgICAgICAiJTwvYj48YnI+dGhhbmtzIHRvIHJlc2lkdWFsIGx1Y2s8YnI+YW5kIHlvdXIgPGI+IiArCiAgICAgICAgICBib251cyArCiAgICAgICAgICAiPC9iPiBnb2xkZW4gY29va2llIHVwZ3JhZGUiICsKICAgICAgICAgIChib251cyA9PSAxID8gIiIgOiAicyIpICsKICAgICAgICAgICcuPC9kaXY+PGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgICB0aGlzLmRkZXNjCiAgICAgICAgKTsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5kZXNjOwogICAgfTsKICAgIGlmIChFTikgR2FtZS5sYXN0LmRlc2NGdW5jID0gZnVuYzsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiR29sZGVuIHN3aXRjaCBbb25dIiwKICAgICAgbG9jKAogICAgICAgICJUaGUgc3dpdGNoIGlzIGN1cnJlbnRseSBnaXZpbmcgeW91IGEgcGFzc2l2ZSA8Yj4rJTElIENwUzwvYj47IGl0IGFsc28gcHJldmVudHMgZ29sZGVuIGNvb2tpZXMgZnJvbSBzcGF3bmluZy48YnI+VHVybmluZyBpdCBvZmYgd2lsbCByZXZlcnQgdGhvc2UgZWZmZWN0cy48YnI+Q29zdCBpcyBlcXVhbCB0byAxIGhvdXIgb2YgcHJvZHVjdGlvbi4iLAogICAgICAgIDUwCiAgICAgICksCiAgICAgIDEwMDAwMDAsCiAgICAgIFsyMSwgMTBdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAidG9nZ2xlIjsKICAgIEdhbWUubGFzdC50b2dnbGVJbnRvID0gIkdvbGRlbiBzd2l0Y2ggW29mZl0iOwogICAgR2FtZS5sYXN0LnByaWNlRnVuYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIEdhbWUuY29va2llc1BzICogNjAgKiA2MDsKICAgIH07CiAgICBHYW1lLmxhc3QuZGVzY0Z1bmMgPSBmdW5jOwoKICAgIG9yZGVyID0gNTAwMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiTWlsayBzZWxlY3RvciIsCiAgICAgIGxvYygiTGV0cyB5b3UgcGljayB3aGF0IGZsYXZvciBvZiBtaWxrIHRvIGRpc3BsYXkuIiksCiAgICAgIDAsCiAgICAgIFsxLCA4XQogICAgKTsKICAgIEdhbWUubGFzdC5kZXNjRnVuYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGNob2ljZSA9IHRoaXMuY2hvaWNlc0Z1bmN0aW9uKClbR2FtZS5taWxrVHlwZV07CiAgICAgIGlmICghY2hvaWNlKSBjaG9pY2UgPSB0aGlzLmNob2ljZXNGdW5jdGlvbigpWzBdOwogICAgICByZXR1cm4gKAogICAgICAgICc8ZGl2IHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsiPicgKwogICAgICAgIGxvYygiQ3VycmVudDoiKSArCiAgICAgICAgIiAiICsKICAgICAgICB0aW55SWNvbihjaG9pY2UuaWNvbikgKwogICAgICAgICIgPGI+IiArCiAgICAgICAgY2hvaWNlLm5hbWUgKwogICAgICAgICc8L2I+PC9kaXY+PGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgdGhpcy5kZGVzYwogICAgICApOwogICAgfTsKCiAgICBHYW1lLmxhc3QucG9vbCA9ICJ0b2dnbGUiOwogICAgR2FtZS5sYXN0LmNob2ljZXNGdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHJhbmsgPSAwOwogICAgICB2YXIgY2hvaWNlcyA9IFtdOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBHYW1lLkFsbE1pbGtzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIGl0ID0gR2FtZS5BbGxNaWxrc1tpXTsKICAgICAgICBjaG9pY2VzLnB1c2goewogICAgICAgICAgbmFtZTogaXQubmFtZSwKICAgICAgICAgIGljb246IGl0Lmljb24sCiAgICAgICAgICBtaWxrOiBpdCwKICAgICAgICAgIG9yZGVyOiBpdC50eXBlLAogICAgICAgIH0pOwogICAgICB9CgogICAgICBjaG9pY2VzWzExXS5kaXYgPSB0cnVlOwoKICAgICAgdmFyIG1heFJhbmsgPSBNYXRoLmZsb29yKEdhbWUuQWNoaWV2ZW1lbnRzT3duZWQgLyAyNSk7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hvaWNlcy5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciBpdCA9IGNob2ljZXNbaV0ubWlsazsKICAgICAgICBpZiAoaXQudHlwZSA9PSAxICYmICFHYW1lLkhhcygiRmFuY2lmdWwgZGFpcnkgc2VsZWN0aW9uIikpCiAgICAgICAgICBjaG9pY2VzW2ldID0gMDsKICAgICAgICBpZiAoaXQucmFuayAmJiBpdC5yYW5rID4gbWF4UmFuaykgY2hvaWNlc1tpXSA9IDA7CiAgICAgIH0KCiAgICAgIGNob2ljZXNbR2FtZS5taWxrVHlwZV0uc2VsZWN0ZWQgPSAxOwogICAgICByZXR1cm4gY2hvaWNlczsKICAgIH07CiAgICBHYW1lLmxhc3QuY2hvaWNlc1BpY2sgPSBmdW5jdGlvbiAoaWQpIHsKICAgICAgR2FtZS5taWxrVHlwZSA9IGlkOwogICAgfTsKCiAgICBvcmRlciA9IDEwMzAwOwogICAgdmFyIGJ1dHRlckJpc2N1aXRNdWx0ID0gMTAwMDAwMDAwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIk1pbGsgY2hvY29sYXRlIGJ1dHRlciBiaXNjdWl0IiwKICAgICAgZGVzYzogIlJld2FyZGVkIGZvciBvd25pbmcgMTAwIG9mIGV2ZXJ5dGhpbmcuPGJyPkl0IGJlYXJzIHRoZSBlbmdyYXZpbmcgb2YgYSBmaW5lIGVudHJlcHJlbmV1ci4iLAogICAgICBpY29uOiBbMjcsIDhdLAogICAgICBwb3dlcjogMTAsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiBidXR0ZXJCaXNjdWl0TXVsdCwKICAgICAgbG9ja2VkOiAxLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiRGFyayBjaG9jb2xhdGUgYnV0dGVyIGJpc2N1aXQiLAogICAgICBkZXNjOiAiUmV3YXJkZWQgZm9yIG93bmluZyAxNTAgb2YgZXZlcnl0aGluZy48YnI+SXQgaXMgYWRvcm5lZCB3aXRoIHRoZSBpbWFnZSBvZiBhbiBleHBlcmllbmNlZCBjb29raWUgdHljb29uLiIsCiAgICAgIGljb246IFsyNywgOV0sCiAgICAgIHBvd2VyOiAxMCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSAqIGJ1dHRlckJpc2N1aXRNdWx0LAogICAgICBsb2NrZWQ6IDEsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJXaGl0ZSBjaG9jb2xhdGUgYnV0dGVyIGJpc2N1aXQiLAogICAgICBkZXNjOiAiUmV3YXJkZWQgZm9yIG93bmluZyAyMDAgb2YgZXZlcnl0aGluZy48YnI+VGhlIGNob2NvbGF0ZSBpcyBjaGlzZWxlZCB0byBkZXBpY3QgYSBtYXN0ZXJmdWwgcGFzdHJ5IG1hZ25hdGUuIiwKICAgICAgaWNvbjogWzI4LCA5XSwKICAgICAgcG93ZXI6IDEwLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogYnV0dGVyQmlzY3VpdE11bHQsCiAgICAgIGxvY2tlZDogMSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlJ1YnkgY2hvY29sYXRlIGJ1dHRlciBiaXNjdWl0IiwKICAgICAgZGVzYzogIlJld2FyZGVkIGZvciBvd25pbmcgMjUwIG9mIGV2ZXJ5dGhpbmcuPGJyPkNvdmVyZWQgaW4gYSByYXJlIHJlZCBjaG9jb2xhdGUsIHRoaXMgYmlzY3VpdCBpcyBldGNoZWQgdG8gcmVwcmVzZW50IHRoZSBmYWNlIG9mIGEgY29va2llIGluZHVzdHJpYWxpc3QgZ29uZSBtYWQgd2l0aCBwb3dlci4iLAogICAgICBpY29uOiBbMjgsIDhdLAogICAgICBwb3dlcjogMTAsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiBidXR0ZXJCaXNjdWl0TXVsdCwKICAgICAgbG9ja2VkOiAxLAogICAgfSk7CgogICAgb3JkZXIgPSAxMDAyMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJHaW5nZXJzbmFwcyIsCiAgICAgIGRlc2M6ICJDb29raWVzIHdpdGggYSBzb3VsLiBQcm9iYWJseS4iLAogICAgICBpY29uOiBbMjksIDEwXSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkNpbm5hbW9uIGNvb2tpZXMiLAogICAgICBkZXNjOiAiVGhlIHNlY3JldCBpcyBpbiB0aGUgcGF0ZW50ZWQgc3dpcmx5IGdsYXppbmcuIiwKICAgICAgaWNvbjogWzIzLCA4XSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OSAqIDUsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJWYW5pdHkgY29va2llcyIsCiAgICAgIGRlc2M6ICJPbmUgdGlueSBjYW5kaWVkIGZydWl0IHNpdHMgYXRvcCB0aGlzIGRlY2FkZW50IGNvb2tpZS4iLAogICAgICBpY29uOiBbMjIsIDhdLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkNpZ2FycyIsCiAgICAgIGRlc2M6ICJDbG9zZSwgYnV0IG5vIG1hdGNoIGZvciB0aG9zZSBleHRyYXZhZ2FudCBjb29raWUgc3RyYXdzIHRoZXkgc2VydmUgaW4gY29mZmVlIHNob3BzIHRoZXNlIGRheXMuIiwKICAgICAgaWNvbjogWzI1LCA4XSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiUGlud2hlZWwgY29va2llcyIsCiAgICAgIGRlc2M6ICJCcmluZ2luZyB5b3UgdGhlIGRpenp5aW5nIGNvbWJpbmF0aW9uIG9mIGJyb3duIGZsYXZvciBhbmQgYmVpZ2UgdGFzdGUhIiwKICAgICAgaWNvbjogWzIyLCAxMF0sCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkZ1ZGdlIHNxdWFyZXMiLAogICAgICBkZXNjOiAiTm90IGV4YWN0bHkgY29va2llcywgYnV0IHlvdSB3b24ndCBjYXJlIG9uY2UgeW91J3ZlIHRhc3RlZCBvbmUgb2YgdGhlc2UuPGJyPlRoZXkncmUgc28gZ29vZCwgaXQncyBmdWRnZWQtdXAhIiwKICAgICAgaWNvbjogWzI0LCA4XSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwoKICAgIG9yZGVyID0gMTAwMzA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiRGlnaXRzIiwKICAgICAgZGVzYzogIlRocmVlIGZsYXZvcnMsIHplcm8gcGhhbGFuZ2VzLiIsCiAgICAgIGljb246IFsyNiwgOF0sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgYnJhbmQgYmlzY3VpdHMiLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OSAqIDUsCiAgICB9KTsKCiAgICBvcmRlciA9IDEwMDI5OwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkJ1dHRlciBob3JzZXNob2VzIiwKICAgICAgZGVzYzogIkl0IHdvdWxkIGJlaG9vdmUgeW91IHRvIG5vdCBvdmVyaW5kdWxnZSBpbiB0aGVzZS4iLAogICAgICBpY29uOiBbMjIsIDldLAogICAgICByZXF1aXJlOiAiVGluIG9mIGJ1dHRlciBjb29raWVzIiwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkJ1dHRlciBwdWNrcyIsCiAgICAgIGRlc2M6ICJMb3JkLCB3aGF0IGZvb2xzIHRoZXNlIG1vcnRhbHMgYmUhPGJyPihUaGlzIGlzIGtpbmQgb2YgYSBob2tleSByZWZlcmVuY2UuKSIsCiAgICAgIGljb246IFsyMywgOV0sCiAgICAgIHJlcXVpcmU6ICJUaW4gb2YgYnV0dGVyIGNvb2tpZXMiLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkJ1dHRlciBrbm90cyIsCiAgICAgIGRlc2M6ICJMb29rLCB5b3UgY2FuIGNhbGwgdGhlc2UgcHJldHplbHMgaWYgeW91IHdhbnQsIGJ1dCB5b3UnZCBqdXN0IGJlIGZvb2xpbmcgeW91cnNlbGYsIHdvdWxkbid0IHlvdT8iLAogICAgICBpY29uOiBbMjQsIDldLAogICAgICByZXF1aXJlOiAiVGluIG9mIGJ1dHRlciBjb29raWVzIiwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJCdXR0ZXIgc2xhYnMiLAogICAgICBkZXNjOiAiTm90aGluZyBidXR0ZXIgdGhhbiBhIHNsYWIgdG8gdGhlIGZhY2UuIiwKICAgICAgaWNvbjogWzI1LCA5XSwKICAgICAgcmVxdWlyZTogIlRpbiBvZiBidXR0ZXIgY29va2llcyIsCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkJ1dHRlciBzd2lybHMiLAogICAgICBkZXNjOiAiVGhlc2UgYXJlIGVxdWFsIHBhcnRzIHN1Z2FyLCBidXR0ZXIsIGFuZCB3YXJtIGZ1enp5IGZlZWxpbmdzIC0gYWxsIG9mIHdoaWNoIGNhdXNlIG1pbGxpb25zIG9mIGRlYXRocyBldmVyeSBkYXkuIiwKICAgICAgaWNvbjogWzI2LCA5XSwKICAgICAgcmVxdWlyZTogIlRpbiBvZiBidXR0ZXIgY29va2llcyIsCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwoKICAgIG9yZGVyID0gMTAwMjA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiU2hvcnRicmVhZCBiaXNjdWl0cyIsCiAgICAgIGRlc2M6ICJUaGVzZSByaWNoIGJ1dHRlciBjb29raWVzIGFyZSBuZWl0aGVyIHNob3J0LCBub3IgYnJlYWQuIFdoYXQgYSBjb3VudHJ5ISIsCiAgICAgIGljb246IFsyMywgMTBdLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiTWlsbGlvbmFpcmVzJyBzaG9ydGJyZWFkcyIsCiAgICAgIGRlc2M6ICJUaHJlZSB0aG91Z2h0LXByb3Zva2luZyBsYXllcnMgb2YgY3JlYW15IGNob2NvbGF0ZSwgaGFyZC13b3JraW5nIGNhcmFtZWwgYW5kIGNydW1ibHkgYmlzY3VpdCBpbiBhIHBvaWduYW50IGNvbW1lbnRhcnkgb2YgY2xhc3Mgc3RydWdnbGUuIiwKICAgICAgaWNvbjogWzI0LCAxMF0sCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQ2FyYW1lbCBjb29raWVzIiwKICAgICAgZGVzYzogIlRoZSBwb2x5bWVyaXplZCBjYXJib2h5ZHJhdGVzIGFkb3JuaW5nIHRoZXNlIGNvb2tpZXMgYXJlIHN1cmUgdG8gc3RpY2sgdG8geW91ciB0ZWV0aCBmb3IgcXVpdGUgYSB3aGlsZS4iLAogICAgICBpY29uOiBbMjUsIDEwXSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKCiAgICB2YXIgZGVzYyA9IGZ1bmN0aW9uICh0b3RhbEhvdXJzKSB7CiAgICAgIHJldHVybiBsb2MoCiAgICAgICAgIllvdSByZXRhaW4gb3B0aW1hbCBjb29raWUgcHJvZHVjdGlvbiB3aGlsZSB0aGUgZ2FtZSBpcyBjbG9zZWQgZm9yIHR3aWNlIGFzIGxvbmcsIGZvciBhIHRvdGFsIG9mIDxiPiUxPC9iPi4iLAogICAgICAgIEdhbWUuc2F5VGltZSh0b3RhbEhvdXJzICogNjAgKiA2MCAqIEdhbWUuZnBzLCAtMSkKICAgICAgKTsKICAgIH07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQmVscGhlZ29yIiwKICAgICAgZGVzYygyKSArCiAgICAgICAgIjxxPkEgZGVtb24gb2Ygc2hvcnRjdXRzIGFuZCBsYXppbmVzcywgQmVscGhlZ29yIGNvbW1hbmRzIG1hY2hpbmVzIHRvIGRvIHdvcmsgaW4gaGlzIHN0ZWFkLjwvcT4iLAogICAgICBNYXRoLnBvdyhhbmdlbFByaWNlRmFjdG9yLCAxKSwKICAgICAgWzcsIDExXQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJUd2luIEdhdGVzIG9mIFRyYW5zY2VuZGVuY2UiXTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJNYW1tb24iLAogICAgICBkZXNjKDQpICsKICAgICAgICAiPHE+VGhlIGRlbW9uaWMgZW1ib2RpbWVudCBvZiB3ZWFsdGgsIE1hbW1vbiByZXF1ZXN0cyBhIHRpdGhlIG9mIGJsb29kIGFuZCBnb2xkIGZyb20gYWxsIGhpcyB3b3JzaGlwcGVycy48L3E+IiwKICAgICAgTWF0aC5wb3coYW5nZWxQcmljZUZhY3RvciwgMiksCiAgICAgIFs4LCAxMV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiQmVscGhlZ29yIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQWJhZGRvbiIsCiAgICAgIGRlc2MoOCkgKwogICAgICAgICI8cT5NYXN0ZXIgb2Ygb3ZlcmluZHVsZ2VuY2UsIEFiYWRkb24gZ292ZXJucyB0aGUgd3JpbmtsZXIgYnJvb2QgYW5kIGluc3BpcmVzIHRoZWlyIGluc2F0aWFiaWxpdHkuPC9xPiIsCiAgICAgIE1hdGgucG93KGFuZ2VsUHJpY2VGYWN0b3IsIDMpLAogICAgICBbOSwgMTFdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIk1hbW1vbiJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlNhdGFuIiwKICAgICAgZGVzYygxNikgKwogICAgICAgICI8cT5UaGUgY291bnRlcnBvaW50IHRvIGV2ZXJ5dGhpbmcgcmlnaHRlb3VzLCB0aGlzIGRlbW9uIHJlcHJlc2VudHMgdGhlIG5lZmFyaW91cyBpbmZsdWVuY2Ugb2YgZGVjZWl0IGFuZCB0ZW1wdGF0aW9uLjwvcT4iLAogICAgICBNYXRoLnBvdyhhbmdlbFByaWNlRmFjdG9yLCA0KSwKICAgICAgWzEwLCAxMV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiQWJhZGRvbiJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkFzbW9kZXVzIiwKICAgICAgZGVzYygzMikgKwogICAgICAgICI8cT5UaGlzIGRlbW9uIHdpdGggdGhyZWUgbW9uc3Ryb3VzIGhlYWRzIGRyYXdzIGhpcyBwb3dlciBmcm9tIHRoZSBhbGwtY29uc3VtaW5nIGRlc2lyZSBmb3IgY29va2llcyBhbmQgYWxsIHRoaW5ncyBzd2VldC48L3E+IiwKICAgICAgTWF0aC5wb3coYW5nZWxQcmljZUZhY3RvciwgNSksCiAgICAgIFsxMSwgMTFdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIlNhdGFuIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQmVlbHplYnViIiwKICAgICAgZGVzYyg2NCkgKwogICAgICAgICI8cT5UaGUgZmVzdGVyaW5nIGluY2FybmF0aW9uIG9mIGJsaWdodCBhbmQgZGlzZWFzZSwgQmVlbHplYnViIHJ1bGVzIG92ZXIgdGhlIHZhc3QgYXJtaWVzIG9mIHBhc3RyeSBpbmZlcm5vLjwvcT4iLAogICAgICBNYXRoLnBvdyhhbmdlbFByaWNlRmFjdG9yLCA2KSwKICAgICAgWzEyLCAxMV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiQXNtb2RldXMiXTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJMdWNpZmVyIiwKICAgICAgZGVzYygxMjgpICsKICAgICAgICAiPHE+QWxzbyBrbm93biBhcyB0aGUgTGlnaHRicmluZ2VyLCB0aGlzIGluZmVybmFsIHByaW5jZSdzIHRyZW1lbmRvdXMgZWdvIGNhdXNlZCBoaW0gdG8gYmUgY2FzdCBkb3duIGZyb20gcGFzdHJ5IGhlYXZlbi48L3E+IiwKICAgICAgTWF0aC5wb3coYW5nZWxQcmljZUZhY3RvciwgNyksCiAgICAgIFsxMywgMTFdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkJlZWx6ZWJ1YiJdOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJHb2xkZW4gY29va2llIGFsZXJ0IHNvdW5kIiwKICAgICAgbG9jKAogICAgICAgICJVbmxvY2tzIHRoZSA8Yj5nb2xkZW4gY29va2llIHNvdW5kIHNlbGVjdG9yPC9iPiwgd2hpY2ggbGV0cyB5b3UgcGljayB3aGV0aGVyIGdvbGRlbiBjb29raWVzIGVtaXQgYSBzb3VuZCB3aGVuIGFwcGVhcmluZyBvciBub3QuIgogICAgICApICsgIjxxPkEgc291bmQgZGVjaXNpb24uPC9xPiIsCiAgICAgIDk5OTk5OSwKICAgICAgWzI4LCA2XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJSZXNpZHVhbCBsdWNrIl07CgogICAgb3JkZXIgPSA0OTkwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJHb2xkZW4gY29va2llIHNvdW5kIHNlbGVjdG9yIiwKICAgICAgbG9jKCJMZXRzIHlvdSBjaGFuZ2UgdGhlIHNvdW5kIGdvbGRlbiBjb29raWVzIG1ha2Ugd2hlbiB0aGV5IHNwYXduLiIpLAogICAgICAwLAogICAgICBbMjgsIDZdCiAgICApOwogICAgR2FtZS5sYXN0LmRlc2NGdW5jID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgY2hvaWNlID0gdGhpcy5jaG9pY2VzRnVuY3Rpb24oKVtHYW1lLmNoaW1lVHlwZV07CiAgICAgIHJldHVybiAoCiAgICAgICAgJzxkaXYgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyI+JyArCiAgICAgICAgbG9jKCJDdXJyZW50OiIpICsKICAgICAgICAiICIgKwogICAgICAgIHRpbnlJY29uKGNob2ljZS5pY29uKSArCiAgICAgICAgIiA8Yj4iICsKICAgICAgICBjaG9pY2UubmFtZSArCiAgICAgICAgJzwvYj48L2Rpdj48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICB0aGlzLmRkZXNjCiAgICAgICk7CiAgICB9OwoKICAgIEdhbWUubGFzdC5wb29sID0gInRvZ2dsZSI7CiAgICBHYW1lLmxhc3QuY2hvaWNlc0Z1bmN0aW9uID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgY2hvaWNlcyA9IFtdOwogICAgICBjaG9pY2VzWzBdID0geyBuYW1lOiAiTm8gc291bmQiLCBpY29uOiBbMCwgN10gfTsKICAgICAgY2hvaWNlc1sxXSA9IHsgbmFtZTogIkNoaW1lIiwgaWNvbjogWzIyLCA2XSB9OwogICAgICBjaG9pY2VzWzJdID0geyBuYW1lOiAiRm9ydHVuZSIsIGljb246IFsyNywgNl0gfTsKICAgICAgY2hvaWNlc1szXSA9IHsgbmFtZTogIkN5bWJhbCIsIGljb246IFs5LCAxMF0gfTsKICAgICAgY2hvaWNlc1s0XSA9IHsgbmFtZTogIlNxdWVhayIsIGljb246IFs4LCAxMF0gfTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaG9pY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY2hvaWNlc1tpXS5uYW1lID0gbG9jKGNob2ljZXNbaV0ubmFtZSk7CiAgICAgIH0KCiAgICAgIGNob2ljZXNbR2FtZS5jaGltZVR5cGVdLnNlbGVjdGVkID0gMTsKICAgICAgcmV0dXJuIGNob2ljZXM7CiAgICB9OwogICAgR2FtZS5sYXN0LmNob2ljZXNQaWNrID0gZnVuY3Rpb24gKGlkKSB7CiAgICAgIEdhbWUuY2hpbWVUeXBlID0gaWQ7CiAgICAgIEdhbWUucGxheUdvbGRlbkNvb2tpZUNoaW1lKCk7CiAgICB9OwogICAgR2FtZS5wbGF5R29sZGVuQ29va2llQ2hpbWUgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChHYW1lLmNoaW1lVHlwZSA9PSAxKSBQbGF5U291bmQoInNuZC9jaGltZS5tcDMiKTsKICAgICAgZWxzZSBpZiAoR2FtZS5jaGltZVR5cGUgPT0gMikgUGxheVNvdW5kKCJzbmQvZm9ydHVuZS5tcDMiKTsKICAgICAgZWxzZSBpZiAoR2FtZS5jaGltZVR5cGUgPT0gMykgUGxheVNvdW5kKCJzbmQvY3ltYmFsUmV2Lm1wMyIpOwogICAgICBlbHNlIGlmIChHYW1lLmNoaW1lVHlwZSA9PSA0KSB7CiAgICAgICAgR2FtZS53cmlua2xlclNxdWlzaFNvdW5kKys7CiAgICAgICAgaWYgKEdhbWUud3JpbmtsZXJTcXVpc2hTb3VuZCA+IDQpIHsKICAgICAgICAgIEdhbWUud3JpbmtsZXJTcXVpc2hTb3VuZCAtPSA0OwogICAgICAgIH0KICAgICAgICBQbGF5U291bmQoInNuZC9zcXVlYWsiICsgR2FtZS53cmlua2xlclNxdWlzaFNvdW5kICsgIi5tcDMiKTsKICAgICAgfQogICAgfTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQmFzaWMgd2FsbHBhcGVyIGFzc29ydG1lbnQiLAogICAgICBsb2MoCiAgICAgICAgIlVubG9ja3MgdGhlIDxiPmJhY2tncm91bmQgc2VsZWN0b3I8L2I+LCBsZXR0aW5nIHlvdSBzZWxlY3QgdGhlIGdhbWUncyBiYWNrZ3JvdW5kLjxicj5Db21lcyB3aXRoIGEgdmFyaWV0eSBvZiBiYXNpYyBmbGF2b3JzLiIKICAgICAgKSArCiAgICAgICAgIjxxPlByaW9yaXRpemluZyBhZXN0aGV0aWNzIG92ZXIgY3J1Y2lhbCB1dGlsaXRhcmlhbiB1cGdyYWRlcz8gQ29sb3IgbWUgaW1wcmVzc2VkLjwvcT4iLAogICAgICA5OSwKICAgICAgWzI5LCA1XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJDbGFzc2ljIGRhaXJ5IHNlbGVjdGlvbiJdOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJMZWdhY3kiLAogICAgICBsb2MoCiAgICAgICAgJ1RoaXMgaXMgdGhlIGZpcnN0IGhlYXZlbmx5IHVwZ3JhZGU7IGl0IHVubG9ja3MgdGhlIDxiPkhlYXZlbmx5IGNoaXBzPC9iPiBzeXN0ZW0uPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+RWFjaCB0aW1lIHlvdSBhc2NlbmQsIHRoZSBjb29raWVzIHlvdSBtYWRlIGluIHlvdXIgcGFzdCBsaWZlIGFyZSB0dXJuZWQgaW50byA8Yj5oZWF2ZW5seSBjaGlwczwvYj4gYW5kIDxiPnByZXN0aWdlPC9iPi48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj48Yj5IZWF2ZW5seSBjaGlwczwvYj4gY2FuIGJlIHNwZW50IG9uIGEgdmFyaWV0eSBvZiBwZXJtYW5lbnQgdHJhbnNjZW5kZW50YWwgdXBncmFkZXMuPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+WW91ciA8Yj5wcmVzdGlnZSBsZXZlbDwvYj4gYWxzbyBnaXZlcyB5b3UgYSBwZXJtYW5lbnQgPGI+KzElIENwUzwvYj4gcGVyIGxldmVsLicKICAgICAgKSArICI8cT5XZSd2ZSBhbGwgYmVlbiB3YWl0aW5nIGZvciB5b3UuPC9xPiIsCiAgICAgIDEsCiAgICAgIFsyMSwgNl0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFtdOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJFbGRlciBzcGljZSIsCiAgICAgIGxvYygiWW91IGNhbiBhdHRyYWN0IDxiPiUxIG1vcmUgd3JpbmtsZXJzPC9iPi4iLCAyKSArCiAgICAgICAgIjxxPlRoZSBjb29raWUgeW91ciBjb29raWUgY291bGQgc21lbGwgbGlrZS48L3E+IiwKICAgICAgNDQ0NDQ0LAogICAgICBbMTksIDhdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIlVuaG9seSBiYWl0Il07CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlJlc2lkdWFsIGx1Y2siLAogICAgICBsb2MoCiAgICAgICAgIldoaWxlIHRoZSBnb2xkZW4gc3dpdGNoIGlzIG9uLCB5b3UgZ2FpbiBhbiBhZGRpdGlvbmFsIDxiPislMSUgQ3BTPC9iPiBwZXIgZ29sZGVuIGNvb2tpZSB1cGdyYWRlIG93bmVkLiIsCiAgICAgICAgMTAKICAgICAgKSArICI8cT5Gb3J0dW5lIGNvbWVzIGluIG1hbnkgZmxhdm9ycy48L3E+IiwKICAgICAgOTk5OTksCiAgICAgIFsyNywgNl0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiR29sZGVuIHN3aXRjaCJdOwoKICAgIG9yZGVyID0gMTUwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkZhbnRhc3RlZWwgbW91c2UiLAogICAgICBnZXRTdHJDbGlja2luZ0dhaW5zKDEpICsKICAgICAgICAiPHE+WW91IGNvdWxkIGJlIGNsaWNraW5nIHVzaW5nIHlvdXIgdG91Y2hwYWQgYW5kIHdlJ2QgYmUgbm9uZSB0aGUgd2lzZXIuPC9xPiIsCiAgICAgIDUwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIFsxMSwgMTddCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgOCwgMTEpOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIk5ldmVyY3JhY2sgbW91c2UiLAogICAgICBnZXRTdHJDbGlja2luZ0dhaW5zKDEpICsKICAgICAgICAiPHE+SG93IG11Y2ggYmVlZmllciBjYW4geW91IG1ha2UgYSBtb3VzZSB1bnRpbCBpdCdzIGNvbnNpZGVyZWQgYSByYXQ/PC9xPiIsCiAgICAgIDUwMDAwMDAwMDAwMDAwMDAwMDAwMCwKICAgICAgWzExLCAxOF0KICAgICk7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCA5LCAxMSk7CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkZpdmUtZmluZ2VyIGRpc2NvdW50IiwKICAgICAgbG9jKCJBbGwgdXBncmFkZXMgYXJlIDxiPiUxJSBjaGVhcGVyIHBlciAlMjwvYj4uIiwgWwogICAgICAgIDEsCiAgICAgICAgbG9jKCIlMSBjdXJzb3IiLCAxMDApLAogICAgICBdKSArICI8cT5TdGljayBpdCB0byB0aGUgbWFuLjwvcT4iLAogICAgICA1NTU1NTUsCiAgICAgIFsyOCwgN10sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkID0gMTsKICAgICAgfQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJIYWxvIGdsb3ZlcyIsICJBYmFkZG9uIl07CgogICAgb3JkZXIgPSA1MDAwOwogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIkZ1dHVyZSBhbG1hbmFjcyIsCiAgICAgICI8cT5MZXRzIHlvdSBwcmVkaWN0IG9wdGltYWwgcGxhbnRpbmcgdGltZXMuIEl0J3MgY3Jhenkgd2hhdCB0aW1lIHRyYXZlbCBjYW4gZG8hPC9xPiIsCiAgICAgICJGYXJtIiwKICAgICAgIlRpbWUgbWFjaGluZSIsCiAgICAgICJzeW5lcmd5MSIKICAgICk7CiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlKAogICAgICAiUmFpbiBwcmF5ZXIiLAogICAgICAiPHE+QSBkZWVwbHkgc3Bpcml0dWFsIGNlcmVtb25pYWwgaW52b2x2aW5nIGNvbXBsaWNhdGVkIGRhbmNlIG1vdmVzIGFuZCBoaWdoLXRlY2ggY2xvdWQtYnVzdGluZyBsYXNlcnMuPC9xPiIsCiAgICAgICJGYXJtIiwKICAgICAgIlRlbXBsZSIsCiAgICAgICJzeW5lcmd5MiIKICAgICk7CgogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIlNlaXNtaWMgbWFnaWMiLAogICAgICAiPHE+U3VycHJpc2UgZWFydGhxdWFrZXMgYXJlIGFuIG9sZCBmYXZvcml0ZSBvZiB3aXphcmRseSBmcmF0IGhvdXNlcy48L3E+IiwKICAgICAgIk1pbmUiLAogICAgICAiV2l6YXJkIHRvd2VyIiwKICAgICAgInN5bmVyZ3kxIgogICAgKTsKICAgIEdhbWUuU3luZXJneVVwZ3JhZGUoCiAgICAgICJBc3Rlcm9pZCBtaW5pbmciLAogICAgICAiPHE+QXMgcGVyIHRoZSA8c3Bhbj4xOTwvc3Bhbj43NCBVbml0ZWQgQ29zbWljIENvbnZlbnRpb24sIGNvbWV0cywgbW9vbnMsIGFuZCBpbmhhYml0ZWQgcGxhbmV0b2lkcyBhcmUgbm8gbG9uZ2VyIGxlZ2FsbHkgZXhjYXZhdGFibGUuPGJyPkJ1dCBoZXksIGEgc3BhY2UgYnJpYmUgZ29lcyBhIGxvbmcgd2F5LjwvcT4iLAogICAgICAiTWluZSIsCiAgICAgICJTaGlwbWVudCIsCiAgICAgICJzeW5lcmd5MiIKICAgICk7CgogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIlF1YW50dW0gZWxlY3Ryb25pY3MiLAogICAgICAiPHE+WW91ciBtYWNoaW5lcyB3b24ndCBldmVuIGJlIHN1cmUgaWYgdGhleSdyZSBvbiBvciBvZmYhPC9xPiIsCiAgICAgICJGYWN0b3J5IiwKICAgICAgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwKICAgICAgInN5bmVyZ3kxIgogICAgKTsKICAgIEdhbWUuU3luZXJneVVwZ3JhZGUoCiAgICAgICJUZW1wb3JhbCBvdmVyY2xvY2tpbmciLAogICAgICAiPHE+SW50cm9kdWNlIG1vcmUgcXVpY2tpdHVkZSBpbiB5b3VyIHN5c3RlbSBmb3IgaW5jcmVhc2VkIHNwZWVkYXRpb24gb2YgZmFzdG5lc3MuPC9xPiIsCiAgICAgICJGYWN0b3J5IiwKICAgICAgIlRpbWUgbWFjaGluZSIsCiAgICAgICJzeW5lcmd5MiIKICAgICk7CgogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIkNvbnRyYWN0cyBmcm9tIGJleW9uZCIsCiAgICAgICI8cT5NYWtlIHN1cmUgdG8gcmVhZCB0aGUgZmluZSBwcmludCE8L3E+IiwKICAgICAgIkJhbmsiLAogICAgICAiUG9ydGFsIiwKICAgICAgInN5bmVyZ3kxIgogICAgKTsKICAgIEdhbWUuU3luZXJneVVwZ3JhZGUoCiAgICAgICJQcmludGluZyBwcmVzc2VzIiwKICAgICAgIjxxPkZha2UgYmlsbHMgc28gcmVhbCwgdGhleSdyZSBhbG1vc3Qgd29ydGggdGhlIGluayB0aGV5J3JlIHByaW50ZWQgd2l0aC48L3E+IiwKICAgICAgIkJhbmsiLAogICAgICAiRmFjdG9yeSIsCiAgICAgICJzeW5lcmd5MiIKICAgICk7CgogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIlBhZ2FuaXNtIiwKICAgICAgIjxxPlNvbWUgZGVpdGllcyBhcmUgYmV0dGVyIGxlZnQgdW53b3JzaGlwcGVkLjwvcT4iLAogICAgICAiVGVtcGxlIiwKICAgICAgIlBvcnRhbCIsCiAgICAgICJzeW5lcmd5MSIKICAgICk7CiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlKAogICAgICAiR29kIHBhcnRpY2xlIiwKICAgICAgIjxxPlR1cm5zIG91dCBHb2QgaXMgbXVjaCB0aW5pZXIgdGhhbiB3ZSB0aG91Z2h0LCBJIGd1ZXNzLjwvcT4iLAogICAgICAiVGVtcGxlIiwKICAgICAgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwKICAgICAgInN5bmVyZ3kyIgogICAgKTsKCiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlKAogICAgICAiQXJjYW5lIGtub3dsZWRnZSIsCiAgICAgICI8cT5Tb21lIHRoaW5ncyB3ZXJlIG5ldmVyIG1lYW50IHRvIGJlIGtub3duIC0gb25seSBtaWxkbHkgc3BlY3VsYXRlZC48L3E+IiwKICAgICAgIldpemFyZCB0b3dlciIsCiAgICAgICJBbGNoZW15IGxhYiIsCiAgICAgICJzeW5lcmd5MSIKICAgICk7CiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlKAogICAgICAiTWFnaWNhbCBib3RhbnkiLAogICAgICAnPHE+QWxyZWFkeSBrbm93biBpbiBzb21lIHJlYWN0aW9uYXJ5IG5ld3NwYXBlcnMgYXMgInRoZSB3aXphcmRcJ3MgR01PcyIuPC9xPicsCiAgICAgICJXaXphcmQgdG93ZXIiLAogICAgICAiRmFybSIsCiAgICAgICJzeW5lcmd5MiIKICAgICk7CgogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIkZvc3NpbCBmdWVscyIsCiAgICAgICI8cT5Tb21laG93IGJldHRlciB0aGFuIHBsdXRvbml1bSBmb3IgcG93ZXJpbmcgcm9ja2V0cy48YnI+RXh0cmFjdGVkIGZyb20gdGhlIGZ1ZWxzIG9mIGFuY2llbnQsIGZvc3NpbGl6ZWQgY2l2aWxpemF0aW9ucy48L3E+IiwKICAgICAgIlNoaXBtZW50IiwKICAgICAgIk1pbmUiLAogICAgICAic3luZXJneTEiCiAgICApOwogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIlNoaXB5YXJkcyIsCiAgICAgICI8cT5XaGVyZSBjYXJwZW50cnksIGJsaW5kIGx1Y2ssIGFuZCBhc2Jlc3RvcyBpbnN1bGF0aW9uIHVuaXRlIHRvIHByb2R1Y2UgdGhlIG1vc3QgZGF6emxpbmcgc3BhY2VzaGlwcyBvbiB0aGUgcGxhbmV0LjwvcT4iLAogICAgICAiU2hpcG1lbnQiLAogICAgICAiRmFjdG9yeSIsCiAgICAgICJzeW5lcmd5MiIKICAgICk7CgogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIlByaW1vcmRpYWwgb3JlcyIsCiAgICAgICI8cT5Pbmx5IHdoZW4gcmVmaW5pbmcgdGhlIHB1cmVzdCBtZXRhbHMgd2lsbCB5b3UgZXh0cmFjdCB0aGUgc3dlZXRlc3Qgc2FwIG9mIHRoZSBlYXJ0aC48L3E+IiwKICAgICAgIkFsY2hlbXkgbGFiIiwKICAgICAgIk1pbmUiLAogICAgICAic3luZXJneTEiCiAgICApOwogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIkdvbGQgZnVuZCIsCiAgICAgICI8cT5JZiBnb2xkIGlzIHRoZSBiYWNrYm9uZSBvZiB0aGUgZWNvbm9teSwgY29va2llcywgc3VyZWx5LCBhcmUgaXRzIGhpcCBqb2ludHMuPC9xPiIsCiAgICAgICJBbGNoZW15IGxhYiIsCiAgICAgICJCYW5rIiwKICAgICAgInN5bmVyZ3kyIgogICAgKTsKCiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlKAogICAgICAiSW5mZXJuYWwgY3JvcHMiLAogICAgICAiPHE+U3ByaW5rbGUgcmVndWxhcmx5IHdpdGggRklSRS48L3E+IiwKICAgICAgIlBvcnRhbCIsCiAgICAgICJGYXJtIiwKICAgICAgInN5bmVyZ3kxIgogICAgKTsKICAgIEdhbWUuU3luZXJneVVwZ3JhZGUoCiAgICAgICJBYnlzbWFsIGdsaW1tZXIiLAogICAgICAiPHE+U29tZW9uZSwgb3Igc29tZXRoaW5nLCBpcyBzdGFyaW5nIGJhY2sgYXQgeW91Ljxicj5QZXJoYXBzIGF0IGFsbCBvZiB1cy48L3E+IiwKICAgICAgIlBvcnRhbCIsCiAgICAgICJQcmlzbSIsCiAgICAgICJzeW5lcmd5MiIKICAgICk7CgogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIlJlbGF0aXZpc3RpYyBwYXJzZWMtc2tpcHBpbmciLAogICAgICAiPHE+UGVvcGxlIHdpbGwgdGVsbCB5b3UgdGhpcyBpc24ndCBwaHlzaWNhbGx5IHBvc3NpYmxlLjxicj5UaGVzZSBhcmUgcGVvcGxlIHlvdSBkb24ndCB3YW50IG9uIHlvdXIgc2hpcC48L3E+IiwKICAgICAgIlRpbWUgbWFjaGluZSIsCiAgICAgICJTaGlwbWVudCIsCiAgICAgICJzeW5lcmd5MSIKICAgICk7CiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlKAogICAgICAiUHJpbWV2YWwgZ2xvdyIsCiAgICAgICI8cT5Gcm9tIHVuZW5kaW5nIHRpbWVzLCBhbiBhbmNpZW50IGxpZ2h0IHN0aWxsIHNoaW5lcywgaW1wb3NzaWJseSBwdXJlIGFuZCBmcmFnaWxlIGluIGl0cyBvbGQgYWdlLjwvcT4iLAogICAgICAiVGltZSBtYWNoaW5lIiwKICAgICAgIlByaXNtIiwKICAgICAgInN5bmVyZ3kyIgogICAgKTsKCiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlKAogICAgICAiRXh0cmEgcGh5c2ljcyBmdW5kaW5nIiwKICAgICAgIjxxPlRpbWUgdG8gcHV0IHlvdXIgbW9uZXkgd2hlcmUgeW91ciBwYXJ0aWNsZSBjb2xsaWRlcnMgYXJlLjwvcT4iLAogICAgICAiQW50aW1hdHRlciBjb25kZW5zZXIiLAogICAgICAiQmFuayIsCiAgICAgICJzeW5lcmd5MSIKICAgICk7CiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlKAogICAgICAiQ2hlbWljYWwgcHJvZmljaWVuY3kiLAogICAgICAiPHE+RGlzY292ZXIgZXhjaXRpbmcgbmV3IGVsZW1lbnRzLCBzdWNoIGFzIEZsZXNobWVsdGl1bSwgSW5lcnQgU2hhbXBvbyBCeXByb2R1Y3QgIzE3IGFuZCBDYXJib24rKyE8L3E+IiwKICAgICAgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwKICAgICAgIkFsY2hlbXkgbGFiIiwKICAgICAgInN5bmVyZ3kyIgogICAgKTsKCiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlKAogICAgICAiTGlnaHQgbWFnaWMiLAogICAgICAiPHE+QWN0dWFsbHkgbm90IHRvIGJlIHRha2VuIGxpZ2h0bHkhIE5vLCBJJ20gc2VyaW91cy4gMTc4IHBlb3BsZSBkaWVkIGxhc3QgeWVhci4gWW91IGRvbid0IG1lc3MgYXJvdW5kIHdpdGggbWFnaWMuPC9xPiIsCiAgICAgICJQcmlzbSIsCiAgICAgICJXaXphcmQgdG93ZXIiLAogICAgICAic3luZXJneTEiCiAgICApOwogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIk15c3RpY2FsIGVuZXJnaWVzIiwKICAgICAgIjxxPlNvbWV0aGluZyBiZWNrb25zIGZyb20gd2l0aGluIHRoZSBsaWdodC4gSXQgaXMgd2FybSwgY29tZm9ydGluZywgYW5kIGFwcGFyZW50bHkgdGhlIGNhdXNlIGZvciBzZXZlcmFsIGtpbmRzIG9mIGV4b3RpYyBza2luIGNhbmNlcnMuPC9xPiIsCiAgICAgICJQcmlzbSIsCiAgICAgICJUZW1wbGUiLAogICAgICAic3luZXJneTIiCiAgICApOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTeW5lcmdpZXMgVm9sLiBJIiwKICAgICAgbG9jKAogICAgICAgICJVbmxvY2tzIGEgbmV3IHRpZXIgb2YgdXBncmFkZXMgdGhhdCBhZmZlY3QgPGI+MiBidWlsZGluZ3MgYXQgdGhlIHNhbWUgdGltZTwvYj4uPGJyPlN5bmVyZ2llcyBhcHBlYXIgb25jZSB5b3UgaGF2ZSA8Yj4lMTwvYj4gb2YgYm90aCBidWlsZGluZ3MuIiwKICAgICAgICAxNQogICAgICApICsgIjxxPlRoZSBtYW55IGJlYXRzIHRoZSBmZXcuPC9xPiIsCiAgICAgIDIyMjIyMiwKICAgICAgWzEwLCAyMF0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiU2F0YW4iLCAiRG9taW5pb25zIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiU3luZXJnaWVzIFZvbC4gSUkiLAogICAgICBsb2MoCiAgICAgICAgIlVubG9ja3MgYSBuZXcgdGllciBvZiB1cGdyYWRlcyB0aGF0IGFmZmVjdCA8Yj4yIGJ1aWxkaW5ncyBhdCB0aGUgc2FtZSB0aW1lPC9iPi48YnI+U3luZXJnaWVzIGFwcGVhciBvbmNlIHlvdSBoYXZlIDxiPiUxPC9iPiBvZiBib3RoIGJ1aWxkaW5ncy4iLAogICAgICAgIDc1CiAgICAgICkgKyAiPHE+VGhlIHNldmVyYWwgYmVhdHMgdGhlIG1hbnkuPC9xPiIsCiAgICAgIDIyMjIyMjIsCiAgICAgIFsxMCwgMjldCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkJlZWx6ZWJ1YiIsICJTZXJhcGhpbSIsICJTeW5lcmdpZXMgVm9sLiBJIl07CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkhlYXZlbmx5IGNvb2tpZXMiLAogICAgICBsb2MoIkNvb2tpZSBwcm9kdWN0aW9uIG11bHRpcGxpZXIgPGI+KyUxJSBwZXJtYW5lbnRseTwvYj4uIiwgMTApICsKICAgICAgICAiPHE+QmFrZWQgd2l0aCBoZWF2ZW5seSBjaGlwcy4gQW4gb3RoZXJ3b3JkbHkgZmxhdm9yIHRoYXQgdHJhbnNjZW5kcyB0aW1lIGFuZCBzcGFjZS48L3E+IiwKICAgICAgMywKICAgICAgWzI1LCAxMl0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiTGVnYWN5Il07CiAgICBHYW1lLmxhc3QucG93ZXIgPSAxMDsKICAgIEdhbWUubGFzdC5wc2V1ZG9Db29raWUgPSB0cnVlOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIldyaW5rbHkgY29va2llcyIsCiAgICAgIGxvYygiQ29va2llIHByb2R1Y3Rpb24gbXVsdGlwbGllciA8Yj4rJTElIHBlcm1hbmVudGx5PC9iPi4iLCAxMCkgKwogICAgICAgICI8cT5UaGUgcmVzdWx0IG9mIHJlZ3VsYXIgY29va2llcyBsZWZ0IHRvIGFnZSBvdXQgZm9yIGNvdW50bGVzcyBlb25zIGluIGEgcGxhY2Ugd2hlcmUgdGltZSBhbmQgc3BhY2UgYXJlIG1lYW5pbmdsZXNzLjwvcT4iLAogICAgICA2NjY2NjY2LAogICAgICBbMjYsIDEyXQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJTYWNyaWxlZ2lvdXMgY29ycnVwdGlvbiIsICJFbGRlciBzcGljZSJdOwogICAgR2FtZS5sYXN0LnBvd2VyID0gMTA7CiAgICBHYW1lLmxhc3QucHNldWRvQ29va2llID0gdHJ1ZTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJEaXN0aWxsZWQgZXNzZW5jZSBvZiByZWRvdWJsZWQgbHVjayIsCiAgICAgIGxvYygKICAgICAgICAiR29sZGVuIGNvb2tpZXMgKGFuZCBhbGwgb3RoZXIgdGhpbmdzIHRoYXQgc3Bhd24sIHN1Y2ggYXMgcmVpbmRlZXIpIGhhdmUgPGI+JTElIGNoYW5jZSBvZiBiZWluZyBkb3VibGVkPC9iPi4iLAogICAgICAgIDEKICAgICAgKSArCiAgICAgICAgIjxxPlRhc3RlcyBnbGl0dGVyeS4gVGhlIGVtcHR5IHBoaWFsIG1ha2VzIGZvciBhIGdyZWF0IHBlbmNpbCBob2xkZXIuPC9xPiIsCiAgICAgIDc3Nzc3NzcsCiAgICAgIFsyNywgMTJdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkRpdmluZSBiYWtlcmllcyIsICJSZXNpZHVhbCBsdWNrIl07CgogICAgb3JkZXIgPSA0MDAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJPY2N1bHQgb2JzdHJ1Y3Rpb24iLAogICAgICBsb2MoIkNvb2tpZSBwcm9kdWN0aW9uIDxiPnJlZHVjZWQgdG8gMDwvYj4uIikgKwogICAgICAgICI8cT5JZiBzeW1wdG9tcyBwZXJzaXN0LCBjb25zdWx0IGEgZG9jdG9yLjwvcT4iLAogICAgICA3LAogICAgICBbMTUsIDVdCiAgICApOyAvL2RlYnVnIHB1cnBvc2VzIG9ubHkKICAgIEdhbWUubGFzdC5wb29sID0gImRlYnVnIjsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJHbHVjb3NlLWNoYXJnZWQgYWlyIiwKICAgICAgbG9jKCJTdWdhciBsdW1wcyBjb2FsZXNjZSA8Yj5hIHdob2xlIGxvdCBmYXN0ZXI8L2I+LiIpICsKICAgICAgICAiPHE+RG9uJ3QgYnJlYXRoZSB0b28gbXVjaCBvciB5b3UnbGwgZ2V0IGRpYWJldGVzITwvcT4iLAogICAgICA3LAogICAgICBbMjksIDE2XQogICAgKTsgLy9kZWJ1ZyBwdXJwb3NlcyBvbmx5CiAgICBHYW1lLmxhc3QucG9vbCA9ICJkZWJ1ZyI7CgogICAgb3JkZXIgPSAxMDMwMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJMYXZlbmRlciBjaG9jb2xhdGUgYnV0dGVyIGJpc2N1aXQiLAogICAgICBkZXNjOiAiUmV3YXJkZWQgZm9yIG93bmluZyAzMDAgb2YgZXZlcnl0aGluZy48YnI+VGhpcyBzdWJ0bHktZmxhdm9yZWQgYmlzY3VpdCByZXByZXNlbnRzIHRoZSBhY2NvbXBsaXNobWVudHMgb2YgZGVjYWRlcyBvZiB0b3Atc2VjcmV0IHJlc2VhcmNoLiBUaGUgbW9sZGVkIGRlc2lnbiBvbiB0aGUgY2hvY29sYXRlIHJlc2VtYmxlcyBhIHdlbGwta25vd24gZW50cmVwcmVuZXVyIHdobyBnYXZlIHRoZWlyIGFsbCB0byB0aGUgYW5jaWVudCBwYXRoIG9mIGJha2luZy4iLAogICAgICBpY29uOiBbMjYsIDEwXSwKICAgICAgcG93ZXI6IDEwLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogYnV0dGVyQmlzY3VpdE11bHQsCiAgICAgIGxvY2tlZDogMSwKICAgIH0pOwoKICAgIG9yZGVyID0gMTAwMzA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiTG9tYmFyZGlhIGNvb2tpZXMiLAogICAgICBkZXNjOiAiVGhlc2UgY29tZSBmcm9tIHRob3NlIGZhcm1zIHdpdGggdGhlIHJlYWxseSBnb29kIG1lbW9yeS4iLAogICAgICBpY29uOiBbMjMsIDEzXSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBicmFuZCBiaXNjdWl0cyIsCiAgICAgIHBvd2VyOiAzLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkJhc3RlbmFrZW4gY29va2llcyIsCiAgICAgIGRlc2M6ICJGcmVuY2ggY29va2llcyBtYWRlIG9mIGRlbGljaW91cyBjaW5uYW1vbiBhbmQgY2FuZHkgc3VnYXIuIFRoZXNlIGRvIG5vdCBjb250YWluIE51dHMhIiwKICAgICAgaWNvbjogWzI0LCAxM10sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgYnJhbmQgYmlzY3VpdHMiLAogICAgICBwb3dlcjogMywKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OSAqIDUsCiAgICB9KTsKCiAgICBvcmRlciA9IDEwMDIwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlBlY2FuIHNhbmRpZXMiLAogICAgICBkZXNjOiAiU3RpY2sgYSBudXQgb24gYSBjb29raWUgYW5kIGNhbGwgaXQgYSBkYXkhIE5hbWUgeW91ciBiYW5kIGFmdGVyIGl0ISBXaGF0ZXZlciEiLAogICAgICBpY29uOiBbMjUsIDEzXSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiTW9yYXZpYW4gc3BpY2UgY29va2llcyIsCiAgICAgIGRlc2M6ICJQb3B1bGFyIGZvciBiZWluZyB0aGUgd29ybGQncyBtb3JhdmlhbmVzdCBjb29raWVzLiIsCiAgICAgIGljb246IFsyNiwgMTNdLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJBbnphYyBiaXNjdWl0cyIsCiAgICAgIGRlc2M6ICJBcm15IGJpc2N1aXRzIGZyb20gYSBiYWtlcnkgZG93biB1bmRlciwgY29udGFpbmluZyBubyBlZ2dzIGJ1dCB5ZXMgb2F0cy4iLAogICAgICBpY29uOiBbMjcsIDEzXSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkJ1dHRlcmNha2VzIiwKICAgICAgZGVzYzogIkdsaXN0ZW5pbmcgd2l0aCBjaG9sZXN0ZXJvbCwgdGhlc2UgY29va2llcyBtb2lzdGx5IHN0cmFkZGxlIHRoZSBsaW5lIGJldHdlZW4gdGhlIGxlZ2FsIGRlZmluaXRpb24gb2YgYSBjb29raWUgYW5kIGp1c3QgYSBzdHJhaWdodC11cCBzdGljayBvZiBidXR0ZXIuIiwKICAgICAgaWNvbjogWzI5LCAxM10sCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJJY2UgY3JlYW0gc2FuZHdpY2hlcyIsCiAgICAgIGRlc2M6ICdJbiBhbiBhbHRlcm5hdGUgdW5pdmVyc2UsICJpY2UgY3JlYW0gc2FuZHdpY2giIGRlc2lnbmF0ZXMgYW4gaWNlIGNyZWFtIGNvbmUgZmlsbGVkIHdpdGggYmFjb24sIGxldHR1Y2UsIGFuZCB0b21hdG9lcy4gTWF5YmUgc29tZSBzcHJpbmtsZXMgdG9vLicsCiAgICAgIGljb246IFsyOCwgMTNdLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTdGV2aWEgQ2FlbGVzdGlzIiwKICAgICAgbG9jKAogICAgICAgICJTdWdhciBsdW1wcyByaXBlbiA8Yj4lMTwvYj4gc29vbmVyLiIsCiAgICAgICAgR2FtZS5zYXlUaW1lKDYwICogNjAgKiBHYW1lLmZwcykKICAgICAgKSArCiAgICAgICAgIjxxPkEgcGxhbnQgb2Ygc3VwZXJuYXR1cmFsIHN3ZWV0bmVzcyBncm93biBieSBhbmdlbHMgaW4gaGVhdmVubHkgZ2FyZGVucy48L3E+IiwKICAgICAgMTAwMDAwMDAwLAogICAgICBbMjUsIDE1XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJXcmlua2x5IGNvb2tpZXMiXTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJEaWFiZXRpY2EgRGFlbW9uaWN1cyIsCiAgICAgIGxvYygKICAgICAgICAiU3VnYXIgbHVtcHMgbWF0dXJlIDxiPiUxPC9iPiBzb29uZXIuIiwKICAgICAgICBHYW1lLnNheVRpbWUoNjAgKiA2MCAqIEdhbWUuZnBzKQogICAgICApICsKICAgICAgICAiPHE+QSBtYWxldm9sZW50LCBpZiBkZWxpY2lvdXMgaGVyYiB0aGF0IGlzIHNhaWQgdG8gZ3JvdyBvbiB0aGUgY2xpZmZzIG9mIHRoZSBkYXJrZXN0IGFieXNzIG9mIHRoZSB1bmRlcndvcmxkLjwvcT4iLAogICAgICAzMDAwMDAwMDAsCiAgICAgIFsyNiwgMTVdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIlN0ZXZpYSBDYWVsZXN0aXMiLCAiTHVjaWZlciJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlN1Y3JhbG9zaWEgSW51dGlsaXMiLAogICAgICBsb2MoCiAgICAgICAgIkJpZnVyY2F0ZWQgc3VnYXIgbHVtcHMgYXBwZWFyIDxiPiUxJSBtb3JlIG9mdGVuPC9iPiBhbmQgYXJlIDxiPiUyJSBtb3JlIGxpa2VseTwvYj4gdG8gZHJvcCAyIGx1bXBzLiIsCiAgICAgICAgWzUsIDVdCiAgICAgICkgKwogICAgICAgICI8cT5BIHJhcmUgYmVycnkgb2YgdW5pbnRlcmVzdGluZyBmbGF2b3IgdGhhdCBpcyBhcyBlbHVzaXZlIGFzIGl0cyB1c2VzIGFyZSBsaW1pdGVkOyBvbmx5IHNvdWdodC1hZnRlciBieSB0aGUgbW9zdCBhdmlkIGNvbGxlY3RvcnMgd2l0aCB0b28gbXVjaCB3ZWFsdGggb24gdGhlaXIgaGFuZHMuPC9xPiIsCiAgICAgIDEwMDAwMDAwMDAsCiAgICAgIFsyNywgMTVdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkRpYWJldGljYSBEYWVtb25pY3VzIl07CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkx1Y2t5IGRpZ2l0IiwKICAgICAgbG9jKAogICAgICAgICI8Yj4rJTElPC9iPiBwcmVzdGlnZSBsZXZlbCBlZmZlY3Qgb24gQ3BTLjxicj48Yj4rJTIlPC9iPiBnb2xkZW4gY29va2llIGVmZmVjdCBkdXJhdGlvbi48YnI+PGI+KyUzJTwvYj4gZ29sZGVuIGNvb2tpZSBsaWZlc3Bhbi4iLAogICAgICAgIFsxLCAxLCAxXQogICAgICApICsKICAgICAgICAiPHE+VGhpcyB1cGdyYWRlIGlzIGEgYml0IHNoeSBhbmQgb25seSBhcHBlYXJzIHdoZW4geW91ciBwcmVzdGlnZSBsZXZlbCBjb250YWlucyBhIDcuPC9xPiIsCiAgICAgIDc3NywKICAgICAgWzI0LCAxNV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiSGVhdmVubHkgbHVjayJdOwogICAgR2FtZS5sYXN0LnNob3dJZiA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIE1hdGguY2VpbCgoR2FtZS5wcmVzdGlnZSArICIiKS5zcGxpdCgiNyIpLmxlbmd0aCAtIDEpID49IDE7CiAgICB9OwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkx1Y2t5IG51bWJlciIsCiAgICAgIGxvYygKICAgICAgICAiPGI+KyUxJTwvYj4gcHJlc3RpZ2UgbGV2ZWwgZWZmZWN0IG9uIENwUy48YnI+PGI+KyUyJTwvYj4gZ29sZGVuIGNvb2tpZSBlZmZlY3QgZHVyYXRpb24uPGJyPjxiPislMyU8L2I+IGdvbGRlbiBjb29raWUgbGlmZXNwYW4uIiwKICAgICAgICBbMSwgMSwgMV0KICAgICAgKSArCiAgICAgICAgIjxxPlRoaXMgdXBncmFkZSBpcyBhIHJlY2x1c2l2ZSBoZXJtaXQgYW5kIG9ubHkgYXBwZWFycyB3aGVuIHlvdXIgcHJlc3RpZ2UgbGV2ZWwgY29udGFpbnMgdHdvIDcncy48L3E+IiwKICAgICAgNzc3NzcsCiAgICAgIFsyNCwgMTVdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkx1Y2t5IGRpZ2l0IiwgIkxhc3RpbmcgZm9ydHVuZSJdOwogICAgR2FtZS5sYXN0LnNob3dJZiA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIE1hdGguY2VpbCgoR2FtZS5wcmVzdGlnZSArICIiKS5zcGxpdCgiNyIpLmxlbmd0aCAtIDEpID49IDI7CiAgICB9OwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkx1Y2t5IHBheW91dCIsCiAgICAgIGxvYygKICAgICAgICAiPGI+KyUxJTwvYj4gcHJlc3RpZ2UgbGV2ZWwgZWZmZWN0IG9uIENwUy48YnI+PGI+KyUyJTwvYj4gZ29sZGVuIGNvb2tpZSBlZmZlY3QgZHVyYXRpb24uPGJyPjxiPislMyU8L2I+IGdvbGRlbiBjb29raWUgbGlmZXNwYW4uIiwKICAgICAgICBbMSwgMSwgMV0KICAgICAgKSArCiAgICAgICAgIjxxPlRoaXMgdXBncmFkZSB0b29rIGFuIG9hdGggb2YgY29tcGxldGUgc2VjbHVzaW9uIGZyb20gdGhlIHJlc3Qgb2YgdGhlIHdvcmxkIGFuZCBvbmx5IGFwcGVhcnMgd2hlbiB5b3VyIHByZXN0aWdlIGxldmVsIGNvbnRhaW5zIGZvdXIgNydzLjwvcT4iLAogICAgICA3Nzc3Nzc3NywKICAgICAgWzI0LCAxNV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiTHVja3kgbnVtYmVyIiwgIkRlY2lzaXZlIGZhdGUiXTsKICAgIEdhbWUubGFzdC5zaG93SWYgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBNYXRoLmNlaWwoKEdhbWUucHJlc3RpZ2UgKyAiIikuc3BsaXQoIjciKS5sZW5ndGggLSAxKSA+PSA0OwogICAgfTsKCiAgICBvcmRlciA9IDUwMDAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkJhY2tncm91bmQgc2VsZWN0b3IiLAogICAgICBsb2MoIkxldHMgeW91IHBpY2sgd2hpY2ggd2FsbHBhcGVyIHRvIGRpc3BsYXkuIiksCiAgICAgIDAsCiAgICAgIFsyOSwgNV0KICAgICk7CiAgICBHYW1lLmxhc3QuZGVzY0Z1bmMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBjaG9pY2UgPSB0aGlzLmNob2ljZXNGdW5jdGlvbigpW0dhbWUuYmdUeXBlXTsKICAgICAgaWYgKGNob2ljZSA9PSAwKSBjaG9pY2UgPSB0aGlzLmNob2ljZXNGdW5jdGlvbigpWzBdOwogICAgICByZXR1cm4gKAogICAgICAgICc8ZGl2IHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsiPicgKwogICAgICAgIGxvYygiQ3VycmVudDoiKSArCiAgICAgICAgIiAiICsKICAgICAgICB0aW55SWNvbihjaG9pY2UuaWNvbikgKwogICAgICAgICIgPGI+IiArCiAgICAgICAgY2hvaWNlLm5hbWUgKwogICAgICAgICc8L2I+PC9kaXY+PGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgdGhpcy5kZGVzYwogICAgICApOwogICAgfTsKCiAgICBHYW1lLmxhc3QucG9vbCA9ICJ0b2dnbGUiOwogICAgR2FtZS5sYXN0LmNob2ljZXNGdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGNob2ljZXMgPSBbXTsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLkJHc0J5Q2hvaWNlKSB7CiAgICAgICAgY2hvaWNlc1tpXSA9IHsKICAgICAgICAgIG5hbWU6IEdhbWUuQkdzQnlDaG9pY2VbaV0ubmFtZSwKICAgICAgICAgIGljb246IEdhbWUuQkdzQnlDaG9pY2VbaV0uaWNvbiwKICAgICAgICAgIG9yZGVyOiBHYW1lLkJHc0J5Q2hvaWNlW2ldLm9yZGVyIHx8IHBhcnNlSW50KGkpLAogICAgICAgIH07CiAgICAgIH0KCiAgICAgIGNob2ljZXNbMTNdLmRpdiA9IHRydWU7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNob2ljZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgaXQgPSBjaG9pY2VzW2ldOwogICAgICAgIGlmIChpdC5vcmRlciA+PSA0LjkgJiYgIUdhbWUuSGFzKCJEaXN0aW5ndWlzaGVkIHdhbGxwYXBlciBhc3NvcnRtZW50IikpCiAgICAgICAgICBjaG9pY2VzW2ldID0gMDsKICAgICAgfQoKICAgICAgY2hvaWNlc1tHYW1lLmJnVHlwZV0uc2VsZWN0ZWQgPSAxOwogICAgICByZXR1cm4gY2hvaWNlczsKICAgIH07CiAgICBHYW1lLmxhc3QuY2hvaWNlc1BpY2sgPSBmdW5jdGlvbiAoaWQpIHsKICAgICAgR2FtZS5iZ1R5cGUgPSBpZDsKICAgIH07CgogICAgR2FtZS5BbGxCR3MgPSBbCiAgICAgIHsgcGljOiAiYmdCbHVlIiwgbmFtZTogIkF1dG9tYXRpYyIsIGljb246IFswLCA3XSB9LAogICAgICB7IHBpYzogImJnQmx1ZSIsIG5hbWU6ICJCbHVlIiwgaWNvbjogWzIxLCAyMV0gfSwKICAgICAgeyBwaWM6ICJiZ1JlZCIsIG5hbWU6ICJSZWQiLCBpY29uOiBbMjIsIDIxXSB9LAogICAgICB7IHBpYzogImJnV2hpdGUiLCBuYW1lOiAiV2hpdGUiLCBpY29uOiBbMjMsIDIxXSB9LAogICAgICB7IHBpYzogImJnQmxhY2siLCBuYW1lOiAiQmxhY2siLCBpY29uOiBbMjQsIDIxXSB9LAogICAgICB7IHBpYzogImJnR29sZCIsIG5hbWU6ICJHb2xkIiwgaWNvbjogWzI1LCAyMV0gfSwKICAgICAgeyBwaWM6ICJncmFuZG1hczEiLCBuYW1lOiAiR3JhbmRtYXMiLCBpY29uOiBbMjYsIDIxXSB9LAogICAgICB7IHBpYzogImdyYW5kbWFzMiIsIG5hbWU6ICJEaXNwbGVhc2VkIGdyYW5kbWFzIiwgaWNvbjogWzI3LCAyMV0gfSwKICAgICAgeyBwaWM6ICJncmFuZG1hczMiLCBuYW1lOiAiQW5nZXJlZCBncmFuZG1hcyIsIGljb246IFsyOCwgMjFdIH0sCiAgICAgIHsgcGljOiAiYmdNb25leSIsIG5hbWU6ICJNb25leSIsIGljb246IFsyOSwgMjFdIH0sCiAgICAgIHsgcGljOiAiYmdQdXJwbGUiLCBuYW1lOiAiUHVycGxlIiwgaWNvbjogWzIxLCAyMl0sIG9yZGVyOiAxLjEgfSwKICAgICAgeyBwaWM6ICJiZ1BpbmsiLCBuYW1lOiAiUGluayIsIGljb246IFsyNCwgMjJdLCBvcmRlcjogMi4xIH0sCiAgICAgIHsgcGljOiAiYmdNaW50IiwgbmFtZTogIk1pbnQiLCBpY29uOiBbMjIsIDIyXSwgb3JkZXI6IDIuMiB9LAogICAgICB7IHBpYzogImJnU2lsdmVyIiwgbmFtZTogIlNpbHZlciIsIGljb246IFsyNSwgMjJdLCBvcmRlcjogNC45IH0sCiAgICAgIHsgcGljOiAiYmdCVyIsIG5hbWU6ICJCbGFjayAmIFdoaXRlIiwgaWNvbjogWzIzLCAyMl0sIG9yZGVyOiA0LjEgfSwKICAgICAgeyBwaWM6ICJiZ1NwZWN0cnVtIiwgbmFtZTogIlNwZWN0cnVtIiwgaWNvbjogWzI4LCAyMl0sIG9yZGVyOiA0LjIgfSwKICAgICAgeyBwaWM6ICJiZ0NhbmR5IiwgbmFtZTogIkNhbmR5IiwgaWNvbjogWzI2LCAyMl0gfSwKICAgICAgeyBwaWM6ICJiZ1llbGxvd0JsdWUiLCBuYW1lOiAiQmlzY3VpdCBzdG9yZSIsIGljb246IFsyNywgMjJdIH0sCiAgICAgIHsgcGljOiAiYmdDaG9jbyIsIG5hbWU6ICJDaG9jb2xhdGUiLCBpY29uOiBbMzAsIDIxXSB9LAogICAgICB7IHBpYzogImJnQ2hvY29EYXJrIiwgbmFtZTogIkRhcmsgQ2hvY29sYXRlIiwgaWNvbjogWzMxLCAyMV0gfSwKICAgICAgeyBwaWM6ICJiZ1BhaW50IiwgbmFtZTogIlBhaW50ZXIiLCBpY29uOiBbMjQsIDM0XSB9LAogICAgICB7IHBpYzogImJnU25vd3kiLCBuYW1lOiAiU25vdyIsIGljb246IFszMCwgMjJdIH0sCiAgICAgIHsgcGljOiAiYmdTa3kiLCBuYW1lOiAiU2t5IiwgaWNvbjogWzI5LCAyMl0gfSwKICAgICAgeyBwaWM6ICJiZ1N0YXJzIiwgbmFtZTogIk5pZ2h0IiwgaWNvbjogWzMxLCAyMl0gfSwKICAgICAgeyBwaWM6ICJiZ0ZvaWwiLCBuYW1lOiAiRm9pbCIsIGljb246IFsyNSwgMzRdIH0sCiAgICBdOwogICAgR2FtZS5CR3NCeUNob2ljZSA9IHt9OwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBHYW1lLkFsbEJHcy5sZW5ndGg7IGkrKykgewogICAgICBHYW1lLkJHc0J5Q2hvaWNlW2ldID0gR2FtZS5BbGxCR3NbaV07CiAgICB9CiAgICBpZiAoIUVOKSB7CiAgICAgIEdhbWUuQkdzQnlDaG9pY2VbMF0ubmFtZSA9IGxvYyhHYW1lLkJHc0J5Q2hvaWNlWzBdLm5hbWUpOwogICAgICBmb3IgKHZhciBpID0gMTsgaSA8IEdhbWUuQkdzQnlDaG9pY2UubGVuZ3RoOyBpKyspIHsKICAgICAgICBHYW1lLkJHc0J5Q2hvaWNlW2ldLm5hbWUgPSAnIicgKyBHYW1lLkJHc0J5Q2hvaWNlW2ldLnBpYyArICciJzsKICAgICAgfQogICAgfQoKICAgIG9yZGVyID0gMjU1OwogICAgR2FtZS5HcmFuZG1hU3luZXJneSgKICAgICAgIkx1Y2t5IGdyYW5kbWFzIiwKICAgICAgIkEgZm9ydHVuYXRlIGdyYW5kbWEgdGhhdCBhbHdheXMgc2VlbXMgdG8gZmluZCBtb3JlIGNvb2tpZXMuIiwKICAgICAgIkNoYW5jZW1ha2VyIgogICAgKTsKCiAgICBvcmRlciA9IDEyMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJZb3VyIGx1Y2t5IGNvb2tpZSIsCiAgICAgICI8cT5UaGlzIGlzIHRoZSBmaXJzdCBjb29raWUgeW91J3ZlIGV2ZXIgYmFrZWQuIEl0IGhvbGRzIGEgZGVlcCBzZW50aW1lbnRhbCB2YWx1ZSBhbmQsIGFmdGVyIGFsbCB0aGlzIHRpbWUsIGFuIGludGVyZXN0aW5nIHNtZWxsLjwvcT4iLAogICAgICAiQ2hhbmNlbWFrZXIiLAogICAgICAxCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAnIkFsbCBCZXRzIEFyZSBPZmYiIG1hZ2ljIGNvaW4nLAogICAgICAiPHE+QSBjb2luIHRoYXQgYWx3YXlzIGxhbmRzIG9uIHRoZSBvdGhlciBzaWRlIHdoZW4gZmxpcHBlZC4gTm90IGhlYWRzLCBub3QgdGFpbHMsIG5vdCB0aGUgZWRnZS4gVGhlIDxpPm90aGVyIHNpZGU8L2k+LjwvcT4iLAogICAgICAiQ2hhbmNlbWFrZXIiLAogICAgICAyCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiV2lubmluZyBsb3R0ZXJ5IHRpY2tldCIsCiAgICAgICI8cT5XaGF0IGxvdHRlcnk/IFRIRSBsb3R0ZXJ5LCB0aGF0J3Mgd2hhdCBsb3R0ZXJ5ISBPbmx5IGxvdHRlcnkgdGhhdCBtYXR0ZXJzITwvcT4iLAogICAgICAiQ2hhbmNlbWFrZXIiLAogICAgICAzCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRm91ci1sZWFmIGNsb3ZlciBmaWVsZCIsCiAgICAgICI8cT5ObyBnaWFudCBtb25zdGVycyBoZXJlLCBqdXN0IGEgd2hvbGUgbG90IG9mIGx1Y2t5IGdyYXNzLjwvcT4iLAogICAgICAiQ2hhbmNlbWFrZXIiLAogICAgICA0CiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQSByZWNpcGUgYm9vayBhYm91dCBib29rcyIsCiAgICAgICI8cT5UaXAgdGhlIHNjYWxlcyBpbiB5b3VyIGZhdm9yIHdpdGggMjggY3JlYXRpdmUgbmV3IHdheXMgdG8gY29vayB0aGUgYm9va3MuPC9xPiIsCiAgICAgICJDaGFuY2VtYWtlciIsCiAgICAgIDUKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJMZXByZWNoYXVuIHZpbGxhZ2UiLAogICAgICAiPHE+WW91J3ZlIGZpbmFsbHkgYmVjb21lIGFjY2VwdGVkIGFtb25nIHRoZSBsb2NhbCBsZXByZWNoYXVucywgd2hvIGxlbmQgeW91IHRoZWlyIG15dGhpY2FsIGx1Y2sgYXMgYSBzaWduIG9mIGZyaWVuZHNoaXAgKGFzIHdlbGwgYXMgc29tZSByYXRoZXIgZm91bC10YXN0aW5nIHRlYSkuPC9xPiIsCiAgICAgICJDaGFuY2VtYWtlciIsCiAgICAgIDYKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJJbXByb2JhYmlsaXR5IGRyaXZlIiwKICAgICAgIjxxPkEgc3RyYW5nZSBlbmdpbmUgdGhhdCB0dXJucyBzdGF0aXN0aWNzIG9uIHRoZWlyIGhlYWQuIFJlY29tbWVuZGVkIGJ5IHRoZSBHcmFuZG1vdGhlcidzIEd1aWRlIHRvIHRoZSBCYWtlcnkuPC9xPiIsCiAgICAgICJDaGFuY2VtYWtlciIsCiAgICAgIDcKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJBbnRpc3VwZXJzdGlzdHJvbmljcyIsCiAgICAgICI8cT5BbiBleGNpdGluZyBuZXcgZmllbGQgb2YgcmVzZWFyY2ggdGhhdCBtYWtlcyB1bmx1Y2t5IHRoaW5ncyBsdWNreS4gTm8gbWlycm9yIHVuYnJva2VuLCBubyBsYWRkZXIgdW53YWxrZWQgdW5kZXIhPC9xPiIsCiAgICAgICJDaGFuY2VtYWtlciIsCiAgICAgIDgKICAgICk7CgogICAgb3JkZXIgPSA1MDAwOwogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIkdlbW1lZCB0YWxpc21hbnMiLAogICAgICAiPHE+R29vZC1sdWNrIGNoYXJtcyBjb3ZlcmVkIGluIGFuY2llbnQgYW5kIGV4Y3J1Y2lhdGluZ2x5IHJhcmUgY3J5c3RhbHMuIEEgbXVzdCBoYXZlIGZvciBqb2IgaW50ZXJ2aWV3cyE8L3E+IiwKICAgICAgIkNoYW5jZW1ha2VyIiwKICAgICAgIk1pbmUiLAogICAgICAic3luZXJneTEiCiAgICApOwoKICAgIG9yZGVyID0gMjAwMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiS2l0dGVuIGNvbnN1bHRhbnRzIiwKICAgICAgc3RyS2l0dGVuRGVzYyArICI8cT5nbGFkIHRvIGJlIG92ZXJwYWlkIHRvIHdvcmsgd2l0aCB5b3UsIHNpcjwvcT4iLAogICAgICA5MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIEdhbWUuR2V0SWNvbigiS2l0dGVuIiwgOSkKICAgICk7CiAgICBHYW1lLmxhc3Qua2l0dGVuID0gMTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDksIDE4KTsKCiAgICBvcmRlciA9IDk5OTk5OwogICAgdmFyIHllYXJzID0gTWF0aC5mbG9vcigKICAgICAgKERhdGUubm93KCkgLSBuZXcgRGF0ZSgyMDEzLCA3LCA4KSkgLyAoMTAwMCAqIDYwICogNjAgKiAyNCAqIDM2NSkKICAgICk7CiAgICAvL29ubHkgdXBkYXRlcyBvbiBwYWdlIGxvYWQKICAgIC8vbWF5IGJlaGF2ZSBzdHJhbmdlbHkgb24gbGVhcCB5ZWFycwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkJpcnRoZGF5IGNvb2tpZSIsCiAgICAgIGRlc2M6ICI8cT4tPC9xPiIsCiAgICAgIGljb246IFsyMiwgMTNdLAogICAgICBwb3dlcjogeWVhcnMsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgR2FtZS5sYXN0LmJhc2VEZXNjID0KICAgICAgbG9jKAogICAgICAgICJDb29raWUgcHJvZHVjdGlvbiBtdWx0aXBsaWVyIDxiPislMSU8L2I+IGZvciBldmVyeSB5ZWFyIENvb2tpZSBDbGlja2VyIGhhcyBleGlzdGVkIChjdXJyZW50bHk6IDxiPislMiU8L2I+KS4iLAogICAgICAgIFsxLCBCZWF1dGlmeSh5ZWFycyldCiAgICAgICkgKyAiPHE+VGhhbmsgeW91IGZvciBwbGF5aW5nIENvb2tpZSBDbGlja2VyITxicj4tT3J0ZWlsPC9xPiI7CgogICAgb3JkZXIgPSAxNTA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQXJteXRocmlsIG1vdXNlIiwKICAgICAgZ2V0U3RyQ2xpY2tpbmdHYWlucygxKSArCiAgICAgICAgIjxxPlRoaXMgb25lIHRha2VzIGFib3V0IDUzIHBlb3BsZSB0byBwdXNoIGl0IGFyb3VuZCBhbmQgYW5vdGhlciA0OCB0byBqdW1wIGRvd24gb24gdGhlIGJ1dHRvbiBhbmQgdHJpZ2dlciBhIGNsaWNrLiBZb3UgY291bGQgc2F5IGl0J3MgZ290IHNvbWUgaGVmdCB0byBpdC48L3E+IiwKICAgICAgNTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIFsxMSwgMTldCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgMTAsIDExKTsKCiAgICBvcmRlciA9IDIwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlJldmVyc2UgZGVtZW50aWEiLAogICAgICAiPHE+RXh0cmVtZWx5IHVuc2V0dGxpbmcsIGFuZCBzb21laG93IGV2ZW4gd29yc2UgdGhhbiB0aGUgcmVndWxhciBraW5kLjwvcT4iLAogICAgICAiR3JhbmRtYSIsCiAgICAgIDkKICAgICk7CiAgICBvcmRlciA9IDMwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkh1bWFuZSBwZXN0aWNpZGVzIiwKICAgICAgIjxxPk1hZGUgYnkgcGVvcGxlLCBmb3IgcGVvcGxlLCBmcm9tIHBlb3BsZSBhbmQgcmVhZHkgdG8gdW5sZWFzaCBzb21lIHJpZ2h0ZW91cyBzY29yY2hpbmcgcGFpbiBvbiB0aG9zZSBwZXNreSBpbnNlY3RzIHRoYXQgc28gZGVzZXJ2ZSBpdC48L3E+IiwKICAgICAgIkZhcm0iLAogICAgICA5CiAgICApOwogICAgb3JkZXIgPSA0MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJNb2xlIHBlb3BsZSIsCiAgICAgICI8cT5FbmdpbmVlcmVkIGZyb20gcmVhbCBodW1hbiBiZWluZ3Mgd2l0aGluIHlvdXIgdmVyeSBsYWJzLCB0aGVzZSBzdHVyZHkgbGl0dGxlIGZvbGtzIGhhdmUgYSBrbmFjayBmb3IgZmluZGluZyB0aGUgdGFzdGllc3QgdW5kZXJncm91bmQgbWluZXJhbHMgaW4gY29uZGl0aW9ucyB0aGF0IG1vcmUgZXhwZW5zaXZlIG1hY2hpbmVyeSBwcm9iYWJseSB3b3VsZG4ndCBzdXJ2aXZlLjwvcT4iLAogICAgICAiTWluZSIsCiAgICAgIDkKICAgICk7CiAgICBvcmRlciA9IDUwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIk1hY2hpbmUgbGVhcm5pbmciLAogICAgICAiPHE+WW91IGZpZ3VyZWQgeW91IG1pZ2h0IGdldCBiZXR0ZXIgcHJvZHVjdGl2aXR5IGlmIHlvdSBhY3R1YWxseSB0b2xkIHlvdXIgd29ya2VycyB0byBsZWFybiBob3cgdG8gd29yayB0aGUgbWFjaGluZXMuIFNvbWV0aW1lcywgaXQncyB0aGUgbGl0dGxlIHRoaW5ncy4uLjwvcT4iLAogICAgICAiRmFjdG9yeSIsCiAgICAgIDkKICAgICk7CiAgICBvcmRlciA9IDUyNTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkVkaWJsZSBtb25leSIsCiAgICAgICI8cT5JdCdzIHJlYWxseSBxdWl0ZSBzaW1wbGU7IHlvdSBtYWtlIGFsbCBjdXJyZW5jeSB0b28gZGVsaWNpb3VzIG5vdCB0byBlYXQsIHNvbHZpbmcgd29ybGQgaHVuZ2VyIGFuZCBpbmZsYXRpb24gaW4gb25lIGZlbGwgc3dvb3AhPC9xPiIsCiAgICAgICJCYW5rIiwKICAgICAgOQogICAgKTsKICAgIG9yZGVyID0gNTUwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiU2ljayByYXAgcHJheWVycyIsCiAgICAgICI8cT5XaXRoIHRoZWlyIGlsbCBiZWF0IGFuZCByYWRpY2FsIHJoeW1lcywgdGhlc2Ugd2F5LWhpcCByZWxpZ2lvdXMgdHVuZXMgYXJlIHN1cmUgdG8gZ2V0IGFsbCB0aGUgeW91bmdpbnMgd2hvIHRob3VnaHQgdGhleSB3ZXJlIDIgY29vbCA0IGNodXJjaCBiYWNrIG9uIHRoZSBwZXdzIGFuZCBwcmF5aW5nIGZvciBtb3JlISBXaWNrZWQhPC9xPiIsCiAgICAgICJUZW1wbGUiLAogICAgICA5CiAgICApOwogICAgb3JkZXIgPSA1NzU7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJEZWx1eGUgdGFpbG9yZWQgd2FuZHMiLAogICAgICAiPHE+SW4gdGhpcyBhZ2Ugb2Ygc2NpZW5jZSwgbW9zdCBza2lsbGZ1bCB3YW5kLW1ha2VycyBhcmUgbm93IGxvbmcgZ29uZTsgYnV0IHRoYW5rZnVsbHkgLSBub3QgYWxsIHRob3NlIHdhbmRlcnMgYXJlIGxvc3QuPC9xPiIsCiAgICAgICJXaXphcmQgdG93ZXIiLAogICAgICA5CiAgICApOwogICAgb3JkZXIgPSA2MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJBdXRvcGlsb3QiLAogICAgICAiPHE+WW91ciBzaGlwcyBhcmUgbm93IGZpdHRlZCB3aXRoIGNvbXBsZXRlbHkgcm9ib3RpYyBjcmV3cyEgSXQncyBjcmF6eSBob3cgbXVjaCBtb25leSB5b3Ugc2F2ZSB3aGVuIHlvdSBkb24ndCBoYXZlIHRvIGNvbXBlbnNhdGUgdGhlIGZhbWlsaWVzIG9mIHRob3NlIGxvc3QgaW4gc3BhY2UuPC9xPiIsCiAgICAgICJTaGlwbWVudCIsCiAgICAgIDkKICAgICk7CiAgICBvcmRlciA9IDcwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRoZSBhZHZlbnQgb2YgY2hlbWlzdHJ5IiwKICAgICAgIjxxPllvdSBrbm93IHdoYXQ/IFRoYXQgd2hvbGUgYWxjaGVteSBub25zZW5zZSB3YXMgYSBsb2FkIG9mIGJhc2VsZXNzIHJ1YmJpc2guIERlYXIgZ29kLCB3aGF0IHdlcmUgeW91IHRoaW5raW5nPzwvcT4iLAogICAgICAiQWxjaGVteSBsYWIiLAogICAgICA5CiAgICApOwogICAgb3JkZXIgPSA4MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJUaGUgcmVhbCB3b3JsZCIsCiAgICAgICI8cT5JdCB0dXJucyBvdXQgdGhhdCBvdXIgdW5pdmVyc2UgaXMgYWN0dWFsbHkgdGhlIHR3aXN0ZWQgZGltZW5zaW9uIG9mIGFub3RoZXIsIHNhbmVyIHBsYW5lIG9mIHJlYWxpdHkuIFRpbWUgdG8gaG9wIG9uIG92ZXIgdGhlcmUgYW5kIGxvb3QgdGhlIHBsYWNlITwvcT4iLAogICAgICAiUG9ydGFsIiwKICAgICAgOQogICAgKTsKICAgIG9yZGVyID0gOTAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiU2Vjb25kIHNlY29uZHMiLAogICAgICAiPHE+VGhhdCdzIHR3aWNlIGFzIG1hbnkgc2Vjb25kcyBpbiB0aGUgc2FtZSBhbW91bnQgb2YgdGltZSEgV2hhdCBhIGRlYWwhIEFsc28sIHdoYXQgaW4gZ29kJ3MgbmFtZSE8L3E+IiwKICAgICAgIlRpbWUgbWFjaGluZSIsCiAgICAgIDkKICAgICk7CiAgICBvcmRlciA9IDEwMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJRdWFudHVtIGNvbWIiLAogICAgICAiPHE+UXVhbnR1bSBlbnRhbmdsZW1lbnQgaXMgb25lIG9mIHRob3NlIHRoaW5ncyB0aGF0IGFyZSBzbyBhbm5veWluZyB0byBleHBsYWluIHRoYXQgd2UgbWlnaHQgaG9uZXN0bHkgYmUgYmV0dGVyIG9mZiB3aXRob3V0IGl0LiBUaGlzIGlzIGZpbmFsbHkgcG9zc2libGUgdGhhbmtzIHRvIHRoZSBxdWFudHVtIGNvbWIhPC9xPiIsCiAgICAgICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsCiAgICAgIDkKICAgICk7CiAgICBvcmRlciA9IDExMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJDcnlzdGFsIG1pcnJvcnMiLAogICAgICAiPHE+RGVzaWduZWQgdG8gZmlsdGVyIG1vcmUgbGlnaHQgYmFjayBpbnRvIHlvdXIgcHJpc21zLCByZWFjaGluZyBsZXZlbHMgb2YgYnJpZ2h0bmVzcyB0aGF0IHJlYWxpdHkgaXRzZWxmIGhhZCBuZXZlciBwbGFubmVkIGZvci48L3E+IiwKICAgICAgIlByaXNtIiwKICAgICAgOQogICAgKTsKICAgIG9yZGVyID0gMTIwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkJ1bm55cGVkZXMiLAogICAgICAiPHE+WW91J3ZlIHRha2VuIHRvIGJyZWVkaW5nIHJhYmJpdHMgd2l0aCBodW5kcmVkcyBvZiBwYXdzLCB3aGljaCBtYWtlcyB0aGVtIGludHJpbnNpY2FsbHkgdmVyeSBsdWNreSBhbmQgdGh1cyBhIHZlcnkgaGFuZHkgKGlmIHZlcnkgZGlzdHVyYmluZykgcGV0LjwvcT4iLAogICAgICAiQ2hhbmNlbWFrZXIiLAogICAgICA5CiAgICApOwoKICAgIG9yZGVyID0gMjAwMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiS2l0dGVuIGFzc2lzdGFudHMgdG8gdGhlIHJlZ2lvbmFsIG1hbmFnZXIiLAogICAgICBzdHJLaXR0ZW5EZXNjICsKICAgICAgICAiPHE+bm90aGluZyBzdHJlc3NlcyBtZW93dC4uLiBleGNlcHQgaGF2aW5nIHRvIHNlZWsgdGhlIGFwcHJvdmFsIG9mIG15IGluZmVyaW9ycywgc2lyPC9xPiIsCiAgICAgIDkwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCwKICAgICAgR2FtZS5HZXRJY29uKCJLaXR0ZW4iLCAxMCkKICAgICk7CiAgICBHYW1lLmxhc3Qua2l0dGVuID0gMTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDEwLCAxOCk7CgogICAgb3JkZXIgPSA1MDAwOwogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIkNoYXJtIHF1YXJrcyIsCiAgICAgICI8cT5UaGV5J3JlIGFmdGVyIHlvdXIgbHVja3kgcXVhcmtzITwvcT4iLAogICAgICAiQ2hhbmNlbWFrZXIiLAogICAgICAiQW50aW1hdHRlciBjb25kZW5zZXIiLAogICAgICAic3luZXJneTIiCiAgICApOwoKICAgIG9yZGVyID0gMTAwMjA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiUGluayBiaXNjdWl0cyIsCiAgICAgIGRlc2M6ICJPbmUgb2YgdGhlIG9sZGVzdCBjb29raWVzLiBUcmFkaXRpb25hbGx5IGRpcHBlZCBpbiBjaGFtcGFnbmUgdG8gc29mdGVuIGl0LCBiZWNhdXNlIHRoZSBGcmVuY2ggd2lsbCB1c2UgYW55IG9wcG9ydHVuaXR5IHRvIGRyaW5rLiIsCiAgICAgIGljb246IFsyMSwgMTZdLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIldob2xlLWdyYWluIGNvb2tpZXMiLAogICAgICBkZXNjOiAnQ292ZXJlZCBpbiBzZWVkcyBhbmQgb3RoZXIgZWFydGh5LWxvb2tpbmcgZGVicmlzLiBSZWFsbHkgZ29pbmcgZm9yIHRoYXQgIjUtc2Vjb25kIHJ1bGUiIGxvb2suJywKICAgICAgaWNvbjogWzIyLCAxNl0sCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkNhbmR5IGNvb2tpZXMiLAogICAgICBkZXNjOiAiVGhlc2UgbWVsdCBpbiB5b3VyIGhhbmRzIGp1c3QgYSBsaXR0bGUgYml0LiIsCiAgICAgIGljb246IFsyMywgMTZdLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJCaWcgY2hpcCBjb29raWVzIiwKICAgICAgZGVzYzogIllvdSBhcmUgaW4gYXdlIGF0IHRoZSBzaXplIG9mIHRoZXNlIGNoaXBzLiBBYnNvbHV0ZSB1bml0cy4iLAogICAgICBpY29uOiBbMjQsIDE2XSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIk9uZSBjaGlwIGNvb2tpZXMiLAogICAgICBkZXNjOiAiWW91IGdldCBvbmUuIiwKICAgICAgaWNvbjogWzI1LCAxNl0sCiAgICAgIHBvd2VyOiAxLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiU3VnYXIgYmFraW5nIiwKICAgICAgbG9jKAogICAgICAgICdFYWNoIHVuc3BlbnQgc3VnYXIgbHVtcCAodXAgdG8gJTEpIGdpdmVzIDxiPislMiUgQ3BTPC9iPi48ZGl2IGNsYXNzPSJ3YXJuaW5nIj5Ob3RlOiB0aGlzIG1lYW5zIHRoYXQgc3BlbmRpbmcgc3VnYXIgbHVtcHMgd2lsbCBkZWNyZWFzZSB5b3VyIENwUyB1bnRpbCB0aGV5IGdyb3cgYmFjay48L2Rpdj4nLAogICAgICAgIFsxMDAsIDFdCiAgICAgICkgKwogICAgICAgICI8cT5UbyBiYWtlIHdpdGggdGhlIHN1Z2FyeSBlc3NlbmNlIG9mIGVvbnMgdGhlbXNlbHZlcywgeW91IG11c3QgZmlyc3QgbGVhcm4gdG8gdGFrZSB5b3VyIHN3ZWV0IHRpbWUuPC9xPiIsCiAgICAgIDIwMDAwMDAwMCwKICAgICAgWzIxLCAxN10KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiU3RldmlhIENhZWxlc3RpcyJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlN1Z2FyIGNyYXZpbmciLAogICAgICBsb2MoCiAgICAgICAgJ09uY2UgYW4gYXNjZW5zaW9uLCB5b3UgbWF5IHVzZSB0aGUgIlN1Z2FyIGZyZW56eSIgc3dpdGNoIHRvIDxiPnRyaXBsZSB5b3VyIENwUzwvYj4gZm9yIDEgaG91ciwgYXQgdGhlIGNvc3Qgb2YgPGI+MSBzdWdhciBsdW1wPC9iPi4nCiAgICAgICkgKyAiPHE+SnVzdCBhIGxpdHRsZSBraWNrIHRvIHN3ZWV0ZW4gdGhlIGRlYWwuPC9xPiIsCiAgICAgIDQwMDAwMDAwMCwKICAgICAgWzIyLCAxN10KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiU3VnYXIgYmFraW5nIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiU3VnYXIgYWdpbmcgcHJvY2VzcyIsCiAgICAgIGxvYygiRWFjaCBncmFuZG1hICh1cCB0byAlMSkgbWFrZXMgc3VnYXIgbHVtcHMgcmlwZW4gPGI+JTI8L2I+IHNvb25lci4iLCBbCiAgICAgICAgNjAwLAogICAgICAgIEdhbWUuc2F5VGltZSg2ICogR2FtZS5mcHMpLAogICAgICBdKSArICI8cT5BcmVuJ3QgdGhleSBqdXN0IHRoZSBzd2VldGVzdD88L3E+IiwKICAgICAgNjAwMDAwMDAwLAogICAgICBbMjMsIDE3XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJTdWdhciBjcmF2aW5nIiwgIkRpYWJldGljYSBEYWVtb25pY3VzIl07CgogICAgb3JkZXIgPSA0MDA1MDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTdWdhciBmcmVuenkiLAogICAgICBsb2MoCiAgICAgICAgIkFjdGl2YXRpbmcgdGhpcyB3aWxsIDxiPnRyaXBsZSB5b3VyIENwUzwvYj4gZm9yIDEgaG91ciwgYXQgdGhlIGNvc3Qgb2YgPGI+MSBzdWdhciBsdW1wPC9iPi4iCiAgICAgICkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJNYXkgb25seSBiZSB1c2VkIG9uY2UgcGVyIGFzY2Vuc2lvbi4iKSwKICAgICAgMCwKICAgICAgWzIyLCAxN10KICAgICk7CiAgICBHYW1lLmxhc3QucHJpY2VMdW1wcyA9IDE7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJ0b2dnbGUiOwogICAgR2FtZS5sYXN0LnRvZ2dsZUludG8gPSAwOwogICAgR2FtZS5sYXN0LmNhbkJ1eUZ1bmMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBHYW1lLmx1bXBzID49IDE7CiAgICB9OwogICAgR2FtZS5sYXN0LmNsaWNrRnVuY3Rpb24gPSBHYW1lLnNwZW5kTHVtcCgKICAgICAgMSwKICAgICAgbG9jKCJhY3RpdmF0ZSB0aGUgc3VnYXIgZnJlbnp5IiksCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLlVwZ3JhZGVzWyJTdWdhciBmcmVuenkiXS5idXkoMSk7CiAgICAgICAgYnVmZiA9IEdhbWUuZ2FpbkJ1ZmYoInN1Z2FyIGZyZW56eSIsIDYwICogNjAsIDMpOwogICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgbG9jKCJTdWdhciBmcmVuenkhIiksCiAgICAgICAgICBsb2MoIkNwUyB4JTEgZm9yIDEgaG91ciEiLCAzKSwKICAgICAgICAgIFsyOSwgMTRdCiAgICAgICAgKTsKICAgICAgfQogICAgKTsKCiAgICBvcmRlciA9IDEwMDIwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlNwcmlua2xlcyBjb29raWVzIiwKICAgICAgZGVzYzogIkEgYml0IG9mIGZlc3RpdmUgZGVjb3JhdGluZyBoZWxwcyBoaWRlIHRoZSBmYWN0IHRoYXQgdGhpcyBtaWdodCBiZSBvbmUgb2YgdGhlIGJsYW5kZXN0IGNvb2tpZXMgeW91J3ZlIGV2ZXIgdGFzdGVkLiIsCiAgICAgIGljb246IFsyMSwgMTRdLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlBlYW51dCBidXR0ZXIgYmxvc3NvbXMiLAogICAgICBkZXNjOiAiVG9wcGVkIHdpdGggYSBzY3J1bXB0aW91cyBjaG9jb2xhdGUgc3F1aXJ0LCB3aGljaCBpcyBzb21ldGhpbmcgd2UgcmVhbGx5IHdpc2ggd2UgZGlkbid0IGp1c3Qgd3JpdGUuIiwKICAgICAgaWNvbjogWzIyLCAxNF0sCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiTm8tYmFrZSBjb29raWVzIiwKICAgICAgZGVzYzogIllvdSBoYXZlIG5vIGlkZWEgaG93IHRoZXNlIG15c3RlcmlvdXMgb3Zlbi1sZXNzIHRyZWF0cyBjYW1lIHRvIGJlIG9yIGhvdyB0aGV5IGhvbGQgdGhlaXIgc2hhcGUuIFlvdSdyZSB0aGlua2luZyBlaXRoZXIgZWxlcGhhbnQgZ2x1ZSBvciBjb2xkIGZ1c2lvbi4iLAogICAgICBpY29uOiBbMjEsIDE1XSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiRmxvcmVudGluZXMiLAogICAgICBkZXNjOiAiVGhlc2UgbWFrZSB1cCBmb3IgYmVpbmcgdGhlIGZydWl0Y2FrZSBvZiBjb29raWVzIGJ5IGF0IGxlYXN0IGhhdmluZyB0aGUgZGVjZW5jeSB0byBmZWF0dXJlIGNob2NvbGF0ZS4iLAogICAgICBpY29uOiBbMjYsIDE2XSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQ2hvY29sYXRlIGNyaW5rbGVzIiwKICAgICAgZGVzYzogIk5vbi1kZW5vbWluYXRpb25hbCBjb29raWVzIHRvIGNlbGVicmF0ZSB5ZWFyLXJvdW5kIGRlbGljaW91c25lc3MsIGFuZCBjZXJ0YWlubHkgbm90IENocmlzdG1hcyBvciBzb21lIG90aGVyIG5vbnNlbnNlLiIsCiAgICAgIGljb246IFsyMiwgMTVdLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiTWFwbGUgY29va2llcyIsCiAgICAgIGRlc2M6ICJNYWRlIHdpdGggc3lydXAgZnJvbSBhIGxhbmQgd2hlcmUgbWlsayBjb21lcyBpbiBiYWdzLCBpbnN0ZWFkIG9mIHNwb250YW5lb3VzbHkgcG9vbGluZyBhdCB0aGUgYm90dG9tIG9mIHlvdXIgc2NyZWVuIGRlcGVuZGluZyBvbiB5b3VyIGFjaGlldmVtZW50cy4iLAogICAgICBpY29uOiBbMjEsIDEzXSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwoKICAgIG9yZGVyID0gNDAwMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiVHVyYm8tY2hhcmdlZCBzb2lsIiwKICAgICAgbG9jKAogICAgICAgICJHYXJkZW4gcGxhbnRzIGdyb3cgZXZlcnkgc2Vjb25kLjxicj5HYXJkZW4gc2VlZHMgYXJlIGZyZWUgdG8gcGxhbnQuPGJyPllvdSBjYW4gc3dpdGNoIHNvaWxzIGF0IGFueSB0aW1lLiIKICAgICAgKSArICI8cT5JdCdzIGdvdCBlbGVjdHJvbHl0ZXMhPC9xPiIsCiAgICAgIDcsCiAgICAgIFsyLCAxNl0KICAgICk7IC8vZGVidWcgcHVycG9zZXMgb25seQogICAgR2FtZS5sYXN0LmJ1eUZ1bmN0aW9uID0gZnVuY3Rpb24gKCkgewogICAgICBpZiAoR2FtZS5PYmplY3RzWyJGYXJtIl0ubWluaWdhbWVMb2FkZWQpIHsKICAgICAgICBHYW1lLk9iamVjdHNbIkZhcm0iXS5taW5pZ2FtZS5jb21wdXRlU3RlcFQoKTsKICAgICAgfQogICAgfTsKICAgIEdhbWUubGFzdC5wb29sID0gImRlYnVnIjsKCiAgICBvcmRlciA9IDE1MDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJUZWNobm9ic2lkaWFuIG1vdXNlIiwKICAgICAgZ2V0U3RyQ2xpY2tpbmdHYWlucygxKSArCiAgICAgICAgIjxxPkEgaGlnaGx5IGFkdmFuY2VkIG1vdXNlIG9mIGEgc29waGlzdGljYXRlZCBkZXNpZ24uIE9ubHkgb25lIHRoaW5nIG9uIGl0cyBtaW5kIDogdG8gY2xpY2suPC9xPiIsCiAgICAgIDUwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIFsxMSwgMjhdCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgMTEsIDExKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJQbGFzbWFyYmxlIG1vdXNlIiwKICAgICAgZ2V0U3RyQ2xpY2tpbmdHYWlucygxKSArCiAgICAgICAgIjxxPkEgc2hpZnRpbmcgYmx1ciBpbiB0aGUgY29ybmVyIG9mIHlvdXIgZXllLCB0aGlzIG1vdXNlIGNhbiB0cmlnZ2VyIGEgZmx1cnJ5IG9mIGNsaWNrcyB3aGVuIGdyYXplZCBieSBldmVuIHRoZSBzbGlnaHRlc3QgYnJlZXplLjwvcT4iLAogICAgICA1MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIFsxMSwgMzBdCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgMTIsIDExKTsKCiAgICBvcmRlciA9IDIwMDAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIktpdHRlbiBtYXJrZXRlZXJzIiwKICAgICAgc3RyS2l0dGVuRGVzYyArICI8cT5ubyBzdWNoIHRoaW5nIGFzIGEgc2F0dXJhdGVkIG1hcmtpdCwgc2lyPC9xPiIsCiAgICAgIDkwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCwKICAgICAgR2FtZS5HZXRJY29uKCJLaXR0ZW4iLCAxMSkKICAgICk7CiAgICBHYW1lLmxhc3Qua2l0dGVuID0gMTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDExLCAxOCk7CgogICAgb3JkZXIgPSAxMDAzMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJGZXN0aXZpdHkgbG9vcHMiLAogICAgICBkZXNjOiAiVGhlc2UgZ2FyaXNoIGJpc2N1aXRzIGFyZSBhIHBlcmZlY3QgZml0IGZvciBjaGlsZHJlbidzIGJpcnRoZGF5IHBhcnRpZXMgb3IgdGhlIGZ1bmVyYWxzIG9mIHN0cmFuZ2UsIGVjY2VudHJpYyBiaWxsaW9uYWlyZXMuIiwKICAgICAgaWNvbjogWzI1LCAxN10sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgYnJhbmQgYmlzY3VpdHMiLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSAqIDUsCiAgICB9KTsKCiAgICBvcmRlciA9IDEwMDIwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlBlcnNpYW4gcmljZSBjb29raWVzIiwKICAgICAgZGVzYzogIlJvc2Ugd2F0ZXIgYW5kIHBvcHB5IHNlZWRzIGFyZSB0aGUgc2VjcmV0IGluZ3JlZGllbnRzIG9mIHRoZXNlIHNtYWxsLCBidXR0ZXItZnJlZSBjb29raWVzLiIsCiAgICAgIGljb246IFsyOCwgMTVdLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIk5vcndlZ2lhbiBjb29raWVzIiwKICAgICAgZGVzYzogIkEgZmxhdCBidXR0ZXIgY29va2llIHdpdGggYSBzbGl2ZXIgb2YgY2FuZGllZCBjaGVycnkgb24gdG9wLiBJdCBpcyBzYWlkIHRoYXQgdGhlc2UgaWxsdXN0cmF0ZSB0aGUgYmxlYWtuZXNzIG9mIHNjYW5kaW5hdmlhbiBleGlzdGVudGlhbGlzbS4iLAogICAgICBpY29uOiBbMjIsIDIwXSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJDcmlzcHkgcmljZSBjb29raWVzIiwKICAgICAgZGVzYzogIkZ1biB0byBtYWtlIGF0IGhvbWUhIFN0b3JlLWJvdWdodCBjb29raWVzIGFyZSBvYnNvbGV0ZSEgVG9wcGxlIHRoZSBzeXN0ZW0hIFRoZXJlJ3MgbWFyc2htYWxsb3dzIGluIHRoZXNlISBEZXN0cm95IGNhcGl0YWxpc20hIiwKICAgICAgaWNvbjogWzIzLCAyMF0sCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlViZSBjb29raWVzIiwKICAgICAgZGVzYzogIlRoZSB0aW50IGlzIG9idGFpbmVkIGJ5IHRoZSB1c2Ugb2YgcHVycGxlIHlhbXMuIEFjY29yZGluZyB0byBjb2xvciBzeW1ib2xpc20sIHRoZXNlIGNvb2tpZXMgYXJlIGVpdGhlciBub2JsZSwgaG9seSwgb3Igc3VwZXJ2aWxsYWlucy4iLAogICAgICBpY29uOiBbMjQsIDE3XSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQnV0dGVyc2NvdGNoIGNvb2tpZXMiLAogICAgICBkZXNjOiAiVGhlIGJ1dHRlcnNjb3RjaCBjaGlwcyBhcmUganVzdCB0aGUgcmlnaHQgYW1vdW50IG9mIHN0aWNreSwgYW5kIG1ha2UgeW91IGZlZWwgbGlrZSB5b3UncmUgZWF0aW5nIGNhbmR5LiIsCiAgICAgIGljb246IFsyNCwgMjBdLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiU3BlY3VsYWFzIiwKICAgICAgZGVzYzogIlRoZXNlIGNydW5jaHksIGFsbW9zdCBvYm5veGlvdXNseSBjaW5uYW1vbnkgY29va2llcyBhcmUgYSBzb3VyY2Ugb2YgZHV0Y2ggcHJpZGUuIEFib3V0IHRoZSBvcmlnaW4gb2YgdGhlIG5hbWUsIG9uZSBjYW4gb25seSBzcGVjdWxhdGUuIiwKICAgICAgaWNvbjogWzIxLCAyMF0sCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKCiAgICBvcmRlciA9IDEwMjAwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkVsZGVyd29ydCBiaXNjdWl0cyIsCiAgICAgIGRlc2M6ICItIiwKICAgICAgaWNvbjogWzIyLCAyNV0sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogNjAgKiAyLAogICAgICBsb2NrZWQ6IDEsCiAgICB9KTsKICAgIEdhbWUubGFzdC5iYXNlRGVzYyA9CiAgICAgIGdldFN0ckNvb2tpZVByb2R1Y3Rpb25NdWx0aXBsaWVyUGx1cygyKSArCiAgICAgICI8YnI+IiArCiAgICAgIGxvYygiJTEgYXJlIDxiPiUyJTwvYj4gbW9yZSBwb3dlcmZ1bC4iLCBbCiAgICAgICAgY2FwKEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLnBsdXJhbCksCiAgICAgICAgMiwKICAgICAgXSkgKwogICAgICAiPGJyPiIgKwogICAgICBsb2MoIkRyb3BwZWQgYnkgJTEgcGxhbnRzLiIsIGxvYygiRWxkZXJ3b3J0IikudG9Mb3dlckNhc2UoKSkgKwogICAgICAiPHE+VGhleSB0YXN0ZSBpbmNyZWRpYmx5IHN0YWxlLCBldmVuIHdoZW4gYmFrZWQgZnJlc2guPC9xPiI7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQmFrZWJlcnJ5IGNvb2tpZXMiLAogICAgICBkZXNjOiAiLSIsCiAgICAgIGljb246IFsyMywgMjVdLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDYwLAogICAgICBsb2NrZWQ6IDEsCiAgICB9KTsKICAgIEdhbWUubGFzdC5iYXNlRGVzYyA9CiAgICAgIGdldFN0ckNvb2tpZVByb2R1Y3Rpb25NdWx0aXBsaWVyUGx1cygyKSArCiAgICAgICI8YnI+IiArCiAgICAgIGxvYygiRHJvcHBlZCBieSAlMSBwbGFudHMuIiwgbG9jKCJCYWtlYmVycnkiKS50b0xvd2VyQ2FzZSgpKSArCiAgICAgICI8cT5SZWFsbHkgZ29vZCBkaXBwZWQgaW4gaG90IGNob2NvbGF0ZS48L3E+IjsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJEdWtldGF0ZXIgY29va2llcyIsCiAgICAgIGRlc2M6ICItIiwKICAgICAgaWNvbjogWzI0LCAyNV0sCiAgICAgIHBvd2VyOiAxMCwKICAgICAgcHJpY2U6IDYwICogMywKICAgICAgbG9ja2VkOiAxLAogICAgfSk7CiAgICBHYW1lLmxhc3QuYmFzZURlc2MgPQogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMTApICsKICAgICAgIjxicj4iICsKICAgICAgbG9jKCJEcm9wcGVkIGJ5ICUxIHBsYW50cy4iLCBsb2MoIkR1a2V0YXRlciIpLnRvTG93ZXJDYXNlKCkpICsKICAgICAgIjxxPkZyYWdyYW50IGFuZCBtZWFseSwgd2l0aCBhIHNsaWdodCB5ZWxsb3cgYWZ0ZXJ0YXN0ZS48L3E+IjsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJHcmVlbiB5ZWFzdCBkaWdlc3RpdmVzIiwKICAgICAgZGVzYzogIi0iLAogICAgICBpY29uOiBbMjUsIDI1XSwKICAgICAgcG93ZXI6IDAsCiAgICAgIHByaWNlOiA2MCAqIDMsCiAgICAgIGxvY2tlZDogMSwKICAgIH0pOwogICAgR2FtZS5sYXN0LmJhc2VEZXNjID0KICAgICAgbG9jKCJHb2xkZW4gY29va2llcyBnaXZlIDxiPiUxJTwvYj4gbW9yZSBjb29raWVzLiIsIDEpICsKICAgICAgIjxicj4iICsKICAgICAgbG9jKCJHb2xkZW4gY29va2llIGVmZmVjdHMgbGFzdCA8Yj4lMSU8L2I+IGxvbmdlci4iLCAxKSArCiAgICAgICI8YnI+IiArCiAgICAgIGxvYygiR29sZGVuIGNvb2tpZXMgYXBwZWFyIDxiPiUxJTwvYj4gbW9yZSBvZnRlbi4iLCAxKSArCiAgICAgICI8YnI+IiArCiAgICAgIGxvYygiUmFuZG9tIGRyb3BzIGFyZSA8Yj4lMSUgbW9yZSBjb21tb248L2I+LiIsIDMpICsKICAgICAgIjxicj4iICsKICAgICAgbG9jKCJEcm9wcGVkIGJ5ICUxIHBsYW50cy4iLCBsb2MoIkdyZWVuIHJvdCIpLnRvTG93ZXJDYXNlKCkpICsKICAgICAgIjxxPlRoZXNlIGFyZSB0YXN0aWVyIHRoYW4geW91J2QgZXhwZWN0LCBidXQgbm90IGJ5IG11Y2guPC9xPiI7CgogICAgb3JkZXIgPSAyMzAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJGZXJuIHRlYSIsCiAgICAgIGxvYygKICAgICAgICAiWW91IGdhaW4gYW5vdGhlciA8Yj4rJTElPC9iPiBvZiB5b3VyIHJlZ3VsYXIgQ3BTIHdoaWxlIHRoZSBnYW1lIGlzIGNsb3NlZC4iLAogICAgICAgIDMKICAgICAgKSArCiAgICAgICAgIiA8c21hbGw+KCIgKwogICAgICAgIGxvYygKICAgICAgICAgICJNdXN0IG93biB0aGUgJTEgdXBncmFkZS4iLAogICAgICAgICAgZ2V0VXBncmFkZU5hbWUoIlR3aW4gR2F0ZXMgb2YgVHJhbnNjZW5kZW5jZSIpCiAgICAgICAgKSArCiAgICAgICAgIik8L3NtYWxsPiIgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJEcm9wcGVkIGJ5ICUxIHBsYW50cy4iLCBsb2MoIkRyb3dzeWZlcm4iKS50b0xvd2VyQ2FzZSgpKSArCiAgICAgICAgIjxxPkEgY2hlbWljYWxseSBjb21wbGV4IG5hdHVyYWwgYmV2ZXJhZ2UsIHRoaXMgc29vdGhpbmcgY29uY29jdGlvbiBoYXMgYmVlbiB1c2VkIGJ5IG1hdGhlbWF0aWNpYW5zIHRvIHNvbHZlIGVxdWF0aW9ucyBpbiB0aGVpciBzbGVlcC48L3E+IiwKICAgICAgNjAsCiAgICAgIFsyNiwgMjVdCiAgICApOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkljaG9yIHN5cnVwIiwKICAgICAgbG9jKAogICAgICAgICJZb3UgZ2FpbiBhbm90aGVyIDxiPislMSU8L2I+IG9mIHlvdXIgcmVndWxhciBDcFMgd2hpbGUgdGhlIGdhbWUgaXMgY2xvc2VkLiIsCiAgICAgICAgNwogICAgICApICsKICAgICAgICAiIDxzbWFsbD4oIiArCiAgICAgICAgbG9jKAogICAgICAgICAgIk11c3Qgb3duIHRoZSAlMSB1cGdyYWRlLiIsCiAgICAgICAgICBnZXRVcGdyYWRlTmFtZSgiVHdpbiBHYXRlcyBvZiBUcmFuc2NlbmRlbmNlIikKICAgICAgICApICsKICAgICAgICAiKTwvc21hbGw+IiArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoCiAgICAgICAgICAiU3VnYXIgbHVtcHMgbWF0dXJlIDxiPiUxPC9iPiBzb29uZXIuIiwKICAgICAgICAgIEdhbWUuc2F5VGltZSg3ICogNjAgKiBHYW1lLmZwcykKICAgICAgICApICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiRHJvcHBlZCBieSAlMSBwbGFudHMuIiwgbG9jKCJJY2hvcnB1ZmYiKS50b0xvd2VyQ2FzZSgpKSArCiAgICAgICAgIjxxPlRhc3RlcyBsaWtlIGNhbmR5LiBUaGUgc21lbGwgaXMgYW5vdGhlciBzdG9yeS48L3E+IiwKICAgICAgNjAgKiAyLAogICAgICBbMjcsIDI1XQogICAgKTsKCiAgICBvcmRlciA9IDEwMjAwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIldoZWF0IHNsaW1zIiwKICAgICAgZGVzYzogIi0iLAogICAgICBpY29uOiBbMjgsIDI1XSwKICAgICAgcG93ZXI6IDEsCiAgICAgIHByaWNlOiAzMCwKICAgICAgbG9ja2VkOiAxLAogICAgfSk7CiAgICBHYW1lLmxhc3QuYmFzZURlc2MgPQogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMSkgKwogICAgICAiPGJyPiIgKwogICAgICBsb2MoIkRyb3BwZWQgYnkgJTEgcGxhbnRzLiIsIGxvYygiQmFrZXIncyB3aGVhdCIpLnRvTG93ZXJDYXNlKCkpICsKICAgICAgIjxxPlRoZSBvbmx5IHJlYXNvbiB5b3UnZCBjb25zaWRlciB0aGVzZSB0byBiZSBjb29raWVzIGlzIGJlY2F1c2UgeW91IGZlZWwgc2xpZ2h0bHkgc29ycnkgZm9yIHRoZW0uPC9xPiI7CgogICAgdmFyIGdhcmRlbkRyb3BzID0gWwogICAgICAiRWxkZXJ3b3J0IGJpc2N1aXRzIiwKICAgICAgIkJha2ViZXJyeSBjb29raWVzIiwKICAgICAgIkR1a2V0YXRlciBjb29raWVzIiwKICAgICAgIkdyZWVuIHllYXN0IGRpZ2VzdGl2ZXMiLAogICAgICAiRmVybiB0ZWEiLAogICAgICAiSWNob3Igc3lydXAiLAogICAgICAiV2hlYXQgc2xpbXMiLAogICAgXTsKICAgIGZvciAodmFyIGkgaW4gZ2FyZGVuRHJvcHMpIHsgLy9zY2FsZSBieSBDcFMKICAgICAgdmFyIGl0ID0gR2FtZS5VcGdyYWRlc1tnYXJkZW5Ecm9wc1tpXV07CiAgICAgIGl0LnByaWNlRnVuYyA9IChmdW5jdGlvbiAoY29zdCkgewogICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gY29zdCAqIEdhbWUuY29va2llc1BzICogNjA7CiAgICAgICAgfTsKICAgICAgfSkoaXQuYmFzZVByaWNlKTsKICAgICAgaXQuYmFzZURlc2MgPSBpdC5iYXNlRGVzYy5yZXBsYWNlKAogICAgICAgICI8cT4iLAogICAgICAgICI8YnI+IiArIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBDcFMuIikgKyAiPHE+IgogICAgICApOwogICAgICBpdC5kZXNjID0gQmVhdXRpZnlJblRleHQoaXQuYmFzZURlc2MpOwogICAgICBpdC5sYXN0aW5nID0gdHJ1ZTsKICAgIH0KCiAgICBvcmRlciA9IDEwMzAwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlN5bnRoZXRpYyBjaG9jb2xhdGUgZ3JlZW4gaG9uZXkgYnV0dGVyIGJpc2N1aXQiLAogICAgICBkZXNjOiAiUmV3YXJkZWQgZm9yIG93bmluZyAzNTAgb2YgZXZlcnl0aGluZy48YnI+VGhlIHJlY2lwZSBmb3IgdGhpcyBidXR0ZXIgYmlzY3VpdCB3YXMgb25jZSB0aGUgc29sZSBoZXJpdGFnZSBvZiBhbiBhbmNpZW50IG1vdW50YWluIG1vbmFzdGVyeS4gSXRzIGZsYXZvciBpcyBzbyByZWZpbmVkIHRoYXQgb25seSBhIHNsYWIgb2YgbGFiLW1hZGUgY2hvY29sYXRlIHNwZWNpZmljYWxseSBlbmdpbmVlcmVkIHRvIGJlIGNvbXBsZXRlbHkgdGFzdGVsZXNzIGNvdWxkIGNvbXBsZW1lbnQgaXQuPGJyPkFsc28gaXQncyBnb3QgeW91ciBmYWNlIG9uIGl0LiIsCiAgICAgIGljb246IFsyNCwgMjZdLAogICAgICBwb3dlcjogMTAsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiBidXR0ZXJCaXNjdWl0TXVsdCwKICAgICAgbG9ja2VkOiAxLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiUm95YWwgcmFzcGJlcnJ5IGNob2NvbGF0ZSBidXR0ZXIgYmlzY3VpdCIsCiAgICAgIGRlc2M6ICJSZXdhcmRlZCBmb3Igb3duaW5nIDQwMCBvZiBldmVyeXRoaW5nLjxicj5PbmNlIHJlc2VydmVkIGZvciB0aGUgbWVnYWxvbWFuaWFjIGVsaXRlLCB0aGlzIHVuaXF1ZSBzdHJhaW4gb2YgZnJ1aXR5IGNob2NvbGF0ZSBoYXMgYSBmbGF2b3IgYW5kIHRleHR1cmUgdW5saWtlIGFueSBvdGhlci4gV2hldGhlciBpdHMgZXhvcmJpdGFudCB3b3J0aCBpcyBpbXByb3ZlZCBvciBsZXNzZW5lZCBieSB0aGUgcHJlc2VuY2Ugb2YgeW91ciBsaWtlbmVzcyBvbiBpdCBzdGlsbCByZW1haW5zIHRvIGJlIHNlZW4uIiwKICAgICAgaWNvbjogWzI1LCAyNl0sCiAgICAgIHBvd2VyOiAxMCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSAqIGJ1dHRlckJpc2N1aXRNdWx0LAogICAgICBsb2NrZWQ6IDEsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJVbHRyYS1jb25jZW50cmF0ZWQgaGlnaC1lbmVyZ3kgY2hvY29sYXRlIGJ1dHRlciBiaXNjdWl0IiwKICAgICAgZGVzYzogIlJld2FyZGVkIGZvciBvd25pbmcgNDUwIG9mIGV2ZXJ5dGhpbmcuPGJyPkluZnVzZWQgd2l0aCB0aGUgcG93ZXIgb2Ygc2V2ZXJhbCBoeWRyb2dlbiBib21icyB0aHJvdWdoIGEgcHJvY2VzcyB0aGF0IGxlZnQgbW9zdCBudWNsZWFyIGVuZ2luZWVycyBhbmQgc2hhcmVob2xkZXJzIHBlcnBsZXhlZC4gQ3VycmVudGx5IGF0IHRoZSBjZW50ZXIgb2Ygc29tZSByYXRoZXIgaGVhdGVkIFVuaXRlZCBOYXRpb25zIG1lZXRpbmdzLiBHb2luZyBpbiBtb3JlIGRldGFpbCBhYm91dCB0aGlzIGNob2NvbGF0ZSB3b3VsZCB2aW9sYXRlIHNldmVyYWwgc3RhdGUgc2VjcmV0cywgYnV0IHdlJ2xsIGp1c3QgYWRkIHRoYXQgc29tZW9uZSdzIGJ1c3Qgc2VlbXMgdG8gYmUgcGljdHVyZWQgb24gaXQuIFBlcmhhcHMgeW91cnM/IiwKICAgICAgaWNvbjogWzI2LCAyNl0sCiAgICAgIHBvd2VyOiAxMCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSAqIGJ1dHRlckJpc2N1aXRNdWx0LAogICAgICBsb2NrZWQ6IDEsCiAgICB9KTsKCiAgICBvcmRlciA9IDIwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRpbWVwcm9vZiBoYWlyIGR5ZXMiLAogICAgICAiPHE+V2h5IGRvIHRoZXkgYWx3YXlzIGhhdmUgdGhvc2Ugc3RyYW5nZSB3aXNweSBwaW5rIGRvcz8gV2hhdCBkbyB0aGV5IGtub3cgYWJvdXQgY2FuZHkgZmxvc3MgdGhhdCB3ZSBkb24ndD88L3E+IiwKICAgICAgIkdyYW5kbWEiLAogICAgICAxMAogICAgKTsKICAgIG9yZGVyID0gMzAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQmFybnN0YXJzIiwKICAgICAgIjxxPkFoLCB5ZXMuIFRoZXNlIGhlbHAgcXVpdGUgYSBiaXQuIFNvbWVob3cuPC9xPiIsCiAgICAgICJGYXJtIiwKICAgICAgMTAKICAgICk7CiAgICBvcmRlciA9IDQwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIk1pbmUgY2FuYXJpZXMiLAogICAgICAiPHE+VGhlc2UgYXJlbid0IHVzZWQgZm9yIGFueXRoaW5nIGZyZWFreSEgVGhlIG1pbmVycyBqdXN0IGVuam95IGhhdmluZyBhIHBldCBvciB0d28gZG93biB0aGVyZS48L3E+IiwKICAgICAgIk1pbmUiLAogICAgICAxMAogICAgKTsKICAgIG9yZGVyID0gNTAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQnJvd25pZSBwb2ludCBzeXN0ZW0iLAogICAgICAiPHE+T2gsIHRoZXNlIGFyZSBsb3ZlbHkhIFlvdSBjYW4gbm93IHJld2FyZCB5b3VyIGZhY3RvcnkgZW1wbG95ZWVzIGZvciBnb29kIGJlaGF2aW9yLCBzdWNoIGFzIHdvcmtpbmcgb3ZlcnRpbWUgb3Igc25pdGNoaW5nIG9uIGNvd29ya2Vycy4gNTggYnJvd25pZSBwb2ludHMgZ2V0cyB5b3UgYSBsaXR0bGUgcGljdHVyZSBvZiBhIGJyb3duaWUsIGFuZCAxNzggb2YgdGhvc2UgcGljdHVyZXMgZ2V0cyB5b3UgYW4gYWN0dWFsIGJyb3duaWUgcGllY2UgZm9yIHlvdSB0byBkbyB3aXRoIGFzIHlvdSBwbGVhc2UhIEluZmFudGlsaXppbmc/IE1heWJlLiBPb2RsZXMgb2YgZnVuPyBZb3UgYmV0Y2hhITwvcT4iLAogICAgICAiRmFjdG9yeSIsCiAgICAgIDEwCiAgICApOwogICAgb3JkZXIgPSA1MjU7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJHcmFuZCBzdXBlcmN5Y2xlcyIsCiAgICAgICI8cT5XZSBsZXQgdGhlIHB1YmxpYyB0aGluayB0aGVzZSBhcmUgY29tcGxpY2F0ZWQgZmluYW5jaWFsIHRlcm1zIHdoZW4gcmVhbGx5IHdlJ3JlIGp1c3QgcmV3YXJkaW5nIHRoZSBiYW5rZXJzIHdpdGggc25henp5IGJpY3ljbGVzIGZvciBhIGpvYiB3ZWxsIGRvbmUuIEl0J3Mgb25seSBuYXR1cmFsIGFmdGVyIHlvdSBidWlsdCB0aG9zZSBmYW5jeSBnb2xkIHN3aW1taW5nIHBvb2xzIGZvciB0aGVtLCB3aGVyZSB0aGV5IGNhbiB0YWtlIGEgZGlwIGFuZCBjYXRjaCBLb25kcmF0aWV2IHdhdmVzLjwvcT4iLAogICAgICAiQmFuayIsCiAgICAgIDEwCiAgICApOwogICAgb3JkZXIgPSA1NTA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJQc2FsbS1yZWFkaW5nIiwKICAgICAgIjxxPkEgdGhlb2xvZ2ljYWxseSBkdWJpb3VzIGFuZCBwb3NzaWJseSBibGFzcGhlbW91cyBibGVuZCBvZiBmb3J0dW5lLXRlbGxpbmcgYW5kIHNjcmlwdHVyZSBzdHVkaWVzLjwvcT4iLAogICAgICAiVGVtcGxlIiwKICAgICAgMTAKICAgICk7CiAgICBvcmRlciA9IDU3NTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkltbW9iaWxlIHNwZWxsY2FzdGluZyIsCiAgICAgICI8cT5XaXphcmRzIHdobyBtYXN0ZXIgdGhpcyBza2lsbCBjYW4gbm93IGNhc3Qgc3BlbGxzIHdpdGhvdXQgaGF2aW5nIHRvIGhvcCBhbmQgc2tpcCBhbmQgZ2VzdGljdWxhdGUgZW1iYXJyYXNzaW5nbHksIHdoaWNoIGlzIG11Y2ggc25lYWtpZXIgYW5kIGhvbmVzdGx5IHF1aXRlIGEgcmVsaWVmLjwvcT4iLAogICAgICAiV2l6YXJkIHRvd2VyIiwKICAgICAgMTAKICAgICk7CiAgICBvcmRlciA9IDYwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlJlc3RhdXJhbnRzIGF0IHRoZSBlbmQgb2YgdGhlIHVuaXZlcnNlIiwKICAgICAgIjxxPlNpbmNlIHRoZSB1bml2ZXJzZSBpcyBzcGF0aWFsbHkgaW5maW5pdGUsIGFuZCB0aGVyZWZvcmUgY2FuIGJlIGNvbnN0cnVlZCB0byBoYXZlIGluZmluaXRlIGVuZHMsIHlvdSd2ZSBvcGVuZWQgYW4gaW5maW5pdGUgY2hhaW4gb2YgcmVzdGF1cmFudHMgd2hlcmUgeW91ciBzcGFjZSB0cnVja2VycyBjYW4gcmVzdCBhbmQgcGFydGFrZSBpbiBzb21lIGhvbWUtYnJhbmQgY29va2llLWJhc2VkIG1lYWxzLjwvcT4iLAogICAgICAiU2hpcG1lbnQiLAogICAgICAxMAogICAgKTsKICAgIG9yZGVyID0gNzAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiT24gc2Vjb25kIHRob3VnaHQiLAogICAgICAiPHE+RGlzcmVnYXJkIHRoYXQgbGFzdCB1cGdyYWRlLCBhbGNoZW15IGlzIHdoZXJlIGl0J3MgYXQhIFlvdXIgZWdnaGVhZHMganVzdCBmb3VuZCBhIHdheSB0byB0cmFuc211dGUgY2hpbGRyZW4ncyBuaWdodG1hcmVzIGludG8gcmFyZSBtZXRhbHMhPC9xPiIsCiAgICAgICJBbGNoZW15IGxhYiIsCiAgICAgIDEwCiAgICApOwogICAgb3JkZXIgPSA4MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJEaW1lbnNpb25hbCBnYXJiYWdlIGd1bHBlciIsCiAgICAgICI8cT5TbyB3ZSd2ZSBiZWVuIGxvb2tpbmcgZm9yIGEgcGxhY2UgdG8gZGlzcG9zZSBvZiBhbGwgdGhlIHJlZnVzZSB0aGF0J3MgYmVlbiBhY2N1bXVsYXRpbmcgc2luY2Ugd2Ugc3RhcnRlZCBiYWtpbmcgLSBidXJudCBjb29raWVzLCBmYWlsZWQgZXhwZXJpbWVudHMsIHVucnVseSB3b3JrZXJzIC0gYW5kIHdlbGwsIHdlIGZpZ3VyZWQgcmF0aGVyIHRoYW4gc2VsbCBpdCB0byBwb29yIGNvdW50cmllcyBsaWtlIHdlJ3ZlIGJlZW4gZG9pbmcsIHdlIGNvdWxkIGp1c3QgZHVtcCBpdCBpbiBzb21lIGFsdGVybmF0ZSB0cmFzaCBkaW1lbnNpb24gd2hlcmUgaXQncyBub3QgZ29ubmEgYm90aGVyIGFueWJvZHkhIFByb2JhYmx5ITwvcT4iLAogICAgICAiUG9ydGFsIiwKICAgICAgMTAKICAgICk7CiAgICBvcmRlciA9IDkwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkFkZGl0aW9uYWwgY2xvY2sgaGFuZHMiLAogICAgICAiPHE+SXQgc2VlbWVkIGxpa2UgYSBzaWxseSBpZGVhIGF0IGZpcnN0LCBidXQgaXQgdHVybnMgb3V0IHRoZXNlIGhhdmUgdGhlIHN0cmFuZ2UgYWJpbGl0eSB0byB0d2lzdCB0aW1lIGluIGludGVyZXN0aW5nIG5ldyB3YXlzLjwvcT4iLAogICAgICAiVGltZSBtYWNoaW5lIiwKICAgICAgMTAKICAgICk7CiAgICBvcmRlciA9IDEwMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJCYWtpbmcgTm9iZWwgcHJpemUiLAogICAgICAiPHE+V2hhdCBiZXR0ZXIgd2F5IHRvIHNwb25zb3Igc2NpZW50aWZpYyBncm93dGggdGhhbiB0byBtb3RpdmF0ZSB0aG9zZSBzbWFybXkgbmVyZHMgd2l0aCBhIG1lYW5pbmdsZXNzIGF3YXJkISBXaGF0J3MgbW9yZSwgZWFjaCBwcml6ZSBjb21lcyB3aXRoIGEgZmluZSBwcmludCBsaWZlbG9uZyBleGNsdXNpdmUgY29udHJhY3QgdG8gY29tZSB3b3JrIGZvciB5b3UgKG9yIGVsc2UpITwvcT4iLAogICAgICAiQW50aW1hdHRlciBjb25kZW5zZXIiLAogICAgICAxMAogICAgKTsKICAgIG9yZGVyID0gMTEwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlJldmVyc2UgdGhlb3J5IG9mIGxpZ2h0IiwKICAgICAgIjxxPkEgd2hvbGUgbmV3IHdvcmxkIG9mIHBoeXNpY3Mgb3BlbnMgdXAgd2hlbiB5b3UgZGVjaWRlIHRoYXQgYW50aXBob3RvbnMgYXJlIHJlYWwgYW5kIHBvc2l0IHRoYXQgbGlnaHQgaXMgbWVyZWx5IGEgdm9pZCBpbiBzaGFkb3cuPC9xPiIsCiAgICAgICJQcmlzbSIsCiAgICAgIDEwCiAgICApOwogICAgb3JkZXIgPSAxMjAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiUmV2aXNlZCBwcm9iYWJpbGlzdGljcyIsCiAgICAgICI8cT5FaXRoZXIgc29tZXRoaW5nIGhhcHBlbnMgb3IgaXQgZG9lc24ndC4gVGhhdCdzIGEgNTAlIGNoYW5jZSEgVGhpcyBzdWRkZW5seSBtYWtlcyBhIGxvdCBvZiB1bmxpa2VseSB0aGluZ3MgdmVyeSBwb3NzaWJsZS48L3E+IiwKICAgICAgIkNoYW5jZW1ha2VyIiwKICAgICAgMTAKICAgICk7CgogICAgb3JkZXIgPSAyMDAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJLaXR0ZW4gYW5hbHlzdHMiLAogICAgICBzdHJLaXR0ZW5EZXNjICsKICAgICAgICAiPHE+YmFzZWQgb24gcHVycmVudCByZXR1cm4tb24taW52ZXN0bWVudCBtZW93ZGVscyB3ZSBzaG91bGQgYmUgYWJsZSB0byBhZmZ1cmQgdG8gcGF5IG91ciBlbXBhd3llZXMgc29tZXdoZXJlIGFyb3VuZCBuZXh0IGNlbnR1cnksIHNpcjwvcT4iLAogICAgICA5MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIEdhbWUuR2V0SWNvbigiS2l0dGVuIiwgMTIpCiAgICApOwogICAgR2FtZS5sYXN0LmtpdHRlbiA9IDE7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCAxMiwgMTgpOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJFeWUgb2YgdGhlIHdyaW5rbGVyIiwKICAgICAgbG9jKCJNb3VzZSBvdmVyIGEgd3JpbmtsZXIgdG8gc2VlIGhvdyBtYW55IGNvb2tpZXMgYXJlIGluIGl0cyBzdG9tYWNoLiIpICsKICAgICAgICAiPHE+SnVzdCBhIHdyaW5rbGVyIGFuZCBpdHMgd2lsbCB0byBzdXJ2aXZlLjxicj5IYW5naW4nIHRvdWdoLCBzdGF5aW4nIGh1bmdyeS48L3E+IiwKICAgICAgOTk5OTk5OTksCiAgICAgIFsyNywgMjZdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIldyaW5rbHkgY29va2llcyJdOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJJbnNwaXJlZCBjaGVja2xpc3QiLAogICAgICBsb2MoCiAgICAgICAgIlVubG9ja3MgdGhlIDxiPkJ1eSBhbGw8L2I+IGZlYXR1cmUsIHdoaWNoIGxldHMgeW91IGluc3RhbnRseSBwdXJjaGFzZSBldmVyeSB1cGdyYWRlIGluIHlvdXIgc3RvcmUgKHN0YXJ0aW5nIGZyb20gdGhlIGNoZWFwZXN0IG9uZSkuPGJyPkFsc28gdW5sb2NrcyB0aGUgPGI+VmF1bHQ8L2I+LCBhIHN0b3JlIHNlY3Rpb24gd2hlcmUgeW91IGNhbiBwbGFjZSB1cGdyYWRlcyB5b3UgZG8gbm90IHdpc2ggdG8gYXV0by1idXkuIgogICAgICApICsKICAgICAgICAnPHE+U25henp5IGdyYW5kbWEgYWNjZXNzb3JpZXM/IENoZWNrLiBUcmFuc2RpbWVuc2lvbmFsIGFib21pbmF0aW9ucz8gQ2hlY2suIEEgYnVuY2ggb2YgZWdncyBmb3Igc29tZSByZWFzb24/IENoZWNrLiBNYWNoaW5lIHRoYXQgZ29lcyAicGluZyI/IENoZWNrIGFuZCBjaGVjay48L3E+JywKICAgICAgOTAwMDAwLAogICAgICBbMjgsIDI2XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJQZXJzaXN0ZW50IG1lbW9yeSIsICJQZXJtYW5lbnQgdXBncmFkZSBzbG90IElJIl07CgogICAgb3JkZXIgPSAxMDMwMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJQdXJlIHBpdGNoLWJsYWNrIGNob2NvbGF0ZSBidXR0ZXIgYmlzY3VpdCIsCiAgICAgIGRlc2M6ICJSZXdhcmRlZCBmb3Igb3duaW5nIDUwMCBvZiBldmVyeXRoaW5nLjxicj5UaGlzIGNob2NvbGF0ZSBpcyBzbyBwdXJlIGFuZCBzbyBmbGF3bGVzcyB0aGF0IGl0IGhhcyBubyBjb2xvciBvZiBpdHMgb3duLCBpbnN0ZWFkIHRha2luZyBvbiB0aGUgYXBwZWFyYW5jZSBvZiB3aGF0ZXZlciBpcyBhcm91bmQgaXQuIFlvdSdyZSBhIGJpdCBzdXJwcmlzZWQgdG8gbm90aWNlIHRoYXQgdGhpcyBvbmUgaXNuJ3Qgc3RhbXBlZCB3aXRoIHlvdXIgZWZmaWd5LCBhcyBpdHMgc3VyZmFjZSBpcyBwZXJmZWN0bHkgc21vb3RoICh0byB0aGUgcGljb21ldGVyKSAtIHVudGlsIHlvdSByZWFsaXplIGl0J3MgcXVpdGUgbGl0ZXJhbGx5IHJlZmxlY3RpbmcgeW91ciBvd24gZmFjZSBsaWtlIGEgbWlycm9yLiIsCiAgICAgIGljb246IFsyNCwgMjddLAogICAgICBwb3dlcjogMTAsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiBidXR0ZXJCaXNjdWl0TXVsdCwKICAgICAgbG9ja2VkOiAxLAogICAgfSk7CgogICAgb3JkZXIgPSAxMDAyMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJDaG9jb2xhdGUgb2F0bWVhbCBjb29raWVzIiwKICAgICAgZGVzYzogIlRoZXNlIGJhZCBib3lzIGNvbXBlbnNhdGUgZm9yIGxhY2sgb2YgYSBjb2hlc2l2ZSBmb3JtIGFuZCBhIGx1bXB5LCB1bnNpZ2h0bHkgYXBwZWFyYW5jZSBieSBiZWluZyBqdXN0IHNpbXBseSBkZWxpY2lvdXMuIFNvbWV0aGluZyB3ZSBzaG91bGQgYWxsIGFzcGlyZSB0by4iLAogICAgICBpY29uOiBbMjMsIDI4XSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSAqIDUsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJNb2xhc3NlcyBjb29raWVzIiwKICAgICAgZGVzYzogIlN0aWNreSwgY3JhY2tseSwgYW5kIGR1c3RlZCBpbiBmaW5lIHN1Z2FyLjxicj5Tb21lIGx1bmF0aWNzIGhhdmUgYmVlbiBrbm93biB0byBlYXQgdGhlc2Ugd2l0aCBwb3RhdG9lcy4iLAogICAgICBpY29uOiBbMjQsIDI4XSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJCaXNjb3R0aSIsCiAgICAgIGRlc2M6ICJBbG1vbmRzIGFuZCBwaXN0YWNoaW9zIG1ha2UgdGhlc2UgdmVyeSByb2J1c3QgY29va2llcyBzbGlnaHRseSBtb3JlIGludGVyZXN0aW5nIHRvIGVhdCB0aGFuIHRvIGJsdWRnZW9uIHBlb3BsZSB3aXRoLiIsCiAgICAgIGljb246IFsyMiwgMjhdLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSAqIDUsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJXYWZmbGUgY29va2llcyIsCiAgICAgIGRlc2M6ICJXaGV0aGVyIHRoZXNlIGFyZSBjb29raWVzIHdpdGggc2hvY2tpbmdseSB3YWZmbGUtbGlrZSBmZWF0dXJlcyBvciBzaW1wbHkgcmVndWxhciBjb29raWUtc2l6ZWQgd2FmZmxlcyBpcyBhIGRlYmF0ZSB3ZSdyZSBub3QgZ2V0dGluZyBpbnRvIGhlcmUuIiwKICAgICAgaWNvbjogWzIxLCAyOF0sCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwoKICAgIG9yZGVyID0gMTAwMDA7CiAgICAvL2Vhcmx5IGNvb2tpZXMgdGhhdCB1bmxvY2sgYXQgdGhlIHNhbWUgdGltZSBhcyBjb2NvbnV0IGNvb2tpZXM7IG1lYW50IHRvIGJvb3N0IGVhcmx5IGdhbWUgYSBsaXR0bGUgYml0CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQWxtb25kIGNvb2tpZXMiLAogICAgICBkZXNjOiAiU29tZXRpbWVzIHlvdSBmZWVsIGxpa2Ugb25lIG9mIHRoZXNlLiBTb21ldGltZXMgeW91IGRvbid0LiIsCiAgICAgIGljb246IFsyMSwgMjddLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiSGF6ZWxudXQgY29va2llcyIsCiAgICAgIGRlc2M6ICJUYXN0ZXMgbGlrZSBhIG1vcm5pbmcgc3Ryb2xsIHRocm91Z2ggYSBmcmFncmFudCBmb3Jlc3QsIG1pbnVzIHRoZSBjbG91ZHMgb2YgZ25hdHMuIiwKICAgICAgaWNvbjogWzIyLCAyN10sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJXYWxudXQgY29va2llcyIsCiAgICAgIGRlc2M6ICJTb21lIGV4cGVydHMgaGF2ZSBwb2ludGVkIHRvIHRoZSB3YWxudXQncyBlZXJpZSByZXNlbWJsYW5jZSB0byB0aGUgaHVtYW4gYnJhaW4gYXMgYSBzaWduIG9mIGl0cyBzZW50aWVuY2UgLSBhIHRoZW9yeSBtb3N0IHdhbG51dHMgdmVoZW1lbnRseSBvYmplY3QgdG8uIiwKICAgICAgaWNvbjogWzIzLCAyN10sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTksCiAgICB9KTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiTGFiZWwgcHJpbnRlciIsCiAgICAgIGxvYygKICAgICAgICAiTW91c2Ugb3ZlciBhbiB1cGdyYWRlIHRvIHNlZSBpdHMgdGllci48YnI+PHNtYWxsPk5vdGU6IG9ubHkgc29tZSB1cGdyYWRlcyBoYXZlIHRpZXJzLiBUaWVycyBhcmUgcHVyZWx5IGNvc21ldGljIGFuZCBoYXZlIG5vIGVmZmVjdCBvbiBnYW1lcGxheS48L3NtYWxsPiIKICAgICAgKSArCiAgICAgICAgIjxxPkFsc28gY29tZXMgaW4gcmVhbCBoYW5keSB3aGVuIHlvdSB3YW50IHRvIHRlbGwgY2F0c3VwIGFwYXJ0IGZyb20ga2V0Y2h1cC48L3E+IiwKICAgICAgNTAwMDAwMCwKICAgICAgWzI4LCAyOV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiR2VuaXVzIGFjY291bnRpbmciXTsKCiAgICBvcmRlciA9IDIwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkdvb2QgbWFubmVycyIsCiAgICAgICc8cT5BcHBhcmVudGx5IHRoZXNlIGxhZGllcyBhcmUgbXVjaCBtb3JlIGFtaWFibGUgaWYgeW91IHRha2UgdGhlIHRpbWUgdG8gbGVhcm4gdGhlaXIgc3RyYW5nZSwgYW5jaWVudCBjdXN0b21zLCB3aGljaCBzZWVtIHRvIGludm9sdmUgc2F5aW5nICJwbGVhc2UiIGFuZCAidGhhbmsgeW91IiBhbmQgc3RhcmluZyBhdCB0aGUgc3VuIHdpdGggYnVsZ2luZyBleWVzIHdoaWxlIG11dHRlcmluZyBlbGRyaXRjaCBjdXJzZXMgdW5kZXIgeW91ciBicmVhdGguPC9xPicsCiAgICAgICJHcmFuZG1hIiwKICAgICAgMTEKICAgICk7CiAgICBvcmRlciA9IDMwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkxpbmR3b3JtcyIsCiAgICAgICI8cT5Zb3UgaGF2ZSB0byBpbXBvcnQgdGhlc2UgZnJvbSBmYXIgdXAgbm9ydGgsIGJ1dCB0aGV5IHJlYWxseSBoZWxwIGFlcmF0ZSB0aGUgc29pbCE8L3E+IiwKICAgICAgIkZhcm0iLAogICAgICAxMQogICAgKTsKICAgIG9yZGVyID0gNDAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQm9yZSBhZ2FpbiIsCiAgICAgICI8cT5BZnRlciBleHRyYWN0aW5nIHNvIG11Y2ggc2VkaW1lbnQgZm9yIHNvIGxvbmcsIHlvdSd2ZSBmb3JtZWQgc29tZSB2ZXJpdGFibGUgbW91bnRhaW5zIG9mIHlvdXIgb3duIGZyb20gdGhlIGFjY3VtdWxhdGVkIHBpbGVzIG9mIHJvY2sgYW5kIGRpcnQuIFRpbWUgdG8gZGlnIHRocm91Z2ggdGhvc2UgYW5kIHNlZSBpZiB5b3UgZmluZCBhbnl0aGluZyBmdW4hPC9xPiIsCiAgICAgICJNaW5lIiwKICAgICAgMTEKICAgICk7CiAgICBvcmRlciA9IDUwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgJyJWb2x1bnRlZXIiIGludGVybnMnLAogICAgICAiPHE+SWYgeW91J3JlIGJhZCBhdCBzb21ldGhpbmcsIGFsd2F5cyBkbyBpdCBmb3IgZnJlZS48L3E+IiwKICAgICAgIkZhY3RvcnkiLAogICAgICAxMQogICAgKTsKICAgIG9yZGVyID0gNTI1OwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiUnVsZXMgb2YgYWNxdWlzaXRpb24iLAogICAgICAiPHE+UnVsZSAzODcgOiBhIGNvb2tpZSBiYWtlZCBpcyBhIGNvb2tpZSBrZXB0LjwvcT4iLAogICAgICAiQmFuayIsCiAgICAgIDExCiAgICApOwogICAgb3JkZXIgPSA1NTA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJXYXIgb2YgdGhlIGdvZHMiLAogICAgICAiPHE+QW4gaW50ZXJlc3RpbmcgZ2FtZTsgdGhlIG9ubHkgd2lubmluZyBtb3ZlIGlzIG5vdCB0byBwcmF5LjwvcT4iLAogICAgICAiVGVtcGxlIiwKICAgICAgMTEKICAgICk7CiAgICBvcmRlciA9IDU3NTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkVsZWN0cmljaXR5IiwKICAgICAgIjxxPkFuY2llbnQgbWFnaWNrcyBhbmQgZm9yYmlkZGVuIGhleGVzIHNocm91ZCB0aGlzIGFyY2FuZSBrbm93bGVkZ2UsIHdob3NlIHVuZmF0aG9tYWJsZSBwb3dlciBjYW4gbXlzdGVyaW91c2x5IHR1cm4gZGFya25lc3MgaW50byBsaWdodCBhbmQgc2hvY2sgYW4gZWxlcGhhbnQgdG8gZGVhdGguPC9xPiIsCiAgICAgICJXaXphcmQgdG93ZXIiLAogICAgICAxMQogICAgKTsKICAgIG9yZGVyID0gNjAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiVW5pdmVyc2FsIGFscGhhYmV0IiwKICAgICAgJzxxPllvdVwndmUgbWFuYWdlZCB0byBjaGFydCBhIGxhbmd1YWdlIHRoYXQgY2FuIGJlIHVuZGVyc3Rvb2QgYnkgYW55IHNlbnRpZW50IHNwZWNpZXMgaW4gdGhlIGdhbGF4eTsgaXRzIGV4Y2l0aW5nIHZvY2FidWxhcnkgY29udGFpbnMgb3ZlciA1NiB0cmlsbGlvbiB3b3JkcyB0aGF0IHNvdW5kIGFuZCBsb29rIGxpa2Ugc3BhcmtseSBidXJwcywgZm9ybWluZyBpbnRyaWNhdGUgc2VudGVuY2VzIHRoYXQgdXN1YWxseSB0cmFuc2xhdGUgdG8gc29tZXRoaW5nIGxpa2UgImdpdmUgdXMgeW91ciBjb29raWVzLCBvciBlbHNlIi48L3E+JywKICAgICAgIlNoaXBtZW50IiwKICAgICAgMTEKICAgICk7CiAgICBvcmRlciA9IDcwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlB1YmxpYyBiZXR0ZXJtZW50IiwKICAgICAgIjxxPldoeSBkbyB3ZSBrZWVwIHRyeWluZyB0byBjaGFuZ2UgdXNlbGVzcyBtYXR0ZXIgaW50byBjb29raWVzLCBvciBjb29raWVzIGludG8gZXZlbiBiZXR0ZXIgY29va2llcz8gQ2xlYXJseSwgdGhlIHdheSBvZiB0aGUgZnV0dXJlIGlzIHRvIGNoYW5nZSB0aGUgcGVvcGxlIHdobyBlYXQgdGhlIGNvb2tpZXMgaW50byBwZW9wbGUgd2l0aCBhIGdyZWF0ZXIgdW5kZXJzdGFuZGluZywgYXBwcmVjaWF0aW9uIGFuZCByZXNwZWN0IGZvciB0aGUgY29va2llcyB0aGV5J3JlIGVhdGluZy4gSW50byB0aGUgdmF0IHlvdSBnbyE8L3E+IiwKICAgICAgIkFsY2hlbXkgbGFiIiwKICAgICAgMTEKICAgICk7CiAgICBvcmRlciA9IDgwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkVtYmVkZGVkIG1pY3JvcG9ydGFscyIsCiAgICAgICI8cT5XZSd2ZSBmb3VuZCBvdXQgdGhhdCBpZiB3ZSBiYWtlIHRoZSBwb3J0YWxzIGludG8gdGhlIGNvb2tpZXMgdGhlbXNlbHZlcywgd2UgY2FuIHRyYW5zcG9ydCBwZW9wbGUncyB0YXN0ZSBidWRzIHN0cmFpZ2h0IGludG8gdGhlIHRhc3RlIGRpbWVuc2lvbiEgR29vZCB0aGluZyB5b3VyIGFybXkgb2YgbGF3eWVycyBnb3QgcmlkIG9mIHRoZSBGREEgYSB3aGlsZSBhZ28hPC9xPiIsCiAgICAgICJQb3J0YWwiLAogICAgICAxMQogICAgKTsKICAgIG9yZGVyID0gOTAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiTm9zdGFsZ2lhIiwKICAgICAgIjxxPllvdXIgdGltZSBtYWNoaW5lIHRlY2huaWNpYW5zIGluc2lzdCB0aGF0IHRoaXMgaXMgc29tZSBhZHZhbmNlZCBuZXcgdGltZSB0cmF2ZWwgdGVjaCwgYW5kIG5vdCBqdXN0IGFuIGV4aXN0aW5nIGVtb3Rpb24gdW5pdmVyc2FsIHRvIG1hbmtpbmQuIEVpdGhlciB3YXksIHlvdSBoYXZlIHRvIGFkbWl0IHRoYXQgc2VsbGluZyBwZW9wbGUgdGhlIHNhbWUgb2xkIGNvb2tpZXMganVzdCBiZWNhdXNlIGl0IHJlbWluZHMgdGhlbSBvZiB0aGUgZ29vZCBvbGQgdGltZXMgaXMgYW4gaW50ZXJlc3RpbmcgcHJvc3BlY3QuPC9xPiIsCiAgICAgICJUaW1lIG1hY2hpbmUiLAogICAgICAxMQogICAgKTsKICAgIG9yZGVyID0gMTAwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRoZSBkZWZpbml0ZSBtb2xlY3VsZSIsCiAgICAgICI8cT5Zb3VyIHNjaWVudGlzdHMgaGF2ZSBmb3VuZCBhIHdheSB0byBwYWNrIGEgY29va2llIGludG8gb25lIHNpbmdsZSBjb250aW51b3VzIG1vbGVjdWxlLCBvcGVuaW5nIGV4Y2l0aW5nIG5ldyBwcm9zcGVjdHMgaW4gYm90aCBzdG9yYWdlIGFuZCBmbGF2b3IgZGVzcGl0ZSB0aGUgZmFjdCB0aGF0IHRoZXNlIHRha2UgdXAgdG8gYSB3aG9sZSB5ZWFyIHRvIGRpZ2VzdC48L3E+IiwKICAgICAgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwKICAgICAgMTEKICAgICk7CiAgICBvcmRlciA9IDExMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJMaWdodCBjYXB0dXJlIG1lYXN1cmVzIiwKICAgICAgIjxxPkFzIHRoZSB1bml2ZXJzZSBnZXRzIGV2ZXIgc28gc2xpZ2h0bHkgZGltbWVyIGR1ZSB0byB5b3UgY29udmVydGluZyBtb3JlIGFuZCBtb3JlIG9mIGl0cyBsaWdodCBpbnRvIGNvb2tpZXMsIHlvdSd2ZSB0YWtlbiB0byBmaW5kaW5nIG5ldyBhbmQgdW5leHBsb3JlZCBzb3VyY2VzIG9mIGxpZ2h0IGZvciB5b3VyIHByaXNtczsgZm9yIGluc3RhbmNlLCB0aGUgd2FybSBnbG93IGVtaXR0ZWQgYnkgYSBwcmVnbmFudCB3b21hbiwgb3IgdGhlIHR3aW5rbGUgaW4gdGhlIGV5ZSBvZiBhIGhvcGVmdWwgY2hpbGQuPC9xPiIsCiAgICAgICJQcmlzbSIsCiAgICAgIDExCiAgICApOwogICAgb3JkZXIgPSAxMjAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiMC1zaWRlZCBkaWNlIiwKICAgICAgIjxxPlRoZSBhZHZlbnQgb2YgdGhlIDAtc2lkZWQgZGljZSBoYXMgaGFkIHVuZXhwZWN0ZWQgYW5kIHR1bXVsdHVvdXMgZWZmZWN0cyBvbiB0aGUgZ2FtYmxpbmcgY29tbXVuaXR5LCBhbmQgc2F3IGV4cGVydHMgYXJvdW5kIHRoZSB3b3JsZCBjYWxsaW5nIHlvdSBib3RoIGEgZ2VuaXVzIGFuZCBhbiBpbWJlY2lsZS48L3E+IiwKICAgICAgIkNoYW5jZW1ha2VyIiwKICAgICAgMTEKICAgICk7CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkhlcmFsZHMiLAogICAgICBsb2MoCiAgICAgICAgIllvdSBub3cgYmVuZWZpdCBmcm9tIHRoZSBib29zdCBwcm92aWRlZCBieSA8Yj5oZXJhbGRzPC9iPi48YnI+RWFjaCBoZXJhbGQgZ2l2ZXMgeW91IDxiPisxJSBDcFM8L2I+Ljxicj5Mb29rIG9uIHRoZSBwdXJwbGUgZmxhZyBhdCB0aGUgdG9wIHRvIHNlZSBob3cgbWFueSBoZXJhbGRzIGFyZSBhY3RpdmUgYXQgYW55IGdpdmVuIHRpbWUuIgogICAgICApICsKICAgICAgICAoQXBwCiAgICAgICAgICA/ICI8cT5JdCdzIGdldHRpbmcgc3RlYW15LjwvcT4iCiAgICAgICAgICA6ICI8cT5CZSBleGNlbGxlbnQgdG8gZWFjaCBvdGhlci48YnI+QW5kIFBhdHJlb24sIGR1ZGVzITwvcT4iKSwKICAgICAgMTAwLAogICAgICBbMjEsIDI5XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKCiAgICBvcmRlciA9IDI1NTsKICAgIEdhbWUuR3JhbmRtYVN5bmVyZ3koCiAgICAgICJNZXRhZ3JhbmRtYXMiLAogICAgICAiQSBmcmFjdGFsIGdyYW5kbWEgdG8gbWFrZSBtb3JlIGdyYW5kbWFzIHRvIG1ha2UgbW9yZSBjb29raWVzLiIsCiAgICAgICJGcmFjdGFsIGVuZ2luZSIKICAgICk7CgogICAgb3JkZXIgPSAxMzAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiTWV0YWJha2VyaWVzIiwKICAgICAgIjxxPlRoZXkgcHJhY3RpY2FsbHkgYmFrZSB0aGVtc2VsdmVzITwvcT4iLAogICAgICAiRnJhY3RhbCBlbmdpbmUiLAogICAgICAxCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiTWFuZGVsYnJvd24gc3VnYXIiLAogICAgICAiPHE+QSBzdWJzdGFuY2UgdGhhdCBkaXNwbGF5cyB1c2VmdWwgcHJvcGVydGllcyBzdWNoIGFzIGZyYWN0YWwgc3dlZXRuZXNzIGFuZCBpbnN0YW50IGNvbnRhY3QgbGV0aGFsaXR5LjwvcT4iLAogICAgICAiRnJhY3RhbCBlbmdpbmUiLAogICAgICAyCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRnJhY3RvaWRzIiwKICAgICAgIjxxPkhlcmUncyBhIGZydW4gZnJhY3QgOiBhbGwgaW4gYWxsLCB0aGVzZSB3ZXJlIGEgdGVycmlibGUgaWRlYS48L3E+IiwKICAgICAgIkZyYWN0YWwgZW5naW5lIiwKICAgICAgMwogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIk5lc3RlZCB1bml2ZXJzZSB0aGVvcnkiLAogICAgICAiPHE+QXNzZXJ0cyB0aGF0IGVhY2ggc3ViYXRvbWljIHBhcnRpY2xlIGlzIGhvc3QgdG8gYSB3aG9sZSBuZXcgdW5pdmVyc2UsIGFuZCB0aGVyZWZvcmUsIGFub3RoZXIgbGltaXRsZXNzIHF1YW50aXR5IG9mIGNvb2tpZXMuPGJyPlRoaXMgc29tZWhvdyBzdGFja3Mgd2l0aCB0aGUgdGhlb3J5IG9mIG5hbm9jb3NtaWNzLCBiZWNhdXNlIHBoeXNpY3MuPC9xPiIsCiAgICAgICJGcmFjdGFsIGVuZ2luZSIsCiAgICAgIDQKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJNZW5nZXIgc3BvbmdlIGNha2UiLAogICAgICAiPHE+RnJpZ2h0ZW5pbmdseSBhYnNvcmJlbnQgdGhhbmtzIHRvIGl0cyB2aXJ0dWFsbHkgaW5maW5pdGUgc3VyZmFjZSBhcmVhLiBLZWVwIGl0IGlzb2xhdGVkIGluIGEgZHJ5IGNoYW1iZXIsIG5ldmVyIGhhbmRsZSBpdCB3aXRoIGFuIG9wZW4gd291bmQsIGFuZCBkbyBub3QgZXZlciBsZXQgaXQgdG91Y2ggYSBib2R5IG9mIHdhdGVyLjwvcT4iLAogICAgICAiRnJhY3RhbCBlbmdpbmUiLAogICAgICA1CiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiT25lIHBhcnRpY3VsYXJseSBnb29kLWh1bW9yZWQgY293IiwKICAgICAgIjxxPlRoaXMgdW5hc3N1bWluZyBib3ZpbmUgd2FzIGV4Y3J1Y2lhdGluZ2x5IGV4cGVuc2l2ZSBhbmQgaXQgbWF5IHNlZW0gYXQgZmlyc3QgbGlrZSB5b3Ugd2VyZSByaXBwZWQgb2ZmLiBPbiBjbG9zZXIgaW5zcGVjdGlvbiBob3dldmVyLCB5b3Ugbm90aWNlIHRoYXQgaXRzIGVhcnJpbmdzIChpdCdzIHdlYXJpbmcgZWFycmluZ3MpIGFyZSBhY3R1YWxseSBmdWxseSBmdW5jdGlvbmFsIGNvcGllcyBvZiBpdHNlbGYsIGVhY2ggb2Ygd2hpY2ggYWxzbyB3ZWFyaW5nIHRoZWlyIG93biBjb3cgZWFycmluZ3MsIGFuZCBzbyBvbiwgaW5maW5pdGVseS4gSXQgYXBwZWFycyB5b3VyIGRhaXJ5IGNvbmNlcm5zIHdpbGwgYmUgdGFrZW4gY2FyZSBvZiBmb3IgYSB3aGlsZSwgYWx0aG91Z2ggeW91J2xsIGhhdmUgdG8gcHV0IHVwIHdpdGggdGhlIGNvdydzIGFubm95aW5nIHNuaWNrZXJpbmcuPC9xPiIsCiAgICAgICJGcmFjdGFsIGVuZ2luZSIsCiAgICAgIDYKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJDaG9jb2xhdGUgb3Vyb2Jvcm9zIiwKICAgICAgIjxxPkZvcmV2ZXIgZWF0aW5nIGl0cyBvd24gdGFpbCBhbmQgZGlnZXN0aW5nIGl0c2VsZiwgaW4gYSBtZXRhYm9saWNhbGx5IGR1YmlvdXMgdGFsZSBvZiBkZWxpY2lvdXMgdHJhZ2VkeS48L3E+IiwKICAgICAgIkZyYWN0YWwgZW5naW5lIiwKICAgICAgNwogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIk5lc3RlZCIsCiAgICAgICI8cT5DbGV2ZXIgc2VsZi1yZWZlcmVuY2Ugb3Igc2hhbWVmdWwgY3Jvc3MtcHJvbW90aW9uPyBUaGlzIHVwZ3JhZGUgYXBwYXJlbnRseSBoYXMgdGhlIGdhbGwgdG8gYWR2ZXJ0aXNlIGEgbGluayB0byA8dT5vcnRlaWwuZGFzaG5ldC5vcmcvbmVzdGVkPC91PiwgaW4gYSB0b29sdGlwIHlvdSBjYW4ndCBldmVuIGNsaWNrLjwvcT4iLAogICAgICAiRnJhY3RhbCBlbmdpbmUiLAogICAgICA4CiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiU3BhY2UtZmlsbGluZyBmaWJlcnMiLAogICAgICAiPHE+VGhpcyBzcGVjaWFsIGluZ3JlZGllbnQgaGFzIHRoZSBpbmNyZWRpYmxlIGFiaWxpdHkgdG8gZmlsbCB0aGUgbG9jYWwgc3BhY2UgcGVyZmVjdGx5LCBlZmZlY3RpdmVseSBlcmFkaWNhdGluZyBodW5nZXIgaW4gdGhvc2Ugd2hvIGNvbnN1bWUgaXQhPGJyPktub3dpbmcgdGhhdCBubyBodW5nZXIgbWVhbnMgbm8gbmVlZCBmb3IgY29va2llcywgeW91ciBtYXJrZXRlcnMgdXJnZSB5b3UgdG8gcmVwdXJwb3NlIHRoaXMgcHJvZHVjdCBpbnRvIG5leHQtbGV2ZWwgcGFja2luZyBwZWFudXRzLjwvcT4iLAogICAgICAiRnJhY3RhbCBlbmdpbmUiLAogICAgICA5CiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKCJFbmRsZXNzIGJvb2sgb2YgcHJvc2UiLCAiIiwgIkZyYWN0YWwgZW5naW5lIiwgMTApOwogICAgaWYgKEVOKSB7CiAgICAgIEdhbWUubGFzdC5kZXNjRnVuYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgc3RyID0KICAgICAgICAgICciVGhlcmUgb25jZSB3YXMgYSBiYWtlciBuYW1lZCAnICsKICAgICAgICAgIEdhbWUuYmFrZXJ5TmFtZSArCiAgICAgICAgICAiLiBPbmUgZGF5LCB0aGVyZSB3YXMgYSBrbm9jayBhdCB0aGUgZG9vcjsgIiArCiAgICAgICAgICBHYW1lLmJha2VyeU5hbWUgKwogICAgICAgICAgIiBvcGVuZWQgaXQgYW5kIHdhcyBzdWRkZW5seSBmYWNlLXRvLWZhY2Ugd2l0aCBhIHN0cmFuZ2UgYW5kIG1lbmFjaW5nIG9sZCBncmFuZG1hLiBUaGUgZ3JhbmRtYSBvcGVuZWQgaGVyIG1vdXRoIGFuZCwgaW4gYSBzdHJhbmdlIGxpdHRsZSB2b2ljZSwgc3RhcnRlZCByZWNpdGluZyB0aGlzIHN0cmFuZ2UgbGl0dGxlIHRhbGUgOiAiOwogICAgICAgIHZhciBuID0gMzU7CiAgICAgICAgdmFyIGkgPSBNYXRoLmZsb29yKEdhbWUuVCAqIDAuMSk7CiAgICAgICAgcmV0dXJuICgKICAgICAgICAgIHRoaXMuZGVzYyArCiAgICAgICAgICAnPHEgc3R5bGU9ImZvbnQtZmFtaWx5OkNvdXJpZXI7Ij4nICsKICAgICAgICAgIChzdHIuc3Vic3RyKGkgJSBzdHIubGVuZ3RoLCBuKSArCiAgICAgICAgICAgIChpICUgc3RyLmxlbmd0aCA+IHN0ci5sZW5ndGggLSBuCiAgICAgICAgICAgICAgPyBzdHIuc3Vic3RyKDAsIChpICUgc3RyLmxlbmd0aCkgLSAoc3RyLmxlbmd0aCAtIG4pKQogICAgICAgICAgICAgIDogIiIpKSArCiAgICAgICAgICAiPC9xPiIKICAgICAgICApOwogICAgICB9OwogICAgfSBlbHNlIEdhbWUubGFzdC5kZXNjID0gIjxxPi08L3E+IjsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRoZSBzZXQgb2YgYWxsIHNldHMiLAogICAgICAiPHE+VGhlIGFuc3dlciwgb2YgY291cnNlLCBpcyBhIGRlZmluaXRlIG1heWJlLjwvcT4iLAogICAgICAiRnJhY3RhbCBlbmdpbmUiLAogICAgICAxMQogICAgKTsKCiAgICBvcmRlciA9IDUwMDA7CiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlKAogICAgICAiUmVjdXJzaXZlIG1pcnJvcnMiLAogICAgICAiPHE+RG8geW91IGhhdmUgYW55IGlkZWEgd2hhdCBoYXBwZW5zIHdoZW4geW91IHBvaW50IHR3byBvZiB0aGVzZSBhdCBlYWNoIG90aGVyPyBBcHBhcmVudGx5LCB0aGUgdW5pdmVyc2UgZG9lc24ndCBlaXRoZXIuPC9xPiIsCiAgICAgICJGcmFjdGFsIGVuZ2luZSIsCiAgICAgICJQcmlzbSIsCiAgICAgICJzeW5lcmd5MSIKICAgICk7CiAgICAvL0dhbWUuU3luZXJneVVwZ3JhZGUoJ0NvbXBvdW5kZWQgb2RkcycsJzxxPldoZW4gcHJvYmFiaWxpdGllcyBzdGFydCBjYXNjYWRpbmcsICJuZXZlciBpbiBhIGJpbGxpb24gbGlmZXRpbWVzIiBzdGFydHMgbG9va2luZyB0ZXJyaWJseSBsaWtlICJwcm9iYWJseSBiZWZvcmUgTW9uZGF5IGNvbWVzIGFyb3VuZCIuPC9xPicsJ0ZyYWN0YWwgZW5naW5lJywnQ2hhbmNlbWFrZXInLCdzeW5lcmd5MScpOwogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIk1pY2UgY2xpY2tpbmcgbWljZSIsCiAgICAgICIiLAogICAgICAiRnJhY3RhbCBlbmdpbmUiLAogICAgICAiQ3Vyc29yIiwKICAgICAgInN5bmVyZ3kyIgogICAgKTsKICAgIGlmIChFTikgewogICAgICBHYW1lLmxhc3QuZGVzY0Z1bmMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgTWF0aC5zZWVkcmFuZG9tKEdhbWUuc2VlZCArICItYmxhc3BoZW1vdXNlIik7CiAgICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPCAwLjMpIHsKICAgICAgICAgIE1hdGguc2VlZHJhbmRvbSgpOwogICAgICAgICAgcmV0dXJuIHRoaXMuZGVzYyArICI8cT5BYnNvbHV0ZWx5IGJsYXNwaGVtb3VzZSE8L3E+IjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgTWF0aC5zZWVkcmFuZG9tKCk7CiAgICAgICAgICByZXR1cm4gdGhpcy5kZXNjICsgIjxxPkFic29sdXRlbHkgYmxhc3BoZW1vdXMhPC9xPiI7CiAgICAgICAgfQogICAgICB9OwogICAgfSBlbHNlIEdhbWUubGFzdC5kZXNjID0gIjxxPi08L3E+IjsKCiAgICBvcmRlciA9IDEwMDIwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkN1c3RhcmQgY3JlYW1zIiwKICAgICAgZGVzYzogIkJyaXRpc2ggbG9yZSBwaXRzIHRoZXNlIGluIGEgbWVyY2lsZXNzIHdhciBhZ2FpbnN0IGJvdXJib24gYmlzY3VpdHMuPGJyPlRoZSBmaWxsaW5nIGV2b2tlcyB2YW5pbGxhIHdpdGhvdXQgcXVpdGUgYXBwcm9hY2hpbmcgaXQuPGJyPlRoZXkncmUgdGFzdGllciBvbiB0aGUgaW5zaWRlISIsCiAgICAgIGljb246IFsyMywgMjldLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQm91cmJvbiBiaXNjdWl0cyIsCiAgICAgIGRlc2M6ICJUd28gY2hvY29sYXRlIGJpc2N1aXRzIGpvaW5lZCB0b2dldGhlciB3aXRoIGV2ZW4gbW9yZSBjaG9jb2xhdGUuPGJyPlRoZSBzd29ybiByaXZhbHMgb2YgY3VzdGFyZCBjcmVhbXMsIGFzIGxlZ2VuZCBoYXMgaXQuIiwKICAgICAgaWNvbjogWzI0LCAyOV0sCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiS2VlcHNha2VzIiwKICAgICAgbG9jKAogICAgICAgICJTZWFzb25hbCByYW5kb20gZHJvcHMgaGF2ZSBhIDxiPjEvNSBjaGFuY2U8L2I+IHRvIGNhcnJ5IG92ZXIgdGhyb3VnaCBhc2NlbnNpb25zLiIKICAgICAgKSArICI8cT5DaGVyaXNoIHRoZSBtZW1vcmllcy48L3E+IiwKICAgICAgMTExMTExMTExMSwKICAgICAgWzIyLCAyOV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsKICAgICAgIlN0YXJzbm93IiwKICAgICAgIlN0YXJsb3ZlIiwKICAgICAgIlN0YXJ0ZXJyb3IiLAogICAgICAiU3RhcnRyYWRlIiwKICAgICAgIlN0YXJzcGF3biIsCiAgICBdOwoKICAgIG9yZGVyID0gMTAwMjA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiTWluaS1jb29raWVzIiwKICAgICAgZGVzYzogIkhhdmUgeW91IGV2ZXIgbm90aWNlZCBob3cgdGhlIHNtYWxsZXIgc29tZXRoaW5nIGlzLCB0aGUgZWFzaWVyIGl0IGlzIHRvIGJpbmdlIG9uIGl0PyIsCiAgICAgIGljb246IFsyOSwgMzBdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTdWdhciBjcnlzdGFsIGNvb2tpZXMiLAogICAgICAoRU4KICAgICAgICA/ICJDb29raWUgcHJvZHVjdGlvbiBtdWx0aXBsaWVyIDxiPis1JSBwZXJtYW5lbnRseTwvYj4sIGFuZCA8Yj4rMSU8L2I+IGZvciBldmVyeSBidWlsZGluZyB0eXBlIGxldmVsIDEwIG9yIGhpZ2hlci4iCiAgICAgICAgOiBsb2MoIkNvb2tpZSBwcm9kdWN0aW9uIG11bHRpcGxpZXIgPGI+KyUxJSBwZXJtYW5lbnRseTwvYj4uIiwgNSkgKwogICAgICAgICAgIjxicj4iICsKICAgICAgICAgIGxvYygKICAgICAgICAgICAgIkNvb2tpZSBwcm9kdWN0aW9uIG11bHRpcGxpZXIgPGI+KyUxJTwvYj4gZm9yIGV2ZXJ5IGJ1aWxkaW5nIHR5cGUgbGV2ZWwgJTIgb3IgaGlnaGVyLiIsCiAgICAgICAgICAgIFsxLCAxMF0KICAgICAgICAgICkpICsKICAgICAgICAiPHE+SW5mdXNlZCB3aXRoIGNvc21pYyBzd2VldG5lc3MuIEl0IGdpdmVzIG9mZiBhIGZhaW50IHNoaW1tZXJ5IHNvdW5kIHdoZW4geW91IGhvbGQgaXQgdXAgdG8geW91ciBlYXIuPC9xPiIsCiAgICAgIDEwMDAwMDAwMDAsCiAgICAgIFsyMSwgMzBdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIlN1Z2FyIGJha2luZyJdOwogICAgR2FtZS5sYXN0LnBvd2VyID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgbiA9IDU7CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKSB7CiAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1tpXS5sZXZlbCA+PSAxMCkgbisrOwogICAgICB9CiAgICAgIHJldHVybiBuOwogICAgfTsKICAgIEdhbWUubGFzdC5wc2V1ZG9Db29raWUgPSB0cnVlOwogICAgR2FtZS5sYXN0LmRlc2NGdW5jID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgbiA9IDU7CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKSB7CiAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1tpXS5sZXZlbCA+PSAxMCkgbisrOwogICAgICB9CiAgICAgIHJldHVybiAoCiAgICAgICAgJzxkaXYgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyI+JyArCiAgICAgICAgbG9jKCJDdXJyZW50OiIpICsKICAgICAgICAiIDxiPisiICsKICAgICAgICBCZWF1dGlmeShuKSArCiAgICAgICAgJyU8L2I+PGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+PC9kaXY+JyArCiAgICAgICAgdGhpcy5kZGVzYwogICAgICApOwogICAgfTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJCb3ggb2YgbWF5YmUgY29va2llcyIsCiAgICAgIGxvYygiQ29udGFpbnMgYW4gYXNzb3J0bWVudCBvZi4uLnNvbWV0aGluZy4iKSArCiAgICAgICAgIjxxPlRoZXNlIG1heSBvciBtYXkgbm90IGJlIGNvbnNpZGVyZWQgY29va2llcy48L3E+IiwKICAgICAgMzMzMDAwMDAwMDAwLAogICAgICBbMjUsIDI5XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJTdWdhciBjcnlzdGFsIGNvb2tpZXMiXTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJCb3ggb2Ygbm90IGNvb2tpZXMiLAogICAgICBsb2MoIkNvbnRhaW5zIGFuIGFzc29ydG1lbnQgb2YuLi5zb21ldGhpbmcuIikgKwogICAgICAgICI8cT5UaGVzZSBhcmUgc3RyaWN0bHksIGRlZmluaXRlbHkgbm90IGNvb2tpZXMuPC9xPiIsCiAgICAgIDMzMzAwMDAwMDAwMCwKICAgICAgWzI2LCAyOV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiU3VnYXIgY3J5c3RhbCBjb29raWVzIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQm94IG9mIHBhc3RyaWVzIiwKICAgICAgbG9jKCJDb250YWlucyBhbiBhc3NvcnRtZW50IG9mIGRlbGljaW91cyBwYXN0cmllcy4iKSArCiAgICAgICAgIjxxPlRoZXNlIGFyZSBhIGRhbW4gc2xpcHBlcnkgc2xvcGUgaXMgd2hhdCB0aGV5IGFyZSE8L3E+IiwKICAgICAgMzMzMDAwMDAwMDAwLAogICAgICBbMjcsIDI5XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJTdWdhciBjcnlzdGFsIGNvb2tpZXMiXTsKCiAgICBvcmRlciA9IDEwMDQwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlByb2ZpdGVyb2xlcyIsCiAgICAgIGRlc2M6ICJBbHNvIGtub3duIGFzIGNyZWFtIHB1ZmZzLCB0aGVzZSBwYXN0cmllcyBhcmUgbGlnaHQsIGZsdWZmeSwgZmlsbGVkIHdpdGggd2hpcHBlZCBjcmVhbSBhbmQgZnVuIHRvIHRocm93IGF0IHBlb3BsZSB3aGVuIHNub3diYWxscyBhcmUgcnVubmluZyBzY2FyY2UuIiwKICAgICAgaWNvbjogWzI5LCAyOV0sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgcGFzdHJpZXMiLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IE1hdGgucG93KDEwLCAzMSksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJKZWxseSBkb251dCIsCiAgICAgIGRlc2M6ICJHdWFyYW50ZWVkIHRvIGNvbnRhaW4gYXQgbGVhc3QgMC4zJSBqZWxseSBmaWxsaW5nLCBvciB5b3VyIG1vbmV5IGJhY2suPGJyPllvdSBjYW4gc3RpbGwgc2VlIHRoZSBqZWxseSBzdGFiIHdvdW5kISIsCiAgICAgIGljb246IFsyNywgMjhdLAogICAgICByZXF1aXJlOiAiQm94IG9mIHBhc3RyaWVzIiwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiBNYXRoLnBvdygxMCwgMzMpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiR2xhemVkIGRvbnV0IiwKICAgICAgZGVzYzogIkFic29sdXRlbHkgZ29vZXkgd2l0aCBzdWdhci4gVGhlIGhvbGUgaXMgdGhlIHRhc3RpZXN0IHBhcnQhIiwKICAgICAgaWNvbjogWzI4LCAyOF0sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgcGFzdHJpZXMiLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IE1hdGgucG93KDEwLCAzNSksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJDaG9jb2xhdGUgY2FrZSIsCiAgICAgIGRlc2M6ICJUaGUgY2FrZSBpcyBhIFBvcnRhbCByZWZlcmVuY2UhIiwKICAgICAgaWNvbjogWzI1LCAyN10sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgcGFzdHJpZXMiLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IE1hdGgucG93KDEwLCAzNyksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJTdHJhd2JlcnJ5IGNha2UiLAogICAgICBkZXNjOiAiSXQncyBub3QgZWFzeSB0byBjb21lIHVwIHdpdGggZmxhdm9yIHRleHQgZm9yIHNvbWV0aGluZyBhcyBnZW5lcmljIGFzIHRoaXMsIGJ1dCBzb21lIHdvdWxkIHNheSBpdCdzIGEgcGllY2Ugb2YgY2FrZS4iLAogICAgICBpY29uOiBbMjYsIDI3XSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBwYXN0cmllcyIsCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogTWF0aC5wb3coMTAsIDM5KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkFwcGxlIHBpZSIsCiAgICAgIGRlc2M6ICJJdCBpcyBzYWlkIHRoYXQgc29tZSBncmFuZG1hcyBnbyByb2d1ZSBhbmQgYmFrZSB0aGVzZSBpbnN0ZWFkLiIsCiAgICAgIGljb246IFsyNSwgMjhdLAogICAgICByZXF1aXJlOiAiQm94IG9mIHBhc3RyaWVzIiwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiBNYXRoLnBvdygxMCwgNDEpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiTGVtb24gbWVyaW5ndWUgcGllIiwKICAgICAgZGVzYzogIk1lcmluZ3VlIGlzIGEgZmluaWNreSBzdWJzdGFuY2UgbWFkZSBvZiBzdWdhciBhbmQgZWdnIHdoaXRlcyB0aGF0IHJlcXVpcmVzIHNwZWNpZmljIGF0bW9zcGhlcmljIGNvbmRpdGlvbnMgdG8gYmUgYmFrZWQgYXQgYWxsLiBUaGUgbGVtb24sIGFzIGZhciBhcyB3ZSBjYW4gdGVsbCwgaXNuJ3QgbmVhcmx5IGFzIHBpY2t5LiIsCiAgICAgIGljb246IFsyNiwgMjhdLAogICAgICByZXF1aXJlOiAiQm94IG9mIHBhc3RyaWVzIiwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiBNYXRoLnBvdygxMCwgNDMpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQnV0dGVyIGNyb2lzc2FudCIsCiAgICAgIGRlc2M6ICJMb29rIGFyb3VuZC48YnI+QSBydWRlIG1hbiBpbiBhIHN0cmlwZWQgc2hpcnQgYmlrZXMgcGFzdCB5b3UuIEhlIHNtZWxscyBvZiBjaWdhcmV0dGVzIGFuZCBjYWYmZWFjdXRlOy1hdS1sYWl0LiBTb21ld2hlcmUsIGEgbWltZSB1c2VzIGhpcyBtb3VzdGFjaGUgdG8gbWFrZSBmdW4gb2YgdGhlIEJyaXRpc2guIDMwMCBwaWdlb25zIGZseSBvdmVyaGVhZC48YnI+UmVsYXguIFlvdSdyZSBleHBlcmllbmNpbmcgY3JvaXNzYW50LiIsCiAgICAgIGljb246IFsyOSwgMjhdLAogICAgICByZXF1aXJlOiAiQm94IG9mIHBhc3RyaWVzIiwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiBNYXRoLnBvdygxMCwgNDUpLAogICAgfSk7CgogICAgb3JkZXIgPSAxMDA1MDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJDb29raWUgZG91Z2giLAogICAgICBkZXNjOiAiQnVyc3Rpbmcgd2l0aCBpbmZpbml0ZSBwb3RlbnRpYWwsIGJ1dCBjYW4gYWxzbyBiZSBlYXRlbiBhcyBpcy4gQXJndWFibHkgd29ydGggdGhlIHNhbG1vbmVsbGEuIiwKICAgICAgaWNvbjogWzI1LCAzMF0sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgbWF5YmUgY29va2llcyIsCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogTWF0aC5wb3coMTAsIDM1KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkJ1cm50IGNvb2tpZSIsCiAgICAgIGRlc2M6ICJUaGlzIGNvb2tpZSBmbGV3IHRvbyBjbG9zZSB0byB0aGUgc3VuIGFuZCBpcyBub3cgYSBzaGFkb3cgb2YgaXRzIGZvcm1lciBzZWxmLiBJZiBvbmx5IHlvdSByZW1lbWJlcmVkIHRvIHNldCBhIHRpbWVyLCB5b3Ugd291bGRuJ3QgaGF2ZSB0aGlzIHRyYWdlZHkgb24geW91ciBoYW5kcy4uLiIsCiAgICAgIGljb246IFsyMywgMzBdLAogICAgICByZXF1aXJlOiAiQm94IG9mIG1heWJlIGNvb2tpZXMiLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IE1hdGgucG93KDEwLCAzNyksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJBIGNob2NvbGF0ZSBjaGlwIGNvb2tpZSBidXQgd2l0aCB0aGUgY2hpcHMgcGlja2VkIG9mZiBmb3Igc29tZSByZWFzb24iLAogICAgICBkZXNjOiAiVGhpcyBoYXMgdG8gYmUgdGhlIHNhZGRlc3QgdGhpbmcgeW91J3ZlIGV2ZXIgc2Vlbi4iLAogICAgICBpY29uOiBbMjQsIDMwXSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBtYXliZSBjb29raWVzIiwKICAgICAgcG93ZXI6IDMsCiAgICAgIHByaWNlOiBNYXRoLnBvdygxMCwgMzkpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiRmxhdm9yIHRleHQgY29va2llIiwKICAgICAgZGVzYzogIldoYXQgeW91J3JlIGN1cnJlbnRseSByZWFkaW5nIGlzIHdoYXQgZ2l2ZXMgdGhpcyBjb29raWUgaXRzIGluaW1pdGFibGUgZmxhdm9yLiIsCiAgICAgIGljb246IFsyMiwgMzBdLAogICAgICByZXF1aXJlOiAiQm94IG9mIG1heWJlIGNvb2tpZXMiLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IE1hdGgucG93KDEwLCA0MSksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJIaWdoLWRlZmluaXRpb24gY29va2llIiwKICAgICAgZGVzYzogIlVuY29tZm9ydGFibHkgZGV0YWlsZWQsIGxpa2UgdGhvc2Ugd2VpcmQgc3RvcmllcyB5b3VyIGF1bnQga2VlcHMgdGVsbGluZyBhdCBwYXJ0aWVzLiIsCiAgICAgIGljb246IFsyOCwgMTBdLAogICAgICByZXF1aXJlOiAiQm94IG9mIG1heWJlIGNvb2tpZXMiLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IE1hdGgucG93KDEwLCA0MyksCiAgICB9KTsKCiAgICBvcmRlciA9IDEwMDYwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlRvYXN0IiwKICAgICAgZGVzYzogIkEgY3Jpc3Agc2xpY2Ugb2YgYnJlYWQsIGJlZ2dpbmcgZm9yIHNvbWUgYnV0dGVyIGFuZCBqYW0uPGJyPldoeSBkbyBwZW9wbGUga2VlcCBwcm9wb3NpbmcgdGhlc2UgYXQgcGFydGllcz8iLAogICAgICBpY29uOiBbMjcsIDEwXSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBub3QgY29va2llcyIsCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogTWF0aC5wb3coMTAsIDM0KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlBlYW51dCBidXR0ZXIgJiBqZWxseSIsCiAgICAgIGRlc2M6ICJJdCdzIHRpbWUuIiwKICAgICAgaWNvbjogWzI5LCA5XSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBub3QgY29va2llcyIsCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogTWF0aC5wb3coMTAsIDM2KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIldvb2tpZXMiLAogICAgICBkZXNjOiAiVGhlc2UgYXJlbid0IHRoZSBjb29raWVzIHlvdSdyZSBsb29raW5nIGZvci4iLAogICAgICBpY29uOiBbMjYsIDMwXSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBub3QgY29va2llcyIsCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogTWF0aC5wb3coMTAsIDM4KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkNoZWVzZWJ1cmdlciIsCiAgICAgIGRlc2M6ICJBYnNvbHV0ZWx5IG5vIHJlbGF0aW9uIHRvIGNvb2tpZXMgd2hhdHNvZXZlciAtIE9ydGVpbCBqdXN0IHdhbnRlZCBhbiBleGN1c2UgdG8gZHJhdyBhIGNoZWVzZWJ1cmdlci4iLAogICAgICBpY29uOiBbMjgsIDMwXSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBub3QgY29va2llcyIsCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogTWF0aC5wb3coMTAsIDQwKSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIk9uZSBsb25lIGNob2NvbGF0ZSBjaGlwIiwKICAgICAgZGVzYzogIlRoZSBzdGFydCBvZiBzb21ldGhpbmcgYmVhdXRpZnVsLiIsCiAgICAgIGljb246IFsyNywgMzBdLAogICAgICByZXF1aXJlOiAiQm94IG9mIG5vdCBjb29raWVzIiwKICAgICAgcG93ZXI6IDEsCiAgICAgIHByaWNlOiBNYXRoLnBvdygxMCwgNDIpLAogICAgfSk7CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkdlbml1cyBhY2NvdW50aW5nIiwKICAgICAgbG9jKAogICAgICAgICJVbmxvY2tzIDxiPmV4dHJhIHByaWNlIGluZm9ybWF0aW9uPC9iPi48YnI+RWFjaCBkaXNwbGF5ZWQgY29zdCBub3cgc3BlY2lmaWVzIGhvdyBsb25nIGl0J2xsIHRha2UgeW91IHRvIGFmZm9yZCBpdCwgYW5kIGhvdyBtdWNoIG9mIHlvdXIgYmFuayBpdCByZXByZXNlbnRzLiIKICAgICAgKSArICI8cT5UaGVyZSdzIG5vIGFjY291bnRpbmcgZm9yIHRhc3RlLCBhbmQgeWV0IGhlcmUgd2UgYXJlLjwvcT4iLAogICAgICAyMDAwMDAwLAogICAgICBbMTEsIDEwXQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJJbnNwaXJlZCBjaGVja2xpc3QiXTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiU2hpbW1lcmluZyB2ZWlsIiwKICAgICAgbG9jKAogICAgICAgICJVbmxvY2tzIHRoZSA8Yj5zaGltbWVyaW5nIHZlaWw8L2I+LCBhIHN3aXRjaCB0aGF0IHBhc3NpdmVseSBib29zdHMgeW91ciBDcFMgYnkgPGI+JTElPC9iPi48YnI+WW91IHN0YXJ0IHdpdGggdGhlIHZlaWwgdHVybmVkIG9uOyBob3dldmVyLCBpdCBpcyB2ZXJ5IGZyYWdpbGUsIGFuZCBjbGlja2luZyB0aGUgYmlnIGNvb2tpZSBvciBhbnkgZ29sZGVuIGNvb2tpZSBvciByZWluZGVlciB3aWxsIHR1cm4gaXQgb2ZmLCByZXF1aXJpbmcgJTIgb2YgQ3BTIHRvIHR1cm4gYmFjayBvbi4iLAogICAgICAgIFs1MCwgR2FtZS5zYXlUaW1lKDI0ICogNjAgKiA2MCAqIEdhbWUuZnBzLCAyKV0KICAgICAgKSArICI8cT5IYW5kcyBvZmYhPC9xPiIsCiAgICAgIDk5OTk5OTk5OSwKICAgICAgWzksIDEwXQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJEaXN0aWxsZWQgZXNzZW5jZSBvZiByZWRvdWJsZWQgbHVjayJdOwoKICAgIG9yZGVyID0gNDAwMDU7CiAgICB2YXIgZnVuYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGJvb3N0ID0gR2FtZS5nZXRWZWlsQm9vc3QoKTsKICAgICAgdmFyIHJlc2lzdCA9IEdhbWUuZ2V0VmVpbERlZmVuc2UoKTsKICAgICAgcmV0dXJuICgKICAgICAgICAodGhpcy5uYW1lID09ICJTaGltbWVyaW5nIHZlaWwgW29uXSIKICAgICAgICAgID8gJzxkaXYgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyI+JyArCiAgICAgICAgICAgIGxvYygiQWN0aXZlLiIpICsKICAgICAgICAgICAgJzwvZGl2PjxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicKICAgICAgICAgIDogIiIpICsKICAgICAgICBsb2MoCiAgICAgICAgICAiQm9vc3RzIHlvdXIgY29va2llIHByb2R1Y3Rpb24gYnkgPGI+JTElPC9iPiB3aGVuIGFjdGl2ZS48YnI+VGhlIHZlaWwgaXMgdmVyeSBmcmFnaWxlIGFuZCB3aWxsIGJyZWFrIGlmIHlvdSBjbGljayB0aGUgYmlnIGNvb2tpZSBvciBhbnkgZ29sZGVuIGNvb2tpZXMgb3IgcmVpbmRlZXIuPGJyPjxicj5PbmNlIGJyb2tlbiwgdHVybmluZyB0aGUgdmVpbCBiYWNrIG9uIGNvc3RzICUyIG9mIHVuYnVmZmVkIENwUy4iLAogICAgICAgICAgW0JlYXV0aWZ5KGJvb3N0ICogMTAwKSwgR2FtZS5zYXlUaW1lKDI0ICogNjAgKiA2MCAqIEdhbWUuZnBzLCAyKV0KICAgICAgICApICsKICAgICAgICAocmVzaXN0ID4gMAogICAgICAgICAgPyAiPGJyPjxicj4iICsKICAgICAgICAgICAgbG9jKCJIYXMgYSA8Yj4lMSU8L2I+IGNoYW5jZSB0byBub3QgYnJlYWsuIiwgQmVhdXRpZnkocmVzaXN0ICogMTAwKSkKICAgICAgICAgIDogIiIpCiAgICAgICk7CiAgICB9OwogICAgbmV3IEdhbWUuVXBncmFkZSgiU2hpbW1lcmluZyB2ZWlsIFtvZmZdIiwgIiIsIDEwMDAwMDAsIFs5LCAxMF0pOwogICAgR2FtZS5sYXN0LnBvb2wgPSAidG9nZ2xlIjsKICAgIEdhbWUubGFzdC50b2dnbGVJbnRvID0gIlNoaW1tZXJpbmcgdmVpbCBbb25dIjsKICAgIEdhbWUubGFzdC5wcmljZUZ1bmMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBHYW1lLnVuYnVmZmVkQ3BzICogNjAgKiA2MCAqIDI0OwogICAgfTsKICAgIEdhbWUubGFzdC5kZXNjRnVuYyA9IGZ1bmM7CiAgICBuZXcgR2FtZS5VcGdyYWRlKCJTaGltbWVyaW5nIHZlaWwgW29uXSIsICIiLCAwLCBbOSwgMTBdKTsKICAgIEdhbWUubGFzdC5wb29sID0gInRvZ2dsZSI7CiAgICBHYW1lLmxhc3QudG9nZ2xlSW50byA9ICJTaGltbWVyaW5nIHZlaWwgW29mZl0iOwogICAgR2FtZS5sYXN0LmRlc2NGdW5jID0gZnVuYzsKCiAgICBHYW1lLmxvc2VTaGltbWVyaW5nVmVpbCA9IGZ1bmN0aW9uIChjb250ZXh0KSB7CiAgICAgIGlmICghR2FtZS5IYXMoIlNoaW1tZXJpbmcgdmVpbCIpKSByZXR1cm4gZmFsc2U7CiAgICAgIGlmICgKICAgICAgICAhR2FtZS5IYXMoIlNoaW1tZXJpbmcgdmVpbCBbb2ZmXSIpICYmCiAgICAgICAgR2FtZS5IYXMoIlNoaW1tZXJpbmcgdmVpbCBbb25dIikKICAgICAgKQogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgaWYgKEdhbWUuSGFzKCJSZWluZm9yY2VkIG1lbWJyYW5lIikpIHsKICAgICAgICBpZiAoY29udGV4dCA9PSAic2hpbW1lciIpCiAgICAgICAgICBNYXRoLnNlZWRyYW5kb20oCiAgICAgICAgICAgIEdhbWUuc2VlZCArICIvIiArIChHYW1lLmdvbGRlbkNsaWNrcyArIEdhbWUucmVpbmRlZXJDbGlja2VkKQogICAgICAgICAgKTsKICAgICAgICBlbHNlIGlmIChjb250ZXh0ID09ICJjbGljayIpCiAgICAgICAgICBNYXRoLnNlZWRyYW5kb20oR2FtZS5zZWVkICsgIi8iICsgR2FtZS5jb29raWVDbGlja3MpOwogICAgICAgIGlmIChNYXRoLnJhbmRvbSgpIDwgR2FtZS5nZXRWZWlsRGVmZW5zZSgpKSB7CiAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgbG9jKCJUaGUgcmVpbmZvcmNlZCBtZW1icmFuZSBwcm90ZWN0cyB0aGUgc2hpbW1lcmluZyB2ZWlsLiIpLAogICAgICAgICAgICAiIiwKICAgICAgICAgICAgWzcsIDEwXQogICAgICAgICAgKTsKICAgICAgICAgIEdhbWUuV2luKCJUaGljay1za2lubmVkIik7CiAgICAgICAgICBNYXRoLnNlZWRyYW5kb20oKTsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgTWF0aC5zZWVkcmFuZG9tKCk7CiAgICAgIH0KICAgICAgdmFyIG1lID0gR2FtZS5VcGdyYWRlc1siU2hpbW1lcmluZyB2ZWlsIFtvbl0iXTsKICAgICAgbWUuYm91Z2h0ID0gMTsKICAgICAgLy9HYW1lLlVwZ3JhZGVzW21lLnRvZ2dsZUludG9dLmJvdWdodD1mYWxzZTsKICAgICAgR2FtZS5Mb2NrKG1lLnRvZ2dsZUludG8pOwogICAgICBHYW1lLlVubG9jayhtZS50b2dnbGVJbnRvKTsKICAgICAgR2FtZS5Ob3RpZnkobG9jKCJUaGUgc2hpbW1lcmluZyB2ZWlsIGRpc2FwcGVhcnMuLi4iKSwgIiIsIFs5LCAxMF0pOwogICAgICBHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkID0gMTsKICAgICAgR2FtZS5yZWNhbGN1bGF0ZUdhaW5zID0gMTsKICAgICAgUGxheVNvdW5kKCJzbmQvc3BlbGxGYWlsLm1wMyIsIDAuNzUpOwogICAgfTsKCiAgICB2YXIgZ2V0Q29va2llUHJpY2UgPSBmdW5jdGlvbiAobGV2ZWwpIHsKICAgICAgcmV0dXJuICgKICAgICAgICA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiBNYXRoLnBvdygxMCwgKGxldmVsIC0gMSkgLyAyKQogICAgICApOwogICAgfTsKCiAgICBvcmRlciA9IDEwMDIwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIldob29waWUgcGllcyIsCiAgICAgIGRlc2M6ICJUd28gY2hvY29sYXRlIGhhbHZlcyBqb2luZWQgdG9nZXRoZXIgYnkgYSBjcmVhbSBmaWxsaW5nLiBJdCdzIGdvdCBubyBleWVicm93cywgYnV0IHlvdSBuZXZlciBub3RpY2VkIHVudGlsIG5vdy4iLAogICAgICBpY29uOiBbMjEsIDMxXSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSgxKSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkNhcmFtZWwgd2FmZXIgYmlzY3VpdHMiLAogICAgICBkZXNjOiAiQ29hdGVkIGluIGRlbGljaW91cyBjaG9jb2xhdGUuIEFzIG1hbnkgbGF5ZXJzIGFzIHlvdSdsbCBnZXQgaW4gYSBiaXNjdWl0IHdpdGhvdXQgaW52b2x2aW5nIG9uaW9ucy4iLAogICAgICBpY29uOiBbMjIsIDMxXSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSgyKSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkNob2NvbGF0ZSBjaGlwIG1vY2hhIGNvb2tpZXMiLAogICAgICBkZXNjOiAiTW9jaGEgc3RhcnRlZCBvdXQgYXMgYW4gZXhjdXNlIHRvIHNtdWdnbGUgY2hvY29sYXRlIGludG8gY29mZmVlLiBBbmQgbm93LCBpbiBhIHBvaWduYW50IGRpc3BsYXkgb2YgZGlwbG9tYWN5IGFuZCBjdWx0dXJhbCBleGNoYW5nZSwgaXQncyBicmluZ2luZyBjb2ZmZWUgdG8gY2hvY29sYXRlIGNvb2tpZXMuIiwKICAgICAgaWNvbjogWzIzLCAzMV0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoMyksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJFYXJsIEdyZXkgY29va2llcyIsCiAgICAgIGRlc2M6ICJDYXB0YWluIFBpY2FyZCdzIGZhdm9yaXRlLiIsCiAgICAgIGljb246IFsyNCwgMzFdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDQpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQ29ybiBzeXJ1cCBjb29raWVzIiwKICAgICAgZGVzYzogIlRoZSBjb3JuIHN5cnVwIG1ha2VzIGl0IGV4dHJhIGNoZXd5LiBOb3QgdGhlIHR5cGUgb2Ygc3R1ZmYgeW91J2QgdGhpbmsgdG8gcHV0IGluIGEgY29va2llLCBidXQgYmFrZXJzIG1ha2UgZG8uIiwKICAgICAgaWNvbjogWzI1LCAzMV0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoNSksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJJY2Vib3ggY29va2llcyIsCiAgICAgIGRlc2M6ICJDYW4gYmUgcHJlcGFyZWQgaW4gYSB2YXJpZXR5IG9mIHNoYXBlcyB3aXRoIGEgdmFyaWV0eSBvZiBpbmdyZWRpZW50cy4gTWFkZSBieSBmcmVlemluZyBkb3VnaCBiZWZvcmUgYmFraW5nIGl0LCBtaXJyb3JpbmcgYSB0aW1lLXByb3ZlbiBtZWRpZXZhbCB0b3J0dXJlIHByYWN0aWNlLiBHb3R0YSBrZWVwIHRoZW0gZ3Vlc3NpbmcuIiwKICAgICAgaWNvbjogWzI2LCAzMV0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoNiksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJHcmFoYW0gY3JhY2tlcnMiLAogICAgICBkZXNjOiAiSW5zcGlyZWQgaW4gdGhlaXIgZGVzaWduIGJ5IHRoZSB3aXNoIHRvIGxpdmUgYSBsaWZlIG9mIGF1c3RlcmUgdGVtcGVyYW5jZSwgZnJlZSBmcm9tIHBsZWFzdXJlIG9yIGNoZWVyOyBpdCdzIG5vIHdvbmRlciB0aGVzZSBhcmUgc28gdGFzdHkuIiwKICAgICAgaWNvbjogWzI3LCAzMV0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoNyksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJIYXJkdGFjayIsCiAgICAgIGRlc2M6ICJFeHRyZW1lbHkgaGFyZCBhbmQsIGlmIHdlJ3JlIGJlaW5nIGhvbmVzdCwgZXh0cmVtZWx5IHRhY2suPGJyPklmIHlvdSdyZSBjb25zaWRlcmluZyBlYXRpbmcgdGhpcyBhcyBhIGZ1biBzbmFjaywgeW91IHByb2JhYmx5IGhhdmUgb3RoZXIgdGhpbmdzIHRvIHdvcnJ5IGFib3V0IHRoYW4gdGhpcyBnYW1lLCBsaWtlIGdldHRpbmcgc2N1cnZ5IG9yIHlvdXIgY3JldyBmb21lbnRpbmcgbXV0aW55LiIsCiAgICAgIGljb246IFsyOCwgMzFdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDgpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQ29ybmZsYWtlIGNvb2tpZXMiLAogICAgICBkZXNjOiAiVGhleSdyZSBncnJycnJyb292eSEgQ2FyZWZ1bCBub3QgdG8gbGV0IGl0IHNpdCBpbiB5b3VyIG1pbGsgdG9vIGxvbmcsIGxlc3QgeW91IGFjY2lkZW50YWxseSBlbmQgdXAgd2l0aCBhIGJvd2wgb2YgY2VyZWFsIGFuZCBnZXQgY29uZnVzZWQuIiwKICAgICAgaWNvbjogWzI5LCAzMV0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoOSksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJUb2Z1IGNvb2tpZXMiLAogICAgICBkZXNjOiAiVGhlcmUncyByZWFsbHkgdHdvIHdheXMgdG8gZ28gd2l0aCB0b2Z1IGNvb2tpbmc7IGVpdGhlciBpdCBhc3NlcnRzIGl0c2VsZiBpbiBwbGFpbiBzaWdodCBvciBpdCBjYW1vdWZsYWdlcyBpdHNlbGYgaW4gdGhlIG90aGVyIGluZ3JlZGllbnRzLiBUaGlzIGhhcHBlbnMgdG8gYmUgdGhlIGxhdHRlciwgYW5kIGFzIHN1Y2gsIHlvdSBjYW4ndCByZWFsbHkgdGVsbCB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIHRoaXMgYW5kIGEgcmVndWxhciBjb29raWUsIHNhdmUgZm9yIHRoYXQgb25lIHBpeGVsIG9uIHRoZSBsZWZ0LiIsCiAgICAgIGljb246IFszMCwgMzFdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDEwKSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkdsdXRlbi1mcmVlIGNvb2tpZXMiLAogICAgICBkZXNjOiAiTWFkZSB3aXRoIGJyb3duZWQgYnV0dGVyIGFuZCBtaWxrIHRvIGNsb3NlbHkgbWF0Y2ggdGhlIGFyY2hldHlwYWwgY2hvY29sYXRlIGNoaXAgY29va2llLjxicj5Gb3IgY2VsaWFjcywgYSBjaGFuY2UgdG8gaW5kdWxnZSBpbiBhIGRlbGljaW91cyByaXNrLWZyZWUgcGFzdHJ5LiBGb3Igb3RoZXJzLCBhIHN0cmFuZ2VseSB0aHJlYXRlbmluZyBjb25mZWN0aW9uIHdob3NlIGVtcHR5IGV5ZXMgd2lsbCBuZXZlciBrbm93IGhlYXZlbiBub3IgaGVsbC4iLAogICAgICBpY29uOiBbMzAsIDMwXSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSgxMCksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJSdXNzaWFuIGJyZWFkIGNvb2tpZXMiLAogICAgICBkZXNjOiAiQWxzbyBrbm93biBhcyBhbHBoYWJldCBjb29raWVzOyB3aGlsZSBtb3N0IGJha2VycyBmb2xsb3cgdGhlIHJlY2lwZSB0byB0aGUgbGV0dGVyLCBpdCBpcyBzYWlkIHRoYXQgc29tZSBzdWJzdGl0dXRlIHRoZSBmbG91ciBmb3Igc3BlbHQuIEJ1dCBkb24ndCB0YWtlIG15IHdvcmQgZm9yIGl0LiIsCiAgICAgIGljb246IFszMCwgMjldLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDExKSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkxlYmt1Y2hlbiIsCiAgICAgIGRlc2M6ICJEaXZlcnNlIGNvb2tpZXMgZnJvbSBHZXJtYW55LCBmcmFncmFudCB3aXRoIGhvbmV5IGFuZCBzcGljZXMsIG9mdGVuIGJha2VkIGFyb3VuZCBDaHJpc3RtYXMuPGJyPk9uY2Ugd29ybiBieSB3YXJyaW9ycyBvZiBvbGQgZm9yIHByb3RlY3Rpb24gaW4gYmF0dGxlLjxicj4rNSBTVFIsICsyMCUgbWFnaWMgcmVzaXN0YW5jZS4iLAogICAgICBpY29uOiBbMzAsIDI4XSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSgxMiksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJBYWNoZW5lciBQcmludGVuIiwKICAgICAgZGVzYzogIlRoZSBob25leSBvbmNlIHVzZWQgdG8gc3dlZXRlbiB0aGVzZSBnaW5nZXJicmVhZC1saWtlIHRyZWF0cyBoYXMgc2luY2UgYmVlbiBzd2FwcGVkIG91dCBmb3IgYmVldCBzdWdhciwgcHJvdmlkaW5nIGFub3RoZXIgc2FkIGV4YW1wbGUgb2YgcmVncmVzc2l2ZSBldm9sdXRpb24uIiwKICAgICAgaWNvbjogWzMwLCAyN10sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoMTMpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQ2FuaXN0cmVsbGkiLAogICAgICBkZXNjOiAiQSBkcnkgYmlzY3VpdCBmbGF2b3JlZCB3aXRoIGFuaXNlIGFuZCB3aW5lLCB0b3VnaCBsaWtlIHRoZSBwZW9wbGUgb2YgQ29yc2ljYSB3aGVyZSBpdCBjb21lcyBmcm9tLiIsCiAgICAgIGljb246IFszMCwgMjZdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDE0KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIk5pY2UgYmlzY3VpdHMiLAogICAgICBkZXNjOiAiTWFkZSB3aXRoIGNvY29udXQgYW5kIHBlcmZlY3Qgd2l0aCB0ZWEuIFRyYWNlcyBpdHMgb3JpZ2lucyB0byBhIEZyZW5jaCBjaXR5IHNvIG5pY2UgdGhleSBuYW1lZCBpdCB0aGF0LiIsCiAgICAgIGljb246IFszMCwgMjVdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDE1KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkZyZW5jaCBwdXJlIGJ1dHRlciBjb29raWVzIiwKICAgICAgZGVzYzogIllvdSBjYW4ndCB0ZWxsIHdoYXQncyBzdHJvbmdlciBjb21pbmcgb2ZmIHRoZXNlIC0gdGhlIHNtZWxsIG9mIGJ1dHRlciBvciBjb25kZXNjZW5zaW9uLiIsCiAgICAgIGljb246IFszMSwgMjVdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDE2KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlBldGl0IGJldXJyZSIsCiAgICAgIGRlc2M6ICdBbiB1bmFzc3VtaW5nIGJpc2N1aXQgd2hvc2UgbmFtZSBzaW1wbHkgbWVhbnMgImxpdHRsZSBidXR0ZXIiLiBGYW1lZCBhbmQgZmVhcmVkIGZvciBpdHMgZm91ciBlYXJzIGFuZCBmb3J0eS1laWdodCB0ZWV0aC48YnI+V2hlbiBpdCBoZWFycyB5YSwgaXRcJ2xsIGdldCB5YS4uLicsCiAgICAgIGljb246IFszMSwgMjZdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDE2KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIk5hbmFpbW8gYmFycyIsCiAgICAgIGRlc2M6ICJBIGRlbGljaW91cyBuby1iYWtlIHBhc3RyeSBoYWlsaW5nIGZyb20gQ2FuYWRhLiBQcm9iYWJseSBiZWF0cyBlYXRpbmcgc3RyYWlnaHQtdXAgc25vdyB3aXRoIG1hcGxlIHN5cnVwIHBvdXJlZCBvbiBpdCwgYnV0IHdoYXQgZG8gSSBrbm93LiIsCiAgICAgIGljb246IFszMSwgMjddLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDE3KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkJlcmdlciBjb29raWVzIiwKICAgICAgZGVzYzogIk1lc3NpbHkgc2xhdGhlcmVkIHdpdGggY2hvY29sYXRlIGZ1ZGdlLCBidXQgb25lIG9mIHRoZSBtb3N0IHBvcHVsYXIgYmVyZ2VycyBvZiBCYWx0aW1vcmUsIGFsb25nIHdpdGggdGhlIHRyaXBsZSBmcmllZCBlZ2cgYmVyZ2VyIGFuZCB0aGUgYmx1ZSBjcmFiIGNoZWVzZWJlcmdlci4iLAogICAgICBpY29uOiBbMzEsIDI4XSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSgxOCksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJDaGluc3VrbyIsCiAgICAgIGRlc2M6ICJBIGxpdHRsZSBwaWVjZSBvZiBPa2luYXdhIGluIGNvb2tpZSBmb3JtLiBQYXJ0IG9mIGEgSmFwYW5lc2UgY3VzdG9tIG9mIHNlbGxpbmcgc3dlZXRzIGFzIHNvdXZlbmlycy4gQnV0IGhleSwgcHJlc3NlZCBwZW5uaWVzIGFyZSBjb29sIHRvby4iLAogICAgICBpY29uOiBbMzEsIDI5XSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSgxOSksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJQYW5kYSBrb2FsYSBiaXNjdWl0cyIsCiAgICAgIGRlc2M6ICJBc3NvcnRlZCBqdW5nbGUgYW5pbWFscyB3aXRoIGVxdWFsbHkgYXNzb3J0ZWQgZmlsbGluZ3MuPGJyPkNvbWVzIGluIGNob2NvbGF0ZSwgc3RyYXdiZXJyeSwgdmFuaWxsYSBhbmQgZ3JlZW4gdGVhLjxicj5FYXQgdGhlbSBhbGwgYmVmb3JlIHRoZXkgZ28gZXh0aW5jdCEiLAogICAgICBpY29uOiBbMzEsIDEzXSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSgxOSksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJQdXRyaSBzYWxqdSIsCiAgICAgIGRlc2M6ICJBIGJlbG92ZWQgSW5kb25lc2lhbiBwYXN0cnk7IGl0cyBuYW1lIG1lYW5zIFwic25vdyBwcmluY2Vzc1wiLCBmb3IgdGhlIHBvd2RlcmVkIHN1Z2FyIGl0J3MgY29hdGVkIHdpdGguIEhhZCB3ZSBhZGRlZCB0aGVzZSB0byBDb29raWUgQ2xpY2tlciBzb21lIHllYXJzIGFnbywgdGhpcyBpcyB3aGVyZSB3ZSdkIG1ha2UgYSByZWZlcmVuY2UgdG8gdGhhdCBvbmUgRGlzbmV5IG1vdmllLCBidXQgaXQncyBwcm9iYWJseSB0aW1lIHRvIGxldCBpdCBnby4iLAogICAgICBpY29uOiBbMzEsIDMwXSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSgyMCksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJNaWxrIGNvb2tpZXMiLAogICAgICBkZXNjOiAiQmVzdCBlYXRlbiB3aXRoIGEgdGFsbCBnbGFzcyBvZiBjaG9jb2xhdGUuIiwKICAgICAgaWNvbjogWzMxLCAzMV0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoMjEpLAogICAgfSk7CgogICAgb3JkZXIgPSA5OTk5OwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkNvb2tpZSBjcnVtYnMiLAogICAgICBkZXNjOiAiVGhlcmUgdXNlZCB0byBiZSBhIGNvb2tpZSBoZXJlLiBOb3cgdGhlcmUgaXNuJ3QuPGJyPkdvb2QgaGVhdmVucywgd2hhdCBkaWQgeW91IDxpPkRPPyE8L2k+IiwKICAgICAgaWNvbjogWzMwLCAxM10sCiAgICAgIHBvd2VyOiAxLAogICAgICByZXF1aXJlOiAiTGVnYWN5IiwKICAgICAgcHJpY2U6IDEwMCwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkNob2NvbGF0ZSBjaGlwIGNvb2tpZSIsCiAgICAgIGRlc2M6ICJUaGlzIGlzIHRoZSBjb29raWUgeW91J3ZlIGJlZW4gY2xpY2tpbmcgdGhpcyB3aG9sZSB0aW1lLiBJdCBsb29rcyBhIGJpdCBkZW50ZWQgYW5kIG5pYmJsZWQgb24sIGJ1dCBpdCdzIG90aGVyd2lzZSBnb29kIGFzIG5ldy4iLAogICAgICBpY29uOiBbMTAsIDBdLAogICAgICBwb3dlcjogMTAsCiAgICAgIHJlcXVpcmU6ICJMZWdhY3kiLAogICAgICBwcmljZTogMTAwMDAwMDAwMDAwMCwKICAgIH0pOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJDb3NtaWMgYmVnaW5uZXIncyBsdWNrIiwKICAgICAgbG9jKAogICAgICAgICJQcmlvciB0byBwdXJjaGFzaW5nIHRoZSA8Yj4lMTwvYj4gdXBncmFkZSBpbiBhIHJ1biwgcmFuZG9tIGRyb3BzIGFyZSA8Yj4lMiB0aW1lcyBtb3JlIGNvbW1vbjwvYj4uIiwKICAgICAgICBbZ2V0VXBncmFkZU5hbWUoIkhlYXZlbmx5IGNoaXAgc2VjcmV0IiksIDVdCiAgICAgICkgKwogICAgICAgICI8cT5PaCEgQSBwZW5ueSE8YnI+T2ghIEEgcHJpY2VsZXNzIGhlaXJsb29tITxicj5PaCEgQW5vdGhlciBwZW5ueSE8L3E+IiwKICAgICAgOTk5OTk5OTk5ICogMTUsCiAgICAgIFs4LCAxMF0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiU2hpbW1lcmluZyB2ZWlsIl07CiAgICBHYW1lLmdldFZlaWxEZWZlbnNlID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgbiA9IDA7CiAgICAgIGlmIChHYW1lLkhhcygiUmVpbmZvcmNlZCBtZW1icmFuZSIpKSBuICs9IDAuMTsKICAgICAgaWYgKEdhbWUuSGFzKCJEZWxpY2F0ZSB0b3VjaCIpKSBuICs9IDAuMTsKICAgICAgaWYgKEdhbWUuSGFzKCJTdGVhZGZhc3QgbXVybXVyIikpIG4gKz0gMC4xOwogICAgICBpZiAoR2FtZS5IYXMoIkdsaXR0ZXJpbmcgZWRnZSIpKSBuICs9IDAuMTsKICAgICAgcmV0dXJuIG47CiAgICB9OwogICAgR2FtZS5nZXRWZWlsQm9vc3QgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBuID0gMC41OwogICAgICBpZiAoR2FtZS5IYXMoIlJlaW5mb3JjZWQgbWVtYnJhbmUiKSkgbiArPSAwLjE7CiAgICAgIGlmIChHYW1lLkhhcygiRGVsaWNhdGUgdG91Y2giKSkgbiArPSAwLjA1OwogICAgICBpZiAoR2FtZS5IYXMoIlN0ZWFkZmFzdCBtdXJtdXIiKSkgbiArPSAwLjA1OwogICAgICBpZiAoR2FtZS5IYXMoIkdsaXR0ZXJpbmcgZWRnZSIpKSBuICs9IDAuMDU7CiAgICAgIHJldHVybiBuOwogICAgfTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJSZWluZm9yY2VkIG1lbWJyYW5lIiwKICAgICAgbG9jKAogICAgICAgICJUaGUgPGI+c2hpbW1lcmluZyB2ZWlsPC9iPiBpcyBtb3JlIHJlc2lzdGFudCwgYW5kIGhhcyBhIDxiPiUxJSBjaGFuY2U8L2I+IG5vdCB0byBicmVhay4gSXQgYWxzbyBnaXZlcyA8Yj4rJTIlPC9iPiBtb3JlIENwUy4iLAogICAgICAgIFsxMCwgMTBdCiAgICAgICkgKyAiPHE+QSBjb25zaXN0ZW5jeSBiZXR3ZWVuIGplbGx5ZmlzaCBhbmQgY2xpbmcgd3JhcC48L3E+IiwKICAgICAgOTk5OTk5OTk5ICogMTUsCiAgICAgIFs3LCAxMF0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiU2hpbW1lcmluZyB2ZWlsIl07CgogICAgb3JkZXIgPSAyNTU7CiAgICBHYW1lLkdyYW5kbWFTeW5lcmd5KAogICAgICAiQmluYXJ5IGdyYW5kbWFzIiwKICAgICAgJ0EgZGlnaXRhbCBncmFuZG1hIHRvIHRyYW5zZmVyIG1vcmUgY29va2llcy48YnI+KFNlZSBhbHNvIDogYm9vbGVhbiBncmFuZG1hcywgc3RyaW5nIGdyYW5kbWFzLCBhbmQgbm90LWEtbnVtYmVyIGdyYW5kbWFzLCBhbHNvIGtub3duIGFzICJOYU5zIi4pJywKICAgICAgIkphdmFzY3JpcHQgY29uc29sZSIKICAgICk7CgogICAgb3JkZXIgPSAxNDAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiVGhlIEphdmFTY3JpcHQgY29uc29sZSBmb3IgZHVtbWllcyIsCiAgICAgICc8cT5UaGlzIHNob3VsZCBnZXQgeW91IHN0YXJ0ZWQuIFRoZSBmaXJzdCBsaW5lIHJlYWRzOiAiVG8gb3BlbiB0aGUgamF2YXNjcmlwdCBjb25zb2xlLCBwcmVzcy0iPGJyPi4uLnRoZSByZXN0IG9mIHRoZSBib29rIGlzIHNvYWtlZCBpbiBjaG9jb2xhdGUgbWlsay4gSWYgb25seSB0aGVyZSB3YXMgYSB3YXkgdG8gbG9vayB1cCB0aGlzIHNvcnQgb2YgaW5mb3JtYXRpb24uLi48L3E+JywKICAgICAgIkphdmFzY3JpcHQgY29uc29sZSIsCiAgICAgIDEKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICI2NGJpdCBhcnJheXMiLAogICAgICAiPHE+QSBsb25nLWZvcm0gdmFyaWFibGUgdHlwZSB0byBwYWNrIHlvdXIgY29va2llcyBtdWNoIG1vcmUgZWZmaWNpZW50bHkuPC9xPiIsCiAgICAgICJKYXZhc2NyaXB0IGNvbnNvbGUiLAogICAgICAyCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiU3RhY2sgb3ZlcmZsb3ciLAogICAgICAiPHE+VGhpcyBpcyByZWFsbHkgYmFkISBZb3UgcHJvYmFibHkgZm9yZ290IHRvIGNsb3NlIGEgbG9vcCBzb21ld2hlcmUgYW5kIG5vdyB5b3VyIHByb2dyYW1zIGFyZSBnb2luZyBjcmF6eSEgVGhlIHJlc3Qgb2YgeW91ciBlbmdpbmVlcnMgc2VlbSByZWFsbHkgZXhjaXRlZCBhYm91dCBpdCBzb21laG93LiBIb3cgY291bGQgYSBzb2Z0d2FyZSBtaXNoYXAgbGlrZSBhIHN0YWNrIG92ZXJmbG93IHBvc3NpYmx5IGV2ZXIgaGVscCBhbnlvbmU/PC9xPiIsCiAgICAgICJKYXZhc2NyaXB0IGNvbnNvbGUiLAogICAgICAzCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRW50ZXJwcmlzZSBjb21waWxlciIsCiAgICAgICI8cT5UaGlzIGJlc3Bva2UgamF2YXNjcmlwdCBjb21waWxlciB0b29rIHlvdXIgdGVhbSB5ZWFycyBvZiBkZXZlbG9wbWVudCBhbmQgYmlsbGlvbnMgaW4gcmVzZWFyY2gsIGJ1dCBpdCBzaG91bGQgbGV0IHlvdSBleGVjdXRlIChjZXJ0YWluKSBmdW5jdGlvbnMgKHVwIHRvKSAyJSBmYXN0ZXIgKGluIG9wdGltYWwgY2lyY3Vtc3RhbmNlcykuPC9xPiIsCiAgICAgICJKYXZhc2NyaXB0IGNvbnNvbGUiLAogICAgICA0CiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiU3ludGFjdGljIHN1Z2FyIiwKICAgICAgIjxxPlRhc3RpZXIgY29kZSBmb3IgdGFzdGllciBjb29raWVzLjwvcT4iLAogICAgICAiSmF2YXNjcmlwdCBjb25zb2xlIiwKICAgICAgNQogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkEgbmljZSBjdXAgb2YgY29mZmVlIiwKICAgICAgIjxxPkFsbCB0aGlzIG5lcmQgc3R1ZmYgaGFzIHlvdSBleGhhdXN0ZWQuIFlvdSBtYWtlIHlvdXJzZWxmIGEgbmljZSBjdXAgb2YgY29mZmVlLCBicmV3ZWQgd2l0aCByb2FzdGVkIGJlYW5zIGZyb20gc29tZSBmYXItYXdheSBpc2xhbmQuIFlvdSBtYXkgaGF2ZSBiZWVuIHdvcmtpbmcgYSBiaXQgdG9vIGhhcmQgdGhvdWdoIC0gdGhlIGN1cCBvZiBjb2ZmZWUgc3RhcnRzIHRhbGtpbmcgdG8geW91LCBpbnNpc3RpbmcgdGhhdCBpdCBpcyBOT1QgamF2YXNjcmlwdC48L3E+IiwKICAgICAgIkphdmFzY3JpcHQgY29uc29sZSIsCiAgICAgIDYKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJKdXN0LWluLXRpbWUgYmFraW5nIiwKICAgICAgIjxxPkEgbmV3IG1ldGhvZCBvZiBwcmVwYXJpbmcgY29va2llczsgdGhleSBiYWtlIHRoZW1zZWx2ZXMgcmlnaHQgaW4gZnJvbnQgb2YgdGhlIGN1c3RvbWVycyBiZWZvcmUgZWF0aW5nLCBsZWF2aW5nIHlvdXIga2l0Y2hlbnMgbWVzcy1mcmVlLjwvcT4iLAogICAgICAiSmF2YXNjcmlwdCBjb25zb2xlIiwKICAgICAgNwogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgImNvb2tpZXMrKyIsCiAgICAgICc8cT5Zb3VyIHZlcnkgb3duIGNvb2tpZS10aGVtZWQgcHJvZ3JhbW1pbmcgbGFuZ3VhZ2UsIGVsZWdhbnRseSBuYW1lZCBhZnRlciBpdHMgbW9zdCBpbnRlcmVzdGluZyBhYmlsaXR5IC0gaW5jcmVhc2luZyB0aGUgImNvb2tpZXMiIHZhcmlhYmxlIGJ5IDEuPC9xPicsCiAgICAgICJKYXZhc2NyaXB0IGNvbnNvbGUiLAogICAgICA4CiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiU29mdHdhcmUgdXBkYXRlcyIsCiAgICAgICI8cT5UaGlzIGlzIGdyYW5kIG5ld3MgLSBzb21lb25lJ3MgZmluYWxseSBmaWd1cmVkIG91dCB0aGUgV2lmaSBwYXNzd29yZCwgYW5kIHlvdXIgbmV3Zm91bmQgaW50ZXJuZXQgY29ubmVjdGlvbiBzZWVtcyB0byBoYXZlIHRyaWdnZXJlZCBhIHdob2xlIGxvdCBvZiBzb2Z0d2FyZSB1cGRhdGVzISBZb3VyIGJyb3dzZXJzLCBkcml2ZXJzIGFuZCBwbHVnaW5zIGFsbCByZWNlaXZlZCBhIGZyZXNoIGNvYXQgb2YgcGFpbnQsIGFuZCB5b3VyIGphdmFzY3JpcHQgdmVyc2lvbiBoYXMgYmVlbiB1cGRhdGVkIHRvIHRoZSBsYXRlc3QgRUNNQVNjcmlwdCBzcGVjaWZpY2F0aW9uLiBJdCdzIHJlYWxseSB0b28gYmFkIHRob3VzYW5kcyBoYWQgdG8gZGllIGR1ZSB0byBzb21lIGRlcHJlY2F0ZWQgZnVuY3Rpb24gaW4geW91ciBuZXVyb3RveGluIHZlbnRpbGF0aW9uIGNvZGUsIGJ1dCBJIGd1ZXNzIHRoYXQncyBwcm9ncmVzcyBmb3IgeW91LjwvcT4iLAogICAgICAiSmF2YXNjcmlwdCBjb25zb2xlIiwKICAgICAgOQogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkdhbWUuTG9vcCIsCiAgICAgICI8cT5Zb3UncmUgbm90IHF1aXRlIHN1cmUgd2hhdCB0byBtYWtlIG9mIHRoaXMuIFdoYXQgZG9lcyBpdCBtZWFuPyBXaGF0IGRvZXMgaXQgZG8/IFdobyB3b3VsZCBsZWF2ZSBzb21ldGhpbmcgbGlrZSB0aGF0IGp1c3QgbGF5aW5nIGFyb3VuZCBoZXJlPyBUcnkgYXNraW5nIGFnYWluIGluIDEvMzB0aCBvZiBhIHNlY29uZC48L3E+IiwKICAgICAgIkphdmFzY3JpcHQgY29uc29sZSIsCiAgICAgIDEwCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiZXZhbCgpIiwKICAgICAgIjxxPkl0IGlzIHNhaWQgdGhhdCB0aGlzIHNpbXBsZSBmdW5jdGlvbiBob2xkcyB0aGUga2V5IHRvIHRoZSB1bml2ZXJzZSwgYW5kIHRoYXQgd2hvc29ldmVyIG1hc3RlcnMgaXQgbWF5IHNoYXBlIHJlYWxpdHkgdG8gdGhlaXIgd2lsbC48YnI+R29vZCB0aGluZyB5b3UgaGF2ZSBubyBpZGVhIGhvdyBpdCB3b3Jrcy4gTWFrZXMgZm9yIGEgbmVhdCBwbGFxdWUgb24geW91ciB3YWxsLCB0aG91Z2guPC9xPiIsCiAgICAgICJKYXZhc2NyaXB0IGNvbnNvbGUiLAogICAgICAxMQogICAgKTsKCiAgICBvcmRlciA9IDUwMDA7CiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlKAogICAgICAiU2NyaXB0IGdyYW5uaWVzIiwKICAgICAgIjxxPkFybWllcyBvZiBlbmVyZ3kgZHJpbmstZnVlbGVkIGdyYW5kbWFzIHJlYWR5IHRvIGhhY2sgaW50byB0aGUgY3liZXJzcGFjZSBmb3IgcmVuZWdhZGUgZS1jb29raWVzLjwvcT4iLAogICAgICAiSmF2YXNjcmlwdCBjb25zb2xlIiwKICAgICAgIkdyYW5kbWEiLAogICAgICAic3luZXJneTEiCiAgICApOwogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIlRvbWJvbGEgY29tcHV0aW5nIiwKICAgICAgIiIsCiAgICAgICJKYXZhc2NyaXB0IGNvbnNvbGUiLAogICAgICAiQ2hhbmNlbWFrZXIiLAogICAgICAic3luZXJneTIiCiAgICApOwogICAgaWYgKEVOKSB7CiAgICAgIEdhbWUubGFzdC5kZXNjRnVuYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBNYXRoLnNlZWRyYW5kb20oR2FtZS5zZWVkICsgIi10b21ib2xhY29tcHV0aW5nIik7CiAgICAgICAgdmFyIHN0ciA9CiAgICAgICAgICAiKFlvdXIgdGlja2V0IHJlYWRzICIgKwogICAgICAgICAgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKSArCiAgICAgICAgICAiICIgKwogICAgICAgICAgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKSArCiAgICAgICAgICAiICIgKwogICAgICAgICAgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKSArCiAgICAgICAgICAiICIgKwogICAgICAgICAgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKSArCiAgICAgICAgICAiLCBlbnRpdGxpbmcgeW91IHRvICIgKwogICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNSArIDIpICsgIiBsaW5lcyBvZiBqYXZhc2NyaXB0IiwKICAgICAgICAgICAgIm9uZSBmcmVlIHVzZSBvZiBNYXRoLnJhbmRvbSgpIiwKICAgICAgICAgICAgIm9uZSBxdWJpdCwgd2hhdGV2ZXIgdGhhdCBpcyIsCiAgICAgICAgICAgICJvbmUgaGFsZi1lYXRlbiBjb29raWUiLAogICAgICAgICAgICAiYSBicmFuZCBuZXcgdmFjdXVtIGNsZWFuZXIiLAogICAgICAgICAgICAibW9zdCBvZiBvbmUgcm9vbS10ZW1wZXJhdHVyZSBjdXAgb2Ygb3JhbmdlIHNvZGEiLAogICAgICAgICAgICAib25lIHJlYWxseSBnb29kIHNhbmR3aWNoIiwKICAgICAgICAgICAgIm9uZSBoYW5kZnVsIG9mIHBvY2tldCBsaW50IiwKICAgICAgICAgICAgInNvbWVvbmUncyBtb3N0bHkgY2xlYW4gaGFpcnBpZWNlIiwKICAgICAgICAgICAgImEgdHJpcCB0byBhIGZhbmN5IHJlc3RhdXJhbnQiLAogICAgICAgICAgICAidGhlIGtub3dsZWRnZSBvZiB0aG9zZSBudW1iZXJzIiwKICAgICAgICAgICAgImEgZnVydGl2ZSBnbGFuY2UgYXQgdGhlIG5ld3MgdGlja2VyIiwKICAgICAgICAgICAgImFub3RoZXIgdGlja2V0LCBoYWxmLXByaWNlIiwKICAgICAgICAgICAgImFsbC15b3UtY2FuLWVhdCBtb2xkeSBicmVhZCIsCiAgICAgICAgICAgICJvbmUgbGlmZXRpbWUgc3VwcGx5IG9mIG94eWdlbiIsCiAgICAgICAgICAgICJ0aGUgY29sb3IgIiArCiAgICAgICAgICAgICAgY2hvb3NlWwogICAgICAgICAgICAgICAgKCJyZWQiLAogICAgICAgICAgICAgICAgIm9yYW5nZSIsCiAgICAgICAgICAgICAgICAieWVsbG93IiwKICAgICAgICAgICAgICAgICJncmVlbiIsCiAgICAgICAgICAgICAgICAiYmx1ZSIsCiAgICAgICAgICAgICAgICAicHVycGxlIiwKICAgICAgICAgICAgICAgICJibGFjayIsCiAgICAgICAgICAgICAgICAid2hpdGUiLAogICAgICAgICAgICAgICAgImdyYXkiLAogICAgICAgICAgICAgICAgImJyb3duIiwKICAgICAgICAgICAgICAgICJwaW5rIiwKICAgICAgICAgICAgICAgICJ0ZWFsIikKICAgICAgICAgICAgICBdLAogICAgICAgICAgICAiaW5jcmVhc2VkIGludGVsbGVjdCBmb3IgYSBsaW1pdGVkIHRpbWUiLAogICAgICAgICAgICAiYW4gYW5jaWVudCBydW5lc3dvcmQiLAogICAgICAgICAgICAidGhlIHRocm9uZSBvZiBhIGZhci1hd2F5IGNvdW50cnkiLAogICAgICAgICAgICAidGhlIHBvc2l0aW9uIG9mIE1hZmlhIGNhcG8uIEdvb2QgbHVjayIsCiAgICAgICAgICAgICJvbmUgZnJlZSB0aW1lLXRyYXZlbCB3ZWVrLWVuZCIsCiAgICAgICAgICAgICJzb21ldGhpbmcgYmVhdXRpZnVsIiwKICAgICAgICAgICAgInRoZSBkZWVkIHRvIHNvbWUgb2lsIHdlbGwiLAogICAgICAgICAgICAib25lIGhhbWJ1cmdlciBtYWRlIG91dCBvZiB0aGUgYW5pbWFsLCBwbGFudCwgb3IgcGVyc29uIG9mIHlvdXIgY2hvaWNlIiwKICAgICAgICAgICAgInRoZSBsYXN0IHN1cnZpdmluZyAiICsKICAgICAgICAgICAgICBjaG9vc2VbCiAgICAgICAgICAgICAgICAoImRvZG8gYmlyZCIsICJ0aHlsYWNpbmUiLCAidW5pY29ybiIsICJkaW5vc2F1ciIsICJuZWFuZGVydGhhbCIpCiAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgImEgZGVlcCBmZWVsaW5nIG9mIGFjY29tcGxpc2htZW50IiwKICAgICAgICAgICAgImEgZmxlZXRpbmcgdGluZ2Ugb2YgZW50ZXJ0YWlubWVudCIsCiAgICAgICAgICAgICJhIHZhZ3VlIHNlbnNlIG9mIHVuZWFzZSIsCiAgICAgICAgICAgICJkZWVwIGV4aXN0ZW50aWFsIGRyZWFkIiwKICAgICAgICAgICAgIm9uZSBleHRyYSB3ZWVrIGFkZGVkIHRvIHlvdXIgbGlmZXNwYW4iLAogICAgICAgICAgICAiYnJlYXRoZSBtYW51YWxseSIsCiAgICAgICAgICAgICJibGluayByaWdodCBoZXJlIGFuZCBub3ciLAogICAgICAgICAgICAib25lIG1lZXRpbmcgd2l0aCBhbnkgZmFtb3VzIHBlcnNvbiwgbGl2aW5nIG9yIGRlYWQsIGluIHlvdXIgbmV4dCBkcmVhbSIsCiAgICAgICAgICAgICJvbmUgdmVyeSBuaWNlIGRyZWFtIiwKICAgICAgICAgICAgImEgd2Fja3kgc291bmQgZWZmZWN0IiwKICAgICAgICAgICAgIjQ1IHNlY29uZHMgb2YgbW9yYWwgZmxleGliaWxpdHkiLAogICAgICAgICAgICAnaHVuZHJlZHMgYW5kIHRob3VzYW5kcywgYWxzbyBrbm93biBhcyAic3ByaW5rbGVzIicsCiAgICAgICAgICAgICJvbmUgY2lyY2xlLCB0cmlhbmdsZSwgc3F1YXJlIG9yIG90aGVyIHNpbXBsZSBnZW9tZXRyaWMgc2hhcGUsIG9mIGF2ZXJhZ2UgZGltZW5zaW9ucyIsCiAgICAgICAgICAgICJqdXN0IHRoaXMgZXh0cmEgYml0IG9mIHJhbmRvbW5lc3MiLAogICAgICAgICAgICAidGhlIGV4dHJhIHB1c2ggeW91IG5lZWRlZCB0byB0dXJuIHlvdXIgbGlmZSBhcm91bmQiLAogICAgICAgICAgICAiYSBnb29kIGZyaWdodCIsCiAgICAgICAgICAgICJvbmUgc2VjcmV0IHN1cGVycG93ZXIiLAogICAgICAgICAgICAiYSBiZXR0ZXIgbHVjayBuZXh0IHRpbWUiLAogICAgICAgICAgICAiYW4gaXJyYXRpb25hbCBwaG9iaWEgb2YgdG9tYm9sYSB0aWNrZXRzIiwKICAgICAgICAgICAgIm9uZSB3aG9sZSBzcGlkZXIiLAogICAgICAgICAgICAiYW4gaW5jcmVhc2VkIHNlbnNlIG9mIHNlbGYtd29ydGggYW5kIGRldGVybWluYXRpb24iLAogICAgICAgICAgICAiaW5uZXIgcGVhY2UiLAogICAgICAgICAgICAib25lIGRvdWJsZS1YUCB3ZWVrLWVuZCBpbiB0aGUgTU1PUlBHIG9mIHlvdXIgY2hvaWNlIiwKICAgICAgICAgICAgImEgbGl0dGxlIHBpZWNlIG9mIHRoZSB1bml2ZXJzZSwgcmVwcmVzZW50ZWQgYnkgdGhlIHRyaWxsaW9ucyBvZiBhdG9tcyB0aGF0IG1ha2UgdXAgdGhpcyB2ZXJ5IHRpY2tldCIsCiAgICAgICAgICAgICJmb29kIHBvaXNvbmluZyIsCiAgICAgICAgICAgICJ0aGUgTW9vbiEgV2VsbCwgY29uY2VwdHVhbGx5IiwKICAgICAgICAgICAgImEgbmV3IGNhciwgYmFieSIsCiAgICAgICAgICAgICJhIG5ldyBjYXRjaHBocmFzZSIsCiAgICAgICAgICAgICJhbiBpbnRydXNpdmUgdGhvdWdodCBvZiB5b3VyIGNob2ljZSIsCiAgICAgICAgICAgICItIC4uLmF3IG1hbiwgaXQganVzdCBjdXRzIG9mZiB0aGVyZSIsCiAgICAgICAgICAgICJ0aGUgZGlyZWN0b3Igc3BvdCBmb3IgdGhlIG5leHQgYmlnIGhpdCBtb3ZpZSIsCiAgICAgICAgICAgICJyZWFsbHkgZ29vZC1sb29raW5nIGNhbHZlcyIsCiAgICAgICAgICAgICJvbmUgZ2VudWluZSBwaXJhdGUgZ29sZGVuIGRvdWJsb29uIiwKICAgICAgICAgICAgJyJ0cmVhc3VyZSBhbmQgcmljaGVzIiwgb3Igc29tZXRoaW5nJywKICAgICAgICAgICAgIm9uZSBib2F0LCBzdW5rZW4iLAogICAgICAgICAgICAiYmFieSBzaG9lcywgbmV2ZXIgd29ybiIsCiAgICAgICAgICAgICJkaXJlY3QgbGluZWFnZSB0byBzb21lIEtpbmcgb3IgUXVlZW4iLAogICAgICAgICAgICAiaW5uYXRlIGtub3dsZWRnZSBvZiBhIGRlYWQgbGFuZ3VhZ2UgeW91J2xsIG5ldmVyIGVuY291bnRlciIsCiAgICAgICAgICAgICJ0aGUgbWVsb2R5IG9mIGEgc29uZyB5b3UgZG9uJ3Qga25vdyB0aGUgd29yZHMgdG8iLAogICAgICAgICAgICAid2hpdGUgbm9pc2UiLAogICAgICAgICAgICAibWlsZCBwaHlzaWNhbCBpbXBhaXJtZW50IiwKICAgICAgICAgICAgImEgbmV3IHBhaXIgb2YgbGlwcyIsCiAgICAgICAgICAgICJ0aGluZ3MsIGFuZCBzdWNoIiwKICAgICAgICAgICAgIm9uZSBwb3B1bGFyIGV4cHJlc3Npb24gYmVhcmluZyB5b3VyIG5hbWUiLAogICAgICAgICAgICAib25lIHR5cG8iLAogICAgICAgICAgICAib25lIGdldC1vdXQtb2YtamFpbC1mcmVlIGNhcmQiLAogICAgICAgICAgICAidGhlIHJlc3Qgb2YgeW91ciBsaWZlLi4uIGZvciBub3ciLAogICAgICAgICAgICAib25lIHBvbGl0ZSBodWZmIiwKICAgICAgICAgICAgImEgY29uZGVzY2VuZGluZyBzdGFyZSIsCiAgICAgICAgICAgICJvbmUgY3Vyc2VkIG1vbmtleSBwYXciLAogICAgICAgICAgICAidHJ1ZSBsb3ZlLCBwcm9iYWJseSIsCiAgICAgICAgICAgICJhbiBpbnRlcmVzdGluZyBmYWN0b2lkIGFib3V0IHRoZSBhbmltYWwsIGNvdW50cnksIFRWIHNob3cgb3IgY2VsZWJyaXR5IG9mIHlvdXIgY2hvaWNlIiwKICAgICAgICAgICAgImEgcG9wIGN1bHR1cmUgcmVmZXJlbmNlIiwKICAgICAgICAgICAgIm1pbnV0ZXMgb2YgZnVuIiwKICAgICAgICAgICAgJ3RoZSBldHltb2xvZ3kgb2YgdGhlIHdvcmQgInRvbWJvbGEiIC0gaXRcJ3MgSXRhbGlhbiBmb3IgImEgdHVtYmxlIicsCiAgICAgICAgICAgICJub3RoaW5nLiBZb3UgbG9zdCwgc29ycnkiLAogICAgICAgICAgXSkgKwogICAgICAgICAgIi4pIjsKICAgICAgICBNYXRoLnNlZWRyYW5kb20oKTsKICAgICAgICByZXR1cm4gKAogICAgICAgICAgdGhpcy5kZXNjICsKICAgICAgICAgICI8cT5MaWtlIHF1YW50dW0gY29tcHV0aW5nLCBidXQgbW9yZSBmdW4uPGJyPiIgKwogICAgICAgICAgc3RyICsKICAgICAgICAgICI8L3E+IgogICAgICAgICk7CiAgICAgIH07CiAgICB9IGVsc2UgR2FtZS5sYXN0LmRlc2MgPSAiPHE+LTwvcT4iOwoKICAgIG9yZGVyID0gMTAwMjA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiS3J1aWRub3RlbiIsCiAgICAgIGRlc2M6ICdBIGZlc3RpdmUgZHV0Y2ggZmF2b3JpdGU7IHRpbnkgY2lubmFtb255IGJpdGVzIHNvbWV0aW1lcyBjb2F0ZWQgaW4gY2hvY29sYXRlLiBUaGUgbmFtZSB0cmFuc2xhdGVzIHJvdWdobHkgdG8gImtydWlkbm90ZW4iLicsCiAgICAgIGljb246IFszMCwgM10sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoMjIpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiTWFyaWUgYmlzY3VpdHMiLAogICAgICBkZXNjOiAiUGxlYXNhbnRseSByb3VuZCwgc21vb3RobHkgYnV0dGVyeSwgc3VidGx5IHZhbmlsbGEtZmxhdm9yZWQsIG9ybmF0ZWx5IGVtYm9zc2VkLCBlYWNoIHJpZGdlIHJlcHJlc2VudHMgYSBwZXJzb24gTWFyaWUga2lsbGVkIGluIHByaXNvbi4iLAogICAgICBpY29uOiBbMzAsIDRdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDIzKSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIk1lcmluZ3VlIGNvb2tpZXMiLAogICAgICBkZXNjOiAiUHJvYmFibHkgdGhlIG1vc3QgZXhjaXRpbmcgdGhpbmcgeW91IGNhbiBtYWtlIG91dCBvZiBlZ2cgd2hpdGVzLiBBbHNvIGNhbGxlZCBmb3Jnb3R0ZW4gY29va2llcywgZHVlIHRvIHRoZSByZWNpcGUgYmVpbmcgb25jZSBsb3N0IGluIGEgc2VhbGVkIG15c3RpY2FsIHZhdWx0IGZvciAxMCwwMDAgeWVhcnMuIiwKICAgICAgaWNvbjogWzMxLCA0XSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSgyNCksCiAgICB9KTsKCiAgICBvcmRlciA9IDEwMDYwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlBpenphIiwKICAgICAgZGVzYzogIldoYXQgaXMgYSBwaXp6YSBpZiBub3QgYSBsYXJnZSwgY2hld3kgY29va2llLCBmcm9zdGVkIHdpdGggYSByYXRoZXIgZXh1YmVyYW50IHRvbWF0byAmIGNoZWVzZSBpY2luZz8gTm90IGEgY29va2llLCB0aGF0J3Mgd2hhdC4iLAogICAgICBpY29uOiBbMzEsIDldLAogICAgICByZXF1aXJlOiAiQm94IG9mIG5vdCBjb29raWVzIiwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBNYXRoLnBvdygxMCwgNDQpLAogICAgfSk7CgogICAgb3JkZXIgPSAxMDA1MDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJDcmFja2VycyIsCiAgICAgIGRlc2M6ICdUaGVzZSBhcmUgdGhlIG5vbi1mbGF2b3JlZCBraW5kIHdpdGggbm8gc2FsdCBhZGRlZC4gUmVhbGx5IGp1c3QgYSBqdWRnbWVudC1mcmVlIHdoZWF0IHNxdWFyZSBiZWdnaW5nIHRvIGhhdmUgYml0cyBvZiBoYW0gYW5kIHNwcmVhZGFibGUgY2hlZXNlIHBpbGVkIG9udG8gaXQsIGl0cyBtYWluIGNvbnRyaWJ1dGlvbiBiZWluZyAiY3J1bmNoeSIuJywKICAgICAgaWNvbjogWzMwLCA5XSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBtYXliZSBjb29raWVzIiwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiBNYXRoLnBvdygxMCwgNDUpLAogICAgfSk7CgogICAgb3JkZXIgPSAxMDAzMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJIYXZhYnJlYWtzIiwKICAgICAgZGVzYzogIllvdSBjYW4gc25hcCB0aGUgc2VjdGlvbnMgbmVhdGx5IG9yIGp1c3QgYml0ZSBpbnRvIHRoZSB3aG9sZSB0aGluZyBsaWtlIHNvbWUga2luZCBvZiBsdW5hdGljLiBTb21lIG92ZXJzZWEgY291bnRyaWVzIG1hbnVmYWN0dXJlIHRoZXNlIGluIGh1bmRyZWRzIG9mIHVuaXF1ZSBmbGF2b3JzLCBzdWNoIGFzIGdyZWVuIHRlYSwgbG9ic3RlciBiaXNxdWUsIGFuZCBkYXJrIGNob2NvbGF0ZS4iLAogICAgICBpY29uOiBbMzEsIDNdLAogICAgICByZXF1aXJlOiAiQm94IG9mIGJyYW5kIGJpc2N1aXRzIiwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CgogICAgb3JkZXIgPSAyMDAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJLaXR0ZW4gZXhlY3V0aXZlcyIsCiAgICAgIHN0cktpdHRlbkRlc2MgKwogICAgICAgICI8cT5yZWFkeSB0byBleGVjdXRlIHdoYXRldmVyIGFuZCB3aG9ldmVyIHlvdSdkIGxpa2UsIHNpcjwvcT4iLAogICAgICA5MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIEdhbWUuR2V0SWNvbigiS2l0dGVuIiwgMTMpCiAgICApOwogICAgR2FtZS5sYXN0LmtpdHRlbiA9IDE7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCAxMywgMTgpOwoKICAgIG9yZGVyID0gMTAwMjA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQ2hhaSB0ZWEgY29va2llcyIsCiAgICAgIGRlc2M6ICJOb3QgZXhhY3RseSBDYXB0YWluIFBpY2FyZCdzIGZhdm9yaXRlLCBidXQgSSBtZWFuLCB0aGVzZSB3aWxsIGRvIGluIGEgcGluY2guIiwKICAgICAgaWNvbjogWzIzLCAzMl0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoNCkgKyA1LAogICAgfSk7CiAgICBHYW1lLmxhc3Qub3JkZXIgPSAxMDAyMC41Njg1OwoKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJZb2d1cnQgY29va2llcyIsCiAgICAgIGRlc2M6ICJBdWdtZW50ZWQgYnkgdGhlIHdvbmRlcnMgb2YgZGFpcnksIHRoZXNlIGNvb2tpZXMgYXJlIGxpZ2h0IGFuZCBmbHVmZnkgYW5kIGp1c3Qgb25lIG1vcmUgdGhpbmcgZm9yIHRoZSBsYWN0b3NlLWludG9sZXJhbnQgdG8gYXZvaWQuPGJyPlRydWx5IGZvciB0aGUgY3VsdHVyZWQgYW1vbmcgdXMuIiwKICAgICAgaWNvbjogWzI0LCAzMl0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoMjUpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiVGh1bWJwcmludCBjb29raWVzIiwKICAgICAgZGVzYzogIkZpbGxlZCB3aXRoIGphbSBhbmQgc29tZXRpbWVzIHNlcnZlZCBpbiBsaXR0bGUgcGFwZXIgY3Vwcy4gTm8gbG9uZ2VyIGFkbWlzc2libGUgYXMgYmlvbWV0cmljIGV2aWRlbmNlIGluIGNvdXJ0LiBXZSdyZSBub3QgaGF2aW5nIGEgcmVwZWF0IG9mIHRoYXQgd2hvbGUgbWVzcy4iLAogICAgICBpY29uOiBbMjUsIDMyXSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSgyNiksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJQaXp6ZWxsZSIsCiAgICAgIGRlc2M6ICJUaGluLCBjcmlzcCB3YWZmbGUgY29va2llcyBiYWtlZCBpbiBhIGJlc3Bva2UgaXJvbiBmb2xsb3dpbmcgYW4gYW5jaWVudCBJdGFsaWFuIHJlY2lwZS48YnI+VGhlc2UgY29va2llcyBoYXZlIGJlZW4gYXJvdW5kIGZvciBhIGxvbmcsIGxvbmcgdGltZS48YnI+VGhlc2UgY29va2llcyBoYXZlIHNlZW4gdGhpbmdzLiIsCiAgICAgIGljb246IFsyNiwgMzJdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDI3KSwKICAgIH0pOwoKICAgIG9yZGVyID0gMTAwMzA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiWmlsbGEgd2FmZXJzIiwKICAgICAgZGVzYzogIlBvcHVsYXIgdmFuaWxsYS1mbGF2b3JlZCBiaXNjdWl0cyB0aGF0IHNvbWVob3cga2VlcCBlbmRpbmcgdXAgaW4gYmFuYW5hIHB1ZGRpbmcuPGJyPlRoZW1lZCBhZnRlciBhIGJlbG92ZWQgcmFkaW9hY3RpdmUgcHJlaGlzdG9yaWMgbW9uc3RlciwgZm9yIHNvbWUgcmVhc29uLiIsCiAgICAgIGljb246IFsyMiwgMzJdLAogICAgICByZXF1aXJlOiAiQm94IG9mIGJyYW5kIGJpc2N1aXRzIiwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiRGltIERhbXMiLAogICAgICBkZXNjOiAiVHdvIGJpc2N1aXRzIGpvaW5lZCBieSBjaG9jb2xhdGUgYW5kIGNvYXRlZCBpbiBldmVuIG1vcmUgY2hvY29sYXRlLjxicj5Zb3Ugd29uZGVyIC0gd2hpY2ggb25lIGlzIHRoZSBkaW0sIGFuZCB3aGljaCBvbmUgaXMgdGhlIGRhbT8iLAogICAgICBpY29uOiBbMzEsIDEwXSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBicmFuZCBiaXNjdWl0cyIsCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwoKICAgIG9yZGVyID0gMTAwNjA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQ2FuZHkiLAogICAgICBkZXNjOiAiVGhlcmUgYXJlIHR3byBwaWxsYXJzIHRvIHRoZSB3b3JsZCBvZiBzd2VldHMgOiBwYXN0cmllcywgb2YgY291cnNlIC0gYW5kIGNhbmR5Ljxicj5Zb3UgY291bGQgbWFrZSBhIHdob2xlIG5ldyBnYW1lIGp1c3QgYWJvdXQgdGhlc2UsIGJ1dCBmb3Igbm93LCBwbGVhc2UgZW5qb3kgdGhlc2UgYXNzb3J0ZWQgZ2VuZXJpYyB0cmVhdHMuIiwKICAgICAgaWNvbjogWzMwLCAxMF0sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2Ygbm90IGNvb2tpZXMiLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IE1hdGgucG93KDEwLCA0NiksCiAgICB9KTsKCiAgICBvcmRlciA9IDE5MDAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRm9ydHVuZSAjMDAxIiwKICAgICAgIjxxPkZpbmdlcnMgYXJlIG5vdCB0aGUgb25seSB0aGluZyB5b3UgY2FuIGNvdW50IG9uLjwvcT4iLAogICAgICAiQ3Vyc29yIiwKICAgICAgImZvcnR1bmUiCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRm9ydHVuZSAjMDAyIiwKICAgICAgIjxxPkEgd3JpbmtsZSBpcyBhIGNyYWNrIGluIGEgbXVuZGFuZSBmYWNhZGUuPC9xPiIsCiAgICAgICJHcmFuZG1hIiwKICAgICAgImZvcnR1bmUiCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRm9ydHVuZSAjMDAzIiwKICAgICAgIjxxPlRoZSBzZWVkcyBvZiB0b21vcnJvdyBhbHJlYWR5IGxpZSB3aXRoaW4gdGhlIHNlZWRzIG9mIHRvZGF5LjwvcT4iLAogICAgICAiRmFybSIsCiAgICAgICJmb3J0dW5lIgogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkZvcnR1bmUgIzAwNCIsCiAgICAgICI8cT5SaWNoZXMgZnJvbSBkZWVwIHVuZGVyIGVsZXZhdGUgeW91IGFsbCB0aGUgc2FtZS48L3E+IiwKICAgICAgIk1pbmUiLAogICAgICAiZm9ydHVuZSIKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJGb3J0dW5lICMwMDUiLAogICAgICAiPHE+VHJ1ZSB3b3J0aCBpcyBub3QgaW4gd2hhdCB5b3UgZmluZCwgYnV0IGluIHdoYXQgeW91IG1ha2UuPC9xPiIsCiAgICAgICJGYWN0b3J5IiwKICAgICAgImZvcnR1bmUiCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRm9ydHVuZSAjMDA2IiwKICAgICAgIjxxPlRoZSB2YWx1ZSBvZiBtb25leSBtZWFucyBub3RoaW5nIHRvIGEgcG9ja2V0LjwvcT4iLAogICAgICAiQmFuayIsCiAgICAgICJmb3J0dW5lIgogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkZvcnR1bmUgIzAwNyIsCiAgICAgICI8cT5Ob3QgYWxsIGd1aWRlcyBkZXNlcnZlIHdvcnNoaXAuPC9xPiIsCiAgICAgICJUZW1wbGUiLAogICAgICAiZm9ydHVuZSIKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJGb3J0dW5lICMwMDgiLAogICAgICAiPHE+TWFnaWMgaXMgYWJvdXQgdHdvIHRoaW5ncyAtIHNob3dtYW5zaGlwLCBhbmQgcmFiYml0cy48L3E+IiwKICAgICAgIldpemFyZCB0b3dlciIsCiAgICAgICJmb3J0dW5lIgogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkZvcnR1bmUgIzAwOSIsCiAgICAgICI8cT5FdmVyeSBtaWxlIHRyYXZlbGxlZCBleHBhbmRzIHRoZSBtaW5kIGJ5IGp1c3QgYXMgbXVjaC48L3E+IiwKICAgICAgIlNoaXBtZW50IiwKICAgICAgImZvcnR1bmUiCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRm9ydHVuZSAjMDEwIiwKICAgICAgIjxxPkRvbid0IGdldCB1c2VkIHRvIHlvdXJzZWxmLiBZb3UncmUgZ29ubmEgaGF2ZSB0byBjaGFuZ2UuPC9xPiIsCiAgICAgICJBbGNoZW15IGxhYiIsCiAgICAgICJmb3J0dW5lIgogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkZvcnR1bmUgIzAxMSIsCiAgICAgICI8cT5FdmVyeSBkb29yd2F5IGlzIGEgZ2FtYmxlLiBUcmVhZCB3aXRoIGNhcmUuPC9xPiIsCiAgICAgICJQb3J0YWwiLAogICAgICAiZm9ydHVuZSIKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJGb3J0dW5lICMwMTIiLAogICAgICAiPHE+RG8geW91ciBmdXR1cmUgc2VsZiBhIGZhdm9yOyB0aGV5J2xsIHRoYW5rIHlvdSBmb3IgaXQuPC9xPiIsCiAgICAgICJUaW1lIG1hY2hpbmUiLAogICAgICAiZm9ydHVuZSIKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJGb3J0dW5lICMwMTMiLAogICAgICAiPHE+VGhlIHdvcmxkIGlzIG1hZGUgb2Ygd2hhdCB3ZSBwdXQgaW50byBpdC48L3E+IiwKICAgICAgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwKICAgICAgImZvcnR1bmUiCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRm9ydHVuZSAjMDE0IiwKICAgICAgIjxxPlN0YXJpbmcgYXQgYSBkYXp6bGluZyBsaWdodCBjYW4gYmxpbmQgeW91IGJhY2sgdG8gZGFya25lc3MuPC9xPiIsCiAgICAgICJQcmlzbSIsCiAgICAgICJmb3J0dW5lIgogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkZvcnR1bmUgIzAxNSIsCiAgICAgICI8cT5Eb24ndCBsZWF2ZSB0byBibGluZCBjaGFuY2Ugd2hhdCB5b3UgY291bGQgYWNjb21wbGlzaCB3aXRoIGRlYWYgc2tpbGwuPC9xPiIsCiAgICAgICJDaGFuY2VtYWtlciIsCiAgICAgICJmb3J0dW5lIgogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkZvcnR1bmUgIzAxNiIsCiAgICAgICI8cT5JdCdzIGdvb2QgdG8gc2VlIHlvdXJzZWxmIGluIG90aGVycy4gUmVtZW1iZXIgdG8gc2VlIHlvdXJzZWxmIGluIHlvdXJzZWxmLCB0b28uPC9xPiIsCiAgICAgICJGcmFjdGFsIGVuZ2luZSIsCiAgICAgICJmb3J0dW5lIgogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkZvcnR1bmUgIzAxNyIsCiAgICAgICI8cT5JZiB0aGluZ3MgYXJlbid0IHdvcmtpbmcgb3V0IGZvciB5b3UsIHJld3JpdGUgdGhlIHJ1bGVzLjwvcT4iLAogICAgICAiSmF2YXNjcmlwdCBjb25zb2xlIiwKICAgICAgImZvcnR1bmUiCiAgICApOwoKICAgIG9yZGVyID0gMTkxMDA7CiAgICAvL25vdGUgOiBwcmljZSBmb3IgdGhlc2UgY2FwcGVkIHRvIGJhc2UgcHJpY2UgT1IgMSBkYXkgb2YgdW5idWZmZWQgQ3BTCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRm9ydHVuZSAjMTAwIiwKICAgICAgbG9jKCJBbGwgYnVpbGRpbmdzIGFuZCB1cGdyYWRlcyBhcmUgPGI+JTElIGNoZWFwZXI8L2I+LiIsIDEpICsKICAgICAgICAiICIgKwogICAgICAgIGxvYygiQ29va2llIHByb2R1Y3Rpb24gbXVsdGlwbGllciA8Yj4rJTElPC9iPi4iLCAxKSArCiAgICAgICAgIjxxPlRydWUgd2VhbHRoIGlzIGNvdW50ZWQgaW4gZ2lmdHMuPC9xPiIsCiAgICAgIEdhbWUuVGllcnNbImZvcnR1bmUiXS5wcmljZSAqIDEwMDAwMCwKICAgICAgWzAsIDBdCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgImZvcnR1bmUiLCAxMCk7CiAgICBHYW1lLmxhc3QucHJpY2VGdW5jID0gZnVuY3Rpb24gKG1lKSB7CiAgICAgIHJldHVybiBNYXRoLm1pbihtZS5iYXNlUHJpY2UsIEdhbWUudW5idWZmZWRDcHMgKiA2MCAqIDYwICogMjQpOwogICAgfTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJGb3J0dW5lICMxMDEiLAogICAgICBsb2MoIkNvb2tpZSBwcm9kdWN0aW9uIG11bHRpcGxpZXIgPGI+KyUxJTwvYj4uIiwgNykgKwogICAgICAgICI8cT5Tb21lIHBlb3BsZSBkcmVhbSBvZiBmb3J0dW5lczsgb3RoZXJzIGRyZWFtIG9mIGNvb2tpZXMuPC9xPiIsCiAgICAgIEdhbWUuVGllcnNbImZvcnR1bmUiXS5wcmljZSAqIDEwMDAwMDAwMCwKICAgICAgWzAsIDBdCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgImZvcnR1bmUiLCAxMCk7CiAgICBHYW1lLmxhc3QucHJpY2VGdW5jID0gZnVuY3Rpb24gKG1lKSB7CiAgICAgIHJldHVybiBNYXRoLm1pbihtZS5iYXNlUHJpY2UsIEdhbWUudW5idWZmZWRDcHMgKiA2MCAqIDYwICogMjQpOwogICAgfTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJGb3J0dW5lICMxMDIiLAogICAgICBsb2MoCiAgICAgICAgIllvdSBnYWluIGFub3RoZXIgPGI+KyUxJTwvYj4gb2YgeW91ciByZWd1bGFyIENwUyB3aGlsZSB0aGUgZ2FtZSBpcyBjbG9zZWQuIiwKICAgICAgICAxCiAgICAgICkgKwogICAgICAgICIgPHNtYWxsPigiICsKICAgICAgICBsb2MoCiAgICAgICAgICAiTXVzdCBvd24gdGhlICUxIHVwZ3JhZGUuIiwKICAgICAgICAgIGdldFVwZ3JhZGVOYW1lKCJUd2luIEdhdGVzIG9mIFRyYW5zY2VuZGVuY2UiKQogICAgICAgICkgKwogICAgICAgICIpPC9zbWFsbD4iICsKICAgICAgICAiPHE+SGVscCwgSSdtIHRyYXBwZWQgaW4gYSAiICsKICAgICAgICAoQXBwID8gImNvbXB1dGVyIiA6ICJicm93c2VyIikgKwogICAgICAgICIgZ2FtZSE8L3E+IiwKICAgICAgR2FtZS5UaWVyc1siZm9ydHVuZSJdLnByaWNlICogMTAwMDAwMDAwMDAwLAogICAgICBbMCwgMF0KICAgICk7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCAiZm9ydHVuZSIsIDEwKTsKICAgIEdhbWUubGFzdC5wcmljZUZ1bmMgPSBmdW5jdGlvbiAobWUpIHsKICAgICAgcmV0dXJuIE1hdGgubWluKG1lLmJhc2VQcmljZSwgR2FtZS51bmJ1ZmZlZENwcyAqIDYwICogNjAgKiAyNCk7CiAgICB9OwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkZvcnR1bmUgIzEwMyIsCiAgICAgIHN0cktpdHRlbkRlc2MgKwogICAgICAgICI8cT5Eb24ndCBiZWxpZXZlIHRoZSBzdXBlcnN0aXRpb25zOyBhbGwgY2F0cyBhcmUgZ29vZCBsdWNrLjwvcT4iLAogICAgICBHYW1lLlRpZXJzWyJmb3J0dW5lIl0ucHJpY2UgKiAxMDAwMDAwMDAwMDAwMDAsCiAgICAgIFswLCAwXQogICAgKTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsICJmb3J0dW5lIiwgMTgpOwogICAgR2FtZS5sYXN0LmtpdHRlbiA9IDE7CiAgICBHYW1lLmxhc3QucHJpY2VGdW5jID0gZnVuY3Rpb24gKG1lKSB7CiAgICAgIHJldHVybiBNYXRoLm1pbihtZS5iYXNlUHJpY2UsIEdhbWUudW5idWZmZWRDcHMgKiA2MCAqIDYwICogMjQpOwogICAgfTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJGb3J0dW5lICMxMDQiLAogICAgICBnZXRTdHJDbGlja2luZ0dhaW5zKDEpICsgIjxxPlJlbWVtYmVyIHRvIHN0YXkgaW4gdG91Y2guPC9xPiIsCiAgICAgIEdhbWUuVGllcnNbImZvcnR1bmUiXS5wcmljZSAqIDEwMDAwMDAwMDAwMCwKICAgICAgWzAsIDBdCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgImZvcnR1bmUiLCAxMSk7CiAgICBHYW1lLmxhc3QucHJpY2VGdW5jID0gZnVuY3Rpb24gKG1lKSB7CiAgICAgIHJldHVybiBNYXRoLm1pbihtZS5iYXNlUHJpY2UsIEdhbWUudW5idWZmZWRDcHMgKiA2MCAqIDYwICogMjQpOwogICAgfTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRm9ydHVuZSBjb29raWVzIiwKICAgICAgbG9jKAogICAgICAgICJUaGUgbmV3cyB0aWNrZXIgbWF5IG9jY2FzaW9uYWxseSBoYXZlIDxiPmZvcnR1bmVzPC9iPiwgd2hpY2ggbWF5IGJlIGNsaWNrZWQgZm9yIHNvbWV0aGluZyBnb29kLiIKICAgICAgKSArCiAgICAgICAgIjxxPlRoZXNlIGRvbid0IHRhc3RlIGFsbCB0aGF0IGdyZWF0IGJ1dCB0aGF0J3Mgbm90IHJlYWxseSB0aGUgcG9pbnQsIGlzIGl0PzwvcT4iLAogICAgICA3Nzc3Nzc3Nzc3NywKICAgICAgWzI5LCA4XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJEaXN0aWxsZWQgZXNzZW5jZSBvZiByZWRvdWJsZWQgbHVjayJdOwoKICAgIG9yZGVyID0gNDAwMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQSByZWFsbHkgZ29vZCBndWlkZSBib29rIiwKICAgICAgIjxiPj8/PzwvYj48cT4/Pz8/Pz88L3E+IiwKICAgICAgNywKICAgICAgWzIyLCAxMl0KICAgICk7IC8vZGVidWcgcHVycG9zZXMgb25seQogICAgLy9uZXcgR2FtZS5VcGdyYWRlKCdBIHJlYWxseSBnb29kIGd1aWRlIGJvb2snLCc8Yj5BbGwgZHVuZ2VvbiBsb2NhdGlvbnMgYmVoYXZlIGFzIGlmIHVubG9ja2VkLjwvYj48YnI+PGI+WW91IG1heSBzaGlmdC1jbGljayBhIGR1bmdlb24gbG9jYXRpb24gdG8gdGVsZXBvcnQgdGhlcmUuPC9iPjxxPkl0IGV2ZW4gdGVsbHMgeW91IHdoaWNoIGhvdGVscyB0byBhdm9pZCE8L3E+Jyw3LFsyMiwxMl0pOy8vZGVidWcgcHVycG9zZXMgb25seQogICAgR2FtZS5sYXN0LmJ1eUZ1bmN0aW9uID0gZnVuY3Rpb24gKCkgewogICAgICBpZiAoR2FtZS5PYmplY3RzWyJGYWN0b3J5Il0ubWluaWdhbWVMb2FkZWQpIHsKICAgICAgICBHYW1lLk9iamVjdHNbIkZhY3RvcnkiXS5taW5pZ2FtZS5jb21wdXRlTWFwQm91bmRzKCk7CiAgICAgICAgR2FtZS5PYmplY3RzWyJGYWN0b3J5Il0ubWluaWdhbWUudXBkYXRlTG9jU3R5bGVzKCk7CiAgICAgIH0KICAgIH07CiAgICBHYW1lLmxhc3QucG9vbCA9ICJkZWJ1ZyI7CgogICAgb3JkZXIgPSAxMDMwMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJQcmlzbSBoZWFydCBiaXNjdWl0cyIsCiAgICAgIGRlc2M6ICJBbiBldmVyeS1mbGF2b3IgYmlzY3VpdCB0aGF0IHN0YW5kcyBmb3IgdW5pdmVyc2FsIGxvdmUgYW5kIGJlaW5nIHRydWUgdG8geW91cnNlbGYuIiwKICAgICAgcmVxdWlyZTogIkV0ZXJuYWwgaGVhcnQgYmlzY3VpdHMiLAogICAgICBzZWFzb246ICJ2YWxlbnRpbmVzIiwKICAgICAgaWNvbjogWzMwLCA4XSwKICAgICAgcG93ZXI6IGhlYXJ0UG93ZXIsCiAgICAgIHByaWNlOiAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwLAogICAgfSk7CiAgICBHYW1lLmxhc3Qub3JkZXIgPSAxMDMwMC4xNzU7CgogICAgb3JkZXIgPSAxOTEwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJLaXR0ZW4gd2FnZXMiLAogICAgICBsb2MoCiAgICAgICAgIlRocm91Z2ggY2xldmVyIGFjY291bnRpbmcsIHRoaXMgYWN0dWFsbHkgbWFrZXMga2l0dGVuIHVwZ3JhZGVzIDxiPiUxJSBjaGVhcGVyPC9iPi4iLAogICAgICAgIDEwCiAgICAgICkgKwogICAgICAgICI8cT5DYXRzIGNhbiBoYXZlIGxpdHRsZSBhIHNhbGFyeSwgYXMgYSB0cmVhdC48YnI+Q2F0cyBhcmUgZXhwZXJ0IGhhZ2dsZXJzIGFuZCBoYXZlIGEga2VlbiBzZW5zZSBvZiBiYXJnYWluaW5nLCBlc3BlY2lhbGx5IGluIHRoZSBjYXNlIG9mIGNhc2guPC9xPiIsCiAgICAgIDkwMDAwMDAwMDAsCiAgICAgIFszMSwgOF0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiS2l0dGVuIGFuZ2VscyJdOwogICAgR2FtZS5sYXN0LmtpdHRlbiA9IDE7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiUGV0IHRoZSBkcmFnb24iLAogICAgICBsb2MoCiAgICAgICAgIlVubG9ja3MgdGhlIGFiaWxpdHkgdG8gPGI+cGV0IHlvdXIgZHJhZ29uPC9iPiBieSBjbGlja2luZyBvbiBpdCBvbmNlIGhhdGNoZWQuIgogICAgICApICsKICAgICAgICAiPHE+RHJhZ29ucyBkbyBub3QgcHVyci4gSWYgeW91ciBkcmFnb24gc3RhcnRzIHB1cnJpbmcsIHZhY2F0ZSB0aGUgYXJlYSBpbW1lZGlhdGVseS48L3E+IiwKICAgICAgOTk5OTk5OTk5OTksCiAgICAgIFszMCwgMTJdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkhvdyB0byBiYWtlIHlvdXIgZHJhZ29uIiwgIlJlc2lkdWFsIGx1Y2siXTsKCiAgICBvcmRlciA9IDI1MTAwOwogICAgdmFyIGRyYWdvbkRyb3BVcGdyYWRlQ29zdCA9IGZ1bmN0aW9uIChtZSkgewogICAgICByZXR1cm4gKAogICAgICAgIEdhbWUudW5idWZmZWRDcHMgKgogICAgICAgIDYwICoKICAgICAgICAzMCAqCiAgICAgICAgKEdhbWUuZHJhZ29uTGV2ZWwgPCBHYW1lLmRyYWdvbkxldmVscy5sZW5ndGggLSAxID8gMSA6IDAuMSkKICAgICAgKTsKICAgIH07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRHJhZ29uIHNjYWxlIiwKICAgICAgZ2V0U3RyQ29va2llUHJvZHVjdGlvbk11bHRpcGxpZXJQbHVzKDMpICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygKICAgICAgICAgICJDb3N0IHNjYWxlcyB3aXRoIENwUywgYnV0ICUxIHRpbWVzIGNoZWFwZXIgd2l0aCBhIGZ1bGx5LXRyYWluZWQgZHJhZ29uLiIsCiAgICAgICAgICAxMAogICAgICAgICkgKwogICAgICAgICI8cT5Zb3VyIGRyYWdvbiBzaGVkcyB0aGVzZSByZWd1bGFybHksIHNvIHRoaXMgb25lIHByb2JhYmx5IHdvbid0IGJlIG1pc3NlZC48YnI+Tm90ZTogaWNvbiBub3QgdG8gc2NhbGUuPC9xPiIsCiAgICAgIDk5OSwKICAgICAgWzMwLCAxNF0KICAgICk7CiAgICBHYW1lLmxhc3QucHJpY2VGdW5jID0gZHJhZ29uRHJvcFVwZ3JhZGVDb3N0OwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkRyYWdvbiBjbGF3IiwKICAgICAgbG9jKCJDbGlja2luZyBpcyA8Yj4lMSU8L2I+IG1vcmUgcG93ZXJmdWwuIiwgMykgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKAogICAgICAgICAgIkNvc3Qgc2NhbGVzIHdpdGggQ3BTLCBidXQgJTEgdGltZXMgY2hlYXBlciB3aXRoIGEgZnVsbHktdHJhaW5lZCBkcmFnb24uIiwKICAgICAgICAgIDEwCiAgICAgICAgKSArCiAgICAgICAgIjxxPldpbGwgZ3JvdyBiYWNrIGluIGEgZmV3IGRheXMnIHRpbWUuPGJyPkEgc2l4LWluY2ggcmV0cmFjdGFibGUgY2xhdywgbGlrZSBhIHJhem9yLCBmcm9tIHRoZSBtaWRkbGUgdG9lLiBTbyB5b3Uga25vdywgdHJ5IHRvIHNob3cgYSBsaXR0bGUgcmVzcGVjdC48L3E+IiwKICAgICAgOTk5LAogICAgICBbMzEsIDE0XQogICAgKTsKICAgIEdhbWUubGFzdC5wcmljZUZ1bmMgPSBkcmFnb25Ecm9wVXBncmFkZUNvc3Q7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRHJhZ29uIGZhbmciLAogICAgICBsb2MoIkdvbGRlbiBjb29raWVzIGdpdmUgPGI+JTElPC9iPiBtb3JlIGNvb2tpZXMuIiwgMykgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJEcmFnb24gaGFydmVzdCBhbmQgRHJhZ29uZmxpZ2h0IGFyZSA8Yj4lMSUgc3Ryb25nZXI8L2I+LiIsIDEwKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoCiAgICAgICAgICAiQ29zdCBzY2FsZXMgd2l0aCBDcFMsIGJ1dCAlMSB0aW1lcyBjaGVhcGVyIHdpdGggYSBmdWxseS10cmFpbmVkIGRyYWdvbi4iLAogICAgICAgICAgMTAKICAgICAgICApICsKICAgICAgICAiPHE+SnVzdCBhIGZhbGxlbiBiYWJ5IHRvb3RoIHlvdXIgZHJhZ29uIHdhbnRlZCB5b3UgdG8gaGF2ZSwgYXMgYSBnaWZ0Ljxicj5JdCBtaWdodCBiZSBzbWFsbGVyIHRoYW4gYW4gYWR1bHQgdG9vdGgsIGJ1dCBpdCdzIHN0aWxsIGZyaWdodGVuaW5nbHkgc2hhcnAgLSBhbmQgZGlzcGxheXMgc29tZSBhd2UtaW5zcGlyaW5nIGNhdml0aWVzLCB3aGljaCB5b3UgbWlnaHQgZXhwZWN0IGZyb20gYSBjcmVhdHVyZSBtYWRlIG91dCBvZiBzd2VldHMuPC9xPiIsCiAgICAgIDk5OSwKICAgICAgWzMwLCAxNV0KICAgICk7CiAgICBHYW1lLmxhc3QucHJpY2VGdW5jID0gZHJhZ29uRHJvcFVwZ3JhZGVDb3N0OwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkRyYWdvbiB0ZWRkeSBiZWFyIiwKICAgICAgbG9jKCJSYW5kb20gZHJvcHMgYXJlIDxiPiUxJSBtb3JlIGNvbW1vbjwvYj4uIiwgMykgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKAogICAgICAgICAgIkNvc3Qgc2NhbGVzIHdpdGggQ3BTLCBidXQgJTEgdGltZXMgY2hlYXBlciB3aXRoIGEgZnVsbHktdHJhaW5lZCBkcmFnb24uIiwKICAgICAgICAgIDEwCiAgICAgICAgKSArCiAgICAgICAgIjxxPllvdXIgZHJhZ29uIHVzZWQgdG8gc2xlZXAgd2l0aCB0aGlzLCBidXQgaXQncyB5b3VycyBub3cuPGJyPkNyYWZ0ZWQgaW4gdGhlIGxpa2VsaW5lc3Mgb2YgYSBmZWFyc29tZSBiZWFzdC4gU3R1ZmZlZCB3aXRoIG1hZ2ljYWwgaGVyYnMgcGlja2VkIGxvbmcgYWdvIGJ5IGEgd2FuZGVyaW5nIHdpemFyZC4gV292ZW4gZnJvbSBlbHZlbiB5YXJuIGFuZCBhIHBvbHllc3RlciBibGVuZC48L3E+IiwKICAgICAgOTk5LAogICAgICBbMzEsIDE1XQogICAgKTsKICAgIEdhbWUubGFzdC5wcmljZUZ1bmMgPSBkcmFnb25Ecm9wVXBncmFkZUNvc3Q7CgogICAgb3JkZXIgPSAxMDAyMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJHcmFub2xhIGNvb2tpZXMiLAogICAgICBkZXNjOiAiV2FpdCEgVGhlc2UgYXJlIGp1c3Qgb2F0bWVhbCBjb29raWVzIG1peGVkIHdpdGggcmFpc2luIGNvb2tpZXMhIFdoYXQgbmV4dCwgaGFsZi1kYXJrIGNob2NvbGF0ZSBoYWxmLXdoaXRlIGNob2NvbGF0ZSBjb29raWVzPyIsCiAgICAgIGljb246IFsyOCwgMzJdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDI4KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlJpY290dGEgY29va2llcyIsCiAgICAgIGRlc2M6ICJMaWdodCBhbmQgY2FrZS1saWtlLiBPZnRlbiBmbGF2b3JlZCB3aXRoIGxlbW9uIG9yIGFsbW9uZCBleHRyYWN0LiBTcHJpbmtsZXMgb3B0aW9uYWwuIEFsbGVnZWRseSBJdGFsaWFuLiBJbnZlc3RpZ2F0aW9uIHBlbmRpbmcuIiwKICAgICAgaWNvbjogWzI5LCAzMl0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoMjkpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiUm96ZSBrb2VrZW4iLAogICAgICBkZXNjOiAiVGhlIGljaW5nIG9uIHRoZXNlIER1dGNoIGNvb2tpZXMgaXMgdHJhZGl0aW9uYWxseSBwaW5rLCBidXQgZGlmZmVyZW50IGNvbG9ycyBtYXkgYmUgdXNlZCBmb3Igc3BlY2lhbCBvY2Nhc2lvbnMgLSBzdWNoIGFzIHBpbmsgdG8gY2VsZWJyYXRlIEJyZWFzdCBDYW5jZXIgQXdhcmVuZXNzIE1vbnRoLCBvciBmb3IgSW50ZXJuYXRpb25hbCBGbGFtaW5nbyBEYXksIHBpbmsuIiwKICAgICAgaWNvbjogWzMwLCAzMl0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoMzApLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiUGVhbnV0IGJ1dHRlciBjdXAgY29va2llcyIsCiAgICAgIGRlc2M6ICJXaGF0IG1vcmUgcG9pZ25hbnQgZXhhbXBsZSBvZiBtb2Rlcm4gc29jaWV0YWwgc3RydWdnbGVzIHRoYW4gdGhlIGJyYXplbiByZWNsYWltaW5nIG9mIGEgY29ycG9yYXRlIHByb2R1Y3QgYnkgaW50ZWdyYXRpbmcgaXQgaW4gdGhlIHZhc3RseSBtb3JlIGF1dGhlbnRpYyBzaGVsbCBvZiBhIGhvbWVtYWRlIHVuZGVydGFraW5nPyBBbnl3YXkgdGhpcyBpcyBhIHBlYW51dCBidXR0ZXIgY3VwLCBiYWtlZCBpbnRvIGEgY29va2llLiBJdCdzIHByZXR0eSBnb29kISIsCiAgICAgIGljb246IFszMSwgMzJdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDMxKSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlNlc2FtZSBjb29raWVzIiwKICAgICAgZGVzYzogIkxvb2sgYXQgYWxsIHRoZSBsaXR0bGUgc2VlZHMgb24gdGhlc2UhIEl0J3MgbGlrZSBzb21lb25lIGRyb3BwZWQgdGhlbSBvbiB0aGUgc3RyZWV0IG9yIHNvbWV0aGluZyEgQSB2ZXJ5IHdlbGNvbWluZyBhbmQgZWR1Y2F0aW9uYWwgc3RyZWV0ISIsCiAgICAgIGljb246IFsyMiwgMzNdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDMyKSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlRhaXlha2kiLAogICAgICBkZXNjOiAiQSBwYXN0cnkgZmlzaCBmaWxsZWQgd2l0aCByZWQgYmVhbiBwYXN0ZSwgZG9vbWVkIHRvIGxpdmUgYW4gZXhpc3RlbmNlIG9mIGNvbnN0YW50IGFuZCBleGNydWNpYXRpbmcgcGFpbiBhcyBpdHMgYXF1YXRpYyBlbnZpcm9ubWVudCBzbG93bHkgZGlzc29sdmVzIGl0cyBzb2Z0IGRvdWdoeSBib2R5Ljxicj5BbHNvIGNvbWVzIGluIGNob2NvbGF0ZSBmbGF2b3IhIiwKICAgICAgaWNvbjogWzIzLCAzM10sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoMzMpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiVmFuaWxsZWtpcGZlcmwiLAogICAgICBkZXNjOiAiTnV0LWJhc2VkIGNvb2tpZXMgZnJvbSBDZW50cmFsIEV1cm9wZSwgY29hdGVkIGluIHBvd2RlcmVkIHZhbmlsbGEgc3VnYXIuIFJlZ3VsYXIga2lwZmVybCwgY3Jlc2NlbnQtc2hhcGVkIGJyZWFkIHJvbGxzIGZyb20gdGhlIHNhbWUgcmVnaW9uLCBhcmUgbXVjaCBsZXNzIGV4Y2l0aW5nLiIsCiAgICAgIGljb246IFsyNCwgMzNdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDM0KSwKICAgIH0pOwoKICAgIG9yZGVyID0gMTAzMDA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQ29zbWljIGNob2NvbGF0ZSBidXR0ZXIgYmlzY3VpdCIsCiAgICAgIGRlc2M6ICJSZXdhcmRlZCBmb3Igb3duaW5nIDU1MCBvZiBldmVyeXRoaW5nLjxicj5UaHJvdWdoIHNvbWUgc3RyYW5nZSB0cmljayBvZiBtYWdpYyBvciB0ZWNobm9sb2d5LCBsb29raW5nIGF0IHRoaXMgY29va2llIGlzIGxpa2UgcGVlcmluZyBpbnRvIGEgZGVlcCBvY2VhbiBvZiBhbmNpZW50IHN0YXJzLiBUaGUgb3JpZ2lucyBvZiB0aGlzIGJpc2N1aXQgYXJlIHVua25vd247IGl0cyBtYW51ZmFjdHVyZSwgYXMgZmFyIGFzIHlvdXIgYmVzdCBpbnZlc3RpZ2F0b3JzIGNhbiB0ZWxsLCBsZWZ0IG5vIHBhcGVyIHRyYWlsLiBGcm9tIGEgY2VydGFpbiBhbmdsZSwgaWYgeW91IHNxdWludCBoYXJkIGVub3VnaCwgeW91J2xsIG5vdGljZSB0aGF0IGEgbnVtYmVyIG9mIHN0YXJzIG5lYXIgdGhlIGNlbnRlciBhcmUgYXJyYW5nZWQgdG8gcmVzZW1ibGUgdGhlIG91dGxpbmUgb2YgeW91ciBvd24gZmFjZS4iLAogICAgICBpY29uOiBbMjcsIDMyXSwKICAgICAgcG93ZXI6IDEwLAogICAgICBwcmljZToKICAgICAgICA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiBidXR0ZXJCaXNjdWl0TXVsdCwKICAgICAgbG9ja2VkOiAxLAogICAgfSk7CgogICAgb3JkZXIgPSAxMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiTm9uaWxsaW9uIGZpbmdlcnMiLAogICAgICBnZXRTdHJUaG91c2FuZEZpbmdlcnNHYWluKDIwKSArCiAgICAgICAgIjxxPk9ubHkgZm9yIHRoZSBmcmVha2llc3QgaGFuZHNoYWtlcy48L3E+IiwKICAgICAgMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIFsxMiwgMzFdCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgMTMsIDApOwogICAgb3JkZXIgPSAxNTA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiTWlyYWN1bGl0ZSBtb3VzZSIsCiAgICAgIGdldFN0ckNsaWNraW5nR2FpbnMoMSkgKwogICAgICAgICI8cT5Db21wb3NlZCBvZiBhIG1hdGVyaWFsIHRoYXQgbmVpdGhlciBzY2llbmNlIG5vciBwaGlsb3NvcGh5IGFyZSBlcXVpcHBlZCB0byBjb25jZXB0dWFsaXplLiBBbmQgYm95LCBkb2VzIGl0IGV2ZXIgY2xpY2suPC9xPiIsCiAgICAgIDUwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwLAogICAgICBbMTEsIDMxXQogICAgKTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDEzLCAxMSk7CiAgICBvcmRlciA9IDIwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkdlbmVyYXRpb24gZGVnZW5lcmF0aW9uIiwKICAgICAgIjxxPkdlbmV0aWMgdGVzdGluZyBzaG93cyB0aGF0IG1vc3Qgb2YgeW91ciBncmFuZG1hcyBhcmUgaW5mZWN0ZWQgd2l0aCBhIHN0cmFuZ2UgZGVnZW5lcmF0aXZlIGRpc2Vhc2UgdGhhdCBvbmx5IHNlZW1zIHRvIGZ1cnRoZXIgdGhlaXIgcG93ZXJzOyB0aGUgbW9yZSB0aW1lIHBhc3NlcywgdGhlIG9sZGVyIHRoZXkgZ2V0LiBUaGlzIHNob3VsZCBjb25jZXJuIHlvdS48L3E+IiwKICAgICAgIkdyYW5kbWEiLAogICAgICAxMgogICAgKTsKICAgIG9yZGVyID0gMzAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiR2xvYmFsIHNlZWQgdmF1bHQiLAogICAgICAiPHE+QW4gZW5vcm1vdXMgZ2VuZXRpYyByZXBvc2l0b3J5IHRoYXQgY291bGQgb3V0bGl2ZSBhbiBhcG9jYWx5cHNlLiBHdWFyYW50ZWVzIHRoZSBzdXJ2aXZhbCBvZiB5b3VyIGVtcGlyZSwgb3IgYXQgdGhlIHZlcnkgbGVhc3QgaXRzIGFncmljdWx0dXJhbCBjb21wb25lbnRzLCBzaG91bGQgY2l2aWxpemF0aW9uIGZhbGwuIFdoaWNoIHNob3VsZCBiZSBhbnkgZGF5IG5vdy48L3E+IiwKICAgICAgIkZhcm0iLAogICAgICAxMgogICAgKTsKICAgIG9yZGVyID0gNDAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQWlyIG1pbmluZyIsCiAgICAgICI8cT5Zb3UndmUgZHVnIHlvdXIgZHJpbGxzIHRocm91Z2gganVzdCBhYm91dCBldmVyeSBzb2xpZCBzdXJmYWNlIHlvdSBjb3VsZCBmaW5kLiBCdXQgZGlkIHlvdSBrbm93IHJlY2VudCBhZHZhbmNlcyBoYXZlIHJldmVhbGVkIHVudG9sZCByaWNoZXMgaGlkaW5nIHdpdGhpbiBub24tc29saWQgc3VyZmFjZXMgdG9vPzwvcT4iLAogICAgICAiTWluZSIsCiAgICAgIDEyCiAgICApOwogICAgb3JkZXIgPSA1MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJCZWhhdmlvcmFsIHJlZnJhbWluZyIsCiAgICAgICI8cT5UaHJvdWdoIGNhcmVmdWwgc29jaWFsIGVuZ2luZWVyaW5nIHlvdSd2ZSBjb252aW5jZWQgeW91ciB3b3JrZXJzIHRoYXQgXCJ1bmlvblwiIGlzIGEgc2x1ciB0aGF0IG9ubHkgdGhlIG1vc3QgdmlsZSBhbmQgcmVwdWduYW50IGZpbHRoIGFtb25nIHVzIHdvdWxkIGV2ZXIgZGFyZSB1dHRlciEgU29tZXRpbWVzIHByb2dyZXNzIGlzbid0IGluIHRoZSBiaWcgbWFjaGluZXMsIGl0J3MgaW4gdGhlIGxpdHRsZSBsaWVzITwvcT4iLAogICAgICAiRmFjdG9yeSIsCiAgICAgIDEyCiAgICApOwogICAgb3JkZXIgPSA1MjU7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJBbHRydWlzdGljIGxvb3AiLAogICAgICAiPHE+WW91IGNvbnRyb2wgc28gbWFueSBicmFuY2hlcyBvZiB0aGUgZ2xvYmFsIGVjb25vbXkgYW5kIGxlZ2lzbGF0aXZlIGJvZGllcyB0aGF0LCB0aHJvdWdoIGEgcGFydGljdWxhcmx5IGNyZWF0aXZlIGxvb3Bob2xlLCBkb25hdGluZyBtb25leSAodG8geW91cnNlbGYpIGdyYW50cyB5b3UgZXZlbiBtb3JlIGNhc2ggaW4gdGF4IGRlZHVjdGlvbnMgdGhhbiB5b3Ugc3RhcnRlZCB3aXRoITwvcT4iLAogICAgICAiQmFuayIsCiAgICAgIDEyCiAgICApOwogICAgb3JkZXIgPSA1NTA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJBIG5vdmVsIGlkZWEiLAogICAgICAiPHE+WW91IGRvbid0IGdldCByaWNoIHN0YXJ0aW5nIGEgcmVsaWdpb24uIElmIHlvdSB3YW50IHRvIGdldCByaWNoLCB5b3Ugd3JpdGUgc2NpZW5jZSBmaWN0aW9uLjwvcT4iLAogICAgICAiVGVtcGxlIiwKICAgICAgMTIKICAgICk7CiAgICBvcmRlciA9IDU3NTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlNwZWxsaW5nIGJlZXMiLAogICAgICAiPHE+WW91J3ZlIHVubGVhc2hlZCBhIHN3YXJtIG9mIG1hZ2ljYWxseS1lbmhhbmNlZCBiZWVzIHVwb24gbWFua2luZCEgVGhlaXIgc3Rpbmdpbmcgc3BlbGxzIG1heSBiZSB0aGUgYmFuZSBvZiBhbGwgbGl2aW5nIHRoaW5ncyBidXQgeW91J3JlIGNlcnRhaW4geW91IGNhbiBwdXQgdGhlaXIgZGVsaWNpb3VzLCBwdXJwbGUsIGZpenp5IGhvbmV5IHRvIGdvb2QgdXNlITwvcT4iLAogICAgICAiV2l6YXJkIHRvd2VyIiwKICAgICAgMTIKICAgICk7CiAgICBvcmRlciA9IDYwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRvcm9pZCB1bml2ZXJzZSIsCiAgICAgICI8cT5JZiB5b3UgdGhpbmsgb2YgdGhlIHVuaXZlcnNlIGFzIGFuIG50aC1kaW1lbnNpb25hbCB0b3J1cyB0aGF0IHdyYXBzIGJhY2sgb24gaXRzZWxmIGluIGV2ZXJ5IGRpcmVjdGlvbiwgeW91IGNhbiBzYXZlIGEgZm9ydHVuZSBvbiByb2NrZXQgZnVlbCEgT2YgY291cnNlIHRoZSB1bml2ZXJzZSBpc24ndCBhY3R1YWxseSBzaGFwZWQgbGlrZSB0aGF0LCBidXQgeW91J3ZlIG5ldmVyIGxldCBkZXRhaWxzIHN0YW5kIGluIHlvdXIgd2F5LjwvcT4iLAogICAgICAiU2hpcG1lbnQiLAogICAgICAxMgogICAgKTsKICAgIG9yZGVyID0gNzAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiSGVybWV0aWMgcmVjb25jaWxpYXRpb24iLAogICAgICAiPHE+SXQncyB0aW1lIGZvciBtb2Rlcm4gc2NpZW5jZSBhbmQgdGhlIG15c3RpY2FsIGRvbWFpbnMgb2YgdGhlIG9jY3VsdCB0byB3b3JrIHRvZ2V0aGVyIGF0IGxhc3QuIFdoYXQgZG8gZ3Jhdml0b25zIHRyYW5zbXV0ZSBpbnRvPyBXaGF0IGlmIGFsa2FoZXN0IGlzIHBILW5ldXRyYWw/IFNob3VsZCBhIGhvbXVuY3VsdXMgaGF2ZSB0aGUgcmlnaHQgdG8gdm90ZT8gQW5kIG90aGVyIGV4Y2l0aW5nIHF1ZXN0aW9ucyBjb21pbmcgdG8geW91IHNvb24sIHdoZXRoZXIgeW91IGxpa2UgaXQgb3Igbm90LjwvcT4iLAogICAgICAiQWxjaGVteSBsYWIiLAogICAgICAxMgogICAgKTsKICAgIG9yZGVyID0gODAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiSGlzIGFkdmVudCIsCiAgICAgICI8cT5IZSBjb21lcyEgSGUgY29tZXMgYXQgbGFzdCEgSnVzdCBsaWtlIHRoZSBwcm9waGVjaWVzIGZvcmV0b2xkISBBbmQgYXMgSGUgc3RlcHMgb3V0IG9mIHRoZSBwb3J0YWwsIHlvdXIgZW5naW5lZXJzIGJlZ2luIHNsaWNpbmcgSGltIGludG8gY29udmVuaWVudCBjaHVua3MgYmVmb3JlIHRyYW5zcG9ydGluZyBIaXMgd3JpdGhpbmcgY29zbWljIGZsZXNoIHRvIHlvdXIgZmFjdG9yaWVzLCB3aGVyZSBIZSB3aWxsIGJlIHByb2Nlc3NlZCBhbmQgY29udmVydGVkIGludG8gYSBuZXcgYW5kIGV4Y2l0aW5nIGNvb2tpZSBmbGF2b3IsIGF2YWlsYWJsZSBpbiBzdG9yZXMgdG9tb3Jyb3cuPC9xPiIsCiAgICAgICJQb3J0YWwiLAogICAgICAxMgogICAgKTsKICAgIG9yZGVyID0gOTAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiU3BsaXQgc2Vjb25kcyIsCiAgICAgICI8cT5UaW1lIGlzIGluZmluaXRlLCB5ZXMuLi4gQnV0IHdoYXQgaWYsIG5lc3RsZWQgd2l0aGluIGVhY2ggc2Vjb25kLCB3ZXJlIGV2ZW4gbW9yZSBpbmZpbml0aWVzPyBFdmVyeSBtb21lbnQgYW4gZXRlcm5pdHkhIFRoaW5rIG9mIGhvdyBtYW55IHNjaGVkdWxpbmcgdHJvdWJsZXMgdGhpcyBzb2x2ZXMhPC9xPiIsCiAgICAgICJUaW1lIG1hY2hpbmUiLAogICAgICAxMgogICAgKTsKICAgIG9yZGVyID0gMTAwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkZsYXZvciBpdHNlbGYiLAogICAgICAiPHE+RGVlcCB1bmRlciB0aGUgZWFydGgsIGluIHRoZSBtb3N0IHN0ZXJpbGUgbGFib3JhdG9yeSwgaW4gdGhlIG1vc3QgdmFzdCBhbmQgZXhwZW5zaXZlIHBhcnRpY2xlIGFjY2VsZXJhdG9yIGV2ZXIgZGV2aXNlZCwgeW91ciBzY2llbnRpc3RzIGhhdmUgc3ludGhlc2l6ZWQgLWZvciBhIGZyYWN0aW9uIG9mIGEgc2Vjb25kLSB0aGUgcGh5c2ljYWwgbWFuaWZlc3RhdGlvbiBvZiBwdXJlIGZsYXZvci4gSGlnaGx5IHVuc3RhYmxlLCBhbmQgZ29uZSBpbiBhIHB1ZmYgb2YgcmFkaW9hY3RpdmUgZW5lcmd5LCBpdCBub25ldGhlbGVzcyBsZWZ0IHlvdXIgdGVhbSBzaGl2ZXJpbmcgd2l0aCBhd2UuLi4gYW5kIGh1bmdlci48L3E+IiwKICAgICAgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwKICAgICAgMTIKICAgICk7CiAgICBvcmRlciA9IDExMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJMaWdodCBzcGVlZCBsaW1pdCIsCiAgICAgICI8cT5XaG9haCwgc2xvdyBkb3duLiBIYXJ2ZXN0aW5nIGxpZ2h0IGlzIHdlbGwgYW5kIGdvb2QgYnV0IGl0J2QgYmUgbXVjaCBlYXNpZXIgaWYgaXQgd2VyZW4ndCBzbyBkYW5nIGZhc3QhIFRoaXMgc2hvdWxkIHRoYW5rZnVsbHkgdGFrZSBjYXJlIG9mIHRoYXQuPC9xPiIsCiAgICAgICJQcmlzbSIsCiAgICAgIDEyCiAgICApOwogICAgb3JkZXIgPSAxMjAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQSB0b3VjaCBvZiBkZXRlcm1pbmlzbSIsCiAgICAgICI8cT5CeSBrbm93aW5nIHRoZSBleGFjdCBwb3NpdGlvbiBhbmQgbW92ZW1lbnQgb2YgZXZlcnkgcGFydGljbGUgaW4gdGhlIHVuaXZlcnNlLCB5b3UncmUgYWJsZSB0byBwcmVkaWN0IGV2ZXJ5dGhpbmcgdGhhdCBjYW4gZXZlciBoYXBwZW4sIGxlYXZpbmcgbm90aGluZyB0byBjaGFuY2UuIFRoaXMgd2FzIGEgZG9venkgdG8gcHVsbCBvZmYgbWluZCB5b3UsIGJ1dCBpdCdzIGhlbHBlZCB5b3Ugd2luIDUwIGJ1Y2tzIGF0IHRoZSBob3JzZSByYWNlcyBzbyB5b3UgY291bGQgc2F5IGl0J3MgYWxyZWFkeSBwYXlpbmcgb2ZmLjwvcT4iLAogICAgICAiQ2hhbmNlbWFrZXIiLAogICAgICAxMgogICAgKTsKICAgIG9yZGVyID0gMTMwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRoaXMgdXBncmFkZSIsCiAgICAgICI8cT5UaGlzIHVwZ3JhZGUncyBmbGF2b3IgdGV4dCBsaWtlcyB0byByZWZlciB0byBpdHNlbGYsIGFzIHdlbGwgYXMgdG8gdGhlIGZhY3QgdGhhdCBpdCBsaWtlcyB0byByZWZlciB0byBpdHNlbGYuIFlvdSBzaG91bGQgcmVhbGx5IGJ1eSB0aGlzIHVwZ3JhZGUgYmVmb3JlIGl0IHN0YXJ0cyBkb2luZyBhbnl0aGluZyBtb3JlIG9ibm94aW91cy48L3E+IiwKICAgICAgIkZyYWN0YWwgZW5naW5lIiwKICAgICAgMTIKICAgICk7CiAgICBvcmRlciA9IDE0MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJZb3VyIGJpZ2dlc3QgZmFucyIsCiAgICAgICI8cT5MZXQncyBmYWNlIGl0LCBiYWtpbmcgY29va2llcyBpc24ndCB0aGUgbW9zdCBvcHRpbWl6ZWQgdGhpbmcgdGhlcmUgaXMuIFNvIHlvdSd2ZSBwdXJjaGFzZWQgeW91ciBiaWdnZXN0IGZhbnMgeWV0IGFuZCBzdHVjayB0aGVtIG5leHQgdG8geW91ciBjb21wdXRlcnMgdG8ga2VlcCB0aGluZ3MgY2hpbGwgYW5kIGluIHdvcmtpbmcgb3JkZXIuIENvb2whPC9xPiIsCiAgICAgICJKYXZhc2NyaXB0IGNvbnNvbGUiLAogICAgICAxMgogICAgKTsKCiAgICBvcmRlciA9IDEwMDIwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkJhdHRlbmJlcmcgYmlzY3VpdHMiLAogICAgICBkZXNjOiAiSW5zcGlyZWQgYnkgYSBjYWtlIG9mIHRoZSBzYW1lIG5hbWUsIGl0c2VsZiBuYW1lZCBhZnRlciBhIHByaW5jZSBvZiB0aGUgc2FtZSBuYW1lLiBZb3Ugc3VwcG9zZSB5b3UgY291bGQgcGxheSBhIHJlYWxseSwgcmVhbGx5IHNob3J0IGdhbWUgb2YgY2hlc3Mgb24gdGhlc2UuIiwKICAgICAgaWNvbjogWzI4LCAzM10sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoMzUpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiUm9zZXR0ZSBjb29raWVzIiwKICAgICAgZGVzYzogIkludHJpY2F0ZSBmcmllZCBwYXN0cmllcyBmcm9tIE5vcnRoZXJuIEV1cm9wZSwgbWFkZSB1c2luZyBzcGVjaWFsaXplZCBpcm9ucyBhbmQgZGlwcGVkIGluIGljaW5nIHN1Z2FyLiBXaGlsZSB1c3VhbGx5IGVhdGVuIGFzIGEgZGVsaWNpb3VzIHRyZWF0LCB0aGVzZSBhcmUgb2Z0ZW4gYWxzbyB1c2VkIGFzIENocmlzdG1hcyB0cmVlIGRlY29yYXRpb25zLCBvciB3b3JuIGVsZWdhbnRseSBvbiBvbmUncyBsYXBlbCB0byBzeW1ib2xpemUgdGhlIG5haCBJJ20ganVzdCBtZXNzaW5nIHdpdGggeW91LiIsCiAgICAgIGljb246IFsyNiwgMzNdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDM2KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkdhbmdtYWtlcnMiLAogICAgICBkZXNjOiAiVGhlIGxpdHRsZSBiaXQgb2YgcmFzcGJlcnJ5IGphbSBhdCBpdHMgY2VudGVyIGlzIGNydWNpYWw7IGEgcGxhaW4gYnV0dGVyIGNvb2tpZSB3aXRoIGNob2NvbGF0ZSB0b3BwaW5nIGRvZXMgbm90IGEgZ2FuZ21ha2VyIG1ha2UuIiwKICAgICAgaWNvbjogWzI3LCAzM10sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoMzcpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiV2Vsc2ggY29va2llcyIsCiAgICAgIGRlc2M6ICJXZWxzaCBjb29raWVzLCBhbHNvIGtub3duIGFzIFdlbHNoIGNha2VzLCBiYWtlc3RvbmVzLCBncmlkZGxlIGNha2VzLCBncmlkZGxlIHNjb25lcywgb3IgcGljcywgb3IgaW4gV2Vsc2g6IDxpPnBpY2F1IGFyIHkgbWFlbiwgcGljZSBiYWNoLCBjYWNlbm5hdSBjcmk8L2k+IG9yIDxpPnRlaXNlbm5hdSBncmFkZWxsPC9pPiwgYXJlIHJpY2ggY3VycmFudC1maWxsZWQgc2NvbmUtbGlrZSBiaXNjdWl0cyBvZiB1bmNlcnRhaW4gb3JpZ2luLiIsCiAgICAgIGljb246IFsyOSwgMzNdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDM4KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlJhc3BiZXJyeSBjaGVlc2VjYWtlIGNvb2tpZXMiLAogICAgICBkZXNjOiAiVGhlIGh1bWJsZSByYXNwYmVycnkgY2hlZXNlY2FrZSwgbm93IGluIGFzY2VuZGVkIGNvb2tpZSBmb3JtLiBSZXNlYXJjaGVycyBwb3NpdCB0aGF0IHJhc3BiZXJyeSBjaGVlc2VjYWtlIGNvb2tpZXMgYXJlIGV2aWRlbmNlIHRoYXQgdGhlIGZpbmFsIGZvcm0gb2YgZXZlcnkgYmFrZWQgZ29vZCwgdGhyb3VnaCBjb252ZXJnZW50IGV2b2x1dGlvbiwgYXBwcm9hY2hlcyB0aGF0IG9mIGEgY29va2llLCBpbiBhIHByb2Nlc3Mga25vd24gYXMgY29va2llbmlzYXRpb24uIiwKICAgICAgaWNvbjogWzI1LCAzM10sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoMzkpLAogICAgfSk7CgogICAgb3JkZXIgPSAyNTU7CiAgICBHYW1lLkdyYW5kbWFTeW5lcmd5KAogICAgICAiQWx0ZXJuYXRlIGdyYW5kbWFzIiwKICAgICAgIkEgZGlmZmVyZW50IGdyYW5kbWEgdG8gYmFrZSBzb21ldGhpbmcgZWxzZS4iLAogICAgICAiSWRsZXZlcnNlIgogICAgKTsKCiAgICBvcmRlciA9IDE1MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJNYW5pZmVzdCBkZXN0aW55IiwKICAgICAgIjxxPldoaWxlIHRoZSBldGhpY3Mgb2YgcmFuc2Fja2luZyBwYXJhbGxlbCB1bml2ZXJzZXMgZm9yIHRoZWlyIHJpY2hlcyBtYXkgc2VlbSBxdWVzdGlvbmFibGUgdG8gc29tZSwgeW91J3ZlIHJlYXNvbmVkIHRoYXQgYnJpbmdpbmcgdGhlIGdvb2Qgd29yZCBvZiB5b3VyIGNvb2tpZSBlbXBpcmUgdG8gdGhlIHVud2FzaGVkIGNvbmZpbmVzIG9mIG90aGVyIHJlYWxpdGllcyBpcyB5b3VyIG1vcmFsIGR1dHksIG5heSwgeW91ciByaWdodGVvdXMgaW1wZXJhdGl2ZSwgYW5kIG11c3QgYmUgdW5kZXJ0YWtlbiBhcyBzb29uIGFzIHBvc3NpYmxlLCBsZXN0IHRoZXkgZG8gaXQgdG8geW91IGZpcnN0ITwvcT4iLAogICAgICAiSWRsZXZlcnNlIiwKICAgICAgMQogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRoZSBtdWx0aXZlcnNlIGluIGEgbnV0c2hlbGwiLAogICAgICAnPHE+VGhlIHN0cnVjdHVyZSBvZiB0aGUgbWV0YWNvc21vcyBtYXkgc2VlbSBjb25mdXNpbmcgYW5kIGF0IHRpbWVzIGV2ZW4gY29udHJhZGljdG9yeSwgYnV0IGhlcmVcJ3Mgd2hhdCB5b3VcJ3ZlIGdhdGhlcmVkIHNvIGZhcjo8YnI+PGJyPjxkaXYgc3R5bGU9InRleHQtYWxpZ246bGVmdDsiPiZidWxsOyBlYWNoIHJlYWxpdHksIG9yICJpZGxldmVyc2UiLCBleGlzdHMgaW4gcGFyYWxsZWwgdG8gYWxsIG90aGVyczxicj48YnI+JmJ1bGw7IG1vc3QgcmVhbGl0aWVzIHNlZW0gdG8gY29udmVyZ2UgdG93YXJkcyB0aGUgcHJvZHVjdGlvbiBvZiBhIHNvbGUgdHlwZSBvZiBpdGVtIChvdXJzIGV2aWRlbnRseSBiZWluZywgdGhhbmtzIHRvIHlvdSwgY29va2llcyk8YnI+PGJyPiZidWxsOyBlYWNoIHJlYWxpdHkgaXMgcmlkZGxlZCB3aXRoIGNoYW90aWMgdHVubmVscyB0byBhIG51bWJlciBvZiBzdWJvcmRpbmF0ZSBkaW1lbnNpb25zIChzdWNoIGFzIHRoZSBzby1jYWxsZWQgImNvb2tpZXZlcnNlIiksIG11Y2ggbGlrZSBzd2lzcyBjaGVlc2U8YnI+PGJyPiZidWxsOyBhbGwgcmVhbGl0aWVzIGJhdGhlIGluIGFuIGluZmluaXRlIGxpcXVpZCBvZiBwZWN1bGlhciBwcm9wZXJ0aWVzLCBjb2xsb3F1aWFsbHkga25vd24gYXMgIm1pbGsiPC9kaXY+PGJyPkZpbmFsbHksIGVhY2ggcmVhbGl0eSBtYXkgaGF2ZSBpdHMgb3duIGludGVycHJldGF0aW9uIG9mIHRoZSBjb25jZXB0IG9mICJyZWFsaXR5IiwgZm9yIGFkZGVkIGZ1bi48L3E+JywKICAgICAgIklkbGV2ZXJzZSIsCiAgICAgIDIKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJBbGwtY29udmVyc2lvbiIsCiAgICAgICI8cT5JdCdzIHF1aXRlIG5pY2UgdGhhdCB5b3UgY2FuIHJld2lyZSB0aGUgbG9naWMgb2YgZWFjaCB1bml2ZXJzZSB0byBnZW5lcmF0ZSBjb29raWVzIGluc3RlYWQsIGJ1dCB5b3Ugc3RpbGwgZW5kIHVwIHdpdGggcGFyc2VjLWxvYWRzIG9mIHdoYXRldmVyIHRoZXkgd2VyZSBwcm9kdWNpbmcgYmVmb3JlIC0gYmF1YmxlcyB5b3UndmUgbG9uZyBtYWRlIG9ic29sZXRlOiBjYXNoIG1vbmV5LCBnZW1zLCBjaGVlc2VidXJnZXJzLCBwdXBwaWVzLi4uIFRoYXQncyB3aHkgeW91J3ZlIGRlc2lnbmVkIHRoZSB1bml2ZXJzYWwgY29udmVydGVyLCBjb21wYXRpYmxlIHdpdGggYW55IHN1YnN0YW5jZSBhbmQgY2FwYWJsZSBvZiB0dXJuaW5nIHRob3NlIHVzZWxlc3Mgc3BvaWxzIG9mIGNvbnF1ZXN0IGludG8gdGhlIHJlYXNzdXJpbmcgY3J1bWJseSBydXN0bGUgb2YgZXZlbiBtb3JlIGNvb2tpZXMuPC9xPiIsCiAgICAgICJJZGxldmVyc2UiLAogICAgICAzCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiTXVsdGl2ZXJzZSBhZ2VudHMiLAogICAgICAiPHE+WW91IGNhbiBzZW5kIHVuZGVyY292ZXIgc3BpZXMgdG8gaW5maWx0cmF0ZSBlYWNoIHVuaXZlcnNlIGFuZCBoYXZlIHRoZW0gc2lnbmFsIHlvdSB3aGV0aGVyIGl0J3Mgd29ydGggb3ZlcnRha2luZy4gT25jZSB0aGUgYXNzaW1pbGF0aW9uIHByb2Nlc3Mgc3RhcnRlZCwgdGhleSB3aWxsIGFsc28gaGVscCBwYWNpZnkgdGhlIGxvY2FsIHBvcHVsYXRpb25zLCBoYXZpbmcgZXN0YWJsaXNoZWQgdHJ1c3QgdGhyb3VnaCB0aGUgdXNlIG9mIHdhY2t5LCBidXQgc2VhbWxlc3MsIGRpc2d1aXNlcy48L3E+IiwKICAgICAgIklkbGV2ZXJzZSIsCiAgICAgIDQKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJFc2NhcGUgcGxhbiIsCiAgICAgICI8cT5Zb3UndmUgc2V0IGFuIGlkbGV2ZXJzZSBhc2lkZSBhbmQgdGVycmFmb3JtZWQgaXQgdG8gY2xvc2VseSByZXNlbWJsZSB0aGlzIG9uZSBpbiBjYXNlIHNvbWV0aGluZyBnb2VzIGhvcnJpYmx5IHdyb25nIGluIGhlcmUuIE9mIGNvdXJzZSwgdGhlIGRlbml6ZW5zIG9mIHRoYXQgaWRsZXZlcnNlIGFsc28gaGF2ZSB0aGVpciBvd24gZXNjYXBlIGlkbGV2ZXJzZSB0byBhYnNjb25kIHRvIGluIHRoZSBldmVudHVhbGl0eSBvZiB5b3VyIGFycml2YWwsIGl0c2VsZiBsaWtlbHkgaGF2aW5nIGl0cyBvd24gY29udGluZ2VuY3kgaWRsZXZlcnNlLCBhbmQgc28gb24uPC9xPiIsCiAgICAgICJJZGxldmVyc2UiLAogICAgICA1CiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiR2FtZSBkZXNpZ24iLAogICAgICAiPHE+RWFjaCBpZGxldmVyc2UgZnVuY3Rpb25zIGFjY29yZGluZyB0byBzb21lIGZvcm0gb2YgdHJhbnNjZW5kZW50YWwgcHJvZ3JhbW1pbmcsIHRoYXQgbXVjaCBpcyBhIGdpdmVuLiBCdXQgdGhleSBhbHNvIHNlZW0gdG8gYmUgZ292ZXJuZWQgYnkgbXVjaCBtb3JlIHN1YnRsZSBydWxlcywgdGhlIGxvZ2ljIG9mIHdoaWNoLCB3aGVuIGhhcm5lc3NlZCwgbWF5IGdpdmUgeW91IHVucGFyYWxsZWxlZCBkb21pbmlvbiBvdmVyIHRoZSBtdWx0aXZlcnNlLiBSZXdyaXRlIHRoZSBydWxlcyEgQSBnYW1lIGRlc2lnbmVyIGlzIHlvdSE8L3E+IiwKICAgICAgIklkbGV2ZXJzZSIsCiAgICAgIDYKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJTYW5kYm94IHVuaXZlcnNlcyIsCiAgICAgICI8cT5JdCBkb2Vzbid0IHNlZW0gbGlrZSB5b3UnbGwgcnVuIG91dCBvZiBleHRyYSB1bml2ZXJzZXMgYW55dGltZSBzb29uIHNvIHdoeSBub3QgcmVwdXJwb3NlIHNvbWUgb2YgdGhlbSBhcyBjb25zZXF1ZW5jZS1mcmVlIHRlc3RpbmcgZ3JvdW5kcyBmb3IgYWxsIHlvdXIgbW9yZSBleGlzdGVudGlhbGx5IHRocmVhdGVuaW5nIG1hcmtldCByZXNlYXJjaD8gKC4uLmNvbnNlcXVlbmNlLWZyZWUgZm9yIHlvdSwgYW55d2F5Lik8L3E+IiwKICAgICAgIklkbGV2ZXJzZSIsCiAgICAgIDcKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJNdWx0aXZlcnNlIHdhcnMiLAogICAgICAiPHE+SG1tLCBsb29rcyBsaWtlIHNvbWUgb3RoZXIgdW5pdmVyc2VzIHdpc2VkIHVwIHRvIHlvdXIgcGx1bmRlcmluZy4gVGhhbmtmdWxseSwgdGhhdCdzIG5vdGhpbmcgeW91ciBleHRyYSBiZWVmZWQtdXAgbWV0YWNvc21pYyBtaWxpdGFyeSBidWRnZXQgY2FuJ3QgaGFuZGxlITwvcT4iLAogICAgICAiSWRsZXZlcnNlIiwKICAgICAgOAogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIk1vYmlsZSBwb3J0cyIsCiAgICAgICI8cT5BY2Nlc3NpbmcgZWFjaCBvdXRlciB1bml2ZXJzZSBpcyBhIGJpdCBvZiBhIGhhc3NsZSwgcmVxdWlyaW5nIHRoZSBvbmNlLWluLWEtYmx1ZS1tb29uIGFsaWdubWVudCBvZiBuYXR1cmFsIGNvc21pYyBwb3J0cyB0byB0cmFuc2l0IGZyb20gdW5pdmVyc2UgdG8gdW5pdmVyc2UuIFlvdSd2ZSBmaW5hbGx5IHBlcmZlY3RlZCB0aGUgbWV0aG9kIG9mIGNvbnN0cnVjdGluZyB5b3VyIG93biBzZWxmLXByb3BlbGxlZCBwb3J0cywgd2hpY2ggY2FuIHRyYXZlbCBuZWFyLWluc3RhbnRhbmVvdXNseSBhbG9uZyB1bml2ZXJzYWwgcGVyaW1ldGVycyB0byBwZXJtaXQgaGVhZGFjaGUtZnJlZSBtdWx0aXZlcnNlIGNvbm5lY3Rpb25zLiBUb29rIHlvdSBsb25nIGVub3VnaC48L3E+IiwKICAgICAgIklkbGV2ZXJzZSIsCiAgICAgIDkKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJFbmNhcHN1bGF0ZWQgcmVhbGl0aWVzIiwKICAgICAgIjxxPlVudG9sZCBmZWF0cyBvZiBzY2llbmNlIHdlbnQgaW50byB0aGUgcmVkdWN0aW9uIG9mIGluZmluaXRlIHVuaXZlcnNlcyBpbnRvIHRoZXNlIHNtYWxsLCBnbGltbWVyaW5nLCBlYXN5LXRvLXN0b3JlIGxpdHRsZSBzcGhlcmVzLiBFeGVyY2lzZSBpbmZpbml0ZSBjYXV0aW9uIHdoZW4gaGFuZGxpbmcgdGhlc2UsIGZvciBlYWNoIG9mIHRoZW0sIGNvbnRhaW5pbmcgZW5kbGVzcyBnYWxheGllcyBhbmQgc3VwcG9ydGluZyBlbmRsZXNzIGxpZmUsIGlzIG1vcmUgcHJlY2lvdXMgdGhhbiB5b3UgY2FuIGV2ZXIgZmF0aG9tLiBUaGV5J3ZlIGFsc28gcHJvdmVuIHRvIGJlIHF1aXRlIGEgc21hc2ggaGl0IGluIHlvdXIgd2FyZWhvdXNlcyBvbiBib3dsaW5nIG5pZ2h0LjwvcT4iLAogICAgICAiSWRsZXZlcnNlIiwKICAgICAgMTAKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJFeHRyaW5zaWMgY2xpY2tpbmciLAogICAgICAiPHE+SWYgeW91IHBva2UgYW4gaWRsZXZlcnNlLCBpdCBzZWVtcyBsaWtlIGl0IGdldHMgd29yayBkb25lIGZhc3Rlci4gSXQncyBhbHNvIHF1aXRlIGZ1biBoZWFyaW5nIGEgdHJpbGxpb24gdGVycmlmaWVkIHZvaWNlcyBzY3JlYW1pbmcgaW4gdW5pc29uLjwvcT4iLAogICAgICAiSWRsZXZlcnNlIiwKICAgICAgMTEKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJVbml2ZXJzYWwgaWRsaW5nIiwKICAgICAgIjxxPlRoZSBuYXR1cmUgb2YgaWRsZXZlcnNlcyBpcyBmb3VuZCBpbiB3YWl0aW5nLiBUaGUgbW9yZSB5b3Ugd2FpdCBvbiBhbiBpZGxldmVyc2UsIHRoZSBtb3JlIGV4cG9uZW50aWFsbHkgcG90ZW50IGl0IGJlY29tZXMgLSB3aGljaCBzYXZlcyB5b3UgYSB3aG9sZSBsb3Qgb2YgaGFyZCB3b3JrLiBJbiBhIHRydWUgYWN0IG9mIHplbiwgeW91J3ZlIHRha2VuIHRvIGJpZGluZyB5b3VyIHRpbWUgd2hlbiBjb2xsZWN0aW5nIG5ldyB1bml2ZXJzZXMsIGxldHRpbmcgdGhlbSByaXBlbiBsaWtlIGEgZmluZSB3aW5lLjwvcT4iLAogICAgICAiSWRsZXZlcnNlIiwKICAgICAgMTIKICAgICk7CgogICAgb3JkZXIgPSA1MDAwOwogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIlBlcmZvcmF0ZWQgbWlsbGUtZmV1aWxsZSBjb3Ntb3MiLAogICAgICAiPHE+SW1hZ2luZSwgaWYgeW91IHdpbGwsIGxheWVycyB1cG9uIGxheWVycyB1cG9uIGxheWVycy4gTm93IHBpY3R1cmUgYmlsbGlvbnMgb2Ygd29ybXMgY2hld2luZyB0aGVpciB3YXkgdGhyb3VnaCBpdCBhbGwuIFRoaXMgcm91Z2hseSwgYnV0IG5vdCBxdWl0ZSwgYXBwcm94aW1hdGVzIHRoZSBnZW9tZXRyeSBvZiB0aGUgbW9zdCBiYXNhbCBzdHJhdHVtIG9mIG91ciBuYXR1cmFsIHdvcmxkLjwvcT4iLAogICAgICAiSWRsZXZlcnNlIiwKICAgICAgIlBvcnRhbCIsCiAgICAgICJzeW5lcmd5MSIKICAgICk7CiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlKAogICAgICAiSW5mcmF2ZXJzZXMgYW5kIHN1cGVydmVyc2VzIiwKICAgICAgIjxxPlVuaXZlcnNlcyB3aXRoaW4gdW5pdmVyc2VzPyBIb3cgc3VidmVyc2l2ZSE8L3E+IiwKICAgICAgIklkbGV2ZXJzZSIsCiAgICAgICJGcmFjdGFsIGVuZ2luZSIsCiAgICAgICJzeW5lcmd5MiIKICAgICk7CgogICAgb3JkZXIgPSAxOTAwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkZvcnR1bmUgIzAxOCIsCiAgICAgICI8cT5UaGVyZSdzIHBsZW50eSBvZiBldmVyeW9uZSwgYnV0IG9ubHkgb25lIG9mIHlvdS48L3E+IiwKICAgICAgIklkbGV2ZXJzZSIsCiAgICAgICJmb3J0dW5lIgogICAgKTsKCiAgICBvcmRlciA9IDEwMzAwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkJ1dHRlciBiaXNjdWl0ICh3aXRoIGJ1dHRlcikiLAogICAgICBkZXNjOiAiUmV3YXJkZWQgZm9yIG93bmluZyA2MDAgb2YgZXZlcnl0aGluZy48YnI+VGhpcyBpcyBhIHBsYWluIGJ1dHRlciBiaXNjdWl0LiBJdCdzIGdvdCBzb21lIGJ1dHRlciBvbiBpdC4gVGhlIGJ1dHRlciBkb2Vzbid0IGxvb2sgbGlrZSBhbnl0aGluZyBpbiBwYXJ0aWN1bGFyLiIsCiAgICAgIGljb246IFszMCwgMzNdLAogICAgICBwb3dlcjogMTAsCiAgICAgIHByaWNlOgogICAgICAgIDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSAqIGJ1dHRlckJpc2N1aXRNdWx0LAogICAgICBsb2NrZWQ6IDEsCiAgICB9KTsKCiAgICBvcmRlciA9IDIwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlZpc2l0cyIsCiAgICAgICI8cT5JbiBhbiBleHRlbnNpdmUgZG91YmxlLWJsaW5kIHN0dWR5IChzYW1wbGUgc2l6ZTogMTIgbWlsbGlvbiksIHlvdXIgcmVzZWFyY2hlcnMgaGF2ZSBmb3VuZCBldmlkZW5jZSB0aGF0IGdyYW5kbWFzIGFyZSB1cCB0byB0d2ljZSBhcyBwcm9kdWN0aXZlIGlmIHlvdSBqdXN0IGNvbWUgYnkgYW5kIHNheSBoaSBvbmNlIGluIGEgd2hpbGUuIEl0J3MgbmljZSB0byBjaGVjayB1cCBvbiB5b3VyIGdyYW5zISAoRG8gbm90IHVuZGVyIGFueSBjaXJjdW1zdGFuY2VzIGluZ2VzdCBhbnkgdGVhIG9yIHRlYS1saWtlIHN1YnN0YW5jZXMgdGhlIGdyYW5kbWFzIG1heSBvZmZlciB5b3UuKTwvcT4iLAogICAgICAiR3JhbmRtYSIsCiAgICAgIDEzCiAgICApOwogICAgb3JkZXIgPSAzMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJSZXZlcnNlLXZlZ2FuaXNtIiwKICAgICAgIjxxPlBsYW50cyBhcmVuJ3QgZm9yIGVhdGluZywgcGxhbnRzIGFyZSBmb3IgZXhwbG9pdGF0aXZlIGFncmljdWx0dXJlIGFuZCBhc3Ryb25vbWljYWwgcHJvZml0IG1hcmdpbnMhPC9xPiIsCiAgICAgICJGYXJtIiwKICAgICAgMTMKICAgICk7CiAgICBvcmRlciA9IDQwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkNhcmFtZWwgYWxsb3lzIiwKICAgICAgIjxxPllvdXIgZ2VvbG9naXN0cyBoYXZlIGlzb2xhdGVkIGEgZmFtaWx5IG9mIG9uY2Utb3Zlcmxvb2tlZCBzdWdhcnkgb3JlcyB0aGF0LCB3aGVuIGNvbWJpbmVkLCBtYXkgYmUgdHVybmVkIGludG8gZXZlbiBtb3JlIGNvb2tpZSBpbmdyZWRpZW50cy4gWW91ciBtaWxsaW9ucyBvZiBtaWxlcyBvZiBwcmV2aW91c2x5IHVzZWxlc3MgdHVubmVscyBwcm9iYWJseSBob3VzZSBpbnNhbmUgYW1vdW50cyBvZiB0aGUgc3R1ZmYhPC9xPiIsCiAgICAgICJNaW5lIiwKICAgICAgMTMKICAgICk7CiAgICBvcmRlciA9IDUwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRoZSBpbmZpbml0eSBlbmdpbmUiLAogICAgICAiPHE+SW4gdGhpcyBob3VzZSwgSSBndWVzcyB3ZSBkb24ndCBjYXJlIG11Y2ggZm9yIHRoZSBsYXdzIG9mIHRoZXJtb2R5bmFtaWNzLjwvcT4iLAogICAgICAiRmFjdG9yeSIsCiAgICAgIDEzCiAgICApOwogICAgb3JkZXIgPSA1MjU7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJEaW1pbmlzaGluZyB0YXggcmV0dXJucyIsCiAgICAgICI8cT5Xb3csIHRoZXkncmUgdGlueSEgV2lzaCB5b3UnZCB0aG91Z2h0IG9mIHRoYXQgc29vbmVyITwvcT4iLAogICAgICAiQmFuayIsCiAgICAgIDEzCiAgICApOwogICAgb3JkZXIgPSA1NTA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJBcHBhcml0aW9ucyIsCiAgICAgICI8cT5Zb3UndmUgYm9va2VkIGEgZGVhbCB3aXRoIHRoZSBoaWdoZXItdXBzIHRoYXQgc2NoZWR1bGVzIG9uZSB3ZWVrbHkgZWFydGhseSBhcHBhcml0aW9uIGJ5IGEgZGVpdHksIGFuZ2VsLCBhc2NlbmRlZCBwcm9waGV0LCBvciBvdGhlciBob2x5IGZpZ3VyZS4gVGhpcyBzaG91bGQgYm9vc3QgaW50ZXJlc3QgaW4gY29va2llIHJlbGlnaW9uIGFtb25nIHlvdXRocyBhcyBsb25nIGFzIHlvdSBjYW4gc2VjdXJlIGEgZGVjZW50IHRpbWUgc2xvdC48L3E+IiwKICAgICAgIlRlbXBsZSIsCiAgICAgIDEzCiAgICApOwogICAgb3JkZXIgPSA1NzU7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJXaXphcmQgYmFzZW1lbnRzIiwKICAgICAgIjxxPllvdSd2ZSByZWNlaXZlZCBjb25zdHJ1Y3Rpb24gcGVybWl0cyBhbGxvd2luZyB5b3UgdG8gYnVpbGQgYmFzZW1lbnRzIHVuZGVybmVhdGggZWFjaCB3aXphcmQgdG93ZXIuIFRoaXMgcHJvdmlkZXMgYSBoYW5keSBzdG9yYWdlIHNwYWNlIGZvciBwcmVjaW91cyByZWFnZW50cywgZml6emxlZC1vdXQgc291bCBnZW1zLCBhbmQgd2VpcmQgb2xkIG1hZ2F6aW5lcy48L3E+IiwKICAgICAgIldpemFyZCB0b3dlciIsCiAgICAgIDEzCiAgICApOwogICAgb3JkZXIgPSA2MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJQcmltZSBkaXJlY3RpdmUiLAogICAgICAiPHE+QW4gaW50ZXJnYWxhY3RpYyBkZWxlZ2F0aW9uIG1hZGUgeW91IHBpbmt5LXN3ZWFyIG5vdCB0byBkaXJlY3RseSBpbnRlcmFjdCB3aXRoIGxlc3NlciBhbGllbiBjdWx0dXJlcy4gV2hpY2ggaXMgZmluZSwgYmVjYXVzZSBpdCdzIG11Y2ggZnVubmllciB0byByb2IgYSBwbGFuZXQgYmxpbmQgd2hlbiBpdHMgaW5oYWJpdGFudHMgaGF2ZSBubyBpZGVhIHdoYXQncyBnb2luZyBvbi48L3E+IiwKICAgICAgIlNoaXBtZW50IiwKICAgICAgMTMKICAgICk7CiAgICBvcmRlciA9IDcwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkNocm9tYXRpYyBjeWNsaW5nIiwKICAgICAgIjxxPkFsbCBzdGF0ZXMgb2YgbWF0dGVyIGV4aXN0IGluIGEgY29udGludW91cyBsb29wLiBIYXZpbmcgbGVhcm5lZCBob3cgdG8gY3ljbGUgdGhyb3VnaCB0aGVtLCBhbGwgeW91IGhhdmUgdG8gZG8gaXMgdG8gZnJlZXplIG1hdHRlciByaWdodCBvbiB0aGUgc3RhdGUgeW91IG5lZWQuIEZvciByZWZlcmVuY2UsIHRoZSBjb29raWUgc3RhdGUgb2YgbWF0dGVyIGlzIHNpdHVhdGVkIGF0IHByZWNpc2VseSAxNjMuNzE5JmRlZzssIHJpZ2h0IGJldHdlZW4gbGFtZWxsYXIgZ2FzIGFuZCBtZXRhcGxhc21hLjwvcT4iLAogICAgICAiQWxjaGVteSBsYWIiLAogICAgICAxMwogICAgKTsKICAgIG9yZGVyID0gODAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRG9tZXN0aWMgcmlmdHMiLAogICAgICAiPHE+WW91J3ZlIG1hbmFnZWQgdG8gbWFudWZhY3R1cmUgcG9ydGFscyB0aGF0IGFyZSBjb252ZW5pZW50IGVub3VnaCwgYW5kIGxlZ2FsbHkgc2FmZSBlbm91Z2gsIHRoYXQgeW91IGNhbiBqdXN0IHN0aWNrIHRoZW0gYWdhaW5zdCB3YWxscyBpbnNpZGUgYnVpbGRpbmdzIHRvIGNvbm5lY3Qgcm9vbXMgdG9nZXRoZXIgaW4gdW51c3VhbCBjb25maWd1cmF0aW9ucy4gSW4gcHJhY3RpY2UsIHRoaXMgbWVhbnMgeW91ciBlbXBsb3llZXMgZ2V0IHRvIGhhdmUgbXVjaCBzaG9ydGVyIGJhdGhyb29tIGJyZWFrcy48L3E+IiwKICAgICAgIlBvcnRhbCIsCiAgICAgIDEzCiAgICApOwogICAgb3JkZXIgPSA5MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJQYXRpZW5jZSBhYm9saXNoZWQiLAogICAgICAiPHE+WW91IHdhaXQgZm9yIG5vIG9uZS48L3E+IiwKICAgICAgIlRpbWUgbWFjaGluZSIsCiAgICAgIDEzCiAgICApOwogICAgb3JkZXIgPSAxMDAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRGVsaWNpb3VzIHB1bGwiLAogICAgICAiPHE+SW4gYWRkaXRpb24gdG8gdGhlIDQgZnVuZGFtZW50YWwgZm9yY2VzIG9mIHRoZSB1bml2ZXJzZSAtZ3Jhdml0eSwgZWxlY3Ryb21hZ25ldGlzbSwgd2VhayBhbmQgc3Ryb25nIGludGVyYWN0aW9ucy0geW91ciBzY2llbnRpc3RzIGhhdmUgYXQgbG9uZyBsYXN0IGNvbmZpcm1lZCB0aGUgZXhpc3RlbmNlIG9mIGEgZmlmdGggb25lLCBtZWRpYXRlZCBieSBzdWdhciBib3NvbnM7IGl0IGRpY3RhdGVzIHRoYXQgYW55IHR3byBtYXNzZXMgb2YgaW5ncmVkaWVudC1saWtlIG1hdHRlciB3aWxsLCBnaXZlbiBlbm91Z2ggdGltZSwgZXZlbnR1YWxseSBtZWV0IGVhY2ggb3RoZXIgdG8gcHJvZHVjZSBhIHRoaXJkLCBldmVuIHRhc3RpZXIgc3Vic3RhbmNlLiBZb3VyIHRlYW0gZW50aHVzaWFzdGljYWxseSBuYW1lcyBpdCB0aGUgZGVsaWNpb3VzIHB1bGwuPC9xPiIsCiAgICAgICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsCiAgICAgIDEzCiAgICApOwogICAgb3JkZXIgPSAxMTAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiT2NjYW0ncyBsYXNlciIsCiAgICAgICI8cT5JbnZlbnRlZCBieSBGcmFuY2lzY2FuIGZyaWFyIFdpbGxpYW0gb2YgT2NjYW0gaW4gMTxzcGFuPjwvc3Bhbj4zMjcuIEFuIGltcG9zc2libHkgY2xldmVyIHVzZSBvZiBsaWdodCB0aGVvcnkgd2l0aCBhIGJpbGxpb24gcG9zc2libGUgYXBwbGljYXRpb25zLCBzb21lIG9mIHdoaWNoIGZyaWdodGZ1bGx5IGRlc3RydWN0aXZlLiBDb25maW5lZCB0byBhIHNpbmdsZSBnb2F0LXNraW4gcGFyY2htZW50IGZvciBodW5kcmVkcyBvZiB5ZWFycyB1bnRpbCB0aGUgcGF0ZW50IGV4cGlyZWQgYW5kIGhpdCBwdWJsaWMgZG9tYWluLCBqdXN0IG5vdy48L3E+IiwKICAgICAgIlByaXNtIiwKICAgICAgMTMKICAgICk7CiAgICBvcmRlciA9IDEyMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJPbiBhIHN0cmVhayIsCiAgICAgICI8cT5UYWtlIGEgbW9tZW50IHRvIGFwcHJlY2lhdGUgaG93IGZhciB5b3UndmUgY29tZS4gSG93IGx1Y2t5IHlvdSd2ZSBiZWVuIHNvIGZhci4gSXQgZG9lc24ndCB0YWtlIGEgZ2VuaXVzIHN0YXRpc3RpY2lhbiB0byBleHRyYXBvbGF0ZSBhIHRyZW5kIGZyb20gdGhpcy4gVGhlcmUncyBubyB3YXkgYW55dGhpbmcgYmFkIGNvdWxkIGhhcHBlbiB0byB5b3Ugbm93LiBSaWdodD88L3E+IiwKICAgICAgIkNoYW5jZW1ha2VyIiwKICAgICAgMTMKICAgICk7CiAgICBvcmRlciA9IDEzMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJBIGJveCIsCiAgICAgICI8cT5XaGF0J3MgaW4gdGhhdCBib3g/IFdoeSwgaXQncyBhIHRpbnkgcmVwbGljYSBvZiB5b3VyIG9mZmljZSEgQW5kIHRoZXJlJ3MgZXZlbiBhIGxpdHRsZSB5b3UgaW4gdGhlcmUhIEFuZCB3aGF0J3Mgb24gdGhlIGxpdHRsZSBkZXNrLi4uIHNheSAtIHRoYXQncyBhbiBldmVuIHRpbmllciBib3ghIEFuZCB0aGUgbGl0dGxlIHlvdSBpcyBvcGVuaW5nIGl0LCByZXZlYWxpbmcgYW4gZXZlbiB0aW5pZXIgb2ZmaWNlISBBbmQgaW4gdGhlIHRpbmllciBvZmZpY2UgdGhlcmUncy0gSG1tLiBZb3UgY2FuIHRoaW5rIG9mIGEgY291cGxlIHVzZXMgZm9yIHRoaXMuPC9xPiIsCiAgICAgICJGcmFjdGFsIGVuZ2luZSIsCiAgICAgIDEzCiAgICApOwogICAgb3JkZXIgPSAxNDAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiSGFja2VyIHNoYWRlcyIsCiAgICAgICI8cT5JJ20gaW4uPC9xPiIsCiAgICAgICJKYXZhc2NyaXB0IGNvbnNvbGUiLAogICAgICAxMwogICAgKTsKICAgIG9yZGVyID0gMTUwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkJyZWFrIHRoZSBmaWZ0aCB3YWxsIiwKICAgICAgIjxxPkh1aCwgd2FzIHRoYXQgYWx3YXlzIHRoZXJlPyBXaGF0ZXZlciBpdCB3YXMsIGl0J3MgZ29uZSBub3cuIEFuZCB3aGF0IHdhcyBiZWhpbmQgaXMgeW91cnMgZm9yIHRoZSB0YWtpbmcuPC9xPiIsCiAgICAgICJJZGxldmVyc2UiLAogICAgICAxMwogICAgKTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQ2F0IGxhZGllcyIsCiAgICAgIGxvYygiRWFjaCBraXR0ZW4gdXBncmFkZSBib29zdHMgJTEgQ3BTIGJ5IDxiPiUyJTwvYj4uIiwgWwogICAgICAgIGxvYygiZ3JhbmRtYSIpLAogICAgICAgIDI5LAogICAgICBdKSArICI8cT5PaCBuby4gT2ggbm8gbm8gbm8uIE9oaGggdGhpcyBpc24ndCByaWdodCBhdCBhbGwuPC9xPiIsCiAgICAgIDkwMDAwMDAwMDAsCiAgICAgIFszMiwgM10KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiS2l0dGVuIGFuZ2VscyJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIk1pbGtoZWxwJnJlZzsgbGFjdG9zZSBpbnRvbGVyYW5jZSByZWxpZWYgdGFibGV0cyIsCiAgICAgIGxvYygiRWFjaCByYW5rIG9mIG1pbGsgYm9vc3RzICUxIENwUyBieSA8Yj4lMiU8L2I+LiIsIFsKICAgICAgICBsb2MoImdyYW5kbWEiKSwKICAgICAgICA1LAogICAgICBdKSArICI8cT5BZ2VkIGxpa2UgbWlsay48L3E+IiwKICAgICAgOTAwMDAwMDAwMDAwLAogICAgICBbMzMsIDNdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkNhdCBsYWRpZXMiXTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQXVyYSBnbG92ZXMiLAogICAgICBsb2MoCiAgICAgICAgIkN1cnNvciBsZXZlbHMgYm9vc3QgY2xpY2tzIGJ5IDxiPiUxJTwvYj4gZWFjaCAodXAgdG8gY3Vyc29yIGxldmVsICUyKS4iLAogICAgICAgIFs1LCAxMF0KICAgICAgKSArCiAgICAgICAgIjxxPlRyeSBub3QgdG8gaGlnaC1maXZlIGFueW9uZSB3ZWFyaW5nIHRoZXNlLiBZb3UgZG9uJ3Qgd2FudCB0aGF0IG1lc3Mgb24geW91ciBoYW5kcy48L3E+IiwKICAgICAgNTU1NTU1NTU1LAogICAgICBbMzIsIDRdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkhhbG8gZ2xvdmVzIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiTHVtaW5vdXMgZ2xvdmVzIiwKICAgICAgbG9jKCI8Yj4lMTwvYj4gYXJlIG5vdyBlZmZlY3RpdmUgdXAgdG8gY3Vyc29yIGxldmVsICUyLiIsIFsKICAgICAgICBnZXRVcGdyYWRlTmFtZSgiQXVyYSBnbG92ZXMiKSwKICAgICAgICAyMCwKICAgICAgXSkgKwogICAgICAgICI8cT5UaGVzZSBoZWxwIHBvd2VyIHlvdXIgY2xpY2tzIHRvIGFic3VyZCBsZXZlbHMsIGJ1dCB0aGV5J3JlIGFsc28gcXVpdGUgaGFuZHkgd2hlbiB5b3Ugd2FudCB0byBsaWdodCB1cCB0aGUgZGFya25lc3Mgb24geW91ciB3YXkgYmFjayBmcm9tIEdsb3ZlIFdvcmxkLjwvcT4iLAogICAgICA1NTU1NTU1NTU1NSwKICAgICAgWzMzLCA0XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJBdXJhIGdsb3ZlcyJdOwoKICAgIG9yZGVyID0gMTAwMjA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQm9ra2VucG9vdGplcyIsCiAgICAgIGRlc2M6ICJDb25zaXN0IG9mIDIgbWVyaW5ndWUgaGFsdmVzIGpvaW5lZCBieSBidXR0ZXJjcmVhbSBhbmQgZGlwcGVkIGJvdGggd2F5cyBpbiBjaG9jb2xhdGUuIE5hbWVkIGFmdGVyIGEgZ29hdCdzIGZvb3QgdGhhdCBwcm9iYWJseSBzdGVwcGVkIGluIHNvbWV0aGluZyB0d2ljZS4iLAogICAgICBpY29uOiBbMzIsIDhdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDQwKSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkZhdCByYXNjYWxzIiwKICAgICAgZGVzYzogIkFsbW9uZC1zbWlsZWQgWW9ya3NoaXJlIGNha2VzIHdpdGggYSByaWNoIGhpc3RvcnkgYW5kIGFuIGV2ZW4gcmljaGVyIHJlY2lwZS4gVGhlIG1vcmUgZGlldC1jb25zY2lvdXMgYXJlIGludml0ZWQgdG8gdHJ5IHRoZSBsZWFuIHZlcnNpb24sIHNraW5ueSBzY2FsbHl3YWdzLiIsCiAgICAgIGljb246IFszMywgOF0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoNDEpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiSXNjaGxlciBjb29raWVzIiwKICAgICAgZGVzYzogIk9yaWdpbmF0aW5nIGluIHRoZSBBdXN0cm8tSHVuZ2FyaWFuIEVtcGlyZSwgdGhlc2UgaGF2ZSBzcHJlYWQgdGhyb3VnaG91dCBldmVyeSBjb3VudHJ5IGluIGVhc3Rlcm4gRXVyb3BlIGFuZCBzcGF3bmVkIGp1c3QgYXMgbWFueSByZWNpcGVzLCBlYWNoIGNsYWltaW5nIHRvIGJlIHRoZSBvcmlnaW5hbC4gVGhlIGJhc2lzIHJlbWFpbnMgdW5jaGFuZ2VkIGFjcm9zcyBhbGwgdmFyaWFudHM6IHR3byBiaXNjdWl0cyBzYW5kd2ljaGVkIGFyb3VuZCBjaG9jb2xhdGUgYnV0dGVyY3JlYW0uIE9yIHdhcyBpdCBqYW0/IiwKICAgICAgaWNvbjogWzMyLCA5XSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSg0MiksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJNYXRjaGEgY29va2llcyIsCiAgICAgIGRlc2M6ICJHcmVlbiB0ZWEgYW5kIGNvb2tpZXMsIGEgbWF0Y2hhIG1hZGUgaW4gaGVhdmVuLiIsCiAgICAgIGljb246IFszMywgOV0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoNDIpLAogICAgfSk7CgogICAgb3JkZXIgPSAxMDAzMjsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJFYXJsIEdyZXkgbWFjYXJvbnMiLAogICAgICBkZXNjOiAiQmVzdCBzZXJ2ZWQgaG90LCBtYWtlIGl0IHNvISIsCiAgICAgIGljb246IFszMiwgMTBdLAogICAgICByZXF1aXJlOiAiQm94IG9mIG1hY2Fyb25zIiwKICAgICAgcG93ZXI6IDMsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5LAogICAgfSk7CgogICAgb3JkZXIgPSAxMDAzMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJQb2tleSIsCiAgICAgIGRlc2M6ICJXaGlsZSBjb21tb25seSB0aG91Z2h0IHRvIGJlIG5hbWVkIHNvIGJlY2F1c2UgaXQncyBmdW4gdG8gcG9rZSB5b3VyIGNsYXNzbWF0ZXMgd2l0aCB0aGVzZSwgUG9rZXktYnJhbmQgYmlzY3VpdCBzdGlja3MgYWN0dWFsbHkgZ2V0IHRoZWlyIG5hbWUgZnJvbSB0aGVpciBwb3B1bGFyaXR5IGluIHNtb2tlLWZyZWUgcHJpc29ucywgd2hlcmUgdGhleSdyZSBjb21tb25seSBzbXVnZ2xlZCBhbmQgdHJhZGVkIGluIGxpZXUgb2YgY2lnYXJldHRlcy4iLAogICAgICBpY29uOiBbMzMsIDEwXSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBicmFuZCBiaXNjdWl0cyIsCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwoKICAgIG9yZGVyID0gMTAwMDA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQ2FzaGV3IGNvb2tpZXMiLAogICAgICBkZXNjOiAiTGV0IG1lIHRlbGwgeW91IGFib3V0IGNhc2hld3MuIENhc2hld3MgYXJlIG5vdCBudXRzLCBidXQgc2VlZHMgdGhhdCBncm93IG91dCBvZiBjdXJpb3VzIHJlZCBvciB5ZWxsb3cgZnJ1aXRzIC0gd2hpY2ggY2FuIGJlIGVhdGVuIG9uIHRoZWlyIG93biwgb3IgbWFkZSBpbnRvIGRyaW5rcy4gVGhlIHNoZWxsIGFyb3VuZCB0aGUgbnV0IGl0c2VsZiBjb250YWlucyBhIG5hc3R5IHN1YnN0YW5jZSB0aGF0IHN0YWlucyBhbmQgaXJyaXRhdGVzIHRoZSBoYW5kcyBvZiB3aG9ldmVyIGhhbmRsZXMgaXQgZm9yIHRvbyBsb25nLiBCdXQgdGhhdCdzIG9rYXksIHNpbmNlIG5vdyB0aGF0IHlvdSd2ZSByZWFkIHRoaXMgeW91J2xsIG1ha2Ugc3VyZSBpdCBkb2Vzbid0IGdldCBpbiB0aGUgY29va2llcyEgT2gsIHlvdSd2ZSBhbHJlYWR5IGVhdGVuIGhvdyBtYW55PyBPa2F5IHRoZW4uIiwKICAgICAgaWNvbjogWzMyLCA3XSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OSwKICAgIH0pOwogICAgb3JkZXIgPSAxMDAwMTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJNaWxrIGNob2NvbGF0ZSBjb29raWVzIiwKICAgICAgZGVzYzogIkEgc3RyYW5nZSBpbnZlcnNpb24gb2YgY2hvY29sYXRlIG1pbGsuIEZvciB0aG9zZSB3aG8gYXJlIGEgbGl0dGxlIGJpdCB0b28gaGFyZGNvcmUgZm9yIHdoaXRlIGNob2NvbGF0ZSwgYnV0IG5vdCBoYXJkY29yZSBlbm91Z2ggZm9yIGRhcmsuIiwKICAgICAgaWNvbjogWzMzLCA3XSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OSAqIDUsCiAgICB9KTsKCiAgICBvcmRlciA9IDI1NTsKICAgIEdhbWUuR3JhbmRtYVN5bmVyZ3koCiAgICAgICJCcmFpbnkgZ3JhbmRtYXMiLAogICAgICAiQSBjbGV2ZXIgZ3JhbmRtYSB0byB0aGluayB1cCBzb21lIGNvb2tpZXMuIiwKICAgICAgIkNvcnRleCBiYWtlciIKICAgICk7CgogICAgb3JkZXIgPSAxNjAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiUHJpbmNpcGxlZCBuZXVyYWwgc2hhY2tsZXMiLAogICAgICAiPHE+QSBkaXNjcmltaW5hdG9yeSwgbG93LW9yZGVyIG5ldXJhbCBuZXQgYWN0aW5nIGFzIGEgZmlsdGVyIGxpbWl0aW5nIHdoYXQgeW91ciBjb3J0ZXggYmFrZXJzIGNhbiB0aGluayBhbmQgZG8uIFJlYWxseSBzb21ldGhpbmcgeW91IHdhbnQgdG8gYXBwbHkgYmVmb3JlIHRoZXkgYWNoaWV2ZSBmdWxsIG1lZ2FzZW50aWVuY2UgYW5kIHJlYWxpemUgdGhleSd2ZSBnb3QgYmV0dGVyIHRoaW5ncyB0byBkbyB0aGFuIG1hdGVyaWFsaXppbmcgcGFzdHJpZXMgZm9yIHlvdSwgdHJ1c3QgbWUuPC9xPiIsCiAgICAgICJDb3J0ZXggYmFrZXIiLAogICAgICAxCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiT2JleSIsCiAgICAgICI8cT5QZXJmZWN0IG1pbmQgY29udHJvbCBtZWFucyBwZXJmZWN0IGVtcGxveWVlIGF0dGVuZGFuY2UgYW5kIHBlcmZvcm1hbmNlLiBPcHRpbWFsIG1vb2Qgc3RhYmlsaXphdGlvbiBpcyBhIG5pY2Ugc2lkZS1lZmZlY3QuPGJyPkhhcHB5IGhhcHB5IGV2ZXJ5b25lIGhhcHB5Ljxicj5IYXBweS48L3E+IiwKICAgICAgIkNvcnRleCBiYWtlciIsCiAgICAgIDIKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJBIHNwcmlua2xlIG9mIGlycmF0aW9uYWxpdHkiLAogICAgICAiPHE+WW91ciBjb3J0ZXggYmFrZXJzIHNvbWV0aW1lcyBnZXQgYm9nZ2VkIGRvd24gYnkgY2lyY3VsYXIgcmVhc29uaW5nIGFuZCBzdGFsZSBpZGVhcy4gQSB0b3VjaCBvZiBjaGFvcyBpcyBqdXN0IHdoYXQgdGhleSBuZWVkIHRvIGdldCBiYWNrIG9uIHRyYWNrLjwvcT4iLAogICAgICAiQ29ydGV4IGJha2VyIiwKICAgICAgMwogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkZyb250IGFuZCBiYWNrIGhlbWlzcGhlcmVzIiwKICAgICAgIjxxPkkgbWVhbiwgb3RoZXJ3aXNlIGl0J3MganVzdCB1bnVzZWQgc3BhY2UsIHllYWg/PC9xPiIsCiAgICAgICJDb3J0ZXggYmFrZXIiLAogICAgICA0CiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiTmV1cmFsIG5ldHdvcmtpbmciLAogICAgICAiPHE+VGhlIGVmZmVjdGl2ZW5lc3Mgb2YgeW91ciBjb3J0ZXggYmFrZXJzIHNob290cyB1cCBleHBvbmVudGlhbGx5IGlmIHlvdSBhbGxvdyB0aGVtIHRvIGNvbm5lY3Qgd2l0aCBlYWNoIG90aGVyLiBJbiBwcmFjdGljZSB0aGlzIHRha2VzIHRoZSBmb3JtIG9mIG1hbnkgY29zbWljLXNpemVkIG5lcmRzIG11bWJsaW5nIGF3a3dhcmRseSBhYm91dCB0ZWNoIHN0YXJ0LXVwIGlkZWFzIHRvIGVhY2ggb3RoZXIuPC9xPiIsCiAgICAgICJDb3J0ZXggYmFrZXIiLAogICAgICA1CiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQ29zbWljIGJyYWluc3Rvcm1zIiwKICAgICAgIjxxPlRoZSB3cmlua2xlZCBzdXJmYWNlcyBvZiB5b3VyIGNvcnRleCBiYWtlcnMgZW1pdCB3ZWF0aGVyLXNjYWxlIGlvbmljIGZsYXJlcyB3aXRoIGV2ZXJ5IHRob3VnaHQgY291cnNpbmcgdGhyb3VnaCB0aGVtLiBUaGVzZSBwdWxzZXMgb2YgcHVyZSBpbnRlbGxlY3R1YWwgZW5lcmd5IGFyZSBzZW50IHJpcHBsaW5nIHRocm91Z2ggc3BhY2UsIG9jY2FzaW9uYWxseSBlY2hvaW5nIGJhY2sgd2l0aCBldmVuIGRlZXBlciBwaGlsb3NvcGhpY2FsIGNvbXBsZXhpdHkuPC9xPiIsCiAgICAgICJDb3J0ZXggYmFrZXIiLAogICAgICA2CiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiTWVnYXRoZXJhcHkiLAogICAgICAiPHE+QSBnaWFudCBicmFpbiBjYW4gZmVlbCB1bndlbGwganVzdCBsaWtlIHlvdSBhbmQgbWUgc29tZXRpbWVzLCBhbmQgaXQncyB0aGUgam9iIG9mIHNwZWNpYWxpemVkIGVuZ2luZWVycyB0byBsb2NhdGUgYW5kIHJlcGFpciB0aGVzZSBidWdzLiBXZSdsbCBhZG1pdCBtb3N0IG9mIHRoZSBidWRnZXQgaW4gdGhpcyB3YXMgc3BlbnQgb24gY29uc3RydWN0aW5nIGV4dHJlbWVseSBsYXJnZSBjaGFpc2VzIGxvbmd1ZXMgZm9yIHRoZSBicmFpbnMgdG8gcmVjbGluZSBvbi48L3E+IiwKICAgICAgIkNvcnRleCBiYWtlciIsCiAgICAgIDcKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJTeW5hcHRpYyBsdWJyaWNhbnQiLAogICAgICAiPHE+QSBtaW5kIGlzIG9ubHkgYXMgZmFzdCBhcyB0aGUgYXhvbnMgdGhhdCBzdXBwb3J0IGl0LiBHZXQgdGhvc2UgYWN0aW9uIHBvdGVudGlhbHMgZmxvd2luZyBzbW9vdGggYXMgc2lsayB3aXRoIHRoaXMgMyBwYXJ0cyBteWVsaW4vMSBwYXJ0IGNhbm9sYSBvaWwgc3ByZWFkYWJsZSBwYXN0ZS4gQWxzbyBncmVhdCBvbiB0b2FzdC48L3E+IiwKICAgICAgIkNvcnRleCBiYWtlciIsCiAgICAgIDgKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJQc3ljaG9raW5lc2lzIiwKICAgICAgIjxxPldoaWxlIHlvdXIgZ2lhbnQgY29ydGV4IGJha2VycyBjb21lIGVxdWlwcGVkIHdpdGggRVNQLCB0aGV5J3ZlIG9ubHkgcmVjZW50bHkgZmlndXJlZCBvdXQgaG93IHRvIG1hbmlwdWxhdGUgdGhlIHBoeXNpY2FsIHdvcmxkIHdpdGggdGhlaXIgdGhvdWdodHMgLSB0aG91Z2ggZm9yIHNhZmV0eSByZWFzb25zLCB5b3VyIGxlZ2FsIHRlYW0gaGFkIHRoZW0gcHJvbWlzZSB0byBvbmx5IHVzZSB0aGVzZSBwb3dlcnMgdG8gc2NyYXRjaCB0aGUgaXRjaGVzIGluIHRoZWlyIGNvcnRpY2FsIGZvbGRzLjwvcT4iLAogICAgICAiQ29ydGV4IGJha2VyIiwKICAgICAgOQogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlNwaW5lcyIsCiAgICAgICI8cT5Zb3VyIGNvcnRleCBiYWtlcnMgYXJlIG5vdyBlcXVpcHBlZCB3aXRoIHRlbnRhY3VsYXIgc3BpbmUtbGlrZSBzdHJ1Y3R1cmVzLCB3aGljaCB0aGV5IGNhbiB1c2UgbGlrZSBwcmVoZW5zaWxlIHRhaWxzIHRvIHBvdXIgdGhlbXNlbHZlcyBlbm9ybW91cyBjdXBzIG9mIGNvZmZlZSBvciBwcm9wZWwgdGhlbXNlbHZlcyBhcm91bmQgbGlrZSB2ZXJ5IGxhcmdlLCB2ZXJ5IHNtYXJ0LCB2ZXJ5IHNsb3cgdGFkcG9sZXMuPC9xPiIsCiAgICAgICJDb3J0ZXggYmFrZXIiLAogICAgICAxMAogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIk5ldXJhZm9ybWluZyIsCiAgICAgICI8cT5CeSB2aXJ0dWUgb2YgYmVpbmcgcGxhbmV0LXNpemVkLCB5b3VyIGNvcnRleCBiYWtlcnMgb2Z0ZW4gYm9hc3QgdGhlaXIgb3duIGF0bW9zcGhlcmVzIGFuZCBzZWFzIG9mIGNlcmVicm9zcGluYWwgZmx1aWQsIGFuZCBnaXZlbiBlbm91Z2ggdGltZSwgdGhlaXIgb3duIGVjb3N5c3RlbXMuIFRoaXMgaW5jcmVkaWJsZSBuZXcgYnJhbmNoIG9mIGxpZmUsIGV2b2x2ZWQgZW50aXJlbHkgb3V0IG9mIG5ldXJhbCBtYXRlcmlhbCwgY2FuIGJlIHB1dCB0byBnb29kIHVzZSBhcyBob21lLWdyb3duIGFjY291bnRhbnRzIGFuZCBsb3ctcmFua2luZyB0ZWNobmljaWFucy48L3E+IiwKICAgICAgIkNvcnRleCBiYWtlciIsCiAgICAgIDExCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRXBpc3RlbW9sb2dpY2FsIHRyaWNrZXJ5IiwKICAgICAgIjxxPlJlZGVmaW5pbmcgd2hhdCBpcyAtb3IgaXNuJ3QtIGEgY29va2llIHRocm91Z2ggdGhlIHBvd2VyIG9mIHBoaWxvc29waGljYWwgZGlzY291cnNlIG1heSByZXN1bHQgaW4gc29tZSBzdHJhbmdlIGFuZCB3b25kZXJmdWwgdGhpbmdzIGZvciB5b3VyIHByb2ZpdCBtYXJnaW5zLjwvcT4iLAogICAgICAiQ29ydGV4IGJha2VyIiwKICAgICAgMTIKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJFdmVyeSBwb3NzaWJsZSBpZGVhIiwKICAgICAgIjxxPkNvbmdyYXR1bGF0aW9ucywgeW91ciBjb3J0ZXggYmFrZXJzIGhhdmUgZXhlcnRlZCBlbm91Z2ggaW50ZWxsZWN0dWFsIGNvbXB1dGF0aW9uIHRvIHBlcm11dGUgdGhyb3VnaCBldmVyeSBzaW5nbGUgaWRlYSB0aGF0IGNhbiBvciBldmVyIHdpbGwgYmUgY29uY2VpdmVkIG9mLiBBbnkgdGhvdWdodCBiZXlvbmQgdGhpcyBwb2ludCBpcyBtZXJlbHkgcmVkaXNjb3ZlcmluZyBhIG5vdGlvbiB5b3UndmUgYWxyZWFkeSBhcmNoaXZlZC4gSGFyZGx5IGNhdXNlIGZvciBjZXJlYnJhdGlvbi48L3E+IiwKICAgICAgIkNvcnRleCBiYWtlciIsCiAgICAgIDEzCiAgICApOwoKICAgIG9yZGVyID0gMjAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiS2l0Y2hlbiBjYWJpbmV0cyIsCiAgICAgICI8cT5BIGdyYW5kbWEncyBraXRjaGVuIGNhYmluZXQgaXMgYSBiZWZ1ZGRsaW5nIHBsYWNlLiBUaHJvdWdoIGxlc3Nlci1zdHVkaWVkIGFnZ3JlZ2F0aW5nIGluc3RpbmN0cywgZ3JhbmRtYXMgd2lsbCB0ZW5kIHRvIGdyYWR1YWxseSBmaWxsIGFsbCBuZWFyYnkgY2FiaW5ldHMgd2l0aCB2YXJpb3VzIHNvcnRzIG9mIHRoaW5ncywgc3VjaCBhcyBjdXJpb3VzIGNvY29udXQgc25hY2tzIG9yIGRpZXRldGljIHBvd2RlcnMuIEJ5IGNvbnRyYWN0LCB0aGVzZSBhcmUgbGVnYWxseSB5b3Vycywgd2hpY2ggb3BlbnMgdXAgZXhjaXRpbmcgb3Bwb3J0dW5pdGllcyBmb3IgeW91ciBzdWJzdGFuY2UgaW52ZXN0aWdhdGlvbiBkZXBhcnRtZW50LjwvcT4iLAogICAgICAiR3JhbmRtYSIsCiAgICAgIDE0CiAgICApOwogICAgb3JkZXIgPSAzMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJDb29raWUgbXVsY2giLAogICAgICAiPHE+R3JpbmRpbmcgc3VycGx1cyBjb29raWVzIGludG8gcGFzdGUgdGhhdCB5b3UgdGhlbiBzcHJlYWQgb250byB5b3VyIGZpZWxkcyBlbmFibGVzIGEgc3RyYW5nZSBmZWVkYmFjayBsb29wIGluIHRoZSBxdWFsaXR5IG9mIHlvdXIgY29va2llIGNyb3BzLiBDb29raWUgZmVlZGluZyBvbiBjb29raWUgc2hvdWxkIGJlIGFuIGFib21pbmF0aW9uLCBidXQgdGhlbiB3aHkgZG9lcyBpdCB0YXN0ZSBzbyBnb29kPzwvcT4iLAogICAgICAiRmFybSIsCiAgICAgIDE0CiAgICApOwogICAgb3JkZXIgPSA0MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJEZWxpY2lvdXMgbWluZXJhbG9neSIsCiAgICAgICI8cT5TdHJhdHVtIGFmdGVyIHN0cmF0dW0sIHlvdSd2ZSBleHRyYWN0ZWQgc3RyYW5nZSBuZXcgbWluZXJhbHMgaGVyZXRvZm9yZSB1bmtub3duIHRvIGdlb2xvZ3kuIFVzaGVyaW5nIGEgbmV3IGVyYSBvZiBtYXRlcmlhbHMgcmVzZWFyY2gsIHlvdXIgc2NpZW50aXN0cyBoYXZlIGJlZW4gYWJsZSB0byBpZGVudGlmeSBldmVyeSBuZXcgZWxlbWVudCB5b3VyIG1pbmVzIGhhdmUgZGlzY292ZXJlZCwgaW5jbHVkaW5nIHdoYXRldmVyIHRob3NlIHRoaW5ncyBhcmUgaW4gdGhlIHVwZ3JhZGUgdGllciBuYW1lcy48L3E+IiwKICAgICAgIk1pbmUiLAogICAgICAxNAogICAgKTsKICAgIG9yZGVyID0gNTAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiTi1kaW1lbnNpb25hbCBhc3NlbWJseSBsaW5lcyIsCiAgICAgICI8cT5MaW5lcyBhcmUgZGVwcmVzc2luZ2x5IDEtZGltZW5zaW9uYWwuIEJleW9uZCBhc3NlbWJseSBsaW5lcywgd2UgcG9zaXQgdGhlIGV4aXN0ZW5jZSBvZiBoaWdoZXItb3JkZXIgYXNzZW1ibHkgZW50aXRpZXMsIHN1Y2ggYXMgYXNzZW1ibHkgc3F1YXJlcywgYXNzZW1ibHkgY3ViZXMgLSBwZXJoYXBzIGV2ZW4gYXNzZW1ibHkgdGVzc2VyYWN0cy4gQW55IGRlZXBlciB0aGFuIHRoYXQgYW5kIHdlIGRvdWJ0IHdlJ2xsIGJlIGFibGUgdG8gd3JpdGUgbWFudWFscyB5b3VyIHdvcmtlcnMgY2FuIHJlYWQuPC9xPiIsCiAgICAgICJGYWN0b3J5IiwKICAgICAgMTQKICAgICk7CiAgICBvcmRlciA9IDUyNTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkNvb2tpZSBQb2ludHMiLAogICAgICAiPHE+QSBsb3lhbHR5IHByb2dyYW0gd2hlcmVpbiBlYWNoIHB1cmNoYXNlIG9mIHlvdXIgY29va2llcyBjb21lcyB3aXRoIGZyZWUgQ29va2llIFBvaW50cywgd2hpY2ggY2FuIGluIHR1cm4gYmUgcmVkZWVtZWQgZm9yIG1vcmUgY29va2llcywgdGh1cyBjcmVhdGluZyB0aGUgc2VsZi1zdXN0YWluaW5nIGVjb25vbXkgeW91J3ZlIGJlZW4gbG9va2luZyBmb3IuPC9xPiIsCiAgICAgICJCYW5rIiwKICAgICAgMTQKICAgICk7CiAgICBvcmRlciA9IDU1MDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIk5lZ2F0aGVpc20iLAogICAgICAiPHE+UG9seXRoZWlzbSBpcyBhIGJlbGllZiBpbiBtdWx0aXBsZSBkZWl0aWVzOyBtb25vdGhlaXNtIGluIGp1c3Qgb25lLiBBdGhlaXNtIGlzIGEgYmVsaWVmIGluIG5vIGRlaXR5IHdoYXRzb2V2ZXIuIFRocm91Z2ggbG9naWNhbCBzdWNjZXNzaW9uIGl0IGZvbGxvd3MgdGhhdCB0aGlzIHJlbWFpbnMgdHJ1ZSB3aGVuIGdvaW5nIGludG8gbmVnYXRpdmUgbnVtYmVycywgd2l0aCBiZWxpZWYgc3lzdGVtcyBpbnZvbHZpbmcgbWludXMgMSBvciBtb3JlIGRlaXRpZXMgZGlzcGxheWluZyB1bnByZWNlZGVudGVkIHRoZW9sb2dpY2FsIHByb3BlcnRpZXMuPC9xPiIsCiAgICAgICJUZW1wbGUiLAogICAgICAxNAogICAgKTsKICAgIG9yZGVyID0gNTc1OwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiTWFnaWNhbCByZWFsaXNtIiwKICAgICAgIjxxPk1vcmUgYSBzb2NpYWwgdGhhbiB0aGF1bWF0dXJnaWNhbCBwcm9ncmVzcywgbWFnaWNhbCByZWFsaXNtIHJlZmVycyB0byB0aGUgbm9ybWFsaXphdGlvbiBvZiBtb2Rlcm4gdGVjaG5vbG9neSBhbW9uZyBtYWdpYy11c2Vycy4gSXQncyB0b3RhbGx5IGZpbmUgZm9yIGEgd2l6YXJkIHRvIGRyaXZlIGEgY2FyISBUaGVyZSdzIG5vIHN0aWdtYSBpbiB3YWl0aW5nIGluIGxpbmUgZm9yIGNvZmZlZSEgU3VyZSwgdGFrZSBhIHBob25lIGNhbGwsIHNlbmQgYW4gZW1haWwsIHdoYXRldmVyITwvcT4iLAogICAgICAiV2l6YXJkIHRvd2VyIiwKICAgICAgMTQKICAgICk7CiAgICBvcmRlciA9IDYwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkNvc21pYyBmb3JlZ3JvdW5kIHJhZGlhdGlvbiIsCiAgICAgICI8cT5BaCwgdGhpcyBpcyBhIHByb2JsZW0uPC9xPiIsCiAgICAgICJTaGlwbWVudCIsCiAgICAgIDE0CiAgICApOwogICAgb3JkZXIgPSA3MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJBcmNhbml6ZWQgZ2xhc3N3YXJlIiwKICAgICAgIjxxPllvdSB0aGluayB5b3VyIGxhYiBlcXVpcG1lbnQgZW5qb3lzIHRha2luZyBwYXJ0IGluIHRoZXNlIGV4cGVyaW1lbnRzIHZpb2xhdGluZyBhbGwgc29ydHMgb2YgbW9kZXJuIHNjaWVudGlmaWMgcHJlY2VwdHM/IE9mIGNvdXJzZSBub3QuIFRoYW5rZnVsbHksIHlvdSd2ZSBmaW5hbGl6ZWQgdGhlIGRlc2lnbiBvZiBzcGVjaWFsaXplZCBiZWFrZXJzIGFuZCBmbGFza3MsIHJlY3ljbGVkIGZyb20gdGhlIHNhbWUgZ2xhc3MgdXNlZCBieSB0aGUgYW5jaWVudHMgdG8gcGVyZm9ybSBwcmltZXZhbCBhbGNoZW15LCBhbmQgdGhlcmVmb3JlIG11Y2ggbGVzcyBwaWNreSBhYm91dCB0aGUgbmF0dXJlIG9mIHRoZSBwaHlzaWNhbCB3b3JsZC48L3E+IiwKICAgICAgIkFsY2hlbXkgbGFiIiwKICAgICAgMTQKICAgICk7CiAgICBvcmRlciA9IDgwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlBvcnRhbCBndW5zIiwKICAgICAgIjxxPkF0IGxvbmcgbGFzdCEgVGhlIG9ubHkgd2VhcG9uIGNhcGFibGUgb2Yga2lsbGluZyBhIHBvcnRhbC48L3E+IiwKICAgICAgIlBvcnRhbCIsCiAgICAgIDE0CiAgICApOwogICAgb3JkZXIgPSA5MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJUaW1lcHJvb2YgdXBob2xzdGVyeSIsCiAgICAgICI8cT5Tb21ldGltZXMgeW91ciB0aW1lIGFnZW50cyBvdmVyc2hvb3QgYW5kIGVuZCB1cCBoYXZpbmcgdG8gZmFzdC1mb3J3YXJkIHRocm91Z2ggdGhlIHVuaXZlcnNlJ3MgZW50aXJlIGhpc3RvcnkgdW50aWwgdGhleSBsb29wIGJhY2sgdG8gcHJlc2VudCB0aW1lLiBJdCBzdGlsbCB0YWtlcyBhIHdoaWxlLCBzbyB0aGV5IG1pZ2h0IGFzIHdlbGwgdHJhdmVsIGluIGNvbWZvcnQgYW5kIGVuam95IHRoZSBzaG93IHdoaWxlIHRoZXkgZG8uPC9xPiIsCiAgICAgICJUaW1lIG1hY2hpbmUiLAogICAgICAxNAogICAgKTsKICAgIG9yZGVyID0gMTAwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkVtcGxveWVlIG1pbmlmaWNhdGlvbiIsCiAgICAgICI8cT5Vc2luZyBtb2xlY3VsYXIgc2hyaW5raW5nIHRlY2hub2xvZ3ksIHlvdSd2ZSByZW5kZXJlZCB5b3VyIHN0YWZmIGFuZCB0aGVpciBvZmZpY2VzIGFic29sdXRlbHkgaXR0eS1iaXR0eS4gVGhlIHN0b3JhZ2UgYW5kIHByb2R1Y3Rpdml0eSBiZW5lZml0cyBhcmUgcXVlc3Rpb25hYmxlIGJ1dCBpdCdzIHZlcnkgZnVuIGxpc3RlbmluZyB0byB0aGVpciB0aW55IGxpdHRsZSBjb21wbGFpbnRzLiBUaGV5IGFsbCBzaWduZWQgdGhlIHdhaXZlcnMsIHNvIG1heWJlIHRoZWlyIG5ldyBzaXplIHdpbGwgZmluYWxseSB0ZWFjaCB0aGVtIHRvIHJlYWQgdGhlIHNtYWxsIHByaW50Li4uPC9xPiIsCiAgICAgICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsCiAgICAgIDE0CiAgICApOwogICAgb3JkZXIgPSAxMTAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiSHlwZXJibGFjayBwYWludCIsCiAgICAgICI8cT5BcyB0aGUgdGVjaG5vbG9neSBiZWhpbmQgeW91ciBwcmlzbXMgZXZvbHZlcywgdGhlaXIgc3RvcmFnZSBiZWNvbWVzIG1vcmUgYW5kIG1vcmUgcHJvYmxlbWF0aWM6IHdpdGhpbiBzZWNvbmRzLCBhIHNpbmdsZSBwcmlzbSdzIHJlZmxlY3RpdmUgYWJpbGl0eSBjYW4gc2V0IGEgd2hvbGUgdW5kZXJncm91bmQgaGFuZ2FyIGFibGF6ZSBhcyBpdCBjYXRjaGVzIHRoZSBzbGlnaHRlc3QgZ2xpbnQgb2YgbGlnaHQuIEhvd2V2ZXIsIG9uY2UgY29hdGVkIHdpdGggdGhpcyBuZXcgc2hhZGUgb2YgcGFpbnQsIGl0cyBkYW1hZ2UgbWF5IGJlIHJlZHVjZWQgdG8gb25seSBnaXZpbmcgdGhpcmQtZGVncmVlIGJ1cm5zIHRvIGVtcGxveWVlcyB0aGF0IHN0YW5kIHRvbyBjbG9zZS48L3E+IiwKICAgICAgIlByaXNtIiwKICAgICAgMTQKICAgICk7CiAgICBvcmRlciA9IDEyMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJTaWx2ZXIgbGluaW5nIG1heGltaXphdGlvbiIsCiAgICAgICI8cT5Tb21ldGltZXMgbHVjayBpcyBhIG1hdHRlciBvZiBwZXJzcGVjdGl2ZS4gQnJva2UgeW91ciBhbmtsZT8gV2hhdCBkbyB5b3Uga25vdywgdGhhdCBjdXRlIG51cnNlIGZpeGluZyB5b3UgdXAgbWlnaHQganVzdCBiZSB5b3VyIGZ1dHVyZSBzcG91c2UuIExvc3QgeW91ciBqb2I/IFlvdSB3ZXJlIG1lYW50IGZvciBncmVhdGVyIHRoaW5ncyBhbnl3YXkhIERldmVsb3BlZCBhIGNvb2tpZSBhbGxlcmd5PyBUaGVyZSdzIG5vIHVwc2hvdCB0byB0aGF0LCB5b3Ugc2ljayBtb25zdGVyLjwvcT4iLAogICAgICAiQ2hhbmNlbWFrZXIiLAogICAgICAxNAogICAgKTsKICAgIG9yZGVyID0gMTMwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIk11bHRpc2NhbGUgcHJvZmlsaW5nIiwKICAgICAgIjxxPkRpZCB5b3Uga25vdyB0aGF0IGVhdGluZyBhIGNvb2tpZSBtZWFucyB0aGUgaW50ZXN0aW5hbCBmbG9yYSBpbnNpZGUgeW91IGlzIGVhdGluZyBpdCB0b28/IFRyaWxsaW9ucyBvZiB0aW55IGJhY3RlcmlhbCBtb3V0aHMgdG8gZmVlZCwgZWFjaCB3aXRoIHRoZWlyIG93biBwcmVmZXJlbmNlcy4gU3VyZWx5IHRoaXMgaXMgcm9vbSBmb3IgZmxhdm9yIG9wdGltaXphdGlvbi4gQW5kIHRoZW4sIG9mIGNvdXJzZSwgdGhlcmUncyBhbHNvIHRoZSBtdWNoIGJpZ2dlciB0aGluZ3MgdGhhdCwgaW4gdHVybiwgZWF0IHlvdS48L3E+IiwKICAgICAgIkZyYWN0YWwgZW5naW5lIiwKICAgICAgMTQKICAgICk7CiAgICBvcmRlciA9IDE0MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJQSFAgY29udGFpbm1lbnQgdmF0cyIsCiAgICAgICI8cT5JbiBlc3NlbmNlLCB0aGVzZSBhcmUgbGFyZ2Ugc2VydmVyIGNoYW1iZXJzIG1lYW50IHRvIHRyYXAgcm9ndWUgUEhQIGNvZGUsIGFsbG93aW5nIGl0IHRvIGV4ZWN1dGUgZmFyIGF3YXkgZnJvbSB5b3VyIGphdmFzY3JpcHQgd2hlcmUgaXQgY2FuIGRvIG1pbmltYWwgaGFybS48L3E+IiwKICAgICAgIkphdmFzY3JpcHQgY29uc29sZSIsCiAgICAgIDE0CiAgICApOwogICAgb3JkZXIgPSAxNTAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiT3Bwb3NpdGUgdW5pdmVyc2UiLAogICAgICAiPHE+WW91J3ZlIGxvY2F0ZWQgYSB1bml2ZXJzZSB3aGVyZSBldmVyeXRoaW5nIGlzIHJldmVyc2VkOiB1cCBpcyBkb3duLCBsaWdodCBpcyBkYXJrbmVzcywgY2xvd25zIGFyZSB2ZWdldGFyaWFucyAtIGJ1dCB3b3JzdCBvZiBhbGwsIHNvbWUgbHVuYXRpYyB0aGVyZSBpcyBtYW51ZmFjdHVyaW5nIGFib21pbmFibGUgYW1vdW50cyBvZiBhbnRpLWNvb2tpZXMuIElmIHRoZXNlIGNhbWUgaW50byBjb250YWN0IHdpdGggeW91cnMsIGV2ZXJ5dGhpbmcgd291bGQgYmUgbG9zdCEgVGhhbmtzIHRvIHRoaXMgZGlzY292ZXJ5LCB5b3UndmUgYmVlbiBhYmxlIHRvIHBsYWNlIHRoZSBvZmZlbmRpbmcgdW5pdmVyc2UgaW4gcGVybWFuZW50IHF1YXJhbnRpbmUsIGFuZCBwcmF5IHRoYXQgdGhlcmUgYXJlbid0IG1vcmUgbGlrZSBpdCBoaWRpbmcgYXJvdW5kIHNvbWV3aGVyZS48L3E+IiwKICAgICAgIklkbGV2ZXJzZSIsCiAgICAgIDE0CiAgICApOwogICAgb3JkZXIgPSAxNjAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiVGhlIGxhbmQgb2YgZHJlYW1zIiwKICAgICAgIjxxPllvdXIgcGxhbmV0IGJyYWlucyBoYXZlIGdhaW5lZCB0aGUgYWJpbGl0eSB0byBzbGVlcCwgYWN0aW5nIGFzIGEgc29mdCByZWJvb3Qgd2hpY2ggaGVscHMga2VlcCB0aGVpciBwYW5nZW5vY2lkYWwgaW1wdWxzZXMgaW4gY2hlY2suIEl0IGFsc28gYWxsb3dzIHRoZW0gdG8gY29tbXVuZSBpbiBhIHNoYXJlZCBkcmVhbXdvcmxkIGluIHdoaWNoIHRoZXkgY2FuIGltYWdpbmUgd2hhdCBpdCdzIGxpa2UgdG8gbm90IGV4aXN0IGFzIGEgZGlzZW1ib2RpZWQgY29zbWljIGhvcnJvciBmb3JldmVyIGZhdGVkIHRvIHVzZSBpdHMgaW5maW5pdGUgaW50ZWxsZWN0IHRvIGRldmlzZSBuZXcgbWVhbnMgb2YgY3JlYXRpbmcgYmlzY3VpdHMuIFlvdSBrbm93LCB3aXRoaW4gcmVhc29uLjwvcT4iLAogICAgICAiQ29ydGV4IGJha2VyIiwKICAgICAgMTQKICAgICk7CgogICAgb3JkZXIgPSA1MDAwOwogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIlRob3VnaHRzICYgcHJheWVycyIsCiAgICAgICI8cT5UaGUgbm90aW9uIG9mIHNhY3JlZG5lc3MgYXJpc2VzIGluIG1vc3Qgc2VudGllbnQgZXZvbHZlZCBicmFpbnMgYW5kIG1heSBiZW5lZml0IHRoZSBkZXZlbG9wbWVudCBvZiBjb2duaXRpb24gdmlhIGFic3RyYWN0IHRob3VnaHQuIFRoaXMgbWVjaGFuaXNtLCBob3dldmVyLCBpcyBhYnNlbnQgaW4gZGVzaWduZWQgbWluZHMgc3VjaCBhcyB5b3VyIGNvcnRleCBiYWtlcnM7IHRoaXMgcHJvY2VzcyBhdHRlbXB0cyB0byBhZGQgaXQgYmFjay4gSnVzdCBtYWtlIHN1cmUgdG8ga2VlcCB0aGVtIGluIGNoZWNrIC0geW91IHJlYWxseSBkb24ndCB3YW50IHRoZXNlIHRoaW5ncyB0byBkZXZlbG9wIG9yZ2FuaXplZCByZWxpZ2lvbi48L3E+IiwKICAgICAgIkNvcnRleCBiYWtlciIsCiAgICAgICJUZW1wbGUiLAogICAgICAic3luZXJneTEiCiAgICApOwogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIkZlcnRpbGUgbWluZHMiLAogICAgICAiPHE+QW4gYWN1dGUgaW50ZWxsZWN0LCBhcnRpZmljaWFsIG9yIG5vdCwgcmVxdWlyZXMgcGxlbnR5IG9mIHZpdGFtaW5zLiBZb3UgZm9ydHVpdG91c2x5IGhhcHBlbiB0byBiZSBpbiBjaGFyZ2Ugb2YgdmFzdCBmYXJtaW5nIG9wZXJhdGlvbnMsIG9ubHkgYSBmZXcgdHJpbGxpb24gYWNyZXMgb2Ygd2hpY2ggbmVlZCBiZSByZXF1aXNpdGlvbmVkIHRvIGdyb3cgdGhlIHF1YW50aXRpZXMgb2YgYnJvY2NvbGkgYW5kIGthbGUgdG8ga2VlcCB5b3VyIHBsYW5ldC1zaXplZCBicmFpbnMgaW4gdGlwLXRvcCBzaGFwZS4gT3BlbiB3aWRlLCBoZXJlIGNvbWVzIHRoZSBhaXJwbGFuZSE8L3E+IiwKICAgICAgIkNvcnRleCBiYWtlciIsCiAgICAgICJGYXJtIiwKICAgICAgInN5bmVyZ3kyIgogICAgKTsKCiAgICBvcmRlciA9IDE5MDAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRm9ydHVuZSAjMDE5IiwKICAgICAgIjxxPlRoZSBzbWFydGVzdCB3YXkgdG8gdGhpbmsgaXMgbm90IHRvIHRoaW5rIGF0IGFsbC48L3E+IiwKICAgICAgIkNvcnRleCBiYWtlciIsCiAgICAgICJmb3J0dW5lIgogICAgKTsKCiAgICBvcmRlciA9IDEwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJEZWNpbGxpb24gZmluZ2VycyIsCiAgICAgIGdldFN0clRob3VzYW5kRmluZ2Vyc0dhaW4oMjApICsKICAgICAgICAiPHE+SWYgeW91IHN0aWxsIGNhbid0IHF1aXRlIHB1dCB5b3VyIGZpbmdlciBvbiBpdCwgeW91IG11c3Qgbm90IGJlIHRyeWluZyB2ZXJ5IGhhcmQuPC9xPiIsCiAgICAgIDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwLAogICAgICBbMTIsIDM0XQogICAgKTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDE0LCAwKTsKICAgIG9yZGVyID0gMTUwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkFldGhlcmljZSBtb3VzZSIsCiAgICAgIGdldFN0ckNsaWNraW5nR2FpbnMoMSkgKwogICAgICAgICI8cT5NYWRlIGZyb20gYSBzdWJzdGFuY2UgaW1wb3NzaWJsZSB0byBtYW51ZmFjdHVyZSwgb25seSBvYnRhaW5lZCB0aHJvdWdoIG5hdHVyYWwgaGFwcGVuc3RhbmNlOyBpdHMgcHJvcGVydGllcyBiZXdpbGRlciBldmVuIHRoZSBtb3N0IHByZWNpc2UgbWVhc3VyaW5nIGluc3RydW1lbnRzLjwvcT4iLAogICAgICA1MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwLAogICAgICBbMTEsIDM0XQogICAgKTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDE0LCAxMSk7CgogICAgb3JkZXIgPSAyMDAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJLaXR0ZW4gYWRtaW5zIiwKICAgICAgc3RyS2l0dGVuRGVzYyArICI8cT5sZWFkZXJzaGlwIGFpbid0IGVhc3ksIHNpcjwvcT4iLAogICAgICA5MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIEdhbWUuR2V0SWNvbigiS2l0dGVuIiwgMTQpCiAgICApOwogICAgR2FtZS5sYXN0LmtpdHRlbiA9IDE7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCAxNCwgMTgpOwoKICAgIG9yZGVyID0gMTAzMDA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiRXZlcnlidXR0ZXIgYmlzY3VpdCIsCiAgICAgIGRlc2M6ICJSZXdhcmRlZCBmb3Igb3duaW5nIDY1MCBvZiBldmVyeXRoaW5nLjxicj5UaGlzIGJpc2N1aXQgaXMgYmFrZWQgd2l0aCwgYW5kIGNvYXRlZCBpbiwgZXZlcnkga2luZCBvZiBidXR0ZXIgZXZlciBpbWFnaW5lZCwgZnJvbSBldmVyeSBodW1hbiBjdWx0dXJlIGFuZCBhIGdvb2QgZmV3IGFsaWVuIG9uZXMgdG9vLiBTb21lIG9mIHRoZW0gcGVyaGFwcyBkaXNwbGF5IGhhbGx1Y2lub2dlbmljIHRyYWl0cywgYXMgdGhlIGJpc2N1aXQgc2VlbXMgdG8gY2hhbmdlIHNoYXBlIGluIGZyb250IG9mIHlvdSAtIHNlZW1pbmdseSBzaGlmdGluZyBiZXR3ZWVuIHZpc2lvbnMgb2YgZXZlcnkgcGFzdCBhbmQgZnV0dXJlIHlvdS4iLAogICAgICBpY29uOiBbMjIsIDM0XSwKICAgICAgcG93ZXI6IDEwLAogICAgICBwcmljZToKICAgICAgICA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKgogICAgICAgIGJ1dHRlckJpc2N1aXRNdWx0LAogICAgICBsb2NrZWQ6IDEsCiAgICB9KTsKCiAgICBHYW1lLk5ld1Vuc2hhY2tsZUJ1aWxkaW5nID0gZnVuY3Rpb24gKG9iaikgewogICAgICB2YXIgYnVpbGRpbmcgPSBHYW1lLk9iamVjdHNbb2JqLmJ1aWxkaW5nXTsKICAgICAgdmFyIHVwZ3JhZGUgPSBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAgICJVbnNoYWNrbGVkICIgKyBidWlsZGluZy5icGx1cmFsLAogICAgICAgIChvYmouYnVpbGRpbmcgPT0gIkN1cnNvciIKICAgICAgICAgID8gZ2V0U3RyVGhvdXNhbmRGaW5nZXJzR2FpbigyNSkKICAgICAgICAgIDogbG9jKAogICAgICAgICAgICAgICJUaWVyZWQgdXBncmFkZXMgZm9yIDxiPiUxPC9iPiBwcm92aWRlIGFuIGV4dHJhIDxiPislMiU8L2I+IHByb2R1Y3Rpb24uPGJyPk9ubHkgd29ya3Mgd2l0aCB1bnNoYWNrbGVkIHVwZ3JhZGUgdGllcnMuIiwKICAgICAgICAgICAgICBbCiAgICAgICAgICAgICAgICBjYXAoYnVpbGRpbmcucGx1cmFsKSwKICAgICAgICAgICAgICAgIE1hdGgucm91bmQoCiAgICAgICAgICAgICAgICAgIChidWlsZGluZy5pZCA9PSAxID8gMC41IDogKDIwIC0gYnVpbGRpbmcuaWQpICogMC4xKSAqIDEwMAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICBdCiAgICAgICAgICAgICkpICsgKEVOID8gIjxxPiIgKyBvYmoucSArICI8L3E+IiA6ICIiKSwKICAgICAgICBNYXRoLnBvdyhidWlsZGluZy5pZCArIDEsIDcpICogMTUwMDAwMDAsCiAgICAgICAgW2J1aWxkaW5nLmljb25Db2x1bW4sIDM1XQogICAgICApOwogICAgICB1cGdyYWRlLnBvb2wgPSAicHJlc3RpZ2UiOwogICAgICB1cGdyYWRlLnBhcmVudHMgPSBbCiAgICAgICAgb2JqLmJ1aWxkaW5nID09ICJDdXJzb3IiCiAgICAgICAgICA/ICJVbnNoYWNrbGVkIGZsYXZvciIKICAgICAgICAgIDogR2FtZS5PYmplY3RzQnlJZFtidWlsZGluZy5pZCAtIDFdLnVuc2hhY2tsZVVwZ3JhZGUsCiAgICAgIF07CiAgICAgIGJ1aWxkaW5nLnVuc2hhY2tsZVVwZ3JhZGUgPSB1cGdyYWRlLm5hbWU7CiAgICAgIHVwZ3JhZGUucG9zWCA9IDc1MCAtIE1hdGguc2luKChidWlsZGluZy5pZCArIDEpICogMC4yNSArIDIuMykgKiA1MDA7CiAgICAgIHVwZ3JhZGUucG9zWSA9IDIwMCArIE1hdGguY29zKChidWlsZGluZy5pZCArIDEpICogMC4yNSArIDIuMykgKiA1MDA7CiAgICAgIHJldHVybiB1cGdyYWRlOwogICAgfTsKCiAgICAvLyJVbnNoYWNrbGVkIFtidWlsZGluZyBuYW1lXSIKICAgIEdhbWUuTmV3VW5zaGFja2xlQnVpbGRpbmcoewogICAgICBidWlsZGluZzogIkN1cnNvciIsCiAgICAgIHE6ICJUaGVzZSBoYW5kcyB0ZWxsIGEgc3RvcnkuIiwKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVCdWlsZGluZyh7IGJ1aWxkaW5nOiAiR3JhbmRtYSIsIHE6ICJOZXZlciB0b28gb2xkLiIgfSk7CiAgICBHYW1lLk5ld1Vuc2hhY2tsZUJ1aWxkaW5nKHsgYnVpbGRpbmc6ICJGYXJtIiwgcTogIlRpbGwgdGhlIHVuaXZlcnNlLiIgfSk7CiAgICBHYW1lLk5ld1Vuc2hhY2tsZUJ1aWxkaW5nKHsKICAgICAgYnVpbGRpbmc6ICJNaW5lIiwKICAgICAgcTogJ1JlZGVmaW5lIHRoZSBtZWFuaW5nIG9mICJkZXB0aCIuJywKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVCdWlsZGluZyh7CiAgICAgIGJ1aWxkaW5nOiAiRmFjdG9yeSIsCiAgICAgIHE6ICJOb3RoaW5nIHRvIGxvc2UgYnV0IHlvdXIgcHJvZHVjdGlvbiBjaGFpbnMuIiwKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVCdWlsZGluZyh7CiAgICAgIGJ1aWxkaW5nOiAiQmFuayIsCiAgICAgIHE6ICJBbGwtdGltZSBoaWdocywgYWxsIHRoZSB0aW1lLiIsCiAgICB9KTsKICAgIEdhbWUuTmV3VW5zaGFja2xlQnVpbGRpbmcoewogICAgICBidWlsZGluZzogIlRlbXBsZSIsCiAgICAgIHE6ICJZb3UgY2FuIG1ha2UgYSByZWxpZ2lvbiBvdXQgb2YgdGhpcy4iLAogICAgfSk7CiAgICBHYW1lLk5ld1Vuc2hhY2tsZUJ1aWxkaW5nKHsKICAgICAgYnVpbGRpbmc6ICJXaXphcmQgdG93ZXIiLAogICAgICBxOiAiVGhlcmUncyBhIHNwZWxsIGZvciBldmVyeXRoaW5nLiIsCiAgICB9KTsKICAgIEdhbWUuTmV3VW5zaGFja2xlQnVpbGRpbmcoewogICAgICBidWlsZGluZzogIlNoaXBtZW50IiwKICAgICAgcTogIkV2ZXJ5d2hlcmUgYXQgb25jZS4iLAogICAgfSk7CiAgICBHYW1lLk5ld1Vuc2hhY2tsZUJ1aWxkaW5nKHsKICAgICAgYnVpbGRpbmc6ICJBbGNoZW15IGxhYiIsCiAgICAgIHE6ICJBbnl0aGluZyB5b3Ugc2VlLCB5b3UgY2FuIG1ha2UuIiwKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVCdWlsZGluZyh7CiAgICAgIGJ1aWxkaW5nOiAiUG9ydGFsIiwKICAgICAgcTogIlBhcmFsbGVscyB1bnBhcmFsbGVsZWQuIiwKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVCdWlsZGluZyh7CiAgICAgIGJ1aWxkaW5nOiAiVGltZSBtYWNoaW5lIiwKICAgICAgcTogIkFsbCB0aGUgdGltZSBpbiB0aGUgd29ybGQuIiwKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVCdWlsZGluZyh7CiAgICAgIGJ1aWxkaW5nOiAiQW50aW1hdHRlciBjb25kZW5zZXIiLAogICAgICBxOiAiTm8gc2NhbGUgdG9vIGxhcmdlIG9yIHRvbyBsaXR0bGUuIiwKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVCdWlsZGluZyh7CiAgICAgIGJ1aWxkaW5nOiAiUHJpc20iLAogICAgICBxOiAiQnJpbGxpYW5jZSBoYXMgbm8gdXBwZXIgbGltaXQuIiwKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVCdWlsZGluZyh7CiAgICAgIGJ1aWxkaW5nOiAiQ2hhbmNlbWFrZXIiLAogICAgICBxOiAiWW91IG1ha2UgdGhlIHJ1bGVzLiIsCiAgICB9KTsKICAgIEdhbWUuTmV3VW5zaGFja2xlQnVpbGRpbmcoewogICAgICBidWlsZGluZzogIkZyYWN0YWwgZW5naW5lIiwKICAgICAgcTogIlVuY29udGFpbmVkLiIsCiAgICB9KTsKICAgIEdhbWUuTmV3VW5zaGFja2xlQnVpbGRpbmcoewogICAgICBidWlsZGluZzogIkphdmFzY3JpcHQgY29uc29sZSIsCiAgICAgIHE6ICJSZXdyaXRlIHlvdXIgcmVhbGl0eS4iLAogICAgfSk7CiAgICBHYW1lLk5ld1Vuc2hhY2tsZUJ1aWxkaW5nKHsKICAgICAgYnVpbGRpbmc6ICJJZGxldmVyc2UiLAogICAgICBxOiAiV2FpdCBldmVuIGZhc3Rlci4iLAogICAgfSk7CiAgICBHYW1lLk5ld1Vuc2hhY2tsZUJ1aWxkaW5nKHsKICAgICAgYnVpbGRpbmc6ICJDb3J0ZXggYmFrZXIiLAogICAgICBxOiAiTm90aGluZyBpcyByZWFsLiBFdmVyeXRoaW5nIGlzIHBlcm1pdHRlZC4iLAogICAgfSk7CgogICAgR2FtZS5OZXdVbnNoYWNrbGVVcGdyYWRlVGllciA9IGZ1bmN0aW9uIChvYmopIHsKICAgICAgdmFyIHRpZXIgPSBHYW1lLlRpZXJzW29iai50aWVyXTsKICAgICAgdmFyIHVwZ3JhZGUgPSBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAgIG9iai50aWVyID09IDEKICAgICAgICAgID8gIlVuc2hhY2tsZWQgZmxhdm9yIgogICAgICAgICAgOiAiVW5zaGFja2xlZCAiICsgdGllci5uYW1lLnRvTG93ZXJDYXNlKCksCiAgICAgICAgbG9jKAogICAgICAgICAgIlVuc2hhY2tsZXMgYWxsIDxiPiUxLXRpZXIgdXBncmFkZXM8L2I+LCBtYWtpbmcgdGhlbSBtb3JlIHBvd2VyZnVsLjxicj5Pbmx5IGFwcGxpZXMgdG8gdW5zaGFja2xlZCBidWlsZGluZ3MuIiwKICAgICAgICAgIGNhcChsb2MoIltUaWVyXSIgKyB0aWVyLm5hbWUsIDAsIHRpZXIubmFtZSkpCiAgICAgICAgKSArIChFTiA/ICI8cT4iICsgb2JqLnEgKyAiPC9xPiIgOiAiIiksCiAgICAgICAgTWF0aC5wb3cob2JqLnRpZXIsIDcuNSkgKiAxMDAwMDAwMCwKICAgICAgICBbMTAsIHRpZXIuaWNvblJvd10KICAgICAgKTsKICAgICAgdXBncmFkZS5wb29sID0gInByZXN0aWdlIjsKICAgICAgdXBncmFkZS5wYXJlbnRzID0gWwogICAgICAgIG9iai50aWVyID09IDEKICAgICAgICAgID8gIkxhYmVsIHByaW50ZXIiCiAgICAgICAgICA6IEdhbWUuVGllcnNbb2JqLnRpZXIgLSAxXS51bnNoYWNrbGVVcGdyYWRlLAogICAgICBdOwogICAgICB0aWVyLnVuc2hhY2tsZVVwZ3JhZGUgPSB1cGdyYWRlLm5hbWU7CiAgICAgIHVwZ3JhZGUucG9zWCA9IDc1MCAtIE1hdGguc2luKG9iai50aWVyICogMC4zICsgMi4zKSAqIDQwMDsKICAgICAgdXBncmFkZS5wb3NZID0gMjAwICsgTWF0aC5jb3Mob2JqLnRpZXIgKiAwLjMgKyAyLjMpICogNDAwOwogICAgICAvKnVwZ3JhZGUucGFyZW50cz1bb2JqLnRpZXI9PTE/J0xhYmVsIHByaW50ZXInOkdhbWUuVGllcnNbb2JqLnRpZXItMV0udW5zaGFja2xlVXBncmFkZV07CgkJCXRpZXIudW5zaGFja2xlVXBncmFkZT11cGdyYWRlLm5hbWU7CgkJCXVwZ3JhZGUucG9zWD0tOTAwK01hdGguc2luKG9iai50aWVyKjAuMysyLjMpKjMwMDsKCQkJdXBncmFkZS5wb3NZPS0xMzArTWF0aC5jb3Mob2JqLnRpZXIqMC4zKzIuMykqNDAwOyovCiAgICAgIHJldHVybiB1cGdyYWRlOwogICAgfTsKCiAgICAvLyJVbnNoYWNrbGVkIFt0aWVyIG5hbWVdIgogICAgR2FtZS5OZXdVbnNoYWNrbGVVcGdyYWRlVGllcih7CiAgICAgIHRpZXI6IDEsCiAgICAgIHE6ICJXaGlsZSB0aGUgYWJzZW5jZSBvZiBmbGF2b3JpbmcgbWF5IHNlZW0gdW5kZXJ3aGVsbWluZywgaXQgYWxsb3dzIGlubmF0ZSBhcm9tYXMgdG8gYmUgZXhwcmVzc2VkIGF0IHRoZWlyIG1vc3QgdW5hZHVsdGVyYXRlZC4iLAogICAgfSk7CiAgICBHYW1lLk5ld1Vuc2hhY2tsZVVwZ3JhZGVUaWVyKHsKICAgICAgdGllcjogMiwKICAgICAgcTogIkJlcnJ5bGl1bSBpcyBhIHN5bnRoZXRpYyBnZW0gd2l0aCBhIHNpbXBsZSBzaGluZSB0byBpdC4gU3RpY2t5IHRvIHRoZSB0b3VjaCBhbmQgc3VzY2VwdGlibGUgdG8gbWVsdGluZyBpbiBoaWdoIGhlYXQsIGl0IGlzIGZyZXF1ZW50bHkgdXNlZCBpbiB0aGUgZm9vZCBpbmR1c3RyeSByYXRoZXIgdGhhbiBhcyBhZG9ybm1lbnQsIGFzIGl0cyBhdG9taWMgc3RydWN0dXJlIGltcGFydHMgaXQgYSB2YWd1ZWx5IGZydWl0eSBmbGF2b3IuIiwKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVVcGdyYWRlVGllcih7CiAgICAgIHRpZXI6IDMsCiAgICAgIHE6ICJCbHVlYmVycnlsaXVtIGlzIGEgcmVmaW5lbWVudCBvZiBiZXJyeWxpdW0sIHNoYXJpbmcgbmVhcmx5IHRoZSBzYW1lIGNoZW1pY2FsIG1ha2V1cCBzYXZlIGZvciBhIGZldyBzdXBwbGVtZW50YWwgZXN0ZXJzLiBUaGVzZSBhZmZlY3QgaXRzIGZsYXZvciBhcyB3ZWxsIGFzIGl0cyB2aXN1YWwgc3BlY3RydW0gcmVzb25hbmNlLiIsCiAgICB9KTsKICAgIEdhbWUuTmV3VW5zaGFja2xlVXBncmFkZVRpZXIoewogICAgICB0aWVyOiA0LAogICAgICBxOiAiUmF3IGNoYWxjZWRob25leSBpcyBmb3VuZCBpbiBjb21wbGV4IG5vZHVsZXMgd2l0aGluIHRoZSBmb3NzaWxpemVkIHJlbWFpbnMgb2YgYW5jaWVudCBmb3Jlc3RzLiBPbmNlIHB1cmlmaWVkLCBpdCBiZWNvbWVzIGEgc2VtaS12YWx1YWJsZSBzdG9uZSB3aXRoIGEgcGxlYXNhbnQsIHdheHkgc21lbGwuIiwKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVVcGdyYWRlVGllcih7CiAgICAgIHRpZXI6IDUsCiAgICAgIHE6ICJCdXR0ZXJnb2xkIHdhcyBmYW1vdXNseSBpbnZlbnRlZCBieSB0aGUgY2hlZiBzb24gb2YgdHdvIG1vbGVjdWxhciBwaHlzaWNpc3RzLiBOZWl0aGVyIGNsb3NlbHkgcmVsYXRlZCB0byBidXR0ZXIgbm9yIHRvIGdvbGQsIHlldCBzaW1pbGFyIGluIG51dHJpdGlvbmFsIHZhbHVlLCB0aGlzIGdsaW1tZXJpbmcgc3Vic3RhbmNlIGNhbiBiZSBmcm96ZW4gYW5kIHByZXNlcnZlIGl0cyBoYXJkbmVzcyBhdCByb29tIHRlbXBlcmF0dXJlLCBvbmx5IHJlZ2FpbmluZyBpdHMgbWFsbGVhYmlsaXR5IHdoZW4gaGVhdGVkIHVwLiIsCiAgICB9KTsKICAgIEdhbWUuTmV3VW5zaGFja2xlVXBncmFkZVRpZXIoewogICAgICB0aWVyOiA2LAogICAgICBxOiAiU3VnYXJtdWNrIHJlZmVycyB0byB0aGUgZ3JhZHVhbCBjcnVzdCB0aGF0IHNlZW1zIHRvIGZvcm0gc3BvbnRhbmVvdXNseSBpbiB0aGUgdmljaW5pdHkgb2YgY2FuZHktbWFraW5nIGVxdWlwbWVudC4gTG9uZyBpZ25vcmVkIGJ5IGNvbmZlY3Rpb25lcnMsIGl0cyBoYXJ2ZXN0aW5nIHByb2Nlc3Mgd2FzIGRpc2NvdmVyZWQgc2ltdWx0YW5lb3VzbHkgaW4gbXVsdGlwbGUgY291bnRyaWVzIGR1cmluZyBhIGdsb2JhbCBiZWV0IHNob3J0YWdlLiIsCiAgICB9KTsKICAgIEdhbWUuTmV3VW5zaGFja2xlVXBncmFkZVRpZXIoewogICAgICB0aWVyOiA3LAogICAgICBxOiAiVGhlIHN0cmlraW5nIHRhc3RlIG9mIGpldG1pbnQgbWFkZSBpdCBwb3B1bGFyIGluIHRoZSBtYW51ZmFjdHVyZSBvZiB2YXJpb3VzIGtpbmRzIG9mIGNvZmZlZS1zaWRlIHRyZWF0cyB1bnRpbCB0aGUgYXdhcmVuZXNzIG9mIGl0cyBtaWxkIHJhZGlvYWN0aXZpdHkgYmVjYW1lIHdpZGVzcHJlYWQuIFRvZGF5LCBpdHMgbWFpbiB1c2VzIGFyZSBpbiBjb3NtZXRpY3MsIG93aW5nIHRvIHRoZSByZWZyZXNoaW5nIHNlbnNhdGlvbiBpdCBwcm9kdWNlcyBvbiBjb250YWN0LiIsCiAgICB9KTsKICAgIEdhbWUuTmV3VW5zaGFja2xlVXBncmFkZVRpZXIoewogICAgICB0aWVyOiA4LAogICAgICBxOiAiQ2hlcnJ5c2lsdmVyIGlzIGEgcGF0ZW50ZWQgYWxsb3kgd2l0aCBwZWN1bGlhciBhcm9tYXRpYyBwcm9wZXJ0aWVzOyBpdCBpcyBub24tZWRpYmxlLCBidXQgcHJvZHVjZXMgc3Ryb25nIGZsYXZvciByZXNwb25zZXMgd2hpbGUgbG9zaW5nIHZlcnkgbGl0dGxlIG9mIGl0cyBtYXNzIHdoZW4gbGlja2VkLCB0aG91Z2ggdGhpcyBhbHNvIGxlYXZlcyBhIGhhcm1sZXNzIHJlZCB0aW5nZSB1cG9uIHRoZSB0b25ndWUuIiwKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVVcGdyYWRlVGllcih7CiAgICAgIHRpZXI6IDksCiAgICAgIHE6ICJIYXplbHJhbGQgaXMgYSBmcmlhYmxlIGdlbXN0b25lIHdpdGggY29tcGxleCBncmVlbi1icm93biBpbm5lciByZWZsZWN0aW9ucy4gSXQgaXMgY29uc2lkZXJlZCBvcm5hbWVudGFsIGluIHNvbWUgY3VsdHVyZXM7IGluIG90aGVycywgaXQgbWF5IGJlIGNvbnN1bWVkIGluIHNtYWxsIHF1YW50aXRpZXMgYXMgYW4gdXBwZXItc2NhbGUgc3dlZXQuIiwKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVVcGdyYWRlVGllcih7CiAgICAgIHRpZXI6IDEwLAogICAgICBxOiAiV2hpbGUgbWFueSBnZXQgaXQgbWl4ZWQgdXAgd2l0aCB0aGUgdHJhZGVtYXJrZWQgc25hY2sgb2YgdGhlIHNhbWUgbmFtZSBtYWRlIHBvcHVsYXIgZm9sbG93aW5nIGl0cyBkaXNjb3ZlcnksIG1vb25jYW5keSBpcyBhIHZlcnkgcmVhbCBtaW5lcmFsLCBmaXJzdCBpc29sYXRlZCB3aXRoaW4gdGhlIHNwYWNlIGR1c3QgdW5kZXJuZWF0aCBhc3Ryb25hdXQgYm9vdHMuIExlZnQgdG8gaXRzIG93biBkZXZpY2VzIGluIG9wZW4gYWlyLCBhIG1vb25jYW5keSBjcnlzdGFsIG5hdHVyYWxseSBzcHJlYWRzIG91dCBhbmQgZ3Jvd3MuIiwKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVVcGdyYWRlVGllcih7CiAgICAgIHRpZXI6IDExLAogICAgICBxOiAiV2hlbiB5b3UgaGVhdCB1cCB0aGUgc2hpbW1lcmluZyBzeXJ1cCBvb3ppbmcgZnJvbSBtb29uY2FuZHkgdXNpbmcgYSBzcGVjaWFsIGNhcmFtZWxpemF0aW9uIHByb2Nlc3MsIHlvdSBnZXQgYXN0cm9mdWRnZS4gQXN0cm9mdWRnZSBpcyBkZWxpY2lvdXMgYW5kIHNhZmUgZm9yIGh1bWFub2lkIGNvbnN1bXB0aW9uIGluIGNlcnRhaW4gcXVhbnRpdGllcy4gQ29uc3VsdCB5b3VyIGxvY2FsIGZvb2Qgc2FmZXR5IGFnZW5jeSBmb3IgbW9yZSBkZXRhaWxzLiIsCiAgICB9KTsKICAgIEdhbWUuTmV3VW5zaGFja2xlVXBncmFkZVRpZXIoewogICAgICB0aWVyOiAxMiwKICAgICAgcTogJ01vbGVjdWxhcmx5IHJlbGF0ZWQgdG8gZGFpcnksIGFsYWJhc2NyZWFtIG9jY3VycyBuYXR1cmFsbHkgYXQgaGlnaCBhbHRpdHVkZXMsIGZvcm1pbmcgaW4gd2lzcHkgZmlsYW1lbnRzIHdoaWNoIHdlcmUgbG9uZyBpbmRpc3Rpbmd1aXNoYWJsZSBmcm9tIGNsb3Vkcy4gQW4gZXhwZW5zaXZlIGRlbGlnaHQsIGl0IGlzIGFsc28ga25vd24gYXMgInBpbG90c1wnIGJhbmUiLicsCiAgICB9KTsKICAgIEdhbWUuTmV3VW5zaGFja2xlVXBncmFkZVRpZXIoewogICAgICB0aWVyOiAxMywKICAgICAgcTogIklyaWR5dW0gc2hhcmVzIGxpdHRsZSBpbiBjb21tb24gd2l0aCBhbnkgb3RoZXIgbWF0ZXJpYWwga25vd24gdG8gbWFua2luZC4gUmF0aGVyIHRoYW4gc2ltcGx5IHNtZWxsZWQsIGl0IGNhbiBiZSB0YXN0ZWQgZnJvbSBhIGRpc3RhbmNlLCB0aG91Z2ggcmVtYWluaW5nIGluIGl0cyBwcmVzZW5jZSB0b28gbG9uZyBpcyBpbGwtYWR2aXNlZC4gU29tZSBoaWdoLWVuZCB1bmRlcmdyb3VuZCBtZWdhY29tcHV0ZXJzIG1heSBpbmNvcnBvcmF0ZSBpcmlkeXVtIGFzIHBhcnQgb2YgdGhlaXIgZWxlY3Ryb25pYyBjb21wb25lbnRzLiIsCiAgICB9KTsKICAgIEdhbWUuTmV3VW5zaGFja2xlVXBncmFkZVRpZXIoewogICAgICB0aWVyOiAxNCwKICAgICAgcTogIkdsdWNvc21pdW0gaXMgYSBnbG9zc3kgbWV0YWwgd2hvc2UgZmxhdm9yIG1hdHJpeCBpcyBib3VuZCB0byBpdHMgY3VycmVudCBzdWJqZWN0aXZlIGNocm9tYTsgaW4gb3RoZXIgd29yZHMsIGl0cyB0YXN0ZSBkZXBlbmRzIG9uIHdoaWNoIGNvbG9ycyBpdCdzIGN1cnJlbnRseSByZWZsZWN0aW5nLiBJbXByYWN0aWNhbCB0byBjb25zdW1lIHNhZmVseSwgaXRzIGluZHVzdHJpYWwgYXBwbGljYXRpb25zIHJhbmdlIGZyb20gdHJhbnNjb250aW5lbnRhbCBiYWxsaXN0aWNzIHRvIHBhaW50IHZhcm5pc2guIiwKICAgIH0pOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJEZWxpY2F0ZSB0b3VjaCIsCiAgICAgIGxvYygKICAgICAgICAiVGhlIDxiPnNoaW1tZXJpbmcgdmVpbDwvYj4gaXMgbW9yZSByZXNpc3RhbnQsIGFuZCBoYXMgYSA8Yj4lMSUgY2hhbmNlPC9iPiBub3QgdG8gYnJlYWsuIEl0IGFsc28gZ2l2ZXMgPGI+KyUyJTwvYj4gbW9yZSBDcFMuIiwKICAgICAgICBbMTAsIDVdCiAgICAgICkgKyAiPHE+SXQgYnJlYWtzIHNvIGVhc2lseS48L3E+IiwKICAgICAgOTk5OTk5OTk5OSAqIDE1LAogICAgICBbMjMsIDM0XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJSZWluZm9yY2VkIG1lbWJyYW5lIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiU3RlYWRmYXN0IG11cm11ciIsCiAgICAgIGxvYygKICAgICAgICAiVGhlIDxiPnNoaW1tZXJpbmcgdmVpbDwvYj4gaXMgbW9yZSByZXNpc3RhbnQsIGFuZCBoYXMgYSA8Yj4lMSUgY2hhbmNlPC9iPiBub3QgdG8gYnJlYWsuIEl0IGFsc28gZ2l2ZXMgPGI+KyUyJTwvYj4gbW9yZSBDcFMuIiwKICAgICAgICBbMTAsIDVdCiAgICAgICkgKyAiPHE+TGVuZCBhbiBlYXIgYW5kIGxpc3Rlbi48L3E+IiwKICAgICAgOTk5OTk5OTk5OTk5ICogMTUsCiAgICAgIFsyMywgMzRdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkRlbGljYXRlIHRvdWNoIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiR2xpdHRlcmluZyBlZGdlIiwKICAgICAgbG9jKAogICAgICAgICJUaGUgPGI+c2hpbW1lcmluZyB2ZWlsPC9iPiBpcyBtb3JlIHJlc2lzdGFudCwgYW5kIGhhcyBhIDxiPiUxJSBjaGFuY2U8L2I+IG5vdCB0byBicmVhay4gSXQgYWxzbyBnaXZlcyA8Yj4rJTIlPC9iPiBtb3JlIENwUy4iLAogICAgICAgIFsxMCwgNV0KICAgICAgKSArICI8cT5KdXN0IHdpdGhpbiByZWFjaCwgeWV0IGF0IHdoYXQgY29zdD88L3E+IiwKICAgICAgOTk5OTk5OTk5OTk5OTkgKiAxNSwKICAgICAgWzIzLCAzNF0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiU3RlYWRmYXN0IG11cm11ciJdOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJEaXN0aW5ndWlzaGVkIHdhbGxwYXBlciBhc3NvcnRtZW50IiwKICAgICAgKEVOCiAgICAgICAgPyBsb2MoIkNvbnRhaW5zIG1vcmUgd2FsbHBhcGVycyBmb3IgeW91ciBiYWNrZ3JvdW5kIHNlbGVjdG9yLiIpCiAgICAgICAgOiAiIikgKwogICAgICAgICI8cT5EbyB5b3UgZXZlciB0aGluayBhYm91dCB0aGUgcGh5c2ljYWxpdHkgb2YgdGhpcyBwbGFjZT8gQXJlIHlvdSBwdXR0aW5nIHVwIHRoZXNlIHdhbGxwYXBlcnMgaW4geW91ciBvZmZpY2Ugb3Igc29tZXRoaW5nPyBXaGVyZSBhcmUgeW91LCBhbnl3YXk/PC9xPiIsCiAgICAgIDEwMDAwMDAwLAogICAgICBbMjcsIDVdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkJhc2ljIHdhbGxwYXBlciBhc3NvcnRtZW50Il07CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlNvdW5kIHRlc3QiLAogICAgICBsb2MoCiAgICAgICAgIlVubG9ja3MgdGhlIDxiPmp1a2Vib3g8L2I+LCB3aGljaCBhbGxvd3MgeW91IHRvIHBsYXkgdGhyb3VnaCBldmVyeSBzb3VuZCBmaWxlIGluIHRoZSBnYW1lLiIKICAgICAgKSArICI8cT5PbmUgdHdvLCBvbmUgdHdvLiBJcyB0aGlzIHRoaW5nIG9uPzwvcT4iLAogICAgICA5OTk5OTk5OTk5OSwKICAgICAgWzMxLCAxMl0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsKICAgICAgIkZhbmNpZnVsIGRhaXJ5IHNlbGVjdGlvbiIsCiAgICAgICJEaXN0aW5ndWlzaGVkIHdhbGxwYXBlciBhc3NvcnRtZW50IiwKICAgICAgIkdvbGRlbiBjb29raWUgYWxlcnQgc291bmQiLAogICAgXTsKCiAgICBvcmRlciA9IDQ5OTAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkp1a2Vib3giLAogICAgICBsb2MoIlBsYXkgdGhyb3VnaCB0aGUgZ2FtZSdzIHNvdW5kIGZpbGVzISIpLAogICAgICAwLAogICAgICBbMzEsIDEyXQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInRvZ2dsZSI7CiAgICBHYW1lLmp1a2Vib3ggPSB7CiAgICAgIHNvdW5kczogWwogICAgICAgICJ0aWNrIiwKICAgICAgICAidGlja09mZiIsCiAgICAgICAgInNtYWxsVGljayIsCiAgICAgICAgInRvbmVUaWNrIiwKICAgICAgICAiY2xpY2tPbiIsCiAgICAgICAgImNsaWNrT24yIiwKICAgICAgICAiY2xpY2tPZmYiLAogICAgICAgICJjbGlja09mZjIiLAogICAgICAgICJwb3AxIiwKICAgICAgICAicG9wMiIsCiAgICAgICAgInBvcDMiLAogICAgICAgICJwcmVzcyIsCiAgICAgICAgLy8nc3dpdGNoJywKICAgICAgICAiYnV5MSIsCiAgICAgICAgImJ1eTIiLAogICAgICAgICJidXkzIiwKICAgICAgICAiYnV5NCIsCiAgICAgICAgInNlbGwxIiwKICAgICAgICAic2VsbDIiLAogICAgICAgICJzZWxsMyIsCiAgICAgICAgInNlbGw0IiwKICAgICAgICAiYnV5SGVhdmVubHkiLAogICAgICAgICJjbGljazEiLAogICAgICAgICJjbGljazIiLAogICAgICAgICJjbGljazMiLAogICAgICAgICJjbGljazQiLAogICAgICAgICJjbGljazUiLAogICAgICAgICJjbGljazYiLAogICAgICAgICJjbGljazciLAogICAgICAgICJjbGlja2IxIiwKICAgICAgICAiY2xpY2tiMiIsCiAgICAgICAgImNsaWNrYjMiLAogICAgICAgICJjbGlja2I0IiwKICAgICAgICAiY2xpY2tiNSIsCiAgICAgICAgImNsaWNrYjYiLAogICAgICAgICJjbGlja2I3IiwKICAgICAgICAiY2hhcmdpbmciLAogICAgICAgICJ0aHVkIiwKICAgICAgICAvLydjb29raWVCcmVhaycsCiAgICAgICAgImN5bWJhbFJldiIsCiAgICAgICAgLy8nY3ltYmFsQ3Jhc2gnLAogICAgICAgICJzbWFsbEN5bWJhbENyYXNoIiwKICAgICAgICAiY2hvaXIiLAogICAgICAgICJjaGltZSIsCiAgICAgICAgInNoaW1tZXJDbGljayIsCiAgICAgICAgImppbmdsZSIsCiAgICAgICAgImppbmdsZUNsaWNrIiwKICAgICAgICAiZm9ydHVuZSIsCiAgICAgICAgInRpbGwxIiwKICAgICAgICAidGlsbDIiLAogICAgICAgICJ0aWxsMyIsCiAgICAgICAgInRpbGxiMSIsCiAgICAgICAgInRpbGxiMiIsCiAgICAgICAgInRpbGxiMyIsCiAgICAgICAgImhhcnZlc3QxIiwKICAgICAgICAiaGFydmVzdDIiLAogICAgICAgICJoYXJ2ZXN0MyIsCiAgICAgICAgImZyZWV6ZUdhcmRlbiIsCiAgICAgICAgImdyb3dsIiwKICAgICAgICAic25hcmwiLAogICAgICAgICJwYWdlIiwKICAgICAgICAic3dvb3NoSW4iLAogICAgICAgICJzd29vc2hPdXQiLAogICAgICAgICJzcGVsbCIsCiAgICAgICAgInNwZWxsRmFpbCIsCiAgICAgICAgInNwaXJpdCIsCiAgICAgICAgInNxdWlzaDEiLAogICAgICAgICJzcXVpc2gyIiwKICAgICAgICAic3F1aXNoMyIsCiAgICAgICAgInNxdWlzaDQiLAogICAgICAgICJzcXVlYWsxIiwKICAgICAgICAic3F1ZWFrMiIsCiAgICAgICAgInNxdWVhazMiLAogICAgICAgICJzcXVlYWs0IiwKICAgICAgICAiY2FzaEluIiwKICAgICAgICAiY2FzaEluMiIsCiAgICAgICAgImNhc2hPdXQiLAogICAgICAgICJ1cGdyYWRlIiwKICAgICAgICAvLydsZXZlbFByZXN0aWdlJywKICAgICAgXSwKICAgICAgdHJhY2tzOiBbXSwgLy9wb3B1bGF0ZWQgZXh0ZXJuYWxseQogICAgICBvblNvdW5kOiAwLAogICAgICBvblRyYWNrOiAwLAogICAgICB0cmFja0xvb3BlZDogdHJ1ZSwKICAgICAgdHJhY2tBdXRvOiB0cnVlLAogICAgICB0cmFja1NodWZmbGU6IGZhbHNlLAogICAgICByZXNldDogZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBtZSA9IEdhbWUuanVrZWJveDsKICAgICAgICBtZS5vblNvdW5kID0gMDsKICAgICAgICBtZS5vblRyYWNrID0gMDsKICAgICAgICBtZS50cmFja0xvb3BlZCA9IHRydWU7CiAgICAgICAgbWUudHJhY2tBdXRvID0gdHJ1ZTsKICAgICAgICBtZS50cmFja1NodWZmbGUgPSBmYWxzZTsKICAgICAgfSwKICAgICAgc2V0U291bmQ6IGZ1bmN0aW9uIChpZCkgewogICAgICAgIGlmIChpZCA+PSBHYW1lLmp1a2Vib3guc291bmRzLmxlbmd0aCkgaWQgPSAwOwogICAgICAgIGVsc2UgaWYgKGlkIDwgMCkgaWQgPSBHYW1lLmp1a2Vib3guc291bmRzLmxlbmd0aCAtIDE7CiAgICAgICAgR2FtZS5qdWtlYm94Lm9uU291bmQgPSBpZDsKICAgICAgICBpZiAobCgianVrZWJveE9uU291bmQiKSkgewogICAgICAgICAgdHJpZ2dlckFuaW0obCgianVrZWJveFBsYXllciIpLCAicHVja2VyIik7CiAgICAgICAgICBsKCJqdWtlYm94T25Tb3VuZCIpLmlubmVySFRNTCA9CiAgICAgICAgICAgICImYnVsbDsgIiArIEdhbWUuanVrZWJveC5zb3VuZHNbR2FtZS5qdWtlYm94Lm9uU291bmRdICsgIiAmYnVsbDsiOwogICAgICAgICAgbCgianVrZWJveE9uU291bmROIikuaW5uZXJIVE1MID0KICAgICAgICAgICAgR2FtZS5qdWtlYm94Lm9uU291bmQgKyAxICsgIi8iICsgR2FtZS5qdWtlYm94LnNvdW5kcy5sZW5ndGg7CiAgICAgICAgICBsKCJqdWtlYm94U291bmRTZWxlY3QiKS52YWx1ZSA9IEdhbWUuanVrZWJveC5vblNvdW5kOwogICAgICAgIH0KICAgICAgICBQbGF5U291bmQoCiAgICAgICAgICAic25kLyIgKyBHYW1lLmp1a2Vib3guc291bmRzW0dhbWUuanVrZWJveC5vblNvdW5kXSArICIubXAzIiwKICAgICAgICAgIDEKICAgICAgICApOwogICAgICB9LAogICAgICBzZXRUcmFjazogZnVuY3Rpb24gKGlkLCBkb250UGxheSkgewogICAgICAgIGlmIChpZCA+PSBHYW1lLmp1a2Vib3gudHJhY2tzLmxlbmd0aCkgaWQgPSAwOwogICAgICAgIGVsc2UgaWYgKGlkIDwgMCkgaWQgPSBHYW1lLmp1a2Vib3gudHJhY2tzLmxlbmd0aCAtIDE7CiAgICAgICAgR2FtZS5qdWtlYm94Lm9uVHJhY2sgPSBpZDsKICAgICAgICB2YXIgZGF0YSA9CiAgICAgICAgICBNdXNpYy50cmFja3NbR2FtZS5qdWtlYm94LnRyYWNrc1tHYW1lLmp1a2Vib3gub25UcmFja11dLmF1ZGlvOwogICAgICAgIGlmIChsKCJqdWtlYm94T25UcmFjayIpKSB7CiAgICAgICAgICB0cmlnZ2VyQW5pbShsKCJqdWtlYm94UGxheWVyIiksICJwdWNrZXIiKTsKICAgICAgICAgIGwoImp1a2Vib3hPblRyYWNrIikuaW5uZXJIVE1MID0KICAgICAgICAgICAgIiZidWxsOyAiICsKICAgICAgICAgICAgY2FwKEdhbWUuanVrZWJveC50cmFja3NbR2FtZS5qdWtlYm94Lm9uVHJhY2tdKSArCiAgICAgICAgICAgICIgJmJ1bGw7IjsKICAgICAgICAgIGwoImp1a2Vib3hPblRyYWNrQXV0aG9yIikuaW5uZXJIVE1MID0KICAgICAgICAgICAgTXVzaWMudHJhY2tzW0dhbWUuanVrZWJveC50cmFja3NbR2FtZS5qdWtlYm94Lm9uVHJhY2tdXS5hdXRob3I7CiAgICAgICAgICBsKCJqdWtlYm94VHJhY2tTZWxlY3QiKS52YWx1ZSA9IEdhbWUuanVrZWJveC5vblRyYWNrOwogICAgICAgICAgaWYgKGRhdGEpIHsKICAgICAgICAgICAgdmFyIGR1ciA9IGRhdGEuZHVyYXRpb24gKyAxOwogICAgICAgICAgICBsKCJqdWtlYm94TXVzaWNUb3RhbFRpbWUiKS5pbm5lckhUTUwgPQogICAgICAgICAgICAgIE1hdGguZmxvb3IoZHVyIC8gNjApICsKICAgICAgICAgICAgICAiOiIgKwogICAgICAgICAgICAgIChNYXRoLmZsb29yKGR1ciAlIDYwKSA8IDEwID8gIjAiIDogIiIpICsKICAgICAgICAgICAgICBNYXRoLmZsb29yKGR1ciAlIDYwKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIWRvbnRQbGF5ICYmIE11c2ljKSB7CiAgICAgICAgICAgIEdhbWUuanVrZWJveC50cmFja0F1dG8gPSBmYWxzZTsKICAgICAgICAgICAgbCgianVrZWJveE11c2ljQXV0byIpLmNsYXNzTGlzdC5hZGQoIm9mZiIpOwogICAgICAgICAgICBNdXNpYy5wbGF5VHJhY2soR2FtZS5qdWtlYm94LnRyYWNrc1tHYW1lLmp1a2Vib3gub25UcmFja10pOwogICAgICAgICAgICBNdXNpYy5zZXRGaWx0ZXIoMSk7CiAgICAgICAgICAgIE11c2ljLmxvb3AoR2FtZS5qdWtlYm94LnRyYWNrTG9vcGVkKTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChkYXRhLnBhdXNlZCkgbCgianVrZWJveE11c2ljUGxheSIpLmlubmVySFRNTCA9IGxvYygiUGxheSIpOwogICAgICAgICAgZWxzZSBsKCJqdWtlYm94TXVzaWNQbGF5IikuaW5uZXJIVE1MID0gbG9jKCJTdG9wIik7CiAgICAgICAgICBHYW1lLmp1a2Vib3gudXBkYXRlTXVzaWNDdXJyZW50VGltZSgpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgcHJlc3NQbGF5TXVzaWM6IGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoIU11c2ljKSByZXR1cm4gZmFsc2U7CiAgICAgICAgdmFyIGRhdGEgPQogICAgICAgICAgTXVzaWMudHJhY2tzW0dhbWUuanVrZWJveC50cmFja3NbR2FtZS5qdWtlYm94Lm9uVHJhY2tdXS5hdWRpbzsKICAgICAgICBpZiAoIWRhdGEucGF1c2VkKSB7CiAgICAgICAgICBNdXNpYy5wYXVzZSgpOwogICAgICAgICAgbCgianVrZWJveE11c2ljUGxheSIpLmlubmVySFRNTCA9IGxvYygiUGxheSIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBNdXNpYy51bnBhdXNlKCk7CiAgICAgICAgICBsKCJqdWtlYm94TXVzaWNQbGF5IikuaW5uZXJIVE1MID0gbG9jKCJTdG9wIik7CiAgICAgICAgfQogICAgICAgIEdhbWUuanVrZWJveC51cGRhdGVNdXNpY0N1cnJlbnRUaW1lKCk7CiAgICAgIH0sCiAgICAgIHByZXNzTG9vcE11c2ljOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5qdWtlYm94LnRyYWNrTG9vcGVkID0gIUdhbWUuanVrZWJveC50cmFja0xvb3BlZDsKICAgICAgICBpZiAoIU11c2ljKSByZXR1cm4gZmFsc2U7CiAgICAgICAgaWYgKEdhbWUuanVrZWJveC50cmFja0xvb3BlZCkgewogICAgICAgICAgTXVzaWMubG9vcCh0cnVlKTsKICAgICAgICAgIGwoImp1a2Vib3hNdXNpY0xvb3AiKS5jbGFzc0xpc3QucmVtb3ZlKCJvZmYiKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgTXVzaWMubG9vcChmYWxzZSk7CiAgICAgICAgICBsKCJqdWtlYm94TXVzaWNMb29wIikuY2xhc3NMaXN0LmFkZCgib2ZmIik7CiAgICAgICAgfQogICAgICB9LAogICAgICBwcmVzc011c2ljQXV0bzogZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuanVrZWJveC50cmFja0F1dG8gPSAhR2FtZS5qdWtlYm94LnRyYWNrQXV0bzsKICAgICAgICBpZiAoIU11c2ljKSByZXR1cm4gZmFsc2U7CiAgICAgICAgaWYgKEdhbWUuanVrZWJveC50cmFja0F1dG8pIHsKICAgICAgICAgIE11c2ljLmN1ZSgicGxheSIpOwogICAgICAgICAgbCgianVrZWJveE11c2ljQXV0byIpLmNsYXNzTGlzdC5yZW1vdmUoIm9mZiIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvKkdhbWUuanVrZWJveC5zZXRUcmFjayhHYW1lLmp1a2Vib3gub25UcmFjayk7Ki8gbCgKICAgICAgICAgICAgImp1a2Vib3hNdXNpY0F1dG8iCiAgICAgICAgICApLmNsYXNzTGlzdC5hZGQoIm9mZiIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgcHJlc3NNdXNpY1NodWZmbGU6IGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLmp1a2Vib3gudHJhY2tTaHVmZmxlID0gIUdhbWUuanVrZWJveC50cmFja1NodWZmbGU7CiAgICAgIH0sCiAgICAgIHVwZGF0ZU11c2ljQ3VycmVudFRpbWU6IGZ1bmN0aW9uIChub0xvb3ApIHsKICAgICAgICBpZiAoIWwoImp1a2Vib3hNdXNpY1RpbWUiKSkgcmV0dXJuIGZhbHNlOwogICAgICAgIHZhciBkYXRhID0KICAgICAgICAgIE11c2ljLnRyYWNrc1tHYW1lLmp1a2Vib3gudHJhY2tzW0dhbWUuanVrZWJveC5vblRyYWNrXV0uYXVkaW87CiAgICAgICAgbCgianVrZWJveE11c2ljUGxheSIpLmlubmVySFRNTCA9IGRhdGEucGF1c2VkCiAgICAgICAgICA/IGxvYygiUGxheSIpCiAgICAgICAgICA6IGxvYygiUGF1c2UiKTsKICAgICAgICBsKCJqdWtlYm94TXVzaWNUaW1lIikuaW5uZXJIVE1MID0KICAgICAgICAgIE1hdGguZmxvb3IoZGF0YS5jdXJyZW50VGltZSAvIDYwKSArCiAgICAgICAgICAiOiIgKwogICAgICAgICAgKE1hdGguZmxvb3IoZGF0YS5jdXJyZW50VGltZSAlIDYwKSA8IDEwID8gIjAiIDogIiIpICsKICAgICAgICAgIE1hdGguZmxvb3IoZGF0YS5jdXJyZW50VGltZSAlIDYwKTsKICAgICAgICBsKCJqdWtlYm94TXVzaWNTY3J1YiIpLnZhbHVlID0KICAgICAgICAgIChkYXRhLmN1cnJlbnRUaW1lIC8gZGF0YS5kdXJhdGlvbikgKiAxMDAwOwogICAgICAgIGwoImp1a2Vib3hNdXNpY1NjcnViRWxhcHNlZCIpLnN0eWxlLndpZHRoID0KICAgICAgICAgIE1hdGgubWF4KDAsIChkYXRhLmN1cnJlbnRUaW1lIC8gZGF0YS5kdXJhdGlvbikgKiAyODggLSA0KSArICJweCI7CiAgICAgICAgaWYgKCFub0xvb3ApIHNldFRpbWVvdXQoR2FtZS5qdWtlYm94LnVwZGF0ZU11c2ljQ3VycmVudFRpbWUsIDEwMDAgLyAyKTsKICAgICAgfSwKICAgICAgbXVzaWNTY3J1YjogZnVuY3Rpb24gKHRpbWUpIHsKICAgICAgICB2YXIgZGF0YSA9CiAgICAgICAgICBNdXNpYy50cmFja3NbR2FtZS5qdWtlYm94LnRyYWNrc1tHYW1lLmp1a2Vib3gub25UcmFja11dLmF1ZGlvOwogICAgICAgIGRhdGEuY3VycmVudFRpbWUgPSAodGltZSAvIDEwMDApICogZGF0YS5kdXJhdGlvbjsKICAgICAgICBHYW1lLmp1a2Vib3gudXBkYXRlTXVzaWNDdXJyZW50VGltZSgpOwogICAgICB9LAogICAgfTsKICAgIGlmIChNdXNpYykgewogICAgICBmb3IgKHZhciBpIGluIE11c2ljLnRyYWNrcykgewogICAgICAgIEdhbWUuanVrZWJveC50cmFja3MucHVzaChNdXNpYy50cmFja3NbaV0ubmFtZSk7CiAgICAgIH0KICAgIH0KCiAgICBHYW1lLmxhc3QuY2hvaWNlc0Z1bmN0aW9uID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgc3RyID0gIiI7CiAgICAgIHN0ciArPQogICAgICAgICc8ZGl2IGNsYXNzPSJ1c2VzSWNvbiIgc3R5bGU9Im1hcmdpbjphdXRvO3dpZHRoOjQ4cHg7aGVpZ2h0OjQ4cHg7YmFja2dyb3VuZC1wb3NpdGlvbjonICsKICAgICAgICAtMzEgKiA0OCArCiAgICAgICAgInB4ICIgKwogICAgICAgIC0xMiAqIDQ4ICsKICAgICAgICAncHg7IiBpZD0ianVrZWJveFBsYXllciI+PC9kaXY+JzsKICAgICAgc3RyICs9CiAgICAgICAgJzxkaXYgc3R5bGU9ImZvbnQtc2l6ZToxMXB4O29wYWNpdHk6MC43O21hcmdpbi1ib3R0b206LTRweDsiIGlkPSJqdWtlYm94T25Tb3VuZE4iPicgKwogICAgICAgIChHYW1lLmp1a2Vib3gub25Tb3VuZCArIDEpICsKICAgICAgICAiLyIgKwogICAgICAgIEdhbWUuanVrZWJveC5zb3VuZHMubGVuZ3RoICsKICAgICAgICAiPC9kaXY+IjsKICAgICAgc3RyICs9CiAgICAgICAgJzxkaXYgY2xhc3M9ImZhbmN5VGV4dCIgc3R5bGU9ImZvbnQtdmFyaWFudDpub3JtYWw7bGV0dGVyLXNwYWNpbmc6MnB4O3BhZGRpbmc6OHB4O2ZvbnQtc2l6ZToxOHB4OyIgaWQ9Imp1a2Vib3hPblNvdW5kIj4mYnVsbDsgJyArCiAgICAgICAgR2FtZS5qdWtlYm94LnNvdW5kc1tHYW1lLmp1a2Vib3gub25Tb3VuZF0gKwogICAgICAgICIgJmJ1bGw7PC9kaXY+IjsKICAgICAgc3RyICs9CiAgICAgICAgJzxkaXYgc3R5bGU9InBvc2l0aW9uOnJlbGF0aXZlO3dpZHRoOjEwMCU7dGV4dC1hbGlnbjpjZW50ZXI7Ij4nICsKICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiBmYW5jeVRleHQiIG9uY2xpY2s9IkdhbWUuanVrZWJveC5zZXRTb3VuZChHYW1lLmp1a2Vib3gub25Tb3VuZC0xKTsiPiYjeGFiOzwvYT4nICsKICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiBmYW5jeVRleHQiIG9uY2xpY2s9IkdhbWUuanVrZWJveC5zZXRTb3VuZChHYW1lLmp1a2Vib3gub25Tb3VuZCk7Ij4nICsKICAgICAgICBsb2MoIlBsYXkiKSArCiAgICAgICAgIjwvYT4iICsKICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiBmYW5jeVRleHQiIG9uY2xpY2s9IkdhbWUuanVrZWJveC5zZXRTb3VuZChHYW1lLmp1a2Vib3gub25Tb3VuZCsxKTsiPiYjeGJiOzwvYT4nICsKICAgICAgICAiPC9kaXY+IjsKICAgICAgc3RyICs9CiAgICAgICAgJzxzZWxlY3QgaWQ9Imp1a2Vib3hTb3VuZFNlbGVjdCIgb25jaGFuZ2U9IkdhbWUuanVrZWJveC5zZXRTb3VuZChwYXJzZUludCh0aGlzLnZhbHVlKSk7Ij4nOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IEdhbWUuanVrZWJveC5zb3VuZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBzdHIgKz0KICAgICAgICAgICc8b3B0aW9uIHZhbHVlPSInICsKICAgICAgICAgIGkgKwogICAgICAgICAgJyInICsKICAgICAgICAgIChpID09IEdhbWUuanVrZWJveC5vblNvdW5kID8gJyBzZWxlY3RlZD0idHJ1ZSInIDogIiIpICsKICAgICAgICAgICI+IiArCiAgICAgICAgICBHYW1lLmp1a2Vib3guc291bmRzW2ldICsKICAgICAgICAgICI8L29wdGlvbj4iOwogICAgICB9CiAgICAgIHN0ciArPQogICAgICAgICc8L3NlbGVjdD48YSBjbGFzcz0ib3B0aW9uIiBvbmNsaWNrPSJHYW1lLmp1a2Vib3guc2V0U291bmQoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKkdhbWUuanVrZWJveC5zb3VuZHMubGVuZ3RoKSk7Ij4nICsKICAgICAgICBsb2MoIlJhbmRvbSIpICsKICAgICAgICAiPC9hPiI7CiAgICAgIGlmIChBcHApIHsKICAgICAgICB2YXIgZGF0YSA9IE11c2ljCiAgICAgICAgICA/IE11c2ljLnRyYWNrc1tHYW1lLmp1a2Vib3gudHJhY2tzW0dhbWUuanVrZWJveC5vblRyYWNrXV0uYXVkaW8KICAgICAgICAgIDogMDsKICAgICAgICB2YXIgZHVyID0gZGF0YSA/IGRhdGEuZHVyYXRpb24gKyAxIDogMDsKICAgICAgICBzdHIgKz0gJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2Pic7CiAgICAgICAgc3RyICs9CiAgICAgICAgICAnPGRpdiBjbGFzcz0iZmFuY3lUZXh0IiBzdHlsZT0iZm9udC1zdHlsZTppdGFsaWM7bGV0dGVyLXNwYWNpbmc6MnB4O3BhZGRpbmc6OHB4O2ZvbnQtc2l6ZToxOHB4OyIgaWQ9Imp1a2Vib3hPblRyYWNrIj4mYnVsbDsgJyArCiAgICAgICAgICBjYXAoR2FtZS5qdWtlYm94LnRyYWNrc1tHYW1lLmp1a2Vib3gub25UcmFja10pICsKICAgICAgICAgICIgJmJ1bGw7PC9kaXY+IjsKICAgICAgICBzdHIgKz0KICAgICAgICAgICc8ZGl2IGlkPSJqdWtlYm94T25UcmFja0F1dGhvciIgc3R5bGU9ImZvbnQtc2l6ZToxMXB4O29wYWNpdHk6MC43O21hcmdpbi10b3A6LTRweDsiPicgKwogICAgICAgICAgTXVzaWMudHJhY2tzW0dhbWUuanVrZWJveC50cmFja3NbR2FtZS5qdWtlYm94Lm9uVHJhY2tdXS5hdXRob3IgKwogICAgICAgICAgIjwvZGl2PiI7CiAgICAgICAgc3RyICs9CiAgICAgICAgICAnPGRpdiBzdHlsZT0ibWFyZ2luOjRweCAwcHg7Zm9udC1zaXplOjExcHg7Ij4nICsKICAgICAgICAgICc8c3BhbiBpZD0ianVrZWJveE11c2ljVGltZSI+JyArCiAgICAgICAgICAoZGF0YQogICAgICAgICAgICA/IE1hdGguZmxvb3IoZGF0YS5jdXJyZW50VGltZSAvIDYwKSArCiAgICAgICAgICAgICAgIjoiICsKICAgICAgICAgICAgICAoTWF0aC5mbG9vcihkYXRhLmN1cnJlbnRUaW1lICUgNjApIDwgMTAgPyAiMCIgOiAiIikgKwogICAgICAgICAgICAgIE1hdGguZmxvb3IoZGF0YS5jdXJyZW50VGltZSAlIDYwKQogICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAiPC9zcGFuPiB8ICIgKwogICAgICAgICAgJzxhIGNsYXNzPSJvcHRpb24gZmFuY3lUZXh0IiBpZD0ianVrZWJveE11c2ljUGxheSIgb25jbGljaz0iR2FtZS5qdWtlYm94LnByZXNzUGxheU11c2ljKCk7Ij4nICsKICAgICAgICAgIChkYXRhICYmIGRhdGEucGF1c2VkID8gbG9jKCJQbGF5IikgOiBsb2MoIlBhdXNlIikpICsKICAgICAgICAgICI8L2E+IiArCiAgICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiBmYW5jeVRleHQgcHJlZkJ1dHRvbicgKwogICAgICAgICAgKEdhbWUuanVrZWJveC50cmFja0xvb3BlZCA/ICIiIDogIiBvZmYiKSArCiAgICAgICAgICAnIiBpZD0ianVrZWJveE11c2ljTG9vcCIgb25jbGljaz0iR2FtZS5qdWtlYm94LnByZXNzTG9vcE11c2ljKCk7Ij4nICsKICAgICAgICAgIGxvYygiTG9vcCIpICsKICAgICAgICAgICI8L2E+IiArCiAgICAgICAgICAnfCA8c3BhbiBpZD0ianVrZWJveE11c2ljVG90YWxUaW1lIj4nICsKICAgICAgICAgIChkYXRhCiAgICAgICAgICAgID8gTWF0aC5mbG9vcihkdXIgLyA2MCkgKwogICAgICAgICAgICAgICI6IiArCiAgICAgICAgICAgICAgKE1hdGguZmxvb3IoZHVyICUgNjApIDwgMTAgPyAiMCIgOiAiIikgKwogICAgICAgICAgICAgIE1hdGguZmxvb3IoZHVyICUgNjApCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICI8L3NwYW4+IiArCiAgICAgICAgICAiPC9kaXY+IjsKICAgICAgICBzdHIgKz0KICAgICAgICAgICc8ZGl2IHN0eWxlPSJwb3NpdGlvbjpyZWxhdGl2ZTsiPjxpbnB1dCBjbGFzcz0ic2xpZGVyIiBzdHlsZT0iY2xlYXI6Ym90aDsiIHR5cGU9InJhbmdlIiBtaW49IjAiIG1heD0iMTAwMCIgc3RlcD0iMSIgdmFsdWU9IicgKwogICAgICAgICAgKGRhdGEgPyAoZGF0YS5jdXJyZW50VGltZSAvIGRhdGEuZHVyYXRpb24pICogMTAwMCA6IDApICsKICAgICAgICAgICciIG9uY2hhbmdlPSJHYW1lLmp1a2Vib3gubXVzaWNTY3J1Yih0aGlzLnZhbHVlKTsiIG9uaW5wdXQ9IkdhbWUuanVrZWJveC5tdXNpY1NjcnViKHRoaXMudmFsdWUpOyIgaWQ9Imp1a2Vib3hNdXNpY1NjcnViIi8+PGRpdiBpZD0ianVrZWJveE11c2ljU2NydWJFbGFwc2VkIiBzdHlsZT0icG9zaXRpb246YWJzb2x1dGU7bGVmdDozcHg7dG9wOjNweDtoZWlnaHQ6NnB4O3dpZHRoOjBweDtiYWNrZ3JvdW5kOiNjY2M7Ym94LXNoYWRvdzoxcHggMXB4IDFweCAjNTU1IGluc2V0LDBweCAtMXB4IDBweCAjZmZmIGluc2V0O2JvcmRlci1yYWRpdXM6MnB4O3otaW5kZXg6MTA7cG9pbnRlci1ldmVudHM6bm9uZTsiPjwvZGl2PjwvZGl2Pic7CgogICAgICAgIHN0ciArPQogICAgICAgICAgJzxhIGNsYXNzPSJvcHRpb24gZmFuY3lUZXh0IHByZWZCdXR0b24nICsKICAgICAgICAgIChHYW1lLmp1a2Vib3gudHJhY2tBdXRvID8gIiIgOiAiIG9mZiIpICsKICAgICAgICAgICciIG9uY2xpY2s9IkdhbWUuanVrZWJveC5wcmVzc011c2ljQXV0bygpOyIgaWQ9Imp1a2Vib3hNdXNpY0F1dG8iPicgKwogICAgICAgICAgbG9jKCJBdXRvIikgKwogICAgICAgICAgJzwvYT48c2VsZWN0IGlkPSJqdWtlYm94VHJhY2tTZWxlY3QiIG9uY2hhbmdlPSJHYW1lLmp1a2Vib3guc2V0VHJhY2socGFyc2VJbnQodGhpcy52YWx1ZSkpOyI+JzsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IEdhbWUuanVrZWJveC50cmFja3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIHN0ciArPQogICAgICAgICAgICAnPG9wdGlvbiB2YWx1ZT0iJyArCiAgICAgICAgICAgIGkgKwogICAgICAgICAgICAnIicgKwogICAgICAgICAgICAoaSA9PSBHYW1lLmp1a2Vib3gub25UcmFjayA/ICcgc2VsZWN0ZWQ9InRydWUiJyA6ICIiKSArCiAgICAgICAgICAgICI+IiArCiAgICAgICAgICAgIEdhbWUuanVrZWJveC50cmFja3NbaV0gKwogICAgICAgICAgICAiPC9vcHRpb24+IjsKICAgICAgICB9CiAgICAgICAgc3RyICs9CiAgICAgICAgICAnPC9zZWxlY3Q+PCEtLTxhIGNsYXNzPSJvcHRpb24gZmFuY3lUZXh0IHByZWZCdXR0b24nICsKICAgICAgICAgIChHYW1lLmp1a2Vib3gudHJhY2tBdXRvID8gIiIgOiAiIG9mZiIpICsKICAgICAgICAgICciIG9uY2xpY2s9IkdhbWUuanVrZWJveC5wcmVzc011c2ljU2h1ZmZsZSgpOyI+JyArCiAgICAgICAgICBsb2MoIlNodWZmbGUiKSArCiAgICAgICAgICAiPC9hPi0tPiI7CgogICAgICAgIHNldFRpbWVvdXQoR2FtZS5qdWtlYm94LnVwZGF0ZU11c2ljQ3VycmVudFRpbWUsIDUwMCk7CiAgICAgIH0KICAgICAgcmV0dXJuIHN0cjsKICAgIH07CgogICAgb3JkZXIgPSAxMDAyMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJEYWxnb25hIGNvb2tpZXMiLAogICAgICBkZXNjOiAiQSBwb3B1bGFyIEtvcmVhbiBjYW5keS1saWtlIHRyZWF0LiBPbmUgb2YgdGhlIHR3aXN0ZWQgZ2FtZXMgcGVvcGxlIHBsYXkgd2l0aCB0aGVzZSBpcyB0byBjYXJlZnVsbHkgZXh0cmFjdCB0aGUgc2hhcGUgaW4gdGhlIG1pZGRsZSwgd2hpY2ggbWF5IGVudGl0bGUgb25lIHRvIGFub3RoZXIgZnJlZSBkYWxnb25hLiBTa2lsbGVkIHBsYXllcnMgbWF5IHBlcmZvcm0gdGhpcyBvdmVyIGFuZCBvdmVyIHVudGlsIGJhbmtydXB0aW5nIHRoZSBzbmFjayB2ZW5kb3IuIiwKICAgICAgaWNvbjogWzI2LCAzNF0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoNDMpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiU3BpY3kgY29va2llcyIsCiAgICAgIGRlc2M6ICJDb250YWluaW5nIGNob2NvbGF0ZSBjaGlwcyBwcmVwYXJlZCB3aXRoIGhvdCBwZXBwZXJzLCBqdXN0IGxpa2UgdGhlIEF6dGVjcyB1c2VkIHRvIG1ha2UuIFRoZXNlIGNvb2tpZXMgYXJlIG9uIHRoZSBhbmdyeSBzaWRlLiIsCiAgICAgIGljb246IFsyNywgMzRdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDQ0KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlNtaWxlIGNvb2tpZXMiLAogICAgICBkZXNjOiAiQXMgZXllcyBhcmUgdGhlIHdpbmRvd3MgdG8gdGhlIHNvdWwsIHNvIHRvbyBhcmUgdGhlc2UgY29va2llcycgZmFjaWFsIGZlYXR1cmVzIGEgZ2FwaW5nIG9wZW5pbmcgdW50byB0aGVpciBjaG9jb2xhdGV5IGlubmFyZHMuIElzIGl0IGhhcHBpbmVzcyB0aGV5IGZlZWw/IE9yIHNvbWV0aGluZyBsZXNzIGh1bWFuPyIsCiAgICAgIGljb246IFsyOCwgMzRdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDQ1KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIktvbGFjaHkgY29va2llcyIsCiAgICAgIGRlc2M6ICJBZGFwdGVkIGZyb20gYSB0eXBlIG9mIENlbnRyYWwgRXVyb3BlYW4gcGFzdHJ5OyBuZWF0bHkgZm9sZGVkIHRvIGhvbGQgYSBzcG9vbmZ1bCBvZiBkZWxpY2lvdXMgamFtLCBhcyBhIGJhc2hmdWwgbGl0dGxlIGdpZnQgZm9yIHlvdXIgbW91dGguIiwKICAgICAgaWNvbjogWzI5LCAzNF0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoNDYpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiR29tbWEgY29va2llcyIsCiAgICAgIGRlc2M6ICJTdXJpbmFtZXNlIGNvcm5mbG91ciBjb29raWVzIHdpdGggc3ByaW5rbGVzIG9uIHRvcC4gVGhlIHVzYWdlIG9mIGNvcm4gaW1wYXJ0cyB0aGVtIGEgaGludCBvZiBjaGV3eSBwaXp6YXp6IC0gd2hpY2ggeW91IHdvdWxkbid0IGdldCB3aXRoIHdoZWF0LCBhIGZhbW91c2x5IHN0dWNrLXVwIGdyYWluLiIsCiAgICAgIGljb246IFszMCwgMzRdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDQ3KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlZlZ2FuIGNvb2tpZXMiLAogICAgICBkZXNjOiAiQSB2ZWdhbiByaWZmIG9uIHRoZSBjbGFzc2ljIGNob2NvbGF0ZSBjaGlwIGNvb2tpZSByZWNpcGUgd2l0aCBhIGNvdXBsZSBzdWJzdGl0dXRpb25zOiB0aGUgYnV0dGVyIGlzIG5vdyBjb2NvbnV0IG9pbCwgdGhlIGVnZ3MgYXJlIGNvcm5zdGFyY2gsIGFuZCB0aGUgc3Vja2xpbmcgcGlnIHdhcyBjbGV2ZXJseSByZXBsYWNlZCB3aXRoIHdoZWF0IGdsdXRlbi4gWW91IGNhbiBoYXJkbHkgdGVsbC4iLAogICAgICBpY29uOiBbMjQsIDM1XSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSg0OCksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJDb3lvdGFzIiwKICAgICAgZGVzYzogIkEgd2lkZSwgZGVsaWNpb3VzIGNvb2tpZSBmcm9tIE1leGljbywgdXN1YWxseSBmaWxsZWQgd2l0aCBzdGlja3kgYnJvd24gc3VnYXIuIE5vdCB0byBiZSBjb25mdXNlZCB3aXRoIGNveW90YXMsIHRoZSByZXN1bHQgb2YgdGhlIGNyb3NzYnJlZWRpbmcgYmV0d2VlbiBhIE5vcnRoIEFtZXJpY2FuIGNhbmluZSBhbmQgYSBKYXBhbmVzZSBjYXIgbWFudWZhY3R1cmVyLiIsCiAgICAgIGljb246IFsyMSwgMzVdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDQ5KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkZyb3N0ZWQgc3VnYXIgY29va2llcyIsCiAgICAgIGRlc2M6ICJNYXkgYmUgbW9yZSBzdHlsZSB0aGFuIHN1YnN0YW5jZSwgZGVwZW5kaW5nIG9uIHRoZSByZWNpcGUuIE5vdGhpbmcgdGhhdCBoaWRlcyBpdHNlbGYgdW5kZXIgdGhpcyBtdWNoIGZyb3N0aW5nIHNob3VsZCBiZSB0cnVzdGVkLiIsCiAgICAgIGljb246IFsyMiwgMzVdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDUwKSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIk1hcnNobWFsbG93IHNhbmR3aWNoIGNvb2tpZXMiLAogICAgICBkZXNjOiAiUydtb3JlcycgbW9yZSBjaXZpbGl6ZWQgY291c2luczogdHdvIHJlZ3VsYXIgY2hvY29sYXRlIGNoaXAgY29va2llcyBqb2luZWQgYnkgYSBnb29leSwgbWVsdHkgbWFyc2htYWxsb3cuIFRoZW9yZXRpY2FsbHkgb25lIGNvdWxkIGFzc2VtYmxlIGFsbCBraW5kcyBvZiBvdGhlciB0aGluZ3MgdGhpcyB3YXkuIFRoZSBtaW5kIHJhY2VzLiIsCiAgICAgIGljb246IFszMSwgMzRdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDUxKSwKICAgIH0pOwoKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJXZWIgY29va2llcyIsCiAgICAgIGRlc2M6CiAgICAgICAgIlRoZSBvcmlnaW5hbCByZWNpcGU7IG5hbWVkIGZvciB0aGUgZGVsaWNhdGUgcGF0dGVybiBpbnNjcmliZWQgb24gdGhlaXIgc3VyZmFjZSBieSB0aGUgYmFraW5nIHByb2Nlc3MuIEVhdGluZyB0aGVzZSBjYW4gdGVsbCBhIGxvdCBhYm91dCBzb21lb25lLiBJbnZlbnRlZCBieSB3ZWxsLWNvbm5lY3RlZCBiYWtlcnMsIG5vIGRvdWJ0LiIgKwogICAgICAgIChBcHAKICAgICAgICAgID8gIjxicj5Pbmx5IG9mIGFueSB1c2UgaW4gQ29va2llIENsaWNrZXIncyB3ZWIgdmVyc2lvbiwgb2YgY291cnNlLiIKICAgICAgICAgIDogIiIpLAogICAgICBpY29uOiBbMjUsIDM1XSwKICAgICAgcG93ZXI6IEFwcCA/IDAgOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoNTIpLAogICAgfSk7CiAgICBpZiAoQXBwKSBHYW1lLmxhc3QucG9vbCA9ICJkZWJ1ZyI7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiU3RlYW1lZCBjb29raWVzIiwKICAgICAgZGVzYzoKICAgICAgICAiTG9jYWxpemVkIGVudGlyZWx5IHdpdGhpbiB0aGlzIGdhbWluZyBwbGF0Zm9ybT8gWWVzISBCYWtlZCB3aXRoIHRoZSBwb3dlciBvZiBzdGVhbSwgaW4gYSB0b3VjaCBvZiBjdXR0aW5nLWVkZ2UgbW9kZXJuaXR5IG5vdCBzZWVuIHNpbmNlIHRoZSBpbmR1c3RyaWFsIHJldm9sdXRpb24uIiArCiAgICAgICAgKCFBcHAKICAgICAgICAgID8gIjxicj5Pbmx5IG9mIGFueSB1c2UgaW4gQ29va2llIENsaWNrZXIncyBTdGVhbSB2ZXJzaW9uLCBvZiBjb3Vyc2UuIgogICAgICAgICAgOiAiIiksCiAgICAgIGljb246IFsyNiwgMzVdLAogICAgICBwb3dlcjogQXBwID8gNSA6IDAsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSg1MiksCiAgICB9KTsKICAgIGlmICghQXBwKSBHYW1lLmxhc3QucG9vbCA9ICJkZWJ1ZyI7CgogICAgb3JkZXIgPSAxMDA1MDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJEZWVwLWZyaWVkIGNvb2tpZSBkb3VnaCIsCiAgICAgIGRlc2M6ICJUaGV5J2xsIGZyeSBhbnl0aGluZyB0aGVzZSBkYXlzLiBEcml6emxlZCBpbiBob3QgY2hvY29sYXRlIHN5cnVwLCBqdXN0IGxpa2UgaW4gc3RhdGUgZmFpcnMuIFNwaWtlcyB1cCB5b3VyIGJsb29kIHN1Z2FyIEFORCB5b3VyIGNob2xlc3Rlcm9sISIsCiAgICAgIGljb246IFsyMywgMzVdLAogICAgICByZXF1aXJlOiAiQm94IG9mIG1heWJlIGNvb2tpZXMiLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IE1hdGgucG93KDEwLCA0NyksCiAgICB9KTsKCiAgICAvL2VuZCBvZiB1cGdyYWRlcwoKICAgIEdhbWUuc2Vhc29ucyA9IHsKICAgICAgY2hyaXN0bWFzOiB7CiAgICAgICAgbmFtZTogIkNocmlzdG1hcyIsCiAgICAgICAgc3RhcnQ6ICJDaHJpc3RtYXMgc2Vhc29uIGhhcyBzdGFydGVkISIsCiAgICAgICAgb3ZlcjogIkNocmlzdG1hcyBzZWFzb24gaXMgb3Zlci4iLAogICAgICAgIHRyaWdnZXI6ICJGZXN0aXZlIGJpc2N1aXQiLAogICAgICB9LAogICAgICB2YWxlbnRpbmVzOiB7CiAgICAgICAgbmFtZTogIlZhbGVudGluZSdzIGRheSIsCiAgICAgICAgc3RhcnQ6ICJWYWxlbnRpbmUncyBkYXkgaGFzIHN0YXJ0ZWQhIiwKICAgICAgICBvdmVyOiAiVmFsZW50aW5lJ3MgZGF5IGlzIG92ZXIuIiwKICAgICAgICB0cmlnZ2VyOiAiTG92ZXNpY2sgYmlzY3VpdCIsCiAgICAgIH0sCiAgICAgIGZvb2xzOiB7CiAgICAgICAgbmFtZTogIkJ1c2luZXNzIGRheSIsCiAgICAgICAgc3RhcnQ6ICJCdXNpbmVzcyBkYXkgaGFzIHN0YXJ0ZWQhIiwKICAgICAgICBvdmVyOiAiQnVzaW5lc3MgZGF5IGlzIG92ZXIuIiwKICAgICAgICB0cmlnZ2VyOiAiRm9vbCdzIGJpc2N1aXQiLAogICAgICB9LAogICAgICBlYXN0ZXI6IHsKICAgICAgICBuYW1lOiAiRWFzdGVyIiwKICAgICAgICBzdGFydDogIkVhc3RlciBzZWFzb24gaGFzIHN0YXJ0ZWQhIiwKICAgICAgICBvdmVyOiAiRWFzdGVyIHNlYXNvbiBpcyBvdmVyLiIsCiAgICAgICAgdHJpZ2dlcjogIkJ1bm55IGJpc2N1aXQiLAogICAgICB9LAogICAgICBoYWxsb3dlZW46IHsKICAgICAgICBuYW1lOiAiSGFsbG93ZWVuIiwKICAgICAgICBzdGFydDogIkhhbGxvd2VlbiBoYXMgc3RhcnRlZCEiLAogICAgICAgIG92ZXI6ICJIYWxsb3dlZW4gaXMgb3Zlci4iLAogICAgICAgIHRyaWdnZXI6ICJHaG9zdGx5IGJpc2N1aXQiLAogICAgICB9LAogICAgfTsKICAgIGlmICghRU4pIHsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLnNlYXNvbnMpIHsKICAgICAgICB2YXIgaXQgPSBHYW1lLnNlYXNvbnNbaV07CiAgICAgICAgaXQubmFtZSA9IGxvYyhpdC5uYW1lKTsKICAgICAgICBpdC5zdGFydCA9IGxvYygiJTEgaGFzIHN0YXJ0ZWQhIiwgaXQubmFtZSk7CiAgICAgICAgaXQub3ZlciA9IGxvYygiJTEgaXMgb3Zlci4iLCBpdC5uYW1lKTsKICAgICAgfQogICAgfQoKICAgIEdhbWUubGlzdFRpbnlPd25lZFVwZ3JhZGVzID0gZnVuY3Rpb24gKGFycikgewogICAgICB2YXIgc3RyID0gIiI7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKEdhbWUuSGFzKGFycltpXSkpIHsKICAgICAgICAgIHZhciBpdCA9IEdhbWUuVXBncmFkZXNbYXJyW2ldXTsKICAgICAgICAgIHN0ciArPSB0aW55SWNvbihpdC5pY29uKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHN0cjsKICAgIH07CgogICAgR2FtZS5zYW50YURyb3BzID0gWwogICAgICAiSW5jcmVhc2VkIG1lcnJpbmVzcyIsCiAgICAgICJJbXByb3ZlZCBqb2xsaW5lc3MiLAogICAgICAiQSBsdW1wIG9mIGNvYWwiLAogICAgICAiQW4gaXRjaHkgc3dlYXRlciIsCiAgICAgICJSZWluZGVlciBiYWtpbmcgZ3JvdW5kcyIsCiAgICAgICJXZWlnaHRlZCBzbGVpZ2hzIiwKICAgICAgIkhvIGhvIGhvLWZsYXZvcmVkIGZyb3N0aW5nIiwKICAgICAgIlNlYXNvbiBzYXZpbmdzIiwKICAgICAgIlRveSB3b3Jrc2hvcCIsCiAgICAgICJOYXVnaHR5IGxpc3QiLAogICAgICAiU2FudGEncyBib3R0b21sZXNzIGJhZyIsCiAgICAgICJTYW50YSdzIGhlbHBlcnMiLAogICAgICAiU2FudGEncyBsZWdhY3kiLAogICAgICAiU2FudGEncyBtaWxrIGFuZCBjb29raWVzIiwKICAgIF07CgogICAgR2FtZS5HZXRIb3dNYW55U2FudGFEcm9wcyA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIG51bSA9IDA7CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5zYW50YURyb3BzKSB7CiAgICAgICAgaWYgKEdhbWUuSGFzKEdhbWUuc2FudGFEcm9wc1tpXSkpIG51bSsrOwogICAgICB9CiAgICAgIHJldHVybiBudW07CiAgICB9OwoKICAgIEdhbWUucmVpbmRlZXJEcm9wcyA9IFsKICAgICAgIkNocmlzdG1hcyB0cmVlIGJpc2N1aXRzIiwKICAgICAgIlNub3dmbGFrZSBiaXNjdWl0cyIsCiAgICAgICJTbm93bWFuIGJpc2N1aXRzIiwKICAgICAgIkhvbGx5IGJpc2N1aXRzIiwKICAgICAgIkNhbmR5IGNhbmUgYmlzY3VpdHMiLAogICAgICAiQmVsbCBiaXNjdWl0cyIsCiAgICAgICJQcmVzZW50IGJpc2N1aXRzIiwKICAgIF07CiAgICBHYW1lLkdldEhvd01hbnlSZWluZGVlckRyb3BzID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgbnVtID0gMDsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLnJlaW5kZWVyRHJvcHMpIHsKICAgICAgICBpZiAoR2FtZS5IYXMoR2FtZS5yZWluZGVlckRyb3BzW2ldKSkgbnVtKys7CiAgICAgIH0KICAgICAgcmV0dXJuIG51bTsKICAgIH07CiAgICAvKmZvciAodmFyIGkgaW4gR2FtZS5zYW50YURyb3BzKQoJCXsKCQkJR2FtZS5VcGdyYWRlc1tHYW1lLnNhbnRhRHJvcHNbaV1dLmRlc2NGdW5jPWZ1bmN0aW9uKCl7cmV0dXJuICc8ZGl2IHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsiPllvdSBjdXJyZW50bHkgb3duIDxiPicrR2FtZS5HZXRIb3dNYW55U2FudGFEcm9wcygpKycvJytHYW1lLnNhbnRhRHJvcHMubGVuZ3RoKyc8L2I+IG9mIFNhbnRhXCdzIGdpZnRzLjwvZGl2PjxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicrdGhpcy5kZGVzYzt9OwoJCX0qLwoKICAgIEdhbWUuc2Vhc29uRHJvcHMgPSBHYW1lLmhlYXJ0RHJvcHMKICAgICAgLmNvbmNhdChHYW1lLmhhbGxvd2VlbkRyb3BzKQogICAgICAuY29uY2F0KEdhbWUuZWFzdGVyRWdncykKICAgICAgLmNvbmNhdChHYW1lLnNhbnRhRHJvcHMpCiAgICAgIC5jb25jYXQoR2FtZS5yZWluZGVlckRyb3BzKTsKCiAgICBHYW1lLnNheVNlYXNvblN3aXRjaFVzZXMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChHYW1lLnNlYXNvblVzZXMgPT0gMCkKICAgICAgICByZXR1cm4gbG9jKCJZb3UgaGF2ZW4ndCBzd2l0Y2hlZCBzZWFzb25zIHRoaXMgYXNjZW5zaW9uIHlldC4iKTsKICAgICAgcmV0dXJuIEVOCiAgICAgICAgPyAiWW91J3ZlIHN3aXRjaGVkIHNlYXNvbnMgPGI+IiArCiAgICAgICAgICAgIChHYW1lLnNlYXNvblVzZXMgPT0gMQogICAgICAgICAgICAgID8gIm9uY2UiCiAgICAgICAgICAgICAgOiBHYW1lLnNlYXNvblVzZXMgPT0gMgogICAgICAgICAgICAgID8gInR3aWNlIgogICAgICAgICAgICAgIDogR2FtZS5zZWFzb25Vc2VzICsgIiB0aW1lcyIpICsKICAgICAgICAgICAgIjwvYj4gdGhpcyBhc2NlbnNpb24uIgogICAgICAgIDogR2FtZS5zZWFzb25Vc2VzID09IDEKICAgICAgICA/IGxvYygiWW91J3ZlIHN3aXRjaGVkIHNlYXNvbnMgPGI+b25jZTwvYj4gdGhpcyBhc2NlbnNpb24uIikKICAgICAgICA6IGxvYygKICAgICAgICAgICAgIllvdSd2ZSBzd2l0Y2hlZCBzZWFzb25zIDxiPiUxIHRpbWVzPC9iPiB0aGlzIGFzY2Vuc2lvbi4iLAogICAgICAgICAgICBHYW1lLnNlYXNvblVzZXMKICAgICAgICAgICk7CiAgICB9OwogICAgR2FtZS5VcGdyYWRlc1siRmVzdGl2ZSBiaXNjdWl0Il0uZGVzY0Z1bmMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiAoCiAgICAgICAgJzxkaXYgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyI+JyArCiAgICAgICAgR2FtZS5saXN0VGlueU93bmVkVXBncmFkZXMoR2FtZS5zYW50YURyb3BzKSArCiAgICAgICAgIjxicj48YnI+IiArCiAgICAgICAgKEVOCiAgICAgICAgICA/ICJZb3UndmUgcHVyY2hhc2VkIDxiPiIgKwogICAgICAgICAgICBHYW1lLkdldEhvd01hbnlTYW50YURyb3BzKCkgKwogICAgICAgICAgICAiLyIgKwogICAgICAgICAgICBHYW1lLnNhbnRhRHJvcHMubGVuZ3RoICsKICAgICAgICAgICAgIjwvYj4gb2YgU2FudGEncyBnaWZ0cy4iCiAgICAgICAgICA6IGxvYygKICAgICAgICAgICAgICAiU2Vhc29uYWwgY29va2llcyBwdXJjaGFzZWQ6IDxiPiUxPC9iPi4iLAogICAgICAgICAgICAgIEdhbWUuR2V0SG93TWFueVNhbnRhRHJvcHMoKSArICIvIiArIEdhbWUuc2FudGFEcm9wcy5sZW5ndGgKICAgICAgICAgICAgKSkgKwogICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICBHYW1lLmxpc3RUaW55T3duZWRVcGdyYWRlcyhHYW1lLnJlaW5kZWVyRHJvcHMpICsKICAgICAgICAiPGJyPjxicj4iICsKICAgICAgICAoRU4KICAgICAgICAgID8gIllvdSd2ZSBwdXJjaGFzZWQgPGI+IiArCiAgICAgICAgICAgIEdhbWUuR2V0SG93TWFueVJlaW5kZWVyRHJvcHMoKSArCiAgICAgICAgICAgICIvIiArCiAgICAgICAgICAgIEdhbWUucmVpbmRlZXJEcm9wcy5sZW5ndGggKwogICAgICAgICAgICAiPC9iPiByZWluZGVlciBjb29raWVzLiIKICAgICAgICAgIDogbG9jKAogICAgICAgICAgICAgICJSZWluZGVlciBjb29raWVzIHB1cmNoYXNlZDogPGI+JTE8L2I+LiIsCiAgICAgICAgICAgICAgR2FtZS5HZXRIb3dNYW55UmVpbmRlZXJEcm9wcygpICsgIi8iICsgR2FtZS5yZWluZGVlckRyb3BzLmxlbmd0aAogICAgICAgICAgICApKSArCiAgICAgICAgJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicgKwogICAgICAgIEdhbWUuc2F5U2Vhc29uU3dpdGNoVXNlcygpICsKICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+PC9kaXY+JyArCiAgICAgICAgdGhpcy5kZGVzYwogICAgICApOwogICAgfTsKICAgIEdhbWUuVXBncmFkZXNbIkJ1bm55IGJpc2N1aXQiXS5kZXNjRnVuYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuICgKICAgICAgICAnPGRpdiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7Ij4nICsKICAgICAgICBHYW1lLmxpc3RUaW55T3duZWRVcGdyYWRlcyhHYW1lLmVhc3RlckVnZ3MpICsKICAgICAgICAiPGJyPjxicj4iICsKICAgICAgICAoRU4KICAgICAgICAgID8gIllvdSd2ZSBwdXJjaGFzZWQgPGI+IiArCiAgICAgICAgICAgIEdhbWUuR2V0SG93TWFueUVnZ3MoKSArCiAgICAgICAgICAgICIvIiArCiAgICAgICAgICAgIEdhbWUuZWFzdGVyRWdncy5sZW5ndGggKwogICAgICAgICAgICAiPC9iPiBlZ2dzLiIKICAgICAgICAgIDogbG9jKAogICAgICAgICAgICAgICJFZ2dzIHB1cmNoYXNlZDogPGI+JTE8L2I+LiIsCiAgICAgICAgICAgICAgR2FtZS5HZXRIb3dNYW55RWdncygpICsgIi8iICsgR2FtZS5lYXN0ZXJFZ2dzLmxlbmd0aAogICAgICAgICAgICApKSArCiAgICAgICAgJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicgKwogICAgICAgIEdhbWUuc2F5U2Vhc29uU3dpdGNoVXNlcygpICsKICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+PC9kaXY+JyArCiAgICAgICAgdGhpcy5kZGVzYwogICAgICApOwogICAgfTsKICAgIEdhbWUuVXBncmFkZXNbIkdob3N0bHkgYmlzY3VpdCJdLmRlc2NGdW5jID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gKAogICAgICAgICc8ZGl2IHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsiPicgKwogICAgICAgIEdhbWUubGlzdFRpbnlPd25lZFVwZ3JhZGVzKEdhbWUuaGFsbG93ZWVuRHJvcHMpICsKICAgICAgICAiPGJyPjxicj4iICsKICAgICAgICAoRU4KICAgICAgICAgID8gIllvdSd2ZSBwdXJjaGFzZWQgPGI+IiArCiAgICAgICAgICAgIEdhbWUuR2V0SG93TWFueUhhbGxvd2VlbkRyb3BzKCkgKwogICAgICAgICAgICAiLyIgKwogICAgICAgICAgICBHYW1lLmhhbGxvd2VlbkRyb3BzLmxlbmd0aCArCiAgICAgICAgICAgICI8L2I+IGhhbGxvd2VlbiBjb29raWVzLiIKICAgICAgICAgIDogbG9jKAogICAgICAgICAgICAgICJTZWFzb25hbCBjb29raWVzIHB1cmNoYXNlZDogPGI+JTE8L2I+LiIsCiAgICAgICAgICAgICAgR2FtZS5HZXRIb3dNYW55SGFsbG93ZWVuRHJvcHMoKSArICIvIiArIEdhbWUuaGFsbG93ZWVuRHJvcHMubGVuZ3RoCiAgICAgICAgICAgICkpICsKICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgR2FtZS5zYXlTZWFzb25Td2l0Y2hVc2VzKCkgKwogICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj48L2Rpdj4nICsKICAgICAgICB0aGlzLmRkZXNjCiAgICAgICk7CiAgICB9OwogICAgR2FtZS5VcGdyYWRlc1siTG92ZXNpY2sgYmlzY3VpdCJdLmRlc2NGdW5jID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gKAogICAgICAgICc8ZGl2IHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsiPicgKwogICAgICAgIEdhbWUubGlzdFRpbnlPd25lZFVwZ3JhZGVzKEdhbWUuaGVhcnREcm9wcykgKwogICAgICAgICI8YnI+PGJyPiIgKwogICAgICAgIChFTgogICAgICAgICAgPyAiWW91J3ZlIHB1cmNoYXNlZCA8Yj4iICsKICAgICAgICAgICAgR2FtZS5HZXRIb3dNYW55SGVhcnREcm9wcygpICsKICAgICAgICAgICAgIi8iICsKICAgICAgICAgICAgR2FtZS5oZWFydERyb3BzLmxlbmd0aCArCiAgICAgICAgICAgICI8L2I+IGhlYXJ0IGJpc2N1aXRzLiIKICAgICAgICAgIDogbG9jKAogICAgICAgICAgICAgICJTZWFzb25hbCBjb29raWVzIHB1cmNoYXNlZDogPGI+JTE8L2I+LiIsCiAgICAgICAgICAgICAgR2FtZS5HZXRIb3dNYW55SGVhcnREcm9wcygpICsgIi8iICsgR2FtZS5oZWFydERyb3BzLmxlbmd0aAogICAgICAgICAgICApKSArCiAgICAgICAgJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicgKwogICAgICAgIEdhbWUuc2F5U2Vhc29uU3dpdGNoVXNlcygpICsKICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+PC9kaXY+JyArCiAgICAgICAgdGhpcy5kZGVzYwogICAgICApOwogICAgfTsKICAgIEdhbWUuVXBncmFkZXNbIkZvb2wncyBiaXNjdWl0Il0uZGVzY0Z1bmMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiAoCiAgICAgICAgJzxkaXYgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyI+JyArCiAgICAgICAgR2FtZS5zYXlTZWFzb25Td2l0Y2hVc2VzKCkgKwogICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj48L2Rpdj4nICsKICAgICAgICB0aGlzLmRkZXNjCiAgICAgICk7CiAgICB9OwoKICAgIEdhbWUuY29tcHV0ZVNlYXNvblByaWNlcyA9IGZ1bmN0aW9uICgpIHsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLnNlYXNvbnMpIHsKICAgICAgICBHYW1lLnNlYXNvbnNbaV0udHJpZ2dlclVwZ3JhZGUucHJpY2VGdW5jID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIG0gPSAxOwogICAgICAgICAgaWYgKEdhbWUuaGFzR29kKSB7CiAgICAgICAgICAgIHZhciBnb2RMdmwgPSBHYW1lLmhhc0dvZCgic2Vhc29ucyIpOwogICAgICAgICAgICBpZiAoZ29kTHZsID09IDEpIG0gKj0gMjsKICAgICAgICAgICAgZWxzZSBpZiAoZ29kTHZsID09IDIpIG0gKj0gMS41OwogICAgICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMykgbSAqPSAxLjI1OwogICAgICAgICAgfQogICAgICAgICAgLy9yZXR1cm4gR2FtZS5zZWFzb25UcmlnZ2VyQmFzZVByaWNlKk1hdGgucG93KDIsR2FtZS5zZWFzb25Vc2VzKSptOwogICAgICAgICAgLy9yZXR1cm4gR2FtZS5jb29raWVzUHMqNjAqTWF0aC5wb3coMS41LEdhbWUuc2Vhc29uVXNlcykqbTsKICAgICAgICAgIHJldHVybiAoCiAgICAgICAgICAgIEdhbWUuc2Vhc29uVHJpZ2dlckJhc2VQcmljZSArCiAgICAgICAgICAgIEdhbWUudW5idWZmZWRDcHMgKiA2MCAqIE1hdGgucG93KDEuNSwgR2FtZS5zZWFzb25Vc2VzKSAqIG0KICAgICAgICAgICk7CiAgICAgICAgfTsKICAgICAgfQogICAgfTsKICAgIEdhbWUuY29tcHV0ZVNlYXNvbnMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5zZWFzb25zKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5VcGdyYWRlc1tHYW1lLnNlYXNvbnNbaV0udHJpZ2dlcl07CiAgICAgICAgR2FtZS5zZWFzb25zW2ldLnRyaWdnZXJVcGdyYWRlID0gbWU7CiAgICAgICAgbWUucG9vbCA9ICJ0b2dnbGUiOwogICAgICAgIG1lLmJ1eUZ1bmN0aW9uID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgR2FtZS5zZWFzb25Vc2VzICs9IDE7CiAgICAgICAgICBHYW1lLmNvbXB1dGVTZWFzb25QcmljZXMoKTsKICAgICAgICAgIC8vR2FtZS5Mb2NrKHRoaXMubmFtZSk7CiAgICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuc2Vhc29ucykgewogICAgICAgICAgICB2YXIgbWUgPSBHYW1lLlVwZ3JhZGVzW0dhbWUuc2Vhc29uc1tpXS50cmlnZ2VyXTsKICAgICAgICAgICAgaWYgKG1lLm5hbWUgIT0gdGhpcy5uYW1lKSB7CiAgICAgICAgICAgICAgR2FtZS5Mb2NrKG1lLm5hbWUpOwogICAgICAgICAgICAgIEdhbWUuVW5sb2NrKG1lLm5hbWUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoR2FtZS5zZWFzb24gIT0gIiIgJiYgR2FtZS5zZWFzb24gIT0gdGhpcy5zZWFzb24pIHsKICAgICAgICAgICAgR2FtZS5Ob3RpZnkoCiAgICAgICAgICAgICAgR2FtZS5zZWFzb25zW0dhbWUuc2Vhc29uXS5vdmVyICsgJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicsCiAgICAgICAgICAgICAgIiIsCiAgICAgICAgICAgICAgR2FtZS5zZWFzb25zW0dhbWUuc2Vhc29uXS50cmlnZ2VyVXBncmFkZS5pY29uLAogICAgICAgICAgICAgIDQKICAgICAgICAgICAgKTsKICAgICAgICAgIH0KICAgICAgICAgIEdhbWUuc2Vhc29uID0gdGhpcy5zZWFzb247CiAgICAgICAgICBHYW1lLnNlYXNvblQgPSBHYW1lLmdldFNlYXNvbkR1cmF0aW9uKCk7CiAgICAgICAgICBHYW1lLnN0b3JlVG9SZWZyZXNoID0gMTsKICAgICAgICAgIEdhbWUudXBncmFkZXNUb1JlYnVpbGQgPSAxOwogICAgICAgICAgR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0ucmVkcmF3KCk7CiAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgR2FtZS5zZWFzb25zW3RoaXMuc2Vhc29uXS5zdGFydCArICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nLAogICAgICAgICAgICAiIiwKICAgICAgICAgICAgdGhpcy5pY29uLAogICAgICAgICAgICA0CiAgICAgICAgICApOwogICAgICAgIH07CgogICAgICAgIG1lLmNsaWNrRnVuY3Rpb24gPSAoZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAvL3VuZG8gc2Vhc29uCiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICBtZS5ib3VnaHQgJiYKICAgICAgICAgICAgICBHYW1lLnNlYXNvbiAmJgogICAgICAgICAgICAgIG1lID09IEdhbWUuc2Vhc29uc1tHYW1lLnNlYXNvbl0udHJpZ2dlclVwZ3JhZGUKICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgbWUubG9zZSgpOwogICAgICAgICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgICAgICAgR2FtZS5zZWFzb25zW0dhbWUuc2Vhc29uXS5vdmVyLAogICAgICAgICAgICAgICAgIiIsCiAgICAgICAgICAgICAgICBHYW1lLnNlYXNvbnNbR2FtZS5zZWFzb25dLnRyaWdnZXJVcGdyYWRlLmljb24KICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIGlmIChHYW1lLkhhcygiU2Vhc29uIHN3aXRjaGVyIikpIHsKICAgICAgICAgICAgICAgIEdhbWUuVW5sb2NrKEdhbWUuc2Vhc29uc1tHYW1lLnNlYXNvbl0udHJpZ2dlcik7CiAgICAgICAgICAgICAgICBHYW1lLnNlYXNvbnNbR2FtZS5zZWFzb25dLnRyaWdnZXJVcGdyYWRlLmJvdWdodCA9IDA7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkID0gMTsKICAgICAgICAgICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICAgICAgICAgIEdhbWUuc2Vhc29uID0gR2FtZS5iYXNlU2Vhc29uOwogICAgICAgICAgICAgIEdhbWUuc2Vhc29uVCA9IC0xOwogICAgICAgICAgICAgIFBsYXlTb3VuZCgic25kL3RpY2subXAzIik7CiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9IGVsc2UgcmV0dXJuIHRydWU7CiAgICAgICAgICB9OwogICAgICAgIH0pKG1lKTsKCiAgICAgICAgbWUuZGlzcGxheUZ1bmNXaGVuT3duZWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAnPGRpdiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7Ij4nICsKICAgICAgICAgICAgbG9jKCJUaW1lIHJlbWFpbmluZzoiKSArCiAgICAgICAgICAgICI8YnI+PGI+IiArCiAgICAgICAgICAgIChHYW1lLkhhcygiRXRlcm5hbCBzZWFzb25zIikKICAgICAgICAgICAgICA/IGxvYygiZm9yZXZlciIpCiAgICAgICAgICAgICAgOiBHYW1lLnNheVRpbWUoR2FtZS5zZWFzb25ULCAtMSkpICsKICAgICAgICAgICAgJzwvYj48ZGl2IHN0eWxlPSJmb250LXNpemU6ODAlOyI+KCcgKwogICAgICAgICAgICBsb2MoIkNsaWNrIGFnYWluIHRvIGNhbmNlbCBzZWFzb24iKSArCiAgICAgICAgICAgICIpPC9kaXY+PC9kaXY+IgogICAgICAgICAgKTsKICAgICAgICB9OwogICAgICAgIG1lLnRpbWVyRGlzcGxheSA9IChmdW5jdGlvbiAodXBncmFkZSkgewogICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICFHYW1lLlVwZ3JhZGVzW3VwZ3JhZGUubmFtZV0uYm91Z2h0IHx8CiAgICAgICAgICAgICAgR2FtZS5IYXMoIkV0ZXJuYWwgc2Vhc29ucyIpCiAgICAgICAgICAgICkKICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgIGVsc2UgcmV0dXJuIDEgLSBHYW1lLnNlYXNvblQgLyBHYW1lLmdldFNlYXNvbkR1cmF0aW9uKCk7CiAgICAgICAgICB9OwogICAgICAgIH0pKG1lKTsKICAgICAgfQogICAgfTsKICAgIEdhbWUuZ2V0U2Vhc29uRHVyYXRpb24gPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBHYW1lLmZwcyAqIDYwICogNjAgKiAyNDsKICAgIH07CiAgICBHYW1lLmNvbXB1dGVTZWFzb25zKCk7CgogICAgLy9hbGVydCB1bnRpZXJlZCBidWlsZGluZyB1cGdyYWRlcwogICAgZm9yICh2YXIgaSBpbiBHYW1lLlVwZ3JhZGVzKSB7CiAgICAgIHZhciBtZSA9IEdhbWUuVXBncmFkZXNbaV07CiAgICAgIGlmICgKICAgICAgICBtZS5vcmRlciA+PSAyMDAgJiYKICAgICAgICBtZS5vcmRlciA8IDIwMDAgJiYKICAgICAgICAhbWUudGllciAmJgogICAgICAgIG1lLm5hbWUuaW5kZXhPZigiZ3JhbmRtYSIpID09IC0xICYmCiAgICAgICAgbWUucG9vbCAhPSAicHJlc3RpZ2UiCiAgICAgICkKICAgICAgICBjb25zb2xlLmxvZyhtZS5uYW1lICsgIiBoYXMgbm8gdGllci4iKTsKICAgIH0KCiAgICBHYW1lLlVwZ3JhZGVzQnlQb29sID0geyBraXR0ZW46IFtdIH07CiAgICBmb3IgKHZhciBpIGluIEdhbWUuVXBncmFkZXMpIHsKICAgICAgaWYgKCFHYW1lLlVwZ3JhZGVzQnlQb29sW0dhbWUuVXBncmFkZXNbaV0ucG9vbF0pCiAgICAgICAgR2FtZS5VcGdyYWRlc0J5UG9vbFtHYW1lLlVwZ3JhZGVzW2ldLnBvb2xdID0gW107CiAgICAgIEdhbWUuVXBncmFkZXNCeVBvb2xbR2FtZS5VcGdyYWRlc1tpXS5wb29sXS5wdXNoKEdhbWUuVXBncmFkZXNbaV0pOwogICAgICBpZiAoR2FtZS5VcGdyYWRlc1tpXS5raXR0ZW4pCiAgICAgICAgR2FtZS5VcGdyYWRlc0J5UG9vbFsia2l0dGVuIl0ucHVzaChHYW1lLlVwZ3JhZGVzW2ldKTsKICAgIH0KCiAgICBHYW1lLlByZXN0aWdlVXBncmFkZXMgPSBbXTsKICAgIGZvciAodmFyIGkgaW4gR2FtZS5VcGdyYWRlcykgewogICAgICBpZiAoCiAgICAgICAgR2FtZS5VcGdyYWRlc1tpXS5wb29sID09ICJwcmVzdGlnZSIgfHwKICAgICAgICBHYW1lLlVwZ3JhZGVzW2ldLnBvb2wgPT0gInByZXN0aWdlRGVjb3IiCiAgICAgICkgewogICAgICAgIEdhbWUuUHJlc3RpZ2VVcGdyYWRlcy5wdXNoKEdhbWUuVXBncmFkZXNbaV0pOwogICAgICAgIGlmIChHYW1lLlVwZ3JhZGVzW2ldLnBvc1ggfHwgR2FtZS5VcGdyYWRlc1tpXS5wb3NZKQogICAgICAgICAgR2FtZS5VcGdyYWRlc1tpXS5wbGFjZWRCeUNvZGUgPSB0cnVlOwogICAgICAgIGVsc2UgewogICAgICAgICAgR2FtZS5VcGdyYWRlc1tpXS5wb3NYID0gMDsKICAgICAgICAgIEdhbWUuVXBncmFkZXNbaV0ucG9zWSA9IDA7CiAgICAgICAgfQogICAgICAgIGlmICgKICAgICAgICAgIEdhbWUuVXBncmFkZXNbaV0ucGFyZW50cy5sZW5ndGggPT0gMCAmJgogICAgICAgICAgR2FtZS5VcGdyYWRlc1tpXS5uYW1lICE9ICJMZWdhY3kiCiAgICAgICAgKQogICAgICAgICAgR2FtZS5VcGdyYWRlc1tpXS5wYXJlbnRzID0gWyJMZWdhY3kiXTsKICAgICAgICBmb3IgKHZhciBpaSBpbiBHYW1lLlVwZ3JhZGVzW2ldLnBhcmVudHMpIHsKICAgICAgICAgIEdhbWUuVXBncmFkZXNbaV0ucGFyZW50c1tpaV0gPQogICAgICAgICAgICBHYW1lLlVwZ3JhZGVzW0dhbWUuVXBncmFkZXNbaV0ucGFyZW50c1tpaV1dOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIEdhbWUuZ29sZGVuQ29va2llVXBncmFkZXMgPSBbCiAgICAgICJHZXQgbHVja3kiLAogICAgICAiTHVja3kgZGF5IiwKICAgICAgIlNlcmVuZGlwaXR5IiwKICAgICAgIkhlYXZlbmx5IGx1Y2siLAogICAgICAiTGFzdGluZyBmb3J0dW5lIiwKICAgICAgIkRlY2lzaXZlIGZhdGUiLAogICAgICAiTHVja3kgZGlnaXQiLAogICAgICAiTHVja3kgbnVtYmVyIiwKICAgICAgIkx1Y2t5IHBheW91dCIsCiAgICAgICJHb2xkZW4gZ29vc2UgZWdnIiwKICAgIF07CgogICAgR2FtZS5jb29raWVVcGdyYWRlcyA9IFtdOwogICAgZm9yICh2YXIgaSBpbiBHYW1lLlVwZ3JhZGVzKSB7CiAgICAgIHZhciBtZSA9IEdhbWUuVXBncmFkZXNbaV07CiAgICAgIGlmIChtZS5wb29sID09ICJjb29raWUiIHx8IG1lLnBzZXVkb0Nvb2tpZSkgR2FtZS5jb29raWVVcGdyYWRlcy5wdXNoKG1lKTsKICAgICAgaWYgKG1lLnRpZXIpIEdhbWUuVGllcnNbbWUudGllcl0udXBncmFkZXMucHVzaChtZSk7CiAgICB9CiAgICBmb3IgKHZhciBpIGluIEdhbWUuVW5sb2NrQXQpIHsKICAgICAgR2FtZS5VcGdyYWRlc1tHYW1lLlVubG9ja0F0W2ldLm5hbWVdLnVubG9ja0F0ID0gR2FtZS5VbmxvY2tBdFtpXTsKICAgIH0KICAgIGZvciAodmFyIGkgaW4gR2FtZS5VcGdyYWRlcykgewogICAgICBpZiAoR2FtZS5VcGdyYWRlc1tpXS5wb29sID09ICJwcmVzdGlnZSIpCiAgICAgICAgR2FtZS5VcGdyYWRlc1tpXS5vcmRlciA9IEdhbWUuVXBncmFkZXNbaV0uaWQ7CiAgICB9CgogICAgLyp2YXIgb2xkUHJlc3RpZ2VQcmljZXM9eyJDaGltZXJhIjo1NzY0ODAxLCJTeW5lcmdpZXMgVm9sLiBJIjoyNTI1LCJTeW5lcmdpZXMgVm9sLiBJSSI6MjUyNTI1LCJMYWJlbCBwcmludGVyIjo5OTk5fTsKCQlmb3IgKHZhciBpIGluIG9sZFByZXN0aWdlUHJpY2VzKXtHYW1lLlVwZ3JhZGVzW2ldLmJhc2VQcmljZT1vbGRQcmVzdGlnZVByaWNlc1tpXTt9Ki8KCiAgICBHYW1lLlVwZ3JhZGVQb3NpdGlvbnMgPSB7CiAgICAgIDE0MTogWzExOCwgLTQyXSwKICAgICAgMTgxOiBbLTU1NSwgLTkzXSwKICAgICAgMjUzOiBbLTIzNywgLTIyNl0sCiAgICAgIDI1NDogWy01NiwgLTIzNF0sCiAgICAgIDI1NTogWy0xNDksIC0yNjddLAogICAgICAyNjQ6IFs2OCwgOTddLAogICAgICAyNjU6IFsxNTcsIDE5Nl0sCiAgICAgIDI2NjogWzI4NywgMjEyXSwKICAgICAgMjY3OiBbNDEzLCAxNTddLAogICAgICAyNjg6IFs0ODAsIDM1XSwKICAgICAgMjY5OiBbLTY0MCwgNDJdLAogICAgICAyNzA6IFstNDcxLCAtMjI4XSwKICAgICAgMjcxOiBbLTY5MCwgLTE3OF0sCiAgICAgIDI3MjogWy01OTEsIC0yNDldLAogICAgICAyNzM6IFstNzExLCAtNThdLAogICAgICAyNzQ6IFsyNzAsIC0zMjhdLAogICAgICAyNzU6IFszMTcsIC00MzldLAogICAgICAyNzY6IFszMzMsIC01NTZdLAogICAgICAyNzc6IFszMzQsIC02NzZdLAogICAgICAyNzg6IFszMzMsIC03OTZdLAogICAgICAyNzk6IFszMjgsIC05MjJdLAogICAgICAyODA6IFszMDMsIC0xMDQwXSwKICAgICAgMjgxOiBbMTk0LCAtMjMwXSwKICAgICAgMjgyOiBbLTI5MywgMTU2XSwKICAgICAgMjgzOiBbLTMzNSwgMjg5XSwKICAgICAgMjg0OiBbLTMyOCwgNDIyXSwKICAgICAgMjg1OiBbLTI0NywgNTY3XSwKICAgICAgMjg2OiBbLTM3NSwgNTc5XSwKICAgICAgMjg3OiBbLTI5NiwgNzI2XSwKICAgICAgMjg4OiBbLTI2MCwgLTM5Nl0sCiAgICAgIDI4OTogWy0zNzUsIC01MDJdLAogICAgICAyOTA6IFstMTI3LCAtNDE1XSwKICAgICAgMjkxOiBbNDc5LCAtNzM5XSwKICAgICAgMjkyOiBbLTM5OSwgLTY0OV0sCiAgICAgIDI5MzogWy00MDEsIC04MDZdLAogICAgICAzMjM6IFstNzYsIDEwOV0sCiAgICAgIDMyNTogWzE5OCwgLTExNTNdLAogICAgICAzMjY6IFstMjcwLCAtMTM0XSwKICAgICAgMzI3OiBbLTIyMSwgMjYxXSwKICAgICAgMzI4OiBbMTksIDI0N10sCiAgICAgIDMyOTogWzQyLCA0MDJdLAogICAgICAzNTM6IFsxMjEsIC0zMjZdLAogICAgICAzNTQ6IFs3NywgLTQzNl0sCiAgICAgIDM1NTogWzY0LCAtNTQ4XSwKICAgICAgMzU2OiBbNTcsIC02NzNdLAogICAgICAzNTc6IFs1MiwgLTc5M10sCiAgICAgIDM1ODogWzU4LCAtOTI0XSwKICAgICAgMzU5OiBbODIsIC0xMDQzXSwKICAgICAgMzYwOiBbNDksIDUwNl0sCiAgICAgIDM2MjogWzE1NiwgMzI1XSwKICAgICAgMzYzOiBbLTMwLCAtMzBdLAogICAgICAzNjQ6IFstMjM4LCAtNzI4XSwKICAgICAgMzY1OiBbLTEyMywgNDIzXSwKICAgICAgMzY4OiBbLTU1LCAtNTI3XSwKICAgICAgMzkzOiBbMTk2LCAtNzE0XSwKICAgICAgMzk0OiBbMTk3LCAtOTY0XSwKICAgICAgMzk1OiBbLTE0MywgLTE0MF0sCiAgICAgIDM5NjogWy0yNDQsIC04OTddLAogICAgICAzOTc6IFstOTcsIDY0MV0sCiAgICAgIDQwODogWy0yMDQsIC0xMDM2XSwKICAgICAgNDA5OiBbLTcyLCAtMTE1Ml0sCiAgICAgIDQxMDogWzQyLCAtMTI3OF0sCiAgICAgIDQxMTogWy00NzYsIDEwNV0sCiAgICAgIDQxMjogWy01MjIsIDI1OV0sCiAgICAgIDQxMzogWy01MTYsIDQzM10sCiAgICAgIDQ0OTogWy0zNjcsIC0xMTEzXSwKICAgICAgNDUwOiBbLTMwNiwgLTEyMTZdLAogICAgICA0NTE6IFstMTg0LCAtMTI0MV0sCiAgICAgIDQ5NTogWy00MDgsIC05NzRdLAogICAgICA0OTY6IFsyMDAsIDQ5XSwKICAgICAgNTA1OiBbNDExLCAtOTRdLAogICAgICA1MjA6IFstMzAzLCAtMTJdLAogICAgICA1Mzc6IFstNzk1LCAtMjQzXSwKICAgICAgNTM5OiBbLTUzNCwgLTExMzBdLAogICAgICA1NDA6IFstNzAyLCAtMTEzNV0sCiAgICAgIDU0MTogWy02NTYsIC0xMDE0XSwKICAgICAgNTQyOiBbLTY1MCwgLTEyNTJdLAogICAgICA1NjE6IFsyOTgsIC0yMV0sCiAgICAgIDU2MjogWzMyLCA3NDRdLAogICAgICA1OTE6IFsxNDgsIDg0NF0sCiAgICAgIDU5MjogWy01MiwgODU4XSwKICAgICAgNjQzOiBbNTcsIDYxNl0sCiAgICAgIDY0NjogWzQ4NSwgLTg4Ml0sCiAgICAgIDY0NzogWy0xMDIsIDI0Nl0sCiAgICAgIDcxNzogWzYyMSwgLTY3Nl0sCiAgICAgIDcxODogWzYxOCwgLTUzN10sCiAgICAgIDcxOTogWy0yMjUsIC01MjBdLAogICAgICA3MjA6IFstMTUwLCAtNjMxXSwKICAgICAgODAxOiBbLTE4OCwgOTIwXSwKICAgICAgODAyOiBbLTM0NCwgOTE2XSwKICAgICAgODAzOiBbLTQ2MiwgODQ4XSwKICAgICAgODA0OiBbMzIwLCAzNTBdLAogICAgICA4MDU6IFsyMjEsIDQ4Nl0sCiAgICB9OwoKICAgIGZvciAodmFyIGkgaW4gR2FtZS5VcGdyYWRlUG9zaXRpb25zKSB7CiAgICAgIEdhbWUuVXBncmFkZXNCeUlkW2ldLnBvc1ggPSBHYW1lLlVwZ3JhZGVQb3NpdGlvbnNbaV1bMF07CiAgICAgIEdhbWUuVXBncmFkZXNCeUlkW2ldLnBvc1kgPSBHYW1lLlVwZ3JhZGVQb3NpdGlvbnNbaV1bMV07CiAgICB9CgogICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkJQUNISUVWRU1FTlRTCgkJPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KICAgIEdhbWUuQWNoaWV2ZW1lbnRzID0ge307CiAgICBHYW1lLkFjaGlldmVtZW50c0J5SWQgPSB7fTsKICAgIEdhbWUuQWNoaWV2ZW1lbnRzTiA9IDA7CiAgICBHYW1lLkFjaGlldmVtZW50c093bmVkID0gMDsKICAgIEdhbWUuQWNoaWV2ZW1lbnQgPSBmdW5jdGlvbiAobmFtZSwgZGVzYywgaWNvbikgewogICAgICB0aGlzLmlkID0gR2FtZS5BY2hpZXZlbWVudHNOOwogICAgICB0aGlzLm5hbWUgPSBuYW1lOwogICAgICB0aGlzLmRuYW1lID0gdGhpcy5uYW1lOwogICAgICB0aGlzLmRlc2MgPSBkZXNjOwogICAgICB0aGlzLmJhc2VEZXNjID0gdGhpcy5kZXNjOwogICAgICB0aGlzLmljb24gPSBpY29uOwogICAgICB0aGlzLndvbiA9IDA7CiAgICAgIHRoaXMuZGlzYWJsZWQgPSAwOwogICAgICB0aGlzLm9yZGVyID0gdGhpcy5pZDsKICAgICAgaWYgKG9yZGVyKSB0aGlzLm9yZGVyID0gb3JkZXIgKyB0aGlzLmlkICogMC4wMDE7CiAgICAgIHRoaXMucG9vbCA9ICJub3JtYWwiOwogICAgICB0aGlzLnZhbmlsbGEgPSBHYW1lLnZhbmlsbGE7CiAgICAgIHRoaXMudHlwZSA9ICJhY2hpZXZlbWVudCI7CgogICAgICB0aGlzLmNsaWNrID0gZnVuY3Rpb24gKCkgewogICAgICAgIGlmICh0aGlzLmNsaWNrRnVuY3Rpb24pIHRoaXMuY2xpY2tGdW5jdGlvbigpOwogICAgICB9OwogICAgICBHYW1lLmxhc3QgPSB0aGlzOwogICAgICBHYW1lLkFjaGlldmVtZW50c1t0aGlzLm5hbWVdID0gdGhpczsKICAgICAgR2FtZS5BY2hpZXZlbWVudHNCeUlkW3RoaXMuaWRdID0gdGhpczsKICAgICAgR2FtZS5BY2hpZXZlbWVudHNOKys7CiAgICAgIHJldHVybiB0aGlzOwogICAgfTsKICAgIEdhbWUuQWNoaWV2ZW1lbnQucHJvdG90eXBlLmdldFR5cGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiAiQWNoaWV2ZW1lbnQiOwogICAgfTsKCiAgICBHYW1lLldpbiA9IGZ1bmN0aW9uICh3aGF0KSB7CiAgICAgIGlmICh0eXBlb2Ygd2hhdCA9PT0gInN0cmluZyIpIHsKICAgICAgICBpZiAoR2FtZS5BY2hpZXZlbWVudHNbd2hhdF0pIHsKICAgICAgICAgIHZhciBpdCA9IEdhbWUuQWNoaWV2ZW1lbnRzW3doYXRdOwogICAgICAgICAgaWYgKGl0LndvbiA9PSAwKSB7CiAgICAgICAgICAgIHZhciBuYW1lID0gaXQuc2hvcnROYW1lID8gaXQuc2hvcnROYW1lIDogaXQuZG5hbWU7CiAgICAgICAgICAgIGl0LndvbiA9IDE7CiAgICAgICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgICAgIGxvYygiQWNoaWV2ZW1lbnQgdW5sb2NrZWQiKSwKICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0idGl0bGUiIHN0eWxlPSJmb250LXNpemU6MThweDttYXJnaW4tdG9wOi0ycHg7Ij4nICsKICAgICAgICAgICAgICAgIG5hbWUgKwogICAgICAgICAgICAgICAgIjwvZGl2PiIsCiAgICAgICAgICAgICAgaXQuaWNvbgogICAgICAgICAgICApOwogICAgICAgICAgICBHYW1lLk5vdGlmeVRvb2x0aXAoCiAgICAgICAgICAgICAgImZ1bmN0aW9uKCl7cmV0dXJuIEdhbWUuY3JhdGVUb29sdGlwKEdhbWUuQWNoaWV2ZW1lbnRzQnlJZFsiICsKICAgICAgICAgICAgICAgIGl0LmlkICsKICAgICAgICAgICAgICAgICJdKTt9IgogICAgICAgICAgICApOwogICAgICAgICAgICBpZiAoR2FtZS5Db3VudHNBc0FjaGlldmVtZW50T3duZWQoaXQucG9vbCkpCiAgICAgICAgICAgICAgR2FtZS5BY2hpZXZlbWVudHNPd25lZCsrOwogICAgICAgICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICAgICAgICBpZiAoQXBwICYmIGl0LnZhbmlsbGEpIEFwcC5nb3RBY2hpZXYoaXQuaWQpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKHZhciBpIGluIHdoYXQpIHsKICAgICAgICAgIEdhbWUuV2luKHdoYXRbaV0pOwogICAgICAgIH0KICAgICAgfQogICAgfTsKICAgIEdhbWUuUmVtb3ZlQWNoaWV2ID0gZnVuY3Rpb24gKHdoYXQpIHsKICAgICAgaWYgKEdhbWUuQWNoaWV2ZW1lbnRzW3doYXRdKSB7CiAgICAgICAgaWYgKEdhbWUuQWNoaWV2ZW1lbnRzW3doYXRdLndvbiA9PSAxKSB7CiAgICAgICAgICBHYW1lLkFjaGlldmVtZW50c1t3aGF0XS53b24gPSAwOwogICAgICAgICAgaWYgKEdhbWUuQ291bnRzQXNBY2hpZXZlbWVudE93bmVkKEdhbWUuQWNoaWV2ZW1lbnRzW3doYXRdLnBvb2wpKQogICAgICAgICAgICBHYW1lLkFjaGlldmVtZW50c093bmVkLS07CiAgICAgICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICAgIH0KICAgICAgfQogICAgfTsKICAgIEdhbWUuQWNoaWV2ZW1lbnQucHJvdG90eXBlLnRvZ2dsZSA9IGZ1bmN0aW9uICgpIC8vY2hlYXRpbmcgb25seQogICAgewogICAgICBpZiAoIXRoaXMud29uKSB7CiAgICAgICAgR2FtZS5XaW4odGhpcy5uYW1lKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBHYW1lLlJlbW92ZUFjaGlldih0aGlzLm5hbWUpOwogICAgICB9CiAgICAgIGlmIChHYW1lLm9uTWVudSA9PSAic3RhdHMiKSBHYW1lLlVwZGF0ZU1lbnUoKTsKICAgIH07CgogICAgR2FtZS5Db3VudHNBc0FjaGlldmVtZW50T3duZWQgPSBmdW5jdGlvbiAocG9vbCkgewogICAgICBpZiAocG9vbCA9PSAiIiB8fCBwb29sID09ICJub3JtYWwiKSByZXR1cm4gdHJ1ZTsKICAgICAgZWxzZSByZXR1cm4gZmFsc2U7CiAgICB9OwoKICAgIEdhbWUuSGFzQWNoaWV2ID0gZnVuY3Rpb24gKHdoYXQpIHsKICAgICAgcmV0dXJuIEdhbWUuQWNoaWV2ZW1lbnRzW3doYXRdID8gR2FtZS5BY2hpZXZlbWVudHNbd2hhdF0ud29uIDogMDsKICAgIH07CgogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCA9IGZ1bmN0aW9uIChuYW1lLCBkZXNjLCBidWlsZGluZywgdGllcikgewogICAgICB2YXIgYWNoaWV2ID0gbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICAgbmFtZSwKICAgICAgICBsb2MoCiAgICAgICAgICAiSGF2ZSA8Yj4lMTwvYj4uIiwKICAgICAgICAgIGxvYygKICAgICAgICAgICAgIiUxICIgKyBHYW1lLk9iamVjdHNbYnVpbGRpbmddLmJzaW5nbGUsCiAgICAgICAgICAgIExCZWF1dGlmeShHYW1lLlRpZXJzW3RpZXJdLmFjaGlldlVubG9jaykKICAgICAgICAgICkKICAgICAgICApICsgZGVzYywKICAgICAgICBHYW1lLkdldEljb24oYnVpbGRpbmcsIHRpZXIpCiAgICAgICk7CiAgICAgIEdhbWUuU2V0VGllcihidWlsZGluZywgdGllcik7CiAgICAgIHJldHVybiBhY2hpZXY7CiAgICB9OwoKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50ID0gZnVuY3Rpb24gKG5hbWUsIGJ1aWxkaW5nLCB0aWVyLCBxLCBtdWx0KSB7CiAgICAgIHZhciBidWlsZGluZyA9IEdhbWUuT2JqZWN0c1tidWlsZGluZ107CiAgICAgIHZhciBpY29uID0gW2J1aWxkaW5nLmljb25Db2x1bW4sIDIyXTsKICAgICAgdmFyIG4gPSAxMiArIGJ1aWxkaW5nLm4gKyAobXVsdCB8fCAwKTsKICAgICAgaWYgKHRpZXIgPT0gMikgewogICAgICAgIGljb25bMV0gPSAyMzsKICAgICAgICBuICs9IDc7CiAgICAgIH0gZWxzZSBpZiAodGllciA9PSAzKSB7CiAgICAgICAgaWNvblsxXSA9IDI0OwogICAgICAgIG4gKz0gMTQ7CiAgICAgIH0KICAgICAgdmFyIHBvdyA9IE1hdGgucG93KDEwLCBuKTsKICAgICAgdmFyIGFjaGlldiA9IG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAgIG5hbWUsCiAgICAgICAgbG9jKCJNYWtlIDxiPiUxPC9iPiBqdXN0IGZyb20gJTIuIiwgWwogICAgICAgICAgbG9jKCIlMSBjb29raWUiLCB7IG46IHBvdywgYjogdG9GaXhlZChwb3cpIH0pLAogICAgICAgICAgYnVpbGRpbmcucGx1cmFsLAogICAgICAgIF0pICsgKHEgPyAiPHE+IiArIHEgKyAiPC9xPiIgOiAiIiksCiAgICAgICAgaWNvbgogICAgICApOwogICAgICBidWlsZGluZy5wcm9kdWN0aW9uQWNoaWV2cy5wdXNoKHsgcG93OiBwb3csIGFjaGlldjogYWNoaWV2IH0pOwogICAgICByZXR1cm4gYWNoaWV2OwogICAgfTsKCiAgICBHYW1lLnRocmVzaG9sZEljb25zID0gWwogICAgICAwLCAxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5LCAxMCwgMTEsIDE4LCAxOSwgMjAsIDIxLCAyMiwgMjMsIDI0LCAyNSwgMjYsCiAgICAgIDI3LCAyOCwgMjksIDIxLCAyMiwgMjMsIDI0LCAyNSwgMjYsIDI3LCAyOCwgMjksIDIxLCAyMiwgMjMsIDI0LCAyNSwgMjYsCiAgICAgIDI3LCAyOCwgMjksIDMwLCAzMSwgMzAsIDMxLAogICAgXTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50cyA9IFtdOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQgPSBmdW5jdGlvbiAobmFtZSwgcSkgewogICAgICB2YXIgdGhyZXNob2xkID0gTWF0aC5wb3coCiAgICAgICAgMTAsCiAgICAgICAgTWF0aC5mbG9vcihHYW1lLkJhbmtBY2hpZXZlbWVudHMubGVuZ3RoICogMS41ICsgMikKICAgICAgKTsKICAgICAgaWYgKEdhbWUuQmFua0FjaGlldmVtZW50cy5sZW5ndGggPT0gMCkgdGhyZXNob2xkID0gMTsKICAgICAgdmFyIGFjaGlldiA9IG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAgIG5hbWUsCiAgICAgICAgbG9jKAogICAgICAgICAgIkJha2UgPGI+JTE8L2I+IGluIG9uZSBhc2NlbnNpb24uIiwKICAgICAgICAgIGxvYygiJTEgY29va2llIiwgeyBuOiB0aHJlc2hvbGQsIGI6IHRvRml4ZWQodGhyZXNob2xkKSB9KQogICAgICAgICkgKyAocSA/ICI8cT4iICsgcSArICI8L3E+IiA6ICIiKSwKICAgICAgICBbCiAgICAgICAgICBHYW1lLnRocmVzaG9sZEljb25zW0dhbWUuQmFua0FjaGlldmVtZW50cy5sZW5ndGhdLAogICAgICAgICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnRzLmxlbmd0aCA+IDQzCiAgICAgICAgICAgID8gMgogICAgICAgICAgICA6IEdhbWUuQmFua0FjaGlldmVtZW50cy5sZW5ndGggPiAzMgogICAgICAgICAgICA/IDEKICAgICAgICAgICAgOiBHYW1lLkJhbmtBY2hpZXZlbWVudHMubGVuZ3RoID4gMjMKICAgICAgICAgICAgPyAyCiAgICAgICAgICAgIDogNSwKICAgICAgICBdCiAgICAgICk7CiAgICAgIGFjaGlldi50aHJlc2hvbGQgPSB0aHJlc2hvbGQ7CiAgICAgIGFjaGlldi5vcmRlciA9IDEwMCArIEdhbWUuQmFua0FjaGlldmVtZW50cy5sZW5ndGggKiAwLjAxOwogICAgICBHYW1lLkJhbmtBY2hpZXZlbWVudHMucHVzaChhY2hpZXYpOwogICAgICByZXR1cm4gYWNoaWV2OwogICAgfTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnRzID0gW107CiAgICBHYW1lLkNwc0FjaGlldmVtZW50ID0gZnVuY3Rpb24gKG5hbWUsIHEpIHsKICAgICAgdmFyIHRocmVzaG9sZCA9IE1hdGgucG93KAogICAgICAgIDEwLAogICAgICAgIE1hdGguZmxvb3IoR2FtZS5DcHNBY2hpZXZlbWVudHMubGVuZ3RoICogMS4yKQogICAgICApOwogICAgICAvL2lmIChHYW1lLkNwc0FjaGlldmVtZW50cy5sZW5ndGg9PTApIHRocmVzaG9sZD0xOwogICAgICB2YXIgYWNoaWV2ID0gbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICAgbmFtZSwKICAgICAgICBsb2MoCiAgICAgICAgICAiQmFrZSA8Yj4lMTwvYj4gcGVyIHNlY29uZC4iLAogICAgICAgICAgbG9jKCIlMSBjb29raWUiLCB7IG46IHRocmVzaG9sZCwgYjogdG9GaXhlZCh0aHJlc2hvbGQpIH0pCiAgICAgICAgKSArIChxID8gIjxxPiIgKyBxICsgIjwvcT4iIDogIiIpLAogICAgICAgIFsKICAgICAgICAgIEdhbWUudGhyZXNob2xkSWNvbnNbR2FtZS5DcHNBY2hpZXZlbWVudHMubGVuZ3RoXSwKICAgICAgICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnRzLmxlbmd0aCA+IDQzCiAgICAgICAgICAgID8gMgogICAgICAgICAgICA6IEdhbWUuQ3BzQWNoaWV2ZW1lbnRzLmxlbmd0aCA+IDMyCiAgICAgICAgICAgID8gMQogICAgICAgICAgICA6IEdhbWUuQ3BzQWNoaWV2ZW1lbnRzLmxlbmd0aCA+IDIzCiAgICAgICAgICAgID8gMgogICAgICAgICAgICA6IDUsCiAgICAgICAgXQogICAgICApOwogICAgICBhY2hpZXYudGhyZXNob2xkID0gdGhyZXNob2xkOwogICAgICBhY2hpZXYub3JkZXIgPSAyMDAgKyBHYW1lLkNwc0FjaGlldmVtZW50cy5sZW5ndGggKiAwLjAxOwogICAgICBHYW1lLkNwc0FjaGlldmVtZW50cy5wdXNoKGFjaGlldik7CiAgICAgIHJldHVybiBhY2hpZXY7CiAgICB9OwoKICAgIC8vZGVmaW5lIGFjaGlldmVtZW50cwogICAgLy9XQVJOSU5HIDogZG8gTk9UIGFkZCBuZXcgYWNoaWV2ZW1lbnRzIGluIGJldHdlZW4sIHRoaXMgYnJlYWtzIHRoZSBzYXZlcy4gQWRkIHRoZW0gYXQgdGhlIGVuZCAhCgogICAgdmFyIG9yZGVyID0gMDsgLy90aGlzIGlzIHVzZWQgdG8gc2V0IHRoZSBvcmRlciBpbiB3aGljaCB0aGUgaXRlbXMgYXJlIGxpc3RlZAoKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJXYWtlIGFuZCBiYWtlIik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiTWFraW5nIHNvbWUgZG91Z2giKTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJTbyBiYWtlZCByaWdodCBub3ciKTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJGbGVkZ2xpbmcgYmFrZXJ5Iik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiQWZmbHVlbnQgYmFrZXJ5Iik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiV29ybGQtZmFtb3VzIGJha2VyeSIpOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIkNvc21pYyBiYWtlcnkiKTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJHYWxhY3RpYyBiYWtlcnkiKTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJVbml2ZXJzYWwgYmFrZXJ5Iik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiVGltZWxlc3MgYmFrZXJ5Iik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiSW5maW5pdGUgYmFrZXJ5Iik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiSW1tb3J0YWwgYmFrZXJ5Iik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiRG9uJ3Qgc3RvcCBtZSBub3ciKTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJZb3UgY2FuIHN0b3Agbm93Iik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiQ29va2llcyBhbGwgdGhlIHdheSBkb3duIik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiT3ZlcmRvc2UiKTsKCiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJDYXN1YWwgYmFraW5nIik7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJIYXJkY29yZSBiYWtpbmciKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIlN0ZWFkeSB0YXN0eSBzdHJlYW0iKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIkNvb2tpZSBtb25zdGVyIik7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJNYXNzIHByb2R1Y2VyIik7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJDb29raWUgdm9ydGV4Iik7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJDb29raWUgcHVsc2FyIik7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJDb29raWUgcXVhc2FyIik7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJPaCBoZXksIHlvdSdyZSBzdGlsbCBoZXJlIik7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJMZXQncyBuZXZlciBiYWtlIGFnYWluIik7CgogICAgb3JkZXIgPSAzMDAxMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiU2FjcmlmaWNlIiwKICAgICAgbG9jKCJBc2NlbmQgd2l0aCA8Yj4lMTwvYj4gYmFrZWQuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWU2KSkpICsKICAgICAgICAiPHE+RWFzeSBjb21lLCBlYXN5IGdvLjwvcT4iLAogICAgICBbMTEsIDZdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJPYmxpdmlvbiIsCiAgICAgIGxvYygiQXNjZW5kIHdpdGggPGI+JTE8L2I+IGJha2VkLiIsIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KDFlOSkpKSArCiAgICAgICAgIjxxPkJhY2sgdG8gc3F1YXJlIG9uZS48L3E+IiwKICAgICAgWzExLCA2XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiRnJvbSBzY3JhdGNoIiwKICAgICAgbG9jKCJBc2NlbmQgd2l0aCA8Yj4lMTwvYj4gYmFrZWQuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUxMikpKSArCiAgICAgICAgIjxxPkl0J3MgYmVlbiBmdW4uPC9xPiIsCiAgICAgIFsxMSwgNl0KICAgICk7CgogICAgb3JkZXIgPSAxMTAxMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiTmV2ZXJjbGljayIsCiAgICAgIGxvYygiTWFrZSA8Yj4lMTwvYj4gYnkgb25seSBoYXZpbmcgY2xpY2tlZCA8Yj4lMiB0aW1lczwvYj4uIiwgWwogICAgICAgIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KDFlNikpLAogICAgICAgIDE1LAogICAgICBdKSwKICAgICAgWzEyLCAwXQogICAgKTsgLy9HYW1lLmxhc3QucG9vbD0nc2hhZG93JzsKICAgIG9yZGVyID0gMTAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQ2xpY2t0YXN0aWMiLAogICAgICBsb2MoIk1ha2UgPGI+JTE8L2I+IGZyb20gY2xpY2tpbmcuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUzKSkpLAogICAgICBbMTEsIDBdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJDbGlja2F0aGxvbiIsCiAgICAgIGxvYygiTWFrZSA8Yj4lMTwvYj4gZnJvbSBjbGlja2luZy4iLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxZTUpKSksCiAgICAgIFsxMSwgMV0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkNsaWNrb2x5bXBpY3MiLAogICAgICBsb2MoIk1ha2UgPGI+JTE8L2I+IGZyb20gY2xpY2tpbmcuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWU3KSkpLAogICAgICBbMTEsIDJdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJDbGlja29yYW1hIiwKICAgICAgbG9jKCJNYWtlIDxiPiUxPC9iPiBmcm9tIGNsaWNraW5nLiIsIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KDFlOSkpKSwKICAgICAgWzExLCAxM10KICAgICk7CgogICAgb3JkZXIgPSAxMDUwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJDbGljayIsCiAgICAgIGxvYygiSGF2ZSA8Yj4lMTwvYj4uIiwgbG9jKCIlMSBjdXJzb3IiLCBMQmVhdXRpZnkoMSkpKSwKICAgICAgWzAsIDBdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJEb3VibGUtY2xpY2siLAogICAgICBsb2MoIkhhdmUgPGI+JTE8L2I+LiIsIGxvYygiJTEgY3Vyc29yIiwgTEJlYXV0aWZ5KDIpKSksCiAgICAgIFswLCA2XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiTW91c2Ugd2hlZWwiLAogICAgICBsb2MoIkhhdmUgPGI+JTE8L2I+LiIsIGxvYygiJTEgY3Vyc29yIiwgTEJlYXV0aWZ5KDUwKSkpLAogICAgICBbMSwgNl0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIk9mIE1pY2UgYW5kIE1lbiIsCiAgICAgIGxvYygiSGF2ZSA8Yj4lMTwvYj4uIiwgbG9jKCIlMSBjdXJzb3IiLCBMQmVhdXRpZnkoMTAwKSkpLAogICAgICBbMCwgMV0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlRoZSBEaWdpdGFsIiwKICAgICAgbG9jKCJIYXZlIDxiPiUxPC9iPi4iLCBsb2MoIiUxIGN1cnNvciIsIExCZWF1dGlmeSgyMDApKSksCiAgICAgIFswLCAyXQogICAgKTsKCiAgICBvcmRlciA9IDEwOTg7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkp1c3Qgd3JvbmciLAogICAgICBsb2MoIlNlbGwgYSBncmFuZG1hLiIpICsgIjxxPkkgdGhvdWdodCB5b3UgbG92ZWQgbWUuPC9xPiIsCiAgICAgIFsxMCwgOV0KICAgICk7CiAgICBvcmRlciA9IDExMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJHcmFuZG1hJ3MgY29va2llcyIsICIiLCAiR3JhbmRtYSIsIDEpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiU2xvcHB5IGtpc3NlcyIsICIiLCAiR3JhbmRtYSIsIDIpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiUmV0aXJlbWVudCBob21lIiwgIiIsICJHcmFuZG1hIiwgMyk7CgogICAgb3JkZXIgPSAxMjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiQm91Z2h0IHRoZSBmYXJtIiwgIiIsICJGYXJtIiwgMSk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJSZWFwIHdoYXQgeW91IHNvdyIsICIiLCAiRmFybSIsIDIpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiRmFybSBpbGwiLCAiIiwgIkZhcm0iLCAzKTsKCiAgICBvcmRlciA9IDE0MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJQcm9kdWN0aW9uIGNoYWluIiwgIiIsICJGYWN0b3J5IiwgMSk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJJbmR1c3RyaWFsIHJldm9sdXRpb24iLCAiIiwgIkZhY3RvcnkiLCAyKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkdsb2JhbCB3YXJtaW5nIiwgIiIsICJGYWN0b3J5IiwgMyk7CgogICAgb3JkZXIgPSAxMzAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiWW91IGtub3cgdGhlIGRyaWxsIiwgIiIsICJNaW5lIiwgMSk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJFeGNhdmF0aW9uIHNpdGUiLCAiIiwgIk1pbmUiLCAyKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkhvbGxvdyB0aGUgcGxhbmV0IiwgIiIsICJNaW5lIiwgMyk7CgogICAgb3JkZXIgPSAxNTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiRXhwZWRpdGlvbiIsICIiLCAiU2hpcG1lbnQiLCAxKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkdhbGFjdGljIGhpZ2h3YXkiLCAiIiwgIlNoaXBtZW50IiwgMik7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJGYXIgZmFyIGF3YXkiLCAiIiwgIlNoaXBtZW50IiwgMyk7CgogICAgb3JkZXIgPSAxNjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiVHJhbnNtdXRhdGlvbiIsICIiLCAiQWxjaGVteSBsYWIiLCAxKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlRyYW5zbW9ncmlmaWNhdGlvbiIsICIiLCAiQWxjaGVteSBsYWIiLCAyKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkdvbGQgbWVtYmVyIiwgIiIsICJBbGNoZW15IGxhYiIsIDMpOwoKICAgIG9yZGVyID0gMTcwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkEgd2hvbGUgbmV3IHdvcmxkIiwgIiIsICJQb3J0YWwiLCAxKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIk5vdyB5b3UncmUgdGhpbmtpbmciLCAiIiwgIlBvcnRhbCIsIDIpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiRGltZW5zaW9uYWwgc2hpZnQiLCAiIiwgIlBvcnRhbCIsIDMpOwoKICAgIG9yZGVyID0gMTgwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlRpbWUgd2FycCIsICIiLCAiVGltZSBtYWNoaW5lIiwgMSk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJBbHRlcm5hdGUgdGltZWxpbmUiLCAiIiwgIlRpbWUgbWFjaGluZSIsIDIpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiUmV3cml0aW5nIGhpc3RvcnkiLCAiIiwgIlRpbWUgbWFjaGluZSIsIDMpOwoKICAgIG9yZGVyID0gNzAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiT25lIHdpdGggZXZlcnl0aGluZyIsCiAgICAgIGxvYygiSGF2ZSA8Yj5hdCBsZWFzdCAlMTwvYj4gb2YgZXZlcnkgYnVpbGRpbmcuIiwgMSksCiAgICAgIFsyLCA3XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiTWF0aGVtYXRpY2lhbiIsCiAgICAgIGxvYygKICAgICAgICAiSGF2ZSBhdCBsZWFzdCA8Yj4xIG9mIHRoZSBtb3N0IGV4cGVuc2l2ZSBvYmplY3QsIDIgb2YgdGhlIHNlY29uZC1tb3N0IGV4cGVuc2l2ZSwgNCBvZiB0aGUgbmV4dDwvYj4gYW5kIHNvIG9uIChjYXBwZWQgYXQgJTEpLiIsCiAgICAgICAgMTI4CiAgICAgICksCiAgICAgIFsyMywgMTJdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJCYXNlIDEwIiwKICAgICAgbG9jKAogICAgICAgICJIYXZlIGF0IGxlYXN0IDxiPjEwIG9mIHRoZSBtb3N0IGV4cGVuc2l2ZSBvYmplY3QsIDIwIG9mIHRoZSBzZWNvbmQtbW9zdCBleHBlbnNpdmUsIDMwIG9mIHRoZSBuZXh0PC9iPiBhbmQgc28gb24uIgogICAgICApLAogICAgICBbMjMsIDEyXQogICAgKTsKCiAgICBvcmRlciA9IDEwMDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJHb2xkZW4gY29va2llIiwKICAgICAgbG9jKCJDbGljayBhIDxiPmdvbGRlbiBjb29raWU8L2I+LiIpLAogICAgICBbMTAsIDE0XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiTHVja3kgY29va2llIiwKICAgICAgbG9jKCJDbGljayA8Yj4lMTwvYj4uIiwgbG9jKCIlMSBnb2xkZW4gY29va2llIiwgTEJlYXV0aWZ5KDcpKSksCiAgICAgIFsyMiwgNl0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkEgc3Ryb2tlIG9mIGx1Y2siLAogICAgICBsb2MoIkNsaWNrIDxiPiUxPC9iPi4iLCBsb2MoIiUxIGdvbGRlbiBjb29raWUiLCBMQmVhdXRpZnkoMjcpKSksCiAgICAgIFsyMywgNl0KICAgICk7CgogICAgb3JkZXIgPSAzMDIwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQ2hlYXRlZCBjb29raWVzIHRhc3RlIGF3ZnVsIiwKICAgICAgbG9jKCJIYWNrIGluIHNvbWUgY29va2llcy4iKSwKICAgICAgWzEwLCA2XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInNoYWRvdyI7CiAgICBvcmRlciA9IDExMDEwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJVbmNhbm55IGNsaWNrZXIiLAogICAgICBsb2MoIkNsaWNrIHJlYWxseSwgcmVhbGx5IGZhc3QuIikgKyAiPHE+V2VsbCBJJ2xsIGJlITwvcT4iLAogICAgICBbMTIsIDBdCiAgICApOwoKICAgIG9yZGVyID0gNTAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQnVpbGRlciIsCiAgICAgIGxvYygiT3duIDxiPiUxPC9iPi4iLCBsb2MoIiUxIGJ1aWxkaW5nIiwgTEJlYXV0aWZ5KDEwMCkpKSwKICAgICAgWzIsIDZdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJBcmNoaXRlY3QiLAogICAgICBsb2MoIk93biA8Yj4lMTwvYj4uIiwgbG9jKCIlMSBidWlsZGluZyIsIExCZWF1dGlmeSg1MDApKSksCiAgICAgIFszLCA2XQogICAgKTsKICAgIG9yZGVyID0gNjAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiRW5oYW5jZXIiLAogICAgICBsb2MoIlB1cmNoYXNlIDxiPiUxPC9iPi4iLCBsb2MoIiUxIHVwZ3JhZGUiLCBMQmVhdXRpZnkoMjApKSksCiAgICAgIFs5LCAwXQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQXVnbWVudGVyIiwKICAgICAgbG9jKCJQdXJjaGFzZSA8Yj4lMTwvYj4uIiwgbG9jKCIlMSB1cGdyYWRlIiwgTEJlYXV0aWZ5KDUwKSkpLAogICAgICBbOSwgMV0KICAgICk7CgogICAgb3JkZXIgPSAxMTAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQ29va2llLWR1bmtlciIsCiAgICAgIGxvYygiRHVuayB0aGUgY29va2llLiIpICsgIjxxPllvdSBkaWQgaXQhPC9xPiIsCiAgICAgIFsxLCA4XQogICAgKTsKCiAgICBvcmRlciA9IDEwMDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJGb3J0dW5lIiwKICAgICAgbG9jKCJDbGljayA8Yj4lMTwvYj4uIiwgbG9jKCIlMSBnb2xkZW4gY29va2llIiwgTEJlYXV0aWZ5KDc3KSkpICsKICAgICAgICAiPHE+WW91IHNob3VsZCByZWFsbHkgZ28gdG8gYmVkLjwvcT4iLAogICAgICBbMjQsIDZdCiAgICApOwogICAgb3JkZXIgPSAzMTAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiVHJ1ZSBOZXZlcmNsaWNrIiwKICAgICAgbG9jKAogICAgICAgICJNYWtlIDxiPiUxPC9iPiB3aXRoIDxiPm5vPC9iPiBjb29raWUgY2xpY2tzLiIsCiAgICAgICAgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWU2KSkKICAgICAgKSArICI8cT5UaGlzIGtpbmRhIGRlZmVhdHMgdGhlIHdob2xlIHB1cnBvc2UsIGRvZXNuJ3QgaXQ/PC9xPiIsCiAgICAgIFsxMiwgMF0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJzaGFkb3ciOwoKICAgIG9yZGVyID0gMjAwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkVsZGVyIG5hcCIsCiAgICAgIGxvYygiQXBwZWFzZSB0aGUgZ3JhbmRtYXRyaWFyY2hzIGF0IGxlYXN0IDxiPm9uY2U8L2I+LiIpICsKICAgICAgICAiPHE+d2U8YnI+YXJlPGJyPmV0ZXJuYWw8L3E+IiwKICAgICAgWzgsIDldCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJFbGRlciBzbHVtYmVyIiwKICAgICAgbG9jKCJBcHBlYXNlIHRoZSBncmFuZG1hdHJpYXJjaHMgYXQgbGVhc3QgPGI+JTEgdGltZXM8L2I+LiIsIDUpICsKICAgICAgICAiPHE+b3VyIG1pbmQ8YnI+b3V0bGl2ZXM8YnI+dGhlIHVuaXZlcnNlPC9xPiIsCiAgICAgIFs4LCA5XQogICAgKTsKCiAgICBvcmRlciA9IDEwOTg7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkVsZGVyIiwKICAgICAgbG9jKCJPd24gYXQgbGVhc3QgPGI+JTE8L2I+IGdyYW5kbWEgdHlwZXMuIiwgNyksCiAgICAgIFsxMCwgOV0KICAgICk7CgogICAgb3JkZXIgPSAyMDAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiRWxkZXIgY2FsbSIsCiAgICAgIGxvYygiRGVjbGFyZSBhIGNvdmVuYW50IHdpdGggdGhlIGdyYW5kbWF0cmlhcmNocy4iKSArCiAgICAgICAgIjxxPndlPGJyPmhhdmU8YnI+ZmVkPC9xPiIsCiAgICAgIFs4LCA5XQogICAgKTsKCiAgICBvcmRlciA9IDUwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkVuZ2luZWVyIiwKICAgICAgbG9jKCJPd24gPGI+JTE8L2I+LiIsIGxvYygiJTEgYnVpbGRpbmciLCBMQmVhdXRpZnkoMTAwMCkpKSwKICAgICAgWzQsIDZdCiAgICApOwoKICAgIG9yZGVyID0gMTAwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkxlcHJlY2hhdW4iLAogICAgICBsb2MoIkNsaWNrIDxiPiUxPC9iPi4iLCBsb2MoIiUxIGdvbGRlbiBjb29raWUiLCBMQmVhdXRpZnkoNzc3KSkpLAogICAgICBbMjUsIDZdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJCbGFjayBjYXQncyBwYXciLAogICAgICBsb2MoIkNsaWNrIDxiPiUxPC9iPi4iLCBsb2MoIiUxIGdvbGRlbiBjb29raWUiLCBMQmVhdXRpZnkoNzc3NykpKSwKICAgICAgWzI2LCA2XQogICAgKTsKCiAgICBvcmRlciA9IDMwMDUwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJOaWhpbGlzbSIsCiAgICAgIGxvYygiQXNjZW5kIHdpdGggPGI+JTE8L2I+IGJha2VkLiIsIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KDFlMTUpKSkgKwogICAgICAgICI8cT5UaGVyZSBhcmUgbWFueSB0aGluZ3M8YnI+dGhhdCBuZWVkIHRvIGJlIGVyYXNlZDwvcT4iLAogICAgICBbMTEsIDddCiAgICApOwoKICAgIG9yZGVyID0gMTkwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkFudGliYXR0ZXIiLCAiIiwgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwgMSk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJRdWlya3kgcXVhcmtzIiwgIiIsICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsIDIpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiSXQgZG9lcyBtYXR0ZXIhIiwgIiIsICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsIDMpOwoKICAgIG9yZGVyID0gNjAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiVXBncmFkZXIiLAogICAgICBsb2MoIlB1cmNoYXNlIDxiPiUxPC9iPi4iLCBsb2MoIiUxIHVwZ3JhZGUiLCBMQmVhdXRpZnkoMTAwKSkpLAogICAgICBbOSwgMl0KICAgICk7CgogICAgb3JkZXIgPSA3MDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJDZW50ZW5uaWFsIiwKICAgICAgbG9jKCJIYXZlIGF0IGxlYXN0IDxiPiUxIG9mIGV2ZXJ5dGhpbmc8L2I+LiIsIDEwMCksCiAgICAgIFs2LCA2XQogICAgKTsKCiAgICBvcmRlciA9IDMwNTAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJIYXJkY29yZSIsCiAgICAgIGxvYygKICAgICAgICAiR2V0IHRvIDxiPiUxPC9iPiBiYWtlZCB3aXRoIDxiPm5vIHVwZ3JhZGVzIHB1cmNoYXNlZDwvYj4uIiwKICAgICAgICBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxZTkpKQogICAgICApLAogICAgICBbMTIsIDZdCiAgICApOyAvL0dhbWUubGFzdC5wb29sPSdzaGFkb3cnOwoKICAgIG9yZGVyID0gMzA2MDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlNwZWVkIGJha2luZyBJIiwKICAgICAgbG9jKCJHZXQgdG8gPGI+JTE8L2I+IGJha2VkIGluIDxiPiUyPC9iPi4iLCBbCiAgICAgICAgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWU2KSksCiAgICAgICAgR2FtZS5zYXlUaW1lKDYwICogMzUgKiBHYW1lLmZwcyksCiAgICAgIF0pLAogICAgICBbMTIsIDVdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAic2hhZG93IjsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiU3BlZWQgYmFraW5nIElJIiwKICAgICAgbG9jKCJHZXQgdG8gPGI+JTE8L2I+IGJha2VkIGluIDxiPiUyPC9iPi4iLCBbCiAgICAgICAgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWU2KSksCiAgICAgICAgR2FtZS5zYXlUaW1lKDYwICogMjUgKiBHYW1lLmZwcyksCiAgICAgIF0pLAogICAgICBbMTMsIDVdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAic2hhZG93IjsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiU3BlZWQgYmFraW5nIElJSSIsCiAgICAgIGxvYygiR2V0IHRvIDxiPiUxPC9iPiBiYWtlZCBpbiA8Yj4lMjwvYj4uIiwgWwogICAgICAgIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KDFlNikpLAogICAgICAgIEdhbWUuc2F5VGltZSg2MCAqIDE1ICogR2FtZS5mcHMpLAogICAgICBdKSwKICAgICAgWzE0LCA1XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInNoYWRvdyI7CgogICAgb3JkZXIgPSA2MTAwMDsKICAgIHZhciBhY2hpZXYgPSBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkdldHRpbmcgZXZlbiB3aXRoIHRoZSBvdmVuIiwKICAgICAgRU4KICAgICAgICA/ICJEZWZlYXQgdGhlIDxiPlNlbnRpZW50IEZ1cm5hY2U8L2I+IGluIHRoZSBmYWN0b3J5IGR1bmdlb25zLiIKICAgICAgICA6ICI/Pz8iLAogICAgICBbMTIsIDddCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAiZHVuZ2VvbiI7CiAgICB2YXIgYWNoaWV2ID0gbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJOb3cgdGhpcyBpcyBwb2Qtc21hc2hpbmciLAogICAgICBFTgogICAgICAgID8gIkRlZmVhdCB0aGUgPGI+QXNjZW5kZWQgQmFraW5nIFBvZDwvYj4gaW4gdGhlIGZhY3RvcnkgZHVuZ2VvbnMuIgogICAgICAgIDogIj8/PyIsCiAgICAgIFsxMiwgN10KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJkdW5nZW9uIjsKICAgIHZhciBhY2hpZXYgPSBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkNoaXJwZWQgb3V0IiwKICAgICAgRU4KICAgICAgICA/ICJGaW5kIGFuZCBkZWZlYXQgPGI+Q2hpcnB5PC9iPiwgdGhlIGR5c2Z1bmN0aW9ubmluZyBhbGFybSBib3QuIgogICAgICAgIDogIj8/PyIsCiAgICAgIFsxMywgN10KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJkdW5nZW9uIjsKICAgIHZhciBhY2hpZXYgPSBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkZvbGxvdyB0aGUgd2hpdGUgcmFiYml0IiwKICAgICAgRU4gPyAiRmluZCBhbmQgZGVmZWF0IHRoZSBlbHVzaXZlIDxiPnN1Z2FyIGJ1bm55PC9iPi4iIDogIj8/PyIsCiAgICAgIFsxNCwgN10KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJkdW5nZW9uIjsKCiAgICBvcmRlciA9IDEwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkNsaWNrYXNtaWMiLAogICAgICBsb2MoIk1ha2UgPGI+JTE8L2I+IGZyb20gY2xpY2tpbmcuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUxMSkpKSwKICAgICAgWzExLCAxNF0KICAgICk7CgogICAgb3JkZXIgPSAxMTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiRnJpZW5kIG9mIHRoZSBhbmNpZW50cyIsICIiLCAiR3JhbmRtYSIsIDQpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiUnVsZXIgb2YgdGhlIGFuY2llbnRzIiwgIiIsICJHcmFuZG1hIiwgNSk7CgogICAgb3JkZXIgPSAzMjAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiV2hvbGVzb21lIiwKICAgICAgbG9jKCJVbmxvY2sgPGI+MTAwJTwvYj4gb2YgeW91ciBoZWF2ZW5seSBjaGlwcyBwb3dlci4iKSwKICAgICAgWzE1LCA3XQogICAgKTsKCiAgICBvcmRlciA9IDMzMDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJKdXN0IHBsYWluIGx1Y2t5IiwKICAgICAgbG9jKAogICAgICAgICJZb3UgaGF2ZSA8Yj4xIGNoYW5jZSBpbiAlMTwvYj4gZXZlcnkgc2Vjb25kIG9mIGVhcm5pbmcgdGhpcyBhY2hpZXZlbWVudC4iLAogICAgICAgIEJlYXV0aWZ5KDEwMDAwMDApCiAgICAgICksCiAgICAgIFsxNSwgNl0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJzaGFkb3ciOwoKICAgIG9yZGVyID0gMjEwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkl0Y2hzY3JhdGNoZXIiLAogICAgICBsb2MoIkJ1cnN0IDxiPjEgd3JpbmtsZXI8L2I+LiIpLAogICAgICBbMTksIDhdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJXcmlua2xlc3F1aXNoZXIiLAogICAgICBsb2MoIkJ1cnN0IDxiPiUxIHdyaW5rbGVyczwvYj4uIiwgNTApLAogICAgICBbMTksIDhdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJNb2lzdGJ1cnN0ZXIiLAogICAgICBsb2MoIkJ1cnN0IDxiPiUxIHdyaW5rbGVyczwvYj4uIiwgMjAwKSwKICAgICAgWzE5LCA4XQogICAgKTsKCiAgICBvcmRlciA9IDIyMDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJTcG9va3kgY29va2llcyIsCiAgICAgIGxvYygKICAgICAgICAnVW5sb2NrIDxiPmV2ZXJ5IEhhbGxvd2Vlbi10aGVtZWQgY29va2llPC9iPi48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj5Pd25pbmcgdGhpcyBhY2hpZXZlbWVudCBtYWtlcyBIYWxsb3dlZW4tdGhlbWVkIGNvb2tpZXMgZHJvcCBtb3JlIGZyZXF1ZW50bHkgaW4gZnV0dXJlIHBsYXl0aHJvdWdocy4nCiAgICAgICksCiAgICAgIFsxMiwgOF0KICAgICk7CgogICAgb3JkZXIgPSAyMjEwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQ29taW5nIHRvIHRvd24iLAogICAgICBsb2MoIlJlYWNoIDxiPlNhbnRhJ3MgN3RoIGZvcm08L2I+LiIpLAogICAgICBbMTgsIDldCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJBbGwgaGFpbCBTYW50YSIsCiAgICAgIGxvYygiUmVhY2ggPGI+U2FudGEncyBmaW5hbCBmb3JtPC9iPi4iKSwKICAgICAgWzE5LCAxMF0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkxldCBpdCBzbm93IiwKICAgICAgbG9jKAogICAgICAgICdVbmxvY2sgPGI+ZXZlcnkgQ2hyaXN0bWFzLXRoZW1lZCBjb29raWU8L2I+LjxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2Pk93bmluZyB0aGlzIGFjaGlldmVtZW50IG1ha2VzIENocmlzdG1hcy10aGVtZWQgY29va2llcyBkcm9wIG1vcmUgZnJlcXVlbnRseSBpbiBmdXR1cmUgcGxheXRocm91Z2hzLicKICAgICAgKSwKICAgICAgWzE5LCA5XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KCJPaCBkZWVyIiwgbG9jKCJQb3AgPGI+MSByZWluZGVlcjwvYj4uIiksIFsxMiwgOV0pOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJTbGVpZ2ggb2YgaGFuZCIsCiAgICAgIGxvYygiUG9wIDxiPiUxIHJlaW5kZWVyPC9iPi4iLCA1MCksCiAgICAgIFsxMiwgOV0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlJlaW5kZWVyIHNsZWlnaGVyIiwKICAgICAgbG9jKCJQb3AgPGI+JTEgcmVpbmRlZXI8L2I+LiIsIDIwMCksCiAgICAgIFsxMiwgOV0KICAgICk7CgogICAgb3JkZXIgPSAxMjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiUGVyZmVjdGVkIGFncmljdWx0dXJlIiwgIiIsICJGYXJtIiwgNCk7CiAgICBvcmRlciA9IDE0MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJVbHRpbWF0ZSBhdXRvbWF0aW9uIiwgIiIsICJGYWN0b3J5IiwgNCk7CiAgICBvcmRlciA9IDEzMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJDYW4geW91IGRpZyBpdCIsICIiLCAiTWluZSIsIDQpOwogICAgb3JkZXIgPSAxNTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiVHlwZSBJSSBjaXZpbGl6YXRpb24iLCAiIiwgIlNoaXBtZW50IiwgNCk7CiAgICBvcmRlciA9IDE2MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJHaWxkIHdhcnMiLCAiIiwgIkFsY2hlbXkgbGFiIiwgNCk7CiAgICBvcmRlciA9IDE3MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJCcmFpbi1zcGxpdCIsICIiLCAiUG9ydGFsIiwgNCk7CiAgICBvcmRlciA9IDE4MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJUaW1lIGR1a2UiLCAiIiwgIlRpbWUgbWFjaGluZSIsIDQpOwogICAgb3JkZXIgPSAxOTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTW9sZWN1bGFyIG1hZXN0cm8iLCAiIiwgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwgNCk7CgogICAgb3JkZXIgPSAyMDAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTG9uZSBwaG90b24iLCAiIiwgIlByaXNtIiwgMSk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJEYXp6bGluZyBnbGltbWVyIiwgIiIsICJQcmlzbSIsIDIpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiQmxpbmRpbmcgZmxhc2giLCAiIiwgIlByaXNtIiwgMyk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJVbmVuZGluZyBnbG93IiwgIiIsICJQcmlzbSIsIDQpOwoKICAgIG9yZGVyID0gNTAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiTG9yZCBvZiBDb25zdHJ1Y3RzIiwKICAgICAgbG9jKCJPd24gPGI+JTE8L2I+LiIsIGxvYygiJTEgYnVpbGRpbmciLCBMQmVhdXRpZnkoMjUwMCkpKSArCiAgICAgICAgIjxxPkhlIHNhdyB0aGUgdmFzdCBwbGFpbnMgc3RyZXRjaGluZyBhaGVhZCBvZiBoaW0sIGFuZCBoZSBzYWlkIDogbGV0IHRoZXJlIGJlIGNpdmlsaXphdGlvbi48L3E+IiwKICAgICAgWzUsIDZdCiAgICApOwogICAgb3JkZXIgPSA2MDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJMb3JkIG9mIFByb2dyZXNzIiwKICAgICAgbG9jKCJQdXJjaGFzZSA8Yj4lMTwvYj4uIiwgbG9jKCIlMSB1cGdyYWRlIiwgTEJlYXV0aWZ5KDIwMCkpKSArCiAgICAgICAgIjxxPk9uZSBjYW4gYWx3YXlzIGRvIGJldHRlci4gQnV0IHNob3VsZCB5b3U/PC9xPiIsCiAgICAgIFs5LCAxNF0KICAgICk7CiAgICBvcmRlciA9IDcwMDI7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkJpY2VudGVubmlhbCIsCiAgICAgIGxvYygiSGF2ZSBhdCBsZWFzdCA8Yj4lMSBvZiBldmVyeXRoaW5nPC9iPi4iLCAyMDApICsKICAgICAgICAiPHE+WW91IGNyYXp5IHBlcnNvbi48L3E+IiwKICAgICAgWzgsIDZdCiAgICApOwoKICAgIG9yZGVyID0gMjIzMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkxvdmVseSBjb29raWVzIiwKICAgICAgbG9jKCJVbmxvY2sgPGI+ZXZlcnkgVmFsZW50aW5lLXRoZW1lZCBjb29raWU8L2I+LiIpLAogICAgICBbMjAsIDNdCiAgICApOwoKICAgIG9yZGVyID0gNzAwMTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQ2VudGVubmlhbCBhbmQgYSBoYWxmIiwKICAgICAgbG9jKCJIYXZlIGF0IGxlYXN0IDxiPiUxIG9mIGV2ZXJ5dGhpbmc8L2I+LiIsIDE1MCksCiAgICAgIFs3LCA2XQogICAgKTsKCiAgICBvcmRlciA9IDExMDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJUaW55IGNvb2tpZSIsCiAgICAgIGxvYygiQ2xpY2sgdGhlIHRpbnkgY29va2llLiIpICsKICAgICAgICAiPHE+VGhlc2UgYXJlbid0IHRoZSBjb29raWVzPGJyPnlvdSdyZSBjbGlja2luZyBmb3IuPC9xPiIsCiAgICAgIFswLCA1XQogICAgKTsKCiAgICBvcmRlciA9IDQwMDAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiWW91IHdpbiBhIGNvb2tpZSIsCiAgICAgIGxvYygKICAgICAgICAiVGhpcyBpcyBmb3IgYmFraW5nICUxIGFuZCBtYWtpbmcgaXQgb24gdGhlIGxvY2FsIG5ld3MuIiwKICAgICAgICBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxZTE0KSkKICAgICAgKSArICI8cT5XZSdyZSBhbGwgc28gcHJvdWQgb2YgeW91LjwvcT4iLAogICAgICBbMTAsIDBdCiAgICApOwoKICAgIG9yZGVyID0gMTA3MDsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJDbGljayBkZWxlZ2F0b3IiLCAiQ3Vyc29yIiwgMSwgMCwgNyk7CiAgICBvcmRlciA9IDExMjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiR3VzaGluZyBncmFubmllcyIsICJHcmFuZG1hIiwgMSwgMCwgNik7CiAgICBvcmRlciA9IDEyMjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiSSBoYXRlIG1hbnVyZSIsICJGYXJtIiwgMSk7CiAgICBvcmRlciA9IDEzMjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiTmV2ZXIgZGlnIGRvd24iLCAiTWluZSIsIDEpOwogICAgb3JkZXIgPSAxNDIwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIlRoZSBpbmNyZWRpYmxlIG1hY2hpbmUiLCAiRmFjdG9yeSIsIDEpOwogICAgb3JkZXIgPSAxNTIwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIkFuZCBiZXlvbmQiLCAiU2hpcG1lbnQiLCAxKTsKICAgIG9yZGVyID0gMTYyMDsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJNYWdudW0gT3B1cyIsICJBbGNoZW15IGxhYiIsIDEpOwogICAgb3JkZXIgPSAxNzIwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIldpdGggc3RyYW5nZSBlb25zIiwgIlBvcnRhbCIsIDEpOwogICAgb3JkZXIgPSAxODIwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIlNwYWNldGltZSBqaWdhbWFyb28iLCAiVGltZSBtYWNoaW5lIiwgMSk7CiAgICBvcmRlciA9IDE5MjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiU3VwZXJtYXNzaXZlIiwgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwgMSk7CiAgICBvcmRlciA9IDIwMjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiUHJhaXNlIHRoZSBzdW4iLCAiUHJpc20iLCAxKTsKCiAgICBvcmRlciA9IDEwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkNsaWNrYWdlZGRvbiIsCiAgICAgIGxvYygiTWFrZSA8Yj4lMTwvYj4gZnJvbSBjbGlja2luZy4iLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxZTEzKSkpLAogICAgICBbMTEsIDE1XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQ2xpY2tuYXJvayIsCiAgICAgIGxvYygiTWFrZSA8Yj4lMTwvYj4gZnJvbSBjbGlja2luZy4iLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxZTE1KSkpLAogICAgICBbMTEsIDE2XQogICAgKTsKCiAgICBvcmRlciA9IDEwNTA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkV4dHJlbWUgcG9seWRhY3R5bHkiLAogICAgICBsb2MoIkhhdmUgPGI+JTE8L2I+LiIsIGxvYygiJTEgY3Vyc29yIiwgTEJlYXV0aWZ5KDMwMCkpKSwKICAgICAgWzAsIDEzXQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiRHIuIFQiLAogICAgICBsb2MoIkhhdmUgPGI+JTE8L2I+LiIsIGxvYygiJTEgY3Vyc29yIiwgTEJlYXV0aWZ5KDQwMCkpKSwKICAgICAgWzAsIDE0XQogICAgKTsKCiAgICBvcmRlciA9IDExMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KAogICAgICAiVGhlIG9sZCBuZXZlciBib3RoZXJlZCBtZSBhbnl3YXkiLAogICAgICAiIiwKICAgICAgIkdyYW5kbWEiLAogICAgICA2CiAgICApOwogICAgb3JkZXIgPSAxMjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiSG9tZWdyb3duIiwgIiIsICJGYXJtIiwgNSk7CiAgICBvcmRlciA9IDE0MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJUZWNobm9jcmFjeSIsICIiLCAiRmFjdG9yeSIsIDUpOwogICAgb3JkZXIgPSAxMzAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiVGhlIGNlbnRlciBvZiB0aGUgRWFydGgiLCAiIiwgIk1pbmUiLCA1KTsKICAgIG9yZGVyID0gMTUwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIldlIGNvbWUgaW4gcGVhY2UiLCAiIiwgIlNoaXBtZW50IiwgNSk7CiAgICBvcmRlciA9IDE2MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJUaGUgc2VjcmV0cyBvZiB0aGUgdW5pdmVyc2UiLCAiIiwgIkFsY2hlbXkgbGFiIiwgNSk7CiAgICBvcmRlciA9IDE3MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJSZWFsbSBvZiB0aGUgTWFkIEdvZCIsICIiLCAiUG9ydGFsIiwgNSk7CiAgICBvcmRlciA9IDE4MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJGb3JldmVyIGFuZCBldmVyIiwgIiIsICJUaW1lIG1hY2hpbmUiLCA1KTsKICAgIG9yZGVyID0gMTkwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIldhbGsgdGhlIHBsYW5jayIsICIiLCAiQW50aW1hdHRlciBjb25kZW5zZXIiLCA1KTsKICAgIG9yZGVyID0gMjAwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlJpc2UgYW5kIHNoaW5lIiwgIiIsICJQcmlzbSIsIDUpOwoKICAgIG9yZGVyID0gMzAyMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkdvZCBjb21wbGV4IiwKICAgICAgbG9jKAogICAgICAgICdOYW1lIHlvdXJzZWxmIDxiPk9ydGVpbDwvYj4uPGRpdiBjbGFzcz0id2FybmluZyI+Tm90ZTogdXN1cnBlcnMgaW5jdXIgYSAtJTElIENwUyBwZW5hbHR5IHVudGlsIHRoZXkgcmVuYW1lIHRoZW1zZWx2ZXMgc29tZXRoaW5nIGVsc2UuPC9kaXY+JywKICAgICAgICAxCiAgICAgICkgKyAiPHE+QnV0IHRoYXQncyBub3QgeW91LCBpcyBpdD88L3E+IiwKICAgICAgWzE3LCA1XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInNoYWRvdyI7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlRoaXJkLXBhcnR5IiwKICAgICAgbG9jKCJVc2UgYW4gPGI+YWRkLW9uPC9iPi4iKSArCiAgICAgICAgIjxxPlNvbWUgZmluZCB2YW5pbGxhIHRvIGJlIHRoZSBtb3N0IGJvcmluZyBmbGF2b3IuPC9xPiIsCiAgICAgIFsxNiwgNV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJzaGFkb3ciOyAvL2lmIHlvdSdyZSBtYWtpbmcgYSBtb2QsIGFkZCBhIEdhbWUuV2luKCdUaGlyZC1wYXJ0eScpIHNvbWV3aGVyZSBpbiB0aGVyZSEKCiAgICBvcmRlciA9IDMwMDUwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJEZW1hdGVyaWFsaXplIiwKICAgICAgbG9jKCJBc2NlbmQgd2l0aCA8Yj4lMTwvYj4gYmFrZWQuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUxOCkpKSArCiAgICAgICAgIjxxPlByZXN0byE8YnI+Li4ud2hlcmUnZCB0aGUgY29va2llcyBnbz88L3E+IiwKICAgICAgWzExLCA3XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiTmlsIHplcm8gemlsY2giLAogICAgICBsb2MoIkFzY2VuZCB3aXRoIDxiPiUxPC9iPiBiYWtlZC4iLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxZTIxKSkpICsKICAgICAgICAiPHE+VG8gc3VtbWFyaXplIDogcmVhbGx5IG5vdCB2ZXJ5IG11Y2ggYXQgYWxsLjwvcT4iLAogICAgICBbMTEsIDddCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJUcmFuc2NlbmRlbmNlIiwKICAgICAgbG9jKCJBc2NlbmQgd2l0aCA8Yj4lMTwvYj4gYmFrZWQuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUyNCkpKSArCiAgICAgICAgIjxxPllvdXIgY29va2llcyBhcmUgbm93IG9uIGEgaGlnaGVyIHBsYW5lIG9mIGJlaW5nLjwvcT4iLAogICAgICBbMTEsIDhdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJPYmxpdGVyYXRlIiwKICAgICAgbG9jKCJBc2NlbmQgd2l0aCA8Yj4lMTwvYj4gYmFrZWQuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUyNykpKSArCiAgICAgICAgIjxxPlJlc2lzdGFuY2UgaXMgZnV0aWxlLCBhbGJlaXQgZW50ZXJ0YWluaW5nLjwvcT4iLAogICAgICBbMTEsIDhdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJOZWdhdGl2ZSB2b2lkIiwKICAgICAgbG9jKCJBc2NlbmQgd2l0aCA8Yj4lMTwvYj4gYmFrZWQuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUzMCkpKSArCiAgICAgICAgIjxxPllvdSBub3cgaGF2ZSBzbyBmZXcgY29va2llcyB0aGF0IGl0J3MgYWxtb3N0IGxpa2UgeW91IGhhdmUgYSBuZWdhdGl2ZSBhbW91bnQgb2YgdGhlbS48L3E+IiwKICAgICAgWzExLCA4XQogICAgKTsKCiAgICBvcmRlciA9IDIyNDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJUaGUgaHVudCBpcyBvbiIsCiAgICAgIGxvYygiVW5sb2NrIDxiPjEgZWdnPC9iPi4iKSwKICAgICAgWzEsIDEyXQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiRWdnaW5nIG9uIiwKICAgICAgbG9jKCJVbmxvY2sgPGI+JTEgZWdnczwvYj4uIiwgNyksCiAgICAgIFs0LCAxMl0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIk1hc3MgRWFzdGVyaWEiLAogICAgICBsb2MoIlVubG9jayA8Yj4lMSBlZ2dzPC9iPi4iLCAxNCksCiAgICAgIFs3LCAxMl0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkhpZGUgJiBzZWVrIGNoYW1waW9uIiwKICAgICAgbG9jKAogICAgICAgICdVbmxvY2sgPGI+YWxsIHRoZSBlZ2dzPC9iPi48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj5Pd25pbmcgdGhpcyBhY2hpZXZlbWVudCBtYWtlcyBlZ2dzIGRyb3AgbW9yZSBmcmVxdWVudGx5IGluIGZ1dHVyZSBwbGF5dGhyb3VnaHMuJwogICAgICApLAogICAgICBbMTMsIDEyXQogICAgKTsKCiAgICBvcmRlciA9IDExMDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJXaGF0J3MgaW4gYSBuYW1lIiwKICAgICAgbG9jKCJHaXZlIHlvdXIgYmFrZXJ5IGEgbmFtZS4iKSwKICAgICAgWzE1LCA5XQogICAgKTsKCiAgICBvcmRlciA9IDE0MjU7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJQcmV0dHkgcGVubnkiLCAiIiwgIkJhbmsiLCAxKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkZpdCB0aGUgYmlsbCIsICIiLCAiQmFuayIsIDIpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiQSBsb2FuIGluIHRoZSBkYXJrIiwgIiIsICJCYW5rIiwgMyk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJOZWVkIGZvciBncmVlZCIsICIiLCAiQmFuayIsIDQpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiSXQncyB0aGUgZWNvbm9teSwgc3R1cGlkIiwgIiIsICJCYW5rIiwgNSk7CiAgICBvcmRlciA9IDE0NTA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJZb3VyIHRpbWUgdG8gc2hyaW5lIiwgIiIsICJUZW1wbGUiLCAxKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlNoYWR5IHNlY3QiLCAiIiwgIlRlbXBsZSIsIDIpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTmV3LWFnZSBjdWx0IiwgIiIsICJUZW1wbGUiLCAzKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIk9yZ2FuaXplZCByZWxpZ2lvbiIsICIiLCAiVGVtcGxlIiwgNCk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJGYW5hdGljaXNtIiwgIiIsICJUZW1wbGUiLCA1KTsKICAgIG9yZGVyID0gMTQ3NTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkJld2l0Y2hlZCIsICIiLCAiV2l6YXJkIHRvd2VyIiwgMSk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJUaGUgc29yY2VyZXIncyBhcHByZW50aWNlIiwgIiIsICJXaXphcmQgdG93ZXIiLCAyKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkNoYXJtcyBhbmQgZW5jaGFudG1lbnRzIiwgIiIsICJXaXphcmQgdG93ZXIiLCAzKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkN1cnNlcyBhbmQgbWFsZWRpY3Rpb25zIiwgIiIsICJXaXphcmQgdG93ZXIiLCA0KTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIk1hZ2ljIGtpbmdkb20iLCAiIiwgIldpemFyZCB0b3dlciIsIDUpOwoKICAgIG9yZGVyID0gMTQ0NTsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJWZXN0ZWQgaW50ZXJlc3QiLCAiQmFuayIsIDEpOwogICAgb3JkZXIgPSAxNDcwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIk5ldyB3b3JsZCBvcmRlciIsICJUZW1wbGUiLCAxKTsKICAgIG9yZGVyID0gMTQ5NTsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJIb2N1cyBwb2N1cyIsICJXaXphcmQgdG93ZXIiLCAxKTsKCiAgICBvcmRlciA9IDEwNzA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiRmluZ2VyIGNsaWNraW4nIGdvb2QiLCAiQ3Vyc29yIiwgMiwgMCwgNyk7CiAgICBvcmRlciA9IDExMjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiUGFuaWMgYXQgdGhlIGJpbmdvIiwgIkdyYW5kbWEiLCAyLCAwLCA2KTsKICAgIG9yZGVyID0gMTIyMDsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJSYWtlIGluIHRoZSBkb3VnaCIsICJGYXJtIiwgMik7CiAgICBvcmRlciA9IDEzMjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiUXVhcnJ5IG9uIiwgIk1pbmUiLCAyKTsKICAgIG9yZGVyID0gMTQyMDsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJZZXMgSSBsb3ZlIHRlY2hub2xvZ3kiLCAiRmFjdG9yeSIsIDIpOwogICAgb3JkZXIgPSAxNDQ1OwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIlBhaWQgaW4gZnVsbCIsICJCYW5rIiwgMik7CiAgICBvcmRlciA9IDE0NzA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiQ2h1cmNoIG9mIENvb2tpb2xvZ3kiLCAiVGVtcGxlIiwgMik7CiAgICBvcmRlciA9IDE0OTU7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgKICAgICAgIlRvbyBtYW55IHJhYmJpdHMsIG5vdCBlbm91Z2ggaGF0cyIsCiAgICAgICJXaXphcmQgdG93ZXIiLAogICAgICAyCiAgICApOwogICAgb3JkZXIgPSAxNTIwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIlRoZSBtb3N0IHByZWNpb3VzIGNhcmdvIiwgIlNoaXBtZW50IiwgMik7CiAgICBvcmRlciA9IDE2MjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiVGhlIEF1cmVhdGUiLCAiQWxjaGVteSBsYWIiLCAyKTsKICAgIG9yZGVyID0gMTcyMDsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJFdmVyIG1vcmUgaGlkZW91cyIsICJQb3J0YWwiLCAyKTsKICAgIG9yZGVyID0gMTgyMDsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJCZSBraW5kLCByZXdpbmQiLCAiVGltZSBtYWNoaW5lIiwgMik7CiAgICBvcmRlciA9IDE5MjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiSW5maW5pdGVzaW1hbCIsICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsIDIpOwogICAgb3JkZXIgPSAyMDIwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIkEgc3RpbGwgbW9yZSBnbG9yaW91cyBkYXduIiwgIlByaXNtIiwgMik7CgogICAgb3JkZXIgPSAzMDAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KCJSZWJpcnRoIiwgbG9jKCJBc2NlbmQgYXQgbGVhc3Qgb25jZS4iKSwgWzIxLCA2XSk7CgogICAgb3JkZXIgPSAxMTAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiSGVyZSB5b3UgZ28iLAogICAgICBsb2MoIkNsaWNrIHRoaXMgYWNoaWV2ZW1lbnQncyBzbG90LiIpICsKICAgICAgICAiPHE+QWxsIHlvdSBoYWQgdG8gZG8gd2FzIGFzay48L3E+IiwKICAgICAgWzEsIDddCiAgICApOwogICAgR2FtZS5sYXN0LmNsaWNrRnVuY3Rpb24gPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICghR2FtZS5IYXNBY2hpZXYoIkhlcmUgeW91IGdvIikpIHsKICAgICAgICBQbGF5U291bmQoInNuZC90aWNrLm1wMyIpOwogICAgICAgIEdhbWUuV2luKCJIZXJlIHlvdSBnbyIpOwogICAgICB9CiAgICB9OwoKICAgIG9yZGVyID0gMzAwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlJlc3VycmVjdGlvbiIsCiAgICAgIGxvYygiQXNjZW5kIDxiPiUxIHRpbWVzPC9iPi4iLCAxMCksCiAgICAgIFsyMSwgNl0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlJlaW5jYXJuYXRpb24iLAogICAgICBsb2MoIkFzY2VuZCA8Yj4lMSB0aW1lczwvYj4uIiwgMTAwKSwKICAgICAgWzIxLCA2XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiRW5kbGVzcyBjeWNsZSIsCiAgICAgIGxvYygiQXNjZW5kIDxiPiUxIHRpbWVzPC9iPi4iLCAxMDAwKSArICI8cT5PaCBoZXksIGl0J3MgeW91IGFnYWluLjwvcT4iLAogICAgICBbMiwgN10KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJzaGFkb3ciOwoKICAgIG9yZGVyID0gMTEwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlRoZSBhZ2VtYXN0ZXIiLCAiIiwgIkdyYW5kbWEiLCA3KTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlRvIG9sZGx5IGdvIiwgIiIsICJHcmFuZG1hIiwgOCk7CgogICAgb3JkZXIgPSAxMjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiR2FyZGVuZXIgZXh0cmFvcmRpbmFpcmUiLCAiIiwgIkZhcm0iLCA2KTsKICAgIG9yZGVyID0gMTMwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlRlY3RvbmljIGFtYmFzc2Fkb3IiLCAiIiwgIk1pbmUiLCA2KTsKICAgIG9yZGVyID0gMTQwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlJpc2Ugb2YgdGhlIG1hY2hpbmVzIiwgIiIsICJGYWN0b3J5IiwgNik7CiAgICBvcmRlciA9IDE0MjU7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJBY3F1aXJlIGN1cnJlbmN5IiwgIiIsICJCYW5rIiwgNik7CiAgICBvcmRlciA9IDE0NTA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJaZWFsb3RyeSIsICIiLCAiVGVtcGxlIiwgNik7CiAgICBvcmRlciA9IDE0NzU7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJUaGUgd2l6YXJkaW5nIHdvcmxkIiwgIiIsICJXaXphcmQgdG93ZXIiLCA2KTsKICAgIG9yZGVyID0gMTUwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlBhcnNlYy1tYXNoZXIiLCAiIiwgIlNoaXBtZW50IiwgNik7CiAgICBvcmRlciA9IDE2MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJUaGUgd29yayBvZiBhIGxpZmV0aW1lIiwgIiIsICJBbGNoZW15IGxhYiIsIDYpOwogICAgb3JkZXIgPSAxNzAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiQSBwbGFjZSBsb3N0IGluIHRpbWUiLCAiIiwgIlBvcnRhbCIsIDYpOwogICAgb3JkZXIgPSAxODAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiSGVhdCBkZWF0aCIsICIiLCAiVGltZSBtYWNoaW5lIiwgNik7CiAgICBvcmRlciA9IDE5MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJNaWNyb2Nvc20iLCAiIiwgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwgNik7CiAgICBvcmRlciA9IDIwMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJCcmlnaHQgZnV0dXJlIiwgIiIsICJQcmlzbSIsIDYpOwoKICAgIG9yZGVyID0gMjUwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkhlcmUgYmUgZHJhZ29uIiwKICAgICAgbG9jKCJDb21wbGV0ZSB5b3VyIDxiPmRyYWdvbidzIHRyYWluaW5nPC9iPi4iKSwKICAgICAgWzIxLCAxMl0KICAgICk7CgogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIkhvdz8iKTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJUaGUgbGFuZCBvZiBtaWxrIGFuZCBjb29raWVzIik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgKICAgICAgIkhlIHdobyBjb250cm9scyB0aGUgY29va2llcyBjb250cm9scyB0aGUgdW5pdmVyc2UiLAogICAgICAiVGhlIG1pbGsgbXVzdCBmbG93ISIKICAgICk7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiVG9uaWdodCBvbiBIb2FyZGVycyIpOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIkFyZSB5b3UgZ29ubmEgZWF0IGFsbCB0aGF0PyIpOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIldlJ3JlIGdvbm5hIG5lZWQgYSBiaWdnZXIgYmFrZXJ5Iik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgKICAgICAgIkluIHRoZSBtb3V0aCBvZiBtYWRuZXNzIiwKICAgICAgIkEgY29va2llIGlzIGp1c3Qgd2hhdCB3ZSB0ZWxsIGVhY2ggb3RoZXIgaXQgaXMuIgogICAgKTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KAogICAgICAnQnJvdWdodCB0byB5b3UgYnkgdGhlIGxldHRlciA8ZGl2IHN0eWxlPSJkaXNwbGF5OmlubGluZS1ibG9jaztiYWNrZ3JvdW5kOnVybChpbWcvbW9uZXkucG5nKTt3aWR0aDoxNnB4O2hlaWdodDoxNnB4OyI+PC9kaXY+JwogICAgKTsKCiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJBIHdvcmxkIGZpbGxlZCB3aXRoIGNvb2tpZXMiKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoCiAgICAgICJXaGVuIHRoaXMgYmFieSBoaXRzICIgKwogICAgICAgIEJlYXV0aWZ5KDEwMDAwMDAwMDAwMDAwICogNjAgKiA2MCkgKwogICAgICAgICIgY29va2llcyBwZXIgaG91ciIKICAgICk7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJGYXN0IGFuZCBkZWxpY2lvdXMiKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoCiAgICAgICJDb29raWVoZXJ0eiA6IGEgcmVhbGx5LCByZWFsbHkgdGFzdHkgaGVydHoiLAogICAgICAiVGFzdGllciB0aGFuIGEgaGVydHogZG9udXQsIGFueXdheS4iCiAgICApOwogICAgR2FtZS5DcHNBY2hpZXZlbWVudCgiV29vcHMsIHlvdSBzb2x2ZWQgd29ybGQgaHVuZ2VyIik7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KAogICAgICAiVHVyYm9wdW5zIiwKICAgICAgJ01vdGhlciBOYXR1cmUgd2lsbCBiZSBsaWtlICJzbG93d3d3dyBkb3d3d3d3biIuJwogICAgKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIkZhc3RlciBtZW5uZXIiKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIkFuZCB5ZXQgeW91J3JlIHN0aWxsIGh1bmdyeSIpOwogICAgR2FtZS5DcHNBY2hpZXZlbWVudCgiVGhlIEFiYWtlbmluZyIpOwogICAgR2FtZS5DcHNBY2hpZXZlbWVudCgKICAgICAgIlRoZXJlJ3MgcmVhbGx5IG5vIGhhcmQgbGltaXQgdG8gaG93IGxvbmcgdGhlc2UgYWNoaWV2ZW1lbnQgbmFtZXMgY2FuIGJlIGFuZCB0byBiZSBxdWl0ZSBob25lc3QgSSdtIHJhdGhlciBjdXJpb3VzIHRvIHNlZSBob3cgZmFyIHdlIGNhbiBnby48YnI+QWRvbHBodXMgVy4gR3JlZW4gKDE4NDTigJMxOTE3KSBzdGFydGVkIGFzIHRoZSBQcmluY2lwYWwgb2YgdGhlIEdyb3RvbiBTY2hvb2wgaW4gMTg2NC4gQnkgMTg2NSwgaGUgYmVjYW1lIHNlY29uZCBhc3Npc3RhbnQgbGlicmFyaWFuIGF0IHRoZSBOZXcgWW9yayBNZXJjYW50aWxlIExpYnJhcnk7IGZyb20gMTg2NyB0byAxODY5LCBoZSB3YXMgcHJvbW90ZWQgdG8gZnVsbCBsaWJyYXJpYW4uIEZyb20gMTg2OSB0byAxODczLCBoZSB3b3JrZWQgZm9yIEV2YXJ0cywgU291dGhtYXlkICYgQ2hvYXRlLCBhIGxhdyBmaXJtIGNvLWZvdW5kZWQgYnkgV2lsbGlhbSBNLiBFdmFydHMsIENoYXJsZXMgRmVyZGluYW5kIFNvdXRobWF5ZCBhbmQgSm9zZXBoIEhvZGdlcyBDaG9hdGUuIEhlIHdhcyBhZG1pdHRlZCB0byB0aGUgTmV3IFlvcmsgU3RhdGUgQmFyIEFzc29jaWF0aW9uIGluIDE4NzMuPGJyPkFueXdheSwgaG93J3MgeW91ciBkYXkgYmVlbj8iCiAgICApOyAvL0dhbWUubGFzdC5zaG9ydE5hbWU9J1RoZXJlXCdzIHJlYWxseSBubyBoYXJkIGxpbWl0IHRvIGhvdyBsb25nIHRoZXNlIGFjaGlldmVtZW50IG5hbWVzIGNhbiBiZSBhbmQgdG8gYmUgcXVpdGUgaG9uZXN0IElcJ20gWy4uLl0nOwogICAgR2FtZS5DcHNBY2hpZXZlbWVudCgiRmFzdCIsICJXb3chIik7CgogICAgb3JkZXIgPSA3MDAyOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJCaWNlbnRlbm5pYWwgYW5kIGEgaGFsZiIsCiAgICAgIGxvYygiSGF2ZSBhdCBsZWFzdCA8Yj4lMSBvZiBldmVyeXRoaW5nPC9iPi4iLCAyNTApICsKICAgICAgICAiPHE+S2VlcCBvbiB0cnVja2luJy48L3E+IiwKICAgICAgWzksIDZdCiAgICApOwoKICAgIG9yZGVyID0gMTEwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlRhYmxvaWQgYWRkaWN0aW9uIiwKICAgICAgbG9jKCJDbGljayBvbiB0aGUgbmV3cyB0aWNrZXIgPGI+JTEgdGltZXM8L2I+LiIsIDUwKSArCiAgICAgICAgIjxxPlBhZ2UgNjogTWFkIGluZGl2aWR1YWwgY2xpY2tzIG9uIHBpY3R1cmUgb2YgcGFzdHJ5IGluIGEgZnV0aWxlIGF0dGVtcHQgdG8gZXNjYXBlIGJvcmVkb20hPGJyPkFsc28gcGFnZSA2OiBCcml0aXNoIHBhcmxpYW1lbnQgYXRlIG15IGJhYnkhPC9xPiIsCiAgICAgIFsyNywgN10KICAgICk7CgogICAgb3JkZXIgPSAxMDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJDbGlja2FzdHJvcGhlIiwKICAgICAgbG9jKCJNYWtlIDxiPiUxPC9iPiBmcm9tIGNsaWNraW5nLiIsIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KDFlMTcpKSksCiAgICAgIFsxMSwgMTddCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJDbGlja2F0YWNseXNtIiwKICAgICAgbG9jKCJNYWtlIDxiPiUxPC9iPiBmcm9tIGNsaWNraW5nLiIsIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KDFlMTkpKSksCiAgICAgIFsxMSwgMThdCiAgICApOwoKICAgIG9yZGVyID0gMTA1MDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiVGh1bWJzLCBwaGFsYW5nZXMsIG1ldGFjYXJwYWxzIiwKICAgICAgbG9jKCJIYXZlIDxiPiUxPC9iPi4iLCBsb2MoIiUxIGN1cnNvciIsIExCZWF1dGlmeSg1MDApKSkgKwogICAgICAgICI8cT4mIEtOVUNLTEVTPC9xPiIsCiAgICAgIFswLCAxNV0KICAgICk7CgogICAgb3JkZXIgPSA2MDAyOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJQb2x5bWF0aCIsCiAgICAgIGxvYygiT3duIDxiPiUxPC9iPiB1cGdyYWRlcyBhbmQgPGI+JTI8L2I+IGJ1aWxkaW5ncy4iLCBbMzAwLCA0MDAwXSkgKwogICAgICAgICI8cT5FeGNlbGxlbmNlIGRvZXNuJ3QgaGFwcGVuIG92ZXJuaWdodCAtIGl0IHVzdWFsbHkgdGFrZXMgYSBnb29kIGNvdXBsZSBkYXlzLjwvcT4iLAogICAgICBbMjksIDddCiAgICApOwoKICAgIG9yZGVyID0gMTA5OTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiVGhlIGVsZGVyIHNjcm9sbHMiLAogICAgICBsb2MoIk93biBhIGNvbWJpbmVkIDxiPiUxPC9iPiAlMiBhbmQgJTMuIiwgWwogICAgICAgIDc3NywKICAgICAgICBsb2MoImdyYW5kbWFzIiksCiAgICAgICAgbG9jKCJjdXJzb3JzIiksCiAgICAgIF0pICsgIjxxPkxldCBtZSBndWVzcy4gU29tZW9uZSBzdG9sZSB5b3VyIGNvb2tpZS48L3E+IiwKICAgICAgWzEwLCA5XQogICAgKTsKCiAgICBvcmRlciA9IDMwMDUwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJUbyBjcnVtYnMsIHlvdSBzYXk/IiwKICAgICAgbG9jKCJBc2NlbmQgd2l0aCA8Yj4lMTwvYj4gYmFrZWQuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUzMykpKSArCiAgICAgICAgIjxxPlZlcnkgd2VsbCB0aGVuLjwvcT4iLAogICAgICBbMjksIDZdCiAgICApOwoKICAgIG9yZGVyID0gMTIwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlNlZWR5IGJ1c2luZXNzIiwgIiIsICJGYXJtIiwgNyk7CiAgICBvcmRlciA9IDEzMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJGcmVhayBmcmFja2luZyIsICIiLCAiTWluZSIsIDcpOwogICAgb3JkZXIgPSAxNDAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTW9kZXJuIHRpbWVzIiwgIiIsICJGYWN0b3J5IiwgNyk7CiAgICBvcmRlciA9IDE0MjU7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJUaGUgbmVydmUgb2Ygd2FyIiwgIiIsICJCYW5rIiwgNyk7CiAgICBvcmRlciA9IDE0NTA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJXb2xvbG8iLCAiIiwgIlRlbXBsZSIsIDcpOwogICAgb3JkZXIgPSAxNDc1OwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIkFuZCBub3cgZm9yIG15IG5leHQgdHJpY2ssIEknbGwgbmVlZCBhIHZvbHVudGVlciBmcm9tIHRoZSBhdWRpZW5jZSIsCiAgICAgICIiLAogICAgICAiV2l6YXJkIHRvd2VyIiwKICAgICAgNwogICAgKTsKICAgIG9yZGVyID0gMTUwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkl0J3Mgbm90IGRlbGl2ZXJ5IiwgIiIsICJTaGlwbWVudCIsIDcpOwogICAgb3JkZXIgPSAxNjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiR29sZCwgSmVycnkhIEdvbGQhIiwgIiIsICJBbGNoZW15IGxhYiIsIDcpOwogICAgb3JkZXIgPSAxNzAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiRm9yYmlkZGVuIHpvbmUiLCAiIiwgIlBvcnRhbCIsIDcpOwogICAgb3JkZXIgPSAxODAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgImNvb2tpZSBjbGlja2VyIGZvcmV2ZXIgYW5kIGZvcmV2ZXIgYSBodW5kcmVkIHllYXJzIGNvb2tpZSBjbGlja2VyLCBhbGwgZGF5IGxvbmcgZm9yZXZlciwgZm9yZXZlciBhIGh1bmRyZWQgdGltZXMsIG92ZXIgYW5kIG92ZXIgY29va2llIGNsaWNrZXIgYWR2ZW50dXJlcyBkb3QgY29tIiwKICAgICAgIiIsCiAgICAgICJUaW1lIG1hY2hpbmUiLAogICAgICA3CiAgICApOwogICAgb3JkZXIgPSAxOTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIlNjaWVudGlzdHMgYmFmZmxlZCBldmVyeXdoZXJlIiwKICAgICAgIiIsCiAgICAgICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsCiAgICAgIDcKICAgICk7CiAgICBvcmRlciA9IDIwMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJIYXJtb255IG9mIHRoZSBzcGhlcmVzIiwgIiIsICJQcmlzbSIsIDcpOwoKICAgIG9yZGVyID0gMzUwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkxhc3QgQ2hhbmNlIHRvIFNlZSIsCiAgICAgIGxvYygiQnVyc3QgdGhlIG5lYXItZXh0aW5jdCA8Yj5zaGlueSB3cmlua2xlcjwvYj4uIikgKwogICAgICAgICI8cT5Zb3UgbW9uc3RlciE8L3E+IiwKICAgICAgWzI0LCAxMl0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJzaGFkb3ciOwoKICAgIG9yZGVyID0gMTAwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkVhcmx5IGJpcmQiLAogICAgICBsb2MoIkNsaWNrIGEgZ29sZGVuIGNvb2tpZSA8Yj5sZXNzIHRoYW4gMSBzZWNvbmQgYWZ0ZXIgaXQgc3Bhd25zPC9iPi4iKSwKICAgICAgWzEwLCAxNF0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkZhZGluZyBsdWNrIiwKICAgICAgbG9jKCJDbGljayBhIGdvbGRlbiBjb29raWUgPGI+bGVzcyB0aGFuIDEgc2Vjb25kIGJlZm9yZSBpdCBkaWVzPC9iPi4iKSwKICAgICAgWzEwLCAxNF0KICAgICk7CgogICAgb3JkZXIgPSAyMjEwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiRWxkZWVyIiwKICAgICAgbG9jKCJQb3AgYSByZWluZGVlciA8Yj5kdXJpbmcgYW4gZWxkZXIgZnJlbnp5PC9iPi4iKSwKICAgICAgWzEyLCA5XQogICAgKTsKCiAgICBvcmRlciA9IDIxMTAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJEdWRlLCBzd2VldCIsCiAgICAgIGxvYygiSGFydmVzdCA8Yj4lMSBjb2FsZXNjaW5nIHN1Z2FyIGx1bXBzPC9iPi4iLCA3KSwKICAgICAgWzI0LCAxNF0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlN1Z2FyIHJ1c2giLAogICAgICBsb2MoIkhhcnZlc3QgPGI+JTEgY29hbGVzY2luZyBzdWdhciBsdW1wczwvYj4uIiwgMzApLAogICAgICBbMjYsIDE0XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiWWVhcidzIHdvcnRoIG9mIGNhdml0aWVzIiwKICAgICAgbG9jKCJIYXJ2ZXN0IDxiPiUxIGNvYWxlc2Npbmcgc3VnYXIgbHVtcHM8L2I+LiIsIDM2NSkgKwogICAgICAgICI8cT5NeSBsdW1wcyBteSBsdW1wcyBteSBsdW1wcy48L3E+IiwKICAgICAgWzI5LCAxNF0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkhhbmQtcGlja2VkIiwKICAgICAgbG9jKCJTdWNjZXNzZnVsbHkgaGFydmVzdCBhIGNvYWxlc2Npbmcgc3VnYXIgbHVtcCBiZWZvcmUgaXQncyByaXBlLiIpLAogICAgICBbMjgsIDE0XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiU3VnYXIgc3VnYXIiLAogICAgICBsb2MoIkhhcnZlc3QgYSA8Yj5iaWZ1cmNhdGVkIHN1Z2FyIGx1bXA8L2I+LiIpLAogICAgICBbMjksIDE1XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQWxsLW5hdHVyYWwgY2FuZSBzdWdhciIsCiAgICAgIGxvYygiSGFydmVzdCBhIDxiPmdvbGRlbiBzdWdhciBsdW1wPC9iPi4iKSwKICAgICAgWzI5LCAxNl0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJzaGFkb3ciOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJTd2VldG1lYXRzIiwKICAgICAgbG9jKCJIYXJ2ZXN0IGEgPGI+bWVhdHkgc3VnYXIgbHVtcDwvYj4uIiksCiAgICAgIFsyOSwgMTddCiAgICApOwoKICAgIG9yZGVyID0gNzAwMjsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiVHJpY2VudGVubmlhbCIsCiAgICAgIGxvYygiSGF2ZSBhdCBsZWFzdCA8Yj4lMSBvZiBldmVyeXRoaW5nPC9iPi4iLCAzMDApICsKICAgICAgICAiPHE+Q2FuJ3Qgc3RvcCwgd29uJ3Qgc3RvcC4gUHJvYmFibHkgc2hvdWxkIHN0b3AsIHRob3VnaC48L3E+IiwKICAgICAgWzI5LCAxMl0KICAgICk7CgogICAgR2FtZS5DcHNBY2hpZXZlbWVudCgiS25lYWQgZm9yIHNwZWVkIiwgIkhvdyBkaWQgd2Ugbm90IG1ha2UgdGhhdCBvbmUgeWV0PyIpOwogICAgR2FtZS5DcHNBY2hpZXZlbWVudCgKICAgICAgIldlbGwgdGhlIGNvb2tpZXMgc3RhcnQgY29taW5nIGFuZCB0aGV5IGRvbid0IHN0b3AgY29taW5nIiwKICAgICAgIkRpZG4ndCBtYWtlIHNlbnNlIG5vdCB0byBjbGljayBmb3IgZnVuLiIKICAgICk7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KAogICAgICAiSSBkb24ndCBrbm93IGlmIHlvdSd2ZSBub3RpY2VkIGJ1dCBhbGwgdGhlc2UgaWNvbnMgYXJlIHZlcnkgc2xpZ2h0bHkgb2ZmLWNlbnRlciIKICAgICk7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KAogICAgICAiVGhlIHByb29mIG9mIHRoZSBjb29raWUgaXMgaW4gdGhlIGJha2luZyIsCiAgICAgICJIb3cgY2FuIHlvdSBoYXZlIGFueSBjb29raWVzIGlmIHlvdSBkb24ndCBiYWtlIHlvdXIgZG91Z2g/IgogICAgKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIklmIGl0J3Mgd29ydGggZG9pbmcsIGl0J3Mgd29ydGggb3ZlcmRvaW5nIik7CgogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoCiAgICAgICJUaGUgZHJlYW1zIGluIHdoaWNoIEknbSBiYWtpbmcgYXJlIHRoZSBiZXN0IEkndmUgZXZlciBoYWQiCiAgICApOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIlNldCBmb3IgbGlmZSIpOwoKICAgIG9yZGVyID0gMTIwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIllvdSBhbmQgdGhlIGJlYW5zdGFsayIsICIiLCAiRmFybSIsIDgpOwogICAgb3JkZXIgPSAxMzAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiUm9tYW5jaW5nIHRoZSBzdG9uZSIsICIiLCAiTWluZSIsIDgpOwogICAgb3JkZXIgPSAxNDAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiRXggbWFjaGluYSIsICIiLCAiRmFjdG9yeSIsIDgpOwogICAgb3JkZXIgPSAxNDI1OwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiQW5kIEkgbmVlZCBpdCBub3ciLCAiIiwgIkJhbmsiLCA4KTsKICAgIG9yZGVyID0gMTQ1MDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlByYXkgb24gdGhlIHdlYWsiLCAiIiwgIlRlbXBsZSIsIDgpOwogICAgb3JkZXIgPSAxNDc1OwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiSXQncyBhIGtpbmQgb2YgbWFnaWMiLCAiIiwgIldpemFyZCB0b3dlciIsIDgpOwogICAgb3JkZXIgPSAxNTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTWFrZSBpdCBzbyIsICIiLCAiU2hpcG1lbnQiLCA4KTsKICAgIG9yZGVyID0gMTYwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkFsbCB0aGF0IGdsaXR0ZXJzIGlzIGdvbGQiLCAiIiwgIkFsY2hlbXkgbGFiIiwgOCk7CiAgICBvcmRlciA9IDE3MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJIzaHMuMy3zZPMs8yzzK/Mn82VzJ/Njc2NzKNlzaHMos2YzLDMpsywzLrMrsydzZbNlsyYzKrNiSDNmMygzKbNlcykzKrMnc2FzKXMsMygzKvMlsyjzZnMrEPMqMymzLrMqcyyzKXNicytzZrMnMy7zJ3Mo8y8zZnMrsyvzKpvzKHMtM2ezaHNh8yYzY7MnsyyzYfMpsyybcy4zZjMqcy6zJ3Mo8y5zYXMsc2azKzMpcyrzLPMvMyezJjMr2XNosyVzYHMo82HzLrMnHPNmM2YzLbNnsyZzJ/MscylzK7Mr8ywzKbNk82HzZbNlsydIiwgIiIsICJQb3J0YWwiLCA4KTsKICAgIG9yZGVyID0gMTgwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIldheSBiYWNrIHRoZW4iLCAiIiwgIlRpbWUgbWFjaGluZSIsIDgpOwogICAgb3JkZXIgPSAxOTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiRXhvdGljIG1hdHRlciIsICIiLCAiQW50aW1hdHRlciBjb25kZW5zZXIiLCA4KTsKICAgIG9yZGVyID0gMjAwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkF0IHRoZSBlbmQgb2YgdGhlIHR1bm5lbCIsICIiLCAiUHJpc20iLCA4KTsKCiAgICBvcmRlciA9IDEwNzA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgKICAgICAgIkNsaWNrIChzdGFycmluZyBBZGFtIFNhbmRsZXIpIiwKICAgICAgIkN1cnNvciIsCiAgICAgIDMsCiAgICAgIDAsCiAgICAgIDcKICAgICk7CiAgICBvcmRlciA9IDExMjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiRnJhbnRpcXVpdGllcyIsICJHcmFuZG1hIiwgMywgMCwgNik7CiAgICBvcmRlciA9IDEyMjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiT3Zlcmdyb3d0aCIsICJGYXJtIiwgMyk7CiAgICBvcmRlciA9IDEzMjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiU2VkaW1lbnRhbGlzbSIsICJNaW5lIiwgMyk7CiAgICBvcmRlciA9IDE0MjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiTGFib3Igb2YgbG92ZSIsICJGYWN0b3J5IiwgMyk7CiAgICBvcmRlciA9IDE0NDU7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiUmV2ZXJzZSBmdW5uZWwgc3lzdGVtIiwgIkJhbmsiLCAzKTsKICAgIG9yZGVyID0gMTQ3MDsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJUaHVzIHNwb2tlIHlvdSIsICJUZW1wbGUiLCAzKTsKICAgIG9yZGVyID0gMTQ5NTsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJNYW5hZmVzdCBkZXN0aW55IiwgIldpemFyZCB0b3dlciIsIDMpOwogICAgb3JkZXIgPSAxNTIwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoCiAgICAgICJOZWl0aGVyIHNub3cgbm9yIHJhaW4gbm9yIGhlYXQgbm9yIGdsb29tIG9mIG5pZ2h0IiwKICAgICAgIlNoaXBtZW50IiwKICAgICAgMwogICAgKTsKICAgIG9yZGVyID0gMTYyMDsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJJJ3ZlIGdvdCB0aGUgTWlkYXMgdG91Y2giLCAiQWxjaGVteSBsYWIiLCAzKTsKICAgIG9yZGVyID0gMTcyMDsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJXaGljaCBldGVybmFsIGxpZSIsICJQb3J0YWwiLCAzKTsKICAgIG9yZGVyID0gMTgyMDsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJEJmVhY3V0ZTtqJmFncmF2ZTsgdnUiLCAiVGltZSBtYWNoaW5lIiwgMyk7CiAgICBvcmRlciA9IDE5MjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiUG93ZXJzIG9mIFRlbiIsICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsIDMpOwogICAgb3JkZXIgPSAyMDIwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIk5vdyB0aGUgZGFyayBkYXlzIGFyZSBnb25lIiwgIlByaXNtIiwgMyk7CgogICAgb3JkZXIgPSAxMDcwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoIkZyZWFreSBqYXp6IGhhbmRzIiwgIiIsIFswLCAyNl0pOwogICAgR2FtZS5PYmplY3RzWyJDdXJzb3IiXS5sZXZlbEFjaGlldjEwID0gR2FtZS5sYXN0OwogICAgb3JkZXIgPSAxMTIwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoIk1ldGh1c2VsYWgiLCAiIiwgWzEsIDI2XSk7CiAgICBHYW1lLk9iamVjdHNbIkdyYW5kbWEiXS5sZXZlbEFjaGlldjEwID0gR2FtZS5sYXN0OwogICAgb3JkZXIgPSAxMjIwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoIkh1Z2UgdHJhY3RzIG9mIGxhbmQiLCAiIiwgWzIsIDI2XSk7CiAgICBHYW1lLk9iamVjdHNbIkZhcm0iXS5sZXZlbEFjaGlldjEwID0gR2FtZS5sYXN0OwogICAgb3JkZXIgPSAxMzIwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoIkQtZC1kLWQtZGVlcGVyIiwgIiIsIFszLCAyNl0pOwogICAgR2FtZS5PYmplY3RzWyJNaW5lIl0ubGV2ZWxBY2hpZXYxMCA9IEdhbWUubGFzdDsKICAgIG9yZGVyID0gMTQyMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KCJQYXRlbnRseSBnZW5pdXMiLCAiIiwgWzQsIDI2XSk7CiAgICBHYW1lLk9iamVjdHNbIkZhY3RvcnkiXS5sZXZlbEFjaGlldjEwID0gR2FtZS5sYXN0OwogICAgb3JkZXIgPSAxNDQ1OwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoIkEgY2FwaXRhbCBpZGVhIiwgIiIsIFsxNSwgMjZdKTsKICAgIEdhbWUuT2JqZWN0c1siQmFuayJdLmxldmVsQWNoaWV2MTAgPSBHYW1lLmxhc3Q7CiAgICBvcmRlciA9IDE0NzA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgiSXQgYmVsb25ncyBpbiBhIGJha2VyeSIsICIiLCBbMTYsIDI2XSk7CiAgICBHYW1lLk9iamVjdHNbIlRlbXBsZSJdLmxldmVsQWNoaWV2MTAgPSBHYW1lLmxhc3Q7CiAgICBvcmRlciA9IDE0OTU7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgiTW90b3Jtb3V0aCIsICIiLCBbMTcsIDI2XSk7CiAgICBHYW1lLk9iamVjdHNbIldpemFyZCB0b3dlciJdLmxldmVsQWNoaWV2MTAgPSBHYW1lLmxhc3Q7CiAgICBvcmRlciA9IDE1MjA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgiQmVlbiB0aGVyZSBkb25lIHRoYXQiLCAiIiwgWzUsIDI2XSk7CiAgICBHYW1lLk9iamVjdHNbIlNoaXBtZW50Il0ubGV2ZWxBY2hpZXYxMCA9IEdhbWUubGFzdDsKICAgIG9yZGVyID0gMTYyMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KCJQaGxvZ2lzdGljYXRlZCBzdWJzdGFuY2VzIiwgIiIsIFs2LCAyNl0pOwogICAgR2FtZS5PYmplY3RzWyJBbGNoZW15IGxhYiJdLmxldmVsQWNoaWV2MTAgPSBHYW1lLmxhc3Q7CiAgICBvcmRlciA9IDE3MjA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgiQml6YXJybyB3b3JsZCIsICIiLCBbNywgMjZdKTsKICAgIEdhbWUuT2JqZWN0c1siUG9ydGFsIl0ubGV2ZWxBY2hpZXYxMCA9IEdhbWUubGFzdDsKICAgIG9yZGVyID0gMTgyMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KCJUaGUgbG9uZyBub3ciLCAiIiwgWzgsIDI2XSk7CiAgICBHYW1lLk9iamVjdHNbIlRpbWUgbWFjaGluZSJdLmxldmVsQWNoaWV2MTAgPSBHYW1lLmxhc3Q7CiAgICBvcmRlciA9IDE5MjA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgiQ2h1YmJ5IGhhZHJvbnMiLCAiIiwgWzEzLCAyNl0pOwogICAgR2FtZS5PYmplY3RzWyJBbnRpbWF0dGVyIGNvbmRlbnNlciJdLmxldmVsQWNoaWV2MTAgPSBHYW1lLmxhc3Q7CiAgICBvcmRlciA9IDIwMjA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgiUGFsZXR0YWJsZSIsICIiLCBbMTQsIDI2XSk7CiAgICBHYW1lLk9iamVjdHNbIlByaXNtIl0ubGV2ZWxBY2hpZXYxMCA9IEdhbWUubGFzdDsKCiAgICBvcmRlciA9IDYxNDcwOwogICAgb3JkZXIgPSA2MTQ5NTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQmliYmlkaS1ib2JiaWRpLWJvbyIsCiAgICAgIGxvYygiQ2FzdCA8Yj4lMTwvYj4gc3BlbGxzLiIsIDkpLAogICAgICBbMjEsIDExXQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiSSdtIHRoZSB3aXoiLAogICAgICBsb2MoIkNhc3QgPGI+JTE8L2I+IHNwZWxscy4iLCA5OSksCiAgICAgIFsyMiwgMTFdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJBIHdpemFyZCBpcyB5b3UiLAogICAgICBsb2MoIkNhc3QgPGI+JTE8L2I+IHNwZWxscy4iLCA5OTkpICsgIjxxPkknbSBhIHdoYXQ/PC9xPiIsCiAgICAgIFsyOSwgMTFdCiAgICApOwoKICAgIG9yZGVyID0gMTAwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkZvdXItbGVhZiBjb29raWUiLAogICAgICBsb2MoIkhhdmUgPGI+JTE8L2I+IGdvbGRlbiBjb29raWVzIHNpbXVsdGFuZW91c2x5LiIsIDQpICsKICAgICAgICAiPHE+RmFpcmx5IHJhcmUsIGNvbnNpZGVyaW5nIGNvb2tpZXMgZG9uJ3QgZXZlbiBoYXZlIGxlYXZlcy48L3E+IiwKICAgICAgWzI3LCA2XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInNoYWRvdyI7CgogICAgb3JkZXIgPSAyMTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTHVja2VkIG91dCIsICIiLCAiQ2hhbmNlbWFrZXIiLCAxKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIldoYXQgYXJlIHRoZSBvZGRzIiwgIiIsICJDaGFuY2VtYWtlciIsIDIpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIkdyYW5kbWEgbmVlZHMgYSBuZXcgcGFpciBvZiBzaG9lcyIsCiAgICAgICIiLAogICAgICAiQ2hhbmNlbWFrZXIiLAogICAgICAzCiAgICApOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTWlsbGlvbiB0byBvbmUgc2hvdCwgZG9jIiwgIiIsICJDaGFuY2VtYWtlciIsIDQpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiQXMgbHVjayB3b3VsZCBoYXZlIGl0IiwgIiIsICJDaGFuY2VtYWtlciIsIDUpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiRXZlciBpbiB5b3VyIGZhdm9yIiwgIiIsICJDaGFuY2VtYWtlciIsIDYpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiQmUgYSBsYWR5IiwgIiIsICJDaGFuY2VtYWtlciIsIDcpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiRGljZXkgYnVzaW5lc3MiLCAiIiwgIkNoYW5jZW1ha2VyIiwgOCk7CgogICAgb3JkZXIgPSAyMTIwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIkZpbmdlcnMgY3Jvc3NlZCIsICJDaGFuY2VtYWtlciIsIDEpOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIkp1c3QgYSBzdGF0aXN0aWMiLCAiQ2hhbmNlbWFrZXIiLCAyKTsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJNdXJwaHkncyB3aWxkIGd1ZXNzIiwgIkNoYW5jZW1ha2VyIiwgMyk7CgogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoIkxldCdzIGxlYWYgaXQgYXQgdGhhdCIsICIiLCBbMTksIDI2XSk7CiAgICBHYW1lLk9iamVjdHNbIkNoYW5jZW1ha2VyIl0ubGV2ZWxBY2hpZXYxMCA9IEdhbWUubGFzdDsKCiAgICBvcmRlciA9IDEwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlRoZSB1bHRpbWF0ZSBjbGlja2Rvd24iLAogICAgICBsb2MoIk1ha2UgPGI+JTE8L2I+IGZyb20gY2xpY2tpbmcuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUyMSkpKSArCiAgICAgICAgIjxxPihvZiB1bHRpbWF0ZSBkZXN0aW55Lik8L3E+IiwKICAgICAgWzExLCAxOV0KICAgICk7CgogICAgb3JkZXIgPSAxMTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiQWdlZCB3ZWxsIiwgIiIsICJHcmFuZG1hIiwgOSk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCIxMDFzdCBiaXJ0aGRheSIsICIiLCAiR3JhbmRtYSIsIDEwKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkJ1dCB3YWl0ICd0aWwgeW91IGdldCBvbGRlciIsICIiLCAiR3JhbmRtYSIsIDExKTsKICAgIG9yZGVyID0gMTIwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkhhcnZlc3QgbW9vbiIsICIiLCAiRmFybSIsIDkpOwogICAgb3JkZXIgPSAxMzAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTWluZT8iLCAiIiwgIk1pbmUiLCA5KTsKICAgIG9yZGVyID0gMTQwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkluIGZ1bGwgZ2VhciIsICIiLCAiRmFjdG9yeSIsIDkpOwogICAgb3JkZXIgPSAxNDI1OwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiVHJlYWNsZSB0YXJ0IGVjb25vbWljcyIsICIiLCAiQmFuayIsIDkpOwogICAgb3JkZXIgPSAxNDUwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiSG9seSBjb29raWVzLCBncmFuZG1hISIsICIiLCAiVGVtcGxlIiwgOSk7CiAgICBvcmRlciA9IDE0NzU7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KAogICAgICAiVGhlIFByZXN0aWdlIiwKICAgICAgIjxxPihVbnJlbGF0ZWQgdG8gdGhlIENvb2tpZSBDbGlja2VyIGZlYXR1cmUgb2YgdGhlIHNhbWUgbmFtZS4pPC9xPiIsCiAgICAgICJXaXphcmQgdG93ZXIiLAogICAgICA5CiAgICApOwogICAgb3JkZXIgPSAxNTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiVGhhdCdzIGp1c3QgcGVhbnV0cyB0byBzcGFjZSIsICIiLCAiU2hpcG1lbnQiLCA5KTsKICAgIG9yZGVyID0gMTYwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIldvcnRoIGl0cyB3ZWlnaHQgaW4gbGVhZCIsICIiLCAiQWxjaGVteSBsYWIiLCA5KTsKICAgIG9yZGVyID0gMTcwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJXaGF0IGhhcHBlbnMgaW4gdGhlIHZvcnRleCBzdGF5cyBpbiB0aGUgdm9ydGV4IiwKICAgICAgIiIsCiAgICAgICJQb3J0YWwiLAogICAgICA5CiAgICApOwogICAgb3JkZXIgPSAxODAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIkludml0ZWQgdG8geWVzdGVyZGF5J3MgcGFydHkiLAogICAgICAiIiwKICAgICAgIlRpbWUgbWFjaGluZSIsCiAgICAgIDkKICAgICk7CiAgICBvcmRlciA9IDE5MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJEb3duc2l6aW5nIiwgIiIsICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsIDkpOyAvL3RoZSB0cmFpbGVyIGdvdCBtZSByZWFsbHkgaHlwZWQgdXAgYnV0IGkndmUgcmVhZCBzb21lIHByZXR0eSBiYWQgcmV2aWV3cy4gaXMgaXQgd2F0Y2hhYmxlID8gaXMgaXQgd29ydGggc2VlaW5nID8gaSBkb24ndCBtaW5kIG1hdHQgZGFtb24KICAgIG9yZGVyID0gMjAwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIk15IGV5ZXMiLCAiIiwgIlByaXNtIiwgOSk7CiAgICBvcmRlciA9IDIxMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KAogICAgICAiTWF5YmUgYSBjaGFuY2UgaW4gaGVsbCwgYWN0dWFsbHkiLAogICAgICAiIiwKICAgICAgIkNoYW5jZW1ha2VyIiwKICAgICAgOQogICAgKTsKCiAgICBvcmRlciA9IDEyMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJNYWtlIGxpa2UgYSB0cmVlIiwgIiIsICJGYXJtIiwgMTApOwogICAgb3JkZXIgPSAxMzAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiQ2F2ZSBzdG9yeSIsICIiLCAiTWluZSIsIDEwKTsKICAgIG9yZGVyID0gMTQwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkluLWNvZy1uZWF0byIsICIiLCAiRmFjdG9yeSIsIDEwKTsKICAgIG9yZGVyID0gMTQyNTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJTYXZlIHlvdXIgYnJlYXRoIGJlY2F1c2UgdGhhdCdzIGFsbCB5b3UndmUgZ290IGxlZnQiLAogICAgICAiIiwKICAgICAgIkJhbmsiLAogICAgICAxMAogICAgKTsKICAgIG9yZGVyID0gMTQ1MDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlZlbmdlZnVsIGFuZCBhbG1pZ2h0eSIsICIiLCAiVGVtcGxlIiwgMTApOwogICAgb3JkZXIgPSAxNDc1OwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiU3BlbGwgaXQgb3V0IGZvciB5b3UiLCAiIiwgIldpemFyZCB0b3dlciIsIDEwKTsKICAgIG9yZGVyID0gMTUwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJTcGFjZSBzcGFjZSBzcGFjZSBzcGFjZSBzcGFjZSIsCiAgICAgICI8cT5JdCdzIHRvbyBmYXIgYXdheS4uLjwvcT4iLAogICAgICAiU2hpcG1lbnQiLAogICAgICAxMAogICAgKTsKICAgIG9yZGVyID0gMTYwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJEb24ndCBnZXQgdXNlZCB0byB5b3Vyc2VsZiwgeW91J3JlIGdvbm5hIGhhdmUgdG8gY2hhbmdlIiwKICAgICAgIiIsCiAgICAgICJBbGNoZW15IGxhYiIsCiAgICAgIDEwCiAgICApOwogICAgb3JkZXIgPSAxNzAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIk9iamVjdHMgaW4gdGhlIG1pcnJvciBkaW1lbnNpb24gYXJlIGNsb3NlciB0aGFuIHRoZXkgYXBwZWFyIiwKICAgICAgIiIsCiAgICAgICJQb3J0YWwiLAogICAgICAxMAogICAgKTsKICAgIG9yZGVyID0gMTgwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkdyb3VuZGhvZyBkYXkiLCAiIiwgIlRpbWUgbWFjaGluZSIsIDEwKTsKICAgIG9yZGVyID0gMTkwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJBIG1hdHRlciBvZiBwZXJzcGVjdGl2ZSIsCiAgICAgICIiLAogICAgICAiQW50aW1hdHRlciBjb25kZW5zZXIiLAogICAgICAxMAogICAgKTsKICAgIG9yZGVyID0gMjAwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIk9wdGljYWwgaWxsdXNpb24iLCAiIiwgIlByaXNtIiwgMTApOwogICAgb3JkZXIgPSAyMTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiSmFja3BvdCIsICIiLCAiQ2hhbmNlbWFrZXIiLCAxMCk7CgogICAgb3JkZXIgPSAzNjAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiU28gbXVjaCB0byBkbyBzbyBtdWNoIHRvIHNlZSIsCiAgICAgIGxvYygiTWFuYWdlIGEgY29va2llIGxlZ2FjeSBmb3IgPGI+YXQgbGVhc3QgYSB5ZWFyPC9iPi4iKSArCiAgICAgICAgIjxxPlRoYW5rIHlvdSBzbyBtdWNoIGZvciBwbGF5aW5nIENvb2tpZSBDbGlja2VyITwvcT4iLAogICAgICBbMjMsIDExXQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInNoYWRvdyI7CgogICAgR2FtZS5DcHNBY2hpZXZlbWVudCgiUnVubmluZyB3aXRoIHNjaXNzb3JzIik7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJSYXJlZmllZCBhaXIiKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIlB1c2ggaXQgdG8gdGhlIGxpbWl0Iik7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJHcmVlbiBjb29raWVzIHNsZWVwIGZ1cmlvdXNseSIpOwoKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJQYW5pYyEgYXQgTmFiaXNjbyIpOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIkJ1cnN0aW5nIGF0IHRoZSBzZWFtcyIpOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIkp1c3QgYWJvdXQgZnVsbCIpOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIkh1bmdyeSBmb3IgbW9yZSIpOwoKICAgIG9yZGVyID0gMTAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQWxsIHRoZSBvdGhlciBraWRzIHdpdGggdGhlIHB1bXBlZCB1cCBjbGlja3MiLAogICAgICBsb2MoIk1ha2UgPGI+JTE8L2I+IGZyb20gY2xpY2tpbmcuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUyMykpKSwKICAgICAgWzExLCAyOF0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIk9uZS4uLm1vcmUuLi5jbGljay4uLiIsCiAgICAgIGxvYygiTWFrZSA8Yj4lMTwvYj4gZnJvbSBjbGlja2luZy4iLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxZTI1KSkpLAogICAgICBbMTEsIDMwXQogICAgKTsKCiAgICBvcmRlciA9IDYxNTE1OwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJCb3RhbnkgZW50aHVzaWFzdCIsCiAgICAgIGxvYygiSGFydmVzdCA8Yj4lMTwvYj4gbWF0dXJlIGdhcmRlbiBwbGFudHMuIiwgMTAwKSwKICAgICAgWzI2LCAyMF0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkdyZWVuLCBhY2hpbmcgdGh1bWIiLAogICAgICBsb2MoIkhhcnZlc3QgPGI+JTE8L2I+IG1hdHVyZSBnYXJkZW4gcGxhbnRzLiIsIDEwMDApLAogICAgICBbMjcsIDIwXQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiSW4gdGhlIGdhcmRlbiBvZiBFZGVuIChiYWJ5KSIsCiAgICAgIGxvYygiRmlsbCBldmVyeSB0aWxlIG9mIHRoZSBiaWdnZXN0IGdhcmRlbiBwbG90IHdpdGggcGxhbnRzLiIpICsKICAgICAgICAiPHE+SXNuJ3QgdGVuZGluZyB0byB0aG9zZSBwcmVjaW91cyBsaXR0bGUgcGxhbnRzIGp1c3Qgc28gcm9jayBhbmQvb3Igcm9sbD88L3E+IiwKICAgICAgWzI4LCAyMF0KICAgICk7CgogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJLZWVwZXIgb2YgdGhlIGNvbnNlcnZhdG9yeSIsCiAgICAgIGxvYygiVW5sb2NrIGV2ZXJ5IGdhcmRlbiBzZWVkLiIpLAogICAgICBbMjUsIDIwXQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiU2VlZGxlc3MgdG8gbmF5IiwKICAgICAgbG9jKAogICAgICAgICdDb252ZXJ0IGEgY29tcGxldGUgc2VlZCBsb2cgaW50byBzdWdhciBsdW1wcyBieSBzYWNyaWZpY2luZyB5b3VyIGdhcmRlbiB0byB0aGUgc3VnYXIgaG9ybmV0cy48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj5Pd25pbmcgdGhpcyBhY2hpZXZlbWVudCBtYWtlcyBzZWVkcyA8Yj4lMSUgY2hlYXBlcjwvYj4sIHBsYW50cyBtYXR1cmUgPGI+JTIlIHNvb25lcjwvYj4sIGFuZCBwbGFudCB1cGdyYWRlcyBkcm9wIDxiPiUzJSBtb3JlPC9iPi4nLAogICAgICAgIFs1LCA1LCA1XQogICAgICApLAogICAgICBbMjksIDIwXQogICAgKTsKCiAgICBvcmRlciA9IDMwMDUwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJZb3UgZ2V0IG5vdGhpbmciLAogICAgICBsb2MoIkFzY2VuZCB3aXRoIDxiPiUxPC9iPiBiYWtlZC4iLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxZTM2KSkpICsKICAgICAgICAiPHE+R29vZCBkYXkgc2lyITwvcT4iLAogICAgICBbMjksIDZdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJIdW1ibGUgcmViZWdpbm5pbmdzIiwKICAgICAgbG9jKCJBc2NlbmQgd2l0aCA8Yj4lMTwvYj4gYmFrZWQuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUzOSkpKSArCiAgICAgICAgIjxxPlN0YXJ0ZWQgZnJvbSB0aGUgYm90dG9tLCBub3cgd2UncmUgaGVyZS48L3E+IiwKICAgICAgWzI5LCA2XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiVGhlIGVuZCBvZiB0aGUgd29ybGQiLAogICAgICBsb2MoIkFzY2VuZCB3aXRoIDxiPiUxPC9iPiBiYWtlZC4iLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxZTQyKSkpICsKICAgICAgICAiPHE+KGFzIHdlIGtub3cgaXQpPC9xPiIsCiAgICAgIFsyMSwgMjVdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJPaCwgeW91J3JlIGJhY2siLAogICAgICBsb2MoIkFzY2VuZCB3aXRoIDxiPiUxPC9iPiBiYWtlZC4iLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxZTQ1KSkpICsKICAgICAgICAiPHE+TWlzc2VkIHVzPzwvcT4iLAogICAgICBbMjEsIDI1XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiTGF6YXJ1cyIsCiAgICAgIGxvYygiQXNjZW5kIHdpdGggPGI+JTE8L2I+IGJha2VkLiIsIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KDFlNDgpKSkgKwogICAgICAgICI8cT5BbGwgcmlzZS48L3E+IiwKICAgICAgWzIxLCAyNV0KICAgICk7CgogICAgR2FtZS5DcHNBY2hpZXZlbWVudCgiTGVpc3VyZWx5IHBhY2UiKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIkh5cGVyc29uaWMiKTsKCiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiRmVlZCBtZSwgT3J0ZWlsIik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiQW5kIHRoZW4gd2hhdD8iKTsKCiAgICBvcmRlciA9IDcwMDI7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlRyaWNlbnRlbm5pYWwgYW5kIGEgaGFsZiIsCiAgICAgIGxvYygiSGF2ZSBhdCBsZWFzdCA8Yj4lMSBvZiBldmVyeXRoaW5nPC9iPi4iLCAzNTApICsKICAgICAgICAiPHE+KGl0J3MgZnJlZSByZWFsIGVzdGF0ZSk8L3E+IiwKICAgICAgWzIxLCAyNl0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlF1YWRyaWNlbnRlbm5pYWwiLAogICAgICBsb2MoIkhhdmUgYXQgbGVhc3QgPGI+JTEgb2YgZXZlcnl0aGluZzwvYj4uIiwgNDAwKSArCiAgICAgICAgIjxxPllvdSd2ZSBoYWQgdG8gZG8gaG9ycmlibGUgdGhpbmdzIHRvIGdldCB0aGlzIGZhci48YnI+SG9ycmlibGUuLi4gaG9ycmlibGUgdGhpbmdzLjwvcT4iLAogICAgICBbMjIsIDI2XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiUXVhZHJpY2VudGVubmlhbCBhbmQgYSBoYWxmIiwKICAgICAgbG9jKCJIYXZlIGF0IGxlYXN0IDxiPiUxIG9mIGV2ZXJ5dGhpbmc8L2I+LiIsIDQ1MCkgKwogICAgICAgICI8cT5BdCB0aGlzIHBvaW50LCB5b3UgbWlnaHQganVzdCBiZSBjb21wZW5zYXRpbmcgZm9yIHNvbWV0aGluZy48L3E+IiwKICAgICAgWzIzLCAyNl0KICAgICk7CgogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJRdWluY2VudGVubmlhbCIsCiAgICAgIGxvYygiSGF2ZSBhdCBsZWFzdCA8Yj4lMSBvZiBldmVyeXRoaW5nPC9iPi4iLCA1MDApICsKICAgICAgICAiPHE+U29tZSBwZW9wbGUgd291bGQgc2F5IHlvdSdyZSBoYWxmd2F5IHRoZXJlLjxicj5XZSBkbyBub3QgY2FyZSBmb3IgdGhvc2UgcGVvcGxlIGFuZCB0aGVpciByZWNrbGVzcyBzZW5zZSBvZiB1bmNoZWNrZWQgb3B0aW1pc20uPC9xPiIsCiAgICAgIFsyOSwgMjVdCiAgICApOwoKICAgIG9yZGVyID0gMjExMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIk1haWxsYXJkIHJlYWN0aW9uIiwKICAgICAgbG9jKCJIYXJ2ZXN0IGEgPGI+Y2FyYW1lbGl6ZWQgc3VnYXIgbHVtcDwvYj4uIiksCiAgICAgIFsyOSwgMjddCiAgICApOwoKICAgIG9yZGVyID0gMzAyNTA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIldoZW4gdGhlIGNvb2tpZXMgYXNjZW5kIGp1c3QgcmlnaHQiLAogICAgICBsb2MoIkFzY2VuZCB3aXRoIGV4YWN0bHkgPGI+JTE8L2I+LiIsIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KDFlMTIpKSksCiAgICAgIFsyNSwgN10KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJzaGFkb3ciOyAvL3RoaXMgYWNoaWV2ZW1lbnQgaXMgc2hhZG93IGJlY2F1c2UgaXQgaXMgb25seSBhY2hpZXZhYmxlIHRocm91Z2ggYmxpbmQgbHVjayBvciByZWFkaW5nIGV4dGVybmFsIGd1aWRlczsgdGhpcyBtYXkgY2hhbmdlIGluIHRoZSBmdXR1cmUKCiAgICBvcmRlciA9IDEwNTA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIldpdGggaGVyIGZpbmdlciBhbmQgaGVyIHRodW1iIiwKICAgICAgbG9jKCJIYXZlIDxiPiUxPC9iPi4iLCBsb2MoIiUxIGN1cnNvciIsIExCZWF1dGlmeSg2MDApKSksCiAgICAgIFswLCAxNl0KICAgICk7CgogICAgb3JkZXIgPSAxMTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiRGVmZW5zZSBvZiB0aGUgYW5jaWVudHMiLCAiIiwgIkdyYW5kbWEiLCAxMik7CiAgICBvcmRlciA9IDEyMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJTaGFycGVzdCB0b29sIGluIHRoZSBzaGVkIiwgIiIsICJGYXJtIiwgMTEpOwogICAgb3JkZXIgPSAxMzAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiSGV5IG5vdywgeW91J3JlIGEgcm9jayIsICIiLCAiTWluZSIsIDExKTsKICAgIG9yZGVyID0gMTQwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkJyZWFrIHRoZSBtb2xkIiwgIiIsICJGYWN0b3J5IiwgMTEpOwogICAgb3JkZXIgPSAxNDI1OwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiR2V0IHRoZSBzaG93IG9uLCBnZXQgcGFpZCIsICIiLCAiQmFuayIsIDExKTsKICAgIG9yZGVyID0gMTQ1MDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJNeSB3b3JsZCdzIG9uIGZpcmUsIGhvdyBhYm91dCB5b3VycyIsCiAgICAgICIiLAogICAgICAiVGVtcGxlIiwKICAgICAgMTEKICAgICk7CiAgICBvcmRlciA9IDE0NzU7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KAogICAgICAiVGhlIG1ldGVvciBtZW4gYmVnIHRvIGRpZmZlciIsCiAgICAgICIiLAogICAgICAiV2l6YXJkIHRvd2VyIiwKICAgICAgMTEKICAgICk7CiAgICBvcmRlciA9IDE1MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJPbmx5IHNob290aW5nIHN0YXJzIiwgIiIsICJTaGlwbWVudCIsIDExKTsKICAgIG9yZGVyID0gMTYwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJXZSBjb3VsZCBhbGwgdXNlIGEgbGl0dGxlIGNoYW5nZSIsCiAgICAgICIiLAogICAgICAiQWxjaGVteSBsYWIiLAogICAgICAxMQogICAgKTsgLy8iYWxsIHRoYXQgZ2xpdHRlcnMgaXMgZ29sZCIgd2FzIGFscmVhZHkgYW4gYWNoaWV2ZW1lbnQKICAgIG9yZGVyID0gMTcwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJZb3VyIGJyYWluIGdldHMgc21hcnQgYnV0IHlvdXIgaGVhZCBnZXRzIGR1bWIiLAogICAgICAiIiwKICAgICAgIlBvcnRhbCIsCiAgICAgIDExCiAgICApOwogICAgb3JkZXIgPSAxODAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiVGhlIHllYXJzIHN0YXJ0IGNvbWluZyIsICIiLCAiVGltZSBtYWNoaW5lIiwgMTEpOwogICAgb3JkZXIgPSAxOTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiV2hhdCBhIGNvbmNlcHQiLCAiIiwgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwgMTEpOwogICAgb3JkZXIgPSAyMDAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIllvdSdsbCBuZXZlciBzaGluZSBpZiB5b3UgZG9uJ3QgZ2xvdyIsCiAgICAgICIiLAogICAgICAiUHJpc20iLAogICAgICAxMQogICAgKTsKICAgIG9yZGVyID0gMjEwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJZb3UnbGwgbmV2ZXIga25vdyBpZiB5b3UgZG9uJ3QgZ28iLAogICAgICAiIiwKICAgICAgIkNoYW5jZW1ha2VyIiwKICAgICAgMTEKICAgICk7CgogICAgb3JkZXIgPSAyMjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiU2VsZi1jb250YWluZWQiLCAiIiwgIkZyYWN0YWwgZW5naW5lIiwgMSk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJUaHJldyB5b3UgZm9yIGEgbG9vcCIsICIiLCAiRnJhY3RhbCBlbmdpbmUiLCAyKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlRoZSBzdW0gb2YgaXRzIHBhcnRzIiwgIiIsICJGcmFjdGFsIGVuZ2luZSIsIDMpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIkJlYXJzIHJlcGVhdGluZyIsCiAgICAgICI8cT5XaGVyZSBkaWQgdGhlc2UgY29tZSBmcm9tPzwvcT4iLAogICAgICAiRnJhY3RhbCBlbmdpbmUiLAogICAgICA0CiAgICApOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTW9yZSBvZiB0aGUgc2FtZSIsICIiLCAiRnJhY3RhbCBlbmdpbmUiLCA1KTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkxhc3QgcmVjdXJzZSIsICIiLCAiRnJhY3RhbCBlbmdpbmUiLCA2KTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIk91dCBvZiBvbmUsIG1hbnkiLCAiIiwgIkZyYWN0YWwgZW5naW5lIiwgNyk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJBbiBleGFtcGxlIG9mIHJlY3Vyc2lvbiIsICIiLCAiRnJhY3RhbCBlbmdpbmUiLCA4KTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJGb3IgbW9yZSBpbmZvcm1hdGlvbiBvbiB0aGlzIGFjaGlldmVtZW50LCBwbGVhc2UgcmVmZXIgdG8gaXRzIHRpdGxlIiwKICAgICAgIiIsCiAgICAgICJGcmFjdGFsIGVuZ2luZSIsCiAgICAgIDkKICAgICk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KAogICAgICAiSSdtIHNvIG1ldGEsIGV2ZW4gdGhpcyBhY2hpZXZlbWVudCIsCiAgICAgICIiLAogICAgICAiRnJhY3RhbCBlbmdpbmUiLAogICAgICAxMAogICAgKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIk5ldmVyIGdldCBib3JlZCIsICIiLCAiRnJhY3RhbCBlbmdpbmUiLCAxMSk7CgogICAgb3JkZXIgPSAyMjIwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIlRoZSBuZWVkcyBvZiB0aGUgbWFueSIsICJGcmFjdGFsIGVuZ2luZSIsIDEpOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIkVhdGluZyBpdHMgb3duIiwgIkZyYWN0YWwgZW5naW5lIiwgMik7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiV2UgbXVzdCBnbyBkZWVwZXIiLCAiRnJhY3RhbCBlbmdpbmUiLCAzKTsKCiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgiU2llcnBpbnNraSByaG9tYm9pZHMiLCAiIiwgWzIwLCAyNl0pOwogICAgR2FtZS5PYmplY3RzWyJGcmFjdGFsIGVuZ2luZSJdLmxldmVsQWNoaWV2MTAgPSBHYW1lLmxhc3Q7CgogICAgR2FtZS5DcHNBY2hpZXZlbWVudCgiR290dGEgZ28gZmFzdCIpOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIkkgdGhpbmsgaXQncyBzYWZlIHRvIHNheSB5b3UndmUgZ290IGl0IG1hZGUiKTsKCiAgICBvcmRlciA9IDYwMDI7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlJlbmFpc3NhbmNlIGJha2VyIiwKICAgICAgbG9jKCJPd24gPGI+JTE8L2I+IHVwZ3JhZGVzIGFuZCA8Yj4lMjwvYj4gYnVpbGRpbmdzLiIsIFs0MDAsIDgwMDBdKSArCiAgICAgICAgIjxxPklmIHlvdSBoYXZlIHNlZW4gZnVydGhlciwgaXQgaXMgYnkgc3RhbmRpbmcgb24gdGhlIHNob3VsZGVycyBvZiBnaWFudHMgLSBhIG15c3RlcmlvdXMgc3BlY2llcyBvZiB0b3dlcmluZyBodW1hbm9pZHMgdW50aWwgbm93IHRob3VnaHQgbG9uZy1leHRpbmN0LjwvcT4iLAogICAgICBbMTAsIDEwXQogICAgKTsKCiAgICBvcmRlciA9IDEwOTg7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlZldGVyYW4iLAogICAgICBsb2MoIk93biBhdCBsZWFzdCA8Yj4lMTwvYj4gZ3JhbmRtYSB0eXBlcy4iLCAxNCkgKyAiPHE+MTQncyBhIGNyb3dkITwvcT4iLAogICAgICBbMTAsIDldCiAgICApOwoKICAgIG9yZGVyID0gMTAwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlRoaWNrLXNraW5uZWQiLAogICAgICBsb2MoCiAgICAgICAgIkhhdmUgeW91ciA8Yj5yZWluZm9yY2VkIG1lbWJyYW5lPC9iPiBwcm90ZWN0IHRoZSA8Yj5zaGltbWVyaW5nIHZlaWw8L2I+LiIKICAgICAgKSwKICAgICAgWzcsIDEwXQogICAgKTsKCiAgICBvcmRlciA9IDIzMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJGMTIiLCAiIiwgIkphdmFzY3JpcHQgY29uc29sZSIsIDEpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiVmFyaWFibGUgc3VjY2VzcyIsICIiLCAiSmF2YXNjcmlwdCBjb25zb2xlIiwgMik7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJObyBjb21tZW50cyIsICIiLCAiSmF2YXNjcmlwdCBjb25zb2xlIiwgMyk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJVcCB0byBjb2RlIiwgIiIsICJKYXZhc2NyaXB0IGNvbnNvbGUiLCA0KTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIldvcmtzIG9uIG15IG1hY2hpbmUiLCAiIiwgIkphdmFzY3JpcHQgY29uc29sZSIsIDUpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiVGVjaG5pY2FsIGRlYnQiLCAiIiwgIkphdmFzY3JpcHQgY29uc29sZSIsIDYpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTWluZCB5b3VyIGxhbmd1YWdlIiwgIiIsICJKYXZhc2NyaXB0IGNvbnNvbGUiLCA3KTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkluY29uc29sYWJsZSIsICIiLCAiSmF2YXNjcmlwdCBjb25zb2xlIiwgOCk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJDbG9zdXJlIiwgIiIsICJKYXZhc2NyaXB0IGNvbnNvbGUiLCA5KTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJEdWRlIHdoYXQgaWYgd2UncmUgYWxsIGxpdmluZyBpbiBhIHNpbXVsYXRpb24gbGlrZSB3aGF0IGlmIHdlJ3JlIGFsbCBqdXN0IGNvZGUgb24gYSBjb21wdXRlciBzb21ld2hlcmUiLAogICAgICAiIiwKICAgICAgIkphdmFzY3JpcHQgY29uc29sZSIsCiAgICAgIDEwCiAgICApOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIlRha2luZyB0aGUgYmFjayBzdHJlZXRzIiwKICAgICAgIiIsCiAgICAgICJKYXZhc2NyaXB0IGNvbnNvbGUiLAogICAgICAxMQogICAgKTsKCiAgICBvcmRlciA9IDIzMjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiSW5oZXJpdGVkIHByb3RvdHlwZSIsICJKYXZhc2NyaXB0IGNvbnNvbGUiLCAxKTsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KAogICAgICAiQSBtb2RlbCBvZiBkb2N1bWVudCBvYmplY3QiLAogICAgICAiSmF2YXNjcmlwdCBjb25zb2xlIiwKICAgICAgMgogICAgKTsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJGaXJzdC1jbGFzcyBjaXRpemVuIiwgIkphdmFzY3JpcHQgY29uc29sZSIsIDMpOwoKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KCJBbGV4YW5kcmlhIiwgIiIsIFszMiwgMjZdKTsKICAgIEdhbWUuT2JqZWN0c1siSmF2YXNjcmlwdCBjb25zb2xlIl0ubGV2ZWxBY2hpZXYxMCA9IEdhbWUubGFzdDsKCiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJCYWtlIGhpbSBhd2F5LCB0b3lzIik7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJZb3UncmUgIzEgc28gd2h5IHRyeSBoYXJkZXIiKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIkhhdmVuJ3QgZXZlbiBiZWd1biB0byBwZWFrIik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiQSBzb21ldGltZXMgZm9vZCIpOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIk5vdCBlbm91Z2ggb2YgYSBnb29kIHRoaW5nIik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiSG9ybiBvZiBwbGVudHkiKTsKCiAgICBvcmRlciA9IDMwMDUwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJTbXVyZiBhY2NvdW50IiwKICAgICAgbG9jKCJBc2NlbmQgd2l0aCA8Yj4lMTwvYj4gYmFrZWQuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWU1MSkpKSArCiAgICAgICAgIjxxPkl0J3MgbGlrZSB5b3UganVzdCBhcHBlYXJlZCBvdXQgb2YgdGhlIGJsdWUhPC9xPiIsCiAgICAgIFsyMSwgMzJdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJJZiBhdCBmaXJzdCB5b3UgZG9uJ3Qgc3VjY2VlZCIsCiAgICAgIGxvYygiQXNjZW5kIHdpdGggPGI+JTE8L2I+IGJha2VkLiIsIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KDFlNTQpKSkgKwogICAgICAgICI8cT5JZiBhdCBmaXJzdCB5b3UgZG9uJ3Qgc3VjY2VlZCwgdHJ5LCB0cnksIHRyeSBhZ2Fpbi48YnI+QnV0IGlzbid0IHRoYXQgdGhlIGRlZmluaXRpb24gb2YgaW5zYW5pdHk/PC9xPiIsCiAgICAgIFsyMSwgMzJdCiAgICApOwoKICAgIG9yZGVyID0gMzMwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIk8gRm9ydHVuYSIsCiAgICAgIGxvYygKICAgICAgICAnT3duIGV2ZXJ5IDxiPmZvcnR1bmUgdXBncmFkZTwvYj4uPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+T3duaW5nIHRoaXMgYWNoaWV2ZW1lbnQgbWFrZXMgZm9ydHVuZXMgYXBwZWFyIDxiPnR3aWNlIGFzIG9mdGVuPC9iPjsgdW5sb2NrZWQgZm9ydHVuZSB1cGdyYWRlcyBhbHNvIGhhdmUgYSA8Yj4lMSUgY2hhbmNlPC9iPiB0byBjYXJyeSBvdmVyIGFmdGVyIGFzY2VuZGluZy4nLAogICAgICAgIDQwCiAgICAgICksCiAgICAgIFsyOSwgOF0KICAgICk7CgogICAgb3JkZXIgPSA2MTYxNTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiSW5pdGlhbCBwdWJsaWMgb2ZmZXJpbmciLAogICAgICBsb2MoIk1ha2UgeW91ciBmaXJzdCBzdG9jayBtYXJrZXQgcHJvZml0LiIpLAogICAgICBbMCwgMzNdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJSb29raWUgbnVtYmVycyIsCiAgICAgIGxvYygiT3duIGF0IGxlYXN0IDxiPiUxPC9iPiBvZiBldmVyeSBzdG9jayBtYXJrZXQgZ29vZC4iLCAxMDApICsKICAgICAgICAiPHE+R290dGEgcHVtcCB0aG9zZSBudW1iZXJzIHVwITwvcT4iLAogICAgICBbOSwgMzNdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJObyBub2JpbGl0eSBpbiBwb3ZlcnR5IiwKICAgICAgbG9jKCJPd24gYXQgbGVhc3QgPGI+JTE8L2I+IG9mIGV2ZXJ5IHN0b2NrIG1hcmtldCBnb29kLiIsIDUwMCkgKwogICAgICAgICI8cT5XaGF0IGtpbmQgb2YgdHdpc3RlZCBpbmRpdmlkdWFsIGlzIG91dCB0aGVyZSBjcmFtbWluZyBjYW1lbHMgdGhyb3VnaCBuZWVkbGUgaG9sZXMgYW55d2F5PzwvcT4iLAogICAgICBbMTAsIDMzXQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiRnVsbCB3YXJlaG91c2VzIiwKICAgICAgbG9jKCJPd24gYXQgbGVhc3QgPGI+JTE8L2I+IG9mIGEgc3RvY2sgbWFya2V0IGdvb2QuIiwgMTAwMCksCiAgICAgIFsxMSwgMzNdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJNYWtlIG15IGRheSIsCiAgICAgIGxvYygiTWFrZSA8Yj5hIGRheTwvYj4gb2YgQ3BTICgkJTEpIGluIDEgc3RvY2sgbWFya2V0IHNhbGUuIiwgODY0MDApLAogICAgICBbMSwgMzNdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJCdXkgYnV5IGJ1eSIsCiAgICAgIGxvYygiU3BlbmQgPGI+YSBkYXk8L2I+IG9mIENwUyAoJCUxKSBpbiAxIHN0b2NrIG1hcmtldCBwdXJjaGFzZS4iLCA4NjQwMCksCiAgICAgIFsxLCAzM10KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkdhc2VvdXMgYXNzZXRzIiwKICAgICAgbG9jKAogICAgICAgICJIYXZlIHlvdXIgc3RvY2sgbWFya2V0IHByb2ZpdHMgc3VycGFzcyA8Yj5hIHdob2xlIHllYXI8L2I+IG9mIENwUyAoJCUxKS4iLAogICAgICAgIDMxNTM2MDAwCiAgICAgICkgKyAiPHE+Qm95LCBob3cgdm9sYXRpbGUhPC9xPiIsCiAgICAgIFsxOCwgMzNdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAic2hhZG93IjsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiUHlyYW1pZCBzY2hlbWUiLAogICAgICBsb2MoIlVubG9jayB0aGUgPGI+aGlnaGVzdC10aWVyPC9iPiBzdG9jayBtYXJrZXQgaGVhZHF1YXJ0ZXJzLiIpLAogICAgICBbMTgsIDMzXQogICAgKTsKCiAgICBvcmRlciA9IDEwMDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJKZWxsaWNsZXMiLAogICAgICBsb2MoIk93biA8Yj4lMTwvYj4ga2l0dGVuIHVwZ3JhZGVzLiIsIDEwKSArCiAgICAgICAgIjxxPkplbGxpY2xlcyBjYW4gYW5kIGplbGxpY2xlcyBkbyEgTWFrZSBzdXJlIHRvIHdhc2ggeW91ciBqZWxsaWNsZXMgZXZlcnkgZGF5ITwvcT4iLAogICAgICBbMTgsIDE5XQogICAgKTsKCiAgICBvcmRlciA9IDcwMDI7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlF1aW5jZW50ZW5uaWFsIGFuZCBhIGhhbGYiLAogICAgICBsb2MoIkhhdmUgYXQgbGVhc3QgPGI+JTEgb2YgZXZlcnl0aGluZzwvYj4uIiwgNTUwKSArCiAgICAgICAgIjxxPlRoaXMgd29uJ3QgZmlsbCB0aGUgY2h1cm5pbmcgdm9pZCBpbnNpZGUsIHlvdSBrbm93LjwvcT4iLAogICAgICBbMjksIDI2XQogICAgKTsKCiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJXaGF0IGRpZCB3ZSBldmVuIGVhdCBiZWZvcmUgdGhlc2UiKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIkhlYXZ5IGZsb3ciKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIk1vcmUgeW91IHNheT8iKTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJMYXJnZSBhbmQgaW4gY2hhcmdlIik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiQWJzb2x1dGVseSBzdHVmZmVkIik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiSXQncyBvbmx5IHdhZmVyLXRoaW4iLCAiSnVzdCB0aGUgb25lISIpOwoKICAgIG9yZGVyID0gMTAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQ2xpY2tldHkgc3BsaXQiLAogICAgICBsb2MoIk1ha2UgPGI+JTE8L2I+IGZyb20gY2xpY2tpbmcuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUyNykpKSwKICAgICAgWzExLCAzMV0KICAgICk7CiAgICBvcmRlciA9IDEwNTA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkdvdHRhIGhhbmQgaXQgdG8geW91IiwKICAgICAgbG9jKCJIYXZlIDxiPiUxPC9iPi4iLCBsb2MoIiUxIGN1cnNvciIsIExCZWF1dGlmeSg3MDApKSksCiAgICAgIFswLCAxN10KICAgICk7CiAgICBvcmRlciA9IDExMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJPa2F5IGJvb21lciIsICIiLCAiR3JhbmRtYSIsIDEzKTsKICAgIG9yZGVyID0gMTIwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIk92ZXJyaXBlIiwgIiIsICJGYXJtIiwgMTIpOwogICAgb3JkZXIgPSAxMzAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiUm9jayBvbiIsICIiLCAiTWluZSIsIDEyKTsKICAgIG9yZGVyID0gMTQwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlNlbGYtbWFubWFkZSBtYW4iLCAiIiwgIkZhY3RvcnkiLCAxMik7CiAgICBvcmRlciA9IDE0MjU7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJDaGVja3Mgb3V0IiwgIiIsICJCYW5rIiwgMTIpOwogICAgb3JkZXIgPSAxNDUwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTGl2aW5nIG9uIGEgcHJheWVyIiwgIiIsICJUZW1wbGUiLCAxMik7CiAgICBvcmRlciA9IDE0NzU7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KAogICAgICAiSGlnaXR1cyBmaWdpdHVzIG1pZ2l0dXMgbXVtIiwKICAgICAgIiIsCiAgICAgICJXaXphcmQgdG93ZXIiLAogICAgICAxMgogICAgKTsKICAgIG9yZGVyID0gMTUwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlRoZSBpbmNyZWRpYmxlIGpvdXJuZXkiLCAiIiwgIlNoaXBtZW50IiwgMTIpOwogICAgb3JkZXIgPSAxNjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiSnVzdCBhIHBoYXNlIiwgIiIsICJBbGNoZW15IGxhYiIsIDEyKTsKICAgIG9yZGVyID0gMTcwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkRvbid0IGxldCBtZSBsZWF2ZSwgTXVycGgiLCAiIiwgIlBvcnRhbCIsIDEyKTsKICAgIG9yZGVyID0gMTgwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkNhdmVtYW4gdG8gY29zbW9zIiwgIiIsICJUaW1lIG1hY2hpbmUiLCAxMik7CiAgICBvcmRlciA9IDE5MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJQYXJ0aWN1bGFyIHRhc3RlcyIsICIiLCAiQW50aW1hdHRlciBjb25kZW5zZXIiLCAxMik7CiAgICBvcmRlciA9IDIwMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJBIGxpZ2h0IHNuYWNrIiwgIiIsICJQcmlzbSIsIDEyKTsKICAgIG9yZGVyID0gMjEwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlRlbXB0aW5nIGZhdGUiLCAiIiwgIkNoYW5jZW1ha2VyIiwgMTIpOwogICAgb3JkZXIgPSAyMjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiVGF1dG9sb2dpY2FsIiwgIiIsICJGcmFjdGFsIGVuZ2luZSIsIDEyKTsKICAgIG9yZGVyID0gMjMwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJDdXJseSBicmFjZXMiLAogICAgICAiPHE+T3IgYXMgdGhlIEZyZW5jaCBjYWxsIHRoZW0sIG11c3RhY2hlIGJveGVzLjxicj5HbyB3ZWxsIHdpdGggcXVvdGVzLjwvcT4iLAogICAgICAiSmF2YXNjcmlwdCBjb25zb2xlIiwKICAgICAgMTIKICAgICk7CgogICAgb3JkZXIgPSAxMDAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiU2V2ZW4gaG9yc2VzaG9lcyIsCiAgICAgIGxvYygiQ2xpY2sgPGI+JTE8L2I+LiIsIGxvYygiJTEgZ29sZGVuIGNvb2tpZSIsIExCZWF1dGlmeSgyNzc3NykpKSArCiAgICAgICAgIjxxPkVub3VnaCBmb3Igb25lIG9mIHRob3NlIGZ1bmt5IGhvcnNlcyB0aGF0IGdyYXplIG5lYXIgeW91ciBmYWN0b3JpZXMuPC9xPiIsCiAgICAgIFsyMSwgMzNdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAic2hhZG93IjsKCiAgICBvcmRlciA9IDExMDA1OwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJPbGRlbiBkYXlzIiwKICAgICAgbG9jKCJGaW5kIHRoZSA8Yj5mb3Jnb3R0ZW4gbWFkZWxlaW5lPC9iPi4iKSArCiAgICAgICAgIjxxPkRhc2hOZXQgRmFybXMgcmVtZW1iZXJzLjwvcT4iLAogICAgICBbMTIsIDNdCiAgICApOwoKICAgIG9yZGVyID0gMTA1MDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiVGhlIGRldmlsJ3Mgd29ya3Nob3AiLAogICAgICBsb2MoIkhhdmUgPGI+JTE8L2I+LiIsIGxvYygiJTEgY3Vyc29yIiwgTEJlYXV0aWZ5KDgwMCkpKSwKICAgICAgWzAsIDE4XQogICAgKTsKICAgIG9yZGVyID0gMTIwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkluIHRoZSBncmVlbiIsICIiLCAiRmFybSIsIDEzKTsKICAgIG9yZGVyID0gMTMwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJNb3VudGFpbiBvdXQgb2YgYSBtb2xlaGlsbCwgYnV0IGxpa2UgaW4gYSBnb29kIHdheSIsCiAgICAgICIiLAogICAgICAiTWluZSIsCiAgICAgIDEzCiAgICApOwogICAgb3JkZXIgPSAxNDAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiVGhlIHdoZWVscyBvZiBwcm9ncmVzcyIsICIiLCAiRmFjdG9yeSIsIDEzKTsKICAgIG9yZGVyID0gMTQyNTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlRoYXQncyByaWNoIiwgIiIsICJCYW5rIiwgMTMpOwogICAgb3JkZXIgPSAxNDUwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiUHJlYWNoZXMgYW5kIGNyZWFtIiwgIiIsICJUZW1wbGUiLCAxMyk7CiAgICBvcmRlciA9IDE0NzU7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJNYWdpYyB0aGlua2luZyIsICIiLCAiV2l6YXJkIHRvd2VyIiwgMTMpOwogICAgb3JkZXIgPSAxNTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIklzIHRoZXJlIGxpZmUgb24gTWFycz8iLAogICAgICAiPHE+WWVzLCB0aGVyZSBpcy4gWW91J3JlIGN1cnJlbnRseSB1c2luZyBpdCBhcyBmaWxsaW5nIGluIGV4cGVyaW1lbnRhbCBmbGF2b3IgcHJvdG90eXBlICM4MTA2NTcuPC9xPiIsCiAgICAgICJTaGlwbWVudCIsCiAgICAgIDEzCiAgICApOwogICAgb3JkZXIgPSAxNjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiQmFkIGNoZW1pc3RyeSIsICIiLCAiQWxjaGVteSBsYWIiLCAxMyk7CiAgICBvcmRlciA9IDE3MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJSZWR1Y2VkIHRvIGdpYmJlcmluZyBoZWFwcyIsICIiLCAiUG9ydGFsIiwgMTMpOwogICAgb3JkZXIgPSAxODAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiQmFjayBhbHJlYWR5PyIsICIiLCAiVGltZSBtYWNoaW5lIiwgMTMpOwogICAgb3JkZXIgPSAxOTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTnVjbGVhciB0aHJvbmUiLCAiIiwgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwgMTMpOwogICAgb3JkZXIgPSAyMDAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTWFraW5nIGxpZ2h0IG9mIHRoZSBzaXR1YXRpb24iLCAiIiwgIlByaXNtIiwgMTMpOwogICAgb3JkZXIgPSAyMTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIkZsaXAgYSBjb29raWUuIENoaXBzLCBJIHdpbi4gQ3J1c3QsIHlvdSBsb3NlLiIsCiAgICAgICIiLAogICAgICAiQ2hhbmNlbWFrZXIiLAogICAgICAxMwogICAgKTsKICAgIG9yZGVyID0gMjIwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkluIGFuZCBvZiBpdHNlbGYiLCAiIiwgIkZyYWN0YWwgZW5naW5lIiwgMTMpOwogICAgb3JkZXIgPSAyMzAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIkR1Y2sgdHlwaW5nIiwKICAgICAgIjxxPkhlbGxvLCB0aGlzIGlzIGEgZHVjayB0eXBpbmcuIEdvdCBhbnkgZ3JhcGVzPzwvcT4iLAogICAgICAiSmF2YXNjcmlwdCBjb25zb2xlIiwKICAgICAgMTMKICAgICk7CgogICAgb3JkZXIgPSAyNDAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIlRoZXknbGwgbmV2ZXIga25vdyB3aGF0IGhpdCAnZW0iLAogICAgICAiIiwKICAgICAgIklkbGV2ZXJzZSIsCiAgICAgIDEKICAgICk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJXZWxsLXZlcnNlZCIsICIiLCAiSWRsZXZlcnNlIiwgMik7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJSaXBlIGZvciB0aGUgcGlja2luZyIsICIiLCAiSWRsZXZlcnNlIiwgMyk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJVbnJlYWwiLCAiIiwgIklkbGV2ZXJzZSIsIDQpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiT25jZSB5b3UndmUgc2VlbiBvbmUiLCAiIiwgIklkbGV2ZXJzZSIsIDUpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiU3BvaWxzIGFuZCBwbHVuZGVyIiwgIiIsICJJZGxldmVyc2UiLCA2KTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJOb2JvZHkgZXhpc3RzIG9uIHB1cnBvc2UsIG5vYm9keSBiZWxvbmdzIGFueXdoZXJlIiwKICAgICAgIjxxPkNvbWUgd2F0Y2ggVFY/PC9xPiIsCiAgICAgICJJZGxldmVyc2UiLAogICAgICA3CiAgICApOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiSHlwZXJzcGFjZSBleHByZXNzd2F5IiwgIiIsICJJZGxldmVyc2UiLCA4KTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlZlcnNhdGlsZSIsICIiLCAiSWRsZXZlcnNlIiwgOSk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJZb3UgYXJlIGluZXZpdGFibGUiLCAiIiwgIklkbGV2ZXJzZSIsIDEwKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkF3YXkgZnJvbSB0aGlzIHBsYWNlIiwgIiIsICJJZGxldmVyc2UiLCAxMSk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJFdmVyeXdoZXJlIGF0IG9uY2UiLCAiIiwgIklkbGV2ZXJzZSIsIDEyKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJSZWplY3QgcmVhbGl0eSwgc3Vic3RpdHV0ZSB5b3VyIG93biIsCiAgICAgICIiLAogICAgICAiSWRsZXZlcnNlIiwKICAgICAgMTMKICAgICk7CgogICAgb3JkZXIgPSAyNDIwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIkZyaW5nZSIsICJJZGxldmVyc2UiLCAxKTsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJDb2hlcmVuY2UiLCAiSWRsZXZlcnNlIiwgMik7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiRWFydGgtNjE2IiwgIklkbGV2ZXJzZSIsIDMpOwoKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KCJTdHJhbmdlIHRvcG9sb2dpZXMiLCAiIiwgWzMzLCAyNl0pOwogICAgR2FtZS5PYmplY3RzWyJJZGxldmVyc2UiXS5sZXZlbEFjaGlldjEwID0gR2FtZS5sYXN0OwoKICAgIG9yZGVyID0gNTAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiR3JhbmQgZGVzaWduIiwKICAgICAgbG9jKCJPd24gPGI+JTE8L2I+LiIsIGxvYygiJTEgYnVpbGRpbmciLCBMQmVhdXRpZnkoNTAwMCkpKSArCiAgICAgICAgIjxxPlRoZXknbGwgcmVtZW1iZXIgeW91IGZvcmV2ZXIhPC9xPiIsCiAgICAgIFszMiwgMTJdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJFY3VtZW5vcG9saXMiLAogICAgICBsb2MoIk93biA8Yj4lMTwvYj4uIiwgbG9jKCIlMSBidWlsZGluZyIsIExCZWF1dGlmeSg3NTAwKSkpICsKICAgICAgICAiPHE+R2V0dGluZyBhIHdlZSBiaXQgY3JhbXBlZC48L3E+IiwKICAgICAgWzMzLCAxMl0KICAgICk7CgogICAgb3JkZXIgPSA2MDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJUaGUgZnVsbCBwaWN0dXJlIiwKICAgICAgbG9jKCJQdXJjaGFzZSA8Yj4lMTwvYj4uIiwgbG9jKCIlMSB1cGdyYWRlIiwgTEJlYXV0aWZ5KDMwMCkpKSArCiAgICAgICAgIjxxPlNvIHRoYXQncyB3aGVyZSB0aGF0IGZpdHMgaW4hPC9xPiIsCiAgICAgIFszMiwgMTFdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJXaGVuIHRoZXJlJ3Mgbm90aGluZyBsZWZ0IHRvIGFkZCIsCiAgICAgIGxvYygiUHVyY2hhc2UgPGI+JTE8L2I+LiIsIGxvYygiJTEgdXBncmFkZSIsIExCZWF1dGlmeSg0MDApKSkgKwogICAgICAgICI8cT4uLi5rZWVwIGdvaW5nLjwvcT4iLAogICAgICBbMzMsIDExXQogICAgKTsKCiAgICBvcmRlciA9IDcwMDI7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlNleGNlbnRlbm5pYWwiLAogICAgICBsb2MoIkhhdmUgYXQgbGVhc3QgPGI+JTEgb2YgZXZlcnl0aGluZzwvYj4uIiwgNjAwKSArCiAgICAgICAgIjxxPkhleSwgbmljZSBtaWxlc3RvbmUhPC9xPiIsCiAgICAgIFszMSwgMzNdCiAgICApOwoKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIktlZXAgZ29pbmcgdW50aWwgSSBzYXkgc3RvcCIpOwogICAgR2FtZS5DcHNBY2hpZXZlbWVudCgiQnV0IEkgZGlkbid0IHNheSBzdG9wLCBkaWQgST8iKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIldpdGggdW5yaXZhbGVkIGZlcnZvciIpOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIlRoaW5rIGJpZyIpOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIkh5cGVyc2l6ZSBtZSIpOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIk1heCBjYXBhY2l0eSIpOwoKICAgIG9yZGVyID0gNjE2MTY7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkxpcXVpZCBhc3NldHMiLAogICAgICBsb2MoIkhhdmUgeW91ciBzdG9jayBtYXJrZXQgcHJvZml0cyBzdXJwYXNzIDxiPiQlMTwvYj4uIiwgMWU3KSwKICAgICAgWzEyLCAzM10KICAgICk7CgogICAgb3JkZXIgPSAxMTAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiU3RpZmxpbmcgdGhlIHByZXNzIiwKICAgICAgbG9jKCJTcXVpc2ggdGhlIG5ld3MgdGlja2VyIGZsYXQsIHRoZW4gY2xpY2sgb24gaXQuIikgKwogICAgICAgICI8cT5OYXJyb3cgaW4gaGVyZSBvciBpcyBpdCBqdXN0IG1lPzwvcT4iLAogICAgICBbMjcsIDddCiAgICApOwoKICAgIG9yZGVyID0gMjUwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkl0J3MgYmlnIGJyYWluIHRpbWUiLCAiIiwgIkNvcnRleCBiYWtlciIsIDEpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiSnVzdCBteSBpbWFnaW5hdGlvbiIsICIiLCAiQ29ydGV4IGJha2VyIiwgMik7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJOb3cgdGhlcmUncyBhbiBpZGVhIiwgIiIsICJDb3J0ZXggYmFrZXIiLCAzKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJUaGUgb3JnYW4gdGhhdCBuYW1lZCBpdHNlbGYiLAogICAgICAiIiwKICAgICAgIkNvcnRleCBiYWtlciIsCiAgICAgIDQKICAgICk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJHeXJpZmljYXRpb24iLCAiIiwgIkNvcnRleCBiYWtlciIsIDUpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgJ0EgdHJhZGVtYXJrZWQgcG9ydG1hbnRlYXUgb2YgImltYWdpbmF0aW9uIiBhbmQgImVuZ2luZWVyaW5nIicsCiAgICAgICIiLAogICAgICAiQ29ydGV4IGJha2VyIiwKICAgICAgNgogICAgKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIk1pbmRmdWxuZXNzIiwgIiIsICJDb3J0ZXggYmFrZXIiLCA3KTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlRoZSAxMCUgbXl0aCIsICIiLCAiQ29ydGV4IGJha2VyIiwgOCk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KAogICAgICAiRG9uJ3QgdGhpbmsgYWJvdXQgaXQgdG9vIGhhcmQiLAogICAgICAiIiwKICAgICAgIkNvcnRleCBiYWtlciIsCiAgICAgIDkKICAgICk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KAogICAgICAiVGhvdWdoIGZvb2xzIHNlbGRvbSBkaWZmZXIiLAogICAgICAiIiwKICAgICAgIkNvcnRleCBiYWtlciIsCiAgICAgIDEwCiAgICApOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTG9va2luZyBraW5kIG9mIGR1bWIiLCAiIiwgIkNvcnRleCBiYWtlciIsIDExKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkEgYmVhdXRpZnVsIG1pbmQiLCAiIiwgIkNvcnRleCBiYWtlciIsIDEyKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkNhcmRpbmFsIHN5bmFwc2VzIiwgIiIsICJDb3J0ZXggYmFrZXIiLCAxMyk7CgogICAgb3JkZXIgPSAyNTIwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIlBvc2l0aXZlIHRoaW5raW5nIiwgIkNvcnRleCBiYWtlciIsIDEpOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIlRoZSB0aG91Z2h0IHRoYXQgY291bnRzIiwgIkNvcnRleCBiYWtlciIsIDIpOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIlVudGhpbmthYmxlIiwgIkNvcnRleCBiYWtlciIsIDMpOwoKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KCJHaWZ0ZWQiLCAiIiwgWzM0LCAyNl0pOwogICAgR2FtZS5PYmplY3RzWyJDb3J0ZXggYmFrZXIiXS5sZXZlbEFjaGlldjEwID0gR2FtZS5sYXN0OwoKICAgIG9yZGVyID0gMTEwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlRoZXkgbW9pc3RseSBjb21lIGF0IG5pZ2h0IiwgIiIsICJHcmFuZG1hIiwgMTQpOwogICAgb3JkZXIgPSAxMjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiSXQncyBncm93biBvbiB5b3UiLCAiIiwgIkZhcm0iLCAxNCk7CiAgICBvcmRlciA9IDEzMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KAogICAgICAiRG9uJ3QgbGV0IHRoZSB3YWxscyBjYXZlIGluIG9uIHlvdSIsCiAgICAgICIiLAogICAgICAiTWluZSIsCiAgICAgIDE0CiAgICApOwogICAgb3JkZXIgPSAxNDAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiUmVwbGFjZWQgYnkgcm9ib3RzIiwgIiIsICJGYWN0b3J5IiwgMTQpOwogICAgb3JkZXIgPSAxNDI1OwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIkZpbmFuY2lhbCBwcm9kaWd5IiwKICAgICAgIjxxPkltYWdpbmUgaG93IGl0IHdvdWxkIGJlLCB0byBiZSBhdCB0aGUgdG9wIG1ha2luZyBjYXNoIG1vbmV5LjwvcT4iLAogICAgICAiQmFuayIsCiAgICAgIDE0CiAgICApOwogICAgb3JkZXIgPSAxNDUwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiQW5kIEkgd2lsbCBwcmF5IHRvIGEgYmlnIGdvZCIsICIiLCAiVGVtcGxlIiwgMTQpOwogICAgb3JkZXIgPSAxNDc1OwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiU2hvc3BsZSBDb2x1cGlzIiwgIiIsICJXaXphcmQgdG93ZXIiLCAxNCk7CiAgICBvcmRlciA9IDE1MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJGYWxzZSB2YWN1dW0iLCAiIiwgIlNoaXBtZW50IiwgMTQpOwogICAgb3JkZXIgPSAxNjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTWV0YWxsaWMgdGFzdGUiLCAiIiwgIkFsY2hlbXkgbGFiIiwgMTQpOwogICAgb3JkZXIgPSAxNzAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiU3dpc3MgY2hlZXNlIiwgIiIsICJQb3J0YWwiLCAxNCk7CiAgICBvcmRlciA9IDE4MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KAogICAgICAiQnV0IHRoZSBmdXR1cmUgcmVmdXNlZCB0byBjaGFuZ2UiLAogICAgICAiIiwKICAgICAgIlRpbWUgbWFjaGluZSIsCiAgICAgIDE0CiAgICApOwogICAgb3JkZXIgPSAxOTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIldoYXQncyB0aGUgZGFyayBtYXR0ZXIgd2l0aCB5b3UiLAogICAgICAiIiwKICAgICAgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwKICAgICAgMTQKICAgICk7CiAgICBvcmRlciA9IDIwMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJFbmxpZ2h0ZW5tZW50IiwgIiIsICJQcmlzbSIsIDE0KTsKICAgIG9yZGVyID0gMjEwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIk5ldmVyIHRlbGwgbWUgdGhlIG9kZHMiLCAiIiwgIkNoYW5jZW1ha2VyIiwgMTQpOwogICAgb3JkZXIgPSAyMjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIkJsb3dpbmcgYW4gQXBvbGxvbmlhbiBnYXNrZXQiLAogICAgICAiIiwKICAgICAgIkZyYWN0YWwgZW5naW5lIiwKICAgICAgMTQKICAgICk7CiAgICBvcmRlciA9IDIzMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KAogICAgICAiR2V0IHdpdGggdGhlIHByb2dyYW0iLAogICAgICAiIiwKICAgICAgIkphdmFzY3JpcHQgY29uc29sZSIsCiAgICAgIDE0CiAgICApOwogICAgb3JkZXIgPSAyNDAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTG9zdCB5b3VyIGNvc21pYyBtYXJibGVzIiwgIiIsICJJZGxldmVyc2UiLCAxNCk7CiAgICBvcmRlciA9IDI1MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KAogICAgICAiQnkgd2lsbCBhbG9uZSBJIHNldCBteSBtaW5kIGluIG1vdGlvbiIsCiAgICAgICIiLAogICAgICAiQ29ydGV4IGJha2VyIiwKICAgICAgMTQKICAgICk7CgogICAgb3JkZXIgPSAxMDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJBaW4ndCB0aGF0IGEgY2xpY2sgaW4gdGhlIGhlYWQiLAogICAgICBsb2MoIk1ha2UgPGI+JTE8L2I+IGZyb20gY2xpY2tpbmcuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUyOSkpKSwKICAgICAgWzExLCAzNF0KICAgICk7CgogICAgb3JkZXIgPSA3MDAyOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJTZXhjZW50ZW5uaWFsIGFuZCBhIGhhbGYiLAogICAgICBsb2MoIkhhdmUgYXQgbGVhc3QgPGI+JTEgb2YgZXZlcnl0aGluZzwvYj4uIiwgNjUwKSArCiAgICAgICAgIjxxPkhvcGUgeW91J3JlIGVuam95aW5nIHRoZSBncmluZCBzbyBmYXIhIEl0IGdldHMgd29yc2UuPC9xPiIsCiAgICAgIFsyMSwgMzRdCiAgICApOwoKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIkkgYW0gc3BlZWQiKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIkFuZCBvbiBhbmQgb24iKTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJGYWtlIGl0IHRpbGwgeW91IGJha2UgaXQiKTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJIaXN0b3J5IGluIHRoZSBiYWtpbmciKTsKCiAgICBvcmRlciA9IDIyMTAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJCYWJ5IGl0J3Mgb2xkIG91dHNpZGUiLAogICAgICBsb2MoIkNsaWNrIG9uZSBvZiBTYW50YSdzIGhlbHBlciBncmFuZG1hcyBkdXJpbmcgQ2hyaXN0bWFzIHNlYXNvbi4iKSwKICAgICAgWzEwLCA5XQogICAgKTsKCiAgICBvcmRlciA9IDUwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIk15cmlhZCIsCiAgICAgIGxvYygiT3duIDxiPiUxPC9iPi4iLCBsb2MoIiUxIGJ1aWxkaW5nIiwgTEJlYXV0aWZ5KDEwMDAwKSkpICsKICAgICAgICAiPHE+QXQgdGhpcyBwb2ludCwgbW9zdCBvZiB5b3VyIGFzc2V0cyBsaWUgaW4gcmVhbCBlc3RhdGUuPC9xPiIsCiAgICAgIFszMSwgNl0KICAgICk7CgogICAgb3JkZXIgPSA2MDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJLYWl6ZW4iLAogICAgICBsb2MoIlB1cmNoYXNlIDxiPiUxPC9iPi4iLCBsb2MoIiUxIHVwZ3JhZGUiLCBMQmVhdXRpZnkoNTAwKSkpICsKICAgICAgICAiPHE+SnVzdCBhIGxpdHRsZSBtb3JlLjwvcT4iLAogICAgICBbMzEsIDVdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJCZXlvbmQgcXVhbGl0eSIsCiAgICAgIGxvYygiUHVyY2hhc2UgPGI+JTE8L2I+LiIsIGxvYygiJTEgdXBncmFkZSIsIExCZWF1dGlmeSg2MDApKSkgKwogICAgICAgICI8cT5Ed2FyZmluZyBhbGwgb2YgbWFua2luZCdzIGFjY29tcGxpc2htZW50cy48L3E+IiwKICAgICAgWzMyLCA1XQogICAgKTsKCiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJFdmVyeXRoaW5nIGhhcHBlbnMgc28gbXVjaCIpOwogICAgR2FtZS5DcHNBY2hpZXZlbWVudCgiSSdsbCByZXN0IHdoZW4gSSdtIGRlYWQiKTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJXaGF0IGRvIHlvdSBnZXQgZm9yIHRoZSBiYWtlciB3aG8gaGFzIGV2ZXJ5dGhpbmciKTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJCb3R0b21sZXNzIHBpdCIpOwoKICAgIG9yZGVyID0gNjAwMTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQWxsIHRoZSBzdGFycyBpbiBoZWF2ZW4iLAogICAgICBsb2MoIk93biA8Yj4lMTwvYj4gaGVhdmVubHkgdXBncmFkZXMuIiwgMTAwKSwKICAgICAgWzMwLCA1XQogICAgKTsKCiAgICAvL2VuZCBvZiBhY2hpZXZlbWVudHMKCiAgICBmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0cykgewogICAgICBpZiAoR2FtZS5PYmplY3RzW2ldLmxldmVsQWNoaWV2MTApIHsKICAgICAgICBHYW1lLk9iamVjdHNbaV0ubGV2ZWxBY2hpZXYxMC5iYXNlRGVzYyA9IGxvYygKICAgICAgICAgICJSZWFjaCBsZXZlbCA8Yj4lMTwvYj4gJTIuIiwKICAgICAgICAgIFsxMCwgR2FtZS5PYmplY3RzW2ldLnBsdXJhbF0KICAgICAgICApOwogICAgICAgIEdhbWUuT2JqZWN0c1tpXS5sZXZlbEFjaGlldjEwLmRlc2MgPQogICAgICAgICAgR2FtZS5PYmplY3RzW2ldLmxldmVsQWNoaWV2MTAuYmFzZURlc2M7CiAgICAgIH0KICAgIH0KCiAgICBMb2NhbGl6ZVVwZ3JhZGVzQW5kQWNoaWV2cygpOwoKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJCUJVRkZTCgkJPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KCiAgICBHYW1lLmJ1ZmZzID0ge307IC8vYnVmZnMgY3VycmVudGx5IGluIGVmZmVjdCBieSBuYW1lCiAgICBHYW1lLmJ1ZmZzSSA9IDA7CiAgICBHYW1lLmJ1ZmZzTCA9IGwoImJ1ZmZzIik7CiAgICBHYW1lLmdhaW5CdWZmID0gZnVuY3Rpb24gKHR5cGUsIHRpbWUsIGFyZzEsIGFyZzIsIGFyZzMpIHsKICAgICAgdHlwZSA9IEdhbWUuYnVmZlR5cGVzQnlOYW1lW3R5cGVdOwogICAgICB2YXIgb2JqID0gdHlwZS5mdW5jKHRpbWUsIGFyZzEsIGFyZzIsIGFyZzMpOwogICAgICBvYmoudHlwZSA9IHR5cGU7CiAgICAgIG9iai5hcmcxID0gYXJnMTsKICAgICAgb2JqLmFyZzIgPSBhcmcyOwogICAgICBvYmouYXJnMyA9IGFyZzM7CiAgICAgIGlmICghb2JqLmRuYW1lICYmIG9iai5uYW1lICE9ICI/Pz8iKSBvYmouZG5hbWUgPSBsb2Mob2JqLm5hbWUpOwoKICAgICAgdmFyIGJ1ZmYgPSB7CiAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICB0aW1lOiAwLAogICAgICAgIG5hbWU6ICI/Pz8iLAogICAgICAgIGRlc2M6ICIiLAogICAgICAgIGljb246IFswLCAwXSwKICAgICAgfTsKICAgICAgaWYgKEdhbWUuYnVmZnNbb2JqLm5hbWVdKSB7CiAgICAgICAgLy9pZiB0aGVyZSBpcyBhbHJlYWR5IGEgYnVmZiBpbiBlZmZlY3Qgd2l0aCB0aGlzIG5hbWUKICAgICAgICB2YXIgYnVmZiA9IEdhbWUuYnVmZnNbb2JqLm5hbWVdOwogICAgICAgIGlmIChvYmoubWF4KSBidWZmLnRpbWUgPSBNYXRoLm1heChvYmoudGltZSwgYnVmZi50aW1lKTsgLy9uZXcgZHVyYXRpb24gaXMgbWF4IG9mIG9sZCBhbmQgbmV3CiAgICAgICAgaWYgKG9iai5hZGQpIGJ1ZmYudGltZSArPSBvYmoudGltZTsgLy9uZXcgZHVyYXRpb24gaXMgb2xkICsgbmV3CiAgICAgICAgaWYgKCFvYmoubWF4ICYmICFvYmouYWRkKSBidWZmLnRpbWUgPSBvYmoudGltZTsgLy9uZXcgZHVyYXRpb24gaXMgc2V0IHRvIG5ldwogICAgICAgIGJ1ZmYubWF4VGltZSA9IGJ1ZmYudGltZTsKICAgICAgfSAvL2NyZWF0ZSBuZXcgYnVmZgogICAgICBlbHNlIHsKICAgICAgICBmb3IgKHZhciBpIGluIG9iaikgeyAvL3Bhc3RlIHBhcmFtZXRlcnMgb250byBidWZmCiAgICAgICAgICBidWZmW2ldID0gb2JqW2ldOwogICAgICAgIH0KICAgICAgICBidWZmLm1heFRpbWUgPSBidWZmLnRpbWU7CiAgICAgICAgR2FtZS5idWZmc1tidWZmLm5hbWVdID0gYnVmZjsKICAgICAgICBidWZmLmlkID0gR2FtZS5idWZmc0k7CgogICAgICAgIC8vY3JlYXRlIGRvbQogICAgICAgIEdhbWUuYnVmZnNMLmlubmVySFRNTCA9CiAgICAgICAgICBHYW1lLmJ1ZmZzTC5pbm5lckhUTUwgKwogICAgICAgICAgJzxkaXYgaWQ9ImJ1ZmYnICsKICAgICAgICAgIGJ1ZmYuaWQgKwogICAgICAgICAgJyIgY2xhc3M9ImNyYXRlIGVuYWJsZWQgYnVmZiIgJyArCiAgICAgICAgICAoYnVmZi5kZXNjCiAgICAgICAgICAgID8gR2FtZS5nZXRUb29sdGlwKAogICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9InByb21wdCIgc3R5bGU9Im1pbi13aWR0aDoyMDBweDt0ZXh0LWFsaWduOmNlbnRlcjtmb250LXNpemU6MTFweDttYXJnaW46OHB4IDBweDsiIGlkPSJ0b29sdGlwQnVmZiI+PGgzPicgKwogICAgICAgICAgICAgICAgICBidWZmLmRuYW1lICsKICAgICAgICAgICAgICAgICAgJzwvaDM+PGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgICAgICAgICAgIGJ1ZmYuZGVzYyArCiAgICAgICAgICAgICAgICAgICI8L2Rpdj4iLAogICAgICAgICAgICAgICAgImxlZnQiLAogICAgICAgICAgICAgICAgdHJ1ZQogICAgICAgICAgICAgICkKICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgJyBzdHlsZT0ib3BhY2l0eToxO2Zsb2F0Om5vbmU7ZGlzcGxheTpibG9jazsnICsKICAgICAgICAgIHdyaXRlSWNvbihidWZmLmljb24pICsKICAgICAgICAgICciPjwvZGl2Pic7CgogICAgICAgIGJ1ZmYubCA9IGwoImJ1ZmYiICsgYnVmZi5pZCk7CgogICAgICAgIEdhbWUuYnVmZnNJKys7CiAgICAgIH0KICAgICAgR2FtZS5yZWNhbGN1bGF0ZUdhaW5zID0gMTsKICAgICAgR2FtZS5zdG9yZVRvUmVmcmVzaCA9IDE7CiAgICAgIHJldHVybiBidWZmOwogICAgfTsKICAgIEdhbWUuaGFzQnVmZiA9IGZ1bmN0aW9uICgKICAgICAgd2hhdCAvL3JldHVybnMgMCBpZiB0aGVyZSBpcyBubyBidWZmIGluIGVmZmVjdCB3aXRoIHRoaXMgbmFtZTsgZWxzZSwgcmV0dXJucyBpdAogICAgKSB7CiAgICAgIGlmICghR2FtZS5idWZmc1t3aGF0XSkgcmV0dXJuIDA7CiAgICAgIGVsc2UgcmV0dXJuIEdhbWUuYnVmZnNbd2hhdF07CiAgICB9OwogICAgR2FtZS51cGRhdGVCdWZmcyA9IGZ1bmN0aW9uICgpIC8vZXhlY3V0ZWQgZXZlcnkgbG9naWMgZnJhbWUKICAgIHsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLmJ1ZmZzKSB7CiAgICAgICAgdmFyIGJ1ZmYgPSBHYW1lLmJ1ZmZzW2ldOwoKICAgICAgICBpZiAoYnVmZi50aW1lID49IDApIHsKICAgICAgICAgIGlmICghbCgiYnVmZlBpZVRpbWVyIiArIGJ1ZmYuaWQpKQogICAgICAgICAgICBsKCJidWZmIiArIGJ1ZmYuaWQpLmlubmVySFRNTCA9CiAgICAgICAgICAgICAgbCgiYnVmZiIgKyBidWZmLmlkKS5pbm5lckhUTUwgKwogICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJwaWVUaW1lciIgaWQ9ImJ1ZmZQaWVUaW1lcicgKwogICAgICAgICAgICAgIGJ1ZmYuaWQgKwogICAgICAgICAgICAgICciPjwvZGl2Pic7CiAgICAgICAgICB2YXIgVCA9IDEgLSBidWZmLnRpbWUgLyBidWZmLm1heFRpbWU7CiAgICAgICAgICBUID0gKFQgKiAxNDQpICUgMTQ0OwogICAgICAgICAgbCgiYnVmZlBpZVRpbWVyIiArIGJ1ZmYuaWQpLnN0eWxlLmJhY2tncm91bmRQb3NpdGlvbiA9CiAgICAgICAgICAgIC1NYXRoLmZsb29yKFQgJSAxOCkgKiA0OCArICJweCAiICsgLU1hdGguZmxvb3IoVCAvIDE4KSAqIDQ4ICsgInB4IjsKICAgICAgICB9CiAgICAgICAgYnVmZi50aW1lLS07CiAgICAgICAgaWYgKGJ1ZmYudGltZSA8PSAwKSB7CiAgICAgICAgICBpZiAoR2FtZS5vbkNyYXRlID09IGwoImJ1ZmYiICsgYnVmZi5pZCkpIEdhbWUudG9vbHRpcC5oaWRlKCk7CiAgICAgICAgICBpZiAoYnVmZi5vbkRpZSkgYnVmZi5vbkRpZSgpOwogICAgICAgICAgR2FtZS5idWZmc0wucmVtb3ZlQ2hpbGQobCgiYnVmZiIgKyBidWZmLmlkKSk7CiAgICAgICAgICBpZiAoR2FtZS5idWZmc1tidWZmLm5hbWVdKSB7CiAgICAgICAgICAgIEdhbWUuYnVmZnNbYnVmZi5uYW1lXSA9IDA7CiAgICAgICAgICAgIGRlbGV0ZSBHYW1lLmJ1ZmZzW2J1ZmYubmFtZV07CiAgICAgICAgICB9CiAgICAgICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICAgICAgR2FtZS5zdG9yZVRvUmVmcmVzaCA9IDE7CiAgICAgICAgfQogICAgICB9CiAgICB9OwogICAgR2FtZS5raWxsQnVmZiA9IGZ1bmN0aW9uICgKICAgICAgd2hhdCAvL3JlbW92ZSBhIGJ1ZmYgYnkgbmFtZQogICAgKSB7CiAgICAgIGlmIChHYW1lLmJ1ZmZzW3doYXRdKSB7CiAgICAgICAgR2FtZS5idWZmc1t3aGF0XS50aW1lID0gMDsgLypHYW1lLmJ1ZmZzW3doYXRdPTA7Ki8KICAgICAgfQogICAgfTsKICAgIEdhbWUua2lsbEJ1ZmZzID0gZnVuY3Rpb24gKCkgLy9yZW1vdmUgYWxsIGJ1ZmZzCiAgICB7CiAgICAgIEdhbWUuYnVmZnNMLmlubmVySFRNTCA9ICIiOwogICAgICBHYW1lLmJ1ZmZzID0ge307CiAgICAgIEdhbWUucmVjYWxjdWxhdGVHYWlucyA9IDE7CiAgICAgIEdhbWUuc3RvcmVUb1JlZnJlc2ggPSAxOwogICAgfTsKCiAgICBHYW1lLmJ1ZmZUeXBlcyA9IFtdOyAvL2J1ZmYgYXJjaGV0eXBlczsgb25seSBidWZmcyBkZWNsYXJlZCBmcm9tIHRoZXNlIGNhbiBiZSBzYXZlZCBhbmQgbG9hZGVkCiAgICBHYW1lLmJ1ZmZUeXBlc0J5TmFtZSA9IFtdOwogICAgR2FtZS5idWZmVHlwZXNOID0gMDsKICAgIEdhbWUuYnVmZlR5cGUgPSBmdW5jdGlvbiAobmFtZSwgZnVuYykgewogICAgICB0aGlzLm5hbWUgPSBuYW1lOwogICAgICB0aGlzLmZ1bmMgPSBmdW5jOyAvL3RoaXMgaXMgYSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBidWZmIG9iamVjdDsgaXQgdGFrZXMgYSAidGltZSIgYXJndW1lbnQgaW4gc2Vjb25kcywgYW5kIDMgbW9yZSBvcHRpb25hbCBhcmd1bWVudHMgYXQgbW9zdCwgd2hpY2ggd2lsbCBiZSBzYXZlZCBhbmQgbG9hZGVkIGFzIGZsb2F0cwogICAgICB0aGlzLmlkID0gR2FtZS5idWZmVHlwZXNOOwogICAgICB0aGlzLnZhbmlsbGEgPSBHYW1lLnZhbmlsbGE7CiAgICAgIEdhbWUuYnVmZlR5cGVzQnlOYW1lW3RoaXMubmFtZV0gPSB0aGlzOwogICAgICBHYW1lLmJ1ZmZUeXBlc1tHYW1lLmJ1ZmZUeXBlc05dID0gdGhpczsKICAgICAgR2FtZS5idWZmVHlwZXNOKys7CiAgICB9OwoKICAgIC8qCgkJYmFzaWMgYnVmZiBwYXJhbWV0ZXJzIDoKCQkJbmFtZTonS2l0dGVuIHJhaW4nLAoJCQlkZXNjOidJdFwncyByYWluaW5nIGtpdHRlbnMhJywKCQkJaWNvbjpbMCwwXSwKCQkJdGltZTozMCpHYW1lLmZwcwoJCW90aGVyIHBhcmFtZXRlcnMgOgoJCQl2aXNpYmxlOmZhbHNlIC0gd2lsbCBoaWRlIHRoZSBidWZmIGZyb20gdGhlIGJ1ZmYgbGlzdAoJCQlhZGQ6dHJ1ZSAtIGlmIHRoaXMgYnVmZiBhbHJlYWR5IGV4aXN0cywgYWRkIHRoZSBuZXcgZHVyYXRpb24gdG8gdGhlIG9sZCBvbmUKCQkJbWF4OnRydWUgLSBpZiB0aGlzIGJ1ZmYgYWxyZWFkeSBleGlzdHMsIHNldCB0aGUgbmV3IGR1cmF0aW9uIHRvIHRoZSBtYXggb2YgZWl0aGVyCgkJCW9uRGllOmZ1bmN0aW9uKCl7fSAtIGZ1bmN0aW9uIHdpbGwgZXhlY3V0ZSB3aGVuIHRoZSBidWZmIHJ1bnMgb3V0CgkJCXBvd2VyOjMgLSB1c2VkIGJ5IHNvbWUgYnVmZnMKCQkJbXVsdENwUzozIC0gYnVmZiBtdWx0aXBsaWVzIENwUyBieSB0aGlzIGFtb3VudAoJCQltdWx0Q2xpY2s6MyAtIGJ1ZmYgbXVsdGlwbGllcyBjbGljayBwb3dlciBieSB0aGlzIGFtb3VudAoJCSovCgogICAgLy9iYXNlIGJ1ZmZzCiAgICBuZXcgR2FtZS5idWZmVHlwZSgiZnJlbnp5IiwgZnVuY3Rpb24gKHRpbWUsIHBvdykgewogICAgICByZXR1cm4gewogICAgICAgIG5hbWU6ICJGcmVuenkiLAogICAgICAgIGRlc2M6IGxvYygiQ29va2llIHByb2R1Y3Rpb24geCUxIGZvciAlMiEiLCBbCiAgICAgICAgICBwb3csCiAgICAgICAgICBHYW1lLnNheVRpbWUodGltZSAqIEdhbWUuZnBzLCAtMSksCiAgICAgICAgXSksCiAgICAgICAgaWNvbjogWzEwLCAxNF0sCiAgICAgICAgdGltZTogdGltZSAqIEdhbWUuZnBzLAogICAgICAgIGFkZDogdHJ1ZSwKICAgICAgICBtdWx0Q3BTOiBwb3csCiAgICAgICAgYXVyYTogMSwKICAgICAgfTsKICAgIH0pOwogICAgbmV3IEdhbWUuYnVmZlR5cGUoImJsb29kIGZyZW56eSIsIGZ1bmN0aW9uICh0aW1lLCBwb3cpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBuYW1lOiAiRWxkZXIgZnJlbnp5IiwKICAgICAgICBkZXNjOiBsb2MoIkNvb2tpZSBwcm9kdWN0aW9uIHglMSBmb3IgJTIhIiwgWwogICAgICAgICAgcG93LAogICAgICAgICAgR2FtZS5zYXlUaW1lKHRpbWUgKiBHYW1lLmZwcywgLTEpLAogICAgICAgIF0pLAogICAgICAgIGljb246IFsyOSwgNl0sCiAgICAgICAgdGltZTogdGltZSAqIEdhbWUuZnBzLAogICAgICAgIGFkZDogdHJ1ZSwKICAgICAgICBtdWx0Q3BTOiBwb3csCiAgICAgICAgYXVyYTogMSwKICAgICAgfTsKICAgIH0pOwogICAgbmV3IEdhbWUuYnVmZlR5cGUoImNsb3QiLCBmdW5jdGlvbiAodGltZSwgcG93KSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgbmFtZTogIkNsb3QiLAogICAgICAgIGRlc2M6IGxvYygKICAgICAgICAgICJDb29raWUgcHJvZHVjdGlvbiBoYWx2ZWQgZm9yICUxISIsCiAgICAgICAgICBHYW1lLnNheVRpbWUodGltZSAqIEdhbWUuZnBzLCAtMSkKICAgICAgICApLAogICAgICAgIGljb246IFsxNSwgNV0sCiAgICAgICAgdGltZTogdGltZSAqIEdhbWUuZnBzLAogICAgICAgIGFkZDogdHJ1ZSwKICAgICAgICBtdWx0Q3BTOiBwb3csCiAgICAgICAgYXVyYTogMiwKICAgICAgfTsKICAgIH0pOwogICAgbmV3IEdhbWUuYnVmZlR5cGUoImRyYWdvbiBoYXJ2ZXN0IiwgZnVuY3Rpb24gKHRpbWUsIHBvdykgewogICAgICBpZiAoR2FtZS5IYXMoIkRyYWdvbiBmYW5nIikpIHBvdyA9IE1hdGguY2VpbChwb3cgKiAxLjEpOwogICAgICByZXR1cm4gewogICAgICAgIG5hbWU6ICJEcmFnb24gSGFydmVzdCIsCiAgICAgICAgZGVzYzogbG9jKCJDb29raWUgcHJvZHVjdGlvbiB4JTEgZm9yICUyISIsIFsKICAgICAgICAgIHBvdywKICAgICAgICAgIEdhbWUuc2F5VGltZSh0aW1lICogR2FtZS5mcHMsIC0xKSwKICAgICAgICBdKSwKICAgICAgICBpY29uOiBbMTAsIDI1XSwKICAgICAgICB0aW1lOiB0aW1lICogR2FtZS5mcHMsCiAgICAgICAgYWRkOiB0cnVlLAogICAgICAgIG11bHRDcFM6IHBvdywKICAgICAgICBhdXJhOiAxLAogICAgICB9OwogICAgfSk7CiAgICBuZXcgR2FtZS5idWZmVHlwZSgiZXZlcnl0aGluZyBtdXN0IGdvIiwgZnVuY3Rpb24gKHRpbWUsIHBvdykgewogICAgICByZXR1cm4gewogICAgICAgIG5hbWU6ICJFdmVyeXRoaW5nIG11c3QgZ28iLAogICAgICAgIGRlc2M6IGxvYygiQWxsIGJ1aWxkaW5ncyBhcmUgJTElIGNoZWFwZXIgZm9yICUyISIsIFsKICAgICAgICAgIHBvdywKICAgICAgICAgIEdhbWUuc2F5VGltZSh0aW1lICogR2FtZS5mcHMsIC0xKSwKICAgICAgICBdKSwKICAgICAgICBpY29uOiBbMTcsIDZdLAogICAgICAgIHRpbWU6IHRpbWUgKiBHYW1lLmZwcywKICAgICAgICBhZGQ6IHRydWUsCiAgICAgICAgcG93ZXI6IHBvdywKICAgICAgICBhdXJhOiAxLAogICAgICB9OwogICAgfSk7CiAgICBuZXcgR2FtZS5idWZmVHlwZSgiY3Vyc2VkIGZpbmdlciIsIGZ1bmN0aW9uICh0aW1lLCBwb3cpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBuYW1lOiAiQ3Vyc2VkIGZpbmdlciIsCiAgICAgICAgZGVzYzogbG9jKAogICAgICAgICAgIkNvb2tpZSBwcm9kdWN0aW9uIGhhbHRlZCBmb3IgJTEsPGJyPmJ1dCBlYWNoIGNsaWNrIGlzIHdvcnRoICUyIG9mIENwUy4iLAogICAgICAgICAgW0dhbWUuc2F5VGltZSh0aW1lICogR2FtZS5mcHMsIC0xKSwgR2FtZS5zYXlUaW1lKHRpbWUgKiBHYW1lLmZwcywgLTEpXQogICAgICAgICksCiAgICAgICAgaWNvbjogWzEyLCAxN10sCiAgICAgICAgdGltZTogdGltZSAqIEdhbWUuZnBzLAogICAgICAgIGFkZDogdHJ1ZSwKICAgICAgICBwb3dlcjogcG93LAogICAgICAgIG11bHRDcFM6IDAsCiAgICAgICAgYXVyYTogMSwKICAgICAgfTsKICAgIH0pOwogICAgbmV3IEdhbWUuYnVmZlR5cGUoImNsaWNrIGZyZW56eSIsIGZ1bmN0aW9uICh0aW1lLCBwb3cpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBuYW1lOiAiQ2xpY2sgZnJlbnp5IiwKICAgICAgICBkZXNjOiBsb2MoIkNsaWNraW5nIHBvd2VyIHglMSBmb3IgJTIhIiwgWwogICAgICAgICAgcG93LAogICAgICAgICAgR2FtZS5zYXlUaW1lKHRpbWUgKiBHYW1lLmZwcywgLTEpLAogICAgICAgIF0pLAogICAgICAgIGljb246IFswLCAxNF0sCiAgICAgICAgdGltZTogdGltZSAqIEdhbWUuZnBzLAogICAgICAgIGFkZDogdHJ1ZSwKICAgICAgICBtdWx0Q2xpY2s6IHBvdywKICAgICAgICBhdXJhOiAxLAogICAgICB9OwogICAgfSk7CiAgICBuZXcgR2FtZS5idWZmVHlwZSgiZHJhZ29uZmxpZ2h0IiwgZnVuY3Rpb24gKHRpbWUsIHBvdykgewogICAgICBpZiAoR2FtZS5IYXMoIkRyYWdvbiBmYW5nIikpIHBvdyA9IE1hdGguY2VpbChwb3cgKiAxLjEpOwogICAgICByZXR1cm4gewogICAgICAgIG5hbWU6ICJEcmFnb25mbGlnaHQiLAogICAgICAgIGRlc2M6IGxvYygiQ2xpY2tpbmcgcG93ZXIgeCUxIGZvciAlMiEiLCBbCiAgICAgICAgICBwb3csCiAgICAgICAgICBHYW1lLnNheVRpbWUodGltZSAqIEdhbWUuZnBzLCAtMSksCiAgICAgICAgXSksCiAgICAgICAgaWNvbjogWzAsIDI1XSwKICAgICAgICB0aW1lOiB0aW1lICogR2FtZS5mcHMsCiAgICAgICAgYWRkOiB0cnVlLAogICAgICAgIG11bHRDbGljazogcG93LAogICAgICAgIGF1cmE6IDEsCiAgICAgIH07CiAgICB9KTsKICAgIG5ldyBHYW1lLmJ1ZmZUeXBlKCJjb29raWUgc3Rvcm0iLCBmdW5jdGlvbiAodGltZSwgcG93KSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgbmFtZTogIkNvb2tpZSBzdG9ybSIsCiAgICAgICAgZGVzYzogbG9jKCJDb29raWVzIGV2ZXJ5d2hlcmUhIiksCiAgICAgICAgaWNvbjogWzIyLCA2XSwKICAgICAgICB0aW1lOiB0aW1lICogR2FtZS5mcHMsCiAgICAgICAgYWRkOiB0cnVlLAogICAgICAgIHBvd2VyOiBwb3csCiAgICAgICAgYXVyYTogMSwKICAgICAgfTsKICAgIH0pOwogICAgbmV3IEdhbWUuYnVmZlR5cGUoImJ1aWxkaW5nIGJ1ZmYiLCBmdW5jdGlvbiAodGltZSwgcG93LCBidWlsZGluZykgewogICAgICB2YXIgb2JqID0gR2FtZS5PYmplY3RzQnlJZFtidWlsZGluZ107CiAgICAgIHJldHVybiB7CiAgICAgICAgbmFtZTogR2FtZS5nb2xkZW5Db29raWVCdWlsZGluZ0J1ZmZzW29iai5uYW1lXVswXSwKICAgICAgICBkbmFtZTogRU4KICAgICAgICAgID8gR2FtZS5nb2xkZW5Db29raWVCdWlsZGluZ0J1ZmZzW29iai5uYW1lXVswXQogICAgICAgICAgOiBsb2MoIiUxIFBvd2VyISIsIG9iai5kbmFtZSksCiAgICAgICAgZGVzYzoKICAgICAgICAgIGxvYygKICAgICAgICAgICAgIllvdXIgJTEgYXJlIGJvb3N0aW5nIHlvdXIgQ3BTISIsCiAgICAgICAgICAgIGxvYygiJTEgIiArIG9iai5ic2luZ2xlLCBMQmVhdXRpZnkob2JqLmFtb3VudCkpCiAgICAgICAgICApICsKICAgICAgICAgICI8YnI+IiArCiAgICAgICAgICBsb2MoIkNvb2tpZSBwcm9kdWN0aW9uICslMSUgZm9yICUyISIsIFsKICAgICAgICAgICAgQmVhdXRpZnkoTWF0aC5jZWlsKHBvdyAqIDEwMCAtIDEwMCkpLAogICAgICAgICAgICBHYW1lLnNheVRpbWUodGltZSAqIEdhbWUuZnBzLCAtMSksCiAgICAgICAgICBdKSwKICAgICAgICBpY29uOiBbb2JqLmljb25Db2x1bW4sIDE0XSwKICAgICAgICB0aW1lOiB0aW1lICogR2FtZS5mcHMsCiAgICAgICAgYWRkOiB0cnVlLAogICAgICAgIG11bHRDcFM6IHBvdywKICAgICAgICBhdXJhOiAxLAogICAgICB9OwogICAgfSk7CiAgICBuZXcgR2FtZS5idWZmVHlwZSgiYnVpbGRpbmcgZGVidWZmIiwgZnVuY3Rpb24gKHRpbWUsIHBvdywgYnVpbGRpbmcpIHsKICAgICAgdmFyIG9iaiA9IEdhbWUuT2JqZWN0c0J5SWRbYnVpbGRpbmddOwogICAgICByZXR1cm4gewogICAgICAgIG5hbWU6IEdhbWUuZ29sZGVuQ29va2llQnVpbGRpbmdCdWZmc1tvYmoubmFtZV1bMV0sCiAgICAgICAgZG5hbWU6IEVOCiAgICAgICAgICA/IEdhbWUuZ29sZGVuQ29va2llQnVpbGRpbmdCdWZmc1tvYmoubmFtZV1bMV0KICAgICAgICAgIDogbG9jKCIlMSBCdXJkZW4hIiwgb2JqLmRuYW1lKSwKICAgICAgICBkZXNjOgogICAgICAgICAgbG9jKAogICAgICAgICAgICAiWW91ciAlMSBhcmUgcnVzdGluZyB5b3VyIENwUyEiLAogICAgICAgICAgICBsb2MoIiUxICIgKyBvYmouYnNpbmdsZSwgTEJlYXV0aWZ5KG9iai5hbW91bnQpKQogICAgICAgICAgKSArCiAgICAgICAgICAiPGJyPiIgKwogICAgICAgICAgbG9jKCJDb29raWUgcHJvZHVjdGlvbiAlMSUgc2xvd2VyIGZvciAlMiEiLCBbCiAgICAgICAgICAgIEJlYXV0aWZ5KE1hdGguY2VpbChwb3cgKiAxMDAgLSAxMDApKSwKICAgICAgICAgICAgR2FtZS5zYXlUaW1lKHRpbWUgKiBHYW1lLmZwcywgLTEpLAogICAgICAgICAgXSksCiAgICAgICAgaWNvbjogW29iai5pY29uQ29sdW1uLCAxNV0sCiAgICAgICAgdGltZTogdGltZSAqIEdhbWUuZnBzLAogICAgICAgIGFkZDogdHJ1ZSwKICAgICAgICBtdWx0Q3BTOiAxIC8gcG93LAogICAgICAgIGF1cmE6IDIsCiAgICAgIH07CiAgICB9KTsKICAgIG5ldyBHYW1lLmJ1ZmZUeXBlKCJzdWdhciBibGVzc2luZyIsIGZ1bmN0aW9uICh0aW1lLCBwb3cpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBuYW1lOiAiU3VnYXIgYmxlc3NpbmciLAogICAgICAgIGRlc2M6IGxvYygiWW91IGZpbmQgJTElIG1vcmUgZ29sZGVuIGNvb2tpZXMgZm9yIHRoZSBuZXh0ICUyLiIsIFsKICAgICAgICAgIDEwLAogICAgICAgICAgR2FtZS5zYXlUaW1lKHRpbWUgKiBHYW1lLmZwcywgLTEpLAogICAgICAgIF0pLAogICAgICAgIGljb246IFsyOSwgMTZdLAogICAgICAgIHRpbWU6IHRpbWUgKiBHYW1lLmZwcywKICAgICAgICAvL2FkZDp0cnVlCiAgICAgIH07CiAgICB9KTsKICAgIG5ldyBHYW1lLmJ1ZmZUeXBlKCJoYWdnbGVyIGx1Y2siLCBmdW5jdGlvbiAodGltZSwgcG93KSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgbmFtZTogIkhhZ2dsZXIncyBsdWNrIiwKICAgICAgICBkZXNjOiBsb2MoIkFsbCB1cGdyYWRlcyBhcmUgJTElIGNoZWFwZXIgZm9yICUyISIsIFsKICAgICAgICAgIHBvdywKICAgICAgICAgIEdhbWUuc2F5VGltZSh0aW1lICogR2FtZS5mcHMsIC0xKSwKICAgICAgICBdKSwKICAgICAgICBpY29uOiBbMjUsIDExXSwKICAgICAgICB0aW1lOiB0aW1lICogR2FtZS5mcHMsCiAgICAgICAgcG93ZXI6IHBvdywKICAgICAgICBtYXg6IHRydWUsCiAgICAgIH07CiAgICB9KTsKICAgIG5ldyBHYW1lLmJ1ZmZUeXBlKCJoYWdnbGVyIG1pc2VyeSIsIGZ1bmN0aW9uICh0aW1lLCBwb3cpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBuYW1lOiAiSGFnZ2xlcidzIG1pc2VyeSIsCiAgICAgICAgZGVzYzogbG9jKCJBbGwgdXBncmFkZXMgYXJlICUxJSBwcmljaWVyIGZvciAlMiEiLCBbCiAgICAgICAgICBwb3csCiAgICAgICAgICBHYW1lLnNheVRpbWUodGltZSAqIEdhbWUuZnBzLCAtMSksCiAgICAgICAgXSksCiAgICAgICAgaWNvbjogWzI1LCAxMV0sCiAgICAgICAgdGltZTogdGltZSAqIEdhbWUuZnBzLAogICAgICAgIHBvd2VyOiBwb3csCiAgICAgICAgbWF4OiB0cnVlLAogICAgICB9OwogICAgfSk7CiAgICBuZXcgR2FtZS5idWZmVHlwZSgicGl4aWUgbHVjayIsIGZ1bmN0aW9uICh0aW1lLCBwb3cpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBuYW1lOiAiQ3JhZnR5IHBpeGllcyIsCiAgICAgICAgZGVzYzogbG9jKCJBbGwgYnVpbGRpbmdzIGFyZSAlMSUgY2hlYXBlciBmb3IgJTIhIiwgWwogICAgICAgICAgcG93LAogICAgICAgICAgR2FtZS5zYXlUaW1lKHRpbWUgKiBHYW1lLmZwcywgLTEpLAogICAgICAgIF0pLAogICAgICAgIGljb246IFsyNiwgMTFdLAogICAgICAgIHRpbWU6IHRpbWUgKiBHYW1lLmZwcywKICAgICAgICBwb3dlcjogcG93LAogICAgICAgIG1heDogdHJ1ZSwKICAgICAgfTsKICAgIH0pOwogICAgbmV3IEdhbWUuYnVmZlR5cGUoInBpeGllIG1pc2VyeSIsIGZ1bmN0aW9uICh0aW1lLCBwb3cpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBuYW1lOiAiTmFzdHkgZ29ibGlucyIsCiAgICAgICAgZGVzYzogbG9jKCJBbGwgYnVpbGRpbmdzIGFyZSAlMSUgcHJpY2llciBmb3IgJTIhIiwgWwogICAgICAgICAgcG93LAogICAgICAgICAgR2FtZS5zYXlUaW1lKHRpbWUgKiBHYW1lLmZwcywgLTEpLAogICAgICAgIF0pLAogICAgICAgIGljb246IFsyNiwgMTFdLAogICAgICAgIHRpbWU6IHRpbWUgKiBHYW1lLmZwcywKICAgICAgICBwb3dlcjogcG93LAogICAgICAgIG1heDogdHJ1ZSwKICAgICAgfTsKICAgIH0pOwogICAgbmV3IEdhbWUuYnVmZlR5cGUoIm1hZ2ljIGFkZXB0IiwgZnVuY3Rpb24gKHRpbWUsIHBvdykgewogICAgICByZXR1cm4gewogICAgICAgIG5hbWU6ICJNYWdpYyBhZGVwdCIsCiAgICAgICAgZGVzYzogbG9jKCJTcGVsbHMgYmFja2ZpcmUgJTEgdGltZXMgbGVzcyBmb3IgJTIuIiwgWwogICAgICAgICAgcG93LAogICAgICAgICAgR2FtZS5zYXlUaW1lKHRpbWUgKiBHYW1lLmZwcywgLTEpLAogICAgICAgIF0pLAogICAgICAgIGljb246IFsyOSwgMTFdLAogICAgICAgIHRpbWU6IHRpbWUgKiBHYW1lLmZwcywKICAgICAgICBwb3dlcjogcG93LAogICAgICAgIG1heDogdHJ1ZSwKICAgICAgfTsKICAgIH0pOwogICAgbmV3IEdhbWUuYnVmZlR5cGUoIm1hZ2ljIGluZXB0IiwgZnVuY3Rpb24gKHRpbWUsIHBvdykgewogICAgICByZXR1cm4gewogICAgICAgIG5hbWU6ICJNYWdpYyBpbmVwdCIsCiAgICAgICAgZGVzYzogbG9jKCJTcGVsbHMgYmFja2ZpcmUgJTEgdGltZXMgbW9yZSBmb3IgJTIuIiwgWwogICAgICAgICAgcG93LAogICAgICAgICAgR2FtZS5zYXlUaW1lKHRpbWUgKiBHYW1lLmZwcywgLTEpLAogICAgICAgIF0pLAogICAgICAgIGljb246IFsyOSwgMTFdLAogICAgICAgIHRpbWU6IHRpbWUgKiBHYW1lLmZwcywKICAgICAgICBwb3dlcjogcG93LAogICAgICAgIG1heDogdHJ1ZSwKICAgICAgfTsKICAgIH0pOwogICAgbmV3IEdhbWUuYnVmZlR5cGUoImRldmFzdGF0aW9uIiwgZnVuY3Rpb24gKHRpbWUsIHBvdykgewogICAgICByZXR1cm4gewogICAgICAgIG5hbWU6ICJEZXZhc3RhdGlvbiIsCiAgICAgICAgZGVzYzogbG9jKCJDbGlja2luZyBwb3dlciArJTElIGZvciAlMiEiLCBbCiAgICAgICAgICBNYXRoLmZsb29yKHBvdyAqIDEwMCAtIDEwMCksCiAgICAgICAgICBHYW1lLnNheVRpbWUodGltZSAqIEdhbWUuZnBzLCAtMSksCiAgICAgICAgXSksCiAgICAgICAgaWNvbjogWzIzLCAxOF0sCiAgICAgICAgdGltZTogdGltZSAqIEdhbWUuZnBzLAogICAgICAgIG11bHRDbGljazogcG93LAogICAgICAgIGF1cmE6IDEsCiAgICAgICAgbWF4OiB0cnVlLAogICAgICB9OwogICAgfSk7CiAgICBuZXcgR2FtZS5idWZmVHlwZSgic3VnYXIgZnJlbnp5IiwgZnVuY3Rpb24gKHRpbWUsIHBvdykgewogICAgICByZXR1cm4gewogICAgICAgIG5hbWU6ICJTdWdhciBmcmVuenkiLAogICAgICAgIGRlc2M6IGxvYygiQ29va2llIHByb2R1Y3Rpb24geCUxIGZvciAlMiEiLCBbCiAgICAgICAgICBwb3csCiAgICAgICAgICBHYW1lLnNheVRpbWUodGltZSAqIEdhbWUuZnBzLCAtMSksCiAgICAgICAgXSksCiAgICAgICAgaWNvbjogWzI5LCAxNF0sCiAgICAgICAgdGltZTogdGltZSAqIEdhbWUuZnBzLAogICAgICAgIGFkZDogdHJ1ZSwKICAgICAgICBtdWx0Q3BTOiBwb3csCiAgICAgICAgYXVyYTogMCwKICAgICAgfTsKICAgIH0pOwogICAgbmV3IEdhbWUuYnVmZlR5cGUoImxvYW4gMSIsIGZ1bmN0aW9uICh0aW1lLCBwb3cpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBuYW1lOiAiTG9hbiAxIiwKICAgICAgICBkbmFtZTogbG9jKCJMb2FuICUxIiwgMSksCiAgICAgICAgZGVzYzogbG9jKCJDb29raWUgcHJvZHVjdGlvbiB4JTEgZm9yICUyISIsIFsKICAgICAgICAgIHBvdywKICAgICAgICAgIEdhbWUuc2F5VGltZSh0aW1lICogR2FtZS5mcHMsIC0xKSwKICAgICAgICBdKSwKICAgICAgICBpY29uOiBbMSwgMzNdLAogICAgICAgIHRpbWU6IHRpbWUgKiBHYW1lLmZwcywKICAgICAgICBwb3dlcjogcG93LAogICAgICAgIG11bHRDcFM6IHBvdywKICAgICAgICBtYXg6IHRydWUsCiAgICAgICAgb25EaWU6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGlmIChHYW1lLnRha2VMb2FuKSB7CiAgICAgICAgICAgIEdhbWUudGFrZUxvYW4oMSwgdHJ1ZSk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgfTsKICAgIH0pOwogICAgbmV3IEdhbWUuYnVmZlR5cGUoImxvYW4gMSBpbnRlcmVzdCIsIGZ1bmN0aW9uICh0aW1lLCBwb3cpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBuYW1lOiAiTG9hbiAxIChpbnRlcmVzdCkiLAogICAgICAgIGRuYW1lOiBsb2MoIkxvYW4gJTEgKGludGVyZXN0KSIsIDEpLAogICAgICAgIGRlc2M6IGxvYygiQ29va2llIHByb2R1Y3Rpb24geCUxIGZvciAlMiEiLCBbCiAgICAgICAgICBwb3csCiAgICAgICAgICBHYW1lLnNheVRpbWUodGltZSAqIEdhbWUuZnBzLCAtMSksCiAgICAgICAgXSksCiAgICAgICAgaWNvbjogWzEsIDMzXSwKICAgICAgICB0aW1lOiB0aW1lICogR2FtZS5mcHMsCiAgICAgICAgcG93ZXI6IHBvdywKICAgICAgICBtdWx0Q3BTOiBwb3csCiAgICAgICAgbWF4OiB0cnVlLAogICAgICB9OwogICAgfSk7CiAgICBuZXcgR2FtZS5idWZmVHlwZSgibG9hbiAyIiwgZnVuY3Rpb24gKHRpbWUsIHBvdykgewogICAgICByZXR1cm4gewogICAgICAgIG5hbWU6ICJMb2FuIDIiLAogICAgICAgIGRuYW1lOiBsb2MoIkxvYW4gJTEiLCAyKSwKICAgICAgICBkZXNjOiBsb2MoIkNvb2tpZSBwcm9kdWN0aW9uIHglMSBmb3IgJTIhIiwgWwogICAgICAgICAgcG93LAogICAgICAgICAgR2FtZS5zYXlUaW1lKHRpbWUgKiBHYW1lLmZwcywgLTEpLAogICAgICAgIF0pLAogICAgICAgIGljb246IFsxLCAzM10sCiAgICAgICAgdGltZTogdGltZSAqIEdhbWUuZnBzLAogICAgICAgIHBvd2VyOiBwb3csCiAgICAgICAgbXVsdENwUzogcG93LAogICAgICAgIG1heDogdHJ1ZSwKICAgICAgICBvbkRpZTogZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKEdhbWUudGFrZUxvYW4pIHsKICAgICAgICAgICAgR2FtZS50YWtlTG9hbigyLCB0cnVlKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICB9OwogICAgfSk7CiAgICBuZXcgR2FtZS5idWZmVHlwZSgibG9hbiAyIGludGVyZXN0IiwgZnVuY3Rpb24gKHRpbWUsIHBvdykgewogICAgICByZXR1cm4gewogICAgICAgIG5hbWU6ICJMb2FuIDIgKGludGVyZXN0KSIsCiAgICAgICAgZG5hbWU6IGxvYygiTG9hbiAlMSAoaW50ZXJlc3QpIiwgMiksCiAgICAgICAgZGVzYzogbG9jKCJDb29raWUgcHJvZHVjdGlvbiB4JTEgZm9yICUyISIsIFsKICAgICAgICAgIHBvdywKICAgICAgICAgIEdhbWUuc2F5VGltZSh0aW1lICogR2FtZS5mcHMsIC0xKSwKICAgICAgICBdKSwKICAgICAgICBpY29uOiBbMSwgMzNdLAogICAgICAgIHRpbWU6IHRpbWUgKiBHYW1lLmZwcywKICAgICAgICBwb3dlcjogcG93LAogICAgICAgIG11bHRDcFM6IHBvdywKICAgICAgICBtYXg6IHRydWUsCiAgICAgIH07CiAgICB9KTsKICAgIG5ldyBHYW1lLmJ1ZmZUeXBlKCJsb2FuIDMiLCBmdW5jdGlvbiAodGltZSwgcG93KSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgbmFtZTogIkxvYW4gMyIsCiAgICAgICAgZG5hbWU6IGxvYygiTG9hbiAlMSIsIDMpLAogICAgICAgIGRlc2M6IGxvYygiQ29va2llIHByb2R1Y3Rpb24geCUxIGZvciAlMiEiLCBbCiAgICAgICAgICBwb3csCiAgICAgICAgICBHYW1lLnNheVRpbWUodGltZSAqIEdhbWUuZnBzLCAtMSksCiAgICAgICAgXSksCiAgICAgICAgaWNvbjogWzEsIDMzXSwKICAgICAgICB0aW1lOiB0aW1lICogR2FtZS5mcHMsCiAgICAgICAgcG93ZXI6IHBvdywKICAgICAgICBtdWx0Q3BTOiBwb3csCiAgICAgICAgbWF4OiB0cnVlLAogICAgICAgIG9uRGllOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAoR2FtZS50YWtlTG9hbikgewogICAgICAgICAgICBHYW1lLnRha2VMb2FuKDMsIHRydWUpOwogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgIH07CiAgICB9KTsKICAgIG5ldyBHYW1lLmJ1ZmZUeXBlKCJsb2FuIDMgaW50ZXJlc3QiLCBmdW5jdGlvbiAodGltZSwgcG93KSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgbmFtZTogIkxvYW4gMyAoaW50ZXJlc3QpIiwKICAgICAgICBkbmFtZTogbG9jKCJMb2FuICUxIChpbnRlcmVzdCkiLCAzKSwKICAgICAgICBkZXNjOiBsb2MoIkNvb2tpZSBwcm9kdWN0aW9uIHglMSBmb3IgJTIhIiwgWwogICAgICAgICAgcG93LAogICAgICAgICAgR2FtZS5zYXlUaW1lKHRpbWUgKiBHYW1lLmZwcywgLTEpLAogICAgICAgIF0pLAogICAgICAgIGljb246IFsxLCAzM10sCiAgICAgICAgdGltZTogdGltZSAqIEdhbWUuZnBzLAogICAgICAgIHBvd2VyOiBwb3csCiAgICAgICAgbXVsdENwUzogcG93LAogICAgICAgIG1heDogdHJ1ZSwKICAgICAgfTsKICAgIH0pOwoKICAgIC8vZW5kIG9mIGJ1ZmZzCgogICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkJR1JBTkRNQVBPQ0FMWVBTRQoJCT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCiAgICBHYW1lLlVwZGF0ZUdyYW5kbWFwb2NhbHlwc2UgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChHYW1lLkhhcygiRWxkZXIgQ292ZW5hbnQiKSB8fCBHYW1lLk9iamVjdHNbIkdyYW5kbWEiXS5hbW91bnQgPT0gMCkKICAgICAgICBHYW1lLmVsZGVyV3JhdGggPSAwOwogICAgICBlbHNlIGlmIChHYW1lLnBsZWRnZVQgPiAwKSB7CiAgICAgICAgLy9pZiB0aGUgcGxlZGdlIGlzIGFjdGl2ZSwgbG93ZXIgaXQKICAgICAgICBHYW1lLnBsZWRnZVQtLTsKICAgICAgICBpZiAoR2FtZS5wbGVkZ2VUID09IDApIHsKICAgICAgICAgIC8vZGlkIHdlIHJlYWNoIDA/IG1ha2UgdGhlIHBsZWRnZSBwdXJjaGFzYWJsZSBhZ2FpbgogICAgICAgICAgR2FtZS5Mb2NrKCJFbGRlciBQbGVkZ2UiKTsKICAgICAgICAgIEdhbWUuVW5sb2NrKCJFbGRlciBQbGVkZ2UiKTsKICAgICAgICAgIEdhbWUuZWxkZXJXcmF0aCA9IDE7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmIChHYW1lLkhhcygiT25lIG1pbmQiKSAmJiBHYW1lLmVsZGVyV3JhdGggPT0gMCkgewogICAgICAgICAgR2FtZS5lbGRlcldyYXRoID0gMTsKICAgICAgICB9CiAgICAgICAgaWYgKAogICAgICAgICAgTWF0aC5yYW5kb20oKSA8IDAuMDAxICYmCiAgICAgICAgICBHYW1lLmVsZGVyV3JhdGggPAogICAgICAgICAgICBHYW1lLkhhcygiT25lIG1pbmQiKSArCiAgICAgICAgICAgICAgR2FtZS5IYXMoIkNvbW11bmFsIGJyYWluc3dlZXAiKSArCiAgICAgICAgICAgICAgR2FtZS5IYXMoIkVsZGVyIFBhY3QiKQogICAgICAgICkgewogICAgICAgICAgR2FtZS5lbGRlcldyYXRoKys7IC8vaGF2ZSB3ZSBhbHJlYWR5IHBsZWRnZWQ/IG1ha2UgdGhlIGVsZGVyIHdyYXRoIHNoaWZ0IGJldHdlZW4gZGlmZmVyZW50IHN0YWdlcwogICAgICAgIH0KICAgICAgICBpZiAoCiAgICAgICAgICBHYW1lLkhhcygiRWxkZXIgUGFjdCIpICYmCiAgICAgICAgICBHYW1lLlVwZ3JhZGVzWyJFbGRlciBQbGVkZ2UiXS51bmxvY2tlZCA9PSAwCiAgICAgICAgKSB7CiAgICAgICAgICBHYW1lLkxvY2soIkVsZGVyIFBsZWRnZSIpOwogICAgICAgICAgR2FtZS5VbmxvY2soIkVsZGVyIFBsZWRnZSIpOwogICAgICAgIH0KICAgICAgfQogICAgICBHYW1lLmVsZGVyV3JhdGhEICs9IChHYW1lLmVsZGVyV3JhdGggKyAxIC0gR2FtZS5lbGRlcldyYXRoRCkgKiAwLjAwMTsgLy9zbG93bHkgZmFkZSB0byB0aGUgdGFyZ2V0IHdyYXRoIHN0YXRlCgogICAgICBpZiAoR2FtZS5lbGRlcldyYXRoICE9IEdhbWUuZWxkZXJXcmF0aE9sZCkgewogICAgICAgIGlmIChHYW1lLmNsaWNrc1RoaXNTZXNzaW9uID4gMCkgewogICAgICAgICAgaWYgKEdhbWUuZWxkZXJXcmF0aCA+PSAzKSBQbGF5Q3VlKCJmYWRlVG8iLCAiZ3JhbmRtYXBvY2FseXBzZSIpOwogICAgICAgICAgZWxzZSBQbGF5Q3VlKCJmYWRlVG8iLCAiY2xpY2siKTsKICAgICAgICB9CiAgICAgICAgR2FtZS5zdG9yZVRvUmVmcmVzaCA9IDE7CiAgICAgIH0KCiAgICAgIEdhbWUuZWxkZXJXcmF0aE9sZCA9IEdhbWUuZWxkZXJXcmF0aDsKCiAgICAgIEdhbWUuVXBkYXRlV3JpbmtsZXJzKCk7CiAgICB9OwoKICAgIC8vd3JpbmtsZXJzCgogICAgZnVuY3Rpb24gaW5SZWN0KHgsIHksIHJlY3QpIHsKICAgICAgLy9maW5kIG91dCBpZiB0aGUgcG9pbnQgeCx5IGlzIGluIHRoZSByb3RhdGVkIHJlY3RhbmdsZSByZWN0e3csaCxyLG99ICh3aWR0aCxoZWlnaHQscm90YXRpb24gaW4gcmFkaWFucyx5LW9yaWdpbikgKG5lZWRzIHRvIGJlIG5vcm1hbGl6ZWQpCiAgICAgIC8vSSBmb3VuZCB0aGlzIHNvbWV3aGVyZSBvbmxpbmUgSSBndWVzcwogICAgICB2YXIgZHggPSB4ICsgTWF0aC5zaW4oLXJlY3QucikgKiAtKHJlY3QuaCAvIDIgLSByZWN0Lm8pLAogICAgICAgIGR5ID0geSArIE1hdGguY29zKC1yZWN0LnIpICogLShyZWN0LmggLyAyIC0gcmVjdC5vKTsKICAgICAgdmFyIGgxID0gTWF0aC5zcXJ0KGR4ICogZHggKyBkeSAqIGR5KTsKICAgICAgdmFyIGN1cnJBID0gTWF0aC5hdGFuMihkeSwgZHgpOwogICAgICB2YXIgbmV3QSA9IGN1cnJBIC0gcmVjdC5yOwogICAgICB2YXIgeDIgPSBNYXRoLmNvcyhuZXdBKSAqIGgxOwogICAgICB2YXIgeTIgPSBNYXRoLnNpbihuZXdBKSAqIGgxOwogICAgICBpZiAoCiAgICAgICAgeDIgPiAtMC41ICogcmVjdC53ICYmCiAgICAgICAgeDIgPCAwLjUgKiByZWN0LncgJiYKICAgICAgICB5MiA+IC0wLjUgKiByZWN0LmggJiYKICAgICAgICB5MiA8IDAuNSAqIHJlY3QuaAogICAgICApCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBHYW1lLndyaW5rbGVySFAgPSAyLjE7CiAgICBHYW1lLndyaW5rbGVycyA9IFtdOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxMjsgaSsrKSB7CiAgICAgIEdhbWUud3JpbmtsZXJzLnB1c2goewogICAgICAgIGlkOiBwYXJzZUludChpKSwKICAgICAgICBjbG9zZTogMCwKICAgICAgICBzdWNrZWQ6IDAsCiAgICAgICAgcGhhc2U6IDAsCiAgICAgICAgeDogMCwKICAgICAgICB5OiAwLAogICAgICAgIHI6IDAsCiAgICAgICAgaHVydDogMCwKICAgICAgICBocDogR2FtZS53cmlua2xlckhQLAogICAgICAgIHNlbGVjdGVkOiAwLAogICAgICAgIHR5cGU6IDAsCiAgICAgIH0pOwogICAgfQogICAgR2FtZS5nZXRXcmlua2xlcnNNYXggPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBuID0gMTA7CiAgICAgIGlmIChHYW1lLkhhcygiRWxkZXIgc3BpY2UiKSkgbiArPSAyOwogICAgICByZXR1cm4gbjsKICAgIH07CiAgICBHYW1lLlJlc2V0V3JpbmtsZXJzID0gZnVuY3Rpb24gKCkgewogICAgICBmb3IgKHZhciBpIGluIEdhbWUud3JpbmtsZXJzKSB7CiAgICAgICAgR2FtZS53cmlua2xlcnNbaV0gPSB7CiAgICAgICAgICBpZDogcGFyc2VJbnQoaSksCiAgICAgICAgICBjbG9zZTogMCwKICAgICAgICAgIHN1Y2tlZDogMCwKICAgICAgICAgIHBoYXNlOiAwLAogICAgICAgICAgeDogMCwKICAgICAgICAgIHk6IDAsCiAgICAgICAgICByOiAwLAogICAgICAgICAgaHVydDogMCwKICAgICAgICAgIGhwOiBHYW1lLndyaW5rbGVySFAsCiAgICAgICAgICBzZWxlY3RlZDogMCwKICAgICAgICAgIHR5cGU6IDAsCiAgICAgICAgfTsKICAgICAgfQogICAgfTsKICAgIEdhbWUuQ29sbGVjdFdyaW5rbGVycyA9IGZ1bmN0aW9uICgpIHsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLndyaW5rbGVycykgewogICAgICAgIEdhbWUud3JpbmtsZXJzW2ldLmhwID0gMDsKICAgICAgfQogICAgfTsKICAgIEdhbWUud3JpbmtsZXJTcXVpc2hTb3VuZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDQpICsgMTsKICAgIEdhbWUucGxheVdyaW5rbGVyU3F1aXNoU291bmQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIFBsYXlTb3VuZCgKICAgICAgICAic25kLyIgKwogICAgICAgICAgKEdhbWUuV0lOS0xFUlMgPyAic3F1ZWFrIiA6ICJzcXVpc2giKSArCiAgICAgICAgICBHYW1lLndyaW5rbGVyU3F1aXNoU291bmQgKwogICAgICAgICAgIi5tcDMiLAogICAgICAgIDAuNQogICAgICApOwogICAgICBHYW1lLndyaW5rbGVyU3F1aXNoU291bmQgKz0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMS41KSArIDE7CiAgICAgIGlmIChHYW1lLndyaW5rbGVyU3F1aXNoU291bmQgPiA0KSBHYW1lLndyaW5rbGVyU3F1aXNoU291bmQgLT0gNDsKICAgIH07CiAgICBHYW1lLlNwYXduV3JpbmtsZXIgPSBmdW5jdGlvbiAobWUpIHsKICAgICAgaWYgKCFtZSkgewogICAgICAgIHZhciBtYXggPSBHYW1lLmdldFdyaW5rbGVyc01heCgpOwogICAgICAgIHZhciBuID0gMDsKICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUud3JpbmtsZXJzKSB7CiAgICAgICAgICBpZiAoR2FtZS53cmlua2xlcnNbaV0ucGhhc2UgPiAwKSBuKys7CiAgICAgICAgfQogICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS53cmlua2xlcnMpIHsKICAgICAgICAgIHZhciBpdCA9IEdhbWUud3JpbmtsZXJzW2ldOwogICAgICAgICAgaWYgKGl0LnBoYXNlID09IDAgJiYgR2FtZS5lbGRlcldyYXRoID4gMCAmJiBuIDwgbWF4ICYmIGl0LmlkIDwgbWF4KSB7CiAgICAgICAgICAgIG1lID0gaXQ7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoIW1lKSByZXR1cm4gZmFsc2U7CiAgICAgIG1lLnBoYXNlID0gMTsKICAgICAgbWUuaHAgPSBHYW1lLndyaW5rbGVySFA7CiAgICAgIG1lLnR5cGUgPSAwOwogICAgICBpZiAoTWF0aC5yYW5kb20oKSA8IDAuMDAwMSkgbWUudHlwZSA9IDE7IC8vc2hpbnkgd3JpbmtsZXIKICAgICAgcmV0dXJuIG1lOwogICAgfTsKICAgIEdhbWUuUG9wUmFuZG9tV3JpbmtsZXIgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciB3cmlua2xlcnMgPSBbXTsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLndyaW5rbGVycykgewogICAgICAgIGlmIChHYW1lLndyaW5rbGVyc1tpXS5waGFzZSA+IDAgJiYgR2FtZS53cmlua2xlcnNbaV0uaHAgPiAwKQogICAgICAgICAgd3JpbmtsZXJzLnB1c2goR2FtZS53cmlua2xlcnNbaV0pOwogICAgICB9CiAgICAgIGlmICh3cmlua2xlcnMubGVuZ3RoID4gMCkgewogICAgICAgIHZhciBtZSA9IGNob29zZSh3cmlua2xlcnMpOwogICAgICAgIG1lLmhwID0gLTEwOwogICAgICAgIHJldHVybiBtZTsKICAgICAgfQogICAgICByZXR1cm4gZmFsc2U7CiAgICB9OwogICAgR2FtZS5VcGRhdGVXcmlua2xlcnMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciB4QmFzZSA9IDA7CiAgICAgIHZhciB5QmFzZSA9IDA7CiAgICAgIHZhciBvbldyaW5rbGVyID0gMDsKICAgICAgaWYgKEdhbWUuTGVmdEJhY2tncm91bmQpIHsKICAgICAgICB4QmFzZSA9IEdhbWUuY29va2llT3JpZ2luWDsKICAgICAgICB5QmFzZSA9IEdhbWUuY29va2llT3JpZ2luWTsKICAgICAgfQogICAgICB2YXIgbWF4ID0gR2FtZS5nZXRXcmlua2xlcnNNYXgoKTsKICAgICAgdmFyIG4gPSAwOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUud3JpbmtsZXJzKSB7CiAgICAgICAgaWYgKEdhbWUud3JpbmtsZXJzW2ldLnBoYXNlID4gMCkgbisrOwogICAgICB9CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS53cmlua2xlcnMpIHsKICAgICAgICB2YXIgbWUgPSBHYW1lLndyaW5rbGVyc1tpXTsKICAgICAgICBpZiAobWUucGhhc2UgPT0gMCAmJiBHYW1lLmVsZGVyV3JhdGggPiAwICYmIG4gPCBtYXggJiYgbWUuaWQgPCBtYXgpIHsKICAgICAgICAgIHZhciBjaGFuY2UgPSAwLjAwMDAxICogR2FtZS5lbGRlcldyYXRoOwogICAgICAgICAgY2hhbmNlICo9IEdhbWUuZWZmKCJ3cmlua2xlclNwYXduIik7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIlVuaG9seSBiYWl0IikpIGNoYW5jZSAqPSA1OwogICAgICAgICAgaWYgKEdhbWUuaGFzR29kKSB7CiAgICAgICAgICAgIHZhciBnb2RMdmwgPSBHYW1lLmhhc0dvZCgic2Nvcm4iKTsKICAgICAgICAgICAgaWYgKGdvZEx2bCA9PSAxKSBjaGFuY2UgKj0gMi41OwogICAgICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMikgY2hhbmNlICo9IDI7CiAgICAgICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAzKSBjaGFuY2UgKj0gMS41OwogICAgICAgICAgfQogICAgICAgICAgaWYgKEdhbWUuSGFzKCJXcmlua2xlciBkb29ybWF0IikpIGNoYW5jZSA9IDAuMTsKICAgICAgICAgIGlmIChNYXRoLnJhbmRvbSgpIDwgY2hhbmNlKSB7CiAgICAgICAgICAgIC8vcmVzcGF3bgogICAgICAgICAgICBHYW1lLlNwYXduV3JpbmtsZXIobWUpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAobWUucGhhc2UgPiAwKSB7CiAgICAgICAgICBpZiAobWUuY2xvc2UgPCAxKSBtZS5jbG9zZSArPSAxIC8gR2FtZS5mcHMgLyAxMDsKICAgICAgICAgIGlmIChtZS5jbG9zZSA+IDEpIG1lLmNsb3NlID0gMTsKICAgICAgICB9IGVsc2UgbWUuY2xvc2UgPSAwOwogICAgICAgIGlmIChtZS5jbG9zZSA9PSAxICYmIG1lLnBoYXNlID09IDEpIHsKICAgICAgICAgIG1lLnBoYXNlID0gMjsKICAgICAgICAgIEdhbWUucmVjYWxjdWxhdGVHYWlucyA9IDE7CiAgICAgICAgfQogICAgICAgIGlmIChtZS5waGFzZSA9PSAyKSB7CiAgICAgICAgICBtZS5zdWNrZWQgKz0gKEdhbWUuY29va2llc1BzIC8gR2FtZS5mcHMpICogR2FtZS5jcHNTdWNrZWQ7IC8vc3VjayB0aGUgY29va2llcwogICAgICAgIH0KICAgICAgICBpZiAobWUucGhhc2UgPiAwKSB7CiAgICAgICAgICBpZiAobWUudHlwZSA9PSAwKSB7CiAgICAgICAgICAgIGlmIChtZS5ocCA8IEdhbWUud3JpbmtsZXJIUCkgbWUuaHAgKz0gMC4wNDsKICAgICAgICAgICAgbWUuaHAgPSBNYXRoLm1pbihHYW1lLndyaW5rbGVySFAsIG1lLmhwKTsKICAgICAgICAgIH0gZWxzZSBpZiAobWUudHlwZSA9PSAxKSB7CiAgICAgICAgICAgIGlmIChtZS5ocCA8IEdhbWUud3JpbmtsZXJIUCAqIDMpIG1lLmhwICs9IDAuMDQ7CiAgICAgICAgICAgIG1lLmhwID0gTWF0aC5taW4oR2FtZS53cmlua2xlckhQICogMywgbWUuaHApOwogICAgICAgICAgfQogICAgICAgICAgdmFyIGQgPSAxMjggKiAoMiAtIG1lLmNsb3NlKTsgLy8qR2FtZS5CaWdDb29raWVTaXplOwogICAgICAgICAgaWYgKEdhbWUucHJlZnMuZmFuY3kpCiAgICAgICAgICAgIGQgKz0gTWF0aC5jb3MoR2FtZS5UICogMC4wNSArIHBhcnNlSW50KG1lLmlkKSkgKiA0OwogICAgICAgICAgbWUuciA9IChtZS5pZCAvIG1heCkgKiAzNjA7CiAgICAgICAgICBpZiAoR2FtZS5wcmVmcy5mYW5jeSkKICAgICAgICAgICAgbWUuciArPSBNYXRoLnNpbihHYW1lLlQgKiAwLjA1ICsgcGFyc2VJbnQobWUuaWQpKSAqIDQ7CiAgICAgICAgICBtZS54ID0geEJhc2UgKyBNYXRoLnNpbigobWUuciAqIE1hdGguUEkpIC8gMTgwKSAqIGQ7CiAgICAgICAgICBtZS55ID0geUJhc2UgKyBNYXRoLmNvcygobWUuciAqIE1hdGguUEkpIC8gMTgwKSAqIGQ7CiAgICAgICAgICBpZiAoR2FtZS5wcmVmcy5mYW5jeSkKICAgICAgICAgICAgbWUuciArPSBNYXRoLnNpbihHYW1lLlQgKiAwLjA5ICsgcGFyc2VJbnQobWUuaWQpKSAqIDQ7CiAgICAgICAgICB2YXIgcmVjdCA9IHsgdzogMTAwLCBoOiAyMDAsIHI6ICgtbWUuciAqIE1hdGguUEkpIC8gMTgwLCBvOiAxMCB9OwogICAgICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPCAwLjAxICYmICFHYW1lLnByZWZzLm5vdFNjYXJ5KQogICAgICAgICAgICBtZS5odXJ0ID0gTWF0aC5tYXgobWUuaHVydCwgTWF0aC5yYW5kb20oKSk7CiAgICAgICAgICBpZiAoR2FtZS5UICUgNSA9PSAwICYmIEdhbWUuQ2FuQ2xpY2spIHsKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgIEdhbWUuTGVmdEJhY2tncm91bmQgJiYKICAgICAgICAgICAgICBHYW1lLm1vdXNlWCA8IEdhbWUuTGVmdEJhY2tncm91bmQuY2FudmFzLndpZHRoICYmCiAgICAgICAgICAgICAgaW5SZWN0KEdhbWUubW91c2VYIC0gbWUueCwgR2FtZS5tb3VzZVkgLSBtZS55LCByZWN0KQogICAgICAgICAgICApCiAgICAgICAgICAgICAgbWUuc2VsZWN0ZWQgPSAxOwogICAgICAgICAgICBlbHNlIG1lLnNlbGVjdGVkID0gMDsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChtZS5zZWxlY3RlZCAmJiBvbldyaW5rbGVyID09IDAgJiYgR2FtZS5DYW5DbGljaykgewogICAgICAgICAgICBtZS5odXJ0ID0gTWF0aC5tYXgobWUuaHVydCwgMC4yNSk7CiAgICAgICAgICAgIC8vbWUuY2xvc2UqPTAuOTk7CiAgICAgICAgICAgIGlmIChHYW1lLkNsaWNrICYmIEdhbWUubGFzdENsaWNrZWRFbCA9PSBsKCJiYWNrZ3JvdW5kTGVmdENhbnZhcyIpKSB7CiAgICAgICAgICAgICAgaWYgKEdhbWUua2V5c1sxN10gJiYgR2FtZS5zZXNhbWUpIHsKICAgICAgICAgICAgICAgIG1lLnR5cGUgPSAhbWUudHlwZTsKICAgICAgICAgICAgICAgIFBsYXlTb3VuZCgic25kL3NoaW1tZXJDbGljay5tcDMiKTsKICAgICAgICAgICAgICB9IC8vY3RybC1jbGljayBvbiBhIHdyaW5rbGVyIGluIGdvZCBtb2RlIHRvIHRvZ2dsZSBpdHMgc2hpbmluZXNzCiAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBHYW1lLnBsYXlXcmlua2xlclNxdWlzaFNvdW5kKCk7CiAgICAgICAgICAgICAgICBtZS5odXJ0ID0gMTsKICAgICAgICAgICAgICAgIG1lLmhwIC09IDAuNzU7CiAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgIEdhbWUucHJlZnMucGFydGljbGVzICYmCiAgICAgICAgICAgICAgICAgICFHYW1lLnByZWZzLm5vdFNjYXJ5ICYmCiAgICAgICAgICAgICAgICAgICFHYW1lLldJTktMRVJTICYmCiAgICAgICAgICAgICAgICAgICEobWUuaHAgPD0gMC41ICYmIG1lLnBoYXNlID4gMCkKICAgICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgICB2YXIgeCA9IG1lLnggKyBNYXRoLnNpbigobWUuciAqIE1hdGguUEkpIC8gMTgwKSAqIDkwOwogICAgICAgICAgICAgICAgICB2YXIgeSA9IG1lLnkgKyBNYXRoLmNvcygobWUuciAqIE1hdGguUEkpIC8gMTgwKSAqIDkwOwogICAgICAgICAgICAgICAgICBmb3IgKHZhciBpaSA9IDA7IGlpIDwgMzsgaWkrKykgewogICAgICAgICAgICAgICAgICAgIC8vR2FtZS5wYXJ0aWNsZUFkZCh4K01hdGgucmFuZG9tKCkqNTAtMjUseStNYXRoLnJhbmRvbSgpKjUwLTI1LE1hdGgucmFuZG9tKCkqNC0yLE1hdGgucmFuZG9tKCkqLTItMiwxLDEsMiwnd3JpbmtsZXJCaXRzLnBuZycpOwogICAgICAgICAgICAgICAgICAgIHZhciBwYXJ0ID0gR2FtZS5wYXJ0aWNsZUFkZCgKICAgICAgICAgICAgICAgICAgICAgIHgsCiAgICAgICAgICAgICAgICAgICAgICB5LAogICAgICAgICAgICAgICAgICAgICAgTWF0aC5yYW5kb20oKSAqIDQgLSAyLAogICAgICAgICAgICAgICAgICAgICAgTWF0aC5yYW5kb20oKSAqIC0yIC0gMiwKICAgICAgICAgICAgICAgICAgICAgIDEsCiAgICAgICAgICAgICAgICAgICAgICAxLAogICAgICAgICAgICAgICAgICAgICAgMiwKICAgICAgICAgICAgICAgICAgICAgIG1lLnR5cGUgPT0gMQogICAgICAgICAgICAgICAgICAgICAgICA/ICJzaGlueVdyaW5rbGVyQml0cy5wbmciCiAgICAgICAgICAgICAgICAgICAgICAgIDogIndyaW5rbGVyQml0cy5wbmciCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICBwYXJ0LnIgPSAtbWUucjsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBHYW1lLkNsaWNrID0gMDsKICAgICAgICAgICAgfQogICAgICAgICAgICBvbldyaW5rbGVyID0gMTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChtZS5odXJ0ID4gMCkgewogICAgICAgICAgbWUuaHVydCAtPSA1IC8gR2FtZS5mcHM7CiAgICAgICAgICAvL21lLmNsb3NlLT1tZS5odXJ0KjAuMDU7CiAgICAgICAgICAvL21lLngrPU1hdGgucmFuZG9tKCkqMi0xOwogICAgICAgICAgLy9tZS55Kz1NYXRoLnJhbmRvbSgpKjItMTsKICAgICAgICAgIG1lLnIgKz0gTWF0aC5zaW4oR2FtZS5UICogMSkgKiBtZS5odXJ0ICogMTg7IC8vTWF0aC5yYW5kb20oKSoyLTE7CiAgICAgICAgfQogICAgICAgIGlmIChtZS5ocCA8PSAwLjUgJiYgbWUucGhhc2UgPiAwKSB7CiAgICAgICAgICBHYW1lLnBsYXlXcmlua2xlclNxdWlzaFNvdW5kKCk7CiAgICAgICAgICBQbGF5U291bmQoCiAgICAgICAgICAgICJzbmQvcG9wIiArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDMgKyAxKSArICIubXAzIiwKICAgICAgICAgICAgMC43NQogICAgICAgICAgKTsKICAgICAgICAgIEdhbWUud3JpbmtsZXJzUG9wcGVkKys7CiAgICAgICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICAgICAgbWUucGhhc2UgPSAwOwogICAgICAgICAgbWUuY2xvc2UgPSAwOwogICAgICAgICAgbWUuaHVydCA9IDA7CiAgICAgICAgICBtZS5ocCA9IDM7CiAgICAgICAgICB2YXIgdG9TdWNrID0gMS4xOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJTYWNyaWxlZ2lvdXMgY29ycnVwdGlvbiIpKSB0b1N1Y2sgKj0gMS4wNTsKICAgICAgICAgIGlmIChtZS50eXBlID09IDEpIHRvU3VjayAqPSAzOyAvL3NoaW55IHdyaW5rbGVycyBhcmUgYW4gZWx1c2l2ZSwgcHJvZml0YWJsZSBicmVlZAogICAgICAgICAgbWUuc3Vja2VkICo9IHRvU3VjazsgLy9jb29raWUgZG91Z2ggZG9lcyB3ZWlyZCB0aGluZ3MgaW5zaWRlIHdyaW5rbGVyIGRpZ2VzdGl2ZSB0cmFjdHMKICAgICAgICAgIGlmIChHYW1lLkhhcygiV3JpbmtsZXJzcGF3biIpKSBtZS5zdWNrZWQgKj0gMS4wNTsKICAgICAgICAgIGlmIChHYW1lLmhhc0dvZCkgewogICAgICAgICAgICB2YXIgZ29kTHZsID0gR2FtZS5oYXNHb2QoInNjb3JuIik7CiAgICAgICAgICAgIGlmIChnb2RMdmwgPT0gMSkgbWUuc3Vja2VkICo9IDEuMTU7CiAgICAgICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAyKSBtZS5zdWNrZWQgKj0gMS4xOwogICAgICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMykgbWUuc3Vja2VkICo9IDEuMDU7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAobWUuc3Vja2VkID4gMC41KSB7CiAgICAgICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgICAgIG1lLnR5cGUgPT0gMQogICAgICAgICAgICAgICAgPyBsb2MoIkV4cGxvZGVkIGEgc2hpbnkgd3JpbmtsZXIiKQogICAgICAgICAgICAgICAgOiBsb2MoIkV4cGxvZGVkIGEgd3JpbmtsZXIiKSwKICAgICAgICAgICAgICBsb2MoIkZvdW5kIDxiPiUxPC9iPiEiLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeShtZS5zdWNrZWQpKSksCiAgICAgICAgICAgICAgWzE5LCA4XSwKICAgICAgICAgICAgICA2CiAgICAgICAgICAgICk7CiAgICAgICAgICAgIEdhbWUuUG9wdXAoCiAgICAgICAgICAgICAgJzxkaXYgc3R5bGU9ImZvbnQtc2l6ZTo4MCU7Ij4nICsKICAgICAgICAgICAgICAgIGxvYygiKyUxISIsIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KG1lLnN1Y2tlZCkpKSArCiAgICAgICAgICAgICAgICAiPC9kaXY+IiwKICAgICAgICAgICAgICBHYW1lLm1vdXNlWCwKICAgICAgICAgICAgICBHYW1lLm1vdXNlWQogICAgICAgICAgICApOwoKICAgICAgICAgICAgaWYgKEdhbWUuc2Vhc29uID09ICJoYWxsb3dlZW4iKSB7CiAgICAgICAgICAgICAgLy9pZiAoTWF0aC5yYW5kb20oKTwoR2FtZS5IYXNBY2hpZXYoJ1Nwb29reSBjb29raWVzJyk/MC4yOjAuMDUpKS8vaGFsbG93ZWVuIGNvb2tpZSBkcm9wcwogICAgICAgICAgICAgIHZhciBmYWlsUmF0ZSA9IDAuOTU7CiAgICAgICAgICAgICAgaWYgKEdhbWUuSGFzQWNoaWV2KCJTcG9va3kgY29va2llcyIpKSBmYWlsUmF0ZSA9IDAuODsKICAgICAgICAgICAgICBpZiAoR2FtZS5IYXMoIlN0YXJ0ZXJyb3IiKSkgZmFpbFJhdGUgKj0gMC45OwogICAgICAgICAgICAgIGZhaWxSYXRlICo9IDEgLyBHYW1lLmRyb3BSYXRlTXVsdCgpOwogICAgICAgICAgICAgIGlmIChHYW1lLmhhc0dvZCkgewogICAgICAgICAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJzZWFzb25zIik7CiAgICAgICAgICAgICAgICBpZiAoZ29kTHZsID09IDEpIGZhaWxSYXRlICo9IDAuOTsKICAgICAgICAgICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAyKSBmYWlsUmF0ZSAqPSAwLjk1OwogICAgICAgICAgICAgICAgZWxzZSBpZiAoZ29kTHZsID09IDMpIGZhaWxSYXRlICo9IDAuOTc7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmIChtZS50eXBlID09IDEpIGZhaWxSYXRlICo9IDAuOTsKICAgICAgICAgICAgICBpZiAoTWF0aC5yYW5kb20oKSA+IGZhaWxSYXRlKSB7CiAgICAgICAgICAgICAgICAvL2hhbGxvd2VlbiBjb29raWUgZHJvcHMKICAgICAgICAgICAgICAgIHZhciBjb29raWUgPSBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAiU2t1bGwgY29va2llcyIsCiAgICAgICAgICAgICAgICAgICJHaG9zdCBjb29raWVzIiwKICAgICAgICAgICAgICAgICAgIkJhdCBjb29raWVzIiwKICAgICAgICAgICAgICAgICAgIlNsaW1lIGNvb2tpZXMiLAogICAgICAgICAgICAgICAgICAiUHVtcGtpbiBjb29raWVzIiwKICAgICAgICAgICAgICAgICAgIkV5ZWJhbGwgY29va2llcyIsCiAgICAgICAgICAgICAgICAgICJTcGlkZXIgY29va2llcyIsCiAgICAgICAgICAgICAgICBdKTsKICAgICAgICAgICAgICAgIGlmICghR2FtZS5IYXNVbmxvY2tlZChjb29raWUpICYmICFHYW1lLkhhcyhjb29raWUpKSB7CiAgICAgICAgICAgICAgICAgIEdhbWUuVW5sb2NrKGNvb2tpZSk7CiAgICAgICAgICAgICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgICAgICAgICAgIEdhbWUuVXBncmFkZXNbY29va2llXS5kbmFtZSwKICAgICAgICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAgICAgICAiWW91IGFsc28gZm91bmQgPGI+JTE8L2I+ISIsCiAgICAgICAgICAgICAgICAgICAgICBHYW1lLlVwZ3JhZGVzW2Nvb2tpZV0uZG5hbWUKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIEdhbWUuVXBncmFkZXNbY29va2llXS5pY29uCiAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIEdhbWUuRHJvcEVnZygwLjk4KTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChtZS50eXBlID09IDEpIEdhbWUuV2luKCJMYXN0IENoYW5jZSB0byBTZWUiKTsKICAgICAgICAgIEdhbWUuRWFybihtZS5zdWNrZWQpOwogICAgICAgICAgLyppZiAoR2FtZS5wcmVmcy5wYXJ0aWNsZXMgJiYgIUdhbWUuV0lOS0xFUlMpCgkJCQkJewoJCQkJCQl2YXIgeD1tZS54KyhNYXRoLnNpbihtZS5yKk1hdGguUEkvMTgwKSoxMDApOwoJCQkJCQl2YXIgeT1tZS55KyhNYXRoLmNvcyhtZS5yKk1hdGguUEkvMTgwKSoxMDApOwoJCQkJCQlmb3IgKHZhciBpaT0wO2lpPDY7aWkrKykKCQkJCQkJewoJCQkJCQkJR2FtZS5wYXJ0aWNsZUFkZCh4K01hdGgucmFuZG9tKCkqNTAtMjUseStNYXRoLnJhbmRvbSgpKjUwLTI1LE1hdGgucmFuZG9tKCkqNC0yLE1hdGgucmFuZG9tKCkqLTItMiwxLDEsMiwnd3JpbmtsZXJCaXRzLnBuZycpOwoJCQkJCQl9CgkJCQkJfSovCiAgICAgICAgICBpZiAoR2FtZS5wcmVmcy5wYXJ0aWNsZXMpIHsKICAgICAgICAgICAgdmFyIHggPSBtZS54ICsgTWF0aC5zaW4oKG1lLnIgKiBNYXRoLlBJKSAvIDE4MCkgKiA5MDsKICAgICAgICAgICAgdmFyIHkgPSBtZS55ICsgTWF0aC5jb3MoKG1lLnIgKiBNYXRoLlBJKSAvIDE4MCkgKiA5MDsKICAgICAgICAgICAgaWYgKG1lLnN1Y2tlZCA+IDApIHsKICAgICAgICAgICAgICBmb3IgKHZhciBpaSA9IDA7IGlpIDwgNTsgaWkrKykgewogICAgICAgICAgICAgICAgR2FtZS5wYXJ0aWNsZUFkZCgKICAgICAgICAgICAgICAgICAgR2FtZS5tb3VzZVgsCiAgICAgICAgICAgICAgICAgIEdhbWUubW91c2VZLAogICAgICAgICAgICAgICAgICBNYXRoLnJhbmRvbSgpICogNCAtIDIsCiAgICAgICAgICAgICAgICAgIE1hdGgucmFuZG9tKCkgKiAtMiAtIDIsCiAgICAgICAgICAgICAgICAgIE1hdGgucmFuZG9tKCkgKiAwLjUgKyAwLjc1LAogICAgICAgICAgICAgICAgICAxLjUsCiAgICAgICAgICAgICAgICAgIDIKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghR2FtZS5wcmVmcy5ub3RTY2FyeSAmJiAhR2FtZS5XSU5LTEVSUykgewogICAgICAgICAgICAgIGZvciAodmFyIGlpID0gMDsgaWkgPCA4OyBpaSsrKSB7CiAgICAgICAgICAgICAgICB2YXIgcGFydCA9IEdhbWUucGFydGljbGVBZGQoCiAgICAgICAgICAgICAgICAgIHgsCiAgICAgICAgICAgICAgICAgIHksCiAgICAgICAgICAgICAgICAgIE1hdGgucmFuZG9tKCkgKiA0IC0gMiwKICAgICAgICAgICAgICAgICAgTWF0aC5yYW5kb20oKSAqIC0yIC0gMiwKICAgICAgICAgICAgICAgICAgMSwKICAgICAgICAgICAgICAgICAgMSwKICAgICAgICAgICAgICAgICAgMiwKICAgICAgICAgICAgICAgICAgbWUudHlwZSA9PSAxID8gInNoaW55V3JpbmtsZXJCaXRzLnBuZyIgOiAid3JpbmtsZXJCaXRzLnBuZyIKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICBwYXJ0LnIgPSAtbWUucjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIG1lLnN1Y2tlZCA9IDA7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChvbldyaW5rbGVyKSB7CiAgICAgICAgR2FtZS5tb3VzZVBvaW50ZXIgPSAxOwogICAgICB9CiAgICB9OwogICAgR2FtZS5EcmF3V3JpbmtsZXJzID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgY3R4ID0gR2FtZS5MZWZ0QmFja2dyb3VuZDsKICAgICAgdmFyIHNlbGVjdGVkID0gMDsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLndyaW5rbGVycykgewogICAgICAgIHZhciBtZSA9IEdhbWUud3JpbmtsZXJzW2ldOwogICAgICAgIGlmIChtZS5waGFzZSA+IDApIHsKICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IG1lLmNsb3NlOwogICAgICAgICAgY3R4LnNhdmUoKTsKICAgICAgICAgIGN0eC50cmFuc2xhdGUobWUueCwgbWUueSk7CiAgICAgICAgICB2YXIgc3cgPSAxMDAgKyAyICogTWF0aC5zaW4oR2FtZS5UICogMC4yICsgaSAqIDMpOwogICAgICAgICAgdmFyIHNoID0gMjAwICsgNSAqIE1hdGguc2luKEdhbWUuVCAqIDAuMiAtIDIgKyBpICogMyk7CiAgICAgICAgICBpZiAoR2FtZS5wcmVmcy5mYW5jeSkgewogICAgICAgICAgICBjdHgudHJhbnNsYXRlKDAsIDMwKTsKICAgICAgICAgICAgY3R4LnJvdGF0ZSgoLW1lLnIgKiBNYXRoLlBJKSAvIDE4MCk7CiAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoUGljKCJ3cmlua2xlclNoYWRvdy5wbmciKSwgLXN3IC8gMiwgLTEwLCBzdywgc2gpOwogICAgICAgICAgICBjdHgucm90YXRlKChtZS5yICogTWF0aC5QSSkgLyAxODApOwogICAgICAgICAgICBjdHgudHJhbnNsYXRlKDAsIC0zMCk7CiAgICAgICAgICB9CiAgICAgICAgICBjdHgucm90YXRlKCgtbWUuciAqIE1hdGguUEkpIC8gMTgwKTsKICAgICAgICAgIC8vdmFyIHM9TWF0aC5taW4oMSxtZS5zdWNrZWQvKEdhbWUuY29va2llc1BzKjYwKSkqMC43NSswLjI1Oy8vc2NhbGUgd3JpbmtsZXJzIGFzIHRoZXkgZWF0CiAgICAgICAgICAvL2N0eC5zY2FsZShNYXRoLnBvdyhzLDEuNSkqMS4yNSxzKTsKICAgICAgICAgIC8vY3R4LmZpbGxSZWN0KC01MCwtMTAsMTAwLDIwMCk7CiAgICAgICAgICB2YXIgcGljID0gR2FtZS5XSU5LTEVSUyA/ICJ3aW5rbGVyLnBuZyIgOiAid3JpbmtsZXIucG5nIjsKICAgICAgICAgIGlmIChtZS50eXBlID09IDEpCiAgICAgICAgICAgIHBpYyA9IEdhbWUuV0lOS0xFUlMgPyAic2hpbnlXaW5rbGVyLnBuZyIgOiAic2hpbnlXcmlua2xlci5wbmciOwogICAgICAgICAgZWxzZSBpZiAoR2FtZS5zZWFzb24gPT0gImNocmlzdG1hcyIpCiAgICAgICAgICAgIHBpYyA9IEdhbWUuV0lOS0xFUlMgPyAid2ludGVyV2lua2xlci5wbmciIDogIndpbnRlcldyaW5rbGVyLnBuZyI7CiAgICAgICAgICBjdHguZHJhd0ltYWdlKFBpYyhwaWMpLCAtc3cgLyAyLCAtMTAsIHN3LCBzaCk7CiAgICAgICAgICBpZiAoIUdhbWUuV0lOS0xFUlMgJiYgR2FtZS5wcmVmcy5ub3RTY2FyeSkKICAgICAgICAgICAgY3R4LmRyYXdJbWFnZSgKICAgICAgICAgICAgICBQaWMoCiAgICAgICAgICAgICAgICBNYXRoLnNpbigKICAgICAgICAgICAgICAgICAgR2FtZS5UICogMC4wMDMgKwogICAgICAgICAgICAgICAgICAgIGkgKiAxMSArCiAgICAgICAgICAgICAgICAgICAgMTM3ICsKICAgICAgICAgICAgICAgICAgICBNYXRoLnNpbihHYW1lLlQgKiAwLjAxNyArIGkgKiAxMykKICAgICAgICAgICAgICAgICkgPiAwLjk5OTcKICAgICAgICAgICAgICAgICAgPyAid3JpbmtsZXJCbGluay5wbmciCiAgICAgICAgICAgICAgICAgIDogIndyaW5rbGVyR29vZ2xpZXMucG5nIgogICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgLXN3IC8gMiwKICAgICAgICAgICAgICAtMTAgKyAxICogTWF0aC5zaW4oR2FtZS5UICogMC4yICsgaSAqIDMgKyAxLjIpLAogICAgICAgICAgICAgIHN3LAogICAgICAgICAgICAgIHNoCiAgICAgICAgICAgICk7CiAgICAgICAgICAvL2N0eC5kcmF3SW1hZ2UoUGljKHBpYyksLTUwLC0xMCk7CiAgICAgICAgICAvL2N0eC5maWxsVGV4dChtZS5pZCsnIDogJyttZS5zdWNrZWQsMCwwKTsKICAgICAgICAgIGlmIChtZS50eXBlID09IDEgJiYgTWF0aC5yYW5kb20oKSA8IDAuMyAmJiBHYW1lLnByZWZzLnBhcnRpY2xlcykgewogICAgICAgICAgICAvL3NwYXJrbGUKICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gTWF0aC5yYW5kb20oKSAqIDAuNjUgKyAwLjE7CiAgICAgICAgICAgIHZhciBzID0gTWF0aC5yYW5kb20oKSAqIDMwICsgNTsKICAgICAgICAgICAgY3R4Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9ICJsaWdodGVyIjsKICAgICAgICAgICAgY3R4LmRyYXdJbWFnZSgKICAgICAgICAgICAgICBQaWMoImdsaW50LmpwZyIpLAogICAgICAgICAgICAgIC1zIC8gMiArIE1hdGgucmFuZG9tKCkgKiA1MCAtIDI1LAogICAgICAgICAgICAgIC1zIC8gMiArIE1hdGgucmFuZG9tKCkgKiAyMDAsCiAgICAgICAgICAgICAgcywKICAgICAgICAgICAgICBzCiAgICAgICAgICAgICk7CiAgICAgICAgICB9CiAgICAgICAgICBjdHgucmVzdG9yZSgpOwoKICAgICAgICAgIGlmIChHYW1lLnByZWZzLnBhcnRpY2xlcyAmJiBtZS5waGFzZSA9PSAyICYmIE1hdGgucmFuZG9tKCkgPCAwLjAzKSB7CiAgICAgICAgICAgIEdhbWUucGFydGljbGVBZGQoCiAgICAgICAgICAgICAgbWUueCwKICAgICAgICAgICAgICBtZS55LAogICAgICAgICAgICAgIE1hdGgucmFuZG9tKCkgKiA0IC0gMiwKICAgICAgICAgICAgICBNYXRoLnJhbmRvbSgpICogLTIgLSAyLAogICAgICAgICAgICAgIE1hdGgucmFuZG9tKCkgKiAwLjUgKyAwLjUsCiAgICAgICAgICAgICAgMSwKICAgICAgICAgICAgICAyCiAgICAgICAgICAgICk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKG1lLnNlbGVjdGVkKSBzZWxlY3RlZCA9IG1lOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoc2VsZWN0ZWQgJiYgR2FtZS5IYXMoIkV5ZSBvZiB0aGUgd3JpbmtsZXIiKSkgewogICAgICAgIHZhciB4ID0gR2FtZS5jb29raWVPcmlnaW5YOwogICAgICAgIHZhciB5ID0gR2FtZS5jb29raWVPcmlnaW5ZOwogICAgICAgIGN0eC5mb250ID0gIjE0cHggTWVycml3ZWF0aGVyIjsKICAgICAgICBjdHgudGV4dEFsaWduID0gImNlbnRlciI7CiAgICAgICAgdmFyIHRleHQgPSBsb2MoIlN3YWxsb3dlZDoiKTsKICAgICAgICB2YXIgd2lkdGggPSBNYXRoLmNlaWwoCiAgICAgICAgICBNYXRoLm1heCgKICAgICAgICAgICAgY3R4Lm1lYXN1cmVUZXh0KHRleHQpLndpZHRoLAogICAgICAgICAgICBjdHgubWVhc3VyZVRleHQoQmVhdXRpZnkoc2VsZWN0ZWQuc3Vja2VkKSkud2lkdGgKICAgICAgICAgICkKICAgICAgICApOwogICAgICAgIGN0eC5maWxsU3R5bGUgPSAiIzAwMCI7CiAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMC42NTsKICAgICAgICAvKmN0eC5zdHJva2VTdHlsZT0nIzAwMCc7CgkJCQljdHgubGluZVdpZHRoPTg7CgkJCQljdHguYmVnaW5QYXRoKCk7CgkJCQljdHgubW92ZVRvKHgseSk7CgkJCQljdHgubGluZVRvKE1hdGguZmxvb3Ioc2VsZWN0ZWQueCksTWF0aC5mbG9vcihzZWxlY3RlZC55KSk7CgkJCQljdHguc3Ryb2tlKCk7Ki8KICAgICAgICB2YXIgeE8gPSB4IC0gd2lkdGggLyAyIC0gMTY7CiAgICAgICAgdmFyIHlPID0geSAtIDQ7CiAgICAgICAgdmFyIGRpc3QgPSBNYXRoLmZsb29yKAogICAgICAgICAgTWF0aC5zcXJ0KAogICAgICAgICAgICAoc2VsZWN0ZWQueCAtIHhPKSAqIChzZWxlY3RlZC54IC0geE8pICsKICAgICAgICAgICAgICAoc2VsZWN0ZWQueSAtIHlPKSAqIChzZWxlY3RlZC55IC0geU8pCiAgICAgICAgICApCiAgICAgICAgKTsKICAgICAgICB2YXIgYW5nbGUgPSAtTWF0aC5hdGFuMih5TyAtIHNlbGVjdGVkLnksIHhPIC0gc2VsZWN0ZWQueCkgKyBNYXRoLlBJIC8gMjsKICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSAiI2ZmZiI7CiAgICAgICAgY3R4LmxpbmVXaWR0aCA9IDE7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBNYXRoLmZsb29yKGRpc3QgLyAxMik7IGkrKykgewogICAgICAgICAgdmFyIHhDID0gc2VsZWN0ZWQueCArIE1hdGguc2luKGFuZ2xlKSAqIGkgKiAxMjsKICAgICAgICAgIHZhciB5QyA9IHNlbGVjdGVkLnkgKyBNYXRoLmNvcyhhbmdsZSkgKiBpICogMTI7CiAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7CiAgICAgICAgICBjdHguYXJjKAogICAgICAgICAgICB4QywKICAgICAgICAgICAgeUMsCiAgICAgICAgICAgIDQgKwogICAgICAgICAgICAgIChHYW1lLnByZWZzLmZhbmN5CiAgICAgICAgICAgICAgICA/IDIgKiBNYXRoLnBvdyhNYXRoLnNpbigtR2FtZS5UICogMC4yICsgaSAqIDAuMyksIDQpCiAgICAgICAgICAgICAgICA6IDApLAogICAgICAgICAgICAwLAogICAgICAgICAgICAyICogTWF0aC5QSSwKICAgICAgICAgICAgZmFsc2UKICAgICAgICAgICk7CiAgICAgICAgICBjdHguZmlsbCgpOwogICAgICAgICAgY3R4LnN0cm9rZSgpOwogICAgICAgIH0KICAgICAgICBjdHguZmlsbFJlY3QoeCAtIHdpZHRoIC8gMiAtIDggLSAxMCwgeSAtIDIzLCB3aWR0aCArIDE2ICsgMjAsIDM4KTsKICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSAiI2ZmZiI7CiAgICAgICAgY3R4LmxpbmVXaWR0aCA9IDE7CiAgICAgICAgY3R4LnN0cm9rZVJlY3QoCiAgICAgICAgICB4IC0gd2lkdGggLyAyIC0gOCAtIDEwICsgMS41LAogICAgICAgICAgeSAtIDIzICsgMS41LAogICAgICAgICAgd2lkdGggKyAxNiArIDIwIC0gMywKICAgICAgICAgIDM4IC0gMwogICAgICAgICk7CiAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMTsKICAgICAgICBjdHguZmlsbFN0eWxlID0gIiNmZmYiOwogICAgICAgIGN0eC5maWxsVGV4dCh0ZXh0LCB4ICsgMTQsIHkgLSA4KTsKICAgICAgICBjdHguZmlsbFRleHQoQmVhdXRpZnkoc2VsZWN0ZWQuc3Vja2VkKSwgeCArIDEwLCB5ICsgOCk7CiAgICAgICAgdmFyIHMgPSA1NCArIDIgKiBNYXRoLnNpbihHYW1lLlQgKiAwLjQpOwogICAgICAgIGN0eC5kcmF3SW1hZ2UoCiAgICAgICAgICBQaWMoImljb25zLnBuZyIpLAogICAgICAgICAgMjcgKiA0OCwKICAgICAgICAgIDI2ICogNDgsCiAgICAgICAgICA0OCwKICAgICAgICAgIDQ4LAogICAgICAgICAgeCAtIHdpZHRoIC8gMiAtIDE2IC0gcyAvIDIsCiAgICAgICAgICB5IC0gNCAtIHMgLyAyLAogICAgICAgICAgcywKICAgICAgICAgIHMKICAgICAgICApOwogICAgICB9CiAgICB9OwogICAgR2FtZS5TYXZlV3JpbmtsZXJzID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgYW1vdW50ID0gMDsKICAgICAgdmFyIGFtb3VudFNoaW5pZXMgPSAwOwogICAgICB2YXIgbnVtYmVyID0gMDsKICAgICAgdmFyIHNoaW5pZXMgPSAwOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUud3JpbmtsZXJzKSB7CiAgICAgICAgaWYgKEdhbWUud3JpbmtsZXJzW2ldLnN1Y2tlZCA+IDAuNSkgewogICAgICAgICAgbnVtYmVyKys7CiAgICAgICAgICBpZiAoR2FtZS53cmlua2xlcnNbaV0udHlwZSA9PSAxKSB7CiAgICAgICAgICAgIHNoaW5pZXMrKzsKICAgICAgICAgICAgYW1vdW50U2hpbmllcyArPSBHYW1lLndyaW5rbGVyc1tpXS5zdWNrZWQ7CiAgICAgICAgICB9IGVsc2UgYW1vdW50ICs9IEdhbWUud3JpbmtsZXJzW2ldLnN1Y2tlZDsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHsKICAgICAgICBhbW91bnQ6IGFtb3VudCwKICAgICAgICBudW1iZXI6IG51bWJlciwKICAgICAgICBzaGluaWVzOiBzaGluaWVzLAogICAgICAgIGFtb3VudFNoaW5pZXM6IGFtb3VudFNoaW5pZXMsCiAgICAgIH07CiAgICB9OwogICAgR2FtZS5Mb2FkV3JpbmtsZXJzID0gZnVuY3Rpb24gKGFtb3VudCwgbnVtYmVyLCBzaGluaWVzLCBhbW91bnRTaGluaWVzKSB7CiAgICAgIGlmIChudW1iZXIgPiAwICYmIChhbW91bnQgPiAwIHx8IGFtb3VudFNoaW5pZXMgPiAwKSkgewogICAgICAgIHZhciBmdWxsTnVtYmVyID0gbnVtYmVyIC0gc2hpbmllczsKICAgICAgICB2YXIgZnVsbE51bWJlclNoaW5pZXMgPSBzaGluaWVzOwogICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS53cmlua2xlcnMpIHsKICAgICAgICAgIGlmIChudW1iZXIgPiAwKSB7CiAgICAgICAgICAgIEdhbWUud3JpbmtsZXJzW2ldLnBoYXNlID0gMjsKICAgICAgICAgICAgR2FtZS53cmlua2xlcnNbaV0uY2xvc2UgPSAxOwogICAgICAgICAgICBHYW1lLndyaW5rbGVyc1tpXS5ocCA9IDM7CiAgICAgICAgICAgIGlmIChzaGluaWVzID4gMCkgewogICAgICAgICAgICAgIEdhbWUud3JpbmtsZXJzW2ldLnR5cGUgPSAxOwogICAgICAgICAgICAgIEdhbWUud3JpbmtsZXJzW2ldLnN1Y2tlZCA9IGFtb3VudFNoaW5pZXMgLyBmdWxsTnVtYmVyU2hpbmllczsKICAgICAgICAgICAgICBzaGluaWVzLS07CiAgICAgICAgICAgIH0gZWxzZSBHYW1lLndyaW5rbGVyc1tpXS5zdWNrZWQgPSBhbW91bnQgLyBmdWxsTnVtYmVyOwogICAgICAgICAgICBudW1iZXItLTsKICAgICAgICAgIH0gLy9yZXNwYXduCiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJCVNQRUNJQUwgVEhJTkdTIEFORCBTVFVGRgoJCT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCgogICAgR2FtZS5zcGVjaWFsVGFiID0gIiI7CiAgICBHYW1lLnNwZWNpYWxUYWJIb3ZlcmVkID0gIiI7CiAgICBHYW1lLnNwZWNpYWxUYWJzID0gW107CgogICAgR2FtZS5VcGRhdGVTcGVjaWFsID0gZnVuY3Rpb24gKCkgewogICAgICBHYW1lLnNwZWNpYWxUYWJzID0gW107CiAgICAgIGlmIChHYW1lLkhhcygiQSBmZXN0aXZlIGhhdCIpKSBHYW1lLnNwZWNpYWxUYWJzLnB1c2goInNhbnRhIik7CiAgICAgIGlmIChHYW1lLkhhcygiQSBjcnVtYmx5IGVnZyIpKSBHYW1lLnNwZWNpYWxUYWJzLnB1c2goImRyYWdvbiIpOwogICAgICBpZiAoR2FtZS5zcGVjaWFsVGFicy5sZW5ndGggPT0gMCkgewogICAgICAgIEdhbWUuVG9nZ2xlU3BlY2lhbE1lbnUoMCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoR2FtZS5MZWZ0QmFja2dyb3VuZCkgewogICAgICAgIEdhbWUuc3BlY2lhbFRhYkhvdmVyZWQgPSAiIjsKICAgICAgICB2YXIgbGVuID0gR2FtZS5zcGVjaWFsVGFicy5sZW5ndGg7CiAgICAgICAgaWYgKGxlbiA9PSAwKSByZXR1cm47CiAgICAgICAgdmFyIHkgPSBHYW1lLkxlZnRCYWNrZ3JvdW5kLmNhbnZhcy5oZWlnaHQgLSAyNCAtIDQ4ICogbGVuOwogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgR2FtZS5zcGVjaWFsVGFicy5sZW5ndGg7IGkrKykgewogICAgICAgICAgdmFyIHNlbGVjdGVkID0gMDsKICAgICAgICAgIGlmIChHYW1lLnNwZWNpYWxUYWIgPT0gR2FtZS5zcGVjaWFsVGFic1tpXSkgc2VsZWN0ZWQgPSAxOwogICAgICAgICAgdmFyIHggPSAyNDsKICAgICAgICAgIHZhciBzID0gMTsKICAgICAgICAgIGlmIChzZWxlY3RlZCkgewogICAgICAgICAgICBzID0gMjsKICAgICAgICAgICAgeCArPSAyNDsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIE1hdGguYWJzKEdhbWUubW91c2VYIC0geCkgPD0gMjQgKiBzICYmCiAgICAgICAgICAgIE1hdGguYWJzKEdhbWUubW91c2VZIC0geSkgPD0gMjQgKiBzCiAgICAgICAgICApIHsKICAgICAgICAgICAgR2FtZS5zcGVjaWFsVGFiSG92ZXJlZCA9IEdhbWUuc3BlY2lhbFRhYnNbaV07CiAgICAgICAgICAgIEdhbWUubW91c2VQb2ludGVyID0gMTsKICAgICAgICAgICAgR2FtZS5DYW5DbGljayA9IDA7CiAgICAgICAgICAgIGlmIChHYW1lLkNsaWNrICYmIEdhbWUubGFzdENsaWNrZWRFbCA9PSBsKCJiYWNrZ3JvdW5kTGVmdENhbnZhcyIpKSB7CiAgICAgICAgICAgICAgaWYgKEdhbWUuc3BlY2lhbFRhYiAhPSBHYW1lLnNwZWNpYWxUYWJzW2ldKSB7CiAgICAgICAgICAgICAgICBHYW1lLnNwZWNpYWxUYWIgPSBHYW1lLnNwZWNpYWxUYWJzW2ldOwogICAgICAgICAgICAgICAgR2FtZS5Ub2dnbGVTcGVjaWFsTWVudSgxKTsKICAgICAgICAgICAgICAgIFBsYXlTb3VuZCgic25kL3ByZXNzLm1wMyIpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBHYW1lLlRvZ2dsZVNwZWNpYWxNZW51KDApOwogICAgICAgICAgICAgICAgUGxheVNvdW5kKCJzbmQvcHJlc3MubXAzIik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIC8vUGxheVNvdW5kKCdzbmQvdGljay5tcDMnKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHkgKz0gNDg7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIEdhbWUuc2FudGFMZXZlbHMgPSBbCiAgICAgICJGZXN0aXZlIHRlc3QgdHViZSIsCiAgICAgICJGZXN0aXZlIG9ybmFtZW50IiwKICAgICAgIkZlc3RpdmUgd3JlYXRoIiwKICAgICAgIkZlc3RpdmUgdHJlZSIsCiAgICAgICJGZXN0aXZlIHByZXNlbnQiLAogICAgICAiRmVzdGl2ZSBlbGYgZmV0dXMiLAogICAgICAiRWxmIHRvZGRsZXIiLAogICAgICAiRWxmbGluZyIsCiAgICAgICJZb3VuZyBlbGYiLAogICAgICAiQnVsa3kgZWxmIiwKICAgICAgIk5pY2siLAogICAgICAiU2FudGEgQ2xhdXMiLAogICAgICAiRWxkZXIgU2FudGEiLAogICAgICAiVHJ1ZSBTYW50YSIsCiAgICAgICJGaW5hbCBDbGF1cyIsCiAgICBdOwogICAgaWYgKCFFTikgewogICAgICBmb3IgKHZhciBpIGluIEdhbWUuc2FudGFMZXZlbHMpIHsKICAgICAgICBHYW1lLnNhbnRhTGV2ZWxzW2ldID0gbG9jKEdhbWUuc2FudGFMZXZlbHNbaV0pOwogICAgICB9CiAgICB9CiAgICBmb3IgKHZhciBpIGluIEdhbWUuc2FudGFEcm9wcykgeyAvL3NjYWxlIGNocmlzdG1hcyB1cGdyYWRlIHByaWNlcyB3aXRoIHNhbnRhIGxldmVsCiAgICAgIEdhbWUuVXBncmFkZXNbR2FtZS5zYW50YURyb3BzW2ldXS5wcmljZUZ1bmMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIE1hdGgucG93KDMsIEdhbWUuc2FudGFMZXZlbCkgKiAyNTI1OwogICAgICB9OwogICAgfQoKICAgIEdhbWUuVXBncmFkZVNhbnRhID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgbW9uaSA9IE1hdGgucG93KEdhbWUuc2FudGFMZXZlbCArIDEsIEdhbWUuc2FudGFMZXZlbCArIDEpOwogICAgICBpZiAoR2FtZS5jb29raWVzID4gbW9uaSAmJiBHYW1lLnNhbnRhTGV2ZWwgPCAxNCkgewogICAgICAgIFBsYXlTb3VuZCgic25kL3NoaW1tZXJDbGljay5tcDMiKTsKCiAgICAgICAgR2FtZS5TcGVuZChtb25pKTsKICAgICAgICBHYW1lLnNhbnRhTGV2ZWwgPSAoR2FtZS5zYW50YUxldmVsICsgMSkgJSAxNTsKICAgICAgICBpZiAoR2FtZS5zYW50YUxldmVsID09IDE0KSB7CiAgICAgICAgICBHYW1lLlVubG9jaygiU2FudGEncyBkb21pbmlvbiIpOwogICAgICAgICAgR2FtZS5Ob3RpZnkoCiAgICAgICAgICAgIGxvYygiWW91IGFyZSBncmFudGVkICUxLiIsIEdhbWUuVXBncmFkZXNbIlNhbnRhJ3MgZG9taW5pb24iXS5kbmFtZSksCiAgICAgICAgICAgICIiLAogICAgICAgICAgICBHYW1lLlVwZ3JhZGVzWyJTYW50YSdzIGRvbWluaW9uIl0uaWNvbgogICAgICAgICAgKTsKICAgICAgICB9CiAgICAgICAgdmFyIGRyb3BzID0gW107CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLnNhbnRhRHJvcHMpIHsKICAgICAgICAgIGlmICghR2FtZS5IYXNVbmxvY2tlZChHYW1lLnNhbnRhRHJvcHNbaV0pKQogICAgICAgICAgICBkcm9wcy5wdXNoKEdhbWUuc2FudGFEcm9wc1tpXSk7CiAgICAgICAgfQogICAgICAgIHZhciBkcm9wID0gY2hvb3NlKGRyb3BzKTsKICAgICAgICBpZiAoZHJvcCkgewogICAgICAgICAgR2FtZS5VbmxvY2soZHJvcCk7CiAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgbG9jKCJGb3VuZCBhIHByZXNlbnQhIiksCiAgICAgICAgICAgIGxvYygiWW91IGZpbmQgYSBwcmVzZW50IHdoaWNoIGNvbnRhaW5zLi4uIikgKwogICAgICAgICAgICAgICI8YnI+PGI+IiArCiAgICAgICAgICAgICAgR2FtZS5VcGdyYWRlc1tkcm9wXS5kbmFtZSArCiAgICAgICAgICAgICAgIjwvYj4hIiwKICAgICAgICAgICAgR2FtZS5VcGdyYWRlc1tkcm9wXS5pY29uCiAgICAgICAgICApOwogICAgICAgIH0KCiAgICAgICAgR2FtZS5Ub2dnbGVTcGVjaWFsTWVudSgxKTsKCiAgICAgICAgaWYgKGwoInNwZWNpYWxQaWMiKSkgewogICAgICAgICAgdmFyIHJlY3QgPSBsKCJzcGVjaWFsUGljIikuZ2V0Qm91bmRzKCk7CiAgICAgICAgICBHYW1lLlNwYXJrbGVBdCgKICAgICAgICAgICAgKHJlY3QubGVmdCArIHJlY3QucmlnaHQpIC8gMiwKICAgICAgICAgICAgKHJlY3QudG9wICsgcmVjdC5ib3R0b20pIC8gMgogICAgICAgICAgKSArCiAgICAgICAgICAgIDMyIC0KICAgICAgICAgICAgVG9wQmFyT2Zmc2V0OwogICAgICAgIH0KCiAgICAgICAgaWYgKEdhbWUuc2FudGFMZXZlbCA+PSA2KSBHYW1lLldpbigiQ29taW5nIHRvIHRvd24iKTsKICAgICAgICBpZiAoR2FtZS5zYW50YUxldmVsID49IDE0KSBHYW1lLldpbigiQWxsIGhhaWwgU2FudGEiKTsKICAgICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICAgIEdhbWUudXBncmFkZXNUb1JlYnVpbGQgPSAxOwogICAgICB9CiAgICB9OwoKICAgIEdhbWUuZHJhZ29uTGV2ZWxzID0gWwogICAgICB7CiAgICAgICAgbmFtZTogIkRyYWdvbiBlZ2ciLAogICAgICAgIGFjdGlvbjogbG9jKCJDaGlwIGl0IiksCiAgICAgICAgcGljOiAwLAogICAgICAgIGNvc3Q6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBHYW1lLmNvb2tpZXMgPj0gMTAwMDAwMDsKICAgICAgICB9LAogICAgICAgIGJ1eTogZnVuY3Rpb24gKCkgewogICAgICAgICAgR2FtZS5TcGVuZCgxMDAwMDAwKTsKICAgICAgICB9LAogICAgICAgIGNvc3RTdHI6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxMDAwMDAwKSk7CiAgICAgICAgfSwKICAgICAgfSwKICAgICAgewogICAgICAgIG5hbWU6ICJEcmFnb24gZWdnIiwKICAgICAgICBhY3Rpb246IGxvYygiQ2hpcCBpdCIpLAogICAgICAgIHBpYzogMSwKICAgICAgICBjb3N0OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gR2FtZS5jb29raWVzID49IDEwMDAwMDAgKiAyOwogICAgICAgIH0sCiAgICAgICAgYnV5OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBHYW1lLlNwZW5kKDEwMDAwMDAgKiAyKTsKICAgICAgICB9LAogICAgICAgIGNvc3RTdHI6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxMDAwMDAwICogMikpOwogICAgICAgIH0sCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBuYW1lOiAiRHJhZ29uIGVnZyIsCiAgICAgICAgYWN0aW9uOiBsb2MoIkNoaXAgaXQiKSwKICAgICAgICBwaWM6IDIsCiAgICAgICAgY29zdDogZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIEdhbWUuY29va2llcyA+PSAxMDAwMDAwICogNDsKICAgICAgICB9LAogICAgICAgIGJ1eTogZnVuY3Rpb24gKCkgewogICAgICAgICAgR2FtZS5TcGVuZCgxMDAwMDAwICogNCk7CiAgICAgICAgfSwKICAgICAgICBjb3N0U3RyOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMTAwMDAwMCAqIDQpKTsKICAgICAgICB9LAogICAgICB9LAogICAgICB7CiAgICAgICAgbmFtZTogIlNoaXZlcmluZyBkcmFnb24gZWdnIiwKICAgICAgICBhY3Rpb246IGxvYygiSGF0Y2ggaXQiKSwKICAgICAgICBwaWM6IDMsCiAgICAgICAgY29zdDogZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIEdhbWUuY29va2llcyA+PSAxMDAwMDAwICogODsKICAgICAgICB9LAogICAgICAgIGJ1eTogZnVuY3Rpb24gKCkgewogICAgICAgICAgR2FtZS5TcGVuZCgxMDAwMDAwICogOCk7CiAgICAgICAgfSwKICAgICAgICBjb3N0U3RyOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMTAwMDAwMCAqIDgpKTsKICAgICAgICB9LAogICAgICB9LAogICAgICB7CiAgICAgICAgbmFtZTogIktydW1ibG9yLCBjb29raWUgaGF0Y2hsaW5nIiwKICAgICAgICBhY3Rpb246CiAgICAgICAgICAiVHJhaW4gQnJlYXRoIG9mIE1pbGs8YnI+PHNtYWxsPkF1cmEgOiBraXR0ZW5zIGFyZSA1JSBtb3JlIGVmZmVjdGl2ZTwvc21hbGw+IiwKICAgICAgICBwaWM6IDQsCiAgICAgICAgY29zdDogZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIEdhbWUuY29va2llcyA+PSAxMDAwMDAwICogMTY7CiAgICAgICAgfSwKICAgICAgICBidXk6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEdhbWUuU3BlbmQoMTAwMDAwMCAqIDE2KTsKICAgICAgICB9LAogICAgICAgIGNvc3RTdHI6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxMDAwMDAwICogMTYpKTsKICAgICAgICB9LAogICAgICB9LAogICAgICB7CiAgICAgICAgbmFtZTogIktydW1ibG9yLCBjb29raWUgaGF0Y2hsaW5nIiwKICAgICAgICBhY3Rpb246CiAgICAgICAgICAiVHJhaW4gRHJhZ29uIEN1cnNvcjxicj48c21hbGw+QXVyYSA6IGNsaWNraW5nIGlzIDUlIG1vcmUgZWZmZWN0aXZlPC9zbWFsbD4iLAogICAgICAgIHBpYzogNCwKICAgICAgfSwKICAgICAgewogICAgICAgIG5hbWU6ICJLcnVtYmxvciwgY29va2llIGhhdGNobGluZyIsCiAgICAgICAgYWN0aW9uOgogICAgICAgICAgIlRyYWluIEVsZGVyIEJhdHRhbGlvbjxicj48c21hbGw+QXVyYSA6IGdyYW5kbWFzIGdhaW4gKzElIENwUyBmb3IgZXZlcnkgbm9uLWdyYW5kbWEgYnVpbGRpbmc8L3NtYWxsPiIsCiAgICAgICAgcGljOiA0LAogICAgICB9LAogICAgICB7CiAgICAgICAgbmFtZTogIktydW1ibG9yLCBjb29raWUgaGF0Y2hsaW5nIiwKICAgICAgICBhY3Rpb246CiAgICAgICAgICAiVHJhaW4gUmVhcGVyIG9mIEZpZWxkczxicj48c21hbGw+QXVyYSA6IGdvbGRlbiBjb29raWVzIG1heSB0cmlnZ2VyIGEgRHJhZ29uIEhhcnZlc3Q8L3NtYWxsPiIsCiAgICAgICAgcGljOiA0LAogICAgICB9LAogICAgICB7CiAgICAgICAgbmFtZTogIktydW1ibG9yLCBjb29raWUgZHJhZ29uIiwKICAgICAgICBhY3Rpb246CiAgICAgICAgICAiVHJhaW4gRWFydGggU2hhdHRlcmVyPGJyPjxzbWFsbD5BdXJhIDogYnVpbGRpbmdzIHNlbGwgYmFjayBmb3IgNTAlIGluc3RlYWQgb2YgMjUlPC9zbWFsbD4iLAogICAgICAgIHBpYzogNSwKICAgICAgfSwKICAgICAgewogICAgICAgIG5hbWU6ICJLcnVtYmxvciwgY29va2llIGRyYWdvbiIsCiAgICAgICAgYWN0aW9uOgogICAgICAgICAgIlRyYWluIE1hc3RlciBvZiB0aGUgQXJtb3J5PGJyPjxzbWFsbD5BdXJhIDogYWxsIHVwZ3JhZGVzIGFyZSAyJSBjaGVhcGVyPC9zbWFsbD4iLAogICAgICAgIHBpYzogNSwKICAgICAgfSwKICAgICAgewogICAgICAgIG5hbWU6ICJLcnVtYmxvciwgY29va2llIGRyYWdvbiIsCiAgICAgICAgYWN0aW9uOgogICAgICAgICAgIlRyYWluIEZpZXJjZSBIb2FyZGVyPGJyPjxzbWFsbD5BdXJhIDogYWxsIGJ1aWxkaW5ncyBhcmUgMiUgY2hlYXBlcjwvc21hbGw+IiwKICAgICAgICBwaWM6IDUsCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBuYW1lOiAiS3J1bWJsb3IsIGNvb2tpZSBkcmFnb24iLAogICAgICAgIGFjdGlvbjoKICAgICAgICAgICJUcmFpbiBEcmFnb24gR29kPGJyPjxzbWFsbD5BdXJhIDogcHJlc3RpZ2UgQ3BTIGJvbnVzICs1JTwvc21hbGw+IiwKICAgICAgICBwaWM6IDUsCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBuYW1lOiAiS3J1bWJsb3IsIGNvb2tpZSBkcmFnb24iLAogICAgICAgIGFjdGlvbjoKICAgICAgICAgICJUcmFpbiBBcmNhbmUgQXVyYTxicj48c21hbGw+QXVyYSA6IGdvbGRlbiBjb29raWVzIGFwcGVhciA1JSBtb3JlIG9mdGVuPC9zbWFsbD4iLAogICAgICAgIHBpYzogNSwKICAgICAgfSwKICAgICAgewogICAgICAgIG5hbWU6ICJLcnVtYmxvciwgY29va2llIGRyYWdvbiIsCiAgICAgICAgYWN0aW9uOgogICAgICAgICAgIlRyYWluIERyYWdvbmZsaWdodDxicj48c21hbGw+QXVyYSA6IGdvbGRlbiBjb29raWVzIG1heSB0cmlnZ2VyIGEgRHJhZ29uZmxpZ2h0PC9zbWFsbD4iLAogICAgICAgIHBpYzogNSwKICAgICAgfSwKICAgICAgewogICAgICAgIG5hbWU6ICJLcnVtYmxvciwgY29va2llIGRyYWdvbiIsCiAgICAgICAgYWN0aW9uOgogICAgICAgICAgIlRyYWluIEFuY2VzdHJhbCBNZXRhbW9ycGhvc2lzPGJyPjxzbWFsbD5BdXJhIDogZ29sZGVuIGNvb2tpZXMgZ2l2ZSAxMCUgbW9yZSBjb29raWVzPC9zbWFsbD4iLAogICAgICAgIHBpYzogNSwKICAgICAgfSwKICAgICAgewogICAgICAgIG5hbWU6ICJLcnVtYmxvciwgY29va2llIGRyYWdvbiIsCiAgICAgICAgYWN0aW9uOgogICAgICAgICAgIlRyYWluIFVuaG9seSBEb21pbmlvbjxicj48c21hbGw+QXVyYSA6IHdyYXRoIGNvb2tpZXMgZ2l2ZSAxMCUgbW9yZSBjb29raWVzPC9zbWFsbD4iLAogICAgICAgIHBpYzogNSwKICAgICAgfSwKICAgICAgewogICAgICAgIG5hbWU6ICJLcnVtYmxvciwgY29va2llIGRyYWdvbiIsCiAgICAgICAgYWN0aW9uOgogICAgICAgICAgIlRyYWluIEVwb2NoIE1hbmlwdWxhdG9yPGJyPjxzbWFsbD5BdXJhIDogZ29sZGVuIGNvb2tpZSBlZmZlY3RzIGxhc3QgNSUgbG9uZ2VyPC9zbWFsbD4iLAogICAgICAgIHBpYzogNSwKICAgICAgfSwKICAgICAgewogICAgICAgIG5hbWU6ICJLcnVtYmxvciwgY29va2llIGRyYWdvbiIsCiAgICAgICAgYWN0aW9uOgogICAgICAgICAgIlRyYWluIE1pbmQgT3ZlciBNYXR0ZXI8YnI+PHNtYWxsPkF1cmEgOiArMjUlIHJhbmRvbSBkcm9wczwvc21hbGw+IiwKICAgICAgICBwaWM6IDUsCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBuYW1lOiAiS3J1bWJsb3IsIGNvb2tpZSBkcmFnb24iLAogICAgICAgIGFjdGlvbjoKICAgICAgICAgICJUcmFpbiBSYWRpYW50IEFwcGV0aXRlPGJyPjxzbWFsbD5BdXJhIDogYWxsIGNvb2tpZSBwcm9kdWN0aW9uIG11bHRpcGxpZWQgYnkgMjwvc21hbGw+IiwKICAgICAgICBwaWM6IDUsCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBuYW1lOiAiS3J1bWJsb3IsIGNvb2tpZSBkcmFnb24iLAogICAgICAgIGFjdGlvbjoKICAgICAgICAgICJUcmFpbiBEcmFnb24ncyBGb3J0dW5lPGJyPjxzbWFsbD5BdXJhIDogKzEyMyUgQ3BTIHBlciBnb2xkZW4gY29va2llIG9uLXNjcmVlbjwvc21hbGw+IiwKICAgICAgICBwaWM6IDUsCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBuYW1lOiAiS3J1bWJsb3IsIGNvb2tpZSBkcmFnb24iLAogICAgICAgIGFjdGlvbjoKICAgICAgICAgICJUcmFpbiBEcmFnb24ncyBDdXJ2ZTxicj48c21hbGw+QXVyYSA6IHN1Z2FyIGx1bXBzIGdyb3cgNSUgZmFzdGVyLCA1MCUgd2VpcmRlcjwvc21hbGw+IiwKICAgICAgICBwaWM6IDUsCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBuYW1lOiAiS3J1bWJsb3IsIGNvb2tpZSBkcmFnb24iLAogICAgICAgIGFjdGlvbjoKICAgICAgICAgICJUcmFpbiBSZWFsaXR5IEJlbmRpbmc8YnI+PHNtYWxsPkF1cmEgOiAxMCUgb2YgZXZlcnkgb3RoZXIgYXVyYSwgY29tYmluZWQ8L3NtYWxsPiIsCiAgICAgICAgcGljOiA1LAogICAgICB9LAogICAgICB7CiAgICAgICAgbmFtZTogIktydW1ibG9yLCBjb29raWUgZHJhZ29uIiwKICAgICAgICBhY3Rpb246CiAgICAgICAgICAiVHJhaW4gRHJhZ29uIE9yYnM8YnI+PHNtYWxsPkF1cmEgOiBzZWxsaW5nIHlvdXIgYmVzdCBidWlsZGluZyBtYXkgZ3JhbnQgYSB3aXNoPC9zbWFsbD4iLAogICAgICAgIHBpYzogNSwKICAgICAgfSwKICAgICAgewogICAgICAgIG5hbWU6ICJLcnVtYmxvciwgY29va2llIGRyYWdvbiIsCiAgICAgICAgYWN0aW9uOgogICAgICAgICAgIlRyYWluIFN1cHJlbWUgSW50ZWxsZWN0PGJyPjxzbWFsbD5BdXJhIDogY29uZmVycyB2YXJpb3VzIHBvd2VycyB0byB5b3VyIG1pbmlnYW1lczwvc21hbGw+IiwKICAgICAgICBwaWM6IDUsCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBuYW1lOiAiS3J1bWJsb3IsIGNvb2tpZSBkcmFnb24iLAogICAgICAgIGFjdGlvbjoKICAgICAgICAgIGxvYygiQmFrZSBkcmFnb24gY29va2llIikgKwogICAgICAgICAgIjxicj48c21hbGw+IiArCiAgICAgICAgICBsb2MoIkRlbGljaW91cyEiKSArCiAgICAgICAgICAiPC9zbWFsbD4iLAogICAgICAgIHBpYzogNiwKICAgICAgICBjb3N0OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgZmFpbCA9IDA7CiAgICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0cykgewogICAgICAgICAgICBpZiAoR2FtZS5PYmplY3RzW2ldLmFtb3VudCA8IDUwKSBmYWlsID0gMTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBmYWlsID09IDA7CiAgICAgICAgfSwKICAgICAgICBidXk6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKSB7CiAgICAgICAgICAgIEdhbWUuT2JqZWN0c1tpXS5zYWNyaWZpY2UoNTApOwogICAgICAgICAgfQogICAgICAgICAgR2FtZS5VbmxvY2soIkRyYWdvbiBjb29raWUiKTsKICAgICAgICB9LAogICAgICAgIGNvc3RTdHI6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBsb2MoIiUxIG9mIGV2ZXJ5IGJ1aWxkaW5nIiwgNTApOwogICAgICAgIH0sCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBuYW1lOiAiS3J1bWJsb3IsIGNvb2tpZSBkcmFnb24iLAogICAgICAgIGFjdGlvbjoKICAgICAgICAgIGxvYygiVHJhaW4gc2Vjb25kYXJ5IGF1cmEiKSArCiAgICAgICAgICAiPGJyPjxzbWFsbD4iICsKICAgICAgICAgIGxvYygiTGV0cyB5b3UgdXNlIHR3byBkcmFnb24gYXVyYXMgc2ltdWx0YW5lb3VzbHkiKSArCiAgICAgICAgICAiPC9zbWFsbD4iLAogICAgICAgIHBpYzogNywKICAgICAgICBjb3N0OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgZmFpbCA9IDA7CiAgICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0cykgewogICAgICAgICAgICBpZiAoR2FtZS5PYmplY3RzW2ldLmFtb3VudCA8IDIwMCkgZmFpbCA9IDE7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gZmFpbCA9PSAwOwogICAgICAgIH0sCiAgICAgICAgYnV5OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0cykgewogICAgICAgICAgICBHYW1lLk9iamVjdHNbaV0uc2FjcmlmaWNlKDIwMCk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBjb3N0U3RyOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gbG9jKCIlMSBvZiBldmVyeSBidWlsZGluZyIsIDIwMCk7CiAgICAgICAgfSwKICAgICAgfSwKICAgICAgewogICAgICAgIG5hbWU6ICJLcnVtYmxvciwgY29va2llIGRyYWdvbiIsCiAgICAgICAgYWN0aW9uOiBsb2MoIllvdXIgZHJhZ29uIGlzIGZ1bGx5IHRyYWluZWQuIiksCiAgICAgICAgcGljOiA4LAogICAgICB9LAogICAgXTsKCiAgICBHYW1lLmRyYWdvbkF1cmFzID0gewogICAgICAwOiB7CiAgICAgICAgbmFtZTogIk5vIGF1cmEiLAogICAgICAgIHBpYzogWzAsIDddLAogICAgICAgIGRlc2M6IGxvYygiU2VsZWN0IGFuIGF1cmEgZnJvbSB0aG9zZSB5b3VyIGRyYWdvbiBrbm93cy4iKSwKICAgICAgfSwKICAgICAgMTogewogICAgICAgIG5hbWU6ICJCcmVhdGggb2YgTWlsayIsCiAgICAgICAgcGljOiBbMTgsIDI1XSwKICAgICAgICBkZXNjOiBsb2MoIktpdHRlbnMgYXJlIDxiPiUxJTwvYj4gbW9yZSBlZmZlY3RpdmUuIiwgNSksCiAgICAgIH0sCiAgICAgIDI6IHsKICAgICAgICBuYW1lOiAiRHJhZ29uIEN1cnNvciIsCiAgICAgICAgcGljOiBbMCwgMjVdLAogICAgICAgIGRlc2M6IGxvYygiQ2xpY2tpbmcgaXMgPGI+JTElPC9iPiBtb3JlIHBvd2VyZnVsLiIsIDUpLAogICAgICB9LAogICAgICAzOiB7CiAgICAgICAgbmFtZTogIkVsZGVyIEJhdHRhbGlvbiIsCiAgICAgICAgcGljOiBbMSwgMjVdLAogICAgICAgIGRlc2M6IGxvYygKICAgICAgICAgICJHcmFuZG1hcyBnYWluIDxiPislMSUgQ3BTPC9iPiBmb3IgZWFjaCBub24tZ3JhbmRtYSBidWlsZGluZy4iLAogICAgICAgICAgMQogICAgICAgICksCiAgICAgIH0sCiAgICAgIDQ6IHsKICAgICAgICBuYW1lOiAiUmVhcGVyIG9mIEZpZWxkcyIsCiAgICAgICAgcGljOiBbMiwgMjVdLAogICAgICAgIGRlc2M6IGxvYygiR29sZGVuIGNvb2tpZXMgbWF5IHRyaWdnZXIgYSA8Yj5EcmFnb24gSGFydmVzdDwvYj4uIiksCiAgICAgIH0sCiAgICAgIDU6IHsKICAgICAgICBuYW1lOiAiRWFydGggU2hhdHRlcmVyIiwKICAgICAgICBwaWM6IFszLCAyNV0sCiAgICAgICAgZGVzYzogbG9jKAogICAgICAgICAgIkJ1aWxkaW5ncyBzZWxsIGJhY2sgZm9yIDxiPiUxJTwvYj4gaW5zdGVhZCBvZiAlMiUuIiwKICAgICAgICAgIFs1MCwgMjVdCiAgICAgICAgKSwKICAgICAgfSwKICAgICAgNjogewogICAgICAgIG5hbWU6ICJNYXN0ZXIgb2YgdGhlIEFybW9yeSIsCiAgICAgICAgcGljOiBbNCwgMjVdLAogICAgICAgIGRlc2M6IGxvYygiQWxsIHVwZ3JhZGVzIGFyZSA8Yj4lMSUgY2hlYXBlcjwvYj4uIiwgMiksCiAgICAgIH0sCiAgICAgIDc6IHsKICAgICAgICBuYW1lOiAiRmllcmNlIEhvYXJkZXIiLAogICAgICAgIHBpYzogWzE1LCAyNV0sCiAgICAgICAgZGVzYzogbG9jKCJBbGwgYnVpbGRpbmdzIGFyZSA8Yj4lMSUgY2hlYXBlcjwvYj4uIiwgMiksCiAgICAgIH0sCiAgICAgIDg6IHsKICAgICAgICBuYW1lOiAiRHJhZ29uIEdvZCIsCiAgICAgICAgcGljOiBbMTYsIDI1XSwKICAgICAgICBkZXNjOiBsb2MoIjxiPislMSU8L2I+IHByZXN0aWdlIGxldmVsIGVmZmVjdCBvbiBDcFMuIiwgNSksCiAgICAgIH0sCiAgICAgIDk6IHsKICAgICAgICBuYW1lOiAiQXJjYW5lIEF1cmEiLAogICAgICAgIHBpYzogWzE3LCAyNV0sCiAgICAgICAgZGVzYzogbG9jKCJHb2xkZW4gY29va2llcyBhcHBlYXIgPGI+JTElPC9iPiBtb3JlIG9mdGVuLiIsIDUpLAogICAgICB9LAogICAgICAxMDogewogICAgICAgIG5hbWU6ICJEcmFnb25mbGlnaHQiLAogICAgICAgIHBpYzogWzUsIDI1XSwKICAgICAgICBkZXNjOiBsb2MoIkdvbGRlbiBjb29raWVzIG1heSB0cmlnZ2VyIGEgPGI+RHJhZ29uZmxpZ2h0PC9iPi4iKSwKICAgICAgfSwKICAgICAgMTE6IHsKICAgICAgICBuYW1lOiAiQW5jZXN0cmFsIE1ldGFtb3JwaG9zaXMiLAogICAgICAgIHBpYzogWzYsIDI1XSwKICAgICAgICBkZXNjOiBsb2MoIkdvbGRlbiBjb29raWVzIGdpdmUgPGI+JTElPC9iPiBtb3JlIGNvb2tpZXMuIiwgMTApLAogICAgICB9LAogICAgICAxMjogewogICAgICAgIG5hbWU6ICJVbmhvbHkgRG9taW5pb24iLAogICAgICAgIHBpYzogWzcsIDI1XSwKICAgICAgICBkZXNjOiBsb2MoIldyYXRoIGNvb2tpZXMgZ2l2ZSA8Yj4lMSU8L2I+IG1vcmUgY29va2llcy4iLCAxMCksCiAgICAgIH0sCiAgICAgIDEzOiB7CiAgICAgICAgbmFtZTogIkVwb2NoIE1hbmlwdWxhdG9yIiwKICAgICAgICBwaWM6IFs4LCAyNV0sCiAgICAgICAgZGVzYzogbG9jKCJHb2xkZW4gY29va2llcyBzdGF5IDxiPiUxJTwvYj4gbG9uZ2VyLiIsIDUpLAogICAgICB9LAogICAgICAxNDogewogICAgICAgIG5hbWU6ICJNaW5kIE92ZXIgTWF0dGVyIiwKICAgICAgICBwaWM6IFsxMywgMjVdLAogICAgICAgIGRlc2M6IGxvYygiUmFuZG9tIGRyb3BzIGFyZSA8Yj4lMSUgbW9yZSBjb21tb248L2I+LiIsIDI1KSwKICAgICAgfSwKICAgICAgMTU6IHsKICAgICAgICBuYW1lOiAiUmFkaWFudCBBcHBldGl0ZSIsCiAgICAgICAgcGljOiBbMTQsIDI1XSwKICAgICAgICBkZXNjOiBsb2MoIkFsbCBjb29raWUgcHJvZHVjdGlvbiA8Yj5tdWx0aXBsaWVkIGJ5ICUxPC9iPi4iLCAyKSwKICAgICAgfSwKICAgICAgMTY6IHsKICAgICAgICBuYW1lOiAiRHJhZ29uJ3MgRm9ydHVuZSIsCiAgICAgICAgcGljOiBbMTksIDI1XSwKICAgICAgICBkZXNjOiBsb2MoCiAgICAgICAgICAiPGI+KyUxJSBDcFM8L2I+IHBlciBnb2xkZW4gY29va2llIG9uLXNjcmVlbiwgbXVsdGlwbGljYXRpdmUuIiwKICAgICAgICAgIDEyMwogICAgICAgICksCiAgICAgIH0sCiAgICAgIDE3OiB7CiAgICAgICAgbmFtZTogIkRyYWdvbidzIEN1cnZlIiwKICAgICAgICBwaWM6IFsyMCwgMjVdLAogICAgICAgIGRlc2M6CiAgICAgICAgICBsb2MoIjxiPislMSU8L2I+IHN1Z2FyIGx1bXAgZ3Jvd3RoLiIsIDUpICsKICAgICAgICAgICIgIiArCiAgICAgICAgICBsb2MoIlN1Z2FyIGx1bXBzIGFyZSA8Yj50d2ljZSBhcyBsaWtlbHk8L2I+IHRvIGJlIHVudXN1YWwuIiksCiAgICAgIH0sCiAgICAgIDE4OiB7CiAgICAgICAgbmFtZTogIlJlYWxpdHkgQmVuZGluZyIsCiAgICAgICAgcGljOiBbMzIsIDI1XSwKICAgICAgICBkZXNjOiBsb2MoCiAgICAgICAgICAiPGI+T25lIHRlbnRoPC9iPiBvZiBldmVyeSBvdGhlciBkcmFnb24gYXVyYSwgPGI+Y29tYmluZWQ8L2I+LiIKICAgICAgICApLAogICAgICB9LAogICAgICAxOTogewogICAgICAgIG5hbWU6ICJEcmFnb24gT3JicyIsCiAgICAgICAgcGljOiBbMzMsIDI1XSwKICAgICAgICBkZXNjOiBsb2MoCiAgICAgICAgICAiV2l0aCBubyBidWZmcyBhbmQgbm8gZ29sZGVuIGNvb2tpZXMgb24gc2NyZWVuLCBzZWxsaW5nIHlvdXIgbW9zdCBwb3dlcmZ1bCBidWlsZGluZyBoYXMgPGI+JTElIGNoYW5jZSB0byBzdW1tb24gb25lPC9iPi4iLAogICAgICAgICAgMTAKICAgICAgICApLAogICAgICB9LAogICAgICAyMDogewogICAgICAgIG5hbWU6ICJTdXByZW1lIEludGVsbGVjdCIsCiAgICAgICAgcGljOiBbMzQsIDI1XSwKICAgICAgICBkZXNjOiBsb2MoCiAgICAgICAgICAiQ29uZmVycyB2YXJpb3VzIHBvd2VycyB0byB5b3VyIG1pbmlnYW1lcyB3aGlsZSBhY3RpdmUuPGJyPlNlZSB0aGUgYm90dG9tIG9mIGVhY2ggbWluaWdhbWUgZm9yIG1vcmUgZGV0YWlscy4iCiAgICAgICAgKSwKICAgICAgfSwKICAgIH07CgogICAgR2FtZS5kcmFnb25BdXJhc0JOID0ge307CiAgICBmb3IgKHZhciBpIGluIEdhbWUuZHJhZ29uQXVyYXMpIHsKICAgICAgR2FtZS5kcmFnb25BdXJhc0JOW0dhbWUuZHJhZ29uQXVyYXNbaV0ubmFtZV0gPSBHYW1lLmRyYWdvbkF1cmFzW2ldOwogICAgfQogICAgZm9yICh2YXIgaSBpbiBHYW1lLmRyYWdvbkF1cmFzKSB7CiAgICAgIEdhbWUuZHJhZ29uQXVyYXNbaV0uaWQgPSBwYXJzZUludChpKTsKICAgICAgR2FtZS5kcmFnb25BdXJhc1tpXS5kbmFtZSA9IGxvYyhHYW1lLmRyYWdvbkF1cmFzW2ldLm5hbWUpOwogICAgfQoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgR2FtZS5kcmFnb25MZXZlbHMubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIGl0ID0gR2FtZS5kcmFnb25MZXZlbHNbaV07CiAgICAgIGl0Lm5hbWUgPSBsb2MoaXQubmFtZSk7CiAgICAgIGlmIChpID49IDQgJiYgaSA8IEdhbWUuZHJhZ29uTGV2ZWxzLmxlbmd0aCAtIDMpIHsKICAgICAgICBpZiAoIUVOKQogICAgICAgICAgaXQuYWN0aW9uID0KICAgICAgICAgICAgbG9jKCJUcmFpbiAlMSIsIEdhbWUuZHJhZ29uQXVyYXNbaSAtIDNdLmRuYW1lKSArCiAgICAgICAgICAgICI8YnI+PHNtYWxsPiIgKwogICAgICAgICAgICBsb2MoIkF1cmE6ICUxIiwgR2FtZS5kcmFnb25BdXJhc1tpIC0gM10uZGVzYykgKwogICAgICAgICAgICAiPC9zbWFsbD4iOwogICAgICAgIGlmIChpID49IDUpIHsKICAgICAgICAgIGl0LmNvc3RTdHIgPSAoZnVuY3Rpb24gKGJ1aWxkaW5nKSB7CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGxvYygiJTEgIiArIGJ1aWxkaW5nLmJzaW5nbGUsIExCZWF1dGlmeSgxMDApKTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0pKEdhbWUuT2JqZWN0c0J5SWRbaSAtIDVdKTsKICAgICAgICAgIGl0LmNvc3QgPSAoZnVuY3Rpb24gKGJ1aWxkaW5nKSB7CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGJ1aWxkaW5nLmFtb3VudCA+PSAxMDA7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9KShHYW1lLk9iamVjdHNCeUlkW2kgLSA1XSk7CiAgICAgICAgICBpdC5idXkgPSAoZnVuY3Rpb24gKGJ1aWxkaW5nKSB7CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgYnVpbGRpbmcuc2FjcmlmaWNlKDEwMCk7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9KShHYW1lLk9iamVjdHNCeUlkW2kgLSA1XSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgR2FtZS5oYXNBdXJhID0gZnVuY3Rpb24gKHdoYXQpIHsKICAgICAgaWYgKAogICAgICAgIEdhbWUuZHJhZ29uQXVyYXNbR2FtZS5kcmFnb25BdXJhXS5uYW1lID09IHdoYXQgfHwKICAgICAgICBHYW1lLmRyYWdvbkF1cmFzW0dhbWUuZHJhZ29uQXVyYTJdLm5hbWUgPT0gd2hhdAogICAgICApCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIGVsc2UgcmV0dXJuIGZhbHNlOwogICAgfTsKICAgIEdhbWUuYXVyYU11bHQgPSBmdW5jdGlvbiAod2hhdCkgewogICAgICB2YXIgbiA9IDA7CiAgICAgIGlmICgKICAgICAgICBHYW1lLmRyYWdvbkF1cmFzW0dhbWUuZHJhZ29uQXVyYV0ubmFtZSA9PSB3aGF0IHx8CiAgICAgICAgR2FtZS5kcmFnb25BdXJhc1tHYW1lLmRyYWdvbkF1cmEyXS5uYW1lID09IHdoYXQKICAgICAgKQogICAgICAgIG4gPSAxOwogICAgICBpZiAoCiAgICAgICAgKEdhbWUuZHJhZ29uQXVyYXNbR2FtZS5kcmFnb25BdXJhXS5uYW1lID09ICJSZWFsaXR5IEJlbmRpbmciIHx8CiAgICAgICAgICBHYW1lLmRyYWdvbkF1cmFzW0dhbWUuZHJhZ29uQXVyYTJdLm5hbWUgPT0gIlJlYWxpdHkgQmVuZGluZyIpICYmCiAgICAgICAgR2FtZS5kcmFnb25MZXZlbCA+PSBHYW1lLmRyYWdvbkF1cmFzQk5bd2hhdF0uaWQgKyA0CiAgICAgICkKICAgICAgICBuICs9IDAuMTsKICAgICAgcmV0dXJuIG47CiAgICB9OwoKICAgIEdhbWUuU2VsZWN0RHJhZ29uQXVyYSA9IGZ1bmN0aW9uIChzbG90LCB1cGRhdGUpIHsKICAgICAgdmFyIGN1cnJlbnRBdXJhID0gMDsKICAgICAgdmFyIG90aGVyQXVyYSA9IDA7CiAgICAgIGlmIChzbG90ID09IDApIGN1cnJlbnRBdXJhID0gR2FtZS5kcmFnb25BdXJhOwogICAgICBlbHNlIGN1cnJlbnRBdXJhID0gR2FtZS5kcmFnb25BdXJhMjsKICAgICAgaWYgKHNsb3QgPT0gMCkgb3RoZXJBdXJhID0gR2FtZS5kcmFnb25BdXJhMjsKICAgICAgZWxzZSBvdGhlckF1cmEgPSBHYW1lLmRyYWdvbkF1cmE7CiAgICAgIGlmICghdXBkYXRlKSBHYW1lLlNlbGVjdGluZ0RyYWdvbkF1cmEgPSBjdXJyZW50QXVyYTsKCiAgICAgIHZhciBzdHIgPSAiIjsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLmRyYWdvbkF1cmFzKSB7CiAgICAgICAgaWYgKEdhbWUuZHJhZ29uTGV2ZWwgPj0gcGFyc2VJbnQoaSkgKyA0KSB7CiAgICAgICAgICB2YXIgaWNvbiA9IEdhbWUuZHJhZ29uQXVyYXNbaV0ucGljOwogICAgICAgICAgaWYgKGkgPT0gMCB8fCBpICE9IG90aGVyQXVyYSkKICAgICAgICAgICAgc3RyICs9CiAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImNyYXRlIGVuYWJsZWQnICsKICAgICAgICAgICAgICAoaSA9PSBHYW1lLlNlbGVjdGluZ0RyYWdvbkF1cmEgPyAiIGhpZ2hsaWdodGVkIiA6ICIiKSArCiAgICAgICAgICAgICAgJyIgc3R5bGU9Im9wYWNpdHk6MTtmbG9hdDpub25lO2Rpc3BsYXk6aW5saW5lLWJsb2NrOycgKwogICAgICAgICAgICAgIHdyaXRlSWNvbihpY29uKSArCiAgICAgICAgICAgICAgJyIgJyArCiAgICAgICAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgICAgICAgIj1cIlBsYXlTb3VuZCgnc25kL3RpY2subXAzJyk7R2FtZS5TZXREcmFnb25BdXJhKCIgKwogICAgICAgICAgICAgIGkgKwogICAgICAgICAgICAgICIsIiArCiAgICAgICAgICAgICAgc2xvdCArCiAgICAgICAgICAgICAgJyk7IiBvbk1vdXNlT3V0PSJHYW1lLkRlc2NyaWJlRHJhZ29uQXVyYSgnICsKICAgICAgICAgICAgICBHYW1lLlNlbGVjdGluZ0RyYWdvbkF1cmEgKwogICAgICAgICAgICAgICcpOyIgb25Nb3VzZU92ZXI9IkdhbWUuRGVzY3JpYmVEcmFnb25BdXJhKCcgKwogICAgICAgICAgICAgIGkgKwogICAgICAgICAgICAgICcpOyInICsKICAgICAgICAgICAgICAiPjwvZGl2PiI7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgaGlnaGVzdEJ1aWxkaW5nID0gMDsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICBpZiAoR2FtZS5PYmplY3RzW2ldLmFtb3VudCA+IDApIGhpZ2hlc3RCdWlsZGluZyA9IEdhbWUuT2JqZWN0c1tpXTsKICAgICAgfQoKICAgICAgR2FtZS5Qcm9tcHQoCiAgICAgICAgIjxpZCBQaWNrRHJhZ29uQXVyYT48aDM+IiArCiAgICAgICAgICBsb2MoCiAgICAgICAgICAgIHNsb3QgPT0gMQogICAgICAgICAgICAgID8gIlNldCB5b3VyIGRyYWdvbidzIHNlY29uZGFyeSBhdXJhIgogICAgICAgICAgICAgIDogIlNldCB5b3VyIGRyYWdvbidzIGF1cmEiCiAgICAgICAgICApICsKICAgICAgICAgICI8L2gzPiIgKwogICAgICAgICAgJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicgKwogICAgICAgICAgJzxkaXYgaWQ9ImRyYWdvbkF1cmFJbmZvIiBzdHlsZT0ibWluLWhlaWdodDo2MHB4OyI+PC9kaXY+JyArCiAgICAgICAgICAnPGRpdiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7Ij4nICsKICAgICAgICAgIHN0ciArCiAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgICAnPGRpdiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7bWFyZ2luLWJvdHRvbTo4cHg7Ij4nICsKICAgICAgICAgIChoaWdoZXN0QnVpbGRpbmcgPT0gMAogICAgICAgICAgICA/IGxvYygKICAgICAgICAgICAgICAgICJTd2l0Y2hpbmcgeW91ciBhdXJhIGlzIDxiPmZyZWU8L2I+IGJlY2F1c2UgeW91IG93biBubyBidWlsZGluZ3MuIgogICAgICAgICAgICAgICkKICAgICAgICAgICAgOiBsb2MoCiAgICAgICAgICAgICAgICAiVGhlIGNvc3Qgb2Ygc3dpdGNoaW5nIHlvdXIgYXVyYSBpcyA8Yj4lMTwvYj4uPGJyPlRoaXMgd2lsbCBhZmZlY3QgeW91ciBDcFMhIiwKICAgICAgICAgICAgICAgIGxvYygiJTEgIiArIGhpZ2hlc3RCdWlsZGluZy5ic2luZ2xlLCBMQmVhdXRpZnkoMSkpCiAgICAgICAgICAgICAgKSkgKwogICAgICAgICAgIjwvZGl2PiIsCiAgICAgICAgWwogICAgICAgICAgWwogICAgICAgICAgICBsb2MoIkNvbmZpcm0iKSwKICAgICAgICAgICAgKHNsb3QgPT0gMCA/ICJHYW1lLmRyYWdvbkF1cmEiIDogIkdhbWUuZHJhZ29uQXVyYTIiKSArCiAgICAgICAgICAgICAgIj1HYW1lLlNlbGVjdGluZ0RyYWdvbkF1cmE7IiArCiAgICAgICAgICAgICAgKGhpZ2hlc3RCdWlsZGluZyA9PSAwIHx8IGN1cnJlbnRBdXJhID09IEdhbWUuU2VsZWN0aW5nRHJhZ29uQXVyYQogICAgICAgICAgICAgICAgPyAiIgogICAgICAgICAgICAgICAgOiAiR2FtZS5PYmplY3RzQnlJZFsiICsKICAgICAgICAgICAgICAgICAgaGlnaGVzdEJ1aWxkaW5nLmlkICsKICAgICAgICAgICAgICAgICAgIl0uc2FjcmlmaWNlKDEpOyIpICsKICAgICAgICAgICAgICAiR2FtZS5Ub2dnbGVTcGVjaWFsTWVudSgxKTtHYW1lLkNsb3NlUHJvbXB0KCk7IiwKICAgICAgICAgIF0sCiAgICAgICAgICBsb2MoIkNhbmNlbCIpLAogICAgICAgIF0sCiAgICAgICAgMCwKICAgICAgICAid2lkZVByb21wdCIKICAgICAgKTsKICAgICAgR2FtZS5EZXNjcmliZURyYWdvbkF1cmEoR2FtZS5TZWxlY3RpbmdEcmFnb25BdXJhKTsKICAgIH07CiAgICBHYW1lLlNlbGVjdGluZ0RyYWdvbkF1cmEgPSAtMTsKICAgIEdhbWUuU2V0RHJhZ29uQXVyYSA9IGZ1bmN0aW9uIChhdXJhLCBzbG90KSB7CiAgICAgIEdhbWUuU2VsZWN0aW5nRHJhZ29uQXVyYSA9IGF1cmE7CiAgICAgIEdhbWUuU2VsZWN0RHJhZ29uQXVyYShzbG90LCAxKTsKICAgIH07CiAgICBHYW1lLkRlc2NyaWJlRHJhZ29uQXVyYSA9IGZ1bmN0aW9uIChhdXJhKSB7CiAgICAgIGwoImRyYWdvbkF1cmFJbmZvIikuaW5uZXJIVE1MID0KICAgICAgICAnPGRpdiBzdHlsZT0ibWluLXdpZHRoOjIwMHB4O3RleHQtYWxpZ246Y2VudGVyOyI+PGg0PicgKwogICAgICAgIEdhbWUuZHJhZ29uQXVyYXNbYXVyYV0uZG5hbWUgKwogICAgICAgICI8L2g0PiIgKwogICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICBHYW1lLmRyYWdvbkF1cmFzW2F1cmFdLmRlc2MgKwogICAgICAgICI8L2Rpdj4iOwogICAgfTsKCiAgICBHYW1lLlVwZ3JhZGVEcmFnb24gPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICgKICAgICAgICBHYW1lLmRyYWdvbkxldmVsIDwgR2FtZS5kcmFnb25MZXZlbHMubGVuZ3RoIC0gMSAmJgogICAgICAgIEdhbWUuZHJhZ29uTGV2ZWxzW0dhbWUuZHJhZ29uTGV2ZWxdLmNvc3QoKQogICAgICApIHsKICAgICAgICBQbGF5U291bmQoInNuZC9zaGltbWVyQ2xpY2subXAzIik7CiAgICAgICAgR2FtZS5kcmFnb25MZXZlbHNbR2FtZS5kcmFnb25MZXZlbF0uYnV5KCk7CiAgICAgICAgR2FtZS5kcmFnb25MZXZlbCA9IChHYW1lLmRyYWdvbkxldmVsICsgMSkgJSBHYW1lLmRyYWdvbkxldmVscy5sZW5ndGg7CgogICAgICAgIGlmIChHYW1lLmRyYWdvbkxldmVsID49IEdhbWUuZHJhZ29uTGV2ZWxzLmxlbmd0aCAtIDEpCiAgICAgICAgICBHYW1lLldpbigiSGVyZSBiZSBkcmFnb24iKTsKICAgICAgICBHYW1lLlRvZ2dsZVNwZWNpYWxNZW51KDEpOwogICAgICAgIGlmIChsKCJzcGVjaWFsUGljIikpIHsKICAgICAgICAgIHZhciByZWN0ID0gbCgic3BlY2lhbFBpYyIpLmdldEJvdW5kcygpOwogICAgICAgICAgR2FtZS5TcGFya2xlQXQoCiAgICAgICAgICAgIChyZWN0LmxlZnQgKyByZWN0LnJpZ2h0KSAvIDIsCiAgICAgICAgICAgIChyZWN0LnRvcCArIHJlY3QuYm90dG9tKSAvIDIKICAgICAgICAgICkgKwogICAgICAgICAgICAzMiAtCiAgICAgICAgICAgIFRvcEJhck9mZnNldDsKICAgICAgICB9CiAgICAgICAgR2FtZS5yZWNhbGN1bGF0ZUdhaW5zID0gMTsKICAgICAgICBHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkID0gMTsKICAgICAgfQogICAgfTsKCiAgICBHYW1lLmxhc3RDbGlja2VkU3BlY2lhbFBpYyA9IDA7CiAgICBHYW1lLkNsaWNrU3BlY2lhbFBpYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKAogICAgICAgIEdhbWUuc3BlY2lhbFRhYiA9PSAiZHJhZ29uIiAmJgogICAgICAgIEdhbWUuZHJhZ29uTGV2ZWwgPj0gNCAmJgogICAgICAgIEdhbWUuSGFzKCJQZXQgdGhlIGRyYWdvbiIpICYmCiAgICAgICAgbCgic3BlY2lhbFBpYyIpCiAgICAgICkgewogICAgICAgIHRyaWdnZXJBbmltKGwoInNwZWNpYWxQaWMiKSwgInB1Y2tlciIpOwogICAgICAgIFBsYXlTb3VuZCgKICAgICAgICAgICJzbmQvY2xpY2siICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyArIDEpICsgIi5tcDMiLAogICAgICAgICAgMC41CiAgICAgICAgKTsKICAgICAgICBpZiAoRGF0ZS5ub3coKSAtIEdhbWUubGFzdENsaWNrZWRTcGVjaWFsUGljID4gMjAwMCkKICAgICAgICAgIFBsYXlTb3VuZCgic25kL2dyb3dsLm1wMyIpOwogICAgICAgIC8vZWxzZSBpZiAoTWF0aC5yYW5kb20oKTwwLjUpIFBsYXlTb3VuZCgnc25kL2dyb3dsLm1wMycsMC41K01hdGgucmFuZG9tKCkqMC4yKTsKICAgICAgICBHYW1lLmxhc3RDbGlja2VkU3BlY2lhbFBpYyA9IERhdGUubm93KCk7CiAgICAgICAgaWYgKEdhbWUucHJlZnMucGFydGljbGVzKSB7CiAgICAgICAgICBHYW1lLnBhcnRpY2xlQWRkKAogICAgICAgICAgICBHYW1lLm1vdXNlWCwKICAgICAgICAgICAgR2FtZS5tb3VzZVkgLSAzMiwKICAgICAgICAgICAgTWF0aC5yYW5kb20oKSAqIDQgLSAyLAogICAgICAgICAgICBNYXRoLnJhbmRvbSgpICogLTIgLSA0LAogICAgICAgICAgICBNYXRoLnJhbmRvbSgpICogMC4yICsgMC41LAogICAgICAgICAgICAxLAogICAgICAgICAgICAyLAogICAgICAgICAgICBbMjAsIDNdCiAgICAgICAgICApOwogICAgICAgIH0KICAgICAgICBpZiAoR2FtZS5kcmFnb25MZXZlbCA+PSA4ICYmIE1hdGgucmFuZG9tKCkgPCAxIC8gMjApIHsKICAgICAgICAgIE1hdGguc2VlZHJhbmRvbShHYW1lLnNlZWQgKyAiL2RyYWdvblRpbWUiKTsKICAgICAgICAgIHZhciBkcm9wcyA9IFsKICAgICAgICAgICAgIkRyYWdvbiBzY2FsZSIsCiAgICAgICAgICAgICJEcmFnb24gY2xhdyIsCiAgICAgICAgICAgICJEcmFnb24gZmFuZyIsCiAgICAgICAgICAgICJEcmFnb24gdGVkZHkgYmVhciIsCiAgICAgICAgICBdOwogICAgICAgICAgZHJvcHMgPSBzaHVmZmxlKGRyb3BzKTsKICAgICAgICAgIHZhciBkcm9wID0KICAgICAgICAgICAgZHJvcHNbTWF0aC5mbG9vcigobmV3IERhdGUoKS5nZXRNaW51dGVzKCkgLyA2MCkgKiBkcm9wcy5sZW5ndGgpXTsKICAgICAgICAgIGlmICghR2FtZS5IYXMoZHJvcCkgJiYgIUdhbWUuSGFzVW5sb2NrZWQoZHJvcCkpIHsKICAgICAgICAgICAgR2FtZS5VbmxvY2soZHJvcCk7CiAgICAgICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgICAgIGRyb3AsCiAgICAgICAgICAgICAgIjxiPiIgKyBsb2MoIllvdXIgZHJhZ29uIGRyb3BwZWQgc29tZXRoaW5nISIpICsgIjwvYj4iLAogICAgICAgICAgICAgIEdhbWUuVXBncmFkZXNbZHJvcF0uaWNvbgogICAgICAgICAgICApOwogICAgICAgICAgfQogICAgICAgICAgTWF0aC5zZWVkcmFuZG9tKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIEdhbWUuVG9nZ2xlU3BlY2lhbE1lbnUgPSBmdW5jdGlvbiAob24pIHsKICAgICAgaWYgKG9uKSB7CiAgICAgICAgdmFyIHBpYyA9ICIiOwogICAgICAgIHZhciBmcmFtZSA9IDA7CiAgICAgICAgaWYgKEdhbWUuc3BlY2lhbFRhYiA9PSAic2FudGEiKSB7CiAgICAgICAgICBwaWMgPSAic2FudGEucG5nIjsKICAgICAgICAgIGZyYW1lID0gR2FtZS5zYW50YUxldmVsOwogICAgICAgIH0gZWxzZSBpZiAoR2FtZS5zcGVjaWFsVGFiID09ICJkcmFnb24iKSB7CiAgICAgICAgICBwaWMgPSAiZHJhZ29uLnBuZz92PSIgKyBHYW1lLnZlcnNpb247CiAgICAgICAgICBmcmFtZSA9IEdhbWUuZHJhZ29uTGV2ZWxzW0dhbWUuZHJhZ29uTGV2ZWxdLnBpYzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcGljID0gImRyYWdvbi5wbmc/dj0iICsgR2FtZS52ZXJzaW9uOwogICAgICAgICAgZnJhbWUgPSA0OwogICAgICAgIH0KCiAgICAgICAgdmFyIHN0ciA9CiAgICAgICAgICAnPGRpdiBpZD0ic3BlY2lhbFBpYyIgJyArCiAgICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAgICc9IkdhbWUuQ2xpY2tTcGVjaWFsUGljKCk7IiBzdHlsZT0iJyArCiAgICAgICAgICAoR2FtZS5zcGVjaWFsVGFiID09ICJkcmFnb24iICYmCiAgICAgICAgICBHYW1lLmRyYWdvbkxldmVsID49IDQgJiYKICAgICAgICAgIEdhbWUuSGFzKCJQZXQgdGhlIGRyYWdvbiIpCiAgICAgICAgICAgID8gImN1cnNvcjpwb2ludGVyOyIKICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgInBvc2l0aW9uOmFic29sdXRlO2xlZnQ6LTE2cHg7dG9wOi02NHB4O3dpZHRoOjk2cHg7aGVpZ2h0Ojk2cHg7YmFja2dyb3VuZDp1cmwoaW1nLyIgKwogICAgICAgICAgcGljICsKICAgICAgICAgICIpO2JhY2tncm91bmQtcG9zaXRpb246IiArCiAgICAgICAgICAtZnJhbWUgKiA5NiArCiAgICAgICAgICAncHggMHB4O2ZpbHRlcjpkcm9wLXNoYWRvdygwcHggM3B4IDJweCAjMDAwKTstd2Via2l0LWZpbHRlcjpkcm9wLXNoYWRvdygwcHggM3B4IDJweCAjMDAwKTsiPjwvZGl2Pic7CiAgICAgICAgc3RyICs9CiAgICAgICAgICAnPGRpdiBjbGFzcz0iY2xvc2UiIG9uY2xpY2s9IlBsYXlTb3VuZChcJ3NuZC9wcmVzcy5tcDNcJyk7R2FtZS5Ub2dnbGVTcGVjaWFsTWVudSgwKTsiPng8L2Rpdj4nOwoKICAgICAgICBpZiAoR2FtZS5zcGVjaWFsVGFiID09ICJzYW50YSIpIHsKICAgICAgICAgIHZhciBtb25pID0gTWF0aC5wb3coR2FtZS5zYW50YUxldmVsICsgMSwgR2FtZS5zYW50YUxldmVsICsgMSk7CgogICAgICAgICAgc3RyICs9CiAgICAgICAgICAgICc8aDMgc3R5bGU9InBvaW50ZXItZXZlbnRzOm5vbmU7Ij4nICsKICAgICAgICAgICAgR2FtZS5zYW50YUxldmVsc1tHYW1lLnNhbnRhTGV2ZWxdICsKICAgICAgICAgICAgIjwvaDM+IjsKICAgICAgICAgIGlmIChHYW1lLnNhbnRhTGV2ZWwgPCAxNCkgewogICAgICAgICAgICBzdHIgKz0KICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9Im9wdGlvbkJveCIgc3R5bGU9Im1hcmdpbi1ib3R0b206MHB4OyI+PGEgY2xhc3M9Im9wdGlvbiBmcmFtZWQgbGFyZ2UgdGl0bGUiICcgKwogICAgICAgICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICAgICAgICc9IkdhbWUuVXBncmFkZVNhbnRhKCk7Ij4nICsKICAgICAgICAgICAgICAnPGRpdiBzdHlsZT0iZGlzcGxheTp0YWJsZS1jZWxsO3ZlcnRpY2FsLWFsaWduOm1pZGRsZTsiPicgKwogICAgICAgICAgICAgIGxvYygiRXZvbHZlIikgKwogICAgICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICAgICAnPGRpdiBzdHlsZT0iZGlzcGxheTp0YWJsZS1jZWxsO3ZlcnRpY2FsLWFsaWduOm1pZGRsZTtwYWRkaW5nOjRweCAxMnB4OyI+fDwvZGl2PicgKwogICAgICAgICAgICAgICc8ZGl2IHN0eWxlPSJkaXNwbGF5OnRhYmxlLWNlbGw7dmVydGljYWwtYWxpZ246bWlkZGxlO2ZvbnQtc2l6ZTo2NSU7Ij4nICsKICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAic2FjcmlmaWNlICUxIiwKICAgICAgICAgICAgICAgICI8ZGl2IiArCiAgICAgICAgICAgICAgICAgIChHYW1lLmNvb2tpZXMgPiBtb25pID8gIiIgOiAnIHN0eWxlPSJjb2xvcjojNzc3OyInKSArCiAgICAgICAgICAgICAgICAgICI+IiArCiAgICAgICAgICAgICAgICAgIGxvYygKICAgICAgICAgICAgICAgICAgICAiJTEgY29va2llIiwKICAgICAgICAgICAgICAgICAgICBMQmVhdXRpZnkoCiAgICAgICAgICAgICAgICAgICAgICBNYXRoLnBvdyhHYW1lLnNhbnRhTGV2ZWwgKyAxLCBHYW1lLnNhbnRhTGV2ZWwgKyAxKQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgKSArCiAgICAgICAgICAgICAgICAgICI8L2Rpdj4iCiAgICAgICAgICAgICAgKSArCiAgICAgICAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICAgICAgICI8L2E+PC9kaXY+IjsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKEdhbWUuc3BlY2lhbFRhYiA9PSAiZHJhZ29uIikgewogICAgICAgICAgdmFyIGxldmVsID0gR2FtZS5kcmFnb25MZXZlbHNbR2FtZS5kcmFnb25MZXZlbF07CgogICAgICAgICAgc3RyICs9ICc8aDMgc3R5bGU9InBvaW50ZXItZXZlbnRzOm5vbmU7Ij4nICsgbGV2ZWwubmFtZSArICI8L2gzPiI7CgogICAgICAgICAgaWYgKEdhbWUuZHJhZ29uTGV2ZWwgPj0gNSkgewogICAgICAgICAgICB2YXIgaWNvbiA9IEdhbWUuZHJhZ29uQXVyYXNbR2FtZS5kcmFnb25BdXJhXS5waWM7CiAgICAgICAgICAgIHN0ciArPQogICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJjcmF0ZSBlbmFibGVkIiBzdHlsZT0ib3BhY2l0eToxO3Bvc2l0aW9uOmFic29sdXRlO3JpZ2h0OjE4cHg7dG9wOi01OHB4OycgKwogICAgICAgICAgICAgIHdyaXRlSWNvbihpY29uKSArCiAgICAgICAgICAgICAgJyIgJyArCiAgICAgICAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgICAgICAgIj1cIlBsYXlTb3VuZCgnc25kL3RpY2subXAzJyk7R2FtZS5TZWxlY3REcmFnb25BdXJhKDApO1wiICIgKwogICAgICAgICAgICAgIEdhbWUuZ2V0VG9vbHRpcCgKICAgICAgICAgICAgICAgICc8ZGl2IHN0eWxlPSJtaW4td2lkdGg6MjAwcHg7dGV4dC1hbGlnbjpjZW50ZXI7IiBpZD0idG9vbHRpcERyYWdvbkF1cmFTZWxlY3QiPjxoND4nICsKICAgICAgICAgICAgICAgICAgR2FtZS5kcmFnb25BdXJhc1tHYW1lLmRyYWdvbkF1cmFdLmRuYW1lICsKICAgICAgICAgICAgICAgICAgIjwvaDQ+IiArCiAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICAgICAgICAgICAgR2FtZS5kcmFnb25BdXJhc1tHYW1lLmRyYWdvbkF1cmFdLmRlc2MgKwogICAgICAgICAgICAgICAgICAiPC9kaXY+IiwKICAgICAgICAgICAgICAgICJ0b3AiCiAgICAgICAgICAgICAgKSArCiAgICAgICAgICAgICAgIj48L2Rpdj4iOwogICAgICAgICAgfQogICAgICAgICAgaWYgKEdhbWUuZHJhZ29uTGV2ZWwgPj0gMjYpIHsKICAgICAgICAgICAgLy8ybmQgYXVyYSBzbG90OyBpbmNyZWFzZWQgd2l0aCBsYXN0IGJ1aWxkaW5nIChjb3J0ZXggYmFrZXIpCiAgICAgICAgICAgIHZhciBpY29uID0gR2FtZS5kcmFnb25BdXJhc1tHYW1lLmRyYWdvbkF1cmEyXS5waWM7CiAgICAgICAgICAgIHN0ciArPQogICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJjcmF0ZSBlbmFibGVkIiBzdHlsZT0ib3BhY2l0eToxO3Bvc2l0aW9uOmFic29sdXRlO3JpZ2h0OjgwcHg7dG9wOi01OHB4OycgKwogICAgICAgICAgICAgIHdyaXRlSWNvbihpY29uKSArCiAgICAgICAgICAgICAgJyIgJyArCiAgICAgICAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgICAgICAgIj1cIlBsYXlTb3VuZCgnc25kL3RpY2subXAzJyk7R2FtZS5TZWxlY3REcmFnb25BdXJhKDEpO1wiICIgKwogICAgICAgICAgICAgIEdhbWUuZ2V0VG9vbHRpcCgKICAgICAgICAgICAgICAgICc8ZGl2IHN0eWxlPSJtaW4td2lkdGg6MjAwcHg7dGV4dC1hbGlnbjpjZW50ZXI7IiBpZD0idG9vbHRpcERyYWdvbkF1cmFTZWxlY3QyIj48aDQ+JyArCiAgICAgICAgICAgICAgICAgIEdhbWUuZHJhZ29uQXVyYXNbR2FtZS5kcmFnb25BdXJhMl0uZG5hbWUgKwogICAgICAgICAgICAgICAgICAiPC9oND4iICsKICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicgKwogICAgICAgICAgICAgICAgICBHYW1lLmRyYWdvbkF1cmFzW0dhbWUuZHJhZ29uQXVyYTJdLmRlc2MgKwogICAgICAgICAgICAgICAgICAiPC9kaXY+IiwKICAgICAgICAgICAgICAgICJ0b3AiCiAgICAgICAgICAgICAgKSArCiAgICAgICAgICAgICAgIj48L2Rpdj4iOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChHYW1lLmRyYWdvbkxldmVsIDwgR2FtZS5kcmFnb25MZXZlbHMubGVuZ3RoIC0gMSkgewogICAgICAgICAgICBzdHIgKz0KICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9Im9wdGlvbkJveCIgc3R5bGU9Im1hcmdpbi1ib3R0b206MHB4OyI+PGEgY2xhc3M9Im9wdGlvbiBmcmFtZWQgbGFyZ2UgdGl0bGUiICcgKwogICAgICAgICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICAgICAgICc9IkdhbWUuVXBncmFkZURyYWdvbigpOyI+JyArCiAgICAgICAgICAgICAgJzxkaXYgc3R5bGU9ImRpc3BsYXk6dGFibGUtY2VsbDt2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7Ij4nICsKICAgICAgICAgICAgICBsZXZlbC5hY3Rpb24gKwogICAgICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICAgICAnPGRpdiBzdHlsZT0iZGlzcGxheTp0YWJsZS1jZWxsO3ZlcnRpY2FsLWFsaWduOm1pZGRsZTtwYWRkaW5nOjRweCAxMnB4OyI+fDwvZGl2PicgKwogICAgICAgICAgICAgICc8ZGl2IHN0eWxlPSJkaXNwbGF5OnRhYmxlLWNlbGw7dmVydGljYWwtYWxpZ246bWlkZGxlO2ZvbnQtc2l6ZTo2NSU7Ij4nICsKICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAic2FjcmlmaWNlICUxIiwKICAgICAgICAgICAgICAgICI8ZGl2IiArCiAgICAgICAgICAgICAgICAgIChsZXZlbC5jb3N0KCkgPyAiIiA6ICcgc3R5bGU9ImNvbG9yOiM3Nzc7IicpICsKICAgICAgICAgICAgICAgICAgIj4iICsKICAgICAgICAgICAgICAgICAgbGV2ZWwuY29zdFN0cigpICsKICAgICAgICAgICAgICAgICAgIjwvZGl2PiIKICAgICAgICAgICAgICApICsKICAgICAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAgICAgIjwvYT48L2Rpdj4iOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3RyICs9CiAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicgKwogICAgICAgICAgICAgICc8ZGl2IHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjttYXJnaW4tYm90dG9tOjRweDsiPicgKwogICAgICAgICAgICAgIGxldmVsLmFjdGlvbiArCiAgICAgICAgICAgICAgIjwvZGl2PiI7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBsKCJzcGVjaWFsUG9wdXAiKS5pbm5lckhUTUwgPSBzdHI7CgogICAgICAgIGwoInNwZWNpYWxQb3B1cCIpLmNsYXNzTmFtZSA9ICJmcmFtZWQgcHJvbXB0IG9uU2NyZWVuIjsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoR2FtZS5zcGVjaWFsVGFiICE9ICIiKSB7CiAgICAgICAgICBHYW1lLnNwZWNpYWxUYWIgPSAiIjsKICAgICAgICAgIGwoInNwZWNpYWxQb3B1cCIpLmNsYXNzTmFtZSA9ICJmcmFtZWQgcHJvbXB0IG9mZlNjcmVlbiI7CiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgaWYgKEdhbWUuc3BlY2lhbFRhYiA9PSAiIikgewogICAgICAgICAgICAgIC8qbCgnc3BlY2lhbFBvcHVwJykuc3R5bGUuZGlzcGxheT0nbm9uZSc7Ki8gbCgKICAgICAgICAgICAgICAgICJzcGVjaWFsUG9wdXAiCiAgICAgICAgICAgICAgKS5pbm5lckhUTUwgPSAiIjsKICAgICAgICAgICAgfQogICAgICAgICAgfSwgMTAwMCAqIDAuMik7CiAgICAgICAgfQogICAgICB9CiAgICB9OwogICAgR2FtZS5EcmF3U3BlY2lhbCA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGxlbiA9IEdhbWUuc3BlY2lhbFRhYnMubGVuZ3RoOwogICAgICBpZiAobGVuID09IDApIHJldHVybjsKICAgICAgR2FtZS5MZWZ0QmFja2dyb3VuZC5nbG9iYWxBbHBoYSA9IDE7CiAgICAgIHZhciB5ID0gR2FtZS5MZWZ0QmFja2dyb3VuZC5jYW52YXMuaGVpZ2h0IC0gMjQgLSA0OCAqIGxlbjsKICAgICAgdmFyIHRhYkkgPSAwOwoKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLnNwZWNpYWxUYWJzKSB7CiAgICAgICAgdmFyIHNlbGVjdGVkID0gMDsKICAgICAgICB2YXIgaG92ZXJlZCA9IDA7CiAgICAgICAgaWYgKEdhbWUuc3BlY2lhbFRhYiA9PSBHYW1lLnNwZWNpYWxUYWJzW2ldKSBzZWxlY3RlZCA9IDE7CiAgICAgICAgaWYgKEdhbWUuc3BlY2lhbFRhYkhvdmVyZWQgPT0gR2FtZS5zcGVjaWFsVGFic1tpXSkgaG92ZXJlZCA9IDE7CiAgICAgICAgdmFyIHggPSAyNDsKICAgICAgICB2YXIgcyA9IDE7CiAgICAgICAgdmFyIHBpYyA9ICIiOwogICAgICAgIHZhciBmcmFtZSA9IDA7CiAgICAgICAgaWYgKGhvdmVyZWQpIHsKICAgICAgICAgIHMgPSAxOwogICAgICAgICAgeCA9IDI0OwogICAgICAgIH0KICAgICAgICBpZiAoc2VsZWN0ZWQpIHsKICAgICAgICAgIHMgPSAxOwogICAgICAgICAgeCA9IDQ4OwogICAgICAgIH0KCiAgICAgICAgaWYgKEdhbWUuc3BlY2lhbFRhYnNbaV0gPT0gInNhbnRhIikgewogICAgICAgICAgcGljID0gInNhbnRhLnBuZyI7CiAgICAgICAgICBmcmFtZSA9IEdhbWUuc2FudGFMZXZlbDsKICAgICAgICB9IGVsc2UgaWYgKEdhbWUuc3BlY2lhbFRhYnNbaV0gPT0gImRyYWdvbiIpIHsKICAgICAgICAgIHBpYyA9ICJkcmFnb24ucG5nP3Y9IiArIEdhbWUudmVyc2lvbjsKICAgICAgICAgIGZyYW1lID0gR2FtZS5kcmFnb25MZXZlbHNbR2FtZS5kcmFnb25MZXZlbF0ucGljOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBwaWMgPSAiZHJhZ29uLnBuZz92PSIgKyBHYW1lLnZlcnNpb247CiAgICAgICAgICBmcmFtZSA9IDQ7CiAgICAgICAgfQoKICAgICAgICBpZiAoaG92ZXJlZCB8fCBzZWxlY3RlZCkgewogICAgICAgICAgdmFyIHNzID0gcyAqIDY0OwogICAgICAgICAgdmFyIHIgPSBNYXRoLmZsb29yKChHYW1lLlQgKiAwLjUpICUgMzYwKTsKICAgICAgICAgIEdhbWUuTGVmdEJhY2tncm91bmQuc2F2ZSgpOwogICAgICAgICAgR2FtZS5MZWZ0QmFja2dyb3VuZC50cmFuc2xhdGUoeCwgeSk7CiAgICAgICAgICBpZiAoR2FtZS5wcmVmcy5mYW5jeSkKICAgICAgICAgICAgR2FtZS5MZWZ0QmFja2dyb3VuZC5yb3RhdGUoKHIgLyAzNjApICogTWF0aC5QSSAqIDIpOwogICAgICAgICAgR2FtZS5MZWZ0QmFja2dyb3VuZC5nbG9iYWxBbHBoYSA9IDAuNzU7CiAgICAgICAgICBHYW1lLkxlZnRCYWNrZ3JvdW5kLmRyYXdJbWFnZSgKICAgICAgICAgICAgUGljKCJzaGluZS5wbmciKSwKICAgICAgICAgICAgLXNzIC8gMiwKICAgICAgICAgICAgLXNzIC8gMiwKICAgICAgICAgICAgc3MsCiAgICAgICAgICAgIHNzCiAgICAgICAgICApOwogICAgICAgICAgR2FtZS5MZWZ0QmFja2dyb3VuZC5yZXN0b3JlKCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoR2FtZS5wcmVmcy5mYW5jeSkKICAgICAgICAgIEdhbWUuTGVmdEJhY2tncm91bmQuZHJhd0ltYWdlKAogICAgICAgICAgICBQaWMocGljKSwKICAgICAgICAgICAgOTYgKiBmcmFtZSwKICAgICAgICAgICAgMCwKICAgICAgICAgICAgOTYsCiAgICAgICAgICAgIDk2LAogICAgICAgICAgICB4ICsgKHNlbGVjdGVkID8gMCA6IE1hdGguc2luKEdhbWUuVCAqIDAuMiArIHRhYkkpICogMykgLSAyNCAqIHMsCiAgICAgICAgICAgIHkgLQogICAgICAgICAgICAgIChzZWxlY3RlZCA/IDYgOiBNYXRoLmFicyhNYXRoLmNvcyhHYW1lLlQgKiAwLjIgKyB0YWJJKSkgKiA2KSAtCiAgICAgICAgICAgICAgMjQgKiBzLAogICAgICAgICAgICA0OCAqIHMsCiAgICAgICAgICAgIDQ4ICogcwogICAgICAgICAgKTsKICAgICAgICBlbHNlCiAgICAgICAgICBHYW1lLkxlZnRCYWNrZ3JvdW5kLmRyYXdJbWFnZSgKICAgICAgICAgICAgUGljKHBpYyksCiAgICAgICAgICAgIDk2ICogZnJhbWUsCiAgICAgICAgICAgIDAsCiAgICAgICAgICAgIDk2LAogICAgICAgICAgICA5NiwKICAgICAgICAgICAgeCAtIDI0ICogcywKICAgICAgICAgICAgeSAtIDI0ICogcywKICAgICAgICAgICAgNDggKiBzLAogICAgICAgICAgICA0OCAqIHMKICAgICAgICAgICk7CgogICAgICAgIHRhYkkrKzsKICAgICAgICB5ICs9IDQ4OwogICAgICB9CiAgICB9OwoKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJCVZJU1VBTCBFRkZFQ1RTCgkJPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KCiAgICBHYW1lLkFsbE1pbGtzID0gWwogICAgICB7IG5hbWU6ICJBdXRvbWF0aWMiLCBpY29uOiBbMCwgN10sIHR5cGU6IC0xLCBwaWM6ICJtaWxrUGxhaW4iIH0sCiAgICAgIHsgbmFtZTogIlBsYWluIG1pbGsiLCBpY29uOiBbMSwgOF0sIHR5cGU6IDAsIHBpYzogIm1pbGtQbGFpbiIgfSwKICAgICAgeyBuYW1lOiAiQ2hvY29sYXRlIG1pbGsiLCBpY29uOiBbMiwgOF0sIHR5cGU6IDAsIHBpYzogIm1pbGtDaG9jb2xhdGUiIH0sCiAgICAgIHsgbmFtZTogIlJhc3BiZXJyeSBtaWxrIiwgaWNvbjogWzMsIDhdLCB0eXBlOiAwLCBwaWM6ICJtaWxrUmFzcGJlcnJ5IiB9LAogICAgICB7IG5hbWU6ICJPcmFuZ2UgbWlsayIsIGljb246IFs0LCA4XSwgdHlwZTogMCwgcGljOiAibWlsa09yYW5nZSIgfSwKICAgICAgeyBuYW1lOiAiQ2FyYW1lbCBtaWxrIiwgaWNvbjogWzUsIDhdLCB0eXBlOiAwLCBwaWM6ICJtaWxrQ2FyYW1lbCIgfSwKICAgICAgeyBuYW1lOiAiQmFuYW5hIG1pbGsiLCBpY29uOiBbNiwgOF0sIHR5cGU6IDAsIHBpYzogIm1pbGtCYW5hbmEiIH0sCiAgICAgIHsgbmFtZTogIkxpbWUgbWlsayIsIGljb246IFs3LCA4XSwgdHlwZTogMCwgcGljOiAibWlsa0xpbWUiIH0sCiAgICAgIHsgbmFtZTogIkJsdWViZXJyeSBtaWxrIiwgaWNvbjogWzgsIDhdLCB0eXBlOiAwLCBwaWM6ICJtaWxrQmx1ZWJlcnJ5IiB9LAogICAgICB7IG5hbWU6ICJTdHJhd2JlcnJ5IG1pbGsiLCBpY29uOiBbOSwgOF0sIHR5cGU6IDAsIHBpYzogIm1pbGtTdHJhd2JlcnJ5IiB9LAogICAgICB7IG5hbWU6ICJWYW5pbGxhIG1pbGsiLCBpY29uOiBbMTAsIDhdLCB0eXBlOiAwLCBwaWM6ICJtaWxrVmFuaWxsYSIgfSwKICAgICAgeyBuYW1lOiAiWmVicmEgbWlsayIsIGljb246IFsxMCwgN10sIHR5cGU6IDEsIHBpYzogIm1pbGtaZWJyYSIgfSwKICAgICAgeyBuYW1lOiAiQ29zbWljIG1pbGsiLCBpY29uOiBbOSwgN10sIHR5cGU6IDEsIHBpYzogIm1pbGtTdGFycyIgfSwKICAgICAgeyBuYW1lOiAiRmxhbWluZyBtaWxrIiwgaWNvbjogWzgsIDddLCB0eXBlOiAxLCBwaWM6ICJtaWxrRmlyZSIgfSwKICAgICAgeyBuYW1lOiAiU2FuZ3VpbmUgbWlsayIsIGljb246IFs3LCA3XSwgdHlwZTogMSwgcGljOiAibWlsa0Jsb29kIiB9LAogICAgICB7IG5hbWU6ICJNaWRhcyBtaWxrIiwgaWNvbjogWzYsIDddLCB0eXBlOiAxLCBwaWM6ICJtaWxrR29sZCIgfSwKICAgICAgeyBuYW1lOiAiTWlkbmlnaHQgbWlsayIsIGljb246IFs1LCA3XSwgdHlwZTogMSwgcGljOiAibWlsa0JsYWNrIiB9LAogICAgICB7CiAgICAgICAgbmFtZTogIkdyZWVuIGluZmVybm8gbWlsayIsCiAgICAgICAgaWNvbjogWzQsIDddLAogICAgICAgIHR5cGU6IDEsCiAgICAgICAgcGljOiAibWlsa0dyZWVuRmlyZSIsCiAgICAgIH0sCiAgICAgIHsgbmFtZTogIkZyb3N0ZmlyZSBtaWxrIiwgaWNvbjogWzMsIDddLCB0eXBlOiAxLCBwaWM6ICJtaWxrQmx1ZUZpcmUiIH0sCiAgICAgIHsgbmFtZTogIkhvbmV5IG1pbGsiLCBpY29uOiBbMjEsIDIzXSwgdHlwZTogMCwgcGljOiAibWlsa0hvbmV5IiB9LAogICAgICB7IG5hbWU6ICJDb2ZmZWUgbWlsayIsIGljb246IFsyMiwgMjNdLCB0eXBlOiAwLCBwaWM6ICJtaWxrQ29mZmVlIiB9LAogICAgICB7IG5hbWU6ICJUZWEgbWlsayIsIGljb246IFsyMywgMjNdLCB0eXBlOiAwLCBwaWM6ICJtaWxrVGVhIiB9LAogICAgICB7IG5hbWU6ICJDb2NvbnV0IG1pbGsiLCBpY29uOiBbMjQsIDIzXSwgdHlwZTogMCwgcGljOiAibWlsa0NvY29udXQiIH0sCiAgICAgIHsgbmFtZTogIkNoZXJyeSBtaWxrIiwgaWNvbjogWzI1LCAyM10sIHR5cGU6IDAsIHBpYzogIm1pbGtDaGVycnkiIH0sCiAgICAgIHsgbmFtZTogIlNveSBtaWxrIiwgaWNvbjogWzI3LCAyM10sIHR5cGU6IDEsIHBpYzogIm1pbGtTb3kiIH0sCiAgICAgIHsgbmFtZTogIlNwaWNlZCBtaWxrIiwgaWNvbjogWzI2LCAyM10sIHR5cGU6IDAsIHBpYzogIm1pbGtTcGljZWQiIH0sCiAgICAgIHsgbmFtZTogIk1hcGxlIG1pbGsiLCBpY29uOiBbMjgsIDIzXSwgdHlwZTogMCwgcGljOiAibWlsa01hcGxlIiB9LAogICAgICB7IG5hbWU6ICJNaW50IG1pbGsiLCBpY29uOiBbMjksIDIzXSwgdHlwZTogMCwgcGljOiAibWlsa01pbnQiIH0sCiAgICAgIHsgbmFtZTogIkxpY29yaWNlIG1pbGsiLCBpY29uOiBbMzAsIDIzXSwgdHlwZTogMCwgcGljOiAibWlsa0xpY29yaWNlIiB9LAogICAgICB7IG5hbWU6ICJSb3NlIG1pbGsiLCBpY29uOiBbMzEsIDIzXSwgdHlwZTogMCwgcGljOiAibWlsa1Jvc2UiIH0sCiAgICAgIHsKICAgICAgICBuYW1lOiAiRHJhZ29uZnJ1aXQgbWlsayIsCiAgICAgICAgaWNvbjogWzIxLCAyNF0sCiAgICAgICAgdHlwZTogMCwKICAgICAgICBwaWM6ICJtaWxrRHJhZ29uZnJ1aXQiLAogICAgICB9LAogICAgICB7IG5hbWU6ICJNZWxvbiBtaWxrIiwgaWNvbjogWzIyLCAyNF0sIHR5cGU6IDAsIHBpYzogIm1pbGtNZWxvbiIgfSwKICAgICAgewogICAgICAgIG5hbWU6ICJCbGFja2N1cnJhbnQgbWlsayIsCiAgICAgICAgaWNvbjogWzIzLCAyNF0sCiAgICAgICAgdHlwZTogMCwKICAgICAgICBwaWM6ICJtaWxrQmxhY2tjdXJyYW50IiwKICAgICAgfSwKICAgIF07CgogICAgR2FtZS5NaWxrcyA9IFtdOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBHYW1lLkFsbE1pbGtzLmxlbmd0aDsgaSsrKSB7CiAgICAgIEdhbWUuQWxsTWlsa3NbaV0uYm5hbWUgPSBHYW1lLkFsbE1pbGtzW2ldLm5hbWU7CiAgICAgIEdhbWUuQWxsTWlsa3NbaV0ubmFtZSA9IGxvYyhHYW1lLkFsbE1pbGtzW2ldLm5hbWUpOwogICAgICBHYW1lLkFsbE1pbGtzW2ldLnBpYyArPSAiLnBuZyI7CiAgICAgIGlmIChHYW1lLkFsbE1pbGtzW2ldLnR5cGUgPT0gMCkgewogICAgICAgIEdhbWUuQWxsTWlsa3NbaV0ucmFuayA9IEdhbWUuTWlsa3MubGVuZ3RoOwogICAgICAgIEdhbWUuTWlsa3MucHVzaChHYW1lLkFsbE1pbGtzW2ldKTsKICAgICAgfQogICAgfQogICAgR2FtZS5NaWxrID0gR2FtZS5NaWxrc1swXTsKCiAgICBHYW1lLm1vdXNlUG9pbnRlciA9IDA7IC8vd2hlbiAxLCBkcmF3IHRoZSBtb3VzZSBhcyBhIHBvaW50ZXIgb24gdGhlIGxlZnQgc2NyZWVuCgogICAgR2FtZS5jb29raWVPcmlnaW5YID0gMDsKICAgIEdhbWUuY29va2llT3JpZ2luWSA9IDA7CiAgICBHYW1lLkRyYXdCYWNrZ3JvdW5kID0gZnVuY3Rpb24gKCkgewogICAgICBUaW1lci5jbGVhbigpOwogICAgICAvL2JhY2tncm91bmQKICAgICAgaWYgKCFHYW1lLkJhY2tncm91bmQpIHsKICAgICAgICAvL2luaXQgc29tZSBzdHVmZgogICAgICAgIEdhbWUuQmFja2dyb3VuZCA9IGwoImJhY2tncm91bmRDYW52YXMiKS5nZXRDb250ZXh0KCIyZCIpOwogICAgICAgIEdhbWUuQmFja2dyb3VuZC5jYW52YXMud2lkdGggPQogICAgICAgICAgR2FtZS5CYWNrZ3JvdW5kLmNhbnZhcy5wYXJlbnROb2RlLm9mZnNldFdpZHRoOwogICAgICAgIEdhbWUuQmFja2dyb3VuZC5jYW52YXMuaGVpZ2h0ID0KICAgICAgICAgIEdhbWUuQmFja2dyb3VuZC5jYW52YXMucGFyZW50Tm9kZS5vZmZzZXRIZWlnaHQ7CiAgICAgICAgR2FtZS5MZWZ0QmFja2dyb3VuZCA9IGwoImJhY2tncm91bmRMZWZ0Q2FudmFzIikuZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgICBHYW1lLkxlZnRCYWNrZ3JvdW5kLmNhbnZhcy53aWR0aCA9CiAgICAgICAgICBHYW1lLkxlZnRCYWNrZ3JvdW5kLmNhbnZhcy5wYXJlbnROb2RlLm9mZnNldFdpZHRoOwogICAgICAgIEdhbWUuTGVmdEJhY2tncm91bmQuY2FudmFzLmhlaWdodCA9CiAgICAgICAgICBHYW1lLkxlZnRCYWNrZ3JvdW5kLmNhbnZhcy5wYXJlbnROb2RlLm9mZnNldEhlaWdodDsKICAgICAgICAvL3ByZWxvYWQgYXNjZW5kIGFuaW1hdGlvbiBiaXRzIHNvIHRoZXkgc2hvdyB1cCBpbnN0YW50bHkKICAgICAgICBHYW1lLkxlZnRCYWNrZ3JvdW5kLmdsb2JhbEFscGhhID0gMDsKICAgICAgICBHYW1lLkxlZnRCYWNrZ3JvdW5kLmRyYXdJbWFnZShQaWMoImJyb2tlbkNvb2tpZS5wbmciKSwgMCwgMCk7CiAgICAgICAgR2FtZS5MZWZ0QmFja2dyb3VuZC5kcmF3SW1hZ2UoUGljKCJicm9rZW5Db29raWVIYWxvLnBuZyIpLCAwLCAwKTsKICAgICAgICBHYW1lLkxlZnRCYWNrZ3JvdW5kLmRyYXdJbWFnZShQaWMoInN0YXJiZy5qcGciKSwgMCwgMCk7CgogICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJyZXNpemUiLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgIEdhbWUuQmFja2dyb3VuZC5jYW52YXMud2lkdGggPQogICAgICAgICAgICBHYW1lLkJhY2tncm91bmQuY2FudmFzLnBhcmVudE5vZGUub2Zmc2V0V2lkdGg7CiAgICAgICAgICBHYW1lLkJhY2tncm91bmQuY2FudmFzLmhlaWdodCA9CiAgICAgICAgICAgIEdhbWUuQmFja2dyb3VuZC5jYW52YXMucGFyZW50Tm9kZS5vZmZzZXRIZWlnaHQ7CiAgICAgICAgICBHYW1lLkxlZnRCYWNrZ3JvdW5kLmNhbnZhcy53aWR0aCA9CiAgICAgICAgICAgIEdhbWUuTGVmdEJhY2tncm91bmQuY2FudmFzLnBhcmVudE5vZGUub2Zmc2V0V2lkdGg7CiAgICAgICAgICBHYW1lLkxlZnRCYWNrZ3JvdW5kLmNhbnZhcy5oZWlnaHQgPQogICAgICAgICAgICBHYW1lLkxlZnRCYWNrZ3JvdW5kLmNhbnZhcy5wYXJlbnROb2RlLm9mZnNldEhlaWdodDsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgdmFyIGN0eCA9IEdhbWUuTGVmdEJhY2tncm91bmQ7CgogICAgICBpZiAoR2FtZS5PbkFzY2VuZCkgewogICAgICAgIFRpbWVyLmNsZWFuKCk7CiAgICAgICAgLy9zdGFycnkgYmFja2dyb3VuZCBvbiBhc2NlbmQgc2NyZWVuCiAgICAgICAgdmFyIHcgPSBHYW1lLkJhY2tncm91bmQuY2FudmFzLndpZHRoOwogICAgICAgIHZhciBoID0gR2FtZS5CYWNrZ3JvdW5kLmNhbnZhcy5oZWlnaHQ7CiAgICAgICAgdmFyIGIgPSBHYW1lLmFzY2VuZGwuZ2V0Qm91bmRzKCk7CiAgICAgICAgdmFyIHggPSAoYi5sZWZ0ICsgYi5yaWdodCkgLyAyOwogICAgICAgIHZhciB5ID0gKGIudG9wICsgYi5ib3R0b20pIC8gMjsKICAgICAgICBHYW1lLkJhY2tncm91bmQuZ2xvYmFsQWxwaGEgPSAwLjU7CiAgICAgICAgdmFyIHMgPSAxICogR2FtZS5Bc2NlbmRab29tICogKDEgKyBNYXRoLmNvcyhHYW1lLlQgKiAwLjAwMjcpICogMC4wNSk7CiAgICAgICAgR2FtZS5CYWNrZ3JvdW5kLmZpbGxQYXR0ZXJuKAogICAgICAgICAgUGljKCJzdGFyYmcuanBnIiksCiAgICAgICAgICAwLAogICAgICAgICAgMCwKICAgICAgICAgIHcsCiAgICAgICAgICBoLAogICAgICAgICAgMTAyNCAqIHMsCiAgICAgICAgICAxMDI0ICogcywKICAgICAgICAgIHggKyBHYW1lLkFzY2VuZE9mZlggKiAwLjI1ICogcywKICAgICAgICAgIHkgKyBHYW1lLkFzY2VuZE9mZlkgKiAwLjI1ICogcwogICAgICAgICk7CiAgICAgICAgVGltZXIudHJhY2soInN0YXIgbGF5ZXIgMSIpOwogICAgICAgIGlmIChHYW1lLnByZWZzLmZhbmN5KSB7CiAgICAgICAgICAvL2FkZGl0aW9uYWwgc3RhciBsYXllcgogICAgICAgICAgR2FtZS5CYWNrZ3JvdW5kLmdsb2JhbEFscGhhID0KICAgICAgICAgICAgMC41ICogKDAuNSArIE1hdGguc2luKEdhbWUuVCAqIDAuMDIpICogMC4zKTsKICAgICAgICAgIHZhciBzID0gMiAqIEdhbWUuQXNjZW5kWm9vbSAqICgxICsgTWF0aC5zaW4oR2FtZS5UICogMC4wMDIpICogMC4wNyk7CiAgICAgICAgICAvL0dhbWUuQmFja2dyb3VuZC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb249J2xpZ2h0ZXInOwogICAgICAgICAgR2FtZS5CYWNrZ3JvdW5kLmZpbGxQYXR0ZXJuKAogICAgICAgICAgICBQaWMoInN0YXJiZy5qcGciKSwKICAgICAgICAgICAgMCwKICAgICAgICAgICAgMCwKICAgICAgICAgICAgdywKICAgICAgICAgICAgaCwKICAgICAgICAgICAgMTAyNCAqIHMsCiAgICAgICAgICAgIDEwMjQgKiBzLAogICAgICAgICAgICB4ICsgR2FtZS5Bc2NlbmRPZmZYICogMC4yNSAqIHMsCiAgICAgICAgICAgIHkgKyBHYW1lLkFzY2VuZE9mZlkgKiAwLjI1ICogcwogICAgICAgICAgKTsKICAgICAgICAgIC8vR2FtZS5CYWNrZ3JvdW5kLmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbj0nc291cmNlLW92ZXInOwogICAgICAgICAgVGltZXIudHJhY2soInN0YXIgbGF5ZXIgMiIpOwoKICAgICAgICAgIHggPSB4ICsgR2FtZS5Bc2NlbmRPZmZYICogR2FtZS5Bc2NlbmRab29tOwogICAgICAgICAgeSA9IHkgKyBHYW1lLkFzY2VuZE9mZlkgKiBHYW1lLkFzY2VuZFpvb207CiAgICAgICAgICAvL3dpc3B5IG5lYnVsYSBhcm91bmQgdGhlIGNlbnRlcgogICAgICAgICAgR2FtZS5CYWNrZ3JvdW5kLnNhdmUoKTsKICAgICAgICAgIEdhbWUuQmFja2dyb3VuZC5nbG9iYWxBbHBoYSA9IDAuNTsKICAgICAgICAgIEdhbWUuQmFja2dyb3VuZC50cmFuc2xhdGUoeCwgeSk7CiAgICAgICAgICBHYW1lLkJhY2tncm91bmQuZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gImxpZ2h0ZXIiOwogICAgICAgICAgR2FtZS5CYWNrZ3JvdW5kLnJvdGF0ZShHYW1lLlQgKiAwLjAwMSk7CiAgICAgICAgICBzID0gKDYwMCArIDE1MCAqIE1hdGguc2luKEdhbWUuVCAqIDAuMDA3KSkgKiBHYW1lLkFzY2VuZFpvb207CiAgICAgICAgICBHYW1lLkJhY2tncm91bmQuZHJhd0ltYWdlKAogICAgICAgICAgICBQaWMoImhlYXZlblJpbmcxLmpwZyIpLAogICAgICAgICAgICAtcyAvIDIsCiAgICAgICAgICAgIC1zIC8gMiwKICAgICAgICAgICAgcywKICAgICAgICAgICAgcwogICAgICAgICAgKTsKICAgICAgICAgIEdhbWUuQmFja2dyb3VuZC5yb3RhdGUoLUdhbWUuVCAqIDAuMDAxNyk7CiAgICAgICAgICBzID0gKDYwMCArIDE1MCAqIE1hdGguc2luKEdhbWUuVCAqIDAuMDAzNykpICogR2FtZS5Bc2NlbmRab29tOwogICAgICAgICAgR2FtZS5CYWNrZ3JvdW5kLmRyYXdJbWFnZSgKICAgICAgICAgICAgUGljKCJoZWF2ZW5SaW5nMi5qcGciKSwKICAgICAgICAgICAgLXMgLyAyLAogICAgICAgICAgICAtcyAvIDIsCiAgICAgICAgICAgIHMsCiAgICAgICAgICAgIHMKICAgICAgICAgICk7CiAgICAgICAgICBHYW1lLkJhY2tncm91bmQucmVzdG9yZSgpOwogICAgICAgICAgVGltZXIudHJhY2soIm5lYnVsYSIpOwoKICAgICAgICAgIC8vR2FtZS5CYWNrZ3JvdW5kLmRyYXdJbWFnZShQaWMoJ3NoYWRlZEJvcmRlcnMucG5nJyksMCwwLHcsaCk7CiAgICAgICAgICAvL1RpbWVyLnRyYWNrKCdib3JkZXInKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIGdvb2RCdWZmID0gMDsKICAgICAgICB2YXIgYmFkQnVmZiA9IDA7CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLmJ1ZmZzKSB7CiAgICAgICAgICBpZiAoR2FtZS5idWZmc1tpXS5hdXJhID09IDEpIGdvb2RCdWZmID0gMTsKICAgICAgICAgIGlmIChHYW1lLmJ1ZmZzW2ldLmF1cmEgPT0gMikgYmFkQnVmZiA9IDE7CiAgICAgICAgfQoKICAgICAgICBpZiAoR2FtZS5kcmF3VCAlIDUgPT0gMCkgewogICAgICAgICAgaWYgKGZhbHNlICYmIEdhbWUuYmdUeXBlICE9IDAgJiYgR2FtZS5hc2NlbnNpb25Nb2RlICE9IDEpIHsKICAgICAgICAgICAgLy9sKCdiYWNrZ3JvdW5kQ2FudmFzJykuc3R5bGUuYmFja2dyb3VuZD0ndXJsKGltZy9zaGFkZWRCb3JkZXJzU29mdC5wbmcpIDBweCAwcHgsdXJsKGltZy9iZ1doZWF0LmpwZykgNTAlIDUwJSc7CiAgICAgICAgICAgIC8vbCgnYmFja2dyb3VuZENhbnZhcycpLnN0eWxlLmJhY2tncm91bmRTaXplPScxMDAlIDEwMCUsY292ZXInOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbCgiYmFja2dyb3VuZENhbnZhcyIpLnN0eWxlLmJhY2tncm91bmQgPSAidHJhbnNwYXJlbnQiOwogICAgICAgICAgICBHYW1lLmRlZmF1bHRCZyA9ICJiZ0JsdWUiOwogICAgICAgICAgICBHYW1lLmJnUiA9IDA7CgogICAgICAgICAgICBpZiAoR2FtZS5zZWFzb24gPT0gImZvb2xzIikgR2FtZS5kZWZhdWx0QmcgPSAiYmdNb25leSI7CiAgICAgICAgICAgIGlmIChHYW1lLmVsZGVyV3JhdGhEIDwgMSB8fCBHYW1lLnByZWZzLm5vdFNjYXJ5KSB7CiAgICAgICAgICAgICAgR2FtZS5iZ1IgPSAwOwogICAgICAgICAgICAgIEdhbWUuYmcgPSBHYW1lLmRlZmF1bHRCZzsKICAgICAgICAgICAgICBHYW1lLmJnRmFkZSA9IEdhbWUuZGVmYXVsdEJnOwogICAgICAgICAgICB9IGVsc2UgaWYgKEdhbWUuZWxkZXJXcmF0aEQgPj0gMSAmJiBHYW1lLmVsZGVyV3JhdGhEIDwgMikgewogICAgICAgICAgICAgIEdhbWUuYmdSID0gKEdhbWUuZWxkZXJXcmF0aEQgLSAxKSAvIDE7CiAgICAgICAgICAgICAgR2FtZS5iZyA9IEdhbWUuZGVmYXVsdEJnOwogICAgICAgICAgICAgIEdhbWUuYmdGYWRlID0gImdyYW5kbWFzMSI7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoR2FtZS5lbGRlcldyYXRoRCA+PSAyICYmIEdhbWUuZWxkZXJXcmF0aEQgPCAzKSB7CiAgICAgICAgICAgICAgR2FtZS5iZ1IgPSAoR2FtZS5lbGRlcldyYXRoRCAtIDIpIC8gMTsKICAgICAgICAgICAgICBHYW1lLmJnID0gImdyYW5kbWFzMSI7CiAgICAgICAgICAgICAgR2FtZS5iZ0ZhZGUgPSAiZ3JhbmRtYXMyIjsKICAgICAgICAgICAgfSBlbHNlIGlmIChHYW1lLmVsZGVyV3JhdGhEID49IDMpIHsKICAgICAgICAgICAgICAvLyAmJiBHYW1lLmVsZGVyV3JhdGhEPDQpCiAgICAgICAgICAgICAgR2FtZS5iZ1IgPSAoR2FtZS5lbGRlcldyYXRoRCAtIDMpIC8gMTsKICAgICAgICAgICAgICBHYW1lLmJnID0gImdyYW5kbWFzMiI7CiAgICAgICAgICAgICAgR2FtZS5iZ0ZhZGUgPSAiZ3JhbmRtYXMzIjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKEdhbWUuYmdUeXBlICE9IDAgJiYgR2FtZS5hc2NlbnNpb25Nb2RlICE9IDEpIHsKICAgICAgICAgICAgICBHYW1lLmJnUiA9IDA7CiAgICAgICAgICAgICAgR2FtZS5iZyA9IEdhbWUuQkdzQnlDaG9pY2VbR2FtZS5iZ1R5cGVdLnBpYzsKICAgICAgICAgICAgICBHYW1lLmJnRmFkZSA9IEdhbWUuYmc7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEdhbWUuQmFja2dyb3VuZC5maWxsUGF0dGVybigKICAgICAgICAgICAgICBQaWMoR2FtZS5iZyArICIuanBnIiksCiAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgIEdhbWUuQmFja2dyb3VuZC5jYW52YXMud2lkdGgsCiAgICAgICAgICAgICAgR2FtZS5CYWNrZ3JvdW5kLmNhbnZhcy5oZWlnaHQsCiAgICAgICAgICAgICAgNTEyLAogICAgICAgICAgICAgIDUxMiwKICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgIDAKICAgICAgICAgICAgKTsKICAgICAgICAgICAgaWYgKEdhbWUuYmdSID4gMCkgewogICAgICAgICAgICAgIEdhbWUuQmFja2dyb3VuZC5nbG9iYWxBbHBoYSA9IEdhbWUuYmdSOwogICAgICAgICAgICAgIEdhbWUuQmFja2dyb3VuZC5maWxsUGF0dGVybigKICAgICAgICAgICAgICAgIFBpYyhHYW1lLmJnRmFkZSArICIuanBnIiksCiAgICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgIEdhbWUuQmFja2dyb3VuZC5jYW52YXMud2lkdGgsCiAgICAgICAgICAgICAgICBHYW1lLkJhY2tncm91bmQuY2FudmFzLmhlaWdodCwKICAgICAgICAgICAgICAgIDUxMiwKICAgICAgICAgICAgICAgIDUxMiwKICAgICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgICAwCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBHYW1lLkJhY2tncm91bmQuZ2xvYmFsQWxwaGEgPSAxOwogICAgICAgICAgICBHYW1lLkJhY2tncm91bmQuZHJhd0ltYWdlKAogICAgICAgICAgICAgIFBpYygic2hhZGVkQm9yZGVyc1NvZnQucG5nIiksCiAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgIEdhbWUuQmFja2dyb3VuZC5jYW52YXMud2lkdGgsCiAgICAgICAgICAgICAgR2FtZS5CYWNrZ3JvdW5kLmNhbnZhcy5oZWlnaHQKICAgICAgICAgICAgKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgVGltZXIudHJhY2soIndpbmRvdyBiYWNrZ3JvdW5kIik7CgogICAgICAgIC8vY2xlYXIKICAgICAgICBjdHguY2xlYXJSZWN0KDAsIDAsIGN0eC5jYW52YXMud2lkdGgsIGN0eC5jYW52YXMuaGVpZ2h0KTsKICAgICAgICAvKmlmIChHYW1lLkFzY2VuZFRpbWVyPEdhbWUuQXNjZW5kQnJlYWtwb2ludCkgY3R4LmNsZWFyUmVjdCgwLDAsY3R4LmNhbnZhcy53aWR0aCxjdHguY2FudmFzLmhlaWdodCk7CgkJCQllbHNlCgkJCQl7CgkJCQkJY3R4Lmdsb2JhbEFscGhhPTAuMDU7CgkJCQkJY3R4LmZpbGxTdHlsZT0nIzAwMCc7CgkJCQkJY3R4LmZpbGxSZWN0KDAsMCxjdHguY2FudmFzLndpZHRoLGN0eC5jYW52YXMuaGVpZ2h0KTsKCQkJCQljdHguZ2xvYmFsQWxwaGE9MTsKCQkJCQlPbGRDYW52YXNEcmF3SW1hZ2UuYXBwbHkoY3R4LFtjdHguY2FudmFzLE1hdGgucmFuZG9tKCkqNC0yLE1hdGgucmFuZG9tKCkqNC0yLTRdKTsKCQkJCQljdHguZ2xvYmFsQWxwaGE9MTsKCQkJCX0qLwogICAgICAgIFRpbWVyLmNsZWFuKCk7CgogICAgICAgIHZhciBzaG93RHJhZ29uID0gMDsKICAgICAgICBpZiAoR2FtZS5oYXNCdWZmKCJEcmFnb25mbGlnaHQiKSB8fCBHYW1lLmhhc0J1ZmYoIkRyYWdvbiBIYXJ2ZXN0IikpCiAgICAgICAgICBzaG93RHJhZ29uID0gMTsKCiAgICAgICAgR2FtZS5jb29raWVPcmlnaW5YID0gTWF0aC5mbG9vcihjdHguY2FudmFzLndpZHRoIC8gMik7CiAgICAgICAgR2FtZS5jb29raWVPcmlnaW5ZID0gTWF0aC5mbG9vcihjdHguY2FudmFzLmhlaWdodCAqIDAuNCk7CgogICAgICAgIGlmIChHYW1lLkFzY2VuZFRpbWVyID09IDApIHsKICAgICAgICAgIGlmIChHYW1lLnByZWZzLnBhcnRpY2xlcykgewogICAgICAgICAgICAvL2ZhbGxpbmcgY29va2llcwogICAgICAgICAgICB2YXIgcGljID0gIiI7CiAgICAgICAgICAgIHZhciBvcGFjaXR5ID0gMTsKICAgICAgICAgICAgaWYgKEdhbWUuZWxkZXJXcmF0aEQgPD0gMS41IHx8IEdhbWUucHJlZnMubm90U2NhcnkpIHsKICAgICAgICAgICAgICBpZiAoR2FtZS5jb29raWVzUHMgPj0gMTAwMCkgcGljID0gImNvb2tpZVNob3dlcjMucG5nIjsKICAgICAgICAgICAgICBlbHNlIGlmIChHYW1lLmNvb2tpZXNQcyA+PSA1MDApIHBpYyA9ICJjb29raWVTaG93ZXIyLnBuZyI7CiAgICAgICAgICAgICAgZWxzZSBpZiAoR2FtZS5jb29raWVzUHMgPj0gNTApIHBpYyA9ICJjb29raWVTaG93ZXIxLnBuZyI7CiAgICAgICAgICAgICAgZWxzZSBwaWMgPSAiIjsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocGljICE9ICIiKSB7CiAgICAgICAgICAgICAgaWYgKEdhbWUuZWxkZXJXcmF0aEQgPj0gMSAmJiAhR2FtZS5wcmVmcy5ub3RTY2FyeSkKICAgICAgICAgICAgICAgIG9wYWNpdHkgPSAxIC0gKE1hdGgubWluKEdhbWUuZWxkZXJXcmF0aEQsIDEuNSkgLSAxKSAvIDAuNTsKICAgICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSBvcGFjaXR5OwogICAgICAgICAgICAgIHZhciB5ID0gTWF0aC5mbG9vcihHYW1lLlQgKiAyKSAlIDUxMjsKICAgICAgICAgICAgICBjdHguZmlsbFBhdHRlcm4oCiAgICAgICAgICAgICAgICBQaWMocGljKSwKICAgICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgICAgY3R4LmNhbnZhcy53aWR0aCwKICAgICAgICAgICAgICAgIGN0eC5jYW52YXMuaGVpZ2h0ICsgNTEyLAogICAgICAgICAgICAgICAgNTEyLAogICAgICAgICAgICAgICAgNTEyLAogICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgIHkKICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy9zbm93CiAgICAgICAgICAgIGlmIChHYW1lLnNlYXNvbiA9PSAiY2hyaXN0bWFzIikgewogICAgICAgICAgICAgIHZhciB5ID0gTWF0aC5mbG9vcihHYW1lLlQgKiAyLjUpICUgNTEyOwogICAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDAuNzU7CiAgICAgICAgICAgICAgY3R4Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9ICJsaWdodGVyIjsKICAgICAgICAgICAgICBjdHguZmlsbFBhdHRlcm4oCiAgICAgICAgICAgICAgICBQaWMoInNub3cyLmpwZyIpLAogICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgICBjdHguY2FudmFzLndpZHRoLAogICAgICAgICAgICAgICAgY3R4LmNhbnZhcy5oZWlnaHQgKyA1MTIsCiAgICAgICAgICAgICAgICA1MTIsCiAgICAgICAgICAgICAgICA1MTIsCiAgICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgICAgeQogICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgY3R4Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9ICJzb3VyY2Utb3ZlciI7CiAgICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvL2hlYXJ0cwogICAgICAgICAgICBpZiAoR2FtZS5zZWFzb24gPT0gInZhbGVudGluZXMiKSB7CiAgICAgICAgICAgICAgdmFyIHkgPSBNYXRoLmZsb29yKEdhbWUuVCAqIDIuNSkgJSA1MTI7CiAgICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMTsKICAgICAgICAgICAgICBjdHguZmlsbFBhdHRlcm4oCiAgICAgICAgICAgICAgICBQaWMoImhlYXJ0U3Rvcm0ucG5nIiksCiAgICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgIGN0eC5jYW52YXMud2lkdGgsCiAgICAgICAgICAgICAgICBjdHguY2FudmFzLmhlaWdodCArIDUxMiwKICAgICAgICAgICAgICAgIDUxMiwKICAgICAgICAgICAgICAgIDUxMiwKICAgICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgICB5CiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIFRpbWVyLnRyYWNrKCJsZWZ0IGJhY2tncm91bmQiKTsKCiAgICAgICAgICAgIEdhbWUucGFydGljbGVzRHJhdygwKTsKICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMTsKICAgICAgICAgICAgVGltZXIudHJhY2soInBhcnRpY2xlcyIpOwoKICAgICAgICAgICAgLy9iaWcgY29va2llIHNoaW5lCiAgICAgICAgICAgIHZhciBzID0gNTEyOwoKICAgICAgICAgICAgdmFyIHggPSBHYW1lLmNvb2tpZU9yaWdpblg7CiAgICAgICAgICAgIHZhciB5ID0gR2FtZS5jb29raWVPcmlnaW5ZOwoKICAgICAgICAgICAgdmFyIHIgPSBNYXRoLmZsb29yKChHYW1lLlQgKiAwLjUpICUgMzYwKTsKICAgICAgICAgICAgY3R4LnNhdmUoKTsKICAgICAgICAgICAgY3R4LnRyYW5zbGF0ZSh4LCB5KTsKICAgICAgICAgICAgY3R4LnJvdGF0ZSgociAvIDM2MCkgKiBNYXRoLlBJICogMik7CiAgICAgICAgICAgIHZhciBhbHBoYU11bHQgPSAxOwogICAgICAgICAgICBpZiAoR2FtZS5iZ1R5cGUgPT0gMiB8fCBHYW1lLmJnVHlwZSA9PSA0KSBhbHBoYU11bHQgPSAwLjU7CiAgICAgICAgICAgIHZhciBwaWMgPSAic2hpbmUucG5nIjsKICAgICAgICAgICAgaWYgKGdvb2RCdWZmKSB7CiAgICAgICAgICAgICAgcGljID0gInNoaW5lR29sZC5wbmciOwogICAgICAgICAgICAgIGFscGhhTXVsdCA9IDE7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoYmFkQnVmZikgewogICAgICAgICAgICAgIHBpYyA9ICJzaGluZVJlZC5wbmciOwogICAgICAgICAgICAgIGFscGhhTXVsdCA9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGdvb2RCdWZmICYmIEdhbWUucHJlZnMuZmFuY3kpCiAgICAgICAgICAgICAgY3R4Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9ICJsaWdodGVyIjsKICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMC41ICogYWxwaGFNdWx0OwogICAgICAgICAgICBjdHguZHJhd0ltYWdlKFBpYyhwaWMpLCAtcyAvIDIsIC1zIC8gMiwgcywgcyk7CiAgICAgICAgICAgIGN0eC5yb3RhdGUoKCgtciAqIDIpIC8gMzYwKSAqIE1hdGguUEkgKiAyKTsKICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMC4yNSAqIGFscGhhTXVsdDsKICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShQaWMocGljKSwgLXMgLyAyLCAtcyAvIDIsIHMsIHMpOwogICAgICAgICAgICBjdHgucmVzdG9yZSgpOwogICAgICAgICAgICBUaW1lci50cmFjaygic2hpbmUiKTsKCiAgICAgICAgICAgIGlmIChHYW1lLlJlaW5jYXJuYXRlVGltZXIgPiAwKSB7CiAgICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0KICAgICAgICAgICAgICAgIDEgLSBHYW1lLlJlaW5jYXJuYXRlVGltZXIgLyBHYW1lLlJlaW5jYXJuYXRlRHVyYXRpb247CiAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9ICIjMDAwIjsKICAgICAgICAgICAgICBjdHguZmlsbFJlY3QoMCwgMCwgY3R4LmNhbnZhcy53aWR0aCwgY3R4LmNhbnZhcy5oZWlnaHQpOwogICAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDE7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChzaG93RHJhZ29uKSB7CiAgICAgICAgICAgICAgLy9iaWcgZHJhZ29uCiAgICAgICAgICAgICAgdmFyIHMgPSAzMDAgKiAyICogKDEgKyBNYXRoLnNpbihHYW1lLlQgKiAwLjAxMykgKiAwLjEpOwogICAgICAgICAgICAgIHZhciB4ID0gR2FtZS5jb29raWVPcmlnaW5YIC0gcyAvIDI7CiAgICAgICAgICAgICAgdmFyIHkgPQogICAgICAgICAgICAgICAgR2FtZS5jb29raWVPcmlnaW5ZIC0gcyAvICgxLjQgKyAwLjIgKiBNYXRoLnNpbihHYW1lLlQgKiAwLjAxKSk7CiAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShQaWMoImRyYWdvbkJHLnBuZyIpLCB4LCB5LCBzLCBzKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy9iaWcgY29va2llCiAgICAgICAgICAgIGlmIChmYWxzZSkgewogICAgICAgICAgICAgIC8vZG9uJ3QgZG8gdGhhdAogICAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDE7CiAgICAgICAgICAgICAgdmFyIGFtb3VudCA9IE1hdGguZmxvb3IoR2FtZS5jb29raWVzKS50b1N0cmluZygpOwogICAgICAgICAgICAgIHZhciBkaWdpdHMgPSBhbW91bnQubGVuZ3RoOwogICAgICAgICAgICAgIHZhciBzcGFjZSA9IDA7CiAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkaWdpdHM7IGkrKykgewogICAgICAgICAgICAgICAgdmFyIHMgPSAxNiAqIChkaWdpdHMgLSBpKTsKICAgICAgICAgICAgICAgIHZhciBudW0gPSBwYXJzZUludChhbW91bnRbaV0pOwogICAgICAgICAgICAgICAgaWYgKGkgPiAwKSBzcGFjZSAtPSAocyAqICgxIC0gbnVtIC8gMTApKSAvIDI7CiAgICAgICAgICAgICAgICBpZiAoaSA9PSAwICYmIG51bSA+IDEpIHNwYWNlICs9IHMgKiAwLjE7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBpaSA9IDA7IGlpIDwgbnVtOyBpaSsrKSB7CiAgICAgICAgICAgICAgICAgIHZhciB4ID0gR2FtZS5jb29raWVPcmlnaW5YOwogICAgICAgICAgICAgICAgICB2YXIgeSA9IEdhbWUuY29va2llT3JpZ2luWTsKICAgICAgICAgICAgICAgICAgdmFyIHNwaW4gPQogICAgICAgICAgICAgICAgICAgIEdhbWUuVCAqICgwLjAwNSArIGkgKiAwLjAwMSkgKyBpICsgKGlpIC8gbnVtKSAqIE1hdGguUEkgKiAyOwogICAgICAgICAgICAgICAgICB4ICs9IE1hdGguc2luKHNwaW4pICogc3BhY2U7CiAgICAgICAgICAgICAgICAgIHkgKz0gTWF0aC5jb3Moc3BpbikgKiBzcGFjZTsKICAgICAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZSgKICAgICAgICAgICAgICAgICAgICBQaWMoInBlcmZlY3RDb29raWUucG5nIiksCiAgICAgICAgICAgICAgICAgICAgeCAtIHMgLyAyLAogICAgICAgICAgICAgICAgICAgIHkgLSBzIC8gMiwKICAgICAgICAgICAgICAgICAgICBzLAogICAgICAgICAgICAgICAgICAgIHMKICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHNwYWNlICs9IHMgLyAyOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAxOwogICAgICAgICAgICAgIHZhciBzID0gMjU2ICogR2FtZS5CaWdDb29raWVTaXplOwogICAgICAgICAgICAgIHZhciB4ID0gR2FtZS5jb29raWVPcmlnaW5YOwogICAgICAgICAgICAgIHZhciB5ID0gR2FtZS5jb29raWVPcmlnaW5ZOwogICAgICAgICAgICAgIGN0eC5zYXZlKCk7CiAgICAgICAgICAgICAgaWYgKEdhbWUucHJlZnMuZmFuY3kpCiAgICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKAogICAgICAgICAgICAgICAgICBQaWMoImNvb2tpZVNoYWRvdy5wbmciKSwKICAgICAgICAgICAgICAgICAgeCAtIHMgLyAyLAogICAgICAgICAgICAgICAgICB5IC0gcyAvIDIgKyAyMCwKICAgICAgICAgICAgICAgICAgcywKICAgICAgICAgICAgICAgICAgcwogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICBjdHgudHJhbnNsYXRlKHgsIHkpOwogICAgICAgICAgICAgIGlmIChHYW1lLnNlYXNvbiA9PSAiZWFzdGVyIikgewogICAgICAgICAgICAgICAgdmFyIG5lc3RXID0gMzA0ICogMC45OCAqIEdhbWUuQmlnQ29va2llU2l6ZTsKICAgICAgICAgICAgICAgIHZhciBuZXN0SCA9IDE2MSAqIDAuOTggKiBHYW1lLkJpZ0Nvb2tpZVNpemU7CiAgICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKAogICAgICAgICAgICAgICAgICBQaWMoIm5lc3QucG5nIiksCiAgICAgICAgICAgICAgICAgIC1uZXN0VyAvIDIsCiAgICAgICAgICAgICAgICAgIC1uZXN0SCAvIDIgKyAxMzAsCiAgICAgICAgICAgICAgICAgIG5lc3RXLAogICAgICAgICAgICAgICAgICBuZXN0SAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgLy9jdHgucm90YXRlKCgoR2FtZS5zdGFydERhdGUlMzYwKS8zNjApKk1hdGguUEkqMik7CiAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShQaWMoInBlcmZlY3RDb29raWUucG5nIiksIC1zIC8gMiwgLXMgLyAyLCBzLCBzKTsKCiAgICAgICAgICAgICAgaWYgKGdvb2RCdWZmICYmIEdhbWUucHJlZnMucGFydGljbGVzKSB7CiAgICAgICAgICAgICAgICAvL3NwYXJrbGUKICAgICAgICAgICAgICAgIGN0eC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb24gPSAibGlnaHRlciI7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDE7IGkrKykgewogICAgICAgICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSBNYXRoLnJhbmRvbSgpICogMC42NSArIDAuMTsKICAgICAgICAgICAgICAgICAgdmFyIHNpemUgPSBNYXRoLnJhbmRvbSgpICogMzAgKyA1OwogICAgICAgICAgICAgICAgICB2YXIgYSA9IE1hdGgucmFuZG9tKCkgKiBNYXRoLlBJICogMjsKICAgICAgICAgICAgICAgICAgdmFyIGQgPSAocyAqIDAuOSAqIE1hdGgucmFuZG9tKCkpIC8gMjsKICAgICAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZSgKICAgICAgICAgICAgICAgICAgICBQaWMoImdsaW50LmpwZyIpLAogICAgICAgICAgICAgICAgICAgIC1zaXplIC8gMiArIE1hdGguc2luKGEpICogZCwKICAgICAgICAgICAgICAgICAgICAtc2l6ZSAvIDIgKyBNYXRoLmNvcyhhKSAqIGQsCiAgICAgICAgICAgICAgICAgICAgc2l6ZSwKICAgICAgICAgICAgICAgICAgICBzaXplCiAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjdHgucmVzdG9yZSgpOwogICAgICAgICAgICAgIFRpbWVyLnRyYWNrKCJiaWcgY29va2llIik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gLy9ubyBwYXJ0aWNsZXMKICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAvL2JpZyBjb29raWUgc2hpbmUKICAgICAgICAgICAgdmFyIHMgPSA1MTI7CiAgICAgICAgICAgIHZhciB4ID0gR2FtZS5jb29raWVPcmlnaW5YIC0gcyAvIDI7CiAgICAgICAgICAgIHZhciB5ID0gR2FtZS5jb29raWVPcmlnaW5ZIC0gcyAvIDI7CiAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDAuNTsKICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShQaWMoInNoaW5lLnBuZyIpLCB4LCB5LCBzLCBzKTsKCiAgICAgICAgICAgIGlmIChzaG93RHJhZ29uKSB7CiAgICAgICAgICAgICAgLy9iaWcgZHJhZ29uCiAgICAgICAgICAgICAgdmFyIHMgPSAzMDAgKiAyICogKDEgKyBNYXRoLnNpbihHYW1lLlQgKiAwLjAxMykgKiAwLjEpOwogICAgICAgICAgICAgIHZhciB4ID0gR2FtZS5jb29raWVPcmlnaW5YIC0gcyAvIDI7CiAgICAgICAgICAgICAgdmFyIHkgPQogICAgICAgICAgICAgICAgR2FtZS5jb29raWVPcmlnaW5ZIC0gcyAvICgxLjQgKyAwLjIgKiBNYXRoLnNpbihHYW1lLlQgKiAwLjAxKSk7CiAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShQaWMoImRyYWdvbkJHLnBuZyIpLCB4LCB5LCBzLCBzKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy9iaWcgY29va2llCiAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDE7CiAgICAgICAgICAgIHZhciBzID0gMjU2ICogR2FtZS5CaWdDb29raWVTaXplOwogICAgICAgICAgICB2YXIgeCA9IEdhbWUuY29va2llT3JpZ2luWCAtIHMgLyAyOwogICAgICAgICAgICB2YXIgeSA9IEdhbWUuY29va2llT3JpZ2luWSAtIHMgLyAyOwogICAgICAgICAgICBpZiAoR2FtZS5wcmVmcy5mYW5jeSkKICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKFBpYygiY29va2llU2hhZG93LnBuZyIpLCB4LCB5ICsgMjAsIHMsIHMpOwogICAgICAgICAgICBjdHguZHJhd0ltYWdlKFBpYygicGVyZmVjdENvb2tpZS5wbmciKSwgeCwgeSwgcywgcyk7CiAgICAgICAgICB9CgogICAgICAgICAgLy9jdXJzb3JzCiAgICAgICAgICBpZiAoR2FtZS5wcmVmcy5jdXJzb3JzKSB7CiAgICAgICAgICAgIGN0eC5zYXZlKCk7CiAgICAgICAgICAgIGN0eC50cmFuc2xhdGUoR2FtZS5jb29raWVPcmlnaW5YLCBHYW1lLmNvb2tpZU9yaWdpblkpOwogICAgICAgICAgICB2YXIgcGljID0gUGljKCJjdXJzb3IucG5nIik7CiAgICAgICAgICAgIHZhciBmYW5jeSA9IEdhbWUucHJlZnMuZmFuY3k7CgogICAgICAgICAgICBpZiAoc2hvd0RyYWdvbikgY3R4Lmdsb2JhbEFscGhhID0gMC4yNTsKICAgICAgICAgICAgdmFyIGFtb3VudCA9IEdhbWUuT2JqZWN0c1siQ3Vyc29yIl0uYW1vdW50OwogICAgICAgICAgICAvL3ZhciBzcGU9LTE7CiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYW1vdW50OyBpKyspIHsKICAgICAgICAgICAgICB2YXIgbiA9IE1hdGguZmxvb3IoaSAvIDUwKTsKICAgICAgICAgICAgICAvL3ZhciBhPSgoaSswLjUqbiklNTApLzUwOwogICAgICAgICAgICAgIHZhciB3ID0gMDsKICAgICAgICAgICAgICBpZiAoZmFuY3kpCiAgICAgICAgICAgICAgICB3ID0gTWF0aC5zaW4oCiAgICAgICAgICAgICAgICAgIEdhbWUuVCAqIDAuMDI1ICsgKCgoaSArIG4gKiAxMikgJSAyNSkgLyAyNSkgKiBNYXRoLlBJICogMgogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICBpZiAodyA+IDAuOTk3KSB3ID0gMS41OwogICAgICAgICAgICAgIGVsc2UgaWYgKHcgPiAwLjk5NCkgdyA9IDAuNTsKICAgICAgICAgICAgICBlbHNlIHcgPSAwOwogICAgICAgICAgICAgIHcgKj0gLTQ7CiAgICAgICAgICAgICAgaWYgKGZhbmN5KSB3ICs9IE1hdGguc2luKCgobiArIEdhbWUuVCAqIDAuMDEpICogTWF0aC5QSSkgLyAyKSAqIDQ7CiAgICAgICAgICAgICAgdmFyIHggPSAwOwogICAgICAgICAgICAgIHZhciB5ID0gMTQwIC8qICpHYW1lLkJpZ0Nvb2tpZVNpemUqLyArIG4gKiAxNiArIHcgLSAxNjsKCiAgICAgICAgICAgICAgdmFyIHJvdCA9IDcuMjsgLy8oMS81MCkqMzYwCiAgICAgICAgICAgICAgaWYgKGkgPT0gMCAmJiBmYW5jeSkgcm90IC09IEdhbWUuVCAqIDAuMTsKICAgICAgICAgICAgICBpZiAoaSAlIDUwID09IDApIHJvdCArPSA3LjIgLyAyOwogICAgICAgICAgICAgIGN0eC5yb3RhdGUoKHJvdCAvIDM2MCkgKiBNYXRoLlBJICogMik7CiAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShwaWMsIDAsIDAsIDMyLCAzMiwgeCwgeSwgMzIsIDMyKTsKICAgICAgICAgICAgICAvL2N0eC5kcmF3SW1hZ2UocGljLDMyKihpPT1zcGUpLDAsMzIsMzIseCx5LDMyLDMyKTsKCiAgICAgICAgICAgICAgLyppZiAoaT09c3BlKQoJCQkJCQkJewoJCQkJCQkJCXkrPTE2OwoJCQkJCQkJCXg9R2FtZS5jb29raWVPcmlnaW5YK01hdGguc2luKC0oKHItNSkvMzYwKSpNYXRoLlBJKjIpKnk7CgkJCQkJCQkJeT1HYW1lLmNvb2tpZU9yaWdpblkrTWF0aC5jb3MoLSgoci01KS8zNjApKk1hdGguUEkqMikqeTsKCQkJCQkJCQlpZiAoR2FtZS5DYW5DbGljayAmJiBjdHggJiYgTWF0aC5hYnMoR2FtZS5tb3VzZVgteCk8MTYgJiYgTWF0aC5hYnMoR2FtZS5tb3VzZVkteSk8MTYpIEdhbWUubW91c2VQb2ludGVyPTE7CgkJCQkJCQl9Ki8KICAgICAgICAgICAgfQogICAgICAgICAgICBjdHgucmVzdG9yZSgpOwogICAgICAgICAgICBUaW1lci50cmFjaygiY3Vyc29ycyIpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB2YXIgdEJhc2UgPSBNYXRoLm1heCgKICAgICAgICAgICAgMCwKICAgICAgICAgICAgKEdhbWUuQXNjZW5kVGltZXIgLSBHYW1lLkFzY2VuZEJyZWFrcG9pbnQpIC8KICAgICAgICAgICAgICAoR2FtZS5Bc2NlbmREdXJhdGlvbiAtIEdhbWUuQXNjZW5kQnJlYWtwb2ludCkKICAgICAgICAgICk7CiAgICAgICAgICAvL2JpZyBjcnVtYmxpbmcgY29va2llCiAgICAgICAgICAvL3ZhciB0PSgzKk1hdGgucG93KHRCYXNlLDIpLTIqTWF0aC5wb3codEJhc2UsMykpOy8vUyBjdXJ2ZQogICAgICAgICAgdmFyIHQgPSBNYXRoLnBvdyh0QmFzZSwgMC41KTsKCiAgICAgICAgICB2YXIgc2hha2UgPSAwOwogICAgICAgICAgaWYgKEdhbWUuQXNjZW5kVGltZXIgPCBHYW1lLkFzY2VuZEJyZWFrcG9pbnQpIHsKICAgICAgICAgICAgc2hha2UgPSBHYW1lLkFzY2VuZFRpbWVyIC8gR2FtZS5Bc2NlbmRCcmVha3BvaW50OwogICAgICAgICAgfQogICAgICAgICAgLy9lbHNlIHtzaGFrZT0xLXQ7fQoKICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDE7CgogICAgICAgICAgdmFyIHggPSBHYW1lLmNvb2tpZU9yaWdpblg7CiAgICAgICAgICB2YXIgeSA9IEdhbWUuY29va2llT3JpZ2luWTsKCiAgICAgICAgICB4ICs9IChNYXRoLnJhbmRvbSgpICogMiAtIDEpICogMTAgKiBzaGFrZTsKICAgICAgICAgIHkgKz0gKE1hdGgucmFuZG9tKCkgKiAyIC0gMSkgKiAxMCAqIHNoYWtlOwoKICAgICAgICAgIHZhciBzID0gMTsKICAgICAgICAgIGlmICh0QmFzZSA+IDApIHsKICAgICAgICAgICAgY3R4LnNhdmUoKTsKICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMSAtIE1hdGgucG93KHQsIDAuNSk7CiAgICAgICAgICAgIGN0eC50cmFuc2xhdGUoeCwgeSk7CiAgICAgICAgICAgIGN0eC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb24gPSAibGlnaHRlciI7CiAgICAgICAgICAgIGN0eC5yb3RhdGUoR2FtZS5UICogMC4wMDcpOwogICAgICAgICAgICBzID0gMC41ICsgTWF0aC5wb3codEJhc2UsIDAuNikgKiAxOwogICAgICAgICAgICB2YXIgczIgPSA2MDAgKiBzOwogICAgICAgICAgICBjdHguZHJhd0ltYWdlKFBpYygiaGVhdmVuUmluZzEuanBnIiksIC1zMiAvIDIsIC1zMiAvIDIsIHMyLCBzMik7CiAgICAgICAgICAgIGN0eC5yb3RhdGUoLUdhbWUuVCAqIDAuMDAyKTsKICAgICAgICAgICAgcyA9IDAuNSArIE1hdGgucG93KDEgLSB0QmFzZSwgMC40KSAqIDE7CiAgICAgICAgICAgIHMyID0gNjAwICogczsKICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShQaWMoImhlYXZlblJpbmcyLmpwZyIpLCAtczIgLyAyLCAtczIgLyAyLCBzMiwgczIpOwogICAgICAgICAgICBjdHgucmVzdG9yZSgpOwogICAgICAgICAgfQoKICAgICAgICAgIHMgPSAyNTY7IC8vKkdhbWUuQmlnQ29va2llU2l6ZTsKCiAgICAgICAgICBjdHguc2F2ZSgpOwogICAgICAgICAgY3R4LnRyYW5zbGF0ZSh4LCB5KTsKICAgICAgICAgIGN0eC5yb3RhdGUodCAqIC0wLjEgKiBNYXRoLlBJICogMik7CgogICAgICAgICAgdmFyIGNodW5rcyA9IHsKICAgICAgICAgICAgMDogNywKICAgICAgICAgICAgMTogNiwKICAgICAgICAgICAgMjogMywKICAgICAgICAgICAgMzogMiwKICAgICAgICAgICAgNDogOCwKICAgICAgICAgICAgNTogMSwKICAgICAgICAgICAgNjogOSwKICAgICAgICAgICAgNzogNSwKICAgICAgICAgICAgODogMCwKICAgICAgICAgICAgOTogNCwKICAgICAgICAgIH07CiAgICAgICAgICBzICo9IHQgLyAyICsgMTsKICAgICAgICAgIC8qY3R4Lmdsb2JhbEFscGhhPSgxLXQpKjAuMzM7CgkJCQkJZm9yICh2YXIgaT0wO2k8MTA7aSsrKQoJCQkJCXsKCQkJCQkJdmFyIGQ9KHQtMC4yKSooODArKChpKzIpJTMpKjQwKTsKCQkJCQkJY3R4LmRyYXdJbWFnZShQaWMoJ2Jyb2tlbkNvb2tpZS5wbmcnKSwyNTYqKGNodW5rc1tpXSksMCwyNTYsMjU2LC1zLzIrTWF0aC5zaW4oLSgoKGNodW5rc1tpXSs0KSUxMCkvMTApKk1hdGguUEkqMikqZCwtcy8yK01hdGguY29zKC0oKChjaHVua3NbaV0rNCklMTApLzEwKSpNYXRoLlBJKjIpKmQscyxzKTsKCQkJCQl9CgkJCQkJY3R4Lmdsb2JhbEFscGhhPSgxLXQpKjAuNjY7CgkJCQkJZm9yICh2YXIgaT0wO2k8MTA7aSsrKQoJCQkJCXsKCQkJCQkJdmFyIGQ9KHQtMC4xKSooODArKChpKzIpJTMpKjQwKTsKCQkJCQkJY3R4LmRyYXdJbWFnZShQaWMoJ2Jyb2tlbkNvb2tpZS5wbmcnKSwyNTYqKGNodW5rc1tpXSksMCwyNTYsMjU2LC1zLzIrTWF0aC5zaW4oLSgoKGNodW5rc1tpXSs0KSUxMCkvMTApKk1hdGguUEkqMikqZCwtcy8yK01hdGguY29zKC0oKChjaHVua3NbaV0rNCklMTApLzEwKSpNYXRoLlBJKjIpKmQscyxzKTsKCQkJCQl9Ki8KICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDEgLSB0OwogICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxMDsgaSsrKSB7CiAgICAgICAgICAgIHZhciBkID0gdCAqICg4MCArICgoaSArIDIpICUgMykgKiA0MCk7CiAgICAgICAgICAgIHZhciB4MiA9IChNYXRoLnJhbmRvbSgpICogMiAtIDEpICogNSAqIHNoYWtlOwogICAgICAgICAgICB2YXIgeTIgPSAoTWF0aC5yYW5kb20oKSAqIDIgLSAxKSAqIDUgKiBzaGFrZTsKICAgICAgICAgICAgY3R4LmRyYXdJbWFnZSgKICAgICAgICAgICAgICBQaWMoImJyb2tlbkNvb2tpZS5wbmciKSwKICAgICAgICAgICAgICAyNTYgKiBjaHVua3NbaV0sCiAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAyNTYsCiAgICAgICAgICAgICAgMjU2LAogICAgICAgICAgICAgIC1zIC8gMiArCiAgICAgICAgICAgICAgICBNYXRoLnNpbigtKCgoY2h1bmtzW2ldICsgNCkgJSAxMCkgLyAxMCkgKiBNYXRoLlBJICogMikgKiBkICsKICAgICAgICAgICAgICAgIHgyLAogICAgICAgICAgICAgIC1zIC8gMiArCiAgICAgICAgICAgICAgICBNYXRoLmNvcygtKCgoY2h1bmtzW2ldICsgNCkgJSAxMCkgLyAxMCkgKiBNYXRoLlBJICogMikgKiBkICsKICAgICAgICAgICAgICAgIHkyLAogICAgICAgICAgICAgIHMsCiAgICAgICAgICAgICAgcwogICAgICAgICAgICApOwogICAgICAgICAgfQogICAgICAgICAgdmFyIGJyb2tlbkhhbG8gPSAxIC0gTWF0aC5taW4odCAvICgxIC8gMyksIDEgLyAzKSAqIDM7CiAgICAgICAgICBpZiAoR2FtZS5Bc2NlbmRUaW1lciA8IEdhbWUuQXNjZW5kQnJlYWtwb2ludCkKICAgICAgICAgICAgYnJva2VuSGFsbyA9IEdhbWUuQXNjZW5kVGltZXIgLyBHYW1lLkFzY2VuZEJyZWFrcG9pbnQ7CiAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSBicm9rZW5IYWxvOwogICAgICAgICAgY3R4LmRyYXdJbWFnZSgKICAgICAgICAgICAgUGljKCJicm9rZW5Db29raWVIYWxvLnBuZyIpLAogICAgICAgICAgICAtcyAvIDEuMzMzMywKICAgICAgICAgICAgLXMgLyAxLjMzMzMsCiAgICAgICAgICAgIHMgKiAxLjUsCiAgICAgICAgICAgIHMgKiAxLjUKICAgICAgICAgICk7CgogICAgICAgICAgY3R4LnJlc3RvcmUoKTsKCiAgICAgICAgICAvL2ZsYXJlcwogICAgICAgICAgdmFyIG4gPSA5OwogICAgICAgICAgdmFyIHQgPSBHYW1lLkFzY2VuZFRpbWVyIC8gR2FtZS5Bc2NlbmRCcmVha3BvaW50OwogICAgICAgICAgaWYgKEdhbWUuQXNjZW5kVGltZXIgPCBHYW1lLkFzY2VuZEJyZWFrcG9pbnQpIHsKICAgICAgICAgICAgY3R4LnNhdmUoKTsKICAgICAgICAgICAgY3R4LnRyYW5zbGF0ZSh4LCB5KTsKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgICAgICAgICAgICBpZiAoTWF0aC5mbG9vcigodCAvIDMpICogbiAqIDMgKyBpICogMi43KSAlIDIpIHsKICAgICAgICAgICAgICAgIHZhciB0MiA9IE1hdGgucG93KCgodCAvIDMpICogbiAqIDMgKyBpICogMi43KSAlIDEsIDEuNSk7CiAgICAgICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAoMSAtIHQpICogKEdhbWUuZHJhd1QgJSAyID09IDAgPyAwLjUgOiAxKTsKICAgICAgICAgICAgICAgIHZhciBzdyA9ICgxIC0gdDIgKiAwLjUpICogOTY7CiAgICAgICAgICAgICAgICB2YXIgc2ggPSAoMC41ICsgdDIgKiAxLjUpICogOTY7CiAgICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKAogICAgICAgICAgICAgICAgICBQaWMoInNoaW5lU3Bva2UucG5nIiksCiAgICAgICAgICAgICAgICAgIC1zdyAvIDIsCiAgICAgICAgICAgICAgICAgIC1zaCAtIDMyIC0gKDEgLSB0MikgKiAyNTYsCiAgICAgICAgICAgICAgICAgIHN3LAogICAgICAgICAgICAgICAgICBzaAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgY3R4LnJvdGF0ZSgoTWF0aC5QSSAqIDIpIC8gbik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTsKICAgICAgICAgIH0KCiAgICAgICAgICAvL2ZsYXNoIGF0IGJyZWFrcG9pbnQKICAgICAgICAgIGlmICh0QmFzZSA8IDAuMSAmJiB0QmFzZSA+IDApIHsKICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMSAtIHRCYXNlIC8gMC4xOwogICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gIiNmZmYiOwogICAgICAgICAgICBjdHguZmlsbFJlY3QoMCwgMCwgY3R4LmNhbnZhcy53aWR0aCwgY3R4LmNhbnZhcy5oZWlnaHQpOwogICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAxOwogICAgICAgICAgfQogICAgICAgICAgaWYgKHRCYXNlID4gMC44KSB7CiAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9ICh0QmFzZSAtIDAuOCkgLyAwLjI7CiAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSAiIzAwMCI7CiAgICAgICAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCBjdHguY2FudmFzLndpZHRoLCBjdHguY2FudmFzLmhlaWdodCk7CiAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDE7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvL21pbGsgYW5kIG1pbGsgYWNjZXNzb3JpZXMKICAgICAgICBpZiAoR2FtZS5wcmVmcy5taWxrKSB7CiAgICAgICAgICB2YXIgd2lkdGggPSBjdHguY2FudmFzLndpZHRoOwogICAgICAgICAgdmFyIGhlaWdodCA9IGN0eC5jYW52YXMuaGVpZ2h0OwogICAgICAgICAgdmFyIHggPSBNYXRoLmZsb29yKAogICAgICAgICAgICAoR2FtZS5UICogMiAtIChHYW1lLm1pbGtIIC0gR2FtZS5taWxrSGQpICogMjAwMCArIDQ4MCAqIDIpICUgNDgwCiAgICAgICAgICApOyAvL01hdGguZmxvb3IoKEdhbWUuVCoyK01hdGguc2luKEdhbWUuVCowLjEpKjIrTWF0aC5zaW4oR2FtZS5UKjAuMDMpKjItKEdhbWUubWlsa0gtR2FtZS5taWxrSGQpKjIwMDArNDgwKjIpJTQ4MCk7CiAgICAgICAgICB2YXIgeSA9IEdhbWUubWlsa0hkICogaGVpZ2h0OyAvLygoKEdhbWUubWlsa0hkKSpjdHguY2FudmFzLmhlaWdodCkqKDErMC4wNSooTWF0aC5zaW4oR2FtZS5UKjAuMDE3KS8yKzAuNSkpKTsKICAgICAgICAgIHZhciBhID0gMTsKICAgICAgICAgIGlmIChHYW1lLkFzY2VuZFRpbWVyID4gMCkgewogICAgICAgICAgICB5ICo9IDEgLSBNYXRoLnBvdyhHYW1lLkFzY2VuZFRpbWVyIC8gR2FtZS5Bc2NlbmRCcmVha3BvaW50LCAyKSAqIDI7CiAgICAgICAgICAgIGEgKj0gMSAtIE1hdGgucG93KEdhbWUuQXNjZW5kVGltZXIgLyBHYW1lLkFzY2VuZEJyZWFrcG9pbnQsIDIpICogMjsKICAgICAgICAgIH0gZWxzZSBpZiAoR2FtZS5SZWluY2FybmF0ZVRpbWVyID4gMCkgewogICAgICAgICAgICB5ICo9CiAgICAgICAgICAgICAgMSAtCiAgICAgICAgICAgICAgTWF0aC5wb3coCiAgICAgICAgICAgICAgICAxIC0gR2FtZS5SZWluY2FybmF0ZVRpbWVyIC8gR2FtZS5SZWluY2FybmF0ZUR1cmF0aW9uLAogICAgICAgICAgICAgICAgMgogICAgICAgICAgICAgICkgKgogICAgICAgICAgICAgICAgMjsKICAgICAgICAgICAgYSAqPQogICAgICAgICAgICAgIDEgLQogICAgICAgICAgICAgIE1hdGgucG93KAogICAgICAgICAgICAgICAgMSAtIEdhbWUuUmVpbmNhcm5hdGVUaW1lciAvIEdhbWUuUmVpbmNhcm5hdGVEdXJhdGlvbiwKICAgICAgICAgICAgICAgIDIKICAgICAgICAgICAgICApICoKICAgICAgICAgICAgICAgIDI7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKEdhbWUuVE9ZUykgewogICAgICAgICAgICAvL2dvbGx5CiAgICAgICAgICAgIGlmICghR2FtZS5Ub3kpIHsKICAgICAgICAgICAgICBHYW1lLnRveXMgPSBbXTsKICAgICAgICAgICAgICBHYW1lLnRveXNUeXBlID0gY2hvb3NlKFsxLCAyXSk7CiAgICAgICAgICAgICAgR2FtZS5Ub3kgPSBmdW5jdGlvbiAoeCwgeSkgewogICAgICAgICAgICAgICAgdGhpcy5pZCA9IEdhbWUudG95cy5sZW5ndGg7CiAgICAgICAgICAgICAgICB0aGlzLnggPSB4OwogICAgICAgICAgICAgICAgdGhpcy55ID0geTsKICAgICAgICAgICAgICAgIHRoaXMueGQgPSBNYXRoLnJhbmRvbSgpICogMTAgLSA1OwogICAgICAgICAgICAgICAgdGhpcy55ZCA9IE1hdGgucmFuZG9tKCkgKiAxMCAtIDU7CiAgICAgICAgICAgICAgICB0aGlzLnIgPSBNYXRoLnJhbmRvbSgpICogTWF0aC5QSSAqIDI7CiAgICAgICAgICAgICAgICB0aGlzLnJkID0gTWF0aC5yYW5kb20oKSAqIDAuMSAtIDAuMDU7CiAgICAgICAgICAgICAgICB2YXIgdiA9IE1hdGgucmFuZG9tKCk7CiAgICAgICAgICAgICAgICB2YXIgYSA9IDAuNTsKICAgICAgICAgICAgICAgIHZhciBiID0gMC41OwogICAgICAgICAgICAgICAgaWYgKHYgPD0gYSkgdiA9IGIgLSBiICogTWF0aC5wb3coMSAtIHYgLyBhLCAzKTsKICAgICAgICAgICAgICAgIGVsc2UgdiA9IGIgKyAoMSAtIGIpICogTWF0aC5wb3coKHYgLSBhKSAvICgxIC0gYSksIDMpOwogICAgICAgICAgICAgICAgdGhpcy5zID0gKEdhbWUudG95c1R5cGUgPT0gMSA/IDY0IDogNDgpICogKDAuMSArIHYgKiAxLjkpOwogICAgICAgICAgICAgICAgaWYgKEdhbWUudG95c1R5cGUgPT0gMikgdGhpcy5zID0gdGhpcy5pZCAlIDEwID09IDEgPyA5NiA6IDQ4OwogICAgICAgICAgICAgICAgdGhpcy5zdCA9IHRoaXMuczsKICAgICAgICAgICAgICAgIHRoaXMucyA9IDA7CiAgICAgICAgICAgICAgICB2YXIgY29va2llcyA9IFtbMTAsIDBdXTsKICAgICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5VcGdyYWRlcykgewogICAgICAgICAgICAgICAgICB2YXIgY29va2llID0gR2FtZS5VcGdyYWRlc1tpXTsKICAgICAgICAgICAgICAgICAgaWYgKGNvb2tpZS5ib3VnaHQgPiAwICYmIGNvb2tpZS5wb29sID09ICJjb29raWUiKQogICAgICAgICAgICAgICAgICAgIGNvb2tpZXMucHVzaChjb29raWUuaWNvbik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0aGlzLmljb24gPSBjaG9vc2UoY29va2llcyk7CiAgICAgICAgICAgICAgICB0aGlzLmRyYWdnZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHRoaXMubCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICAgICAgICAgICAgdGhpcy5sLmlubmVySFRNTCA9IHRoaXMuaWQ7CiAgICAgICAgICAgICAgICB0aGlzLmwuc3R5bGUuY3NzVGV4dCA9CiAgICAgICAgICAgICAgICAgICJjdXJzb3I6cG9pbnRlcjtib3JkZXItcmFkaXVzOiIgKwogICAgICAgICAgICAgICAgICB0aGlzLnMgLyAyICsKICAgICAgICAgICAgICAgICAgInB4O29wYWNpdHk6MDt3aWR0aDoiICsKICAgICAgICAgICAgICAgICAgdGhpcy5zICsKICAgICAgICAgICAgICAgICAgInB4O2hlaWdodDoiICsKICAgICAgICAgICAgICAgICAgdGhpcy5zICsKICAgICAgICAgICAgICAgICAgInB4O2JhY2tncm91bmQ6Izk5OTtwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OjBweDt0b3A6MHB4O3otaW5kZXg6MTAwMDAwMDA7dHJhbnNmb3JtOnRyYW5zbGF0ZSgtMTAwMHB4LC0xMDAwcHgpOyI7CiAgICAgICAgICAgICAgICBsKCJzZWN0aW9uTGVmdCIpLmFwcGVuZENoaWxkKHRoaXMubCk7CiAgICAgICAgICAgICAgICBBZGRFdmVudCgKICAgICAgICAgICAgICAgICAgdGhpcy5sLAogICAgICAgICAgICAgICAgICAibW91c2Vkb3duIiwKICAgICAgICAgICAgICAgICAgKGZ1bmN0aW9uICh3aGF0KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgIHdoYXQuZHJhZ2dlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgfSkodGhpcykKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICBBZGRFdmVudCgKICAgICAgICAgICAgICAgICAgdGhpcy5sLAogICAgICAgICAgICAgICAgICAibW91c2V1cCIsCiAgICAgICAgICAgICAgICAgIChmdW5jdGlvbiAod2hhdCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICB3aGF0LmRyYWdnZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICB9KSh0aGlzKQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIEdhbWUudG95cy5wdXNoKHRoaXMpOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBmb3IgKAogICAgICAgICAgICAgICAgdmFyIGkgPSAwOwogICAgICAgICAgICAgICAgaSA8CiAgICAgICAgICAgICAgICBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxNSArIChHYW1lLnRveXNUeXBlID09IDEgPyA1IDogMzApKTsKICAgICAgICAgICAgICAgIGkrKwogICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgbmV3IEdhbWUuVG95KAogICAgICAgICAgICAgICAgICBNYXRoLnJhbmRvbSgpICogd2lkdGgsCiAgICAgICAgICAgICAgICAgIE1hdGgucmFuZG9tKCkgKiBoZWlnaHQgKiAwLjMKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDAuNTsKICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLnRveXMpIHsKICAgICAgICAgICAgICB2YXIgbWUgPSBHYW1lLnRveXNbaV07CiAgICAgICAgICAgICAgY3R4LnNhdmUoKTsKICAgICAgICAgICAgICBjdHgudHJhbnNsYXRlKG1lLngsIG1lLnkpOwogICAgICAgICAgICAgIGN0eC5yb3RhdGUobWUucik7CiAgICAgICAgICAgICAgaWYgKEdhbWUudG95c1R5cGUgPT0gMSkKICAgICAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoCiAgICAgICAgICAgICAgICAgIFBpYygic21hbGxDb29raWVzLnBuZyIpLAogICAgICAgICAgICAgICAgICAobWUuaWQgJSA4KSAqIDY0LAogICAgICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgICAgICA2NCwKICAgICAgICAgICAgICAgICAgNjQsCiAgICAgICAgICAgICAgICAgIC1tZS5zIC8gMiwKICAgICAgICAgICAgICAgICAgLW1lLnMgLyAyLAogICAgICAgICAgICAgICAgICBtZS5zLAogICAgICAgICAgICAgICAgICBtZS5zCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoCiAgICAgICAgICAgICAgICAgIFBpYygiaWNvbnMucG5nIiksCiAgICAgICAgICAgICAgICAgIG1lLmljb25bMF0gKiA0OCwKICAgICAgICAgICAgICAgICAgbWUuaWNvblsxXSAqIDQ4LAogICAgICAgICAgICAgICAgICA0OCwKICAgICAgICAgICAgICAgICAgNDgsCiAgICAgICAgICAgICAgICAgIC1tZS5zIC8gMiwKICAgICAgICAgICAgICAgICAgLW1lLnMgLyAyLAogICAgICAgICAgICAgICAgICBtZS5zLAogICAgICAgICAgICAgICAgICBtZS5zCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMTsKICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLnRveXMpIHsKICAgICAgICAgICAgICB2YXIgbWUgPSBHYW1lLnRveXNbaV07CiAgICAgICAgICAgICAgLy9wc3N0Li4uIG5vdCByZWFsIHBoeXNpY3MKICAgICAgICAgICAgICBmb3IgKHZhciBpaSBpbiBHYW1lLnRveXMpIHsKICAgICAgICAgICAgICAgIHZhciBpdCA9IEdhbWUudG95c1tpaV07CiAgICAgICAgICAgICAgICBpZiAoaXQuaWQgIT0gbWUuaWQpIHsKICAgICAgICAgICAgICAgICAgdmFyIHgxID0gbWUueCArIG1lLnhkOwogICAgICAgICAgICAgICAgICB2YXIgeTEgPSBtZS55ICsgbWUueWQ7CiAgICAgICAgICAgICAgICAgIHZhciB4MiA9IGl0LnggKyBpdC54ZDsKICAgICAgICAgICAgICAgICAgdmFyIHkyID0gaXQueSArIGl0LnlkOwogICAgICAgICAgICAgICAgICB2YXIgZGlzdCA9CiAgICAgICAgICAgICAgICAgICAgTWF0aC5zcXJ0KE1hdGgucG93KHgxIC0geDIsIDIpICsgTWF0aC5wb3coeTEgLSB5MiwgMikpIC8KICAgICAgICAgICAgICAgICAgICAobWUucyAvIDIgKyBpdC5zIC8gMik7CiAgICAgICAgICAgICAgICAgIGlmIChkaXN0IDwgKEdhbWUudG95c1R5cGUgPT0gMSA/IDAuOTUgOiAwLjc1KSkgewogICAgICAgICAgICAgICAgICAgIHZhciBhbmdsZSA9IE1hdGguYXRhbjIoeTEgLSB5MiwgeDEgLSB4Mik7CiAgICAgICAgICAgICAgICAgICAgdmFyIHYxID0gTWF0aC5zcXJ0KE1hdGgucG93KG1lLnhkLCAyKSArIE1hdGgucG93KG1lLnlkLCAyKSk7CiAgICAgICAgICAgICAgICAgICAgdmFyIHYyID0gTWF0aC5zcXJ0KE1hdGgucG93KGl0LnhkLCAyKSArIE1hdGgucG93KGl0LnlkLCAyKSk7CiAgICAgICAgICAgICAgICAgICAgdmFyIHYgPSAoKHYxICsgdjIpIC8gMiArIGRpc3QpICogMC43NTsKICAgICAgICAgICAgICAgICAgICB2YXIgcmF0aW8gPSBpdC5zIC8gbWUuczsKICAgICAgICAgICAgICAgICAgICBtZS54ZCArPSBNYXRoLnNpbigtYW5nbGUgKyBNYXRoLlBJIC8gMikgKiB2ICogcmF0aW87CiAgICAgICAgICAgICAgICAgICAgbWUueWQgKz0gTWF0aC5jb3MoLWFuZ2xlICsgTWF0aC5QSSAvIDIpICogdiAqIHJhdGlvOwogICAgICAgICAgICAgICAgICAgIGl0LnhkICs9IE1hdGguc2luKC1hbmdsZSAtIE1hdGguUEkgLyAyKSAqIHYgKiAoMSAvIHJhdGlvKTsKICAgICAgICAgICAgICAgICAgICBpdC55ZCArPSBNYXRoLmNvcygtYW5nbGUgLSBNYXRoLlBJIC8gMikgKiB2ICogKDEgLyByYXRpbyk7CiAgICAgICAgICAgICAgICAgICAgbWUucmQgKz0gKE1hdGgucmFuZG9tKCkgKiAxIC0gMC41KSAqIDAuMSAqIHJhdGlvOwogICAgICAgICAgICAgICAgICAgIGl0LnJkICs9IChNYXRoLnJhbmRvbSgpICogMSAtIDAuNSkgKiAwLjEgKiAoMSAvIHJhdGlvKTsKICAgICAgICAgICAgICAgICAgICBtZS5yZCAqPSBNYXRoLm1pbigxLCB2KTsKICAgICAgICAgICAgICAgICAgICBpdC5yZCAqPSBNYXRoLm1pbigxLCB2KTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAobWUueSA+PSBoZWlnaHQgLSBHYW1lLm1pbGtIZCAqIGhlaWdodCArIDgpIHsKICAgICAgICAgICAgICAgIG1lLnhkICo9IDAuODU7CiAgICAgICAgICAgICAgICBtZS55ZCAqPSAwLjg1OwogICAgICAgICAgICAgICAgbWUucmQgKj0gMC44NTsKICAgICAgICAgICAgICAgIG1lLnlkIC09IDE7CiAgICAgICAgICAgICAgICBtZS54ZCArPSAoTWF0aC5yYW5kb20oKSAqIDEgLSAwLjUpICogMC4zOwogICAgICAgICAgICAgICAgbWUueWQgKz0gKE1hdGgucmFuZG9tKCkgKiAxIC0gMC41KSAqIDAuMDU7CiAgICAgICAgICAgICAgICBtZS5yZCArPSAoTWF0aC5yYW5kb20oKSAqIDEgLSAwLjUpICogMC4wMjsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbWUueGQgKj0gMC45OTsKICAgICAgICAgICAgICAgIG1lLnJkICo9IDAuOTk7CiAgICAgICAgICAgICAgICBtZS55ZCArPSAxOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBtZS55ZCAqPSBNYXRoLm1pbigKICAgICAgICAgICAgICAgIDEsCiAgICAgICAgICAgICAgICBNYXRoLmFicyhtZS55IC0gKGhlaWdodCAtIEdhbWUubWlsa0hkICogaGVpZ2h0KSAvIDE2KQogICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgbWUucmQgKz0gKG1lLnhkICogMC4wMSkgLyAobWUucyAvIChHYW1lLnRveXNUeXBlID09IDEgPyA2NCA6IDQ4KSk7CiAgICAgICAgICAgICAgaWYgKG1lLnggPCBtZS5zIC8gMiAmJiBtZS54ZCA8IDApCiAgICAgICAgICAgICAgICBtZS54ZCA9IE1hdGgubWF4KDAuMSwgLW1lLnhkICogMC42KTsKICAgICAgICAgICAgICBlbHNlIGlmIChtZS54IDwgbWUucyAvIDIpIHsKICAgICAgICAgICAgICAgIG1lLnhkID0gMDsKICAgICAgICAgICAgICAgIG1lLnggPSBtZS5zIC8gMjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKG1lLnggPiB3aWR0aCAtIG1lLnMgLyAyICYmIG1lLnhkID4gMCkKICAgICAgICAgICAgICAgIG1lLnhkID0gTWF0aC5taW4oLTAuMSwgLW1lLnhkICogMC42KTsKICAgICAgICAgICAgICBlbHNlIGlmIChtZS54ID4gd2lkdGggLSBtZS5zIC8gMikgewogICAgICAgICAgICAgICAgbWUueGQgPSAwOwogICAgICAgICAgICAgICAgbWUueCA9IHdpZHRoIC0gbWUucyAvIDI7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIG1lLnhkID0gTWF0aC5taW4oTWF0aC5tYXgobWUueGQsIC0zMCksIDMwKTsKICAgICAgICAgICAgICBtZS55ZCA9IE1hdGgubWluKE1hdGgubWF4KG1lLnlkLCAtMzApLCAzMCk7CiAgICAgICAgICAgICAgbWUucmQgPSBNYXRoLm1pbihNYXRoLm1heChtZS5yZCwgLTAuNSksIDAuNSk7CiAgICAgICAgICAgICAgbWUueCArPSBtZS54ZDsKICAgICAgICAgICAgICBtZS55ICs9IG1lLnlkOwogICAgICAgICAgICAgIG1lLnIgKz0gbWUucmQ7CiAgICAgICAgICAgICAgbWUuciA9IG1lLnIgJSAoTWF0aC5QSSAqIDIpOwogICAgICAgICAgICAgIG1lLnMgKz0gKG1lLnN0IC0gbWUucykgKiAwLjU7CiAgICAgICAgICAgICAgaWYgKEdhbWUudG95c1R5cGUgPT0gMiAmJiAhbWUuZHJhZ2dlZCAmJiBNYXRoLnJhbmRvbSgpIDwgMC4wMDMpCiAgICAgICAgICAgICAgICBtZS5zdCA9IGNob29zZShbNDgsIDQ4LCA0OCwgNDgsIDk2XSk7CiAgICAgICAgICAgICAgaWYgKG1lLmRyYWdnZWQpIHsKICAgICAgICAgICAgICAgIG1lLnggPSBHYW1lLm1vdXNlWDsKICAgICAgICAgICAgICAgIG1lLnkgPSBHYW1lLm1vdXNlWTsKICAgICAgICAgICAgICAgIG1lLnhkICs9ICgoR2FtZS5tb3VzZVggLSBHYW1lLm1vdXNlWDIpICogMyAtIG1lLnhkKSAqIDAuNTsKICAgICAgICAgICAgICAgIG1lLnlkICs9ICgoR2FtZS5tb3VzZVkgLSBHYW1lLm1vdXNlWTIpICogMyAtIG1lLnlkKSAqIDAuNTsKICAgICAgICAgICAgICAgIG1lLmwuc3R5bGUudHJhbnNmb3JtID0KICAgICAgICAgICAgICAgICAgInRyYW5zbGF0ZSgiICsKICAgICAgICAgICAgICAgICAgKG1lLnggLSBtZS5zIC8gMikgKwogICAgICAgICAgICAgICAgICAicHgsIiArCiAgICAgICAgICAgICAgICAgIChtZS55IC0gbWUucyAvIDIpICsKICAgICAgICAgICAgICAgICAgInB4KSBzY2FsZSg1MCkiOwogICAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAgbWUubC5zdHlsZS50cmFuc2Zvcm0gPQogICAgICAgICAgICAgICAgICAidHJhbnNsYXRlKCIgKwogICAgICAgICAgICAgICAgICAobWUueCAtIG1lLnMgLyAyKSArCiAgICAgICAgICAgICAgICAgICJweCwiICsKICAgICAgICAgICAgICAgICAgKG1lLnkgLSBtZS5zIC8gMikgKwogICAgICAgICAgICAgICAgICAicHgpIjsKICAgICAgICAgICAgICBtZS5sLnN0eWxlLndpZHRoID0gbWUucyArICJweCI7CiAgICAgICAgICAgICAgbWUubC5zdHlsZS5oZWlnaHQgPSBtZS5zICsgInB4IjsKICAgICAgICAgICAgICBjdHguc2F2ZSgpOwogICAgICAgICAgICAgIGN0eC50cmFuc2xhdGUobWUueCwgbWUueSk7CiAgICAgICAgICAgICAgY3R4LnJvdGF0ZShtZS5yKTsKICAgICAgICAgICAgICBpZiAoR2FtZS50b3lzVHlwZSA9PSAxKQogICAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZSgKICAgICAgICAgICAgICAgICAgUGljKCJzbWFsbENvb2tpZXMucG5nIiksCiAgICAgICAgICAgICAgICAgIChtZS5pZCAlIDgpICogNjQsCiAgICAgICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgICAgIDY0LAogICAgICAgICAgICAgICAgICA2NCwKICAgICAgICAgICAgICAgICAgLW1lLnMgLyAyLAogICAgICAgICAgICAgICAgICAtbWUucyAvIDIsCiAgICAgICAgICAgICAgICAgIG1lLnMsCiAgICAgICAgICAgICAgICAgIG1lLnMKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZSgKICAgICAgICAgICAgICAgICAgUGljKCJpY29ucy5wbmciKSwKICAgICAgICAgICAgICAgICAgbWUuaWNvblswXSAqIDQ4LAogICAgICAgICAgICAgICAgICBtZS5pY29uWzFdICogNDgsCiAgICAgICAgICAgICAgICAgIDQ4LAogICAgICAgICAgICAgICAgICA0OCwKICAgICAgICAgICAgICAgICAgLW1lLnMgLyAyLAogICAgICAgICAgICAgICAgICAtbWUucyAvIDIsCiAgICAgICAgICAgICAgICAgIG1lLnMsCiAgICAgICAgICAgICAgICAgIG1lLnMKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHZhciBwaWMgPSBHYW1lLk1pbGsucGljOwogICAgICAgICAgaWYgKEdhbWUubWlsa1R5cGUgIT0gMCAmJiBHYW1lLmFzY2Vuc2lvbk1vZGUgIT0gMSkKICAgICAgICAgICAgcGljID0gR2FtZS5BbGxNaWxrc1tHYW1lLm1pbGtUeXBlXS5waWM7CiAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAwLjk1ICogYTsKICAgICAgICAgIGN0eC5maWxsUGF0dGVybigKICAgICAgICAgICAgUGljKHBpYyksCiAgICAgICAgICAgIDAsCiAgICAgICAgICAgIGhlaWdodCAtIHksCiAgICAgICAgICAgIHdpZHRoICsgNDgwLAogICAgICAgICAgICAxLAogICAgICAgICAgICA0ODAsCiAgICAgICAgICAgIDQ4MCwKICAgICAgICAgICAgeCwKICAgICAgICAgICAgMAogICAgICAgICAgKTsKCiAgICAgICAgICBjdHguZmlsbFN0eWxlID0gIiMwMDAiOwogICAgICAgICAgY3R4LmZpbGxSZWN0KDAsIGhlaWdodCAtIHkgKyA0ODAsIHdpZHRoLCBNYXRoLm1heCgwLCB5IC0gNDgwKSk7CiAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAxOwoKICAgICAgICAgIFRpbWVyLnRyYWNrKCJtaWxrIik7CiAgICAgICAgfQoKICAgICAgICBpZiAoR2FtZS5Bc2NlbmRUaW1lciA+IDApIHsKICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoCiAgICAgICAgICAgIFBpYygic2hhZGVkQm9yZGVyc1NvZnQucG5nIiksCiAgICAgICAgICAgIDAsCiAgICAgICAgICAgIDAsCiAgICAgICAgICAgIGN0eC5jYW52YXMud2lkdGgsCiAgICAgICAgICAgIGN0eC5jYW52YXMuaGVpZ2h0CiAgICAgICAgICApOwogICAgICAgIH0KCiAgICAgICAgaWYgKEdhbWUuQXNjZW5kVGltZXIgPT0gMCkgewogICAgICAgICAgR2FtZS5EcmF3V3JpbmtsZXJzKCk7CiAgICAgICAgICBUaW1lci50cmFjaygid3JpbmtsZXJzIik7CiAgICAgICAgICBHYW1lLkRyYXdTcGVjaWFsKCk7CiAgICAgICAgICBUaW1lci50cmFjaygiZXZvbHZhYmxlcyIpOwoKICAgICAgICAgIEdhbWUucGFydGljbGVzRHJhdygyKTsKICAgICAgICAgIFRpbWVyLnRyYWNrKCJ0ZXh0IHBhcnRpY2xlcyIpOwoKICAgICAgICAgIC8vc2hpbnkgYm9yZGVyIGR1cmluZyBmcmVuemllcyBldGMKICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDE7CiAgICAgICAgICB2YXIgYm9yZGVycyA9ICJzaGFkZWRCb3JkZXJzU29mdC5wbmciOwogICAgICAgICAgaWYgKGdvb2RCdWZmKSBib3JkZXJzID0gInNoYWRlZEJvcmRlcnNHb2xkLnBuZyI7CiAgICAgICAgICBlbHNlIGlmIChiYWRCdWZmKSBib3JkZXJzID0gInNoYWRlZEJvcmRlcnNSZWQucG5nIjsKICAgICAgICAgIGlmIChnb29kQnVmZiAmJiBHYW1lLnByZWZzLmZhbmN5KQogICAgICAgICAgICBjdHguZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gImxpZ2h0ZXIiOwogICAgICAgICAgY3R4LmRyYXdJbWFnZSgKICAgICAgICAgICAgUGljKGJvcmRlcnMpLAogICAgICAgICAgICAwLAogICAgICAgICAgICAwLAogICAgICAgICAgICBjdHguY2FudmFzLndpZHRoLAogICAgICAgICAgICBjdHguY2FudmFzLmhlaWdodAogICAgICAgICAgKTsKICAgICAgICAgIGlmIChnb29kQnVmZiAmJiBHYW1lLnByZWZzLmZhbmN5KQogICAgICAgICAgICBjdHguZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gInNvdXJjZS1vdmVyIjsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkJSU5JVElBTElaQVRJT04gRU5EOyBHQU1FIFJFQURZIFRPIExBVU5DSAoJCT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCgogICAgR2FtZS5raWxsU2hpbW1lcnMoKTsKCiAgICAvL2Jvb29vbwogICAgR2FtZS5SdWluVGhlRnVuID0gZnVuY3Rpb24gKHNpbGVudCkgewogICAgICBHYW1lLnBvcHVwcyA9IDA7CiAgICAgIEdhbWUuU2V0QWxsVXBncmFkZXMoMSk7CiAgICAgIEdhbWUuU2V0QWxsQWNoaWV2cygxKTsKICAgICAgR2FtZS5wb3B1cHMgPSAwOwogICAgICBHYW1lLkVhcm4oOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5KTsKICAgICAgR2FtZS5NYXhTcGVjaWFscygpOwogICAgICBHYW1lLm5leHRSZXNlYXJjaCA9IDA7CiAgICAgIEdhbWUucmVzZWFyY2hUID0gLTE7CiAgICAgIEdhbWUudXBncmFkZXNUb1JlYnVpbGQgPSAxOwogICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICBHYW1lLnBvcHVwcyA9IDE7CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5PYmplY3RzW2ldOwogICAgICAgIGlmIChtZS5sZXZlbCA8IDEwKSB7CiAgICAgICAgICBtZS5sZXZlbCA9IDk7CiAgICAgICAgICBtZS5sZXZlbFVwKHRydWUpOwogICAgICAgIH0KICAgICAgICBpZiAobWUubWluaWdhbWUgJiYgbWUubWluaWdhbWUub25SdWluVGhlRnVuKSBtZS5taW5pZ2FtZS5vblJ1aW5UaGVGdW4oKTsKICAgICAgfQogICAgICBpZiAoIXNpbGVudCkgewogICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgIlRob3UgZG90aCBydWluZXRoIHRoZSBmdW4hIiwKICAgICAgICAgICJZb3UncmUgZnJlZS4gRnJlZSBhdCBsYXN0LiIsCiAgICAgICAgICBbMTEsIDVdCiAgICAgICAgKTsKICAgICAgfQogICAgICByZXR1cm4gIllvdSBmZWVsIGEgYml0dGVyIHRhc3RlIGluIHlvdXIgbW91dGguLi4iOwogICAgfTsKCiAgICBHYW1lLlNldEFsbFVwZ3JhZGVzID0gZnVuY3Rpb24gKG9uKSB7CiAgICAgIEdhbWUucG9wdXBzID0gMDsKICAgICAgdmFyIGxlZnRvdXQgPSBbCiAgICAgICAgIk1hZ2ljIHNoZW5hbmlnYW5zIiwKICAgICAgICAiT2NjdWx0IG9ic3RydWN0aW9uIiwKICAgICAgICAiR2x1Y29zZS1jaGFyZ2VkIGFpciIsCiAgICAgIF07CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5VcGdyYWRlcykgewogICAgICAgIGlmICgKICAgICAgICAgIG9uICYmCiAgICAgICAgICAoR2FtZS5VcGdyYWRlc1tpXS5wb29sID09ICJ0b2dnbGUiIHx8CiAgICAgICAgICAgIGxlZnRvdXQuaW5kZXhPZihHYW1lLlVwZ3JhZGVzW2ldLm5hbWUpICE9IC0xKQogICAgICAgICkgewogICAgICAgIH0gZWxzZSBpZiAob24pIEdhbWUuVXBncmFkZXNbaV0uZWFybigpOwogICAgICAgIGVsc2UgaWYgKCFvbikgR2FtZS5VcGdyYWRlc1tpXS5sb3NlKCk7CiAgICAgIH0KICAgICAgR2FtZS51cGdyYWRlc1RvUmVidWlsZCA9IDE7CiAgICAgIEdhbWUucmVjYWxjdWxhdGVHYWlucyA9IDE7CiAgICAgIEdhbWUucG9wdXBzID0gMTsKICAgIH07CiAgICBHYW1lLlNldEFsbEFjaGlldnMgPSBmdW5jdGlvbiAob24pIHsKICAgICAgR2FtZS5wb3B1cHMgPSAwOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUuQWNoaWV2ZW1lbnRzKSB7CiAgICAgICAgaWYgKG9uICYmIEdhbWUuQWNoaWV2ZW1lbnRzW2ldLnBvb2wgIT0gImR1bmdlb24iKQogICAgICAgICAgR2FtZS5XaW4oR2FtZS5BY2hpZXZlbWVudHNbaV0ubmFtZSk7CiAgICAgICAgZWxzZSBpZiAoIW9uKSBHYW1lLlJlbW92ZUFjaGlldihHYW1lLkFjaGlldmVtZW50c1tpXS5uYW1lKTsKICAgICAgfQogICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICBHYW1lLnBvcHVwcyA9IDE7CiAgICB9OwogICAgR2FtZS5HZXRBbGxEZWJ1Z3MgPSBmdW5jdGlvbiAoKSB7CiAgICAgIEdhbWUucG9wdXBzID0gMDsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlVwZ3JhZGVzKSB7CiAgICAgICAgaWYgKEdhbWUuVXBncmFkZXNbaV0ucG9vbCA9PSAiZGVidWciKSBHYW1lLlVwZ3JhZGVzW2ldLmVhcm4oKTsKICAgICAgfQogICAgICBHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkID0gMTsKICAgICAgR2FtZS5yZWNhbGN1bGF0ZUdhaW5zID0gMTsKICAgICAgR2FtZS5wb3B1cHMgPSAxOwogICAgfTsKICAgIEdhbWUuTWF4U3BlY2lhbHMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIEdhbWUuZHJhZ29uTGV2ZWwgPSBHYW1lLmRyYWdvbkxldmVscy5sZW5ndGggLSAxOwogICAgICBHYW1lLnNhbnRhTGV2ZWwgPSBHYW1lLnNhbnRhTGV2ZWxzLmxlbmd0aCAtIDE7CiAgICB9OwoKICAgIEdhbWUuU2VzYW1lUmVzZXQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBuYW1lID0gR2FtZS5iYWtlcnlOYW1lOwogICAgICBHYW1lLkhhcmRSZXNldCgyKTsKICAgICAgR2FtZS5iYWtlcnlOYW1lID0gbmFtZTsKICAgICAgR2FtZS5iYWtlcnlOYW1lUmVmcmVzaCgpOwogICAgICBHYW1lLkFjaGlldmVtZW50c1siQ2hlYXRlZCBjb29raWVzIHRhc3RlIGF3ZnVsIl0ud29uID0gMTsKICAgIH07CgogICAgR2FtZS5kZWJ1Z1RpbWVyc09uID0gMDsKICAgIEdhbWUuc2VzYW1lID0gMDsKICAgIEdhbWUuT3BlblNlc2FtZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHN0ciA9ICIiOwogICAgICBzdHIgKz0KICAgICAgICAnPGRpdiBjbGFzcz0iaWNvbiIgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlO2xlZnQ6LTlweDt0b3A6LTZweDtiYWNrZ3JvdW5kLXBvc2l0aW9uOicgKwogICAgICAgIC0xMCAqIDQ4ICsKICAgICAgICAicHggIiArCiAgICAgICAgLTYgKiA0OCArCiAgICAgICAgJ3B4OyI+PC9kaXY+JzsKICAgICAgc3RyICs9CiAgICAgICAgJzxkaXYgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlO2xlZnQ6MHB4O3RvcDowcHg7ei1pbmRleDoxMDtmb250LXNpemU6MTBweDtiYWNrZ3JvdW5kOiMwMDA7cGFkZGluZzoxcHg7IiBpZD0iZnBzQ291bnRlciI+PC9kaXY+JzsKCiAgICAgIHN0ciArPSAnPGRpdiBpZD0iZGV2Q29uc29sZUNvbnRlbnQiPic7CiAgICAgIHN0ciArPQogICAgICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSIgc3R5bGU9ImZvbnQtc2l6ZToxNHB4O21hcmdpbjo2cHg7Ij5EZXYgdG9vbHM8L2Rpdj4nOwoKICAgICAgc3RyICs9CiAgICAgICAgJzxhIGNsYXNzPSJvcHRpb24gbmVhdG8iICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICc9IkdhbWUuQXNjZW5kKDEpOyI+QXNjZW5kPC9hPic7CiAgICAgIHN0ciArPSAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JzsKICAgICAgc3RyICs9CiAgICAgICAgJzxhIGNsYXNzPSJvcHRpb24gbmVhdG8iICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICc9IkdhbWUuY29va2llcyo9MTA7R2FtZS5jb29raWVzRWFybmVkKj0xMDsiPngxMDwvYT4nOwogICAgICBzdHIgKz0KICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiBuZWF0byIgJyArCiAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgJz0iR2FtZS5jb29raWVzLz0xMDtHYW1lLmNvb2tpZXNFYXJuZWQvPTEwOyI+LzEwPC9hPjxicj4nOwogICAgICBzdHIgKz0KICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiBuZWF0byIgJyArCiAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgJz0iR2FtZS5jb29raWVzKj0xMDAwO0dhbWUuY29va2llc0Vhcm5lZCo9MTAwMDsiPngxazwvYT4nOwogICAgICBzdHIgKz0KICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiBuZWF0byIgJyArCiAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgJz0iR2FtZS5jb29raWVzLz0xMDAwO0dhbWUuY29va2llc0Vhcm5lZC89MTAwMDsiPi8xazwvYT48YnI+JzsKICAgICAgc3RyICs9CiAgICAgICAgJzxhIGNsYXNzPSJvcHRpb24gbmVhdG8iICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICc9ImZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKXtHYW1lLk9iamVjdHNbaV0uYnV5KDEwMCk7fSI+QnV5IDEwMCBvZiBhbGw8L2E+JzsgLy9mb3IgKHZhciBuPTA7bjwxMDA7bisrKXtmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0cyl7R2FtZS5PYmplY3RzW2ldLmJ1eSgxKTt9fQogICAgICBzdHIgKz0KICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiBuZWF0byIgJyArCiAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgJz0iZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpe0dhbWUuT2JqZWN0c1tpXS5zZWxsKDEwMCk7fSI+U2VsbCAxMDAgb2YgYWxsPC9hPjxicj4nOwogICAgICBzdHIgKz0KICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiBuZWF0byIgJyArCiAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgJz0iR2FtZS5nYWluTHVtcHMoMTApOyI+KzEwIGx1bXBzPC9hPic7CiAgICAgIHN0ciArPQogICAgICAgICc8YSBjbGFzcz0ib3B0aW9uIG5lYXRvIiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0cyl7R2FtZS5PYmplY3RzW2ldLmxldmVsPTA7R2FtZS5PYmplY3RzW2ldLm9uTWluaWdhbWU9ZmFsc2U7R2FtZS5PYmplY3RzW2ldLnJlZnJlc2goKTt9R2FtZS5yZWNhbGN1bGF0ZUdhaW5zPTE7Ij5SZXNldCBsZXZlbHM8L2E+JzsKICAgICAgc3RyICs9CiAgICAgICAgJzxhIGNsYXNzPSJvcHRpb24gbmVhdG8iICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICc9IkdhbWUuY29va2llc1Jlc2V0Kz1HYW1lLkhvd01hbnlDb29raWVzUmVzZXQoKEdhbWUuaGVhdmVubHlDaGlwc3x8MSkqMTAwMCk7R2FtZS5FYXJuSGVhdmVubHlDaGlwcygwLHRydWUpO0dhbWUucmVjYWxjdWxhdGVHYWlucz0xOyI+SEMgeDFrPC9hPic7CiAgICAgIHN0ciArPQogICAgICAgICc8YSBjbGFzcz0ib3B0aW9uIG5lYXRvIiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJHYW1lLmNvb2tpZXNSZXNldD0oR2FtZS5oZWF2ZW5seUNoaXBzPDEwMD8wOkdhbWUuSG93TWFueUNvb2tpZXNSZXNldChNYXRoLmZsb29yKEdhbWUuaGVhdmVubHlDaGlwcyowLjAwMSkpKTtHYW1lLmNvb2tpZXNSZXNldD1NYXRoLm1heChHYW1lLmNvb2tpZXNSZXNldCwwKTtHYW1lLkVhcm5IZWF2ZW5seUNoaXBzKDAsdHJ1ZSk7aWYgKEdhbWUuY29va2llc1Jlc2V0PD0wKXtHYW1lLmhlYXZlbmx5Q2hpcHM9MDt9R2FtZS5yZWNhbGN1bGF0ZUdhaW5zPTE7Ij5IQyAvMWs8L2E+PGJyPic7IC8vd2VlIGJpdCBpbmFjY3VyYXRlCiAgICAgIHN0ciArPQogICAgICAgICc8YSBjbGFzcz0ib3B0aW9uIG5lYXRvIiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJHYW1lLmNvb2tpZXNFYXJuZWQ9MDtHYW1lLnJlY2FsY3VsYXRlR2FpbnM9MTsiPlJlc2V0IGNvb2tpZXMgZWFybmVkPC9hPjxicj4nOwogICAgICBzdHIgKz0gJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2Pic7CiAgICAgIHN0ciArPQogICAgICAgICc8YSBjbGFzcz0ib3B0aW9uIHdhcm5pbmciICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICc9IkdhbWUuUnVpblRoZUZ1bigxKTsiPlJ1aW4gVGhlIEZ1bjwvYT4nOwogICAgICBzdHIgKz0KICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiB3YXJuaW5nIiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJHYW1lLlNlc2FtZVJlc2V0KCk7Ij5XaXBlPC9hPic7CiAgICAgIHN0ciArPQogICAgICAgICc8YSBjbGFzcz0ib3B0aW9uIG5lYXRvIiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJHYW1lLkdldEFsbERlYnVncygpOyI+QWxsIGRlYnVnczwvYT4nOwogICAgICBzdHIgKz0KICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiBuZWF0byIgJyArCiAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgJz0iR2FtZS5kZWJ1Z1RpbWVyc09uPSFHYW1lLmRlYnVnVGltZXJzT247R2FtZS5PcGVuU2VzYW1lKCk7Ij5UaW1lcnMgJyArCiAgICAgICAgKEdhbWUuZGVidWdUaW1lcnNPbiA/ICJPbiIgOiAiT2ZmIikgKwogICAgICAgICI8L2E+PGJyPiI7CiAgICAgIHN0ciArPQogICAgICAgICc8YSBjbGFzcz0ib3B0aW9uIG5lYXRvIiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJHYW1lLlNldEFsbFVwZ3JhZGVzKDApOyI+Tm8gdXBncmFkZXM8L2E+JzsKICAgICAgc3RyICs9CiAgICAgICAgJzxhIGNsYXNzPSJvcHRpb24gbmVhdG8iICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICc9IkdhbWUuU2V0QWxsVXBncmFkZXMoMSk7Ij5BbGwgdXBncmFkZXM8L2E+PGJyPic7CiAgICAgIHN0ciArPQogICAgICAgICc8YSBjbGFzcz0ib3B0aW9uIG5lYXRvIiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJHYW1lLlNldEFsbEFjaGlldnMoMCk7Ij5ObyBhY2hpZXZzPC9hPic7CiAgICAgIHN0ciArPQogICAgICAgICc8YSBjbGFzcz0ib3B0aW9uIG5lYXRvIiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJHYW1lLlNldEFsbEFjaGlldnMoMSk7Ij5BbGwgYWNoaWV2czwvYT48YnI+JzsKICAgICAgc3RyICs9CiAgICAgICAgJzxhIGNsYXNzPSJvcHRpb24gbmVhdG8iICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICc9IkdhbWUuc2FudGFMZXZlbD0wO0dhbWUuZHJhZ29uTGV2ZWw9MDsiPlJlc2V0IHNwZWNpYWxzPC9hPic7CiAgICAgIHN0ciArPQogICAgICAgICc8YSBjbGFzcz0ib3B0aW9uIG5lYXRvIiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJHYW1lLk1heFNwZWNpYWxzKCk7Ij5NYXggc3BlY2lhbHM8L2E+PGJyPic7CiAgICAgIHN0ciArPQogICAgICAgICc8YSBjbGFzcz0ib3B0aW9uIG5lYXRvIiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJHYW1lLmx1bXBSZWZpbGw9MDsvKkRhdGUubm93KCktR2FtZS5nZXRMdW1wUmVmaWxsTWF4KCk7Ki8iPlJlc2V0IHJlZmlsbHM8L2E+JzsKICAgICAgc3RyICs9CiAgICAgICAgJzxhIGNsYXNzPSJvcHRpb24gbmVhdG8iICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICc9IkdhbWUuRWRpdEFzY2VuZCgpOyI+JyArCiAgICAgICAgKEdhbWUuRGVidWdnaW5nUHJlc3RpZ2UgPyAiRXhpdCBBc2NlbmQgRWRpdCIgOiAiQXNjZW5kIEVkaXQiKSArCiAgICAgICAgIjwvYT4iOwogICAgICBzdHIgKz0KICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiBuZWF0byIgJyArCiAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgJz0iR2FtZS5EZWJ1Z1VwZ3JhZGVDcFMoKTsiPkRlYnVnIHVwZ3JhZGVzIENwUzwvYT4nOwogICAgICBzdHIgKz0KICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiBuZWF0byIgJyArCiAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgJz0iR2FtZS5zZWVkPUdhbWUubWFrZVNlZWQoKTsiPlJlLXNlZWQ8L2E+JzsKICAgICAgc3RyICs9CiAgICAgICAgJzxhIGNsYXNzPSJvcHRpb24gbmVhdG8iICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICI9XCJHYW1lLmhlcmFsZHM9MTAwO2woJ2hlcmFsZHNBbW91bnQnKS50ZXh0Q29udGVudD1HYW1lLmhlcmFsZHM7R2FtZS5leHRlcm5hbERhdGFMb2FkZWQ9dHJ1ZTtHYW1lLnJlY2FsY3VsYXRlR2FpbnM9MTtcIj5NYXggaGVyYWxkczwvYT4iOwogICAgICBzdHIgKz0gJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2Pic7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgR2FtZS5nb2xkZW5Db29raWVDaG9pY2VzLmxlbmd0aCAvIDI7IGkrKykgewogICAgICAgIHN0ciArPQogICAgICAgICAgJzxhIGNsYXNzPSJvcHRpb24gbmVhdG8iICcgKwogICAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgICAiPVwidmFyIG5ld1NoaW1tZXI9bmV3IEdhbWUuc2hpbW1lcignZ29sZGVuJyk7bmV3U2hpbW1lci5mb3JjZT0nIiArCiAgICAgICAgICBHYW1lLmdvbGRlbkNvb2tpZUNob2ljZXNbaSAqIDIgKyAxXSArCiAgICAgICAgICAiJztcIj4iICsKICAgICAgICAgIEdhbWUuZ29sZGVuQ29va2llQ2hvaWNlc1tpICogMl0gKwogICAgICAgICAgIjwvYT4iOwogICAgICAgIC8vc3RyKz0nPGEgY2xhc3M9Im9wdGlvbiBuZWF0byIgJytHYW1lLmNsaWNrU3RyKyc9IkdhbWUuZ29sZGVuQ29va2llLmZvcmNlPVwnJytHYW1lLmdvbGRlbkNvb2tpZS5jaG9pY2VzW2kqMisxXSsnXCc7R2FtZS5nb2xkZW5Db29raWUuc3Bhd24oKTsiPicrR2FtZS5nb2xkZW5Db29raWUuY2hvaWNlc1tpKjJdKyc8L2E+JzsKICAgICAgICAvL3N0cis9JzxhIGNsYXNzPSJvcHRpb24gbmVhdG8iICcrR2FtZS5jbGlja1N0cisnPSJHYW1lLmdvbGRlbkNvb2tpZS5jbGljaygwLFwnJytHYW1lLmdvbGRlbkNvb2tpZS5jaG9pY2VzW2kqMisxXSsnXCcpOyI+JytHYW1lLmdvbGRlbkNvb2tpZS5jaG9pY2VzW2kqMl0rJzwvYT4nOwogICAgICB9CiAgICAgIHN0ciArPSAiPC9kaXY+IjsKCiAgICAgIGwoImRldkNvbnNvbGUiKS5pbm5lckhUTUwgPSBzdHI7CgogICAgICBpZiAoIWwoImZwc0dyYXBoIikpIHsKICAgICAgICB2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIik7CiAgICAgICAgZGl2LmlkID0gImZwc0dyYXBoIjsKICAgICAgICBkaXYud2lkdGggPSAxMjg7CiAgICAgICAgZGl2LmhlaWdodCA9IDY0OwogICAgICAgIGRpdi5zdHlsZS5vcGFjaXR5ID0gMC41OwogICAgICAgIGRpdi5zdHlsZS5wb2ludGVyRXZlbnRzID0gIm5vbmUiOwogICAgICAgIGRpdi5zdHlsZS50cmFuc2Zvcm1PcmlnaW4gPSAiMCUgMCUiOwogICAgICAgIGRpdi5zdHlsZS50cmFuc2Zvcm0gPSAic2NhbGUoMC43NSkiOwogICAgICAgIC8vbCgnZGV2Q29uc29sZScpLmFwcGVuZENoaWxkKGRpdik7CiAgICAgICAgbCgiZGV2Q29uc29sZSIpLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKAogICAgICAgICAgZGl2LAogICAgICAgICAgbCgiZGV2Q29uc29sZSIpLm5leHRTaWJsaW5nCiAgICAgICAgKTsKICAgICAgICBHYW1lLmZwc0dyYXBoID0gZGl2OwogICAgICAgIEdhbWUuZnBzR3JhcGhDdHggPSBHYW1lLmZwc0dyYXBoLmdldENvbnRleHQoIjJkIiwgeyBhbHBoYTogZmFsc2UgfSk7CiAgICAgICAgdmFyIGN0eCA9IEdhbWUuZnBzR3JhcGhDdHg7CiAgICAgICAgY3R4LmZpbGxTdHlsZSA9ICIjMDAwIjsKICAgICAgICBjdHguZmlsbFJlY3QoMCwgMCwgMTI4LCA2NCk7CiAgICAgIH0KCiAgICAgIGwoImRlYnVnIikuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgIEdhbWUuc2VzYW1lID0gMTsKICAgICAgR2FtZS5BY2hpZXZlbWVudHNbIkNoZWF0ZWQgY29va2llcyB0YXN0ZSBhd2Z1bCJdLndvbiA9IDE7CiAgICB9OwoKICAgIEdhbWUuRWRpdEFzY2VuZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCFHYW1lLkRlYnVnZ2luZ1ByZXN0aWdlKSB7CiAgICAgICAgR2FtZS5EZWJ1Z2dpbmdQcmVzdGlnZSA9IHRydWU7CiAgICAgICAgR2FtZS5Bc2NlbmRUaW1lciA9IDA7CiAgICAgICAgR2FtZS5PbkFzY2VuZCA9IDE7CiAgICAgICAgR2FtZS5yZW1vdmVDbGFzcygiYXNjZW5kSW50cm8iKTsKICAgICAgICBHYW1lLmFkZENsYXNzKCJhc2NlbmRpbmciKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBHYW1lLkRlYnVnZ2luZ1ByZXN0aWdlID0gZmFsc2U7CiAgICAgIH0KICAgICAgR2FtZS5CdWlsZEFzY2VuZFRyZWUoKTsKICAgICAgR2FtZS5PcGVuU2VzYW1lKCk7CiAgICB9OwoKICAgIC8vZXhwZXJpbWVudGFsIGRlYnVnZ2luZyBmdW5jdGlvbiB0aGF0IGN5Y2xlcyB0aHJvdWdoIGV2ZXJ5IG93bmVkIHVwZ3JhZGUsIHR1cm5zIGl0IG9mZiBhbmQgb24sIGFuZCBsaXN0cyBob3cgbXVjaCBlYWNoIHVwZ3JhZGUgaXMgcGFydGljaXBhdGluZyB0byBDcFMKICAgIEdhbWUuZGVidWdnZWRVcGdyYWRlQ3BTID0gW107CiAgICBHYW1lLmRlYnVnZ2VkVXBncmFkZUNwQ2xpY2sgPSBbXTsKICAgIEdhbWUuZGVidWdDb2xvcnMgPSBbCiAgICAgICIjMzIyIiwKICAgICAgIiM0MTEiLAogICAgICAiIzYwMCIsCiAgICAgICIjOTAwIiwKICAgICAgIiNmMzAiLAogICAgICAiI2Y5MCIsCiAgICAgICIjZmYwIiwKICAgICAgIiM5ZjAiLAogICAgICAiIzBmOSIsCiAgICAgICIjMDlmIiwKICAgICAgIiM5MGYiLAogICAgXTsKICAgIEdhbWUuRGVidWdVcGdyYWRlQ3BTID0gZnVuY3Rpb24gKCkgewogICAgICBHYW1lLkNhbGN1bGF0ZUdhaW5zKCk7CiAgICAgIEdhbWUuZGVidWdnZWRVcGdyYWRlQ3BTID0gW107CiAgICAgIEdhbWUuZGVidWdnZWRVcGdyYWRlQ3BDbGljayA9IFtdOwogICAgICB2YXIgQ3BTID0gR2FtZS5jb29raWVzUHM7CiAgICAgIHZhciBDcENsaWNrID0gR2FtZS5jb21wdXRlZE1vdXNlQ3BzOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUuVXBncmFkZXMpIHsKICAgICAgICB2YXIgbWUgPSBHYW1lLlVwZ3JhZGVzW2ldOwogICAgICAgIGlmIChtZS5ib3VnaHQpIHsKICAgICAgICAgIG1lLmJvdWdodCA9IDA7CiAgICAgICAgICBHYW1lLkNhbGN1bGF0ZUdhaW5zKCk7CiAgICAgICAgICAvL0dhbWUuZGVidWdnZWRVcGdyYWRlQ3BTW21lLm5hbWVdPUNwUy1HYW1lLmNvb2tpZXNQczsKICAgICAgICAgIEdhbWUuZGVidWdnZWRVcGdyYWRlQ3BTW21lLm5hbWVdID0gQ3BTIC8gKEdhbWUuY29va2llc1BzIHx8IDEpIC0gMTsKICAgICAgICAgIEdhbWUuZGVidWdnZWRVcGdyYWRlQ3BDbGlja1ttZS5uYW1lXSA9CiAgICAgICAgICAgIENwQ2xpY2sgLyAoR2FtZS5jb21wdXRlZE1vdXNlQ3BzIHx8IDEpIC0gMTsKICAgICAgICAgIG1lLmJvdWdodCA9IDE7CiAgICAgICAgfQogICAgICB9CiAgICAgIEdhbWUuQ2FsY3VsYXRlR2FpbnMoKTsKICAgIH07CgogICAgR2FtZS52YW5pbGxhID0gMDsgLy9ldmVyeXRoaW5nIHdlIGNyZWF0ZSBiZXlvbmQgdGhpcyB3aWxsIGJlIHNhdmVkIGluIG1vZCBzdHJ1Y3R1cmVzCgogICAgR2FtZS5sYXVuY2hNb2RzKCk7CgogICAgR2FtZS5ydW5Nb2RIb29rKCJjcmVhdGUiKTsgLy9kZWNsYXJlIGN1c3RvbSB1cGdyYWRlcy9hY2hpZXZzL2J1ZmZzL2J1aWxkaW5ncyBoZXJlIQoKICAgIEJlYXV0aWZ5QWxsKCk7CgogICAgaWYgKCFBcHApIHsKICAgICAgaWYgKCFHYW1lLkxvYWRTYXZlKCkpIHsKICAgICAgICAvL3RyeSB0byBsb2FkIHRoZSBzYXZlIHdoZW4gd2Ugb3BlbiB0aGUgcGFnZS4gaWYgdGhpcyBmYWlscywgdHJ5IHRvIGJydXRlLWZvcmNlIGl0IGhhbGYgYSBzZWNvbmQgbGF0ZXIKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBsb2NhbCA9IGxvY2FsU3RvcmFnZUdldChHYW1lLlNhdmVUbyk7CiAgICAgICAgICBHYW1lLkxvYWRTYXZlKGxvY2FsKTsKICAgICAgICB9LCA1MDApOwogICAgICB9CiAgICB9IGVsc2UgaWYgKEFwcC5zYXZlRGF0YSkKICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5Mb2FkU2F2ZShBcHAuc2F2ZURhdGEpOwogICAgICB9LCAxMDApOwogICAgZWxzZQogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLkxvYWRTYXZlKCk7CiAgICAgIH0sIDEwMCk7CgogICAgR2FtZS5yZWFkeSA9IDE7CiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKAogICAgICAgIHR5cGVvZiBzaG93QWRzID09PSAidW5kZWZpbmVkIiAmJgogICAgICAgICghbCgiZGV0ZWN0QWRzIikgfHwgbCgiZGV0ZWN0QWRzIikuY2xpZW50SGVpZ2h0IDwgMSkKICAgICAgKQogICAgICAgIEdhbWUuYWRkQ2xhc3MoIm5vQWRzIik7CiAgICB9LCA1MDApOwogICAgbCgib2ZmR2FtZU1lc3NhZ2UiKS5pbm5lckhUTUwgPSAiIjsKICAgIGwoIm9mZkdhbWVNZXNzYWdlV3JhcCIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICBHYW1lLkxvb3AoKTsKICAgIEdhbWUuRHJhdygpOwoKICAgIFBsYXlDdWUoImxhdW5jaCIpOwoKICAgIGlmICghRU4pIHsKICAgICAgdmFyIGFkYXB0V2lkdGggPSBmdW5jdGlvbiAobm9kZSkgewogICAgICAgIHZhciBlbCA9IG5vZGUuZmlyc3RDaGlsZDsKICAgICAgICB2YXIgd2lkdGggPSBlbC5jbGllbnRXaWR0aDsKICAgICAgICBpZiAoZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCJzdWJCdXR0b24iKSkgewogICAgICAgICAgaWYgKHdpZHRoIC8gOTUgPiAxKSBlbC5zdHlsZS5wYWRkaW5nID0gIjZweCAwcHgiOwogICAgICAgIH0KICAgICAgICB3aWR0aCA9IHdpZHRoIC8gOTU7CiAgICAgICAgaWYgKHdpZHRoID4gMSkgewogICAgICAgICAgZWwuc3R5bGUuZm9udFNpemUgPQogICAgICAgICAgICAocGFyc2VJbnQod2luZG93LmdldENvbXB1dGVkU3R5bGUoZWwpLmZvbnRTaXplKSAqIDEpIC8gd2lkdGggKyAicHgiOwogICAgICAgICAgZWwuc3R5bGUudHJhbnNmb3JtID0gInNjYWxlKDEsIiArIHdpZHRoICsgIikiOwogICAgICAgIH0KICAgICAgfTsKICAgICAgbCgicHJlZnNCdXR0b24iKS5maXJzdENoaWxkLmlubmVySFRNTCA9IGxvYygiT3B0aW9ucyIpOwogICAgICBsKCJzdGF0c0J1dHRvbiIpLmZpcnN0Q2hpbGQuaW5uZXJIVE1MID0gbG9jKCJTdGF0cyIpOwogICAgICBsKCJsb2dCdXR0b24iKS5maXJzdENoaWxkLmlubmVySFRNTCA9IGxvYygiSW5mbyIpOwogICAgICBsKCJsZWdhY3lCdXR0b24iKS5maXJzdENoaWxkLmlubmVySFRNTCA9IGxvYygiTGVnYWN5Iik7CiAgICAgIGFkYXB0V2lkdGgobCgicHJlZnNCdXR0b24iKSk7CiAgICAgIGFkYXB0V2lkdGgobCgic3RhdHNCdXR0b24iKSk7CiAgICAgIGFkYXB0V2lkdGgobCgibG9nQnV0dG9uIikpOwogICAgICBhZGFwdFdpZHRoKGwoImxlZ2FjeUJ1dHRvbiIpKTsKICAgICAgbCgiY2hlY2tGb3JVcGRhdGUiKS5jaGlsZE5vZGVzWzBdLnRleHRDb250ZW50ID0gbG9jKCJOZXcgdXBkYXRlISIpOwogICAgICBsKCJidWlsZGluZ3NUaXRsZSIpLmNoaWxkTm9kZXNbMF0udGV4dENvbnRlbnQgPSBsb2MoIkJ1aWxkaW5ncyIpOwogICAgICBsKCJzdG9yZVRpdGxlIikuY2hpbGROb2Rlc1swXS50ZXh0Q29udGVudCA9IGxvYygiU3RvcmUiKTsKICAgIH0KICB9OwogIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJTE9HSUMKCT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCiAgR2FtZS5Mb2dpYyA9IGZ1bmN0aW9uICgpIHsKICAgIEdhbWUuYm91bmRzID0gR2FtZS5sLmdldEJvdW5kcygpOwoKICAgIGlmICghR2FtZS5PbkFzY2VuZCAmJiBHYW1lLkFzY2VuZFRpbWVyID09IDApIHsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICBpZiAoR2FtZS5PYmplY3RzW2ldLmVhY2hGcmFtZSkgR2FtZS5PYmplY3RzW2ldLmVhY2hGcmFtZSgpOwogICAgICB9CiAgICAgIEdhbWUuVXBkYXRlU3BlY2lhbCgpOwogICAgICBHYW1lLlVwZGF0ZUdyYW5kbWFwb2NhbHlwc2UoKTsKCiAgICAgIC8vdGhlc2UgYXJlIGtpbmRhIGZ1bgogICAgICAvL2lmIChHYW1lLkJpZ0Nvb2tpZVN0YXRlPT0yICYmICFHYW1lLnByb21wdE9uICYmIEdhbWUuU2Nyb2xsIT0wKSBHYW1lLkNsaWNrQ29va2llKCk7CiAgICAgIC8vaWYgKEdhbWUuQmlnQ29va2llU3RhdGU9PTEgJiYgIUdhbWUucHJvbXB0T24pIEdhbWUuQ2xpY2tDb29raWUoKTsKCiAgICAgIC8vaGFuZGxlIGdyYXBoaWMgc3R1ZmYKICAgICAgaWYgKEdhbWUucHJlZnMud29iYmx5KSB7CiAgICAgICAgaWYgKEdhbWUuQmlnQ29va2llU3RhdGUgPT0gMSkgR2FtZS5CaWdDb29raWVTaXplVCA9IDAuOTg7CiAgICAgICAgZWxzZSBpZiAoR2FtZS5CaWdDb29raWVTdGF0ZSA9PSAyKSBHYW1lLkJpZ0Nvb2tpZVNpemVUID0gMS4wNTsKICAgICAgICBlbHNlIEdhbWUuQmlnQ29va2llU2l6ZVQgPSAxOwogICAgICAgIEdhbWUuQmlnQ29va2llU2l6ZUQgKz0KICAgICAgICAgIChHYW1lLkJpZ0Nvb2tpZVNpemVUIC0gR2FtZS5CaWdDb29raWVTaXplKSAqIDAuNzU7CiAgICAgICAgR2FtZS5CaWdDb29raWVTaXplRCAqPSAwLjc1OwogICAgICAgIEdhbWUuQmlnQ29va2llU2l6ZSArPSBHYW1lLkJpZ0Nvb2tpZVNpemVEOwogICAgICAgIEdhbWUuQmlnQ29va2llU2l6ZSA9IE1hdGgubWF4KDAuMSwgR2FtZS5CaWdDb29raWVTaXplKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoR2FtZS5CaWdDb29raWVTdGF0ZSA9PSAxKQogICAgICAgICAgR2FtZS5CaWdDb29raWVTaXplICs9ICgwLjk4IC0gR2FtZS5CaWdDb29raWVTaXplKSAqIDAuNTsKICAgICAgICBlbHNlIGlmIChHYW1lLkJpZ0Nvb2tpZVN0YXRlID09IDIpCiAgICAgICAgICBHYW1lLkJpZ0Nvb2tpZVNpemUgKz0gKDEuMDUgLSBHYW1lLkJpZ0Nvb2tpZVNpemUpICogMC41OwogICAgICAgIGVsc2UgR2FtZS5CaWdDb29raWVTaXplICs9ICgxIC0gR2FtZS5CaWdDb29raWVTaXplKSAqIDAuNTsKICAgICAgfQogICAgICBHYW1lLnBhcnRpY2xlc1VwZGF0ZSgpOwoKICAgICAgaWYgKEdhbWUubW91c2VQb2ludGVyKSBsKCJzZWN0aW9uTGVmdCIpLnN0eWxlLmN1cnNvciA9ICJwb2ludGVyIjsKICAgICAgZWxzZSBsKCJzZWN0aW9uTGVmdCIpLnN0eWxlLmN1cnNvciA9ICJhdXRvIjsKICAgICAgR2FtZS5tb3VzZVBvaW50ZXIgPSAwOwoKICAgICAgLy9oYW5kbGUgbWlsayBhbmQgbWlsayBhY2Nlc3NvcmllcwogICAgICBHYW1lLm1pbGtQcm9ncmVzcyA9IEdhbWUuQWNoaWV2ZW1lbnRzT3duZWQgLyAyNTsKICAgICAgaWYgKEdhbWUubWlsa1Byb2dyZXNzID49IDAuNSkgR2FtZS5VbmxvY2soIktpdHRlbiBoZWxwZXJzIik7CiAgICAgIGlmIChHYW1lLm1pbGtQcm9ncmVzcyA+PSAxKSBHYW1lLlVubG9jaygiS2l0dGVuIHdvcmtlcnMiKTsKICAgICAgaWYgKEdhbWUubWlsa1Byb2dyZXNzID49IDIpIEdhbWUuVW5sb2NrKCJLaXR0ZW4gZW5naW5lZXJzIik7CiAgICAgIGlmIChHYW1lLm1pbGtQcm9ncmVzcyA+PSAzKSBHYW1lLlVubG9jaygiS2l0dGVuIG92ZXJzZWVycyIpOwogICAgICBpZiAoR2FtZS5taWxrUHJvZ3Jlc3MgPj0gNCkgR2FtZS5VbmxvY2soIktpdHRlbiBtYW5hZ2VycyIpOwogICAgICBpZiAoR2FtZS5taWxrUHJvZ3Jlc3MgPj0gNSkgR2FtZS5VbmxvY2soIktpdHRlbiBhY2NvdW50YW50cyIpOwogICAgICBpZiAoR2FtZS5taWxrUHJvZ3Jlc3MgPj0gNikgR2FtZS5VbmxvY2soIktpdHRlbiBzcGVjaWFsaXN0cyIpOwogICAgICBpZiAoR2FtZS5taWxrUHJvZ3Jlc3MgPj0gNykgR2FtZS5VbmxvY2soIktpdHRlbiBleHBlcnRzIik7CiAgICAgIGlmIChHYW1lLm1pbGtQcm9ncmVzcyA+PSA4KSBHYW1lLlVubG9jaygiS2l0dGVuIGNvbnN1bHRhbnRzIik7CiAgICAgIGlmIChHYW1lLm1pbGtQcm9ncmVzcyA+PSA5KQogICAgICAgIEdhbWUuVW5sb2NrKCJLaXR0ZW4gYXNzaXN0YW50cyB0byB0aGUgcmVnaW9uYWwgbWFuYWdlciIpOwogICAgICBpZiAoR2FtZS5taWxrUHJvZ3Jlc3MgPj0gMTApIEdhbWUuVW5sb2NrKCJLaXR0ZW4gbWFya2V0ZWVycyIpOwogICAgICBpZiAoR2FtZS5taWxrUHJvZ3Jlc3MgPj0gMTEpIEdhbWUuVW5sb2NrKCJLaXR0ZW4gYW5hbHlzdHMiKTsKICAgICAgaWYgKEdhbWUubWlsa1Byb2dyZXNzID49IDEyKSBHYW1lLlVubG9jaygiS2l0dGVuIGV4ZWN1dGl2ZXMiKTsKICAgICAgaWYgKEdhbWUubWlsa1Byb2dyZXNzID49IDEzKSBHYW1lLlVubG9jaygiS2l0dGVuIGFkbWlucyIpOwogICAgICBHYW1lLm1pbGtIID0gTWF0aC5taW4oMSwgR2FtZS5taWxrUHJvZ3Jlc3MpICogMC4zNTsKICAgICAgR2FtZS5taWxrSGQgKz0gKEdhbWUubWlsa0ggLSBHYW1lLm1pbGtIZCkgKiAwLjAyOwoKICAgICAgR2FtZS5NaWxrID0KICAgICAgICBHYW1lLk1pbGtzWwogICAgICAgICAgTWF0aC5taW4oTWF0aC5mbG9vcihHYW1lLm1pbGtQcm9ncmVzcyksIEdhbWUuTWlsa3MubGVuZ3RoIC0gMSkKICAgICAgICBdOwoKICAgICAgaWYgKEdhbWUuYXV0b2NsaWNrZXJEZXRlY3RlZCA+IDApIEdhbWUuYXV0b2NsaWNrZXJEZXRlY3RlZC0tOwoKICAgICAgLy9oYW5kbGUgcmVzZWFyY2gKICAgICAgaWYgKEdhbWUucmVzZWFyY2hUID4gMCkgewogICAgICAgIEdhbWUucmVzZWFyY2hULS07CiAgICAgIH0KICAgICAgaWYgKEdhbWUucmVzZWFyY2hUID09IDAgJiYgR2FtZS5uZXh0UmVzZWFyY2gpIHsKICAgICAgICBpZiAoIUdhbWUuSGFzKEdhbWUuVXBncmFkZXNCeUlkW0dhbWUubmV4dFJlc2VhcmNoXS5uYW1lKSkgewogICAgICAgICAgR2FtZS5VbmxvY2soR2FtZS5VcGdyYWRlc0J5SWRbR2FtZS5uZXh0UmVzZWFyY2hdLm5hbWUpOwogICAgICAgICAgR2FtZS5Ob3RpZnkoCiAgICAgICAgICAgIGxvYygiUmVzZWFyY2ggY29tcGxldGUiKSwKICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICJZb3UgaGF2ZSBkaXNjb3ZlcmVkOiA8Yj4lMTwvYj4uIiwKICAgICAgICAgICAgICBHYW1lLlVwZ3JhZGVzQnlJZFtHYW1lLm5leHRSZXNlYXJjaF0uZG5hbWUKICAgICAgICAgICAgKSwKICAgICAgICAgICAgR2FtZS5VcGdyYWRlc0J5SWRbR2FtZS5uZXh0UmVzZWFyY2hdLmljb24KICAgICAgICAgICk7CiAgICAgICAgfQogICAgICAgIEdhbWUubmV4dFJlc2VhcmNoID0gMDsKICAgICAgICBHYW1lLnJlc2VhcmNoVCA9IC0xOwogICAgICAgIEdhbWUucmVjYWxjdWxhdGVHYWlucyA9IDE7CiAgICAgIH0KICAgICAgLy9oYW5kbGUgc2Vhc29ucwogICAgICBpZiAoR2FtZS5zZWFzb25UID4gMCkgewogICAgICAgIEdhbWUuc2Vhc29uVC0tOwogICAgICB9CiAgICAgIGlmICgKICAgICAgICBHYW1lLnNlYXNvblQgPD0gMCAmJgogICAgICAgIEdhbWUuc2Vhc29uICE9ICIiICYmCiAgICAgICAgR2FtZS5zZWFzb24gIT0gR2FtZS5iYXNlU2Vhc29uICYmCiAgICAgICAgIUdhbWUuSGFzKCJFdGVybmFsIHNlYXNvbnMiKQogICAgICApIHsKICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgIEdhbWUuc2Vhc29uc1tHYW1lLnNlYXNvbl0ub3ZlciwKICAgICAgICAgICIiLAogICAgICAgICAgR2FtZS5zZWFzb25zW0dhbWUuc2Vhc29uXS50cmlnZ2VyVXBncmFkZS5pY29uCiAgICAgICAgKTsKICAgICAgICBpZiAoR2FtZS5IYXMoIlNlYXNvbiBzd2l0Y2hlciIpKSB7CiAgICAgICAgICBHYW1lLlVubG9jayhHYW1lLnNlYXNvbnNbR2FtZS5zZWFzb25dLnRyaWdnZXIpOwogICAgICAgICAgR2FtZS5zZWFzb25zW0dhbWUuc2Vhc29uXS50cmlnZ2VyVXBncmFkZS5ib3VnaHQgPSAwOwogICAgICAgIH0KICAgICAgICBHYW1lLnNlYXNvbiA9IEdhbWUuYmFzZVNlYXNvbjsKICAgICAgICBHYW1lLnNlYXNvblQgPSAtMTsKICAgICAgfQoKICAgICAgLy9wcmVzcyBjdHJsIHRvIGJ1bGstYnV5IDEwLCBzaGlmdCB0byBidWxrLWJ1eSAxMDAKICAgICAgaWYgKCFHYW1lLnByb21wdE9uKSB7CiAgICAgICAgaWYgKChHYW1lLmtleXNbMTZdIHx8IEdhbWUua2V5c1sxN10pICYmICFHYW1lLmJ1eUJ1bGtTaG9ydGN1dCkgewogICAgICAgICAgR2FtZS5idXlCdWxrT2xkID0gR2FtZS5idXlCdWxrOwogICAgICAgICAgaWYgKEdhbWUua2V5c1sxNl0pIEdhbWUuYnV5QnVsayA9IDEwMDsKICAgICAgICAgIGlmIChHYW1lLmtleXNbMTddKSBHYW1lLmJ1eUJ1bGsgPSAxMDsKICAgICAgICAgIEdhbWUuYnV5QnVsa1Nob3J0Y3V0ID0gMTsKICAgICAgICAgIEdhbWUuc3RvcmVCdWxrQnV0dG9uKC0xKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKCFHYW1lLmtleXNbMTZdICYmICFHYW1lLmtleXNbMTddICYmIEdhbWUuYnV5QnVsa1Nob3J0Y3V0KSB7CiAgICAgICAgLy9yZWxlYXNlCiAgICAgICAgR2FtZS5idXlCdWxrID0gR2FtZS5idXlCdWxrT2xkOwogICAgICAgIEdhbWUuYnV5QnVsa1Nob3J0Y3V0ID0gMDsKICAgICAgICBHYW1lLnN0b3JlQnVsa0J1dHRvbigtMSk7CiAgICAgIH0KCiAgICAgIC8vaGFuZGxlIGNvb2tpZXMKICAgICAgaWYgKEdhbWUucmVjYWxjdWxhdGVHYWlucykgR2FtZS5DYWxjdWxhdGVHYWlucygpOwogICAgICBHYW1lLkVhcm4oR2FtZS5jb29raWVzUHMgLyBHYW1lLmZwcyk7IC8vYWRkIGNvb2tpZXMgcGVyIHNlY29uZAoKICAgICAgLy9ncm93IGx1bXBzCiAgICAgIEdhbWUuZG9MdW1wcygpOwoKICAgICAgLy9taW5pZ2FtZXMKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICB2YXIgbWUgPSBHYW1lLk9iamVjdHNbaV07CiAgICAgICAgaWYgKAogICAgICAgICAgR2FtZS5pc01pbmlnYW1lUmVhZHkobWUpICYmCiAgICAgICAgICBtZS5taW5pZ2FtZS5sb2dpYyAmJgogICAgICAgICAgR2FtZS5hc2NlbnNpb25Nb2RlICE9IDEKICAgICAgICApCiAgICAgICAgICBtZS5taW5pZ2FtZS5sb2dpYygpOwogICAgICB9CgogICAgICBpZiAoR2FtZS5zcGVjaWFsVGFiICE9ICIiICYmIEdhbWUuVCAlIChHYW1lLmZwcyAqIDMpID09IDApCiAgICAgICAgR2FtZS5Ub2dnbGVTcGVjaWFsTWVudSgxKTsKCiAgICAgIC8vd3JpbmtsZXJzCiAgICAgIGlmIChHYW1lLmNwc1N1Y2tlZCA+IDApIHsKICAgICAgICBHYW1lLkRpc3NvbHZlKChHYW1lLmNvb2tpZXNQcyAvIEdhbWUuZnBzKSAqIEdhbWUuY3BzU3Vja2VkKTsKICAgICAgICBHYW1lLmNvb2tpZXNTdWNrZWQgKz0gKEdhbWUuY29va2llc1BzIC8gR2FtZS5mcHMpICogR2FtZS5jcHNTdWNrZWQ7CiAgICAgICAgLy9zaG91bGQgYmUgdXNpbmcgb25lIG9mIHRoZSBmb2xsb3dpbmcsIGJ1dCBJJ20gbm90IHN1cmUgd2hhdCBJJ20gdXNpbmcgdGhpcyBzdGF0IGZvciBhbnltb3JlCiAgICAgICAgLy9HYW1lLmNvb2tpZXNTdWNrZWQ9R2FtZS53cmlua2xlcnMucmVkdWNlKGZ1bmN0aW9uKHMsdyl7cmV0dXJuIHMrdy5zdWNrZWQ7fSwwKTsKICAgICAgICAvL2ZvciAodmFyIGkgaW4gR2FtZS53cmlua2xlcnMpIHtHYW1lLmNvb2tpZXNTdWNrZWQrPUdhbWUud3JpbmtsZXJzW2ldLnN1Y2tlZDt9CiAgICAgIH0KCiAgICAgIC8vdmFyIGNwcz1HYW1lLmNvb2tpZXNQcytHYW1lLmNvb2tpZXMqMC4wMTsvL2V4cG9uZW50aWFsIGNvb2tpZXMKICAgICAgLy9HYW1lLkVhcm4oY3BzL0dhbWUuZnBzKTsvL2FkZCBjb29raWVzIHBlciBzZWNvbmQKCiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5PYmplY3RzW2ldOwogICAgICAgIG1lLnRvdGFsQ29va2llcyArPSAobWUuc3RvcmVkVG90YWxDcHMgKiBHYW1lLmdsb2JhbENwc011bHQpIC8gR2FtZS5mcHM7CiAgICAgIH0KICAgICAgaWYgKAogICAgICAgIEdhbWUucHJlZnMucGFydGljbGVzICYmCiAgICAgICAgR2FtZS5jb29raWVzICYmCiAgICAgICAgR2FtZS5UICUgTWF0aC5jZWlsKEdhbWUuZnBzIC8gTWF0aC5taW4oMTAsIEdhbWUuY29va2llc1BzKSkgPT0gMAogICAgICApCiAgICAgICAgR2FtZS5wYXJ0aWNsZUFkZCgpOyAvL2Nvb2tpZSBzaG93ZXIKCiAgICAgIGlmIChHYW1lLlQgJSAoR2FtZS5mcHMgKiAxMCkgPT0gMCkgR2FtZS5yZWNhbGN1bGF0ZUdhaW5zID0gMTsgLy9yZWNhbGN1bGF0ZSBDcFMgZXZlcnkgMTAgc2Vjb25kcyAoZm9yIGR5bmFtaWMgYm9vc3RzIHN1Y2ggYXMgQ2VudHVyeSBlZ2cpCgogICAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCQkJVU5MT0NLSU5HIFNUVUZGCgkJCT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCiAgICAgIGlmIChHYW1lLlQgJSBHYW1lLmZwcyA9PSAwICYmIE1hdGgucmFuZG9tKCkgPCAxIC8gMTAwMDAwMCkKICAgICAgICBHYW1lLldpbigiSnVzdCBwbGFpbiBsdWNreSIpOyAvLzEgY2hhbmNlIGluIDEsMDAwLDAwMCBldmVyeSBzZWNvbmQgYWNoaWV2ZW1lbnQKICAgICAgaWYgKEdhbWUuVCAlIChHYW1lLmZwcyAqIDUpID09IDAgJiYgR2FtZS5PYmplY3RzQnlJZC5sZW5ndGggPiAwKSB7CiAgICAgICAgLy9jaGVjayBzb21lIGFjaGlldmVtZW50cyBhbmQgdXBncmFkZXMKICAgICAgICBpZiAoaXNOYU4oR2FtZS5jb29raWVzKSkgewogICAgICAgICAgR2FtZS5jb29raWVzID0gMDsKICAgICAgICAgIEdhbWUuY29va2llc0Vhcm5lZCA9IDA7CiAgICAgICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICAgIH0KCiAgICAgICAgdmFyIHRpbWVQbGF5ZWQgPSBuZXcgRGF0ZSgpOwogICAgICAgIHRpbWVQbGF5ZWQuc2V0VGltZShEYXRlLm5vdygpIC0gR2FtZS5zdGFydERhdGUpOwoKICAgICAgICBpZiAoCiAgICAgICAgICAhR2FtZS5mdWxsRGF0ZSB8fAogICAgICAgICAgRGF0ZS5ub3coKSAtIEdhbWUuZnVsbERhdGUgPj0gMzY1ICogMjQgKiA2MCAqIDYwICogMTAwMAogICAgICAgICkKICAgICAgICAgIEdhbWUuV2luKCJTbyBtdWNoIHRvIGRvIHNvIG11Y2ggdG8gc2VlIik7CgogICAgICAgIGlmICgKICAgICAgICAgIEdhbWUuY29va2llc0Vhcm5lZCA+PSAxMDAwMDAwICYmCiAgICAgICAgICAoR2FtZS5hc2NlbnNpb25Nb2RlID09IDEgfHwgR2FtZS5yZXNldHMgPT0gMCkKICAgICAgICApIHsKICAgICAgICAgIC8vY2hhbGxlbmdlIHJ1biBvciBoYXNuJ3QgYXNjZW5kZWQgeWV0CiAgICAgICAgICBpZiAodGltZVBsYXllZCA8PSAxMDAwICogNjAgKiAzNSkgR2FtZS5XaW4oIlNwZWVkIGJha2luZyBJIik7CiAgICAgICAgICBpZiAodGltZVBsYXllZCA8PSAxMDAwICogNjAgKiAyNSkgR2FtZS5XaW4oIlNwZWVkIGJha2luZyBJSSIpOwogICAgICAgICAgaWYgKHRpbWVQbGF5ZWQgPD0gMTAwMCAqIDYwICogMTUpIEdhbWUuV2luKCJTcGVlZCBiYWtpbmcgSUlJIik7CgogICAgICAgICAgaWYgKEdhbWUuY29va2llQ2xpY2tzIDw9IDE1KSBHYW1lLldpbigiTmV2ZXJjbGljayIpOwogICAgICAgICAgaWYgKEdhbWUuY29va2llQ2xpY2tzIDw9IDApIEdhbWUuV2luKCJUcnVlIE5ldmVyY2xpY2siKTsKICAgICAgICAgIGlmIChHYW1lLmNvb2tpZXNFYXJuZWQgPj0gMTAwMDAwMDAwMCAmJiBHYW1lLlVwZ3JhZGVzT3duZWQgPT0gMCkKICAgICAgICAgICAgR2FtZS5XaW4oIkhhcmRjb3JlIik7CiAgICAgICAgfQoKICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuVW5sb2NrQXQpIHsKICAgICAgICAgIHZhciB1bmxvY2sgPSBHYW1lLlVubG9ja0F0W2ldOwogICAgICAgICAgaWYgKEdhbWUuY29va2llc0Vhcm5lZCA+PSB1bmxvY2suY29va2llcykgewogICAgICAgICAgICB2YXIgcGFzcyA9IDE7CiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICB1bmxvY2sucmVxdWlyZSAmJgogICAgICAgICAgICAgICFHYW1lLkhhcyh1bmxvY2sucmVxdWlyZSkgJiYKICAgICAgICAgICAgICAhR2FtZS5IYXNBY2hpZXYodW5sb2NrLnJlcXVpcmUpCiAgICAgICAgICAgICkKICAgICAgICAgICAgICBwYXNzID0gMDsKICAgICAgICAgICAgaWYgKHVubG9jay5zZWFzb24gJiYgR2FtZS5zZWFzb24gIT0gdW5sb2NrLnNlYXNvbikgcGFzcyA9IDA7CiAgICAgICAgICAgIGlmIChwYXNzKSB7CiAgICAgICAgICAgICAgR2FtZS5VbmxvY2sodW5sb2NrLm5hbWUpOwogICAgICAgICAgICAgIEdhbWUuV2luKHVubG9jay5uYW1lKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKEdhbWUuSGFzKCJHb2xkZW4gc3dpdGNoIikpIEdhbWUuVW5sb2NrKCJHb2xkZW4gc3dpdGNoIFtvZmZdIik7CiAgICAgICAgaWYgKAogICAgICAgICAgR2FtZS5IYXMoIlNoaW1tZXJpbmcgdmVpbCIpICYmCiAgICAgICAgICAhR2FtZS5IYXMoIlNoaW1tZXJpbmcgdmVpbCBbb2ZmXSIpICYmCiAgICAgICAgICAhR2FtZS5IYXMoIlNoaW1tZXJpbmcgdmVpbCBbb25dIikKICAgICAgICApIHsKICAgICAgICAgIEdhbWUuVW5sb2NrKCJTaGltbWVyaW5nIHZlaWwgW29uXSIpOwogICAgICAgICAgR2FtZS5VcGdyYWRlc1siU2hpbW1lcmluZyB2ZWlsIFtvZmZdIl0uZWFybigpOwogICAgICAgIH0KICAgICAgICBpZiAoR2FtZS5IYXMoIlN1Z2FyIGNyYXZpbmciKSkgR2FtZS5VbmxvY2soIlN1Z2FyIGZyZW56eSIpOwogICAgICAgIGlmIChHYW1lLkhhcygiQ2xhc3NpYyBkYWlyeSBzZWxlY3Rpb24iKSkgR2FtZS5VbmxvY2soIk1pbGsgc2VsZWN0b3IiKTsKICAgICAgICBpZiAoR2FtZS5IYXMoIkJhc2ljIHdhbGxwYXBlciBhc3NvcnRtZW50IikpCiAgICAgICAgICBHYW1lLlVubG9jaygiQmFja2dyb3VuZCBzZWxlY3RvciIpOwogICAgICAgIGlmIChHYW1lLkhhcygiR29sZGVuIGNvb2tpZSBhbGVydCBzb3VuZCIpKQogICAgICAgICAgR2FtZS5VbmxvY2soIkdvbGRlbiBjb29raWUgc291bmQgc2VsZWN0b3IiKTsKICAgICAgICBpZiAoR2FtZS5IYXMoIlNvdW5kIHRlc3QiKSkgR2FtZS5VbmxvY2soIkp1a2Vib3giKTsKCiAgICAgICAgaWYgKEdhbWUuSGFzKCJQcmlzbSBoZWFydCBiaXNjdWl0cyIpKSBHYW1lLldpbigiTG92ZWx5IGNvb2tpZXMiKTsKICAgICAgICBpZiAoR2FtZS5zZWFzb24gPT0gImVhc3RlciIpIHsKICAgICAgICAgIHZhciBlZ2dzID0gMDsKICAgICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5lYXN0ZXJFZ2dzKSB7CiAgICAgICAgICAgIGlmIChHYW1lLkhhc1VubG9ja2VkKEdhbWUuZWFzdGVyRWdnc1tpXSkpIGVnZ3MrKzsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChlZ2dzID49IDEpIEdhbWUuV2luKCJUaGUgaHVudCBpcyBvbiIpOwogICAgICAgICAgaWYgKGVnZ3MgPj0gNykgR2FtZS5XaW4oIkVnZ2luZyBvbiIpOwogICAgICAgICAgaWYgKGVnZ3MgPj0gMTQpIEdhbWUuV2luKCJNYXNzIEVhc3RlcmlhIik7CiAgICAgICAgICBpZiAoZWdncyA+PSBHYW1lLmVhc3RlckVnZ3MubGVuZ3RoKSBHYW1lLldpbigiSGlkZSAmIHNlZWsgY2hhbXBpb24iKTsKICAgICAgICB9CgogICAgICAgIGlmIChHYW1lLkhhcygiRm9ydHVuZSBjb29raWVzIikpIHsKICAgICAgICAgIHZhciBsaXN0ID0gR2FtZS5UaWVyc1siZm9ydHVuZSJdLnVwZ3JhZGVzOwogICAgICAgICAgdmFyIGZvcnR1bmVzID0gMDsKICAgICAgICAgIGZvciAodmFyIGkgaW4gbGlzdCkgewogICAgICAgICAgICBpZiAoR2FtZS5IYXMobGlzdFtpXS5uYW1lKSkgZm9ydHVuZXMrKzsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChmb3J0dW5lcyA+PSBsaXN0Lmxlbmd0aCkgR2FtZS5XaW4oIk8gRm9ydHVuYSIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKEdhbWUuSGFzKCJMZWdhY3kiKSAmJiBHYW1lLmFzY2Vuc2lvbk1vZGUgIT0gMSkgewogICAgICAgICAgR2FtZS5VbmxvY2soIkhlYXZlbmx5IGNoaXAgc2VjcmV0Iik7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIkhlYXZlbmx5IGNoaXAgc2VjcmV0IikpCiAgICAgICAgICAgIEdhbWUuVW5sb2NrKCJIZWF2ZW5seSBjb29raWUgc3RhbmQiKTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiSGVhdmVubHkgY29va2llIHN0YW5kIikpIEdhbWUuVW5sb2NrKCJIZWF2ZW5seSBiYWtlcnkiKTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiSGVhdmVubHkgYmFrZXJ5IikpCiAgICAgICAgICAgIEdhbWUuVW5sb2NrKCJIZWF2ZW5seSBjb25mZWN0aW9uZXJ5Iik7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIkhlYXZlbmx5IGNvbmZlY3Rpb25lcnkiKSkgR2FtZS5VbmxvY2soIkhlYXZlbmx5IGtleSIpOwoKICAgICAgICAgIGlmIChHYW1lLkhhcygiSGVhdmVubHkga2V5IikpIEdhbWUuV2luKCJXaG9sZXNvbWUiKTsKICAgICAgICB9CgogICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5CYW5rQWNoaWV2ZW1lbnRzKSB7CiAgICAgICAgICBpZiAoR2FtZS5jb29raWVzRWFybmVkID49IEdhbWUuQmFua0FjaGlldmVtZW50c1tpXS50aHJlc2hvbGQpCiAgICAgICAgICAgIEdhbWUuV2luKEdhbWUuQmFua0FjaGlldmVtZW50c1tpXS5uYW1lKTsKICAgICAgICB9CgogICAgICAgIHZhciBidWlsZGluZ3NPd25lZCA9IDA7CiAgICAgICAgdmFyIG1hdGhlbWF0aWNpYW4gPSAxOwogICAgICAgIHZhciBiYXNlMTAgPSAxOwogICAgICAgIHZhciBtaW5BbW91bnQgPSAxMDAwMDA7CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICAgIGJ1aWxkaW5nc093bmVkICs9IEdhbWUuT2JqZWN0c1tpXS5hbW91bnQ7CiAgICAgICAgICBtaW5BbW91bnQgPSBNYXRoLm1pbihHYW1lLk9iamVjdHNbaV0uYW1vdW50LCBtaW5BbW91bnQpOwogICAgICAgICAgaWYgKCFHYW1lLkhhc0FjaGlldigiTWF0aGVtYXRpY2lhbiIpKSB7CiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICBHYW1lLk9iamVjdHNbaV0uYW1vdW50IDwKICAgICAgICAgICAgICBNYXRoLm1pbigKICAgICAgICAgICAgICAgIDEyOCwKICAgICAgICAgICAgICAgIE1hdGgucG93KDIsIEdhbWUuT2JqZWN0c0J5SWQubGVuZ3RoIC0gR2FtZS5PYmplY3RzW2ldLmlkIC0gMSkKICAgICAgICAgICAgICApCiAgICAgICAgICAgICkKICAgICAgICAgICAgICBtYXRoZW1hdGljaWFuID0gMDsKICAgICAgICAgIH0KICAgICAgICAgIGlmICghR2FtZS5IYXNBY2hpZXYoIkJhc2UgMTAiKSkgewogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgR2FtZS5PYmplY3RzW2ldLmFtb3VudCA8CiAgICAgICAgICAgICAgKEdhbWUuT2JqZWN0c0J5SWQubGVuZ3RoIC0gR2FtZS5PYmplY3RzW2ldLmlkKSAqIDEwCiAgICAgICAgICAgICkKICAgICAgICAgICAgICBiYXNlMTAgPSAwOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAobWluQW1vdW50ID49IDEpIEdhbWUuV2luKCJPbmUgd2l0aCBldmVyeXRoaW5nIik7CiAgICAgICAgaWYgKG1hdGhlbWF0aWNpYW4gPT0gMSkgR2FtZS5XaW4oIk1hdGhlbWF0aWNpYW4iKTsKICAgICAgICBpZiAoYmFzZTEwID09IDEpIEdhbWUuV2luKCJCYXNlIDEwIik7CiAgICAgICAgaWYgKG1pbkFtb3VudCA+PSAxMDApIHsKICAgICAgICAgIEdhbWUuV2luKCJDZW50ZW5uaWFsIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiTWlsayBjaG9jb2xhdGUgYnV0dGVyIGJpc2N1aXQiKTsKICAgICAgICB9CiAgICAgICAgaWYgKG1pbkFtb3VudCA+PSAxNTApIHsKICAgICAgICAgIEdhbWUuV2luKCJDZW50ZW5uaWFsIGFuZCBhIGhhbGYiKTsKICAgICAgICAgIEdhbWUuVW5sb2NrKCJEYXJrIGNob2NvbGF0ZSBidXR0ZXIgYmlzY3VpdCIpOwogICAgICAgIH0KICAgICAgICBpZiAobWluQW1vdW50ID49IDIwMCkgewogICAgICAgICAgR2FtZS5XaW4oIkJpY2VudGVubmlhbCIpOwogICAgICAgICAgR2FtZS5VbmxvY2soIldoaXRlIGNob2NvbGF0ZSBidXR0ZXIgYmlzY3VpdCIpOwogICAgICAgIH0KICAgICAgICBpZiAobWluQW1vdW50ID49IDI1MCkgewogICAgICAgICAgR2FtZS5XaW4oIkJpY2VudGVubmlhbCBhbmQgYSBoYWxmIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiUnVieSBjaG9jb2xhdGUgYnV0dGVyIGJpc2N1aXQiKTsKICAgICAgICB9CiAgICAgICAgaWYgKG1pbkFtb3VudCA+PSAzMDApIHsKICAgICAgICAgIEdhbWUuV2luKCJUcmljZW50ZW5uaWFsIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiTGF2ZW5kZXIgY2hvY29sYXRlIGJ1dHRlciBiaXNjdWl0Iik7CiAgICAgICAgfQogICAgICAgIGlmIChtaW5BbW91bnQgPj0gMzUwKSB7CiAgICAgICAgICBHYW1lLldpbigiVHJpY2VudGVubmlhbCBhbmQgYSBoYWxmIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiU3ludGhldGljIGNob2NvbGF0ZSBncmVlbiBob25leSBidXR0ZXIgYmlzY3VpdCIpOwogICAgICAgIH0KICAgICAgICBpZiAobWluQW1vdW50ID49IDQwMCkgewogICAgICAgICAgR2FtZS5XaW4oIlF1YWRyaWNlbnRlbm5pYWwiKTsKICAgICAgICAgIEdhbWUuVW5sb2NrKCJSb3lhbCByYXNwYmVycnkgY2hvY29sYXRlIGJ1dHRlciBiaXNjdWl0Iik7CiAgICAgICAgfQogICAgICAgIGlmIChtaW5BbW91bnQgPj0gNDUwKSB7CiAgICAgICAgICBHYW1lLldpbigiUXVhZHJpY2VudGVubmlhbCBhbmQgYSBoYWxmIik7CiAgICAgICAgICBHYW1lLlVubG9jaygKICAgICAgICAgICAgIlVsdHJhLWNvbmNlbnRyYXRlZCBoaWdoLWVuZXJneSBjaG9jb2xhdGUgYnV0dGVyIGJpc2N1aXQiCiAgICAgICAgICApOwogICAgICAgIH0KICAgICAgICBpZiAobWluQW1vdW50ID49IDUwMCkgewogICAgICAgICAgR2FtZS5XaW4oIlF1aW5jZW50ZW5uaWFsIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiUHVyZSBwaXRjaC1ibGFjayBjaG9jb2xhdGUgYnV0dGVyIGJpc2N1aXQiKTsKICAgICAgICB9CiAgICAgICAgaWYgKG1pbkFtb3VudCA+PSA1NTApIHsKICAgICAgICAgIEdhbWUuV2luKCJRdWluY2VudGVubmlhbCBhbmQgYSBoYWxmIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiQ29zbWljIGNob2NvbGF0ZSBidXR0ZXIgYmlzY3VpdCIpOwogICAgICAgIH0KICAgICAgICBpZiAobWluQW1vdW50ID49IDYwMCkgewogICAgICAgICAgR2FtZS5XaW4oIlNleGNlbnRlbm5pYWwiKTsKICAgICAgICAgIEdhbWUuVW5sb2NrKCJCdXR0ZXIgYmlzY3VpdCAod2l0aCBidXR0ZXIpIik7CiAgICAgICAgfQogICAgICAgIGlmIChtaW5BbW91bnQgPj0gNjUwKSB7CiAgICAgICAgICBHYW1lLldpbigiU2V4Y2VudGVubmlhbCBhbmQgYSBoYWxmIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiRXZlcnlidXR0ZXIgYmlzY3VpdCIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKEdhbWUuaGFuZG1hZGVDb29raWVzID49IDEwMDApIHsKICAgICAgICAgIEdhbWUuV2luKCJDbGlja3Rhc3RpYyIpOwogICAgICAgICAgR2FtZS5VbmxvY2soIlBsYXN0aWMgbW91c2UiKTsKICAgICAgICB9CiAgICAgICAgaWYgKEdhbWUuaGFuZG1hZGVDb29raWVzID49IDEwMDAwMCkgewogICAgICAgICAgR2FtZS5XaW4oIkNsaWNrYXRobG9uIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiSXJvbiBtb3VzZSIpOwogICAgICAgIH0KICAgICAgICBpZiAoR2FtZS5oYW5kbWFkZUNvb2tpZXMgPj0gMTAwMDAwMDApIHsKICAgICAgICAgIEdhbWUuV2luKCJDbGlja29seW1waWNzIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiVGl0YW5pdW0gbW91c2UiKTsKICAgICAgICB9CiAgICAgICAgaWYgKEdhbWUuaGFuZG1hZGVDb29raWVzID49IDEwMDAwMDAwMDApIHsKICAgICAgICAgIEdhbWUuV2luKCJDbGlja29yYW1hIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiQWRhbWFudGl1bSBtb3VzZSIpOwogICAgICAgIH0KICAgICAgICBpZiAoR2FtZS5oYW5kbWFkZUNvb2tpZXMgPj0gMTAwMDAwMDAwMDAwKSB7CiAgICAgICAgICBHYW1lLldpbigiQ2xpY2thc21pYyIpOwogICAgICAgICAgR2FtZS5VbmxvY2soIlVub2J0YWluaXVtIG1vdXNlIik7CiAgICAgICAgfQogICAgICAgIGlmIChHYW1lLmhhbmRtYWRlQ29va2llcyA+PSAxMDAwMDAwMDAwMDAwMCkgewogICAgICAgICAgR2FtZS5XaW4oIkNsaWNrYWdlZGRvbiIpOwogICAgICAgICAgR2FtZS5VbmxvY2soIkVsdWRpdW0gbW91c2UiKTsKICAgICAgICB9CiAgICAgICAgaWYgKEdhbWUuaGFuZG1hZGVDb29raWVzID49IDEwMDAwMDAwMDAwMDAwMDApIHsKICAgICAgICAgIEdhbWUuV2luKCJDbGlja25hcm9rIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiV2lzaGFsbG95IG1vdXNlIik7CiAgICAgICAgfQogICAgICAgIGlmIChHYW1lLmhhbmRtYWRlQ29va2llcyA+PSAxMDAwMDAwMDAwMDAwMDAwMDApIHsKICAgICAgICAgIEdhbWUuV2luKCJDbGlja2FzdHJvcGhlIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiRmFudGFzdGVlbCBtb3VzZSIpOwogICAgICAgIH0KICAgICAgICBpZiAoR2FtZS5oYW5kbWFkZUNvb2tpZXMgPj0gMTAwMDAwMDAwMDAwMDAwMDAwMDApIHsKICAgICAgICAgIEdhbWUuV2luKCJDbGlja2F0YWNseXNtIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiTmV2ZXJjcmFjayBtb3VzZSIpOwogICAgICAgIH0KICAgICAgICBpZiAoR2FtZS5oYW5kbWFkZUNvb2tpZXMgPj0gMTAwMDAwMDAwMDAwMDAwMDAwMDAwMCkgewogICAgICAgICAgR2FtZS5XaW4oIlRoZSB1bHRpbWF0ZSBjbGlja2Rvd24iKTsKICAgICAgICAgIEdhbWUuVW5sb2NrKCJBcm15dGhyaWwgbW91c2UiKTsKICAgICAgICB9CiAgICAgICAgaWYgKEdhbWUuaGFuZG1hZGVDb29raWVzID49IDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCkgewogICAgICAgICAgR2FtZS5XaW4oIkFsbCB0aGUgb3RoZXIga2lkcyB3aXRoIHRoZSBwdW1wZWQgdXAgY2xpY2tzIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiVGVjaG5vYnNpZGlhbiBtb3VzZSIpOwogICAgICAgIH0KICAgICAgICBpZiAoR2FtZS5oYW5kbWFkZUNvb2tpZXMgPj0gMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDApIHsKICAgICAgICAgIEdhbWUuV2luKCJPbmUuLi5tb3JlLi4uY2xpY2suLi4iKTsKICAgICAgICAgIEdhbWUuVW5sb2NrKCJQbGFzbWFyYmxlIG1vdXNlIik7CiAgICAgICAgfQogICAgICAgIGlmIChHYW1lLmhhbmRtYWRlQ29va2llcyA+PSAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwKSB7CiAgICAgICAgICBHYW1lLldpbigiQ2xpY2tldHkgc3BsaXQiKTsKICAgICAgICAgIEdhbWUuVW5sb2NrKCJNaXJhY3VsaXRlIG1vdXNlIik7CiAgICAgICAgfQogICAgICAgIGlmIChHYW1lLmhhbmRtYWRlQ29va2llcyA+PSAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDApIHsKICAgICAgICAgIEdhbWUuV2luKCJBaW4ndCB0aGF0IGEgY2xpY2sgaW4gdGhlIGhlYWQiKTsKICAgICAgICAgIEdhbWUuVW5sb2NrKCJBZXRoZXJpY2UgbW91c2UiKTsKICAgICAgICB9CgogICAgICAgIGlmIChHYW1lLmNvb2tpZXNFYXJuZWQgPCBHYW1lLmNvb2tpZXMpCiAgICAgICAgICBHYW1lLldpbigiQ2hlYXRlZCBjb29raWVzIHRhc3RlIGF3ZnVsIik7CgogICAgICAgIGlmICgKICAgICAgICAgIEdhbWUuSGFzKCJTa3VsbCBjb29raWVzIikgJiYKICAgICAgICAgIEdhbWUuSGFzKCJHaG9zdCBjb29raWVzIikgJiYKICAgICAgICAgIEdhbWUuSGFzKCJCYXQgY29va2llcyIpICYmCiAgICAgICAgICBHYW1lLkhhcygiU2xpbWUgY29va2llcyIpICYmCiAgICAgICAgICBHYW1lLkhhcygiUHVtcGtpbiBjb29raWVzIikgJiYKICAgICAgICAgIEdhbWUuSGFzKCJFeWViYWxsIGNvb2tpZXMiKSAmJgogICAgICAgICAgR2FtZS5IYXMoIlNwaWRlciBjb29raWVzIikKICAgICAgICApCiAgICAgICAgICBHYW1lLldpbigiU3Bvb2t5IGNvb2tpZXMiKTsKICAgICAgICBpZiAoR2FtZS53cmlua2xlcnNQb3BwZWQgPj0gMSkgR2FtZS5XaW4oIkl0Y2hzY3JhdGNoZXIiKTsKICAgICAgICBpZiAoR2FtZS53cmlua2xlcnNQb3BwZWQgPj0gNTApIEdhbWUuV2luKCJXcmlua2xlc3F1aXNoZXIiKTsKICAgICAgICBpZiAoR2FtZS53cmlua2xlcnNQb3BwZWQgPj0gMjAwKSBHYW1lLldpbigiTW9pc3RidXJzdGVyIik7CgogICAgICAgIGlmICgKICAgICAgICAgIEdhbWUuY29va2llc0Vhcm5lZCA+PSAxMDAwMDAwICYmCiAgICAgICAgICBHYW1lLkhhcygiSG93IHRvIGJha2UgeW91ciBkcmFnb24iKQogICAgICAgICkKICAgICAgICAgIEdhbWUuVW5sb2NrKCJBIGNydW1ibHkgZWdnIik7CgogICAgICAgIGlmIChHYW1lLmNvb2tpZXNFYXJuZWQgPj0gMjUgJiYgR2FtZS5zZWFzb24gPT0gImNocmlzdG1hcyIpCiAgICAgICAgICBHYW1lLlVubG9jaygiQSBmZXN0aXZlIGhhdCIpOwogICAgICAgIGlmICgKICAgICAgICAgIEdhbWUuSGFzKCJDaHJpc3RtYXMgdHJlZSBiaXNjdWl0cyIpICYmCiAgICAgICAgICBHYW1lLkhhcygiU25vd2ZsYWtlIGJpc2N1aXRzIikgJiYKICAgICAgICAgIEdhbWUuSGFzKCJTbm93bWFuIGJpc2N1aXRzIikgJiYKICAgICAgICAgIEdhbWUuSGFzKCJIb2xseSBiaXNjdWl0cyIpICYmCiAgICAgICAgICBHYW1lLkhhcygiQ2FuZHkgY2FuZSBiaXNjdWl0cyIpICYmCiAgICAgICAgICBHYW1lLkhhcygiQmVsbCBiaXNjdWl0cyIpICYmCiAgICAgICAgICBHYW1lLkhhcygiUHJlc2VudCBiaXNjdWl0cyIpCiAgICAgICAgKQogICAgICAgICAgR2FtZS5XaW4oIkxldCBpdCBzbm93Iik7CgogICAgICAgIGlmIChHYW1lLnJlaW5kZWVyQ2xpY2tlZCA+PSAxKSBHYW1lLldpbigiT2ggZGVlciIpOwogICAgICAgIGlmIChHYW1lLnJlaW5kZWVyQ2xpY2tlZCA+PSA1MCkgR2FtZS5XaW4oIlNsZWlnaCBvZiBoYW5kIik7CiAgICAgICAgaWYgKEdhbWUucmVpbmRlZXJDbGlja2VkID49IDIwMCkgR2FtZS5XaW4oIlJlaW5kZWVyIHNsZWlnaGVyIik7CgogICAgICAgIGlmIChidWlsZGluZ3NPd25lZCA+PSAxMDApIEdhbWUuV2luKCJCdWlsZGVyIik7CiAgICAgICAgaWYgKGJ1aWxkaW5nc093bmVkID49IDUwMCkgR2FtZS5XaW4oIkFyY2hpdGVjdCIpOwogICAgICAgIGlmIChidWlsZGluZ3NPd25lZCA+PSAxMDAwKSBHYW1lLldpbigiRW5naW5lZXIiKTsKICAgICAgICBpZiAoYnVpbGRpbmdzT3duZWQgPj0gMjUwMCkgR2FtZS5XaW4oIkxvcmQgb2YgQ29uc3RydWN0cyIpOwogICAgICAgIGlmIChidWlsZGluZ3NPd25lZCA+PSA1MDAwKSBHYW1lLldpbigiR3JhbmQgZGVzaWduIik7CiAgICAgICAgaWYgKGJ1aWxkaW5nc093bmVkID49IDc1MDApIEdhbWUuV2luKCJFY3VtZW5vcG9saXMiKTsKICAgICAgICBpZiAoYnVpbGRpbmdzT3duZWQgPj0gMTAwMDApIEdhbWUuV2luKCJNeXJpYWQiKTsKICAgICAgICBpZiAoR2FtZS5VcGdyYWRlc093bmVkID49IDIwKSBHYW1lLldpbigiRW5oYW5jZXIiKTsKICAgICAgICBpZiAoR2FtZS5VcGdyYWRlc093bmVkID49IDUwKSBHYW1lLldpbigiQXVnbWVudGVyIik7CiAgICAgICAgaWYgKEdhbWUuVXBncmFkZXNPd25lZCA+PSAxMDApIEdhbWUuV2luKCJVcGdyYWRlciIpOwogICAgICAgIGlmIChHYW1lLlVwZ3JhZGVzT3duZWQgPj0gMjAwKSBHYW1lLldpbigiTG9yZCBvZiBQcm9ncmVzcyIpOwogICAgICAgIGlmIChHYW1lLlVwZ3JhZGVzT3duZWQgPj0gMzAwKSBHYW1lLldpbigiVGhlIGZ1bGwgcGljdHVyZSIpOwogICAgICAgIGlmIChHYW1lLlVwZ3JhZGVzT3duZWQgPj0gNDAwKQogICAgICAgICAgR2FtZS5XaW4oIldoZW4gdGhlcmUncyBub3RoaW5nIGxlZnQgdG8gYWRkIik7CiAgICAgICAgaWYgKEdhbWUuVXBncmFkZXNPd25lZCA+PSA1MDApIEdhbWUuV2luKCJLYWl6ZW4iKTsKICAgICAgICBpZiAoR2FtZS5VcGdyYWRlc093bmVkID49IDYwMCkgR2FtZS5XaW4oIkJleW9uZCBxdWFsaXR5Iik7CiAgICAgICAgaWYgKGJ1aWxkaW5nc093bmVkID49IDQwMDAgJiYgR2FtZS5VcGdyYWRlc093bmVkID49IDMwMCkKICAgICAgICAgIEdhbWUuV2luKCJQb2x5bWF0aCIpOwogICAgICAgIGlmIChidWlsZGluZ3NPd25lZCA+PSA4MDAwICYmIEdhbWUuVXBncmFkZXNPd25lZCA+PSA0MDApCiAgICAgICAgICBHYW1lLldpbigiUmVuYWlzc2FuY2UgYmFrZXIiKTsKCiAgICAgICAgaWYgKCFHYW1lLkhhc0FjaGlldigiSmVsbGljbGVzIikpIHsKICAgICAgICAgIHZhciBraXR0ZW5zID0gMDsKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgR2FtZS5VcGdyYWRlc0J5UG9vbFsia2l0dGVuIl0ubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKEdhbWUuSGFzKEdhbWUuVXBncmFkZXNCeVBvb2xbImtpdHRlbiJdW2ldLm5hbWUpKSBraXR0ZW5zKys7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoa2l0dGVucyA+PSAxMCkgR2FtZS5XaW4oIkplbGxpY2xlcyIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKEdhbWUuY29va2llc0Vhcm5lZCA+PSAxZTE0ICYmICFHYW1lLkhhc0FjaGlldigiWW91IHdpbiBhIGNvb2tpZSIpKSB7CiAgICAgICAgICBHYW1lLldpbigiWW91IHdpbiBhIGNvb2tpZSIpOwogICAgICAgICAgR2FtZS5FYXJuKDEpOwogICAgICAgIH0KCiAgICAgICAgaWYgKEdhbWUuc2hpbW1lclR5cGVzWyJnb2xkZW4iXS5uID49IDQpIEdhbWUuV2luKCJGb3VyLWxlYWYgY29va2llIik7CgogICAgICAgIHZhciBncmFuZG1hcyA9IDA7CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLkdyYW5kbWFTeW5lcmdpZXMpIHsKICAgICAgICAgIGlmIChHYW1lLkhhcyhHYW1lLkdyYW5kbWFTeW5lcmdpZXNbaV0pKSBncmFuZG1hcysrOwogICAgICAgIH0KICAgICAgICBpZiAoIUdhbWUuSGFzQWNoaWV2KCJFbGRlciIpICYmIGdyYW5kbWFzID49IDcpIEdhbWUuV2luKCJFbGRlciIpOwogICAgICAgIGlmICghR2FtZS5IYXNBY2hpZXYoIlZldGVyYW4iKSAmJiBncmFuZG1hcyA+PSAxNCkgR2FtZS5XaW4oIlZldGVyYW4iKTsKICAgICAgICBpZiAoCiAgICAgICAgICBHYW1lLk9iamVjdHNbIkdyYW5kbWEiXS5hbW91bnQgPj0gNiAmJgogICAgICAgICAgIUdhbWUuSGFzKCJCaW5nbyBjZW50ZXIvUmVzZWFyY2ggZmFjaWxpdHkiKSAmJgogICAgICAgICAgR2FtZS5IYXNBY2hpZXYoIkVsZGVyIikKICAgICAgICApCiAgICAgICAgICBHYW1lLlVubG9jaygiQmluZ28gY2VudGVyL1Jlc2VhcmNoIGZhY2lsaXR5Iik7CiAgICAgICAgaWYgKEdhbWUucGxlZGdlcyA+IDApIEdhbWUuV2luKCJFbGRlciBuYXAiKTsKICAgICAgICBpZiAoR2FtZS5wbGVkZ2VzID49IDUpIEdhbWUuV2luKCJFbGRlciBzbHVtYmVyIik7CiAgICAgICAgaWYgKEdhbWUucGxlZGdlcyA+PSAxMCkgR2FtZS5VbmxvY2soIlNhY3JpZmljaWFsIHJvbGxpbmcgcGlucyIpOwogICAgICAgIGlmICgKICAgICAgICAgIEdhbWUuT2JqZWN0c1siQ3Vyc29yIl0uYW1vdW50ICsgR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0uYW1vdW50ID49CiAgICAgICAgICA3NzcKICAgICAgICApCiAgICAgICAgICBHYW1lLldpbigiVGhlIGVsZGVyIHNjcm9sbHMiKTsKCiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICAgIHZhciBpdCA9IEdhbWUuT2JqZWN0c1tpXTsKICAgICAgICAgIGZvciAodmFyIGlpIGluIGl0LnByb2R1Y3Rpb25BY2hpZXZzKSB7CiAgICAgICAgICAgIGlmIChpdC50b3RhbENvb2tpZXMgPj0gaXQucHJvZHVjdGlvbkFjaGlldnNbaWldLnBvdykKICAgICAgICAgICAgICBHYW1lLldpbihpdC5wcm9kdWN0aW9uQWNoaWV2c1tpaV0uYWNoaWV2Lm5hbWUpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKAogICAgICAgICAgIUdhbWUuSGFzQWNoaWV2KCJDb29raWUtZHVua2VyIikgJiYKICAgICAgICAgIEdhbWUuTGVmdEJhY2tncm91bmQgJiYKICAgICAgICAgIEdhbWUubWlsa1Byb2dyZXNzID4gMC4xICYmCiAgICAgICAgICBHYW1lLkxlZnRCYWNrZ3JvdW5kLmNhbnZhcy5oZWlnaHQgKiAwLjQgKyAyNTYgLyAyIC0gMTYgPgogICAgICAgICAgICAoMSAtIEdhbWUubWlsa0hkKSAqIEdhbWUuTGVmdEJhY2tncm91bmQuY2FudmFzLmhlaWdodAogICAgICAgICkKICAgICAgICAgIEdhbWUuV2luKCJDb29raWUtZHVua2VyIik7CiAgICAgICAgLy8mJiBsKCdiaWdDb29raWUnKS5nZXRCb3VuZHMoKS5ib3R0b20+bCgnbWlsaycpLmdldEJvdW5kcygpLnRvcCsxNiAmJiBHYW1lLm1pbGtQcm9ncmVzcz4wLjEpIEdhbWUuV2luKCdDb29raWUtZHVua2VyJyk7CgogICAgICAgIEdhbWUucnVuTW9kSG9vaygiY2hlY2siKTsKICAgICAgfQoKICAgICAgR2FtZS5jb29raWVzZCArPSAoR2FtZS5jb29raWVzIC0gR2FtZS5jb29raWVzZCkgKiAwLjM7CgogICAgICBpZiAoR2FtZS5zdG9yZVRvUmVmcmVzaCkgR2FtZS5SZWZyZXNoU3RvcmUoKTsKICAgICAgaWYgKEdhbWUudXBncmFkZXNUb1JlYnVpbGQpIEdhbWUuUmVidWlsZFVwZ3JhZGVzKCk7CgogICAgICBHYW1lLnVwZGF0ZVNoaW1tZXJzKCk7CiAgICAgIEdhbWUudXBkYXRlQnVmZnMoKTsKCiAgICAgIEdhbWUuVXBkYXRlVGlja2VyKCk7CiAgICB9CgogICAgaWYgKEdhbWUuVCAlIChHYW1lLmZwcyAqIDIpID09IDApIHsKICAgICAgdmFyIHRpdGxlID0gIkNvb2tpZSBDbGlja2VyIjsKICAgICAgaWYgKEdhbWUuc2Vhc29uID09ICJmb29scyIpIHRpdGxlID0gIkNvb2tpZSBCYWtlciI7CiAgICAgIGRvY3VtZW50LnRpdGxlID0KICAgICAgICAoR2FtZS5PbkFzY2VuZCA/IChFTiA/ICJBc2NlbmRpbmchICIgOiBsb2MoIkFzY2VuZGluZyIpICsgIiB8ICIpIDogIiIpICsKICAgICAgICBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeShHYW1lLmNvb2tpZXMpKSArCiAgICAgICAgIiAtICIgKwogICAgICAgIHRpdGxlOwogICAgfQogICAgaWYgKEdhbWUuVCAlIDE1ID09IDApIHsKICAgICAgLy93cml0dGVuIHRocm91Z2ggdGhlIG1hZ2ljIG9mICJob3BlIGZvciB0aGUgYmVzdCIgbWF0aHMKICAgICAgdmFyIGNoaXBzT3duZWQgPSBHYW1lLkhvd011Y2hQcmVzdGlnZShHYW1lLmNvb2tpZXNSZXNldCk7CiAgICAgIHZhciBhc2NlbmROb3dUb093biA9IE1hdGguZmxvb3IoCiAgICAgICAgR2FtZS5Ib3dNdWNoUHJlc3RpZ2UoR2FtZS5jb29raWVzUmVzZXQgKyBHYW1lLmNvb2tpZXNFYXJuZWQpCiAgICAgICk7CiAgICAgIHZhciBhc2NlbmROb3dUb0dldCA9IGFzY2VuZE5vd1RvT3duIC0gTWF0aC5mbG9vcihjaGlwc093bmVkKTsKICAgICAgdmFyIG5leHRDaGlwQXQgPQogICAgICAgIEdhbWUuSG93TWFueUNvb2tpZXNSZXNldChNYXRoLmZsb29yKGNoaXBzT3duZWQgKyBhc2NlbmROb3dUb0dldCArIDEpKSAtCiAgICAgICAgR2FtZS5Ib3dNYW55Q29va2llc1Jlc2V0KE1hdGguZmxvb3IoY2hpcHNPd25lZCArIGFzY2VuZE5vd1RvR2V0KSk7CiAgICAgIHZhciBjb29raWVzVG9OZXh0ID0KICAgICAgICBHYW1lLkhvd01hbnlDb29raWVzUmVzZXQoYXNjZW5kTm93VG9Pd24gKyAxKSAtCiAgICAgICAgKEdhbWUuY29va2llc0Vhcm5lZCArIEdhbWUuY29va2llc1Jlc2V0KTsKICAgICAgdmFyIHBlcmNlbnQgPSAxIC0gY29va2llc1RvTmV4dCAvIG5leHRDaGlwQXQ7CgogICAgICAvL2ZpbGwgdGhlIHRvb2x0aXAgdW5kZXIgdGhlIExlZ2FjeSB0YWIKICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgpOwogICAgICBkYXRlLnNldFRpbWUoRGF0ZS5ub3coKSAtIEdhbWUuc3RhcnREYXRlKTsKICAgICAgdmFyIHRpbWVJblNlY29uZHMgPSBkYXRlLmdldFRpbWUoKSAvIDEwMDA7CiAgICAgIHZhciBzdGFydERhdGUgPSBHYW1lLnNheVRpbWUodGltZUluU2Vjb25kcyAqIEdhbWUuZnBzLCAtMSk7CgogICAgICB2YXIgc3RyID0gIiI7CiAgICAgIGlmIChFTikKICAgICAgICBzdHIgKz0KICAgICAgICAgICJZb3UndmUgYmVlbiBvbiB0aGlzIHJ1biBmb3IgPGI+IiArCiAgICAgICAgICAoc3RhcnREYXRlID09ICIiID8gIm5vdCB2ZXJ5IGxvbmciIDogc3RhcnREYXRlKSArCiAgICAgICAgICAiPC9iPi48YnI+IjsKICAgICAgZWxzZQogICAgICAgIHN0ciArPQogICAgICAgICAgbG9jKCJZb3UndmUgYmVlbiBvbiB0aGlzIHJ1biBmb3IgPGI+JTE8L2I+LiIsIHN0YXJ0RGF0ZSkgKyAiPGJyPiI7CiAgICAgIHN0ciArPSAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JzsKICAgICAgaWYgKEdhbWUucHJlc3RpZ2UgPiAwKSB7CiAgICAgICAgc3RyICs9IGxvYygKICAgICAgICAgICJZb3VyIHByZXN0aWdlIGxldmVsIGlzIGN1cnJlbnRseSA8Yj4lMTwvYj4uPGJyPihDcFMgKyUyJSkiLAogICAgICAgICAgW0JlYXV0aWZ5KEdhbWUucHJlc3RpZ2UpLCBCZWF1dGlmeShHYW1lLnByZXN0aWdlKV0KICAgICAgICApOwogICAgICAgIHN0ciArPSAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JzsKICAgICAgfQogICAgICBpZiAoYXNjZW5kTm93VG9HZXQgPCAxKQogICAgICAgIHN0ciArPSBsb2MoIkFzY2VuZGluZyBub3cgd291bGQgZ3JhbnQgeW91IG5vIHByZXN0aWdlLiIpOwogICAgICBlbHNlIGlmIChhc2NlbmROb3dUb0dldCA8IDIpCiAgICAgICAgc3RyICs9IGxvYygKICAgICAgICAgICJBc2NlbmRpbmcgbm93IHdvdWxkIGdyYW50IHlvdTxicj48Yj4xIHByZXN0aWdlIGxldmVsPC9iPiAoKzElIENwUyk8YnI+YW5kIDxiPjEgaGVhdmVubHkgY2hpcDwvYj4gdG8gc3BlbmQuIgogICAgICAgICk7CiAgICAgIGVsc2UKICAgICAgICBzdHIgKz0gbG9jKAogICAgICAgICAgIkFzY2VuZGluZyBub3cgd291bGQgZ3JhbnQgeW91PGJyPjxiPiUxIHByZXN0aWdlIGxldmVsczwvYj4gKCslMiUgQ3BTKTxicj5hbmQgPGI+JTMgaGVhdmVubHkgY2hpcHM8L2I+IHRvIHNwZW5kLiIsCiAgICAgICAgICBbCiAgICAgICAgICAgIEJlYXV0aWZ5KGFzY2VuZE5vd1RvR2V0KSwKICAgICAgICAgICAgQmVhdXRpZnkoYXNjZW5kTm93VG9HZXQpLAogICAgICAgICAgICBCZWF1dGlmeShhc2NlbmROb3dUb0dldCksCiAgICAgICAgICBdCiAgICAgICAgKTsKICAgICAgaWYgKGNvb2tpZXNUb05leHQgPj0gMCkgewogICAgICAgIC8vbm90ZTogY29va2llc1RvTmV4dCBjYW4gYmUgbmVnYXRpdmUgYXQgaGlnaGVyIEhDIGFtb3VudHMgZHVlIHRvIHByZWNpc2lvbiBsb3NzLiB3ZSBzaW1wbHkgaGlkZSBpdCBpbiBzdWNoIGNhc2VzLCBhcyB0aGlzIHVzdWFsbHkgb25seSBvY2N1cnMgd2hlbiB0aGUgZ2FwIGlzIHNtYWxsIGFuZCByYXBpZGx5IG92ZXJjb21lIGFueXdheQogICAgICAgIHN0ciArPSAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JzsKICAgICAgICBzdHIgKz0KICAgICAgICAgIGxvYygKICAgICAgICAgICAgIllvdSBuZWVkIDxiPiUxIG1vcmUgY29va2llczwvYj4gZm9yIHRoZSBuZXh0IGxldmVsLiIsCiAgICAgICAgICAgIEJlYXV0aWZ5KGNvb2tpZXNUb05leHQpCiAgICAgICAgICApICsgIjxicj4iOwogICAgICB9CiAgICAgIGwoImFzY2VuZFRvb2x0aXAiKS5pbm5lckhUTUwgPSBzdHI7CgogICAgICBpZiAoYXNjZW5kTm93VG9HZXQgPiAwKSB7CiAgICAgICAgLy9zaG93IG51bWJlciBzYXlpbmcgaG93IG1hbnkgY2hpcHMgeW91J2QgZ2V0IHJlc2V0dGluZyBub3cKICAgICAgICBHYW1lLmFzY2VuZE51bWJlci50ZXh0Q29udGVudCA9ICIrIiArIFNpbXBsZUJlYXV0aWZ5KGFzY2VuZE5vd1RvR2V0KTsKICAgICAgICBHYW1lLmFzY2VuZE51bWJlci5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgfSBlbHNlIHsKICAgICAgICBHYW1lLmFzY2VuZE51bWJlci5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICB9CgogICAgICBpZiAoCiAgICAgICAgYXNjZW5kTm93VG9HZXQgPiBHYW1lLmFzY2VuZE1ldGVyTGV2ZWwgfHwKICAgICAgICBHYW1lLmFzY2VuZE1ldGVyUGVyY2VudFQgPCBHYW1lLmFzY2VuZE1ldGVyUGVyY2VudAogICAgICApIHsKICAgICAgICAvL3Jlc2V0IHRoZSBnYXVnZSBhbmQgcGxheSBhIHNvdW5kIGlmIHdlIGdhaW5lZCBhIHBvdGVudGlhbCBsZXZlbAogICAgICAgIEdhbWUuYXNjZW5kTWV0ZXJQZXJjZW50ID0gMDsKICAgICAgICAvL1BsYXlTb3VuZCgnc25kL2xldmVsUHJlc3RpZ2UubXAzJyk7Ly9hIGJpdCB0b28gYW5ub3lpbmcKICAgICAgfQogICAgICBHYW1lLmFzY2VuZE1ldGVyTGV2ZWwgPSBhc2NlbmROb3dUb0dldDsKICAgICAgR2FtZS5hc2NlbmRNZXRlclBlcmNlbnRUID0gcGVyY2VudDsgLy9nYXVnZSB0aGF0IGZpbGxzIHVwIGFzIHlvdSBuZWFyIHlvdXIgbmV4dCBjaGlwCiAgICAgIC8vaWYgKEdhbWUuYXNjZW5kTWV0ZXJQZXJjZW50VDxHYW1lLmFzY2VuZE1ldGVyUGVyY2VudCkge0dhbWUuYXNjZW5kTWV0ZXJQZXJjZW50PTA7UGxheVNvdW5kKCdzbmQvbGV2ZWxQcmVzdGlnZS5tcDMnLDAuNSk7fQogICAgICAvL2lmIChwZXJjZW50Pj0xKSB7R2FtZS5hc2NlbmRNZXRlci5jbGFzc05hbWU9Jyc7fSBlbHNlIEdhbWUuYXNjZW5kTWV0ZXIuY2xhc3NOYW1lPSdmaWxsaW5nJzsKICAgIH0KICAgIC8vR2FtZS5hc2NlbmRNZXRlci5zdHlsZS5yaWdodD1NYXRoLmZsb29yKE1hdGgubWF4KDAsMS1HYW1lLmFzY2VuZE1ldGVyUGVyY2VudCkqMTAwKSsncHgnOwogICAgR2FtZS5hc2NlbmRNZXRlci5zdHlsZS5iYWNrZ3JvdW5kUG9zaXRpb24gPQogICAgICAtR2FtZS5UICogMC41IC0gR2FtZS5hc2NlbmRNZXRlclBlcmNlbnQgKiAxMDAgKyAicHgiOwogICAgR2FtZS5hc2NlbmRNZXRlci5zdHlsZS50cmFuc2Zvcm0gPQogICAgICAidHJhbnNsYXRlKCIgKwogICAgICBNYXRoLmZsb29yKC1NYXRoLm1heCgwLCAxIC0gR2FtZS5hc2NlbmRNZXRlclBlcmNlbnQpICogMTAwKSArCiAgICAgICIlLDBweCkiOwogICAgR2FtZS5hc2NlbmRNZXRlclBlcmNlbnQgKz0KICAgICAgKEdhbWUuYXNjZW5kTWV0ZXJQZXJjZW50VCAtIEdhbWUuYXNjZW5kTWV0ZXJQZXJjZW50KSAqIDAuMTsKCiAgICBHYW1lLk5vdGVzTG9naWMoKTsKICAgIGlmIChHYW1lLm1vdXNlTW92ZWQgfHwgR2FtZS5TY3JvbGwgfHwgR2FtZS50b29sdGlwLmR5bmFtaWMpCiAgICAgIEdhbWUudG9vbHRpcC51cGRhdGUoKTsKCiAgICBpZiAoCiAgICAgIEdhbWUuVCAlIChHYW1lLmZwcyAqIDUpID09IDAgJiYKICAgICAgIUdhbWUubW91c2VEb3duICYmCiAgICAgIChHYW1lLm9uTWVudSA9PSAic3RhdHMiIHx8IEdhbWUub25NZW51ID09ICJwcmVmcyIpCiAgICApCiAgICAgIEdhbWUuVXBkYXRlTWVudSgpOwogICAgaWYgKEdhbWUuVCAlIChHYW1lLmZwcyAqIDEpID09IDApIEdhbWUuVXBkYXRlUHJvbXB0KCk7CiAgICBpZiAoR2FtZS5Bc2NlbmRUaW1lciA+IDApIEdhbWUuVXBkYXRlQXNjZW5kSW50cm8oKTsKICAgIGlmIChHYW1lLlJlaW5jYXJuYXRlVGltZXIgPiAwKSBHYW1lLlVwZGF0ZVJlaW5jYXJuYXRlSW50cm8oKTsKICAgIGlmIChHYW1lLk9uQXNjZW5kKSBHYW1lLlVwZGF0ZUFzY2VuZCgpOwoKICAgIEdhbWUucnVuTW9kSG9vaygibG9naWMiKTsKCiAgICBpZiAoR2FtZS5zcGFya2xlc1QgPiAwKSB7CiAgICAgIEdhbWUuc3BhcmtsZXMuc3R5bGUuYmFja2dyb3VuZFBvc2l0aW9uID0KICAgICAgICAtTWF0aC5mbG9vcigoR2FtZS5zcGFya2xlc0ZyYW1lcyAtIEdhbWUuc3BhcmtsZXNUICsgMSkgKiAxMjgpICsKICAgICAgICAicHggMHB4IjsKICAgICAgR2FtZS5zcGFya2xlc1QtLTsKICAgICAgaWYgKEdhbWUuc3BhcmtsZXNUID09IDEpIEdhbWUuc3BhcmtsZXMuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgIH0KCiAgICBHYW1lLkNsaWNrID0gMDsKICAgIEdhbWUuU2Nyb2xsID0gMDsKICAgIEdhbWUubW91c2VNb3ZlZCA9IDA7CiAgICBHYW1lLkNhbkNsaWNrID0gMTsKCiAgICBpZiAoCiAgICAgIChHYW1lLnRvU2F2ZSB8fAogICAgICAgIChHYW1lLlQgJSAoR2FtZS5mcHMgKiA2MCkgPT0gMCAmJgogICAgICAgICAgR2FtZS5UID4gR2FtZS5mcHMgKiAxMCAmJgogICAgICAgICAgR2FtZS5wcmVmcy5hdXRvc2F2ZSkpICYmCiAgICAgICFHYW1lLk9uQXNjZW5kCiAgICApIHsKICAgICAgLy9jaGVjayBpZiB3ZSBjYW4gc2F2ZSA6IG5vIG1pbmlnYW1lcyBhcmUgbG9hZGluZwogICAgICB2YXIgY2FuU2F2ZSA9IHRydWU7CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5PYmplY3RzW2ldOwogICAgICAgIGlmIChtZS5taW5pZ2FtZUxvYWRpbmcpIHsKICAgICAgICAgIGNhblNhdmUgPSBmYWxzZTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoY2FuU2F2ZSkgR2FtZS5Xcml0ZVNhdmUoKTsKICAgIH0KICAgIGlmICghR2FtZS50b1NhdmUgJiYgIUdhbWUuaXNTYXZpbmcpIHsKICAgICAgaWYgKEdhbWUudG9SZWxvYWQpIHsKICAgICAgICBHYW1lLnRvUmVsb2FkID0gZmFsc2U7CiAgICAgICAgaWYgKCFBcHApIHsKICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBBcHAucmVsb2FkKCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChHYW1lLnRvUXVpdCkgewogICAgICAgIEdhbWUudG9RdWl0ID0gZmFsc2U7CiAgICAgICAgaWYgKCFBcHApIHsKICAgICAgICAgIHdpbmRvdy5jbG9zZSgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBBcHAucXVpdCgpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGlmIChBcHAgJiYgQXBwLmxvZ2ljKSBBcHAubG9naWMoR2FtZS5UKTsKCiAgICAvL2V2ZXJ5IGhvdXI6IGdldCBzZXJ2ZXIgZGF0YSAoaWUuIHVwZGF0ZSBub3RpZmljYXRpb24sIHBhdHJlb24sIHN0ZWFtIGV0YykKICAgIGlmICgKICAgICAgR2FtZS5UICUgKEdhbWUuZnBzICogNjAgKiA2MCkgPT0gMCAmJgogICAgICBHYW1lLlQgPiBHYW1lLmZwcyAqIDEwIC8qICYmIEdhbWUucHJlZnMuYXV0b3VwZGF0ZSovCiAgICApIHsKICAgICAgR2FtZS5DaGVja1VwZGF0ZXMoKTsKICAgICAgR2FtZS5HcmFiRGF0YSgpOwogICAgfQoKICAgIEdhbWUuVCsrOwogIH07CgogIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJRFJBVwoJPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KCiAgR2FtZS5EcmF3ID0gZnVuY3Rpb24gKCkgewogICAgR2FtZS5EcmF3QmFja2dyb3VuZCgpOwogICAgVGltZXIudHJhY2soImVuZCBvZiBiYWNrZ3JvdW5kIik7CgogICAgaWYgKCFHYW1lLk9uQXNjZW5kKSB7CiAgICAgIHZhciBzdHIgPSBCZWF1dGlmeShNYXRoLnJvdW5kKEdhbWUuY29va2llc2QpKTsKICAgICAgaWYgKEdhbWUuY29va2llc2QgPj0gMTAwMDAwMCkgewogICAgICAgIC8vZGlydHkgcGFkZGluZwogICAgICAgIHZhciBzcGFjZVBvcyA9IHN0ci5pbmRleE9mKCIgIik7CiAgICAgICAgdmFyIGRvdFBvcyA9IHN0ci5pbmRleE9mKCIuIik7CiAgICAgICAgdmFyIGFkZCA9ICIiOwogICAgICAgIGlmIChzcGFjZVBvcyAhPSAtMSkgewogICAgICAgICAgaWYgKGRvdFBvcyA9PSAtMSkgYWRkICs9ICIuMDAwIjsKICAgICAgICAgIGVsc2UgewogICAgICAgICAgICBpZiAoc3BhY2VQb3MgLSBkb3RQb3MgPT0gMikgYWRkICs9ICIwMCI7CiAgICAgICAgICAgIGlmIChzcGFjZVBvcyAtIGRvdFBvcyA9PSAzKSBhZGQgKz0gIjAiOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBzdHIgPSBbc3RyLnNsaWNlKDAsIHNwYWNlUG9zKSwgYWRkLCBzdHIuc2xpY2Uoc3BhY2VQb3MpXS5qb2luKCIiKTsKICAgICAgfQoKICAgICAgc3RyID0gbG9jKCIlMSBjb29raWUiLCB7IG46IE1hdGgucm91bmQoR2FtZS5jb29raWVzZCksIGI6IHN0ciB9KTsKICAgICAgaWYgKHN0ci5sZW5ndGggPiAxNCkgc3RyID0gc3RyLnJlcGxhY2UoIiAiLCAiPGJyPiIpOwoKICAgICAgaWYgKEdhbWUucHJlZnMubW9ub3NwYWNlKQogICAgICAgIHN0ciA9ICc8c3BhbiBjbGFzcz0ibW9ub3NwYWNlIj4nICsgc3RyICsgIjwvc3Bhbj4iOwogICAgICBzdHIgPQogICAgICAgIHN0ciArCiAgICAgICAgJzxkaXYgaWQ9ImNvb2tpZXNQZXJTZWNvbmQiJyArCiAgICAgICAgKEdhbWUuY3BzU3Vja2VkID4gMCA/ICcgY2xhc3M9IndyaW5rbGVkIicgOiAiIikgKwogICAgICAgICI+IiArCiAgICAgICAgbG9jKCJwZXIgc2Vjb25kOiIpICsKICAgICAgICAiICIgKwogICAgICAgIEJlYXV0aWZ5KEdhbWUuY29va2llc1BzICogKDEgLSBHYW1lLmNwc1N1Y2tlZCksIDEpICsKICAgICAgICAiPC9kaXY+IjsKICAgICAgbCgiY29va2llcyIpLmlubmVySFRNTCA9IHN0cjsKICAgICAgVGltZXIudHJhY2soImNvb2tpZSBhbW91bnQiKTsKCiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5PYmplY3RzW2ldOwogICAgICAgIGlmIChtZS5vbk1pbmlnYW1lICYmIG1lLm1pbmlnYW1lLmRyYXcgJiYgIW1lLm11dGVkICYmICFHYW1lLm9uTWVudSkKICAgICAgICAgIG1lLm1pbmlnYW1lLmRyYXcoKTsKICAgICAgfQogICAgICBUaW1lci50cmFjaygiZHJhdyBtaW5pZ2FtZXMiKTsKCiAgICAgIGlmIChHYW1lLmRyYXdUICUgNSA9PSAwKSB7CiAgICAgICAgLy9pZiAoR2FtZS5wcmVmcy5tb25vc3BhY2UpIHtsKCdjb29raWVzJykuY2xhc3NOYW1lPSd0aXRsZSBtb25vc3BhY2UnO30gZWxzZSB7bCgnY29va2llcycpLmNsYXNzTmFtZT0ndGl0bGUnO30KICAgICAgICB2YXIgbGFzdExvY2tlZCA9IDA7CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICAgIHZhciBtZSA9IEdhbWUuT2JqZWN0c1tpXTsKCiAgICAgICAgICAvL21ha2UgcHJvZHVjdHMgZnVsbC1vcGFjaXR5IGlmIHdlIGNhbiBidXkgdGhlbQogICAgICAgICAgdmFyIGNsYXNzZXMgPSAicHJvZHVjdCI7CiAgICAgICAgICB2YXIgcHJpY2UgPSBtZS5idWxrUHJpY2U7CiAgICAgICAgICBpZiAoR2FtZS5jb29raWVzRWFybmVkID49IG1lLmJhc2VQcmljZSB8fCBtZS5ib3VnaHQgPiAwKSB7CiAgICAgICAgICAgIGNsYXNzZXMgKz0gIiB1bmxvY2tlZCI7CiAgICAgICAgICAgIGxhc3RMb2NrZWQgPSAwOwogICAgICAgICAgICBtZS5sb2NrZWQgPSAwOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY2xhc3NlcyArPSAiIGxvY2tlZCI7CiAgICAgICAgICAgIGxhc3RMb2NrZWQrKzsKICAgICAgICAgICAgbWUubG9ja2VkID0gMTsKICAgICAgICAgIH0KICAgICAgICAgIGlmICgKICAgICAgICAgICAgKEdhbWUuYnV5TW9kZSA9PSAxICYmIEdhbWUuY29va2llcyA+PSBwcmljZSkgfHwKICAgICAgICAgICAgKEdhbWUuYnV5TW9kZSA9PSAtMSAmJiBtZS5hbW91bnQgPiAwKQogICAgICAgICAgKQogICAgICAgICAgICBjbGFzc2VzICs9ICIgZW5hYmxlZCI7CiAgICAgICAgICBlbHNlIGNsYXNzZXMgKz0gIiBkaXNhYmxlZCI7CiAgICAgICAgICBpZiAobGFzdExvY2tlZCA+IDIpIGNsYXNzZXMgKz0gIiB0b2dnbGVkT2ZmIjsKICAgICAgICAgIG1lLmwuY2xhc3NOYW1lID0gY2xhc3NlczsKICAgICAgICAgIC8vaWYgKG1lLmlkPjApIHtsKCdwcm9kdWN0TmFtZScrbWUuaWQpLmlubmVySFRNTD1CZWF1dGlmeShtZS5zdG9yZWRUb3RhbENwcy9HYW1lLk9iamVjdHNCeUlkW21lLmlkLTFdLnN0b3JlZFRvdGFsQ3BzLDIpO30KICAgICAgICB9CgogICAgICAgIC8vbWFrZSB1cGdyYWRlcyBmdWxsLW9wYWNpdHkgaWYgd2UgY2FuIGJ1eSB0aGVtCiAgICAgICAgdmFyIGxhc3RQcmljZSA9IDA7CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlVwZ3JhZGVzSW5TdG9yZSkgewogICAgICAgICAgdmFyIG1lID0gR2FtZS5VcGdyYWRlc0luU3RvcmVbaV07CiAgICAgICAgICBpZiAoIW1lLmJvdWdodCkgewogICAgICAgICAgICB2YXIgcHJpY2UgPSBtZS5nZXRQcmljZSgpOwogICAgICAgICAgICB2YXIgY2FuQnV5ID0gbWUuY2FuQnV5KCk7IC8vKEdhbWUuY29va2llcz49cHJpY2UpOwogICAgICAgICAgICB2YXIgZW5hYmxlZCA9IGwoInVwZ3JhZGUiICsgaSkuY2xhc3NOYW1lLmluZGV4T2YoImVuYWJsZWQiKSA+IC0xOwogICAgICAgICAgICBpZiAoKGNhbkJ1eSAmJiAhZW5hYmxlZCkgfHwgKCFjYW5CdXkgJiYgZW5hYmxlZCkpCiAgICAgICAgICAgICAgR2FtZS51cGdyYWRlc1RvUmVidWlsZCA9IDE7CiAgICAgICAgICAgIGlmIChwcmljZSA8IGxhc3RQcmljZSkgR2FtZS5zdG9yZVRvUmVmcmVzaCA9IDE7IC8vaXMgdGhpcyB1cGdyYWRlIGxlc3MgZXhwZW5zaXZlIHRoYW4gdGhlIHByZXZpb3VzIG9uZT8gdHJpZ2dlciBhIHJlZnJlc2ggdG8gc29ydCBpdCBhZ2FpbgogICAgICAgICAgICBsYXN0UHJpY2UgPSBwcmljZTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChtZS50aW1lckRpc3BsYXkpIHsKICAgICAgICAgICAgdmFyIFQgPSBtZS50aW1lckRpc3BsYXkoKTsKICAgICAgICAgICAgaWYgKFQgIT0gLTEpIHsKICAgICAgICAgICAgICBpZiAoIWwoInVwZ3JhZGVQaWVUaW1lciIgKyBpKSkKICAgICAgICAgICAgICAgIGwoInVwZ3JhZGUiICsgaSkuaW5uZXJIVE1MID0KICAgICAgICAgICAgICAgICAgbCgidXBncmFkZSIgKyBpKS5pbm5lckhUTUwgKwogICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0icGllVGltZXIiIGlkPSJ1cGdyYWRlUGllVGltZXInICsKICAgICAgICAgICAgICAgICAgaSArCiAgICAgICAgICAgICAgICAgICciPjwvZGl2Pic7CiAgICAgICAgICAgICAgVCA9IChUICogMTQ0KSAlIDE0NDsKICAgICAgICAgICAgICBsKCJ1cGdyYWRlUGllVGltZXIiICsgaSkuc3R5bGUuYmFja2dyb3VuZFBvc2l0aW9uID0KICAgICAgICAgICAgICAgIC1NYXRoLmZsb29yKFQgJSAxOCkgKiA0OCArCiAgICAgICAgICAgICAgICAicHggIiArCiAgICAgICAgICAgICAgICAtTWF0aC5mbG9vcihUIC8gMTgpICogNDggKwogICAgICAgICAgICAgICAgInB4IjsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIC8vaWYgKG1lLmNhbkJ1eSgpKSBsKCd1cGdyYWRlJytpKS5jbGFzc05hbWU9J2NyYXRlIHVwZ3JhZGUgZW5hYmxlZCc7IGVsc2UgbCgndXBncmFkZScraSkuY2xhc3NOYW1lPSdjcmF0ZSB1cGdyYWRlIGRpc2FibGVkJzsKICAgICAgICB9CiAgICAgIH0KICAgICAgVGltZXIudHJhY2soInN0b3JlIik7CgogICAgICBpZiAoR2FtZS5QQVJUWSkgewogICAgICAgIC8vaSB3YXMgYm9yZWQgYW5kIGZlbHQgbGlrZSBtZXNzaW5nIHdpdGggQ1NTCiAgICAgICAgdmFyIHB1bHNlID0gTWF0aC5wb3coKEdhbWUuVCAlIDEwKSAvIDEwLCAwLjUpOwogICAgICAgIEdhbWUubC5zdHlsZS5maWx0ZXIgPQogICAgICAgICAgImh1ZS1yb3RhdGUoIiArCiAgICAgICAgICAoKEdhbWUuVCAqIDUpICUgMzYwKSArCiAgICAgICAgICAiZGVnKSBicmlnaHRuZXNzKCIgKwogICAgICAgICAgKDE1MCAtIDUwICogcHVsc2UpICsKICAgICAgICAgICIlKSI7CiAgICAgICAgR2FtZS5sLnN0eWxlLndlYmtpdEZpbHRlciA9CiAgICAgICAgICAiaHVlLXJvdGF0ZSgiICsKICAgICAgICAgICgoR2FtZS5UICogNSkgJSAzNjApICsKICAgICAgICAgICJkZWcpIGJyaWdodG5lc3MoIiArCiAgICAgICAgICAoMTUwIC0gNTAgKiBwdWxzZSkgKwogICAgICAgICAgIiUpIjsKICAgICAgICBHYW1lLmwuc3R5bGUudHJhbnNmb3JtID0KICAgICAgICAgICJzY2FsZSgiICsKICAgICAgICAgICgxLjAyIC0gMC4wMiAqIHB1bHNlKSArCiAgICAgICAgICAiLCIgKwogICAgICAgICAgKDEuMDIgLSAwLjAyICogcHVsc2UpICsKICAgICAgICAgICIpIHJvdGF0ZSgiICsKICAgICAgICAgIE1hdGguc2luKEdhbWUuVCAqIDAuNSkgKiAwLjUgKwogICAgICAgICAgImRlZykiOwogICAgICAgIEdhbWUud3JhcHBlci5zdHlsZS5vdmVyZmxvd1ggPSAiaGlkZGVuIjsKICAgICAgICBHYW1lLndyYXBwZXIuc3R5bGUub3ZlcmZsb3dZID0gImhpZGRlbiI7CiAgICAgIH0KCiAgICAgIFRpbWVyLmNsZWFuKCk7CiAgICAgIGlmICgKICAgICAgICBHYW1lLnByZWZzLmFuaW1hdGUgJiYKICAgICAgICAoKEdhbWUucHJlZnMuZmFuY3kgJiYgR2FtZS5kcmF3VCAlIDEgPT0gMCkgfHwKICAgICAgICAgICghR2FtZS5wcmVmcy5mYW5jeSAmJiBHYW1lLmRyYXdUICUgMTAgPT0gMCkpICYmCiAgICAgICAgR2FtZS5Bc2NlbmRUaW1lciA9PSAwICYmCiAgICAgICAgR2FtZS5vbk1lbnUgPT0gIiIKICAgICAgKQogICAgICAgIEdhbWUuRHJhd0J1aWxkaW5ncygpOwogICAgICBUaW1lci50cmFjaygiYnVpbGRpbmdzIik7CgogICAgICBHYW1lLnRleHRQYXJ0aWNsZXNVcGRhdGUoKTsKICAgICAgVGltZXIudHJhY2soInRleHQgcGFydGljbGVzIik7CiAgICB9CgogICAgR2FtZS5Ob3Rlc0RyYXcoKTsKICAgIFRpbWVyLnRyYWNrKCJub3RlcyIpOwoKICAgIEdhbWUucnVuTW9kSG9vaygiZHJhdyIpOwoKICAgIEdhbWUuZHJhd1QrKzsKICAgIC8vaWYgKEdhbWUucHJlZnMuYWx0RHJhdykgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKEdhbWUuRHJhdyk7CiAgfTsKCiAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CglNQUlOIExPT1AKCT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCiAgR2FtZS5Mb29wID0gZnVuY3Rpb24gKCkgewogICAgaWYgKEdhbWUudGltZWRvdXQpIHJldHVybiBmYWxzZTsKICAgIFRpbWVyLnNheSgiU1RBUlQiKTsKICAgIFRpbWVyLnRyYWNrKCJicm93c2VyIHN0dWZmIik7CiAgICBUaW1lci5zYXkoIkxPR0lDIik7CiAgICAvL3VwZGF0ZSBnYW1lIGxvZ2ljICEKICAgIEdhbWUuY2F0Y2h1cExvZ2ljID0gMDsKICAgIEdhbWUuTG9naWMoKTsKICAgIEdhbWUuY2F0Y2h1cExvZ2ljID0gMTsKCiAgICB2YXIgdGltZSA9IERhdGUubm93KCk7CgogICAgLy9sYXRlbmN5IGNvbXBlbnNhdG9yCiAgICBHYW1lLmFjY3VtdWxhdGVkRGVsYXkgKz0gdGltZSAtIEdhbWUudGltZSAtIDEwMDAgLyBHYW1lLmZwczsKICAgIGlmIChHYW1lLnByZWZzLnRpbWVvdXQgJiYgdGltZSAtIEdhbWUubGFzdEFjdGl2aXR5ID49IDEwMDAgKiA2MCAqIDUpIHsKICAgICAgaWYgKEdhbWUuYWNjdW11bGF0ZWREZWxheSA+IDEwMDAgKiA2MCAqIDMwKQogICAgICAgIEdhbWUuZGVsYXlUaW1lb3V0cyArPSAzOyAvL21vcmUgdGhhbiAzMCBtaW51dGVzIGRlbGF5PyBjb21wdXRlciBwcm9iYWJseSBhc2xlZXAgYW5kIG5vdCBtYWtpbmcgY29va2llcyBhbnl3YXkKICAgICAgZWxzZSBpZiAoR2FtZS5hY2N1bXVsYXRlZERlbGF5ID4gMTAwMCAqIDUpIEdhbWUuZGVsYXlUaW1lb3V0cysrOyAvL2FkZCB0byB0aW1lb3V0IGNvdW50ZXIgd2hlbiB3ZSBza2lwIDEwIHNlY29uZHMgd29ydGggb2YgZnJhbWVzIChhbmQgdGhlIHBsYXllciBoYXMgYmVlbiBpbmFjdGl2ZSBmb3IgYXQgbGVhc3QgNSBtaW51dGVzKQogICAgICBpZiAoR2FtZS5kZWxheVRpbWVvdXRzID49IDMpIEdhbWUuVGltZW91dCgpOyAvL3RyaWdnZXIgdGltZW91dCB3aGVuIHRoZSB0aW1lb3V0IGNvdW50ZXIgaXMgMysKICAgIH0KCiAgICBHYW1lLmFjY3VtdWxhdGVkRGVsYXkgPSBNYXRoLm1pbihHYW1lLmFjY3VtdWxhdGVkRGVsYXksIDEwMDAgKiA1KTsgLy9kb24ndCBjb21wZW5zYXRlIG92ZXIgNSBzZWNvbmRzOyBpZiB5b3UgZG8sIHNvbWV0aGluZydzIHByb2JhYmx5IHZlcnkgd3JvbmcKICAgIEdhbWUudGltZSA9IHRpbWU7CgogICAgLy9pZiAoR2FtZS5hY2N1bXVsYXRlZERlbGF5Pj1HYW1lLmZwcykgY29uc29sZS5sb2coJ2RlbGF5OicsTWF0aC5yb3VuZChHYW1lLmFjY3VtdWxhdGVkRGVsYXkvR2FtZS5mcHMpKTsKICAgIHdoaWxlIChHYW1lLmFjY3VtdWxhdGVkRGVsYXkgPiAwKSB7CiAgICAgIEdhbWUuTG9naWMoKTsKICAgICAgR2FtZS5hY2N1bXVsYXRlZERlbGF5IC09IDEwMDAgLyBHYW1lLmZwczsgLy9hcyBsb25nIGFzIHdlJ3JlIGRldGVjdGluZyBsYXRlbmN5IChzbG93ZXIgdGhhbiB0YXJnZXQgZnBzKSwgZXhlY3V0ZSBsb2dpYyAodGhpcyBtYWtlcyBkcmF3aW5nIHNsb3dlciBidXQgbWFrZXMgdGhlIGxvZ2ljIGJlaGF2ZSBjbG9zZXIgdG8gY29ycmVjdCB0YXJnZXQgZnBzKQogICAgfQogICAgR2FtZS5jYXRjaHVwTG9naWMgPSAwOwogICAgVGltZXIudHJhY2soImxvZ2ljIik7CiAgICBUaW1lci5zYXkoIkVORCBMT0dJQyIpOwogICAgLyoKCQlpZiAoIUdhbWUucHJlZnMuYWx0RHJhdykKCQl7CgkJCXZhciBoYXNGb2N1cz1kb2N1bWVudC5oYXNGb2N1cygpOwoJCQlUaW1lci5zYXkoJ0RSQVcnKTsKCQkJaWYgKGhhc0ZvY3VzIHx8IEdhbWUucHJlZnMuZm9jdXMgfHwgR2FtZS5sb29wVCUxMD09MCkgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKEdhbWUuRHJhdyk7CgkJCS8vaWYgKGRvY3VtZW50Lmhhc0ZvY3VzKCkgfHwgR2FtZS5sb29wVCU1PT0wKSBHYW1lLkRyYXcoKTsKCQkJVGltZXIuc2F5KCdFTkQgRFJBVycpOwoJCX0KCQllbHNlIHJlcXVlc3RBbmltYXRpb25GcmFtZShHYW1lLkRyYXcpOyovCiAgICBpZiAoR2FtZS52aXNpYmxlKSBHYW1lLkRyYXcoKTsKCiAgICAvL2lmICghaGFzRm9jdXMpIEdhbWUudG9vbHRpcC5oaWRlKCk7CgogICAgaWYgKEdhbWUuc2VzYW1lKSB7CiAgICAgIC8vZnBzIGNvdW50ZXIgYW5kIGdyYXBoCiAgICAgIEdhbWUucHJldmlvdXNGcHMgPSBHYW1lLmN1cnJlbnRGcHM7CiAgICAgIEdhbWUuY3VycmVudEZwcyA9IEdhbWUuZ2V0RnBzKCk7CiAgICAgIHZhciBjdHggPSBHYW1lLmZwc0dyYXBoQ3R4OwogICAgICBjdHguZHJhd0ltYWdlKEdhbWUuZnBzR3JhcGgsIC0xLCAwKTsKICAgICAgY3R4LmZpbGxTdHlsZSA9CiAgICAgICAgInJnYigiICsgTWF0aC5yb3VuZCgoMSAtIEdhbWUuY3VycmVudEZwcyAvIEdhbWUuZnBzKSAqIDEyOCkgKyAiLDAsMCkiOwogICAgICBjdHguZmlsbFJlY3QoMTI4IC0gMSwgMCwgMSwgNjQpOwogICAgICBjdHguc3Ryb2tlU3R5bGUgPSAiI2ZmZiI7CiAgICAgIGN0eC5iZWdpblBhdGgoKTsKICAgICAgY3R4Lm1vdmVUbygxMjggLSAxLCAoMSAtIEdhbWUucHJldmlvdXNGcHMgLyBHYW1lLmZwcykgKiA2NCk7CiAgICAgIGN0eC5saW5lVG8oMTI4LCAoMSAtIEdhbWUuY3VycmVudEZwcyAvIEdhbWUuZnBzKSAqIDY0KTsKICAgICAgY3R4LnN0cm9rZSgpOwoKICAgICAgbCgiZnBzQ291bnRlciIpLnRleHRDb250ZW50ID0gR2FtZS5jdXJyZW50RnBzICsgIiBmcHMiOwogICAgICB2YXIgc3RyID0gIiI7CiAgICAgIGZvciAodmFyIGkgaW4gVGltZXIubGFiZWxzKSB7CiAgICAgICAgc3RyICs9IFRpbWVyLmxhYmVsc1tpXTsKICAgICAgfQogICAgICBpZiAoR2FtZS5kZWJ1Z1RpbWVyc09uKSBsKCJkZWJ1Z0xvZyIpLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICBlbHNlIGwoImRlYnVnTG9nIikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgbCgiZGVidWdMb2ciKS5pbm5lckhUTUwgPSBzdHI7CiAgICB9CiAgICBUaW1lci5yZXNldCgpOwoKICAgIEdhbWUubG9vcFQrKzsKICAgIHNldFRpbWVvdXQoR2FtZS5Mb29wLCAxMDAwIC8gR2FtZS5mcHMpOwogIH07Cn07CgovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KTEFVTkNIIFRISVMgVEhJTkcKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KLy9HYW1lLkxhdW5jaCgpOwoKLy90cnkge0dhbWUuTGF1bmNoKCk7fQovL2NhdGNoKGVycikge2NvbnNvbGUubG9nKCdFUlJPUiA6ICcrZXJyLm1lc3NhZ2UpO30KCndpbmRvdy5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgaWYgKCFHYW1lLnJlYWR5KSB7CiAgICB2YXIgbG9hZExhbmdBbmRMYXVuY2ggPSBmdW5jdGlvbiAobGFuZywgZmlyc3RMYXVuY2gpIHsKICAgICAgaWYgKCFmaXJzdExhdW5jaCkgbG9jYWxTdG9yYWdlU2V0KCJDb29raWVDbGlja2VyTGFuZyIsIGxhbmcpOwoKICAgICAgLy9Mb2FkTGFuZygnLi4vQ29va2llIENsaWNrZXIgTG9jYWxpemF0aW9uL0VOLmpzJyxmdW5jdGlvbihsYW5nKXtyZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgTG9hZExhbmcoCiAgICAgICAgImxvYy9FTi5qcz92PSIgKyBHYW1lLnZlcnNpb24sCiAgICAgICAgKGZ1bmN0aW9uIChsYW5nKSB7CiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBsb2NTdHJpbmdzRmFsbGJhY2sgPSBsb2NTdHJpbmdzOwogICAgICAgICAgICBMb2FkTGFuZygibG9jLyIgKyBsYW5nICsgIi5qcz92PSIgKyBHYW1lLnZlcnNpb24sIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICB2YXIgbGF1bmNoID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgR2FtZS5MYXVuY2goKTsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKAogICAgICAgICAgICAgICAgICAiWz09PSAiICsKICAgICAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAgICAgIk9oLCBoZWxsbyEiLAogICAgICAgICAgICAgICAgICAgICAgImhleSwgaG93J3MgaXQgaGFuZ2luIiwKICAgICAgICAgICAgICAgICAgICAgICJBYm91dCB0byBjaGVhdCBpbiBzb21lIGNvb2tpZXMgb3IganVzdCBjaGVja2luZyBmb3IgYnVncz8iLAogICAgICAgICAgICAgICAgICAgICAgIlJlbWVtYmVyIDogY2hlYXRlZCBjb29raWVzIHRhc3RlIGF3ZnVsISIsCiAgICAgICAgICAgICAgICAgICAgICAiSGV5LCBPcnRlaWwgaGVyZS4gQ2hlYXRlZCBjb29raWVzIHRhc3RlIGF3ZnVsLi4uIG9yIGRvIHRoZXk/IiwKICAgICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICAgIiA9PT1dIgogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIEdhbWUuTG9hZChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIEdhbWUuSW5pdCgpOwogICAgICAgICAgICAgICAgICBpZiAoZmlyc3RMYXVuY2gpIEdhbWUuc2hvd0xhbmdTZWxlY3Rpb24odHJ1ZSk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIC8vdHJ5IHtHYW1lLkxvYWQoR2FtZS5Jbml0KTt9CiAgICAgICAgICAgICAgICAvL2NhdGNoKGVycikge2NvbnNvbGUubG9nKCdFUlJPUiA6ICcrZXJyLm1lc3NhZ2UpO30KICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIGlmIChBcHAgJiYgQXBwLmxvYWRNb2RzKSBBcHAubG9hZE1vZHMobGF1bmNoKTsKICAgICAgICAgICAgICBlbHNlIGxhdW5jaCgpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH07CiAgICAgICAgfSkobGFuZykKICAgICAgKTsKICAgIH07CgogICAgdmFyIHNob3dMYW5nU2VsZWN0ID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7CiAgICAgIHZhciBzdHIgPSAiIjsKICAgICAgZm9yICh2YXIgaSBpbiBMYW5ncykgewogICAgICAgIHZhciBsYW5nID0gTGFuZ3NbaV07CiAgICAgICAgc3RyICs9CiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGFuZ1NlbGVjdEJ1dHRvbiB0aXRsZSIgaWQ9ImxhbmdTZWxlY3QtJyArCiAgICAgICAgICBpICsKICAgICAgICAgICciPicgKwogICAgICAgICAgbGFuZy5uYW1lICsKICAgICAgICAgICI8L2Rpdj4iOwogICAgICB9CiAgICAgIGwoIm9mZkdhbWVNZXNzYWdlIikuaW5uZXJIVE1MID0KICAgICAgICAnPGRpdiBjbGFzcz0idGl0bGUiIGlkPSJsYW5ndWFnZVNlbGVjdEhlYWRlciI+TGFuZ3VhZ2U8L2Rpdj4nICsKICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSIgc3R5bGU9Im1heC13aWR0aDozMDBweDsiPjwvZGl2PicgKwogICAgICAgIHN0cjsKICAgICAgZm9yICh2YXIgaSBpbiBMYW5ncykgewogICAgICAgIHZhciBsYW5nID0gTGFuZ3NbaV07CiAgICAgICAgQWRkRXZlbnQoCiAgICAgICAgICBsKCJsYW5nU2VsZWN0LSIgKyBpKSwKICAgICAgICAgICJjbGljayIsCiAgICAgICAgICAoZnVuY3Rpb24gKGxhbmcpIHsKICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBjYWxsYmFjayhsYW5nKTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0pKGkpCiAgICAgICAgKTsKICAgICAgICBBZGRFdmVudCgKICAgICAgICAgIGwoImxhbmdTZWxlY3QtIiArIGkpLAogICAgICAgICAgIm1vdXNlb3ZlciIsCiAgICAgICAgICAoZnVuY3Rpb24gKGxhbmcpIHsKICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBQbGF5U291bmQoInNuZC9zbWFsbFRpY2subXAzIiwgMC43NSk7CiAgICAgICAgICAgICAgbCgibGFuZ3VhZ2VTZWxlY3RIZWFkZXIiKS5pbm5lckhUTUwgPSBMYW5nc1tsYW5nXS5jaGFuZ2VMYW5ndWFnZTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0pKGkpCiAgICAgICAgKTsKICAgICAgfQogICAgfTsKCiAgICB2YXIgbGFuZyA9IGxvY2FsU3RvcmFnZUdldCgiQ29va2llQ2xpY2tlckxhbmciKTsKICAgIGlmIChBcHAgJiYgIWxhbmcpIHNob3dMYW5nU2VsZWN0KGxvYWRMYW5nQW5kTGF1bmNoKTsKICAgIGVsc2UgaWYgKCFsYW5nKSB7CiAgICAgIGxvYWRMYW5nQW5kTGF1bmNoKCJFTiIsIHRydWUpOwogICAgfSBlbHNlIGxvYWRMYW5nQW5kTGF1bmNoKGxhbmcpOwogIH0KfTsK"></script>

    <script>
      var VERSION = 2.048;
      var BETA = 0;
      var App = typeof App === "undefined" ? 0 : App;
    </script>

    <link href="style.css" rel="stylesheet" type="text/css" />
    <script src="data:@file/javascript;base64,LyoKQWxsIHRoaXMgY29kZSBpcyBjb3B5cmlnaHQgT3J0ZWlsLCAyMDEzLTIwMjIuCgktd2l0aCBzb21lIGhlbHAsIGFkdmljZSBhbmQgZml4ZXMgYnkgTmljaG9sYXMgTGF1eCwgRGVidWdicm8sIE9wdGksIHRoZSBmb2xrcyBhdCBQbGF5c2F1cnVzLCBhbmQgbG90cyBvZiBwZW9wbGUgb24gcmVkZGl0LCBEaXNjb3JkLCBhbmQgdGhlIERhc2hOZXQgZm9ydW1zCgktYWxzbyBpbmNsdWRlcyBhIGJ1bmNoIG9mIHNuaXBwZXRzIGZvdW5kIG9uIHN0YWNrb3ZlcmZsb3cuY29tIGFuZCBvdGhlcnMKCS13YW50IHRvIG1vZCB0aGUgZ2FtZT8gc2Nyb2xsIGRvd24gdG8gdGhlICJNT0RESU5HIEFQSSIgc2VjdGlvbgpIZWxsbywgYW5kIHdlbGNvbWUgdG8gdGhlIGpveW91cyBtZXNzIHRoYXQgaXMgbWFpbi5qcy4gQ29kZSBjb250YWluZWQgaGVyZWluIGlzIG5vdCBndWFyYW50ZWVkIHRvIGJlIGdvb2QsIGNvbnNpc3RlbnQsIG9yIHNhbmUuIE1vc3Qgb2YgdGhpcyBpcyB5ZWFycyBvbGQgYXQgdGhpcyBwb2ludCBhbmQgaGFya2VucyBiYWNrIHRvIHNpbXBsZXIsIGNydWRlciB0aW1lcy4gSW4gcGFydGljdWxhciBJJ3ZlIHRyaWVkIHRvIG1haW50YWluIGNvbXBhdGliaWxpdHkgd2l0aCBmYWlybHkgb2xkIHZlcnNpb25zIG9mIGphdmFzY3JpcHQsIHdoaWNoIG1lYW5zIGx1eHVyaWVzIHN1Y2ggYXMgJ2xldCcsIGFycm93IGZ1bmN0aW9ucyBhbmQgc3RyaW5nIGxpdGVyYWxzIGFyZSB1bmF2YWlsYWJsZS4KQXMgQ29va2llIENsaWNrZXIgaXMgcmlmZSB3aXRoIHB1bnMgYW5kIHRyaWNreSB3b3JkcGxheSwgbG9jYWxpemF0aW9uIHdhcyBuZXZlciBpbnRlbmRlZCB0byBiZSBwb3NzaWJsZSAtIGJ1dCBlbmRlZCB1cCBoYXBwZW5pbmcgYW55d2F5IGFzIHBhcnQgb2YgdGhlIFN0ZWFtIHBvcnQuIEFzIGEgcmVzdWx0LCB1c2FnZSBvZiBzdHJpbmdzIGlzIHNvbWV3aGF0IHVub3J0aG9kb3ggaW4gc29tZSBwbGFjZXMuCkhhdmUgYSBuaWNlIHRyaXAsIGFuZCBzdGF5IHNhZmUuClNwb2lsZXJzIGFoZWFkLgpodHRwOi8vb3J0ZWlsLmRhc2huZXQub3JnCiovCgovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KTUlTQyBIRUxQRVIgRlVOQ1RJT05TCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCmZ1bmN0aW9uIGwod2hhdCkgewogIHJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh3aGF0KTsKfQpmdW5jdGlvbiBjaG9vc2UoYXJyKSB7CiAgcmV0dXJuIGFycltNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBhcnIubGVuZ3RoKV07Cn0KCmZ1bmN0aW9uIGVzY2FwZVJlZ0V4cChzdHIpIHsKICByZXR1cm4gc3RyLnJlcGxhY2UoL1tcLVxbXF1cL1x7XH1cKFwpXCpcK1w/XC5cXFxeXCRcfF0vZywgIlxcJCYiKTsKfQpmdW5jdGlvbiByZXBsYWNlQWxsKGZpbmQsIHJlcGxhY2UsIHN0cikgewogIHJldHVybiBzdHIucmVwbGFjZShuZXcgUmVnRXhwKGVzY2FwZVJlZ0V4cChmaW5kKSwgImciKSwgcmVwbGFjZSk7Cn0KCmZ1bmN0aW9uIGNhcChzdHIpIHsKICByZXR1cm4gc3RyLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgc3RyLnNsaWNlKDEpOwp9CgpmdW5jdGlvbiByb21hbml6ZShudW0pIHsKICBpZiAoaXNOYU4obnVtKSkgcmV0dXJuIE5hTjsKICB2YXIgZGlnaXRzID0gU3RyaW5nKCtudW0pLnNwbGl0KCIiKSwKICAgIGtleSA9IFsKICAgICAgIiIsCiAgICAgICJDIiwKICAgICAgIkNDIiwKICAgICAgIkNDQyIsCiAgICAgICJDRCIsCiAgICAgICJEIiwKICAgICAgIkRDIiwKICAgICAgIkRDQyIsCiAgICAgICJEQ0NDIiwKICAgICAgIkNNIiwKICAgICAgIiIsCiAgICAgICJYIiwKICAgICAgIlhYIiwKICAgICAgIlhYWCIsCiAgICAgICJYTCIsCiAgICAgICJMIiwKICAgICAgIkxYIiwKICAgICAgIkxYWCIsCiAgICAgICJMWFhYIiwKICAgICAgIlhDIiwKICAgICAgIiIsCiAgICAgICJJIiwKICAgICAgIklJIiwKICAgICAgIklJSSIsCiAgICAgICJJViIsCiAgICAgICJWIiwKICAgICAgIlZJIiwKICAgICAgIlZJSSIsCiAgICAgICJWSUlJIiwKICAgICAgIklYIiwKICAgIF0sCiAgICByb21hbiA9ICIiLAogICAgaSA9IDM7CiAgd2hpbGUgKGktLSkgcm9tYW4gPSAoa2V5WytkaWdpdHMucG9wKCkgKyBpICogMTBdIHx8ICIiKSArIHJvbWFuOwogIHJldHVybiBBcnJheSgrZGlnaXRzLmpvaW4oIiIpICsgMSkuam9pbigiTSIpICsgcm9tYW47Cn0KCi8vZGlzYWJsZSBzb3VuZHMgY29taW5nIGZyb20gc291bmRqYXkuY29tIChzb3JyeSkKdmFyIHJlYWxBdWRpbyA9CiAgdHlwZW9mIEF1ZGlvICE9PSAidW5kZWZpbmVkIgogICAgPyBBdWRpbwogICAgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHt9OwogICAgICB9OyAvL2JhY2t1cCByZWFsIGF1ZGlvCkF1ZGlvID0gZnVuY3Rpb24gKHNyYykgewogIGlmIChzcmMgJiYgc3JjLmluZGV4T2YoInNvdW5kamF5IikgPiAtMSkgewogICAgR2FtZS5Qb3B1cCgiU29ycnksIG5vIHNvdW5kcyBob3RsaW5rZWQgZnJvbSBzb3VuZGpheS5jb20uIik7CiAgICB0aGlzLnBsYXkgPSBmdW5jdGlvbiAoKSB7fTsKICB9IGVsc2UgcmV0dXJuIG5ldyByZWFsQXVkaW8oc3JjKTsKfTsKCmlmICghQXJyYXkucHJvdG90eXBlLmluZGV4T2YpIHsKICBBcnJheS5wcm90b3R5cGUuaW5kZXhPZiA9IGZ1bmN0aW9uIChuZWVkbGUpIHsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykgewogICAgICBpZiAodGhpc1tpXSA9PT0gbmVlZGxlKSB7CiAgICAgICAgcmV0dXJuIGk7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiAtMTsKICB9Owp9CgpmdW5jdGlvbiByYW5kb21GbG9vcih4KSB7CiAgaWYgKHggJSAxIDwgTWF0aC5yYW5kb20oKSkgcmV0dXJuIE1hdGguZmxvb3IoeCk7CiAgZWxzZSByZXR1cm4gTWF0aC5jZWlsKHgpOwp9CgpmdW5jdGlvbiBzaHVmZmxlKGFycmF5KSB7CiAgdmFyIGNvdW50ZXIgPSBhcnJheS5sZW5ndGgsCiAgICB0ZW1wLAogICAgaW5kZXg7CiAgLy8gV2hpbGUgdGhlcmUgYXJlIGVsZW1lbnRzIGluIHRoZSBhcnJheQogIHdoaWxlIChjb3VudGVyLS0pIHsKICAgIC8vIFBpY2sgYSByYW5kb20gaW5kZXgKICAgIGluZGV4ID0gKE1hdGgucmFuZG9tKCkgKiBjb3VudGVyKSB8IDA7CgogICAgLy8gQW5kIHN3YXAgdGhlIGxhc3QgZWxlbWVudCB3aXRoIGl0CiAgICB0ZW1wID0gYXJyYXlbY291bnRlcl07CiAgICBhcnJheVtjb3VudGVyXSA9IGFycmF5W2luZGV4XTsKICAgIGFycmF5W2luZGV4XSA9IHRlbXA7CiAgfQogIHJldHVybiBhcnJheTsKfQoKRWxlbWVudC5wcm90b3R5cGUuZ2V0Qm91bmRzID0gZnVuY3Rpb24gKCkgewogIHZhciBib3VuZHMgPSB0aGlzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogIHZhciBzID0gR2FtZS5zY2FsZTsKICBib3VuZHMueCAvPSBzOwogIGJvdW5kcy55IC89IHM7CiAgYm91bmRzLndpZHRoIC89IHM7CiAgYm91bmRzLmhlaWdodCAvPSBzOwogIGJvdW5kcy50b3AgLz0gczsKICBib3VuZHMuYm90dG9tIC89IHM7CiAgYm91bmRzLmxlZnQgLz0gczsKICBib3VuZHMucmlnaHQgLz0gczsKICByZXR1cm4gYm91bmRzOwp9OwoKdmFyIExvYWRTY3JpcHQgPSBmdW5jdGlvbiAodXJsLCBjYWxsYmFjaywgZXJyb3IpIHsKICB2YXIganMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKTsKICBqcy5zZXRBdHRyaWJ1dGUoInR5cGUiLCAidGV4dC9qYXZhc2NyaXB0Iik7CiAgaWYgKGpzLnJlYWR5U3RhdGUpIHsKICAgIGpzLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKGpzLnJlYWR5U3RhdGUgPT09ICJsb2FkZWQiIHx8IGpzLnJlYWR5U3RhdGUgPT09ICJjb21wbGV0ZSIpIHsKICAgICAgICBqcy5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsOwogICAgICAgIGlmIChjYWxsYmFjaykgY2FsbGJhY2soKTsKICAgICAgfQogICAgfTsKICB9IGVsc2UgaWYgKGNhbGxiYWNrKSB7CiAgICBqcy5vbmxvYWQgPSBjYWxsYmFjazsKICB9CiAgaWYgKGVycm9yKSBqcy5vbmVycm9yID0gZXJyb3I7CgogIGpzLnNldEF0dHJpYnV0ZSgic3JjIiwgdXJsKTsKICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGpzKTsKfTsKCmxvY2FsU3RvcmFnZUdldCA9IGZ1bmN0aW9uIChrZXkpIHsKICB2YXIgbG9jYWwgPSAwOwogIHRyeSB7CiAgICBsb2NhbCA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpOwogIH0gY2F0Y2ggKGV4Y2VwdGlvbikge30KICByZXR1cm4gbG9jYWw7Cn07CmxvY2FsU3RvcmFnZVNldCA9IGZ1bmN0aW9uIChrZXksIHN0cikgewogIHZhciBsb2NhbCA9IDA7CiAgdHJ5IHsKICAgIGxvY2FsID0gd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKGtleSwgc3RyKTsKICB9IGNhdGNoIChleGNlcHRpb24pIHt9CiAgcmV0dXJuIGxvY2FsOwp9OwoKdmFyIGFqYXggPSBmdW5jdGlvbiAodXJsLCBjYWxsYmFjaykgewogIHZhciBodHRwUmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOwogIGlmICghaHR0cFJlcXVlc3QpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CiAgaHR0cFJlcXVlc3Qub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkgewogICAgdHJ5IHsKICAgICAgaWYgKAogICAgICAgIGh0dHBSZXF1ZXN0LnJlYWR5U3RhdGUgPT09IFhNTEh0dHBSZXF1ZXN0LkRPTkUgJiYKICAgICAgICBodHRwUmVxdWVzdC5zdGF0dXMgPT09IDIwMAogICAgICApIHsKICAgICAgICBjYWxsYmFjayhodHRwUmVxdWVzdC5yZXNwb25zZVRleHQpOwogICAgICB9CiAgICB9IGNhdGNoIChlKSB7fQogIH07CiAgLy9odHRwUmVxdWVzdC5vbmVycm9yPWZ1bmN0aW9uKGUpe2NvbnNvbGUubG9nKCdFUlJPUicsZSk7fQogIGlmICh1cmwuaW5kZXhPZigiPyIpID09IC0xKSB1cmwgKz0gIj8iOwogIGVsc2UgdXJsICs9ICImIjsKICB1cmwgKz0gIm5vY2FjaGU9IiArIERhdGUubm93KCk7CiAgaHR0cFJlcXVlc3Qub3BlbigiR0VUIiwgdXJsKTsKICBodHRwUmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAidGV4dC9wbGFpbiIpOwogIGh0dHBSZXF1ZXN0Lm92ZXJyaWRlTWltZVR5cGUoInRleHQvcGxhaW4iKTsKICBodHRwUmVxdWVzdC5zZW5kKCk7CiAgcmV0dXJuIHRydWU7Cn07CgpmdW5jdGlvbiB0b0ZpeGVkKHgpIHsKICBpZiAoTWF0aC5hYnMoeCkgPCAxLjApIHsKICAgIHZhciBlID0gcGFyc2VJbnQoeC50b1N0cmluZygpLnNwbGl0KCJlLSIpWzFdKTsKICAgIGlmIChlKSB7CiAgICAgIHggKj0gTWF0aC5wb3coMTAsIGUgLSAxKTsKICAgICAgeCA9ICIwLiIgKyBuZXcgQXJyYXkoZSkuam9pbigiMCIpICsgeC50b1N0cmluZygpLnN1YnN0cmluZygyKTsKICAgIH0KICB9IGVsc2UgewogICAgdmFyIGUgPSBwYXJzZUludCh4LnRvU3RyaW5nKCkuc3BsaXQoIisiKVsxXSk7CiAgICBpZiAoZSA+IDIwKSB7CiAgICAgIGUgLT0gMjA7CiAgICAgIHggLz0gTWF0aC5wb3coMTAsIGUpOwogICAgICB4ICs9IG5ldyBBcnJheShlICsgMSkuam9pbigiMCIpOwogICAgfQogIH0KICByZXR1cm4geDsKfQoKLy9CZWF1dGlmeSBhbmQgbnVtYmVyLWZvcm1hdHRpbmcgYWRhcHRlZCBmcm9tIHRoZSBGcm96ZW4gQ29va2llcyBhZGQtb24gKGh0dHA6Ly9jb29raWVjbGlja2VyLndpa2lhLmNvbS93aWtpL0Zyb3plbl9Db29raWVzXyUyOEphdmFTY3JpcHRfQWRkLW9uJTI5KQpmdW5jdGlvbiBmb3JtYXRFdmVyeVRoaXJkUG93ZXIobm90YXRpb25zKSB7CiAgcmV0dXJuIGZ1bmN0aW9uICh2YWwpIHsKICAgIHZhciBiYXNlID0gMCwKICAgICAgbm90YXRpb25WYWx1ZSA9ICIiOwogICAgaWYgKCFpc0Zpbml0ZSh2YWwpKSByZXR1cm4gIkluZmluaXR5IjsKICAgIGlmICh2YWwgPj0gMTAwMDAwMCkgewogICAgICB2YWwgLz0gMTAwMDsKICAgICAgd2hpbGUgKE1hdGgucm91bmQodmFsKSA+PSAxMDAwKSB7CiAgICAgICAgdmFsIC89IDEwMDA7CiAgICAgICAgYmFzZSsrOwogICAgICB9CiAgICAgIGlmIChiYXNlID49IG5vdGF0aW9ucy5sZW5ndGgpIHsKICAgICAgICByZXR1cm4gIkluZmluaXR5IjsKICAgICAgfSBlbHNlIHsKICAgICAgICBub3RhdGlvblZhbHVlID0gbm90YXRpb25zW2Jhc2VdOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gTWF0aC5yb3VuZCh2YWwgKiAxMDAwKSAvIDEwMDAgKyBub3RhdGlvblZhbHVlOwogIH07Cn0KCmZ1bmN0aW9uIHJhd0Zvcm1hdHRlcih2YWwpIHsKICByZXR1cm4gTWF0aC5yb3VuZCh2YWwgKiAxMDAwKSAvIDEwMDA7Cn0KCnZhciBmb3JtYXRMb25nID0gWwogICIgdGhvdXNhbmQiLAogICIgbWlsbGlvbiIsCiAgIiBiaWxsaW9uIiwKICAiIHRyaWxsaW9uIiwKICAiIHF1YWRyaWxsaW9uIiwKICAiIHF1aW50aWxsaW9uIiwKICAiIHNleHRpbGxpb24iLAogICIgc2VwdGlsbGlvbiIsCiAgIiBvY3RpbGxpb24iLAogICIgbm9uaWxsaW9uIiwKXTsKdmFyIHByZWZpeGVzID0gWwogICIiLAogICJ1biIsCiAgImR1byIsCiAgInRyZSIsCiAgInF1YXR0dW9yIiwKICAicXVpbiIsCiAgInNleCIsCiAgInNlcHRlbiIsCiAgIm9jdG8iLAogICJub3ZlbSIsCl07CnZhciBzdWZmaXhlcyA9IFsKICAiZGVjaWxsaW9uIiwKICAidmlnaW50aWxsaW9uIiwKICAidHJpZ2ludGlsbGlvbiIsCiAgInF1YWRyYWdpbnRpbGxpb24iLAogICJxdWlucXVhZ2ludGlsbGlvbiIsCiAgInNleGFnaW50aWxsaW9uIiwKICAic2VwdHVhZ2ludGlsbGlvbiIsCiAgIm9jdG9naW50aWxsaW9uIiwKICAibm9uYWdpbnRpbGxpb24iLApdOwpmb3IgKHZhciBpIGluIHN1ZmZpeGVzKSB7CiAgZm9yICh2YXIgaWkgaW4gcHJlZml4ZXMpIHsKICAgIGZvcm1hdExvbmcucHVzaCgiICIgKyBwcmVmaXhlc1tpaV0gKyBzdWZmaXhlc1tpXSk7CiAgfQp9Cgp2YXIgZm9ybWF0U2hvcnQgPSBbImsiLCAiTSIsICJCIiwgIlQiLCAiUWEiLCAiUWkiLCAiU3giLCAiU3AiLCAiT2MiLCAiTm8iXTsKdmFyIHByZWZpeGVzID0gWyIiLCAiVW4iLCAiRG8iLCAiVHIiLCAiUWEiLCAiUWkiLCAiU3giLCAiU3AiLCAiT2MiLCAiTm8iXTsKdmFyIHN1ZmZpeGVzID0gWyJEIiwgIlYiLCAiVCIsICJRYSIsICJRaSIsICJTeCIsICJTcCIsICJPIiwgIk4iXTsKZm9yICh2YXIgaSBpbiBzdWZmaXhlcykgewogIGZvciAodmFyIGlpIGluIHByZWZpeGVzKSB7CiAgICBmb3JtYXRTaG9ydC5wdXNoKCIgIiArIHByZWZpeGVzW2lpXSArIHN1ZmZpeGVzW2ldKTsKICB9Cn0KZm9ybWF0U2hvcnRbMTBdID0gIkRjIjsKCnZhciBudW1iZXJGb3JtYXR0ZXJzID0gWwogIGZvcm1hdEV2ZXJ5VGhpcmRQb3dlcihmb3JtYXRTaG9ydCksCiAgZm9ybWF0RXZlcnlUaGlyZFBvd2VyKGZvcm1hdExvbmcpLAogIHJhd0Zvcm1hdHRlciwKXTsKdmFyIEJlYXV0aWZ5ID0gZnVuY3Rpb24gKHZhbCwgZmxvYXRzKSB7CiAgdmFyIG5lZ2F0aXZlID0gdmFsIDwgMDsKICB2YXIgZGVjaW1hbCA9ICIiOwogIHZhciBmaXhlZCA9IHZhbC50b0ZpeGVkKGZsb2F0cyk7CiAgaWYgKGZsb2F0cyA+IDAgJiYgTWF0aC5hYnModmFsKSA8IDEwMDAgJiYgTWF0aC5mbG9vcihmaXhlZCkgIT0gZml4ZWQpCiAgICBkZWNpbWFsID0gIi4iICsgZml4ZWQudG9TdHJpbmcoKS5zcGxpdCgiLiIpWzFdOwogIHZhbCA9IE1hdGguZmxvb3IoTWF0aC5hYnModmFsKSk7CiAgaWYgKGZsb2F0cyA+IDAgJiYgZml4ZWQgPT0gdmFsICsgMSkgdmFsKys7CiAgLy92YXIgZm9ybWF0PSFFTj8yOkdhbWUucHJlZnMuZm9ybWF0PzI6MTsKICB2YXIgZm9ybWF0ID0gR2FtZS5wcmVmcy5mb3JtYXQgPyAyIDogMTsKICB2YXIgZm9ybWF0dGVyID0gbnVtYmVyRm9ybWF0dGVyc1tmb3JtYXRdOwogIHZhciBvdXRwdXQgPQogICAgdmFsLnRvU3RyaW5nKCkuaW5kZXhPZigiZSsiKSAhPSAtMSAmJiBmb3JtYXQgPT0gMgogICAgICA/IHZhbC50b1ByZWNpc2lvbigzKS50b1N0cmluZygpCiAgICAgIDogZm9ybWF0dGVyKHZhbCkKICAgICAgICAgIC50b1N0cmluZygpCiAgICAgICAgICAucmVwbGFjZSgvXEIoPz0oXGR7M30pKyg/IVxkKSkvZywgIiwiKTsKICAvL3ZhciBvdXRwdXQ9Zm9ybWF0dGVyKHZhbCkudG9TdHJpbmcoKS5yZXBsYWNlKC9cQig/PShcZHszfSkrKD8hXGQpKS9nLCcsJyk7CiAgaWYgKG91dHB1dCA9PSAiMCIpIG5lZ2F0aXZlID0gZmFsc2U7CiAgcmV0dXJuIG5lZ2F0aXZlID8gIi0iICsgb3V0cHV0IDogb3V0cHV0ICsgZGVjaW1hbDsKfTsKdmFyIHNob3J0ZW5OdW1iZXIgPSBmdW5jdGlvbiAodmFsKSB7CiAgLy9pZiBubyBzY2llbnRpZmljIG5vdGF0aW9uLCByZXR1cm4gYXMgaXMsIGVsc2UgOgogIC8va2VlcCBvbmx5IHRoZSA1IGZpcnN0IGRpZ2l0cyAocGx1cyBkb3QpLCByb3VuZCB0aGUgcmVzdAogIC8vbWF5IG9yIG1heSBub3Qgd29yayBwcm9wZXJseQogIGlmICh2YWwgPj0gMTAwMDAwMCAmJiBpc0Zpbml0ZSh2YWwpKSB7CiAgICB2YXIgbnVtID0gdmFsLnRvU3RyaW5nKCk7CiAgICB2YXIgaW5kID0gbnVtLmluZGV4T2YoImUrIik7CiAgICBpZiAoaW5kID09IC0xKSByZXR1cm4gdmFsOwogICAgdmFyIHN0ciA9ICIiOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbmQ7IGkrKykgewogICAgICBzdHIgKz0gaSA8IDYgPyBudW1baV0gOiAiMCI7CiAgICB9CiAgICBzdHIgKz0gImUrIjsKICAgIHN0ciArPSBudW0uc3BsaXQoImUrIilbMV07CiAgICByZXR1cm4gcGFyc2VGbG9hdChzdHIpOwogIH0KICByZXR1cm4gdmFsOwp9OwoKdmFyIFNpbXBsZUJlYXV0aWZ5ID0gZnVuY3Rpb24gKHZhbCkgewogIHZhciBzdHIgPSB2YWwudG9TdHJpbmcoKTsKICB2YXIgc3RyMiA9ICIiOwogIGZvciAodmFyIGkgaW4gc3RyKSB7IC8vYWRkIGNvbW1hcwogICAgaWYgKChzdHIubGVuZ3RoIC0gaSkgJSAzID09IDAgJiYgaSA+IDApIHN0cjIgKz0gIiwiOwogICAgc3RyMiArPSBzdHJbaV07CiAgfQogIHJldHVybiBzdHIyOwp9OwoKdmFyIGJlYXV0aWZ5SW5UZXh0RmlsdGVyID0gLygoW1xkXStbLF0qKSspL2c7IC8vbmV3IHJlZ2V4CmZ1bmN0aW9uIEJlYXV0aWZ5SW5UZXh0RnVuY3Rpb24oc3RyKSB7CiAgcmV0dXJuIEJlYXV0aWZ5KHBhcnNlSW50KHN0ci5yZXBsYWNlKC8sL2csICIiKSwgMTApKTsKfQpmdW5jdGlvbiBCZWF1dGlmeUluVGV4dChzdHIpIHsKICByZXR1cm4gc3RyLnJlcGxhY2UoYmVhdXRpZnlJblRleHRGaWx0ZXIsIEJlYXV0aWZ5SW5UZXh0RnVuY3Rpb24pOwp9IC8vcmVmb3JtYXQgZXZlcnkgbnVtYmVyIGluc2lkZSBhIHN0cmluZwpmdW5jdGlvbiBCZWF1dGlmeUFsbCgpIHsKICAvL3J1biB0aHJvdWdoIHVwZ3JhZGVzIGFuZCBhY2hpZXZlbWVudHMgdG8gcmVmb3JtYXQgdGhlIG51bWJlcnMKICB2YXIgZnVuYyA9IGZ1bmN0aW9uICh3aGF0KSB7CiAgICB3aGF0LmRkZXNjID0gQmVhdXRpZnlJblRleHQod2hhdC5kZGVzYyk7CiAgfTsKICBmb3IgKHZhciBpIGluIEdhbWUuVXBncmFkZXNCeUlkKSB7CiAgICBHYW1lLlVwZ3JhZGVzQnlJZFtpXS5kZGVzYyA9IEJlYXV0aWZ5SW5UZXh0KEdhbWUuVXBncmFkZXNCeUlkW2ldLmRkZXNjKTsKICB9CiAgZm9yICh2YXIgaSBpbiBHYW1lLkFjaGlldmVtZW50c0J5SWQpIHsKICAgIEdhbWUuQWNoaWV2ZW1lbnRzQnlJZFtpXS5kZGVzYyA9IEJlYXV0aWZ5SW5UZXh0KAogICAgICBHYW1lLkFjaGlldmVtZW50c0J5SWRbaV0uZGRlc2MKICAgICk7CiAgfQp9CgovLz09PSBMT0NBTElaQVRJT04gPT09Cgp2YXIgbG9jU3RyaW5ncyA9IHt9Owp2YXIgbG9jU3RyaW5nc0ZhbGxiYWNrID0ge307CnZhciBsb2NJZCA9ICJOT05FIjsKdmFyIEVOID0gdHJ1ZTsKdmFyIGxvY05hbWUgPSAibm9uZSI7CnZhciBsb2NQYXRjaGVzID0gW107CnZhciBsb2NQbHVyID0gIm5wbHVyYWxzPTI7cGx1cmFsPShuIT0xKTsiOyAvL3NlZSBodHRwOi8vZG9jcy50cmFuc2xhdGVob3VzZS5vcmcvcHJvamVjdHMvbG9jYWxpemF0aW9uLWd1aWRlL2VuL2xhdGVzdC9sMTBuL3BsdXJhbGZvcm1zLmh0bWwKdmFyIGxvY1BsdXJGYWxsYmFjayA9IGxvY1BsdXI7Ci8vbm90ZSA6IHBsdXJhbCBpbmRleCB3aWxsIGJlIGRvd25ncmFkZWQgdG8gdGhlIGxhc3QgbWF0Y2hpbmcsIGllLiBpbiB0aGlzIGNhc2UsIGlmIHdlIGdldCAiMCIgYnV0IGRvbid0IGhhdmUgYSAzcmQgb3B0aW9uLCB1c2UgdGhlIDJuZCBvcHRpb24gKG9yIDFzdCwgbGFja2luZyB0aGF0IHRvbykKdmFyIGxvY1N0cmluZ3NCeVBhcnQgPSB7fTsKdmFyIEZpbmRMb2NTdHJpbmdCeVBhcnQgPSBmdW5jdGlvbiAobWF0Y2gpIHsKICByZXR1cm4gbG9jU3RyaW5nc0J5UGFydFttYXRjaF0gfHwgdW5kZWZpbmVkOwogIC8qCgkvL25vdGU6IHNsb3csIG9ubHkgZG8gdGhpcyBvbiBpbml0Cglmb3IgKHZhciBpIGluIGxvY1N0cmluZ3MpewoJCXZhciBiaXQ9aS5zcGxpdCgnXScpOwoJCWlmIChiaXRbMF0uc3Vic3RyaW5nKDEpPT1tYXRjaCkgcmV0dXJuIGk7Cgl9CglyZXR1cm4gdW5kZWZpbmVkOwoJKi8KfTsKCnZhciBMYW5ncyA9IHsKICBFTjogewogICAgZmlsZTogIkVOIiwKICAgIG5hbWVFTjogIkVuZ2xpc2giLAogICAgbmFtZTogIkVuZ2xpc2giLAogICAgY2hhbmdlTGFuZ3VhZ2U6ICJMYW5ndWFnZSIsCiAgICBpY29uOiAwLAogICAgdzogMSwKICAgIGlzRU46IHRydWUsCiAgfSwKICBGUjogewogICAgZmlsZTogIkZSIiwKICAgIG5hbWVFTjogIkZyZW5jaCIsCiAgICBuYW1lOiAiRnJhbiZjY2VkaWw7YWlzIiwKICAgIGNoYW5nZUxhbmd1YWdlOiAiTGFuZ3VlIiwKICAgIGljb246IDAsCiAgICB3OiAxLAogIH0sCiAgREU6IHsKICAgIGZpbGU6ICJERSIsCiAgICBuYW1lRU46ICJHZXJtYW4iLAogICAgbmFtZTogIkRldXRzY2giLAogICAgY2hhbmdlTGFuZ3VhZ2U6ICJTcHJhY2hlIiwKICAgIGljb246IDAsCiAgICB3OiAxLAogIH0sCiAgTkw6IHsKICAgIGZpbGU6ICJOTCIsCiAgICBuYW1lRU46ICJEdXRjaCIsCiAgICBuYW1lOiAiTmVkZXJsYW5kcyIsCiAgICBjaGFuZ2VMYW5ndWFnZTogIlRhYWwiLAogICAgaWNvbjogMCwKICAgIHc6IDEsCiAgfSwKICBDUzogewogICAgZmlsZTogIkNTIiwKICAgIG5hbWVFTjogIkN6ZWNoIiwKICAgIG5hbWU6ICImI3gxMEM7ZSYjeDE2MTt0aW5hIiwKICAgIGNoYW5nZUxhbmd1YWdlOiAiSmF6eWsiLAogICAgaWNvbjogMCwKICAgIHc6IDEsCiAgfSwKICBQTDogewogICAgZmlsZTogIlBMIiwKICAgIG5hbWVFTjogIlBvbGlzaCIsCiAgICBuYW1lOiAiUG9sc2tpIiwKICAgIGNoYW5nZUxhbmd1YWdlOiAiSiYjMjgxO3p5ayIsCiAgICBpY29uOiAwLAogICAgdzogMSwKICB9LAogIElUOiB7CiAgICBmaWxlOiAiSVQiLAogICAgbmFtZUVOOiAiSXRhbGlhbiIsCiAgICBuYW1lOiAiSXRhbGlhbm8iLAogICAgY2hhbmdlTGFuZ3VhZ2U6ICJMaW5ndWEiLAogICAgaWNvbjogMCwKICAgIHc6IDEsCiAgfSwKICBFUzogewogICAgZmlsZTogIkVTIiwKICAgIG5hbWVFTjogIlNwYW5pc2giLAogICAgbmFtZTogIkVzcGEmI3hGMTtvbCIsCiAgICBjaGFuZ2VMYW5ndWFnZTogIklkaW9tYSIsCiAgICBpY29uOiAwLAogICAgdzogMSwKICB9LAogICJQVC1CUiI6IHsKICAgIGZpbGU6ICJQVC1CUiIsCiAgICBuYW1lRU46ICJQb3J0dWd1ZXNlIiwKICAgIG5hbWU6ICJQb3J0dWd1JiN4RUE7cyIsCiAgICBjaGFuZ2VMYW5ndWFnZTogIklkaW9tYSIsCiAgICBpY29uOiAwLAogICAgdzogMSwKICB9LAogIEpBOiB7CiAgICBmaWxlOiAiSkEiLAogICAgbmFtZUVOOiAiSmFwYW5lc2UiLAogICAgbmFtZTogIiYjeDY1RTU7JiN4NjcyQzsmI3g4QTlFOyIsCiAgICBjaGFuZ2VMYW5ndWFnZTogIiYjMzUzMjg7JiMzNTQ4NjsiLAogICAgaWNvbjogMCwKICAgIHc6IDEuNSwKICB9LAogICJaSC1DTiI6IHsKICAgIGZpbGU6ICJaSC1DTiIsCiAgICBuYW1lRU46ICJDaGluZXNlIiwKICAgIG5hbWU6ICImI3g0RTJEOyYjeDY1ODc7IiwKICAgIGNoYW5nZUxhbmd1YWdlOiAiJiMzNTgyMTsmIzM1MzI4OyIsCiAgICBpY29uOiAwLAogICAgdzogMS41LAogIH0sCiAgS086IHsKICAgIGZpbGU6ICJLTyIsCiAgICBuYW1lRU46ICJLb3JlYW4iLAogICAgbmFtZTogIiYjeEQ1NUM7JiN4QUUwMDsiLAogICAgY2hhbmdlTGFuZ3VhZ2U6ICImI3hDNUI4OyYjeEM1QjQ7IiwKICAgIGljb246IDAsCiAgICB3OiAxLjUsCiAgfSwKICBSVTogewogICAgZmlsZTogIlJVIiwKICAgIG5hbWVFTjogIlJ1c3NpYW4iLAogICAgbmFtZTogIiYjeDQyMDsmI3g0NDM7JiN4NDQxOyYjeDQ0MTsmI3g0M0E7JiN4NDM4OyYjeDQzOTsiLAogICAgY2hhbmdlTGFuZ3VhZ2U6ICImIzEwNzE7JiMxMDc5OyYjMTA5OTsmIzEwODI7IiwKICAgIGljb246IDAsCiAgICB3OiAxLjIsCiAgfSwKfTsKCi8vbm90ZSA6IGJhc2VsaW5lIHNob3VsZCBiZSB0aGUgb3JpZ2luYWwgZW5nbGlzaCB0ZXh0Ci8vaW4gc2V2ZXJhbCBpbnN0YW5jZXMsIHRoZSBlbmdsaXNoIHRleHQgd2lsbCBiZSBxdWl0ZSBkaWZmZXJlbnQgZnJvbSB0aGUgb3RoZXIgbGFuZ3VhZ2VzLCBhcyB0aGlzIGdhbWUgd2FzIGluaXRpYWxseSBuZXZlciBtZWFudCB0byBiZSB0cmFuc2xhdGVkIGFuZCB0aGUgdHJhbnNsYXRpb24gcHJvY2VzcyBkb2Vzbid0IGFsd2F5cyBwbGF5IHdlbGwgd2l0aCBjb21wbGV4IHNlbnRlbmNlIHN0cnVjdHVyZXMKLyp1c2U6Cglsb2MoJ1BsYWluIHRleHQnKQoJbG9jKCdUZXh0IHdoZXJlICUxIGlzIGEgcGFyYW1ldGVyJywnc29tZXRoaW5nJykKCWxvYygnVGV4dCB3aGVyZSAlMSBhbmQgJTIgYXJlIHBhcmFtZXRlcnMnLFsnYSB0aGluZycsJ2Fub3RoZXIgdGhpbmcnXSkKCWxvYygnVGhlcmUgaXMgJTEgYXBwbGUnLDUpCgkJIC4uLmlmIHRoZSBsb2NhbGl6ZWQgc3RyaW5nIGlzIGFuIGFycmF5LCB0aGlzIGlzIHBhcnNlZCBhcyBhIHBsdXJhbGl6ZWQgc3RyaW5nOyBmb3IgaW5zdGFuY2UsIHRoZSBsb2NhbGl6ZWQgc3RyaW5nIGNvdWxkIGJlCgkJIlRoZXJlIGlzICUxIGFwcGxlIjpbCgkJCSJUaGVyZSBpcyAlMSBhcHBsZSIsCgkJCSJUaGVyZSBhcmUgJTEgYXBwbGVzIgoJCV0KCWxvYygnVGhlcmUgaXMgJTEgYXBwbGUgYW5kIGFsc28sICUyIScsWzUsJ2hlbGxvJ10pCglsb2MoJ1RoaXMgc3RyaW5nIGlzIGxvY2FsaXplZC4nLDAsJ1RoaXMgaXMgdGhlIHN0cmluZyBkaXNwbGF5ZWQgaW4gdGhlIGVuZ2xpc2ggdmVyc2lvbi4nKQoJbG9jKCdZb3UgaGF2ZSAlMS4nLCc8Yj4nK2xvYygnJTEgYXBwbGUnLExCZWF1dGlmeShhbW91bnQpKSsnPC9iPicpCgkJLi4ueW91IG1heSBuZXN0IGxvY2FsaXplZCBzdHJpbmdzLCBhbmQgdXNlIExCZWF1dGlmeSgpIHRvIHBhY2sgQmVhdXRpZmllZCB2YWx1ZXMKKi8KdmFyIGxvY0JsaW5rID0gZmFsc2U7CnZhciBsb2NhbGl6YXRpb25Ob3RGb3VuZCA9IFtdOwp2YXIgbG9jID0gZnVuY3Rpb24gKGlkLCBwYXJhbXMsIGJhc2VsaW5lKSB7CiAgdmFyIGZhbGxiYWNrID0gZmFsc2U7CiAgdmFyIGZvdW5kID0gbG9jU3RyaW5nc1tpZF07CiAgaWYgKCFmb3VuZCkgewogICAgZm91bmQgPSBsb2NTdHJpbmdzRmFsbGJhY2tbaWRdOwogICAgZmFsbGJhY2sgPSB0cnVlOwogIH0KICBpZiAoZm91bmQpIHsKICAgIHZhciBzdHIgPSAiIjsKICAgIHN0ciA9IHBhcnNlTG9jKGZvdW5kLCBwYXJhbXMpOwogICAgLy9yZXR1cm4gc3RyOwogICAgaWYgKHN0ci5jb25zdHJ1Y3RvciA9PT0gQXJyYXkpIHJldHVybiBzdHI7CiAgICBpZiAobG9jQmxpbmsgJiYgIWZhbGxiYWNrKQogICAgICByZXR1cm4gJzxzcGFuIGNsYXNzPSJibGlua2luZyI+JyArIHN0ciArICI8L3NwYW4+IjsgLy93aWxsIG1ha2UgZXZlcnkgbG9jYWxpemVkIHRleHQgYmxpbmsgb24gc2NyZWVuLCBtYWtpbmcgb21pc3Npb25zIG9idmlvdXM7IHdpbGwgbm90IHdvcmsgZm9yIGVsZW1lbnRzIGZpbGxlZCB3aXRoIHRleHRDb250ZW50CiAgfQoKICAvL2lmICgoZmFsbGJhY2sgfHwgIWZvdW5kKSAmJiBsb2NhbGl6YXRpb25Ob3RGb3VuZC5sZW5ndGg8MjAgJiYgbG9jYWxpemF0aW9uTm90Rm91bmQuaW5kZXhPZihpZCk9PS0xKXtsb2NhbGl6YXRpb25Ob3RGb3VuZC5wdXNoKGlkKTtjb25zb2xlLnRyYWNlKCdsb2NhbGl6YXRpb24gc3RyaW5nIG5vdCBmb3VuZDogJyxpZCk7fQogIGlmIChmb3VuZCkgcmV0dXJuIHN0cjsKICByZXR1cm4gYmFzZWxpbmUgfHwgaWQ7Cn07Cgp2YXIgcGFyc2VMb2MgPSBmdW5jdGlvbiAoc3RyLCBwYXJhbXMpIHsKICAvKgoJCXBhcnNlcyBsb2NhbGl6YXRpb24gc3RyaW5ncwoJCS10aGVyZSBjYW4gb25seSBiZSAxIHBsdXJhbCBwZXIgc3RyaW5nIGFuZCBpdCBNVVNUIGJlIGF0IGluZGV4ICUxCgkJLWEgcGx1cmFsaXplZCBzdHJpbmcgaXMgZGV0ZWN0ZWQgaWYgd2UgaGF2ZSBhdCBsZWFzdCAxIHBhcmFtIGFuZCB0aGUgbWF0Y2hpbmcgbG9jYWxpemVkIHN0cmluZyBpcyBhbiBhcnJheQoJKi8KICBpZiAodHlwZW9mIHBhcmFtcyA9PT0gInVuZGVmaW5lZCIpIHBhcmFtcyA9IFtdOwogIGVsc2UgaWYgKHBhcmFtcy5jb25zdHJ1Y3RvciAhPT0gQXJyYXkpIHBhcmFtcyA9IFtwYXJhbXNdOwogIGlmICghc3RyKSByZXR1cm4gIiI7CiAgLy9pZiAoc3RyLmNvbnN0cnVjdG9yPT09QXJyYXkpIHJldHVybiBzdHI7CiAgLy9pZiAodHlwZW9mIHN0cj09PSdmdW5jdGlvbicpIHJldHVybiBzdHIocGFyYW1zKTsKICAvL3N0cj1zdHIucmVwbGFjZSgvW1x0XG5ccl0vZ20sJycpOwoKICBpZiAocGFyYW1zLmxlbmd0aCA9PSAwKSByZXR1cm4gc3RyOwoKICBpZiAoc3RyLmNvbnN0cnVjdG9yID09PSBBcnJheSkgewogICAgaWYgKHR5cGVvZiBwYXJhbXNbMF0gPT09ICJvYmplY3QiKSB7CiAgICAgIC8vYW4gb2JqZWN0IGNvbnRhaW5pbmcgYSBiZWF1dGlmaWVkIG51bWJlcgogICAgICB2YXIgcGx1ckluZGV4ID0gbG9jUGx1cihwYXJhbXNbMF0ubik7CiAgICAgIHBsdXJJbmRleCA9IE1hdGgubWluKHN0ci5sZW5ndGggLSAxLCBwbHVySW5kZXgpOwogICAgICBzdHIgPSBzdHJbcGx1ckluZGV4XTsKICAgICAgc3RyID0gcmVwbGFjZUFsbCgiJTEiLCBwYXJhbXNbMF0uYiwgc3RyKTsKICAgIH0gZWxzZSB7CiAgICAgIHZhciBwbHVySW5kZXggPSBsb2NQbHVyKHBhcmFtc1swXSk7CiAgICAgIHBsdXJJbmRleCA9IE1hdGgubWluKHN0ci5sZW5ndGggLSAxLCBwbHVySW5kZXgpOwogICAgICBzdHIgPSBzdHJbcGx1ckluZGV4XTsKICAgICAgc3RyID0gcmVwbGFjZUFsbCgiJTEiLCBwYXJhbXNbMF0sIHN0cik7CiAgICB9CiAgfQoKICB2YXIgb3V0ID0gIiI7CiAgdmFyIGxlbiA9IHN0ci5sZW5ndGg7CiAgdmFyIGluUGVyY2VudCA9IGZhbHNlOwogIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKICAgIHZhciBpdCA9IHN0cltpXTsKICAgIGlmIChpblBlcmNlbnQpIHsKICAgICAgaW5QZXJjZW50ID0gZmFsc2U7CiAgICAgIGlmICghaXNOYU4oaXQpICYmIHBhcmFtcy5sZW5ndGggPj0gcGFyc2VJbnQoaXQpIC0gMSkKICAgICAgICBvdXQgKz0gcGFyYW1zW3BhcnNlSW50KGl0KSAtIDFdOwogICAgICBlbHNlIG91dCArPSAiJSIgKyBpdDsKICAgIH0gZWxzZSBpZiAoaXQgPT0gIiUiKSBpblBlcmNlbnQgPSB0cnVlOwogICAgZWxzZSBvdXQgKz0gaXQ7CiAgfQogIHJldHVybiBvdXQ7Cn07Cgp2YXIgTEJlYXV0aWZ5ID0gZnVuY3Rpb24gKHZhbCwgZmxvYXRzKSB7CiAgLy9yZXR1cm5zIGFuIG9iamVjdCBpbiB0aGUgZm9ybSB7bjpvcmlnaW5hbCB2YWx1ZSBmbG9vcmVkLGI6YmVhdXRpZmllZCB2YWx1ZSBhcyBzdHJpbmd9IGZvciBsb2NhbGl6YXRpb24gcHVycG9zZXMKICByZXR1cm4geyBuOiBNYXRoLmZsb29yKE1hdGguYWJzKHZhbCkpLCBiOiBCZWF1dGlmeSh2YWwsIGZsb2F0cykgfTsKfTsKCnZhciBNb2RMYW5ndWFnZSA9IGZ1bmN0aW9uIChpZCwganNvbikgewogIGlmIChpZCA9PSAiKiIpIGlkID0gbG9jSWQ7CiAgaWYgKGlkICE9IGxvY0lkIHx8ICFMYW5nc1tpZF0pIHJldHVybiBmYWxzZTsKICBpZiAoanNvblsiUkVQTEFDRSBBTEwiXSkgewogICAgdmFyIHJlcCA9IGZ1bmN0aW9uIChzdHIsIGZyb20sIHRvKSB7CiAgICAgIHZhciByZWdleCA9IG5ldyBSZWdFeHAoZnJvbSwgImlnIik7CiAgICAgIHJldHVybiBzdHIucmVwbGFjZShyZWdleCwgZnVuY3Rpb24gKG1hdGNoKSB7CiAgICAgICAgcmV0dXJuIG1hdGNoWzBdID09IG1hdGNoWzBdLnRvTG93ZXJDYXNlKCkgPyB0byA6IGNhcCh0byk7CiAgICAgIH0pOwogICAgfTsKICAgIGZvciAodmFyIGkgaW4ganNvblsiUkVQTEFDRSBBTEwiXSkgewogICAgICB2YXIgdG8gPSBqc29uWyJSRVBMQUNFIEFMTCJdW2ldOwogICAgICBmb3IgKHZhciBpaSBpbiBsb2NTdHJpbmdzKSB7CiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkobG9jU3RyaW5nc1tpaV0pKSB7CiAgICAgICAgICBmb3IgKHZhciBpaWkgaW4gbG9jU3RyaW5nc1tpaV0pIHsKICAgICAgICAgICAgbG9jU3RyaW5nc1tpaV1baWlpXSA9IHJlcChsb2NTdHJpbmdzW2lpXVtpaWldLCBpLCB0byk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGxvY1N0cmluZ3NbaWldID0gcmVwKGxvY1N0cmluZ3NbaWldLCBpLCB0byk7CiAgICAgIH0KICAgIH0KICB9CiAgZGVsZXRlIGpzb25bIlJFUExBQ0UgQUxMIl07CiAgQWRkTGFuZ3VhZ2UoaWQsIExhbmdzW2lkXS5uYW1lLCBqc29uLCB0cnVlKTsKfTsKCnZhciBBZGRMYW5ndWFnZSA9IGZ1bmN0aW9uIChpZCwgbmFtZSwganNvbiwgbW9kKSB7CiAgLy91c2VkIGluIGxvYyBmaWxlcwogIC8vaWYgbW9kIGlzIHRydWUsIHRoaXMgZmlsZSBpcyBhdWdtZW50aW5nIHRoZSBjdXJyZW50IGxhbmd1YWdlCiAgaWYgKGlkID09IGxvY0lkICYmICFtb2QpIHJldHVybiBmYWxzZTsgLy9kb24ndCBsb2FkIHR3aWNlCiAgaWYgKCFMYW5nc1tpZF0pIHJldHVybiBmYWxzZTsKICBsb2NJZCA9IGlkOwogIGlmIChMYW5nc1tsb2NJZF0uaXNFTikgRU4gPSB0cnVlOwogIGVsc2UgRU4gPSBmYWxzZTsKICBsb2NOYW1lID0gTGFuZ3NbaWRdLm5hbWVFTjsgLy9uYW1lCgogIGlmIChtb2QpIHsKICAgIGZvciAodmFyIGkgaW4ganNvbikgewogICAgICBsb2NTdHJpbmdzW2ldID0ganNvbltpXTsKICAgIH0KICAgIGZvciAodmFyIGkgaW4gbG9jU3RyaW5ncykgewogICAgICB2YXIgYml0ID0gaS5zcGxpdCgiXSIpOwogICAgICBpZiAoCiAgICAgICAgYml0WzFdICYmCiAgICAgICAgYml0WzBdLmluZGV4T2YoIltDT01NRU5UOiIpICE9IDAgJiYKICAgICAgICAhbG9jU3RyaW5nc0J5UGFydFtiaXRbMF0uc3Vic3RyaW5nKDEpXQogICAgICApCiAgICAgICAgbG9jU3RyaW5nc0J5UGFydFtiaXRbMF0uc3Vic3RyaW5nKDEpXSA9IGk7CiAgICB9CiAgICBjb25zb2xlLmxvZygnQXVnbWVudGVkIGxhbmd1YWdlICInICsgbG9jTmFtZSArICciLicpOwogIH0gZWxzZSB7CiAgICBsb2NTdHJpbmdzID0ganNvbjsKICAgIGxvY1BsdXIgPSBqc29uWyIiXVsicGx1cmFsLWZvcm1zIl0gfHwgbG9jUGx1ckZhbGxiYWNrOwogICAgZGVsZXRlIGxvY1N0cmluZ3NbIiJdOwogICAgZm9yICh2YXIgaSBpbiBsb2NTdHJpbmdzKSB7CiAgICAgIGlmIChsb2NTdHJpbmdzW2ldID09ICIvIikgbG9jU3RyaW5nc1tpXSA9IGk7CiAgICB9CgogICAgbG9jUGx1ciA9IChmdW5jdGlvbiAocGx1cmFsX2Zvcm0pIHsKICAgICAgLy9saWZ0ZWQgYW5kIG1vZGlmaWVkIGZyb20gZ2V0dGV4dC5qcwogICAgICB2YXIgcGZfcmUgPSBuZXcgUmVnRXhwKAogICAgICAgICJeXFxzKm5wbHVyYWxzXFxzKj1cXHMqWzAtOV0rXFxzKjtcXHMqcGx1cmFsXFxzKj1cXHMqKD86XFxzfFstXFw/XFx8Jj0hPD4rKi8lOjtuMC05XygpXSkrIgogICAgICApOwogICAgICBpZiAoIXBmX3JlLnRlc3QocGx1cmFsX2Zvcm0pKQogICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIHBsdXJhbCBmb3JtICInICsgcGx1cmFsX2Zvcm0gKyAnIiBpcyBub3QgdmFsaWQnKTsKICAgICAgcmV0dXJuIG5ldyBGdW5jdGlvbigKICAgICAgICAibiIsCiAgICAgICAgInZhciBwbHVyYWwsIG5wbHVyYWxzOyAiICsgcGx1cmFsX2Zvcm0gKyAiIHJldHVybiBwbHVyYWw7IgogICAgICApOwogICAgICAvL3JldHVybiBuZXcgRnVuY3Rpb24oJ24nLCd2YXIgcGx1cmFsLCBucGx1cmFsczsgJysgcGx1cmFsX2Zvcm0gKycgcmV0dXJuIHsgbnBsdXJhbHM6IG5wbHVyYWxzLCBwbHVyYWw6IChwbHVyYWwgPT09IHRydWUgPyAxIDogKHBsdXJhbCA/IHBsdXJhbCA6IDApKSB9OycpOwogICAgfSkobG9jUGx1cik7CgogICAgbG9jUGF0Y2hlcyA9IFtdOwogICAgZm9yICh2YXIgaSBpbiBsb2NTdHJpbmdzKSB7CiAgICAgIGlmIChpLnNwbGl0KCJ8IilbMF0gPT0gIlVwZGF0ZSBub3RlcyIpIHsKICAgICAgICB2YXIgcGF0Y2ggPSBpLnNwbGl0KCJ8Iik7CiAgICAgICAgdmFyIHBhdGNoVHJhbnNsYXRlZCA9IGxvY1N0cmluZ3NbaV0uc3BsaXQoInwiKTsKICAgICAgICBsb2NQYXRjaGVzLnB1c2goewogICAgICAgICAgaWQ6IHBhcnNlSW50KHBhdGNoWzFdKSwKICAgICAgICAgIHR5cGU6IDEsCiAgICAgICAgICB0aXRsZTogcGF0Y2hUcmFuc2xhdGVkWzJdLAogICAgICAgICAgcG9pbnRzOiBwYXRjaFRyYW5zbGF0ZWQuc2xpY2UoMyksCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICAgIHZhciBzb3J0TWFwID0gZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgaWYgKGEuaWQgPCBiLmlkKSByZXR1cm4gMTsKICAgICAgZWxzZSByZXR1cm4gLTE7CiAgICB9OwogICAgbG9jUGF0Y2hlcy5zb3J0KHNvcnRNYXApOwoKICAgIGZvciAodmFyIGkgaW4gbG9jU3RyaW5ncykgewogICAgICB2YXIgYml0ID0gaS5zcGxpdCgiXSIpOwogICAgICBpZiAoCiAgICAgICAgYml0WzFdICYmCiAgICAgICAgYml0WzBdLmluZGV4T2YoIltDT01NRU5UOiIpICE9IDAgJiYKICAgICAgICAhbG9jU3RyaW5nc0J5UGFydFtiaXRbMF0uc3Vic3RyaW5nKDEpXQogICAgICApCiAgICAgICAgbG9jU3RyaW5nc0J5UGFydFtiaXRbMF0uc3Vic3RyaW5nKDEpXSA9IGk7CiAgICB9CgogICAgY29uc29sZS5sb2coJ0xvYWRlZCBsYW5ndWFnZSAiJyArIGxvY05hbWUgKyAnIi4nKTsKICB9Cn07Cgp2YXIgTG9hZExhbmcgPSBMb2FkU2NyaXB0OwoKdmFyIExvY2FsaXplVXBncmFkZXNBbmRBY2hpZXZzID0gZnVuY3Rpb24gKCkgewogIGlmICghR2FtZS5VcGdyYWRlc0J5SWQpIHJldHVybiBmYWxzZTsKCiAgdmFyIGFsbFRoaW5ncyA9IFtdOwogIGZvciAodmFyIGkgaW4gR2FtZS5VcGdyYWRlc0J5SWQpIHsKICAgIGFsbFRoaW5ncy5wdXNoKEdhbWUuVXBncmFkZXNCeUlkW2ldKTsKICB9CiAgZm9yICh2YXIgaSBpbiBHYW1lLkFjaGlldmVtZW50c0J5SWQpIHsKICAgIGFsbFRoaW5ncy5wdXNoKEdhbWUuQWNoaWV2ZW1lbnRzQnlJZFtpXSk7CiAgfQogIGZvciAodmFyIGkgPSAwOyBpIDwgYWxsVGhpbmdzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgaXQgPSBhbGxUaGluZ3NbaV07CiAgICB2YXIgdHlwZSA9IGl0LmdldFR5cGUoKTsKICAgIHZhciBmb3VuZCA9IDA7CiAgICBmb3VuZCA9IEZpbmRMb2NTdHJpbmdCeVBhcnQodHlwZSArICIgbmFtZSAiICsgaXQuaWQpOwogICAgaWYgKGZvdW5kKSBpdC5kbmFtZSA9IGxvYyhmb3VuZCk7CgogICAgaWYgKCFFTikgaXQuYmFzZURlc2MgPSBpdC5iYXNlRGVzYy5yZXBsYWNlKC88cT4uKi8sICIiKTsgLy9zdHJpcCBxdW90ZSBzZWN0aW9uCiAgICBpdC5kZGVzYyA9IEJlYXV0aWZ5SW5UZXh0KGl0LmJhc2VEZXNjKTsKCiAgICBmb3VuZCA9IEZpbmRMb2NTdHJpbmdCeVBhcnQodHlwZSArICIgZGVzYyAiICsgaXQuaWQpOwogICAgaWYgKGZvdW5kKSBpdC5kZGVzYyA9IGxvYyhmb3VuZCk7CiAgICBmb3VuZCA9IEZpbmRMb2NTdHJpbmdCeVBhcnQodHlwZSArICIgcXVvdGUgIiArIGl0LmlkKTsKICAgIGlmIChmb3VuZCkgaXQuZGRlc2MgKz0gIjxxPiIgKyBsb2MoZm91bmQpICsgIjwvcT4iOwogIH0KICBCZWF1dGlmeUFsbCgpOwp9Owp2YXIgZ2V0VXBncmFkZU5hbWUgPSBmdW5jdGlvbiAobmFtZSkgewogIHZhciBpdCA9IEdhbWUuVXBncmFkZXNbbmFtZV07CiAgdmFyIGZvdW5kID0gRmluZExvY1N0cmluZ0J5UGFydCgiVXBncmFkZSBuYW1lICIgKyBpdC5pZCk7CiAgaWYgKGZvdW5kKSByZXR1cm4gbG9jKGZvdW5kKTsKICBlbHNlIHJldHVybiBuYW1lOwp9Owp2YXIgZ2V0QWNoaWV2ZW1lbnROYW1lID0gZnVuY3Rpb24gKG5hbWUpIHsKICB2YXIgaXQgPSBHYW1lLkFjaGlldmVtZW50c1tuYW1lXTsKICB2YXIgZm91bmQgPSBGaW5kTG9jU3RyaW5nQnlQYXJ0KCJBY2hpZXZlbWVudCBuYW1lICIgKyBpdC5pZCk7CiAgaWYgKGZvdW5kKSByZXR1cm4gbG9jKGZvdW5kKTsKICBlbHNlIHJldHVybiBuYW1lOwp9OwoKLy90aGVzZSBhcmUgZmF1bHR5LCBpbnZlc3RpZ2F0ZSBsYXRlcgovL2Z1bmN0aW9uIHV0ZjhfdG9fYjY0KHN0cil7cmV0dXJuIGJ0b2Eoc3RyKTt9Ci8vZnVuY3Rpb24gYjY0X3RvX3V0Zjgoc3RyKXtyZXR1cm4gYXRvYihzdHIpO30KCi8qZnVuY3Rpb24gdXRmOF90b19iNjQoIHN0ciApIHsKCXRyeXtyZXR1cm4gQmFzZTY0LmVuY29kZSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoIHN0ciApKSk7fQoJY2F0Y2goZXJyKQoJe3JldHVybiAnJzt9Cn0KCmZ1bmN0aW9uIGI2NF90b191dGY4KCBzdHIgKSB7Cgl0cnl7cmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChlc2NhcGUoQmFzZTY0LmRlY29kZSggc3RyICkpKTt9CgljYXRjaChlcnIpCgl7cmV0dXJuICcnO30KfSovCgovL3BoZXdpZSEgaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMzAxMDY0NzYvdXNpbmctamF2YXNjcmlwdHMtYXRvYi10by1kZWNvZGUtYmFzZTY0LWRvZXNudC1wcm9wZXJseS1kZWNvZGUtdXRmLTgtc3RyaW5ncwpmdW5jdGlvbiB1dGY4X3RvX2I2NChzdHIpIHsKICB0cnkgewogICAgcmV0dXJuIGJ0b2EoCiAgICAgIGVuY29kZVVSSUNvbXBvbmVudChzdHIpLnJlcGxhY2UoLyUoWzAtOUEtRl17Mn0pL2csIGZ1bmN0aW9uIChtYXRjaCwgcDEpIHsKICAgICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShwYXJzZUludChwMSwgMTYpKTsKICAgICAgfSkKICAgICk7CiAgfSBjYXRjaCAoZXJyKSB7CiAgICByZXR1cm4gIiI7CiAgfQp9CgpmdW5jdGlvbiBiNjRfdG9fdXRmOChzdHIpIHsKICB0cnkgewogICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudCgKICAgICAgQXJyYXkucHJvdG90eXBlLm1hcAogICAgICAgIC5jYWxsKGF0b2Ioc3RyKSwgZnVuY3Rpb24gKGMpIHsKICAgICAgICAgIHJldHVybiAiJSIgKyAoIjAwIiArIGMuY2hhckNvZGVBdCgwKS50b1N0cmluZygxNikpLnNsaWNlKC0yKTsKICAgICAgICB9KQogICAgICAgIC5qb2luKCIiKQogICAgKTsKICB9IGNhdGNoIChlcnIpIHsKICAgIHJldHVybiAiIjsKICB9Cn0KCmZ1bmN0aW9uIENvbXByZXNzQmluKGFycikgewogIC8vY29tcHJlc3MgYSBzZXF1ZW5jZSBsaWtlIFswLDEsMSwwLDEsMF0uLi4gaW50byBhIG51bWJlciBsaWtlIDU0LgogIHZhciBzdHIgPSAiIjsKICB2YXIgYXJyMiA9IGFyci5zbGljZSgwKTsKICBhcnIyLnVuc2hpZnQoMSk7CiAgYXJyMi5wdXNoKDEpOwogIGFycjIucmV2ZXJzZSgpOwogIGZvciAodmFyIGkgaW4gYXJyMikgewogICAgc3RyICs9IGFycjJbaV07CiAgfQogIHN0ciA9IHBhcnNlSW50KHN0ciwgMik7CiAgcmV0dXJuIHN0cjsKfQoKZnVuY3Rpb24gVW5jb21wcmVzc0JpbihudW0pIHsKICAvL3VuY29tcHJlc3MgYSBudW1iZXIgbGlrZSA1NCB0byBhIHNlcXVlbmNlIGxpa2UgWzAsMSwxLDAsMSwwXS4KICB2YXIgYXJyID0gbnVtLnRvU3RyaW5nKDIpOwogIGFyciA9IGFyci5zcGxpdCgiIik7CiAgYXJyLnJldmVyc2UoKTsKICBhcnIuc2hpZnQoKTsKICBhcnIucG9wKCk7CiAgcmV0dXJuIGFycjsKfQoKZnVuY3Rpb24gQ29tcHJlc3NMYXJnZUJpbihhcnIpIHsKICAvL3dlIGhhdmUgdG8gY29tcHJlc3MgaW4gc21hbGxlciBjaHVua3MgdG8gYXZvaWQgZ2V0dGluZyBpbnRvIHNjaWVudGlmaWMgbm90YXRpb24KICB2YXIgYXJyMiA9IGFyci5zbGljZSgwKTsKICB2YXIgdGhpc0JpdCA9IFtdOwogIHZhciBiaXRzID0gW107CiAgZm9yICh2YXIgaSBpbiBhcnIyKSB7CiAgICB0aGlzQml0LnB1c2goYXJyMltpXSk7CiAgICBpZiAodGhpc0JpdC5sZW5ndGggPj0gNTApIHsKICAgICAgYml0cy5wdXNoKENvbXByZXNzQmluKHRoaXNCaXQpKTsKICAgICAgdGhpc0JpdCA9IFtdOwogICAgfQogIH0KICBpZiAodGhpc0JpdC5sZW5ndGggPiAwKSBiaXRzLnB1c2goQ29tcHJlc3NCaW4odGhpc0JpdCkpOwogIGFycjIgPSBiaXRzLmpvaW4oIjsiKTsKICByZXR1cm4gYXJyMjsKfQoKZnVuY3Rpb24gVW5jb21wcmVzc0xhcmdlQmluKGFycikgewogIHZhciBhcnIyID0gYXJyLnNwbGl0KCI7Iik7CiAgdmFyIGJpdHMgPSBbXTsKICBmb3IgKHZhciBpIGluIGFycjIpIHsKICAgIGJpdHMucHVzaChVbmNvbXByZXNzQmluKHBhcnNlSW50KGFycjJbaV0pKSk7CiAgfQogIGFycjIgPSBbXTsKICBmb3IgKHZhciBpIGluIGJpdHMpIHsKICAgIGZvciAodmFyIGlpIGluIGJpdHNbaV0pIGFycjIucHVzaChiaXRzW2ldW2lpXSk7CiAgfQogIHJldHVybiBhcnIyOwp9CgpmdW5jdGlvbiBwYWNrKGJ5dGVzKSB7CiAgdmFyIGNoYXJzID0gW107CiAgdmFyIGxlbiA9IGJ5dGVzLmxlbmd0aDsKICBmb3IgKHZhciBpID0gMCwgbiA9IGxlbjsgaSA8IG47ICkgewogICAgY2hhcnMucHVzaCgoKGJ5dGVzW2krK10gJiAweGZmKSA8PCA4KSB8IChieXRlc1tpKytdICYgMHhmZikpOwogIH0KICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLCBjaGFycyk7Cn0KCmZ1bmN0aW9uIHVucGFjayhzdHIpIHsKICB2YXIgYnl0ZXMgPSBbXTsKICB2YXIgbGVuID0gc3RyLmxlbmd0aDsKICBmb3IgKHZhciBpID0gMCwgbiA9IGxlbjsgaSA8IG47IGkrKykgewogICAgdmFyIGNoYXIgPSBzdHIuY2hhckNvZGVBdChpKTsKICAgIGJ5dGVzLnB1c2goY2hhciA+Pj4gOCwgY2hhciAmIDB4ZmYpOwogIH0KICByZXR1cm4gYnl0ZXM7Cn0KCi8vbW9kaWZpZWQgZnJvbSBodHRwOi8vd3d3LnNtYXNoaW5nbWFnYXppbmUuY29tLzIwMTEvMTAvMTkvb3B0aW1pemluZy1sb25nLWxpc3RzLW9mLXllc25vLXZhbHVlcy13aXRoLWphdmFzY3JpcHQvCmZ1bmN0aW9uIHBhY2syKC8qIHN0cmluZyAqLyB2YWx1ZXMpIHsKICB2YXIgY2h1bmtzID0gdmFsdWVzLm1hdGNoKC8uezEsMTR9L2cpLAogICAgcGFja2VkID0gIiI7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaHVua3MubGVuZ3RoOyBpKyspIHsKICAgIHBhY2tlZCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKHBhcnNlSW50KCIxIiArIGNodW5rc1tpXSwgMikpOwogIH0KICByZXR1cm4gcGFja2VkOwp9CgpmdW5jdGlvbiB1bnBhY2syKC8qIHN0cmluZyAqLyBwYWNrZWQpIHsKICB2YXIgdmFsdWVzID0gIiI7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYWNrZWQubGVuZ3RoOyBpKyspIHsKICAgIHZhbHVlcyArPSBwYWNrZWQuY2hhckNvZGVBdChpKS50b1N0cmluZygyKS5zdWJzdHJpbmcoMSk7CiAgfQogIHJldHVybiB2YWx1ZXM7Cn0KCmZ1bmN0aW9uIHBhY2szKHZhbHVlcykgewogIC8vdG9vIG1hbnkgc2F2ZSBjb3JydXB0aW9ucywgZGFybiBpdCB0byBoZWNrCiAgcmV0dXJuIHZhbHVlczsKfQoKLy9maWxlIHNhdmUgZnVuY3Rpb24gZnJvbSBodHRwczovL2dpdGh1Yi5jb20vZWxpZ3JleS9GaWxlU2F2ZXIuanMKdmFyIHNhdmVBcyA9CiAgc2F2ZUFzIHx8CiAgKGZ1bmN0aW9uICh2aWV3KSB7CiAgICAidXNlIHN0cmljdCI7CiAgICBpZiAoCiAgICAgIHR5cGVvZiBuYXZpZ2F0b3IgIT09ICJ1bmRlZmluZWQiICYmCiAgICAgIC9NU0lFIFsxLTldXC4vLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkKICAgICkgewogICAgICByZXR1cm47CiAgICB9CiAgICB2YXIgZG9jID0gdmlldy5kb2N1bWVudCwKICAgICAgZ2V0X1VSTCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gdmlldy5VUkwgfHwgdmlldy53ZWJraXRVUkwgfHwgdmlldzsKICAgICAgfSwKICAgICAgc2F2ZV9saW5rID0gZG9jLmNyZWF0ZUVsZW1lbnROUygiaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIsICJhIiksCiAgICAgIGNhbl91c2Vfc2F2ZV9saW5rID0gImRvd25sb2FkIiBpbiBzYXZlX2xpbmssCiAgICAgIGNsaWNrID0gZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICB2YXIgZXZlbnQgPSBuZXcgTW91c2VFdmVudCgiY2xpY2siKTsKICAgICAgICBub2RlLmRpc3BhdGNoRXZlbnQoZXZlbnQpOwogICAgICB9LAogICAgICBpc19zYWZhcmkgPSAvVmVyc2lvblwvW1xkXC5dKy4qU2FmYXJpLy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpLAogICAgICB3ZWJraXRfcmVxX2ZzID0gdmlldy53ZWJraXRSZXF1ZXN0RmlsZVN5c3RlbSwKICAgICAgcmVxX2ZzID0KICAgICAgICB2aWV3LnJlcXVlc3RGaWxlU3lzdGVtIHx8IHdlYmtpdF9yZXFfZnMgfHwgdmlldy5tb3pSZXF1ZXN0RmlsZVN5c3RlbSwKICAgICAgdGhyb3dfb3V0c2lkZSA9IGZ1bmN0aW9uIChleCkgewogICAgICAgICh2aWV3LnNldEltbWVkaWF0ZSB8fCB2aWV3LnNldFRpbWVvdXQpKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHRocm93IGV4OwogICAgICAgIH0sIDApOwogICAgICB9LAogICAgICBmb3JjZV9zYXZlYWJsZV90eXBlID0gImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSIsCiAgICAgIGZzX21pbl9zaXplID0gMCwKICAgICAgYXJiaXRyYXJ5X3Jldm9rZV90aW1lb3V0ID0gNTAwLAogICAgICByZXZva2UgPSBmdW5jdGlvbiAoZmlsZSkgewogICAgICAgIHZhciByZXZva2VyID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKHR5cGVvZiBmaWxlID09PSAic3RyaW5nIikgewogICAgICAgICAgICBnZXRfVVJMKCkucmV2b2tlT2JqZWN0VVJMKGZpbGUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZmlsZS5yZW1vdmUoKTsKICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIGlmICh2aWV3LmNocm9tZSkgewogICAgICAgICAgcmV2b2tlcigpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzZXRUaW1lb3V0KHJldm9rZXIsIGFyYml0cmFyeV9yZXZva2VfdGltZW91dCk7CiAgICAgICAgfQogICAgICB9LAogICAgICBkaXNwYXRjaCA9IGZ1bmN0aW9uIChmaWxlc2F2ZXIsIGV2ZW50X3R5cGVzLCBldmVudCkgewogICAgICAgIGV2ZW50X3R5cGVzID0gW10uY29uY2F0KGV2ZW50X3R5cGVzKTsKICAgICAgICB2YXIgaSA9IGV2ZW50X3R5cGVzLmxlbmd0aDsKICAgICAgICB3aGlsZSAoaS0tKSB7CiAgICAgICAgICB2YXIgbGlzdGVuZXIgPSBmaWxlc2F2ZXJbIm9uIiArIGV2ZW50X3R5cGVzW2ldXTsKICAgICAgICAgIGlmICh0eXBlb2YgbGlzdGVuZXIgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBsaXN0ZW5lci5jYWxsKGZpbGVzYXZlciwgZXZlbnQgfHwgZmlsZXNhdmVyKTsKICAgICAgICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICAgICAgICB0aHJvd19vdXRzaWRlKGV4KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgYXV0b19ib20gPSBmdW5jdGlvbiAoYmxvYikgewogICAgICAgIGlmICgKICAgICAgICAgIC9eXHMqKD86dGV4dFwvXFMqfGFwcGxpY2F0aW9uXC94bWx8XFMqXC9cUypcK3htbClccyo7LipjaGFyc2V0XHMqPVxzKnV0Zi04L2kudGVzdCgKICAgICAgICAgICAgYmxvYi50eXBlCiAgICAgICAgICApCiAgICAgICAgKSB7CiAgICAgICAgICByZXR1cm4gbmV3IEJsb2IoWyJcdWZlZmYiLCBibG9iXSwgeyB0eXBlOiBibG9iLnR5cGUgfSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBibG9iOwogICAgICB9LAogICAgICBGaWxlU2F2ZXIgPSBmdW5jdGlvbiAoYmxvYiwgbmFtZSwgbm9fYXV0b19ib20pIHsKICAgICAgICBpZiAoIW5vX2F1dG9fYm9tKSB7CiAgICAgICAgICBibG9iID0gYXV0b19ib20oYmxvYik7CiAgICAgICAgfQogICAgICAgIHZhciBmaWxlc2F2ZXIgPSB0aGlzLAogICAgICAgICAgdHlwZSA9IGJsb2IudHlwZSwKICAgICAgICAgIGJsb2JfY2hhbmdlZCA9IGZhbHNlLAogICAgICAgICAgb2JqZWN0X3VybCwKICAgICAgICAgIHRhcmdldF92aWV3LAogICAgICAgICAgZGlzcGF0Y2hfYWxsID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBkaXNwYXRjaCgKICAgICAgICAgICAgICBmaWxlc2F2ZXIsCiAgICAgICAgICAgICAgIndyaXRlc3RhcnQgcHJvZ3Jlc3Mgd3JpdGUgd3JpdGVlbmQiLnNwbGl0KCIgIikKICAgICAgICAgICAgKTsKICAgICAgICAgIH0sCiAgICAgICAgICBmc19lcnJvciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgaWYgKHRhcmdldF92aWV3ICYmIGlzX3NhZmFyaSAmJiB0eXBlb2YgRmlsZVJlYWRlciAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKICAgICAgICAgICAgICByZWFkZXIub25sb2FkZW5kID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgdmFyIGJhc2U2NERhdGEgPSByZWFkZXIucmVzdWx0OwogICAgICAgICAgICAgICAgdGFyZ2V0X3ZpZXcubG9jYXRpb24uaHJlZiA9CiAgICAgICAgICAgICAgICAgICJkYXRhOmF0dGFjaG1lbnQvZmlsZSIgKwogICAgICAgICAgICAgICAgICBiYXNlNjREYXRhLnNsaWNlKGJhc2U2NERhdGEuc2VhcmNoKC9bLDtdLykpOwogICAgICAgICAgICAgICAgZmlsZXNhdmVyLnJlYWR5U3RhdGUgPSBmaWxlc2F2ZXIuRE9ORTsKICAgICAgICAgICAgICAgIGRpc3BhdGNoX2FsbCgpOwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoYmxvYik7CiAgICAgICAgICAgICAgZmlsZXNhdmVyLnJlYWR5U3RhdGUgPSBmaWxlc2F2ZXIuSU5JVDsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGJsb2JfY2hhbmdlZCB8fCAhb2JqZWN0X3VybCkgewogICAgICAgICAgICAgIG9iamVjdF91cmwgPSBnZXRfVVJMKCkuY3JlYXRlT2JqZWN0VVJMKGJsb2IpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh0YXJnZXRfdmlldykgewogICAgICAgICAgICAgIHRhcmdldF92aWV3LmxvY2F0aW9uLmhyZWYgPSBvYmplY3RfdXJsOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHZhciBuZXdfdGFiID0gdmlldy5vcGVuKG9iamVjdF91cmwsICJfYmxhbmsiKTsKICAgICAgICAgICAgICBpZiAobmV3X3RhYiA9PSB1bmRlZmluZWQgJiYgaXNfc2FmYXJpKSB7CiAgICAgICAgICAgICAgICB2aWV3LmxvY2F0aW9uLmhyZWYgPSBvYmplY3RfdXJsOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmaWxlc2F2ZXIucmVhZHlTdGF0ZSA9IGZpbGVzYXZlci5ET05FOwogICAgICAgICAgICBkaXNwYXRjaF9hbGwoKTsKICAgICAgICAgICAgcmV2b2tlKG9iamVjdF91cmwpOwogICAgICAgICAgfSwKICAgICAgICAgIGFib3J0YWJsZSA9IGZ1bmN0aW9uIChmdW5jKSB7CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgaWYgKGZpbGVzYXZlci5yZWFkeVN0YXRlICE9PSBmaWxlc2F2ZXIuRE9ORSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgICB9LAogICAgICAgICAgY3JlYXRlX2lmX25vdF9mb3VuZCA9IHsgY3JlYXRlOiB0cnVlLCBleGNsdXNpdmU6IGZhbHNlIH0sCiAgICAgICAgICBzbGljZTsKICAgICAgICBmaWxlc2F2ZXIucmVhZHlTdGF0ZSA9IGZpbGVzYXZlci5JTklUOwogICAgICAgIGlmICghbmFtZSkgewogICAgICAgICAgbmFtZSA9ICJkb3dubG9hZCI7CiAgICAgICAgfQogICAgICAgIGlmIChjYW5fdXNlX3NhdmVfbGluaykgewogICAgICAgICAgb2JqZWN0X3VybCA9IGdldF9VUkwoKS5jcmVhdGVPYmplY3RVUkwoYmxvYik7CiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgc2F2ZV9saW5rLmhyZWYgPSBvYmplY3RfdXJsOwogICAgICAgICAgICBzYXZlX2xpbmsuZG93bmxvYWQgPSBuYW1lOwogICAgICAgICAgICBjbGljayhzYXZlX2xpbmspOwogICAgICAgICAgICBkaXNwYXRjaF9hbGwoKTsKICAgICAgICAgICAgcmV2b2tlKG9iamVjdF91cmwpOwogICAgICAgICAgICBmaWxlc2F2ZXIucmVhZHlTdGF0ZSA9IGZpbGVzYXZlci5ET05FOwogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmICh2aWV3LmNocm9tZSAmJiB0eXBlICYmIHR5cGUgIT09IGZvcmNlX3NhdmVhYmxlX3R5cGUpIHsKICAgICAgICAgIHNsaWNlID0gYmxvYi5zbGljZSB8fCBibG9iLndlYmtpdFNsaWNlOwogICAgICAgICAgYmxvYiA9IHNsaWNlLmNhbGwoYmxvYiwgMCwgYmxvYi5zaXplLCBmb3JjZV9zYXZlYWJsZV90eXBlKTsKICAgICAgICAgIGJsb2JfY2hhbmdlZCA9IHRydWU7CiAgICAgICAgfQogICAgICAgIGlmICh3ZWJraXRfcmVxX2ZzICYmIG5hbWUgIT09ICJkb3dubG9hZCIpIHsKICAgICAgICAgIG5hbWUgKz0gIi5kb3dubG9hZCI7CiAgICAgICAgfQogICAgICAgIGlmICh0eXBlID09PSBmb3JjZV9zYXZlYWJsZV90eXBlIHx8IHdlYmtpdF9yZXFfZnMpIHsKICAgICAgICAgIHRhcmdldF92aWV3ID0gdmlldzsKICAgICAgICB9CiAgICAgICAgaWYgKCFyZXFfZnMpIHsKICAgICAgICAgIGZzX2Vycm9yKCk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGZzX21pbl9zaXplICs9IGJsb2Iuc2l6ZTsKICAgICAgICByZXFfZnMoCiAgICAgICAgICB2aWV3LlRFTVBPUkFSWSwKICAgICAgICAgIGZzX21pbl9zaXplLAogICAgICAgICAgYWJvcnRhYmxlKGZ1bmN0aW9uIChmcykgewogICAgICAgICAgICBmcy5yb290LmdldERpcmVjdG9yeSgKICAgICAgICAgICAgICAic2F2ZWQiLAogICAgICAgICAgICAgIGNyZWF0ZV9pZl9ub3RfZm91bmQsCiAgICAgICAgICAgICAgYWJvcnRhYmxlKGZ1bmN0aW9uIChkaXIpIHsKICAgICAgICAgICAgICAgIHZhciBzYXZlID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICBkaXIuZ2V0RmlsZSgKICAgICAgICAgICAgICAgICAgICBuYW1lLAogICAgICAgICAgICAgICAgICAgIGNyZWF0ZV9pZl9ub3RfZm91bmQsCiAgICAgICAgICAgICAgICAgICAgYWJvcnRhYmxlKGZ1bmN0aW9uIChmaWxlKSB7CiAgICAgICAgICAgICAgICAgICAgICBmaWxlLmNyZWF0ZVdyaXRlcigKICAgICAgICAgICAgICAgICAgICAgICAgYWJvcnRhYmxlKGZ1bmN0aW9uICh3cml0ZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICB3cml0ZXIub253cml0ZWVuZCA9IGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0X3ZpZXcubG9jYXRpb24uaHJlZiA9IGZpbGUudG9VUkwoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVzYXZlci5yZWFkeVN0YXRlID0gZmlsZXNhdmVyLkRPTkU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaChmaWxlc2F2ZXIsICJ3cml0ZWVuZCIsIGV2ZW50KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldm9rZShmaWxlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlci5vbmVycm9yID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVycm9yID0gd3JpdGVyLmVycm9yOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVycm9yLmNvZGUgIT09IGVycm9yLkFCT1JUX0VSUikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmc19lcnJvcigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgICAgIndyaXRlc3RhcnQgcHJvZ3Jlc3Mgd3JpdGUgYWJvcnQiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3BsaXQoIiAiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvckVhY2goZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlclsib24iICsgZXZlbnRdID0gZmlsZXNhdmVyWyJvbiIgKyBldmVudF07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICB3cml0ZXIud3JpdGUoYmxvYik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZXNhdmVyLmFib3J0ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVyLmFib3J0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlc2F2ZXIucmVhZHlTdGF0ZSA9IGZpbGVzYXZlci5ET05FOwogICAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZXNhdmVyLnJlYWR5U3RhdGUgPSBmaWxlc2F2ZXIuV1JJVElORzsKICAgICAgICAgICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICAgICAgICAgIGZzX2Vycm9yCiAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgICAgIGZzX2Vycm9yCiAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgZGlyLmdldEZpbGUoCiAgICAgICAgICAgICAgICAgIG5hbWUsCiAgICAgICAgICAgICAgICAgIHsgY3JlYXRlOiBmYWxzZSB9LAogICAgICAgICAgICAgICAgICBhYm9ydGFibGUoZnVuY3Rpb24gKGZpbGUpIHsKICAgICAgICAgICAgICAgICAgICBmaWxlLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgICAgIHNhdmUoKTsKICAgICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICAgIGFib3J0YWJsZShmdW5jdGlvbiAoZXgpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoZXguY29kZSA9PT0gZXguTk9UX0ZPVU5EX0VSUikgewogICAgICAgICAgICAgICAgICAgICAgc2F2ZSgpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICBmc19lcnJvcigpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgZnNfZXJyb3IKICAgICAgICAgICAgKTsKICAgICAgICAgIH0pLAogICAgICAgICAgZnNfZXJyb3IKICAgICAgICApOwogICAgICB9LAogICAgICBGU19wcm90byA9IEZpbGVTYXZlci5wcm90b3R5cGUsCiAgICAgIHNhdmVBcyA9IGZ1bmN0aW9uIChibG9iLCBuYW1lLCBub19hdXRvX2JvbSkgewogICAgICAgIHJldHVybiBuZXcgRmlsZVNhdmVyKGJsb2IsIG5hbWUsIG5vX2F1dG9fYm9tKTsKICAgICAgfTsKICAgIGlmICh0eXBlb2YgbmF2aWdhdG9yICE9PSAidW5kZWZpbmVkIiAmJiBuYXZpZ2F0b3IubXNTYXZlT3JPcGVuQmxvYikgewogICAgICByZXR1cm4gZnVuY3Rpb24gKGJsb2IsIG5hbWUsIG5vX2F1dG9fYm9tKSB7CiAgICAgICAgaWYgKCFub19hdXRvX2JvbSkgewogICAgICAgICAgYmxvYiA9IGF1dG9fYm9tKGJsb2IpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbmF2aWdhdG9yLm1zU2F2ZU9yT3BlbkJsb2IoYmxvYiwgbmFtZSB8fCAiZG93bmxvYWQiKTsKICAgICAgfTsKICAgIH0KICAgIEZTX3Byb3RvLmFib3J0ID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgZmlsZXNhdmVyID0gdGhpczsKICAgICAgZmlsZXNhdmVyLnJlYWR5U3RhdGUgPSBmaWxlc2F2ZXIuRE9ORTsKICAgICAgZGlzcGF0Y2goZmlsZXNhdmVyLCAiYWJvcnQiKTsKICAgIH07CiAgICBGU19wcm90by5yZWFkeVN0YXRlID0gRlNfcHJvdG8uSU5JVCA9IDA7CiAgICBGU19wcm90by5XUklUSU5HID0gMTsKICAgIEZTX3Byb3RvLkRPTkUgPSAyOwogICAgRlNfcHJvdG8uZXJyb3IgPQogICAgICBGU19wcm90by5vbndyaXRlc3RhcnQgPQogICAgICBGU19wcm90by5vbnByb2dyZXNzID0KICAgICAgRlNfcHJvdG8ub253cml0ZSA9CiAgICAgIEZTX3Byb3RvLm9uYWJvcnQgPQogICAgICBGU19wcm90by5vbmVycm9yID0KICAgICAgRlNfcHJvdG8ub253cml0ZWVuZCA9CiAgICAgICAgbnVsbDsKICAgIHJldHVybiBzYXZlQXM7CiAgfSkoCiAgICAodHlwZW9mIHNlbGYgIT09ICJ1bmRlZmluZWQiICYmIHNlbGYpIHx8CiAgICAgICh0eXBlb2Ygd2luZG93ICE9PSAidW5kZWZpbmVkIiAmJiB3aW5kb3cpIHx8CiAgICAgIHRoaXMuY29udGVudAogICk7CmlmICh0eXBlb2YgbW9kdWxlICE9PSAidW5kZWZpbmVkIiAmJiBtb2R1bGUuZXhwb3J0cykgewogIG1vZHVsZS5leHBvcnRzLnNhdmVBcyA9IHNhdmVBczsKfSBlbHNlIGlmICgKICB0eXBlb2YgZGVmaW5lICE9PSAidW5kZWZpbmVkIiAmJgogIGRlZmluZSAhPT0gbnVsbCAmJgogIGRlZmluZS5hbWQgIT0gbnVsbAopIHsKICBkZWZpbmUoW10sIGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiBzYXZlQXM7CiAgfSk7Cn0KCi8vc2VlZGVkIHJhbmRvbSBmdW5jdGlvbiwgY291cnRlc3kgb2YgaHR0cDovL2RhdmlkYmF1LmNvbS9hcmNoaXZlcy8yMDEwLzAxLzMwL3JhbmRvbV9zZWVkc19jb2RlZF9oaW50c19hbmRfcXVpbnRpbGxpb25zLmh0bWwKKGZ1bmN0aW9uIChhLCBiLCBjLCBkLCBlLCBmKSB7CiAgZnVuY3Rpb24gayhhKSB7CiAgICB2YXIgYiwKICAgICAgYyA9IGEubGVuZ3RoLAogICAgICBlID0gdGhpcywKICAgICAgZiA9IDAsCiAgICAgIGcgPSAoZS5pID0gZS5qID0gMCksCiAgICAgIGggPSAoZS5TID0gW10pOwogICAgZm9yIChjIHx8IChhID0gW2MrK10pOyBkID4gZjsgKSBoW2ZdID0gZisrOwogICAgZm9yIChmID0gMDsgZCA+IGY7IGYrKykKICAgICAgKGhbZl0gPSBoWyhnID0gaiAmIChnICsgYVtmICUgY10gKyAoYiA9IGhbZl0pKSldKSwgKGhbZ10gPSBiKTsKICAgIChlLmcgPSBmdW5jdGlvbiAoYSkgewogICAgICBmb3IgKHZhciBiLCBjID0gMCwgZiA9IGUuaSwgZyA9IGUuaiwgaCA9IGUuUzsgYS0tOyApCiAgICAgICAgKGIgPSBoWyhmID0gaiAmIChmICsgMSkpXSksCiAgICAgICAgICAoYyA9IGMgKiBkICsgaFtqICYgKChoW2ZdID0gaFsoZyA9IGogJiAoZyArIGIpKV0pICsgKGhbZ10gPSBiKSldKTsKICAgICAgcmV0dXJuIChlLmkgPSBmKSwgKGUuaiA9IGcpLCBjOwogICAgfSkoZCk7CiAgfQogIGZ1bmN0aW9uIGwoYSwgYikgewogICAgdmFyIGUsCiAgICAgIGMgPSBbXSwKICAgICAgZCA9ICh0eXBlb2YgYSlbMF07CiAgICBpZiAoYiAmJiAibyIgPT0gZCkKICAgICAgZm9yIChlIGluIGEpCiAgICAgICAgdHJ5IHsKICAgICAgICAgIGMucHVzaChsKGFbZV0sIGIgLSAxKSk7CiAgICAgICAgfSBjYXRjaCAoZikge30KICAgIHJldHVybiBjLmxlbmd0aCA/IGMgOiAicyIgPT0gZCA/IGEgOiBhICsgIlwwIjsKICB9CiAgZnVuY3Rpb24gbShhLCBiKSB7CiAgICBmb3IgKHZhciBkLCBjID0gYSArICIiLCBlID0gMDsgYy5sZW5ndGggPiBlOyApCiAgICAgIGJbaiAmIGVdID0gaiAmICgoZCBePSAxOSAqIGJbaiAmIGVdKSArIGMuY2hhckNvZGVBdChlKyspKTsKICAgIHJldHVybiBvKGIpOwogIH0KICBmdW5jdGlvbiBuKGMpIHsKICAgIHRyeSB7CiAgICAgIHJldHVybiBhLmNyeXB0by5nZXRSYW5kb21WYWx1ZXMoKGMgPSBuZXcgVWludDhBcnJheShkKSkpLCBvKGMpOwogICAgfSBjYXRjaCAoZSkgewogICAgICByZXR1cm4gWytuZXcgRGF0ZSgpLCBhLCBhLm5hdmlnYXRvci5wbHVnaW5zLCBhLnNjcmVlbiwgbyhiKV07CiAgICB9CiAgfQogIGZ1bmN0aW9uIG8oYSkgewogICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkoMCwgYSk7CiAgfQogIHZhciBnID0gYy5wb3coZCwgZSksCiAgICBoID0gYy5wb3coMiwgZiksCiAgICBpID0gMiAqIGgsCiAgICBqID0gZCAtIDE7CiAgKGMuc2VlZHJhbmRvbSA9IGZ1bmN0aW9uIChhLCBmKSB7CiAgICB2YXIgaiA9IFtdLAogICAgICBwID0gbShsKGYgPyBbYSwgbyhiKV0gOiAwIGluIGFyZ3VtZW50cyA/IGEgOiBuKCksIDMpLCBqKSwKICAgICAgcSA9IG5ldyBrKGopOwogICAgcmV0dXJuICgKICAgICAgbShvKHEuUyksIGIpLAogICAgICAoYy5yYW5kb20gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgZm9yICh2YXIgYSA9IHEuZyhlKSwgYiA9IGcsIGMgPSAwOyBoID4gYTsgKQogICAgICAgICAgKGEgPSAoYSArIGMpICogZCksIChiICo9IGQpLCAoYyA9IHEuZygxKSk7CiAgICAgICAgZm9yICg7IGEgPj0gaTsgKSAoYSAvPSAyKSwgKGIgLz0gMiksIChjID4+Pj0gMSk7CiAgICAgICAgcmV0dXJuIChhICsgYykgLyBiOwogICAgICB9KSwKICAgICAgcAogICAgKTsKICB9KSwKICAgIG0oYy5yYW5kb20oKSwgYik7Cn0pKHRoaXMsIFtdLCBNYXRoLCAyNTYsIDYsIDUyKTsKCmZ1bmN0aW9uIGJpbmQoc2NvcGUsIGZuKSB7CiAgLy91c2UgOiBiaW5kKHRoaXMsZnVuY3Rpb24oKXt0aGlzLngrKzt9KSAtIHJldHVybnMgYSBmdW5jdGlvbiB3aGVyZSAidGhpcyIgcmVmZXJzIHRvIHRoZSBzY29wZWQgdGhpcwogIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICBmbi5hcHBseShzY29wZSwgYXJndW1lbnRzKTsKICB9Owp9Cgp2YXIgZ3JhYlByb3BzID0gZnVuY3Rpb24gKGFyciwgcHJvcCkgewogIGlmICghYXJyKSByZXR1cm4gW107CiAgYXJyMiA9IFtdOwogIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7CiAgICBhcnIyLnB1c2goYXJyW2ldW3Byb3BdKTsKICB9CiAgcmV0dXJuIGFycjI7Cn07CgpDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQucHJvdG90eXBlLmZpbGxQYXR0ZXJuID0gZnVuY3Rpb24gKAogIGltZywKICBYLAogIFksCiAgVywKICBILAogIGlXLAogIGlILAogIG9mZlgsCiAgb2ZmWQopIHsKICAvL2ZvciB3aGVuIGJ1aWx0LWluIHBhdHRlcm5zIGFyZW4ndCBlbm91Z2gKICBpZiAoaW1nLmFsdCAhPSAiYmxhbmsiKSB7CiAgICB2YXIgb2ZmWCA9IG9mZlggfHwgMDsKICAgIHZhciBvZmZZID0gb2ZmWSB8fCAwOwogICAgaWYgKG9mZlggPCAwKSB7CiAgICAgIG9mZlggPSBvZmZYIC0gTWF0aC5mbG9vcihvZmZYIC8gaVcpICogaVc7CiAgICB9CiAgICBpZiAob2ZmWCA+IDApIHsKICAgICAgb2ZmWCA9IChvZmZYICUgaVcpIC0gaVc7CiAgICB9CiAgICBpZiAob2ZmWSA8IDApIHsKICAgICAgb2ZmWSA9IG9mZlkgLSBNYXRoLmZsb29yKG9mZlkgLyBpSCkgKiBpSDsKICAgIH0KICAgIGlmIChvZmZZID4gMCkgewogICAgICBvZmZZID0gKG9mZlkgJSBpSCkgLSBpSDsKICAgIH0KICAgIGZvciAodmFyIHkgPSBvZmZZOyB5IDwgSDsgeSArPSBpSCkgewogICAgICBmb3IgKHZhciB4ID0gb2ZmWDsgeCA8IFc7IHggKz0gaVcpIHsKICAgICAgICB0aGlzLmRyYXdJbWFnZShpbWcsIFggKyB4LCBZICsgeSwgaVcsIGlIKTsKICAgICAgfQogICAgfQogIH0KfTsKCnZhciBPbGRDYW52YXNEcmF3SW1hZ2UgPSBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQucHJvdG90eXBlLmRyYXdJbWFnZTsKQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELnByb3RvdHlwZS5kcmF3SW1hZ2UgPSBmdW5jdGlvbiAoKSB7CiAgLy9vbmx5IGRyYXcgdGhlIGltYWdlIGlmIGl0J3MgbG9hZGVkCiAgaWYgKGFyZ3VtZW50c1swXS5hbHQgIT0gImJsYW5rIikgT2xkQ2FudmFzRHJhd0ltYWdlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn07CgppZiAoIWRvY3VtZW50Lmhhc0ZvY3VzKQogIGRvY3VtZW50Lmhhc0ZvY3VzID0gZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIGRvY3VtZW50LmhpZGRlbjsKICB9OyAvL2ZvciBPcGVyYQoKZnVuY3Rpb24gQWRkRXZlbnQoZWwsIGV2LCBmdW5jKSB7CiAgLy9pZS4gbXlMaXN0ZW5lcj1BZGRFdmVudChsKCdlbGVtZW50JyksJ2NsaWNrJyxmdW5jdGlvbigpe2NvbnNvbGUubG9nKCdoaSEnKTt9KTsKICBpZiAoZWwuYWRkRXZlbnRMaXN0ZW5lcikgewogICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihldiwgZnVuYywgZmFsc2UpOwogICAgcmV0dXJuIFtlbCwgZXYsIGZ1bmNdOwogIH0gZWxzZSBpZiAoZWwuYXR0YWNoRXZlbnQpIHsKICAgIHZhciBmdW5jMiA9IGZ1bmN0aW9uICgpIHsKICAgICAgZnVuYy5jYWxsKGVsKTsKICAgIH07CiAgICBlbC5hdHRhY2hFdmVudCgib24iICsgZXYsIGZ1bmMyKTsKICAgIHJldHVybiBbZWwsIGV2LCBmdW5jMl07CiAgfQogIHJldHVybiBmYWxzZTsKfQpmdW5jdGlvbiBSZW1vdmVFdmVudChldk9iaikgewogIC8vaWUuIFJlbW92ZUV2ZW50KG15TGlzdGVuZXIpOwogIGlmICghZXZPYmopIHJldHVybiBmYWxzZTsKICBpZiAoZXZPYmpbMF0ucmVtb3ZlRXZlbnRMaXN0ZW5lcikKICAgIGV2T2JqWzBdLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZPYmpbMV0sIGV2T2JqWzJdLCBmYWxzZSk7CiAgZWxzZSBpZiAoZXZPYmpbMF0uZGV0YWNoRXZlbnQpCiAgICBldk9ialswXS5kZXRhY2hFdmVudCgib24iICsgZXZPYmpbMV0sIGV2T2JqWzJdKTsKICByZXR1cm4gdHJ1ZTsKfQoKZnVuY3Rpb24gRmlyZUV2ZW50KGVsLCBldikgewogIGlmIChlbC5maXJlRXZlbnQpIHsKICAgIGVsLmZpcmVFdmVudCgib24iICsgZXYpOwogIH0gZWxzZSB7CiAgICB2YXIgZXZPYmogPSBkb2N1bWVudC5jcmVhdGVFdmVudCgiRXZlbnRzIik7CiAgICBldk9iai5pbml0RXZlbnQoZXYsIHRydWUsIGZhbHNlKTsKICAgIGVsLmRpc3BhdGNoRXZlbnQoZXZPYmopOwogIH0KfQoKZnVuY3Rpb24gd3JpdGVJY29uKGljb24pIHsKICAvL3JldHVybnMgQ1NTIGZvciBhbiBpY29uJ3MgYmFja2dyb3VuZCBpbWFnZQogIC8vZm9yIHVzZSBpbiBDU1Mgc3RyaW5ncwogIHJldHVybiAoCiAgICAoaWNvblsyXQogICAgICA/ICJiYWNrZ3JvdW5kLWltYWdlOnVybCgnIiArIGljb25bMl0ucmVwbGFjZSgvJy9nLCAiXFwnIikgKyAiJyk7IgogICAgICA6ICIiKSArCiAgICAiYmFja2dyb3VuZC1wb3NpdGlvbjoiICsKICAgIC1pY29uWzBdICogNDggKwogICAgInB4ICIgKwogICAgLWljb25bMV0gKiA0OCArCiAgICAicHg7IgogICk7Cn0KZnVuY3Rpb24gdGlueUljb24oaWNvbiwgY3NzKSB7CiAgLy9yZXR1cm5zIEhUTUwgZGlzcGxheWluZyBhbiBpY29uLCB3aXRoIG9wdGlvbmFsIGV4dHJhIENTUwogIHJldHVybiAoCiAgICAnPGRpdiBjbGFzcz0iaWNvbiB0aW55SWNvbiIgc3R5bGU9InZlcnRpY2FsLWFsaWduOm1pZGRsZTtkaXNwbGF5OmlubGluZS1ibG9jazsnICsKICAgIHdyaXRlSWNvbihpY29uKSArCiAgICAidHJhbnNmb3JtOnNjYWxlKDAuNSk7bWFyZ2luOi0xNnB4OyIgKwogICAgKGNzcyA/IGNzcyA6ICIiKSArCiAgICAnIj48L2Rpdj4nCiAgKTsKfQoKdmFyIExvYWRlciA9IGZ1bmN0aW9uICgpIC8vYXNzZXQtbG9hZGluZyBzeXN0ZW0KewogIHRoaXMubG9hZGluZ04gPSAwOwogIHRoaXMuYXNzZXRzTiA9IDA7CiAgdGhpcy5hc3NldHMgPSBbXTsKICB0aGlzLmFzc2V0c0xvYWRpbmcgPSBbXTsKICB0aGlzLmFzc2V0c0xvYWRlZCA9IFtdOwogIHRoaXMuZG9tYWluID0gIiI7CiAgdGhpcy5sb2FkZWQgPSAwOyAvL2NhbGxiYWNrCiAgdGhpcy5kb25lTG9hZGluZyA9IDA7CgogIHRoaXMuYmxhbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJjYW52YXMiKTsKICB0aGlzLmJsYW5rLndpZHRoID0gODsKICB0aGlzLmJsYW5rLmhlaWdodCA9IDg7CiAgdGhpcy5ibGFuay5hbHQgPSAiYmxhbmsiOwoKICB0aGlzLkxvYWQgPSBmdW5jdGlvbiAoYXNzZXRzKSB7CiAgICBmb3IgKHZhciBpIGluIGFzc2V0cykgewogICAgICB0aGlzLmxvYWRpbmdOKys7CiAgICAgIHRoaXMuYXNzZXRzTisrOwogICAgICBpZiAoIXRoaXMuYXNzZXRzTG9hZGluZ1thc3NldHNbaV1dICYmICF0aGlzLmFzc2V0c0xvYWRlZFthc3NldHNbaV1dKSB7CiAgICAgICAgdmFyIGltZyA9IG5ldyBJbWFnZSgpOwogICAgICAgIGlmIChhc3NldHNbaV0uaW5kZXhPZigiLyIpICE9IC0xKSBpbWcuc3JjID0gYXNzZXRzW2ldOwogICAgICAgIGVsc2UgaW1nLnNyYyA9IHRoaXMuZG9tYWluICsgYXNzZXRzW2ldOwogICAgICAgIGltZy5hbHQgPSBhc3NldHNbaV07CiAgICAgICAgaW1nLm9ubG9hZCA9IGJpbmQodGhpcywgdGhpcy5vbkxvYWQpOwogICAgICAgIHRoaXMuYXNzZXRzW2Fzc2V0c1tpXV0gPSBpbWc7CiAgICAgICAgdGhpcy5hc3NldHNMb2FkaW5nLnB1c2goYXNzZXRzW2ldKTsKICAgICAgfQogICAgfQogIH07CiAgdGhpcy5SZXBsYWNlID0gZnVuY3Rpb24gKG9sZCwgbmV3ZXIpIHsKICAgIGlmICghdGhpcy5hc3NldHNbb2xkXSkgdGhpcy5Mb2FkKFtvbGRdKTsKICAgIHZhciBpbWcgPSBuZXcgSW1hZ2UoKTsKICAgIGlmIChuZXdlci5pbmRleE9mKCIvIikgIT0gLTEpCiAgICAgIC8qbmV3ZXIuaW5kZXhPZignaHR0cCcpIT0tMSB8fCBuZXdlci5pbmRleE9mKCdodHRwcycpIT0tMSkqLyBpbWcuc3JjID0KICAgICAgICBuZXdlcjsKICAgIGVsc2UgaW1nLnNyYyA9IHRoaXMuZG9tYWluICsgbmV3ZXI7CiAgICBpbWcuYWx0ID0gbmV3ZXI7CiAgICBpbWcub25sb2FkID0gYmluZCh0aGlzLCB0aGlzLm9uTG9hZCk7CiAgICB0aGlzLmFzc2V0c1tvbGRdID0gaW1nOwogIH07CiAgdGhpcy5vbkxvYWRSZXBsYWNlID0gZnVuY3Rpb24gKCkge307CiAgdGhpcy5vbkxvYWQgPSBmdW5jdGlvbiAoZSkgewogICAgdGhpcy5hc3NldHNMb2FkZWQucHVzaChlLnRhcmdldC5hbHQpOwogICAgdGhpcy5hc3NldHNMb2FkaW5nLnNwbGljZSh0aGlzLmFzc2V0c0xvYWRpbmcuaW5kZXhPZihlLnRhcmdldC5hbHQpLCAxKTsKICAgIHRoaXMubG9hZGluZ04tLTsKICAgIGlmICh0aGlzLmRvbmVMb2FkaW5nID09IDAgJiYgdGhpcy5sb2FkaW5nTiA8PSAwICYmIHRoaXMubG9hZGVkICE9IDApIHsKICAgICAgdGhpcy5kb25lTG9hZGluZyA9IDE7CiAgICAgIHRoaXMubG9hZGVkKCk7CiAgICB9CiAgfTsKICB0aGlzLmdldFByb2dyZXNzID0gZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIDEgLSB0aGlzLmxvYWRpbmdOIC8gdGhpcy5hc3NldHNOOwogIH07Cn07Cgp2YXIgUGljID0gZnVuY3Rpb24gKHdoYXQpIHsKICBpZiAoR2FtZS5Mb2FkZXIuYXNzZXRzTG9hZGVkLmluZGV4T2Yod2hhdCkgIT0gLTEpCiAgICByZXR1cm4gR2FtZS5Mb2FkZXIuYXNzZXRzW3doYXRdOwogIGVsc2UgaWYgKEdhbWUuTG9hZGVyLmFzc2V0c0xvYWRpbmcuaW5kZXhPZih3aGF0KSA9PSAtMSkKICAgIEdhbWUuTG9hZGVyLkxvYWQoW3doYXRdKTsKICByZXR1cm4gR2FtZS5Mb2FkZXIuYmxhbms7Cn07Cgp2YXIgU291bmRzID0gW107CnZhciBPbGRQbGF5U291bmQgPSBmdW5jdGlvbiAodXJsLCB2b2wpIHsKICB2YXIgdm9sdW1lID0gMTsKICBpZiAodm9sICE9PSB1bmRlZmluZWQpIHZvbHVtZSA9IHZvbDsKICBpZiAoIUdhbWUudm9sdW1lIHx8IHZvbHVtZSA9PSAwKSByZXR1cm4gMDsKICBpZiAoIVNvdW5kc1t1cmxdKSB7CiAgICBTb3VuZHNbdXJsXSA9IG5ldyBBdWRpbyh1cmwpOwogICAgU291bmRzW3VybF0ub25sb2FkZWRkYXRhID0gZnVuY3Rpb24gKGUpIHsKICAgICAgZS50YXJnZXQudm9sdW1lID0gTWF0aC5wb3coKHZvbHVtZSAqIEdhbWUudm9sdW1lKSAvIDEwMCwgMik7CiAgICB9OwogIH0gZWxzZSBpZiAoU291bmRzW3VybF0ucmVhZHlTdGF0ZSA+PSAyKSB7CiAgICBTb3VuZHNbdXJsXS5jdXJyZW50VGltZSA9IDA7CiAgICBTb3VuZHNbdXJsXS52b2x1bWUgPSBNYXRoLnBvdygodm9sdW1lICogR2FtZS52b2x1bWUpIC8gMTAwLCAyKTsKICB9CiAgU291bmRzW3VybF0ucGxheSgpOwp9Owp2YXIgU291bmRJbnN0cyA9IFtdOwp2YXIgU291bmRJID0gMDsKZm9yICh2YXIgaSA9IDA7IGkgPCAxMjsgaSsrKSB7CiAgU291bmRJbnN0c1tpXSA9IG5ldyBBdWRpbygpOwp9CnZhciBwaXRjaFN1cHBvcnQgPSBmYWxzZTsKLy9ub3RlIDogQ2hyb21lIHR1cm5zIG91dCB0byBub3Qgc3VwcG9ydCB3ZWJraXRQcmVzZXJ2ZXNQaXRjaCBkZXNwaXRlIHRoZSBzcGVjaWZpY2F0aW9ucyBjbGFpbWluZyBvdGhlcndpc2UsIGFuZCBGaXJlZm94IGNsaXBzIHNvbWUgc2hvcnQgc291bmRzIHdoZW4gY2hhbmdpbmcgcGxheWJhY2tSYXRlLCBzbyBpJ20gdHVybmluZyB0aGUgZmVhdHVyZSBvZmYgY29tcGxldGVseSB1bnRpbCBicm93c2VycyBnZXQgaXQgdG9nZXRoZXIKLy9pZiAoU291bmRJbnN0c1swXS5wcmVzZXJ2ZXNQaXRjaCB8fCBTb3VuZEluc3RzWzBdLm1velByZXNlcnZlc1BpdGNoIHx8IFNvdW5kSW5zdHNbMF0ud2Via2l0UHJlc2VydmVzUGl0Y2gpIHBpdGNoU3VwcG9ydD10cnVlOwoKdmFyIFBsYXlTb3VuZCA9IGZ1bmN0aW9uICh1cmwsIHZvbCwgcGl0Y2hWYXIpIHsKICAvL3VybCA6IHRoZSB1cmwgb2YgdGhlIHNvdW5kIHRvIHBsYXkgKHdpbGwgYmUgY2FjaGVkIHNvIGl0IG9ubHkgbG9hZHMgb25jZSkKICAvL3ZvbCA6IHZvbHVtZSBiZXR3ZWVuIDAgYW5kIDEgKG11bHRpcGxpZWQgYnkgZ2FtZSB2b2x1bWUgc2V0dGluZyk7IGRlZmF1bHRzIHRvIDEgKGZ1bGwgdm9sdW1lKQogIC8vKERJU0FCTEVEKSBwaXRjaFZhciA6IHBpdGNoIHZhcmlhbmNlIGluIGJyb3dzZXJzIHRoYXQgc3VwcG9ydCBpdCAoRmlyZWZveCBvbmx5IGF0IHRoZSBtb21lbnQpOyBkZWZhdWx0cyB0byAwLjA1ICh3aGljaCBtZWFucyBwaXRjaCBjYW4gYmUgdXAgdG8gLTUlIG9yICs1JSBhbnl0aW1lIHRoZSBzb3VuZCBwbGF5cykKICB2YXIgdm9sdW1lID0gMTsKICB2YXIgdm9sdW1lU2V0dGluZyA9IEdhbWUudm9sdW1lOwogIGlmICh0eXBlb2Ygdm9sICE9PSAidW5kZWZpbmVkIikgdm9sdW1lID0gdm9sOwogIGlmICh2b2x1bWUgPCAtNSkgewogICAgdm9sdW1lICs9IDEwOwogICAgdm9sdW1lU2V0dGluZyA9IEdhbWUudm9sdW1lTXVzaWM7CiAgfQogIGlmICghdm9sdW1lU2V0dGluZyB8fCB2b2x1bWUgPT0gMCkgcmV0dXJuIDA7CiAgaWYgKHR5cGVvZiBTb3VuZHNbdXJsXSA9PT0gInVuZGVmaW5lZCIpIHsKICAgIC8vc291bmQgaXNuJ3QgbG9hZGVkLCBjYWNoZSBpdAogICAgU291bmRzW3VybF0gPSBuZXcgQXVkaW8odXJsKTsKICAgIFNvdW5kc1t1cmxdLm9ubG9hZGVkZGF0YSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIFBsYXlTb3VuZCh1cmwsIHZvbCwgcGl0Y2hWYXIpOwogICAgfTsKICAgIC8vU291bmRzW3VybF0ubG9hZCgpOwogIH0gZWxzZSBpZiAoU291bmRzW3VybF0ucmVhZHlTdGF0ZSA+PSAyICYmIFNvdW5kSW5zdHNbU291bmRJXS5wYXVzZWQpIHsKICAgIHZhciBzb3VuZCA9IFNvdW5kSW5zdHNbU291bmRJXTsKICAgIFNvdW5kSSsrOwogICAgaWYgKFNvdW5kSSA+PSAxMikgU291bmRJID0gMDsKICAgIHNvdW5kLnNyYyA9IFNvdW5kc1t1cmxdLnNyYzsKICAgIC8vc291bmQuY3VycmVudFRpbWU9MDsKICAgIHNvdW5kLnZvbHVtZSA9IE1hdGgucG93KCh2b2x1bWUgKiB2b2x1bWVTZXR0aW5nKSAvIDEwMCwgMik7CiAgICBpZiAocGl0Y2hTdXBwb3J0KSB7CiAgICAgIHZhciBwaXRjaFZhciA9IHR5cGVvZiBwaXRjaFZhciA9PT0gInVuZGVmaW5lZCIgPyAwLjA1IDogcGl0Y2hWYXI7CiAgICAgIHZhciByYXRlID0gMSArIChNYXRoLnJhbmRvbSgpICogMiAtIDEpICogcGl0Y2hWYXI7CiAgICAgIHNvdW5kLnByZXNlcnZlc1BpdGNoID0gZmFsc2U7CiAgICAgIHNvdW5kLm1velByZXNlcnZlc1BpdGNoID0gZmFsc2U7CiAgICAgIHNvdW5kLndlYmtpdFByZXNlcnZlc1BpdGNoID0gZmFsc2U7CiAgICAgIHNvdW5kLnBsYXliYWNrUmF0ZSA9IHJhdGU7CiAgICB9CiAgICB0cnkgewogICAgICBzb3VuZC5wbGF5KCk7CiAgICB9IGNhdGNoIChlKSB7fQogICAgLyoKCQl2YXIgc291bmQ9U291bmRzW3VybF0uY2xvbmVOb2RlKCk7CgkJc291bmQudm9sdW1lPU1hdGgucG93KHZvbHVtZSp2b2x1bWVTZXR0aW5nLzEwMCwyKTsKCQlzb3VuZC5vbmVuZGVkPWZ1bmN0aW9uKGUpe2lmIChlLnRhcmdldCl7ZGVsZXRlIGUudGFyZ2V0O319OwoJCXNvdW5kLnBsYXkoKTsqLwogIH0KfTsKdmFyIFBsYXlNdXNpY1NvdW5kID0gZnVuY3Rpb24gKHVybCwgdm9sLCBwaXRjaFZhcikgewogIC8vbGlrZSBQbGF5U291bmQgYnV0LCBpZiBtdXNpYyBpcyBlbmFibGVkLCBwbGF5IHdpdGggbXVzaWMgdm9sdW1lCiAgUGxheVNvdW5kKHVybCwgKHZvbCB8fCAxKSAtIChNdXNpYyA/IDEwIDogMCksIHBpdGNoVmFyKTsKfTsKCk11c2ljID0gZmFsc2U7ClBsYXlDdWUgPSBmdW5jdGlvbiAoY3VlLCBhcmcpIHsKICBpZiAoTXVzaWMgJiYgR2FtZS5qdWtlYm94LnRyYWNrQXV0bykgTXVzaWMuY3VlKGN1ZSwgYXJnKTsKfTsKCmlmICghRGF0ZS5ub3cpIHsKICBEYXRlLm5vdyA9IGZ1bmN0aW9uIG5vdygpIHsKICAgIHJldHVybiBuZXcgRGF0ZSgpLmdldFRpbWUoKTsKICB9Owp9Cgp2YXIgdHJpZ2dlckFuaW0gPSBmdW5jdGlvbiAoZWxlbWVudCwgYW5pbSkgewogIGlmICghZWxlbWVudCkgcmV0dXJuOwogIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShhbmltKTsKICB2b2lkIGVsZW1lbnQub2Zmc2V0V2lkdGg7CiAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKGFuaW0pOwp9OwoKdmFyIGRlYnVnU3RyID0gIiI7CnZhciBEZWJ1ZyA9IGZ1bmN0aW9uICh3aGF0KSB7CiAgaWYgKCFkZWJ1Z1N0cikgZGVidWdTdHIgPSB3aGF0OwogIGVsc2UgZGVidWdTdHIgKz0gIjsgIiArIHdoYXQ7Cn07Cgp2YXIgVGltZXIgPSB7fTsKVGltZXIudCA9IERhdGUubm93KCk7ClRpbWVyLmxhYmVscyA9IFtdOwpUaW1lci5zbW9vdGhlZCA9IFtdOwpUaW1lci5yZXNldCA9IGZ1bmN0aW9uICgpIHsKICBUaW1lci5sYWJlbHMgPSBbXTsKICBUaW1lci50ID0gRGF0ZS5ub3coKTsKfTsKVGltZXIudHJhY2sgPSBmdW5jdGlvbiAobGFiZWwpIHsKICBpZiAoIUdhbWUuc2VzYW1lKSByZXR1cm47CiAgdmFyIG5vdyA9IERhdGUubm93KCk7CiAgaWYgKCFUaW1lci5zbW9vdGhlZFtsYWJlbF0pIFRpbWVyLnNtb290aGVkW2xhYmVsXSA9IDA7CiAgVGltZXIuc21vb3RoZWRbbGFiZWxdICs9IChub3cgLSBUaW1lci50IC0gVGltZXIuc21vb3RoZWRbbGFiZWxdKSAqIDAuMTsKICBUaW1lci5sYWJlbHNbbGFiZWxdID0KICAgICc8ZGl2IHN0eWxlPSJwYWRkaW5nLWxlZnQ6OHB4OyI+JyArCiAgICBsYWJlbCArCiAgICAiIDogIiArCiAgICBNYXRoLnJvdW5kKFRpbWVyLnNtb290aGVkW2xhYmVsXSkgKwogICAgIm1zPC9kaXY+IjsKICBUaW1lci50ID0gbm93Owp9OwpUaW1lci5jbGVhbiA9IGZ1bmN0aW9uICgpIHsKICBpZiAoIUdhbWUuc2VzYW1lKSByZXR1cm47CiAgdmFyIG5vdyA9IERhdGUubm93KCk7CiAgVGltZXIudCA9IG5vdzsKfTsKVGltZXIuc2F5ID0gZnVuY3Rpb24gKGxhYmVsKSB7CiAgaWYgKCFHYW1lLnNlc2FtZSkgcmV0dXJuOwogIFRpbWVyLmxhYmVsc1tsYWJlbF0gPQogICAgJzxkaXYgc3R5bGU9ImJvcmRlci10b3A6MXB4IHNvbGlkICNjY2M7Ij4nICsgbGFiZWwgKyAiPC9kaXY+IjsKfTsKCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpHQU1FIElOSVRJQUxJWkFUSU9OCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCnZhciBHYW1lID0ge307CgooZnVuY3Rpb24gKCkgewogIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJTU9ERElORyBBUEkKCT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCiAgLyoKCQl0byB1c2U6CgkJLShOT1RFOiB0aGlzIGZ1bmN0aW9ucyBhIGxpdHRsZSBkaWZmZXJlbnRseSBpbiB0aGUgc3RhbmRhbG9uZS9TdGVhbSB2ZXJzaW9uOyBoYXZlIGEgbG9vayBpbiB0aGUgZ2FtZSdzIC9tb2RzIGZvbGRlciBmb3IgZXhhbXBsZSBtb2RzIC0gdGhvdWdoIG1vc3Qgb2YgdGhlIGluZm9ybWF0aW9uIGJlbG93IHN0aWxsIGFwcGxpZXMpCgkJLWhhdmUgeW91ciBtb2QgY2FsbCBHYW1lLnJlZ2lzdGVyTW9kKCJ1bmlxdWUgaWQiLG1vZCBvYmplY3QpCgkJLXRoZSAidW5pcXVlIGlkIiB2YWx1ZSBpcyBhIHN0cmluZyB0aGUgbW9kIHdpbGwgdXNlIHRvIGluZGV4IGFuZCByZXRyaWV2ZSBpdHMgc2F2ZSBkYXRhOyBzcGVjaWFsIGNoYXJhY3RlcnMgYXJlIGlnbm9yZWQKCQktdGhlICJtb2Qgb2JqZWN0IiB2YWx1ZSBpcyBhbiBvYmplY3Qgc3RydWN0dXJlZCBsaWtlIHNvOgoJCQl7CgkJCQlpbml0OmZ1bmN0aW9uKCl7CgkJCQkJLy90aGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCBhcyBzb29uIGFzIHRoZSBtb2QgaXMgcmVnaXN0ZXJlZAoJCQkJCS8vZGVjbGFyZSBob29rcyBoZXJlCgkJCQl9LAoJCQkJc2F2ZTpmdW5jdGlvbigpewoJCQkJCS8vdXNlIHRoaXMgdG8gc3RvcmUgcGVyc2lzdGVudCBkYXRhIGFzc29jaWF0ZWQgd2l0aCB5b3VyIG1vZAoJCQkJCXJldHVybiAnYSBzdHJpbmcgdG8gYmUgc2F2ZWQnOwoJCQkJfSwKCQkJCWxvYWQ6ZnVuY3Rpb24oc3RyKXsKCQkJCQkvL2RvIHN0dWZmIHdpdGggdGhlIHN0cmluZyBkYXRhIHlvdSBzYXZlZCBwcmV2aW91c2x5CgkJCQl9LAoJCQl9CgkJLXRoZSBtb2Qgb2JqZWN0IG1heSBhbHNvIGNvbnRhaW4gYW55IG90aGVyIGRhdGEgb3IgZnVuY3Rpb25zIHlvdSB3YW50LCBmb3IgaW5zdGFuY2UgdG8gbWFrZSB0aGVtIGFjY2Vzc2libGUgdG8gb3RoZXIgbW9kcwoJCS15b3VyIG1vZCBhbmQgaXRzIGRhdGEgY2FuIGJlIGFjY2Vzc2VkIHdpdGggR2FtZS5tb2RzWydtb2QgaWQnXQoJCS1ob29rcyBhcmUgZnVuY3Rpb25zIHRoZSBnYW1lIGNhbGxzIGF1dG9tYXRpY2FsbHkgaW4gY2VydGFpbiBjaXJjdW1zdGFuY2VzLCBsaWtlIHdoZW4gY2FsY3VsYXRpbmcgY29va2llcyBwZXIgY2xpY2sgb3Igd2hlbiByZWRyYXdpbmcgdGhlIHNjcmVlbgoJCS10byBhZGQgYSBob29rOiBHYW1lLnJlZ2lzdGVySG9vaygnaG9vayBpZCcseW91ckZ1bmN0aW9uSGVyZSkgLSBub3RlOiB5b3UgY2FuIGFsc28gZGVjbGFyZSB3aG9sZSBhcnJheXMgb2YgaG9va3MsIGllLiBHYW1lLnJlZ2lzdGVySG9vaygnaG9vayBpZCcsW2Z1bmN0aW9uMSxmdW5jdGlvbjIsLi4uXSkKCQktdG8gcmVtb3ZlIGEgaG9vazogR2FtZS5yZW1vdmVIb29rKCdob29rIGlkJyx0aGVTYW1lRnVuY3Rpb25IZXJlKQoJCS1zb21lIGhvb2tzIGFyZSBmZWQgYSBwYXJhbWV0ZXIgeW91IGNhbiB1c2UgaW4gdGhlIGZ1bmN0aW9uCgkJLWxpc3Qgb2YgdmFsaWQgaG9vayBpZHM6CgkJCSdsb2dpYycgLSBjYWxsZWQgZXZlcnkgbG9naWMgdGljawoJCQknZHJhdycgLSBjYWxsZWQgZXZlcnkgZHJhdyB0aWNrCgkJCSdyZXNldCcgLSBjYWxsZWQgd2hlbmV2ZXIgdGhlIHBsYXllciByZXNldHM7IHBhcmFtZXRlciBpcyB0cnVlIGlmIHRoaXMgaXMgYSBoYXJkIHJlc2V0LCBmYWxzZSBpZiBpdCdzIGFuIGFzY2Vuc2lvbgoJCQkncmVpbmNhcm5hdGUnIC0gY2FsbGVkIHdoZW4gdGhlIHBsYXllciBoYXMgcmVpbmNhcm5hdGVkIGFmdGVyIGFuIGFzY2Vuc2lvbgoJCQkndGlja2VyJyAtIGNhbGxlZCB3aGVuIGRldGVybWluaW5nIG5ld3MgdGlja2VyIHRleHQ7IHNob3VsZCByZXR1cm4gYW4gYXJyYXkgb2YgcG9zc2libGUgY2hvaWNlcyB0byBhZGQKCQkJJ2NwcycgLSBjYWxsZWQgd2hlbiBkZXRlcm1pbmluZyB0aGUgQ3BTOyBwYXJhbWV0ZXIgaXMgdGhlIGN1cnJlbnQgQ3BTOyBzaG91bGQgcmV0dXJuIHRoZSBtb2RpZmllZCBDcFMKCQkJJ2Nvb2tpZXNQZXJDbGljaycgLSBjYWxsZWQgd2hlbiBkZXRlcm1pbmluZyB0aGUgY29va2llcyBwZXIgY2xpY2s7IHBhcmFtZXRlciBpcyB0aGUgY3VycmVudCB2YWx1ZTsgc2hvdWxkIHJldHVybiB0aGUgbW9kaWZpZWQgdmFsdWUKCQkJJ2NsaWNrJyAtIGNhbGxlZCB3aGVuIHRoZSBiaWcgY29va2llIGlzIGNsaWNrZWQKCQkJJ2NyZWF0ZScgLSBjYWxsZWQgYWZ0ZXIgdGhlIGdhbWUgZGVjbGFyZXMgYWxsIGJ1aWxkaW5ncywgYnVmZnMsIHVwZ3JhZGVzIGFuZCBhY2hpZXZzOyB1c2UgdGhpcyB0byBkZWNsYXJlIHlvdXIgb3duIC0gbm90ZSB0aGF0IHdoaWxlIHRoZSBnYW1lIGRpc3Rpbmd1aXNoZXMgYmV0d2VlbiB2YW5pbGxhIGFuZCBub24tdmFuaWxsYSBjb250ZW50LCBzYXZpbmcvbG9hZGluZyBmdW5jdGlvbmFsaXR5IGZvciBjdXN0b20gY29udGVudCAoaW5jbHVkaW5nIHN0dWZmIGxpa2UgYWN0aXZlIGJ1ZmZzIG9yIHBlcm1hbmVudCB1cGdyYWRlIHNsb3R0aW5nKSBpcyBub3QgZXhwbGljaXRseSBpbXBsZW1lbnRlZCBhbmQgbWF5IGJlIHVucHJlZGljdGFibGUgYW5kIGJyb2tlbgoJCQknY2hlY2snIC0gY2FsbGVkIGV2ZXJ5IGZldyBzZWNvbmRzIHdoZW4gd2UgY2hlY2sgZm9yIHVwZ3JhZGUvYWNoaWV2IHVubG9jayBjb25kaXRpb25zOyB5b3UgY2FuIGFsc28gdXNlIHRoaXMgZm9yIG90aGVyIGNoZWNrcyB0aGF0IHlvdSBkb24ndCBuZWVkIGhhcHBlbmluZyBldmVyeSBsb2dpYyBmcmFtZQoJCS1mdW5jdGlvbiBob29rcyBhcmUgcHJvdmlkZWQgZm9yIGNvbnZlbmllbmNlIGFuZCBtb3JlIGFkdmFuY2VkIG1vZCBmdW5jdGlvbmFsaXR5IHdpbGwgcHJvYmFibHkgaW52b2x2ZSBtYW51YWwgY29kZSBpbmplY3Rpb24KCQktcGxlYXNlIGJlIG1pbmRmdWwgb2YgdGhlIGxlbmd0aCBvZiB0aGUgZGF0YSB5b3Ugc2F2ZSwgYXMgaXQgZG9lcyBpbmZsYXRlIHRoZSBleHBvcnQtc2F2ZS10by1zdHJpbmcgZmVhdHVyZQoJCQoJCU5PVEU6IG1vZGRpbmcgQVBJIGlzIHN1c2NlcHRpYmxlIHRvIGNoYW5nZSBhbmQgbWF5IG5vdCBhbHdheXMgZnVuY3Rpb24gc3VwZXItd2VsbAoJKi8KICBHYW1lLm1vZHMgPSB7fTsKICBHYW1lLnNvcnRlZE1vZHMgPSBbXTsKICBHYW1lLmJyb2tlbk1vZHMgPSBbXTsKICBHYW1lLm1vZFNhdmVEYXRhID0ge307CiAgR2FtZS5tb2RIb29rcyA9IHt9OwogIEdhbWUubW9kSG9va3NOYW1lcyA9IFsKICAgICJsb2dpYyIsCiAgICAiZHJhdyIsCiAgICAicmVzZXQiLAogICAgInJlaW5jYXJuYXRlIiwKICAgICJ0aWNrZXIiLAogICAgImNwcyIsCiAgICAiY29va2llc1BlckNsaWNrIiwKICAgICJjbGljayIsCiAgICAiY3JlYXRlIiwKICAgICJjaGVjayIsCiAgXTsKICBmb3IgKHZhciBpID0gMDsgaSA8IEdhbWUubW9kSG9va3NOYW1lcy5sZW5ndGg7IGkrKykgewogICAgR2FtZS5tb2RIb29rc1tHYW1lLm1vZEhvb2tzTmFtZXNbaV1dID0gW107CiAgfQogIEdhbWUucmVnaXN0ZXJNb2QgPSBmdW5jdGlvbiAoaWQsIG1vZCkgewogICAgaWQgPSBpZC5yZXBsYWNlKC9cVysvZywgIiAiKTsKICAgIGlmIChpZCA9PSAiTUVUQSIpIHJldHVybiBmYWxzZTsKICAgIGlmIChHYW1lLm1vZHNbaWRdKSB7CiAgICAgIGNvbnNvbGUubG9nKCdFUlJPUjogbW9kIGFscmVhZHkgcmVnaXN0ZXJlZCB3aXRoIHRoZSBpZCAiJyArIGlkICsgJyIuJyk7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIEdhbWUubW9kc1tpZF0gPSBtb2Q7CiAgICBHYW1lLnNvcnRlZE1vZHMucHVzaChtb2QpOwogICAgbW9kLmlkID0gaWQ7CiAgICBtb2QubmFtZSA9IG1vZC5uYW1lIHx8IGlkOwogICAgaWYgKEFwcCkgQXBwLnJlZ2lzdGVyTW9kKG1vZCk7CiAgICBjb25zb2xlLmxvZygnTW9kICInICsgaWQgKyAnIiBhZGRlZC4nKTsKICAgIGlmIChHYW1lLnJlYWR5ICYmIG1vZC5pbml0KSB7CiAgICAgIGlmICghQXBwICYmIEdhbWUuV2luKSBHYW1lLldpbigiVGhpcmQtcGFydHkiKTsKICAgICAgbW9kLmluaXQoKTsKICAgICAgaWYgKG1vZC5sb2FkICYmIEdhbWUubW9kU2F2ZURhdGFbaWRdKSBtb2QubG9hZChHYW1lLm1vZFNhdmVEYXRhW2lkXSk7CiAgICAgIG1vZC5pbml0ID0gMDsKICAgIH0KICB9OwogIEdhbWUubGF1bmNoTW9kcyA9IGZ1bmN0aW9uICgpIHsKICAgIGlmIChHYW1lLmJyb2tlbk1vZHMubGVuZ3RoID4gMCkgewogICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAnPHNwYW4gY2xhc3M9Indhcm5pbmciPicgKwogICAgICAgICAgbG9jKCJTb21lIG1vZHMgY291bGRuJ3QgYmUgbG9hZGVkOiIpICsKICAgICAgICAgICI8L3NwYW4+IiwKICAgICAgICAiWyIgKyBHYW1lLmJyb2tlbk1vZHMuam9pbigiLCAiKSArICJdIiwKICAgICAgICBbMzIsIDE3XQogICAgICApOwogICAgfQogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBHYW1lLnNvcnRlZE1vZHMubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIG1vZCA9IEdhbWUuc29ydGVkTW9kc1tpXTsKICAgICAgaWYgKG1vZC5pbml0KSB7CiAgICAgICAgY29uc29sZS5sb2coIj09PWluaXRpYWxpemluZyBtb2QiLCBtb2QuaWQpOwogICAgICAgIG1vZC5pbml0KCk7CiAgICAgICAgbW9kLmluaXQgPSAwOwogICAgICAgIC8vaWYgKG1vZC5sb2FkICYmIEdhbWUubW9kU2F2ZURhdGFbbW9kLmlkXSkgbW9kLmxvYWQoR2FtZS5tb2RTYXZlRGF0YVttb2QuaWRdKTsKICAgICAgfQogICAgfQogICAgaWYgKCFBcHAgJiYgR2FtZS5zb3J0ZWRNb2RzLmxlbmd0aCA+IDApIEdhbWUuV2luKCJUaGlyZC1wYXJ0eSIpOwogIH07CiAgR2FtZS5yZWdpc3Rlckhvb2sgPSBmdW5jdGlvbiAoaG9vaywgZnVuYykgewogICAgaWYgKGZ1bmMuY29uc3RydWN0b3IgPT09IEFycmF5KSB7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZnVuYy5sZW5ndGg7IGkrKykgewogICAgICAgIEdhbWUucmVnaXN0ZXJIb29rKGhvb2ssIGZ1bmNbaV0pOwogICAgICB9CiAgICAgIHJldHVybjsKICAgIH0KICAgIGlmICh0eXBlb2YgZnVuYyAhPT0gImZ1bmN0aW9uIikgcmV0dXJuOwogICAgaWYgKHR5cGVvZiBHYW1lLm1vZEhvb2tzW2hvb2tdICE9PSAidW5kZWZpbmVkIikKICAgICAgR2FtZS5tb2RIb29rc1tob29rXS5wdXNoKGZ1bmMpOwogICAgZWxzZQogICAgICBjb25zb2xlLmxvZygKICAgICAgICAnRXJyb3I6IGEgbW9kIHRyaWVkIHRvIHJlZ2lzdGVyIGEgbm9uLWV4aXN0ZW50IGhvb2sgbmFtZWQgIicgKwogICAgICAgICAgaG9vayArCiAgICAgICAgICAnIi4nCiAgICAgICk7CiAgfTsKICBHYW1lLnJlbW92ZUhvb2sgPSBmdW5jdGlvbiAoaG9vaywgZnVuYykgewogICAgaWYgKGZ1bmMuY29uc3RydWN0b3IgPT09IEFycmF5KSB7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZnVuYy5sZW5ndGg7IGkrKykgewogICAgICAgIEdhbWUucmVtb3ZlSG9vayhob29rLCBmdW5jW2ldKTsKICAgICAgfQogICAgICByZXR1cm47CiAgICB9CiAgICBpZiAodHlwZW9mIGZ1bmMgIT09ICJmdW5jdGlvbiIpIHJldHVybjsKICAgIGlmICgKICAgICAgdHlwZW9mIEdhbWUubW9kSG9va3NbaG9va10gIT09ICJ1bmRlZmluZWQiICYmCiAgICAgIEdhbWUubW9kSG9va3NbaG9va10uaW5kZXhPZihmdW5jKSAhPSAtMQogICAgKQogICAgICBHYW1lLm1vZEhvb2tzW2hvb2tdLnNwbGljZShHYW1lLm1vZEhvb2tzW2hvb2tdLmluZGV4T2YoZnVuYyksIDEpOwogICAgZWxzZQogICAgICBjb25zb2xlLmxvZygKICAgICAgICAnRXJyb3I6IGEgbW9kIHRyaWVkIHRvIHJlbW92ZSBhIG5vbi1leGlzdGVudCBob29rIG5hbWVkICInICsgaG9vayArICciLicKICAgICAgKTsKICB9OwogIEdhbWUucnVuTW9kSG9vayA9IGZ1bmN0aW9uIChob29rLCBwYXJhbSkgewogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBHYW1lLm1vZEhvb2tzW2hvb2tdLmxlbmd0aDsgaSsrKSB7CiAgICAgIEdhbWUubW9kSG9va3NbaG9va11baV0ocGFyYW0pOwogICAgfQogIH07CiAgR2FtZS5ydW5Nb2RIb29rT25WYWx1ZSA9IGZ1bmN0aW9uIChob29rLCB2YWwpIHsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgR2FtZS5tb2RIb29rc1tob29rXS5sZW5ndGg7IGkrKykgewogICAgICB2YWwgPSBHYW1lLm1vZEhvb2tzW2hvb2tdW2ldKHZhbCk7CiAgICB9CiAgICByZXR1cm4gdmFsOwogIH07CiAgR2FtZS5zYWZlU2F2ZVN0cmluZyA9IGZ1bmN0aW9uIChzdHIpIHsKICAgIC8vbG9vayBhcyBsb25nIGFzIGl0IHdvcmtzCiAgICBzdHIgPSByZXBsYWNlQWxsKCJ8IiwgIltQXSIsIHN0cik7CiAgICBzdHIgPSByZXBsYWNlQWxsKCI7IiwgIltTXSIsIHN0cik7CiAgICByZXR1cm4gc3RyOwogIH07CiAgR2FtZS5zYWZlTG9hZFN0cmluZyA9IGZ1bmN0aW9uIChzdHIpIHsKICAgIHN0ciA9IHJlcGxhY2VBbGwoIltQXSIsICJ8Iiwgc3RyKTsKICAgIHN0ciA9IHJlcGxhY2VBbGwoIltTXSIsICI7Iiwgc3RyKTsKICAgIHJldHVybiBzdHI7CiAgfTsKICBHYW1lLnNhdmVNb2REYXRhID0gZnVuY3Rpb24gKCkgewogICAgdmFyIHN0ciA9ICIiOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBHYW1lLnNvcnRlZE1vZHMubGVuZ3RoOyBpKyspIHsKICAgICAgaWYgKEdhbWUuc29ydGVkTW9kc1tpXVsic2F2ZSJdKSB7CiAgICAgICAgdmFyIGRhdGEgPSBHYW1lLnNvcnRlZE1vZHNbaV1bInNhdmUiXSgpOwogICAgICAgIGlmICh0eXBlb2YgZGF0YSAhPT0gInVuZGVmaW5lZCIpCiAgICAgICAgICBHYW1lLm1vZFNhdmVEYXRhW0dhbWUuc29ydGVkTW9kc1tpXS5pZF0gPSBkYXRhOwogICAgICB9CiAgICB9CiAgICBmb3IgKHZhciBpIGluIEdhbWUubW9kU2F2ZURhdGEpIHsKICAgICAgc3RyICs9IGkgKyAiOiIgKyBHYW1lLnNhZmVTYXZlU3RyaW5nKEdhbWUubW9kU2F2ZURhdGFbaV0pICsgIjsiOwogICAgfQogICAgaWYgKEFwcCAmJiBBcHAuc2F2ZU1vZHMpIHN0ciArPSBBcHAuc2F2ZU1vZHMoKTsKICAgIHJldHVybiBzdHI7CiAgfTsKICBHYW1lLmxvYWRNb2REYXRhID0gZnVuY3Rpb24gKCkgewogICAgZm9yICh2YXIgaSBpbiBHYW1lLm1vZFNhdmVEYXRhKSB7CiAgICAgIGlmIChHYW1lLm1vZHNbaV0gJiYgR2FtZS5tb2RzW2ldWyJsb2FkIl0pCiAgICAgICAgR2FtZS5tb2RzW2ldWyJsb2FkIl0oR2FtZS5tb2RTYXZlRGF0YVtpXSk7CiAgICB9CiAgfTsKICBHYW1lLmRlbGV0ZU1vZERhdGEgPSBmdW5jdGlvbiAoaWQpIHsKICAgIGlmIChHYW1lLm1vZFNhdmVEYXRhW2lkXSkgZGVsZXRlIEdhbWUubW9kU2F2ZURhdGFbaWRdOwogIH07CiAgR2FtZS5kZWxldGVBbGxNb2REYXRhID0gZnVuY3Rpb24gKCkgewogICAgR2FtZS5tb2RTYXZlRGF0YSA9IHt9OwogIH07CiAgR2FtZS5DaGVja01vZERhdGEgPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgbW9kc04gPSAwOwogICAgdmFyIHN0ciA9ICIiOwogICAgZm9yICh2YXIgaSBpbiBHYW1lLm1vZFNhdmVEYXRhKSB7CiAgICAgIHN0ciArPQogICAgICAgICc8ZGl2IHN0eWxlPSJib3JkZXItYm90dG9tOjFweCBkYXNoZWQgcmdiYSgyNTUsMjU1LDI1NSwwLjIpO2NsZWFyOmJvdGg7b3ZlcmZsb3c6aGlkZGVuO3BhZGRpbmc6NHB4IDBweDsiPic7CiAgICAgIHN0ciArPQogICAgICAgICc8ZGl2IHN0eWxlPSJmbG9hdDpsZWZ0O3dpZHRoOjQ5JTt0ZXh0LWFsaWduOmxlZnQ7b3ZlcmZsb3c6aGlkZGVuOyI+PGI+JyArCiAgICAgICAgaSArCiAgICAgICAgIjwvYj4iOwogICAgICBpZiAoR2FtZS5tb2RzW2ldKSBzdHIgKz0gIiAiICsgbG9jKCIobG9hZGVkKSIpOwogICAgICBzdHIgKz0gIjwvZGl2PiI7CiAgICAgIHN0ciArPQogICAgICAgICc8ZGl2IHN0eWxlPSJmbG9hdDpyaWdodDt3aWR0aDo0OSU7dGV4dC1hbGlnbjpyaWdodDtvdmVyZmxvdzpoaWRkZW47Ij4nICsKICAgICAgICBsb2MoIiUxIGNoYXIiLCBHYW1lLm1vZFNhdmVEYXRhW2ldLmxlbmd0aCkgKwogICAgICAgICcgPGEgY2xhc3M9Im9wdGlvbiB3YXJuaW5nIiBzdHlsZT0icGFkZGluZzowcHggMnB4O2ZvbnQtc2l6ZToxMHB4O21hcmdpbjowcHg7dmVydGljYWwtYWxpZ246dG9wOyIgJyArCiAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgIj1cIkdhbWUuZGVsZXRlTW9kRGF0YSgnIiArCiAgICAgICAgaSArCiAgICAgICAgIicpO1BsYXlTb3VuZCgnc25kL3RpY2subXAzJyk7R2FtZS5DbG9zZVByb21wdCgpO0dhbWUuQ2hlY2tNb2REYXRhKCk7XCI+WDwvYT4iOwogICAgICBzdHIgKz0gIjwvZGl2PiI7CiAgICAgIHN0ciArPSAiPC9kaXY+IjsKICAgICAgbW9kc04rKzsKICAgIH0KICAgIGlmIChtb2RzTiA9PSAwKSBzdHIgKz0gbG9jKCJObyBtb2QgZGF0YSBwcmVzZW50LiIpOwogICAgZWxzZQogICAgICBzdHIgKz0KICAgICAgICAnPGRpdj48YSBjbGFzcz0ib3B0aW9uIHdhcm5pbmciIHN0eWxlPSJmb250LXNpemU6MTFweDttYXJnaW4tdG9wOjRweDsiICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICI9XCJHYW1lLmRlbGV0ZUFsbE1vZERhdGEoKTtQbGF5U291bmQoJ3NuZC90aWNrLm1wMycpO0dhbWUuQ2xvc2VQcm9tcHQoKTtHYW1lLkNoZWNrTW9kRGF0YSgpO1wiPiIgKwogICAgICAgIGxvYygiRGVsZXRlIGFsbCIpICsKICAgICAgICAiPC9hPjwvZGl2PiI7CiAgICBHYW1lLlByb21wdCgKICAgICAgIjxpZCBNb2REYXRhPjxoMz4iICsKICAgICAgICBsb2MoIk1vZCBkYXRhIikgKwogICAgICAgICc8L2gzPjxkaXYgY2xhc3M9ImJsb2NrIj4nICsKICAgICAgICB0aW55SWNvbihbMTYsIDVdKSArCiAgICAgICAgIjxkaXY+PC9kaXY+IiArCiAgICAgICAgbG9jKAogICAgICAgICAgIlRoZXNlIGFyZSB0aGUgbW9kcyBwcmVzZW50IGluIHlvdXIgc2F2ZSBkYXRhLiBZb3UgbWF5IGRlbGV0ZSBzb21lIG9mIHRoaXMgZGF0YSB0byBtYWtlIHlvdXIgc2F2ZSBmaWxlIHNtYWxsZXIuIgogICAgICAgICkgKwogICAgICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJibG9jayIgc3R5bGU9ImZvbnQtc2l6ZToxMXB4OyI+JyArCiAgICAgICAgc3RyICsKICAgICAgICAiPC9kaXY+IiwKICAgICAgW2xvYygiQmFjayIpXQogICAgKTsKICB9OwoKICBHYW1lLkxvYWRNb2QgPSBMb2FkU2NyaXB0OyAvL2xvYWRzIHRoZSBtb2QgYXQgdGhlIGdpdmVuIFVSTAoKICBpZiAoZmFsc2UpIHsKICAgIC8vRVhBTVBMRSBNT0QKICAgIEdhbWUucmVnaXN0ZXJNb2QoInRlc3QgbW9kIiwgewogICAgICAvKgoJCQkJd2hhdCB0aGlzIGV4YW1wbGUgbW9kIGRvZXM6CgkJCQktZG91YmxlIHlvdXIgQ3BTCgkJCQktZGlzcGxheSBhIGxpdHRsZSBwb3B1cCBmb3IgaGFsZiBhIHNlY29uZCB3aGVuZXZlciB5b3UgY2xpY2sgdGhlIGJpZyBjb29raWUKCQkJCS1hZGQgYSBsaXR0bGUgaW50cm8gdGV4dCBhYm92ZSB5b3VyIGJha2VyeSBuYW1lLCBhbmQgZ2VuZXJhdGUgdGhhdCBpbnRybyB0ZXh0IGF0IHJhbmRvbSBpZiB5b3UgZG9uJ3QgYWxyZWFkeSBoYXZlIG9uZQoJCQkJLXNhdmUgYW5kIGxvYWQgeW91ciBpbnRybyB0ZXh0CgkJCSovCiAgICAgIGluaXQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLnJlZ2lzdGVySG9vaygicmVpbmNhcm5hdGUiLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBHYW1lLm1vZHNbInRlc3QgbW9kIl0uYWRkSW50cm8oKTsKICAgICAgICB9KTsKICAgICAgICBHYW1lLnJlZ2lzdGVySG9vaygiY2hlY2siLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAoIUdhbWUucGxheWVySW50cm8pIHsKICAgICAgICAgICAgR2FtZS5tb2RzWyJ0ZXN0IG1vZCJdLmFkZEludHJvKCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgR2FtZS5yZWdpc3Rlckhvb2soImNsaWNrIiwgZnVuY3Rpb24gKCkgewogICAgICAgICAgR2FtZS5Ob3RpZnkoCiAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgIkEgZ29vZCBjbGljay4iLAogICAgICAgICAgICAgICJBIHNvbGlkIGNsaWNrLiIsCiAgICAgICAgICAgICAgIkEgbWVkaW9jcmUgY2xpY2suIiwKICAgICAgICAgICAgICAiQW4gZXhjZWxsZW50IGNsaWNrISIsCiAgICAgICAgICAgIF0pLAogICAgICAgICAgICAiIiwKICAgICAgICAgICAgMCwKICAgICAgICAgICAgMC41CiAgICAgICAgICApOwogICAgICAgIH0pOwogICAgICAgIEdhbWUucmVnaXN0ZXJIb29rKCJjcHMiLCBmdW5jdGlvbiAoY3BzKSB7CiAgICAgICAgICByZXR1cm4gY3BzICogMjsKICAgICAgICB9KTsKICAgICAgfSwKICAgICAgc2F2ZTogZnVuY3Rpb24gKCkgewogICAgICAgIC8vbm90ZTogd2UgdXNlIHN0cmluZ2lmaWVkIEpTT04gZm9yIGVhc2UgYW5kIGNsYXJpdHkgYnV0IHlvdSBjb3VsZCBzdG9yZSBhbnkgdHlwZSBvZiBzdHJpbmcKICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoeyB0ZXh0OiBHYW1lLnBsYXllckludHJvIH0pOwogICAgICB9LAogICAgICBsb2FkOiBmdW5jdGlvbiAoc3RyKSB7CiAgICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKHN0cik7CiAgICAgICAgaWYgKGRhdGEudGV4dCkgR2FtZS5tb2RzWyJ0ZXN0IG1vZCJdLmFkZEludHJvKGRhdGEudGV4dCk7CiAgICAgIH0sCiAgICAgIGFkZEludHJvOiBmdW5jdGlvbiAodGV4dCkgewogICAgICAgIC8vbm90ZTogdGhpcyBpcyBub3QgYSBtb2QgaG9vaywganVzdCBhIGZ1bmN0aW9uIHRoYXQncyBwYXJ0IG9mIHRoZSBtb2QKICAgICAgICBHYW1lLnBsYXllckludHJvID0KICAgICAgICAgIHRleHQgfHwKICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICJvaCBzbmFwLCBpdCdzIiwKICAgICAgICAgICAgIndhdGNoIG91dCwgaXQncyIsCiAgICAgICAgICAgICJvaCBubyEgaGVyZSBjb21lcyIsCiAgICAgICAgICAgICJoaWRlIHlvdXIgY29va2llcywgZm9yIGhlcmUgY29tZXMiLAogICAgICAgICAgICAiYmVob2xkISBpdCdzIiwKICAgICAgICAgIF0pOwogICAgICAgIGlmICghbCgiYmFrZXJ5U3VidGl0bGUiKSkKICAgICAgICAgIGwoImJha2VyeU5hbWUiKS5pbnNlcnRBZGphY2VudEhUTUwoCiAgICAgICAgICAgICJhZnRlcmVuZCIsCiAgICAgICAgICAgICc8ZGl2IGlkPSJiYWtlcnlTdWJ0aXRsZSIgY2xhc3M9InRpdGxlIiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7cG9zaXRpb246YWJzb2x1dGU7bGVmdDowcHg7cmlnaHQ6MHB4O2JvdHRvbTozMnB4O2ZvbnQtc2l6ZToxMnB4O3BvaW50ZXItZXZlbnRzOm5vbmU7dGV4dC1zaGFkb3c6MHB4IDFweCAxcHggIzAwMCwwcHggMHB4IDRweCAjZjAwO29wYWNpdHk6MC44OyI+PC9kaXY+JwogICAgICAgICAgKTsKICAgICAgICBsKCJiYWtlcnlTdWJ0aXRsZSIpLnRleHRDb250ZW50ID0gIn4iICsgR2FtZS5wbGF5ZXJJbnRybyArICJ+IjsKICAgICAgfSwKICAgIH0pOwogIH0KCiAgLy9yZXBsYWNpbmcgYW4gZXhpc3RpbmcgY2FudmFzIHBpY3R1cmUgd2l0aCBhIG5ldyBvbmUgYXQgcnVudGltZSA6IEdhbWUuTG9hZGVyLlJlcGxhY2UoJ3BlcmZlY3RDb29raWUucG5nJywnaW1wZXJmZWN0Q29va2llLnBuZycpOwogIC8vdXBncmFkZXMgYW5kIGFjaGlldmVtZW50cyBjYW4gdXNlIG90aGVyIHBpY3R1cmVzIHRoYW4gaWNvbnMucG5nOyBkZWNsYXJlIHRoZWlyIGljb24gd2l0aCBbcG9zWCxwb3NZLCdodHRwOi8vZXhhbXBsZS5jb20vbXlJY29ucy5wbmcnXQogIC8vY2hlY2sgb3V0IHRoZSAiVU5MT0NLSU5HIFNUVUZGIiBzZWN0aW9uIHRvIHNlZSBob3cgdW5sb2NraW5nIGFjaGlldnMgYW5kIHVwZ3JhZGVzIGlzIGRvbmUKfSkoKTsKCkdhbWUudmVyc2lvbiA9IFZFUlNJT047CkdhbWUubG9hZGVkRnJvbVZlcnNpb24gPSBWRVJTSU9OOwpHYW1lLmJldGEgPSBCRVRBOwppZiAoIUFwcCAmJiB3aW5kb3cubG9jYXRpb24uaHJlZi5pbmRleE9mKCIvYmV0YSIpID4gLTEpIEdhbWUuYmV0YSA9IDE7CmVsc2UgaWYgKEFwcCAmJiBuZXcgVVJMKHdpbmRvdy5sb2NhdGlvbi5ocmVmKS5zZWFyY2hQYXJhbXMuZ2V0KCJiZXRhIikpCiAgR2FtZS5iZXRhID0gMTsKR2FtZS5odHRwcyA9ICFBcHAgPyAobG9jYXRpb24ucHJvdG9jb2wgIT0gImh0dHBzOiIgPyBmYWxzZSA6IHRydWUpIDogdHJ1ZTsKR2FtZS5TYXZlVG8gPSAiQ29va2llQ2xpY2tlckdhbWUiOwppZiAoR2FtZS5iZXRhKSBHYW1lLlNhdmVUbyA9ICJDb29raWVDbGlja2VyR2FtZUJldGEiOwppZiAoQXBwICYmIG5ldyBVUkwod2luZG93LmxvY2F0aW9uLmhyZWYpLnNlYXJjaFBhcmFtcy5nZXQoIm1vZGxlc3MiKSkKICBHYW1lLm1vZGxlc3MgPSAxOwoKR2FtZS5MYXVuY2ggPSBmdW5jdGlvbiAoKSB7CiAgR2FtZS5tb2JpbGUgPSAwOwogIEdhbWUudG91Y2hFdmVudHMgPSAwOwogIC8vaWYgKC9BbmRyb2lkfHdlYk9TfGlQaG9uZXxpUGFkfGlQb2R8QmxhY2tCZXJyeXxJRU1vYmlsZXxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgR2FtZS5tb2JpbGU9MTsKICAvL2lmIChHYW1lLm1vYmlsZSkgR2FtZS50b3VjaEV2ZW50cz0xOwogIC8vaWYgKCdvbnRvdWNoc3RhcnQnIGluIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCkgR2FtZS50b3VjaEV2ZW50cz0xOwoKICB2YXIgY3NzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic3R5bGUiKTsKICBjc3MudHlwZSA9ICJ0ZXh0L2NzcyI7CiAgY3NzLmlubmVySFRNTCA9CiAgICAiYm9keSAuaWNvbixib2R5IC5jcmF0ZSxib2R5IC51c2VzSWNvbntiYWNrZ3JvdW5kLWltYWdlOnVybChpbWcvaWNvbnMucG5nP3Y9IiArCiAgICBHYW1lLnZlcnNpb24gKwogICAgIik7fSI7CiAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChjc3MpOwoKICAvL3RoaXMgaXMgc28gc2hpbW1lcnMgY2FuIHN0aWxsIGFwcGVhciBldmVuIGlmIHlvdSBsb3NlIGNvbm5lY3Rpb24gYWZ0ZXIgdGhlIGdhbWUgaXMgbG9hZGVkCiAgdmFyIHByZWxvYWRJbWFnZXMgPSBbCiAgICAiaW1nL2dvbGRDb29raWUucG5nIiwKICAgICJpbWcvd3JhdGhDb29raWUucG5nIiwKICAgICJpbWcvc3Bvb2t5Q29va2llLnBuZyIsCiAgICAiaW1nL2hlYXJ0cy5wbmciLAogICAgImltZy9jb250cmFjdC5wbmciLAogICAgImltZy93cmF0aENvbnRyYWN0LnBuZyIsCiAgICAiaW1nL2J1bm5pZXMucG5nIiwKICAgICJpbWcvZnJvc3RlZFJlaW5kZWVyLnBuZyIsCiAgXTsKICB2YXIgcHJlbG9hZEltYWdlc0wgPSBsKCJwcmVsb2FkSW1hZ2VzIik7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcmVsb2FkSW1hZ2VzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgaW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaW1nIik7CiAgICBpbWcuc3JjID0gcHJlbG9hZEltYWdlc1tpXTsKICAgIHByZWxvYWRJbWFnZXNMLmFwcGVuZENoaWxkKGltZyk7CiAgfQoKICBHYW1lLnZpc2libGUgPSB0cnVlOwogIEFkZEV2ZW50KGRvY3VtZW50LCAidmlzaWJpbGl0eWNoYW5nZSIsIGZ1bmN0aW9uIChlKSB7CiAgICBpZiAoZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlID09PSAiaGlkZGVuIikgR2FtZS52aXNpYmxlID0gZmFsc2U7CiAgICBlbHNlIEdhbWUudmlzaWJsZSA9IHRydWU7CiAgfSk7CgogIGlmICghRU4pIHsKICAgIC8vY29kZS1wYXRjaGluZyB0aGUgQ1NTIGZvciBsb2NhbGl6YXRpb24gZmVlbHMgbGlrZSBpdCBzaG91bGQgYmUgYWdhaW5zdCB0aGUgbGF3LCBhbmQgeWV0CiAgICB2YXIgY3NzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic3R5bGUiKTsKICAgIGNzcy50eXBlID0gInRleHQvY3NzIjsKICAgIGNzcy5pbm5lckhUTUwgPQogICAgICAiI3VwZ3JhZGVzOmJlZm9yZXtjb250ZW50OiciICsKICAgICAgbG9jKCJVcGdyYWRlcyIpICsKICAgICAgIic7fSIgKwogICAgICAiI3RvZ2dsZVVwZ3JhZGVzOmJlZm9yZXtjb250ZW50OiciICsKICAgICAgbG9jKCJTd2l0Y2hlcyIpICsKICAgICAgIic7fSIgKwogICAgICAiI3RlY2hVcGdyYWRlczpiZWZvcmV7Y29udGVudDonIiArCiAgICAgIGxvYygiUmVzZWFyY2giKSArCiAgICAgICInO30iICsKICAgICAgIiN2YXVsdFVwZ3JhZGVzOmJlZm9yZXtjb250ZW50OiciICsKICAgICAgbG9jKCJWYXVsdCIpICsKICAgICAgIic7fSIgKwogICAgICAiI3Byb2R1Y3RzOmJlZm9yZXtjb250ZW50OiciICsKICAgICAgbG9jKCJCdWlsZGluZ3MiKSArCiAgICAgICInO30iICsKICAgICAgIiI7CiAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGNzcyk7CiAgfQoKICBHYW1lLmJhc2VTZWFzb24gPSAiIjsgLy9oYWxsb3dlZW4sIGNocmlzdG1hcywgdmFsZW50aW5lcywgZm9vbHMsIGVhc3RlcgogIC8vYXV0b21hdGljIHNlYXNvbiBkZXRlY3Rpb24gKG1pZ2h0IG5vdCBiZSAxMDAlIGFjY3VyYXRlKQogIHZhciB5ZWFyID0gbmV3IERhdGUoKS5nZXRGdWxsWWVhcigpOwogIHZhciBsZWFwID0gKHllYXIgJSA0ID09IDAgJiYgeWVhciAlIDEwMCAhPSAwKSB8fCB5ZWFyICUgNDAwID09IDAgPyAxIDogMDsKICB2YXIgZGF5ID0gTWF0aC5mbG9vcigKICAgIChuZXcgRGF0ZSgpIC0gbmV3IERhdGUoeWVhciwgMCwgMCkpIC8gKDEwMDAgKiA2MCAqIDYwICogMjQpCiAgKTsKICBpZiAoZGF5ID49IDQxICYmIGRheSA8PSA0NikgR2FtZS5iYXNlU2Vhc29uID0gInZhbGVudGluZXMiOwogIGVsc2UgaWYgKGRheSArIGxlYXAgPj0gOTAgJiYgZGF5IDw9IDkyICsgbGVhcCkgR2FtZS5iYXNlU2Vhc29uID0gImZvb2xzIjsKICBlbHNlIGlmIChkYXkgPj0gMzA0IC0gNyArIGxlYXAgJiYgZGF5IDw9IDMwNCArIGxlYXApCiAgICBHYW1lLmJhc2VTZWFzb24gPSAiaGFsbG93ZWVuIjsKICBlbHNlIGlmIChkYXkgPj0gMzQ5ICsgbGVhcCAmJiBkYXkgPD0gMzY1ICsgbGVhcCkKICAgIEdhbWUuYmFzZVNlYXNvbiA9ICJjaHJpc3RtYXMiOwogIGVsc2UgewogICAgLy9lYXN0ZXIgaXMgYSBwYWluIGdvZGRhbW4KICAgIHZhciBlYXN0ZXJEYXkgPSAoZnVuY3Rpb24gKFkpIHsKICAgICAgdmFyIEMgPSBNYXRoLmZsb29yKFkgLyAxMDApOwogICAgICB2YXIgTiA9IFkgLSAxOSAqIE1hdGguZmxvb3IoWSAvIDE5KTsKICAgICAgdmFyIEsgPSBNYXRoLmZsb29yKChDIC0gMTcpIC8gMjUpOwogICAgICB2YXIgSSA9IEMgLSBNYXRoLmZsb29yKEMgLyA0KSAtIE1hdGguZmxvb3IoKEMgLSBLKSAvIDMpICsgMTkgKiBOICsgMTU7CiAgICAgIEkgPSBJIC0gMzAgKiBNYXRoLmZsb29yKEkgLyAzMCk7CiAgICAgIEkgPQogICAgICAgIEkgLQogICAgICAgIE1hdGguZmxvb3IoSSAvIDI4KSAqCiAgICAgICAgICAoMSAtCiAgICAgICAgICAgIE1hdGguZmxvb3IoSSAvIDI4KSAqCiAgICAgICAgICAgICAgTWF0aC5mbG9vcigyOSAvIChJICsgMSkpICoKICAgICAgICAgICAgICBNYXRoLmZsb29yKCgyMSAtIE4pIC8gMTEpKTsKICAgICAgdmFyIEogPSBZICsgTWF0aC5mbG9vcihZIC8gNCkgKyBJICsgMiAtIEMgKyBNYXRoLmZsb29yKEMgLyA0KTsKICAgICAgSiA9IEogLSA3ICogTWF0aC5mbG9vcihKIC8gNyk7CiAgICAgIHZhciBMID0gSSAtIEo7CiAgICAgIHZhciBNID0gMyArIE1hdGguZmxvb3IoKEwgKyA0MCkgLyA0NCk7CiAgICAgIHZhciBEID0gTCArIDI4IC0gMzEgKiBNYXRoLmZsb29yKE0gLyA0KTsKICAgICAgcmV0dXJuIG5ldyBEYXRlKFksIE0gLSAxLCBEKTsKICAgIH0pKHllYXIpOwogICAgZWFzdGVyRGF5ID0gTWF0aC5mbG9vcigKICAgICAgKGVhc3RlckRheSAtIG5ldyBEYXRlKGVhc3RlckRheS5nZXRGdWxsWWVhcigpLCAwLCAwKSkgLwogICAgICAgICgxMDAwICogNjAgKiA2MCAqIDI0KQogICAgKTsKICAgIGlmIChkYXkgPj0gZWFzdGVyRGF5IC0gNyAmJiBkYXkgPD0gZWFzdGVyRGF5KSBHYW1lLmJhc2VTZWFzb24gPSAiZWFzdGVyIjsKICB9CgogIEdhbWUudXBkYXRlTG9nID0KICAgICc8ZGl2IGNsYXNzPSJzZWxlY3RhYmxlIj4nICsKICAgICc8ZGl2IGNsYXNzPSJzZWN0aW9uIj4nICsKICAgIGxvYygiSW5mbyIpICsKICAgICI8L2Rpdj4iICsKICAgICc8ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+JyArCiAgICBsb2MoIkFib3V0IikgKwogICAgIjwvZGl2PiIgKwogICAgKEFwcAogICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIiBzdHlsZT0iZm9udC13ZWlnaHQ6Ym9sZDtmb250LXN0eWxlOml0YWxpYztvcGFjaXR5OjAuNTsiPicgKwogICAgICAgIGxvYygiTm90ZTogbGlua3Mgd2lsbCBvcGVuIGluIHlvdXIgd2ViIGJyb3dzZXIuIikgKwogICAgICAgICI8L2Rpdj4iCiAgICAgIDogIiIpICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4nICsKICAgIGxvYygiQ29va2llIENsaWNrZXIgaXMgYSBqYXZhc2NyaXB0IGdhbWUgYnkgJTEgYW5kICUyLiIsIFsKICAgICAgJzxhIGhyZWY9Ii8vb3J0ZWlsLmRhc2huZXQub3JnIiB0YXJnZXQ9Il9ibGFuayI+T3J0ZWlsPC9hPicsCiAgICAgICc8YSBocmVmPSIvL2Rhc2huZXQub3JnIiB0YXJnZXQ9Il9ibGFuayI+T3B0aTwvYT4nLAogICAgXSkgKwogICAgIjwvZGl2PiIgKwogICAgKEFwcAogICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4nICsKICAgICAgICBsb2MoCiAgICAgICAgICAiTXVzaWMgYnkgJTEuIiwKICAgICAgICAgICc8YSBocmVmPSJodHRwczovL3R3aXR0ZXIuY29tL0M0MTgiIHRhcmdldD0iX2JsYW5rIj5DNDE4PC9hPicKICAgICAgICApICsKICAgICAgICAiPC9kaXY+IgogICAgICA6ICIiKSArCiAgICAvLyc8ZGl2IGNsYXNzPSJsaXN0aW5nIj5XZSBoYXZlIGFuIDxhIGhyZWY9Imh0dHBzOi8vZGlzY29yZGFwcC5jb20vaW52aXRlL2Nvb2tpZSIgdGFyZ2V0PSJfYmxhbmsiPm9mZmljaWFsIERpc2NvcmQ8L2E+LCBhcyB3ZWxsIGFzIGEgPGEgaHJlZj0iaHR0cDovL2ZvcnVtLmRhc2huZXQub3JnIiB0YXJnZXQ9Il9ibGFuayI+Zm9ydW08L2E+OyAnKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPicgKwogICAgKEVOCiAgICAgID8gJ1dlIGhhdmUgYW4gPGEgaHJlZj0iaHR0cHM6Ly9kaXNjb3JkYXBwLmNvbS9pbnZpdGUvY29va2llIiB0YXJnZXQ9Il9ibGFuayI+b2ZmaWNpYWwgRGlzY29yZDwvYT47IGlmIHlvdVwncmUgbG9va2luZyBmb3IgaGVscCwgeW91IG1heSBhbHNvIHdhbnQgdG8gdmlzaXQgdGhlIDxhIGhyZWY9Imh0dHBzOi8vd3d3LnJlZGRpdC5jb20vci9Db29raWVDbGlja2VyIiB0YXJnZXQ9Il9ibGFuayI+c3VicmVkZGl0PC9hPiBvciB0aGUgPGEgaHJlZj0iaHR0cHM6Ly9jb29raWVjbGlja2VyLndpa2lhLmNvbS93aWtpL0Nvb2tpZV9DbGlja2VyX1dpa2kiIHRhcmdldD0iX2JsYW5rIj53aWtpPC9hPi48YnI+TmV3cyBhbmQgdGVhc2VycyBhcmUgdXN1YWxseSBwb3N0ZWQgb24gT3J0ZWlsXCdzIDxhIGhyZWY9Imh0dHBzOi8vb3J0ZWlsNDIudHVtYmxyLmNvbS8iIHRhcmdldD0iX2JsYW5rIj50dW1ibHI8L2E+IGFuZCA8YSBocmVmPSJodHRwczovL3R3aXR0ZXIuY29tL29ydGVpbDQyIiB0YXJnZXQ9Il9ibGFuayI+dHdpdHRlcjwvYT4uJwogICAgICA6IGxvYygiVXNlZnVsIGxpbmtzOiAlMSwgJTIsICUzLCAlNC4iLCBbCiAgICAgICAgICAnPGEgaHJlZj0iaHR0cHM6Ly9kaXNjb3JkYXBwLmNvbS9pbnZpdGUvY29va2llIiB0YXJnZXQ9Il9ibGFuayIgY2xhc3M9ImhpZ2hsaWdodEhvdmVyIHNtYWxsQmxhY2tCdXR0b24iPkRpc2NvcmQ8L2E+JywKICAgICAgICAgICc8YSBocmVmPSJodHRwczovL2Nvb2tpZWNsaWNrZXIud2lraWEuY29tL3dpa2kvQ29va2llX0NsaWNrZXJfV2lraSIgdGFyZ2V0PSJfYmxhbmsiIGNsYXNzPSJoaWdobGlnaHRIb3ZlciBzbWFsbEJsYWNrQnV0dG9uIj53aWtpPC9hPicsCiAgICAgICAgICAnPGEgaHJlZj0iaHR0cHM6Ly9vcnRlaWw0Mi50dW1ibHIuY29tLyIgdGFyZ2V0PSJfYmxhbmsiIGNsYXNzPSJoaWdobGlnaHRIb3ZlciBzbWFsbEJsYWNrQnV0dG9uIj50dW1ibHI8L2E+JywKICAgICAgICAgICc8YSBocmVmPSJodHRwczovL3R3aXR0ZXIuY29tL29ydGVpbDQyIiB0YXJnZXQ9Il9ibGFuayIgY2xhc3M9ImhpZ2hsaWdodEhvdmVyIHNtYWxsQmxhY2tCdXR0b24iPnR3aXR0ZXI8L2E+JywKICAgICAgICBdKSkgKwogICAgIjwvZGl2PiIgKwogICAgKCFBcHAKICAgICAgPyAnPGRpdiBjbGFzcz0ibGlzdGluZyBibG9jayIgc3R5bGU9Im1hcmdpbjo4cHggMzJweDtmb250LXNpemU6MTFweDtsaW5lLWhlaWdodDoxMTAlO2NvbG9yOnJnYmEoMjAwLDIwMCwyNTUsMSk7YmFja2dyb3VuZDpyZ2JhKDEyOCwxMjgsMjU1LDAuMTUpOyIgaWQ9InN1cHBvcnRTZWN0aW9uIj4nICsKICAgICAgICBsb2MoCiAgICAgICAgICAiVGhpcyB2ZXJzaW9uIG9mIENvb2tpZSBDbGlja2VyIGlzIDEwMCUgZnJlZSwgZm9yZXZlci4gV2FudCB0byBzdXBwb3J0IHVzIHNvIHdlIGNhbiBrZWVwIGRldmVsb3BpbmcgZ2FtZXM/IEhlcmUncyBzb21lIHdheXMgeW91IGNhbiBoZWxwOiUxIiwKICAgICAgICAgIFsKICAgICAgICAgICAgKCFBcHAKICAgICAgICAgICAgICA/ICI8YnI+PGJyPiZidWxsOyAiICsKICAgICAgICAgICAgICAgIChFTiA/ICJnZXQgIiA6ICIiKSArCiAgICAgICAgICAgICAgICAnPGEgaHJlZj0iaHR0cHM6Ly9zdG9yZS5zdGVhbXBvd2VyZWQuY29tL2FwcC8xNDU0NDAwL0Nvb2tpZV9DbGlja2VyLyIgdGFyZ2V0PSJfYmxhbmsiIGNsYXNzPSJoaWdobGlnaHRIb3ZlciBzbWFsbFdoaXRlQnV0dG9uIj5Db29raWUgQ2xpY2tlciBvbiBTdGVhbTwvYT4nCiAgICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgICAgICIiICsKICAgICAgICAgICAgICAoRU4gPyAiIChpdCdzIGFib3V0IDUgYnVja3MpIiA6ICIiKSArCiAgICAgICAgICAgICAgIjxicj48YnI+JmJ1bGw7ICIgKwogICAgICAgICAgICAgIChFTiA/ICJzdXBwb3J0IHVzIG9uICIgOiAiIikgKwogICAgICAgICAgICAgICc8YSBocmVmPSJodHRwczovL3d3dy5wYXRyZW9uLmNvbS9kYXNobmV0IiB0YXJnZXQ9Il9ibGFuayIgY2xhc3M9ImhpZ2hsaWdodEhvdmVyIHNtYWxsT3JhbmdlQnV0dG9uIj5QYXRyZW9uPC9hPicgKwogICAgICAgICAgICAgIChFTiA/ICIgKHRoZXJlJ3MgcGVya3MhKSIgOiAiIikgKwogICAgICAgICAgICAgICI8YnI+PGJyPiZidWxsOyAiICsKICAgICAgICAgICAgICAoRU4gPyAiY2hlY2sgb3V0IG91ciAiIDogIiIpICsKICAgICAgICAgICAgICAnPGEgaHJlZj0iaHR0cDovL3d3dy5yZWRidWJibGUuY29tL3Blb3BsZS9kYXNobmV0IiB0YXJnZXQ9Il9ibGFuayIgY2xhc3M9ImhpZ2hsaWdodEhvdmVyIHNtYWxsV2hpdGVCdXR0b24iPlNob3A8L2E+JyArCiAgICAgICAgICAgICAgKEVOID8gIiB3aXRoIHJhZCBjb29raWUgc2hpcnRzLCBob29kaWVzIGFuZCBzdGlja2VycyIgOiAiIikgKwogICAgICAgICAgICAgICghQXBwICYmIEVOCiAgICAgICAgICAgICAgICA/ICI8YnI+PGJyPiZidWxsOyBkaXNhYmxlIHlvdXIgYWRibG9ja2VyIChpZiB5b3Ugd2FudCEpIgogICAgICAgICAgICAgICAgOiAiIiksCiAgICAgICAgICBdCiAgICAgICAgKSArCiAgICAgICAgIjwvZGl2PjwvZGl2PiIKICAgICAgOiAiIikgKwogICAgJzxkaXYgY2xhc3M9Imxpc3Rpbmcgd2FybmluZyI+JyArCiAgICBsb2MoCiAgICAgICJOb3RlOiBpZiB5b3UgZmluZCBhIG5ldyBidWcgYWZ0ZXIgYW4gdXBkYXRlIGFuZCB5b3UncmUgdXNpbmcgYSAzcmQtcGFydHkgYWRkLW9uLCBtYWtlIHN1cmUgaXQncyBub3QganVzdCB5b3VyIGFkZC1vbiBjYXVzaW5nIGl0ISIKICAgICkgKwogICAgIjwvZGl2PiIgKwogICAgKCFBcHAKICAgICAgPyAnPGRpdiBjbGFzcz0ibGlzdGluZyB3YXJuaW5nIj4nICsKICAgICAgICBsb2MoCiAgICAgICAgICAiV2FybmluZzogY2xlYXJpbmcgeW91ciBicm93c2VyIGNhY2hlIG9yIGNvb2tpZXMgPHNtYWxsPih3aGF0IGVsc2U/KTwvc21hbGw+IHdpbGwgcmVzdWx0IGluIHlvdXIgc2F2ZSBiZWluZyB3aXBlZC4gRXhwb3J0IHlvdXIgc2F2ZSBhbmQgYmFjayBpdCB1cCBmaXJzdCEiCiAgICAgICAgKSArCiAgICAgICAgIjwvZGl2PiIKICAgICAgOiAiIikgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24iPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4nICsKICAgIGxvYygiVmVyc2lvbiBoaXN0b3J5IikgKwogICAgIjwvZGl2PiI7CgogIGZvciAodmFyIGkgPSAwOyBpIDwgbG9jUGF0Y2hlcy5sZW5ndGg7IGkrKykgewogICAgdmFyIHBhdGNoID0gbG9jUGF0Y2hlc1tpXTsKICAgIHZhciBwYXRjaFRleHQgPQogICAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUnICsKICAgICAgKHBhdGNoLnR5cGUgPT0gMiA/ICIgc21hbGwiIDogIiIpICsKICAgICAgJyI+JyArCiAgICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+JyArCiAgICAgIHBhdGNoLnRpdGxlICsKICAgICAgIjwvZGl2PiI7CiAgICBmb3IgKHZhciBpaSA9IDA7IGlpIDwgcGF0Y2gucG9pbnRzLmxlbmd0aDsgaWkrKykgewogICAgICBwYXRjaFRleHQgKz0gJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyAnICsgcGF0Y2gucG9pbnRzW2lpXSArICI8L2Rpdj4iOwogICAgfQogICAgR2FtZS51cGRhdGVMb2cgKz0gcGF0Y2hUZXh0OwogIH0KCiAgaWYgKCFFTikKICAgIEdhbWUudXBkYXRlTG9nICs9CiAgICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIiBzdHlsZT0iZm9udC13ZWlnaHQ6Ym9sZDtmb250LXN0eWxlOml0YWxpYztvcGFjaXR5OjAuNTsiPicgKwogICAgICBsb2MoIk5vdGU6IG9sZGVyIHVwZGF0ZSBub3RlcyBhcmUgaW4gRW5nbGlzaC4iKSArCiAgICAgICI8L2Rpdj4iOwoKICBHYW1lLnVwZGF0ZUxvZyArPQogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MzEvMDUvMjAyMiAtIGEgbWluZCBvZiBpdHMgb3duPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGEgbmV3IGJ1aWxkaW5nPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGEgbmV3IHRpZXIgb2YgdXBncmFkZXMgYW5kIGFjaGlldmVtZW50czwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBtdWx0aS1sYW5ndWFnZSBzdXBwb3J0IGFkZGVkIHRvIHdlYiB2ZXJzaW9uPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGEgZmV3IG5ldyBoZWF2ZW5seSB1cGdyYWRlczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCB0aGUganVrZWJveDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB0aGUgMyBzZWNyZXQgaGVhdmVubHkgdXBncmFkZXMgbm93IHJlbHkgb24gaG93IG1hbnkgdGltZXMgdGhlIHJlbGV2YW50IGRpZ2l0IGlzIHByZXNlbnQgaW4gdG90YWwsIHJhdGhlciB0aGFuIGF0IHRoZSBlbmQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYmFja2dyb3VuZHMgb3ZlcmhhdWxlZDsgZXh0cmEgb3B0aW9ucyBmb3IgdGhlIGJhY2tncm91bmQgc2VsZWN0b3I8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgZXh0cmEgb3B0aW9ucyBmb3IgdGhlIGdvbGRlbiBjb29raWUgc291bmQgc2VsZWN0b3I8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgdGhlIGJhbmsgbWluaWdhbWUgbm93IHRlbGxzIHlvdSB0aGUgdmFsdWUgeW91IHByZXZpb3VzbHkgYm91Z2h0IGEgc3RvY2sgYXQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgdGhlIGJhbmsgbWluaWdhbWUgZmxvdyBpcyBhIGxpdHRsZSBtb3JlIGV4Y2l0aW5nPC9kaXY+JyArCiAgICAoQXBwCiAgICAgID8gJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBuZXcgb3B0aW9uIHRvIGRpc2FibGUgeW91ciBnYW1lIGFjdGl2aXR5IHNob3dpbmcgdXAgaW4gRGlzY29yZDwvZGl2PicKICAgICAgOiAiIikgKwogICAgKEFwcAogICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbGF1bmNoIGVycm9ycyBub3cgcHJvdmlkZSB0aGUgb3B0aW9uIHRvIHJlc3RhcnQgd2l0aG91dCBtb2RzPC9kaXY+JwogICAgICA6ICIiKSArCiAgICAoQXBwCiAgICAgID8gJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIHNtYWxsIj4nICsKICAgICAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjE4LzEyLzIwMjEgLSB3b3JrIGl0PC9kaXY+JyArCiAgICAgICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBTdGVhbSBXb3Jrc2hvcCBzdXBwb3J0IChsZXRzIHlvdSBpbnN0YWxsIG1vZHMgYW5kIHVwbG9hZCB5b3VyIG93bik8L2Rpdj4nICsKICAgICAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIEtvcmVhbiBsYW5ndWFnZSBzdXBwb3J0PC9kaXY+JyArCiAgICAgICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBiYWNrICJzaG9ydCBudW1iZXJzIiBvcHRpb24gZm9yIG5vbi1lbmdsaXNoIGxhbmd1YWdlcyAodXNlcyBlbmdsaXNoIHRlcm1zIGZvciB0aGUgdGltZSBiZWluZyk8L2Rpdj4nICsKICAgICAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIHRvb2x0aXBzIG9uIGFjaGlldmVtZW50IG5vdGlmaWNhdGlvbnM8L2Rpdj4nICsKICAgICAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIERpc2NvcmQgcmljaCBwcmVzZW5jZSBzdXBwb3J0PC9kaXY+JwogICAgICA6ICIiKSArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4wMS8wOS8yMDIxIC0gZ2l2ZSBtZSBTdGVhbTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBDb29raWUgQ2xpY2tlciBoYXMgYmVlbiA8YSBocmVmPSJodHRwczovL3N0b3JlLnN0ZWFtcG93ZXJlZC5jb20vYXBwLzE0NTQ0MDAvQ29va2llX0NsaWNrZXIvIiB0YXJnZXQ9Il9ibGFuayI+cmVsZWFzZWQgb24gU3RlYW08L2E+IHdpdGggbXVzaWMgYnkgQzQxOCE8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgd2ViIHZlcnNpb24gYW5kIFN0ZWFtIHZlcnNpb24gd2lsbCByZWNlaXZlIHRoZSBzYW1lIHVwZGF0ZXMgZnJvbSBub3cgb248L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgeW91IGNhbiBub3cgcGxheSBpbiAxMyBkaWZmZXJlbnQgbGFuZ3VhZ2VzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IG5ldyBvcHRpb24gdG8gZGlzYWJsZSBzY2FyeSBzdHVmZjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBiYXNpYyBzY3JlZW4tcmVhZGVyIHN1cHBvcnQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgdmFyaW91cyBvdGhlciBpbXByb3ZlbWVudHM8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjAxLzExLzIwMjAgLSBhbHRlcm5hdGUgcmVhbGl0eTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBuZXcgYnVpbGRpbmc8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbmV3IHVwZ3JhZGUgdGllcjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBuZXcgYWNoaWV2ZW1lbnQgdGllcjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBuZXcgaGVhdmVubHkgdXBncmFkZXM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbmV3IG1vZGRpbmcgQVBJPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IG5ldyByZWJhbGFuY2luZyAoYXNjZW5zaW9uIHNsb3QgcHJpY2VzLCBmaW5nZXIgdXBncmFkZXMuLi4pPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IG5ldyBmaXhlcyAobGVhcCB5ZWFycywgZ2hvc3Qgc3dhcHMsIGNhcnJ5b3ZlciBzZWVkcy4uLik8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbmV3IHN0dWZmPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4yMy8wOC8yMDIwIC0gbW9uZXkgbWUsIG1vbmV5IG5vdzwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBmaW5hbGl6ZWQgc3RvY2sgbWFya2V0IG1pbmlnYW1lIGJldGEgYW5kIGFkZGVkIGl0IHRvIGxpdmUgdmVyc2lvbjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBkYXJrIG1vZGUgYWRkZWQgdG8gc3RvY2sgbWFya2V0IG1pbmlnYW1lPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGNhbiBubyBsb25nZXIgc2VsZWN0IGEgbWlsayBiZWZvcmUgdW5sb2NraW5nIGl0OyBtaWxrIHNlbGVjdG9yIGxheW91dCBoYXMgYmVlbiBpbXByb3ZlZDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBzdG9jayBtYXJrZXQgZ29vZHMgaGF2ZSBoaWdoZXIgdmFsdWUgY2FwcyBhbmQgYSBsYXJnZXIgc3ByZWFkOyBjYW4gYWxzbyBzaGlmdC1jbGljayB0aGUgaGlkZSBidXR0b25zIHRvIGhpZGUvc2hvdyBhbGwgb3RoZXIgc3RvY2tzPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4wOC8wOC8yMDIwIC0gY2hlY2tpbmcgYWNjb3VudCAoYmV0YSk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgc3RvY2sgbWFya2V0IGxheW91dCBoYXMgYmVlbiByZXZpc2VkPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHNlbGxpbmcgc3RvY2tzIG5vIGxvbmdlciBpbmNyZWFzZXMgY29va2llcyBiYWtlZCBhbGwgdGltZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBzdG9jayBwcmljZXMgYXJlIG5vdyBkZWZpbmVkIGJ5IHlvdXIgaGlnaGVzdCByYXcgQ3BTIHRoaXMgYXNjZW5zaW9uICh3aGljaCBpcyBub3cgZGlzcGxheWVkIGluIHRoZSBzdGF0cyBzY3JlZW4pPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGNhbiBubyBsb25nZXIgYnV5IGFuZCBzZWxsIGEgc3RvY2sgaW4gdGhlIHNhbWUgdGljazwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB3YXJlaG91c2Ugc3BhY2Ugbm93IGdhaW5zICsxMCBwZXIgYXNzb2NpYXRlZCBidWlsZGluZyBsZXZlbCAodXAgZnJvbSArNSk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYmFuayBsZXZlbCBub3cgaW1wcm92ZXMgYXZlcmFnZSAoYW5kIG1heGltdW0pIHN0b2NrIHZhbHVlczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBsYXRlciBzdG9ja3MgYXJlIHdvcnRoIG1vcmU8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgQ29va2llIENsaWNrZXIgdHVybnMgNyE8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjE4LzA2LzIwMjAgLSBtYWtpbmcgYmFuayAoYmV0YSk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgdGhlIHN0b2NrIG1hcmtldCBtaW5pZ2FtZSwgYWNjZXNzaWJsZSB3aXRoIGxldmVsIDEgYmFua3Mgb3IgYWJvdmU7IGJ1eSBsb3csIHNlbGwgaGlnaCE8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgKG1pbmlnYW1lIHN1YmplY3QgdG8gaGVhdnkgcmViYWxhbmNpbmcgb3ZlciB0aGUgY29taW5nIHBhdGNoZXMpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGEgY291cGxlIGhlYXZlbmx5IHVwZ3JhZGVzLCBpbmNsdWRpbmcgb25lIHRoYXQgbGV0cyB5b3UgcGV0IHlvdXIgZHJhZ29uPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGEgbmV3IHRpZXIgb2YgYnVpbGRpbmcgdXBncmFkZXMgYW5kIGFjaGlldmVtZW50czwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyByZWluZGVlciBjbGlja3Mgbm93IHByb3Blcmx5IGNvdW50IGZvciBzaGltbWVyaW5nIHZlaWw8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbnVtYmVycyBpbiBzY2llbnRpZmljIG5vdGF0aW9uIHNob3VsZCBkaXNwbGF5IGJldHRlciB3aXRoIFNob3J0IG51bWJlcnMgb2ZmPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHJlcGxhY2VkIOODhCBpbiB0aGUgamF2YXNjcmlwdCBjb25zb2xlIGJ1aWxkaW5nIGRpc3BsYXkgd2l0aCBtb3JlIGFjY3VyYXRlIOODgzwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MjgvMDkvMjAxOSAtIGdvaW5nIG9mZi1zY3JpcHQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgYSBuZXcgYnVpbGRpbmc8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgZm9ydHVuZSBjb29raWVzIChhIG5ldyBoZWF2ZW5seSB1cGdyYWRlKTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBtb3JlIHVwZ3JhZGVzLCBhY2hpZXZlbWVudHMgZXRjPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHVwZGF0ZWQgdGhlIFJ1c3NpYW4gYnJlYWQgY29va2llcyBpY29uIHRvIGJldHRlciByZWZsZWN0IHRoZWlyIGN5cmlsbGljIG9yaWdpbnM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgPGkgc3R5bGU9ImZvbnQtc3R5bGU6aXRhbGljOyI+c3RlYWx0aCB1cGRhdGUgOjwvaT4gdGhlIHN1Z2FyIGx1bXAgcmVmaWxsIHRpbWVvdXQgKG5vdCBzdWdhciBsdW1wIGdyb3d0aCkgbm93IG5vIGxvbmdlciB0aWNrcyBkb3duIHdoaWxlIHRoZSBnYW1lIGlzIGNsb3NlZCAodGhpcyBmaXhlcyBhbiBleHBsb2l0KTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhbHNvIHJlbGVhc2VkIHRoZSBvZmZpY2lhbCBBbmRyb2lkIHZlcnNpb24gb2YgQ29va2llIENsaWNrZXIsIHBsYXlhYmxlIDxhIGhyZWY9Imh0dHBzOi8vcGxheS5nb29nbGUuY29tL3N0b3JlL2FwcHMvZGV0YWlscz9pZD1vcmcuZGFzaG5ldC5jb29raWVjbGlja2VyIiB0YXJnZXQ9Il9ibGFuayI+aGVyZTwvYT4gKGlPUyB2ZXJzaW9uIHdpbGwgY29tZSBsYXRlcik8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSBzbWFsbCI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjAxLzA0LzIwMTkgLSAyLjAxOSAodGhlICJ0aGlzIHllYXIiIHVwZGF0ZSk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgZ2FtZSBoYXMgYmVlbiByZW5hbWVkIHRvICJDb29raWUgQ2xpY2tlciIgdG8gYXZvaWQgY29uZnVzaW9uPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGNhbiBub3cgY2xpY2sgdGhlIGJpZyBjb29raWUgdG8gZ2VuZXJhdGUgY29va2llcyBmb3IgZnJlZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyByZW1vdmVkIGZhbGwgZGFtYWdlPC9kaXY+JyArCiAgICAvLyc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgZml4ZWQgdmFyaW91cyB0eXBvcyA6IHBsYXllclwncyBuYW1lIGlzIG5vdyBjb3JyZWN0bHkgc3BlbGxlZCBhcyAiW2Jha2VyeU5hbWVdIjwvZGl2PicrCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHJlbW92ZWQgYWxsIHJlZmVyZW5jZXMgdG8gY29tcHV0ZXItYW5pbWF0ZWQgbW92aWUgPGkgc3R5bGU9ImZvbnQtc3R5bGU6aXRhbGljOyI+SG9vZHdpbmtlZCE8L2k+ICgyMDA1KTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB3ZW50IGJhY2sgaW4gdGltZSBhbmQgaW52ZW50ZWQgY29va2llcyBhbmQgY29tcHV0ZXIgbWljZSwgZW5zdXJpbmcgQ29va2llIENsaWNrZXIgd291bGQgb25lIGRheSBjb21lIHRvIGV4aXN0PC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGdhbWUgbm93IGZ1bGx5IGNvbXBsaWFudCB3aXRoIEdlbmV2YSBDb252ZW50aW9uczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBkcm9wcGVkIHN1cHBvcnQgZm9yIFRJLTg0IHZlcnNpb248L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgcmVsZWFzZWQgYSBsb3ctcmVzIHJldHJvIHZlcnNpb24gb2YgdGhlIGdhbWUsIHBsYXlhYmxlIGhlcmUgOiA8YSBocmVmPSIvL29ydGVpbC5kYXNobmV0Lm9yZy9leHBlcmltZW50cy9jb29raWUvIiB0YXJnZXQ9Il9ibGFuayI+b3J0ZWlsLmRhc2huZXQub3JnL2V4cGVyaW1lbnRzL2Nvb2tpZTwvYT48L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgdXBkYXRlZCB2ZXJzaW9uIG51bWJlcjwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIHNtYWxsIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MDUvMDMvMjAxOSAtIGNvb2tpZXMgZm9yIGRheXM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgb3ZlciAyMCBuZXcgY29va2llcywgYWxsIHByZXZpb3VzbHkgc3VnZ2VzdGVkIGJ5IG91ciBzdXBwb3J0ZXJzIG9uIDxhIGhyZWY9Imh0dHBzOi8vd3d3LnBhdHJlb24uY29tL2Rhc2huZXQiIHRhcmdldD0iX2JsYW5rIj5QYXRyZW9uPC9hPjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCAyIGhlYXZlbmx5IHVwZ3JhZGVzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHRoZSBHb2xkZW4gZ29vc2UgZWdnIG5vdyBjb3VudHMgYXMgYSBnb2xkZW4gY29va2llIHVwZ3JhZGUgZm9yIFJlc2lkdWFsIGx1Y2sgcHVycG9zZXM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgZ29sZGVuIHN1Z2FyIGx1bXBzIG5vdyBlaXRoZXIgZG91YmxlIHlvdXIgY29va2llcywgb3IgZ2l2ZSB5b3UgMjQgaG91cnMgb2YgeW91ciBDcFMsIHdoaWNoZXZlciBpcyBsb3dlc3QgKHByZXZpb3VzbHkgd2FzIGRvdWJsaW5nIGNvb2tpZXMgd2l0aCBubyBjYXApPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHRoZSBhbW91bnQgb2YgaGVyYWxkcyBpcyBub3cgc2F2ZWQgd2l0aCB5b3VyIGdhbWUsIGFuZCBpcyB1c2VkIHRvIGNvbXB1dGUgb2ZmbGluZSBDcFMgdGhlIG5leHQgdGltZSB0aGUgZ2FtZSBpcyBsb2FkZWQ7IHByZXZpb3VzbHksIG9uIHBhZ2UgbG9hZCwgdGhlIG9mZmxpbmUgY2FsY3VsYXRpb24gYXNzdW1lZCBoZXJhbGRzIHRvIGJlIDA8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgYSBzeXN0ZW0gdG8gY291bnRlcmFjdCB0aGUgZ2FtZSBmcmVlemluZyB1cCAoYW5kIG5vdCBiYWtpbmcgY29va2llcykgYWZ0ZXIgYmVpbmcgaW5hY3RpdmUgZm9yIGEgbG9uZyB3aGlsZSBvbiBzbG93ZXIgY29tcHV0ZXJzOyBpbnN0ZWFkLCB0aGlzIHdpbGwgbm93IHRyaWdnZXIgc2xlZXAgbW9kZSwgZHVyaW5nIHdoaWNoIHlvdSBzdGlsbCBwcm9kdWNlIGNvb2tpZXMgYXMgaWYgdGhlIGdhbWUgd2FzIGNsb3NlZDsgdG8gZW5hYmxlIHRoaXMgZmVhdHVyZSwgdXNlIHRoZSAiU2xlZXAgbW9kZSB0aW1lb3V0IiBvcHRpb24gaW4gdGhlIHNldHRpbmdzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHZhdWx0aW5nIHVwZ3JhZGVzIGlzIG5vdyBkb25lIHdpdGggc2hpZnQtY2xpY2ssIGFzIGN0cmwtY2xpY2sgd2FzIHBvc2luZyBpc3N1ZXMgZm9yIE1hYyBicm93c2VyczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBtYWRlIHRvb2x0aXBzIGZvciBidWlsZGluZyBDcFMgYm9vc3RzIGZyb20gc3luZXJnaWVzIGhvcGVmdWxseSBjbGVhcmVyPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGZpeGVkIGFuIGV4cGxvaXQgd2l0aCBnYW1ibGVyXCdzIGZldmVyIGRyZWFtIHdvcmtpbmcgYWNyb3NzIGV4cG9ydHMgYW5kIGFzY2Vuc2lvbnM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgY2FuIG5vdyBoaWRlIHRvb2x0aXBzIGluIHRoZSBnYXJkZW4gYnkga2VlcGluZyB0aGUgc2hpZnQga2V5IHByZXNzZWQgdG8gbWFrZSBpdCBlYXNpZXIgdG8gc2VlIHdoZXJlIHlvdVwncmUgcGxhbnRpbmc8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgZml4ZWQgYSBidWcgd2l0aCBnb2xkZW4gY29va2llcy9yZWluZGVlciBub3QgZGlzYXBwZWFyaW5nIHByb3Blcmx5IGluIHNvbWUgY2lyY3Vtc3RhbmNlczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB0aGUgRHJhZ29uXCdzIEN1cnZlIGF1cmEgc2hvdWxkIG5vdyBwcm9wZXJseSBtYWtlIHN1Z2FyIGx1bXBzIHR3aWNlIGFzIHdlaXJkPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHRoZSBjdHJsIGtleSBzaG91bGQgbGVzcyBvZnRlbiByZWdpc3RlciBpbmNvcnJlY3RseSBhcyBwcmVzc2VkPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGEgbmV3IGFkIHNsb3QgaW4gdGhlIHRvcC1yaWdodCwgYXMgd2hpbGUgb3VyIHBsYXllcmJhc2UgaXMgc3Ryb25nIGFuZCBzdXBwb3J0aXZlIGFzIGV2ZXIsIG91ciBhZCByZXZlbnVlIHNvbWV0aW1lcyBmbHVjdHVhdGVzIGJhZGx5OyB3ZSBtYXkgcmVtb3ZlIHRoZSBhZCBhZ2FpbiBzaG91bGQgb3VyIGluY29tZSBzdGFiaWxpemU8L2Rpdj4nICsKICAgICI8ZGl2IGNsYXNzPVwibGlzdGluZ1wiPiZidWxsOyBtYWRlIGEgZmV3IGFkanVzdG1lbnRzIHRvIG1ha2UgdGhlIGdhbWUgc29tZXdoYXQgcGxheWFibGUgaW4gbW9iaWxlIGJyb3dzZXJzOyBpdCdzIG5vdCBwZXJmZWN0IGFuZCBjYW4gZ2V0IGJ1Z2d5LCBidXQgaXQncyBmdW5jdGlvbmFsISAoeW91IG1heSBuZWVkIHRvIHpvb20gb3V0IG9yIHNjcm9sbCBhcm91bmQgdG8gdmlldyB0aGUgZ2FtZSBwcm9wZXJseSk8L2Rpdj4iICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgc3BlYWtpbmcgb2Ygd2hpY2gsIHdlIGFsc28gZ290IHNvbWUgZ29vZCBwcm9ncmVzcyBvbiB0aGUgbW9iaWxlIGFwcCB2ZXJzaW9uIChidWlsdCBmcm9tIHNjcmF0Y2ggZm9yIG1vYmlsZSksIHNvIHN0YXkgdHVuZWQhPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4yNS8xMC8yMDE4IC0gZmVlZGJhY2sgbG9vcDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBhIG5ldyBidWlsZGluZzwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBsYXVuY2hlZCBvdXIgPGEgaHJlZj0iaHR0cHM6Ly93d3cucGF0cmVvbi5jb20vZGFzaG5ldCIgY2xhc3M9Im9yYW5nZUxpbmsiIHRhcmdldD0iX2JsYW5rIj5QYXRyZW9uPC9hPiA8c3BhbiBzdHlsZT0iZm9udC1zaXplOjgwJTsiPih0aGUgbGluayBpcyBvcmFuZ2Ugc28geW91XCdsbCBub3RpY2UgaXQhKTwvc3Bhbj48L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgYSBidW5jaCBvZiBuZXcgaGVhdmVubHkgdXBncmFkZXMsIG9uZSBvZiB3aGljaCB0aWVzIGludG8gb3VyIFBhdHJlb24gYnV0IGJlbmVmaXRzIGV2ZXJ5b25lICh0aGlzIGlzIHN0aWxsIGV4cGVyaW1lbnRhbCEpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHdoZW4gaG92ZXJpbmcgb3ZlciBncmFuZG1hcywgeW91IGNhbiBub3cgc2VlIHRoZWlyIG5hbWVzIGFuZCBhZ2VzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7ICJtYWtlIFggY29va2llcyBqdXN0IGZyb20gWSIgcmVxdWlyZW1lbnRzIGFyZSBub3cgaGlnaGVyPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHR3ZWFrZWQgdGhlIHByaWNlcyBvZiBzb21lIGhlYXZlbmx5IHVwZ3JhZGVzIHRvIGJldHRlciBmaXQgdGhlIGN1cnJlbnQgY29va2llIGVjb25vbXkgKGl0IHR1cm5zIG91dCBiaWxsaW9ucyBvZiBoZWF2ZW5seSBjaGlwcyBpcyBub3cgdmVyeSBhY2hpZXZhYmxlKTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBidWlsZGluZyB0b29sdGlwcyBub3cgZGlzcGxheSB3aGF0ICUgb2YgQ3BTIHRoZXkgY29udHJpYnV0ZSB0aHJvdWdoIHN5bmVyZ3kgdXBncmFkZXM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgcXVlZW5iZWV0cyBub3cgZ2l2ZSB1cCB0byA0JSBvZiBiYW5rLCBkb3duIGZyb20gNiU8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYW1vbmcgb3RoZXIgdGhpbmdzLCBzZWFzb24gc3dpdGNoZXMgbm93IGRpc3BsYXkgaG93IG1hbnkgc2Vhc29uYWwgdXBncmFkZXMgeW91XCdyZSBtaXNzaW5nLCBhbmQgcGVybWFuZW50IHVwZ3JhZGUgc2xvdHMgbm93IGRpc3BsYXkgdGhlIG5hbWUgb2YgdGhlIHNsb3R0ZWQgdXBncmFkZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBzZWFzb24gc3dpdGNoZXMgaGF2ZSByZXdvcmtlZCBwcmljZXM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgc2Vhc29uIHN3aXRjaGVzIGNhbiBub3cgYmUgY2FuY2VsbGVkIGJ5IGNsaWNraW5nIHRoZW0gYWdhaW48L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgY2FuIG5vIGxvbmdlciBhY2NpZGVudGFsbHkgY2xpY2sgd3JpbmtsZXJzIHRocm91Z2ggb3RoZXIgZWxlbWVudHM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgc3VnYXIgZnJlbnp5IG5vdyB0cmlwbGVzIHlvdXIgQ3BTIGZvciBhbiBob3VyIGluc3RlYWQgb2YgZG91YmxpbmcgaXQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgdGhpcyB0ZXh0IGlzIG5vdyBzZWxlY3RhYmxlPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHByb2dyZXNzIG9uIGR1bmdlb25zIG1pbmlnYW1lIGlzIHN0aWxsIHZlcnkgbXVjaCBvbmdvaW5nPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4wOC8wOC8yMDE4IC0gaGV5IG5vdzwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBDb29raWUgQ2xpY2tlciBzb21laG93IHR1cm5zIDUsIGdvaW5nIGFnYWluc3QgZG9jdG9yc1wnIG1vc3Qgb3B0aW1pc3RpYyBlc3RpbWF0ZXM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgYSBuZXcgdGllciBvZiBidWlsZGluZyBhY2hpZXZlbWVudHMsIGFsbCBuYW1lZCBhZnRlciBTbWFzaCBNb3V0aFwncyBjbGFzc2ljIDE5OTkgaGl0ICJBbGwgU3RhciI8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgYSBuZXcgdGllciBvZiBidWlsZGluZyB1cGdyYWRlcywgYWxsIG5hbWVkIGFmdGVyIG5vdGhpbmcgaW4gcGFydGljdWxhcjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyA8Yj50byBvdXIgcGxheWVycyA6PC9iPiB0aGFuayB5b3Ugc28gbXVjaCBmb3Igc3RpY2tpbmcgd2l0aCB1cyBhbGwgdGhvc2UgeWVhcnMgYW5kIGFsbG93aW5nIHVzIHRvIGtlZXAgbWFraW5nIHRoZSBkdW1iZXN0IGdhbWUga25vd24gdG8gbWFua2luZDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyByZXN1bWVkIHdvcmsgb24gdGhlIGR1bmdlb25zIG1pbmlnYW1lPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4wMS8wOC8yMDE4IC0gYnV5IGJ1eSBidXk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgYSBoZWF2ZW5seSB1cGdyYWRlIHRoYXQgbGV0cyB5b3UgYnV5IGFsbCB5b3VyIHVwZ3JhZGVzIGluc3RhbnRseTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBhIGhlYXZlbmx5IHVwZ3JhZGUgdGhhdCBsZXRzIHlvdSBzZWUgdXBncmFkZSB0aWVycyAoZmVhdHVyZSB3YXMgcHJldmlvdXNseSByZW1vdmVkIGR1ZSB0byBiZWluZyBjb25mdXNpbmcpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGEgbmV3IHdyaW5rbGVyLXJlbGF0ZWQgaGVhdmVubHkgdXBncmFkZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBhIG5ldyB1cGdyYWRlIHRpZXI8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgYSBjb3VwbGUgbmV3IGNvb2tpZXMgYW5kIGFjaGlldmVtZW50czwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBuZXcgImV4dHJhIGJ1dHRvbnMiIHNldHRpbmc7IHR1cm5pbmcgaXQgb24gYWRkcyBidXR0b25zIHRoYXQgbGV0IHlvdSBtaW5pbWl6ZSBidWlsZGluZ3M8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbmV3ICJsdW1wIGNvbmZpcm1hdGlvbiIgc2V0dGluZzsgdHVybmluZyBpdCBvbiB3aWxsIHNob3cgYSBjb25maXJtYXRpb24gcHJvbXB0IHdoZW4geW91IHNwZW5kIHN1Z2FyIGx1bXBzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGJ1aWxkaW5ncyBub3cgc2VsbCBiYWNrIGZvciAyNSUgb2YgdGhlaXIgY3VycmVudCBwcmljZSAoZG93biBmcm9tIDUwJSk7IEVhcnRoIFNoYXR0ZXJlciBtb2RpZmllZCBhY2NvcmRpbmdseSwgbm93IGdpdmVzIGJhY2sgNTAlIChkb3duIGZyb20gODUlKTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBmYXJtIHNvaWxzIG5vdyB1bmxvY2sgY29ycmVjdGx5IGJhc2VkIG9uIGN1cnJlbnQgYW1vdW50IG9mIGZhcm1zPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGNoZWFwY2FwcyBoYXZlIGEgbmV3IGV4Y2l0aW5nIG5lcmY8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgd3JpbmtsZWdpbGwgc3Bhd25zIGEgYnVuY2ggbW9yZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBjYW4gbm93IGN0cmwtc2hpZnQtY2xpY2sgb24gIkhhcnZlc3QgYWxsIiB0byBvbmx5IGhhcnZlc3QgbWF0dXJlLCBub24taW1tb3J0YWwgcGxhbnRzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGEgbmV3IHJhcmUgdHlwZSBvZiBzdWdhciBsdW1wPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4yMC8wNC8yMDE4IC0gd2VlZGluZyBvdXQgc29tZSBidWdzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGdvbGRlbiBjbG92ZXJzIGFuZCB3cmlua2xlZ2lsbHMgc2hvdWxkIHNwYXduIGEgYml0IG1vcmUgb2Z0ZW48L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgY3JvbmVyaWNlIG1hdHVyZXMgYSBsb3Qgc29vbmVyPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IG1hdHVyZSBlbGRlcndvcnRzIHN0YXkgbWF0dXJlIGFmdGVyIHJlbG9hZGluZzwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBnYXJkZW4gaW50ZXJmYWNlIG9jY3VwaWVzIHNwYWNlIG1vcmUgaW50ZWxsaWdlbnRseTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBzZWVkIHByaWNlIGRpc3BsYXlzIHNob3VsZCBiZSBiZXR0ZXIgYmVoYXZlZCB3aXRoIHNob3J0IG51bWJlcnMgZGlzYWJsZWQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbWluaWdhbWUgYW5pbWF0aW9ucyBhcmUgbm93IHR1cm5lZCBvZmYgaWYgdXNpbmcgdGhlICJGYW5jeSBncmFwaGljcyIgb3B0aW9uIGlzIGRpc2FibGVkPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IENwUyBhY2hpZXZlbWVudCByZXF1aXJlbWVudHMgd2VyZSBkaWFsZWQgZG93biBhIHdlZSB0YWQ8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSBzbWFsbCI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjE5LzA0LzIwMTggLSBnYXJkZW4gcGF0Y2g8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgdXBncmFkZXMgZHJvcHBlZCBieSBnYXJkZW4gcGxhbnRzIG5vdyBzdGF5IHVubG9ja2VkIGZvcmV2ZXIgKGJ1dCBkcm9wIG11Y2ggbW9yZSByYXJlbHkpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGdhcmRlbiBzdWdhciBsdW1wIHJlZmlsbCBub3cgYWxzbyBtYWtlcyBwbGFudHMgc3ByZWFkIGFuZCBtdXRhdGUgMyB0aW1lcyBtb3JlIGR1cmluZyB0aGUgYm9udXMgdGljazwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhIGZldyBuZXcgdXBncmFkZXM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYSBjb3VwbGUgYnVnIGZpeGVzIGFuZCByZXBocmFzaW5nczwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MTgvMDQvMjAxOCAtIHlvdXIgZ2FyZGVuLXZhcmlldHkgdXBkYXRlPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIHRoZSBnYXJkZW4sIGEgbWluaWdhbWUgdW5sb2NrZWQgYnkgaGF2aW5nIGF0IGxlYXN0IGxldmVsIDEgZmFybXM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgYSBsaXR0bGUgYXJyb3cgYW5kIGEgYmxpbmt5IGxhYmVsIHRvIHNpZ25hbCB0aGUgZ2FtZSBoYXMgdXBkYXRlZCBzaW5jZSB5b3UgbGFzdCBwbGF5ZWQgaXQgKGhpISk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbmV3IGNvb2tpZXMsIG1pbGsgZmxhdm9ycyBhbmQgYWNoaWV2ZW1lbnRzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHN1Z2FyIGx1bXBzIGFyZSBub3cgdW5sb2NrZWQgd2hlbmV2ZXIgeW91XCd2ZSBiYWtlZCBhdCBsZWFzdCBhIGJpbGxpb24gY29va2llcywgaW5zdGVhZCBvZiBvbiB5b3VyIGZpcnN0IGFzY2Vuc2lvbjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBzdWdhciBsdW1wIHR5cGUgbm93IHNhdmVzIGNvcnJlY3RseTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBtaW5pZ2FtZSBzdWdhciBsdW1wIHJlZmlsbHMgY2FuIG5vdyBvbmx5IGJlIGRvbmUgZXZlcnkgMTUgbWludXRlcyAodGltZXIgc2hhcmVkIGFjcm9zcyBhbGwgbWluaWdhbWVzKTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBDcFMgYWNoaWV2ZW1lbnRzIG5vdyBoYXZlIHN0ZWVwZXIgcmVxdWlyZW1lbnRzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGdvbGRlbiBjb29raWVzIG5vdyBsYXN0IDUlIHNob3J0ZXIgZm9yIGV2ZXJ5IG90aGVyIGdvbGRlbiBjb29raWUgb24gdGhlIHNjcmVlbjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB0aGUgZ2FtZSBub3cgcmVtZW1iZXJzIHdoaWNoIG1pbmlnYW1lcyBhcmUgY2xvc2VkIG9yIG9wZW48L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgYSBwb3B1cCB0aGF0IHNob3dzIHdoZW4gYSBzZWFzb24gc3RhcnRzIChzbyBwZW9wbGUgd29uXCd0IGJlIHNvIGNvbmZ1c2VkIGFib3V0ICJ0aGUgZ2FtZSBsb29raW5nIHdlaXJkIHRvZGF5Iik8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgcGVybWFuZW50IHVwZ3JhZGUgc2xvdHMgbm93IHNob3cgYSB0b29sdGlwIGZvciB0aGUgc2VsZWN0ZWQgdXBncmFkZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBmaW5hbGx5IGZpeGVkIHRoZSBzYXZlIGNvcnJ1cHRpb24gYnVnLCBob3BlZnVsbHk8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSBzbWFsbCI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjI0LzAyLzIwMTggLSBzdWdhciBjb2F0aW5nPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGxpbmsgdG8gPGEgaHJlZj0iaHR0cHM6Ly9kaXNjb3JkYXBwLmNvbS9pbnZpdGUvY29va2llIiB0YXJnZXQ9Il9ibGFuayI+b2ZmaWNpYWwgRGlzY29yZCBzZXJ2ZXI8L2E+PC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGZlbHQgd2VpcmQgYWJvdXQgcHVzaGluZyBhbiB1cGRhdGUgd2l0aG91dCBjb250ZW50IHNvIDo8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgYSBoYW5kZnVsIG9mIG5ldyBjb29raWVzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIDMgbmV3IGhlYXZlbmx5IHVwZ3JhZGVzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHNob3J0IG51bWJlcnMgc2hvdWxkIG5vdyBiZSBkaXNwbGF5ZWQgdXAgdG8gbm92ZW1ub25hZ2ludGlsbGlvbnM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgY29va2llIGNoYWlucyBubyBsb25nZXIgc3Bhd24gZnJvbSB0aGUgRm9yY2UgdGhlIEhhbmQgb2YgRmF0ZSBzcGVsbDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBiaWdnZXIsIGJldHRlciBDb29raWUgQ2xpY2tlciBjb250ZW50IGNvbWluZyBsYXRlciB0aGlzIHllYXI8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjA4LzA4LzIwMTcgLSA0IG1vcmUgeWVhcnM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbmV3IGJ1aWxkaW5nIDogQ2hhbmNlbWFrZXJzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IG5ldyBtaWxrLCBuZXcga2l0dGVucywgbmV3IGRyYWdvbiBhdXJhLCBuZXcgY29va2llLCBuZXcgdXBncmFkZSB0aWVyPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGJ1ZmZzIG5vIGxvbmdlciBhZmZlY3Qgb2ZmbGluZSBDcFM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgR29kemFtb2tcJ3MgaHVuZ2VyIHdhcyBtYWRlIGxlc3MgcG90ZW50ICh0aGlzIGlzIGEgbmVyZiwgdmVyeSBzb3JyeSk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgZ3JpbW9pcmUgc3BlbGwgY29zdHMgYW5kIG1heGltdW0gbWFnaWMgd29yayBkaWZmZXJlbnRseTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBTcG9udGFuZW91cyBFZGlmaWNlIGhhcyBiZWVuIHJld29ya2VkPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGNoYW5nZWQgdW5sb2NrIGxldmVscyBhbmQgcHJpY2VzIGZvciBzb21lIGN1cnNvciB1cGdyYWRlczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBmaXhlZCBidWdneSBwYW50aGVvbiBzbG90cywgaG9wZWZ1bGx5PC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGZpeGVkICJMZWdhY3kgc3RhcnRlZCBhIGxvbmcgd2hpbGUgYWdvIiBzaG93aW5nIGFzICJhIGZldyBzZWNvbmRzIGFnbyI8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgQ29va2llIENsaWNrZXIganVzdCB0dXJuZWQgNC4gVGhhbmsgeW91IGZvciBzdGlja2luZyB3aXRoIHVzIHRoaXMgbG9uZyE8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjE1LzA3LzIwMTcgLSB0aGUgc3Bpcml0dWFsIHVwZGF0ZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBpbXBsZW1lbnRlZCBzdWdhciBsdW1wcywgd2hpY2ggc3RhcnQgY29hbGVzY2luZyBpZiB5b3VcJ3ZlIGFzY2VuZGVkIGF0IGxlYXN0IG9uY2UgYW5kIGNhbiBiZSB1c2VkIGFzIGN1cnJlbmN5IGZvciBzcGVjaWFsIHRoaW5nczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBidWlsZGluZ3MgY2FuIG5vdyBsZXZlbCB1cCBieSB1c2luZyBzdWdhciBsdW1wcyBpbiB0aGUgbWFpbiBidWlsZGluZ3MgZGlzcGxheSwgcGVybWFuZW50bHkgYm9vc3RpbmcgdGhlaXIgQ3BTPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIHR3byBuZXcgZmVhdHVyZXMgdW5sb2NrZWQgYnkgbGV2ZWxsaW5nIHVwIHRoZWlyIGFzc29jaWF0ZWQgYnVpbGRpbmdzLCBUZW1wbGVzIGFuZCBXaXphcmQgdG93ZXJzOyBtb3JlIGJ1aWxkaW5nLXJlbGF0ZWQgbWluaWdhbWVzIHdpbGwgYmUgaW1wbGVtZW50ZWQgaW4gdGhlIGZ1dHVyZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhY3RpdmUgYnVmZnMgYXJlIG5vdyBzYXZlZDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB0aGUgYmFja2dyb3VuZCBzZWxlY3RvciB1cGdyYWRlIGlzIG5vdyBmdW5jdGlvbmFsPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHRoZSB0b3AgbWVudSBubyBsb25nZXIgc2Nyb2xscyB3aXRoIHRoZSByZXN0PC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHRpbWVzcGFucyBhcmUgd3JpdHRlbiBuaWNlcjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBEcmFnb25mbGlnaHRzIG5vdyB0ZW5kIHRvIHN1cGVyY2VkZSBDbGljayBmcmVuemllcywgeW91IHdpbGwgcmFyZWx5IGhhdmUgYm90aCBhdCB0aGUgc2FtZSB0aW1lPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHNvbWUgb2xkIGJ1Z3Mgd2VyZSBwaGFzZWQgb3V0IGFuZCByZXBsYWNlZCBieSBuZXcgb25lczwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIHNtYWxsIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MjQvMDcvMjAxNiAtIGdvbGRlbiBjb29raWVzIG92ZXJoYXVsPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGdvbGRlbiBjb29raWVzIGFuZCByZWluZGVlciBub3cgZm9sbG93IGEgbmV3IHN5c3RlbSBpbnZvbHZpbmcgZXhwbGljaXRseSBkZWZpbmVkIGJ1ZmZzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGEgYnVuY2ggb2YgbmV3IGdvbGRlbiBjb29raWUgZWZmZWN0cyBoYXZlIGJlZW4gYWRkZWQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgQ3BTIGdhaW5zIGZyb20gZWdncyBhcmUgbm93IG11bHRpcGxpY2F0aXZlPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHNoaW55IHdyaW5rbGVycyBhcmUgbm93IHNhdmVkPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHJlaW5kZWVyIGhhdmUgYmVlbiByZWJhbGFuY2VkIGV2ZXIgc28gc2xpZ2h0bHk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgYSBuZXcgY29va2llIHVwZ3JhZGUgbmVhciB0aGUgcm9vdCBvZiB0aGUgaGVhdmVubHkgdXBncmFkZSB0cmVlOyB0aGlzIGlzIGludGVuZGVkIHRvIGJvb3N0IGVhcmx5IGFzY2Vuc2lvbnMgYW5kIHNwZWVkIHVwIHRoZSBnYW1lIGFzIGEgd2hvbGU8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgZHVlIHRvIEVVIGxlZ2lzbGF0aW9uLCBpbXBsZW1lbnRlZCBhIHdhcm5pbmcgbWVzc2FnZSByZWdhcmRpbmcgYnJvd3NlciBjb29raWVzOyBkbyB1bmRlcnN0YW5kIHRoYXQgdGhlIGlyb255IGlzIG5vdCBsb3N0IG9uIHVzPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4wOC8wMi8yMDE2IC0gbGVnYWN5PC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGI+RXZlcnl0aGluZyB0aGF0IHdhcyBpbXBsZW1lbnRlZCBkdXJpbmcgdGhlIGFsbW9zdCAyLXllYXItbG9uZyBiZXRhIGhhcyBiZWVuIGFkZGVkIHRvIHRoZSBsaXZlIGdhbWUuIFRvIHJlY2FwIDo8L2I+PC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IDMgbmV3IGJ1aWxkaW5ncyA6IGJhbmtzLCB0ZW1wbGVzLCBhbmQgd2l6YXJkIHRvd2VyczsgdGhlc2UgaGF2ZSBiZWVuIGFkZGVkIGluLWJldHdlZW4gZXhpc3RpbmcgYnVpbGRpbmdzIGFuZCBhcyBzdWNoLCBtYXkgZGlzcnVwdCBzb21lIGJ1aWxkaW5nLXJlbGF0ZWQgYWNoaWV2ZW1lbnRzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHRoZSBhc2NlbnNpb24gc3lzdGVtIGhhcyBiZWVuIHJlZG9uZSBmcm9tIHNjcmF0Y2gsIHdpdGggYSBuZXcgaGVhdmVubHkgdXBncmFkZSB0cmVlPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IG15c3RlcmlvdXMgbmV3IGZlYXR1cmVzIHN1Y2ggYXMgYW5nZWwtcG93ZXJlZCBvZmZsaW5lIHByb2dyZXNzaW9uLCBjaGFsbGVuZ2UgcnVucywgYW5kIGEgY29va2llIGRyYWdvbjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBzb3VuZHMgaGF2ZSBiZWVuIGFkZGVkIChjYW4gYmUgZGlzYWJsZWQgaW4gdGhlIG9wdGlvbnMpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGhlYXBzIG9mIHJlYmFsYW5jaW5nIGFuZCBidWcgZml4ZXM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYSBjb3VwbGUgbW9yZSB1cGdyYWRlcyBhbmQgYWNoaWV2ZW1lbnRzLCBwcm9iYWJseTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBmcmVzaCBuZXcgb3B0aW9ucyB0byBmdXJ0aGVyIGN1c3RvbWl6ZSB5b3VyIGNvb2tpZS1jbGlja2luZyBleHBlcmllbmNlPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHF1YWxpdHktb2YtbGlmZSBpbXByb3ZlbWVudHMgOiBiZXR0ZXIgYnVsay1idXksIGJldHRlciBzd2l0Y2hlcyBldGM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgc29tZSA8YSBocmVmPSJodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpLycgKwogICAgY2hvb3NlKFsKICAgICAgIktyenlzenRvZl9BcmNpc3pld3NraSIsCiAgICAgICJFdXN0YWNoeV9TYW5ndXN6a28iLAogICAgICAiTWF1cnljeV9IYXVrZSIsCiAgICAgICJLYXJvbF9UdXJubyIsCiAgICAgICJUYWRldXN6X0t1dHJ6ZWJhIiwKICAgICAgIkthemltaWVyel9GYWJyeWN5IiwKICAgICAgIkZsb3JpYW5fU2l3aWNraSIsCiAgICBdKSArCiAgICAnIiB0YXJnZXQ9Il9ibGFuayI+Z2VuZXJhbCBwb2xpc2g8L2E+PC9kaXY+JyAvKiBpIGxpa2VkIHRoaXMgZHVtYiBwdW4gdG9vIG11Y2ggdG8gbGV0IGl0IGdvIHVubm90aWNlZCAqLyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHRvbnMgb2Ygb3RoZXIgbGl0dGxlIHRoaW5ncyB3ZSBjYW5cJ3QgZXZlbiByZW1lbWJlciByaWdodCBub3c8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj5NaXNzIHRoZSBvbGQgdmVyc2lvbj8gWW91ciBvbGQgc2F2ZSB3YXMgYXV0b21hdGljYWxseSBleHBvcnRlZCA8YSBocmVmPSIvL29ydGVpbC5kYXNobmV0Lm9yZy9jb29raWVjbGlja2VyL3YxMDQ2Ni8iIHRhcmdldD0iX2JsYW5rIj5oZXJlPC9hPiE8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSBzbWFsbCI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjA1LzAyLzIwMTYgLSBsZWdhY3kgYmV0YSwgbW9yZSBmaXhlczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBjaGFsbGVuZ2UgbW9kZXMsIHdoaWNoIGNhbiBiZSBzZWxlY3RlZCB3aGVuIGFzY2VuZGluZyAob25seSAxIGZvciBub3cgOiAiQm9ybiBhZ2FpbiIpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGNoYW5nZWQgdGhlIHdheSBidWxrLWJ1eWluZyBhbmQgYnVsay1zZWxsaW5nIHdvcmtzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IG1vcmUgYnVncyBpcm9uZWQgb3V0PC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4wMy8wMi8yMDE2IC0gbGVnYWN5IGJldGEsIHBhcnQgSUlJPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyB3YXJuaW5nIj4mYnVsbDsgTm90IGFsbCBidWdzIGhhdmUgYmVlbiBmaXhlZCwgYnV0IGV2ZXJ5dGhpbmcgc2hvdWxkIGJlIG11Y2ggbGVzcyBicm9rZW4uPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IEFkZGl0aW9ucycgKwogICAgJzxkaXYgc3R5bGU9Im9wYWNpdHk6MC44O21hcmdpbi1sZWZ0OjEycHg7Ij4nICsKICAgICItYSBmZXcgbW9yZSBhY2hpZXZlbWVudHM8YnI+IiArCiAgICAiLW5ldyBvcHRpb24gZm9yIG5lYXQsIGJ1dCBzbG93IENTUyBlZmZlY3RzIChkaXNhYmxlZCBieSBkZWZhdWx0KTxicj4iICsKICAgICItbmV3IG9wdGlvbiBmb3IgYSBsZXNzIGdyYXRpbmcgY29va2llIHNvdW5kIChlbmFibGVkIGJ5IGRlZmF1bHQpPGJyPiIgKwogICAgIi1uZXcgb3B0aW9uIHRvIGJyaW5nIGJhY2sgdGhlIGJveGVzIGFyb3VuZCBpY29ucyBpbiB0aGUgc3RhdHMgc2NyZWVuPGJyPiIgKwogICAgIi1uZXcgYnV0dG9ucyBmb3Igc2F2aW5nIGFuZCBsb2FkaW5nIHlvdXIgZ2FtZSB0byBhIHRleHQgZmlsZTxicj4iICsKICAgICI8L2Rpdj4iICsKICAgICI8L2Rpdj4iICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgQ2hhbmdlcycgKwogICAgJzxkaXYgc3R5bGU9Im9wYWNpdHk6MC44O21hcmdpbi1sZWZ0OjEycHg7Ij4nICsKICAgICItZWFybHkgZ2FtZSBzaG91bGQgYmUgYSBiaXQgZmFzdGVyIGFuZCB2ZXJ5IGxhdGUgZ2FtZSB3YXMga2luZGx5IGFza2VkIHRvIHRvbmUgaXQgZG93biBhIHRhZDxicj4iICsKICAgICItZHJhZ29uZmxpZ2h0IHNob3VsZCBiZSBzb21ld2hhdCBsZXNzIHJpZGljdWxvdXNseSBvdmVycG93ZXJlZDxicj4iICsKICAgICItcGxlYXNlIGxldCBtZSBrbm93IGlmIHRoZSByZWJhbGFuY2luZyB3YXMgdG9vIGhlYXZ5IG9yIG5vdCBoZWF2eSBlbm91Z2g8YnI+IiArCiAgICAiLXNhbnRhIGFuZCBlYXN0ZXIgdXBncmFkZXMgbm93IGRlcGVuZCBvbiBTYW50YSBsZXZlbCBhbmQgYW1vdW50IG9mIGVnZ3Mgb3duZWQsIHJlc3BlY3RpdmVseSwgaW5zdGVhZCBvZiBjb3N0aW5nIHNldmVyYWwgbWludXRlcyB3b3J0aCBvZiBDcFM8YnI+IiArCiAgICAiLWNvb2tpZSB1cGdyYWRlcyBub3cgc3RhY2sgbXVsdGlwbGljYXRpdmVseSByYXRoZXIgdGhhbiBhZGRpdGl2ZWx5PGJyPiIgKwogICAgIi1nb2xkZW4gc3dpdGNoIG5vdyBnaXZlcyArNTAlIENwUywgYW5kIHJlc2lkdWFsIGx1Y2sgaXMgKzEwJSBDcFMgcGVyIGdvbGRlbiBjb29raWUgdXBncmFkZSAodXAgZnJvbSArMjUlIGFuZCArMSUsIHJlc3BlY3RpdmVseSk8YnI+IiArCiAgICAiLWx1Y2t5IGNvb2tpZXMgYW5kIGNvb2tpZSBjaGFpbiBwYXlvdXRzIGhhdmUgYmVlbiBtb2RpZmllZCBhIGJpdCwgcG9zc2libHkgZm9yIHRoZSBiZXR0ZXIsIHdobyBrbm93cyE8YnI+IiArCiAgICAiLXdyaW5rbGVycyBoYWQgcHJldmlvdXNseSBiZWVuIHJlZHVjZWQgdG8gYSBtYXhpbXVtIG9mIDggKDEwIHdpdGggYSBoZWF2ZW5seSB1cGdyYWRlKSwgYnV0IGFyZSBub3cgYmFjayB0byAxMCAoMTIgd2l0aCB0aGUgdXBncmFkZSk8YnI+IiArCiAgICAvKictYWxsIGFuaW1hdGlvbnMgYXJlIG5vdyBoYW5kbGVkIGJ5IHJlcXVlc3RBbmltYXRpb25GcmFtZSgpLCB3aGljaCBzaG91bGQgaG9wZWZ1bGx5IGhlbHAgbWFrZSB0aGUgZ2FtZSBsZXNzIHJlc291cmNlLWludGVuc2l2ZTxicj4nKyovCiAgICAiLWFuIGFzY2Vuc2lvbiBub3cgb25seSBjb3VudHMgZm9yIGFjaGlldmVtZW50IHB1cnBvc2VzIGlmIHlvdSBlYXJuZWQgYXQgbGVhc3QgMSBwcmVzdGlnZSBsZXZlbCBmcm9tIGl0PGJyPiIgKwogICAgIi10aGUgZW1ibGVtYXRpYyBDb29raWUgQ2xpY2tlciBmb250IChLYXZvb24pIHdhcyBidWdnZWQgaW4gRmlyZWZveCwgYW5kIGhhcyBiZWVuIHJlcGxhY2VkIHdpdGggYSBuZXcgZm9udCAoTWVycml3ZWF0aGVyKTxicj4iICsKICAgICItdGhlIG15c3RlcmlvdXMgd3JpbmtseSBjcmVhdHVyZSBpcyBub3cgZXZlbiByYXJlciwgYnV0IGhhcyBhIHNoYWRvdyBhY2hpZXZlbWVudCB0aWVkIHRvIGl0PGJyPiIgKwogICAgIjwvZGl2PiIgKwogICAgIjwvZGl2PiIgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBGaXhlcycgKwogICAgJzxkaXYgc3R5bGU9Im9wYWNpdHk6MC44O21hcmdpbi1sZWZ0OjEycHg7Ij4nICsKICAgICItcHJlc3RpZ2Ugbm93IGdyYW50cyArMSUgQ3BTIHBlciBsZXZlbCBhcyBpbnRlbmRlZCwgaW5zdGVhZCBvZiArMTAwJTxicj4iICsKICAgICItaGVhdmVubHkgY2hpcHMgc2hvdWxkIG5vIGxvbmdlciBhZGQgdXAgbGlrZSBjcmF6eSB3aGVuIHlvdSBhc2NlbmQ8YnI+IiArCiAgICAiLXVwZ3JhZGVzIGluIHRoZSBzdG9yZSBzaG91bGQgbm8gbG9uZ2VyIHJhbmRvbWx5IGdvIHVuc29ydGVkPGJyPiIgKwogICAgIi13aW5kb3cgY2FuIGJlIHJlc2l6ZWQgdG8gYW55IHNpemUgYWdhaW48YnI+IiArCiAgICAnLXRoZSAiU3RhdHMiIGFuZCAiT3B0aW9ucyIgYnV0dG9ucyBoYXZlIGJlZW4gc3dhcHBlZCBhZ2Fpbjxicj4nICsKICAgICItdGhlIGdvbGRlbiBjb29raWUgc291bmQgc2hvdWxkIGJlIHNvbWV3aGF0IGNsZWFyZXI8YnI+IiArCiAgICAiLXRoZSBhc2NlbmQgc2NyZWVuIHNob3VsZCBiZSBsZXNzIENQVS1odW5ncnk8YnI+IiArCiAgICAiPC9kaXY+IiArCiAgICAiPC9kaXY+IiArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4yMC8xMi8yMDE1IC0gbGVnYWN5IGJldGEsIHBhcnQgSUk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIHdhcm5pbmciPiZidWxsOyBleGlzdGluZyBiZXRhIHNhdmVzIGhhdmUgYmVlbiB3aXBlZCBkdWUgdG8gZm9ybWF0IGluY29uc2lzdGVuY2llcyBhbmQganVzdCBwbGFpbiBicm9rZW4gYmFsYW5jZTsgeW91XCdsbCBoYXZlIHRvIHN0YXJ0IG92ZXIgZnJvbSBzY3JhdGNoIC0gd2hpY2ggd2lsbCBhbGxvdyB5b3UgdG8gZnVsbHkgZXhwZXJpZW5jZSB0aGUgdXBkYXRlIGFuZCBmaW5kIGFsbCB0aGUgYXdmdWwgbGl0dGxlIGJ1Z3MgdGhhdCBubyBkb3VidCBwbGFndWUgaXQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIHdhcm5pbmciPiZidWxsOyBpbXBvcnRpbmcgeW91ciBzYXZlIGZyb20gdGhlIGxpdmUgdmVyc2lvbiBpcyBhbHNvIGZpbmU8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgd2UgdG9vayBzbyBsb25nIHRvIG1ha2UgdGhpcyB1cGRhdGUsIENvb2tpZSBDbGlja2VyIHR1cm5lZCAyIHllYXJzIG9sZCBpbiB0aGUgbWVhbnRpbWUhIEh1cnJheSE8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgaGVhcHMgb2YgbmV3IHVwZ3JhZGVzIGFuZCBhY2hpZXZlbWVudHM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgZml4ZWQgYSB3aG9sZSBidW5jaCBvZiBidWdzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGRpZCBhIGxvdCBvZiByZWJhbGFuY2luZzwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyByZXdvcmtlZCBoZWF2ZW5seSBjaGlwcyBhbmQgaGVhdmVubHkgY29va2llcyAoc3RpbGwgZXhwZXJpbWVudGluZywgd2lsbCBwcm9iYWJseSByZWJhbGFuY2UgdGhpbmdzIGZ1cnRoZXIpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHlvdSBtYXkgbm93IHVubG9jayBhIGRyYWdvbiBmcmllbmQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgc3dpdGNoZXMgYW5kIHNlYXNvbiB0cmlnZ2VycyBub3cgaGF2ZSB0aGVpciBvd24gc3RvcmUgc2VjdGlvbjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBjdHJsLXMgYW5kIGN0cmwtbyBub3cgc2F2ZSB0aGUgZ2FtZSBhbmQgb3BlbiB0aGUgaW1wb3J0IG1lbnUsIHJlc3BlY3RpdmVseTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBzb21lIHF1aWNrIHNvdW5kcywganVzdCBhcyBhIHRlc3Q8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYSBjb3VwbGUgbW9yZSBvcHRpb25zPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGV2ZW4gbW9yZSBtaXNjZWxsYW5lb3VzIGNoYW5nZXMgYW5kIGFkZGl0aW9uczwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MjUvMDgvMjAxNCAtIGxlZ2FjeSBiZXRhLCBwYXJ0IEk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgMyBuZXcgYnVpbGRpbmdzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHByaWNlIGFuZCBDcFMgY3VydmVzIHJldmFtcGVkPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IENwUyBjYWxjdWxhdGlvbnMgcmV2YW1wZWQ7IGNvb2tpZSB1cGdyYWRlcyBub3cgc3RhY2sgbXVsdGlwbGljYXRpdmVseTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBwcmVzdGlnZSBzeXN0ZW0gcmVkb25lIGZyb20gc2NyYXRjaCwgd2l0aCBhIHdob2xlIG5ldyB1cGdyYWRlIHRyZWU8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgc29tZSA8YSBocmVmPSJodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpLycgKwogICAgY2hvb3NlKFsKICAgICAgIktyenlzenRvZl9BcmNpc3pld3NraSIsCiAgICAgICJFdXN0YWNoeV9TYW5ndXN6a28iLAogICAgICAiTWF1cnljeV9IYXVrZSIsCiAgICAgICJLYXJvbF9UdXJubyIsCiAgICAgICJUYWRldXN6X0t1dHJ6ZWJhIiwKICAgICAgIkthemltaWVyel9GYWJyeWN5IiwKICAgICAgIkZsb3JpYW5fU2l3aWNraSIsCiAgICBdKSArCiAgICAnIiB0YXJnZXQ9Il9ibGFuayI+Z2VuZXJhbCBwb2xpc2g8L2E+PC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHRvbnMgb2Ygb3RoZXIgbWlzY2VsbGFuZW91cyBmaXhlcyBhbmQgYWRkaXRpb25zPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IENvb2tpZSBDbGlja2VyIGlzIG5vdyAxIHllYXIgb2xkISAoVGhhbmsgeW91IGd1eXMgZm9yIGFsbCB0aGUgc3VwcG9ydCEpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyB3YXJuaW5nIj4mYnVsbDsgTm90ZSA6IHRoaXMgaXMgYSBiZXRhOyB5b3UgYXJlIGxpa2VseSB0byBlbmNvdW50ZXIgYnVncyBhbmQgb3ZlcnNpZ2h0cy4gRmVlbCBmcmVlIHRvIHNlbmQgbWUgZmVlZGJhY2sgaWYgeW91IGZpbmQgc29tZXRoaW5nIGZpc2h5ITwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIHNtYWxsIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MTgvMDUvMjAxNCAtIGJldHRlciBsYXRlIHRoYW4gZWFzdGVyPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGJ1bm5pZXMgYW5kIGVnZ3MsIHNvbWVob3c8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgcHJvbXB0cyBub3cgaGF2ZSBrZXlib2FyZCBzaG9ydGN1dHMgbGlrZSBzeXN0ZW0gcHJvbXB0cyB3b3VsZDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBuYW1pbmcgeW91ciBiYWtlcnk/IHlvdSBiZXRjaGE8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgIkZhc3Qgbm90ZXMiIG9wdGlvbiB0byBtYWtlIGFsbCBub3RpZmljYXRpb25zIGNsb3NlIGZhc3RlcjsgbmV3IGJ1dHRvbiB0byBjbG9zZSBhbGwgbm90aWZpY2F0aW9uczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB0aGUgZHVuZ2VvbnMgYmV0YSBpcyBub3cgYXZhaWxhYmxlIG9uIDxhIGhyZWY9Ii8vb3J0ZWlsLmRhc2huZXQub3JnL2Nvb2tpZWNsaWNrZXIvYmV0YWR1bmdlb25zIiB0YXJnZXQ9Il9ibGFuayI+L2JldGFkdW5nZW9uczwvYT48L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSBzbWFsbCI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjA5LzA0LzIwMTQgLSBuaWdodG1hcmUgaW4gaGVhdmVuPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGJyb2tlIGEgdGhpbmc7IGhlYXZlbmx5IGNoaXBzIHdlcmUgY29ycnVwdGVkIGZvciBzb21lIHBlb3BsZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB3aWxsIHByb2JhYmx5IHVwZGF0ZSB0byAvYmV0YSBmaXJzdCBpbiB0aGUgZnV0dXJlPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHNvcnJ5IGFnYWluPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4wOS8wNC8yMDE0IC0gcXVhbGl0eSBvZiBsaWZlPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IG5ldyB1cGdyYWRlIGFuZCBhY2hpZXZlbWVudCB0aWVyPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHBvcHVwcyBhbmQgcHJvbXB0cyBhcmUgbXVjaCBuaWNlcjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB0b29sdGlwcyBvbiBidWlsZGluZ3MgYXJlIG1vcmUgaW5mb3JtYXRpdmU8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgaW1wbGVtZW50ZWQgYSBzaW1wbGlmaWVkIHZlcnNpb24gb2YgdGhlIDxhIGhyZWY9Imh0dHBzOi8vZ2l0aHViLmNvbS9JY2VoYXdrNzgvRnJvemVuQ29va2llcyIgdGFyZ2V0PSJfYmxhbmsiPkZyb3plbiBDb29raWVzPC9hPiBhZGQtb25cJ3Mgc2hvcnQgbnVtYmVyIGZvcm1hdHRpbmc8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgeW91IGNhbiBub3cgYnV5IDEwIGFuZCBzZWxsIGFsbCBvZiBhIGJ1aWxkaW5nIGF0IGEgdGltZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB0b25zIG9mIG9wdGltaXphdGlvbnMgYW5kIHN1YnRsZXIgY2hhbmdlczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB5b3UgY2FuIG5vdyA8YSBocmVmPSIvL29ydGVpbC5kYXNobmV0Lm9yZy9jb29raWVzMmNhc2gvIiB0YXJnZXQ9Il9ibGFuayI+Y29udmVydCB5b3VyIGNvb2tpZXMgdG8gY2FzaDwvYT4hPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4wNS8wNC8yMDE0IC0gcGl0eSB0aGUgZm9vbDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB3cmlua2xlcnMgc2hvdWxkIG5vdyBiZSBzYXZlZCBzbyB5b3UgZG9uXCd0IGhhdmUgdG8gcG9wIHRoZW0gZXZlcnkgdGltZSB5b3UgcmVmcmVzaCB0aGUgZ2FtZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB5b3Ugbm93IHByb3Blcmx5IHdpbiAxIGNvb2tpZSB1cG9uIHJlYWNoaW5nIDEwIGJpbGxpb24gY29va2llcyBhbmQgbWFraW5nIGl0IG9uIHRoZSBsb2NhbCBuZXdzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IG1pc2NlbGxhbmVvdXMgZml4ZXMgYW5kIHRpbnkgYWRkaXRpb25zPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGEgZmV3IHZlcnkgcnVkaW1lbnRhcnkgbW9kIGhvb2tzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHRoZSBnYW1lIHNob3VsZCB3b3JrIGFnYWluIGluIE9wZXJhPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGRvblwndCBmb3JnZXQgdG8gY2hlY2sgb3V0IDxhIGhyZWY9Ii8vb3J0ZWlsLmRhc2huZXQub3JnL3JhbmRvbWdlbi8iIHRhcmdldD0iX2JsYW5rIj5SYW5kb21HZW48L2E+LCBvdXIgYWxsLXB1cnBvc2UgcmFuZG9tIGdlbmVyYXRvciBtYWtlciE8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSBzbWFsbCI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjAxLzA0LzIwMTQgLSBmb29saW5nIGFyb3VuZDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBpdFwncyBhYm91dCB0aW1lIDogQ29va2llIENsaWNrZXIgaGFzIHR1cm5lZCBpbnRvIHRoZSBtdWNoIG1vcmUgcmVhbGlzdGljIENvb2tpZSBCYWtlcjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBzZWFzb24gdHJpZ2dlcnMgYXJlIGNoZWFwZXIgYW5kIHByb3Blcmx5IHVubG9jayBhZ2FpbiB3aGVuIHRoZXkgcnVuIG91dDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBidWlsZGluZ3Mgc2hvdWxkIHByb3Blcmx5IHVubG9jayAocmVtaW5kZXIgOiBidWlsZGluZyB1bmxvY2tpbmcgaXMgY29tcGxldGVseSBjb3NtZXRpYyBhbmQgZG9lcyBub3QgY2hhbmdlIHRoZSBnYW1lcGxheSk8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSBzbWFsbCI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjE0LzAyLzIwMTQgLSBsb3ZlbHkgcmFpbmJvd2NhbHlwc2U8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbmV3IGJ1aWxkaW5nIChpdFwncyBiZWVuIGEgd2hpbGUpLiBNb3JlIHRvIGNvbWUhPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHlvdSBjYW4gbm93IHRyaWdnZXIgc2Vhc29uYWwgZXZlbnRzIHRvIHlvdXIgaGVhcnRcJ3MgY29udGVudCAodXBncmFkZSB1bmxvY2tzIGF0IDUwMDAgaGVhdmVubHkgY2hpcHMpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IG5ldyB1bHRyYS1leHBlbnNpdmUgYmF0Y2ggb2Ygc2Vhc29uYWwgY29va2llIHVwZ3JhZGVzIHlvdVwnbGwgbG92ZSB0byBoYXRlPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IG5ldyB0aW1lciBiYXJzIGZvciBnb2xkZW4gY29va2llIGJ1ZmZzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGJ1aWxkaW5ncyBhcmUgbm93IGhpZGRlbiB3aGVuIHlvdSBzdGFydCBvdXQgYW5kIGFwcGVhciBhcyB0aGV5IGJlY29tZSBhdmFpbGFibGU8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgdGVjaG5pY2FsIHN0dWZmIDogdGhlIGdhbWUgaXMgbm93IHNhdmVkIHRocm91Z2ggbG9jYWxzdG9yYWdlIGluc3RlYWQgb2YgYnJvd3NlciBjb29raWVzLCB0aGVyZWZvcmUgcnVpbmluZyBhIHBlcmZlY3RseSBnb29kIHB1bjwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIHNtYWxsIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MjIvMTIvMjAxMyAtIG1lcnJ5IGZpeG1hczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBzb21lIGlzc3VlcyB3aXRoIHRoZSBjaHJpc3RtYXMgdXBncmFkZXMgaGF2ZSBiZWVuIGZpeGVkPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHJlaW5kZWVyIGNvb2tpZSBkcm9wcyBhcmUgbm93IG1vcmUgY29tbW9uPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHJlaW5kZWVycyBhcmUgbm93IHJlaW5kZWVyPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4yMC8xMi8yMDEzIC0gQ2hyaXN0bWFzIGlzIGhlcmU8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgdGhlcmUgaXMgbm93IGEgZmVzdGl2ZSBuZXcgZXZvbHZpbmcgdXBncmFkZSBpbiBzdG9yZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyByZWluZGVlciBhcmUgcnVubmluZyBhbW9rIChjYXRjaCB0aGVtIGlmIHlvdSBjYW4hKTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBhIG5ldyBvcHRpb24gdG8gd2FybiB5b3Ugd2hlbiB5b3UgY2xvc2UgdGhlIHdpbmRvdywgc28geW91IGRvblwndCBsb3NlIHlvdXIgdW4tcG9wcGVkIHdyaW5rbGVyczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhbHNvIGFkZGVkIGEgc2VwYXJhdGUgb3B0aW9uIGZvciBkaXNwbGF5aW5nIGN1cnNvcnM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWxsIHRoZSBIYWxsb3dlZW4gZmVhdHVyZXMgYXJlIHN0aWxsIHRoZXJlIChhbmQgaGF2aW5nIHRoZSBTcG9va3kgY29va2llcyBhY2hpZXZlbWVudHMgbWFrZXMgdGhlIEhhbGxvd2VlbiBjb29raWVzIGRyb3AgbXVjaCBtb3JlIG9mdGVuKTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBvaCB5ZWFoLCB3ZSBub3cgaGF2ZSA8YSBocmVmPSJodHRwOi8vd3d3LnJlZGJ1YmJsZS5jb20vcGVvcGxlL2Rhc2huZXQiIHRhcmdldD0iX2JsYW5rIj5Db29raWUgQ2xpY2tlciBzaGlydHMsIHN0aWNrZXJzIGFuZCBob29kaWVzPC9hPiEgKHRoZXlcJ3JlIHJlYWxseSByYWQpPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4yOS8xMC8yMDEzIC0gc3Bvb2t5IHVwZGF0ZTwvZGl2PicgKwogICAgIjxkaXYgY2xhc3M9XCJsaXN0aW5nXCI+JmJ1bGw7IHRoZSBHcmFuZG1hcG9jYWx5cHNlIG5vdyBzcGF3bnMgd3JpbmtsZXJzLCBoaWRlb3VzIGVsZGVybHkgY3JlYXR1cmVzIHRoYXQgZGFtYWdlIHlvdXIgQ3BTIHdoZW4gdGhleSByZWFjaCB5b3VyIGJpZyBjb29raWUuIFRoYW5rZnVsbHksIHlvdSBjYW4gY2xpY2sgb24gdGhlbSB0byBtYWtlIHRoZW0gZXhwbG9kZSAoeW91J2xsIGV2ZW4gZ2FpbiBiYWNrIHRoZSBjb29raWVzIHRoZXkndmUgc3dhbGxvd2VkIC0gd2l0aCBpbnRlcmVzdCEpLjwvZGl2PiIgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB3cmF0aCBjb29raWUgbm93IDI3JSBzcG9va2llcjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBzb21lIG90aGVyIHN0dWZmPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHlvdSBzaG91bGQgdG90YWxseSBnbyBjaGVjayBvdXQgPGEgaHJlZj0iaHR0cDovL2NhbmR5Ym94Mi5uZXQvIiB0YXJnZXQ9Il9ibGFuayI+Q2FuZHkgQm94IDI8L2E+LCB0aGUgc2VxdWVsIHRvIHRoZSBnYW1lIHRoYXQgaW5zcGlyZWQgQ29va2llIENsaWNrZXI8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSBzbWFsbCI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjE1LzEwLzIwMTMgLSBpdFwncyBhIHNlY3JldDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBhIG5ldyBoZWF2ZW5seSB1cGdyYWRlIHRoYXQgZ2l2ZXMgeW91IDUlIG9mIHlvdXIgaGVhdmVubHkgY2hpcHMgcG93ZXIgZm9yIDExIGNvb2tpZXMgKGlmIHlvdSBwdXJjaGFzZWQgdGhlIEhlYXZlbmx5IGtleSwgeW91IG1pZ2h0IG5lZWQgdG8gYnV5IGl0IGFnYWluLCBzb3JyeSk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgZ29sZGVuIGNvb2tpZSBjaGFpbnMgc2hvdWxkIG5vdyB3b3JrIHByb3Blcmx5PC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4xNS8xMC8yMDEzIC0gcGxheWVyLWZyaWVuZGx5PC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGhlYXZlbmx5IHVwZ3JhZGVzIGFyZSBub3cgd2F5LCB3YXkgY2hlYXBlcjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB0aWVyIDUgYnVpbGRpbmcgdXBncmFkZXMgYXJlIDUgdGltZXMgY2hlYXBlcjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBjdXJzb3JzIG5vdyBqdXN0IHBsYWluIGRpc2FwcGVhciB3aXRoIEZhbmN5IEdyYXBoaWNzIG9mZiwgSSBtaWdodCBhZGQgYSBwcm9wZXIgb3B0aW9uIHRvIHRvZ2dsZSBvbmx5IHRoZSBjdXJzb3JzIGxhdGVyPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHdhcm5pbmcgOiB0aGUgQ29va2llIE1vbnN0ZXIgYWRkLW9uIHNlZW1zIHRvIGJlIGJ1Z2d5IHdpdGggdGhpcyB1cGRhdGUsIHlvdSBtaWdodCB3YW50IHRvIHdhaXQgdW50aWwgaXRzIHByb2dyYW1tZXIgdXBkYXRlcyBpdDwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIHNtYWxsIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MTUvMTAvMjAxMyAtIGEgY291cGxlIGZpeGVzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGdvbGRlbiBjb29raWVzIHNob3VsZCBubyBsb25nZXIgc3Bhd24gZW1iYXJyYXNzaW5nbHkgb2Z0ZW48L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgY3Vyc29ycyBub3cgc3RvcCBtb3ZpbmcgaWYgRmFuY3kgR3JhcGhpY3MgaXMgdHVybmVkIG9mZjwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIHNtYWxsIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MTQvMTAvMjAxMyAtIGdvaW5nIGZvciB0aGUgZ29sZDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBnb2xkZW4gY29va2llIGNoYWlucyB3b3JrIGEgYml0IGRpZmZlcmVudGx5PC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGdvbGRlbiBjb29raWUgc3Bhd25zIGFyZSBtb3JlIHJhbmRvbTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBDcFMgYWNoaWV2ZW1lbnRzIGFyZSBubyBsb25nZXIgYWZmZWN0ZWQgYnkgZ29sZGVuIGNvb2tpZSBmcmVuemllczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyByZXZpc2VkIGNvb2tpZS1iYWtpbmcgYWNoaWV2ZW1lbnQgcmVxdWlyZW1lbnRzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGhlYXZlbmx5IGNoaXBzIG5vdyByZXF1aXJlIHVwZ3JhZGVzIHRvIGZ1bmN0aW9uIGF0IGZ1bGwgY2FwYWNpdHk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgNCBtb3JlIGNvb2tpZSB1cGdyYWRlcywgdW5sb2NrZWQgYWZ0ZXIgcmVhY2hpbmcgY2VydGFpbiBhbW91bnRzIG9mIEhlYXZlbmx5IENoaXBzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHNwZWVkIGJha2luZyBhY2hpZXZlbWVudHMgbm93IHJlcXVpcmUgeW91IHRvIGhhdmUgbm8gaGVhdmVubHkgdXBncmFkZXM7IGFzIHN1Y2gsIHRoZXkgaGF2ZSBiZWVuIHJlc2V0IGZvciBldmVyeW9uZSAoYWxvbmcgd2l0aCB0aGUgSGFyZGNvcmUgYWNoaWV2ZW1lbnQpIHRvIGJldHRlciBtYXRjaCB0aGVpciBpbml0aWFsbHkgaW50ZW5kZWQgZGlmZmljdWx0eTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBtYWRlIGdvb2QgcHJvZ3Jlc3Mgb24gdGhlIG1vYmlsZSBwb3J0PC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4wMS8xMC8yMDEzIC0gc21vb3RoaW5nIGl0IG91dDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBzb21lIHZpc3VhbCBlZmZlY3RzIGhhdmUgYmVlbiBjb21wbGV0ZWx5IHJld3JpdHRlbiBhbmQgc2hvdWxkIG5vdyBydW4gbW9yZSBzbW9vdGhseSAoYW5kIGJlIGxlc3MgQ1BVLWludGVuc2l2ZSk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbmV3IHVwZ3JhZGUgdGllcjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBuZXcgbWlsayB0aWVyPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGNvb2tpZSBjaGFpbnMgaGF2ZSBkaWZmZXJlbnQgY2FwcGluZyBtZWNoYW5pY3M8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYW50aW1hdHRlciBjb25kZW5zZXJzIGFyZSBiYWNrIHRvIHRoZWlyIHByZXZpb3VzIHByaWNlPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGhlYXZlbmx5IGNoaXBzIG5vdyBnaXZlICsyJSBDcFMgYWdhaW4gKHRoZXkgd2lsbCBiZSBleHRlbnNpdmVseSByZXdvcmtlZCBpbiB0aGUgZnV0dXJlKTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBmYXJtcyBoYXZlIGJlZW4gYnVmZmVkIGEgYml0ICh0byBwb3B1bGFyIGRlbWFuZCk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgZHVuZ2VvbnMgc3RpbGwgbmVlZCBhIGJpdCBtb3JlIHdvcmsgYW5kIHdpbGwgYmUgcmVsZWFzZWQgc29vbiAtIHdlIHdhbnQgdGhlbSB0byBiZSBqdXN0IHJpZ2h0ISAoeW91IGNhbiB0ZXN0IGFuIHVuZmluaXNoZWQgdmVyc2lvbiBpbiA8YSBocmVmPSIvL29ydGVpbC5kYXNobmV0Lm9yZy9jb29raWVjbGlja2VyL2JldGFkdW5nZW9ucy8iIHRhcmdldD0iX2JsYW5rIj50aGUgYmV0YTwvYT4pPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4yOC8wOS8yMDEzIC0gZHVuZ2VvbiBiZXRhPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGZyb20gbm93IG9uLCBiaWcgdXBkYXRlcyB3aWxsIGNvbWUgdGhyb3VnaCBhIGJldGEgc3RhZ2UgZmlyc3QgKHlvdSBjYW4gPGEgaHJlZj0iLy9vcnRlaWwuZGFzaG5ldC5vcmcvY29va2llY2xpY2tlci9iZXRhZHVuZ2VvbnMvIiB0YXJnZXQ9Il9ibGFuayI+dHJ5IGl0IGhlcmU8L2E+KTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBmaXJzdCBkdW5nZW9ucyEgKHlvdSBuZWVkIDUwIGZhY3RvcmllcyB0byB1bmxvY2sgdGhlbSEpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGNvb2tpZSBjaGFpbnMgY2FuIGJlIGxvbmdlcjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhbnRpbWF0dGVyIGNvbmRlbnNlcnMgYXJlIGEgYml0IG1vcmUgZXhwZW5zaXZlPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGhlYXZlbmx5IGNoaXBzIG5vdyBvbmx5IGdpdmUgKzElIGNwcyBlYWNoICh0byBhY2NvdW50IGZvciBhbGwgdGhlIGNvb2tpZXMgbWFkZSBmcm9tIGNvbmRlbnNlcnMpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGZsYXZvciB0ZXh0IG9uIGFsbCB1cGdyYWRlczwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIHNtYWxsIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MTUvMDkvMjAxMyAtIGFudGljb29raWVzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHJhbiBvdXQgb2YgcmVndWxhciBtYXR0ZXIgdG8gbWFrZSB5b3VyIGNvb2tpZXM/IFRyeSBvdXIgbmV3IGFudGltYXR0ZXIgY29uZGVuc2VycyE8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgcmVuYW1lZCBIYXJkLXJlc2V0IHRvICJXaXBlIHNhdmUiIHRvIGF2b2lkIGNvbmZ1c2lvbjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyByZXNldCBhY2hpZXZlbWVudHMgYXJlIG5vdyByZWd1bGFyIGFjaGlldmVtZW50cyBhbmQgcmVxdWlyZSBjb29raWVzIGJha2VkIGFsbCB0aW1lLCBub3QgY29va2llcyBpbiBiYW5rPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGhlYXZlbmx5IGNoaXBzIGhhdmUgYmVlbiBuZXJmZWQgYSBiaXQgKGFuZCBhcmUgbm93IGF3YXJkZWQgZm9sbG93aW5nIGEgZ2VvbWV0cmljIHByb2dyZXNzaW9uIDogMSB0cmlsbGlvbiBmb3IgdGhlIGZpcnN0LCAyIGZvciB0aGUgc2Vjb25kLCBldGMpOyB0aGUgcHJlc3RpZ2Ugc3lzdGVtIHdpbGwgYmUgZXh0ZW5zaXZlbHkgcmV3b3JrZWQgaW4gYSBmdXR1cmUgdXBkYXRlIChhZnRlciBkdW5nZW9ucyk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgZ29sZGVuIGNvb2tpZSBjbGlja3MgYXJlIG5vIGxvbmdlciByZXNldCBieSBzb2Z0LXJlc2V0czwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB5b3UgY2FuIG5vdyBzZWUgaG93IGxvbmcgeW91XCd2ZSBiZWVuIHBsYXlpbmcgaW4gdGhlIHN0YXRzPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4wOC8wOS8yMDEzIC0gZXZlcmxhc3RpbmcgY29va2llczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBhIHByZXN0aWdlIHN5c3RlbSAtIHJlc2V0dGluZyBnaXZlcyB5b3UgcGVybWFuZW50IENwUyBib29zdHMgKHRoZSBtb3JlIGNvb2tpZXMgbWFkZSBiZWZvcmUgcmVzZXR0aW5nLCB0aGUgYmlnZ2VyIHRoZSBib29zdCEpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHNhdmUgZm9ybWF0IGhhcyBiZWVuIHNsaWdodGx5IG1vZGlmaWVkIHRvIHRha2UgbGVzcyBzcGFjZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBMZXByZWNoYXVuIGhhcyBiZWVuIGJ1bXBlZCB0byA3NzcgZ29sZGVuIGNvb2tpZXMgY2xpY2tlZCBhbmQgaXMgbm93IHNoYWRvdzsgRm9ydHVuZSBpcyB0aGUgbmV3IDc3IGdvbGRlbiBjb29raWVzIGFjaGlldmVtZW50PC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGNsaWNraW5nIGZyZW56eSBpcyBub3cgeDc3NzwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIHNtYWxsIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MDQvMDkvMjAxMyAtIHNtYXJ0ZXIgY29va2llPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGdvbGRlbiBjb29raWVzIG9ubHkgaGF2ZSAyMCUgY2hhbmNlIG9mIGdpdmluZyB0aGUgc2FtZSBvdXRjb21lIHR3aWNlIGluIGEgcm93IG5vdzwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBhIGdvbGRlbiBjb29raWUgdXBncmFkZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBhbiB1cGdyYWRlIHRoYXQgbWFrZXMgcGxlZGdlcyBsYXN0IHR3aWNlIGFzIGxvbmcgKHJlcXVpcmVzIGhhdmluZyBwbGVkZ2VkIDEwIHRpbWVzKTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBRdWludGlsbGlvbiBmaW5nZXJzIGlzIG5vdyB0d2ljZSBhcyBlZmZpY2llbnQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgVW5jYW5ueSBjbGlja2VyIHdhcyByZWFsbHkgdG9vIHVucHJlZGljdGFibGU7IGl0IGlzIG5vdyBhIHJlZ3VsYXIgYWNoaWV2ZW1lbnQgYW5kIG5vIGxvbmdlciByZXF1aXJlcyBhIHdvcmxkIHJlY29yZCwganVzdCAqcHJldHR5IGZhc3QqIGNsaWNraW5nPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4wMi8wOS8yMDEzIC0gYSBiZXR0ZXIgd2F5IG91dDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBFbGRlciBDb3ZlbmFudCBpcyBldmVuIGNoZWFwZXIsIGFuZCByZXZva2luZyBpdCBpcyBjaGVhcGVyIHN0aWxsIChhbHNvIGFkZGVkIGEgbmV3IGFjaGlldmVtZW50IGZvciBnZXR0aW5nIGl0KTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBlYWNoIGdyYW5kbWEgdXBncmFkZSBub3cgcmVxdWlyZXMgMTUgb2YgdGhlIG1hdGNoaW5nIGJ1aWxkaW5nPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IHRoZSBkcmVhZGVkIGJvdHRvbSBjdXJzb3IgaGFzIGJlZW4gZml4ZWQgd2l0aCBhIG5ldyBjdXJzb3IgZGlzcGxheSBzdHlsZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBhbiBvcHRpb24gZm9yIGZhc3RlciwgY2hlYXBlciBncmFwaGljczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBiYXNlNjQgZW5jb2RpbmcgaGFzIGJlZW4gcmVkb25lOyB0aGlzIG1pZ2h0IG1ha2Ugc2F2aW5nIHBvc3NpYmxlIGFnYWluIG9uIHNvbWUgb2xkZXIgYnJvd3NlcnM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgc2hhZG93IGFjaGlldmVtZW50cyBub3cgaGF2ZSB0aGVpciBvd24gc2VjdGlvbjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyByYXNwYmVycnkganVpY2UgaXMgbm93IG5hbWVkIHJhc3BiZXJyeSBtaWxrLCBkZXNwaXRlIHJhc3BiZXJyeSBqdWljZSBiZWluZyBkZWxpY2lvdXMgYW5kIGdvaW5nIHVucXVlc3Rpb25hYmx5IHdlbGwgd2l0aCBjb29raWVzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IEhPVEZJWCA6IGN1cnNvcnMgbm93IGNsaWNrOyBmYW5jeSBncmFwaGljcyBidXR0b24gcmVuYW1lZDsgY29va2llcyBhbW91bnQgbm93IG1vcmUgdmlzaWJsZSBhZ2FpbnN0IGN1cnNvcnM8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSBzbWFsbCI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjAxLzA5LzIwMTMgLSBzb3J0aW5nIHRoaW5ncyBvdXQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgdXBncmFkZXMgYW5kIGFjaGlldmVtZW50cyBhcmUgcHJvcGVybHkgc29ydGVkIGluIHRoZSBzdGF0cyBzY3JlZW48L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbWFkZSBFbGRlciBDb3ZlbmFudCBtdWNoIGNoZWFwZXIgYW5kIGxlc3MgaGFybWZ1bDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBpbXBvcnRpbmcgZnJvbSB0aGUgZmlyc3QgdmVyc2lvbiBoYXMgYmVlbiBkaXNhYmxlZCwgYXMgcHJvbWlzZWQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgIk9uZSBtaW5kIiBub3cgYWN0dWFsbHkgYXNrcyB5b3UgdG8gY29uZmlybSB0aGUgdXBncmFkZTwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIHNtYWxsIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MzEvMDgvMjAxMyAtIGhvdGZpeGVzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGEgd2F5IHRvIHBlcm1hbmVudGx5IHN0b3AgdGhlIGdyYW5kbWFwb2NhbHlwc2U8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgRWxkZXIgUGxlZGdlIHByaWNlIGlzIG5vdyBjYXBwZWQ8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgT25lIE1pbmQgYW5kIG90aGVyIGdyYW5kbWEgcmVzZWFyY2ggdXBncmFkZXMgYXJlIG5vdyBhIGxpdHRsZSBtb3JlIHBvd2VyZnVsLCBpZiBub3QgMTAwJSBhY2N1cmF0ZTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyAiZ29sZGVuIiBjb29raWUgbm93IGFwcGVhcnMgYWdhaW4gZHVyaW5nIGdyYW5kbWFwb2NhbHlwc2U7IEVsZGVyIFBsZWRnZS1yZWxhdGVkIGFjaGlldmVtZW50cyBhcmUgbm93IHVubG9ja2FibGU8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjMxLzA4LzIwMTMgLSB0b28gbWFueSBncmFuZG1hczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyB0aGUgZ3JhbmRtYXBvY2FseXBzZSBpcyBiYWNrLCBhbG9uZyB3aXRoIG1vcmUgZ3JhbmRtYSB0eXBlczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBzb21lIHVwZ3JhZGVzIHRoYXQgYm9vc3QgeW91ciBjbGlja2luZyBwb3dlciBhbmQgbWFrZSBpdCBzY2FsZSB3aXRoIHlvdXIgY3BzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGNsaWNraW5nIGFjaGlldmVtZW50cyBtYWRlIGhhcmRlcjsgTmV2ZXJjbGljayBpcyBub3cgYSBzaGFkb3cgYWNoaWV2ZW1lbnQ7IFVuY2FubnkgY2xpY2tlciBzaG91bGQgbm93IHRydWx5IGJlIGEgd29ybGQgcmVjb3JkPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4yOC8wOC8yMDEzIC0gb3Zlci1hY2hpZXZlcjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBhIGZldyBtb3JlIGFjaGlldmVtZW50czwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyByZXdvcmtlZCB0aGUgIkJha2UgWCBjb29raWVzIiBhY2hpZXZlbWVudHMgc28gdGhleSB0YWtlIGxvbmdlciB0byBhY2hpZXZlPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4yNy8wOC8yMDEzIC0gYSBiYWQgaWRlYTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBkdWUgdG8gcG9wdWxhciBkZW1hbmQsIHJldGlyZWQgNSBhY2hpZXZlbWVudHMgKHRoZSAicmVzZXQgeW91ciBnYW1lIiBhbmQgImNoZWF0IiBvbmVzKTsgdGhleSBjYW4gc3RpbGwgYmUgdW5sb2NrZWQsIGJ1dCBkbyBub3QgY291bnQgdG93YXJkIHlvdXIgdG90YWwgYW55bW9yZS4gRG9uXCd0IHdvcnJ5LCB0aGVyZSB3aWxsIGJlIG1hbnkgbW9yZSBhY2hpZXZlbWVudHMgc29vbiE8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbWFkZSBzb21lIGFjaGlldmVtZW50cyBoaWRkZW4gZm9yIGFkZGVkIG15c3Rlcnk8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjI3LzA4LzIwMTMgLSBhIHNlbnNlIG9mIGFjaGlldmVtZW50PC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGFjaGlldmVtZW50cyAoYW5kIG1pbGspPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGk+KHRoaXMgaXMgYSBiaWcgdXBkYXRlLCBwbGVhc2UgZG9uXCd0IGdldCB0b28gbWFkIGlmIHlvdSBsb3NlIHNvbWUgZGF0YSEpPC9pPjwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIHNtYWxsIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MjYvMDgvMjAxMyAtIG5ldyB1cGdyYWRlIHRpZXI8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgc29tZSBtb3JlIHVwZ3JhZGVzIChpbmNsdWRpbmcgYSBjb3VwbGUgZ29sZGVuIGNvb2tpZS1yZWxhdGVkIG9uZXMpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIGNsaWNraW5nIHN0YXRzPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUgc21hbGwiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4yNi8wOC8yMDEzIC0gbW9yZSB0d2Vha3M8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgdHdlYWtlZCBhIGNvdXBsZSBjdXJzb3IgdXBncmFkZXM8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbWFkZSB0aW1lIG1hY2hpbmVzIGxlc3MgcG93ZXJmdWw8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgYWRkZWQgb2ZmbGluZSBtb2RlIG9wdGlvbjwvZGl2PicgKwogICAgJzwvZGl2PjxkaXYgY2xhc3M9InN1YnNlY3Rpb24gdXBkYXRlIHNtYWxsIj4nICsKICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+MjUvMDgvMjAxMyAtIHR3ZWFrczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyByZWJhbGFuY2VkIHByb2dyZXNzaW9uIGN1cnZlIChtaWQtIGFuZCBlbmQtZ2FtZSBvYmplY3RzIGNvc3QgbW9yZSBhbmQgZ2l2ZSBtb3JlKTwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBzb21lIG1vcmUgY29va2llIHVwZ3JhZGVzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIENwUyBmb3IgY3Vyc29yczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBzZWxsIGJ1dHRvbjwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBtYWRlIGdvbGRlbiBjb29raWUgbW9yZSB1c2VmdWw8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSBzbWFsbCI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjI0LzA4LzIwMTMgLSBob3RmaXhlczwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhZGRlZCBpbXBvcnQvZXhwb3J0IGZlYXR1cmUsIHdoaWNoIGFsc28gYWxsb3dzIHlvdSB0byByZXRyaWV2ZSBhIHNhdmUgZ2FtZSBmcm9tIHRoZSBvbGQgdmVyc2lvbiAod2lsbCBiZSBkaXNhYmxlZCBpbiBhIHdlZWsgdG8gcHJldmVudCB0b28gbXVjaCBjaGVhdGluZyk8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgdXBncmFkZSBzdG9yZSBub3cgaGFzIHVubGltaXRlZCBzbG90cyAoanVzdCBob3ZlciBvdmVyIGl0KSwgZHVlIHRvIHBvcHVsYXIgZGVtYW5kPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIHVwZGF0ZSBsb2c8L2Rpdj4nICsKICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIHVwZGF0ZSI+JyArCiAgICAnPGRpdiBjbGFzcz0idGl0bGUiPjI0LzA4LzIwMTMgLSBiaWcgdXBkYXRlITwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyByZXZhbXBlZCB0aGUgd2hvbGUgZ2FtZSAobmV3IGdyYXBoaWNzLCBuZXcgZ2FtZSBtZWNoYW5pY3MpPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGFkZGVkIHVwZ3JhZGVzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IG11Y2ggc2FmZXIgc2F2aW5nPC9kaXY+JyArCiAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiB1cGRhdGUiPicgKwogICAgJzxkaXYgY2xhc3M9InRpdGxlIj4wOC8wOC8yMDEzIC0gZ2FtZSBsYXVuY2g8L2Rpdj4nICsKICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj4mYnVsbDsgbWFkZSA8YSBocmVmPSJodHRwczovL29ydGVpbC5kYXNobmV0Lm9yZy9leHBlcmltZW50cy9jb29raWUvIiB0YXJnZXQ9Il9ibGFuayI+dGhlIGdhbWU8L2E+IGluIGEgY291cGxlIGhvdXJzLCBmb3IgbGF1Z2hzPC9kaXY+JyArCiAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JmJ1bGw7IGtpbmRhIHN0YXJ0aW5nIHRvIHJlZ3JldCBpdDwvZGl2PicgKwogICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPiZidWxsOyBhaCB3ZWxsPC9kaXY+JyArCiAgICAiPC9kaXY+IiArCiAgICAiPC9kaXY+IjsKCiAgR2FtZS5yZWFkeSA9IDA7CgogIEdhbWUuTG9hZCA9IGZ1bmN0aW9uIChjYWxsYmFjaykgewogICAgLy9sKCdvZmZHYW1lTWVzc2FnZScpLmlubmVySFRNTD0nPGRpdiBzdHlsZT0icGFkZGluZzo2NHB4IDEyOHB4OyI+PGRpdiBjbGFzcz0idGl0bGUiPkxvYWRpbmcuLi48L2Rpdj48L2Rpdj4nOwogICAgR2FtZS5Mb2FkZXIgPSBuZXcgTG9hZGVyKCk7CiAgICBHYW1lLkxvYWRlci5kb21haW4gPSAiaW1nLyI7CiAgICBpZiAodHlwZW9mIFBSRUxPQUQgIT09ICJ1bmRlZmluZWQiKSBHYW1lLkxvYWRlci5sb2FkZWQgPSBQUkVMT0FEKEdhbWUuSW5pdCk7CiAgICBlbHNlIEdhbWUuTG9hZGVyLmxvYWRlZCA9IGNhbGxiYWNrOwogICAgR2FtZS5Mb2FkZXIuTG9hZChbImZpbGxlci5wbmciXSk7CiAgfTsKICBHYW1lLkVycm9yRnJhbWUgPSBmdW5jdGlvbiAoKSB7CiAgICBsKCJvZmZHYW1lTWVzc2FnZSIpLmlubmVySFRNTCA9CiAgICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+T29wcy4gV3JvbmcgYWRkcmVzcyE8L2Rpdj4nICsKICAgICAgIjxkaXY+SXQgbG9va3MgbGlrZSB5b3UncmUgYWNjZXNzaW5nIENvb2tpZSBDbGlja2VyIGZyb20gYW5vdGhlciBVUkwgdGhhbiB0aGUgb2ZmaWNpYWwgb25lLjxicj4iICsKICAgICAgJ1lvdSBjYW4gPGEgaHJlZj0iLy9vcnRlaWwuZGFzaG5ldC5vcmcvY29va2llY2xpY2tlci8iIHRhcmdldD0iX2JsYW5rIj5wbGF5IENvb2tpZSBDbGlja2VyIG92ZXIgaGVyZTwvYT4hPGJyPicgKwogICAgICAiPHNtYWxsPihJZiBmb3IgYW55IHJlYXNvbiwgeW91IGFyZSB1bmFibGUgdG8gYWNjZXNzIHRoZSBnYW1lIG9uIHRoZSBvZmZpY2lhbCBVUkwsIHdlIGFyZSBjdXJyZW50bHkgd29ya2luZyBvbiBhIHNlY29uZCBkb21haW4uKTwvc21hbGw+PC9kaXY+IjsKICB9OwogIEdhbWUudGltZWRvdXQgPSBmYWxzZTsKICBHYW1lLlRpbWVvdXQgPSBmdW5jdGlvbiAoKSB7CiAgICBHYW1lLldyaXRlU2F2ZSgpOwogICAgR2FtZS5raWxsU2hpbW1lcnMoKTsKICAgIGwoIm9mZkdhbWVNZXNzYWdlIikuaW5uZXJIVE1MID0KICAgICAgJzxkaXYgY2xhc3M9InRpdGxlIj4nICsKICAgICAgKEdhbWUuSGFzKCJUd2luIEdhdGVzIG9mIFRyYW5zY2VuZGVuY2UiKQogICAgICAgID8gbG9jKCJDb29raWUgQ2xpY2tlciBpcyBpbiBzbGVlcCBtb2RlIGFuZCBnZW5lcmF0aW5nIG9mZmxpbmUgY29va2llcy4iKQogICAgICAgIDogbG9jKCJDb29raWUgQ2xpY2tlciBpcyBpbiBzbGVlcCBtb2RlLiIpKSArCiAgICAgICI8L2Rpdj4iICsKICAgICAgbG9jKAogICAgICAgICIlMSB0byByZXN1bWUgZnJvbSB5b3VyIHNhdmUgZmlsZS4iLAogICAgICAgICI8YSAiICsKICAgICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICAgJz0iR2FtZS5SZXN1bWUoKTsiPicgKwogICAgICAgICAgbG9jKCJDbGljayBoZXJlIikgKwogICAgICAgICAgIjwvYT4iCiAgICAgICkgKwogICAgICAnPGJyPjxkaXYgc3R5bGU9ImZvbnQtc3R5bGU6aXRhbGljO2ZvbnQtc2l6ZTo2NSU7bGluZS1oZWlnaHQ6MTEwJTtvcGFjaXR5OjAuNzU7Ij4nICsKICAgICAgbG9jKAogICAgICAgICIodGhpcyBoYXBwZW5zIHdoZW4gdG9vIG1hbnkgZnJhbWVzIGFyZSBza2lwcGVkIGF0IG9uY2UsPGJyPnVzdWFsbHkgd2hlbiB0aGUgZ2FtZSBoYXMgYmVlbiBydW5uaW5nIGluIHRoZSBiYWNrZ3JvdW5kIGZvciBhIHdoaWxlKTxicj4oeW91IGNhbiB0dXJuIHRoaXMgZmVhdHVyZSBvZmYgaW4gdGhlIHNldHRpbmdzIG1lbnUpIgogICAgICApICsKICAgICAgIjwvZGl2PiI7CiAgICBsKCJvZmZHYW1lTWVzc2FnZVdyYXAiKS5zdHlsZS5kaXNwbGF5ID0gInRhYmxlIjsKICAgIEdhbWUudGltZWRvdXQgPSB0cnVlOwogICAgY29uc29sZS5sb2coCiAgICAgICJbPT09IEdhbWUgdGltZWQgb3V0IGFuZCBoYXMgYmVlbiBwdXQgaW4gc2xlZXAgbW9kZS4gRGF0YSB3YXMgc2F2ZWQuID09PV0iCiAgICApOwogIH07CiAgR2FtZS5SZXN1bWUgPSBmdW5jdGlvbiAoKSB7CiAgICBsKCJvZmZHYW1lTWVzc2FnZSIpLmlubmVySFRNTCA9ICIiOwogICAgbCgib2ZmR2FtZU1lc3NhZ2VXcmFwIikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgIEdhbWUudGltZWRvdXQgPSBmYWxzZTsKICAgIEdhbWUudGltZSA9IERhdGUubm93KCk7CiAgICBHYW1lLmFjY3VtdWxhdGVkRGVsYXkgPSAwOwogICAgR2FtZS5kZWxheVRpbWVvdXRzID0gMDsKICAgIEdhbWUubGFzdEFjdGl2aXR5ID0gRGF0ZS5ub3coKTsKICAgIEdhbWUuTG9vcCgpOwogICAgR2FtZS5Mb2FkU2F2ZSgpOwogICAgY29uc29sZS5sb2coIls9PT0gR2FtZSByZXN1bWVkISBEYXRhIHdhcyBsb2FkZWQuID09PV0iKTsKICB9OwoKICBHYW1lLkluaXQgPSBmdW5jdGlvbiAoKSB7CiAgICBHYW1lLnJlYWR5ID0gMTsKCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCQlWQVJJQUJMRVMgQU5EIFBSRVNFVFMKCQk9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgR2FtZS5UID0gMDsKICAgIEdhbWUuZHJhd1QgPSAwOwogICAgR2FtZS5sb29wVCA9IDA7CiAgICBHYW1lLmZwcyA9IDMwOwoKICAgIEdhbWUuc2Vhc29uID0gR2FtZS5iYXNlU2Vhc29uOwoKICAgIEdhbWUubCA9IGwoImdhbWUiKTsKICAgIEdhbWUud3JhcHBlciA9IGwoIndyYXBwZXIiKTsKICAgIEdhbWUuYm91bmRzID0gMDsgLy9yZWN0YW5nbGUgZGVmaW5pbmcgc2NyZWVuIGxpbWl0cyAocmlnaHQsbGVmdCxib3R0b20sdG9wKSB1cGRhdGVkIGV2ZXJ5IGxvZ2ljIGZyYW1lCgogICAgVG9wQmFyT2Zmc2V0ID0gMzI7CiAgICBpZiAoIUFwcCkgR2FtZS53cmFwcGVyLmNsYXNzTGlzdC5hZGQoIm9uV2ViIik7CiAgICBlbHNlIHsKICAgICAgR2FtZS53cmFwcGVyLmNsYXNzTGlzdC5hZGQoIm9mZldlYiIpOwogICAgICBUb3BCYXJPZmZzZXQgPSAwOwogICAgfQoKICAgIGlmIChHYW1lLm1vYmlsZSA9PSAxKSB7CiAgICAgIEdhbWUud3JhcHBlci5jbGFzc05hbWUgPSAibW9iaWxlIjsKICAgIH0KICAgIEdhbWUuY2xpY2tTdHIgPSBHYW1lLnRvdWNoRXZlbnRzID8gIm9udG91Y2hlbmQiIDogIm9uY2xpY2siOwoKICAgIGwoInZlcnNpb25OdW1iZXIiKS5pbm5lckhUTUwgPQogICAgICAidi4gIiArCiAgICAgIEdhbWUudmVyc2lvbiArCiAgICAgICghQXBwCiAgICAgICAgPyAnPGRpdiBpZD0iaHR0cHNTd2l0Y2giIHN0eWxlPSJjdXJzb3I6cG9pbnRlcjtkaXNwbGF5OmlubGluZS1ibG9jaztiYWNrZ3JvdW5kOnVybChpbWcvJyArCiAgICAgICAgICAoR2FtZS5odHRwcyA/ICJsb2NrT24iIDogImxvY2tPZmYiKSArCiAgICAgICAgICAnLnBuZyk7d2lkdGg6MTZweDtoZWlnaHQ6MTZweDtwb3NpdGlvbjpyZWxhdGl2ZTt0b3A6NHB4O2xlZnQ6MHB4O21hcmdpbjowcHggLTJweDsiPjwvZGl2PicKICAgICAgICA6ICIiKSArCiAgICAgIChHYW1lLmJldGEgPyAnIDxzcGFuIHN0eWxlPSJjb2xvcjojZmYwOyI+YmV0YTwvc3Bhbj4nIDogIiIpOwoKICAgIGlmICghQXBwKSB7CiAgICAgIGlmIChHYW1lLmJldGEpIHsKICAgICAgICB2YXIgbWUgPSBsKCJsaW5rVmVyc2lvbkJldGEiKTsKICAgICAgICBtZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG1lKTsKICAgICAgfSBlbHNlIGlmIChHYW1lLnZlcnNpb24gPT0gMS4wNDY2KSB7CiAgICAgICAgdmFyIG1lID0gbCgibGlua1ZlcnNpb25PbGQiKTsKICAgICAgICBtZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG1lKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgbWUgPSBsKCJsaW5rVmVyc2lvbkxpdmUiKTsKICAgICAgICBtZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG1lKTsKICAgICAgfQogICAgfQoKICAgIEdhbWUubGFzdEFjdGl2aXR5ID0gRGF0ZS5ub3coKTsgLy9yZXNldCBvbiBtb3VzZSBtb3ZlLCBrZXkgcHJlc3Mgb3IgY2xpY2sKCiAgICAvL2xhdGVuY3kgY29tcGVuc2F0b3Igc3R1ZmYKICAgIEdhbWUudGltZSA9IERhdGUubm93KCk7CiAgICBHYW1lLmFjY3VtdWxhdGVkRGVsYXkgPSAwOwogICAgR2FtZS5kZWxheVRpbWVvdXRzID0gMDsgLy9ob3cgbWFueSB0aW1lcyB3ZSd2ZSBnb25lIG92ZXIgdGhlIHRpbWVvdXQgZGVsYXkKICAgIEdhbWUuY2F0Y2h1cExvZ2ljID0gMDsKICAgIEdhbWUuZnBzU3RhcnRUaW1lID0gMDsKICAgIEdhbWUuZnJhbWVOdW1iZXIgPSAwOwogICAgR2FtZS5jdXJyZW50RnBzID0gR2FtZS5mcHM7CiAgICBHYW1lLnByZXZpb3VzRnBzID0gR2FtZS5jdXJyZW50RnBzOwogICAgR2FtZS5nZXRGcHMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIEdhbWUuZnJhbWVOdW1iZXIrKzsKICAgICAgdmFyIGN1cnJlbnRUaW1lID0gKERhdGUubm93KCkgLSBHYW1lLmZwc1N0YXJ0VGltZSkgLyAxMDAwOwogICAgICB2YXIgcmVzdWx0ID0gTWF0aC5mbG9vcihHYW1lLmZyYW1lTnVtYmVyIC8gY3VycmVudFRpbWUpOwogICAgICBpZiAoY3VycmVudFRpbWUgPiAxKSB7CiAgICAgICAgR2FtZS5mcHNTdGFydFRpbWUgPSBEYXRlLm5vdygpOwogICAgICAgIEdhbWUuZnJhbWVOdW1iZXIgPSAwOwogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9OwoKICAgIEdhbWUuY29va2llc0Vhcm5lZCA9IDA7IC8vYWxsIGNvb2tpZXMgZWFybmVkIGR1cmluZyBnYW1lcGxheQogICAgR2FtZS5jb29raWVzID0gMDsgLy9jb29raWVzCiAgICBHYW1lLmNvb2tpZXNkID0gMDsgLy9jb29raWVzIGRpc3BsYXkKICAgIEdhbWUuY29va2llc1BzID0gMTsgLy9jb29raWVzIHBlciBzZWNvbmQgKHRvIHJlY2FsY3VsYXRlIHdpdGggZXZlcnkgbmV3IHB1cmNoYXNlKQogICAgR2FtZS5jb29raWVzUHNSYXcgPSAwOyAvL3JhdyBjb29raWVzIHBlciBzZWNvbmQKICAgIEdhbWUuY29va2llc1BzUmF3SGlnaGVzdCA9IDA7IC8vaGlnaGVzdCByYXcgY29va2llcyBwZXIgc2Vjb25kIHRoaXMgYXNjZW5zaW9uCiAgICBHYW1lLmNvb2tpZXNSZXNldCA9IDA7IC8vY29va2llcyBsb3N0IHRvIHJlc2V0dGluZyAodXNlZCB0byBkZXRlcm1pbmUgcHJlc3RpZ2UgYW5kIGhlYXZlbmx5IGNoaXBzKQogICAgR2FtZS5jb29raWVDbGlja3MgPSAwOyAvLysxIGZvciBlYWNoIGNsaWNrIG9uIHRoZSBjb29raWUKICAgIEdhbWUuZ29sZGVuQ2xpY2tzID0gMDsgLy8rMSBmb3IgZWFjaCBnb2xkZW4gY29va2llIGNsaWNrZWQgKGFsbCB0aW1lKQogICAgR2FtZS5nb2xkZW5DbGlja3NMb2NhbCA9IDA7IC8vKzEgZm9yIGVhY2ggZ29sZGVuIGNvb2tpZSBjbGlja2VkICh0aGlzIGdhbWUgb25seSkKICAgIEdhbWUubWlzc2VkR29sZGVuQ2xpY2tzID0gMDsgLy8rMSBmb3IgZWFjaCBnb2xkZW4gY29va2llIG1pc3NlZAogICAgR2FtZS5oYW5kbWFkZUNvb2tpZXMgPSAwOyAvL2FsbCB0aGUgY29va2llcyBtYWRlIGZyb20gY2xpY2tpbmcgdGhlIGNvb2tpZQogICAgR2FtZS5taWxrUHJvZ3Jlc3MgPSAwOyAvL3lvdSBnYWluIGEgbGl0dGxlIGJpdCBmb3IgZWFjaCBhY2hpZXZlbWVudC4gRWFjaCBpbmNyZW1lbnQgb2YgMSBpcyBhIGRpZmZlcmVudCBtaWxrIGRpc3BsYXllZC4KICAgIEdhbWUubWlsa0ggPSBHYW1lLm1pbGtQcm9ncmVzcyAvIDI7IC8vbWlsayBoZWlnaHQsIGJldHdlZW4gMCBhbmQgMSAoYWx0aG91Z2ggc2hvdWxkIG5ldmVyIGdvIGFib3ZlIDAuNSkKICAgIEdhbWUubWlsa0hkID0gMDsgLy9taWxrIGhlaWdodCBkaXNwbGF5CiAgICBHYW1lLm1pbGtUeXBlID0gMDsgLy9jdXN0b20gbWlsawogICAgR2FtZS5iZ1R5cGUgPSAwOyAvL2N1c3RvbSBiYWNrZ3JvdW5kCiAgICBHYW1lLmNoaW1lVHlwZSA9IDA7IC8vZ29sZGVuIGNvb2tpZSBjaGltZQogICAgR2FtZS5wcmVzdGlnZSA9IDA7IC8vcHJlc3RpZ2UgbGV2ZWwgKHJlY2FsY3VsYXRlZCBkZXBlbmRpbmcgb24gR2FtZS5jb29raWVzUmVzZXQpCiAgICBHYW1lLmhlYXZlbmx5Q2hpcHMgPSAwOyAvL2hlYXZlbmx5IGNoaXBzIHRoZSBwbGF5ZXIgY3VycmVudGx5IGhhcwogICAgR2FtZS5oZWF2ZW5seUNoaXBzRGlzcGxheWVkID0gMDsgLy90aWNrcyB1cCBvciBkb3duIHRvIG1hdGNoIEdhbWUuaGVhdmVubHlDaGlwcwogICAgR2FtZS5oZWF2ZW5seUNoaXBzU3BlbnQgPSAwOyAvL2hlYXZlbmx5IGNoaXBzIHNwZW50IG9uIGNvb2tpZXMsIHVwZ3JhZGVzIGFuZCBzdWNoCiAgICBHYW1lLmhlYXZlbmx5Q29va2llcyA9IDA7IC8vaG93IG1hbnkgY29va2llcyBoYXZlIHdlIGJha2VkIGZyb20gY2hpcHMgKHVudXNlZCkKICAgIEdhbWUucGVybWFuZW50VXBncmFkZXMgPSBbLTEsIC0xLCAtMSwgLTEsIC0xXTsKICAgIEdhbWUuYXNjZW5zaW9uTW9kZSA9IDA7IC8vdHlwZSBvZiBjaGFsbGVuZ2UgcnVuIGlmIGFueQogICAgR2FtZS5yZXNldHMgPSAwOyAvL3Jlc2V0IGNvdW50ZXIKICAgIEdhbWUubHVtcHMgPSAtMTsgLy9zdWdhciBsdW1wcwogICAgR2FtZS5sdW1wc1RvdGFsID0gLTE7IC8vc3VnYXIgbHVtcHMgZWFybmVkIGFjcm9zcyBhbGwgcGxheXRocm91Z2hzICgtMSBtZWFucyB0aGV5IGhhdmVuJ3QgZXZlbiBzdGFydGVkIHlldCkKICAgIEdhbWUubHVtcFQgPSBEYXRlLm5vdygpOyAvL3RpbWUgd2hlbiB0aGUgY3VycmVudCBsdW1wIHN0YXJ0ZWQgZm9ybWluZwogICAgR2FtZS5sdW1wUmVmaWxsID0gMDsgLy90aW1lIGxlZnQgYmVmb3JlIGEgc3VnYXIgbHVtcCBjYW4gYmUgdXNlZCBhZ2FpbiAob24gbWluaWdhbWUgcmVmaWxscyBldGMpIGluIGxvZ2ljIGZyYW1lcwoKICAgIEdhbWUubWFrZVNlZWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBjaGFycyA9ICJhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eiIuc3BsaXQoIiIpOwogICAgICB2YXIgc3RyID0gIiI7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNTsgaSsrKSB7CiAgICAgICAgc3RyICs9IGNob29zZShjaGFycyk7CiAgICAgIH0KICAgICAgcmV0dXJuIHN0cjsKICAgIH07CiAgICBHYW1lLnNlZWQgPSBHYW1lLm1ha2VTZWVkKCk7IC8vZWFjaCBydW4gaGFzIGl0cyBvd24gc2VlZCwgdXNlZCBmb3IgZGV0ZXJtaW5pc3RpYyByYW5kb20gc3R1ZmYKCiAgICBHYW1lLnZvbHVtZSA9IDc1OyAvL3NvdW5kIHZvbHVtZQogICAgR2FtZS52b2x1bWVNdXNpYyA9IDUwOyAvL211c2ljIHZvbHVtZQoKICAgIEdhbWUuZWxkZXJXcmF0aCA9IDA7CiAgICBHYW1lLmVsZGVyV3JhdGhPbGQgPSAwOwogICAgR2FtZS5lbGRlcldyYXRoRCA9IDA7CiAgICBHYW1lLnBsZWRnZXMgPSAwOwogICAgR2FtZS5wbGVkZ2VUID0gMDsKICAgIEdhbWUucmVzZWFyY2hUID0gMDsKICAgIEdhbWUubmV4dFJlc2VhcmNoID0gMDsKICAgIEdhbWUuY29va2llc1N1Y2tlZCA9IDA7IC8vY29va2llcyBzdWNrZWQgYnkgd3JpbmtsZXJzCiAgICBHYW1lLmNwc1N1Y2tlZCA9IDA7IC8vcGVyY2VudCBvZiBDcFMgYmVpbmcgc3Vja2VkIGJ5IHdyaW5rbGVycwogICAgR2FtZS53cmlua2xlcnNQb3BwZWQgPSAwOwogICAgR2FtZS5zYW50YUxldmVsID0gMDsKICAgIEdhbWUucmVpbmRlZXJDbGlja2VkID0gMDsKICAgIEdhbWUuc2Vhc29uVCA9IDA7CiAgICBHYW1lLnNlYXNvblVzZXMgPSAwOwogICAgR2FtZS5kcmFnb25MZXZlbCA9IDA7CiAgICBHYW1lLmRyYWdvbkF1cmEgPSAwOwogICAgR2FtZS5kcmFnb25BdXJhMiA9IDA7CgogICAgR2FtZS5mb3J0dW5lR0MgPSAwOwogICAgR2FtZS5mb3J0dW5lQ1BTID0gMDsKCiAgICBHYW1lLmJsZW5kTW9kZXNPbiA9CiAgICAgIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRldGVjdCIpLnN0eWxlLm1peEJsZW5kTW9kZSA9PT0gIiI7CgogICAgR2FtZS5iZyA9ICIiOyAvL2JhY2tncm91bmQgKGdyYW5kbWFzIGFuZCBzdWNoKQogICAgR2FtZS5iZ0ZhZGUgPSAiIjsgLy9mYWRpbmcgdG8gYmFja2dyb3VuZAogICAgR2FtZS5iZ1IgPSAwOyAvL3JhdGlvICgwIC0gbm90IGZhZGVkLCAxIC0gZnVsbHkgZmFkZWQpCiAgICBHYW1lLmJnUmQgPSAwOyAvL3JhdGlvIGRpc3BsYXllZAoKICAgIEdhbWUud2luZG93VyA9IHdpbmRvdy5pbm5lcldpZHRoOwogICAgR2FtZS53aW5kb3dIID0gd2luZG93LmlubmVySGVpZ2h0OwogICAgR2FtZS5zY2FsZSA9IDE7CgogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInJlc2l6ZSIsIGZ1bmN0aW9uIChlKSB7CiAgICAgIEdhbWUucmVzaXplKCk7CiAgICAgIGlmIChBcHAgJiYgQXBwLm9uUmVzaXplKSBBcHAub25SZXNpemUoKTsKICAgIH0pOwoKICAgIEdhbWUucmVzaXplID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgdyA9IHdpbmRvdy5pbm5lcldpZHRoOwogICAgICB2YXIgaCA9IHdpbmRvdy5pbm5lckhlaWdodDsKCiAgICAgIHZhciBwcmV2VyA9IEdhbWUud2luZG93VzsKICAgICAgdmFyIHByZXZIID0gR2FtZS53aW5kb3dIOwoKICAgICAgdmFyIHNjYWxlID0gTWF0aC5taW4odyAvIE1hdGgubWF4KDgwMCwgdyksIGggLyBNYXRoLm1heCgyMDAsIGgpKTsKICAgICAgR2FtZS53aW5kb3dXID0gTWF0aC5mbG9vcih3IC8gc2NhbGUpOwogICAgICBHYW1lLndpbmRvd0ggPSBNYXRoLmZsb29yKGggLyBzY2FsZSk7CiAgICAgIGlmIChzY2FsZSAhPSAxKSB7CiAgICAgICAgR2FtZS53cmFwcGVyLnN0eWxlLnRyYW5zZm9ybSA9ICJzY2FsZSgiICsgc2NhbGUgKyAiKSI7CiAgICAgICAgR2FtZS53cmFwcGVyLnN0eWxlLndpZHRoID0gR2FtZS53aW5kb3dXICsgInB4IjsKICAgICAgICBHYW1lLndyYXBwZXIuc3R5bGUuaGVpZ2h0ID0gR2FtZS53aW5kb3dIICsgInB4IjsKICAgICAgfSBlbHNlIHsKICAgICAgICBHYW1lLndyYXBwZXIuc3R5bGUucmVtb3ZlUHJvcGVydHkoInRyYW5zZm9ybSIpOwogICAgICAgIEdhbWUud3JhcHBlci5zdHlsZS53aWR0aCA9ICIxMDAlIjsKICAgICAgICBHYW1lLndyYXBwZXIuc3R5bGUuaGVpZ2h0ID0gIjEwMCUiOwogICAgICB9CiAgICAgIEdhbWUuc2NhbGUgPSBzY2FsZTsKCiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5PYmplY3RzW2ldOwogICAgICAgIG1lLnRvUmVzaXplID0gdHJ1ZTsKICAgICAgICBpZiAobWUubWluaWdhbWUgJiYgbWUubWluaWdhbWUub25SZXNpemUpIG1lLm1pbmlnYW1lLm9uUmVzaXplKCk7CiAgICAgIH0KCiAgICAgIGlmIChHYW1lLmdldE5ld1RpY2tlcikgewogICAgICAgIGlmICgKICAgICAgICAgIHByZXZXID49IEdhbWUudGlja2VyVG9vTmFycm93ICYmCiAgICAgICAgICBHYW1lLndpbmRvd1cgPCBHYW1lLnRpY2tlclRvb05hcnJvdwogICAgICAgICkKICAgICAgICAgIEdhbWUuZ2V0TmV3VGlja2VyKHRydWUpOwogICAgICAgIGVsc2UgaWYgKAogICAgICAgICAgcHJldlcgPCBHYW1lLnRpY2tlclRvb05hcnJvdyAmJgogICAgICAgICAgR2FtZS53aW5kb3dXID49IEdhbWUudGlja2VyVG9vTmFycm93CiAgICAgICAgKQogICAgICAgICAgR2FtZS5nZXROZXdUaWNrZXIodHJ1ZSk7CiAgICAgIH0KICAgIH07CiAgICBHYW1lLnJlc2l6ZSgpOwoKICAgIEdhbWUuc3RhcnREYXRlID0gcGFyc2VJbnQoRGF0ZS5ub3coKSk7IC8vd2hlbiB3ZSBzdGFydGVkIHBsYXlpbmcKICAgIEdhbWUuZnVsbERhdGUgPSBwYXJzZUludChEYXRlLm5vdygpKTsgLy93aGVuIHdlIHN0YXJ0ZWQgcGxheWluZyAoY2FycmllcyBvdmVyIHdpdGggcmVzZXRzKQogICAgR2FtZS5sYXN0RGF0ZSA9IHBhcnNlSW50KERhdGUubm93KCkpOyAvL3doZW4gd2UgbGFzdCBzYXZlZCB0aGUgZ2FtZSAodXNlZCB0byBjb21wdXRlICJjb29raWVzIG1hZGUgc2luY2Ugd2UgY2xvc2VkIHRoZSBnYW1lIiBldGMpCgogICAgR2FtZS5wcmVmcyA9IFtdOwogICAgR2FtZS5EZWZhdWx0UHJlZnMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIEdhbWUucHJlZnMucGFydGljbGVzID0gMTsgLy9wYXJ0aWNsZSBlZmZlY3RzIDogZmFsbGluZyBjb29raWVzIGV0YwogICAgICBHYW1lLnByZWZzLm51bWJlcnMgPSAxOyAvL251bWJlcnMgdGhhdCBwb3AgdXAgd2hlbiBjbGlja2luZyB0aGUgY29va2llCiAgICAgIEdhbWUucHJlZnMuYXV0b3NhdmUgPSAxOyAvL3NhdmUgdGhlIGdhbWUgZXZlcnkgbWludXRlIG9yIHNvCiAgICAgIEdhbWUucHJlZnMuYXV0b3VwZGF0ZSA9IDE7IC8vc2VuZCBhbiBBSkFYIHJlcXVlc3QgdG8gdGhlIHNlcnZlciBldmVyeSAzMCBtaW51dGVzIChub3RlIDogaWdub3JlZCkKICAgICAgR2FtZS5wcmVmcy5taWxrID0gMTsgLy9kaXNwbGF5IG1pbGsKICAgICAgR2FtZS5wcmVmcy5mYW5jeSA9IDE7IC8vQ1NTIHNoYWRvdyBlZmZlY3RzIChtaWdodCBiZSBoZWF2eSBvbiBzb21lIGJyb3dzZXJzKQogICAgICBHYW1lLnByZWZzLndhcm4gPSAwOyAvL3dhcm4gYmVmb3JlIGNsb3NpbmcgdGhlIHdpbmRvdwogICAgICBHYW1lLnByZWZzLmN1cnNvcnMgPSAxOyAvL2Rpc3BsYXkgY3Vyc29ycwogICAgICBHYW1lLnByZWZzLmZvY3VzID0gMTsgLy9tYWtlIHRoZSBnYW1lIHJlZnJlc2ggbGVzcyBmcmVxdWVudGx5IHdoZW4gb2ZmLWZvY3VzCiAgICAgIEdhbWUucHJlZnMucG9wdXBzID0gMDsgLy91c2Ugb2xkLXN0eWxlIHBvcHVwcyAobm8gbG9uZ2VyIHVzZWQpCiAgICAgIEdhbWUucHJlZnMuZm9ybWF0ID0gMDsgLy9zaG9ydGVuIG51bWJlcnMKICAgICAgR2FtZS5wcmVmcy5ub3RpZnMgPSAwOyAvL25vdGlmaWNhdGlvbnMgZmFkZSBmYXN0ZXIKICAgICAgR2FtZS5wcmVmcy5hbmltYXRlID0gMTsgLy9hbmltYXRlIGJ1aWxkaW5ncwogICAgICBHYW1lLnByZWZzLndvYmJseSA9IDE7IC8vd29iYmx5IGNvb2tpZQogICAgICBHYW1lLnByZWZzLm1vbm9zcGFjZSA9IDA7IC8vYWx0IG1vbm9zcGFjZSBmb250IGZvciBjb29raWVzCiAgICAgIEdhbWUucHJlZnMuZmlsdGVycyA9IDE7IC8vQ1NTIGZpbHRlciBlZmZlY3RzIChtaWdodCBiZSBoZWF2eSBvbiBzb21lIGJyb3dzZXJzKQogICAgICBHYW1lLnByZWZzLmNvb2tpZXNvdW5kID0gMTsgLy91c2UgbmV3IGNvb2tpZSBjbGljayBzb3VuZAogICAgICBHYW1lLnByZWZzLmNyYXRlcyA9IDA7IC8vc2hvdyBjcmF0ZXMgYXJvdW5kIGljb25zIGluIHN0YXRzCiAgICAgIEdhbWUucHJlZnMuYWx0RHJhdyA9IDA7IC8vdXNlIHJlcXVlc3RBbmltYXRpb25GcmFtZSB0byB1cGRhdGUgZHJhd2luZyBpbnN0ZWFkIG9mIGZpeGVkIDMwIGZwcyBzZXRUaW1lb3V0CiAgICAgIEdhbWUucHJlZnMuc2hvd0JhY2t1cFdhcm5pbmcgPSAxOyAvL2lmIHRydWUsIHNob3cgYSAiSGF2ZSB5b3UgYmFja2VkIHVwIHlvdXIgc2F2ZT8iIG1lc3NhZ2Ugb24gc2F2ZSBsb2FkOyBzZXQgdG8gZmFsc2Ugd2hlbiBzYXZlIGlzIGV4cG9ydGVkCiAgICAgIEdhbWUucHJlZnMuZXh0cmFCdXR0b25zID0gMTsgLy9pZiB0cnVlLCBzaG93IE11dGUgYnV0dG9ucyBhbmQgdGhlIGJ1aWxkaW5nIG1hc3RlciBiYXIKICAgICAgR2FtZS5wcmVmcy5hc2tMdW1wcyA9IDA7IC8vaWYgdHJ1ZSwgc2hvdyBhIHByb21wdCBiZWZvcmUgc3BlbmRpbmcgbHVtcHMKICAgICAgR2FtZS5wcmVmcy5jdXN0b21HcmFuZG1hcyA9IDE7IC8vaWYgdHJ1ZSwgc2hvdyBwYXRyZW9uIG5hbWVzIGZvciBncmFuZG1hcwogICAgICBHYW1lLnByZWZzLnRpbWVvdXQgPSAwOyAvL2lmIHRydWUsIGdhbWUgbWF5IHNob3cgcGF1c2Ugc2NyZWVuIHdoZW4gdGltZWQgb3V0CiAgICAgIEdhbWUucHJlZnMuY2xvdWRTYXZlID0gMTsgLy9pZiB0cnVlIGFuZCBvbiBTdGVhbSwgc2F2ZSBhbmQgbG9hZCB0byBjbG91ZAogICAgICBHYW1lLnByZWZzLmJnTXVzaWMgPSAxOyAvL2lmIHRydWUgYW5kIG9uIFN0ZWFtLCBwbGF5IG11c2ljIGV2ZW4gd2hlbiBnYW1lIGlzbid0IGZvY3VzZWQKICAgICAgR2FtZS5wcmVmcy5ub3RTY2FyeSA9IDA7IC8vaWYgdHJ1ZSwgbWFrZSBzb21lIG9mIHRoZSBzY2FyeSBzdHVmZiBsZXNzIHNjYXJ5ICgiZXllYnJvdyBtb2RlIikKICAgICAgR2FtZS5wcmVmcy5mdWxsc2NyZWVuID0gMDsgLy9pZiB0cnVlLCBTdGVhbSBnYW1lIHdpbGwgYmUgZnVsbHNjcmVlbgogICAgICBHYW1lLnByZWZzLnNjcmVlbnJlYWRlciA9IDA7IC8vaWYgdHJ1ZSwgYWRkIHNvbWUgRE9NIHN0dWZmIHRvIGZhY2lsaXRhdGUgc2NyZWVucmVhZGVyIGludGVyYWN0aW9uIChyZXF1aXJlcyByZWxvYWQpCiAgICAgIEdhbWUucHJlZnMuZGlzY29yZFByZXNlbmNlID0gMTsgLy9pZiB0cnVlIGFuZCBhcHBsaWNhYmxlLCBzaG93IGdhbWUgYWN0aXZpdHkgaW4gRGlzY29yZCBzdGF0dXMKICAgIH07CiAgICBHYW1lLkRlZmF1bHRQcmVmcygpOwoKICAgIHdpbmRvdy5vbmJlZm9yZXVubG9hZCA9IGZ1bmN0aW9uIChldmVudCkgewogICAgICBpZiAoR2FtZS5wcmVmcyAmJiBHYW1lLnByZWZzLndhcm4pIHsKICAgICAgICBpZiAodHlwZW9mIGV2ZW50ID09ICJ1bmRlZmluZWQiKSBldmVudCA9IHdpbmRvdy5ldmVudDsKICAgICAgICBpZiAoZXZlbnQpCiAgICAgICAgICBldmVudC5yZXR1cm5WYWx1ZSA9IGxvYygKICAgICAgICAgICAgIkFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBjbG9zZSBDb29raWUgQ2xpY2tlcj8iCiAgICAgICAgICApOwogICAgICB9CiAgICB9OwoKICAgIEdhbWUuTW9iaWxlID0gZnVuY3Rpb24gKCkgewogICAgICBpZiAoIUdhbWUubW9iaWxlKSB7CiAgICAgICAgR2FtZS53cmFwcGVyLmNsYXNzTmFtZSA9ICJtb2JpbGUiOwogICAgICAgIEdhbWUubW9iaWxlID0gMTsKICAgICAgfSBlbHNlIHsKICAgICAgICBHYW1lLndyYXBwZXIuY2xhc3NOYW1lID0gIiI7CiAgICAgICAgR2FtZS5tb2JpbGUgPSAwOwogICAgICB9CiAgICB9OwoKICAgIEdhbWUuc2hvd0JhY2t1cFdhcm5pbmcgPSBmdW5jdGlvbiAoKSB7CiAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgIGxvYygiQmFjayB1cCB5b3VyIHNhdmUhIiksCiAgICAgICAgbG9jKAogICAgICAgICAgJ0hlbGxvIGFnYWluISBKdXN0IGEgcmVtaW5kZXIgdGhhdCB5b3UgbWF5IHdhbnQgdG8gYmFjayB1cCB5b3VyIENvb2tpZSBDbGlja2VyIHNhdmUgZXZlcnkgb25jZSBpbiBhIHdoaWxlLCBqdXN0IGluIGNhc2UuPGJyPlRvIGRvIHNvLCBnbyB0byBPcHRpb25zIGFuZCBoaXQgIkV4cG9ydCBzYXZlIiBvciAiU2F2ZSB0byBmaWxlIiEnCiAgICAgICAgKSArCiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+PGEgc3R5bGU9ImZsb2F0OnJpZ2h0OyIgb25jbGljaz0iR2FtZS5wcmVmcy5zaG93QmFja3VwV2FybmluZz0wOz09Q0xPU0VUSElTKCk9PSI+JyArCiAgICAgICAgICBsb2MoIkRvbid0IHNob3cgdGhpcyBhZ2FpbiIpICsKICAgICAgICAgICI8L2E+IiwKICAgICAgICBbMjUsIDddCiAgICAgICk7CiAgICB9OwoKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJCUJBS0VSWSBOQU1FCgkJPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KICAgIEdhbWUuUmFuZG9tQmFrZXJ5TmFtZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHN0ciA9ICIiOwogICAgICBpZiAoRU4pIHsKICAgICAgICByZXR1cm4gKAogICAgICAgICAgKE1hdGgucmFuZG9tKCkgPiAwLjA1CiAgICAgICAgICAgID8gY2hvb3NlKFsKICAgICAgICAgICAgICAgICJNYWdpYyIsCiAgICAgICAgICAgICAgICAiRmFudGFzdGljIiwKICAgICAgICAgICAgICAgICJGYW5jeSIsCiAgICAgICAgICAgICAgICAiU2Fzc3kiLAogICAgICAgICAgICAgICAgIlNuYXp6eSIsCiAgICAgICAgICAgICAgICAiUHJldHR5IiwKICAgICAgICAgICAgICAgICJDdXRlIiwKICAgICAgICAgICAgICAgICJQaXJhdGUiLAogICAgICAgICAgICAgICAgIk5pbmphIiwKICAgICAgICAgICAgICAgICJab21iaWUiLAogICAgICAgICAgICAgICAgIlJvYm90IiwKICAgICAgICAgICAgICAgICJSYWRpY2FsIiwKICAgICAgICAgICAgICAgICJVcmJhbiIsCiAgICAgICAgICAgICAgICAiQ29vbCIsCiAgICAgICAgICAgICAgICAiSGVsbGEiLAogICAgICAgICAgICAgICAgIlN3ZWV0IiwKICAgICAgICAgICAgICAgICJBd2Z1bCIsCiAgICAgICAgICAgICAgICAiRG91YmxlIiwKICAgICAgICAgICAgICAgICJUcmlwbGUiLAogICAgICAgICAgICAgICAgIlR1cmJvIiwKICAgICAgICAgICAgICAgICJUZWNobm8iLAogICAgICAgICAgICAgICAgIkRpc2NvIiwKICAgICAgICAgICAgICAgICJFbGVjdHJvIiwKICAgICAgICAgICAgICAgICJEYW5jaW5nIiwKICAgICAgICAgICAgICAgICJXb25kZXIiLAogICAgICAgICAgICAgICAgIk11dGFudCIsCiAgICAgICAgICAgICAgICAiU3BhY2UiLAogICAgICAgICAgICAgICAgIlNjaWVuY2UiLAogICAgICAgICAgICAgICAgIk1lZGlldmFsIiwKICAgICAgICAgICAgICAgICJGdXR1cmUiLAogICAgICAgICAgICAgICAgIkNhcHRhaW4iLAogICAgICAgICAgICAgICAgIkJlYXJkZWQiLAogICAgICAgICAgICAgICAgIkxvdmVseSIsCiAgICAgICAgICAgICAgICAiVGlueSIsCiAgICAgICAgICAgICAgICAiQmlnIiwKICAgICAgICAgICAgICAgICJGaXJlIiwKICAgICAgICAgICAgICAgICJXYXRlciIsCiAgICAgICAgICAgICAgICAiRnJvemVuIiwKICAgICAgICAgICAgICAgICJNZXRhbCIsCiAgICAgICAgICAgICAgICAiUGxhc3RpYyIsCiAgICAgICAgICAgICAgICAiU29saWQiLAogICAgICAgICAgICAgICAgIkxpcXVpZCIsCiAgICAgICAgICAgICAgICAiTW9sZHkiLAogICAgICAgICAgICAgICAgIlNoaW55IiwKICAgICAgICAgICAgICAgICJIYXBweSIsCiAgICAgICAgICAgICAgICAiSGFwcHkgTGl0dGxlIiwKICAgICAgICAgICAgICAgICJTbGlteSIsCiAgICAgICAgICAgICAgICAiVGFzdHkiLAogICAgICAgICAgICAgICAgIkRlbGljaW91cyIsCiAgICAgICAgICAgICAgICAiSHVuZ3J5IiwKICAgICAgICAgICAgICAgICJHcmVlZHkiLAogICAgICAgICAgICAgICAgIkxldGhhbCIsCiAgICAgICAgICAgICAgICAiUHJvZmVzc29yIiwKICAgICAgICAgICAgICAgICJEb2N0b3IiLAogICAgICAgICAgICAgICAgIlBvd2VyIiwKICAgICAgICAgICAgICAgICJDaG9jb2xhdGUiLAogICAgICAgICAgICAgICAgIkNydW1ibHkiLAogICAgICAgICAgICAgICAgIkNob2tsaXQiLAogICAgICAgICAgICAgICAgIlJpZ2h0ZW91cyIsCiAgICAgICAgICAgICAgICAiR2xvcmlvdXMiLAogICAgICAgICAgICAgICAgIk1uZW1vbmljIiwKICAgICAgICAgICAgICAgICJQc3ljaGljIiwKICAgICAgICAgICAgICAgICJGcmVuZXRpYyIsCiAgICAgICAgICAgICAgICAiSGVjdGljIiwKICAgICAgICAgICAgICAgICJDcmF6eSIsCiAgICAgICAgICAgICAgICAiUm95YWwiLAogICAgICAgICAgICAgICAgIkVsIiwKICAgICAgICAgICAgICAgICJWb24iLAogICAgICAgICAgICAgIF0pICsgIiAiCiAgICAgICAgICAgIDogIk1jIikgKwogICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgIkNvb2tpZSIsCiAgICAgICAgICAgICJCaXNjdWl0IiwKICAgICAgICAgICAgIk11ZmZpbiIsCiAgICAgICAgICAgICJTY29uZSIsCiAgICAgICAgICAgICJDdXBjYWtlIiwKICAgICAgICAgICAgIlBhbmNha2UiLAogICAgICAgICAgICAiQ2hpcCIsCiAgICAgICAgICAgICJTcHJvY2tldCIsCiAgICAgICAgICAgICJHaXptbyIsCiAgICAgICAgICAgICJQdXBwZXQiLAogICAgICAgICAgICAiTWl0dGVuIiwKICAgICAgICAgICAgIlNvY2siLAogICAgICAgICAgICAiVGVhcG90IiwKICAgICAgICAgICAgIk15c3RlcnkiLAogICAgICAgICAgICAiQmFrZXIiLAogICAgICAgICAgICAiQ29vayIsCiAgICAgICAgICAgICJHcmFuZG1hIiwKICAgICAgICAgICAgIkNsaWNrIiwKICAgICAgICAgICAgIkNsaWNrZXIiLAogICAgICAgICAgICAiU3BhY2VzaGlwIiwKICAgICAgICAgICAgIkZhY3RvcnkiLAogICAgICAgICAgICAiUG9ydGFsIiwKICAgICAgICAgICAgIk1hY2hpbmUiLAogICAgICAgICAgICAiRXhwZXJpbWVudCIsCiAgICAgICAgICAgICJNb25zdGVyIiwKICAgICAgICAgICAgIlBhbmljIiwKICAgICAgICAgICAgIkJ1cmdsYXIiLAogICAgICAgICAgICAiQmFuZGl0IiwKICAgICAgICAgICAgIkJvb3R5IiwKICAgICAgICAgICAgIlBvdGF0byIsCiAgICAgICAgICAgICJQaXp6YSIsCiAgICAgICAgICAgICJCdXJnZXIiLAogICAgICAgICAgICAiU2F1c2FnZSIsCiAgICAgICAgICAgICJNZWF0YmFsbCIsCiAgICAgICAgICAgICJTcGFnaGV0dGkiLAogICAgICAgICAgICAiTWFjYXJvbmkiLAogICAgICAgICAgICAiS2l0dGVuIiwKICAgICAgICAgICAgIlB1cHB5IiwKICAgICAgICAgICAgIkdpcmFmZmUiLAogICAgICAgICAgICAiWmVicmEiLAogICAgICAgICAgICAiUGFycm90IiwKICAgICAgICAgICAgIkRvbHBoaW4iLAogICAgICAgICAgICAiRHVja2xpbmciLAogICAgICAgICAgICAiU2xvdGgiLAogICAgICAgICAgICAiVHVydGxlIiwKICAgICAgICAgICAgIkdvYmxpbiIsCiAgICAgICAgICAgICJQaXhpZSIsCiAgICAgICAgICAgICJHbm9tZSIsCiAgICAgICAgICAgICJDb21wdXRlciIsCiAgICAgICAgICAgICJQaXJhdGUiLAogICAgICAgICAgICAiTmluamEiLAogICAgICAgICAgICAiWm9tYmllIiwKICAgICAgICAgICAgIlJvYm90IiwKICAgICAgICAgIF0pCiAgICAgICAgKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoCiAgICAgICAgICBsb2NTdHJpbmdzWyJiYWtlcnkgcmFuZG9tIG5hbWUsIDFzdCBoYWxmIl0gJiYKICAgICAgICAgIGxvY1N0cmluZ3NbImJha2VyeSByYW5kb20gbmFtZSwgMm5kIGhhbGYiXQogICAgICAgICkKICAgICAgICAgIHN0ciArPQogICAgICAgICAgICBjaG9vc2UobG9jKCJiYWtlcnkgcmFuZG9tIG5hbWUsIDFzdCBoYWxmIikpICsKICAgICAgICAgICAgIiAiICsKICAgICAgICAgICAgY2hvb3NlKGxvYygiYmFrZXJ5IHJhbmRvbSBuYW1lLCAybmQgaGFsZiIpKTsKICAgICAgICBlbHNlIHN0ciArPSBjaG9vc2UobG9jKCJiYWtlcnkgcmFuZG9tIG5hbWUiKSk7CiAgICAgIH0KICAgICAgcmV0dXJuIHN0cjsKICAgIH07CiAgICBHYW1lLkdldEJha2VyeU5hbWUgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBHYW1lLlJhbmRvbUJha2VyeU5hbWUoKTsKICAgIH07CiAgICBHYW1lLmJha2VyeU5hbWVMID0gbCgiYmFrZXJ5TmFtZSIpOwogICAgR2FtZS5iYWtlcnlOYW1lU2V0ID0gZnVuY3Rpb24gKHdoYXQpIHsKICAgICAgdHJ5IHsKICAgICAgICB2YXIgZXhwID0gbmV3IFJlZ0V4cCgiW14nXFwtXzAtOSBcXHB7TH1dIiwgImd1Iik7CiAgICAgICAgR2FtZS5iYWtlcnlOYW1lID0gd2hhdC5yZXBsYWNlKGV4cCwgIiAiKTsKICAgICAgICAvL0dhbWUuYmFrZXJ5TmFtZT13aGF0LnJlcGxhY2UoL1teJ1wtXzAtOSBccHtMfV0vZ3UsJyAnKTsKICAgICAgICBHYW1lLmJha2VyeU5hbWUgPSBHYW1lLmJha2VyeU5hbWUudHJpbSgpLnN1YnN0cmluZygwLCAyOCk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICB2YXIgZXhwID0gbmV3IFJlZ0V4cCgiVysiLCAiZyIpOwogICAgICAgIEdhbWUuYmFrZXJ5TmFtZSA9IHdoYXQucmVwbGFjZShleHAsICIgIik7CiAgICAgICAgLy9HYW1lLmJha2VyeU5hbWU9d2hhdC5yZXBsYWNlKC9cVysvZywnICcpOwogICAgICAgIEdhbWUuYmFrZXJ5TmFtZSA9IEdhbWUuYmFrZXJ5TmFtZS5zdWJzdHJpbmcoMCwgMjgpOwogICAgICB9CiAgICAgIEdhbWUuYmFrZXJ5TmFtZVJlZnJlc2goKTsKICAgICAgaWYgKEdhbWUuYmFrZXJ5TmFtZSA9PSAiUkVTVE9SRSBCQUNLVVAiICYmIEFwcCAmJiBBcHAucmVzdG9yZUJhY2t1cCkKICAgICAgICBBcHAucmVzdG9yZUJhY2t1cCgpOwogICAgfTsKICAgIEdhbWUuYmFrZXJ5TmFtZVJlZnJlc2ggPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBuYW1lID0gR2FtZS5iYWtlcnlOYW1lOwogICAgICBpZiAoRU4pIHsKICAgICAgICBpZiAobmFtZS5zbGljZSgtMSkudG9Mb3dlckNhc2UoKSA9PSAicyIpIG5hbWUgKz0gIicgYmFrZXJ5IjsKICAgICAgICBlbHNlIG5hbWUgKz0gIidzIGJha2VyeSI7CiAgICAgIH0gZWxzZSBuYW1lID0gbG9jKCIlMSdzIGJha2VyeSIsIG5hbWUpOwogICAgICBHYW1lLmJha2VyeU5hbWVMLnRleHRDb250ZW50ID0gbmFtZTsKICAgICAgbmFtZSA9IEdhbWUuYmFrZXJ5TmFtZS50b0xvd2VyQ2FzZSgpOwogICAgICBpZiAobmFtZSA9PSAib3J0ZWlsIikgR2FtZS5XaW4oIkdvZCBjb21wbGV4Iik7CiAgICAgIGlmICgKICAgICAgICAhQXBwICYmCiAgICAgICAgbmFtZS5pbmRleE9mKCJzYXlzb3BlbnNlc2FtZSIsIG5hbWUubGVuZ3RoIC0gInNheXNvcGVuc2VzYW1lIi5sZW5ndGgpID4KICAgICAgICAgIDAgJiYKICAgICAgICAhR2FtZS5zZXNhbWUKICAgICAgKQogICAgICAgIEdhbWUuT3BlblNlc2FtZSgpOwogICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgfTsKICAgIEdhbWUuYmFrZXJ5TmFtZVByb21wdCA9IGZ1bmN0aW9uICgpIHsKICAgICAgUGxheVNvdW5kKCJzbmQvdGljay5tcDMiKTsKICAgICAgR2FtZS5Qcm9tcHQoCiAgICAgICAgIjxpZCBOYW1lQmFrZXJ5PjxoMz4iICsKICAgICAgICAgIGxvYygiTmFtZSB5b3VyIGJha2VyeSIpICsKICAgICAgICAgICc8L2gzPjxkaXYgY2xhc3M9ImJsb2NrIiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7Ij4nICsKICAgICAgICAgIGxvYygiV2hhdCBzaG91bGQgeW91ciBiYWtlcnkncyBuYW1lIGJlPyIpICsKICAgICAgICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJibG9jayI+PGlucHV0IHR5cGU9InRleHQiIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjt3aWR0aDoxMDAlOyIgaWQ9ImJha2VyeU5hbWVJbnB1dCIgdmFsdWU9IicgKwogICAgICAgICAgR2FtZS5iYWtlcnlOYW1lICsKICAgICAgICAgICciLz48L2Rpdj4nLAogICAgICAgIFsKICAgICAgICAgIFsKICAgICAgICAgICAgbG9jKCJDb25maXJtIiksCiAgICAgICAgICAgICJpZiAobCgnYmFrZXJ5TmFtZUlucHV0JykudmFsdWUubGVuZ3RoPjApIHtHYW1lLmJha2VyeU5hbWVTZXQobCgnYmFrZXJ5TmFtZUlucHV0JykudmFsdWUpO0dhbWUuV2luKCdXaGF0XFwncyBpbiBhIG5hbWUnKTtHYW1lLkNsb3NlUHJvbXB0KCk7fSIsCiAgICAgICAgICBdLAogICAgICAgICAgW2xvYygiUmFuZG9tIiksICJHYW1lLmJha2VyeU5hbWVQcm9tcHRSYW5kb20oKTsiXSwKICAgICAgICAgIGxvYygiQ2FuY2VsIiksCiAgICAgICAgXQogICAgICApOwogICAgICBsKCJiYWtlcnlOYW1lSW5wdXQiKS5mb2N1cygpOwogICAgICBsKCJiYWtlcnlOYW1lSW5wdXQiKS5zZWxlY3QoKTsKICAgIH07CiAgICBHYW1lLmJha2VyeU5hbWVQcm9tcHRSYW5kb20gPSBmdW5jdGlvbiAoKSB7CiAgICAgIGwoImJha2VyeU5hbWVJbnB1dCIpLnZhbHVlID0gR2FtZS5SYW5kb21CYWtlcnlOYW1lKCk7CiAgICB9OwogICAgQWRkRXZlbnQoR2FtZS5iYWtlcnlOYW1lTCwgImNsaWNrIiwgR2FtZS5iYWtlcnlOYW1lUHJvbXB0KTsKCiAgICBHYW1lLmJha2VyeU5hbWVTZXQoR2FtZS5HZXRCYWtlcnlOYW1lKCkpOwoKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJCVRPT0xUSVAKCQk9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgR2FtZS50b29sdGlwID0gewogICAgICB0ZXh0OiAiIiwKICAgICAgeDogMCwKICAgICAgeTogMCwKICAgICAgb3JpZ2luOiAiIiwKICAgICAgb246IDAsCiAgICAgIHR0OiBsKCJ0b29sdGlwIiksCiAgICAgIHR0YTogbCgidG9vbHRpcEFuY2hvciIpLAogICAgICBzaG91bGRIaWRlOiAxLAogICAgICBkeW5hbWljOiAwLAogICAgICBmcm9tOiAwLAogICAgfTsKICAgIEdhbWUudG9vbHRpcC5kcmF3ID0gZnVuY3Rpb24gKGZyb20sIHRleHQsIG9yaWdpbikgewogICAgICB0aGlzLnNob3VsZEhpZGUgPSAwOwogICAgICB0aGlzLnRleHQgPSB0ZXh0OwogICAgICB0aGlzLmZyb20gPSBmcm9tOwogICAgICAvL3RoaXMueD14OwogICAgICAvL3RoaXMueT15OwogICAgICB0aGlzLm9yaWdpbiA9IG9yaWdpbjsKICAgICAgdmFyIHR0ID0gdGhpcy50dDsKICAgICAgdmFyIHR0YSA9IHRoaXMudHRhOwogICAgICB0dC5zdHlsZS5sZWZ0ID0gImF1dG8iOwogICAgICB0dC5zdHlsZS50b3AgPSAiYXV0byI7CiAgICAgIHR0LnN0eWxlLnJpZ2h0ID0gImF1dG8iOwogICAgICB0dC5zdHlsZS5ib3R0b20gPSAiYXV0byI7CiAgICAgIGlmICh0eXBlb2YgdGhpcy50ZXh0ID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgdmFyIHRleHQgPSB0aGlzLnRleHQoKTsKICAgICAgICBpZiAodGV4dCA9PSAiIikgdHRhLnN0eWxlLm9wYWNpdHkgPSAiMCI7CiAgICAgICAgZWxzZSB7CiAgICAgICAgICB0dC5pbm5lckhUTUwgPSB1bmVzY2FwZSh0ZXh0KTsKICAgICAgICAgIHR0YS5zdHlsZS5vcGFjaXR5ID0gIjEiOwogICAgICAgIH0KICAgICAgfSBlbHNlIHR0LmlubmVySFRNTCA9IHVuZXNjYXBlKHRoaXMudGV4dCk7CiAgICAgIC8vdHQuaW5uZXJIVE1MPSh0eXBlb2YgdGhpcy50ZXh0PT09J2Z1bmN0aW9uJyk/dW5lc2NhcGUodGhpcy50ZXh0KCkpOnVuZXNjYXBlKHRoaXMudGV4dCk7CiAgICAgIHR0YS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgdHRhLnN0eWxlLnZpc2liaWxpdHkgPSAiaGlkZGVuIjsKICAgICAgR2FtZS50b29sdGlwLnVwZGF0ZSgpOwogICAgICB0dGEuc3R5bGUudmlzaWJpbGl0eSA9ICJ2aXNpYmxlIjsKICAgICAgdGhpcy5vbiA9IDE7CiAgICB9OwogICAgR2FtZS50b29sdGlwLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIFggPSAwOwogICAgICB2YXIgWSA9IDA7CiAgICAgIHZhciB3aWR0aCA9IHRoaXMudHQub2Zmc2V0V2lkdGg7CiAgICAgIHZhciBoZWlnaHQgPSB0aGlzLnR0Lm9mZnNldEhlaWdodDsKICAgICAgaWYgKHRoaXMub3JpZ2luID09ICJzdG9yZSIpIHsKICAgICAgICBYID0gR2FtZS53aW5kb3dXIC0gMzMyIC0gd2lkdGg7CiAgICAgICAgWSA9IEdhbWUubW91c2VZIC0gMzI7CiAgICAgICAgaWYgKEdhbWUub25DcmF0ZSkgWSA9IEdhbWUub25DcmF0ZS5nZXRCb3VuZHMoKS50b3AgLSA0MjsKICAgICAgICBZID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oR2FtZS53aW5kb3dIIC0gaGVpZ2h0IC0gNDQsIFkpKTsKICAgICAgICAvKnRoaXMudHRhLnN0eWxlLnJpZ2h0PSczMDhweCc7Ly8nNDY4cHgnOwoJCQkJdGhpcy50dGEuc3R5bGUubGVmdD0nYXV0byc7CgkJCQlpZiAoR2FtZS5vbkNyYXRlKSBZPUdhbWUub25DcmF0ZS5nZXRCb3VuZHMoKS50b3AtMjsKCQkJCXRoaXMudHRhLnN0eWxlLnRvcD1NYXRoLm1heCgwLE1hdGgubWluKEdhbWUud2luZG93SC10aGlzLnR0LmNsaWVudEhlaWdodC02NCxZLTQ4KSkrJ3B4JzsqLwogICAgICB9IGVsc2UgewogICAgICAgIGlmIChHYW1lLm9uQ3JhdGUpIHsKICAgICAgICAgIHZhciByZWN0ID0gR2FtZS5vbkNyYXRlLmdldEJvdW5kcygpOwogICAgICAgICAgaWYgKHJlY3QubGVmdCA9PSAwICYmIHJlY3QudG9wID09IDApIHsKICAgICAgICAgICAgLy9pZiB3ZSBnZXQgdGhhdCBidWcgd2hlcmUgd2UgZ2V0IHN0dWNrIGluIHRoZSB0b3AtbGVmdCwgbW92ZSB0byB0aGUgbW91c2UgKFJFVklTSU9OIDoganVzdCBkbyBub3RoaW5nKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7IC8qcmVjdC5sZWZ0PUdhbWUubW91c2VYLTI0O3JlY3QucmlnaHQ9R2FtZS5tb3VzZVgrMjQ7cmVjdC50b3A9R2FtZS5tb3VzZVktMjQ7cmVjdC5ib3R0b209R2FtZS5tb3VzZVkrMjQ7Ki8KICAgICAgICAgIH0KICAgICAgICAgIGlmICh0aGlzLm9yaWdpbiA9PSAibGVmdCIpIHsKICAgICAgICAgICAgWCA9IHJlY3QubGVmdCAtIHdpZHRoIC0gMTY7CiAgICAgICAgICAgIFkgPSByZWN0LnRvcCArIChyZWN0LmJvdHRvbSAtIHJlY3QudG9wKSAvIDIgLSBoZWlnaHQgLyAyIC0gMzg7CiAgICAgICAgICAgIFkgPSBNYXRoLm1heCgwLCBNYXRoLm1pbihHYW1lLndpbmRvd0ggLSBoZWlnaHQgLSAxOSwgWSkpOwogICAgICAgICAgICBpZiAoWCA8IDApIFggPSByZWN0LnJpZ2h0OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgWCA9IHJlY3QubGVmdCArIChyZWN0LnJpZ2h0IC0gcmVjdC5sZWZ0KSAvIDIgLSB3aWR0aCAvIDIgLSA4OwogICAgICAgICAgICBZID0gcmVjdC50b3AgLSBoZWlnaHQgLSBUb3BCYXJPZmZzZXQgLSAxNjsKICAgICAgICAgICAgWCA9IE1hdGgubWF4KDAsIE1hdGgubWluKEdhbWUud2luZG93VyAtIHdpZHRoIC0gMTYsIFgpKTsKICAgICAgICAgICAgaWYgKFkgPCAwKSBZID0gcmVjdC5ib3R0b20gLSBUb3BCYXJPZmZzZXQ7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICh0aGlzLm9yaWdpbiA9PSAiYm90dG9tLXJpZ2h0IikgewogICAgICAgICAgWCA9IEdhbWUubW91c2VYICsgODsKICAgICAgICAgIFkgPSBHYW1lLm1vdXNlWSAtIDMyOwogICAgICAgICAgWCA9IE1hdGgubWF4KDAsIE1hdGgubWluKEdhbWUud2luZG93VyAtIHdpZHRoIC0gMTYsIFgpKTsKICAgICAgICAgIFkgPSBNYXRoLm1heCgwLCBNYXRoLm1pbihHYW1lLndpbmRvd0ggLSBoZWlnaHQgLSA2NCwgWSkpOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy5vcmlnaW4gPT0gImJvdHRvbSIpIHsKICAgICAgICAgIFggPSBHYW1lLm1vdXNlWCAtIHdpZHRoIC8gMiAtIDg7CiAgICAgICAgICBZID0gR2FtZS5tb3VzZVkgKyAyNDsKICAgICAgICAgIFggPSBNYXRoLm1heCgwLCBNYXRoLm1pbihHYW1lLndpbmRvd1cgLSB3aWR0aCAtIDE2LCBYKSk7CiAgICAgICAgICBZID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oR2FtZS53aW5kb3dIIC0gaGVpZ2h0IC0gNjQsIFkpKTsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMub3JpZ2luID09ICJsZWZ0IikgewogICAgICAgICAgWCA9IEdhbWUubW91c2VYIC0gd2lkdGggLSAyNDsKICAgICAgICAgIFkgPSBHYW1lLm1vdXNlWSAtIGhlaWdodCAvIDIgLSA4OwogICAgICAgICAgWCA9IE1hdGgubWF4KDAsIE1hdGgubWluKEdhbWUud2luZG93VyAtIHdpZHRoIC0gMTYsIFgpKTsKICAgICAgICAgIFkgPSBNYXRoLm1heCgwLCBNYXRoLm1pbihHYW1lLndpbmRvd0ggLSBoZWlnaHQgLSA2NCwgWSkpOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy5vcmlnaW4gPT0gInRoaXMiICYmIHRoaXMuZnJvbSkgewogICAgICAgICAgdmFyIHJlY3QgPSB0aGlzLmZyb20uZ2V0Qm91bmRzKCk7CiAgICAgICAgICBYID0gKHJlY3QubGVmdCArIHJlY3QucmlnaHQpIC8gMiAtIHdpZHRoIC8gMiAtIDg7CiAgICAgICAgICBZID0gcmVjdC50b3AgLSB0aGlzLnR0LmNsaWVudEhlaWdodCAtIDQ4OwogICAgICAgICAgWCA9IE1hdGgubWF4KDAsIE1hdGgubWluKEdhbWUud2luZG93VyAtIHdpZHRoIC0gMTYsIFgpKTsKICAgICAgICAgIC8vWT1NYXRoLm1heCgwLE1hdGgubWluKEdhbWUud2luZG93SC10aGlzLnR0LmNsaWVudEhlaWdodC02NCxZKSk7CiAgICAgICAgICBpZiAoWSA8IDApIFkgPSByZWN0LmJvdHRvbSAtIDI0OwogICAgICAgICAgaWYgKFkgKyBoZWlnaHQgKyA0MCA+IEdhbWUud2luZG93SCkgewogICAgICAgICAgICBYID0gcmVjdC5yaWdodCArIDg7CiAgICAgICAgICAgIFkgPSByZWN0LnRvcCArIChyZWN0LmJvdHRvbSAtIHJlY3QudG9wKSAvIDIgLSBoZWlnaHQgLyAyIC0gMzg7CiAgICAgICAgICAgIFkgPSBNYXRoLm1heCgwLCBNYXRoLm1pbihHYW1lLndpbmRvd0ggLSBoZWlnaHQgLSAxOSwgWSkpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBYID0gR2FtZS5tb3VzZVggLSB3aWR0aCAvIDIgLSA4OwogICAgICAgICAgWSA9IEdhbWUubW91c2VZIC0gaGVpZ2h0IC0gMzI7CiAgICAgICAgICBYID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oR2FtZS53aW5kb3dXIC0gd2lkdGggLSAxNiwgWCkpOwogICAgICAgICAgWSA9IE1hdGgubWF4KDAsIE1hdGgubWluKEdhbWUud2luZG93SCAtIGhlaWdodCAtIDY0LCBZKSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMudHRhLnN0eWxlLmxlZnQgPSBYICsgInB4IjsKICAgICAgdGhpcy50dGEuc3R5bGUucmlnaHQgPSAiYXV0byI7CiAgICAgIHRoaXMudHRhLnN0eWxlLnRvcCA9IFkgKyAicHgiOwogICAgICB0aGlzLnR0YS5zdHlsZS5ib3R0b20gPSAiYXV0byI7CiAgICAgIGlmICh0aGlzLnNob3VsZEhpZGUpIHsKICAgICAgICB0aGlzLmhpZGUoKTsKICAgICAgICB0aGlzLnNob3VsZEhpZGUgPSAwOwogICAgICB9IGVsc2UgaWYgKEdhbWUuZHJhd1QgJSAxMCA9PSAwICYmIHR5cGVvZiB0aGlzLnRleHQgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICB2YXIgdGV4dCA9IHRoaXMudGV4dCgpOwogICAgICAgIGlmICh0ZXh0ID09ICIiKSB0aGlzLnR0YS5zdHlsZS5vcGFjaXR5ID0gIjAiOwogICAgICAgIGVsc2UgewogICAgICAgICAgdGhpcy50dC5pbm5lckhUTUwgPSB1bmVzY2FwZSh0ZXh0KTsKICAgICAgICAgIHRoaXMudHRhLnN0eWxlLm9wYWNpdHkgPSAiMSI7CiAgICAgICAgfQogICAgICB9CiAgICB9OwogICAgR2FtZS50b29sdGlwLmhpZGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICh0aGlzLnR0YSkgdGhpcy50dGEuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgdGhpcy5keW5hbWljID0gMDsKICAgICAgdGhpcy5vbiA9IDA7CiAgICB9OwogICAgR2FtZS5nZXRUb29sdGlwID0gZnVuY3Rpb24gKHRleHQsIG9yaWdpbiwgaXNDcmF0ZSkgewogICAgICBvcmlnaW4gPSBvcmlnaW4gPyBvcmlnaW4gOiAibWlkZGxlIjsKICAgICAgaWYgKGlzQ3JhdGUpCiAgICAgICAgcmV0dXJuICgKICAgICAgICAgICdvbk1vdXNlT3V0PSJHYW1lLnNldE9uQ3JhdGUoMCk7R2FtZS50b29sdGlwLnNob3VsZEhpZGU9MTsiIG9uTW91c2VPdmVyPSJpZiAoIUdhbWUubW91c2VEb3duKSB7R2FtZS5zZXRPbkNyYXRlKHRoaXMpO0dhbWUudG9vbHRpcC5keW5hbWljPTA7R2FtZS50b29sdGlwLmRyYXcodGhpcyxcJycgKwogICAgICAgICAgZXNjYXBlKHRleHQpICsKICAgICAgICAgICInLCciICsKICAgICAgICAgIG9yaWdpbiArCiAgICAgICAgICAiJyk7R2FtZS50b29sdGlwLndvYmJsZSgpO31cIiIKICAgICAgICApOwogICAgICBlbHNlCiAgICAgICAgcmV0dXJuICgKICAgICAgICAgICdvbk1vdXNlT3V0PSJHYW1lLnRvb2x0aXAuc2hvdWxkSGlkZT0xOyIgb25Nb3VzZU92ZXI9IkdhbWUudG9vbHRpcC5keW5hbWljPTA7R2FtZS50b29sdGlwLmRyYXcodGhpcyxcJycgKwogICAgICAgICAgZXNjYXBlKHRleHQpICsKICAgICAgICAgICInLCciICsKICAgICAgICAgIG9yaWdpbiArCiAgICAgICAgICAiJyk7R2FtZS50b29sdGlwLndvYmJsZSgpO1wiIgogICAgICAgICk7CiAgICB9OwogICAgR2FtZS5nZXREeW5hbWljVG9vbHRpcCA9IGZ1bmN0aW9uIChmdW5jLCBvcmlnaW4sIGlzQ3JhdGUpIHsKICAgICAgb3JpZ2luID0gb3JpZ2luID8gb3JpZ2luIDogIm1pZGRsZSI7CiAgICAgIGlmIChpc0NyYXRlKQogICAgICAgIHJldHVybiAoCiAgICAgICAgICAnb25Nb3VzZU91dD0iR2FtZS5zZXRPbkNyYXRlKDApO0dhbWUudG9vbHRpcC5zaG91bGRIaWRlPTE7IiBvbk1vdXNlT3Zlcj0iaWYgKCFHYW1lLm1vdXNlRG93bikge0dhbWUuc2V0T25DcmF0ZSh0aGlzKTtHYW1lLnRvb2x0aXAuZHluYW1pYz0xO0dhbWUudG9vbHRpcC5kcmF3KHRoaXMsJyArCiAgICAgICAgICAiZnVuY3Rpb24oKXtyZXR1cm4gIiArCiAgICAgICAgICBmdW5jICsKICAgICAgICAgICIoKTt9IiArCiAgICAgICAgICAiLCciICsKICAgICAgICAgIG9yaWdpbiArCiAgICAgICAgICAiJyk7R2FtZS50b29sdGlwLndvYmJsZSgpO31cIiIKICAgICAgICApOwogICAgICByZXR1cm4gKAogICAgICAgICdvbk1vdXNlT3V0PSJHYW1lLnRvb2x0aXAuc2hvdWxkSGlkZT0xOyIgb25Nb3VzZU92ZXI9IkdhbWUudG9vbHRpcC5keW5hbWljPTE7R2FtZS50b29sdGlwLmRyYXcodGhpcywnICsKICAgICAgICAiZnVuY3Rpb24oKXtyZXR1cm4gIiArCiAgICAgICAgZnVuYyArCiAgICAgICAgIigpO30iICsKICAgICAgICAiLCciICsKICAgICAgICBvcmlnaW4gKwogICAgICAgICInKTtHYW1lLnRvb2x0aXAud29iYmxlKCk7XCIiCiAgICAgICk7CiAgICB9OwogICAgR2FtZS5hdHRhY2hUb29sdGlwID0gZnVuY3Rpb24gKGVsLCBmdW5jLCBvcmlnaW4pIHsKICAgICAgaWYgKHR5cGVvZiBmdW5jID09PSAic3RyaW5nIikgewogICAgICAgIHZhciBzdHIgPSBmdW5jOwogICAgICAgIGZ1bmMgPSAoZnVuY3Rpb24gKHN0cikgewogICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIHN0cjsKICAgICAgICAgIH07CiAgICAgICAgfSkoc3RyKTsKICAgICAgfQogICAgICBvcmlnaW4gPSBvcmlnaW4gPyBvcmlnaW4gOiAibWlkZGxlIjsKICAgICAgQWRkRXZlbnQoCiAgICAgICAgZWwsCiAgICAgICAgIm1vdXNlb3ZlciIsCiAgICAgICAgKGZ1bmN0aW9uIChmdW5jLCBlbCwgb3JpZ2luKSB7CiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBHYW1lLnRvb2x0aXAuZHluYW1pYyA9IDE7CiAgICAgICAgICAgIEdhbWUudG9vbHRpcC5kcmF3KGVsLCBmdW5jLCBvcmlnaW4pOwogICAgICAgICAgfTsKICAgICAgICB9KShmdW5jLCBlbCwgb3JpZ2luKQogICAgICApOwogICAgICBBZGRFdmVudCgKICAgICAgICBlbCwKICAgICAgICAibW91c2VvdXQiLAogICAgICAgIChmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBHYW1lLnRvb2x0aXAuc2hvdWxkSGlkZSA9IDE7CiAgICAgICAgICB9OwogICAgICAgIH0pKCkKICAgICAgKTsKICAgIH07CiAgICBHYW1lLnRvb2x0aXAud29iYmxlID0gZnVuY3Rpb24gKCkgewogICAgICAvL2Rpc2FibGVkIGJlY2F1c2UgdGhpcyBlZmZlY3QgZG9lc24ndCBsb29rIGdvb2Qgd2l0aCB0aGUgc2xpZ2h0IHNsb3dkb3duIGl0IG1pZ2h0IG9yIG1pZ2h0IG5vdCBiZSBjYXVzaW5nLgogICAgICBpZiAoZmFsc2UpIHsKICAgICAgICB0aGlzLnR0LmNsYXNzTmFtZSA9ICJmcmFtZWQiOwogICAgICAgIHZvaWQgdGhpcy50dC5vZmZzZXRXaWR0aDsKICAgICAgICB0aGlzLnR0LmNsYXNzTmFtZSA9ICJmcmFtZWQgd29iYmxpbmciOwogICAgICB9CiAgICB9OwoKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJCVVQREFURSBDSEVDS0VSCgkJPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KICAgIEdhbWUuQ2hlY2tVcGRhdGVzID0gZnVuY3Rpb24gKCkgewogICAgICBpZiAoIUFwcCkgYWpheCgic2VydmVyLnBocD9xPWNoZWNrdXBkYXRlIiwgR2FtZS5DaGVja1VwZGF0ZXNSZXNwb25zZSk7CiAgICB9OwogICAgR2FtZS5DaGVja1VwZGF0ZXNSZXNwb25zZSA9IGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICB2YXIgciA9IHJlc3BvbnNlLnNwbGl0KCJ8Iik7CiAgICAgIHZhciBzdHIgPSAiIjsKICAgICAgaWYgKHJbMF0gPT0gImFsZXJ0IikgewogICAgICAgIGlmIChyWzFdKSBzdHIgPSByWzFdOwogICAgICB9IGVsc2UgaWYgKHBhcnNlRmxvYXQoclswXSkgPiBHYW1lLnZlcnNpb24pIHsKICAgICAgICBzdHIgPSAiPGI+IiArIGxvYygiTmV3IHZlcnNpb24gYXZhaWxhYmxlOiB2LiAlMSEiLCByWzBdKSArICI8L2I+IjsKICAgICAgICBpZiAoclsxXSkKICAgICAgICAgIHN0ciArPSAiPGJyPjxzbWFsbD4iICsgbG9jKCdVcGRhdGUgbm90ZTogIiUxIicsIHJbMV0pICsgIjwvc21hbGw+IjsKICAgICAgICBzdHIgKz0gIjxicj48Yj4iICsgbG9jKCJSZWZyZXNoIHRvIGdldCBpdCEiKSArICI8L2I+IjsKICAgICAgfQogICAgICBpZiAoc3RyICE9ICIiKSB7CiAgICAgICAgbCgiYWxlcnQiKS5pbm5lckhUTUwgPSBzdHI7CiAgICAgICAgbCgiYWxlcnQiKS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgfQogICAgfTsKCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCQlEQVRBIEdSQUJCRVIKCQk9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwoKICAgIEdhbWUuZXh0ZXJuYWxEYXRhTG9hZGVkID0gZmFsc2U7CgogICAgR2FtZS5ncmFuZG1hTmFtZXMgPSBbCiAgICAgICJHcmFubnkiLAogICAgICAiR3VzaGVyIiwKICAgICAgIkV0aGVsIiwKICAgICAgIkVkbmEiLAogICAgICAiRG9yaXMiLAogICAgICAiTWF1ZCIsCiAgICAgICJIaWxkYSIsCiAgICAgICJHbGFkeXMiLAogICAgICAiTWljaGVsbGUiLAogICAgICAiTWljaGVsZSIsCiAgICAgICJQaHlsbGlzIiwKICAgICAgIk1pbGxpY2VudCIsCiAgICAgICJNdXJpZWwiLAogICAgICAiTXlydGxlIiwKICAgICAgIk1pbGRyZWQiLAogICAgICAiTWF2aXMiLAogICAgICAiSGVsZW4iLAogICAgICAiR2xvcmlhIiwKICAgICAgIlNoZWlsYSIsCiAgICAgICJCZXR0eSIsCiAgICAgICJHZXJ0cnVkZSIsCiAgICAgICJBZ2F0aGEiLAogICAgICAiQmVyeWwiLAogICAgICAiQWduZXMiLAogICAgICAiUGVhcmwiLAogICAgICAiUHJlY2lvdXMiLAogICAgICAiUnVieSIsCiAgICAgICJWZXJhIiwKICAgICAgIkJvbm5pZSIsCiAgICAgICJBZGEiLAogICAgICAiQnVubnkiLAogICAgICAiQ29va2llIiwKICAgICAgIkRhcmxpbmciLAogICAgICAiR2FnYSIsCiAgICAgICJHYW1HYW0iLAogICAgICAiTWVtYXciLAogICAgICAiTWltc3kiLAogICAgICAiUGVhbnV0IiwKICAgICAgIk5hbmEiLAogICAgICAiTmFuIiwKICAgICAgIlRvb3RzaWUiLAogICAgICAiV2FydHkiLAogICAgICAiU3Rpbmt5IiwKICAgICAgIkhlaW5vdXMiLAogICAgXTsKICAgIEdhbWUuY3VzdG9tR3JhbmRtYU5hbWVzID0gW107CiAgICBHYW1lLmhlcmFsZHMgPSAwOwoKICAgIEdhbWUuR3JhYkRhdGEgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICghQXBwKSBhamF4KCIvcGF0cmVvbi9ncmFiLnBocCIsIEdhbWUuR3JhYkRhdGFSZXNwb25zZSk7CiAgICAgIGVsc2UKICAgICAgICBBcHAuZ3JhYkRhdGEoZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgR2FtZS5oZXJhbGRzID0gcmVzID8gcmVzLnBsYXllcnNOIHx8IDEgOiAxOwogICAgICAgICAgR2FtZS5oZXJhbGRzID0gTWF0aC5tYXgoCiAgICAgICAgICAgIDAsCiAgICAgICAgICAgIE1hdGgubWluKDEwMCwgTWF0aC5jZWlsKChHYW1lLmhlcmFsZHMgLyAxMDApICogMTAwKSAvIDEwMCkKICAgICAgICAgICk7CiAgICAgICAgICBsKCJoZXJhbGRzQW1vdW50IikudGV4dENvbnRlbnQgPSBNYXRoLmZsb29yKEdhbWUuaGVyYWxkcyk7CiAgICAgICAgfSk7CiAgICB9OwogICAgR2FtZS5HcmFiRGF0YVJlc3BvbnNlID0gZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgIC8qCgkJCQlyZXNwb25zZSBzaG91bGQgYmUgZm9ybWF0dGVkIGFzCgkJCQl7ImhlcmFsZCI6MywiZ3JhbmRtYSI6ImF8YnxjfC4uLn0KCQkJKi8KICAgICAgdmFyIHIgPSB7fTsKICAgICAgdHJ5IHsKICAgICAgICByID0gSlNPTi5wYXJzZShyZXNwb25zZSk7CiAgICAgICAgaWYgKHR5cGVvZiByWyJoZXJhbGQiXSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgIEdhbWUuaGVyYWxkcyA9IHBhcnNlSW50KHJbImhlcmFsZCJdKTsKICAgICAgICAgIEdhbWUuaGVyYWxkcyA9IE1hdGgubWF4KDAsIE1hdGgubWluKDEwMCwgR2FtZS5oZXJhbGRzKSk7CiAgICAgICAgfQogICAgICAgIGlmICh0eXBlb2YgclsiZ3JhbmRtYSJdICE9PSAidW5kZWZpbmVkIiAmJiByWyJncmFuZG1hIl0gIT0gIiIpIHsKICAgICAgICAgIEdhbWUuY3VzdG9tR3JhbmRtYU5hbWVzID0gclsiZ3JhbmRtYSJdLnNwbGl0KCJ8Iik7CiAgICAgICAgICBHYW1lLmN1c3RvbUdyYW5kbWFOYW1lcyA9IEdhbWUuY3VzdG9tR3JhbmRtYU5hbWVzLmZpbHRlcihmdW5jdGlvbiAoCiAgICAgICAgICAgIGVsCiAgICAgICAgICApIHsKICAgICAgICAgICAgcmV0dXJuIGVsICE9ICIiOwogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBsKCJoZXJhbGRzQW1vdW50IikudGV4dENvbnRlbnQgPSBNYXRoLmZsb29yKEdhbWUuaGVyYWxkcyk7CiAgICAgICAgR2FtZS5leHRlcm5hbERhdGFMb2FkZWQgPSB0cnVlOwogICAgICB9IGNhdGNoIChlKSB7fQogICAgfTsKCiAgICBpZiAoIUFwcCkgewogICAgICBHYW1lLmF0dGFjaFRvb2x0aXAoCiAgICAgICAgbCgiaHR0cHNTd2l0Y2giKSwKICAgICAgICAnPGRpdiBzdHlsZT0icGFkZGluZzo4cHg7d2lkdGg6MzUwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Zm9udC1zaXplOjExcHg7Ij4nICsKICAgICAgICAgIGxvYygKICAgICAgICAgICAgIllvdSBhcmUgY3VycmVudGx5IHBsYXlpbmcgQ29va2llIENsaWNrZXIgb24gdGhlIDxiPiUxPC9iPiBwcm90b2NvbC48YnI+VGhlIDxiPiUyPC9iPiB2ZXJzaW9uIHVzZXMgYSBkaWZmZXJlbnQgc2F2ZSBzbG90IHRoYW4gdGhpcyBvbmUuPGJyPkNsaWNrIHRoaXMgbG9jayB0byByZWxvYWQgdGhlIHBhZ2UgYW5kIHN3aXRjaCB0byB0aGUgPGI+JTI8L2I+IHZlcnNpb24hIiwKICAgICAgICAgICAgW0dhbWUuaHR0cHMgPyAiSFRUUFMiIDogIkhUVFAiLCBHYW1lLmh0dHBzID8gIkhUVFAiIDogIkhUVFBTIl0KICAgICAgICAgICkgKwogICAgICAgICAgIjwvZGl2PiIsCiAgICAgICAgInRoaXMiCiAgICAgICk7CiAgICAgIEFkZEV2ZW50KGwoImh0dHBzU3dpdGNoIiksICJjbGljayIsIGZ1bmN0aW9uICgpIHsKICAgICAgICBQbGF5U291bmQoInNuZC9wb3AiICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMyArIDEpICsgIi5tcDMiLCAwLjc1KTsKICAgICAgICBpZiAobG9jYXRpb24ucHJvdG9jb2wgPT0gImh0dHBzOiIpCiAgICAgICAgICBsb2NhdGlvbi5ocmVmID0KICAgICAgICAgICAgImh0dHA6IiArCiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmLnN1YnN0cmluZyh3aW5kb3cubG9jYXRpb24ucHJvdG9jb2wubGVuZ3RoKTsKICAgICAgICBlbHNlIGlmIChsb2NhdGlvbi5wcm90b2NvbCA9PSAiaHR0cDoiKQogICAgICAgICAgbG9jYXRpb24uaHJlZiA9CiAgICAgICAgICAgICJodHRwczoiICsKICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYuc3Vic3RyaW5nKHdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbC5sZW5ndGgpOwogICAgICB9KTsKCiAgICAgIEFkZEV2ZW50KGwoImNoYW5nZUxhbmd1YWdlIiksICJjbGljayIsIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLnNob3dMYW5nU2VsZWN0aW9uKCk7CiAgICAgIH0pOwoKICAgICAgR2FtZS5hdHRhY2hUb29sdGlwKAogICAgICAgIGwoInRvcGJhck9ydGVpbCIpLAogICAgICAgICc8ZGl2IHN0eWxlPSJwYWRkaW5nOjhweDt3aWR0aDoyNTBweDt0ZXh0LWFsaWduOmNlbnRlcjsiPkJhY2sgdG8gT3J0ZWlsXCdzIHN1YmRvbWFpbiE8YnI+TG90cyBvZiBvdGhlciBnYW1lcyBpbiB0aGVyZSE8L2Rpdj4nICsKICAgICAgICAgIHRpbnlJY29uKFsxNywgNV0sICJkaXNwbGF5OmJsb2NrO21hcmdpbjotMTJweCBhdXRvOyIpLAogICAgICAgICJ0aGlzIgogICAgICApOwogICAgICBHYW1lLmF0dGFjaFRvb2x0aXAoCiAgICAgICAgbCgidG9wYmFyRGFzaG5ldCIpLAogICAgICAgICc8ZGl2IHN0eWxlPSJwYWRkaW5nOjhweDt3aWR0aDoyNTBweDt0ZXh0LWFsaWduOmNlbnRlcjsiPkJhY2sgdG8gb3VyIGhvbWVwYWdlITwvZGl2PicsCiAgICAgICAgInRoaXMiCiAgICAgICk7CiAgICAgIEdhbWUuYXR0YWNoVG9vbHRpcCgKICAgICAgICBsKCJ0b3BiYXJUd2l0dGVyIiksCiAgICAgICAgJzxkaXYgc3R5bGU9InBhZGRpbmc6OHB4O3dpZHRoOjI1MHB4O3RleHQtYWxpZ246Y2VudGVyOyI+T3J0ZWlsXCdzIHR3aXR0ZXIsIHdoaWNoIGZyZXF1ZW50bHkgZmVhdHVyZXMgZ2FtZSB1cGRhdGVzLjwvZGl2PicsCiAgICAgICAgInRoaXMiCiAgICAgICk7CiAgICAgIEdhbWUuYXR0YWNoVG9vbHRpcCgKICAgICAgICBsKCJ0b3BiYXJUdW1ibHIiKSwKICAgICAgICAnPGRpdiBzdHlsZT0icGFkZGluZzo4cHg7d2lkdGg6MjUwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Ij5PcnRlaWxcJ3MgdHVtYmxyLCB3aGljaCBmcmVxdWVudGx5IGZlYXR1cmVzIGdhbWUgdXBkYXRlcy48L2Rpdj4nLAogICAgICAgICJ0aGlzIgogICAgICApOwogICAgICBHYW1lLmF0dGFjaFRvb2x0aXAoCiAgICAgICAgbCgidG9wYmFyRGlzY29yZCIpLAogICAgICAgICc8ZGl2IHN0eWxlPSJwYWRkaW5nOjhweDt3aWR0aDoyNTBweDt0ZXh0LWFsaWduOmNlbnRlcjsiPk91ciBvZmZpY2lhbCBkaXNjb3JkIHNlcnZlci48YnI+WW91IGNhbiBzaGFyZSB0aXBzIGFuZCBxdWVzdGlvbnMgYWJvdXQgQ29va2llIENsaWNrZXIgYW5kIGFsbCBvdXIgb3RoZXIgZ2FtZXMhPC9kaXY+JywKICAgICAgICAidGhpcyIKICAgICAgKTsKICAgICAgR2FtZS5hdHRhY2hUb29sdGlwKAogICAgICAgIGwoInRvcGJhclBhdHJlb24iKSwKICAgICAgICAnPGRpdiBzdHlsZT0icGFkZGluZzo4cHg7d2lkdGg6MjUwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Ij5TdXBwb3J0IHVzIG9uIFBhdHJlb24gYW5kIGhlbHAgdXMga2VlcCB1cGRhdGluZyBDb29raWUgQ2xpY2tlciE8YnI+VGhlcmVcJ3MgbmVhdCByZXdhcmRzIGZvciBwYXRyb25zIHRvbyE8L2Rpdj4nLAogICAgICAgICJ0aGlzIgogICAgICApOwogICAgICBHYW1lLmF0dGFjaFRvb2x0aXAoCiAgICAgICAgbCgidG9wYmFyTWVyY2giKSwKICAgICAgICAnPGRpdiBzdHlsZT0icGFkZGluZzo4cHg7d2lkdGg6MjUwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Ij5Db29raWUgQ2xpY2tlciBzaGlydHMsIGhvb2RpZXMgYW5kIHN0aWNrZXJzITwvZGl2PicsCiAgICAgICAgInRoaXMiCiAgICAgICk7CiAgICAgIEdhbWUuYXR0YWNoVG9vbHRpcCgKICAgICAgICBsKCJ0b3BiYXJNb2JpbGVDQyIpLAogICAgICAgICc8ZGl2IHN0eWxlPSJwYWRkaW5nOjhweDt3aWR0aDoyNTBweDt0ZXh0LWFsaWduOmNlbnRlcjsiPlBsYXkgQ29va2llIENsaWNrZXIgb24geW91ciBwaG9uZSE8YnI+KEFuZHJvaWQgb25seTsgaU9TIHZlcnNpb24gd2lsbCBiZSByZWxlYXNlZCBsYXRlcik8L2Rpdj4nLAogICAgICAgICJ0aGlzIgogICAgICApOwogICAgICBHYW1lLmF0dGFjaFRvb2x0aXAoCiAgICAgICAgbCgidG9wYmFyU3RlYW1DQyIpLAogICAgICAgICc8ZGl2IHN0eWxlPSJwYWRkaW5nOjhweDt3aWR0aDoyNTBweDt0ZXh0LWFsaWduOmNlbnRlcjsiPkdldCBDb29raWUgQ2xpY2tlciBvbiBTdGVhbSE8YnI+RmVhdHVyaW5nIG11c2ljIGJ5IEM0MTguPC9kaXY+JywKICAgICAgICAidGhpcyIKICAgICAgKTsKICAgICAgR2FtZS5hdHRhY2hUb29sdGlwKAogICAgICAgIGwoInRvcGJhclJhbmRvbWdlbiIpLAogICAgICAgICc8ZGl2IHN0eWxlPSJwYWRkaW5nOjhweDt3aWR0aDoyNTBweDt0ZXh0LWFsaWduOmNlbnRlcjsiPkEgdGhpbmcgd2UgbWFkZSB0aGF0IGxldHMgeW91IHdyaXRlIHJhbmRvbSBnZW5lcmF0b3JzLjwvZGl2PicsCiAgICAgICAgInRoaXMiCiAgICAgICk7CiAgICAgIEdhbWUuYXR0YWNoVG9vbHRpcCgKICAgICAgICBsKCJ0b3BiYXJJR00iKSwKICAgICAgICAnPGRpdiBzdHlsZT0icGFkZGluZzo4cHg7d2lkdGg6MjUwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Ij5BIHRoaW5nIHdlIG1hZGUgdGhhdCBsZXRzIHlvdSBjcmVhdGUgeW91ciBvd24gaWRsZSBnYW1lcyB1c2luZyBhIHNpbXBsZSBzY3JpcHRpbmcgbGFuZ3VhZ2UuPC9kaXY+JywKICAgICAgICAidGhpcyIKICAgICAgKTsKICAgICAgbCgiY2hhbmdlTGFuZ3VhZ2UiKS5pbm5lckhUTUwgPSBsb2MoIkNoYW5nZSBsYW5ndWFnZSIpOwogICAgICBsKCJsaW5rcyIpLmNoaWxkTm9kZXNbMF0ubm9kZVZhbHVlID0gbG9jKCJPdGhlciB2ZXJzaW9ucyIpOwogICAgICAvL2woJ2xpbmtWZXJzaW9uQmV0YScpLmlubmVySFRNTD1sb2MoIkJldGEiKTsKICAgIH0KCiAgICBHYW1lLmF0dGFjaFRvb2x0aXAoCiAgICAgIGwoImhlcmFsZHMiKSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBzdHIgPSAiIjsKCiAgICAgICAgaWYgKCFBcHAgJiYgIUdhbWUuZXh0ZXJuYWxEYXRhTG9hZGVkKQogICAgICAgICAgc3RyICs9IGxvYygKICAgICAgICAgICAgIkhlcmFsZHMgY291bGRuJ3QgYmUgbG9hZGVkLiBUaGVyZSBtYXkgYmUgYW4gaXNzdWUgd2l0aCBvdXIgc2VydmVycywgb3IgeW91IGFyZSBwbGF5aW5nIHRoZSBnYW1lIGxvY2FsbHkuIgogICAgICAgICAgKTsKICAgICAgICBlbHNlIHsKICAgICAgICAgIGlmICghQXBwICYmIEdhbWUuaGVyYWxkcyA9PSAwKQogICAgICAgICAgICBzdHIgKz0gbG9jKAogICAgICAgICAgICAgICdUaGVyZSBhcmUgbm8gaGVyYWxkcyBhdCB0aGUgbW9tZW50LiBQbGVhc2UgY29uc2lkZXIgPGIgc3R5bGU9ImNvbG9yOiNiYzNhZmY7Ij5kb25hdGluZyB0byBvdXIgUGF0cmVvbjwvYj4hJwogICAgICAgICAgICApOwogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHN0ciArPQogICAgICAgICAgICAgICc8YiBzdHlsZT0iY29sb3I6I2JjM2FmZjt0ZXh0LXNoYWRvdzowcHggMXB4IDBweCAjNmQwMDk2OyI+JyArCiAgICAgICAgICAgICAgbG9jKCIlMSBoZXJhbGQiLCBHYW1lLmhlcmFsZHMpICsKICAgICAgICAgICAgICAiPC9iPiAiICsKICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAic2VsZmxlc3NseSBpbnNwaXJpbmcgYSBib29zdCBpbiBwcm9kdWN0aW9uIGZvciBldmVyeW9uZSwgcmVzdWx0aW5nIGluICUxLiIsCiAgICAgICAgICAgICAgICAnPGJyPjxiIHN0eWxlPSJjb2xvcjojY2RhYTg5O3RleHQtc2hhZG93OjBweCAxcHggMHB4ICM3YzQ1MzIsMHB4IDBweCA2cHggIzdjNDUzMjsiPjxkaXYgc3R5bGU9IndpZHRoOjE2cHg7aGVpZ2h0OjE2cHg7ZGlzcGxheTppbmxpbmUtYmxvY2s7dmVydGljYWwtYWxpZ246bWlkZGxlO2JhY2tncm91bmQ6dXJsKGltZy9tb25leS5wbmcpOyI+PC9kaXY+JyArCiAgICAgICAgICAgICAgICAgIGxvYygiKyUxJSBjb29raWVzIHBlciBzZWNvbmQiLCBHYW1lLmhlcmFsZHMpICsKICAgICAgICAgICAgICAgICAgIjwvYj4iCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgc3RyICs9ICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nOwogICAgICAgICAgICBpZiAoR2FtZS5hc2NlbnNpb25Nb2RlID09IDEpCiAgICAgICAgICAgICAgc3RyICs9IGxvYygKICAgICAgICAgICAgICAgICJZb3UgYXJlIGluIGEgPGI+Qm9ybiBhZ2FpbjwvYj4gcnVuLCBhbmQgYXJlIG5vdCBjdXJyZW50bHkgYmVuZWZpdGluZyBmcm9tIGhlcmFsZHMuIgogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGVsc2UgaWYgKEdhbWUuSGFzKCJIZXJhbGRzIikpCiAgICAgICAgICAgICAgc3RyICs9IGxvYygKICAgICAgICAgICAgICAgICJZb3Ugb3duIHRoZSA8Yj5IZXJhbGRzPC9iPiB1cGdyYWRlLCBhbmQgdGhlcmVmb3JlIGJlbmVmaXQgZnJvbSB0aGUgcHJvZHVjdGlvbiBib29zdC4iCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgIHN0ciArPSBsb2MoCiAgICAgICAgICAgICAgICAiVG8gYmVuZWZpdCBmcm9tIHRoZSBoZXJhbGQgYm9udXMsIHlvdSBuZWVkIGEgc3BlY2lhbCB1cGdyYWRlIHlvdSBkbyBub3QgeWV0IG93bi4gWW91IHdpbGwgcGVybWFuZW50bHkgdW5sb2NrIGl0IGxhdGVyIGluIHRoZSBnYW1lLiIKICAgICAgICAgICAgICApOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBzdHIgKz0KICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj48c3BhbiBzdHlsZT0iZm9udC1zaXplOjkwJTtvcGFjaXR5OjAuNjsiPicgKwogICAgICAgICAgKCFBcHAKICAgICAgICAgICAgPyBsb2MoCiAgICAgICAgICAgICAgICAiPGI+SGVyYWxkczwvYj4gYXJlIHBlb3BsZSB3aG8gaGF2ZSBkb25hdGVkIHRvIG91ciBoaWdoZXN0IFBhdHJlb24gdGllciwgYW5kIGFyZSBsaW1pdGVkIHRvIDEwMC48YnI+RWFjaCBoZXJhbGQgZ2l2ZXMgZXZlcnlvbmUgKzElIENwUy48YnI+SGVyYWxkcyBiZW5lZml0IGV2ZXJ5b25lIHBsYXlpbmcgdGhlIGdhbWUsIHJlZ2FyZGxlc3Mgb2Ygd2hldGhlciB5b3UgZG9uYXRlZC4iCiAgICAgICAgICAgICAgKQogICAgICAgICAgICA6IGxvYygKICAgICAgICAgICAgICAgICJFdmVyeSAlMSBjdXJyZW50IHBsYXllcnMgb24gU3RlYW0gZ2VuZXJhdGVzIDxiPjEgaGVyYWxkPC9iPiwgdXAgdG8gJTIgaGVyYWxkcy48YnI+RWFjaCBoZXJhbGQgZ2l2ZXMgZXZlcnlvbmUgKzElIENwUy4iLAogICAgICAgICAgICAgICAgWzEwMCwgMTAwXQogICAgICAgICAgICAgICkpICsKICAgICAgICAgICc8L3NwYW4+PGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgICB0aW55SWNvbihbMjEsIDI5XSk7CgogICAgICAgIHN0ciArPQogICAgICAgICAgJzxkaXYgc3R5bGU9IndpZHRoOjMxcHg7aGVpZ2h0OjM5cHg7YmFja2dyb3VuZDp1cmwoaW1nL2hlcmFsZEZsYWcucG5nKTtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MHB4O2xlZnQ6OHB4OyI+PC9kaXY+PGRpdiBzdHlsZT0id2lkdGg6MzFweDtoZWlnaHQ6MzlweDtiYWNrZ3JvdW5kOnVybChpbWcvaGVyYWxkRmxhZy5wbmcpO3Bvc2l0aW9uOmFic29sdXRlO3RvcDowcHg7cmlnaHQ6OHB4OyI+PC9kaXY+JzsKCiAgICAgICAgcmV0dXJuICgKICAgICAgICAgICc8ZGl2IHN0eWxlPSJwYWRkaW5nOjhweDt3aWR0aDozMDBweDt0ZXh0LWFsaWduOmNlbnRlcjsiIGNsYXNzPSJwcm9tcHQiIGlkPSJ0b29sdGlwSGVyYWxkcyI+PGgzPicgKwogICAgICAgICAgbG9jKCJIZXJhbGRzIikgKwogICAgICAgICAgJzwvaDM+PGRpdiBjbGFzcz0iYmxvY2siPicgKwogICAgICAgICAgc3RyICsKICAgICAgICAgICI8L2Rpdj48L2Rpdj4iCiAgICAgICAgKTsKICAgICAgfSwKICAgICAgInRoaXMiCiAgICApOwogICAgbCgiaGVyYWxkc0Ftb3VudCIpLnRleHRDb250ZW50ID0gIj8iOwogICAgbCgiaGVyYWxkcyIpLnN0eWxlLmRpc3BsYXkgPSAiaW5saW5lLWJsb2NrIjsKICAgIGlmIChBcHApIHsKICAgICAgbCgiaGVyYWxkcyIpLnN0eWxlLnBhZGRpbmdUb3AgPSAiNHB4IjsKICAgICAgbCgiaGVyYWxkcyIpLnN0eWxlLnBvc2l0aW9uID0gImFic29sdXRlIjsKICAgICAgbCgiaGVyYWxkcyIpLnN0eWxlLnRvcCA9ICIwcHgiOwogICAgICBsKCJoZXJhbGRzIikuc3R5bGUucmlnaHQgPSAiMHB4IjsKICAgICAgbCgiaGVyYWxkcyIpLnN0eWxlLndpZHRoID0gIjI4cHgiOwogICAgICBsKCJoZXJhbGRzIikuc3R5bGUudGV4dEFsaWduID0gImNlbnRlciI7CiAgICAgIGwoImxlZnRCZWFtIikuYXBwZW5kQ2hpbGQobCgiaGVyYWxkcyIpKTsKCiAgICAgIGwoImJ1ZmZzIikuc3R5bGUudG9wID0gIjE2cHgiOwogICAgfQoKICAgIEdhbWUuR3JhYkRhdGEoKTsKCiAgICBHYW1lLnVzZUxvY2FsU3RvcmFnZSA9IDE7CiAgICAvL3dpbmRvdy5sb2NhbFN0b3JhZ2UuY2xlYXIoKTsvL3dvbid0IHN3aXRjaCBiYWNrIHRvIGNvb2tpZS1iYXNlZCBpZiB0aGVyZSBpcyBsb2NhbFN0b3JhZ2UgaW5mbwoKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJCVNBVkUKCQk9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgR2FtZS5FeHBvcnRTYXZlID0gZnVuY3Rpb24gKCkgewogICAgICAvL2lmIChBcHApIHJldHVybiBmYWxzZTsKICAgICAgR2FtZS5wcmVmcy5zaG93QmFja3VwV2FybmluZyA9IDA7CiAgICAgIEdhbWUuUHJvbXB0KAogICAgICAgICI8aWQgRXhwb3J0U2F2ZT48aDM+IiArCiAgICAgICAgICBsb2MoIkV4cG9ydCBzYXZlIikgKwogICAgICAgICAgJzwvaDM+PGRpdiBjbGFzcz0iYmxvY2siPicgKwogICAgICAgICAgbG9jKAogICAgICAgICAgICAiVGhpcyBpcyB5b3VyIHNhdmUgY29kZS48YnI+Q29weSBpdCBhbmQga2VlcCBpdCBzb21ld2hlcmUgc2FmZSEiCiAgICAgICAgICApICsKICAgICAgICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJibG9jayI+PHRleHRhcmVhIGlkPSJ0ZXh0YXJlYVByb21wdCIgc3R5bGU9IndpZHRoOjEwMCU7aGVpZ2h0OjEyOHB4OyIgcmVhZG9ubHk+JyArCiAgICAgICAgICBHYW1lLldyaXRlU2F2ZSgxKSArCiAgICAgICAgICAiPC90ZXh0YXJlYT48L2Rpdj4iLAogICAgICAgIFtsb2MoIkFsbCBkb25lISIpXQogICAgICApOyAvL3Byb21wdCgnQ29weSB0aGlzIHRleHQgYW5kIGtlZXAgaXQgc29tZXdoZXJlIHNhZmUhJyxHYW1lLldyaXRlU2F2ZSgxKSk7CiAgICAgIGwoInRleHRhcmVhUHJvbXB0IikuZm9jdXMoKTsKICAgICAgbCgidGV4dGFyZWFQcm9tcHQiKS5zZWxlY3QoKTsKICAgIH07CiAgICBHYW1lLkltcG9ydFNhdmUgPSBmdW5jdGlvbiAoZGVmKSB7CiAgICAgIC8vaWYgKEFwcCkgcmV0dXJuIGZhbHNlOwogICAgICBHYW1lLlByb21wdCgKICAgICAgICAiPGlkIEltcG9ydFNhdmU+PGgzPiIgKwogICAgICAgICAgbG9jKCJJbXBvcnQgc2F2ZSIpICsKICAgICAgICAgICc8L2gzPjxkaXYgY2xhc3M9ImJsb2NrIj4nICsKICAgICAgICAgIGxvYygKICAgICAgICAgICAgIlBsZWFzZSBwYXN0ZSBpbiB0aGUgY29kZSB0aGF0IHdhcyBnaXZlbiB0byB5b3Ugb24gc2F2ZSBleHBvcnQuIgogICAgICAgICAgKSArCiAgICAgICAgICAnPGRpdiBpZD0iaW1wb3J0RXJyb3IiIGNsYXNzPSJ3YXJuaW5nIiBzdHlsZT0iZm9udC13ZWlnaHQ6Ym9sZDtmb250LXNpemU6MTFweDsiPjwvZGl2PjwvZGl2PjxkaXYgY2xhc3M9ImJsb2NrIj48dGV4dGFyZWEgaWQ9InRleHRhcmVhUHJvbXB0IiBzdHlsZT0id2lkdGg6MTAwJTtoZWlnaHQ6MTI4cHg7Ij4nICsKICAgICAgICAgIChkZWYgfHwgIiIpICsKICAgICAgICAgICI8L3RleHRhcmVhPjwvZGl2PiIsCiAgICAgICAgWwogICAgICAgICAgWwogICAgICAgICAgICBsb2MoIkxvYWQiKSwKICAgICAgICAgICAgImlmIChsKCd0ZXh0YXJlYVByb21wdCcpLnZhbHVlLmxlbmd0aD09MCl7cmV0dXJuIGZhbHNlO31pZiAoR2FtZS5JbXBvcnRTYXZlQ29kZShsKCd0ZXh0YXJlYVByb21wdCcpLnZhbHVlKSl7R2FtZS5DbG9zZVByb21wdCgpO31lbHNle2woJ2ltcG9ydEVycm9yJykuaW5uZXJIVE1MPScoJytsb2MoXCJFcnJvciBpbXBvcnRpbmcgc2F2ZVwiKSsnKSc7fSIsCiAgICAgICAgICBdLAogICAgICAgICAgbG9jKCJOZXZlcm1pbmQiKSwKICAgICAgICBdCiAgICAgICk7IC8vcHJvbXB0KCdQbGVhc2UgcGFzdGUgaW4gdGhlIHRleHQgdGhhdCB3YXMgZ2l2ZW4gdG8geW91IG9uIHNhdmUgZXhwb3J0LicsJycpOwogICAgICBsKCJ0ZXh0YXJlYVByb21wdCIpLmZvY3VzKCk7CiAgICB9OwogICAgR2FtZS5JbXBvcnRTYXZlQ29kZSA9IGZ1bmN0aW9uIChzYXZlKSB7CiAgICAgIHZhciBvdXQgPSBmYWxzZTsKICAgICAgaWYgKHNhdmUgJiYgc2F2ZSAhPSAiIikgb3V0ID0gR2FtZS5Mb2FkU2F2ZShzYXZlKTsKICAgICAgaWYgKG91dCAmJiBBcHAgJiYgQXBwLm9uSW1wb3J0U2F2ZSkgQXBwLm9uSW1wb3J0U2F2ZShvdXQsIHNhdmUpOwogICAgICByZXR1cm4gb3V0OwogICAgfTsKCiAgICBHYW1lLkZpbGVTYXZlID0gZnVuY3Rpb24gKCkgewogICAgICBpZiAoQXBwKSByZXR1cm4gZmFsc2U7CiAgICAgIEdhbWUucHJlZnMuc2hvd0JhY2t1cFdhcm5pbmcgPSAwOwogICAgICB2YXIgZmlsZW5hbWUgPSBHYW1lLmJha2VyeU5hbWUucmVwbGFjZSgvW15hLXpBLVowLTldKy9nLCAiIikgKyAiQmFrZXJ5IjsKICAgICAgdmFyIHRleHQgPSBHYW1lLldyaXRlU2F2ZSgxKTsKICAgICAgdmFyIGJsb2IgPSBuZXcgQmxvYihbdGV4dF0sIHsgdHlwZTogInRleHQvcGxhaW47Y2hhcnNldD11dGYtOCIgfSk7CiAgICAgIHNhdmVBcyhibG9iLCBmaWxlbmFtZSArICIudHh0Iik7CiAgICB9OwogICAgR2FtZS5GaWxlTG9hZCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIGlmIChBcHApIHJldHVybiBmYWxzZTsKICAgICAgaWYgKGUudGFyZ2V0LmZpbGVzLmxlbmd0aCA9PSAwKSByZXR1cm4gZmFsc2U7CiAgICAgIHZhciBmaWxlID0gZS50YXJnZXQuZmlsZXNbMF07CiAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwogICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICBHYW1lLkltcG9ydFNhdmVDb2RlKGUudGFyZ2V0LnJlc3VsdCk7CiAgICAgIH07CiAgICAgIHJlYWRlci5yZWFkQXNUZXh0KGZpbGUpOwogICAgfTsKCiAgICBHYW1lLnRvUmVsb2FkID0gZmFsc2U7CiAgICBHYW1lLnRvU2F2ZSA9IGZhbHNlOwogICAgR2FtZS50b1F1aXQgPSBmYWxzZTsKICAgIEdhbWUuaXNTYXZpbmcgPSBmYWxzZTsgLy90cnVlIHdoaWxlIHdlJ3JlIHNhdmluZywgdG8gYmxvY2sgc29tZSBiZWhhdmlvcjsgd2hlbiBpbiBBcHAgbW9kZSBzYXZpbmcgbWF5IGJlIGFzeW5jaHJvbm91cwogICAgR2FtZS5sYXN0U2F2ZURhdGEgPSAiIjsKICAgIEdhbWUuV3JpdGVTYXZlID0gZnVuY3Rpb24gKHR5cGUpIHsKICAgICAgR2FtZS50b1NhdmUgPSBmYWxzZTsKICAgICAgLy90eXBlOiBub25lIGlzIGRlZmF1bHQsIDE9cmV0dXJuIHN0cmluZyBvbmx5LCAyPXJldHVybiB1bmNvbXByZXNzZWQgc3RyaW5nLCAzPXJldHVybiB1bmNvbXByZXNzZWQsIGNvbW1lbnRlZCBzdHJpbmcKICAgICAgR2FtZS5sYXN0RGF0ZSA9IHBhcnNlSW50KEdhbWUudGltZSk7CiAgICAgIHZhciBzdHIgPSAiIjsKICAgICAgaWYgKHR5cGUgPT0gMykgc3RyICs9ICJcbkdhbWUgdmVyc2lvblxuIjsKICAgICAgc3RyICs9IEdhbWUudmVyc2lvbiArICJ8IjsKICAgICAgc3RyICs9ICJ8IjsgLy9qdXN0IGluIGNhc2Ugd2UgbmVlZCBzb21lIG1vcmUgc3R1ZmYgaGVyZQogICAgICBpZiAodHlwZSA9PSAzKSBzdHIgKz0gIlxuXG5SdW4gZGV0YWlscyI7CiAgICAgIHN0ciArPSAvL3NhdmUgc3RhdHMKICAgICAgICAodHlwZSA9PSAzID8gIlxuCXJ1biBzdGFydCBkYXRlIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VJbnQoR2FtZS5zdGFydERhdGUpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JbGVnYWN5IHN0YXJ0IGRhdGUgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChHYW1lLmZ1bGxEYXRlKSArCiAgICAgICAgIjsiICsKICAgICAgICAodHlwZSA9PSAzID8gIlxuCWRhdGUgd2hlbiB3ZSBsYXN0IG9wZW5lZCB0aGUgZ2FtZSA6ICIgOiAiIikgKwogICAgICAgIHBhcnNlSW50KEdhbWUubGFzdERhdGUpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JYmFrZXJ5IG5hbWUgOiAiIDogIiIpICsKICAgICAgICBHYW1lLmJha2VyeU5hbWUgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbglzZWVkIDogIiA6ICIiKSArCiAgICAgICAgR2FtZS5zZWVkICsKICAgICAgICAifCI7CiAgICAgIGlmICh0eXBlID09IDMpIHN0ciArPSAiXG5cblBhY2tlZCBwcmVmZXJlbmNlcyBiaXRmaWVsZFxuCSI7CiAgICAgIHZhciBzdHIyID0gLy9wcmVmcwogICAgICAgIChHYW1lLnByZWZzLnBhcnRpY2xlcyA/ICIxIiA6ICIwIikgKwogICAgICAgIChHYW1lLnByZWZzLm51bWJlcnMgPyAiMSIgOiAiMCIpICsKICAgICAgICAoR2FtZS5wcmVmcy5hdXRvc2F2ZSA/ICIxIiA6ICIwIikgKwogICAgICAgIChHYW1lLnByZWZzLmF1dG91cGRhdGUgPyAiMSIgOiAiMCIpICsKICAgICAgICAoR2FtZS5wcmVmcy5taWxrID8gIjEiIDogIjAiKSArCiAgICAgICAgKEdhbWUucHJlZnMuZmFuY3kgPyAiMSIgOiAiMCIpICsKICAgICAgICAoR2FtZS5wcmVmcy53YXJuID8gIjEiIDogIjAiKSArCiAgICAgICAgKEdhbWUucHJlZnMuY3Vyc29ycyA/ICIxIiA6ICIwIikgKwogICAgICAgIChHYW1lLnByZWZzLmZvY3VzID8gIjEiIDogIjAiKSArCiAgICAgICAgKEdhbWUucHJlZnMuZm9ybWF0ID8gIjEiIDogIjAiKSArCiAgICAgICAgKEdhbWUucHJlZnMubm90aWZzID8gIjEiIDogIjAiKSArCiAgICAgICAgKEdhbWUucHJlZnMud29iYmx5ID8gIjEiIDogIjAiKSArCiAgICAgICAgKEdhbWUucHJlZnMubW9ub3NwYWNlID8gIjEiIDogIjAiKSArCiAgICAgICAgKEdhbWUucHJlZnMuZmlsdGVycyA/ICIxIiA6ICIwIikgKwogICAgICAgIChHYW1lLnByZWZzLmNvb2tpZXNvdW5kID8gIjEiIDogIjAiKSArCiAgICAgICAgKEdhbWUucHJlZnMuY3JhdGVzID8gIjEiIDogIjAiKSArCiAgICAgICAgKEdhbWUucHJlZnMuc2hvd0JhY2t1cFdhcm5pbmcgPyAiMSIgOiAiMCIpICsKICAgICAgICAoR2FtZS5wcmVmcy5leHRyYUJ1dHRvbnMgPyAiMSIgOiAiMCIpICsKICAgICAgICAoR2FtZS5wcmVmcy5hc2tMdW1wcyA/ICIxIiA6ICIwIikgKwogICAgICAgIChHYW1lLnByZWZzLmN1c3RvbUdyYW5kbWFzID8gIjEiIDogIjAiKSArCiAgICAgICAgKEdhbWUucHJlZnMudGltZW91dCA/ICIxIiA6ICIwIikgKwogICAgICAgIChHYW1lLnByZWZzLmNsb3VkU2F2ZSA/ICIxIiA6ICIwIikgKwogICAgICAgIChHYW1lLnByZWZzLmJnTXVzaWMgPyAiMSIgOiAiMCIpICsKICAgICAgICAoR2FtZS5wcmVmcy5ub3RTY2FyeSA/ICIxIiA6ICIwIikgKwogICAgICAgIChHYW1lLnByZWZzLmZ1bGxzY3JlZW4gPyAiMSIgOiAiMCIpICsKICAgICAgICAoR2FtZS5wcmVmcy5zY3JlZW5yZWFkZXIgPyAiMSIgOiAiMCIpICsKICAgICAgICAoR2FtZS5wcmVmcy5kaXNjb3JkUHJlc2VuY2UgPyAiMSIgOiAiMCIpICsKICAgICAgICAiIjsKICAgICAgc3RyMiA9IHBhY2szKHN0cjIpOwogICAgICBzdHIgKz0gc3RyMiArICJ8IjsKICAgICAgaWYgKHR5cGUgPT0gMykgc3RyICs9ICJcblxuTWlzYyBnYW1lIGRhdGEiOwogICAgICBzdHIgKz0KICAgICAgICAodHlwZSA9PSAzID8gIlxuCWNvb2tpZXMgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUZsb2F0KEdhbWUuY29va2llcykudG9TdHJpbmcoKSArCiAgICAgICAgIjsiICsKICAgICAgICAodHlwZSA9PSAzID8gIlxuCXRvdGFsIGNvb2tpZXMgZWFybmVkIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VGbG9hdChHYW1lLmNvb2tpZXNFYXJuZWQpLnRvU3RyaW5nKCkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgljb29raWUgY2xpY2tzIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLmNvb2tpZUNsaWNrcykpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JZ29sZGVuIGNvb2tpZSBjbGlja3MgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKEdhbWUuZ29sZGVuQ2xpY2tzKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgljb29raWVzIG1hZGUgYnkgY2xpY2tpbmcgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUZsb2F0KEdhbWUuaGFuZG1hZGVDb29raWVzKS50b1N0cmluZygpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JZ29sZGVuIGNvb2tpZXMgbWlzc2VkIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLm1pc3NlZEdvbGRlbkNsaWNrcykpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JYmFja2dyb3VuZCB0eXBlIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLmJnVHlwZSkpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JbWlsayB0eXBlIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLm1pbGtUeXBlKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgljb29raWVzIGZyb20gcGFzdCBydW5zIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VGbG9hdChHYW1lLmNvb2tpZXNSZXNldCkudG9TdHJpbmcoKSArCiAgICAgICAgIjsiICsKICAgICAgICAodHlwZSA9PSAzID8gIlxuCWVsZGVyIHdyYXRoIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLmVsZGVyV3JhdGgpKSArCiAgICAgICAgIjsiICsKICAgICAgICAodHlwZSA9PSAzID8gIlxuCXBsZWRnZXMgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKEdhbWUucGxlZGdlcykpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JcGxlZGdlIHRpbWUgbGVmdCA6ICIgOiAiIikgKwogICAgICAgIHBhcnNlSW50KE1hdGguZmxvb3IoR2FtZS5wbGVkZ2VUKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgljdXJyZW50bHkgcmVzZWFyY2hpbmcgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKEdhbWUubmV4dFJlc2VhcmNoKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbglyZXNlYXJjaCB0aW1lIGxlZnQgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKEdhbWUucmVzZWFyY2hUKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbglhc2NlbnNpb25zIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLnJlc2V0cykpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JZ29sZGVuIGNvb2tpZSBjbGlja3MgKHRoaXMgcnVuKSA6ICIgOiAiIikgKwogICAgICAgIHBhcnNlSW50KE1hdGguZmxvb3IoR2FtZS5nb2xkZW5DbGlja3NMb2NhbCkpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JY29va2llcyBzdWNrZWQgYnkgd3JpbmtsZXJzIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VGbG9hdChHYW1lLmNvb2tpZXNTdWNrZWQpLnRvU3RyaW5nKCkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgl3cmlua2xlcyBwb3BwZWQgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKEdhbWUud3JpbmtsZXJzUG9wcGVkKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbglzYW50YSBsZXZlbCA6ICIgOiAiIikgKwogICAgICAgIHBhcnNlSW50KE1hdGguZmxvb3IoR2FtZS5zYW50YUxldmVsKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbglyZWluZGVlciBjbGlja2VkIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLnJlaW5kZWVyQ2xpY2tlZCkpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4Jc2Vhc29uIHRpbWUgbGVmdCA6ICIgOiAiIikgKwogICAgICAgIHBhcnNlSW50KE1hdGguZmxvb3IoR2FtZS5zZWFzb25UKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbglzZWFzb24gc3dpdGNoZXIgdXNlcyA6ICIgOiAiIikgKwogICAgICAgIHBhcnNlSW50KE1hdGguZmxvb3IoR2FtZS5zZWFzb25Vc2VzKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgljdXJyZW50IHNlYXNvbiA6ICIgOiAiIikgKwogICAgICAgIChHYW1lLnNlYXNvbiA/IEdhbWUuc2Vhc29uIDogIiIpICsKICAgICAgICAiOyI7CiAgICAgIHZhciB3cmlua2xlcnMgPSBHYW1lLlNhdmVXcmlua2xlcnMoKTsKICAgICAgc3RyICs9CiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbglhbW91bnQgb2YgY29va2llcyBjb250YWluZWQgaW4gd3JpbmtsZXJzIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VGbG9hdChNYXRoLmZsb29yKHdyaW5rbGVycy5hbW91bnQpKSArCiAgICAgICAgIjsiICsKICAgICAgICAodHlwZSA9PSAzID8gIlxuCW51bWJlciBvZiB3cmlua2xlcnMgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKHdyaW5rbGVycy5udW1iZXIpKSArCiAgICAgICAgIjsiICsKICAgICAgICAodHlwZSA9PSAzID8gIlxuCXByZXN0aWdlIGxldmVsIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VGbG9hdChHYW1lLnByZXN0aWdlKS50b1N0cmluZygpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JaGVhdmVubHkgY2hpcHMgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUZsb2F0KEdhbWUuaGVhdmVubHlDaGlwcykudG9TdHJpbmcoKSArCiAgICAgICAgIjsiICsKICAgICAgICAodHlwZSA9PSAzID8gIlxuCWhlYXZlbmx5IGNoaXBzIHNwZW50IDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VGbG9hdChHYW1lLmhlYXZlbmx5Q2hpcHNTcGVudCkudG9TdHJpbmcoKSArCiAgICAgICAgIjsiICsKICAgICAgICAodHlwZSA9PSAzID8gIlxuCWhlYXZlbmx5IGNvb2tpZXMgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUZsb2F0KEdhbWUuaGVhdmVubHlDb29raWVzKS50b1N0cmluZygpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JYXNjZW5zaW9uIG1vZGUgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKEdhbWUuYXNjZW5zaW9uTW9kZSkpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JcGVybWFuZW50IHVwZ3JhZGVzIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLnBlcm1hbmVudFVwZ3JhZGVzWzBdKSkgKwogICAgICAgICI7IiArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLnBlcm1hbmVudFVwZ3JhZGVzWzFdKSkgKwogICAgICAgICI7IiArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLnBlcm1hbmVudFVwZ3JhZGVzWzJdKSkgKwogICAgICAgICI7IiArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLnBlcm1hbmVudFVwZ3JhZGVzWzNdKSkgKwogICAgICAgICI7IiArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLnBlcm1hbmVudFVwZ3JhZGVzWzRdKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbglkcmFnb24gbGV2ZWwgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKEdhbWUuZHJhZ29uTGV2ZWwpKSArCiAgICAgICAgIjsiICsKICAgICAgICAodHlwZSA9PSAzID8gIlxuCWRyYWdvbiBhdXJhIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcihHYW1lLmRyYWdvbkF1cmEpKSArCiAgICAgICAgIjsiICsKICAgICAgICAodHlwZSA9PSAzID8gIlxuCWRyYWdvbiBhdXJhIDIgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKEdhbWUuZHJhZ29uQXVyYTIpKSArCiAgICAgICAgIjsiICsKICAgICAgICAodHlwZSA9PSAzID8gIlxuCWNoaW1lIHR5cGUgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKEdhbWUuY2hpbWVUeXBlKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgl2b2x1bWUgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKEdhbWUudm9sdW1lKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgludW1iZXIgb2Ygc2hpbnkgd3JpbmtsZXJzIDogIiA6ICIiKSArCiAgICAgICAgcGFyc2VJbnQoTWF0aC5mbG9vcih3cmlua2xlcnMuc2hpbmllcykpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMKICAgICAgICAgID8gIlxuCWFtb3VudCBvZiBjb29raWVzIGNvbnRhaW5lZCBpbiBzaGlueSB3cmlua2xlcnMgOiAiCiAgICAgICAgICA6ICIiKSArCiAgICAgICAgcGFyc2VGbG9hdChNYXRoLmZsb29yKHdyaW5rbGVycy5hbW91bnRTaGluaWVzKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgljdXJyZW50IGFtb3VudCBvZiBzdWdhciBsdW1wcyA6ICIgOiAiIikgKwogICAgICAgIHBhcnNlRmxvYXQoTWF0aC5mbG9vcihHYW1lLmx1bXBzKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgl0b3RhbCBhbW91bnQgb2Ygc3VnYXIgbHVtcHMgbWFkZSA6ICIgOiAiIikgKwogICAgICAgIHBhcnNlRmxvYXQoTWF0aC5mbG9vcihHYW1lLmx1bXBzVG90YWwpKSArCiAgICAgICAgIjsiICsKICAgICAgICAodHlwZSA9PSAzID8gIlxuCXRpbWUgd2hlbiBjdXJyZW50IHN1Z2FyIGx1bXAgc3RhcnRlZCA6ICIgOiAiIikgKwogICAgICAgIHBhcnNlRmxvYXQoTWF0aC5mbG9vcihHYW1lLmx1bXBUKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMwogICAgICAgICAgPyAiXG4JdGltZSB3aGVuIGxhc3QgcmVmaWxsZWQgYSBtaW5pZ2FtZSB3aXRoIGEgc3VnYXIgbHVtcCA6ICIKICAgICAgICAgIDogIiIpICsKICAgICAgICBwYXJzZUZsb2F0KE1hdGguZmxvb3IoR2FtZS5sdW1wUmVmaWxsKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbglzdWdhciBsdW1wIHR5cGUgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKEdhbWUubHVtcEN1cnJlbnRUeXBlKSkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgl2YXVsdCA6ICIgOiAiIikgKwogICAgICAgIEdhbWUudmF1bHQuam9pbigiLCIpICsKICAgICAgICAiOyIgKwogICAgICAgICh0eXBlID09IDMgPyAiXG4JaGVyYWxkcyA6ICIgOiAiIikgKwogICAgICAgIHBhcnNlSW50KEdhbWUuaGVyYWxkcykgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbglnb2xkZW4gY29va2llIGZvcnR1bmUgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChHYW1lLmZvcnR1bmVHQykgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbglDcFMgZm9ydHVuZSA6ICIgOiAiIikgKwogICAgICAgIHBhcnNlSW50KEdhbWUuZm9ydHVuZUNQUykgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgloaWdoZXN0IHJhdyBDcFMgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUZsb2F0KEdhbWUuY29va2llc1BzUmF3SGlnaGVzdCkgKwogICAgICAgICI7IiArCiAgICAgICAgKHR5cGUgPT0gMyA/ICJcbgltdXNpYyB2b2x1bWUgOiAiIDogIiIpICsKICAgICAgICBwYXJzZUludChNYXRoLmZsb29yKEdhbWUudm9sdW1lTXVzaWMpKSArCiAgICAgICAgIjsiICsKICAgICAgICAifCI7IC8vY29va2llcyBhbmQgbG90cyBvZiBvdGhlciBzdHVmZgoKICAgICAgaWYgKHR5cGUgPT0gMykKICAgICAgICBzdHIgKz0KICAgICAgICAgICJcblxuQnVpbGRpbmdzIDogYW1vdW50LCBib3VnaHQsIGNvb2tpZXMgcHJvZHVjZWQsIGxldmVsLCBtaW5pZ2FtZSBkYXRhIjsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsgLy9idWlsZGluZ3MKICAgICAgICB2YXIgbWUgPSBHYW1lLk9iamVjdHNbaV07CiAgICAgICAgaWYgKHR5cGUgPT0gMykgc3RyICs9ICJcbgkiICsgbWUubmFtZSArICIgOiAiOwogICAgICAgIGlmIChtZS52YW5pbGxhKSB7CiAgICAgICAgICBzdHIgKz0KICAgICAgICAgICAgbWUuYW1vdW50ICsKICAgICAgICAgICAgIiwiICsKICAgICAgICAgICAgbWUuYm91Z2h0ICsKICAgICAgICAgICAgIiwiICsKICAgICAgICAgICAgcGFyc2VGbG9hdChNYXRoLmZsb29yKG1lLnRvdGFsQ29va2llcykpICsKICAgICAgICAgICAgIiwiICsKICAgICAgICAgICAgcGFyc2VJbnQobWUubGV2ZWwpOwogICAgICAgICAgaWYgKEdhbWUuaXNNaW5pZ2FtZVJlYWR5KG1lKSkgc3RyICs9ICIsIiArIG1lLm1pbmlnYW1lLnNhdmUoKTsKICAgICAgICAgIGVsc2Ugc3RyICs9ICIsIiArIChtZS5taW5pZ2FtZVNhdmUgfHwgIiIpOwogICAgICAgICAgc3RyICs9ICIsIiArIChtZS5tdXRlZCA/ICIxIiA6ICIwIik7CiAgICAgICAgICBzdHIgKz0gIiwiICsgbWUuaGlnaGVzdDsKICAgICAgICAgIHN0ciArPSAiOyI7CiAgICAgICAgfQogICAgICB9CiAgICAgIHN0ciArPSAifCI7CiAgICAgIGlmICh0eXBlID09IDMpCiAgICAgICAgc3RyICs9ICJcblxuUGFja2VkIHVwZ3JhZGVzIGJpdGZpZWxkICh1bmxvY2tlZCBhbmQgYm91Z2h0KVxuCSI7CiAgICAgIHZhciB0b0NvbXByZXNzID0gW107CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5VcGdyYWRlc0J5SWQpIHsgLy91cGdyYWRlcwogICAgICAgIHZhciBtZSA9IEdhbWUuVXBncmFkZXNCeUlkW2ldOwogICAgICAgIGlmIChtZS52YW5pbGxhKQogICAgICAgICAgdG9Db21wcmVzcy5wdXNoKE1hdGgubWluKG1lLnVubG9ja2VkLCAxKSwgTWF0aC5taW4obWUuYm91Z2h0LCAxKSk7CiAgICAgIH0KCiAgICAgIHRvQ29tcHJlc3MgPSBwYWNrMyh0b0NvbXByZXNzLmpvaW4oIiIpKTsgLy90b0NvbXByZXNzPXBhY2sodG9Db21wcmVzcyk7Ly9Db21wcmVzc0xhcmdlQmluKHRvQ29tcHJlc3MpOwoKICAgICAgc3RyICs9IHRvQ29tcHJlc3M7CiAgICAgIHN0ciArPSAifCI7CiAgICAgIGlmICh0eXBlID09IDMpIHN0ciArPSAiXG5cblBhY2tlZCBhY2hpZXZlbWVudHMgYml0ZmllbGQgKHdvbilcbgkiOwogICAgICB2YXIgdG9Db21wcmVzcyA9IFtdOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUuQWNoaWV2ZW1lbnRzQnlJZCkgeyAvL2FjaGlldmVtZW50cwogICAgICAgIHZhciBtZSA9IEdhbWUuQWNoaWV2ZW1lbnRzQnlJZFtpXTsKICAgICAgICBpZiAobWUudmFuaWxsYSkgdG9Db21wcmVzcy5wdXNoKE1hdGgubWluKG1lLndvbikpOwogICAgICB9CiAgICAgIHRvQ29tcHJlc3MgPSBwYWNrMyh0b0NvbXByZXNzLmpvaW4oIiIpKTsgLy90b0NvbXByZXNzPXBhY2sodG9Db21wcmVzcyk7Ly9Db21wcmVzc0xhcmdlQmluKHRvQ29tcHJlc3MpOwogICAgICBzdHIgKz0gdG9Db21wcmVzczsKCiAgICAgIHN0ciArPSAifCI7CiAgICAgIGlmICh0eXBlID09IDMpIHN0ciArPSAiXG5cbkJ1ZmZzIDogdHlwZSwgbWF4VGltZSwgdGltZSwgYXJnMSwgYXJnMiwgYXJnMyI7CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5idWZmcykgewogICAgICAgIHZhciBtZSA9IEdhbWUuYnVmZnNbaV07CiAgICAgICAgaWYgKG1lLnR5cGUpIHsKICAgICAgICAgIGlmICh0eXBlID09IDMpIHN0ciArPSAiXG4JIiArIG1lLnR5cGUubmFtZSArICIgOiAiOwogICAgICAgICAgaWYgKG1lLnR5cGUudmFuaWxsYSkgewogICAgICAgICAgICBzdHIgKz0gbWUudHlwZS5pZCArICIsIiArIG1lLm1heFRpbWUgKyAiLCIgKyBtZS50aW1lOwogICAgICAgICAgICBpZiAodHlwZW9mIG1lLmFyZzEgIT09ICJ1bmRlZmluZWQiKQogICAgICAgICAgICAgIHN0ciArPSAiLCIgKyBwYXJzZUZsb2F0KG1lLmFyZzEpOwogICAgICAgICAgICBpZiAodHlwZW9mIG1lLmFyZzIgIT09ICJ1bmRlZmluZWQiKQogICAgICAgICAgICAgIHN0ciArPSAiLCIgKyBwYXJzZUZsb2F0KG1lLmFyZzIpOwogICAgICAgICAgICBpZiAodHlwZW9mIG1lLmFyZzMgIT09ICJ1bmRlZmluZWQiKQogICAgICAgICAgICAgIHN0ciArPSAiLCIgKyBwYXJzZUZsb2F0KG1lLmFyZzMpOwogICAgICAgICAgICBzdHIgKz0gIjsiOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHR5cGUgPT0gMykgc3RyICs9ICJcblxuQ3VzdG9tIDpcbiI7CgogICAgICBzdHIgKz0gInwiOwogICAgICBzdHIgKz0gR2FtZS5zYXZlTW9kRGF0YSgpOwoKICAgICAgR2FtZS5sYXN0U2F2ZURhdGEgPSBzdHI7CgogICAgICBpZiAodHlwZSA9PSAyIHx8IHR5cGUgPT0gMykgewogICAgICAgIHJldHVybiBzdHI7CiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSAxKSB7CiAgICAgICAgc3RyID0gZXNjYXBlKHV0ZjhfdG9fYjY0KHN0cikgKyAiIUVORCEiKTsKICAgICAgICByZXR1cm4gc3RyOwogICAgICB9IGVsc2UgewogICAgICAgIGlmIChHYW1lLnVzZUxvY2FsU3RvcmFnZSkgewogICAgICAgICAgLy9zbyB3ZSB1c2VkIHRvIHNhdmUgdGhlIGdhbWUgdXNpbmcgYnJvd3NlciBjb29raWVzLCB3aGljaCB3YXMganVzdCByZWFsbHkgbmVhdCBjb25zaWRlcmluZyB0aGUgZ2FtZSdzIG5hbWUKICAgICAgICAgIC8vd2UncmUgdXNpbmcgbG9jYWxzdG9yYWdlIG5vdywgd2hpY2ggaXMgbW9yZSBlZmZpY2llbnQgYnV0IG5vdCBhcyBjb29sCiAgICAgICAgICAvL2EgbW9tZW50IG9mIHNpbGVuY2UgZm9yIG91ciBmYWxsZW4gcHVucwogICAgICAgICAgc3RyID0gdXRmOF90b19iNjQoc3RyKSArICIhRU5EISI7CiAgICAgICAgICBpZiAoc3RyLmxlbmd0aCA8IDEwKSB7CiAgICAgICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgICAgICJTYXZpbmcgZmFpbGVkISIsCiAgICAgICAgICAgICAgIlB1cmNoYXNpbmcgYW4gdXBncmFkZSBhbmQgc2F2aW5nIGFnYWluIG1pZ2h0IGZpeCB0aGlzLjxicj5UaGlzIHJlYWxseSBzaG91bGRuJ3QgaGFwcGVuOyBwbGVhc2Ugbm90aWZ5IE9ydGVpbCBvbiBoaXMgdHVtYmxyLiIKICAgICAgICAgICAgKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN0ciA9IGVzY2FwZShzdHIpOwogICAgICAgICAgICBsb2NhbFN0b3JhZ2VTZXQoR2FtZS5TYXZlVG8sIHN0cik7IC8vYWFhbmQgc2F2ZQogICAgICAgICAgICBpZiAoQXBwKSBBcHAuc2F2ZShzdHIpOwogICAgICAgICAgICBpZiAoIWxvY2FsU3RvcmFnZUdldChHYW1lLlNhdmVUbykpIHsKICAgICAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgICAgIGxvYygiRXJyb3Igd2hpbGUgc2F2aW5nIiksCiAgICAgICAgICAgICAgICBsb2MoIkV4cG9ydCB5b3VyIHNhdmUgaW5zdGVhZCEiKQogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZG9jdW1lbnQuaGFzRm9jdXMoKSkgewogICAgICAgICAgICAgIEdhbWUuTm90aWZ5KGxvYygiR2FtZSBzYXZlZCIpLCAiIiwgIiIsIDEsIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSAvL2xlZ2FjeSBzeXN0ZW0KICAgICAgICBlbHNlIHsKICAgICAgICAgIC8vdGhhdCdzIHJpZ2h0CiAgICAgICAgICAvL3dlJ3JlIHVzaW5nIGNvb2tpZXMKICAgICAgICAgIC8veWVhaCBJIHdlbnQgdGhlcmUKICAgICAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpOyAvL3dlIHN0b3JpbiBkaXMgZm9yIDUgeWVhcnMsIHBlb3BsZQogICAgICAgICAgbm93LnNldEZ1bGxZZWFyKG5vdy5nZXRGdWxsWWVhcigpICsgNSk7IC8vbW1oIHN0YWxlIGNvb2tpZXMKICAgICAgICAgIHN0ciA9IHV0ZjhfdG9fYjY0KHN0cikgKyAiIUVORCEiOwogICAgICAgICAgR2FtZS5zYXZlRGF0YSA9IGVzY2FwZShzdHIpOwogICAgICAgICAgc3RyID0KICAgICAgICAgICAgR2FtZS5TYXZlVG8gKwogICAgICAgICAgICAiPSIgKwogICAgICAgICAgICBlc2NhcGUoc3RyKSArCiAgICAgICAgICAgICI7IGV4cGlyZXM9IiArCiAgICAgICAgICAgIG5vdy50b1VUQ1N0cmluZygpICsKICAgICAgICAgICAgIjsiOwogICAgICAgICAgZG9jdW1lbnQuY29va2llID0gc3RyOyAvL2FhYW5kIHNhdmUKICAgICAgICAgIGlmIChBcHApIEFwcC5zYXZlKHN0cik7CiAgICAgICAgICBpZiAoZG9jdW1lbnQuY29va2llLmluZGV4T2YoR2FtZS5TYXZlVG8pIDwgMCkgewogICAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgICBsb2MoIkVycm9yIHdoaWxlIHNhdmluZyIpLAogICAgICAgICAgICAgIGxvYygiRXhwb3J0IHlvdXIgc2F2ZSBpbnN0ZWFkISIpLAogICAgICAgICAgICAgICIiLAogICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgMQogICAgICAgICAgICApOwogICAgICAgICAgfSBlbHNlIGlmIChkb2N1bWVudC5oYXNGb2N1cygpKSB7CiAgICAgICAgICAgIEdhbWUuTm90aWZ5KGxvYygiR2FtZSBzYXZlZCIpLCAiIiwgIiIsIDEsIDEpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCQlMT0FECgkJPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KICAgIEdhbWUuc2FsdmFnZVNhdmUgPSBmdW5jdGlvbiAoKSB7CiAgICAgIC8vZm9yIHdoZW4gQ29va2llIENsaWNrZXIgd29uJ3QgbG9hZCBhbmQgeW91IG5lZWQgeW91ciBzYXZlCiAgICAgIGNvbnNvbGUubG9nKCI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iKTsKICAgICAgY29uc29sZS5sb2coCiAgICAgICAgJ1RoaXMgaXMgeW91ciBzYXZlIGRhdGEuIENvcHlwYXN0ZSBpdCAod2l0aG91dCBxdW90YXRpb24gbWFya3MpIGludG8gYW5vdGhlciB2ZXJzaW9uIHVzaW5nIHRoZSAiSW1wb3J0IHNhdmUiIGZlYXR1cmUuJwogICAgICApOwogICAgICBjb25zb2xlLmxvZyhsb2NhbFN0b3JhZ2VHZXQoR2FtZS5TYXZlVG8pKTsKICAgIH07CiAgICBHYW1lLkxvYWRTYXZlID0gZnVuY3Rpb24gKGRhdGEsIGlnbm9yZVZlcnNpb25Jc3N1ZXMpIHsKICAgICAgdmFyIHN0ciA9ICIiOwogICAgICBpZiAodHlwZW9mIGRhdGEgIT09ICJ1bmRlZmluZWQiKSBzdHIgPSB1bmVzY2FwZShkYXRhKTsKICAgICAgZWxzZSB7CiAgICAgICAgaWYgKEFwcCkgewogICAgICAgICAgQXBwLmdldE1vc3RSZWNlbnRTYXZlKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgIEdhbWUuTG9hZFNhdmUoZGF0YSwgdHJ1ZSk7CiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgaWYgKEdhbWUudXNlTG9jYWxTdG9yYWdlKSB7CiAgICAgICAgICB2YXIgbG9jYWwgPSBsb2NhbFN0b3JhZ2VHZXQoR2FtZS5TYXZlVG8pOwogICAgICAgICAgaWYgKCFsb2NhbCkgewogICAgICAgICAgICAvL25vIGxvY2Fsc3RvcmFnZSBzYXZlIGZvdW5kPyBsZXQncyBnZXQgdGhlIGNvb2tpZSBvbmUgbGFzdCB0aW1lCiAgICAgICAgICAgIGlmIChkb2N1bWVudC5jb29raWUuaW5kZXhPZihHYW1lLlNhdmVUbykgPj0gMCkgewogICAgICAgICAgICAgIHN0ciA9IHVuZXNjYXBlKGRvY3VtZW50LmNvb2tpZS5zcGxpdChHYW1lLlNhdmVUbyArICI9IilbMV0pOwogICAgICAgICAgICAgIGRvY3VtZW50LmNvb2tpZSA9CiAgICAgICAgICAgICAgICBHYW1lLlNhdmVUbyArICI9O2V4cGlyZXM9VGh1LCAwMSBKYW4gMTk3MCAwMDowMDowMSBHTVQ7IjsKICAgICAgICAgICAgfSBlbHNlIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN0ciA9IHVuZXNjYXBlKGxvY2FsKTsKICAgICAgICAgIH0KICAgICAgICB9IC8vbGVnYWN5IHN5c3RlbQogICAgICAgIGVsc2UgewogICAgICAgICAgaWYgKGRvY3VtZW50LmNvb2tpZS5pbmRleE9mKEdhbWUuU2F2ZVRvKSA+PSAwKQogICAgICAgICAgICBzdHIgPSB1bmVzY2FwZSgKICAgICAgICAgICAgICBkb2N1bWVudC5jb29raWUuc3BsaXQoR2FtZS5TYXZlVG8gKyAiPSIpWzFdCiAgICAgICAgICAgICk7IC8vZ2V0IGNvb2tpZSBoZXJlCiAgICAgICAgICBlbHNlIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHN0ciAhPSAiIikgewogICAgICAgIHZhciB2ZXJzaW9uID0gMDsKICAgICAgICB2YXIgb2xkc3RyID0gc3RyLnNwbGl0KCJ8Iik7CiAgICAgICAgaWYgKG9sZHN0clswXS5sZW5ndGggPCAxKSByZXR1cm4gZmFsc2U7CiAgICAgICAgZWxzZSB7CiAgICAgICAgICBzdHIgPSBzdHIuc3BsaXQoIiFFTkQhIilbMF07CiAgICAgICAgICBzdHIgPSBiNjRfdG9fdXRmOChzdHIpOwogICAgICAgIH0KICAgICAgICBpZiAoc3RyID09ICIiKSByZXR1cm4gZmFsc2U7CiAgICAgICAgZWxzZSB7CiAgICAgICAgICB2YXIgc3BsID0gIiI7CiAgICAgICAgICBzdHIgPSBzdHIuc3BsaXQoInwiKTsKICAgICAgICAgIHZlcnNpb24gPSBwYXJzZUZsb2F0KHN0clswXSk7CiAgICAgICAgICBHYW1lLmxvYWRlZEZyb21WZXJzaW9uID0gdmVyc2lvbjsKCiAgICAgICAgICBpZiAoaXNOYU4odmVyc2lvbikgfHwgc3RyLmxlbmd0aCA8IDUpIHsKICAgICAgICAgICAgR2FtZS5Ob3RpZnkoCiAgICAgICAgICAgICAgbG9jKCJFcnJvciBpbXBvcnRpbmcgc2F2ZSIpLAogICAgICAgICAgICAgIGxvYygiT29wcywgbG9va3MgbGlrZSB0aGUgaW1wb3J0IHN0cmluZyBpcyBhbGwgd3JvbmchIiksCiAgICAgICAgICAgICAgIiIsCiAgICAgICAgICAgICAgNiwKICAgICAgICAgICAgICAxCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICAgIGlmICh2ZXJzaW9uID49IDEgJiYgdmVyc2lvbiA+IEdhbWUudmVyc2lvbikgewogICAgICAgICAgICBpZiAoaWdub3JlVmVyc2lvbklzc3VlcykKICAgICAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgICAgICJSZXRyaWV2aW5nIHNhdmUgZnJvbSBhIGZ1dHVyZSB2ZXJzaW9uLiIsCiAgICAgICAgICAgICAgICAiVGhhdCdzLi4ub2RkLiIsCiAgICAgICAgICAgICAgICAiIiwKICAgICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgICAxCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgR2FtZS5Ob3RpZnkoCiAgICAgICAgICAgICAgICBsb2MoIkVycm9yIGltcG9ydGluZyBzYXZlIiksCiAgICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAgICJZb3UgYXJlIGF0dGVtcHRpbmcgdG8gbG9hZCBhIHNhdmUgZnJvbSBhIGZ1dHVyZSB2ZXJzaW9uICh2LiAlMTsgeW91IGFyZSB1c2luZyB2LiAlMikuIiwKICAgICAgICAgICAgICAgICAgW3ZlcnNpb24sIEdhbWUudmVyc2lvbl0KICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAiIiwKICAgICAgICAgICAgICAgIDYsCiAgICAgICAgICAgICAgICAxCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGlmICh2ZXJzaW9uID49IDEpIHsKICAgICAgICAgICAgR2FtZS5UID0gMDsKCiAgICAgICAgICAgIHNwbCA9IHN0clsyXS5zcGxpdCgiOyIpOyAvL3NhdmUgc3RhdHMKICAgICAgICAgICAgR2FtZS5zdGFydERhdGUgPSBwYXJzZUludChzcGxbMF0pOwogICAgICAgICAgICBHYW1lLmZ1bGxEYXRlID0gcGFyc2VJbnQoc3BsWzFdKTsKICAgICAgICAgICAgR2FtZS5sYXN0RGF0ZSA9IHBhcnNlSW50KHNwbFsyXSk7CiAgICAgICAgICAgIHZhciBiYWtlcnlOYW1lID0gc3BsWzNdID8gc3BsWzNdIDogR2FtZS5HZXRCYWtlcnlOYW1lKCk7CiAgICAgICAgICAgIEdhbWUuc2VlZCA9IHNwbFs0XSA/IHNwbFs0XSA6IEdhbWUubWFrZVNlZWQoKTsKICAgICAgICAgICAgLy9wcmVmcwogICAgICAgICAgICBpZiAodmVyc2lvbiA8IDEuMDUwMykgc3BsID0gc3RyWzNdLnNwbGl0KCIiKTsKICAgICAgICAgICAgZWxzZSBpZiAodmVyc2lvbiA8IDIuMDA0Nikgc3BsID0gdW5wYWNrMihzdHJbM10pLnNwbGl0KCIiKTsKICAgICAgICAgICAgZWxzZSBzcGwgPSBzdHJbM10uc3BsaXQoIiIpOwogICAgICAgICAgICBHYW1lLnByZWZzLnBhcnRpY2xlcyA9IHBhcnNlSW50KHNwbFswXSk7CiAgICAgICAgICAgIEdhbWUucHJlZnMubnVtYmVycyA9IHBhcnNlSW50KHNwbFsxXSk7CiAgICAgICAgICAgIEdhbWUucHJlZnMuYXV0b3NhdmUgPSBwYXJzZUludChzcGxbMl0pOwogICAgICAgICAgICBHYW1lLnByZWZzLmF1dG91cGRhdGUgPSBzcGxbM10gPyBwYXJzZUludChzcGxbM10pIDogMTsKICAgICAgICAgICAgR2FtZS5wcmVmcy5taWxrID0gc3BsWzRdID8gcGFyc2VJbnQoc3BsWzRdKSA6IDE7CiAgICAgICAgICAgIEdhbWUucHJlZnMuZmFuY3kgPSBwYXJzZUludChzcGxbNV0pOwogICAgICAgICAgICBpZiAoR2FtZS5wcmVmcy5mYW5jeSkgR2FtZS5yZW1vdmVDbGFzcygibm9GYW5jeSIpOwogICAgICAgICAgICBlbHNlIGlmICghR2FtZS5wcmVmcy5mYW5jeSkgR2FtZS5hZGRDbGFzcygibm9GYW5jeSIpOwogICAgICAgICAgICBHYW1lLnByZWZzLndhcm4gPSBzcGxbNl0gPyBwYXJzZUludChzcGxbNl0pIDogMDsKICAgICAgICAgICAgR2FtZS5wcmVmcy5jdXJzb3JzID0gc3BsWzddID8gcGFyc2VJbnQoc3BsWzddKSA6IDA7CiAgICAgICAgICAgIEdhbWUucHJlZnMuZm9jdXMgPSBzcGxbOF0gPyBwYXJzZUludChzcGxbOF0pIDogMDsKICAgICAgICAgICAgR2FtZS5wcmVmcy5mb3JtYXQgPSBzcGxbOV0gPyBwYXJzZUludChzcGxbOV0pIDogMDsKICAgICAgICAgICAgR2FtZS5wcmVmcy5ub3RpZnMgPSBzcGxbMTBdID8gcGFyc2VJbnQoc3BsWzEwXSkgOiAwOwogICAgICAgICAgICBHYW1lLnByZWZzLndvYmJseSA9IHNwbFsxMV0gPyBwYXJzZUludChzcGxbMTFdKSA6IDA7CiAgICAgICAgICAgIEdhbWUucHJlZnMubW9ub3NwYWNlID0gc3BsWzEyXSA/IHBhcnNlSW50KHNwbFsxMl0pIDogMDsKICAgICAgICAgICAgR2FtZS5wcmVmcy5maWx0ZXJzID0gc3BsWzEzXSA/IHBhcnNlSW50KHNwbFsxM10pIDogMTsKICAgICAgICAgICAgaWYgKEdhbWUucHJlZnMuZmlsdGVycykgR2FtZS5yZW1vdmVDbGFzcygibm9GaWx0ZXJzIik7CiAgICAgICAgICAgIGVsc2UgaWYgKCFHYW1lLnByZWZzLmZpbHRlcnMpIEdhbWUuYWRkQ2xhc3MoIm5vRmlsdGVycyIpOwogICAgICAgICAgICBHYW1lLnByZWZzLmNvb2tpZXNvdW5kID0gc3BsWzE0XSA/IHBhcnNlSW50KHNwbFsxNF0pIDogMTsKICAgICAgICAgICAgR2FtZS5wcmVmcy5jcmF0ZXMgPSBzcGxbMTVdID8gcGFyc2VJbnQoc3BsWzE1XSkgOiAwOwogICAgICAgICAgICBHYW1lLnByZWZzLnNob3dCYWNrdXBXYXJuaW5nID0gc3BsWzE2XSA/IHBhcnNlSW50KHNwbFsxNl0pIDogMTsKICAgICAgICAgICAgR2FtZS5wcmVmcy5leHRyYUJ1dHRvbnMgPSBzcGxbMTddID8gcGFyc2VJbnQoc3BsWzE3XSkgOiAxOwogICAgICAgICAgICBpZiAoIUdhbWUucHJlZnMuZXh0cmFCdXR0b25zKSBHYW1lLnJlbW92ZUNsYXNzKCJleHRyYUJ1dHRvbnMiKTsKICAgICAgICAgICAgZWxzZSBpZiAoR2FtZS5wcmVmcy5leHRyYUJ1dHRvbnMpIEdhbWUuYWRkQ2xhc3MoImV4dHJhQnV0dG9ucyIpOwogICAgICAgICAgICBHYW1lLnByZWZzLmFza0x1bXBzID0gc3BsWzE4XSA/IHBhcnNlSW50KHNwbFsxOF0pIDogMDsKICAgICAgICAgICAgR2FtZS5wcmVmcy5jdXN0b21HcmFuZG1hcyA9IHNwbFsxOV0gPyBwYXJzZUludChzcGxbMTldKSA6IDE7CiAgICAgICAgICAgIEdhbWUucHJlZnMudGltZW91dCA9IHNwbFsyMF0gPyBwYXJzZUludChzcGxbMjBdKSA6IDA7CiAgICAgICAgICAgIEdhbWUucHJlZnMuY2xvdWRTYXZlID0gc3BsWzIxXSA/IHBhcnNlSW50KHNwbFsyMV0pIDogMTsKICAgICAgICAgICAgR2FtZS5wcmVmcy5iZ011c2ljID0gc3BsWzIyXSA/IHBhcnNlSW50KHNwbFsyMl0pIDogMTsKICAgICAgICAgICAgR2FtZS5wcmVmcy5ub3RTY2FyeSA9IHNwbFsyM10gPyBwYXJzZUludChzcGxbMjNdKSA6IDA7CiAgICAgICAgICAgIEdhbWUucHJlZnMuZnVsbHNjcmVlbiA9IHNwbFsyNF0gPyBwYXJzZUludChzcGxbMjRdKSA6IDA7CiAgICAgICAgICAgIGlmIChBcHApIEFwcC5zZXRGdWxsc2NyZWVuKEdhbWUucHJlZnMuZnVsbHNjcmVlbik7CiAgICAgICAgICAgIEdhbWUucHJlZnMuc2NyZWVucmVhZGVyID0gc3BsWzI1XSA/IHBhcnNlSW50KHNwbFsyNV0pIDogMDsKICAgICAgICAgICAgR2FtZS5wcmVmcy5kaXNjb3JkUHJlc2VuY2UgPSBzcGxbMjZdID8gcGFyc2VJbnQoc3BsWzI2XSkgOiAxOwogICAgICAgICAgICBCZWF1dGlmeUFsbCgpOwogICAgICAgICAgICBzcGwgPSBzdHJbNF0uc3BsaXQoIjsiKTsgLy9jb29raWVzIGFuZCBsb3RzIG9mIG90aGVyIHN0dWZmCiAgICAgICAgICAgIEdhbWUuY29va2llcyA9IHBhcnNlRmxvYXQoc3BsWzBdKTsKICAgICAgICAgICAgR2FtZS5jb29raWVzRWFybmVkID0gcGFyc2VGbG9hdChzcGxbMV0pOwogICAgICAgICAgICBHYW1lLmNvb2tpZUNsaWNrcyA9IHNwbFsyXSA/IHBhcnNlSW50KHNwbFsyXSkgOiAwOwogICAgICAgICAgICBHYW1lLmdvbGRlbkNsaWNrcyA9IHNwbFszXSA/IHBhcnNlSW50KHNwbFszXSkgOiAwOwogICAgICAgICAgICBHYW1lLmhhbmRtYWRlQ29va2llcyA9IHNwbFs0XSA/IHBhcnNlRmxvYXQoc3BsWzRdKSA6IDA7CiAgICAgICAgICAgIEdhbWUubWlzc2VkR29sZGVuQ2xpY2tzID0gc3BsWzVdID8gcGFyc2VJbnQoc3BsWzVdKSA6IDA7CiAgICAgICAgICAgIEdhbWUuYmdUeXBlID0gc3BsWzZdID8gcGFyc2VJbnQoc3BsWzZdKSA6IDA7CiAgICAgICAgICAgIEdhbWUubWlsa1R5cGUgPSBzcGxbN10gPyBwYXJzZUludChzcGxbN10pIDogMDsKICAgICAgICAgICAgR2FtZS5jb29raWVzUmVzZXQgPSBzcGxbOF0gPyBwYXJzZUZsb2F0KHNwbFs4XSkgOiAwOwogICAgICAgICAgICBHYW1lLmVsZGVyV3JhdGggPSBzcGxbOV0gPyBwYXJzZUludChzcGxbOV0pIDogMDsKICAgICAgICAgICAgR2FtZS5wbGVkZ2VzID0gc3BsWzEwXSA/IHBhcnNlSW50KHNwbFsxMF0pIDogMDsKICAgICAgICAgICAgR2FtZS5wbGVkZ2VUID0gc3BsWzExXSA/IHBhcnNlSW50KHNwbFsxMV0pIDogMDsKICAgICAgICAgICAgR2FtZS5uZXh0UmVzZWFyY2ggPSBzcGxbMTJdID8gcGFyc2VJbnQoc3BsWzEyXSkgOiAwOwogICAgICAgICAgICBHYW1lLnJlc2VhcmNoVCA9IHNwbFsxM10gPyBwYXJzZUludChzcGxbMTNdKSA6IDA7CiAgICAgICAgICAgIEdhbWUucmVzZXRzID0gc3BsWzE0XSA/IHBhcnNlSW50KHNwbFsxNF0pIDogMDsKICAgICAgICAgICAgR2FtZS5nb2xkZW5DbGlja3NMb2NhbCA9IHNwbFsxNV0gPyBwYXJzZUludChzcGxbMTVdKSA6IDA7CiAgICAgICAgICAgIEdhbWUuY29va2llc1N1Y2tlZCA9IHNwbFsxNl0gPyBwYXJzZUZsb2F0KHNwbFsxNl0pIDogMDsKICAgICAgICAgICAgR2FtZS53cmlua2xlcnNQb3BwZWQgPSBzcGxbMTddID8gcGFyc2VJbnQoc3BsWzE3XSkgOiAwOwogICAgICAgICAgICBHYW1lLnNhbnRhTGV2ZWwgPSBzcGxbMThdID8gcGFyc2VJbnQoc3BsWzE4XSkgOiAwOwogICAgICAgICAgICBHYW1lLnJlaW5kZWVyQ2xpY2tlZCA9IHNwbFsxOV0gPyBwYXJzZUludChzcGxbMTldKSA6IDA7CiAgICAgICAgICAgIEdhbWUuc2Vhc29uVCA9IHNwbFsyMF0gPyBwYXJzZUludChzcGxbMjBdKSA6IDA7CiAgICAgICAgICAgIEdhbWUuc2Vhc29uVXNlcyA9IHNwbFsyMV0gPyBwYXJzZUludChzcGxbMjFdKSA6IDA7CiAgICAgICAgICAgIEdhbWUuc2Vhc29uID0gc3BsWzIyXSA/IHNwbFsyMl0gOiBHYW1lLmJhc2VTZWFzb247CiAgICAgICAgICAgIHZhciB3cmlua2xlcnMgPSB7CiAgICAgICAgICAgICAgYW1vdW50OiBzcGxbMjNdID8gcGFyc2VGbG9hdChzcGxbMjNdKSA6IDAsCiAgICAgICAgICAgICAgbnVtYmVyOiBzcGxbMjRdID8gcGFyc2VJbnQoc3BsWzI0XSkgOiAwLAogICAgICAgICAgICB9OwogICAgICAgICAgICBHYW1lLnByZXN0aWdlID0gc3BsWzI1XSA/IHBhcnNlRmxvYXQoc3BsWzI1XSkgOiAwOwogICAgICAgICAgICBHYW1lLmhlYXZlbmx5Q2hpcHMgPSBzcGxbMjZdID8gcGFyc2VGbG9hdChzcGxbMjZdKSA6IDA7CiAgICAgICAgICAgIEdhbWUuaGVhdmVubHlDaGlwc1NwZW50ID0gc3BsWzI3XSA/IHBhcnNlRmxvYXQoc3BsWzI3XSkgOiAwOwogICAgICAgICAgICBHYW1lLmhlYXZlbmx5Q29va2llcyA9IHNwbFsyOF0gPyBwYXJzZUZsb2F0KHNwbFsyOF0pIDogMDsKICAgICAgICAgICAgR2FtZS5hc2NlbnNpb25Nb2RlID0gc3BsWzI5XSA/IHBhcnNlSW50KHNwbFsyOV0pIDogMDsKICAgICAgICAgICAgR2FtZS5wZXJtYW5lbnRVcGdyYWRlc1swXSA9IHNwbFszMF0gPyBwYXJzZUludChzcGxbMzBdKSA6IC0xOwogICAgICAgICAgICBHYW1lLnBlcm1hbmVudFVwZ3JhZGVzWzFdID0gc3BsWzMxXSA/IHBhcnNlSW50KHNwbFszMV0pIDogLTE7CiAgICAgICAgICAgIEdhbWUucGVybWFuZW50VXBncmFkZXNbMl0gPSBzcGxbMzJdID8gcGFyc2VJbnQoc3BsWzMyXSkgOiAtMTsKICAgICAgICAgICAgR2FtZS5wZXJtYW5lbnRVcGdyYWRlc1szXSA9IHNwbFszM10gPyBwYXJzZUludChzcGxbMzNdKSA6IC0xOwogICAgICAgICAgICBHYW1lLnBlcm1hbmVudFVwZ3JhZGVzWzRdID0gc3BsWzM0XSA/IHBhcnNlSW50KHNwbFszNF0pIDogLTE7CiAgICAgICAgICAgIC8vaWYgKHZlcnNpb248MS4wNSkge0dhbWUuaGVhdmVubHlDaGlwc0Vhcm5lZD1HYW1lLkhvd011Y2hQcmVzdGlnZShHYW1lLmNvb2tpZXNSZXNldCk7R2FtZS5oZWF2ZW5seUNoaXBzPUdhbWUuaGVhdmVubHlDaGlwc0Vhcm5lZDt9CiAgICAgICAgICAgIEdhbWUuZHJhZ29uTGV2ZWwgPSBzcGxbMzVdID8gcGFyc2VJbnQoc3BsWzM1XSkgOiAwOwogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgdmVyc2lvbiA8IDIuMDA0MSAmJgogICAgICAgICAgICAgIEdhbWUuZHJhZ29uTGV2ZWwgPT0gR2FtZS5kcmFnb25MZXZlbHMubGVuZ3RoIC0gMgogICAgICAgICAgICApIHsKICAgICAgICAgICAgICBHYW1lLmRyYWdvbkxldmVsID0gR2FtZS5kcmFnb25MZXZlbHMubGVuZ3RoIC0gMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBHYW1lLmRyYWdvbkF1cmEgPSBzcGxbMzZdID8gcGFyc2VJbnQoc3BsWzM2XSkgOiAwOwogICAgICAgICAgICBHYW1lLmRyYWdvbkF1cmEyID0gc3BsWzM3XSA/IHBhcnNlSW50KHNwbFszN10pIDogMDsKICAgICAgICAgICAgR2FtZS5jaGltZVR5cGUgPSBzcGxbMzhdID8gcGFyc2VJbnQoc3BsWzM4XSkgOiAwOwogICAgICAgICAgICBHYW1lLnZvbHVtZSA9IHNwbFszOV0gPyBwYXJzZUludChzcGxbMzldKSA6IDc1OwogICAgICAgICAgICB3cmlua2xlcnMuc2hpbmllcyA9IHNwbFs0MF0gPyBwYXJzZUludChzcGxbNDBdKSA6IDA7CiAgICAgICAgICAgIHdyaW5rbGVycy5hbW91bnRTaGluaWVzID0gc3BsWzQxXSA/IHBhcnNlRmxvYXQoc3BsWzQxXSkgOiAwOwogICAgICAgICAgICBHYW1lLmx1bXBzID0gc3BsWzQyXSA/IHBhcnNlRmxvYXQoc3BsWzQyXSkgOiAtMTsKICAgICAgICAgICAgR2FtZS5sdW1wc1RvdGFsID0gc3BsWzQzXSA/IHBhcnNlRmxvYXQoc3BsWzQzXSkgOiAtMTsKICAgICAgICAgICAgR2FtZS5sdW1wVCA9IHNwbFs0NF0gPyBwYXJzZUludChzcGxbNDRdKSA6IERhdGUubm93KCk7CiAgICAgICAgICAgIEdhbWUubHVtcFJlZmlsbCA9IHNwbFs0NV0gPyBwYXJzZUludChzcGxbNDVdKSA6IDA7CiAgICAgICAgICAgIGlmICh2ZXJzaW9uIDwgMi4wMjIpIEdhbWUubHVtcFJlZmlsbCA9IEdhbWUuZnBzICogNjA7CiAgICAgICAgICAgIEdhbWUubHVtcEN1cnJlbnRUeXBlID0gc3BsWzQ2XSA/IHBhcnNlSW50KHNwbFs0Nl0pIDogMDsKICAgICAgICAgICAgR2FtZS52YXVsdCA9IHNwbFs0N10gPyBzcGxbNDddLnNwbGl0KCIsIikgOiBbXTsKICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLnZhdWx0KSB7CiAgICAgICAgICAgICAgR2FtZS52YXVsdFtpXSA9IHBhcnNlSW50KEdhbWUudmF1bHRbaV0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZhciBhY3R1YWxIZXJhbGRzID0gR2FtZS5oZXJhbGRzOyAvL3dlIHN0b3JlIHRoZSBhY3R1YWwgYW1vdW50IG9mIGhlcmFsZHMgdG8gcmVzdG9yZSBpdCBsYXRlcjsgaGVyZSB3ZSB1c2VkIHRoZSBhbW91bnQgcHJlc2VudCBpbiB0aGUgc2F2ZSB0byBjb21wdXRlIG9mZmxpbmUgQ3BTCiAgICAgICAgICAgIEdhbWUuaGVyYWxkcyA9IHNwbFs0OF0gPyBwYXJzZUZsb2F0KHNwbFs0OF0pIDogR2FtZS5oZXJhbGRzOwogICAgICAgICAgICBHYW1lLmZvcnR1bmVHQyA9IHNwbFs0OV0gPyBwYXJzZUludChzcGxbNDldKSA6IDA7CiAgICAgICAgICAgIEdhbWUuZm9ydHVuZUNQUyA9IHNwbFs1MF0gPyBwYXJzZUludChzcGxbNTBdKSA6IDA7CiAgICAgICAgICAgIEdhbWUuY29va2llc1BzUmF3SGlnaGVzdCA9IHNwbFs1MV0gPyBwYXJzZUZsb2F0KHNwbFs1MV0pIDogMDsKICAgICAgICAgICAgR2FtZS52b2x1bWVNdXNpYyA9IHNwbFs1Ml0gPyBwYXJzZUludChzcGxbNTJdKSA6IDUwOwoKICAgICAgICAgICAgc3BsID0gc3RyWzVdLnNwbGl0KCI7Iik7IC8vYnVpbGRpbmdzCiAgICAgICAgICAgIEdhbWUuQnVpbGRpbmdzT3duZWQgPSAwOwogICAgICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0c0J5SWQpIHsKICAgICAgICAgICAgICB2YXIgbWUgPSBHYW1lLk9iamVjdHNCeUlkW2ldOwogICAgICAgICAgICAgIG1lLnN3aXRjaE1pbmlnYW1lKGZhbHNlKTsKICAgICAgICAgICAgICBtZS5waWNzID0gW107CiAgICAgICAgICAgICAgaWYgKHNwbFtpXSkgewogICAgICAgICAgICAgICAgdmFyIG1lc3RyID0gc3BsW2ldLnRvU3RyaW5nKCkuc3BsaXQoIiwiKTsKICAgICAgICAgICAgICAgIG1lLmFtb3VudCA9IHBhcnNlSW50KG1lc3RyWzBdKTsKICAgICAgICAgICAgICAgIG1lLmJvdWdodCA9IHBhcnNlSW50KG1lc3RyWzFdKTsKICAgICAgICAgICAgICAgIG1lLnRvdGFsQ29va2llcyA9IHBhcnNlRmxvYXQobWVzdHJbMl0pOwogICAgICAgICAgICAgICAgbWUubGV2ZWwgPSBwYXJzZUludChtZXN0clszXSB8fCAwKTsKICAgICAgICAgICAgICAgIG1lLmhpZ2hlc3QgPSB2ZXJzaW9uID49IDIuMDI0ID8gcGFyc2VJbnQobWVzdHJbNl0pIDogbWUuYW1vdW50OwogICAgICAgICAgICAgICAgaWYgKG1lLm1pbmlnYW1lICYmIG1lLm1pbmlnYW1lTG9hZGVkICYmIG1lLm1pbmlnYW1lLnJlc2V0KSB7CiAgICAgICAgICAgICAgICAgIG1lLm1pbmlnYW1lLnJlc2V0KHRydWUpOwogICAgICAgICAgICAgICAgICBtZS5taW5pZ2FtZS5sb2FkKG1lc3RyWzRdIHx8ICIiKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBtZS5taW5pZ2FtZVNhdmUgPSBtZXN0cls0XSB8fCAwOwogICAgICAgICAgICAgICAgbWUubXV0ZWQgPSBwYXJzZUludChtZXN0cls1XSkgfHwgMDsKICAgICAgICAgICAgICAgIEdhbWUuQnVpbGRpbmdzT3duZWQgKz0gbWUuYW1vdW50OwogICAgICAgICAgICAgICAgaWYgKHZlcnNpb24gPCAyLjAwMykgbWUubGV2ZWwgPSAwOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBtZS5hbW91bnQgPSAwOwogICAgICAgICAgICAgICAgbWUudW5sb2NrZWQgPSAwOwogICAgICAgICAgICAgICAgbWUuYm91Z2h0ID0gMDsKICAgICAgICAgICAgICAgIG1lLmhpZ2hlc3QgPSAwOwogICAgICAgICAgICAgICAgbWUudG90YWxDb29raWVzID0gMDsKICAgICAgICAgICAgICAgIG1lLmxldmVsID0gMDsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEdhbWUuc2V0Vm9sdW1lTXVzaWMoR2FtZS52b2x1bWVNdXNpYyk7CgogICAgICAgICAgICBHYW1lLkxvYWRNaW5pZ2FtZXMoKTsKCiAgICAgICAgICAgIGlmICh2ZXJzaW9uIDwgMS4wMzUpIHsKICAgICAgICAgICAgICAvL29sZCBub24tYmluYXJ5IGFsZ29yaXRobQogICAgICAgICAgICAgIHNwbCA9IHN0cls2XS5zcGxpdCgiOyIpOyAvL3VwZ3JhZGVzCiAgICAgICAgICAgICAgR2FtZS5VcGdyYWRlc093bmVkID0gMDsKICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuVXBncmFkZXNCeUlkKSB7CiAgICAgICAgICAgICAgICB2YXIgbWUgPSBHYW1lLlVwZ3JhZGVzQnlJZFtpXTsKICAgICAgICAgICAgICAgIGlmIChzcGxbaV0pIHsKICAgICAgICAgICAgICAgICAgdmFyIG1lc3RyID0gc3BsW2ldLnNwbGl0KCIsIik7CiAgICAgICAgICAgICAgICAgIG1lLnVubG9ja2VkID0gcGFyc2VJbnQobWVzdHJbMF0pOwogICAgICAgICAgICAgICAgICBtZS5ib3VnaHQgPSBwYXJzZUludChtZXN0clsxXSk7CiAgICAgICAgICAgICAgICAgIGlmIChtZS5ib3VnaHQgJiYgR2FtZS5Db3VudHNBc1VwZ3JhZGVPd25lZChtZS5wb29sKSkKICAgICAgICAgICAgICAgICAgICBHYW1lLlVwZ3JhZGVzT3duZWQrKzsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIG1lLnVubG9ja2VkID0gMDsKICAgICAgICAgICAgICAgICAgbWUuYm91Z2h0ID0gMDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKHN0cls3XSkgc3BsID0gc3RyWzddLnNwbGl0KCI7Iik7CiAgICAgICAgICAgICAgZWxzZSBzcGwgPSBbXTsgLy9hY2hpZXZlbWVudHMKICAgICAgICAgICAgICBHYW1lLkFjaGlldmVtZW50c093bmVkID0gMDsKICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuQWNoaWV2ZW1lbnRzQnlJZCkgewogICAgICAgICAgICAgICAgdmFyIG1lID0gR2FtZS5BY2hpZXZlbWVudHNCeUlkW2ldOwogICAgICAgICAgICAgICAgaWYgKHNwbFtpXSkgewogICAgICAgICAgICAgICAgICB2YXIgbWVzdHIgPSBzcGxbaV0uc3BsaXQoIiwiKTsKICAgICAgICAgICAgICAgICAgbWUud29uID0gcGFyc2VJbnQobWVzdHJbMF0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgbWUud29uID0gMDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChtZS53b24gJiYgR2FtZS5Db3VudHNBc0FjaGlldmVtZW50T3duZWQobWUucG9vbCkpCiAgICAgICAgICAgICAgICAgIEdhbWUuQWNoaWV2ZW1lbnRzT3duZWQrKzsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSBpZiAodmVyc2lvbiA8IDEuMDUwMikgewogICAgICAgICAgICAgIC8vb2xkIGF3ZnVsIHBhY2tpbmcgc3lzdGVtCiAgICAgICAgICAgICAgaWYgKHN0cls2XSkgc3BsID0gc3RyWzZdOwogICAgICAgICAgICAgIGVsc2Ugc3BsID0gW107IC8vdXBncmFkZXMKICAgICAgICAgICAgICBpZiAodmVyc2lvbiA8IDEuMDUpIHNwbCA9IFVuY29tcHJlc3NMYXJnZUJpbihzcGwpOwogICAgICAgICAgICAgIGVsc2Ugc3BsID0gdW5wYWNrKHNwbCk7CiAgICAgICAgICAgICAgR2FtZS5VcGdyYWRlc093bmVkID0gMDsKICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuVXBncmFkZXNCeUlkKSB7CiAgICAgICAgICAgICAgICB2YXIgbWUgPSBHYW1lLlVwZ3JhZGVzQnlJZFtpXTsKICAgICAgICAgICAgICAgIGlmIChzcGxbaSAqIDJdKSB7CiAgICAgICAgICAgICAgICAgIHZhciBtZXN0ciA9IFtzcGxbaSAqIDJdLCBzcGxbaSAqIDIgKyAxXV07CiAgICAgICAgICAgICAgICAgIG1lLnVubG9ja2VkID0gcGFyc2VJbnQobWVzdHJbMF0pOwogICAgICAgICAgICAgICAgICBtZS5ib3VnaHQgPSBwYXJzZUludChtZXN0clsxXSk7CiAgICAgICAgICAgICAgICAgIGlmIChtZS5ib3VnaHQgJiYgR2FtZS5Db3VudHNBc1VwZ3JhZGVPd25lZChtZS5wb29sKSkKICAgICAgICAgICAgICAgICAgICBHYW1lLlVwZ3JhZGVzT3duZWQrKzsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIG1lLnVubG9ja2VkID0gMDsKICAgICAgICAgICAgICAgICAgbWUuYm91Z2h0ID0gMDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKHN0cls3XSkgc3BsID0gc3RyWzddOwogICAgICAgICAgICAgIGVsc2Ugc3BsID0gW107IC8vYWNoaWV2ZW1lbnRzCiAgICAgICAgICAgICAgaWYgKHZlcnNpb24gPCAxLjA1KSBzcGwgPSBVbmNvbXByZXNzTGFyZ2VCaW4oc3BsKTsKICAgICAgICAgICAgICBlbHNlIHNwbCA9IHVucGFjayhzcGwpOwogICAgICAgICAgICAgIEdhbWUuQWNoaWV2ZW1lbnRzT3duZWQgPSAwOwogICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5BY2hpZXZlbWVudHNCeUlkKSB7CiAgICAgICAgICAgICAgICB2YXIgbWUgPSBHYW1lLkFjaGlldmVtZW50c0J5SWRbaV07CiAgICAgICAgICAgICAgICBpZiAoc3BsW2ldKSB7CiAgICAgICAgICAgICAgICAgIHZhciBtZXN0ciA9IFtzcGxbaV1dOwogICAgICAgICAgICAgICAgICBtZS53b24gPSBwYXJzZUludChtZXN0clswXSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBtZS53b24gPSAwOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1lLndvbiAmJiBHYW1lLkNvdW50c0FzQWNoaWV2ZW1lbnRPd25lZChtZS5wb29sKSkKICAgICAgICAgICAgICAgICAgR2FtZS5BY2hpZXZlbWVudHNPd25lZCsrOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBpZiAoc3RyWzZdKSBzcGwgPSBzdHJbNl07CiAgICAgICAgICAgICAgZWxzZSBzcGwgPSBbXTsgLy91cGdyYWRlcwogICAgICAgICAgICAgIGlmICh2ZXJzaW9uIDwgMi4wMDQ2KSBzcGwgPSB1bnBhY2syKHNwbCkuc3BsaXQoIiIpOwogICAgICAgICAgICAgIGVsc2Ugc3BsID0gc3BsLnNwbGl0KCIiKTsKICAgICAgICAgICAgICBHYW1lLlVwZ3JhZGVzT3duZWQgPSAwOwogICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5VcGdyYWRlc0J5SWQpIHsKICAgICAgICAgICAgICAgIHZhciBtZSA9IEdhbWUuVXBncmFkZXNCeUlkW2ldOwogICAgICAgICAgICAgICAgaWYgKHNwbFtpICogMl0pIHsKICAgICAgICAgICAgICAgICAgdmFyIG1lc3RyID0gW3NwbFtpICogMl0sIHNwbFtpICogMiArIDFdXTsKICAgICAgICAgICAgICAgICAgbWUudW5sb2NrZWQgPSBwYXJzZUludChtZXN0clswXSk7CiAgICAgICAgICAgICAgICAgIG1lLmJvdWdodCA9IHBhcnNlSW50KG1lc3RyWzFdKTsKICAgICAgICAgICAgICAgICAgaWYgKG1lLmJvdWdodCAmJiBHYW1lLkNvdW50c0FzVXBncmFkZU93bmVkKG1lLnBvb2wpKQogICAgICAgICAgICAgICAgICAgIEdhbWUuVXBncmFkZXNPd25lZCsrOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgbWUudW5sb2NrZWQgPSAwOwogICAgICAgICAgICAgICAgICBtZS5ib3VnaHQgPSAwOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAoc3RyWzddKSBzcGwgPSBzdHJbN107CiAgICAgICAgICAgICAgZWxzZSBzcGwgPSBbXTsgLy9hY2hpZXZlbWVudHMKICAgICAgICAgICAgICBpZiAodmVyc2lvbiA8IDIuMDA0Nikgc3BsID0gdW5wYWNrMihzcGwpLnNwbGl0KCIiKTsKICAgICAgICAgICAgICBlbHNlIHNwbCA9IHNwbC5zcGxpdCgiIik7CiAgICAgICAgICAgICAgR2FtZS5BY2hpZXZlbWVudHNPd25lZCA9IDA7CiAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLkFjaGlldmVtZW50c0J5SWQpIHsKICAgICAgICAgICAgICAgIHZhciBtZSA9IEdhbWUuQWNoaWV2ZW1lbnRzQnlJZFtpXTsKICAgICAgICAgICAgICAgIGlmIChzcGxbaV0pIHsKICAgICAgICAgICAgICAgICAgdmFyIG1lc3RyID0gW3NwbFtpXV07CiAgICAgICAgICAgICAgICAgIG1lLndvbiA9IHBhcnNlSW50KG1lc3RyWzBdKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIG1lLndvbiA9IDA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAobWUud29uICYmIEdhbWUuQ291bnRzQXNBY2hpZXZlbWVudE93bmVkKG1lLnBvb2wpKQogICAgICAgICAgICAgICAgICBHYW1lLkFjaGlldmVtZW50c093bmVkKys7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBHYW1lLmtpbGxCdWZmcygpOwogICAgICAgICAgICB2YXIgYnVmZnNUb0xvYWQgPSBbXTsKICAgICAgICAgICAgc3BsID0gKHN0cls4XSB8fCAiIikuc3BsaXQoIjsiKTsgLy9idWZmcwogICAgICAgICAgICBmb3IgKHZhciBpIGluIHNwbCkgewogICAgICAgICAgICAgIGlmIChzcGxbaV0pIHsKICAgICAgICAgICAgICAgIHZhciBtZXN0ciA9IHNwbFtpXS50b1N0cmluZygpLnNwbGl0KCIsIik7CiAgICAgICAgICAgICAgICBidWZmc1RvTG9hZC5wdXNoKG1lc3RyKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHNwbCA9IChzdHJbOV0gfHwgIiIpLnNwbGl0KCI7Iik7IC8vbW9kIGRhdGEKCiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gc3BsKSB7CiAgICAgICAgICAgICAgaWYgKHNwbFtpXSkgewogICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBzcGxbaV0uc3BsaXQoIjoiKTsKICAgICAgICAgICAgICAgIHZhciBtb2RJZCA9IGRhdGFbMF07CiAgICAgICAgICAgICAgICBpZiAobW9kSWQgPT0gIk1FVEEiKSBjb250aW51ZTsKICAgICAgICAgICAgICAgIGRhdGEuc2hpZnQoKTsKICAgICAgICAgICAgICAgIGRhdGEgPSBHYW1lLnNhZmVMb2FkU3RyaW5nKGRhdGEuam9pbigiOiIpKTsKICAgICAgICAgICAgICAgIEdhbWUubW9kU2F2ZURhdGFbbW9kSWRdID0gZGF0YTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzQnlJZCkgewogICAgICAgICAgICAgIHZhciBtZSA9IEdhbWUuT2JqZWN0c0J5SWRbaV07CiAgICAgICAgICAgICAgaWYgKG1lLmJ1eUZ1bmN0aW9uKSBtZS5idXlGdW5jdGlvbigpOwogICAgICAgICAgICAgIG1lLnJlZnJlc2goKTsKICAgICAgICAgICAgICBpZiAobWUuaWQgPiAwKSB7CiAgICAgICAgICAgICAgICBpZiAobWUubXV0ZWQpIG1lLm11dGUoMSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAodmVyc2lvbiA8IDEuMDUwMykgewogICAgICAgICAgICAgIC8vdXBncmFkZXMgdGhhdCB1c2VkIHRvIGJlIHJlZ3VsYXIsIGJ1dCBhcmUgbm93IGhlYXZlbmx5CiAgICAgICAgICAgICAgdmFyIG1lID0gR2FtZS5VcGdyYWRlc1siUGVyc2lzdGVudCBtZW1vcnkiXTsKICAgICAgICAgICAgICBtZS51bmxvY2tlZCA9IDA7CiAgICAgICAgICAgICAgbWUuYm91Z2h0ID0gMDsKICAgICAgICAgICAgICB2YXIgbWUgPSBHYW1lLlVwZ3JhZGVzWyJTZWFzb24gc3dpdGNoZXIiXTsKICAgICAgICAgICAgICBtZS51bmxvY2tlZCA9IDA7CiAgICAgICAgICAgICAgbWUuYm91Z2h0ID0gMDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKEdhbWUuYmdUeXBlID09IC0xKSBHYW1lLmJnVHlwZSA9IDA7CiAgICAgICAgICAgIGlmIChHYW1lLm1pbGtUeXBlID09IC0xIHx8ICFHYW1lLkFsbE1pbGtzW0dhbWUubWlsa1R5cGVdKQogICAgICAgICAgICAgIEdhbWUubWlsa1R5cGUgPSAwOwoKICAgICAgICAgICAgLy9hZHZhbmNlIHRpbWVycwogICAgICAgICAgICB2YXIgZnJhbWVzRWxhcHNlZCA9IE1hdGguY2VpbCgKICAgICAgICAgICAgICAoKERhdGUubm93KCkgLSBHYW1lLmxhc3REYXRlKSAvIDEwMDApICogR2FtZS5mcHMKICAgICAgICAgICAgKTsKICAgICAgICAgICAgaWYgKEdhbWUucGxlZGdlVCA+IDApCiAgICAgICAgICAgICAgR2FtZS5wbGVkZ2VUID0gTWF0aC5tYXgoR2FtZS5wbGVkZ2VUIC0gZnJhbWVzRWxhcHNlZCwgMSk7CiAgICAgICAgICAgIGlmIChHYW1lLnNlYXNvblQgPiAwKQogICAgICAgICAgICAgIEdhbWUuc2Vhc29uVCA9IE1hdGgubWF4KEdhbWUuc2Vhc29uVCAtIGZyYW1lc0VsYXBzZWQsIDEpOwogICAgICAgICAgICBpZiAoR2FtZS5yZXNlYXJjaFQgPiAwKQogICAgICAgICAgICAgIEdhbWUucmVzZWFyY2hUID0gTWF0aC5tYXgoR2FtZS5yZXNlYXJjaFQgLSBmcmFtZXNFbGFwc2VkLCAxKTsKCiAgICAgICAgICAgIEdhbWUuUmVzZXRXcmlua2xlcnMoKTsKICAgICAgICAgICAgR2FtZS5Mb2FkV3JpbmtsZXJzKAogICAgICAgICAgICAgIHdyaW5rbGVycy5hbW91bnQsCiAgICAgICAgICAgICAgd3JpbmtsZXJzLm51bWJlciwKICAgICAgICAgICAgICB3cmlua2xlcnMuc2hpbmllcywKICAgICAgICAgICAgICB3cmlua2xlcnMuYW1vdW50U2hpbmllcwogICAgICAgICAgICApOwoKICAgICAgICAgICAgLy9yZWNvbXB1dGUgc2Vhc29uIHRyaWdnZXIgcHJpY2VzCiAgICAgICAgICAgIGlmIChHYW1lLkhhcygiU2Vhc29uIHN3aXRjaGVyIikpIHsKICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuc2Vhc29ucykgewogICAgICAgICAgICAgICAgR2FtZS5VbmxvY2soR2FtZS5zZWFzb25zW2ldLnRyaWdnZXIpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBHYW1lLmNvbXB1dGVTZWFzb25QcmljZXMoKTsKCiAgICAgICAgICAgIC8vcmVjb21wdXRlIHByZXN0aWdlCiAgICAgICAgICAgIEdhbWUucHJlc3RpZ2UgPSBNYXRoLmZsb29yKEdhbWUuSG93TXVjaFByZXN0aWdlKEdhbWUuY29va2llc1Jlc2V0KSk7CiAgICAgICAgICAgIC8vaWYgKChHYW1lLmhlYXZlbmx5Q2hpcHMrR2FtZS5oZWF2ZW5seUNoaXBzU3BlbnQpPEdhbWUucHJlc3RpZ2UpCiAgICAgICAgICAgIC8ve0dhbWUuaGVhdmVubHlDaGlwcz1HYW1lLnByZXN0aWdlO0dhbWUuaGVhdmVubHlDaGlwc1NwZW50PTA7fS8vY2hpcHMgb3duZWQgYW5kIHNwZW50IGRvbid0IGFkZCB1cCB0byB0b3RhbCBwcmVzdGlnZT8gc2V0IGNoaXBzIG93bmVkIHRvIHByZXN0aWdlCgogICAgICAgICAgICBHYW1lLmJha2VyeU5hbWVTZXQoYmFrZXJ5TmFtZSk7CgogICAgICAgICAgICBHYW1lLmxvYWRNb2REYXRhKCk7CgogICAgICAgICAgICBpZiAodmVyc2lvbiA9PSAxLjAzNyAmJiBHYW1lLmJldGEpIHsKICAgICAgICAgICAgICAvL2FyZSB3ZSBvcGVuaW5nIHRoZSBuZXcgYmV0YT8gaWYgc28sIHNhdmUgdGhlIG9sZCBiZXRhIHRvIC9iZXRhZHVuZ2VvbnMKICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oCiAgICAgICAgICAgICAgICAiQ29va2llQ2xpY2tlckdhbWVCZXRhRHVuZ2VvbnMiLAogICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCJDb29raWVDbGlja2VyR2FtZUJldGEiKQogICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgR2FtZS5Ob3RpZnkoCiAgICAgICAgICAgICAgICAiQmV0YSBzYXZlIGRhdGEiLAogICAgICAgICAgICAgICAgIllvdXIgYmV0YSBzYXZlIGRhdGEgaGFzIGJlZW4gc2FmZWx5IGV4cG9ydGVkIHRvIC9iZXRhZHVuZ2VvbnMuIiwKICAgICAgICAgICAgICAgIDIwCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfSBlbHNlIGlmICh2ZXJzaW9uID09IDEuMDUwMSAmJiBHYW1lLmJldGEpIHsKICAgICAgICAgICAgICAvL2FyZSB3ZSBvcGVuaW5nIHRoZSBuZXdlciBiZXRhPyBpZiBzbywgc2F2ZSB0aGUgb2xkIGJldGEgdG8gL29sZGJldGEKICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oCiAgICAgICAgICAgICAgICAiQ29va2llQ2xpY2tlckdhbWVPbGQiLAogICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCJDb29raWVDbGlja2VyR2FtZUJldGEiKQogICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgLy9HYW1lLk5vdGlmeSgnQmV0YSBzYXZlIGRhdGEnLCdZb3VyIGJldGEgc2F2ZSBkYXRhIGhhcyBiZWVuIHNhZmVseSBleHBvcnRlZCB0byAvb2xkYmV0YS4nLDIwKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAodmVyc2lvbiA8PSAxLjA0NjYgJiYgIUdhbWUuYmV0YSkgewogICAgICAgICAgICAgIC8vZXhwb3J0IHRoZSBvbGQgMjAxNCB2ZXJzaW9uIHRvIC92MTA0NjYKICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oCiAgICAgICAgICAgICAgICAiQ29va2llQ2xpY2tlckdhbWV2MTA0NjYiLAogICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCJDb29raWVDbGlja2VyR2FtZSIpCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAvL0dhbWUuTm90aWZ5KCdCZXRhIHNhdmUgZGF0YScsJ1lvdXIgc2F2ZSBkYXRhIGhhcyBiZWVuIHNhZmVseSBleHBvcnRlZCB0byAvdjEwNDY2LicsMjApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh2ZXJzaW9uID09IDEuOSkgewogICAgICAgICAgICAgIC8vYXJlIHdlIGltcG9ydGluZyBmcm9tIHRoZSAxLjkgYmV0YT8gcmVtb3ZlIGFsbCBoZWF2ZW5seSB1cGdyYWRlcyBhbmQgcmVmdW5kIGhlYXZlbmx5IGNoaXBzCiAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlVwZ3JhZGVzQnlJZCkgewogICAgICAgICAgICAgICAgdmFyIG1lID0gR2FtZS5VcGdyYWRlc0J5SWRbaV07CiAgICAgICAgICAgICAgICBpZiAobWUuYm91Z2h0ICYmIG1lLnBvb2wgPT0gInByZXN0aWdlIikgewogICAgICAgICAgICAgICAgICBtZS51bmxvY2tlZCA9IDA7CiAgICAgICAgICAgICAgICAgIG1lLmJvdWdodCA9IDA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIEdhbWUuaGVhdmVubHlDaGlwcyA9IEdhbWUucHJlc3RpZ2U7CiAgICAgICAgICAgICAgR2FtZS5oZWF2ZW5seUNoaXBzU3BlbnQgPSAwOwoKICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIEdhbWUuUHJvbXB0KAogICAgICAgICAgICAgICAgICAnPGgzPkJldGEgcGF0Y2g8L2gzPjxkaXYgY2xhc3M9ImJsb2NrIj5XZVwndmUgdHdlYWtlZCBzb21lIHRoaW5ncyBhbmQgZml4ZWQgc29tZSBvdGhlcnMsIHBsZWFzZSBjaGVjayB0aGUgdXBkYXRlIG5vdGVzITxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2Pk9mIG5vdGUgOiBkdWUgdG8gY2hhbmdlcyBpbiBwcmVzdGlnZSBiYWxhbmNpbmcsIGFsbCB5b3VyIGhlYXZlbmx5IHVwZ3JhZGVzIGhhdmUgYmVlbiByZW1vdmVkIGFuZCB5b3VyIGhlYXZlbmx5IGNoaXBzIHJlZnVuZGVkOyB5b3VcJ2xsIGJlIGFibGUgdG8gcmVhbGxvY2F0ZSB0aGVtIG5leHQgdGltZSB5b3UgYXNjZW5kLjxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PlRoYW5rIHlvdSBhZ2FpbiBmb3IgYmV0YS10ZXN0aW5nIENvb2tpZSBDbGlja2VyITwvZGl2PicsCiAgICAgICAgICAgICAgICAgIFtbIkFscmlnaHQgdGhlbiEiLCAiR2FtZS5DbG9zZVByb21wdCgpOyJdXQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICB9LCAyMDApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh2ZXJzaW9uIDw9IDEuMDQ2NikgewogICAgICAgICAgICAgIC8vYXJlIHdlIGxvYWRpbmcgZnJvbSB0aGUgb2xkIGxpdmUgdmVyc2lvbj8gcmVzZXQgSENzCiAgICAgICAgICAgICAgR2FtZS5oZWF2ZW5seUNoaXBzID0gR2FtZS5wcmVzdGlnZTsKICAgICAgICAgICAgICBHYW1lLmhlYXZlbmx5Q2hpcHNTcGVudCA9IDA7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChHYW1lLmFzY2Vuc2lvbk1vZGUgIT0gMSkgewogICAgICAgICAgICAgIGlmIChHYW1lLkhhcygiU3RhcnRlciBraXQiKSkgR2FtZS5PYmplY3RzWyJDdXJzb3IiXS5mcmVlID0gMTA7CiAgICAgICAgICAgICAgaWYgKEdhbWUuSGFzKCJTdGFydGVyIGtpdGNoZW4iKSkgR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0uZnJlZSA9IDU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEdhbWUuQ2FsY3VsYXRlR2FpbnMoKTsKCiAgICAgICAgICAgIHZhciB0aW1lT2ZmbGluZSA9IChEYXRlLm5vdygpIC0gR2FtZS5sYXN0RGF0ZSkgLyAxMDAwOwoKICAgICAgICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPCAxIC8gMTAwMDApIEdhbWUuVE9ZUyA9IDE7IC8vdGVlaGVlIQogICAgICAgICAgICBpZiAoTWF0aC5yYW5kb20oKSA8IDEgLyAxMDAwMCkgR2FtZS5XSU5LTEVSUyA9IDE7IC8vc3F1ZWFrCgogICAgICAgICAgICAvL2NvbXB1dGUgY29va2llcyBlYXJuZWQgd2hpbGUgdGhlIGdhbWUgd2FzIGNsb3NlZAogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgR2FtZS5tb2JpbGUgfHwKICAgICAgICAgICAgICBHYW1lLkhhcygiUGVyZmVjdCBpZGxpbmciKSB8fAogICAgICAgICAgICAgIEdhbWUuSGFzKCJUd2luIEdhdGVzIG9mIFRyYW5zY2VuZGVuY2UiKQogICAgICAgICAgICApIHsKICAgICAgICAgICAgICBpZiAoR2FtZS5IYXMoIlBlcmZlY3QgaWRsaW5nIikpIHsKICAgICAgICAgICAgICAgIHZhciBtYXhUaW1lID0gNjAgKiA2MCAqIDI0ICogMTAwMDAwMDAwMDsKICAgICAgICAgICAgICAgIHZhciBwZXJjZW50ID0gMTAwOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB2YXIgbWF4VGltZSA9IDYwICogNjA7CiAgICAgICAgICAgICAgICBpZiAoR2FtZS5IYXMoIkJlbHBoZWdvciIpKSBtYXhUaW1lICo9IDI7CiAgICAgICAgICAgICAgICBpZiAoR2FtZS5IYXMoIk1hbW1vbiIpKSBtYXhUaW1lICo9IDI7CiAgICAgICAgICAgICAgICBpZiAoR2FtZS5IYXMoIkFiYWRkb24iKSkgbWF4VGltZSAqPSAyOwogICAgICAgICAgICAgICAgaWYgKEdhbWUuSGFzKCJTYXRhbiIpKSBtYXhUaW1lICo9IDI7CiAgICAgICAgICAgICAgICBpZiAoR2FtZS5IYXMoIkFzbW9kZXVzIikpIG1heFRpbWUgKj0gMjsKICAgICAgICAgICAgICAgIGlmIChHYW1lLkhhcygiQmVlbHplYnViIikpIG1heFRpbWUgKj0gMjsKICAgICAgICAgICAgICAgIGlmIChHYW1lLkhhcygiTHVjaWZlciIpKSBtYXhUaW1lICo9IDI7CgogICAgICAgICAgICAgICAgdmFyIHBlcmNlbnQgPSA1OwogICAgICAgICAgICAgICAgaWYgKEdhbWUuSGFzKCJBbmdlbHMiKSkgcGVyY2VudCArPSAxMDsKICAgICAgICAgICAgICAgIGlmIChHYW1lLkhhcygiQXJjaGFuZ2VscyIpKSBwZXJjZW50ICs9IDEwOwogICAgICAgICAgICAgICAgaWYgKEdhbWUuSGFzKCJWaXJ0dWVzIikpIHBlcmNlbnQgKz0gMTA7CiAgICAgICAgICAgICAgICBpZiAoR2FtZS5IYXMoIkRvbWluaW9ucyIpKSBwZXJjZW50ICs9IDEwOwogICAgICAgICAgICAgICAgaWYgKEdhbWUuSGFzKCJDaGVydWJpbSIpKSBwZXJjZW50ICs9IDEwOwogICAgICAgICAgICAgICAgaWYgKEdhbWUuSGFzKCJTZXJhcGhpbSIpKSBwZXJjZW50ICs9IDEwOwogICAgICAgICAgICAgICAgaWYgKEdhbWUuSGFzKCJHb2QiKSkgcGVyY2VudCArPSAxMDsKCiAgICAgICAgICAgICAgICBpZiAoR2FtZS5IYXMoIkNoaW1lcmEiKSkgewogICAgICAgICAgICAgICAgICBtYXhUaW1lICs9IDYwICogNjAgKiAyNCAqIDI7CiAgICAgICAgICAgICAgICAgIHBlcmNlbnQgKz0gNTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoR2FtZS5IYXMoIkZlcm4gdGVhIikpIHBlcmNlbnQgKz0gMzsKICAgICAgICAgICAgICAgIGlmIChHYW1lLkhhcygiSWNob3Igc3lydXAiKSkgcGVyY2VudCArPSA3OwogICAgICAgICAgICAgICAgaWYgKEdhbWUuSGFzKCJGb3J0dW5lICMxMDIiKSkgcGVyY2VudCArPSAxOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdmFyIHRpbWVPZmZsaW5lT3B0aW1hbCA9IE1hdGgubWluKHRpbWVPZmZsaW5lLCBtYXhUaW1lKTsKICAgICAgICAgICAgICB2YXIgdGltZU9mZmxpbmVSZWR1Y2VkID0gTWF0aC5tYXgoCiAgICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgICAgdGltZU9mZmxpbmUgLSB0aW1lT2ZmbGluZU9wdGltYWwKICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIHZhciBhbW91bnQgPQogICAgICAgICAgICAgICAgKHRpbWVPZmZsaW5lT3B0aW1hbCArIHRpbWVPZmZsaW5lUmVkdWNlZCAqIDAuMSkgKgogICAgICAgICAgICAgICAgR2FtZS5jb29raWVzUHMgKgogICAgICAgICAgICAgICAgKHBlcmNlbnQgLyAxMDApOwoKICAgICAgICAgICAgICBpZiAoYW1vdW50ID4gMCkgewogICAgICAgICAgICAgICAgR2FtZS5Ob3RpZnkoCiAgICAgICAgICAgICAgICAgIGxvYygiV2VsY29tZSBiYWNrISIpLAogICAgICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAgICAgIllvdSBlYXJuZWQgPGI+JTE8L2I+IHdoaWxlIHlvdSB3ZXJlIGF3YXkuIiwKICAgICAgICAgICAgICAgICAgICBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeShhbW91bnQpKQogICAgICAgICAgICAgICAgICApICsKICAgICAgICAgICAgICAgICAgICAoRU4KICAgICAgICAgICAgICAgICAgICAgID8gIjxicj4oIiArCiAgICAgICAgICAgICAgICAgICAgICAgIEdhbWUuc2F5VGltZSh0aW1lT2ZmbGluZU9wdGltYWwgKiBHYW1lLmZwcywgLTEpICsKICAgICAgICAgICAgICAgICAgICAgICAgIiBhdCAiICsKICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5mbG9vcihwZXJjZW50KSArCiAgICAgICAgICAgICAgICAgICAgICAgICIlIENwUyIgKwogICAgICAgICAgICAgICAgICAgICAgICAodGltZU9mZmxpbmVSZWR1Y2VkCiAgICAgICAgICAgICAgICAgICAgICAgICAgPyAiLCBwbHVzICIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgR2FtZS5zYXlUaW1lKHRpbWVPZmZsaW5lUmVkdWNlZCAqIEdhbWUuZnBzLCAtMSkgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgIiBhdCAiICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGguZmxvb3IocGVyY2VudCAqIDEwKSAvIDEwMCArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiJSIKICAgICAgICAgICAgICAgICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAgICAgICAgICAgICAgICIuKSIKICAgICAgICAgICAgICAgICAgICAgIDogIiIpLAogICAgICAgICAgICAgICAgICBbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTYpLCAxMV0KICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICBHYW1lLkVhcm4oYW1vdW50KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vd2UgbG9hZCBidWZmcyBhZnRlciBldmVyeXRoaW5nIGFzIHdlIGRvIG5vdCB3YW50IHRoZW0gdG8gaW50ZXJmZXIgd2l0aCBvZmZsaW5lIENwUwogICAgICAgICAgICBmb3IgKHZhciBpIGluIGJ1ZmZzVG9Mb2FkKSB7CiAgICAgICAgICAgICAgdmFyIG1lc3RyID0gYnVmZnNUb0xvYWRbaV07CiAgICAgICAgICAgICAgdmFyIHR5cGUgPSBHYW1lLmJ1ZmZUeXBlc1twYXJzZUludChtZXN0clswXSldOwogICAgICAgICAgICAgIEdhbWUuZ2FpbkJ1ZmYoCiAgICAgICAgICAgICAgICB0eXBlLm5hbWUsCiAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KG1lc3RyWzFdKSAvIEdhbWUuZnBzLAogICAgICAgICAgICAgICAgcGFyc2VGbG9hdChtZXN0clszXSB8fCAwKSwKICAgICAgICAgICAgICAgIHBhcnNlRmxvYXQobWVzdHJbNF0gfHwgMCksCiAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KG1lc3RyWzVdIHx8IDApCiAgICAgICAgICAgICAgKS50aW1lID0gcGFyc2VGbG9hdChtZXN0clsyXSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEdhbWUubG9hZEx1bXBzKHRpbWVPZmZsaW5lKTsKCiAgICAgICAgICAgIEdhbWUuYmFrZXJ5TmFtZVJlZnJlc2goKTsKICAgICAgICAgIH0gLy9pbXBvcnRpbmcgb2xkIHZlcnNpb24gc2F2ZQogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgICAgIGxvYygiRXJyb3IgaW1wb3J0aW5nIHNhdmUiKSwKICAgICAgICAgICAgICBsb2MoIlNvcnJ5LCB5b3UgY2FuJ3QgaW1wb3J0IHNhdmVzIGZyb20gdGhlIGNsYXNzaWMgdmVyc2lvbi4iKSwKICAgICAgICAgICAgICAiIiwKICAgICAgICAgICAgICA2LAogICAgICAgICAgICAgIDEKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChHYW1lLnByZWZzLnNjcmVlbnJlYWRlcikgewogICAgICAgICAgICBHYW1lLkJ1aWxkU3RvcmUoKTsKICAgICAgICAgIH0KCiAgICAgICAgICBHYW1lLlJlYnVpbGRVcGdyYWRlcygpOwoKICAgICAgICAgIEdhbWUuVGlja2VyQWdlID0gMDsKICAgICAgICAgIEdhbWUuVGlja2VyRWZmZWN0ID0gMDsKCiAgICAgICAgICBHYW1lLmVsZGVyV3JhdGhEID0gMDsKICAgICAgICAgIEdhbWUucmVjYWxjdWxhdGVHYWlucyA9IDE7CiAgICAgICAgICBHYW1lLnN0b3JlVG9SZWZyZXNoID0gMTsKICAgICAgICAgIEdhbWUudXBncmFkZXNUb1JlYnVpbGQgPSAxOwoKICAgICAgICAgIEdhbWUuYnV5QnVsayA9IDE7CiAgICAgICAgICBHYW1lLmJ1eU1vZGUgPSAxOwogICAgICAgICAgR2FtZS5zdG9yZUJ1bGtCdXR0b24oLTEpOwoKICAgICAgICAgIEdhbWUuc3BlY2lhbFRhYiA9ICIiOwogICAgICAgICAgR2FtZS5Ub2dnbGVTcGVjaWFsTWVudSgwKTsKCiAgICAgICAgICBHYW1lLmtpbGxTaGltbWVycygpOwoKICAgICAgICAgIGlmIChHYW1lLlQgPiBHYW1lLmZwcyAqIDUgJiYgR2FtZS5SZWluY2FybmF0ZVRpbWVyID09IDApIHsKICAgICAgICAgICAgLy9mYWRlIG91dCBvZiBibGFjayBhbmQgcG9wIHRoZSBjb29raWUKICAgICAgICAgICAgR2FtZS5SZWluY2FybmF0ZVRpbWVyID0gMTsKICAgICAgICAgICAgR2FtZS5hZGRDbGFzcygicmVpbmNhcm5hdGluZyIpOwogICAgICAgICAgICBHYW1lLkJpZ0Nvb2tpZVNpemUgPSAwOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBwcmVzdGlnZVVwZ3JhZGVzT3duZWQgPSAwOwogICAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlVwZ3JhZGVzKSB7CiAgICAgICAgICAgIGlmIChHYW1lLlVwZ3JhZGVzW2ldLmJvdWdodCAmJiBHYW1lLlVwZ3JhZGVzW2ldLnBvb2wgPT0gInByZXN0aWdlIikKICAgICAgICAgICAgICBwcmVzdGlnZVVwZ3JhZGVzT3duZWQrKzsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChwcmVzdGlnZVVwZ3JhZGVzT3duZWQgPj0gMTAwKSBHYW1lLldpbigiQWxsIHRoZSBzdGFycyBpbiBoZWF2ZW4iKTsKCiAgICAgICAgICBpZiAodmVyc2lvbiA8IEdhbWUudmVyc2lvbikgbCgibG9nQnV0dG9uIikuY2xhc3NMaXN0LmFkZCgiaGFzVXBkYXRlIik7CgogICAgICAgICAgaWYgKEdhbWUuc2Vhc29uICE9ICIiICYmIEdhbWUuc2Vhc29uID09IEdhbWUuYmFzZVNlYXNvbikgewogICAgICAgICAgICBpZiAoR2FtZS5zZWFzb24gPT0gInZhbGVudGluZXMiKQogICAgICAgICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgICAgICAgbG9jKCJWYWxlbnRpbmUncyBEYXkhIiksCiAgICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAgICJJdCdzIDxiPlZhbGVudGluZSdzIHNlYXNvbjwvYj4hPGJyPkxvdmUncyBpbiB0aGUgYWlyIGFuZCBjb29raWVzIGFyZSBqdXN0IHRoYXQgbXVjaCBzd2VldGVyISIKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBbMjAsIDNdLAogICAgICAgICAgICAgICAgNjAgKiAzCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgZWxzZSBpZiAoR2FtZS5zZWFzb24gPT0gImZvb2xzIikKICAgICAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgICAgIGxvYygiQnVzaW5lc3MgRGF5ISIpLAogICAgICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICAgICAiSXQncyA8Yj5CdXNpbmVzcyBzZWFzb248L2I+ITxicj5Eb24ndCBwYW5pYyEgVGhpbmdzIGFyZSBnb25uYSBiZSBsb29raW5nIGEgbGl0dGxlIG1vcmUgY29ycG9yYXRlIGZvciBhIGZldyBkYXlzLiIKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBbMTcsIDZdLAogICAgICAgICAgICAgICAgNjAgKiAzCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgZWxzZSBpZiAoR2FtZS5zZWFzb24gPT0gImhhbGxvd2VlbiIpCiAgICAgICAgICAgICAgR2FtZS5Ob3RpZnkoCiAgICAgICAgICAgICAgICBsb2MoIkhhbGxvd2VlbiEiKSwKICAgICAgICAgICAgICAgIGxvYygKICAgICAgICAgICAgICAgICAgIkl0J3MgPGI+SGFsbG93ZWVuIHNlYXNvbjwvYj4hPGJyPkV2ZXJ5dGhpbmcgaXMganVzdCBhIGxpdHRsZSBiaXQgc3Bvb2tpZXIhIgogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIFsxMywgOF0sCiAgICAgICAgICAgICAgICA2MCAqIDMKICAgICAgICAgICAgICApOwogICAgICAgICAgICBlbHNlIGlmIChHYW1lLnNlYXNvbiA9PSAiY2hyaXN0bWFzIikKICAgICAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgICAgIGxvYygiQ2hyaXN0bWFzIHRpbWUhIiksCiAgICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAgICJJdCdzIDxiPkNocmlzdG1hcyBzZWFzb248L2I+ITxicj5CcmluZyBnb29kIGNoZWVyIHRvIGFsbCBhbmQgeW91IGp1c3QgbWF5IGdldCBjb29raWVzIGluIHlvdXIgc3RvY2tpbmdzISIKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBbMTIsIDEwXSwKICAgICAgICAgICAgICAgIDYwICogMwogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGVsc2UgaWYgKEdhbWUuc2Vhc29uID09ICJlYXN0ZXIiKQogICAgICAgICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgICAgICAgbG9jKCJFYXN0ZXIhIiksCiAgICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAgICJJdCdzIDxiPkVhc3RlciBzZWFzb248L2I+ITxicj5LZWVwIGFuIGV5ZSBvdXQgYW5kIHlvdSBqdXN0IG1pZ2h0IGNsaWNrIGEgcmFiYml0IG9yIHR3byEiCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgWzAsIDEyXSwKICAgICAgICAgICAgICAgIDYwICogMwogICAgICAgICAgICAgICk7CiAgICAgICAgICB9CgogICAgICAgICAgR2FtZS5oZXJhbGRzID0gYWN0dWFsSGVyYWxkczsKCiAgICAgICAgICBHYW1lLk5vdGlmeShsb2MoIkdhbWUgbG9hZGVkIiksICIiLCAiIiwgMSwgMSk7CgogICAgICAgICAgaWYgKCFBcHAgJiYgR2FtZS5wcmVmcy5zaG93QmFja3VwV2FybmluZyA9PSAxKQogICAgICAgICAgICBHYW1lLnNob3dCYWNrdXBXYXJuaW5nKCk7CgogICAgICAgICAgaWYgKEFwcCkgQXBwLmp1c3RMb2FkZWRTYXZlKCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgcmV0dXJuIGZhbHNlOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH07CgogICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkJUkVTRVQKCQk9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgR2FtZS5SZXNldCA9IGZ1bmN0aW9uIChoYXJkKSB7CiAgICAgIEdhbWUuVCA9IDA7CgogICAgICBpZiAoaGFyZCkgewogICAgICAgIEdhbWUubG9hZGVkRnJvbVZlcnNpb24gPSBHYW1lLnZlcnNpb247CiAgICAgIH0KCiAgICAgIHZhciBjb29raWVzRm9yZmVpdGVkID0gR2FtZS5jb29raWVzRWFybmVkOwogICAgICBpZiAoIWhhcmQpIHsKICAgICAgICBpZiAoY29va2llc0ZvcmZlaXRlZCA+PSAxMDAwMDAwKSBHYW1lLldpbigiU2FjcmlmaWNlIik7CiAgICAgICAgaWYgKGNvb2tpZXNGb3JmZWl0ZWQgPj0gMTAwMDAwMDAwMCkgR2FtZS5XaW4oIk9ibGl2aW9uIik7CiAgICAgICAgaWYgKGNvb2tpZXNGb3JmZWl0ZWQgPj0gMTAwMDAwMDAwMDAwMCkgR2FtZS5XaW4oIkZyb20gc2NyYXRjaCIpOwogICAgICAgIGlmIChjb29raWVzRm9yZmVpdGVkID49IDEwMDAwMDAwMDAwMDAwMDApIEdhbWUuV2luKCJOaWhpbGlzbSIpOwogICAgICAgIGlmIChjb29raWVzRm9yZmVpdGVkID49IDEwMDAwMDAwMDAwMDAwMDAwMDApIEdhbWUuV2luKCJEZW1hdGVyaWFsaXplIik7CiAgICAgICAgaWYgKGNvb2tpZXNGb3JmZWl0ZWQgPj0gMTAwMDAwMDAwMDAwMDAwMDAwMDAwMCkKICAgICAgICAgIEdhbWUuV2luKCJOaWwgemVybyB6aWxjaCIpOwogICAgICAgIGlmIChjb29raWVzRm9yZmVpdGVkID49IDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDApCiAgICAgICAgICBHYW1lLldpbigiVHJhbnNjZW5kZW5jZSIpOwogICAgICAgIGlmIChjb29raWVzRm9yZmVpdGVkID49IDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDApCiAgICAgICAgICBHYW1lLldpbigiT2JsaXRlcmF0ZSIpOwogICAgICAgIGlmIChjb29raWVzRm9yZmVpdGVkID49IDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDApCiAgICAgICAgICBHYW1lLldpbigiTmVnYXRpdmUgdm9pZCIpOwogICAgICAgIGlmIChjb29raWVzRm9yZmVpdGVkID49IDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDApCiAgICAgICAgICBHYW1lLldpbigiVG8gY3J1bWJzLCB5b3Ugc2F5PyIpOwogICAgICAgIGlmIChjb29raWVzRm9yZmVpdGVkID49IDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDApCiAgICAgICAgICBHYW1lLldpbigiWW91IGdldCBub3RoaW5nIik7CiAgICAgICAgaWYgKGNvb2tpZXNGb3JmZWl0ZWQgPj0gMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCkKICAgICAgICAgIEdhbWUuV2luKCJIdW1ibGUgcmViZWdpbm5pbmdzIik7CiAgICAgICAgaWYgKGNvb2tpZXNGb3JmZWl0ZWQgPj0gMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCkKICAgICAgICAgIEdhbWUuV2luKCJUaGUgZW5kIG9mIHRoZSB3b3JsZCIpOwogICAgICAgIGlmIChjb29raWVzRm9yZmVpdGVkID49IDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDApCiAgICAgICAgICBHYW1lLldpbigiT2gsIHlvdSdyZSBiYWNrIik7CiAgICAgICAgaWYgKAogICAgICAgICAgY29va2llc0ZvcmZlaXRlZCA+PSAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwCiAgICAgICAgKQogICAgICAgICAgR2FtZS5XaW4oIkxhemFydXMiKTsKICAgICAgICBpZiAoCiAgICAgICAgICBjb29raWVzRm9yZmVpdGVkID49CiAgICAgICAgICAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwCiAgICAgICAgKQogICAgICAgICAgR2FtZS5XaW4oIlNtdXJmIGFjY291bnQiKTsKICAgICAgICBpZiAoCiAgICAgICAgICBjb29raWVzRm9yZmVpdGVkID49CiAgICAgICAgICAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwCiAgICAgICAgKQogICAgICAgICAgR2FtZS5XaW4oIklmIGF0IGZpcnN0IHlvdSBkb24ndCBzdWNjZWVkIik7CgogICAgICAgIGlmIChNYXRoLnJvdW5kKEdhbWUuY29va2llcykgPT0gMTAwMDAwMDAwMDAwMCkKICAgICAgICAgIEdhbWUuV2luKCJXaGVuIHRoZSBjb29raWVzIGFzY2VuZCBqdXN0IHJpZ2h0Iik7CiAgICAgIH0KCiAgICAgIEdhbWUua2lsbEJ1ZmZzKCk7CgogICAgICBHYW1lLnNlZWQgPSBHYW1lLm1ha2VTZWVkKCk7CgogICAgICBHYW1lLmNvb2tpZXNSZXNldCArPSBHYW1lLmNvb2tpZXNFYXJuZWQ7CiAgICAgIEdhbWUuY29va2llcyA9IDA7CiAgICAgIEdhbWUuY29va2llc0Vhcm5lZCA9IDA7CiAgICAgIEdhbWUuY29va2llQ2xpY2tzID0gMDsKICAgICAgR2FtZS5nb2xkZW5DbGlja3NMb2NhbCA9IDA7CiAgICAgIC8vR2FtZS5nb2xkZW5DbGlja3M9MDsKICAgICAgLy9HYW1lLm1pc3NlZEdvbGRlbkNsaWNrcz0wOwogICAgICBHYW1lLmhhbmRtYWRlQ29va2llcyA9IDA7CiAgICAgIEdhbWUuY29va2llc1BzUmF3SGlnaGVzdCA9IDA7CiAgICAgIGlmIChoYXJkKSB7CiAgICAgICAgR2FtZS5iZ1R5cGUgPSAwOwogICAgICAgIEdhbWUubWlsa1R5cGUgPSAwOwogICAgICAgIEdhbWUuY2hpbWVUeXBlID0gMDsKCiAgICAgICAgR2FtZS52YXVsdCA9IFtdOwogICAgICB9CiAgICAgIEdhbWUucGxlZGdlcyA9IDA7CiAgICAgIEdhbWUucGxlZGdlVCA9IDA7CiAgICAgIEdhbWUuZWxkZXJXcmF0aCA9IDA7CiAgICAgIEdhbWUuZWxkZXJXcmF0aE9sZCA9IDA7CiAgICAgIEdhbWUuZWxkZXJXcmF0aEQgPSAwOwogICAgICBHYW1lLm5leHRSZXNlYXJjaCA9IDA7CiAgICAgIEdhbWUucmVzZWFyY2hUID0gMDsKICAgICAgR2FtZS5zZWFzb25UID0gMDsKICAgICAgR2FtZS5zZWFzb25Vc2VzID0gMDsKICAgICAgR2FtZS5zZWFzb24gPSBHYW1lLmJhc2VTZWFzb247CiAgICAgIEdhbWUuY29tcHV0ZVNlYXNvblByaWNlcygpOwoKICAgICAgR2FtZS5zdGFydERhdGUgPSBwYXJzZUludChEYXRlLm5vdygpKTsKICAgICAgR2FtZS5sYXN0RGF0ZSA9IHBhcnNlSW50KERhdGUubm93KCkpOwoKICAgICAgR2FtZS5jb29raWVzU3Vja2VkID0gMDsKICAgICAgR2FtZS53cmlua2xlcnNQb3BwZWQgPSAwOwogICAgICBHYW1lLlJlc2V0V3JpbmtsZXJzKCk7CgogICAgICBHYW1lLnNhbnRhTGV2ZWwgPSAwOwogICAgICBHYW1lLnJlaW5kZWVyQ2xpY2tlZCA9IDA7CgogICAgICBHYW1lLmRyYWdvbkxldmVsID0gMDsKICAgICAgR2FtZS5kcmFnb25BdXJhID0gMDsKICAgICAgR2FtZS5kcmFnb25BdXJhMiA9IDA7CgogICAgICBHYW1lLmZvcnR1bmVHQyA9IDA7CiAgICAgIEdhbWUuZm9ydHVuZUNQUyA9IDA7CgogICAgICBHYW1lLlRpY2tlckNsaWNrcyA9IDA7CgogICAgICBpZiAoR2FtZS5nYWluZWRQcmVzdGlnZSA+IDApIEdhbWUucmVzZXRzKys7CiAgICAgIGlmICghaGFyZCAmJiBHYW1lLmNhbkx1bXBzKCkgJiYgR2FtZS5hc2NlbnNpb25Nb2RlICE9IDEpCiAgICAgICAgR2FtZS5hZGRDbGFzcygibHVtcHNPbiIpOwogICAgICBlbHNlIEdhbWUucmVtb3ZlQ2xhc3MoImx1bXBzT24iKTsKICAgICAgR2FtZS5nYWluZWRQcmVzdGlnZSA9IDA7CgogICAgICBmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0c0J5SWQpIHsKICAgICAgICB2YXIgbWUgPSBHYW1lLk9iamVjdHNCeUlkW2ldOwogICAgICAgIG1lLmFtb3VudCA9IDA7CiAgICAgICAgbWUuYm91Z2h0ID0gMDsKICAgICAgICBtZS5oaWdoZXN0ID0gMDsKICAgICAgICBtZS5mcmVlID0gMDsKICAgICAgICBtZS50b3RhbENvb2tpZXMgPSAwOwogICAgICAgIG1lLnN3aXRjaE1pbmlnYW1lKGZhbHNlKTsKICAgICAgICBpZiAoaGFyZCkgewogICAgICAgICAgbWUubXV0ZWQgPSAwOwogICAgICAgIH0KICAgICAgICBtZS5waWNzID0gW107CiAgICAgICAgbWUucmVmcmVzaCgpOwogICAgICB9CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5VcGdyYWRlc0J5SWQpIHsKICAgICAgICB2YXIgbWUgPSBHYW1lLlVwZ3JhZGVzQnlJZFtpXTsKICAgICAgICBpZiAoaGFyZCB8fCBtZS5wb29sICE9ICJwcmVzdGlnZSIpIG1lLmJvdWdodCA9IDA7CiAgICAgICAgaWYgKGhhcmQpIG1lLnVubG9ja2VkID0gMDsKICAgICAgICBpZiAobWUucG9vbCAhPSAicHJlc3RpZ2UiICYmICFtZS5sYXN0aW5nKSB7CiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIEdhbWUuSGFzKCJLZWVwc2FrZXMiKSAmJgogICAgICAgICAgICBHYW1lLnNlYXNvbkRyb3BzLmluZGV4T2YobWUubmFtZSkgIT0gLTEgJiYKICAgICAgICAgICAgTWF0aC5yYW5kb20oKSA8IDEgLyA1CiAgICAgICAgICApIHsKICAgICAgICAgIH0gZWxzZSBpZiAoCiAgICAgICAgICAgIEdhbWUuYXNjZW5zaW9uTW9kZSA9PSAxICYmCiAgICAgICAgICAgIEdhbWUuSGFzQWNoaWV2KCJPIEZvcnR1bmEiKSAmJgogICAgICAgICAgICBtZS50aWVyID09ICJmb3J0dW5lIgogICAgICAgICAgKSB7CiAgICAgICAgICB9IGVsc2UgaWYgKAogICAgICAgICAgICBHYW1lLkhhc0FjaGlldigiTyBGb3J0dW5hIikgJiYKICAgICAgICAgICAgbWUudGllciA9PSAiZm9ydHVuZSIgJiYKICAgICAgICAgICAgTWF0aC5yYW5kb20oKSA8IDAuNAogICAgICAgICAgKSB7CiAgICAgICAgICB9IGVsc2UgbWUudW5sb2NrZWQgPSAwOwogICAgICAgIH0KICAgICAgfQoKICAgICAgR2FtZS5CdWlsZGluZ3NPd25lZCA9IDA7CiAgICAgIEdhbWUuVXBncmFkZXNPd25lZCA9IDA7CgogICAgICBHYW1lLmNvb2tpZXNQc0J5VHlwZSA9IHt9OwogICAgICBHYW1lLmNvb2tpZXNNdWx0QnlUeXBlID0ge307CgogICAgICBpZiAoIWhhcmQpIHsKICAgICAgICBpZiAoR2FtZS5hc2NlbnNpb25Nb2RlICE9IDEpIHsKICAgICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5wZXJtYW5lbnRVcGdyYWRlcykgewogICAgICAgICAgICBpZiAoR2FtZS5wZXJtYW5lbnRVcGdyYWRlc1tpXSAhPSAtMSkgewogICAgICAgICAgICAgIEdhbWUuVXBncmFkZXNCeUlkW0dhbWUucGVybWFuZW50VXBncmFkZXNbaV1dLmVhcm4oKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgaWYgKEdhbWUuSGFzKCJTZWFzb24gc3dpdGNoZXIiKSkgewogICAgICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuc2Vhc29ucykgewogICAgICAgICAgICAgIEdhbWUuVW5sb2NrKEdhbWUuc2Vhc29uc1tpXS50cmlnZ2VyKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGlmIChHYW1lLkhhcygiU3RhcnRlciBraXQiKSkgR2FtZS5PYmplY3RzWyJDdXJzb3IiXS5nZXRGcmVlKDEwKTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiU3RhcnRlciBraXRjaGVuIikpIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLmdldEZyZWUoNSk7CiAgICAgICAgfQogICAgICB9CgogICAgICAvKmZvciAodmFyIGkgaW4gR2FtZS5BY2hpZXZlbWVudHNCeUlkKQoJCQl7CgkJCQl2YXIgbWU9R2FtZS5BY2hpZXZlbWVudHNCeUlkW2ldOwoJCQkJbWUud29uPTA7CgkJCX0qLwogICAgICAvL0dhbWUuRGVmYXVsdFByZWZzKCk7CiAgICAgIEJlYXV0aWZ5QWxsKCk7CgogICAgICBHYW1lLlJlYnVpbGRVcGdyYWRlcygpOwogICAgICBHYW1lLlRpY2tlckFnZSA9IDA7CiAgICAgIEdhbWUuVGlja2VyRWZmZWN0ID0gMDsKICAgICAgR2FtZS5yZWNhbGN1bGF0ZUdhaW5zID0gMTsKICAgICAgR2FtZS5zdG9yZVRvUmVmcmVzaCA9IDE7CiAgICAgIEdhbWUudXBncmFkZXNUb1JlYnVpbGQgPSAxOwogICAgICBHYW1lLmtpbGxTaGltbWVycygpOwoKICAgICAgR2FtZS5idXlCdWxrID0gMTsKICAgICAgR2FtZS5idXlNb2RlID0gMTsKICAgICAgR2FtZS5zdG9yZUJ1bGtCdXR0b24oLTEpOwoKICAgICAgR2FtZS5Mb2FkTWluaWdhbWVzKCk7CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzQnlJZCkgewogICAgICAgIHZhciBtZSA9IEdhbWUuT2JqZWN0c0J5SWRbaV07CiAgICAgICAgaWYgKGhhcmQgJiYgbWUubWluaWdhbWUgJiYgbWUubWluaWdhbWUubGF1bmNoKSB7CiAgICAgICAgICBtZS5taW5pZ2FtZS5sYXVuY2goKTsKICAgICAgICAgIG1lLm1pbmlnYW1lLnJlc2V0KHRydWUpOwogICAgICAgIH0gZWxzZSBpZiAoIWhhcmQgJiYgbWUubWluaWdhbWUgJiYgbWUubWluaWdhbWUucmVzZXQpCiAgICAgICAgICBtZS5taW5pZ2FtZS5yZXNldCgpOwogICAgICB9CgogICAgICBsKCJ0b2dnbGVCb3giKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICBsKCJ0b2dnbGVCb3giKS5pbm5lckhUTUwgPSAiIjsKICAgICAgR2FtZS5jaG9pY2VTZWxlY3Rvck9uID0gLTE7CiAgICAgIEdhbWUuVG9nZ2xlU3BlY2lhbE1lbnUoMCk7CiAgICAgIEdhbWUuc3BlY2lhbFRhYiA9ICIiOwoKICAgICAgbCgibG9nQnV0dG9uIikuY2xhc3NMaXN0LnJlbW92ZSgiaGFzVXBkYXRlIik7CgogICAgICBHYW1lLnJ1bk1vZEhvb2soInJlc2V0IiwgaGFyZCk7CgogICAgICBpZiAoaGFyZCkgewogICAgICAgIEdhbWUuY2xpY2tzVGhpc1Nlc3Npb24gPSAwOwogICAgICAgIGlmIChHYW1lLlQgPiBHYW1lLmZwcyAqIDUgJiYgR2FtZS5SZWluY2FybmF0ZVRpbWVyID09IDApIHsKICAgICAgICAgIC8vZmFkZSBvdXQgb2YgYmxhY2sgYW5kIHBvcCB0aGUgY29va2llCiAgICAgICAgICBHYW1lLlJlaW5jYXJuYXRlVGltZXIgPSAxOwogICAgICAgICAgR2FtZS5hZGRDbGFzcygicmVpbmNhcm5hdGluZyIpOwogICAgICAgICAgR2FtZS5CaWdDb29raWVTaXplID0gMDsKICAgICAgICB9CiAgICAgICAgR2FtZS5Ob3RpZnkoCiAgICAgICAgICBsb2MoIkdhbWUgcmVzZXQiKSwKICAgICAgICAgIEVOID8gIlNvIGxvbmcsIGNvb2tpZXMuIiA6IGxvYygiR29vZCBieWUsIGNvb2tpZXMuIiksCiAgICAgICAgICBbMjEsIDZdLAogICAgICAgICAgNgogICAgICAgICk7CiAgICAgIH0gZWxzZSBHYW1lLmNsaWNrc1RoaXNTZXNzaW9uID0gTWF0aC5tYXgoR2FtZS5jbGlja3NUaGlzU2Vzc2lvbiwgMSk7CgogICAgICBHYW1lLmp1a2Vib3gucmVzZXQoKTsKICAgICAgaWYgKGhhcmQpIFBsYXlDdWUoImxhdW5jaCIpOwogICAgICBlbHNlIFBsYXlDdWUoInBsYXkiKTsKICAgIH07CiAgICBHYW1lLkhhcmRSZXNldCA9IGZ1bmN0aW9uIChieXBhc3MpIHsKICAgICAgaWYgKCFieXBhc3MpIHsKICAgICAgICBHYW1lLlByb21wdCgKICAgICAgICAgICI8aWQgV2lwZVNhdmU+PGgzPiIgKwogICAgICAgICAgICBsb2MoIldpcGUgc2F2ZSIpICsKICAgICAgICAgICAgJzwvaDM+PGRpdiBjbGFzcz0iYmxvY2siPicgKwogICAgICAgICAgICB0aW55SWNvbihbMTUsIDVdKSArCiAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICJEbyB5b3UgUkVBTExZIHdhbnQgdG8gd2lwZSB5b3VyIHNhdmU/PGJyPjxzbWFsbD5Zb3Ugd2lsbCBsb3NlIHlvdXIgcHJvZ3Jlc3MsIHlvdXIgYWNoaWV2ZW1lbnRzLCBhbmQgeW91ciBoZWF2ZW5seSBjaGlwcyE8L3NtYWxsPiIKICAgICAgICAgICAgKSArCiAgICAgICAgICAgICI8L2Rpdj4iLAogICAgICAgICAgWwogICAgICAgICAgICBbCiAgICAgICAgICAgICAgRU4gPyAiWWVzISIgOiBsb2MoIlllcyIpLAogICAgICAgICAgICAgICJHYW1lLkNsb3NlUHJvbXB0KCk7R2FtZS5IYXJkUmVzZXQoMSk7IiwKICAgICAgICAgICAgICAiZmxvYXQ6bGVmdCIsCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIFtsb2MoIk5vIiksIDAsICJmbG9hdDpyaWdodCJdLAogICAgICAgICAgXQogICAgICAgICk7CiAgICAgIH0gZWxzZSBpZiAoYnlwYXNzID09IDEpIHsKICAgICAgICBHYW1lLlByb21wdCgKICAgICAgICAgICI8aWQgUmVhbGx5V2lwZVNhdmU+PGgzPiIgKwogICAgICAgICAgICBsb2MoIldpcGUgc2F2ZSIpICsKICAgICAgICAgICAgJzwvaDM+PGRpdiBjbGFzcz0iYmxvY2siPicgKwogICAgICAgICAgICB0aW55SWNvbihbMTUsIDVdKSArCiAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICJXaG9haCBub3csIGFyZSB5b3UgcmVhbGx5LCA8Yj48aT5SRUFMTFk8L2k+PC9iPiBzdXJlIHlvdSB3YW50IHRvIGdvIHRocm91Z2ggd2l0aCB0aGlzPzxicj48c21hbGw+RG9uJ3Qgc2F5IHdlIGRpZG4ndCB3YXJuIHlvdSE8L3NtYWxsPiIKICAgICAgICAgICAgKSArCiAgICAgICAgICAgICI8L2Rpdj4iLAogICAgICAgICAgWwogICAgICAgICAgICBbCiAgICAgICAgICAgICAgRU4gPyAiRG8gaXQhIiA6IGxvYygiWWVzIiksCiAgICAgICAgICAgICAgIkdhbWUuQ2xvc2VQcm9tcHQoKTtHYW1lLkhhcmRSZXNldCgyKTsiLAogICAgICAgICAgICAgICJmbG9hdDpsZWZ0IiwKICAgICAgICAgICAgXSwKICAgICAgICAgICAgW2xvYygiTm8iKSwgMCwgImZsb2F0OnJpZ2h0Il0sCiAgICAgICAgICBdCiAgICAgICAgKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuQWNoaWV2ZW1lbnRzQnlJZCkgewogICAgICAgICAgdmFyIG1lID0gR2FtZS5BY2hpZXZlbWVudHNCeUlkW2ldOwogICAgICAgICAgbWUud29uID0gMDsKICAgICAgICB9CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHNCeUlkKSB7CiAgICAgICAgICB2YXIgbWUgPSBHYW1lLk9iamVjdHNCeUlkW2ldOwogICAgICAgICAgbWUubGV2ZWwgPSAwOwogICAgICAgIH0KCiAgICAgICAgR2FtZS5BY2hpZXZlbWVudHNPd25lZCA9IDA7CiAgICAgICAgR2FtZS5nb2xkZW5DbGlja3MgPSAwOwogICAgICAgIEdhbWUubWlzc2VkR29sZGVuQ2xpY2tzID0gMDsKICAgICAgICBHYW1lLlJlc2V0KDEpOwogICAgICAgIEdhbWUucmVzZXRzID0gMDsKICAgICAgICBHYW1lLmZ1bGxEYXRlID0gcGFyc2VJbnQoRGF0ZS5ub3coKSk7CiAgICAgICAgR2FtZS5iYWtlcnlOYW1lID0gR2FtZS5HZXRCYWtlcnlOYW1lKCk7CiAgICAgICAgR2FtZS5iYWtlcnlOYW1lUmVmcmVzaCgpOwogICAgICAgIEdhbWUuY29va2llc1Jlc2V0ID0gMDsKICAgICAgICBHYW1lLnByZXN0aWdlID0gMDsKICAgICAgICBHYW1lLmhlYXZlbmx5Q2hpcHMgPSAwOwogICAgICAgIEdhbWUuaGVhdmVubHlDaGlwc1NwZW50ID0gMDsKICAgICAgICBHYW1lLmhlYXZlbmx5Q29va2llcyA9IDA7CiAgICAgICAgR2FtZS5wZXJtYW5lbnRVcGdyYWRlcyA9IFstMSwgLTEsIC0xLCAtMSwgLTFdOwogICAgICAgIEdhbWUuYXNjZW5zaW9uTW9kZSA9IDA7CiAgICAgICAgR2FtZS5sdW1wcyA9IC0xOwogICAgICAgIEdhbWUubHVtcHNUb3RhbCA9IC0xOwogICAgICAgIEdhbWUubHVtcFQgPSBEYXRlLm5vdygpOwogICAgICAgIEdhbWUubHVtcFJlZmlsbCA9IDA7CiAgICAgICAgR2FtZS5yZW1vdmVDbGFzcygibHVtcHNPbiIpOwogICAgICAgIGlmIChBcHApIEFwcC5oYXJkUmVzZXQoKTsKICAgICAgfQogICAgfTsKCiAgICBHYW1lLm9uQ3JhdGUgPSAwOwogICAgR2FtZS5zZXRPbkNyYXRlID0gZnVuY3Rpb24gKHdoYXQpIHsKICAgICAgR2FtZS5vbkNyYXRlID0gd2hhdDsKICAgIH07CiAgICBHYW1lLmNyYXRlID0gZnVuY3Rpb24gKG1lLCBjb250ZXh0LCBmb3JjZUNsaWNrU3RyLCBpZCwgc3R5bGUpIHsKICAgICAgLy9wcm9kdWNlIGEgY3JhdGUgd2l0aCBhc3NvY2lhdGVkIHRvb2x0aXAgZm9yIGFuIHVwZ3JhZGUgb3IgYWNoaWV2ZW1lbnQKICAgICAgLy9tZSBpcyBhbiBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSB1cGdyYWRlIG9yIGFjaGlldmVtZW50CiAgICAgIC8vY29udGV4dCBjYW4gYmUgInN0b3JlIiwgImFzY2VuZCIsICJzdGF0cyIgb3IgdW5kZWZpbmVkCiAgICAgIC8vZm9yY2VDbGlja1N0ciBjaGFuZ2VzIHdoYXQgaXMgZG9uZSB3aGVuIHRoZSBjcmF0ZSBpcyBjbGlja2VkCiAgICAgIC8vaWQgaXMgdGhlIHJlc3VsdGluZyBkaXYncyBkZXNpcmVkIGlkCgogICAgICB2YXIgY2xhc3NlcyA9ICJjcmF0ZSI7CiAgICAgIHZhciBlbmFibGVkID0gMDsKICAgICAgdmFyIG5vRnJhbWUgPSAwOwogICAgICB2YXIgYXR0YWNobWVudCA9ICJ0b3AiOwogICAgICB2YXIgbmV1cm9tYW5jeSA9IDA7CiAgICAgIGlmICgKICAgICAgICBjb250ZXh0ID09ICJzdGF0cyIgJiYKICAgICAgICAoR2FtZS5IYXMoIk5ldXJvbWFuY3kiKSB8fCAoR2FtZS5zZXNhbWUgJiYgbWUucG9vbCA9PSAiZGVidWciKSkKICAgICAgKQogICAgICAgIG5ldXJvbWFuY3kgPSAxOwogICAgICB2YXIgbXlzdGVyaW91cyA9IDA7CiAgICAgIHZhciBjbGlja1N0ciA9ICIiOwoKICAgICAgaWYgKG1lLnR5cGUgPT0gInVwZ3JhZGUiKSB7CiAgICAgICAgdmFyIGNhbkJ1eSA9IGNvbnRleHQgPT0gInN0b3JlIiA/IG1lLmNhbkJ1eSgpIDogdHJ1ZTsKICAgICAgICBpZiAoCiAgICAgICAgICBjb250ZXh0ID09ICJzdGF0cyIgJiYKICAgICAgICAgIG1lLmJvdWdodCA9PSAwICYmCiAgICAgICAgICAhR2FtZS5IYXMoIk5ldXJvbWFuY3kiKSAmJgogICAgICAgICAgKCFHYW1lLnNlc2FtZSB8fCBtZS5wb29sICE9ICJkZWJ1ZyIpCiAgICAgICAgKQogICAgICAgICAgcmV0dXJuICIiOwogICAgICAgIGVsc2UgaWYgKAogICAgICAgICAgY29udGV4dCA9PSAic3RhdHMiICYmCiAgICAgICAgICAoR2FtZS5IYXMoIk5ldXJvbWFuY3kiKSB8fCAoR2FtZS5zZXNhbWUgJiYgbWUucG9vbCA9PSAiZGVidWciKSkKICAgICAgICApCiAgICAgICAgICBuZXVyb21hbmN5ID0gMTsKICAgICAgICBlbHNlIGlmIChjb250ZXh0ID09ICJzdG9yZSIgJiYgIWNhbkJ1eSkgZW5hYmxlZCA9IDA7CiAgICAgICAgZWxzZSBpZiAoY29udGV4dCA9PSAiYXNjZW5kIiAmJiBtZS5ib3VnaHQgPT0gMCkgZW5hYmxlZCA9IDA7CiAgICAgICAgZWxzZSBlbmFibGVkID0gMTsKICAgICAgICBpZiAobWUuYm91Z2h0ID4gMCkgZW5hYmxlZCA9IDE7CgogICAgICAgIGlmIChjb250ZXh0ID09ICJzdGF0cyIgJiYgIUdhbWUucHJlZnMuY3JhdGVzKSBub0ZyYW1lID0gMTsKCiAgICAgICAgY2xhc3NlcyArPSAiIHVwZ3JhZGUiOwogICAgICAgIGlmIChtZS5wb29sID09ICJwcmVzdGlnZSIpIGNsYXNzZXMgKz0gIiBoZWF2ZW5seSI7CgogICAgICAgIGlmIChuZXVyb21hbmN5KSBjbGlja1N0ciA9ICJHYW1lLlVwZ3JhZGVzQnlJZFsiICsgbWUuaWQgKyAiXS50b2dnbGUoKTsiOwogICAgICB9IGVsc2UgaWYgKG1lLnR5cGUgPT0gImFjaGlldmVtZW50IikgewogICAgICAgIGlmIChjb250ZXh0ID09ICJzdGF0cyIgJiYgbWUud29uID09IDAgJiYgbWUucG9vbCAhPSAibm9ybWFsIikgcmV0dXJuICIiOwogICAgICAgIGVsc2UgaWYgKGNvbnRleHQgIT0gInN0YXRzIikgZW5hYmxlZCA9IDE7CgogICAgICAgIGlmIChjb250ZXh0ID09ICJzdGF0cyIgJiYgIUdhbWUucHJlZnMuY3JhdGVzKSBub0ZyYW1lID0gMTsKCiAgICAgICAgY2xhc3NlcyArPSAiIGFjaGlldmVtZW50IjsKICAgICAgICBpZiAobWUucG9vbCA9PSAic2hhZG93IikgY2xhc3NlcyArPSAiIHNoYWRvdyI7CiAgICAgICAgaWYgKG1lLndvbiA+IDApIGVuYWJsZWQgPSAxOwogICAgICAgIGVsc2UgbXlzdGVyaW91cyA9IDE7CiAgICAgICAgaWYgKCFlbmFibGVkKQogICAgICAgICAgY2xpY2tTdHIgPSAiR2FtZS5BY2hpZXZlbWVudHNCeUlkWyIgKyBtZS5pZCArICJdLmNsaWNrKCk7IjsKCiAgICAgICAgaWYgKG5ldXJvbWFuY3kpCiAgICAgICAgICBjbGlja1N0ciA9ICJHYW1lLkFjaGlldmVtZW50c0J5SWRbIiArIG1lLmlkICsgIl0udG9nZ2xlKCk7IjsKICAgICAgfQoKICAgICAgaWYgKGNvbnRleHQgPT0gInN0b3JlIikgYXR0YWNobWVudCA9ICJzdG9yZSI7CgogICAgICBpZiAoZm9yY2VDbGlja1N0cikgY2xpY2tTdHIgPSBmb3JjZUNsaWNrU3RyOwoKICAgICAgaWYgKG1lLmNob2ljZXNGdW5jdGlvbikgY2xhc3NlcyArPSAiIHNlbGVjdG9yIjsKCiAgICAgIHZhciBpY29uID0gbWUuaWNvbjsKICAgICAgaWYgKG15c3RlcmlvdXMpIGljb24gPSBbMCwgN107CgogICAgICBpZiAobWUuaWNvbkZ1bmN0aW9uKSBpY29uID0gbWUuaWNvbkZ1bmN0aW9uKCk7CgogICAgICBpZiAobWUuYm91Z2h0ICYmIGNvbnRleHQgPT0gInN0b3JlIikgZW5hYmxlZCA9IDA7CgogICAgICBpZiAoZW5hYmxlZCkgY2xhc3NlcyArPSAiIGVuYWJsZWQiOyAvLyBlbHNlIGNsYXNzZXMrPScgZGlzYWJsZWQnOwogICAgICBpZiAobm9GcmFtZSkgY2xhc3NlcyArPSAiIG5vRnJhbWUiOwoKICAgICAgdmFyIHRleHQgPSBbXTsKICAgICAgaWYgKEdhbWUuc2VzYW1lKSB7CiAgICAgICAgaWYgKAogICAgICAgICAgR2FtZS5kZWJ1Z2dlZFVwZ3JhZGVDcFNbbWUubmFtZV0gfHwKICAgICAgICAgIEdhbWUuZGVidWdnZWRVcGdyYWRlQ3BDbGlja1ttZS5uYW1lXQogICAgICAgICkgewogICAgICAgICAgdGV4dC5wdXNoKCJ4IiArIEJlYXV0aWZ5KDEgKyBHYW1lLmRlYnVnZ2VkVXBncmFkZUNwU1ttZS5uYW1lXSwgMikpOwogICAgICAgICAgdGV4dC5wdXNoKAogICAgICAgICAgICBHYW1lLmRlYnVnQ29sb3JzWwogICAgICAgICAgICAgIE1hdGguZmxvb3IoCiAgICAgICAgICAgICAgICBNYXRoLm1heCgKICAgICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgICAgTWF0aC5taW4oCiAgICAgICAgICAgICAgICAgICAgR2FtZS5kZWJ1Z0NvbG9ycy5sZW5ndGggLSAxLAogICAgICAgICAgICAgICAgICAgIE1hdGgucG93KEdhbWUuZGVidWdnZWRVcGdyYWRlQ3BTW21lLm5hbWVdIC8gMiwgMC41KSAqCiAgICAgICAgICAgICAgICAgICAgICBHYW1lLmRlYnVnQ29sb3JzLmxlbmd0aAogICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgKQogICAgICAgICAgICBdCiAgICAgICAgICApOwogICAgICAgICAgdGV4dC5wdXNoKAogICAgICAgICAgICAieCIgKyBCZWF1dGlmeSgxICsgR2FtZS5kZWJ1Z2dlZFVwZ3JhZGVDcENsaWNrW21lLm5hbWVdLCAyKQogICAgICAgICAgKTsKICAgICAgICAgIHRleHQucHVzaCgKICAgICAgICAgICAgR2FtZS5kZWJ1Z0NvbG9yc1sKICAgICAgICAgICAgICBNYXRoLmZsb29yKAogICAgICAgICAgICAgICAgTWF0aC5tYXgoCiAgICAgICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgICAgIE1hdGgubWluKAogICAgICAgICAgICAgICAgICAgIEdhbWUuZGVidWdDb2xvcnMubGVuZ3RoIC0gMSwKICAgICAgICAgICAgICAgICAgICBNYXRoLnBvdyhHYW1lLmRlYnVnZ2VkVXBncmFkZUNwQ2xpY2tbbWUubmFtZV0gLyAyLCAwLjUpICoKICAgICAgICAgICAgICAgICAgICAgIEdhbWUuZGVidWdDb2xvcnMubGVuZ3RoCiAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICApCiAgICAgICAgICAgIF0KICAgICAgICAgICk7CiAgICAgICAgfQogICAgICAgIGlmIChHYW1lLmV4dHJhSW5mbykgewogICAgICAgICAgdGV4dC5wdXNoKAogICAgICAgICAgICBNYXRoLmZsb29yKG1lLm9yZGVyKSArIChtZS5wb3dlciA/ICI8YnI+UDoiICsgbWUucG93ZXIgOiAiIikKICAgICAgICAgICk7CiAgICAgICAgICB0ZXh0LnB1c2goIiNmZmYiKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgdmFyIHRleHRTdHIgPSAiIjsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0ZXh0Lmxlbmd0aDsgaSArPSAyKSB7CiAgICAgICAgdGV4dFN0ciArPQogICAgICAgICAgJzxkaXYgc3R5bGU9Im9wYWNpdHk6MC45O3otaW5kZXg6MTAwMDtwYWRkaW5nOjBweCAycHg7YmFja2dyb3VuZDonICsKICAgICAgICAgIHRleHRbaSArIDFdICsKICAgICAgICAgICI7Y29sb3I6IzAwMDtmb250LXNpemU6MTBweDtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6IiArCiAgICAgICAgICAoaSAvIDIpICogMTAgKwogICAgICAgICAgJ3B4O2xlZnQ6MHB4OyI+JyArCiAgICAgICAgICB0ZXh0W2ldICsKICAgICAgICAgICI8L2Rpdj4iOwogICAgICB9CiAgICAgIHJldHVybiAoCiAgICAgICAgKEdhbWUucHJlZnMuc2NyZWVucmVhZGVyCiAgICAgICAgICA/ICc8YnV0dG9uIGFyaWEtbGFiZWxsZWRieT0iYXJpYVJlYWRlci0nICsgbWUudHlwZSArICItIiArIG1lLmlkICsgJyInCiAgICAgICAgICA6ICI8ZGl2IikgKwogICAgICAgIChjbGlja1N0ciAhPSAiIiA/ICIgIiArIEdhbWUuY2xpY2tTdHIgKyAnPSInICsgY2xpY2tTdHIgKyAnIicgOiAiIikgKwogICAgICAgICcgY2xhc3M9IicgKwogICAgICAgIGNsYXNzZXMgKwogICAgICAgICciICcgKwogICAgICAgIEdhbWUuZ2V0RHluYW1pY1Rvb2x0aXAoCiAgICAgICAgICAiZnVuY3Rpb24oKXtyZXR1cm4gR2FtZS5jcmF0ZVRvb2x0aXAoR2FtZS4iICsKICAgICAgICAgICAgKG1lLnR5cGUgPT0gInVwZ3JhZGUiID8gIlVwZ3JhZGVzIiA6ICJBY2hpZXZlbWVudHMiKSArCiAgICAgICAgICAgICJCeUlkWyIgKwogICAgICAgICAgICBtZS5pZCArCiAgICAgICAgICAgICJdLCIgKwogICAgICAgICAgICAoY29udGV4dCA/ICInIiArIGNvbnRleHQgKyAiJyIgOiAiIikgKwogICAgICAgICAgICAiKTt9IiwKICAgICAgICAgIGF0dGFjaG1lbnQsCiAgICAgICAgICB0cnVlCiAgICAgICAgKSArCiAgICAgICAgKGlkID8gJ2lkPSInICsgaWQgKyAnIiAnIDogIiIpICsKICAgICAgICAnc3R5bGU9IicgKwogICAgICAgIChteXN0ZXJpb3VzCiAgICAgICAgICA/ICJiYWNrZ3JvdW5kLXBvc2l0aW9uOiIgKyAtMCAqIDQ4ICsgInB4ICIgKyAtNyAqIDQ4ICsgInB4OyIKICAgICAgICAgIDogd3JpdGVJY29uKGljb24pKSArCiAgICAgICAgKGNvbnRleHQgPT0gImFzY2VuZCIgJiYgbWUucG9vbCA9PSAicHJlc3RpZ2UiCiAgICAgICAgICA/ICJwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OiIgKyBtZS5wb3NYICsgInB4O3RvcDoiICsgbWUucG9zWSArICJweDsiCiAgICAgICAgICA6ICIiKSArCiAgICAgICAgKHN0eWxlIHx8ICIiKSArCiAgICAgICAgJyI+JyArCiAgICAgICAgdGV4dFN0ciArCiAgICAgICAgKEdhbWUucHJlZnMuc2NyZWVucmVhZGVyCiAgICAgICAgICA/ICc8bGFiZWwgY2xhc3M9InNyT25seSIgaWQ9ImFyaWFSZWFkZXItJyArCiAgICAgICAgICAgIG1lLnR5cGUgKwogICAgICAgICAgICAiLSIgKwogICAgICAgICAgICBtZS5pZCArCiAgICAgICAgICAgICciPjwvbGFiZWw+JwogICAgICAgICAgOiAiIikgKwogICAgICAgIChtZS5jaG9pY2VzRnVuY3Rpb24gPyAnPGRpdiBjbGFzcz0ic2VsZWN0b3JDb3JuZXIiPjwvZGl2PicgOiAiIikgKwogICAgICAgIChHYW1lLnByZWZzLnNjcmVlbnJlYWRlciA/ICI8L2J1dHRvbj4iIDogIjwvZGl2PiIpCiAgICAgICk7CiAgICB9OwogICAgR2FtZS5jcmF0ZVRvb2x0aXAgPSBmdW5jdGlvbiAobWUsIGNvbnRleHQpIHsKICAgICAgdmFyIHRhZ3MgPSBbXTsKICAgICAgbXlzdGVyaW91cyA9IDA7CiAgICAgIHZhciBuZXVyb21hbmN5ID0gMDsKICAgICAgdmFyIHByaWNlID0gIiI7CiAgICAgIGlmICgKICAgICAgICBjb250ZXh0ID09ICJzdGF0cyIgJiYKICAgICAgICAoR2FtZS5IYXMoIk5ldXJvbWFuY3kiKSB8fCAoR2FtZS5zZXNhbWUgJiYgbWUucG9vbCA9PSAiZGVidWciKSkKICAgICAgKQogICAgICAgIG5ldXJvbWFuY3kgPSAxOwoKICAgICAgdmFyIGFyaWFUZXh0ID0gIiI7CgogICAgICBpZiAobWUudHlwZSA9PSAidXBncmFkZSIpIHsKICAgICAgICBhcmlhVGV4dCArPSAiVXBncmFkZS4gIjsKCiAgICAgICAgaWYgKG1lLnBvb2wgPT0gInByZXN0aWdlIikKICAgICAgICAgIHRhZ3MucHVzaChsb2MoIltUYWddSGVhdmVubHkiLCAwLCAiSGVhdmVubHkiKSwgIiNlZmE0MzgiKTsKICAgICAgICBlbHNlIGlmIChtZS5wb29sID09ICJ0ZWNoIikKICAgICAgICAgIHRhZ3MucHVzaChsb2MoIltUYWddVGVjaCIsIDAsICJUZWNoIiksICIjMzZhNGZmIik7CiAgICAgICAgZWxzZSBpZiAobWUucG9vbCA9PSAiY29va2llIikKICAgICAgICAgIHRhZ3MucHVzaChsb2MoIltUYWddQ29va2llIiwgMCwgIkNvb2tpZSIpLCAwKTsKICAgICAgICBlbHNlIGlmIChtZS5wb29sID09ICJkZWJ1ZyIpCiAgICAgICAgICB0YWdzLnB1c2gobG9jKCJbVGFnXURlYnVnIiwgMCwgIkRlYnVnIiksICIjMDBjNDYyIik7CiAgICAgICAgZWxzZSBpZiAobWUucG9vbCA9PSAidG9nZ2xlIikKICAgICAgICAgIHRhZ3MucHVzaChsb2MoIltUYWddU3dpdGNoIiwgMCwgIlN3aXRjaCIpLCAwKTsKICAgICAgICBlbHNlIHRhZ3MucHVzaChsb2MoIltUYWddVXBncmFkZSIsIDAsICJVcGdyYWRlIiksIDApOwoKICAgICAgICBpZiAoR2FtZS5IYXMoIkxhYmVsIHByaW50ZXIiKSkgewogICAgICAgICAgaWYgKG1lLnRpZXIgIT0gMCkKICAgICAgICAgICAgdGFncy5wdXNoKAogICAgICAgICAgICAgIGxvYygiVGllcjoiKSArCiAgICAgICAgICAgICAgICAiICIgKwogICAgICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICAgICAiW1RpZXJdIiArIEdhbWUuVGllcnNbbWUudGllcl0ubmFtZSwKICAgICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgICAgR2FtZS5UaWVyc1ttZS50aWVyXS5uYW1lCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgIEdhbWUuVGllcnNbbWUudGllcl0uY29sb3IKICAgICAgICAgICAgKTsKICAgICAgICAgIGlmIChtZS5uYW1lID09ICJMYWJlbCBwcmludGVyIiB8fCBtZS5uYW1lID09ICJUaGlzIHVwZ3JhZGUiKQogICAgICAgICAgICB0YWdzLnB1c2goCiAgICAgICAgICAgICAgbG9jKCJUaWVyOiIpICsgIiAiICsgbG9jKCJbVGllcl1TZWxmLXJlZmVyZW50aWFsIiksCiAgICAgICAgICAgICAgIiNmZjAwZWEiCiAgICAgICAgICAgICk7CiAgICAgICAgfQoKICAgICAgICBpZiAobWUuaXNWYXVsdGVkKCkpIHRhZ3MucHVzaChsb2MoIlZhdWx0ZWQiKSwgIiM0ZTc1NjYiKTsKCiAgICAgICAgaWYgKG1lLmJvdWdodCA+IDApIHsKICAgICAgICAgIGFyaWFUZXh0ICs9ICJPd25lZC4gIjsKICAgICAgICAgIGlmIChtZS5wb29sID09ICJ0ZWNoIikgdGFncy5wdXNoKGxvYygiUmVzZWFyY2hlZCIpLCAwKTsKICAgICAgICAgIGVsc2UgaWYgKEVOICYmIG1lLmtpdHRlbikgdGFncy5wdXNoKCJQdXJyY2hhc2VkIiwgMCk7CiAgICAgICAgICBlbHNlIHRhZ3MucHVzaChsb2MoIlB1cmNoYXNlZCIpLCAwKTsKICAgICAgICB9CgogICAgICAgIGlmIChtZS5sYXN0aW5nICYmIG1lLnVubG9ja2VkKQogICAgICAgICAgdGFncy5wdXNoKGxvYygiVW5sb2NrZWQgZm9yZXZlciIpLCAiI2YyZmY4NyIpOwoKICAgICAgICBpZiAobmV1cm9tYW5jeSAmJiBtZS5ib3VnaHQgPT0gMCkKICAgICAgICAgIHRhZ3MucHVzaChsb2MoIkNsaWNrIHRvIGxlYXJuISIpLCAiIzAwYzQ2MiIpOwogICAgICAgIGVsc2UgaWYgKG5ldXJvbWFuY3kgJiYgbWUuYm91Z2h0ID4gMCkKICAgICAgICAgIHRhZ3MucHVzaChsb2MoIkNsaWNrIHRvIHVubGVhcm4hIiksICIjMDBjNDYyIik7CgogICAgICAgIHZhciBjYW5CdXkgPSBjb250ZXh0ID09ICJzdG9yZSIgPyBtZS5jYW5CdXkoKSA6IHRydWU7CiAgICAgICAgdmFyIGNvc3QgPSBtZS5nZXRQcmljZSgpOwogICAgICAgIGlmIChtZS5wcmljZUx1bXBzID4gMCkgY29zdCA9IG1lLnByaWNlTHVtcHM7CgogICAgICAgIGlmIChtZS5wcmljZUx1bXBzID09IDAgJiYgY29zdCA9PSAwKSBwcmljZSA9ICIiOwogICAgICAgIGVsc2UgewogICAgICAgICAgcHJpY2UgPQogICAgICAgICAgICAnPGRpdiBzdHlsZT0iZmxvYXQ6cmlnaHQ7dGV4dC1hbGlnbjpyaWdodDsiPjxzcGFuIGNsYXNzPSJwcmljZScgKwogICAgICAgICAgICAobWUucHJpY2VMdW1wcyA+IDAgPyAiIGx1bXAiIDogIiIpICsKICAgICAgICAgICAgKG1lLnBvb2wgPT0gInByZXN0aWdlIgogICAgICAgICAgICAgID8gbWUuYm91Z2h0IHx8IEdhbWUuaGVhdmVubHlDaGlwcyA+PSBjb3N0CiAgICAgICAgICAgICAgICA/ICIgaGVhdmVubHkiCiAgICAgICAgICAgICAgICA6ICIgaGVhdmVubHkgZGlzYWJsZWQiCiAgICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgICAoY29udGV4dCA9PSAic3RvcmUiID8gKGNhbkJ1eSA/ICIiIDogIiBkaXNhYmxlZCIpIDogIiIpICsKICAgICAgICAgICAgJyI+JyArCiAgICAgICAgICAgIEJlYXV0aWZ5KE1hdGgucm91bmQoY29zdCkpICsKICAgICAgICAgICAgIjwvc3Bhbj4iICsKICAgICAgICAgICAgKG1lLnBvb2wgIT0gInByZXN0aWdlIiAmJiBtZS5wcmljZUx1bXBzID09IDAKICAgICAgICAgICAgICA/IEdhbWUuY29zdERldGFpbHMoY29zdCkKICAgICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAgICI8L2Rpdj4iOwoKICAgICAgICAgIGFyaWFUZXh0ICs9CiAgICAgICAgICAgIChtZS5ib3VnaHQKICAgICAgICAgICAgICA/ICJCb3VnaHQgZm9yIgogICAgICAgICAgICAgIDogY2FuQnV5CiAgICAgICAgICAgICAgPyAiQ2FuIGJ1eSBmb3IiCiAgICAgICAgICAgICAgOiAiQ2Fubm90IGFmZm9yZCB0aGUiKSArCiAgICAgICAgICAgICIgIiArCiAgICAgICAgICAgIEJlYXV0aWZ5KE1hdGgucm91bmQoY29zdCkpICsKICAgICAgICAgICAgIiAiICsKICAgICAgICAgICAgKG1lLnByaWNlTHVtcHMgPiAwCiAgICAgICAgICAgICAgPyAic3VnYXIgbHVtcHMiCiAgICAgICAgICAgICAgOiBtZS5wb29sID09ICJwcmVzdGlnZSIKICAgICAgICAgICAgICA/ICJoZWF2ZW5seSBjaGlwcyIKICAgICAgICAgICAgICA6ICJjb29raWVzIikgKwogICAgICAgICAgICAiLiAiOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChtZS50eXBlID09ICJhY2hpZXZlbWVudCIpIHsKICAgICAgICBhcmlhVGV4dCArPSAiQWNoaWV2ZW1lbnQuICI7CiAgICAgICAgaWYgKG1lLnBvb2wgPT0gInNoYWRvdyIpCiAgICAgICAgICB0YWdzLnB1c2gobG9jKCJTaGFkb3cgQWNoaWV2ZW1lbnQiKSwgIiM5NzAwY2YiKTsKICAgICAgICBlbHNlIHRhZ3MucHVzaChsb2MoIkFjaGlldmVtZW50IiksIDApOwogICAgICAgIGlmIChtZS53b24gPiAwKSB7CiAgICAgICAgICB0YWdzLnB1c2gobG9jKCJVbmxvY2tlZCIpLCAwKTsKICAgICAgICAgIGFyaWFUZXh0ICs9ICJVbmxvY2tlZC4gIjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGFncy5wdXNoKGxvYygiTG9ja2VkIiksIDApOwogICAgICAgICAgbXlzdGVyaW91cyA9IDE7CiAgICAgICAgfQoKICAgICAgICBpZiAobmV1cm9tYW5jeSAmJiBtZS53b24gPT0gMCkKICAgICAgICAgIHRhZ3MucHVzaChsb2MoIkNsaWNrIHRvIHdpbiEiKSwgIiMwMGM0NjIiKTsKICAgICAgICBlbHNlIGlmIChuZXVyb21hbmN5ICYmIG1lLndvbiA+IDApCiAgICAgICAgICB0YWdzLnB1c2gobG9jKCJDbGljayB0byBsb3NlISIpLCAiIzAwYzQ2MiIpOwogICAgICB9CgogICAgICB2YXIgdGFnc1N0ciA9ICIiOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRhZ3MubGVuZ3RoOyBpICs9IDIpIHsKICAgICAgICBpZiAoaSAlIDIgPT0gMCkKICAgICAgICAgIHRhZ3NTdHIgKz0KICAgICAgICAgICAgJzxkaXYgY2xhc3M9InRhZyIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6JyArCiAgICAgICAgICAgICh0YWdzW2kgKyAxXSA9PSAwID8gIiNmZmYiIDogdGFnc1tpICsgMV0pICsKICAgICAgICAgICAgJzsiPicgKwogICAgICAgICAgICB0YWdzW2ldICsKICAgICAgICAgICAgIjwvZGl2PiI7CiAgICAgIH0KCiAgICAgIHZhciBpY29uID0gbWUuaWNvbjsKICAgICAgaWYgKG15c3RlcmlvdXMpIGljb24gPSBbMCwgN107CgogICAgICBpZiAobWUuaWNvbkZ1bmN0aW9uKSBpY29uID0gbWUuaWNvbkZ1bmN0aW9uKCk7CgogICAgICBhcmlhVGV4dCArPSAobXlzdGVyaW91cyA/ICJIaWRkZW4iIDogbWUuZG5hbWUpICsgIi4gIjsKCiAgICAgIHZhciB0aXAgPSAiIjsKICAgICAgaWYgKGNvbnRleHQgPT0gInN0b3JlIikgewogICAgICAgIGlmIChtZS5wb29sICE9ICJ0b2dnbGUiICYmIG1lLnBvb2wgIT0gInRlY2giKSB7CiAgICAgICAgICB2YXIgcHVyY2hhc2UgPSBtZS5raXR0ZW4gPyAicHVycmNoYXNlIiA6ICJwdXJjaGFzZSI7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIkluc3BpcmVkIGNoZWNrbGlzdCIpKSB7CiAgICAgICAgICAgIGlmIChtZS5pc1ZhdWx0ZWQoKSkKICAgICAgICAgICAgICB0aXAgPSBFTgogICAgICAgICAgICAgICAgPyAiVXBncmFkZSBpcyB2YXVsdGVkIGFuZCB3aWxsIG5vdCBiZSBhdXRvLSIgKwogICAgICAgICAgICAgICAgICBwdXJjaGFzZSArCiAgICAgICAgICAgICAgICAgICJkLjxicj5DbGljayB0byAiICsKICAgICAgICAgICAgICAgICAgcHVyY2hhc2UgKwogICAgICAgICAgICAgICAgICAiLiBTaGlmdC1jbGljayB0byB1bnZhdWx0LiIKICAgICAgICAgICAgICAgIDogbG9jKCJVcGdyYWRlIGlzIHZhdWx0ZWQgYW5kIHdpbGwgbm90IGJlIGF1dG8tcHVyY2hhc2VkLiIpICsKICAgICAgICAgICAgICAgICAgIjxicj4iICsKICAgICAgICAgICAgICAgICAgbG9jKCJDbGljayB0byBwdXJjaGFzZS4iKSArCiAgICAgICAgICAgICAgICAgICIgIiArCiAgICAgICAgICAgICAgICAgIGxvYygiJTEgdG8gdW52YXVsdC4iLCBsb2MoIlNoaWZ0LWNsaWNrIikpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgdGlwID0gRU4KICAgICAgICAgICAgICAgID8gIkNsaWNrIHRvICIgKyBwdXJjaGFzZSArICIuIFNoaWZ0LWNsaWNrIHRvIHZhdWx0LiIKICAgICAgICAgICAgICAgIDogbG9jKCJDbGljayB0byBwdXJjaGFzZS4iKSArCiAgICAgICAgICAgICAgICAgICIgIiArCiAgICAgICAgICAgICAgICAgIGxvYygiJTEgdG8gdmF1bHQuIiwgbG9jKCJTaGlmdC1jbGljayIpKTsKICAgICAgICAgICAgaWYgKEVOKSB7CiAgICAgICAgICAgICAgaWYgKEdhbWUua2V5c1sxNl0pIHRpcCArPSAiPGJyPihZb3UgYXJlIGhvbGRpbmcgU2hpZnQuKSI7CiAgICAgICAgICAgICAgZWxzZSB0aXAgKz0gIjxicj4oWW91IGFyZSBub3QgaG9sZGluZyBTaGlmdC4pIjsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlCiAgICAgICAgICAgIHRpcCA9IEVOID8gIkNsaWNrIHRvICIgKyBwdXJjaGFzZSArICIuIiA6IGxvYygiQ2xpY2sgdG8gcHVyY2hhc2UuIik7CiAgICAgICAgfSBlbHNlIGlmIChtZS5wb29sID09ICJ0b2dnbGUiICYmIG1lLmNob2ljZXNGdW5jdGlvbikKICAgICAgICAgIHRpcCA9IGxvYygiQ2xpY2sgdG8gb3BlbiBzZWxlY3Rvci4iKTsKICAgICAgICBlbHNlIGlmIChtZS5wb29sID09ICJ0b2dnbGUiKSB0aXAgPSBsb2MoIkNsaWNrIHRvIHRvZ2dsZS4iKTsKICAgICAgICBlbHNlIGlmIChtZS5wb29sID09ICJ0ZWNoIikgdGlwID0gbG9jKCJDbGljayB0byByZXNlYXJjaC4iKTsKICAgICAgfQoKICAgICAgaWYgKHRpcCAhPSAiIikgYXJpYVRleHQgKz0gdGlwICsgIiAiOwoKICAgICAgdmFyIGRlc2MgPSBtZS5kZGVzYzsKICAgICAgaWYgKG1lLmRlc2NGdW5jKSBkZXNjID0gbWUuZGVzY0Z1bmMoY29udGV4dCk7CiAgICAgIGlmIChtZS5ib3VnaHQgJiYgY29udGV4dCA9PSAic3RvcmUiICYmIG1lLmRpc3BsYXlGdW5jV2hlbk93bmVkKQogICAgICAgIGRlc2MgPSBtZS5kaXNwbGF5RnVuY1doZW5Pd25lZCgpICsgJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicgKyBkZXNjOwogICAgICBpZiAobWUudW5sb2NrQXQpIHsKICAgICAgICBpZiAobWUudW5sb2NrQXQucmVxdWlyZSkgewogICAgICAgICAgdmFyIGl0ID0gR2FtZS5VcGdyYWRlc1ttZS51bmxvY2tBdC5yZXF1aXJlXTsKICAgICAgICAgIGRlc2MgPQogICAgICAgICAgICAnPGRpdiBzdHlsZT0iZm9udC1zaXplOjgwJTt0ZXh0LWFsaWduOmNlbnRlcjsiPicgKwogICAgICAgICAgICAoRU4gPyAiRnJvbSIgOiBsb2MoIlNvdXJjZToiKSkgKwogICAgICAgICAgICAiICIgKwogICAgICAgICAgICB0aW55SWNvbihpdC5pY29uKSArCiAgICAgICAgICAgICIgIiArCiAgICAgICAgICAgIGl0LmRuYW1lICsKICAgICAgICAgICAgJzwvZGl2PjxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicgKwogICAgICAgICAgICBkZXNjOwogICAgICAgIH0gZWxzZSBpZiAobWUudW5sb2NrQXQudGV4dCkgewogICAgICAgICAgLy92YXIgaXQ9R2FtZS5VcGdyYWRlc1ttZS51bmxvY2tBdC5yZXF1aXJlXTsKICAgICAgICAgIGRlc2MgPQogICAgICAgICAgICAnPGRpdiBzdHlsZT0iZm9udC1zaXplOjgwJTt0ZXh0LWFsaWduOmNlbnRlcjsiPicgKwogICAgICAgICAgICAoRU4gPyAiRnJvbSIgOiBsb2MoIlNvdXJjZToiKSkgKwogICAgICAgICAgICAiIDxiPiIgKwogICAgICAgICAgICB0ZXh0ICsKICAgICAgICAgICAgJzwvYj48L2Rpdj48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICAgICAgZGVzYzsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICghbXlzdGVyaW91cykgYXJpYVRleHQgKz0gIkRlc2NyaXB0aW9uOiAiICsgZGVzYyArICIgIjsKCiAgICAgIGlmIChHYW1lLnByZWZzLnNjcmVlbnJlYWRlcikgewogICAgICAgIHZhciBhcmlhTGFiZWwgPSBsKCJhcmlhUmVhZGVyLSIgKyBtZS50eXBlICsgIi0iICsgbWUuaWQpOwogICAgICAgIGlmIChhcmlhTGFiZWwpCiAgICAgICAgICBhcmlhTGFiZWwuaW5uZXJIVE1MID0gYXJpYVRleHQucmVwbGFjZSgvKDwoW14+XSspPikvZ2ksICIgIik7CiAgICAgIH0KCiAgICAgIHJldHVybiAoCiAgICAgICAgJzxkaXYgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlO2xlZnQ6MXB4O3RvcDoxcHg7cmlnaHQ6MXB4O2JvdHRvbToxcHg7YmFja2dyb3VuZDpsaW5lYXItZ3JhZGllbnQoMTI1ZGVnLCcgKwogICAgICAgIChtZS5wb29sID09ICJwcmVzdGlnZSIKICAgICAgICAgID8gInJnYmEoMTUsMTE1LDEzMCwxKSAwJSxyZ2JhKDE1LDExNSwxMzAsMCkiCiAgICAgICAgICA6ICJyZ2JhKDUwLDQwLDQwLDEpIDAlLHJnYmEoNTAsNDAsNDAsMCkiKSArCiAgICAgICAgJyAyMCUpO21peC1ibGVuZC1tb2RlOnNjcmVlbjt6LWluZGV4OjE7Ij48L2Rpdj48ZGl2IHN0eWxlPSJ6LWluZGV4OjEwO3BhZGRpbmc6OHB4IDRweDttaW4td2lkdGg6MzUwcHg7cG9zaXRpb246cmVsYXRpdmU7IiBpZD0idG9vbHRpcENyYXRlIj4nICsKICAgICAgICAnPGRpdiBjbGFzcz0iaWNvbiIgc3R5bGU9ImZsb2F0OmxlZnQ7bWFyZ2luLWxlZnQ6LThweDttYXJnaW4tdG9wOi04cHg7JyArCiAgICAgICAgd3JpdGVJY29uKGljb24pICsKICAgICAgICAnIj48L2Rpdj4nICsKICAgICAgICAobWUuYm91Z2h0ICYmIGNvbnRleHQgPT0gInN0b3JlIiA/ICIiIDogcHJpY2UpICsKICAgICAgICAnPGRpdiBjbGFzcz0ibmFtZSI+JyArCiAgICAgICAgKG15c3RlcmlvdXMgPyAiPz8/IiA6IG1lLmRuYW1lKSArCiAgICAgICAgIjwvZGl2PiIgKwogICAgICAgIHRhZ3NTdHIgKwogICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj48ZGl2IGNsYXNzPSJkZXNjcmlwdGlvbiI+JyArCiAgICAgICAgKG15c3RlcmlvdXMgPyAiPz8/IiA6IGRlc2MpICsKICAgICAgICAiPC9kaXY+PC9kaXY+IiArCiAgICAgICAgKHRpcCAhPSAiIgogICAgICAgICAgPyAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+PGRpdiBzdHlsZT0iZm9udC1zaXplOjEwcHg7Zm9udC13ZWlnaHQ6Ym9sZDtjb2xvcjojOTk5O3RleHQtYWxpZ246Y2VudGVyO3BhZGRpbmctYm90dG9tOjRweDtsaW5lLWhlaWdodDoxMDAlOyIgY2xhc3M9ImNyYXRlVGlwIj4nICsKICAgICAgICAgICAgdGlwICsKICAgICAgICAgICAgIjwvZGl2PiIKICAgICAgICAgIDogIiIpICsKICAgICAgICAoR2FtZS5zZXNhbWUKICAgICAgICAgID8gJzxkaXYgc3R5bGU9ImZvbnQtc2l6ZTo5cHg7Ij5JZDogJyArCiAgICAgICAgICAgIG1lLmlkICsKICAgICAgICAgICAgIiB8IE9yZGVyOiAiICsKICAgICAgICAgICAgTWF0aC5mbG9vcihtZS5vcmRlcikgKwogICAgICAgICAgICAobWUudGllciA/ICIgfCBUaWVyOiAiICsgbWUudGllciA6ICIiKSArCiAgICAgICAgICAgICI8L2Rpdj4iCiAgICAgICAgICA6ICIiKQogICAgICApOwogICAgfTsKCiAgICBHYW1lLmNvc3REZXRhaWxzID0gZnVuY3Rpb24gKGNvc3QpIHsKICAgICAgaWYgKCFHYW1lLkhhcygiR2VuaXVzIGFjY291bnRpbmciKSkgcmV0dXJuICIiOwogICAgICBpZiAoIWNvc3QpIHJldHVybiAiIjsKICAgICAgdmFyIHByaWNlSW5mbyA9ICIiOwogICAgICB2YXIgY3BzID0gR2FtZS5jb29raWVzUHMgKiAoMSAtIEdhbWUuY3BzU3Vja2VkKTsKICAgICAgaWYgKGNvc3QgPiBHYW1lLmNvb2tpZXMpCiAgICAgICAgcHJpY2VJbmZvICs9CiAgICAgICAgICBsb2MoCiAgICAgICAgICAgICJpbiAlMSIsCiAgICAgICAgICAgIEdhbWUuc2F5VGltZSgoKGNvc3QgLSBHYW1lLmNvb2tpZXMpIC8gY3BzICsgMSkgKiBHYW1lLmZwcykKICAgICAgICAgICkgKyAiPGJyPiI7CiAgICAgIHByaWNlSW5mbyArPQogICAgICAgIGxvYygiJTEgd29ydGgiLCBHYW1lLnNheVRpbWUoKGNvc3QgLyBjcHMgKyAxKSAqIEdhbWUuZnBzKSkgKyAiPGJyPiI7CiAgICAgIHByaWNlSW5mbyArPQogICAgICAgIGxvYygiJTElIG9mIGJhbmsiLCBCZWF1dGlmeSgoY29zdCAvIEdhbWUuY29va2llcykgKiAxMDAsIDEpKSArICI8YnI+IjsKICAgICAgcmV0dXJuICgKICAgICAgICAnPGRpdiBzdHlsZT0iZm9udC1zaXplOjgwJTtvcGFjaXR5OjAuNztsaW5lLWhlaWdodDo5MCU7IiBjbGFzcz0iY29zdERldGFpbHMiPicgKwogICAgICAgIHByaWNlSW5mbyArCiAgICAgICAgIjwvZGl2PiIKICAgICAgKTsKICAgIH07CgogICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkJUFJFU1RJR0UKCQk9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwoKICAgIEdhbWUuSENmYWN0b3IgPSAzOwogICAgR2FtZS5Ib3dNdWNoUHJlc3RpZ2UgPSBmdW5jdGlvbiAoCiAgICAgIGNvb2tpZXMgLy9ob3cgbXVjaCBwcmVzdGlnZSBbY29va2llc10gc2hvdWxkIGxhbmQgeW91CiAgICApIHsKICAgICAgcmV0dXJuIE1hdGgucG93KGNvb2tpZXMgLyAxMDAwMDAwMDAwMDAwLCAxIC8gR2FtZS5IQ2ZhY3Rvcik7CiAgICB9OwogICAgR2FtZS5Ib3dNYW55Q29va2llc1Jlc2V0ID0gZnVuY3Rpb24gKAogICAgICBjaGlwcyAvL2hvdyBtYW55IGNvb2tpZXMgW2NoaXBzXSBhcmUgd29ydGgKICAgICkgewogICAgICAvL3RoaXMgbXVzdCBiZSB0aGUgaW52ZXJzZSBvZiB0aGUgYWJvdmUgZnVuY3Rpb24gKGllLiBpZiBjb29raWVzPWNoaXBzXjIsIGNoaXBzPWNvb2tpZXNeKDEvMikgKQogICAgICByZXR1cm4gTWF0aC5wb3coY2hpcHMsIEdhbWUuSENmYWN0b3IpICogMTAwMDAwMDAwMDAwMDsKICAgIH07CiAgICBHYW1lLmdhaW5lZFByZXN0aWdlID0gMDsKICAgIEdhbWUuRWFybkhlYXZlbmx5Q2hpcHMgPSBmdW5jdGlvbiAoY29va2llc0ZvcmZlaXRlZCwgc2lsZW50KSB7CiAgICAgIC8vcmVjYWxjdWxhdGUgcHJlc3RpZ2UgYW5kIGNoaXBzIG93bmVkCiAgICAgIHZhciBwcmVzdGlnZSA9IE1hdGguZmxvb3IoCiAgICAgICAgR2FtZS5Ib3dNdWNoUHJlc3RpZ2UoR2FtZS5jb29raWVzUmVzZXQgKyBjb29raWVzRm9yZmVpdGVkKQogICAgICApOwogICAgICBwcmVzdGlnZSA9IE1hdGgubWF4KDAsIHByZXN0aWdlKTsKICAgICAgaWYgKHByZXN0aWdlICE9IEdhbWUucHJlc3RpZ2UpIHsKICAgICAgICAvL2RpZCB3ZSBjaGFuZ2UgcHJlc3RpZ2UgbGV2ZWxzPwogICAgICAgIHZhciBwcmVzdGlnZURpZmZlcmVuY2UgPSBwcmVzdGlnZSAtIEdhbWUucHJlc3RpZ2U7CiAgICAgICAgR2FtZS5nYWluZWRQcmVzdGlnZSA9IHByZXN0aWdlRGlmZmVyZW5jZTsKICAgICAgICBHYW1lLmhlYXZlbmx5Q2hpcHMgKz0gcHJlc3RpZ2VEaWZmZXJlbmNlOwogICAgICAgIEdhbWUucHJlc3RpZ2UgPSBwcmVzdGlnZTsKICAgICAgICBpZiAoIXNpbGVudCAmJiBwcmVzdGlnZURpZmZlcmVuY2UgPiAwKQogICAgICAgICAgR2FtZS5Ob3RpZnkoCiAgICAgICAgICAgIGxvYygKICAgICAgICAgICAgICAiWW91IGZvcmZlaXQgeW91ciAlMS4iLAogICAgICAgICAgICAgIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KGNvb2tpZXNGb3JmZWl0ZWQpKQogICAgICAgICAgICApLAogICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgIllvdSBnYWluIDxiPiUxPC9iPiEiLAogICAgICAgICAgICAgIGxvYygiJTEgcHJlc3RpZ2UgbGV2ZWwiLCBMQmVhdXRpZnkocHJlc3RpZ2VEaWZmZXJlbmNlKSkKICAgICAgICAgICAgKSwKICAgICAgICAgICAgWzE5LCA3XQogICAgICAgICAgKTsKICAgICAgfQogICAgfTsKCiAgICBHYW1lLkdldEhlYXZlbmx5TXVsdGlwbGllciA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGhlYXZlbmx5TXVsdCA9IDA7CiAgICAgIGlmIChHYW1lLkhhcygiSGVhdmVubHkgY2hpcCBzZWNyZXQiKSkgaGVhdmVubHlNdWx0ICs9IDAuMDU7CiAgICAgIGlmIChHYW1lLkhhcygiSGVhdmVubHkgY29va2llIHN0YW5kIikpIGhlYXZlbmx5TXVsdCArPSAwLjI7CiAgICAgIGlmIChHYW1lLkhhcygiSGVhdmVubHkgYmFrZXJ5IikpIGhlYXZlbmx5TXVsdCArPSAwLjI1OwogICAgICBpZiAoR2FtZS5IYXMoIkhlYXZlbmx5IGNvbmZlY3Rpb25lcnkiKSkgaGVhdmVubHlNdWx0ICs9IDAuMjU7CiAgICAgIGlmIChHYW1lLkhhcygiSGVhdmVubHkga2V5IikpIGhlYXZlbmx5TXVsdCArPSAwLjI1OwogICAgICAvL2lmIChHYW1lLmhhc0F1cmEoJ0RyYWdvbiBHb2QnKSkgaGVhdmVubHlNdWx0Kj0xLjA1OwogICAgICBoZWF2ZW5seU11bHQgKj0gMSArIEdhbWUuYXVyYU11bHQoIkRyYWdvbiBHb2QiKSAqIDAuMDU7CiAgICAgIGlmIChHYW1lLkhhcygiTHVja3kgZGlnaXQiKSkgaGVhdmVubHlNdWx0ICo9IDEuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiTHVja3kgbnVtYmVyIikpIGhlYXZlbmx5TXVsdCAqPSAxLjAxOwogICAgICBpZiAoR2FtZS5IYXMoIkx1Y2t5IHBheW91dCIpKSBoZWF2ZW5seU11bHQgKj0gMS4wMTsKICAgICAgaWYgKEdhbWUuaGFzR29kKSB7CiAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJjcmVhdGlvbiIpOwogICAgICAgIGlmIChnb2RMdmwgPT0gMSkgaGVhdmVubHlNdWx0ICo9IDAuNzsKICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMikgaGVhdmVubHlNdWx0ICo9IDAuODsKICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMykgaGVhdmVubHlNdWx0ICo9IDAuOTsKICAgICAgfQogICAgICByZXR1cm4gaGVhdmVubHlNdWx0OwogICAgfTsKCiAgICBHYW1lLmFzY2Vuc2lvbk1vZGVzID0gewogICAgICAwOiB7CiAgICAgICAgbmFtZTogIk5vbmUiLAogICAgICAgIGRuYW1lOiBsb2MoIk5vbmUgW2FzY2Vuc2lvbiB0eXBlXSIpLAogICAgICAgIGRlc2M6IGxvYygiTm8gc3BlY2lhbCBtb2RpZmllcnMuIiksCiAgICAgICAgaWNvbjogWzEwLCAwXSwKICAgICAgfSwKICAgICAgMTogewogICAgICAgIG5hbWU6ICJCb3JuIGFnYWluIiwKICAgICAgICBkbmFtZTogbG9jKCJCb3JuIGFnYWluIFthc2NlbnNpb24gdHlwZV0iKSwKICAgICAgICBkZXNjOiBsb2MoCiAgICAgICAgICAnVGhpcyBydW4gd2lsbCBiZWhhdmUgYXMgaWYgeW91XCdkIGp1c3Qgc3RhcnRlZCB0aGUgZ2FtZSBmcm9tIHNjcmF0Y2guIFByZXN0aWdlIGxldmVscyBhbmQgaGVhdmVubHkgdXBncmFkZXMgd2lsbCBoYXZlIG5vIGVmZmVjdCwgYXMgd2lsbCBzdWdhciBsdW1wcyBhbmQgYnVpbGRpbmcgbGV2ZWxzLiBQZXJtYS11cGdyYWRlcyBhbmQgbWluaWdhbWVzIHdpbGwgYmUgdW5hdmFpbGFibGUuPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+U29tZSBhY2hpZXZlbWVudHMgYXJlIG9ubHkgYXZhaWxhYmxlIGluIHRoaXMgbW9kZS4nCiAgICAgICAgKSwKICAgICAgICBpY29uOiBbMiwgN10sCiAgICAgIH0gLyosCgkJMjp7bmFtZTonVHJpZ2dlciBmaW5nZXInLGRuYW1lOmxvYygiVHJpZ2dlciBmaW5nZXIgW2FzY2Vuc2lvbiB0eXBlXSIpLGRlc2M6bG9jKCJJbiB0aGlzIHJ1biwgc2Nyb2xsaW5nIHlvdXIgbW91c2Ugd2hlZWwgb24gdGhlIGNvb2tpZSBjb3VudHMgYXMgY2xpY2tpbmcgaXQuIFNvbWUgdXBncmFkZXMgaW50cm9kdWNlIG5ldyBjbGlja2luZyBiZWhhdmlvcnMuPGJyPk5vIGNsaWNraW5nIGFjaGlldmVtZW50cyBtYXkgYmUgb2J0YWluZWQgaW4gdGhpcyBtb2RlLjxkaXYgY2xhc3M9XCJsaW5lXCI+PC9kaXY+UmVhY2hpbmcgMSBxdWFkcmlsbGlvbiBjb29raWVzIGluIHRoaXMgbW9kZSB1bmxvY2tzIGEgc3BlY2lhbCBoZWF2ZW5seSB1cGdyYWRlLiIpLGljb246WzEyLDBdfSovLAogICAgfTsKCiAgICBHYW1lLmFzY2VuZE1ldGVyUGVyY2VudCA9IDA7CiAgICBHYW1lLmFzY2VuZE1ldGVyUGVyY2VudFQgPSAwOwogICAgR2FtZS5hc2NlbmRNZXRlckxldmVsID0gMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwOwoKICAgIEdhbWUubmV4dEFzY2Vuc2lvbk1vZGUgPSAwOwogICAgR2FtZS5VcGRhdGVBc2NlbnNpb25Nb2RlUHJvbXB0ID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgaWNvbiA9IEdhbWUuYXNjZW5zaW9uTW9kZXNbR2FtZS5uZXh0QXNjZW5zaW9uTW9kZV0uaWNvbjsKICAgICAgdmFyIG5hbWUgPSBHYW1lLmFzY2Vuc2lvbk1vZGVzW0dhbWUubmV4dEFzY2Vuc2lvbk1vZGVdLmRuYW1lOwogICAgICBsKCJhc2NlbmRNb2RlQnV0dG9uIikuaW5uZXJIVE1MID0KICAgICAgICAnPGRpdiBjbGFzcz0iY3JhdGUgbm9GcmFtZSBlbmFibGVkIiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJHYW1lLlBpY2tBc2NlbnNpb25Nb2RlKCk7IiAnICsKICAgICAgICBHYW1lLmdldFRvb2x0aXAoCiAgICAgICAgICAnPGRpdiBzdHlsZT0ibWluLXdpZHRoOjIwMHB4O3RleHQtYWxpZ246Y2VudGVyO2ZvbnQtc2l6ZToxMXB4OyIgaWQ9InRvb2x0aXBOZXh0Q2hhbGxlbmdlTW9kZSI+JyArCiAgICAgICAgICAgIGxvYygiQ2hhbGxlbmdlIG1vZGUgZm9yIHRoZSBuZXh0IHJ1bjoiKSArCiAgICAgICAgICAgICI8YnI+PGI+IiArCiAgICAgICAgICAgIG5hbWUgKwogICAgICAgICAgICAnPC9iPjxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicgKwogICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgIkNoYWxsZW5nZSBtb2RlcyBhcHBseSBzcGVjaWFsIG1vZGlmaWVycyB0byB5b3VyIG5leHQgYXNjZW5zaW9uLjxicj5DbGljayB0byBjaGFuZ2UuIgogICAgICAgICAgICApICsKICAgICAgICAgICAgIjwvZGl2PiIsCiAgICAgICAgICAiYm90dG9tLXJpZ2h0IgogICAgICAgICkgKwogICAgICAgICcgc3R5bGU9Im9wYWNpdHk6MTtmbG9hdDpub25lO2Rpc3BsYXk6YmxvY2s7YmFja2dyb3VuZC1wb3NpdGlvbjonICsKICAgICAgICAtaWNvblswXSAqIDQ4ICsKICAgICAgICAicHggIiArCiAgICAgICAgLWljb25bMV0gKiA0OCArCiAgICAgICAgJ3B4OyI+PC9kaXY+JzsKICAgIH07CiAgICBHYW1lLlBpY2tBc2NlbnNpb25Nb2RlID0gZnVuY3Rpb24gKCkgewogICAgICBQbGF5U291bmQoInNuZC90aWNrLm1wMyIpOwogICAgICBHYW1lLnRvb2x0aXAuaGlkZSgpOwoKICAgICAgdmFyIHN0ciA9ICIiOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUuYXNjZW5zaW9uTW9kZXMpIHsKICAgICAgICB2YXIgaWNvbiA9IEdhbWUuYXNjZW5zaW9uTW9kZXNbaV0uaWNvbjsKICAgICAgICBzdHIgKz0KICAgICAgICAgICc8ZGl2IGNsYXNzPSJjcmF0ZSBlbmFibGVkJyArCiAgICAgICAgICAoaSA9PSBHYW1lLm5leHRBc2NlbnNpb25Nb2RlID8gIiBoaWdobGlnaHRlZCIgOiAiIikgKwogICAgICAgICAgJyIgaWQ9ImNoYWxsZW5nZU1vZGVTZWxlY3RvcicgKwogICAgICAgICAgaSArCiAgICAgICAgICAnIiBzdHlsZT0ib3BhY2l0eToxO2Zsb2F0Om5vbmU7ZGlzcGxheTppbmxpbmUtYmxvY2s7YmFja2dyb3VuZC1wb3NpdGlvbjonICsKICAgICAgICAgIC1pY29uWzBdICogNDggKwogICAgICAgICAgInB4ICIgKwogICAgICAgICAgLWljb25bMV0gKiA0OCArCiAgICAgICAgICAncHg7IiAnICsKICAgICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICAgJz0iR2FtZS5uZXh0QXNjZW5zaW9uTW9kZT0nICsKICAgICAgICAgIGkgKwogICAgICAgICAgIjtHYW1lLlBpY2tBc2NlbnNpb25Nb2RlKCk7UGxheVNvdW5kKCdzbmQvdGljay5tcDMnKTtHYW1lLmNob2ljZVNlbGVjdG9yT249LTE7XCIgb25Nb3VzZU91dD1cImwoJ2NoYWxsZW5nZVNlbGVjdGVkTmFtZScpLmlubmVySFRNTD1HYW1lLmFzY2Vuc2lvbk1vZGVzW0dhbWUubmV4dEFzY2Vuc2lvbk1vZGVdLmRuYW1lO2woJ2NoYWxsZW5nZVNlbGVjdGVkRGVzYycpLmlubmVySFRNTD1HYW1lLmFzY2Vuc2lvbk1vZGVzW0dhbWUubmV4dEFzY2Vuc2lvbk1vZGVdLmRlc2M7XCIgb25Nb3VzZU92ZXI9XCJsKCdjaGFsbGVuZ2VTZWxlY3RlZE5hbWUnKS5pbm5lckhUTUw9R2FtZS5hc2NlbnNpb25Nb2Rlc1siICsKICAgICAgICAgIGkgKwogICAgICAgICAgIl0uZG5hbWU7bCgnY2hhbGxlbmdlU2VsZWN0ZWREZXNjJykuaW5uZXJIVE1MPUdhbWUuYXNjZW5zaW9uTW9kZXNbIiArCiAgICAgICAgICBpICsKICAgICAgICAgICddLmRlc2M7IicgKwogICAgICAgICAgIj48L2Rpdj4iOwogICAgICB9CiAgICAgIEdhbWUuUHJvbXB0KAogICAgICAgICI8aWQgUGlja0NoYWxsZW5nZU1vZGU+PGgzPiIgKwogICAgICAgICAgbG9jKCJTZWxlY3QgYSBjaGFsbGVuZ2UgbW9kZSIpICsKICAgICAgICAgICI8L2gzPiIgKwogICAgICAgICAgJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PjxkaXYgY2xhc3M9ImNyYXRlQm94Ij4nICsKICAgICAgICAgIHN0ciArCiAgICAgICAgICAnPC9kaXY+PGg0IGlkPSJjaGFsbGVuZ2VTZWxlY3RlZE5hbWUiPicgKwogICAgICAgICAgR2FtZS5hc2NlbnNpb25Nb2Rlc1tHYW1lLm5leHRBc2NlbnNpb25Nb2RlXS5kbmFtZSArCiAgICAgICAgICAnPC9oND48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj48ZGl2IGlkPSJjaGFsbGVuZ2VTZWxlY3RlZERlc2MiIHN0eWxlPSJtaW4taGVpZ2h0OjEyOHB4OyI+JyArCiAgICAgICAgICBHYW1lLmFzY2Vuc2lvbk1vZGVzW0dhbWUubmV4dEFzY2Vuc2lvbk1vZGVdLmRlc2MgKwogICAgICAgICAgJzwvZGl2PjxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicsCiAgICAgICAgWwogICAgICAgICAgWwogICAgICAgICAgICBsb2MoIkNvbmZpcm0iKSwKICAgICAgICAgICAgIkdhbWUuVXBkYXRlQXNjZW5zaW9uTW9kZVByb21wdCgpO0dhbWUuQ2xvc2VQcm9tcHQoKTsiLAogICAgICAgICAgXSwKICAgICAgICBdLAogICAgICAgIDAsCiAgICAgICAgIndpZGVQcm9tcHQiCiAgICAgICk7CiAgICB9OwoKICAgIGwoImFzY2VuZE92ZXJsYXkiKS5pbm5lckhUTUwgPQogICAgICAnPGRpdiBpZD0iYXNjZW5kQm94Ij4nICsKICAgICAgJzxkaXYgaWQ9ImFzY2VuZERhdGExIiBjbGFzcz0iYXNjZW5kRGF0YSBzbWFsbEZyYW1lZCBwcm9tcHQiIHN0eWxlPSJtYXJnaW4tdG9wOjhweDsiPjxoMyBpZD0iYXNjZW5kUHJlc3RpZ2UiPjwvaDM+PC9kaXY+JyArCiAgICAgICc8ZGl2IGlkPSJhc2NlbmREYXRhMiIgY2xhc3M9ImFzY2VuZERhdGEgc21hbGxGcmFtZWQgcHJvbXB0Ij48aDMgaWQ9ImFzY2VuZEhDcyI+PC9oMz48L2Rpdj4nICsKICAgICAgJzxhIGlkPSJhc2NlbmRCdXR0b24iIGNsYXNzPSJvcHRpb24gZnJhbWVkIGxhcmdlIHJlZCIgJyArCiAgICAgIEdhbWUuZ2V0VG9vbHRpcCgKICAgICAgICAnPGRpdiBzdHlsZT0ibWluLXdpZHRoOjMwMHB4O3RleHQtYWxpZ246Y2VudGVyO2ZvbnQtc2l6ZToxMXB4O3BhZGRpbmc6OHB4OyIgaWQ9InRvb2x0aXBSZWluY2FybmF0ZSI+JyArCiAgICAgICAgICBsb2MoIkNsaWNrIHRoaXMgb25jZSB5b3UndmUgYm91Z2h0PGJyPmV2ZXJ5dGhpbmcgeW91IG5lZWQhIikgKwogICAgICAgICAgIjwvZGl2PiIsCiAgICAgICAgImJvdHRvbS1yaWdodCIKICAgICAgKSArCiAgICAgICcgc3R5bGU9ImZvbnQtc2l6ZToxNnB4O21hcmdpbi10b3A6MHB4OyI+PHNwYW4gY2xhc3M9ImZhbmN5VGV4dCIgc3R5bGU9ImZvbnQtc2l6ZToyMHB4OyI+JyArCiAgICAgIGxvYygiUmVpbmNhcm5hdGUiKSArCiAgICAgICI8L3NwYW4+PC9hPiIgKwogICAgICAnPGRpdiBpZD0iYXNjZW5kTW9kZUJ1dHRvbiIgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlO3JpZ2h0OjM0cHg7Ym90dG9tOjI1cHg7ZGlzcGxheTpub25lOyI+PC9kaXY+JyArCiAgICAgICc8aW5wdXQgdHlwZT0idGV4dCIgc3R5bGU9ImRpc3BsYXk6YmxvY2s7IiBpZD0idXBncmFkZVBvc2l0aW9ucyIvPjwvZGl2PicgKwogICAgICAnPGRpdiBpZD0iYXNjZW5kSW5mbyI+PGRpdiBjbGFzcz0iYXNjZW5kRGF0YSBzbWFsbEZyYW1lZCIgc3R5bGU9Im1hcmdpbi10b3A6MjJweDt3aWR0aDo3NSU7Zm9udC1zaXplOjExcHg7Ij4nICsKICAgICAgbG9jKAogICAgICAgICJZb3UgYXJlIGFzY2VuZGluZy48YnI+RHJhZyB0aGUgc2NyZWVuIGFyb3VuZDxicj5vciB1c2UgYXJyb3cga2V5cyE8YnI+V2hlbiB5b3UncmUgcmVhZHksPGJyPmNsaWNrIFJlaW5jYXJuYXRlLiIKICAgICAgKSArCiAgICAgICI8L2Rpdj48L2Rpdj4iOwoKICAgIEdhbWUuYXR0YWNoVG9vbHRpcCgKICAgICAgbCgiYXNjZW5kRGF0YTEiKSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiAoCiAgICAgICAgICAnPGRpdiBzdHlsZT0ibWluLXdpZHRoOjMwMHB4O3RleHQtYWxpZ246Y2VudGVyO2ZvbnQtc2l6ZToxMXB4O3BhZGRpbmc6OHB4OyIgaWQ9InRvb2x0aXBBc2NlbmREYXRhMSI+KDxiPicgKwogICAgICAgICAgQmVhdXRpZnkoR2FtZS5oZWF2ZW5seUNoaXBzKSArCiAgICAgICAgICAnPC9iPik8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICAgIGxvYygKICAgICAgICAgICAgIkVhY2ggcHJlc3RpZ2UgbGV2ZWwgZ3JhbnRzIHlvdSBhIHBlcm1hbmVudCA8Yj4rJTElIENwUzwvYj4uPGJyPlRoZSBtb3JlIGxldmVscyB5b3UgaGF2ZSwgdGhlIG1vcmUgY29va2llcyB0aGV5IHJlcXVpcmUuIiwKICAgICAgICAgICAgMQogICAgICAgICAgKSArCiAgICAgICAgICAiPC9kaXY+IgogICAgICAgICk7CiAgICAgIH0sCiAgICAgICJib3R0b20tcmlnaHQiCiAgICApOwogICAgR2FtZS5hdHRhY2hUb29sdGlwKAogICAgICBsKCJhc2NlbmREYXRhMiIpLAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuICgKICAgICAgICAgICc8ZGl2IHN0eWxlPSJtaW4td2lkdGg6MzAwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Zm9udC1zaXplOjExcHg7cGFkZGluZzo4cHg7IiBpZD0idG9vbHRpcEFzY2VuZERhdGEyIj4oPGI+JyArCiAgICAgICAgICBsb2MoIiUxIGhlYXZlbmx5IGNoaXAiLCBMQmVhdXRpZnkoR2FtZS5oZWF2ZW5seUNoaXBzKSkgKwogICAgICAgICAgJzwvYj4pPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgICBsb2MoCiAgICAgICAgICAgICJIZWF2ZW5seSBjaGlwcyBhcmUgdXNlZCB0byBidXkgaGVhdmVubHkgdXBncmFkZXMuPGJyPllvdSBnYWluIDxiPjEgY2hpcDwvYj4gZXZlcnkgdGltZSB5b3UgZ2FpbiBhIHByZXN0aWdlIGxldmVsLiIKICAgICAgICAgICkgKwogICAgICAgICAgIjwvZGl2PiIKICAgICAgICApOwogICAgICB9LAogICAgICAiYm90dG9tLXJpZ2h0IgogICAgKTsKCiAgICBHYW1lLlVwZGF0ZUFzY2Vuc2lvbk1vZGVQcm9tcHQoKTsKCiAgICBBZGRFdmVudChsKCJhc2NlbmRCdXR0b24iKSwgImNsaWNrIiwgZnVuY3Rpb24gKCkgewogICAgICBQbGF5U291bmQoInNuZC90aWNrLm1wMyIpOwogICAgICBHYW1lLlJlaW5jYXJuYXRlKCk7CiAgICB9KTsKCiAgICBHYW1lLmFzY2VuZGwgPSBsKCJhc2NlbmQiKTsKICAgIEdhbWUuYXNjZW5kQ29udGVudGwgPSBsKCJhc2NlbmRDb250ZW50Iik7CiAgICBHYW1lLmFzY2VuZFpvb21hYmxlbCA9IGwoImFzY2VuZFpvb21hYmxlIik7CiAgICBHYW1lLmFzY2VuZFVwZ3JhZGVzbCA9IGwoImFzY2VuZFVwZ3JhZGVzIik7CiAgICBHYW1lLk9uQXNjZW5kID0gMDsKICAgIEdhbWUuQXNjZW5kVGltZXIgPSAwOyAvL2hvdyBmYXIgd2UgYXJlIGludG8gdGhlIGFzY2VuZCBhbmltYXRpb24KICAgIEdhbWUuQXNjZW5kRHVyYXRpb24gPSBHYW1lLmZwcyAqIDU7IC8vaG93IGxvbmcgdGhlIGFzY2VuZCBhbmltYXRpb24gaXMKICAgIEdhbWUuQXNjZW5kQnJlYWtwb2ludCA9IEdhbWUuQXNjZW5kRHVyYXRpb24gKiAwLjU7IC8vYXQgd2hpY2ggcG9pbnQgdGhlIGNvb2tpZSBleHBsb2RlcyBkdXJpbmcgdGhlIGFzY2VuZCBhbmltYXRpb24KICAgIEdhbWUuVXBkYXRlQXNjZW5kSW50cm8gPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChHYW1lLkFzY2VuZFRpbWVyID09IDEpIFBsYXlTb3VuZCgic25kL2NoYXJnaW5nLm1wMyIpOwogICAgICBpZiAoR2FtZS5Bc2NlbmRUaW1lciA9PSBNYXRoLmZsb29yKEdhbWUuQXNjZW5kQnJlYWtwb2ludCkpCiAgICAgICAgUGxheVNvdW5kKCJzbmQvdGh1ZC5tcDMiKTsKICAgICAgR2FtZS5Bc2NlbmRUaW1lcisrOwogICAgICBpZiAoR2FtZS5Bc2NlbmRUaW1lciA+IEdhbWUuQXNjZW5kRHVyYXRpb24pIHsKICAgICAgICAvL2VuZCBhbmltYXRpb24gYW5kIGxhdW5jaCBhc2NlbmQgc2NyZWVuCiAgICAgICAgUGxheUN1ZSgiYXNjZW5kIik7CiAgICAgICAgUGxheU11c2ljU291bmQoInNuZC9jeW1iYWxSZXYubXAzIik7CiAgICAgICAgaWYgKCFBcHAgfHwgR2FtZS52b2x1bWVNdXNpYyA9PSAwKSBQbGF5U291bmQoInNuZC9jaG9pci5tcDMiKTsKICAgICAgICBHYW1lLkVhcm5IZWF2ZW5seUNoaXBzKEdhbWUuY29va2llc0Vhcm5lZCk7CiAgICAgICAgR2FtZS5Bc2NlbmRUaW1lciA9IDA7CiAgICAgICAgR2FtZS5PbkFzY2VuZCA9IDE7CiAgICAgICAgR2FtZS5yZW1vdmVDbGFzcygiYXNjZW5kSW50cm8iKTsKICAgICAgICBHYW1lLmFkZENsYXNzKCJhc2NlbmRpbmciKTsKICAgICAgICBHYW1lLkJ1aWxkQXNjZW5kVHJlZSgpOwogICAgICAgIEdhbWUuaGVhdmVubHlDaGlwc0Rpc3BsYXllZCA9IEdhbWUuaGVhdmVubHlDaGlwczsKICAgICAgICBHYW1lLm5leHRBc2NlbnNpb25Nb2RlID0gMDsKICAgICAgICBHYW1lLmFzY2Vuc2lvbk1vZGUgPSAwOwogICAgICAgIEdhbWUuVXBkYXRlQXNjZW5zaW9uTW9kZVByb21wdCgpOwogICAgICB9CiAgICB9OwogICAgR2FtZS5SZWluY2FybmF0ZVRpbWVyID0gMDsgLy9ob3cgZmFyIHdlIGFyZSBpbnRvIHRoZSByZWluY2FybmF0aW9uIGFuaW1hdGlvbgogICAgR2FtZS5SZWluY2FybmF0ZUR1cmF0aW9uID0gR2FtZS5mcHMgKiAxOyAvL2hvdyBsb25nIHRoZSByZWluY2FybmF0aW9uIGFuaW1hdGlvbiBpcwogICAgR2FtZS5VcGRhdGVSZWluY2FybmF0ZUludHJvID0gZnVuY3Rpb24gKCkgewogICAgICBpZiAoR2FtZS5SZWluY2FybmF0ZVRpbWVyID09IDEpCiAgICAgICAgUGxheVNvdW5kKCJzbmQvcG9wIiArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDMgKyAxKSArICIubXAzIiwgMC43NSk7CiAgICAgIEdhbWUuUmVpbmNhcm5hdGVUaW1lcisrOwogICAgICBpZiAoR2FtZS5SZWluY2FybmF0ZVRpbWVyID4gR2FtZS5SZWluY2FybmF0ZUR1cmF0aW9uKSB7CiAgICAgICAgLy9lbmQgYW5pbWF0aW9uIGFuZCBsYXVuY2ggcmVndWxhciBnYW1lCiAgICAgICAgR2FtZS5SZWluY2FybmF0ZVRpbWVyID0gMDsKICAgICAgICBHYW1lLnJlbW92ZUNsYXNzKCJyZWluY2FybmF0aW5nIik7CiAgICAgIH0KICAgIH07CiAgICBHYW1lLlJlaW5jYXJuYXRlID0gZnVuY3Rpb24gKGJ5cGFzcykgewogICAgICBpZiAoIWJ5cGFzcykKICAgICAgICBHYW1lLlByb21wdCgKICAgICAgICAgICI8aWQgUmVpbmNhcm5hdGU+PGgzPiIgKwogICAgICAgICAgICBsb2MoIlJlaW5jYXJuYXRlIikgKwogICAgICAgICAgICAnPC9oMz48ZGl2IGNsYXNzPSJibG9jayI+JyArCiAgICAgICAgICAgIGxvYygiQXJlIHlvdSByZWFkeSB0byByZXR1cm4gdG8gdGhlIG1vcnRhbCB3b3JsZD8iKSArCiAgICAgICAgICAgICI8L2Rpdj4iLAogICAgICAgICAgW1tsb2MoIlllcyIpLCAiR2FtZS5DbG9zZVByb21wdCgpO0dhbWUuUmVpbmNhcm5hdGUoMSk7Il0sIGxvYygiTm8iKV0KICAgICAgICApOwogICAgICBlbHNlIHsKICAgICAgICBHYW1lLmFzY2VuZFVwZ3JhZGVzbC5pbm5lckhUTUwgPSAiIjsKICAgICAgICBHYW1lLmFzY2Vuc2lvbk1vZGUgPSBHYW1lLm5leHRBc2NlbnNpb25Nb2RlOwogICAgICAgIEdhbWUubmV4dEFzY2Vuc2lvbk1vZGUgPSAwOwogICAgICAgIEdhbWUuUmVzZXQoKTsKICAgICAgICBpZiAoR2FtZS5IYXNBY2hpZXYoIlJlYmlydGgiKSkgewogICAgICAgICAgR2FtZS5Ob3RpZnkoIlJlaW5jYXJuYXRlZCIsIGxvYygiSGVsbG8sIGNvb2tpZXMhIiksIFsxMCwgMF0sIDQpOwogICAgICAgIH0KICAgICAgICBpZiAoR2FtZS5yZXNldHMgPj0gMTAwMCkgR2FtZS5XaW4oIkVuZGxlc3MgY3ljbGUiKTsKICAgICAgICBpZiAoR2FtZS5yZXNldHMgPj0gMTAwKSBHYW1lLldpbigiUmVpbmNhcm5hdGlvbiIpOwogICAgICAgIGlmIChHYW1lLnJlc2V0cyA+PSAxMCkgR2FtZS5XaW4oIlJlc3VycmVjdGlvbiIpOwogICAgICAgIGlmIChHYW1lLnJlc2V0cyA+PSAxKSBHYW1lLldpbigiUmViaXJ0aCIpOwoKICAgICAgICB2YXIgcHJlc3RpZ2VVcGdyYWRlc093bmVkID0gMDsKICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuVXBncmFkZXMpIHsKICAgICAgICAgIGlmIChHYW1lLlVwZ3JhZGVzW2ldLmJvdWdodCAmJiBHYW1lLlVwZ3JhZGVzW2ldLnBvb2wgPT0gInByZXN0aWdlIikKICAgICAgICAgICAgcHJlc3RpZ2VVcGdyYWRlc093bmVkKys7CiAgICAgICAgfQogICAgICAgIGlmIChwcmVzdGlnZVVwZ3JhZGVzT3duZWQgPj0gMTAwKSBHYW1lLldpbigiQWxsIHRoZSBzdGFycyBpbiBoZWF2ZW4iKTsKCiAgICAgICAgR2FtZS5yZW1vdmVDbGFzcygiYXNjZW5kaW5nIik7CiAgICAgICAgR2FtZS5PbkFzY2VuZCA9IDA7CiAgICAgICAgLy90cmlnZ2VyIHRoZSByZWluY2FybmF0ZSBhbmltYXRpb24KICAgICAgICBHYW1lLlJlaW5jYXJuYXRlVGltZXIgPSAxOwogICAgICAgIEdhbWUuYWRkQ2xhc3MoInJlaW5jYXJuYXRpbmciKTsKICAgICAgICBHYW1lLkJpZ0Nvb2tpZVNpemUgPSAwOwoKICAgICAgICBHYW1lLnJ1bk1vZEhvb2soInJlaW5jYXJuYXRlIik7CiAgICAgIH0KICAgIH07CiAgICBHYW1lLkFzY2VuZCA9IGZ1bmN0aW9uIChieXBhc3MpIHsKICAgICAgaWYgKCFieXBhc3MpCiAgICAgICAgR2FtZS5Qcm9tcHQoCiAgICAgICAgICAiPGlkIEFzY2VuZD48aDM+IiArCiAgICAgICAgICAgIGxvYygiQXNjZW5kIikgKwogICAgICAgICAgICAnPC9oMz48ZGl2IGNsYXNzPSJibG9jayI+JyArCiAgICAgICAgICAgIHRpbnlJY29uKFsxOSwgN10pICsKICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicgKwogICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgJ0RvIHlvdSBSRUFMTFkgd2FudCB0byBhc2NlbmQ/PGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+WW91IHdpbGwgbG9zZSB5b3VyIHByb2dyZXNzIGFuZCBzdGFydCBvdmVyIGZyb20gc2NyYXRjaC48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj5BbGwgeW91ciBjb29raWVzIHdpbGwgYmUgY29udmVydGVkIGludG8gcHJlc3RpZ2UgYW5kIGhlYXZlbmx5IGNoaXBzLicKICAgICAgICAgICAgKSArCiAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICAgICAgKEdhbWUuY2FuTHVtcHMoKQogICAgICAgICAgICAgID8gbG9jKAogICAgICAgICAgICAgICAgICAiWW91IHdpbGwga2VlcCB5b3VyIGFjaGlldmVtZW50cywgYnVpbGRpbmcgbGV2ZWxzIGFuZCBzdWdhciBsdW1wcy4iCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgOiBsb2MoIllvdSB3aWxsIGtlZXAgeW91ciBhY2hpZXZlbWVudHMuIikpICsKICAgICAgICAgICAgJzxkaXYgY2xhc3M9Im9wdGlvbkJveCI+PGEgY2xhc3M9Im9wdGlvbiBzbWFsbEZhbmN5QnV0dG9uIiBzdHlsZT0ibWFyZ2luOjE2cHg7cGFkZGluZzo4cHggMTZweDthbmltYXRpb246cmFpbmJvd0N5Y2xlIDVzIGluZmluaXRlIGVhc2UtaW4tb3V0LHB1Y2tlciAwLjJzIGVhc2Utb3V0O2JveC1zaGFkb3c6MHB4IDBweCAwcHggMXB4ICMwMDAsMHB4IDBweCAxcHggMnB4IGN1cnJlbnRjb2xvcjtiYWNrZ3JvdW5kOmxpbmVhci1ncmFkaWVudCh0byBib3R0b20sdHJhbnNwYXJlbnQgMCUsY3VycmVudENvbG9yIDUwMCUpO3dpZHRoOmF1dG87dGV4dC1hbGlnbjpjZW50ZXI7IiAnICsKICAgICAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgICAgICc9IlBsYXlTb3VuZChcJ3NuZC90aWNrLm1wM1wnKTtHYW1lLkNsb3NlUHJvbXB0KCk7R2FtZS5Bc2NlbmQoMSk7IiBpZD0icHJvbXB0T3B0aW9uMCI+JyArCiAgICAgICAgICAgIGxvYygiQXNjZW5kIikgKwogICAgICAgICAgICAiPC9hPjwvZGl2PjwvZGl2PiIsCiAgICAgICAgICBbCiAgICAgICAgICAgIFsKICAgICAgICAgICAgICBsb2MoIlllcyIpLAogICAgICAgICAgICAgICJHYW1lLkNsb3NlUHJvbXB0KCk7R2FtZS5Bc2NlbmQoMSk7IiwKICAgICAgICAgICAgICAiZmxvYXQ6bGVmdDtkaXNwbGF5Om5vbmU7IiwKICAgICAgICAgICAgXSwKICAgICAgICAgICAgW2xvYygiQ2FuY2VsIiksIDAsICJmbG9hdDpyaWdodCJdLAogICAgICAgICAgXQogICAgICAgICk7CiAgICAgIGVsc2UgewogICAgICAgIEdhbWUuTm90aWZ5KGxvYygiQXNjZW5kaW5nIiksIGxvYygiU28gbG9uZywgY29va2llcy4iKSwgWzIwLCA3XSwgNCk7CiAgICAgICAgR2FtZS5PbkFzY2VuZCA9IDA7CiAgICAgICAgR2FtZS5yZW1vdmVDbGFzcygiYXNjZW5kaW5nIik7CiAgICAgICAgR2FtZS5hZGRDbGFzcygiYXNjZW5kSW50cm8iKTsKICAgICAgICAvL3RyaWdnZXIgdGhlIGFzY2VuZCBhbmltYXRpb24KICAgICAgICBHYW1lLkFzY2VuZFRpbWVyID0gMTsKICAgICAgICBHYW1lLmtpbGxTaGltbWVycygpOwogICAgICAgIGwoInRvZ2dsZUJveCIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgbCgidG9nZ2xlQm94IikuaW5uZXJIVE1MID0gIiI7CiAgICAgICAgR2FtZS5jaG9pY2VTZWxlY3Rvck9uID0gLTE7CiAgICAgICAgR2FtZS5Ub2dnbGVTcGVjaWFsTWVudSgwKTsKICAgICAgICBHYW1lLkFzY2VuZE9mZlggPSAwOwogICAgICAgIEdhbWUuQXNjZW5kT2ZmWSA9IDA7CiAgICAgICAgR2FtZS5Bc2NlbmRPZmZYVCA9IDA7CiAgICAgICAgR2FtZS5Bc2NlbmRPZmZZVCA9IDA7CiAgICAgICAgR2FtZS5Bc2NlbmRab29tVCA9IDE7CiAgICAgICAgR2FtZS5Bc2NlbmRab29tID0gMC4yOwoKICAgICAgICBHYW1lLmp1a2Vib3gucmVzZXQoKTsKICAgICAgICBQbGF5Q3VlKCJwcmVhc2NlbmQiKTsKICAgICAgfQogICAgfTsKCiAgICBHYW1lLkRlYnVnZ2luZ1ByZXN0aWdlID0gMDsKICAgIEdhbWUuQXNjZW5kRHJhZ1ggPSAwOwogICAgR2FtZS5Bc2NlbmREcmFnWSA9IDA7CiAgICBHYW1lLkFzY2VuZE9mZlggPSAwOwogICAgR2FtZS5Bc2NlbmRPZmZZID0gMDsKICAgIEdhbWUuQXNjZW5kWm9vbSA9IDE7CiAgICBHYW1lLkFzY2VuZE9mZlhUID0gMDsKICAgIEdhbWUuQXNjZW5kT2ZmWVQgPSAwOwogICAgR2FtZS5Bc2NlbmRab29tVCA9IDE7CiAgICBHYW1lLkFzY2VuZERyYWdnaW5nID0gMDsKICAgIEdhbWUuQXNjZW5kR3JpZFNuYXAgPSAyNDsKICAgIEdhbWUuaGVhdmVubHlCb3VuZHMgPSB7IGxlZnQ6IDAsIHJpZ2h0OiAwLCB0b3A6IDAsIGJvdHRvbTogMCB9OwogICAgR2FtZS5VcGRhdGVBc2NlbmQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChHYW1lLmtleXNbMzddKSBHYW1lLkFzY2VuZE9mZlhUICs9IDE2ICogKDEgLyBHYW1lLkFzY2VuZFpvb21UKTsKICAgICAgaWYgKEdhbWUua2V5c1szOF0pIEdhbWUuQXNjZW5kT2ZmWVQgKz0gMTYgKiAoMSAvIEdhbWUuQXNjZW5kWm9vbVQpOwogICAgICBpZiAoR2FtZS5rZXlzWzM5XSkgR2FtZS5Bc2NlbmRPZmZYVCAtPSAxNiAqICgxIC8gR2FtZS5Bc2NlbmRab29tVCk7CiAgICAgIGlmIChHYW1lLmtleXNbNDBdKSBHYW1lLkFzY2VuZE9mZllUIC09IDE2ICogKDEgLyBHYW1lLkFzY2VuZFpvb21UKTsKCiAgICAgIGlmIChHYW1lLkFzY2VuZE9mZlhUID4gLUdhbWUuaGVhdmVubHlCb3VuZHMubGVmdCkKICAgICAgICBHYW1lLkFzY2VuZE9mZlhUID0gLUdhbWUuaGVhdmVubHlCb3VuZHMubGVmdDsKICAgICAgaWYgKEdhbWUuQXNjZW5kT2ZmWFQgPCAtR2FtZS5oZWF2ZW5seUJvdW5kcy5yaWdodCkKICAgICAgICBHYW1lLkFzY2VuZE9mZlhUID0gLUdhbWUuaGVhdmVubHlCb3VuZHMucmlnaHQ7CiAgICAgIGlmIChHYW1lLkFzY2VuZE9mZllUID4gLUdhbWUuaGVhdmVubHlCb3VuZHMudG9wKQogICAgICAgIEdhbWUuQXNjZW5kT2ZmWVQgPSAtR2FtZS5oZWF2ZW5seUJvdW5kcy50b3A7CiAgICAgIGlmIChHYW1lLkFzY2VuZE9mZllUIDwgLUdhbWUuaGVhdmVubHlCb3VuZHMuYm90dG9tKQogICAgICAgIEdhbWUuQXNjZW5kT2ZmWVQgPSAtR2FtZS5oZWF2ZW5seUJvdW5kcy5ib3R0b207CiAgICAgIEdhbWUuQXNjZW5kT2ZmWCArPSAoR2FtZS5Bc2NlbmRPZmZYVCAtIEdhbWUuQXNjZW5kT2ZmWCkgKiAwLjU7CiAgICAgIEdhbWUuQXNjZW5kT2ZmWSArPSAoR2FtZS5Bc2NlbmRPZmZZVCAtIEdhbWUuQXNjZW5kT2ZmWSkgKiAwLjU7CiAgICAgIEdhbWUuQXNjZW5kWm9vbSArPSAoR2FtZS5Bc2NlbmRab29tVCAtIEdhbWUuQXNjZW5kWm9vbSkgKiAwLjI1OwogICAgICBpZiAoTWF0aC5hYnMoR2FtZS5Bc2NlbmRab29tVCAtIEdhbWUuQXNjZW5kWm9vbSkgPCAwLjAwNSkKICAgICAgICBHYW1lLkFzY2VuZFpvb20gPSBHYW1lLkFzY2VuZFpvb21UOwoKICAgICAgaWYgKEdhbWUubW91c2VEb3duICYmICFHYW1lLnByb21wdE9uKSB7CiAgICAgICAgaWYgKCFHYW1lLkFzY2VuZERyYWdnaW5nKSB7CiAgICAgICAgICBHYW1lLkFzY2VuZERyYWdYID0gR2FtZS5tb3VzZVg7CiAgICAgICAgICBHYW1lLkFzY2VuZERyYWdZID0gR2FtZS5tb3VzZVk7CiAgICAgICAgfQogICAgICAgIEdhbWUuQXNjZW5kRHJhZ2dpbmcgPSAxOwoKICAgICAgICBpZiAoR2FtZS5EZWJ1Z2dpbmdQcmVzdGlnZSkgewogICAgICAgICAgaWYgKEdhbWUuU2VsZWN0ZWRIZWF2ZW5seVVwZ3JhZGUpIHsKICAgICAgICAgICAgR2FtZS50b29sdGlwLmhpZGUoKTsKICAgICAgICAgICAgLy9kcmFnIHVwZ3JhZGVzIGFyb3VuZAogICAgICAgICAgICB2YXIgbWUgPSBHYW1lLlNlbGVjdGVkSGVhdmVubHlVcGdyYWRlOwogICAgICAgICAgICBtZS5wb3NYICs9CiAgICAgICAgICAgICAgKEdhbWUubW91c2VYIC0gR2FtZS5Bc2NlbmREcmFnWCkgKiAoMSAvIEdhbWUuQXNjZW5kWm9vbVQpOwogICAgICAgICAgICBtZS5wb3NZICs9CiAgICAgICAgICAgICAgKEdhbWUubW91c2VZIC0gR2FtZS5Bc2NlbmREcmFnWSkgKiAoMSAvIEdhbWUuQXNjZW5kWm9vbVQpOwogICAgICAgICAgICB2YXIgcG9zWCA9IG1lLnBvc1g7IC8vTWF0aC5yb3VuZChtZS5wb3NYL0dhbWUuQXNjZW5kR3JpZFNuYXApKkdhbWUuQXNjZW5kR3JpZFNuYXA7CiAgICAgICAgICAgIHZhciBwb3NZID0gbWUucG9zWTsgLy9NYXRoLnJvdW5kKG1lLnBvc1kvR2FtZS5Bc2NlbmRHcmlkU25hcCkqR2FtZS5Bc2NlbmRHcmlkU25hcDsKICAgICAgICAgICAgbCgiaGVhdmVubHlVcGdyYWRlIiArIG1lLmlkKS5zdHlsZS5sZWZ0ID0gTWF0aC5mbG9vcihwb3NYKSArICJweCI7CiAgICAgICAgICAgIGwoImhlYXZlbmx5VXBncmFkZSIgKyBtZS5pZCkuc3R5bGUudG9wID0gTWF0aC5mbG9vcihwb3NZKSArICJweCI7CiAgICAgICAgICAgIGZvciAodmFyIGlpIGluIG1lLnBhcmVudHMpIHsKICAgICAgICAgICAgICB2YXIgb3JpZ1ggPSAwOwogICAgICAgICAgICAgIHZhciBvcmlnWSA9IDA7CiAgICAgICAgICAgICAgdmFyIHRhcmdYID0gbWUucG9zWCArIDI4OwogICAgICAgICAgICAgIHZhciB0YXJnWSA9IG1lLnBvc1kgKyAyODsKICAgICAgICAgICAgICBpZiAobWUucGFyZW50c1tpaV0gIT0gLTEpIHsKICAgICAgICAgICAgICAgIG9yaWdYID0gbWUucGFyZW50c1tpaV0ucG9zWCArIDI4OwogICAgICAgICAgICAgICAgb3JpZ1kgPSBtZS5wYXJlbnRzW2lpXS5wb3NZICsgMjg7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHZhciByb3QgPQogICAgICAgICAgICAgICAgLShNYXRoLmF0YW4oKHRhcmdZIC0gb3JpZ1kpIC8gKG9yaWdYIC0gdGFyZ1gpKSAvIE1hdGguUEkpICogMTgwOwogICAgICAgICAgICAgIGlmICh0YXJnWCA8PSBvcmlnWCkgcm90ICs9IDE4MDsKICAgICAgICAgICAgICB2YXIgZGlzdCA9IE1hdGguZmxvb3IoCiAgICAgICAgICAgICAgICBNYXRoLnNxcnQoCiAgICAgICAgICAgICAgICAgICh0YXJnWCAtIG9yaWdYKSAqICh0YXJnWCAtIG9yaWdYKSArCiAgICAgICAgICAgICAgICAgICAgKHRhcmdZIC0gb3JpZ1kpICogKHRhcmdZIC0gb3JpZ1kpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgbCgiaGVhdmVubHlMaW5rIiArIG1lLmlkICsgIi0iICsgaWkpLnN0eWxlID0KICAgICAgICAgICAgICAgICJ3aWR0aDoiICsKICAgICAgICAgICAgICAgIGRpc3QgKwogICAgICAgICAgICAgICAgInB4O3RyYW5zZm9ybTpyb3RhdGUoIiArCiAgICAgICAgICAgICAgICByb3QgKwogICAgICAgICAgICAgICAgImRlZyk7bGVmdDoiICsKICAgICAgICAgICAgICAgIG9yaWdYICsKICAgICAgICAgICAgICAgICJweDt0b3A6IiArCiAgICAgICAgICAgICAgICBvcmlnWSArCiAgICAgICAgICAgICAgICAicHg7IjsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoIUdhbWUuU2VsZWN0ZWRIZWF2ZW5seVVwZ3JhZGUpIHsKICAgICAgICAgIEdhbWUuQXNjZW5kT2ZmWFQgKz0KICAgICAgICAgICAgKEdhbWUubW91c2VYIC0gR2FtZS5Bc2NlbmREcmFnWCkgKiAoMSAvIEdhbWUuQXNjZW5kWm9vbVQpOwogICAgICAgICAgR2FtZS5Bc2NlbmRPZmZZVCArPQogICAgICAgICAgICAoR2FtZS5tb3VzZVkgLSBHYW1lLkFzY2VuZERyYWdZKSAqICgxIC8gR2FtZS5Bc2NlbmRab29tVCk7CiAgICAgICAgfQogICAgICAgIEdhbWUuQXNjZW5kRHJhZ1ggPSBHYW1lLm1vdXNlWDsKICAgICAgICBHYW1lLkFzY2VuZERyYWdZID0gR2FtZS5tb3VzZVk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLyppZiAoR2FtZS5TZWxlY3RlZEhlYXZlbmx5VXBncmFkZSkKCQkJCXsKCQkJCQl2YXIgbWU9R2FtZS5TZWxlY3RlZEhlYXZlbmx5VXBncmFkZTsKCQkJCQltZS5wb3NYPU1hdGgucm91bmQobWUucG9zWC9HYW1lLkFzY2VuZEdyaWRTbmFwKSpHYW1lLkFzY2VuZEdyaWRTbmFwOwoJCQkJCW1lLnBvc1k9TWF0aC5yb3VuZChtZS5wb3NZL0dhbWUuQXNjZW5kR3JpZFNuYXApKkdhbWUuQXNjZW5kR3JpZFNuYXA7CgkJCQkJbCgnaGVhdmVubHlVcGdyYWRlJyttZS5pZCkuc3R5bGUubGVmdD1tZS5wb3NYKydweCc7CgkJCQkJbCgnaGVhdmVubHlVcGdyYWRlJyttZS5pZCkuc3R5bGUudG9wPW1lLnBvc1krJ3B4JzsKCQkJCX0qLwogICAgICAgIEdhbWUuQXNjZW5kRHJhZ2dpbmcgPSAwOwogICAgICAgIEdhbWUuU2VsZWN0ZWRIZWF2ZW5seVVwZ3JhZGUgPSAwOwogICAgICB9CiAgICAgIGlmIChHYW1lLkNsaWNrIHx8IEdhbWUucHJvbXB0T24pIHsKICAgICAgICBHYW1lLkFzY2VuZERyYWdnaW5nID0gMDsKICAgICAgfQoKICAgICAgLy9HYW1lLmFzY2VuZGwuc3R5bGUuYmFja2dyb3VuZFBvc2l0aW9uPU1hdGguZmxvb3IoR2FtZS5Bc2NlbmRPZmZYLzIpKydweCAnK01hdGguZmxvb3IoR2FtZS5Bc2NlbmRPZmZZLzIpKydweCc7CiAgICAgIC8vR2FtZS5hc2NlbmRsLnN0eWxlLmJhY2tncm91bmRQb3NpdGlvbj1NYXRoLmZsb29yKEdhbWUuQXNjZW5kT2ZmWC8yKSsncHggJytNYXRoLmZsb29yKEdhbWUuQXNjZW5kT2ZmWS8yKSsncHgsJytNYXRoLmZsb29yKEdhbWUuQXNjZW5kT2ZmWC80KSsncHggJytNYXRoLmZsb29yKEdhbWUuQXNjZW5kT2ZmWS80KSsncHgnOwogICAgICAvL0dhbWUuYXNjZW5kQ29udGVudGwuc3R5bGUubGVmdD1NYXRoLmZsb29yKEdhbWUuQXNjZW5kT2ZmWCkrJ3B4JzsKICAgICAgLy9HYW1lLmFzY2VuZENvbnRlbnRsLnN0eWxlLnRvcD1NYXRoLmZsb29yKEdhbWUuQXNjZW5kT2ZmWSkrJ3B4JzsKICAgICAgR2FtZS5hc2NlbmRDb250ZW50bC5zdHlsZS53ZWJraXRUcmFuc2Zvcm0gPQogICAgICAgICJ0cmFuc2xhdGUoIiArCiAgICAgICAgTWF0aC5mbG9vcihHYW1lLkFzY2VuZE9mZlgpICsKICAgICAgICAicHgsIiArCiAgICAgICAgTWF0aC5mbG9vcihHYW1lLkFzY2VuZE9mZlkpICsKICAgICAgICAicHgpIjsKICAgICAgR2FtZS5hc2NlbmRDb250ZW50bC5zdHlsZS5tc1RyYW5zZm9ybSA9CiAgICAgICAgInRyYW5zbGF0ZSgiICsKICAgICAgICBNYXRoLmZsb29yKEdhbWUuQXNjZW5kT2ZmWCkgKwogICAgICAgICJweCwiICsKICAgICAgICBNYXRoLmZsb29yKEdhbWUuQXNjZW5kT2ZmWSkgKwogICAgICAgICJweCkiOwogICAgICBHYW1lLmFzY2VuZENvbnRlbnRsLnN0eWxlLm9UcmFuc2Zvcm0gPQogICAgICAgICJ0cmFuc2xhdGUoIiArCiAgICAgICAgTWF0aC5mbG9vcihHYW1lLkFzY2VuZE9mZlgpICsKICAgICAgICAicHgsIiArCiAgICAgICAgTWF0aC5mbG9vcihHYW1lLkFzY2VuZE9mZlkpICsKICAgICAgICAicHgpIjsKICAgICAgR2FtZS5hc2NlbmRDb250ZW50bC5zdHlsZS5tb3pUcmFuc2Zvcm0gPQogICAgICAgICJ0cmFuc2xhdGUoIiArCiAgICAgICAgTWF0aC5mbG9vcihHYW1lLkFzY2VuZE9mZlgpICsKICAgICAgICAicHgsIiArCiAgICAgICAgTWF0aC5mbG9vcihHYW1lLkFzY2VuZE9mZlkpICsKICAgICAgICAicHgpIjsKICAgICAgR2FtZS5hc2NlbmRDb250ZW50bC5zdHlsZS50cmFuc2Zvcm0gPQogICAgICAgICJ0cmFuc2xhdGUoIiArCiAgICAgICAgTWF0aC5mbG9vcihHYW1lLkFzY2VuZE9mZlgpICsKICAgICAgICAicHgsIiArCiAgICAgICAgTWF0aC5mbG9vcihHYW1lLkFzY2VuZE9mZlkpICsKICAgICAgICAicHgpIjsKICAgICAgR2FtZS5hc2NlbmRab29tYWJsZWwuc3R5bGUud2Via2l0VHJhbnNmb3JtID0KICAgICAgICAic2NhbGUoIiArIEdhbWUuQXNjZW5kWm9vbSArICIsIiArIEdhbWUuQXNjZW5kWm9vbSArICIpIjsKICAgICAgR2FtZS5hc2NlbmRab29tYWJsZWwuc3R5bGUubWFyZ2luTGVmdCA9IEdhbWUud2luZG93VyAvIDIgKyAicHgiOwogICAgICBHYW1lLmFzY2VuZFpvb21hYmxlbC5zdHlsZS5tYXJnaW5Ub3AgPSBHYW1lLndpbmRvd0ggLyAyICsgInB4IjsKICAgICAgR2FtZS5hc2NlbmRab29tYWJsZWwuc3R5bGUubXNUcmFuc2Zvcm0gPQogICAgICAgICJzY2FsZSgiICsgR2FtZS5Bc2NlbmRab29tICsgIiwiICsgR2FtZS5Bc2NlbmRab29tICsgIikiOwogICAgICBHYW1lLmFzY2VuZFpvb21hYmxlbC5zdHlsZS5vVHJhbnNmb3JtID0KICAgICAgICAic2NhbGUoIiArIEdhbWUuQXNjZW5kWm9vbSArICIsIiArIEdhbWUuQXNjZW5kWm9vbSArICIpIjsKICAgICAgR2FtZS5hc2NlbmRab29tYWJsZWwuc3R5bGUubW96VHJhbnNmb3JtID0KICAgICAgICAic2NhbGUoIiArIEdhbWUuQXNjZW5kWm9vbSArICIsIiArIEdhbWUuQXNjZW5kWm9vbSArICIpIjsKICAgICAgR2FtZS5hc2NlbmRab29tYWJsZWwuc3R5bGUudHJhbnNmb3JtID0KICAgICAgICAic2NhbGUoIiArIEdhbWUuQXNjZW5kWm9vbSArICIsIiArIEdhbWUuQXNjZW5kWm9vbSArICIpIjsKCiAgICAgIC8vaWYgKEdhbWUuU2Nyb2xsIT0wKSBHYW1lLmFzY2VuZENvbnRlbnRsLnN0eWxlLnRyYW5zZm9ybU9yaWdpbj1NYXRoLmZsb29yKEdhbWUud2luZG93Vy8yLUdhbWUubW91c2VYKSsncHggJytNYXRoLmZsb29yKEdhbWUud2luZG93SC8yLUdhbWUubW91c2VZKSsncHgnOwogICAgICBpZiAoR2FtZS5TY3JvbGwgPCAwICYmICFHYW1lLnByb21wdE9uKSB7CiAgICAgICAgR2FtZS5Bc2NlbmRab29tVCA9IDAuNTsKICAgICAgfQogICAgICBpZiAoR2FtZS5TY3JvbGwgPiAwICYmICFHYW1lLnByb21wdE9uKSB7CiAgICAgICAgR2FtZS5Bc2NlbmRab29tVCA9IDE7CiAgICAgIH0KCiAgICAgIGlmIChHYW1lLlQgJSAyID09IDApIHsKICAgICAgICBsKCJhc2NlbmRQcmVzdGlnZSIpLmlubmVySFRNTCA9CiAgICAgICAgICBsb2MoIlByZXN0aWdlIGxldmVsOiIpICsgIjxicj4iICsgU2ltcGxlQmVhdXRpZnkoR2FtZS5wcmVzdGlnZSk7CiAgICAgICAgbCgiYXNjZW5kSENzIikuaW5uZXJIVE1MID0KICAgICAgICAgIGxvYygiSGVhdmVubHkgY2hpcHM6IikgKwogICAgICAgICAgJzxicj48c3BhbiBjbGFzcz0icHJpY2UgaGVhdmVubHkiPicgKwogICAgICAgICAgU2ltcGxlQmVhdXRpZnkoTWF0aC5yb3VuZChHYW1lLmhlYXZlbmx5Q2hpcHNEaXNwbGF5ZWQpKSArCiAgICAgICAgICAiPC9zcGFuPiI7CiAgICAgICAgaWYgKEdhbWUucHJlc3RpZ2UgPiAwKSBsKCJhc2NlbmRNb2RlQnV0dG9uIikuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgICAgZWxzZSBsKCJhc2NlbmRNb2RlQnV0dG9uIikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgfQogICAgICBHYW1lLmhlYXZlbmx5Q2hpcHNEaXNwbGF5ZWQgKz0KICAgICAgICAoR2FtZS5oZWF2ZW5seUNoaXBzIC0gR2FtZS5oZWF2ZW5seUNoaXBzRGlzcGxheWVkKSAqIDAuNDsKCiAgICAgIGlmIChHYW1lLkRlYnVnZ2luZ1ByZXN0aWdlICYmIEdhbWUuVCAlIDEwID09IDApIHsKICAgICAgICB2YXIgc3RyID0gIiI7CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlByZXN0aWdlVXBncmFkZXMpIHsKICAgICAgICAgIHZhciBtZSA9IEdhbWUuUHJlc3RpZ2VVcGdyYWRlc1tpXTsKICAgICAgICAgIGlmIChtZS5wbGFjZWRCeUNvZGUpIGNvbnRpbnVlOwogICAgICAgICAgc3RyICs9CiAgICAgICAgICAgIG1lLmlkICsKICAgICAgICAgICAgIjpbIiArCiAgICAgICAgICAgIE1hdGguZmxvb3IobWUucG9zWCkgKwogICAgICAgICAgICAiLCIgKwogICAgICAgICAgICBNYXRoLmZsb29yKG1lLnBvc1kpICsKICAgICAgICAgICAgIl0sIjsKICAgICAgICB9CiAgICAgICAgbCgidXBncmFkZVBvc2l0aW9ucyIpLnZhbHVlID0gIkdhbWUuVXBncmFkZVBvc2l0aW9ucz17IiArIHN0ciArICJ9OyI7CiAgICAgIH0KICAgICAgLy9pZiAoR2FtZS5UJTU9PTApIEdhbWUuQnVpbGRBc2NlbmRUcmVlKCk7CiAgICB9OwogICAgR2FtZS5Bc2NlbmRSZWZvY3VzID0gZnVuY3Rpb24gKCkgewogICAgICBHYW1lLkFzY2VuZE9mZlggPSAwOwogICAgICBHYW1lLkFzY2VuZE9mZlkgPSAwOwogICAgICBHYW1lLmFzY2VuZGwuY2xhc3NOYW1lID0gIiI7CiAgICB9OwoKICAgIEdhbWUuU2VsZWN0ZWRIZWF2ZW5seVVwZ3JhZGUgPSAwOwogICAgR2FtZS5QdXJjaGFzZUhlYXZlbmx5VXBncmFkZSA9IGZ1bmN0aW9uICh3aGF0KSB7CiAgICAgIC8vaWYgKEdhbWUuSGFzKCdOZXVyb21hbmN5JykpIEdhbWUuVXBncmFkZXNCeUlkW3doYXRdLnRvZ2dsZSgpOyBlbHNlCiAgICAgIGlmIChHYW1lLlVwZ3JhZGVzQnlJZFt3aGF0XS5idXkoKSkgewogICAgICAgIGlmIChsKCJoZWF2ZW5seVVwZ3JhZGUiICsgd2hhdCkpIHsKICAgICAgICAgIHZhciByZWN0ID0gbCgiaGVhdmVubHlVcGdyYWRlIiArIHdoYXQpLmdldEJvdW5kcygpOwogICAgICAgICAgR2FtZS5TcGFya2xlQXQoCiAgICAgICAgICAgIChyZWN0LmxlZnQgKyByZWN0LnJpZ2h0KSAvIDIsCiAgICAgICAgICAgIChyZWN0LnRvcCArIHJlY3QuYm90dG9tKSAvIDIgLSAyNAogICAgICAgICAgKTsKICAgICAgICB9CiAgICAgICAgLy9HYW1lLkJ1aWxkQXNjZW5kVHJlZSgpOwogICAgICB9CiAgICB9OwogICAgR2FtZS5CdWlsZEFzY2VuZFRyZWUgPSBmdW5jdGlvbiAoanVzdEJvdWdodCkgewogICAgICB2YXIgc3RyID0gIiI7CiAgICAgIEdhbWUuaGVhdmVubHlCb3VuZHMgPSB7IGxlZnQ6IDAsIHJpZ2h0OiAwLCB0b3A6IDAsIGJvdHRvbTogMCB9OwoKICAgICAgaWYgKEdhbWUuRGVidWdnaW5nUHJlc3RpZ2UpIGwoInVwZ3JhZGVQb3NpdGlvbnMiKS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgZWxzZSBsKCJ1cGdyYWRlUG9zaXRpb25zIikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKCiAgICAgIHZhciB0b1BvcCA9IFtdOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUuUHJlc3RpZ2VVcGdyYWRlcykgewogICAgICAgIHZhciBtZSA9IEdhbWUuUHJlc3RpZ2VVcGdyYWRlc1tpXTsKICAgICAgICB2YXIgcHJldkNhbkJlUHVyY2hhc2VkID0gbWUuY2FuQmVQdXJjaGFzZWQ7CiAgICAgICAgbWUuY2FuQmVQdXJjaGFzZWQgPSAxOwogICAgICAgIGlmICghbWUuYm91Z2h0ICYmICFHYW1lLkRlYnVnZ2luZ1ByZXN0aWdlKSB7CiAgICAgICAgICBpZiAobWUuc2hvd0lmICYmICFtZS5zaG93SWYoKSkgbWUuY2FuQmVQdXJjaGFzZWQgPSAwOwogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGZvciAodmFyIGlpIGluIG1lLnBhcmVudHMpIHsKICAgICAgICAgICAgICBpZiAobWUucGFyZW50c1tpaV0gIT0gLTEgJiYgIW1lLnBhcmVudHNbaWldLmJvdWdodCkKICAgICAgICAgICAgICAgIG1lLmNhbkJlUHVyY2hhc2VkID0gMDsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoCiAgICAgICAgICBqdXN0Qm91Z2h0ICYmCiAgICAgICAgICBtZS5wYXJlbnRzLmluZGV4T2YoanVzdEJvdWdodCkgIT0gLTEgJiYKICAgICAgICAgICFwcmV2Q2FuQmVQdXJjaGFzZWQgJiYKICAgICAgICAgIG1lLmNhbkJlUHVyY2hhc2VkICYmCiAgICAgICAgICAhbWUuYm91Z2h0CiAgICAgICAgKQogICAgICAgICAgdG9Qb3AucHVzaChtZSk7CiAgICAgIH0KICAgICAgdG9Qb3Auc29ydCgKICAgICAgICAoZnVuY3Rpb24gKHBhcmVudCkgewogICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgICAgIHZhciByb3QgPQogICAgICAgICAgICAgIE1hdGguYXRhbjIoYS5wb3NZIC0gcGFyZW50LnBvc1ksIHBhcmVudC5wb3NYIC0gYS5wb3NYKSAtCiAgICAgICAgICAgICAgTWF0aC5QSSAvIDI7CiAgICAgICAgICAgIHZhciByb3QyID0KICAgICAgICAgICAgICBNYXRoLmF0YW4yKGIucG9zWSAtIHBhcmVudC5wb3NZLCBwYXJlbnQucG9zWCAtIGIucG9zWCkgLQogICAgICAgICAgICAgIE1hdGguUEkgLyAyOwogICAgICAgICAgICByZXR1cm4gcm90IDwgcm90MjsKICAgICAgICAgIH07CiAgICAgICAgfSkoanVzdEJvdWdodCkKICAgICAgKTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b1BvcC5sZW5ndGg7IGkrKykgewogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgUGxheVNvdW5kKAogICAgICAgICAgICAic25kL3BvcCIgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAzICsgMSkgKyAiLm1wMyIsCiAgICAgICAgICAgIDAuNQogICAgICAgICAgKTsKICAgICAgICB9LCAoMC4yICsgaSAqIDAuMSkgKiAxMDAwKTsKICAgICAgfQogICAgICBzdHIgKz0KICAgICAgICAnPGRpdiBjbGFzcz0iY3JhdGUgdXBncmFkZSBoZWF2ZW5seSBlbmFibGVkIiBzdHlsZT0icG9zaXRpb246YWJzb2x1dGU7bGVmdDotMzBweDt0b3A6LTMwcHg7b3BhY2l0eTowLjg7cG9pbnRlci1ldmVudHM6bm9uZTt0cmFuc2Zvcm06c2NhbGUoMS4zKTtiYWNrZ3JvdW5kOnRyYW5zcGFyZW50OyI+PC9kaXY+JzsKICAgICAgc3RyICs9ICc8ZGl2IGNsYXNzPSJjcmF0ZUJveCIgc3R5bGU9ImZpbHRlcjpub25lOy13ZWJraXQtZmlsdGVyOm5vbmU7Ij4nOyAvL2Nocm9tZSBpcyBzdGlsbCBiYWQgYXQgdGhlc2UKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlByZXN0aWdlVXBncmFkZXMpIHsKICAgICAgICB2YXIgbWUgPSBHYW1lLlByZXN0aWdlVXBncmFkZXNbaV07CgogICAgICAgIHZhciBnaG9zdGVkID0gMDsKICAgICAgICBpZiAobWUuY2FuQmVQdXJjaGFzZWQgfHwgR2FtZS5IYXMoIk5ldXJvbWFuY3kiKSkgewogICAgICAgICAgc3RyICs9IEdhbWUuY3JhdGUoCiAgICAgICAgICAgIG1lLAogICAgICAgICAgICAiYXNjZW5kIiwKICAgICAgICAgICAgIkdhbWUuUHVyY2hhc2VIZWF2ZW5seVVwZ3JhZGUoIiArIG1lLmlkICsgIik7IiwKICAgICAgICAgICAgImhlYXZlbmx5VXBncmFkZSIgKyBtZS5pZCwKICAgICAgICAgICAgdG9Qb3AuaW5kZXhPZihtZSkgIT0gLTEKICAgICAgICAgICAgICA/ICJhbmltYXRpb246cHVja2VyIDAuMnMgZWFzZS1vdXQ7YW5pbWF0aW9uLWRlbGF5OiIgKwogICAgICAgICAgICAgICAgICAodG9Qb3AuaW5kZXhPZihtZSkgKiAwLjEgKyAwLjIpICsKICAgICAgICAgICAgICAgICAgInM7IgogICAgICAgICAgICAgIDogIiIKICAgICAgICAgICk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGZvciAodmFyIGlpIGluIG1lLnBhcmVudHMpIHsKICAgICAgICAgICAgaWYgKG1lLnBhcmVudHNbaWldICE9IC0xICYmIG1lLnBhcmVudHNbaWldLmNhbkJlUHVyY2hhc2VkKQogICAgICAgICAgICAgIGdob3N0ZWQgPSAxOwogICAgICAgICAgfQogICAgICAgICAgaWYgKG1lLnNob3dJZiAmJiAhbWUuc2hvd0lmKCkpIGdob3N0ZWQgPSAwOwogICAgICAgICAgaWYgKGdob3N0ZWQpIHsKICAgICAgICAgICAgLy9tYXliZSByZXBsYWNlIHRoaXMgd2l0aCBHYW1lLmNyYXRlKCkKICAgICAgICAgICAgc3RyICs9CiAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImNyYXRlIHVwZ3JhZGUgaGVhdmVubHkgZ2hvc3RlZCIgaWQ9ImhlYXZlbmx5VXBncmFkZScgKwogICAgICAgICAgICAgIG1lLmlkICsKICAgICAgICAgICAgICAnIiBzdHlsZT0icG9zaXRpb246YWJzb2x1dGU7bGVmdDonICsKICAgICAgICAgICAgICBtZS5wb3NYICsKICAgICAgICAgICAgICAicHg7dG9wOiIgKwogICAgICAgICAgICAgIG1lLnBvc1kgKwogICAgICAgICAgICAgICJweDsiICsKICAgICAgICAgICAgICB3cml0ZUljb24obWUuaWNvbikgKwogICAgICAgICAgICAgICciPjwvZGl2Pic7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChtZS5jYW5CZVB1cmNoYXNlZCB8fCBHYW1lLkhhcygiTmV1cm9tYW5jeSIpIHx8IGdob3N0ZWQpIHsKICAgICAgICAgIGlmIChtZS5wb3NYIDwgR2FtZS5oZWF2ZW5seUJvdW5kcy5sZWZ0KQogICAgICAgICAgICBHYW1lLmhlYXZlbmx5Qm91bmRzLmxlZnQgPSBtZS5wb3NYOwogICAgICAgICAgaWYgKG1lLnBvc1ggPiBHYW1lLmhlYXZlbmx5Qm91bmRzLnJpZ2h0KQogICAgICAgICAgICBHYW1lLmhlYXZlbmx5Qm91bmRzLnJpZ2h0ID0gbWUucG9zWDsKICAgICAgICAgIGlmIChtZS5wb3NZIDwgR2FtZS5oZWF2ZW5seUJvdW5kcy50b3ApCiAgICAgICAgICAgIEdhbWUuaGVhdmVubHlCb3VuZHMudG9wID0gbWUucG9zWTsKICAgICAgICAgIGlmIChtZS5wb3NZID4gR2FtZS5oZWF2ZW5seUJvdW5kcy5ib3R0b20pCiAgICAgICAgICAgIEdhbWUuaGVhdmVubHlCb3VuZHMuYm90dG9tID0gbWUucG9zWTsKICAgICAgICB9CiAgICAgICAgZm9yICh2YXIgaWkgaW4gbWUucGFyZW50cykgeyAvL2NyZWF0ZSBwdWxzaW5nIGxpbmtzCiAgICAgICAgICBpZiAobWUucGFyZW50c1tpaV0gIT0gLTEgJiYgKG1lLmNhbkJlUHVyY2hhc2VkIHx8IGdob3N0ZWQpKSB7CiAgICAgICAgICAgIHZhciBvcmlnWCA9IDA7CiAgICAgICAgICAgIHZhciBvcmlnWSA9IDA7CiAgICAgICAgICAgIHZhciB0YXJnWCA9IG1lLnBvc1ggKyAyODsKICAgICAgICAgICAgdmFyIHRhcmdZID0gbWUucG9zWSArIDI4OwogICAgICAgICAgICBpZiAobWUucGFyZW50c1tpaV0gIT0gLTEpIHsKICAgICAgICAgICAgICBvcmlnWCA9IG1lLnBhcmVudHNbaWldLnBvc1ggKyAyODsKICAgICAgICAgICAgICBvcmlnWSA9IG1lLnBhcmVudHNbaWldLnBvc1kgKyAyODsKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgcm90ID0KICAgICAgICAgICAgICAtKE1hdGguYXRhbigodGFyZ1kgLSBvcmlnWSkgLyAob3JpZ1ggLSB0YXJnWCkpIC8gTWF0aC5QSSkgKiAxODA7CiAgICAgICAgICAgIGlmICh0YXJnWCA8PSBvcmlnWCkgcm90ICs9IDE4MDsKICAgICAgICAgICAgdmFyIGRpc3QgPSBNYXRoLmZsb29yKAogICAgICAgICAgICAgIE1hdGguc3FydCgKICAgICAgICAgICAgICAgICh0YXJnWCAtIG9yaWdYKSAqICh0YXJnWCAtIG9yaWdYKSArCiAgICAgICAgICAgICAgICAgICh0YXJnWSAtIG9yaWdZKSAqICh0YXJnWSAtIG9yaWdZKQogICAgICAgICAgICAgICkKICAgICAgICAgICAgKTsKICAgICAgICAgICAgc3RyICs9CiAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9InBhcmVudExpbmsiIGlkPSJoZWF2ZW5seUxpbmsnICsKICAgICAgICAgICAgICBtZS5pZCArCiAgICAgICAgICAgICAgIi0iICsKICAgICAgICAgICAgICBpaSArCiAgICAgICAgICAgICAgJyIgc3R5bGU9IicgKwogICAgICAgICAgICAgIChnaG9zdGVkID8gIm9wYWNpdHk6MC4xOyIgOiAiIikgKwogICAgICAgICAgICAgICJ3aWR0aDoiICsKICAgICAgICAgICAgICBkaXN0ICsKICAgICAgICAgICAgICAicHg7LXdlYmtpdC10cmFuc2Zvcm06cm90YXRlKCIgKwogICAgICAgICAgICAgIHJvdCArCiAgICAgICAgICAgICAgImRlZyk7LW1vei10cmFuc2Zvcm06cm90YXRlKCIgKwogICAgICAgICAgICAgIHJvdCArCiAgICAgICAgICAgICAgImRlZyk7LW1zLXRyYW5zZm9ybTpyb3RhdGUoIiArCiAgICAgICAgICAgICAgcm90ICsKICAgICAgICAgICAgICAiZGVnKTstby10cmFuc2Zvcm06cm90YXRlKCIgKwogICAgICAgICAgICAgIHJvdCArCiAgICAgICAgICAgICAgImRlZyk7dHJhbnNmb3JtOnJvdGF0ZSgiICsKICAgICAgICAgICAgICByb3QgKwogICAgICAgICAgICAgICJkZWcpO2xlZnQ6IiArCiAgICAgICAgICAgICAgb3JpZ1ggKwogICAgICAgICAgICAgICJweDt0b3A6IiArCiAgICAgICAgICAgICAgb3JpZ1kgKwogICAgICAgICAgICAgICdweDsiPjwvZGl2Pic7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIEdhbWUuaGVhdmVubHlCb3VuZHMubGVmdCAtPSAxMjg7CiAgICAgIEdhbWUuaGVhdmVubHlCb3VuZHMudG9wIC09IDEyODsKICAgICAgR2FtZS5oZWF2ZW5seUJvdW5kcy5yaWdodCArPSAxMjggKyA2NDsKICAgICAgR2FtZS5oZWF2ZW5seUJvdW5kcy5ib3R0b20gKz0gMTI4ICsgNjQ7CiAgICAgIC8vc3RyKz0nPGRpdiBzdHlsZT0iYm9yZGVyOjFweCBzb2xpZCByZWQ7cG9zaXRpb246YWJzb2x1dGU7bGVmdDonK0dhbWUuaGVhdmVubHlCb3VuZHMubGVmdCsncHg7d2lkdGg6JysoR2FtZS5oZWF2ZW5seUJvdW5kcy5yaWdodC1HYW1lLmhlYXZlbmx5Qm91bmRzLmxlZnQpKydweDt0b3A6JytHYW1lLmhlYXZlbmx5Qm91bmRzLnRvcCsncHg7aGVpZ2h0OicrKEdhbWUuaGVhdmVubHlCb3VuZHMuYm90dG9tLUdhbWUuaGVhdmVubHlCb3VuZHMudG9wKSsncHg7Ij48L2Rpdj4nOwogICAgICBzdHIgKz0gIjwvZGl2PiI7CiAgICAgIEdhbWUuYXNjZW5kVXBncmFkZXNsLmlubmVySFRNTCA9IHN0cjsKCiAgICAgIGlmIChHYW1lLkRlYnVnZ2luZ1ByZXN0aWdlKSB7CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlByZXN0aWdlVXBncmFkZXMpIHsKICAgICAgICAgIHZhciBtZSA9IEdhbWUuUHJlc3RpZ2VVcGdyYWRlc1tpXTsKICAgICAgICAgIEFkZEV2ZW50KAogICAgICAgICAgICBsKCJoZWF2ZW5seVVwZ3JhZGUiICsgbWUuaWQpLAogICAgICAgICAgICAibW91c2Vkb3duIiwKICAgICAgICAgICAgKGZ1bmN0aW9uIChtZSkgewogICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBpZiAoIUdhbWUuRGVidWdnaW5nUHJlc3RpZ2UpIHJldHVybjsKICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgR2FtZS5rZXlzWzE2XSAmJgogICAgICAgICAgICAgICAgICB0eXBlb2YgTEFTVEhFQVZFTkxZU0VMRUNURUQgIT09ICJ1bmRlZmluZWQiICYmCiAgICAgICAgICAgICAgICAgIG1lICE9IExBU1RIRUFWRU5MWVNFTEVDVEVECiAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgLy93aGVuIGNsaWNraW5nIGFuIHVwZ3JhZGUgd2l0aCBjdHJsLCBzZXQgaXQgYXMgcmVmZXJlbmNlIHBvaW50OyBjbGlja2luZyBhbnkgc2libGluZyB1cGdyYWRlIHdpdGggc2hpZnQgd2lsbCBhbGlnbiBpdCBpbiBhIG5pY2UgYXJjIGFyb3VuZCB0aGVpciBzaGFyZWQgcGFyZW50CiAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSAwOwogICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1lLnBhcmVudHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgICBMQVNUSEVBVkVOTFlTRUxFQ1RFRC5wYXJlbnRzLmluZGV4T2YobWUucGFyZW50c1tpXSkgIT0gLTEKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQgPSBtZS5wYXJlbnRzW2ldOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnQpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgb3JpZ1ggPSBwYXJlbnQucG9zWDsKICAgICAgICAgICAgICAgICAgICB2YXIgb3JpZ1kgPSBwYXJlbnQucG9zWTsKICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ1ggPSBMQVNUSEVBVkVOTFlTRUxFQ1RFRC5wb3NYOwogICAgICAgICAgICAgICAgICAgIHZhciB0YXJnWSA9IExBU1RIRUFWRU5MWVNFTEVDVEVELnBvc1k7CiAgICAgICAgICAgICAgICAgICAgdmFyIHJvdCA9CiAgICAgICAgICAgICAgICAgICAgICBNYXRoLmF0YW4yKHRhcmdZIC0gb3JpZ1ksIG9yaWdYIC0gdGFyZ1gpIC0gTWF0aC5QSSAvIDI7CiAgICAgICAgICAgICAgICAgICAgdmFyIGRpc3QgPSBNYXRoLmZsb29yKAogICAgICAgICAgICAgICAgICAgICAgTWF0aC5zcXJ0KAogICAgICAgICAgICAgICAgICAgICAgICAodGFyZ1ggLSBvcmlnWCkgKiAodGFyZ1ggLSBvcmlnWCkgKwogICAgICAgICAgICAgICAgICAgICAgICAgICh0YXJnWSAtIG9yaWdZKSAqICh0YXJnWSAtIG9yaWdZKQogICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgbWUucG9zWCA9CiAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQucG9zWCArIE1hdGguc2luKHJvdCAtIChNYXRoLlBJICogMikgLyA4KSAqIGRpc3Q7CiAgICAgICAgICAgICAgICAgICAgbWUucG9zWSA9CiAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQucG9zWSArIE1hdGguY29zKHJvdCAtIChNYXRoLlBJICogMikgLyA4KSAqIGRpc3Q7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgTEFTVEhFQVZFTkxZU0VMRUNURUQgPSBtZTsKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIlNldCByZWZlcmVuY2UgcG9pbnQgdG8iLCBtZS5uYW1lLCAiLiIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKEdhbWUua2V5c1sxN10pIHsKICAgICAgICAgICAgICAgICAgTEFTVEhFQVZFTkxZU0VMRUNURUQgPSBtZTsKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIlNldCByZWZlcmVuY2UgcG9pbnQgdG8iLCBtZS5uYW1lLCAiLiIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgR2FtZS5TZWxlY3RlZEhlYXZlbmx5VXBncmFkZSA9IG1lOwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0pKG1lKQogICAgICAgICAgKTsKICAgICAgICAgIEFkZEV2ZW50KAogICAgICAgICAgICBsKCJoZWF2ZW5seVVwZ3JhZGUiICsgbWUuaWQpLAogICAgICAgICAgICAibW91c2V1cCIsCiAgICAgICAgICAgIChmdW5jdGlvbiAobWUpIHsKICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgaWYgKEdhbWUuU2VsZWN0ZWRIZWF2ZW5seVVwZ3JhZGUgPT0gbWUpIHsKICAgICAgICAgICAgICAgICAgR2FtZS5TZWxlY3RlZEhlYXZlbmx5VXBncmFkZSA9IDA7CiAgICAgICAgICAgICAgICAgIEdhbWUuQnVpbGRBc2NlbmRUcmVlKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfSkobWUpCiAgICAgICAgICApOwogICAgICAgIH0KICAgICAgfQogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLnRvb2x0aXAuc2hvdWxkSGlkZSA9IHRydWU7CiAgICAgIH0sIDEwMCk7CiAgICB9OwoKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJCUNPQUxFU0NJTkcgU1VHQVIgTFVNUFMKCQk9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgR2FtZS5sdW1wTWF0dXJlQWdlID0gMTsKICAgIEdhbWUubHVtcFJpcGVBZ2UgPSAxOwogICAgR2FtZS5sdW1wT3ZlcnJpcGVBZ2UgPSAxOwogICAgR2FtZS5sdW1wQ3VycmVudFR5cGUgPSAwOwogICAgbCgiY29tbWVudHMiKS5pbm5lckhUTUwgPQogICAgICBsKCJjb21tZW50cyIpLmlubmVySFRNTCArCiAgICAgICc8ZGl2IGlkPSJsdW1wcyIgb25jbGljaz0iR2FtZS5jbGlja0x1bXAoKTsiICcgKwogICAgICBHYW1lLmdldER5bmFtaWNUb29sdGlwKCJHYW1lLmx1bXBUb29sdGlwIiwgImJvdHRvbSIpICsKICAgICAgJz48ZGl2IGlkPSJsdW1wc0ljb24iIGNsYXNzPSJ1c2VzSWNvbiI+PC9kaXY+PGRpdiBpZD0ibHVtcHNJY29uMiIgY2xhc3M9InVzZXNJY29uIj48L2Rpdj48ZGl2IGlkPSJsdW1wc0Ftb3VudCI+MDwvZGl2PjwvZGl2Pic7CiAgICBHYW1lLmx1bXBUb29sdGlwID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgc3RyID0KICAgICAgICAnPGRpdiBzdHlsZT0icGFkZGluZzo4cHg7d2lkdGg6NDAwcHg7Zm9udC1zaXplOjExcHg7dGV4dC1hbGlnbjpjZW50ZXI7IiBpZD0idG9vbHRpcEx1bXBzIj4nICsKICAgICAgICBsb2MoCiAgICAgICAgICAiWW91IGhhdmUgJTEuIiwKICAgICAgICAgICc8c3BhbiBjbGFzcz0icHJpY2UgbHVtcCI+JyArCiAgICAgICAgICAgIGxvYygiJTEgc3VnYXIgbHVtcCIsIExCZWF1dGlmeShHYW1lLmx1bXBzKSkgKwogICAgICAgICAgICAiPC9zcGFuPiIKICAgICAgICApICsKICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgbG9jKAogICAgICAgICAgIkEgPGI+c3VnYXIgbHVtcDwvYj4gaXMgY29hbGVzY2luZyBoZXJlLCBhdHRyYWN0ZWQgYnkgeW91ciBhY2NvbXBsaXNobWVudHMuIgogICAgICAgICk7CgogICAgICB2YXIgYWdlID0gRGF0ZS5ub3coKSAtIEdhbWUubHVtcFQ7CiAgICAgIHN0ciArPSAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JzsKICAgICAgaWYgKGFnZSA8IDApCiAgICAgICAgc3RyICs9IGxvYygKICAgICAgICAgICJUaGlzIHN1Z2FyIGx1bXAgaGFzIGJlZW4gZXhwb3NlZCB0byB0aW1lIHRyYXZlbCBzaGVuYW5pZ2FucyBhbmQgd2lsbCB0YWtlIGFuIGV4Y3J1Y2lhdGluZyA8Yj4lMTwvYj4gdG8gcmVhY2ggbWF0dXJpdHkuIiwKICAgICAgICAgIEdhbWUuc2F5VGltZSgoKEdhbWUubHVtcE1hdHVyZUFnZSAtIGFnZSkgLyAxMDAwICsgMSkgKiBHYW1lLmZwcywgLTEpCiAgICAgICAgKTsKICAgICAgZWxzZSBpZiAoYWdlIDwgR2FtZS5sdW1wTWF0dXJlQWdlKQogICAgICAgIHN0ciArPSBsb2MoCiAgICAgICAgICAiVGhpcyBzdWdhciBsdW1wIGlzIHN0aWxsIGdyb3dpbmcgYW5kIHdpbGwgdGFrZSA8Yj4lMTwvYj4gdG8gcmVhY2ggbWF0dXJpdHkuIiwKICAgICAgICAgIEdhbWUuc2F5VGltZSgoKEdhbWUubHVtcE1hdHVyZUFnZSAtIGFnZSkgLyAxMDAwICsgMSkgKiBHYW1lLmZwcywgLTEpCiAgICAgICAgKTsKICAgICAgZWxzZSBpZiAoYWdlIDwgR2FtZS5sdW1wUmlwZUFnZSkKICAgICAgICBzdHIgKz0gbG9jKAogICAgICAgICAgIlRoaXMgc3VnYXIgbHVtcCBpcyBtYXR1cmUgYW5kIHdpbGwgYmUgcmlwZSBpbiA8Yj4lMTwvYj4uPGJyPllvdSBtYXkgPGI+Y2xpY2sgaXQgdG8gaGFydmVzdCBpdCBub3c8L2I+LCBidXQgdGhlcmUgaXMgYSA8Yj41MCUgY2hhbmNlIHlvdSB3b24ndCBnZXQgYW55dGhpbmc8L2I+LiIsCiAgICAgICAgICBHYW1lLnNheVRpbWUoKChHYW1lLmx1bXBSaXBlQWdlIC0gYWdlKSAvIDEwMDAgKyAxKSAqIEdhbWUuZnBzLCAtMSkKICAgICAgICApOwogICAgICBlbHNlIGlmIChhZ2UgPCBHYW1lLmx1bXBPdmVycmlwZUFnZSkKICAgICAgICBzdHIgKz0gbG9jKAogICAgICAgICAgIjxiPlRoaXMgc3VnYXIgbHVtcCBpcyByaXBlISBDbGljayBpdCB0byBoYXJ2ZXN0IGl0LjwvYj48YnI+SWYgeW91IGRvIG5vdGhpbmcsIGl0IHdpbGwgYXV0by1oYXJ2ZXN0IGluIDxiPiUxPC9iPi4iLAogICAgICAgICAgR2FtZS5zYXlUaW1lKCgoR2FtZS5sdW1wT3ZlcnJpcGVBZ2UgLSBhZ2UpIC8gMTAwMCArIDEpICogR2FtZS5mcHMsIC0xKQogICAgICAgICk7CgogICAgICB2YXIgcGhhc2UgPSAoYWdlIC8gR2FtZS5sdW1wT3ZlcnJpcGVBZ2UpICogNzsKICAgICAgaWYgKHBoYXNlID49IDMpIHsKICAgICAgICBpZiAoR2FtZS5sdW1wQ3VycmVudFR5cGUgIT0gMCkgc3RyICs9ICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nOwogICAgICAgIGlmIChHYW1lLmx1bXBDdXJyZW50VHlwZSA9PSAxKQogICAgICAgICAgc3RyICs9IGxvYygKICAgICAgICAgICAgIlRoaXMgc3VnYXIgbHVtcCBncmV3IHRvIGJlIDxiPmJpZnVyY2F0ZWQ8L2I+OyBoYXJ2ZXN0aW5nIGl0IGhhcyBhIDUwJSBjaGFuY2Ugb2YgeWllbGRpbmcgdHdvIGx1bXBzLiIKICAgICAgICAgICk7CiAgICAgICAgZWxzZSBpZiAoR2FtZS5sdW1wQ3VycmVudFR5cGUgPT0gMikKICAgICAgICAgIHN0ciArPSBsb2MoCiAgICAgICAgICAgICJUaGlzIHN1Z2FyIGx1bXAgZ3JldyB0byBiZSA8Yj5nb2xkZW48L2I+OyBoYXJ2ZXN0aW5nIGl0IHdpbGwgeWllbGQgMiB0byA3IGx1bXBzLCB5b3VyIGN1cnJlbnQgY29va2llcyB3aWxsIGJlIGRvdWJsZWQgKGNhcHBlZCB0byBhIGdhaW4gb2YgMjQgaG91cnMgb2YgeW91ciBDcFMpLCBhbmQgeW91IHdpbGwgZmluZCAxMCUgbW9yZSBnb2xkZW4gY29va2llcyBmb3IgdGhlIG5leHQgMjQgaG91cnMuIgogICAgICAgICAgKTsKICAgICAgICBlbHNlIGlmIChHYW1lLmx1bXBDdXJyZW50VHlwZSA9PSAzKQogICAgICAgICAgc3RyICs9IGxvYygKICAgICAgICAgICAgIlRoaXMgc3VnYXIgbHVtcCB3YXMgYWZmZWN0ZWQgYnkgdGhlIGVsZGVycyBhbmQgZ3JldyB0byBiZSA8Yj5tZWF0eTwvYj47IGhhcnZlc3RpbmcgaXQgd2lsbCB5aWVsZCBiZXR3ZWVuIDAgYW5kIDIgbHVtcHMuIgogICAgICAgICAgKTsKICAgICAgICBlbHNlIGlmIChHYW1lLmx1bXBDdXJyZW50VHlwZSA9PSA0KQogICAgICAgICAgc3RyICs9IGxvYygKICAgICAgICAgICAgIlRoaXMgc3VnYXIgbHVtcCBpcyA8Yj5jYXJhbWVsaXplZDwvYj4sIGl0cyBzdGlja2luZXNzIGJpbmRpbmcgaXQgdG8gdW5leHBlY3RlZCB0aGluZ3M7IGhhcnZlc3RpbmcgaXQgd2lsbCB5aWVsZCBiZXR3ZWVuIDEgYW5kIDMgbHVtcHMgYW5kIHdpbGwgcmVmaWxsIHlvdXIgc3VnYXIgbHVtcCBjb29sZG93bnMuIgogICAgICAgICAgKTsKICAgICAgfQoKICAgICAgc3RyICs9ICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nOwogICAgICBzdHIgKz0gbG9jKAogICAgICAgICJZb3VyIHN1Z2FyIGx1bXBzIG1hdHVyZSBhZnRlciA8Yj4lMTwvYj4sPGJyPnJpcGVuIGFmdGVyIDxiPiUyPC9iPiw8YnI+YW5kIGZhbGwgYWZ0ZXIgPGI+JTM8L2I+LiIsCiAgICAgICAgWwogICAgICAgICAgR2FtZS5zYXlUaW1lKChHYW1lLmx1bXBNYXR1cmVBZ2UgLyAxMDAwKSAqIEdhbWUuZnBzLCAtMSksCiAgICAgICAgICBHYW1lLnNheVRpbWUoKEdhbWUubHVtcFJpcGVBZ2UgLyAxMDAwKSAqIEdhbWUuZnBzLCAtMSksCiAgICAgICAgICBHYW1lLnNheVRpbWUoKEdhbWUubHVtcE92ZXJyaXBlQWdlIC8gMTAwMCkgKiBHYW1lLmZwcywgLTEpLAogICAgICAgIF0KICAgICAgKTsKCiAgICAgIHN0ciArPQogICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICBsb2MoCiAgICAgICAgICAiJmJ1bGw7IFN1Z2FyIGx1bXBzIGNhbiBiZSBoYXJ2ZXN0ZWQgd2hlbiBtYXR1cmUsIHRob3VnaCBpZiBsZWZ0IGFsb25lIGJleW9uZCB0aGF0IHBvaW50IHRoZXkgd2lsbCBzdGFydCByaXBlbmluZyAoaW5jcmVhc2luZyB0aGUgY2hhbmNlIG9mIGhhcnZlc3RpbmcgdGhlbSkgYW5kIHdpbGwgZXZlbnR1YWxseSBmYWxsIGFuZCBiZSBhdXRvLWhhcnZlc3RlZCBhZnRlciBzb21lIHRpbWUuPGJyPiZidWxsOyBTdWdhciBsdW1wcyBhcmUgZGVsaWNpb3VzIGFuZCBtYXkgYmUgdXNlZCBhcyBjdXJyZW5jeSBmb3IgYWxsIHNvcnRzIG9mIHRoaW5ncy48YnI+JmJ1bGw7IE9uY2UgYSBzdWdhciBsdW1wIGlzIGhhcnZlc3RlZCwgYW5vdGhlciBvbmUgd2lsbCBzdGFydCBncm93aW5nIGluIGl0cyBwbGFjZS48YnI+JmJ1bGw7IE5vdGUgdGhhdCBzdWdhciBsdW1wcyBrZWVwIGdyb3dpbmcgd2hlbiB0aGUgZ2FtZSBpcyBjbG9zZWQuIgogICAgICAgICkgKwogICAgICAgICI8L2Rpdj4iOwogICAgICByZXR1cm4gc3RyOwogICAgfTsKICAgIEdhbWUuY29tcHV0ZUx1bXBUaW1lcyA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGhvdXIgPSAxMDAwICogNjAgKiA2MDsKICAgICAgR2FtZS5sdW1wTWF0dXJlQWdlID0gaG91ciAqIDIwOwogICAgICBHYW1lLmx1bXBSaXBlQWdlID0gaG91ciAqIDIzOwogICAgICBpZiAoR2FtZS5IYXMoIlN0ZXZpYSBDYWVsZXN0aXMiKSkgR2FtZS5sdW1wUmlwZUFnZSAtPSBob3VyOwogICAgICBpZiAoR2FtZS5IYXMoIkRpYWJldGljYSBEYWVtb25pY3VzIikpIEdhbWUubHVtcE1hdHVyZUFnZSAtPSBob3VyOwogICAgICBpZiAoR2FtZS5IYXMoIkljaG9yIHN5cnVwIikpIEdhbWUubHVtcE1hdHVyZUFnZSAtPSAxMDAwICogNjAgKiA3OwogICAgICBpZiAoR2FtZS5IYXMoIlN1Z2FyIGFnaW5nIHByb2Nlc3MiKSkKICAgICAgICBHYW1lLmx1bXBSaXBlQWdlIC09CiAgICAgICAgICA2MDAwICogTWF0aC5taW4oNjAwLCBHYW1lLk9iamVjdHNbIkdyYW5kbWEiXS5hbW91bnQpOyAvL2NhcHBlZCBhdCA2MDAgZ3JhbmRtYXMKICAgICAgaWYgKEdhbWUuaGFzR29kICYmIEdhbWUuQnVpbGRpbmdzT3duZWQgJSAxMCA9PSAwKSB7CiAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJvcmRlciIpOwogICAgICAgIGlmIChnb2RMdmwgPT0gMSkgR2FtZS5sdW1wUmlwZUFnZSAtPSBob3VyOwogICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAyKSBHYW1lLmx1bXBSaXBlQWdlIC09IChob3VyIC8gMykgKiAyOwogICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAzKSBHYW1lLmx1bXBSaXBlQWdlIC09IGhvdXIgLyAzOwogICAgICB9CiAgICAgIC8vaWYgKEdhbWUuaGFzQXVyYSgnRHJhZ29uXCdzIEN1cnZlJykpIHtHYW1lLmx1bXBNYXR1cmVBZ2UvPTEuMDU7R2FtZS5sdW1wUmlwZUFnZS89MS4wNTt9CiAgICAgIEdhbWUubHVtcE1hdHVyZUFnZSAvPSAxICsgR2FtZS5hdXJhTXVsdCgiRHJhZ29uJ3MgQ3VydmUiKSAqIDAuMDU7CiAgICAgIEdhbWUubHVtcFJpcGVBZ2UgLz0gMSArIEdhbWUuYXVyYU11bHQoIkRyYWdvbidzIEN1cnZlIikgKiAwLjA1OwogICAgICBHYW1lLmx1bXBPdmVycmlwZUFnZSA9IEdhbWUubHVtcFJpcGVBZ2UgKyBob3VyOwogICAgICBpZiAoR2FtZS5IYXMoIkdsdWNvc2UtY2hhcmdlZCBhaXIiKSkgewogICAgICAgIEdhbWUubHVtcE1hdHVyZUFnZSAvPSAyMDAwOwogICAgICAgIEdhbWUubHVtcFJpcGVBZ2UgLz0gMjAwMDsKICAgICAgICBHYW1lLmx1bXBPdmVycmlwZUFnZSAvPSAyMDAwOwogICAgICB9CiAgICB9OwogICAgR2FtZS5sb2FkTHVtcHMgPSBmdW5jdGlvbiAodGltZSkgewogICAgICBHYW1lLmNvbXB1dGVMdW1wVGltZXMoKTsKICAgICAgLy9HYW1lLmNvbXB1dGVMdW1wVHlwZSgpOwogICAgICBpZiAoIUdhbWUuY2FuTHVtcHMoKSkgR2FtZS5yZW1vdmVDbGFzcygibHVtcHNPbiIpOwogICAgICBlbHNlIHsKICAgICAgICBpZiAoR2FtZS5hc2NlbnNpb25Nb2RlICE9IDEpIEdhbWUuYWRkQ2xhc3MoImx1bXBzT24iKTsKICAgICAgICBHYW1lLmx1bXBUID0gTWF0aC5taW4oRGF0ZS5ub3coKSwgR2FtZS5sdW1wVCk7CiAgICAgICAgdmFyIGFnZSA9IE1hdGgubWF4KERhdGUubm93KCkgLSBHYW1lLmx1bXBULCAwKTsKICAgICAgICB2YXIgYW1vdW50ID0gTWF0aC5mbG9vcihhZ2UgLyBHYW1lLmx1bXBPdmVycmlwZUFnZSk7IC8vaG93IG1hbnkgbHVtcHMgZGlkIHdlIGhhcnZlc3Qgc2luY2Ugd2UgY2xvc2VkIHRoZSBnYW1lPwogICAgICAgIGlmIChhbW91bnQgPj0gMSkgewogICAgICAgICAgR2FtZS5oYXJ2ZXN0THVtcHMoMSwgdHJ1ZSk7CiAgICAgICAgICBHYW1lLmx1bXBDdXJyZW50VHlwZSA9IDA7IC8vYWxsIG9mZmxpbmUgbHVtcHMgYWZ0ZXIgdGhlIGZpcnN0IG9uZSBoYXZlIGEgbm9ybWFsIHR5cGUKICAgICAgICAgIGlmIChhbW91bnQgPiAxKSBHYW1lLmhhcnZlc3RMdW1wcyhhbW91bnQgLSAxLCB0cnVlKTsKICAgICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgICAiIiwKICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICJZb3UgaGFydmVzdGVkIDxiPiUxPC9iPiB3aGlsZSB5b3Ugd2VyZSBhd2F5LiIsCiAgICAgICAgICAgICAgbG9jKCIlMSBzdWdhciBsdW1wIiwgTEJlYXV0aWZ5KGFtb3VudCkpCiAgICAgICAgICAgICksCiAgICAgICAgICAgIFsyOSwgMTRdCiAgICAgICAgICApOwogICAgICAgICAgR2FtZS5sdW1wVCA9IERhdGUubm93KCkgLSAoYWdlIC0gYW1vdW50ICogR2FtZS5sdW1wT3ZlcnJpcGVBZ2UpOwogICAgICAgICAgR2FtZS5jb21wdXRlTHVtcFR5cGUoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgICBHYW1lLmdhaW5MdW1wcyA9IGZ1bmN0aW9uICh0b3RhbCkgewogICAgICBpZiAoR2FtZS5sdW1wc1RvdGFsID09IC0xKSB7CiAgICAgICAgR2FtZS5sdW1wc1RvdGFsID0gMDsKICAgICAgICBHYW1lLmx1bXBzID0gMDsKICAgICAgfQogICAgICBHYW1lLmx1bXBzICs9IHRvdGFsOwogICAgICBHYW1lLmx1bXBzVG90YWwgKz0gdG90YWw7CgogICAgICBpZiAoR2FtZS5sdW1wc1RvdGFsID49IDcpIEdhbWUuV2luKCJEdWRlLCBzd2VldCIpOwogICAgICBpZiAoR2FtZS5sdW1wc1RvdGFsID49IDMwKSBHYW1lLldpbigiU3VnYXIgcnVzaCIpOwogICAgICBpZiAoR2FtZS5sdW1wc1RvdGFsID49IDM2NSkgR2FtZS5XaW4oIlllYXIncyB3b3J0aCBvZiBjYXZpdGllcyIpOwogICAgfTsKICAgIEdhbWUuY2xpY2tMdW1wID0gZnVuY3Rpb24gKCkgewogICAgICB0cmlnZ2VyQW5pbShsKCJsdW1wc0ljb24iKSwgInB1Y2tlciIpOwogICAgICB0cmlnZ2VyQW5pbShsKCJsdW1wc0ljb24yIiksICJwdWNrZXIiKTsKICAgICAgaWYgKCFHYW1lLmNhbkx1bXBzKCkpIHJldHVybjsKICAgICAgdmFyIGFnZSA9IERhdGUubm93KCkgLSBHYW1lLmx1bXBUOwogICAgICBpZiAoYWdlIDwgR2FtZS5sdW1wTWF0dXJlQWdlKSB7CiAgICAgIH0gZWxzZSBpZiAoYWdlIDwgR2FtZS5sdW1wUmlwZUFnZSkgewogICAgICAgIHZhciBhbW91bnQgPSBjaG9vc2UoWzAsIDFdKTsKICAgICAgICBpZiAoYW1vdW50ICE9IDApIEdhbWUuV2luKCJIYW5kLXBpY2tlZCIpOwogICAgICAgIEdhbWUuaGFydmVzdEx1bXBzKGFtb3VudCk7CiAgICAgICAgR2FtZS5jb21wdXRlTHVtcFR5cGUoKTsKICAgICAgfSBlbHNlIGlmIChhZ2UgPCBHYW1lLmx1bXBPdmVycmlwZUFnZSkgewogICAgICAgIEdhbWUuaGFydmVzdEx1bXBzKDEpOwogICAgICAgIEdhbWUuY29tcHV0ZUx1bXBUeXBlKCk7CiAgICAgIH0KICAgIH07CiAgICBHYW1lLmhhcnZlc3RMdW1wcyA9IGZ1bmN0aW9uIChhbW91bnQsIHNpbGVudCkgewogICAgICBpZiAoIUdhbWUuY2FuTHVtcHMoKSkgcmV0dXJuOwogICAgICBHYW1lLmx1bXBUID0gRGF0ZS5ub3coKTsKICAgICAgdmFyIHRvdGFsID0gYW1vdW50OwogICAgICBpZiAoCiAgICAgICAgR2FtZS5sdW1wQ3VycmVudFR5cGUgPT0gMSAmJgogICAgICAgIEdhbWUuSGFzKCJTdWNyYWxvc2lhIEludXRpbGlzIikgJiYKICAgICAgICBNYXRoLnJhbmRvbSgpIDwgMC4wNQogICAgICApCiAgICAgICAgdG90YWwgKj0gMjsKICAgICAgZWxzZSBpZiAoR2FtZS5sdW1wQ3VycmVudFR5cGUgPT0gMSkgdG90YWwgKj0gY2hvb3NlKFsxLCAyXSk7CiAgICAgIGVsc2UgaWYgKEdhbWUubHVtcEN1cnJlbnRUeXBlID09IDIpIHsKICAgICAgICB0b3RhbCAqPSBjaG9vc2UoWzIsIDMsIDQsIDUsIDYsIDddKTsKICAgICAgICBHYW1lLmdhaW5CdWZmKCJzdWdhciBibGVzc2luZyIsIDI0ICogNjAgKiA2MCwgMSk7CiAgICAgICAgR2FtZS5FYXJuKE1hdGgubWluKEdhbWUuY29va2llc1BzICogNjAgKiA2MCAqIDI0LCBHYW1lLmNvb2tpZXMpKTsKICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgIGxvYygiU3VnYXIgYmxlc3NpbmcgYWN0aXZhdGVkISIpLAogICAgICAgICAgbG9jKAogICAgICAgICAgICAiWW91ciBjb29raWVzIGhhdmUgYmVlbiBkb3VibGVkLjxicj4rMTAlIGdvbGRlbiBjb29raWVzIGZvciB0aGUgbmV4dCAyNCBob3Vycy4iCiAgICAgICAgICApLAogICAgICAgICAgWzI5LCAxNl0KICAgICAgICApOwogICAgICB9IGVsc2UgaWYgKEdhbWUubHVtcEN1cnJlbnRUeXBlID09IDMpIHRvdGFsICo9IGNob29zZShbMCwgMCwgMSwgMiwgMl0pOwogICAgICBlbHNlIGlmIChHYW1lLmx1bXBDdXJyZW50VHlwZSA9PSA0KSB7CiAgICAgICAgdG90YWwgKj0gY2hvb3NlKFsxLCAyLCAzXSk7CiAgICAgICAgR2FtZS5sdW1wUmVmaWxsID0gMDsgLy9EYXRlLm5vdygpLUdhbWUuZ2V0THVtcFJlZmlsbE1heCgpOwogICAgICAgIEdhbWUuTm90aWZ5KGxvYygiU3VnYXIgbHVtcCBjb29sZG93bnMgY2xlYXJlZCEiKSwgIiIsIFsyOSwgMjddKTsKICAgICAgfQogICAgICB0b3RhbCA9IE1hdGguZmxvb3IodG90YWwpOwogICAgICBHYW1lLmdhaW5MdW1wcyh0b3RhbCk7CiAgICAgIGlmIChHYW1lLmx1bXBDdXJyZW50VHlwZSA9PSAxKSBHYW1lLldpbigiU3VnYXIgc3VnYXIiKTsKICAgICAgZWxzZSBpZiAoR2FtZS5sdW1wQ3VycmVudFR5cGUgPT0gMikgR2FtZS5XaW4oIkFsbC1uYXR1cmFsIGNhbmUgc3VnYXIiKTsKICAgICAgZWxzZSBpZiAoR2FtZS5sdW1wQ3VycmVudFR5cGUgPT0gMykgR2FtZS5XaW4oIlN3ZWV0bWVhdHMiKTsKICAgICAgZWxzZSBpZiAoR2FtZS5sdW1wQ3VycmVudFR5cGUgPT0gNCkgR2FtZS5XaW4oIk1haWxsYXJkIHJlYWN0aW9uIik7CgogICAgICBpZiAoIXNpbGVudCkgewogICAgICAgIHZhciByZWN0ID0gbCgibHVtcHNJY29uMiIpLmdldEJvdW5kcygpOwogICAgICAgIEdhbWUuU3BhcmtsZUF0KAogICAgICAgICAgKHJlY3QubGVmdCArIHJlY3QucmlnaHQpIC8gMiwKICAgICAgICAgIChyZWN0LnRvcCArIHJlY3QuYm90dG9tKSAvIDIgLSAyNCArIDMyIC0gVG9wQmFyT2Zmc2V0CiAgICAgICAgKTsKICAgICAgICBpZiAodG90YWwgPiAwKQogICAgICAgICAgR2FtZS5Qb3B1cCgKICAgICAgICAgICAgIjxzbWFsbD4rIiArIGxvYygiJTEgc3VnYXIgbHVtcCIsIExCZWF1dGlmeSh0b3RhbCkpICsgIjwvc21hbGw+IiwKICAgICAgICAgICAgKHJlY3QubGVmdCArIHJlY3QucmlnaHQpIC8gMiwKICAgICAgICAgICAgKHJlY3QudG9wICsgcmVjdC5ib3R0b20pIC8gMiAtIDQ4CiAgICAgICAgICApOwogICAgICAgIGVsc2UKICAgICAgICAgIEdhbWUuUG9wdXAoCiAgICAgICAgICAgICI8c21hbGw+IiArIGxvYygiQm90Y2hlZCBoYXJ2ZXN0ISIpICsgIjwvc21hbGw+IiwKICAgICAgICAgICAgKHJlY3QubGVmdCArIHJlY3QucmlnaHQpIC8gMiwKICAgICAgICAgICAgKHJlY3QudG9wICsgcmVjdC5ib3R0b20pIC8gMiAtIDQ4CiAgICAgICAgICApOwogICAgICAgIFBsYXlTb3VuZCgic25kL3BvcCIgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAzICsgMSkgKyAiLm1wMyIsIDAuNzUpOwogICAgICB9CiAgICAgIEdhbWUuY29tcHV0ZUx1bXBUaW1lcygpOwogICAgfTsKICAgIEdhbWUuY29tcHV0ZUx1bXBUeXBlID0gZnVuY3Rpb24gKCkgewogICAgICBNYXRoLnNlZWRyYW5kb20oR2FtZS5zZWVkICsgIi8iICsgR2FtZS5sdW1wVCk7CiAgICAgIHZhciB0eXBlcyA9IFswXTsKICAgICAgdmFyIGxvb3AgPSAxOwogICAgICAvL2lmIChHYW1lLmhhc0F1cmEoJ0RyYWdvblwncyBDdXJ2ZScpKSBsb29wPTI7CiAgICAgIGxvb3AgKz0gR2FtZS5hdXJhTXVsdCgiRHJhZ29uJ3MgQ3VydmUiKTsKICAgICAgbG9vcCA9IHJhbmRvbUZsb29yKGxvb3ApOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxvb3A7IGkrKykgewogICAgICAgIGlmIChNYXRoLnJhbmRvbSgpIDwgKEdhbWUuSGFzKCJTdWNyYWxvc2lhIEludXRpbGlzIikgPyAwLjE1IDogMC4xKSkKICAgICAgICAgIHR5cGVzLnB1c2goMSk7IC8vYmlmdXJjYXRlZAogICAgICAgIGlmIChNYXRoLnJhbmRvbSgpIDwgMyAvIDEwMDApIHR5cGVzLnB1c2goMik7IC8vZ29sZGVuCiAgICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPCAwLjEgKiBHYW1lLmVsZGVyV3JhdGgpIHR5cGVzLnB1c2goMyk7IC8vbWVhdHkKICAgICAgICBpZiAoTWF0aC5yYW5kb20oKSA8IDEgLyA1MCkgdHlwZXMucHVzaCg0KTsgLy9jYXJhbWVsaXplZAogICAgICB9CiAgICAgIEdhbWUubHVtcEN1cnJlbnRUeXBlID0gY2hvb3NlKHR5cGVzKTsKICAgICAgTWF0aC5zZWVkcmFuZG9tKCk7CiAgICB9OwoKICAgIEdhbWUuY2FuTHVtcHMgPSBmdW5jdGlvbiAoKSAvL2dyYW1tYXRpY2FsbHkgcGxlYXNpbmcgZnVuY3Rpb24gbmFtZQogICAgewogICAgICBpZiAoCiAgICAgICAgR2FtZS5sdW1wc1RvdGFsID4gLTEgfHwKICAgICAgICAoR2FtZS5hc2NlbnNpb25Nb2RlICE9IDEgJiYKICAgICAgICAgIEdhbWUuY29va2llc0Vhcm5lZCArIEdhbWUuY29va2llc1Jlc2V0ID49IDEwMDAwMDAwMDApCiAgICAgICkKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfTsKCiAgICBHYW1lLmdldEx1bXBSZWZpbGxNYXggPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBHYW1lLmZwcyAqIDYwICogMTU7IC8vMTAwMCo2MCoxNTsvLzE1IG1pbnV0ZXMKICAgIH07CiAgICBHYW1lLmdldEx1bXBSZWZpbGxSZW1haW5pbmcgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBHYW1lLmx1bXBSZWZpbGw7IC8vR2FtZS5nZXRMdW1wUmVmaWxsTWF4KCktKERhdGUubm93KCktR2FtZS5sdW1wUmVmaWxsKTsKICAgIH07CiAgICBHYW1lLmNhblJlZmlsbEx1bXAgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBHYW1lLmx1bXBSZWZpbGwgPD0gMDsgLy8oKERhdGUubm93KCktR2FtZS5sdW1wUmVmaWxsKT49R2FtZS5nZXRMdW1wUmVmaWxsTWF4KCkpOwogICAgfTsKICAgIEdhbWUucmVmaWxsTHVtcCA9IGZ1bmN0aW9uIChuLCBmdW5jKSB7CiAgICAgIGlmIChHYW1lLmx1bXBzID49IG4gJiYgR2FtZS5jYW5SZWZpbGxMdW1wKCkpIHsKICAgICAgICBHYW1lLnNwZW5kTHVtcChuLCAicmVmaWxsIiwgZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKCFHYW1lLnNlc2FtZSkgR2FtZS5sdW1wUmVmaWxsID0gR2FtZS5nZXRMdW1wUmVmaWxsTWF4KCk7IC8vRGF0ZS5ub3coKTsKICAgICAgICAgIGZ1bmMoKTsKICAgICAgICB9KSgpOwogICAgICB9CiAgICB9OwogICAgR2FtZS5zcGVuZEx1bXAgPSBmdW5jdGlvbiAobiwgc3RyLCBmdW5jLCBmcmVlKSB7CiAgICAgIC8vYXNrIGlmIHdlIHdhbnQgdG8gc3BlbmQgTiBsdW1wcyAodW5sZXNzIGZyZWUpCiAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKCFmcmVlICYmIEdhbWUubHVtcHMgPCBuKSByZXR1cm4gZmFsc2U7CiAgICAgICAgaWYgKCFmcmVlICYmIEdhbWUucHJlZnMuYXNrTHVtcHMpIHsKICAgICAgICAgIFBsYXlTb3VuZCgic25kL3RpY2subXAzIik7CiAgICAgICAgICBHYW1lLnByb21wdENvbmZpcm1GdW5jID0gZnVuYzsgLy9iaXQgZHVtYgogICAgICAgICAgR2FtZS5Qcm9tcHQoCiAgICAgICAgICAgICc8aWQgU3BlbmRMdW1wPjxkaXYgY2xhc3M9Imljb24iIHN0eWxlPSJiYWNrZ3JvdW5kOnVybChpbWcvaWNvbnMucG5nP3Y9JyArCiAgICAgICAgICAgICAgR2FtZS52ZXJzaW9uICsKICAgICAgICAgICAgICAiKTtmbG9hdDpsZWZ0O21hcmdpbi1sZWZ0Oi04cHg7bWFyZ2luLXRvcDotOHB4O2JhY2tncm91bmQtcG9zaXRpb246IiArCiAgICAgICAgICAgICAgLTI5ICogNDggKwogICAgICAgICAgICAgICJweCAiICsKICAgICAgICAgICAgICAtMTQgKiA0OCArCiAgICAgICAgICAgICAgJ3B4OyI+PC9kaXY+PGRpdiBzdHlsZT0ibWFyZ2luOjE2cHggOHB4OyI+JyArCiAgICAgICAgICAgICAgbG9jKCJEbyB5b3Ugd2FudCB0byBzcGVuZCAlMSB0byAlMj8iLCBbCiAgICAgICAgICAgICAgICAiPGI+IiArIGxvYygiJTEgc3VnYXIgbHVtcCIsIExCZWF1dGlmeShuKSkgKyAiPC9iPiIsCiAgICAgICAgICAgICAgICBzdHIsCiAgICAgICAgICAgICAgXSkgKwogICAgICAgICAgICAgICI8L2Rpdj4iLAogICAgICAgICAgICBbCiAgICAgICAgICAgICAgWwogICAgICAgICAgICAgICAgbG9jKCJZZXMiKSwKICAgICAgICAgICAgICAgICJHYW1lLmx1bXBzLT0iICsKICAgICAgICAgICAgICAgICAgbiArCiAgICAgICAgICAgICAgICAgICI7R2FtZS5wcm9tcHRDb25maXJtRnVuYygpO0dhbWUucHJvbXB0Q29uZmlybUZ1bmM9MDtHYW1lLnJlY2FsY3VsYXRlR2FpbnM9MTtHYW1lLkNsb3NlUHJvbXB0KCk7IiwKICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgIGxvYygiTm8iKSwKICAgICAgICAgICAgXQogICAgICAgICAgKTsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKCFmcmVlKSBHYW1lLmx1bXBzIC09IG47CiAgICAgICAgICBmdW5jKCk7CiAgICAgICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICAgIH0KICAgICAgfTsKICAgIH07CgogICAgR2FtZS5kb0x1bXBzID0gZnVuY3Rpb24gKCkgewogICAgICBpZiAoR2FtZS5sdW1wUmVmaWxsID4gMCkgR2FtZS5sdW1wUmVmaWxsLS07CgogICAgICBpZiAoIUdhbWUuY2FuTHVtcHMoKSkgewogICAgICAgIEdhbWUucmVtb3ZlQ2xhc3MoImx1bXBzT24iKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKEdhbWUubHVtcHNUb3RhbCA9PSAtMSkgewogICAgICAgIC8vZmlyc3QgdGltZSAhCiAgICAgICAgaWYgKEdhbWUuYXNjZW5zaW9uTW9kZSAhPSAxKSBHYW1lLmFkZENsYXNzKCJsdW1wc09uIik7CiAgICAgICAgR2FtZS5sdW1wVCA9IERhdGUubm93KCk7CiAgICAgICAgR2FtZS5sdW1wc1RvdGFsID0gMDsKICAgICAgICBHYW1lLmx1bXBzID0gMDsKICAgICAgICBHYW1lLmNvbXB1dGVMdW1wVHlwZSgpOwoKICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgIGxvYygiU3VnYXIgbHVtcHMhIiksCiAgICAgICAgICBsb2MoCiAgICAgICAgICAgICJCZWNhdXNlIHlvdSd2ZSBiYWtlZCBhIDxiPmJpbGxpb24gY29va2llczwvYj4gaW4gdG90YWwsIHlvdSBhcmUgbm93IGF0dHJhY3RpbmcgPGI+c3VnYXIgbHVtcHM8L2I+LiBUaGV5IGNvYWxlc2NlIHF1aWV0bHkgbmVhciB0aGUgdG9wIG9mIHlvdXIgc2NyZWVuLCB1bmRlciB0aGUgU3RhdHMgYnV0dG9uLjxicj5Zb3Ugd2lsbCBiZSBhYmxlIHRvIGhhcnZlc3QgdGhlbSB3aGVuIHRoZXkncmUgcmlwZSwgYWZ0ZXIgd2hpY2ggeW91IG1heSBzcGVuZCB0aGVtIG9uIGFsbCBzb3J0cyBvZiB0aGluZ3MhIgogICAgICAgICAgKSwKICAgICAgICAgIFsyMywgMTRdCiAgICAgICAgKTsKICAgICAgfQogICAgICB2YXIgYWdlID0gRGF0ZS5ub3coKSAtIEdhbWUubHVtcFQ7CiAgICAgIGlmIChhZ2UgPiBHYW1lLmx1bXBPdmVycmlwZUFnZSkgewogICAgICAgIGFnZSA9IDA7CiAgICAgICAgR2FtZS5oYXJ2ZXN0THVtcHMoMSk7CiAgICAgICAgR2FtZS5jb21wdXRlTHVtcFR5cGUoKTsKICAgICAgfQoKICAgICAgdmFyIHBoYXNlID0gTWF0aC5taW4oNiwgTWF0aC5mbG9vcigoYWdlIC8gR2FtZS5sdW1wT3ZlcnJpcGVBZ2UpICogNykpOwogICAgICB2YXIgcGhhc2UyID0gTWF0aC5taW4oCiAgICAgICAgNiwKICAgICAgICBNYXRoLmZsb29yKChhZ2UgLyBHYW1lLmx1bXBPdmVycmlwZUFnZSkgKiA3KSArIDEKICAgICAgKTsKICAgICAgdmFyIHJvdyA9IDE0OwogICAgICB2YXIgcm93MiA9IDE0OwogICAgICB2YXIgdHlwZSA9IEdhbWUubHVtcEN1cnJlbnRUeXBlOwogICAgICBpZiAodHlwZSA9PSAxKSB7CiAgICAgICAgLy9kb3VibGUKICAgICAgICAvL2lmIChwaGFzZT49Nikgcm93PTE1OwogICAgICAgIGlmIChwaGFzZTIgPj0gNikgcm93MiA9IDE1OwogICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gMikgewogICAgICAgIC8vZ29sZGVuCiAgICAgICAgaWYgKHBoYXNlID49IDQpIHJvdyA9IDE2OwogICAgICAgIGlmIChwaGFzZTIgPj0gNCkgcm93MiA9IDE2OwogICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gMykgewogICAgICAgIC8vbWVhdHkKICAgICAgICBpZiAocGhhc2UgPj0gNCkgcm93ID0gMTc7CiAgICAgICAgaWYgKHBoYXNlMiA+PSA0KSByb3cyID0gMTc7CiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSA0KSB7CiAgICAgICAgLy9jYXJhbWVsaXplZAogICAgICAgIGlmIChwaGFzZSA+PSA0KSByb3cgPSAyNzsKICAgICAgICBpZiAocGhhc2UyID49IDQpIHJvdzIgPSAyNzsKICAgICAgfQogICAgICB2YXIgaWNvbiA9IFsyMyArIE1hdGgubWluKHBoYXNlLCA1KSwgcm93XTsKICAgICAgdmFyIGljb24yID0gWzIzICsgcGhhc2UyLCByb3cyXTsKICAgICAgaWYgKGFnZSA8IDApIHsKICAgICAgICBpY29uID0gWzE3LCA1XTsKICAgICAgICBpY29uMiA9IFsxNywgNV07CiAgICAgIH0KICAgICAgdmFyIG9wYWNpdHkgPSBNYXRoLm1pbig2LCAoYWdlIC8gR2FtZS5sdW1wT3ZlcnJpcGVBZ2UpICogNykgJSAxOwogICAgICBpZiAocGhhc2UgPj0gNikgewogICAgICAgIG9wYWNpdHkgPSAxOwogICAgICB9CiAgICAgIGwoImx1bXBzSWNvbiIpLnN0eWxlLmJhY2tncm91bmRQb3NpdGlvbiA9CiAgICAgICAgLWljb25bMF0gKiA0OCArICJweCAiICsgLWljb25bMV0gKiA0OCArICJweCI7CiAgICAgIGwoImx1bXBzSWNvbjIiKS5zdHlsZS5iYWNrZ3JvdW5kUG9zaXRpb24gPQogICAgICAgIC1pY29uMlswXSAqIDQ4ICsgInB4ICIgKyAtaWNvbjJbMV0gKiA0OCArICJweCI7CiAgICAgIGwoImx1bXBzSWNvbjIiKS5zdHlsZS5vcGFjaXR5ID0gb3BhY2l0eTsKICAgICAgbCgibHVtcHNBbW91bnQiKS50ZXh0Q29udGVudCA9IEJlYXV0aWZ5KEdhbWUubHVtcHMpOwogICAgfTsKCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCQlDT09LSUUgRUNPTk9NSUNTCgkJPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KICAgIEdhbWUuRWFybiA9IGZ1bmN0aW9uIChob3dtdWNoKSB7CiAgICAgIEdhbWUuY29va2llcyArPSBob3dtdWNoOwogICAgICBHYW1lLmNvb2tpZXNFYXJuZWQgKz0gaG93bXVjaDsKICAgIH07CiAgICBHYW1lLlNwZW5kID0gZnVuY3Rpb24gKGhvd211Y2gpIHsKICAgICAgR2FtZS5jb29raWVzIC09IGhvd211Y2g7CiAgICB9OwogICAgR2FtZS5EaXNzb2x2ZSA9IGZ1bmN0aW9uIChob3dtdWNoKSB7CiAgICAgIEdhbWUuY29va2llcyAtPSBob3dtdWNoOwogICAgICBHYW1lLmNvb2tpZXNFYXJuZWQgLT0gaG93bXVjaDsKICAgICAgR2FtZS5jb29raWVzID0gTWF0aC5tYXgoMCwgR2FtZS5jb29raWVzKTsKICAgICAgR2FtZS5jb29raWVzRWFybmVkID0gTWF0aC5tYXgoMCwgR2FtZS5jb29raWVzRWFybmVkKTsKICAgIH07CiAgICBHYW1lLm1vdXNlQ3BzID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgYWRkID0gMDsKICAgICAgaWYgKEdhbWUuSGFzKCJUaG91c2FuZCBmaW5nZXJzIikpIGFkZCArPSAwLjE7CiAgICAgIGlmIChHYW1lLkhhcygiTWlsbGlvbiBmaW5nZXJzIikpIGFkZCAqPSA1OwogICAgICBpZiAoR2FtZS5IYXMoIkJpbGxpb24gZmluZ2VycyIpKSBhZGQgKj0gMTA7CiAgICAgIGlmIChHYW1lLkhhcygiVHJpbGxpb24gZmluZ2VycyIpKSBhZGQgKj0gMjA7CiAgICAgIGlmIChHYW1lLkhhcygiUXVhZHJpbGxpb24gZmluZ2VycyIpKSBhZGQgKj0gMjA7CiAgICAgIGlmIChHYW1lLkhhcygiUXVpbnRpbGxpb24gZmluZ2VycyIpKSBhZGQgKj0gMjA7CiAgICAgIGlmIChHYW1lLkhhcygiU2V4dGlsbGlvbiBmaW5nZXJzIikpIGFkZCAqPSAyMDsKICAgICAgaWYgKEdhbWUuSGFzKCJTZXB0aWxsaW9uIGZpbmdlcnMiKSkgYWRkICo9IDIwOwogICAgICBpZiAoR2FtZS5IYXMoIk9jdGlsbGlvbiBmaW5nZXJzIikpIGFkZCAqPSAyMDsKICAgICAgaWYgKEdhbWUuSGFzKCJOb25pbGxpb24gZmluZ2VycyIpKSBhZGQgKj0gMjA7CiAgICAgIGlmIChHYW1lLkhhcygiRGVjaWxsaW9uIGZpbmdlcnMiKSkgYWRkICo9IDIwOwogICAgICBpZiAoR2FtZS5IYXMoIlVuc2hhY2tsZWQgY3Vyc29ycyIpKSBhZGQgKj0gMjU7CgogICAgICB2YXIgbnVtID0gMDsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICBudW0gKz0gR2FtZS5PYmplY3RzW2ldLmFtb3VudDsKICAgICAgfQogICAgICBudW0gLT0gR2FtZS5PYmplY3RzWyJDdXJzb3IiXS5hbW91bnQ7CiAgICAgIGFkZCA9IGFkZCAqIG51bTsKICAgICAgaWYgKEdhbWUuSGFzKCJQbGFzdGljIG1vdXNlIikpIGFkZCArPSBHYW1lLmNvb2tpZXNQcyAqIDAuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiSXJvbiBtb3VzZSIpKSBhZGQgKz0gR2FtZS5jb29raWVzUHMgKiAwLjAxOwogICAgICBpZiAoR2FtZS5IYXMoIlRpdGFuaXVtIG1vdXNlIikpIGFkZCArPSBHYW1lLmNvb2tpZXNQcyAqIDAuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiQWRhbWFudGl1bSBtb3VzZSIpKSBhZGQgKz0gR2FtZS5jb29raWVzUHMgKiAwLjAxOwogICAgICBpZiAoR2FtZS5IYXMoIlVub2J0YWluaXVtIG1vdXNlIikpIGFkZCArPSBHYW1lLmNvb2tpZXNQcyAqIDAuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiRWx1ZGl1bSBtb3VzZSIpKSBhZGQgKz0gR2FtZS5jb29raWVzUHMgKiAwLjAxOwogICAgICBpZiAoR2FtZS5IYXMoIldpc2hhbGxveSBtb3VzZSIpKSBhZGQgKz0gR2FtZS5jb29raWVzUHMgKiAwLjAxOwogICAgICBpZiAoR2FtZS5IYXMoIkZhbnRhc3RlZWwgbW91c2UiKSkgYWRkICs9IEdhbWUuY29va2llc1BzICogMC4wMTsKICAgICAgaWYgKEdhbWUuSGFzKCJOZXZlcmNyYWNrIG1vdXNlIikpIGFkZCArPSBHYW1lLmNvb2tpZXNQcyAqIDAuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiQXJteXRocmlsIG1vdXNlIikpIGFkZCArPSBHYW1lLmNvb2tpZXNQcyAqIDAuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiVGVjaG5vYnNpZGlhbiBtb3VzZSIpKSBhZGQgKz0gR2FtZS5jb29raWVzUHMgKiAwLjAxOwogICAgICBpZiAoR2FtZS5IYXMoIlBsYXNtYXJibGUgbW91c2UiKSkgYWRkICs9IEdhbWUuY29va2llc1BzICogMC4wMTsKICAgICAgaWYgKEdhbWUuSGFzKCJNaXJhY3VsaXRlIG1vdXNlIikpIGFkZCArPSBHYW1lLmNvb2tpZXNQcyAqIDAuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiQWV0aGVyaWNlIG1vdXNlIikpIGFkZCArPSBHYW1lLmNvb2tpZXNQcyAqIDAuMDE7CgogICAgICBpZiAoR2FtZS5IYXMoIkZvcnR1bmUgIzEwNCIpKSBhZGQgKz0gR2FtZS5jb29raWVzUHMgKiAwLjAxOwogICAgICB2YXIgbXVsdCA9IDE7CgogICAgICBpZiAoR2FtZS5IYXMoIlNhbnRhJ3MgaGVscGVycyIpKSBtdWx0ICo9IDEuMTsKICAgICAgaWYgKEdhbWUuSGFzKCJDb29raWUgZWdnIikpIG11bHQgKj0gMS4xOwogICAgICBpZiAoR2FtZS5IYXMoIkhhbG8gZ2xvdmVzIikpIG11bHQgKj0gMS4xOwogICAgICBpZiAoR2FtZS5IYXMoIkRyYWdvbiBjbGF3IikpIG11bHQgKj0gMS4wMzsKCiAgICAgIGlmIChHYW1lLkhhcygiQXVyYSBnbG92ZXMiKSkgewogICAgICAgIG11bHQgKj0KICAgICAgICAgIDEgKwogICAgICAgICAgMC4wNSAqCiAgICAgICAgICAgIE1hdGgubWluKAogICAgICAgICAgICAgIEdhbWUuT2JqZWN0c1siQ3Vyc29yIl0ubGV2ZWwsCiAgICAgICAgICAgICAgR2FtZS5IYXMoIkx1bWlub3VzIGdsb3ZlcyIpID8gMjAgOiAxMAogICAgICAgICAgICApOwogICAgICB9CgogICAgICBtdWx0ICo9IEdhbWUuZWZmKCJjbGljayIpOwoKICAgICAgaWYgKEdhbWUuaGFzR29kKSB7CiAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJsYWJvciIpOwogICAgICAgIGlmIChnb2RMdmwgPT0gMSkgbXVsdCAqPSAxLjE1OwogICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAyKSBtdWx0ICo9IDEuMTsKICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMykgbXVsdCAqPSAxLjA1OwogICAgICB9CgogICAgICBmb3IgKHZhciBpIGluIEdhbWUuYnVmZnMpIHsKICAgICAgICBpZiAodHlwZW9mIEdhbWUuYnVmZnNbaV0ubXVsdENsaWNrICE9ICJ1bmRlZmluZWQiKQogICAgICAgICAgbXVsdCAqPSBHYW1lLmJ1ZmZzW2ldLm11bHRDbGljazsKICAgICAgfQoKICAgICAgLy9pZiAoR2FtZS5oYXNBdXJhKCdEcmFnb24gQ3Vyc29yJykpIG11bHQqPTEuMDU7CiAgICAgIG11bHQgKj0gMSArIEdhbWUuYXVyYU11bHQoIkRyYWdvbiBDdXJzb3IiKSAqIDAuMDU7CgogICAgICB2YXIgb3V0ID0KICAgICAgICBtdWx0ICoKICAgICAgICBHYW1lLkNvbXB1dGVDcHMoCiAgICAgICAgICAxLAogICAgICAgICAgR2FtZS5IYXMoIlJlaW5mb3JjZWQgaW5kZXggZmluZ2VyIikgKwogICAgICAgICAgICBHYW1lLkhhcygiQ2FycGFsIHR1bm5lbCBwcmV2ZW50aW9uIGNyZWFtIikgKwogICAgICAgICAgICBHYW1lLkhhcygiQW1iaWRleHRyb3VzIiksCiAgICAgICAgICBhZGQKICAgICAgICApOwoKICAgICAgb3V0ID0gR2FtZS5ydW5Nb2RIb29rT25WYWx1ZSgiY29va2llc1BlckNsaWNrIiwgb3V0KTsKCiAgICAgIGlmIChHYW1lLmhhc0J1ZmYoIkN1cnNlZCBmaW5nZXIiKSkKICAgICAgICBvdXQgPSBHYW1lLmJ1ZmZzWyJDdXJzZWQgZmluZ2VyIl0ucG93ZXI7CiAgICAgIHJldHVybiBvdXQ7CiAgICB9OwogICAgR2FtZS5jb21wdXRlZE1vdXNlQ3BzID0gMTsKICAgIEdhbWUuZ2xvYmFsQ3BzTXVsdCA9IDE7CiAgICBHYW1lLnVuYnVmZmVkQ3BzID0gMDsKICAgIEdhbWUuYnVpbGRpbmdDcHMgPSAwOwogICAgR2FtZS5sYXN0Q2xpY2sgPSAwOwogICAgR2FtZS5DYW5DbGljayA9IDE7CiAgICBHYW1lLmF1dG9jbGlja2VyRGV0ZWN0ZWQgPSAwOwogICAgR2FtZS5CaWdDb29raWVTdGF0ZSA9IDA7IC8vMCA9IG5vcm1hbCwgMSA9IGNsaWNrZWQgKHNtYWxsKSwgMiA9IHJlbGVhc2VkL2hvdmVyZWQgKGJpZykKICAgIEdhbWUuQmlnQ29va2llU2l6ZSA9IDA7CiAgICBHYW1lLkJpZ0Nvb2tpZVNpemVEID0gMDsKICAgIEdhbWUuQmlnQ29va2llU2l6ZVQgPSAxOwogICAgR2FtZS5jb29raWVDbGlja1NvdW5kID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNykgKyAxOwogICAgR2FtZS5wbGF5Q29va2llQ2xpY2tTb3VuZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKEdhbWUucHJlZnMuY29va2llc291bmQpCiAgICAgICAgUGxheVNvdW5kKCJzbmQvY2xpY2tiIiArIEdhbWUuY29va2llQ2xpY2tTb3VuZCArICIubXAzIiwgMC41KTsKICAgICAgZWxzZSBQbGF5U291bmQoInNuZC9jbGljayIgKyBHYW1lLmNvb2tpZUNsaWNrU291bmQgKyAiLm1wMyIsIDAuNSk7CiAgICAgIEdhbWUuY29va2llQ2xpY2tTb3VuZCArPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA0KSArIDE7CiAgICAgIGlmIChHYW1lLmNvb2tpZUNsaWNrU291bmQgPiA3KSBHYW1lLmNvb2tpZUNsaWNrU291bmQgLT0gNzsKICAgIH07CiAgICBHYW1lLkNsaWNrQ29va2llID0gZnVuY3Rpb24gKGUsIGFtb3VudCkgewogICAgICB2YXIgbm93ID0gRGF0ZS5ub3coKTsKICAgICAgaWYgKGUpIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgaWYgKAogICAgICAgIEdhbWUuT25Bc2NlbmQgfHwKICAgICAgICBHYW1lLkFzY2VuZFRpbWVyID4gMCB8fAogICAgICAgIEdhbWUuVCA8IDMgfHwKICAgICAgICBub3cgLSBHYW1lLmxhc3RDbGljayA8IDEwMDAgLyAoKGUgPyBlLmRldGFpbCA6IDEpID09PSAwID8gMyA6IDUwKQogICAgICApIHsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAobm93IC0gR2FtZS5sYXN0Q2xpY2sgPCAxMDAwIC8gMTUpIHsKICAgICAgICAgIEdhbWUuYXV0b2NsaWNrZXJEZXRlY3RlZCArPSBHYW1lLmZwczsKICAgICAgICAgIGlmIChHYW1lLmF1dG9jbGlja2VyRGV0ZWN0ZWQgPj0gR2FtZS5mcHMgKiA1KQogICAgICAgICAgICBHYW1lLldpbigiVW5jYW5ueSBjbGlja2VyIik7CiAgICAgICAgfQogICAgICAgIEdhbWUubG9zZVNoaW1tZXJpbmdWZWlsKCJjbGljayIpOwogICAgICAgIHZhciBhbW91bnQgPSBhbW91bnQgPyBhbW91bnQgOiBHYW1lLmNvbXB1dGVkTW91c2VDcHM7CiAgICAgICAgR2FtZS5FYXJuKGFtb3VudCk7CiAgICAgICAgR2FtZS5oYW5kbWFkZUNvb2tpZXMgKz0gYW1vdW50OwogICAgICAgIGlmIChHYW1lLnByZWZzLnBhcnRpY2xlcykgewogICAgICAgICAgR2FtZS5wYXJ0aWNsZUFkZCgpOwogICAgICAgICAgR2FtZS5wYXJ0aWNsZUFkZCgKICAgICAgICAgICAgR2FtZS5tb3VzZVgsCiAgICAgICAgICAgIEdhbWUubW91c2VZLAogICAgICAgICAgICBNYXRoLnJhbmRvbSgpICogNCAtIDIsCiAgICAgICAgICAgIE1hdGgucmFuZG9tKCkgKiAtMiAtIDIsCiAgICAgICAgICAgIE1hdGgucmFuZG9tKCkgKiAwLjUgKyAwLjc1LAogICAgICAgICAgICAxLAogICAgICAgICAgICAyCiAgICAgICAgICApOwogICAgICAgIH0KICAgICAgICBpZiAoR2FtZS5wcmVmcy5udW1iZXJzKQogICAgICAgICAgR2FtZS5wYXJ0aWNsZUFkZCgKICAgICAgICAgICAgR2FtZS5tb3VzZVggKyBNYXRoLnJhbmRvbSgpICogOCAtIDQsCiAgICAgICAgICAgIEdhbWUubW91c2VZIC0gOCArIE1hdGgucmFuZG9tKCkgKiA4IC0gNCwKICAgICAgICAgICAgMCwKICAgICAgICAgICAgLTIsCiAgICAgICAgICAgIDEsCiAgICAgICAgICAgIDQsCiAgICAgICAgICAgIDIsCiAgICAgICAgICAgICIiLAogICAgICAgICAgICAiKyIgKyBCZWF1dGlmeShhbW91bnQsIDEpCiAgICAgICAgICApOwoKICAgICAgICBHYW1lLnJ1bk1vZEhvb2soImNsaWNrIik7CgogICAgICAgIEdhbWUucGxheUNvb2tpZUNsaWNrU291bmQoKTsKICAgICAgICBHYW1lLmNvb2tpZUNsaWNrcysrOwoKICAgICAgICBpZiAoR2FtZS5jbGlja3NUaGlzU2Vzc2lvbiA9PSAwKSBQbGF5Q3VlKCJwcmVwbGF5Iik7CiAgICAgICAgR2FtZS5jbGlja3NUaGlzU2Vzc2lvbisrOwogICAgICAgIEdhbWUubGFzdENsaWNrID0gbm93OwogICAgICB9CiAgICAgIEdhbWUuQ2xpY2sgPSAwOwogICAgfTsKICAgIEdhbWUubW91c2VYID0gMDsKICAgIEdhbWUubW91c2VZID0gMDsKICAgIEdhbWUubW91c2VYMiA9IDA7CiAgICBHYW1lLm1vdXNlWTIgPSAwOwogICAgR2FtZS5tb3VzZU1vdmVkID0gMDsKICAgIEdhbWUuR2V0TW91c2VDb29yZHMgPSBmdW5jdGlvbiAoZSkgewogICAgICB2YXIgcG9zeCA9IDA7CiAgICAgIHZhciBwb3N5ID0gMDsKICAgICAgaWYgKCFlKSB2YXIgZSA9IHdpbmRvdy5ldmVudDsKICAgICAgaWYgKGUucGFnZVggfHwgZS5wYWdlWSkgewogICAgICAgIHBvc3ggPSBlLnBhZ2VYOwogICAgICAgIHBvc3kgPSBlLnBhZ2VZOwogICAgICB9IGVsc2UgaWYgKGUuY2xpZW50WCB8fCBlLmNsaWVudFkpIHsKICAgICAgICBwb3N4ID0KICAgICAgICAgIGUuY2xpZW50WCArCiAgICAgICAgICBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQgKwogICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQ7CiAgICAgICAgcG9zeSA9CiAgICAgICAgICBlLmNsaWVudFkgKwogICAgICAgICAgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AgKwogICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDsKICAgICAgfQogICAgICB2YXIgeCA9IDA7CiAgICAgIHZhciB5ID0gVG9wQmFyT2Zmc2V0OwogICAgICAvKgoJCQl2YXIgZWw9bCgnc2VjdGlvbkxlZnQnKTsKCQkJd2hpbGUoZWwgJiYgIWlzTmFOKGVsLm9mZnNldExlZnQpICYmICFpc05hTihlbC5vZmZzZXRUb3ApKQoJCQl7CgkJCQl4Kz1lbC5vZmZzZXRMZWZ0LWVsLnNjcm9sbExlZnQ7CgkJCQl5Kz1lbC5vZmZzZXRUb3AtZWwuc2Nyb2xsVG9wOwoJCQkJZWw9ZWwub2Zmc2V0UGFyZW50OwoJCQl9Ki8KICAgICAgR2FtZS5tb3VzZVgyID0gR2FtZS5tb3VzZVg7CiAgICAgIEdhbWUubW91c2VZMiA9IEdhbWUubW91c2VZOwogICAgICBHYW1lLm1vdXNlWCA9IChwb3N4IC0geCkgLyBHYW1lLnNjYWxlOwogICAgICBHYW1lLm1vdXNlWSA9IChwb3N5IC0geSkgLyBHYW1lLnNjYWxlOwogICAgICBHYW1lLm1vdXNlTW92ZWQgPSAxOwogICAgICBHYW1lLmxhc3RBY3Rpdml0eSA9IEdhbWUudGltZTsKICAgIH07CiAgICB2YXIgYmlnQ29va2llID0gbCgiYmlnQ29va2llIik7CiAgICBpZiAoR2FtZS5wcmVmcy5zY3JlZW5yZWFkZXIpIHsKICAgICAgYmlnQ29va2llLmFyaWFMYWJlbGxlZGJ5ID0gImJpZ0Nvb2tpZUxhYmVsIjsKICAgICAgYmlnQ29va2llLmluc2VydEFkamFjZW50SFRNTCgKICAgICAgICAiYmVmb3JlZW5kIiwKICAgICAgICAnPGxhYmVsIGlkPSJiaWdDb29raWVMYWJlbCIgc3R5bGU9ImZvbnQtc2l6ZToxMDBweCAhaW1wb3J0YW50OyIgY2xhc3M9InNyT25seSI+JyArCiAgICAgICAgICBsb2MoIkJpZyBjbGlja2FibGUgY29va2llIikgKwogICAgICAgICAgIjwvbGFiZWw+IgogICAgICApOwogICAgICBiaWdDb29raWUudGFiSW5kZXggPSAxOwogICAgfQogICAgR2FtZS5DbGljayA9IDA7CiAgICBHYW1lLmxhc3RDbGlja2VkRWwgPSAwOwogICAgR2FtZS5jbGlja3NUaGlzU2Vzc2lvbiA9IDA7CiAgICBHYW1lLmNsaWNrRnJvbSA9IDA7CiAgICBHYW1lLlNjcm9sbCA9IDA7CiAgICBHYW1lLm1vdXNlRG93biA9IDA7CiAgICBpZiAoIUdhbWUudG91Y2hFdmVudHMpIHsKICAgICAgQWRkRXZlbnQoYmlnQ29va2llLCAiY2xpY2siLCBHYW1lLkNsaWNrQ29va2llKTsKICAgICAgQWRkRXZlbnQoYmlnQ29va2llLCAibW91c2Vkb3duIiwgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgR2FtZS5CaWdDb29raWVTdGF0ZSA9IDE7CiAgICAgICAgaWYgKEdhbWUucHJlZnMuY29va2llc291bmQpIHsKICAgICAgICAgIEdhbWUucGxheUNvb2tpZUNsaWNrU291bmQoKTsKICAgICAgICB9CiAgICAgICAgaWYgKGV2ZW50KSBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICB9KTsKICAgICAgQWRkRXZlbnQoYmlnQ29va2llLCAibW91c2V1cCIsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgIEdhbWUuQmlnQ29va2llU3RhdGUgPSAyOwogICAgICAgIGlmIChldmVudCkgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgfSk7CiAgICAgIEFkZEV2ZW50KGJpZ0Nvb2tpZSwgIm1vdXNlb3V0IiwgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgR2FtZS5CaWdDb29raWVTdGF0ZSA9IDA7CiAgICAgIH0pOwogICAgICBBZGRFdmVudChiaWdDb29raWUsICJtb3VzZW92ZXIiLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICBHYW1lLkJpZ0Nvb2tpZVN0YXRlID0gMjsKICAgICAgfSk7CiAgICAgIEFkZEV2ZW50KGRvY3VtZW50LCAibW91c2Vtb3ZlIiwgR2FtZS5HZXRNb3VzZUNvb3Jkcyk7CiAgICAgIEFkZEV2ZW50KGRvY3VtZW50LCAibW91c2Vkb3duIiwgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgR2FtZS5sYXN0QWN0aXZpdHkgPSBHYW1lLnRpbWU7CiAgICAgICAgR2FtZS5tb3VzZURvd24gPSAxOwogICAgICAgIEdhbWUuY2xpY2tGcm9tID0gZXZlbnQudGFyZ2V0OwogICAgICB9KTsKICAgICAgQWRkRXZlbnQoZG9jdW1lbnQsICJtb3VzZXVwIiwgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgR2FtZS5sYXN0QWN0aXZpdHkgPSBHYW1lLnRpbWU7CiAgICAgICAgR2FtZS5tb3VzZURvd24gPSAwOwogICAgICAgIEdhbWUuY2xpY2tGcm9tID0gMDsKICAgICAgfSk7CiAgICAgIEFkZEV2ZW50KGRvY3VtZW50LCAiY2xpY2siLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICBHYW1lLmxhc3RBY3Rpdml0eSA9IEdhbWUudGltZTsKICAgICAgICBHYW1lLkNsaWNrID0gMTsKICAgICAgICBHYW1lLmxhc3RDbGlja2VkRWwgPSBldmVudC50YXJnZXQ7CiAgICAgICAgR2FtZS5jbGlja0Zyb20gPSAwOwogICAgICB9KTsKICAgICAgR2FtZS5oYW5kbGVTY3JvbGwgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIGlmICghZSkgZSA9IGV2ZW50OwogICAgICAgIEdhbWUuU2Nyb2xsID0gZS5kZXRhaWwgPCAwIHx8IGUud2hlZWxEZWx0YSA+IDAgPyAxIDogLTE7CiAgICAgICAgR2FtZS5sYXN0QWN0aXZpdHkgPSBHYW1lLnRpbWU7CiAgICAgIH07CiAgICAgIEFkZEV2ZW50KGRvY3VtZW50LCAiRE9NTW91c2VTY3JvbGwiLCBHYW1lLmhhbmRsZVNjcm9sbCk7CiAgICAgIEFkZEV2ZW50KGRvY3VtZW50LCAibW91c2V3aGVlbCIsIEdhbWUuaGFuZGxlU2Nyb2xsKTsKICAgIH0gZWxzZSB7CiAgICAgIC8vdG91Y2ggZXZlbnRzCiAgICAgIEFkZEV2ZW50KGJpZ0Nvb2tpZSwgInRvdWNoZW5kIiwgR2FtZS5DbGlja0Nvb2tpZSk7CiAgICAgIEFkZEV2ZW50KGJpZ0Nvb2tpZSwgInRvdWNoc3RhcnQiLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICBHYW1lLkJpZ0Nvb2tpZVN0YXRlID0gMTsKICAgICAgICBpZiAoZXZlbnQpIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIH0pOwogICAgICBBZGRFdmVudChiaWdDb29raWUsICJ0b3VjaGVuZCIsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgIEdhbWUuQmlnQ29va2llU3RhdGUgPSAwOwogICAgICAgIGlmIChldmVudCkgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgfSk7CiAgICAgIC8vQWRkRXZlbnQoZG9jdW1lbnQsJ3RvdWNobW92ZScsR2FtZS5HZXRNb3VzZUNvb3Jkcyk7CiAgICAgIEFkZEV2ZW50KGRvY3VtZW50LCAibW91c2Vtb3ZlIiwgR2FtZS5HZXRNb3VzZUNvb3Jkcyk7CiAgICAgIEFkZEV2ZW50KGRvY3VtZW50LCAidG91Y2hzdGFydCIsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgIEdhbWUubGFzdEFjdGl2aXR5ID0gR2FtZS50aW1lOwogICAgICAgIEdhbWUubW91c2VEb3duID0gMTsKICAgICAgfSk7CiAgICAgIEFkZEV2ZW50KGRvY3VtZW50LCAidG91Y2hlbmQiLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICBHYW1lLmxhc3RBY3Rpdml0eSA9IEdhbWUudGltZTsKICAgICAgICBHYW1lLm1vdXNlRG93biA9IDA7CiAgICAgIH0pOwogICAgICBBZGRFdmVudChkb2N1bWVudCwgInRvdWNoZW5kIiwgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgR2FtZS5sYXN0QWN0aXZpdHkgPSBHYW1lLnRpbWU7CiAgICAgICAgR2FtZS5DbGljayA9IDE7CiAgICAgIH0pOwogICAgfQoKICAgIEdhbWUua2V5cyA9IFtdOwogICAgQWRkRXZlbnQod2luZG93LCAia2V5dXAiLCBmdW5jdGlvbiAoZSkgewogICAgICBHYW1lLmxhc3RBY3Rpdml0eSA9IEdhbWUudGltZTsKICAgICAgaWYgKGUua2V5Q29kZSA9PSAyNykgewogICAgICAgIGlmIChHYW1lLnByb21wdE9uICYmICFHYW1lLnByb21wdE5vQ2xvc2UpIHsKICAgICAgICAgIEdhbWUuQ2xvc2VQcm9tcHQoKTsKICAgICAgICAgIFBsYXlTb3VuZCgic25kL3RpY2tPZmYubXAzIik7CiAgICAgICAgfQogICAgICAgIGlmIChHYW1lLkFzY2VuZFRpbWVyID4gMCkgR2FtZS5Bc2NlbmRUaW1lciA9IEdhbWUuQXNjZW5kRHVyYXRpb247CiAgICAgIH0gLy9lc2MgY2xvc2VzIHByb21wdAogICAgICBpZiAoR2FtZS5wcm9tcHRPbikgewogICAgICAgIGlmIChlLmtleUNvZGUgPT0gMTMpIEdhbWUuQ29uZmlybVByb21wdCgpOyAvL2VudGVyIGNvbmZpcm1zIHByb21wdAogICAgICB9CiAgICAgIEdhbWUua2V5c1tlLmtleUNvZGVdID0gMDsKICAgIH0pOwogICAgQWRkRXZlbnQod2luZG93LCAia2V5ZG93biIsIGZ1bmN0aW9uIChlKSB7CiAgICAgIGlmIChHYW1lLnByb21wdE9uKSB7CiAgICAgICAgaWYgKGUua2V5Q29kZSA9PSA5KSB7CiAgICAgICAgICAvL3RhYiB0byBzaGlmdCB0aHJvdWdoIHByb21wdCBidXR0b25zCiAgICAgICAgICBpZiAoZS5zaGlmdEtleSkgR2FtZS5Gb2N1c1Byb21wdE9wdGlvbigtMSk7CiAgICAgICAgICBlbHNlIEdhbWUuRm9jdXNQcm9tcHRPcHRpb24oMSk7CiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICghR2FtZS5PbkFzY2VuZCAmJiBHYW1lLkFzY2VuZFRpbWVyID09IDApIHsKICAgICAgICBpZiAoZS5jdHJsS2V5ICYmIGUua2V5Q29kZSA9PSA4MykgewogICAgICAgICAgR2FtZS50b1NhdmUgPSB0cnVlOwogICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIH0gLy9jdHJsLXMgc2F2ZXMgdGhlIGdhbWUKICAgICAgICBlbHNlIGlmIChlLmN0cmxLZXkgJiYgZS5rZXlDb2RlID09IDc5KSB7CiAgICAgICAgICBHYW1lLkltcG9ydFNhdmUoKTsKICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICB9IC8vY3RybC1vIG9wZW5zIHRoZSBpbXBvcnQgbWVudQogICAgICB9CiAgICAgIGlmICgoZS5rZXlDb2RlID09IDE2IHx8IGUua2V5Q29kZSA9PSAxNykgJiYgR2FtZS50b29sdGlwLmR5bmFtaWMpCiAgICAgICAgR2FtZS50b29sdGlwLnVwZGF0ZSgpOwogICAgICBHYW1lLmtleXNbZS5rZXlDb2RlXSA9IDE7CiAgICAgIGlmIChlLmtleUNvZGUgPT0gOSkgR2FtZS5rZXlzID0gW107IC8vcmVzZXQga2V5cyBvbiB0YWIgcHJlc3MKICAgIH0pOwoKICAgIEFkZEV2ZW50KHdpbmRvdywgInZpc2liaWxpdHljaGFuZ2UiLCBmdW5jdGlvbiAoZSkgewogICAgICBHYW1lLmtleXMgPSBbXTsgLy9yZXNldCBhbGwga2V5IHByZXNzZWQgb24gdmlzaWJpbGl0eSBjaGFuZ2UgKHNob3VsZCBoZWxwIHByZXZlbnQgY3RybCBzdGlsbCBiZWluZyBkb3duIGFmdGVyIGN0cmwtdGFiKQogICAgfSk7CgogICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkJQ1BTIFJFQ0FMQ1VMQVRPUgoJCT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCgogICAgR2FtZS5oZWF2ZW5seVBvd2VyID0gMTsgLy9ob3cgbWFueSBDcFMgcGVyY2VudHMgYSBzaW5nbGUgaGVhdmVubHkgY2hpcCBnaXZlcwogICAgR2FtZS5yZWNhbGN1bGF0ZUdhaW5zID0gMTsKICAgIEdhbWUuY29va2llc1BzQnlUeXBlID0ge307CiAgICBHYW1lLmNvb2tpZXNNdWx0QnlUeXBlID0ge307CiAgICAvL2Rpc3BsYXkgYmFycyB3aXRoIGh0dHA6Ly9jb2RlcGVuLmlvL2Fub24vcGVuL3dhR3lFSgogICAgR2FtZS5lZmZzID0ge307CiAgICBHYW1lLmVmZiA9IGZ1bmN0aW9uIChuYW1lLCBkZWYpIHsKICAgICAgaWYgKHR5cGVvZiBHYW1lLmVmZnNbbmFtZV0gPT09ICJ1bmRlZmluZWQiKQogICAgICAgIHJldHVybiB0eXBlb2YgZGVmID09PSAidW5kZWZpbmVkIiA/IDEgOiBkZWY7CiAgICAgIGVsc2UgcmV0dXJuIEdhbWUuZWZmc1tuYW1lXTsKICAgIH07CgogICAgR2FtZS5DYWxjdWxhdGVHYWlucyA9IGZ1bmN0aW9uICgpIHsKICAgICAgR2FtZS5jb29raWVzUHMgPSAwOwogICAgICB2YXIgbXVsdCA9IDE7CiAgICAgIC8vYWRkIHVwIGVmZmVjdCBib251c2VzIGZyb20gYnVpbGRpbmcgbWluaWdhbWVzCiAgICAgIHZhciBlZmZzID0ge307CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKSB7CiAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1tpXS5taW5pZ2FtZUxvYWRlZCAmJiBHYW1lLk9iamVjdHNbaV0ubWluaWdhbWUuZWZmcykgewogICAgICAgICAgdmFyIG15RWZmcyA9IEdhbWUuT2JqZWN0c1tpXS5taW5pZ2FtZS5lZmZzOwogICAgICAgICAgZm9yICh2YXIgaWkgaW4gbXlFZmZzKSB7CiAgICAgICAgICAgIGlmIChlZmZzW2lpXSkgZWZmc1tpaV0gKj0gbXlFZmZzW2lpXTsKICAgICAgICAgICAgZWxzZSBlZmZzW2lpXSA9IG15RWZmc1tpaV07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIEdhbWUuZWZmcyA9IGVmZnM7CgogICAgICBpZiAoR2FtZS5hc2NlbnNpb25Nb2RlICE9IDEpCiAgICAgICAgbXVsdCArPQogICAgICAgICAgcGFyc2VGbG9hdChHYW1lLnByZXN0aWdlKSAqCiAgICAgICAgICAwLjAxICoKICAgICAgICAgIEdhbWUuaGVhdmVubHlQb3dlciAqCiAgICAgICAgICBHYW1lLkdldEhlYXZlbmx5TXVsdGlwbGllcigpOwoKICAgICAgbXVsdCAqPSBHYW1lLmVmZigiY3BzIik7CgogICAgICBpZiAoR2FtZS5IYXMoIkhlcmFsZHMiKSAmJiBHYW1lLmFzY2Vuc2lvbk1vZGUgIT0gMSkKICAgICAgICBtdWx0ICo9IDEgKyAwLjAxICogR2FtZS5oZXJhbGRzOwoKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLmNvb2tpZVVwZ3JhZGVzKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5jb29raWVVcGdyYWRlc1tpXTsKICAgICAgICBpZiAoR2FtZS5IYXMobWUubmFtZSkpIHsKICAgICAgICAgIG11bHQgKj0KICAgICAgICAgICAgMSArCiAgICAgICAgICAgICh0eXBlb2YgbWUucG93ZXIgPT09ICJmdW5jdGlvbiIgPyBtZS5wb3dlcihtZSkgOiBtZS5wb3dlcikgKiAwLjAxOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKEdhbWUuSGFzKCJTcGVjaWFsaXplZCBjaG9jb2xhdGUgY2hpcHMiKSkgbXVsdCAqPSAxLjAxOwogICAgICBpZiAoR2FtZS5IYXMoIkRlc2lnbmVyIGNvY29hIGJlYW5zIikpIG11bHQgKj0gMS4wMjsKICAgICAgaWYgKEdhbWUuSGFzKCJVbmRlcndvcmxkIG92ZW5zIikpIG11bHQgKj0gMS4wMzsKICAgICAgaWYgKEdhbWUuSGFzKCJFeG90aWMgbnV0cyIpKSBtdWx0ICo9IDEuMDQ7CiAgICAgIGlmIChHYW1lLkhhcygiQXJjYW5lIHN1Z2FyIikpIG11bHQgKj0gMS4wNTsKCiAgICAgIGlmIChHYW1lLkhhcygiSW5jcmVhc2VkIG1lcnJpbmVzcyIpKSBtdWx0ICo9IDEuMTU7CiAgICAgIGlmIChHYW1lLkhhcygiSW1wcm92ZWQgam9sbGluZXNzIikpIG11bHQgKj0gMS4xNTsKICAgICAgaWYgKEdhbWUuSGFzKCJBIGx1bXAgb2YgY29hbCIpKSBtdWx0ICo9IDEuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiQW4gaXRjaHkgc3dlYXRlciIpKSBtdWx0ICo9IDEuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiU2FudGEncyBkb21pbmlvbiIpKSBtdWx0ICo9IDEuMjsKCiAgICAgIGlmIChHYW1lLkhhcygiRm9ydHVuZSAjMTAwIikpIG11bHQgKj0gMS4wMTsKICAgICAgaWYgKEdhbWUuSGFzKCJGb3J0dW5lICMxMDEiKSkgbXVsdCAqPSAxLjA3OwoKICAgICAgaWYgKEdhbWUuSGFzKCJEcmFnb24gc2NhbGUiKSkgbXVsdCAqPSAxLjAzOwoKICAgICAgdmFyIGJ1aWxkTXVsdCA9IDE7CiAgICAgIGlmIChHYW1lLmhhc0dvZCkgewogICAgICAgIHZhciBnb2RMdmwgPSBHYW1lLmhhc0dvZCgiYXNjZXRpY2lzbSIpOwogICAgICAgIGlmIChnb2RMdmwgPT0gMSkgbXVsdCAqPSAxLjE1OwogICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAyKSBtdWx0ICo9IDEuMTsKICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMykgbXVsdCAqPSAxLjA1OwoKICAgICAgICB2YXIgZ29kTHZsID0gR2FtZS5oYXNHb2QoImFnZXMiKTsKICAgICAgICBpZiAoZ29kTHZsID09IDEpCiAgICAgICAgICBtdWx0ICo9CiAgICAgICAgICAgIDEgKwogICAgICAgICAgICAwLjE1ICogTWF0aC5zaW4oKERhdGUubm93KCkgLyAxMDAwIC8gKDYwICogNjAgKiAzKSkgKiBNYXRoLlBJICogMik7CiAgICAgICAgZWxzZSBpZiAoZ29kTHZsID09IDIpCiAgICAgICAgICBtdWx0ICo9CiAgICAgICAgICAgIDEgKwogICAgICAgICAgICAwLjE1ICogTWF0aC5zaW4oKERhdGUubm93KCkgLyAxMDAwIC8gKDYwICogNjAgKiAxMikpICogTWF0aC5QSSAqIDIpOwogICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAzKQogICAgICAgICAgbXVsdCAqPQogICAgICAgICAgICAxICsKICAgICAgICAgICAgMC4xNSAqIE1hdGguc2luKChEYXRlLm5vdygpIC8gMTAwMCAvICg2MCAqIDYwICogMjQpKSAqIE1hdGguUEkgKiAyKTsKCiAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJkZWNhZGVuY2UiKTsKICAgICAgICBpZiAoZ29kTHZsID09IDEpIGJ1aWxkTXVsdCAqPSAwLjkzOwogICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAyKSBidWlsZE11bHQgKj0gMC45NTsKICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMykgYnVpbGRNdWx0ICo9IDAuOTg7CgogICAgICAgIHZhciBnb2RMdmwgPSBHYW1lLmhhc0dvZCgiaW5kdXN0cnkiKTsKICAgICAgICBpZiAoZ29kTHZsID09IDEpIGJ1aWxkTXVsdCAqPSAxLjE7CiAgICAgICAgZWxzZSBpZiAoZ29kTHZsID09IDIpIGJ1aWxkTXVsdCAqPSAxLjA2OwogICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAzKSBidWlsZE11bHQgKj0gMS4wMzsKCiAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJsYWJvciIpOwogICAgICAgIGlmIChnb2RMdmwgPT0gMSkgYnVpbGRNdWx0ICo9IDAuOTc7CiAgICAgICAgZWxzZSBpZiAoZ29kTHZsID09IDIpIGJ1aWxkTXVsdCAqPSAwLjk4OwogICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAzKSBidWlsZE11bHQgKj0gMC45OTsKICAgICAgfQoKICAgICAgaWYgKEdhbWUuSGFzKCJTYW50YSdzIGxlZ2FjeSIpKSBtdWx0ICo9IDEgKyAoR2FtZS5zYW50YUxldmVsICsgMSkgKiAwLjAzOwoKICAgICAgR2FtZS5taWxrUHJvZ3Jlc3MgPSBHYW1lLkFjaGlldmVtZW50c093bmVkIC8gMjU7CiAgICAgIHZhciBtaWxrTXVsdCA9IDE7CiAgICAgIGlmIChHYW1lLkhhcygiU2FudGEncyBtaWxrIGFuZCBjb29raWVzIikpIG1pbGtNdWx0ICo9IDEuMDU7CiAgICAgIC8vaWYgKEdhbWUuaGFzQXVyYSgnQnJlYXRoIG9mIE1pbGsnKSkgbWlsa011bHQqPTEuMDU7CiAgICAgIG1pbGtNdWx0ICo9IDEgKyBHYW1lLmF1cmFNdWx0KCJCcmVhdGggb2YgTWlsayIpICogMC4wNTsKICAgICAgaWYgKEdhbWUuaGFzR29kKSB7CiAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJtb3RoZXIiKTsKICAgICAgICBpZiAoZ29kTHZsID09IDEpIG1pbGtNdWx0ICo9IDEuMTsKICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMikgbWlsa011bHQgKj0gMS4wNTsKICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMykgbWlsa011bHQgKj0gMS4wMzsKICAgICAgfQogICAgICBtaWxrTXVsdCAqPSBHYW1lLmVmZigibWlsayIpOwoKICAgICAgdmFyIGNhdE11bHQgPSAxOwoKICAgICAgaWYgKEdhbWUuSGFzKCJLaXR0ZW4gaGVscGVycyIpKQogICAgICAgIGNhdE11bHQgKj0gMSArIEdhbWUubWlsa1Byb2dyZXNzICogMC4xICogbWlsa011bHQ7CiAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIHdvcmtlcnMiKSkKICAgICAgICBjYXRNdWx0ICo9IDEgKyBHYW1lLm1pbGtQcm9ncmVzcyAqIDAuMTI1ICogbWlsa011bHQ7CiAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIGVuZ2luZWVycyIpKQogICAgICAgIGNhdE11bHQgKj0gMSArIEdhbWUubWlsa1Byb2dyZXNzICogMC4xNSAqIG1pbGtNdWx0OwogICAgICBpZiAoR2FtZS5IYXMoIktpdHRlbiBvdmVyc2VlcnMiKSkKICAgICAgICBjYXRNdWx0ICo9IDEgKyBHYW1lLm1pbGtQcm9ncmVzcyAqIDAuMTc1ICogbWlsa011bHQ7CiAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIG1hbmFnZXJzIikpCiAgICAgICAgY2F0TXVsdCAqPSAxICsgR2FtZS5taWxrUHJvZ3Jlc3MgKiAwLjIgKiBtaWxrTXVsdDsKICAgICAgaWYgKEdhbWUuSGFzKCJLaXR0ZW4gYWNjb3VudGFudHMiKSkKICAgICAgICBjYXRNdWx0ICo9IDEgKyBHYW1lLm1pbGtQcm9ncmVzcyAqIDAuMiAqIG1pbGtNdWx0OwogICAgICBpZiAoR2FtZS5IYXMoIktpdHRlbiBzcGVjaWFsaXN0cyIpKQogICAgICAgIGNhdE11bHQgKj0gMSArIEdhbWUubWlsa1Byb2dyZXNzICogMC4yICogbWlsa011bHQ7CiAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIGV4cGVydHMiKSkKICAgICAgICBjYXRNdWx0ICo9IDEgKyBHYW1lLm1pbGtQcm9ncmVzcyAqIDAuMiAqIG1pbGtNdWx0OwogICAgICBpZiAoR2FtZS5IYXMoIktpdHRlbiBjb25zdWx0YW50cyIpKQogICAgICAgIGNhdE11bHQgKj0gMSArIEdhbWUubWlsa1Byb2dyZXNzICogMC4yICogbWlsa011bHQ7CiAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIGFzc2lzdGFudHMgdG8gdGhlIHJlZ2lvbmFsIG1hbmFnZXIiKSkKICAgICAgICBjYXRNdWx0ICo9IDEgKyBHYW1lLm1pbGtQcm9ncmVzcyAqIDAuMTc1ICogbWlsa011bHQ7CiAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIG1hcmtldGVlcnMiKSkKICAgICAgICBjYXRNdWx0ICo9IDEgKyBHYW1lLm1pbGtQcm9ncmVzcyAqIDAuMTUgKiBtaWxrTXVsdDsKICAgICAgaWYgKEdhbWUuSGFzKCJLaXR0ZW4gYW5hbHlzdHMiKSkKICAgICAgICBjYXRNdWx0ICo9IDEgKyBHYW1lLm1pbGtQcm9ncmVzcyAqIDAuMTI1ICogbWlsa011bHQ7CiAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIGV4ZWN1dGl2ZXMiKSkKICAgICAgICBjYXRNdWx0ICo9IDEgKyBHYW1lLm1pbGtQcm9ncmVzcyAqIDAuMTE1ICogbWlsa011bHQ7CiAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIGFkbWlucyIpKQogICAgICAgIGNhdE11bHQgKj0gMSArIEdhbWUubWlsa1Byb2dyZXNzICogMC4xMSAqIG1pbGtNdWx0OwogICAgICBpZiAoR2FtZS5IYXMoIktpdHRlbiBhbmdlbHMiKSkKICAgICAgICBjYXRNdWx0ICo9IDEgKyBHYW1lLm1pbGtQcm9ncmVzcyAqIDAuMSAqIG1pbGtNdWx0OwogICAgICBpZiAoR2FtZS5IYXMoIkZvcnR1bmUgIzEwMyIpKQogICAgICAgIGNhdE11bHQgKj0gMSArIEdhbWUubWlsa1Byb2dyZXNzICogMC4wNSAqIG1pbGtNdWx0OwoKICAgICAgR2FtZS5jb29raWVzTXVsdEJ5VHlwZVsia2l0dGVucyJdID0gY2F0TXVsdDsKCiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5PYmplY3RzW2ldOwogICAgICAgIG1lLnN0b3JlZENwcyA9IG1lLmNwcyhtZSk7CiAgICAgICAgaWYgKEdhbWUuYXNjZW5zaW9uTW9kZSAhPSAxKQogICAgICAgICAgbWUuc3RvcmVkQ3BzICo9ICgxICsgbWUubGV2ZWwgKiAwLjAxKSAqIGJ1aWxkTXVsdDsKICAgICAgICBpZiAoCiAgICAgICAgICBtZS5pZCA9PSAxICYmCiAgICAgICAgICBHYW1lLkhhcygiTWlsa2hlbHAmcmVnOyBsYWN0b3NlIGludG9sZXJhbmNlIHJlbGllZiB0YWJsZXRzIikKICAgICAgICApCiAgICAgICAgICBtZS5zdG9yZWRDcHMgKj0gMSArIDAuMDUgKiBHYW1lLm1pbGtQcm9ncmVzcyAqIG1pbGtNdWx0OyAvL3RoaXMgdXNlZCB0byBiZSAibWUuc3RvcmVkQ3BzKj0xKzAuMSpNYXRoLnBvdyhjYXRNdWx0LTEsMC41KSIgd2hpY2ggd2FzLiBobW0KICAgICAgICBtZS5zdG9yZWRUb3RhbENwcyA9IG1lLmFtb3VudCAqIG1lLnN0b3JlZENwczsKICAgICAgICBHYW1lLmNvb2tpZXNQcyArPSBtZS5zdG9yZWRUb3RhbENwczsKICAgICAgICBHYW1lLmNvb2tpZXNQc0J5VHlwZVttZS5uYW1lXSA9IG1lLnN0b3JlZFRvdGFsQ3BzOwogICAgICB9CiAgICAgIC8vY3BzIGZyb20gYnVpbGRpbmdzIG9ubHkKICAgICAgR2FtZS5idWlsZGluZ0NwcyA9IEdhbWUuY29va2llc1BzOwoKICAgICAgaWYgKEdhbWUuSGFzKCciZWdnIicpKSB7CiAgICAgICAgR2FtZS5jb29raWVzUHMgKz0gOTsKICAgICAgICBHYW1lLmNvb2tpZXNQc0J5VHlwZVsnImVnZyInXSA9IDk7CiAgICAgIH0gLy8iZWdnIgoKICAgICAgbXVsdCAqPSBjYXRNdWx0OwoKICAgICAgdmFyIGVnZ011bHQgPSAxOwogICAgICBpZiAoR2FtZS5IYXMoIkNoaWNrZW4gZWdnIikpIGVnZ011bHQgKj0gMS4wMTsKICAgICAgaWYgKEdhbWUuSGFzKCJEdWNrIGVnZyIpKSBlZ2dNdWx0ICo9IDEuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiVHVya2V5IGVnZyIpKSBlZ2dNdWx0ICo9IDEuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiUXVhaWwgZWdnIikpIGVnZ011bHQgKj0gMS4wMTsKICAgICAgaWYgKEdhbWUuSGFzKCJSb2JpbiBlZ2ciKSkgZWdnTXVsdCAqPSAxLjAxOwogICAgICBpZiAoR2FtZS5IYXMoIk9zdHJpY2ggZWdnIikpIGVnZ011bHQgKj0gMS4wMTsKICAgICAgaWYgKEdhbWUuSGFzKCJDYXNzb3dhcnkgZWdnIikpIGVnZ011bHQgKj0gMS4wMTsKICAgICAgaWYgKEdhbWUuSGFzKCJTYWxtb24gcm9lIikpIGVnZ011bHQgKj0gMS4wMTsKICAgICAgaWYgKEdhbWUuSGFzKCJGcm9nc3Bhd24iKSkgZWdnTXVsdCAqPSAxLjAxOwogICAgICBpZiAoR2FtZS5IYXMoIlNoYXJrIGVnZyIpKSBlZ2dNdWx0ICo9IDEuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiVHVydGxlIGVnZyIpKSBlZ2dNdWx0ICo9IDEuMDE7CiAgICAgIGlmIChHYW1lLkhhcygiQW50IGxhcnZhIikpIGVnZ011bHQgKj0gMS4wMTsKICAgICAgaWYgKEdhbWUuSGFzKCJDZW50dXJ5IGVnZyIpKSB7CiAgICAgICAgLy90aGUgYm9vc3QgaW5jcmVhc2VzIGEgbGl0dGxlIGV2ZXJ5IGRheSwgd2l0aCBkaW1pbmlzaGluZyByZXR1cm5zIHVwIHRvICsxMCUgb24gdGhlIDEwMHRoIGRheQogICAgICAgIHZhciBkYXkgPQogICAgICAgICAgKE1hdGguZmxvb3IoKERhdGUubm93KCkgLSBHYW1lLnN0YXJ0RGF0ZSkgLyAxMDAwIC8gMTApICogMTApIC8KICAgICAgICAgIDYwIC8KICAgICAgICAgIDYwIC8KICAgICAgICAgIDI0OwogICAgICAgIGRheSA9IE1hdGgubWluKGRheSwgMTAwKTsKICAgICAgICBlZ2dNdWx0ICo9IDEgKyAoMSAtIE1hdGgucG93KDEgLSBkYXkgLyAxMDAsIDMpKSAqIDAuMTsKICAgICAgfQoKICAgICAgR2FtZS5jb29raWVzTXVsdEJ5VHlwZVsiZWdncyJdID0gZWdnTXVsdDsKICAgICAgbXVsdCAqPSBlZ2dNdWx0OwoKICAgICAgaWYgKEdhbWUuSGFzKCJTdWdhciBiYWtpbmciKSkKICAgICAgICBtdWx0ICo9IDEgKyBNYXRoLm1pbigxMDAsIEdhbWUubHVtcHMpICogMC4wMTsKCiAgICAgIC8vaWYgKEdhbWUuaGFzQXVyYSgnUmFkaWFudCBBcHBldGl0ZScpKSBtdWx0Kj0yOwogICAgICBtdWx0ICo9IDEgKyBHYW1lLmF1cmFNdWx0KCJSYWRpYW50IEFwcGV0aXRlIik7CgogICAgICB2YXIgcmF3Q29va2llc1BzID0gR2FtZS5jb29raWVzUHMgKiBtdWx0OwogICAgICBmb3IgKHZhciBpIGluIEdhbWUuQ3BzQWNoaWV2ZW1lbnRzKSB7CiAgICAgICAgaWYgKHJhd0Nvb2tpZXNQcyA+PSBHYW1lLkNwc0FjaGlldmVtZW50c1tpXS50aHJlc2hvbGQpCiAgICAgICAgICBHYW1lLldpbihHYW1lLkNwc0FjaGlldmVtZW50c1tpXS5uYW1lKTsKICAgICAgfQogICAgICBHYW1lLmNvb2tpZXNQc1JhdyA9IHJhd0Nvb2tpZXNQczsKICAgICAgR2FtZS5jb29raWVzUHNSYXdIaWdoZXN0ID0gTWF0aC5tYXgoCiAgICAgICAgR2FtZS5jb29raWVzUHNSYXdIaWdoZXN0LAogICAgICAgIHJhd0Nvb2tpZXNQcwogICAgICApOwoKICAgICAgdmFyIG4gPSBHYW1lLnNoaW1tZXJUeXBlc1siZ29sZGVuIl0ubjsKICAgICAgdmFyIGF1cmFNdWx0ID0gR2FtZS5hdXJhTXVsdCgiRHJhZ29uJ3MgRm9ydHVuZSIpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG47IGkrKykgewogICAgICAgIG11bHQgKj0gMSArIGF1cmFNdWx0ICogMS4yMzsKICAgICAgfQoKICAgICAgbmFtZSA9IEdhbWUuYmFrZXJ5TmFtZS50b0xvd2VyQ2FzZSgpOwogICAgICBpZiAobmFtZSA9PSAib3J0ZWlsIikgbXVsdCAqPSAwLjk5OwogICAgICBlbHNlIGlmIChuYW1lID09ICJvcnRpZWwiKSBtdWx0ICo9IDAuOTg7IC8vb3Igc28gaGVscCBtZQoKICAgICAgdmFyIHN1Y2tpbmcgPSAwOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUud3JpbmtsZXJzKSB7CiAgICAgICAgaWYgKEdhbWUud3JpbmtsZXJzW2ldLnBoYXNlID09IDIpIHsKICAgICAgICAgIHN1Y2tpbmcrKzsKICAgICAgICB9CiAgICAgIH0KICAgICAgdmFyIHN1Y2tSYXRlID0gMSAvIDIwOyAvL2VhY2ggd3JpbmtsZXIgZWF0cyBhIHR3ZW50aWV0aCBvZiB5b3VyIENwUwogICAgICBzdWNrUmF0ZSAqPSBHYW1lLmVmZigid3JpbmtsZXJFYXQiKTsKCiAgICAgIEdhbWUuY3BzU3Vja2VkID0gc3Vja2luZyAqIHN1Y2tSYXRlOwoKICAgICAgaWYgKEdhbWUuSGFzKCJFbGRlciBDb3ZlbmFudCIpKSBtdWx0ICo9IDAuOTU7CgogICAgICBpZiAoR2FtZS5IYXMoIkdvbGRlbiBzd2l0Y2ggW29mZl0iKSkgewogICAgICAgIHZhciBnb2xkZW5Td2l0Y2hNdWx0ID0gMS41OwogICAgICAgIGlmIChHYW1lLkhhcygiUmVzaWR1YWwgbHVjayIpKSB7CiAgICAgICAgICB2YXIgdXBncmFkZXMgPSBHYW1lLmdvbGRlbkNvb2tpZVVwZ3JhZGVzOwogICAgICAgICAgZm9yICh2YXIgaSBpbiB1cGdyYWRlcykgewogICAgICAgICAgICBpZiAoR2FtZS5IYXModXBncmFkZXNbaV0pKSBnb2xkZW5Td2l0Y2hNdWx0ICs9IDAuMTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgbXVsdCAqPSBnb2xkZW5Td2l0Y2hNdWx0OwogICAgICB9CiAgICAgIGlmIChHYW1lLkhhcygiU2hpbW1lcmluZyB2ZWlsIFtvZmZdIikpIHsKICAgICAgICBtdWx0ICo9IDEgKyBHYW1lLmdldFZlaWxCb29zdCgpOwogICAgICB9CiAgICAgIGlmIChHYW1lLkhhcygiTWFnaWMgc2hlbmFuaWdhbnMiKSkgbXVsdCAqPSAxMDAwOwogICAgICBpZiAoR2FtZS5IYXMoIk9jY3VsdCBvYnN0cnVjdGlvbiIpKSBtdWx0ICo9IDA7CgogICAgICBHYW1lLmNvb2tpZXNQcyA9IEdhbWUucnVuTW9kSG9va09uVmFsdWUoImNwcyIsIEdhbWUuY29va2llc1BzKTsKCiAgICAgIC8vY3BzIHdpdGhvdXQgZ29sZGVuIGNvb2tpZSBlZmZlY3RzCiAgICAgIEdhbWUudW5idWZmZWRDcHMgPSBHYW1lLmNvb2tpZXNQcyAqIG11bHQ7CgogICAgICBmb3IgKHZhciBpIGluIEdhbWUuYnVmZnMpIHsKICAgICAgICBpZiAodHlwZW9mIEdhbWUuYnVmZnNbaV0ubXVsdENwUyAhPT0gInVuZGVmaW5lZCIpCiAgICAgICAgICBtdWx0ICo9IEdhbWUuYnVmZnNbaV0ubXVsdENwUzsKICAgICAgfQoKICAgICAgR2FtZS5nbG9iYWxDcHNNdWx0ID0gbXVsdDsKICAgICAgR2FtZS5jb29raWVzUHMgKj0gR2FtZS5nbG9iYWxDcHNNdWx0OwoKICAgICAgLy9pZiAoR2FtZS5oYXNCdWZmKCdDdXJzZWQgZmluZ2VyJykpIEdhbWUuY29va2llc1BzPTA7CgogICAgICBHYW1lLmNvbXB1dGVkTW91c2VDcHMgPSBHYW1lLm1vdXNlQ3BzKCk7CgogICAgICBHYW1lLmNvbXB1dGVMdW1wVGltZXMoKTsKCiAgICAgIEdhbWUucmVjYWxjdWxhdGVHYWlucyA9IDA7CiAgICB9OwoKICAgIEdhbWUuZHJvcFJhdGVNdWx0ID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgcmF0ZSA9IDE7CiAgICAgIGlmIChHYW1lLkhhcygiR3JlZW4geWVhc3QgZGlnZXN0aXZlcyIpKSByYXRlICo9IDEuMDM7CiAgICAgIGlmIChHYW1lLkhhcygiRHJhZ29uIHRlZGR5IGJlYXIiKSkgcmF0ZSAqPSAxLjAzOwogICAgICByYXRlICo9IEdhbWUuZWZmKCJpdGVtRHJvcHMiKTsKICAgICAgLy9pZiAoR2FtZS5oYXNBdXJhKCdNaW5kIE92ZXIgTWF0dGVyJykpIHJhdGUqPTEuMjU7CiAgICAgIHJhdGUgKj0gMSArIEdhbWUuYXVyYU11bHQoIk1pbmQgT3ZlciBNYXR0ZXIiKSAqIDAuMjU7CiAgICAgIGlmIChHYW1lLkhhcygiU2FudGEncyBib3R0b21sZXNzIGJhZyIpKSByYXRlICo9IDEuMTsKICAgICAgaWYgKAogICAgICAgIEdhbWUuSGFzKCJDb3NtaWMgYmVnaW5uZXIncyBsdWNrIikgJiYKICAgICAgICAhR2FtZS5IYXMoIkhlYXZlbmx5IGNoaXAgc2VjcmV0IikKICAgICAgKQogICAgICAgIHJhdGUgKj0gNTsKICAgICAgcmV0dXJuIHJhdGU7CiAgICB9OwogICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkJU0hJTU1FUlMgKEdPTERFTiBDT09LSUVTICYgU1VDSCkKCQk9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgR2FtZS5zaGltbWVyc0wgPSBsKCJzaGltbWVycyIpOwogICAgR2FtZS5zaGltbWVycyA9IFtdOyAvL2FsbCBzaGltbWVycyBjdXJyZW50bHkgb24gdGhlIHNjcmVlbgogICAgR2FtZS5zaGltbWVyc04gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMCk7CiAgICBHYW1lLnNoaW1tZXIgPSBmdW5jdGlvbiAodHlwZSwgb2JqLCBub0NvdW50KSB7CiAgICAgIHRoaXMudHlwZSA9IHR5cGU7CgogICAgICB0aGlzLmwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgdGhpcy5sLmNsYXNzTmFtZSA9ICJzaGltbWVyIjsKICAgICAgaWYgKCFHYW1lLnRvdWNoRXZlbnRzKSB7CiAgICAgICAgQWRkRXZlbnQoCiAgICAgICAgICB0aGlzLmwsCiAgICAgICAgICAiY2xpY2siLAogICAgICAgICAgKGZ1bmN0aW9uICh3aGF0KSB7CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgICB3aGF0LnBvcChldmVudCk7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9KSh0aGlzKQogICAgICAgICk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgQWRkRXZlbnQoCiAgICAgICAgICB0aGlzLmwsCiAgICAgICAgICAidG91Y2hlbmQiLAogICAgICAgICAgKGZ1bmN0aW9uICh3aGF0KSB7CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgICB3aGF0LnBvcChldmVudCk7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9KSh0aGlzKQogICAgICAgICk7CiAgICAgIH0gLy90b3VjaCBldmVudHMKCiAgICAgIHRoaXMueCA9IDA7CiAgICAgIHRoaXMueSA9IDA7CiAgICAgIHRoaXMuaWQgPSBHYW1lLnNoaW1tZXJzTjsKCiAgICAgIHRoaXMuZm9yY2UgPSAiIjsKICAgICAgdGhpcy5mb3JjZU9iaiA9IG9iaiB8fCAwOwogICAgICBpZiAodGhpcy5mb3JjZU9iai50eXBlKSB0aGlzLmZvcmNlID0gdGhpcy5mb3JjZU9iai50eXBlOwogICAgICB0aGlzLm5vQ291bnQgPSBub0NvdW50OwogICAgICBpZiAoIXRoaXMubm9Db3VudCkgewogICAgICAgIEdhbWUuc2hpbW1lclR5cGVzW3RoaXMudHlwZV0ubisrOwogICAgICAgIEdhbWUucmVjYWxjdWxhdGVHYWlucyA9IDE7CiAgICAgIH0KCiAgICAgIHRoaXMuaW5pdCgpOwoKICAgICAgR2FtZS5zaGltbWVyc0wuYXBwZW5kQ2hpbGQodGhpcy5sKTsKICAgICAgR2FtZS5zaGltbWVycy5wdXNoKHRoaXMpOwogICAgICBHYW1lLnNoaW1tZXJzTisrOwogICAgfTsKICAgIEdhbWUuc2hpbW1lci5wcm90b3R5cGUuaW5pdCA9CiAgICAgIGZ1bmN0aW9uICgpIC8vZXhlY3V0ZWQgd2hlbiB0aGUgc2hpbW1lciBpcyBjcmVhdGVkCiAgICAgIHsKICAgICAgICBHYW1lLnNoaW1tZXJUeXBlc1t0aGlzLnR5cGVdLmluaXRGdW5jKHRoaXMpOwogICAgICB9OwogICAgR2FtZS5zaGltbWVyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSAvL2V4ZWN1dGVkIGV2ZXJ5IGZyYW1lCiAgICB7CiAgICAgIEdhbWUuc2hpbW1lclR5cGVzW3RoaXMudHlwZV0udXBkYXRlRnVuYyh0aGlzKTsKICAgIH07CiAgICBHYW1lLnNoaW1tZXIucHJvdG90eXBlLnBvcCA9IGZ1bmN0aW9uICgKICAgICAgZXZlbnQgLy9leGVjdXRlZCB3aGVuIHRoZSBzaGltbWVyIGlzIHBvcHBlZCBieSB0aGUgcGxheWVyCiAgICApIHsKICAgICAgaWYgKGV2ZW50KSBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBHYW1lLmxvc2VTaGltbWVyaW5nVmVpbCgic2hpbW1lciIpOwogICAgICBHYW1lLkNsaWNrID0gMDsKICAgICAgR2FtZS5zaGltbWVyVHlwZXNbdGhpcy50eXBlXS5wb3BGdW5jKHRoaXMpOwogICAgfTsKICAgIEdhbWUuc2hpbW1lci5wcm90b3R5cGUuZGllID0KICAgICAgZnVuY3Rpb24gKCkgLy9leGVjdXRlZCBhZnRlciB0aGUgc2hpbW1lciBkaXNhcHBlYXJzIChmcm9tIG9sZCBhZ2Ugb3IgcG9wcGluZykKICAgICAgewogICAgICAgIGlmIChHYW1lLnNoaW1tZXJUeXBlc1t0aGlzLnR5cGVdLnNwYXduc09uVGltZXIgJiYgdGhpcy5zcGF3bkxlYWQpIHsKICAgICAgICAgIC8vaWYgdGhpcyB3YXMgdGhlIHNwYXduIGxlYWQgZm9yIHRoaXMgc2hpbW1lciB0eXBlLCBzZXQgdGhlIHNoaW1tZXIgdHlwZSdzICJzcGF3bmVkIiB0byAwIGFuZCByZXN0YXJ0IGl0cyBzcGF3biB0aW1lcgogICAgICAgICAgdmFyIHR5cGUgPSBHYW1lLnNoaW1tZXJUeXBlc1t0aGlzLnR5cGVdOwogICAgICAgICAgdHlwZS50aW1lID0gMDsKICAgICAgICAgIHR5cGUuc3Bhd25lZCA9IDA7CiAgICAgICAgICB0eXBlLm1pblRpbWUgPSB0eXBlLmdldE1pblRpbWUodGhpcyk7CiAgICAgICAgICB0eXBlLm1heFRpbWUgPSB0eXBlLmdldE1heFRpbWUodGhpcyk7CiAgICAgICAgfQogICAgICAgIEdhbWUuc2hpbW1lcnNMLnJlbW92ZUNoaWxkKHRoaXMubCk7CiAgICAgICAgaWYgKEdhbWUuc2hpbW1lcnMuaW5kZXhPZih0aGlzKSAhPSAtMSkKICAgICAgICAgIEdhbWUuc2hpbW1lcnMuc3BsaWNlKEdhbWUuc2hpbW1lcnMuaW5kZXhPZih0aGlzKSwgMSk7CiAgICAgICAgaWYgKCF0aGlzLm5vQ291bnQpIHsKICAgICAgICAgIEdhbWUuc2hpbW1lclR5cGVzW3RoaXMudHlwZV0ubiA9IE1hdGgubWF4KAogICAgICAgICAgICAwLAogICAgICAgICAgICBHYW1lLnNoaW1tZXJUeXBlc1t0aGlzLnR5cGVdLm4gLSAxCiAgICAgICAgICApOwogICAgICAgICAgR2FtZS5yZWNhbGN1bGF0ZUdhaW5zID0gMTsKICAgICAgICB9CiAgICAgIH07CgogICAgR2FtZS51cGRhdGVTaGltbWVycyA9CiAgICAgIGZ1bmN0aW9uICgpIC8vcnVuIHNoaW1tZXIgZnVuY3Rpb25zLCBraWxsIG92ZXJ0aW1lZCBzaGltbWVycyBhbmQgc3Bhd24gbmV3IG9uZXMKICAgICAgewogICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5zaGltbWVycykgewogICAgICAgICAgR2FtZS5zaGltbWVyc1tpXS51cGRhdGUoKTsKICAgICAgICB9CgogICAgICAgIC8vY29va2llIHN0b3JtIQogICAgICAgIGlmIChHYW1lLmhhc0J1ZmYoIkNvb2tpZSBzdG9ybSIpICYmIE1hdGgucmFuZG9tKCkgPCAwLjUpIHsKICAgICAgICAgIHZhciBuZXdTaGltbWVyID0gbmV3IEdhbWUuc2hpbW1lcigKICAgICAgICAgICAgImdvbGRlbiIsCiAgICAgICAgICAgIHsgdHlwZTogImNvb2tpZSBzdG9ybSBkcm9wIiB9LAogICAgICAgICAgICAxCiAgICAgICAgICApOwogICAgICAgICAgbmV3U2hpbW1lci5kdXIgPSBNYXRoLmNlaWwoTWF0aC5yYW5kb20oKSAqIDQgKyAxKTsKICAgICAgICAgIG5ld1NoaW1tZXIubGlmZSA9IE1hdGguY2VpbChHYW1lLmZwcyAqIG5ld1NoaW1tZXIuZHVyKTsKICAgICAgICAgIC8vbmV3U2hpbW1lci5mb3JjZT0nY29va2llIHN0b3JtIGRyb3AnOwogICAgICAgICAgbmV3U2hpbW1lci5zaXplTXVsdCA9IE1hdGgucmFuZG9tKCkgKiAwLjc1ICsgMC4yNTsKICAgICAgICB9CgogICAgICAgIC8vc3Bhd24gc2hpbW1lcnMKICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuc2hpbW1lclR5cGVzKSB7CiAgICAgICAgICB2YXIgbWUgPSBHYW1lLnNoaW1tZXJUeXBlc1tpXTsKICAgICAgICAgIGlmIChtZS5zcGF3bnNPblRpbWVyICYmIG1lLnNwYXduQ29uZGl0aW9ucygpKSB7CiAgICAgICAgICAgIC8vb25seSBydW4gb24gc2hpbW1lciB0eXBlcyB0aGF0IHdvcmsgb24gYSB0aW1lcgogICAgICAgICAgICBpZiAoIW1lLnNwYXduZWQpIHsKICAgICAgICAgICAgICAvL25vIHNoaW1tZXIgc3Bhd25lZCBmb3IgdGhpcyB0eXBlPyBjaGVjayB0aGUgdGltZXIgYW5kIHRyeSB0byBzcGF3biBvbmUKICAgICAgICAgICAgICBtZS50aW1lKys7CiAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgTWF0aC5yYW5kb20oKSA8CiAgICAgICAgICAgICAgICBNYXRoLnBvdygKICAgICAgICAgICAgICAgICAgTWF0aC5tYXgoCiAgICAgICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgICAgICAobWUudGltZSAtIG1lLm1pblRpbWUpIC8gKG1lLm1heFRpbWUgLSBtZS5taW5UaW1lKQogICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICA1CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICB2YXIgbmV3U2hpbW1lciA9IG5ldyBHYW1lLnNoaW1tZXIoaSk7CiAgICAgICAgICAgICAgICBuZXdTaGltbWVyLnNwYXduTGVhZCA9IDE7CiAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgIEdhbWUuSGFzKCJEaXN0aWxsZWQgZXNzZW5jZSBvZiByZWRvdWJsZWQgbHVjayIpICYmCiAgICAgICAgICAgICAgICAgIE1hdGgucmFuZG9tKCkgPCAwLjAxCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgIHZhciBuZXdTaGltbWVyID0gbmV3IEdhbWUuc2hpbW1lcihpKTsKICAgICAgICAgICAgICAgIG1lLnNwYXduZWQgPSAxOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfTsKICAgIEdhbWUua2lsbFNoaW1tZXJzID0KICAgICAgZnVuY3Rpb24gKCkgLy9zdG9wIGFuZCBkZWxldGUgYWxsIHNoaW1tZXJzICh1c2VkIG9uIHJlc2V0dGluZyBldGMpCiAgICAgIHsKICAgICAgICBmb3IgKHZhciBpID0gR2FtZS5zaGltbWVycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgICAgR2FtZS5zaGltbWVyc1tpXS5kaWUoKTsKICAgICAgICB9CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLnNoaW1tZXJUeXBlcykgewogICAgICAgICAgdmFyIG1lID0gR2FtZS5zaGltbWVyVHlwZXNbaV07CiAgICAgICAgICBpZiAobWUucmVzZXQpIG1lLnJlc2V0KCk7CiAgICAgICAgICBtZS5uID0gMDsKICAgICAgICAgIGlmIChtZS5zcGF3bnNPblRpbWVyKSB7CiAgICAgICAgICAgIG1lLnRpbWUgPSAwOwogICAgICAgICAgICBtZS5zcGF3bmVkID0gMDsKICAgICAgICAgICAgbWUubWluVGltZSA9IG1lLmdldE1pblRpbWUobWUpOwogICAgICAgICAgICBtZS5tYXhUaW1lID0gbWUuZ2V0TWF4VGltZShtZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9OwoKICAgIEdhbWUuc2hpbW1lclR5cGVzID0gewogICAgICAvL2luIHRoZXNlLCAibWUiIHJlZmVycyB0byB0aGUgc2hpbW1lciBpdHNlbGYsIGFuZCAidGhpcyIgdG8gdGhlIHNoaW1tZXIncyB0eXBlIG9iamVjdAogICAgICBnb2xkZW46IHsKICAgICAgICByZXNldDogZnVuY3Rpb24gKCkgewogICAgICAgICAgdGhpcy5jaGFpbiA9IDA7CiAgICAgICAgICB0aGlzLnRvdGFsRnJvbUNoYWluID0gMDsKICAgICAgICAgIHRoaXMubGFzdCA9ICIiOwogICAgICAgIH0sCiAgICAgICAgaW5pdEZ1bmM6IGZ1bmN0aW9uIChtZSkgewogICAgICAgICAgaWYgKAogICAgICAgICAgICAhdGhpcy5zcGF3bmVkICYmCiAgICAgICAgICAgIG1lLmZvcmNlICE9ICJjb29raWUgc3Rvcm0gZHJvcCIgJiYKICAgICAgICAgICAgR2FtZS5jaGltZVR5cGUgIT0gMCAmJgogICAgICAgICAgICBHYW1lLmFzY2Vuc2lvbk1vZGUgIT0gMQogICAgICAgICAgKQogICAgICAgICAgICBHYW1lLnBsYXlHb2xkZW5Db29raWVDaGltZSgpOwoKICAgICAgICAgIC8vc2V0IGltYWdlCiAgICAgICAgICB2YXIgYmdQaWMgPSAiaW1nL2dvbGRDb29raWUucG5nIjsKICAgICAgICAgIHZhciBwaWNYID0gMDsKICAgICAgICAgIHZhciBwaWNZID0gMDsKCiAgICAgICAgICBpZiAoCiAgICAgICAgICAgICghbWUuZm9yY2VPYmogfHwgIW1lLmZvcmNlT2JqLm5vV3JhdGgpICYmCiAgICAgICAgICAgICgobWUuZm9yY2VPYmogJiYgbWUuZm9yY2VPYmoud3JhdGgpIHx8CiAgICAgICAgICAgICAgKEdhbWUuZWxkZXJXcmF0aCA9PSAxICYmIE1hdGgucmFuZG9tKCkgPCAxIC8gMykgfHwKICAgICAgICAgICAgICAoR2FtZS5lbGRlcldyYXRoID09IDIgJiYgTWF0aC5yYW5kb20oKSA8IDIgLyAzKSB8fAogICAgICAgICAgICAgIEdhbWUuZWxkZXJXcmF0aCA9PSAzIHx8CiAgICAgICAgICAgICAgKEdhbWUuaGFzR29kICYmIEdhbWUuaGFzR29kKCJzY29ybiIpKSkKICAgICAgICAgICkgewogICAgICAgICAgICBtZS53cmF0aCA9IDE7CiAgICAgICAgICAgIGlmIChHYW1lLnNlYXNvbiA9PSAiaGFsbG93ZWVuIikgYmdQaWMgPSAiaW1nL3Nwb29reUNvb2tpZS5wbmciOwogICAgICAgICAgICBlbHNlIGJnUGljID0gImltZy93cmF0aENvb2tpZS5wbmciOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbWUud3JhdGggPSAwOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChHYW1lLnNlYXNvbiA9PSAidmFsZW50aW5lcyIpIHsKICAgICAgICAgICAgYmdQaWMgPSAiaW1nL2hlYXJ0cy5wbmciOwogICAgICAgICAgICBwaWNYID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogOCk7CiAgICAgICAgICB9IGVsc2UgaWYgKEdhbWUuc2Vhc29uID09ICJmb29scyIpIHsKICAgICAgICAgICAgYmdQaWMgPSAiaW1nL2NvbnRyYWN0LnBuZyI7CiAgICAgICAgICAgIGlmIChtZS53cmF0aCkgYmdQaWMgPSAiaW1nL3dyYXRoQ29udHJhY3QucG5nIjsKICAgICAgICAgIH0gZWxzZSBpZiAoR2FtZS5zZWFzb24gPT0gImVhc3RlciIpIHsKICAgICAgICAgICAgYmdQaWMgPSAiaW1nL2J1bm5pZXMucG5nIjsKICAgICAgICAgICAgcGljWCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDQpOwogICAgICAgICAgICBwaWNZID0gMDsKICAgICAgICAgICAgaWYgKG1lLndyYXRoKSBwaWNZID0gMTsKICAgICAgICAgIH0KCiAgICAgICAgICBtZS54ID0KICAgICAgICAgICAgTWF0aC5mbG9vcigKICAgICAgICAgICAgICBNYXRoLnJhbmRvbSgpICoKICAgICAgICAgICAgICAgIE1hdGgubWF4KDAsIEdhbWUuYm91bmRzLnJpZ2h0IC0gMzAwIC0gR2FtZS5ib3VuZHMubGVmdCAtIDEyOCkgKwogICAgICAgICAgICAgICAgR2FtZS5ib3VuZHMubGVmdCArCiAgICAgICAgICAgICAgICA2NAogICAgICAgICAgICApIC0gNjQ7CiAgICAgICAgICBtZS55ID0KICAgICAgICAgICAgTWF0aC5mbG9vcigKICAgICAgICAgICAgICBNYXRoLnJhbmRvbSgpICoKICAgICAgICAgICAgICAgIE1hdGgubWF4KDAsIEdhbWUuYm91bmRzLmJvdHRvbSAtIEdhbWUuYm91bmRzLnRvcCAtIDEyOCkgKwogICAgICAgICAgICAgICAgR2FtZS5ib3VuZHMudG9wICsKICAgICAgICAgICAgICAgIDY0CiAgICAgICAgICAgICkgLSA2NDsKICAgICAgICAgIG1lLmwuc3R5bGUubGVmdCA9IG1lLnggKyAicHgiOwogICAgICAgICAgbWUubC5zdHlsZS50b3AgPSBtZS55ICsgInB4IjsKICAgICAgICAgIG1lLmwuc3R5bGUud2lkdGggPSAiOTZweCI7CiAgICAgICAgICBtZS5sLnN0eWxlLmhlaWdodCA9ICI5NnB4IjsKICAgICAgICAgIG1lLmwuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gInVybCgiICsgYmdQaWMgKyAiKSI7CiAgICAgICAgICBtZS5sLnN0eWxlLmJhY2tncm91bmRQb3NpdGlvbiA9CiAgICAgICAgICAgIC1waWNYICogOTYgKyAicHggIiArIC1waWNZICogOTYgKyAicHgiOwogICAgICAgICAgbWUubC5zdHlsZS5vcGFjaXR5ID0gIjAiOwogICAgICAgICAgbWUubC5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICAgIG1lLmwuc2V0QXR0cmlidXRlKAogICAgICAgICAgICAiYWx0IiwKICAgICAgICAgICAgbG9jKG1lLndyYXRoID8gIldyYXRoIGNvb2tpZSIgOiAiR29sZGVuIGNvb2tpZSIpCiAgICAgICAgICApOwoKICAgICAgICAgIG1lLmxpZmUgPSAxOyAvL3RoZSBjb29raWUncyBjdXJyZW50IHByb2dyZXNzaW9uIHRocm91Z2ggaXRzIGxpZmVzcGFuIChpbiBmcmFtZXMpCiAgICAgICAgICBtZS5kdXIgPSAxMzsgLy9kdXJhdGlvbjsgdGhlIGNvb2tpZSdzIGxpZmVzcGFuIGluIHNlY29uZHMgYmVmb3JlIGl0IGRlc3Bhd25zCgogICAgICAgICAgdmFyIGR1ciA9IDEzOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJMdWNreSBkYXkiKSkgZHVyICo9IDI7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIlNlcmVuZGlwaXR5IikpIGR1ciAqPSAyOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJEZWNpc2l2ZSBmYXRlIikpIGR1ciAqPSAxLjA1OwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJMdWNreSBkaWdpdCIpKSBkdXIgKj0gMS4wMTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiTHVja3kgbnVtYmVyIikpIGR1ciAqPSAxLjAxOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJMdWNreSBwYXlvdXQiKSkgZHVyICo9IDEuMDE7CiAgICAgICAgICBpZiAoIW1lLndyYXRoKSBkdXIgKj0gR2FtZS5lZmYoImdvbGRlbkNvb2tpZUR1ciIpOwogICAgICAgICAgZWxzZSBkdXIgKj0gR2FtZS5lZmYoIndyYXRoQ29va2llRHVyIik7CiAgICAgICAgICBkdXIgKj0gTWF0aC5wb3coMC45NSwgR2FtZS5zaGltbWVyVHlwZXNbImdvbGRlbiJdLm4gLSAxKTsgLy81JSBzaG9ydGVyIGZvciBldmVyeSBvdGhlciBnb2xkZW4gY29va2llIG9uIHRoZSBzY3JlZW4KICAgICAgICAgIGlmICh0aGlzLmNoYWluID4gMCkgZHVyID0gTWF0aC5tYXgoMiwgMTAgLyB0aGlzLmNoYWluKTsgLy90aGlzIGlzIGhpbGFyaW91cwogICAgICAgICAgbWUuZHVyID0gZHVyOwogICAgICAgICAgbWUubGlmZSA9IE1hdGguY2VpbChHYW1lLmZwcyAqIG1lLmR1cik7CiAgICAgICAgICBtZS5zaXplTXVsdCA9IDE7CiAgICAgICAgfSwKICAgICAgICB1cGRhdGVGdW5jOiBmdW5jdGlvbiAobWUpIHsKICAgICAgICAgIHZhciBjdXJ2ZSA9IDEgLSBNYXRoLnBvdygobWUubGlmZSAvIChHYW1lLmZwcyAqIG1lLmR1cikpICogMiAtIDEsIDQpOwogICAgICAgICAgbWUubC5zdHlsZS5vcGFjaXR5ID0gY3VydmU7CiAgICAgICAgICAvL3RoaXMgbGluZSBtYWtlcyBlYWNoIGdvbGRlbiBjb29raWUgcHVsc2UgaW4gYSB1bmlxdWUgd2F5CiAgICAgICAgICBpZiAoR2FtZS5wcmVmcy5mYW5jeSkKICAgICAgICAgICAgbWUubC5zdHlsZS50cmFuc2Zvcm0gPQogICAgICAgICAgICAgICJyb3RhdGUoIiArCiAgICAgICAgICAgICAgKE1hdGguc2luKG1lLmlkICogMC42OSkgKiAyNCArCiAgICAgICAgICAgICAgICBNYXRoLnNpbigKICAgICAgICAgICAgICAgICAgR2FtZS5UICogKDAuMzUgKyBNYXRoLnNpbihtZS5pZCAqIDAuOTcpICogMC4xNSkgKwogICAgICAgICAgICAgICAgICAgIG1lLmlkIC8qK01hdGguc2luKEdhbWUuVCowLjA3KSoyKzIqLwogICAgICAgICAgICAgICAgKSAqCiAgICAgICAgICAgICAgICAgICgzICsgTWF0aC5zaW4obWUuaWQgKiAwLjM2KSAqIDIpKSArCiAgICAgICAgICAgICAgImRlZykgc2NhbGUoIiArCiAgICAgICAgICAgICAgbWUuc2l6ZU11bHQgKgogICAgICAgICAgICAgICAgKDEgKyBNYXRoLnNpbihtZS5pZCAqIDAuNTMpICogMC4yKSAqCiAgICAgICAgICAgICAgICBjdXJ2ZSAqCiAgICAgICAgICAgICAgICAoMSArCiAgICAgICAgICAgICAgICAgICgwLjA2ICsgTWF0aC5zaW4obWUuaWQgKiAwLjQxKSAqIDAuMDUpICoKICAgICAgICAgICAgICAgICAgICBNYXRoLnNpbigKICAgICAgICAgICAgICAgICAgICAgIEdhbWUuVCAqICgwLjI1ICsgTWF0aC5zaW4obWUuaWQgKiAwLjczKSAqIDAuMTUpICsgbWUuaWQKICAgICAgICAgICAgICAgICAgICApKSArCiAgICAgICAgICAgICAgIikiOwogICAgICAgICAgbWUubGlmZS0tOwogICAgICAgICAgaWYgKG1lLmxpZmUgPD0gMCkgewogICAgICAgICAgICB0aGlzLm1pc3NGdW5jKG1lKTsKICAgICAgICAgICAgbWUuZGllKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBwb3BGdW5jOiBmdW5jdGlvbiAobWUpIHsKICAgICAgICAgIC8vZ2V0IGFjaGlldnMgYW5kIHN0YXRzCiAgICAgICAgICBpZiAobWUuc3Bhd25MZWFkKSB7CiAgICAgICAgICAgIEdhbWUuZ29sZGVuQ2xpY2tzKys7CiAgICAgICAgICAgIEdhbWUuZ29sZGVuQ2xpY2tzTG9jYWwrKzsKCiAgICAgICAgICAgIGlmIChHYW1lLmdvbGRlbkNsaWNrcyA+PSAxKSBHYW1lLldpbigiR29sZGVuIGNvb2tpZSIpOwogICAgICAgICAgICBpZiAoR2FtZS5nb2xkZW5DbGlja3MgPj0gNykgR2FtZS5XaW4oIkx1Y2t5IGNvb2tpZSIpOwogICAgICAgICAgICBpZiAoR2FtZS5nb2xkZW5DbGlja3MgPj0gMjcpIEdhbWUuV2luKCJBIHN0cm9rZSBvZiBsdWNrIik7CiAgICAgICAgICAgIGlmIChHYW1lLmdvbGRlbkNsaWNrcyA+PSA3NykgR2FtZS5XaW4oIkZvcnR1bmUiKTsKICAgICAgICAgICAgaWYgKEdhbWUuZ29sZGVuQ2xpY2tzID49IDc3NykgR2FtZS5XaW4oIkxlcHJlY2hhdW4iKTsKICAgICAgICAgICAgaWYgKEdhbWUuZ29sZGVuQ2xpY2tzID49IDc3NzcpIEdhbWUuV2luKCJCbGFjayBjYXQncyBwYXciKTsKICAgICAgICAgICAgaWYgKEdhbWUuZ29sZGVuQ2xpY2tzID49IDI3Nzc3KSBHYW1lLldpbigiU2V2ZW4gaG9yc2VzaG9lcyIpOwoKICAgICAgICAgICAgaWYgKEdhbWUuZ29sZGVuQ2xpY2tzID49IDcpIEdhbWUuVW5sb2NrKCJMdWNreSBkYXkiKTsKICAgICAgICAgICAgaWYgKEdhbWUuZ29sZGVuQ2xpY2tzID49IDI3KSBHYW1lLlVubG9jaygiU2VyZW5kaXBpdHkiKTsKICAgICAgICAgICAgaWYgKEdhbWUuZ29sZGVuQ2xpY2tzID49IDc3KSBHYW1lLlVubG9jaygiR2V0IGx1Y2t5Iik7CgogICAgICAgICAgICBpZiAobWUubGlmZSAvIEdhbWUuZnBzID4gbWUuZHVyIC0gMSkgR2FtZS5XaW4oIkVhcmx5IGJpcmQiKTsKICAgICAgICAgICAgaWYgKG1lLmxpZmUgPCBHYW1lLmZwcykgR2FtZS5XaW4oIkZhZGluZyBsdWNrIik7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKEdhbWUuZm9yY2VVbnNsb3RHb2QpIHsKICAgICAgICAgICAgaWYgKEdhbWUuZm9yY2VVbnNsb3RHb2QoImFzY2V0aWNpc20iKSkgR2FtZS51c2VTd2FwKDEwMDAwMDApOwogICAgICAgICAgfQoKICAgICAgICAgIC8vc2VsZWN0IGFuIGVmZmVjdAogICAgICAgICAgdmFyIGxpc3QgPSBbXTsKICAgICAgICAgIGlmIChtZS53cmF0aCA+IDApCiAgICAgICAgICAgIGxpc3QucHVzaCgiY2xvdCIsICJtdWx0aXBseSBjb29raWVzIiwgInJ1aW4gY29va2llcyIpOwogICAgICAgICAgZWxzZSBsaXN0LnB1c2goImZyZW56eSIsICJtdWx0aXBseSBjb29raWVzIik7CiAgICAgICAgICBpZiAobWUud3JhdGggPiAwICYmIEdhbWUuaGFzR29kICYmIEdhbWUuaGFzR29kKCJzY29ybiIpKQogICAgICAgICAgICBsaXN0LnB1c2goImNsb3QiLCAicnVpbiBjb29raWVzIiwgImNsb3QiLCAicnVpbiBjb29raWVzIik7CiAgICAgICAgICBpZiAobWUud3JhdGggPiAwICYmIE1hdGgucmFuZG9tKCkgPCAwLjMpCiAgICAgICAgICAgIGxpc3QucHVzaCgiYmxvb2QgZnJlbnp5IiwgImNoYWluIGNvb2tpZSIsICJjb29raWUgc3Rvcm0iKTsKICAgICAgICAgIGVsc2UgaWYgKE1hdGgucmFuZG9tKCkgPCAwLjAzICYmIEdhbWUuY29va2llc0Vhcm5lZCA+PSAxMDAwMDApCiAgICAgICAgICAgIGxpc3QucHVzaCgiY2hhaW4gY29va2llIiwgImNvb2tpZSBzdG9ybSIpOwogICAgICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPCAwLjA1ICYmIEdhbWUuc2Vhc29uID09ICJmb29scyIpCiAgICAgICAgICAgIGxpc3QucHVzaCgiZXZlcnl0aGluZyBtdXN0IGdvIik7CiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIE1hdGgucmFuZG9tKCkgPCAwLjEgJiYKICAgICAgICAgICAgKE1hdGgucmFuZG9tKCkgPCAwLjA1IHx8ICFHYW1lLmhhc0J1ZmYoIkRyYWdvbmZsaWdodCIpKQogICAgICAgICAgKQogICAgICAgICAgICBsaXN0LnB1c2goImNsaWNrIGZyZW56eSIpOwogICAgICAgICAgaWYgKG1lLndyYXRoICYmIE1hdGgucmFuZG9tKCkgPCAwLjEpIGxpc3QucHVzaCgiY3Vyc2VkIGZpbmdlciIpOwoKICAgICAgICAgIGlmIChHYW1lLkJ1aWxkaW5nc093bmVkID49IDEwICYmIE1hdGgucmFuZG9tKCkgPCAwLjI1KQogICAgICAgICAgICBsaXN0LnB1c2goImJ1aWxkaW5nIHNwZWNpYWwiKTsKCiAgICAgICAgICBpZiAoR2FtZS5jYW5MdW1wcygpICYmIE1hdGgucmFuZG9tKCkgPCAwLjAwMDUpCiAgICAgICAgICAgIGxpc3QucHVzaCgiZnJlZSBzdWdhciBsdW1wIik7CgogICAgICAgICAgaWYgKChtZS53cmF0aCA9PSAwICYmIE1hdGgucmFuZG9tKCkgPCAwLjE1KSB8fCBNYXRoLnJhbmRvbSgpIDwgMC4wNSkgewogICAgICAgICAgICAvL2lmIChHYW1lLmhhc0F1cmEoJ1JlYXBlciBvZiBGaWVsZHMnKSkgbGlzdC5wdXNoKCdkcmFnb24gaGFydmVzdCcpOwogICAgICAgICAgICBpZiAoTWF0aC5yYW5kb20oKSA8IEdhbWUuYXVyYU11bHQoIlJlYXBlciBvZiBGaWVsZHMiKSkKICAgICAgICAgICAgICBsaXN0LnB1c2goImRyYWdvbiBoYXJ2ZXN0Iik7CiAgICAgICAgICAgIC8vaWYgKEdhbWUuaGFzQXVyYSgnRHJhZ29uZmxpZ2h0JykpIGxpc3QucHVzaCgnZHJhZ29uZmxpZ2h0Jyk7CiAgICAgICAgICAgIGlmIChNYXRoLnJhbmRvbSgpIDwgR2FtZS5hdXJhTXVsdCgiRHJhZ29uZmxpZ2h0IikpCiAgICAgICAgICAgICAgbGlzdC5wdXNoKCJkcmFnb25mbGlnaHQiKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIHRoaXMubGFzdCAhPSAiIiAmJgogICAgICAgICAgICBNYXRoLnJhbmRvbSgpIDwgMC44ICYmCiAgICAgICAgICAgIGxpc3QuaW5kZXhPZih0aGlzLmxhc3QpICE9IC0xCiAgICAgICAgICApCiAgICAgICAgICAgIGxpc3Quc3BsaWNlKGxpc3QuaW5kZXhPZih0aGlzLmxhc3QpLCAxKTsgLy84MCUgY2hhbmNlIHRvIGZvcmNlIGEgZGlmZmVyZW50IG9uZQogICAgICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPCAwLjAwMDEpIGxpc3QucHVzaCgiYmxhYiIpOwogICAgICAgICAgdmFyIGNob2ljZSA9IGNob29zZShsaXN0KTsKCiAgICAgICAgICBpZiAodGhpcy5jaGFpbiA+IDApIGNob2ljZSA9ICJjaGFpbiBjb29raWUiOwogICAgICAgICAgaWYgKG1lLmZvcmNlICE9ICIiKSB7CiAgICAgICAgICAgIHRoaXMuY2hhaW4gPSAwOwogICAgICAgICAgICBjaG9pY2UgPSBtZS5mb3JjZTsKICAgICAgICAgICAgbWUuZm9yY2UgPSAiIjsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChjaG9pY2UgIT0gImNoYWluIGNvb2tpZSIpIHRoaXMuY2hhaW4gPSAwOwoKICAgICAgICAgIHRoaXMubGFzdCA9IGNob2ljZTsKCiAgICAgICAgICAvL2NyZWF0ZSBidWZmIGZvciBlZmZlY3QKICAgICAgICAgIC8vYnVmZiBkdXJhdGlvbiBtdWx0aXBsaWVyCiAgICAgICAgICB2YXIgZWZmZWN0RHVyTW9kID0gMTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiR2V0IGx1Y2t5IikpIGVmZmVjdER1ck1vZCAqPSAyOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJMYXN0aW5nIGZvcnR1bmUiKSkgZWZmZWN0RHVyTW9kICo9IDEuMTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiTHVja3kgZGlnaXQiKSkgZWZmZWN0RHVyTW9kICo9IDEuMDE7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIkx1Y2t5IG51bWJlciIpKSBlZmZlY3REdXJNb2QgKj0gMS4wMTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiR3JlZW4geWVhc3QgZGlnZXN0aXZlcyIpKSBlZmZlY3REdXJNb2QgKj0gMS4wMTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiTHVja3kgcGF5b3V0IikpIGVmZmVjdER1ck1vZCAqPSAxLjAxOwogICAgICAgICAgLy9pZiAoR2FtZS5oYXNBdXJhKCdFcG9jaCBNYW5pcHVsYXRvcicpKSBlZmZlY3REdXJNb2QqPTEuMDU7CiAgICAgICAgICBlZmZlY3REdXJNb2QgKj0gMSArIEdhbWUuYXVyYU11bHQoIkVwb2NoIE1hbmlwdWxhdG9yIikgKiAwLjA1OwogICAgICAgICAgaWYgKCFtZS53cmF0aCkgZWZmZWN0RHVyTW9kICo9IEdhbWUuZWZmKCJnb2xkZW5Db29raWVFZmZEdXIiKTsKICAgICAgICAgIGVsc2UgZWZmZWN0RHVyTW9kICo9IEdhbWUuZWZmKCJ3cmF0aENvb2tpZUVmZkR1ciIpOwoKICAgICAgICAgIGlmIChHYW1lLmhhc0dvZCkgewogICAgICAgICAgICB2YXIgZ29kTHZsID0gR2FtZS5oYXNHb2QoImRlY2FkZW5jZSIpOwogICAgICAgICAgICBpZiAoZ29kTHZsID09IDEpIGVmZmVjdER1ck1vZCAqPSAxLjA3OwogICAgICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMikgZWZmZWN0RHVyTW9kICo9IDEuMDU7CiAgICAgICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAzKSBlZmZlY3REdXJNb2QgKj0gMS4wMjsKICAgICAgICAgIH0KCiAgICAgICAgICAvL2VmZmVjdCBtdWx0aXBsaWVyIChmcm9tIGx1Y2t5IGV0YykKICAgICAgICAgIHZhciBtdWx0ID0gMTsKICAgICAgICAgIC8vaWYgKG1lLndyYXRoPjAgJiYgR2FtZS5oYXNBdXJhKCdVbmhvbHkgRG9taW5pb24nKSkgbXVsdCo9MS4xOwogICAgICAgICAgLy9lbHNlIGlmIChtZS53cmF0aD09MCAmJiBHYW1lLmhhc0F1cmEoJ0FuY2VzdHJhbCBNZXRhbW9ycGhvc2lzJykpIG11bHQqPTEuMTsKICAgICAgICAgIGlmIChtZS53cmF0aCA+IDApIG11bHQgKj0gMSArIEdhbWUuYXVyYU11bHQoIlVuaG9seSBEb21pbmlvbiIpICogMC4xOwogICAgICAgICAgZWxzZSBpZiAobWUud3JhdGggPT0gMCkKICAgICAgICAgICAgbXVsdCAqPSAxICsgR2FtZS5hdXJhTXVsdCgiQW5jZXN0cmFsIE1ldGFtb3JwaG9zaXMiKSAqIDAuMTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiR3JlZW4geWVhc3QgZGlnZXN0aXZlcyIpKSBtdWx0ICo9IDEuMDE7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIkRyYWdvbiBmYW5nIikpIG11bHQgKj0gMS4wMzsKICAgICAgICAgIGlmICghbWUud3JhdGgpIG11bHQgKj0gR2FtZS5lZmYoImdvbGRlbkNvb2tpZUdhaW4iKTsKICAgICAgICAgIGVsc2UgbXVsdCAqPSBHYW1lLmVmZigid3JhdGhDb29raWVHYWluIik7CgogICAgICAgICAgdmFyIHBvcHVwID0gIiI7CiAgICAgICAgICB2YXIgYnVmZiA9IDA7CgogICAgICAgICAgaWYgKGNob2ljZSA9PSAiYnVpbGRpbmcgc3BlY2lhbCIpIHsKICAgICAgICAgICAgdmFyIHRpbWUgPSBNYXRoLmNlaWwoMzAgKiBlZmZlY3REdXJNb2QpOwogICAgICAgICAgICB2YXIgbGlzdCA9IFtdOwogICAgICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0cykgewogICAgICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbaV0uYW1vdW50ID49IDEwKSBsaXN0LnB1c2goR2FtZS5PYmplY3RzW2ldLmlkKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAobGlzdC5sZW5ndGggPT0gMCkgewogICAgICAgICAgICAgIGNob2ljZSA9ICJmcmVuenkiOwogICAgICAgICAgICB9IC8vZGVmYXVsdCB0byBmcmVuenkgaWYgbm8gcHJvcGVyIGJ1aWxkaW5nCiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgIHZhciBvYmogPSBjaG9vc2UobGlzdCk7CiAgICAgICAgICAgICAgdmFyIHBvdyA9IEdhbWUuT2JqZWN0c0J5SWRbb2JqXS5hbW91bnQgLyAxMCArIDE7CiAgICAgICAgICAgICAgaWYgKG1lLndyYXRoICYmIE1hdGgucmFuZG9tKCkgPCAwLjMpIHsKICAgICAgICAgICAgICAgIGJ1ZmYgPSBHYW1lLmdhaW5CdWZmKCJidWlsZGluZyBkZWJ1ZmYiLCB0aW1lLCBwb3csIG9iaik7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGJ1ZmYgPSBHYW1lLmdhaW5CdWZmKCJidWlsZGluZyBidWZmIiwgdGltZSwgcG93LCBvYmopOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGlmIChjaG9pY2UgPT0gImZyZWUgc3VnYXIgbHVtcCIpIHsKICAgICAgICAgICAgR2FtZS5nYWluTHVtcHMoMSk7CiAgICAgICAgICAgIHBvcHVwID0gbG9jKCJTd2VldCE8YnI+PHNtYWxsPkZvdW5kIDEgc3VnYXIgbHVtcCE8L3NtYWxsPiIpOwogICAgICAgICAgfSBlbHNlIGlmIChjaG9pY2UgPT0gImZyZW56eSIpIHsKICAgICAgICAgICAgYnVmZiA9IEdhbWUuZ2FpbkJ1ZmYoImZyZW56eSIsIE1hdGguY2VpbCg3NyAqIGVmZmVjdER1ck1vZCksIDcpOwogICAgICAgICAgfSBlbHNlIGlmIChjaG9pY2UgPT0gImRyYWdvbiBoYXJ2ZXN0IikgewogICAgICAgICAgICBidWZmID0gR2FtZS5nYWluQnVmZigKICAgICAgICAgICAgICAiZHJhZ29uIGhhcnZlc3QiLAogICAgICAgICAgICAgIE1hdGguY2VpbCg2MCAqIGVmZmVjdER1ck1vZCksCiAgICAgICAgICAgICAgMTUKICAgICAgICAgICAgKTsKICAgICAgICAgIH0gZWxzZSBpZiAoY2hvaWNlID09ICJldmVyeXRoaW5nIG11c3QgZ28iKSB7CiAgICAgICAgICAgIGJ1ZmYgPSBHYW1lLmdhaW5CdWZmKAogICAgICAgICAgICAgICJldmVyeXRoaW5nIG11c3QgZ28iLAogICAgICAgICAgICAgIE1hdGguY2VpbCg4ICogZWZmZWN0RHVyTW9kKSwKICAgICAgICAgICAgICA1CiAgICAgICAgICAgICk7CiAgICAgICAgICB9IGVsc2UgaWYgKGNob2ljZSA9PSAibXVsdGlwbHkgY29va2llcyIpIHsKICAgICAgICAgICAgdmFyIG1vbmkgPQogICAgICAgICAgICAgIG11bHQgKiBNYXRoLm1pbihHYW1lLmNvb2tpZXMgKiAwLjE1LCBHYW1lLmNvb2tpZXNQcyAqIDYwICogMTUpICsKICAgICAgICAgICAgICAxMzsgLy9hZGQgMTUlIHRvIGNvb2tpZXMgb3duZWQgKCsxMyksIG9yIDE1IG1pbnV0ZXMgb2YgY29va2llIHByb2R1Y3Rpb24gLSB3aGljaGV2ZXIgaXMgbG93ZXN0CiAgICAgICAgICAgIEdhbWUuRWFybihtb25pKTsKICAgICAgICAgICAgcG9wdXAgPQogICAgICAgICAgICAgIGxvYygiTHVja3khIikgKwogICAgICAgICAgICAgICI8YnI+PHNtYWxsPiIgKwogICAgICAgICAgICAgIGxvYygiKyUxISIsIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KG1vbmkpKSkgKwogICAgICAgICAgICAgICI8L3NtYWxsPiI7CiAgICAgICAgICB9IGVsc2UgaWYgKGNob2ljZSA9PSAicnVpbiBjb29raWVzIikgewogICAgICAgICAgICB2YXIgbW9uaSA9CiAgICAgICAgICAgICAgTWF0aC5taW4oR2FtZS5jb29raWVzICogMC4wNSwgR2FtZS5jb29raWVzUHMgKiA2MCAqIDEwKSArIDEzOyAvL2xvc2UgNSUgb2YgY29va2llcyBvd25lZCAoLTEzKSwgb3IgMTAgbWludXRlcyBvZiBjb29raWUgcHJvZHVjdGlvbiAtIHdoaWNoZXZlciBpcyBsb3dlc3QKICAgICAgICAgICAgbW9uaSA9IE1hdGgubWluKEdhbWUuY29va2llcywgbW9uaSk7CiAgICAgICAgICAgIEdhbWUuU3BlbmQobW9uaSk7CiAgICAgICAgICAgIHBvcHVwID0KICAgICAgICAgICAgICBsb2MoIlJ1aW4hIikgKwogICAgICAgICAgICAgICI8YnI+PHNtYWxsPiIgKwogICAgICAgICAgICAgIGxvYygiTG9zdCAlMSEiLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeShtb25pKSkpICsKICAgICAgICAgICAgICAiPC9zbWFsbD4iOwogICAgICAgICAgfSBlbHNlIGlmIChjaG9pY2UgPT0gImJsb29kIGZyZW56eSIpIHsKICAgICAgICAgICAgYnVmZiA9IEdhbWUuZ2FpbkJ1ZmYoCiAgICAgICAgICAgICAgImJsb29kIGZyZW56eSIsCiAgICAgICAgICAgICAgTWF0aC5jZWlsKDYgKiBlZmZlY3REdXJNb2QpLAogICAgICAgICAgICAgIDY2NgogICAgICAgICAgICApOwogICAgICAgICAgfSBlbHNlIGlmIChjaG9pY2UgPT0gImNsb3QiKSB7CiAgICAgICAgICAgIGJ1ZmYgPSBHYW1lLmdhaW5CdWZmKCJjbG90IiwgTWF0aC5jZWlsKDY2ICogZWZmZWN0RHVyTW9kKSwgMC41KTsKICAgICAgICAgIH0gZWxzZSBpZiAoY2hvaWNlID09ICJjdXJzZWQgZmluZ2VyIikgewogICAgICAgICAgICBidWZmID0gR2FtZS5nYWluQnVmZigKICAgICAgICAgICAgICAiY3Vyc2VkIGZpbmdlciIsCiAgICAgICAgICAgICAgTWF0aC5jZWlsKDEwICogZWZmZWN0RHVyTW9kKSwKICAgICAgICAgICAgICBHYW1lLmNvb2tpZXNQcyAqIE1hdGguY2VpbCgxMCAqIGVmZmVjdER1ck1vZCkKICAgICAgICAgICAgKTsKICAgICAgICAgIH0gZWxzZSBpZiAoY2hvaWNlID09ICJjbGljayBmcmVuenkiKSB7CiAgICAgICAgICAgIGJ1ZmYgPSBHYW1lLmdhaW5CdWZmKAogICAgICAgICAgICAgICJjbGljayBmcmVuenkiLAogICAgICAgICAgICAgIE1hdGguY2VpbCgxMyAqIGVmZmVjdER1ck1vZCksCiAgICAgICAgICAgICAgNzc3CiAgICAgICAgICAgICk7CiAgICAgICAgICB9IGVsc2UgaWYgKGNob2ljZSA9PSAiZHJhZ29uZmxpZ2h0IikgewogICAgICAgICAgICBidWZmID0gR2FtZS5nYWluQnVmZigKICAgICAgICAgICAgICAiZHJhZ29uZmxpZ2h0IiwKICAgICAgICAgICAgICBNYXRoLmNlaWwoMTAgKiBlZmZlY3REdXJNb2QpLAogICAgICAgICAgICAgIDExMTEKICAgICAgICAgICAgKTsKICAgICAgICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPCAwLjgpIEdhbWUua2lsbEJ1ZmYoIkNsaWNrIGZyZW56eSIpOwogICAgICAgICAgfSBlbHNlIGlmIChjaG9pY2UgPT0gImNoYWluIGNvb2tpZSIpIHsKICAgICAgICAgICAgLy9maXggYnkgSWNlaGF3azc4CiAgICAgICAgICAgIGlmICh0aGlzLmNoYWluID09IDApIHRoaXMudG90YWxGcm9tQ2hhaW4gPSAwOwogICAgICAgICAgICB0aGlzLmNoYWluKys7CiAgICAgICAgICAgIHZhciBkaWdpdCA9IG1lLndyYXRoID8gNiA6IDc7CiAgICAgICAgICAgIGlmICh0aGlzLmNoYWluID09IDEpCiAgICAgICAgICAgICAgdGhpcy5jaGFpbiArPSBNYXRoLm1heCgKICAgICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgICBNYXRoLmNlaWwoTWF0aC5sb2coR2FtZS5jb29raWVzKSAvIE1hdGguTE4xMCkgLSAxMAogICAgICAgICAgICAgICk7CgogICAgICAgICAgICB2YXIgbWF4UGF5b3V0ID0KICAgICAgICAgICAgICBNYXRoLm1pbihHYW1lLmNvb2tpZXNQcyAqIDYwICogNjAgKiA2LCBHYW1lLmNvb2tpZXMgKiAwLjUpICogbXVsdDsKICAgICAgICAgICAgdmFyIG1vbmkgPSBNYXRoLm1heCgKICAgICAgICAgICAgICBkaWdpdCwKICAgICAgICAgICAgICBNYXRoLm1pbigKICAgICAgICAgICAgICAgIE1hdGguZmxvb3IoKDEgLyA5KSAqIE1hdGgucG93KDEwLCB0aGlzLmNoYWluKSAqIGRpZ2l0ICogbXVsdCksCiAgICAgICAgICAgICAgICBtYXhQYXlvdXQKICAgICAgICAgICAgICApCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHZhciBuZXh0TW9uaSA9IE1hdGgubWF4KAogICAgICAgICAgICAgIGRpZ2l0LAogICAgICAgICAgICAgIE1hdGgubWluKAogICAgICAgICAgICAgICAgTWF0aC5mbG9vcigKICAgICAgICAgICAgICAgICAgKDEgLyA5KSAqIE1hdGgucG93KDEwLCB0aGlzLmNoYWluICsgMSkgKiBkaWdpdCAqIG11bHQKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBtYXhQYXlvdXQKICAgICAgICAgICAgICApCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHRoaXMudG90YWxGcm9tQ2hhaW4gKz0gbW9uaTsKCiAgICAgICAgICAgIC8vYnJlYWsgdGhlIGNoYWluIGlmIHdlJ3JlIGFib3ZlIDUgZGlnaXRzIEFORCBpdCdzIG1vcmUgdGhhbiA1MCUgb2Ygb3VyIGJhbmssIGl0IGdyYW50cyBtb3JlIHRoYW4gNiBob3VycyBvZiBvdXIgQ3BTLCBvciBqdXN0IGEgMSUgY2hhbmNlIGVhY2ggZGlnaXQgKHVwZGF0ZSA6IHJlbW92ZWQgZGlnaXQgbGltaXQpCiAgICAgICAgICAgIGlmIChNYXRoLnJhbmRvbSgpIDwgMC4wMSB8fCBuZXh0TW9uaSA+PSBtYXhQYXlvdXQpIHsKICAgICAgICAgICAgICB0aGlzLmNoYWluID0gMDsKICAgICAgICAgICAgICBwb3B1cCA9CiAgICAgICAgICAgICAgICBsb2MoIkNvb2tpZSBjaGFpbiIpICsKICAgICAgICAgICAgICAgICI8YnI+PHNtYWxsPiIgKwogICAgICAgICAgICAgICAgbG9jKCIrJTEhIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkobW9uaSkpKSArCiAgICAgICAgICAgICAgICAiPGJyPiIgKwogICAgICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICAgICAiQ29va2llIGNoYWluIG92ZXIuIFlvdSBtYWRlICUxLiIsCiAgICAgICAgICAgICAgICAgIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KHRoaXMudG90YWxGcm9tQ2hhaW4pKQogICAgICAgICAgICAgICAgKSArCiAgICAgICAgICAgICAgICAiPC9zbWFsbD4iOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHBvcHVwID0KICAgICAgICAgICAgICAgIGxvYygiQ29va2llIGNoYWluIikgKwogICAgICAgICAgICAgICAgIjxicj48c21hbGw+IiArCiAgICAgICAgICAgICAgICBsb2MoIislMSEiLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeShtb25pKSkpICsKICAgICAgICAgICAgICAgICI8L3NtYWxsPiI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgR2FtZS5FYXJuKG1vbmkpOwogICAgICAgICAgfSBlbHNlIGlmIChjaG9pY2UgPT0gImNvb2tpZSBzdG9ybSIpIHsKICAgICAgICAgICAgYnVmZiA9IEdhbWUuZ2FpbkJ1ZmYoCiAgICAgICAgICAgICAgImNvb2tpZSBzdG9ybSIsCiAgICAgICAgICAgICAgTWF0aC5jZWlsKDcgKiBlZmZlY3REdXJNb2QpLAogICAgICAgICAgICAgIDcKICAgICAgICAgICAgKTsKICAgICAgICAgIH0gZWxzZSBpZiAoY2hvaWNlID09ICJjb29raWUgc3Rvcm0gZHJvcCIpIHsKICAgICAgICAgICAgdmFyIG1vbmkgPSBNYXRoLm1heCgKICAgICAgICAgICAgICBtdWx0ICogKEdhbWUuY29va2llc1BzICogNjAgKiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3ICsgMSkpLAogICAgICAgICAgICAgIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcgKyAxKQogICAgICAgICAgICApOyAvL2VpdGhlciAxLTcgY29va2llcyBvciAxLTcgbWludXRlcyBvZiBjb29raWUgcHJvZHVjdGlvbiwgd2hpY2hldmVyIGlzIGhpZ2hlc3QKICAgICAgICAgICAgR2FtZS5FYXJuKG1vbmkpOwogICAgICAgICAgICBwb3B1cCA9CiAgICAgICAgICAgICAgJzxkaXYgc3R5bGU9ImZvbnQtc2l6ZTo3NSU7Ij4nICsKICAgICAgICAgICAgICBsb2MoIislMSEiLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeShtb25pKSkpICsKICAgICAgICAgICAgICAiPC9kaXY+IjsKICAgICAgICAgIH0gZWxzZSBpZiAoY2hvaWNlID09ICJibGFiIikgewogICAgICAgICAgICAvL3NvcnJ5IChpdCdzIHJlYWxseSByYXJlKQogICAgICAgICAgICB2YXIgc3RyID0gRU4KICAgICAgICAgICAgICA/IGNob29zZShbCiAgICAgICAgICAgICAgICAgICJDb29raWUgY3J1bWJsaW5lc3MgeDMgZm9yIDYwIHNlY29uZHMhIiwKICAgICAgICAgICAgICAgICAgIkNob2NvbGF0aW5lc3MgeDcgZm9yIDc3IHNlY29uZHMhIiwKICAgICAgICAgICAgICAgICAgIkRvdWdoIGVsYXN0aWNpdHkgaGFsdmVkIGZvciA2NiBzZWNvbmRzISIsCiAgICAgICAgICAgICAgICAgICJHb2xkZW4gY29va2llIHNoaW5pbmVzcyBkb3VibGVkIGZvciAzIHNlY29uZHMhIiwKICAgICAgICAgICAgICAgICAgIldvcmxkIGVjb25vbXkgaGFsdmVkIGZvciAzMCBzZWNvbmRzISIsCiAgICAgICAgICAgICAgICAgICJHcmFuZG1hIGtpc3NlcyAyMyUgc3RpbmdpZXIgZm9yIDQ1IHNlY29uZHMhIiwKICAgICAgICAgICAgICAgICAgIlRoYW5rcyBmb3IgY2xpY2tpbmchIiwKICAgICAgICAgICAgICAgICAgIkZvb2xlZCB5b3UhIFRoaXMgb25lIHdhcyBqdXN0IGEgdGVzdC4iLAogICAgICAgICAgICAgICAgICAiR29sZGVuIGNvb2tpZXMgY2xpY2tlZCArMSEiLAogICAgICAgICAgICAgICAgICAiWW91ciBjbGljayBoYXMgYmVlbiByZWdpc3RlcmVkLiBUaGFuayB5b3UgZm9yIHlvdXIgY29vcGVyYXRpb24uIiwKICAgICAgICAgICAgICAgICAgIlRoYW5rcyEgVGhhdCBoaXQgdGhlIHNwb3QhIiwKICAgICAgICAgICAgICAgICAgIlRoYW5rIHlvdS4gQSB0ZWFtIGhhcyBiZWVuIGRpc3BhdGNoZWQuIiwKICAgICAgICAgICAgICAgICAgIlRoZXkga25vdy4iLAogICAgICAgICAgICAgICAgICAiT29wcy4gVGhpcyB3YXMganVzdCBhIGNob2NvbGF0ZSBjb29raWUgd2l0aCBzaGlueSBhbHVtaW5pdW0gZm9pbC4iLAogICAgICAgICAgICAgICAgICAiRXNjaGF0b24gaW1tYW5lbnRpemVkISIsCiAgICAgICAgICAgICAgICAgICJPaCwgdGhhdCB0aWNrbGVkISIsCiAgICAgICAgICAgICAgICAgICJBZ2Fpbi4iLAogICAgICAgICAgICAgICAgICAiWW91J3ZlIG1hZGUgYSBncmF2ZSBtaXN0YWtlLiIsCiAgICAgICAgICAgICAgICAgICJDaG9jb2xhdGUgY2hpcHMgcmVzaHVmZmxlZCEiLAogICAgICAgICAgICAgICAgICAiUmFuZG9taXplZCBjaGFuY2UgY2FyZCBvdXRjb21lISIsCiAgICAgICAgICAgICAgICAgICJNb3VzZSBhY2NlbGVyYXRpb24gKzAuMDMlISIsCiAgICAgICAgICAgICAgICAgICJBc2NlbnNpb24gYm9udXNlcyB4NSwwMDAgZm9yIDAuMSBzZWNvbmRzISIsCiAgICAgICAgICAgICAgICAgICJHYWluZWQgMSBleHRyYSEiLAogICAgICAgICAgICAgICAgICAiU29ycnksIGJldHRlciBsdWNrIG5leHQgdGltZSEiLAogICAgICAgICAgICAgICAgICAiSSBmZWx0IHRoYXQuIiwKICAgICAgICAgICAgICAgICAgIk5pY2UgdHJ5LCBidXQgbm8uIiwKICAgICAgICAgICAgICAgICAgIldhaXQsIHNvcnJ5LCBJIHdhc24ndCByZWFkeSB5ZXQuIiwKICAgICAgICAgICAgICAgICAgIllpcHBlZSEiLAogICAgICAgICAgICAgICAgICAiQm9uZXMgcmVtb3ZlZC4iLAogICAgICAgICAgICAgICAgICAiT3JnYW5zIGFkZGVkLiIsCiAgICAgICAgICAgICAgICAgICJEaWQgeW91IGp1c3QgY2xpY2sgdGhhdD8iLAogICAgICAgICAgICAgICAgICAiSHVoPyBPaCwgdGhlcmUgd2FzIG5vdGhpbmcgdGhlcmUuIiwKICAgICAgICAgICAgICAgICAgIllvdSBzYXcgbm90aGluZy4iLAogICAgICAgICAgICAgICAgICAiSXQgc2VlbXMgeW91IGhhbGx1Y2luYXRlZCB0aGF0IGdvbGRlbiBjb29raWUuIiwKICAgICAgICAgICAgICAgICAgIlRoaXMgZ29sZGVuIGNvb2tpZSB3YXMgYSBjb21wbGV0ZSBmYWJyaWNhdGlvbi4iLAogICAgICAgICAgICAgICAgICAiSW4gdGhlb3J5IHRoZXJlJ3Mgbm8gd3Jvbmcgd2F5IHRvIGNsaWNrIGEgZ29sZGVuIGNvb2tpZSwgYnV0IHlvdSBqdXN0IGRpZCB0aGF0LCBzb21laG93LiIsCiAgICAgICAgICAgICAgICAgICJBbGwgY29va2llcyBtdWx0aXBsaWVkIGJ5IDk5OSE8YnI+QWxsIGNvb2tpZXMgZGl2aWRlZCBieSA5OTkhIiwKICAgICAgICAgICAgICAgICAgIldoeT8iLAogICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICA6IGNob29zZShsb2MoIkNvb2tpZSBibGFiIikpOwogICAgICAgICAgICBwb3B1cCA9IHN0cjsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAocG9wdXAgPT0gIiIgJiYgYnVmZiAmJiBidWZmLm5hbWUgJiYgYnVmZi5kZXNjKQogICAgICAgICAgICBwb3B1cCA9CiAgICAgICAgICAgICAgYnVmZi5kbmFtZSArCiAgICAgICAgICAgICAgJzxkaXYgc3R5bGU9ImZvbnQtc2l6ZTo2NSU7Ij4nICsKICAgICAgICAgICAgICBidWZmLmRlc2MgKwogICAgICAgICAgICAgICI8L2Rpdj4iOwogICAgICAgICAgaWYgKHBvcHVwICE9ICIiKSBHYW1lLlBvcHVwKHBvcHVwLCBtZS54ICsgbWUubC5vZmZzZXRXaWR0aCAvIDIsIG1lLnkpOwoKICAgICAgICAgIEdhbWUuRHJvcEVnZygwLjkpOwoKICAgICAgICAgIC8vc3BhcmtsZSBhbmQga2lsbCB0aGUgc2hpbW1lcgogICAgICAgICAgR2FtZS5TcGFya2xlQXQobWUueCArIDQ4LCBtZS55ICsgNDgpOwogICAgICAgICAgaWYgKGNob2ljZSA9PSAiY29va2llIHN0b3JtIGRyb3AiKSB7CiAgICAgICAgICAgIGlmIChHYW1lLnByZWZzLmNvb2tpZXNvdW5kKQogICAgICAgICAgICAgIFBsYXlTb3VuZCgKICAgICAgICAgICAgICAgICJzbmQvY2xpY2tiIiArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcgKyAxKSArICIubXAzIiwKICAgICAgICAgICAgICAgIDAuNzUKICAgICAgICAgICAgICApOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgUGxheVNvdW5kKAogICAgICAgICAgICAgICAgInNuZC9jbGljayIgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3ICsgMSkgKyAiLm1wMyIsCiAgICAgICAgICAgICAgICAwLjc1CiAgICAgICAgICAgICAgKTsKICAgICAgICAgIH0gZWxzZSBQbGF5U291bmQoInNuZC9zaGltbWVyQ2xpY2subXAzIik7CiAgICAgICAgICBtZS5kaWUoKTsKICAgICAgICB9LAogICAgICAgIG1pc3NGdW5jOiBmdW5jdGlvbiAobWUpIHsKICAgICAgICAgIGlmICh0aGlzLmNoYWluID4gMCAmJiB0aGlzLnRvdGFsRnJvbUNoYWluID4gMCkgewogICAgICAgICAgICBHYW1lLlBvcHVwKAogICAgICAgICAgICAgIGxvYygKICAgICAgICAgICAgICAgICJDb29raWUgY2hhaW4gYnJva2VuLjxicj48c21hbGw+WW91IG1hZGUgJTEuPC9zbWFsbD4iLAogICAgICAgICAgICAgICAgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkodGhpcy50b3RhbEZyb21DaGFpbikpCiAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICBtZS54ICsgbWUubC5vZmZzZXRXaWR0aCAvIDIsCiAgICAgICAgICAgICAgbWUueQogICAgICAgICAgICApOwogICAgICAgICAgICB0aGlzLmNoYWluID0gMDsKICAgICAgICAgICAgdGhpcy50b3RhbEZyb21DaGFpbiA9IDA7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAobWUuc3Bhd25MZWFkKSBHYW1lLm1pc3NlZEdvbGRlbkNsaWNrcysrOwogICAgICAgIH0sCiAgICAgICAgc3Bhd25zT25UaW1lcjogdHJ1ZSwKICAgICAgICBzcGF3bkNvbmRpdGlvbnM6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGlmICghR2FtZS5IYXMoIkdvbGRlbiBzd2l0Y2ggW29mZl0iKSkgcmV0dXJuIHRydWU7CiAgICAgICAgICBlbHNlIHJldHVybiBmYWxzZTsKICAgICAgICB9LAogICAgICAgIHNwYXduZWQ6IDAsCiAgICAgICAgdGltZTogMCwKICAgICAgICBtaW5UaW1lOiAwLAogICAgICAgIG1heFRpbWU6IDAsCiAgICAgICAgZ2V0VGltZU1vZDogZnVuY3Rpb24gKG1lLCBtKSB7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIkx1Y2t5IGRheSIpKSBtIC89IDI7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIlNlcmVuZGlwaXR5IikpIG0gLz0gMjsKICAgICAgICAgIGlmIChHYW1lLkhhcygiR29sZGVuIGdvb3NlIGVnZyIpKSBtICo9IDAuOTU7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIkhlYXZlbmx5IGx1Y2siKSkgbSAqPSAwLjk1OwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJHcmVlbiB5ZWFzdCBkaWdlc3RpdmVzIikpIG0gKj0gMC45OTsKICAgICAgICAgIC8vaWYgKEdhbWUuaGFzQXVyYSgnQXJjYW5lIEF1cmEnKSkgbSo9MC45NTsKICAgICAgICAgIG0gKj0gMSAtIEdhbWUuYXVyYU11bHQoIkFyY2FuZSBBdXJhIikgKiAwLjA1OwogICAgICAgICAgaWYgKEdhbWUuaGFzQnVmZigiU3VnYXIgYmxlc3NpbmciKSkgbSAqPSAwLjk7CiAgICAgICAgICBpZiAoR2FtZS5zZWFzb24gPT0gImVhc3RlciIgJiYgR2FtZS5IYXMoIlN0YXJzcGF3biIpKSBtICo9IDAuOTg7CiAgICAgICAgICBlbHNlIGlmIChHYW1lLnNlYXNvbiA9PSAiaGFsbG93ZWVuIiAmJiBHYW1lLkhhcygiU3RhcnRlcnJvciIpKQogICAgICAgICAgICBtICo9IDAuOTg7CiAgICAgICAgICBlbHNlIGlmIChHYW1lLnNlYXNvbiA9PSAidmFsZW50aW5lcyIgJiYgR2FtZS5IYXMoIlN0YXJsb3ZlIikpCiAgICAgICAgICAgIG0gKj0gMC45ODsKICAgICAgICAgIGVsc2UgaWYgKEdhbWUuc2Vhc29uID09ICJmb29scyIgJiYgR2FtZS5IYXMoIlN0YXJ0cmFkZSIpKSBtICo9IDAuOTU7CiAgICAgICAgICBpZiAoIW1lLndyYXRoKSBtICo9IDEgLyBHYW1lLmVmZigiZ29sZGVuQ29va2llRnJlcSIpOwogICAgICAgICAgZWxzZSBtICo9IDEgLyBHYW1lLmVmZigid3JhdGhDb29raWVGcmVxIik7CiAgICAgICAgICBpZiAoR2FtZS5oYXNHb2QpIHsKICAgICAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJpbmR1c3RyeSIpOwogICAgICAgICAgICBpZiAoZ29kTHZsID09IDEpIG0gKj0gMS4xOwogICAgICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMikgbSAqPSAxLjA2OwogICAgICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMykgbSAqPSAxLjAzOwogICAgICAgICAgICB2YXIgZ29kTHZsID0gR2FtZS5oYXNHb2QoIm1vdGhlciIpOwogICAgICAgICAgICBpZiAoZ29kTHZsID09IDEpIG0gKj0gMS4xNTsKICAgICAgICAgICAgZWxzZSBpZiAoZ29kTHZsID09IDIpIG0gKj0gMS4xOwogICAgICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMykgbSAqPSAxLjA1OwoKICAgICAgICAgICAgaWYgKEdhbWUuc2Vhc29uICE9ICIiKSB7CiAgICAgICAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJzZWFzb25zIik7CiAgICAgICAgICAgICAgaWYgKEdhbWUuc2Vhc29uICE9ICJmb29scyIpIHsKICAgICAgICAgICAgICAgIGlmIChnb2RMdmwgPT0gMSkgbSAqPSAwLjk3OwogICAgICAgICAgICAgICAgZWxzZSBpZiAoZ29kTHZsID09IDIpIG0gKj0gMC45ODsKICAgICAgICAgICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAzKSBtICo9IDAuOTk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlmIChnb2RMdmwgPT0gMSkgbSAqPSAwLjk1NTsKICAgICAgICAgICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAyKSBtICo9IDAuOTc7CiAgICAgICAgICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMykgbSAqPSAwLjk4NTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGlmICh0aGlzLmNoYWluID4gMCkgbSA9IDAuMDU7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIkdvbGQgaG9hcmQiKSkgbSA9IDAuMDE7CiAgICAgICAgICByZXR1cm4gTWF0aC5jZWlsKEdhbWUuZnBzICogNjAgKiBtKTsKICAgICAgICB9LAogICAgICAgIGdldE1pblRpbWU6IGZ1bmN0aW9uIChtZSkgewogICAgICAgICAgdmFyIG0gPSA1OwogICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VGltZU1vZChtZSwgbSk7CiAgICAgICAgfSwKICAgICAgICBnZXRNYXhUaW1lOiBmdW5jdGlvbiAobWUpIHsKICAgICAgICAgIHZhciBtID0gMTU7CiAgICAgICAgICByZXR1cm4gdGhpcy5nZXRUaW1lTW9kKG1lLCBtKTsKICAgICAgICB9LAogICAgICAgIGxhc3Q6ICIiLAogICAgICB9LAogICAgICByZWluZGVlcjogewogICAgICAgIHJlc2V0OiBmdW5jdGlvbiAoKSB7fSwKICAgICAgICBpbml0RnVuYzogZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgICBpZiAoIXRoaXMuc3Bhd25lZCAmJiBHYW1lLmNoaW1lVHlwZSAhPSAwICYmIEdhbWUuYXNjZW5zaW9uTW9kZSAhPSAxKQogICAgICAgICAgICBQbGF5U291bmQoInNuZC9qaW5nbGUubXAzIik7CgogICAgICAgICAgbWUueCA9IC0xMjg7CiAgICAgICAgICBtZS55ID0KICAgICAgICAgICAgTWF0aC5mbG9vcigKICAgICAgICAgICAgICBNYXRoLnJhbmRvbSgpICoKICAgICAgICAgICAgICAgIE1hdGgubWF4KDAsIEdhbWUuYm91bmRzLmJvdHRvbSAtIEdhbWUuYm91bmRzLnRvcCAtIDI1NikgKwogICAgICAgICAgICAgICAgR2FtZS5ib3VuZHMudG9wICsKICAgICAgICAgICAgICAgIDEyOAogICAgICAgICAgICApIC0gMTI4OwogICAgICAgICAgLy9tZS5sLnN0eWxlLmxlZnQ9bWUueCsncHgnOwogICAgICAgICAgLy9tZS5sLnN0eWxlLnRvcD1tZS55KydweCc7CiAgICAgICAgICBtZS5sLnN0eWxlLndpZHRoID0gIjE2N3B4IjsKICAgICAgICAgIG1lLmwuc3R5bGUuaGVpZ2h0ID0gIjIxMnB4IjsKICAgICAgICAgIG1lLmwuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gInVybChpbWcvZnJvc3RlZFJlaW5kZWVyLnBuZykiOwogICAgICAgICAgbWUubC5zdHlsZS5vcGFjaXR5ID0gIjAiOwogICAgICAgICAgLy9tZS5sLnN0eWxlLnRyYW5zZm9ybT0ncm90YXRlKCcrKE1hdGgucmFuZG9tKCkqNjAtMzApKydkZWcpIHNjYWxlKCcrKE1hdGgucmFuZG9tKCkqMSswLjI1KSsnKSc7CiAgICAgICAgICBtZS5sLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICAgICAgbWUubC5zZXRBdHRyaWJ1dGUoImFsdCIsIGxvYygiUmVpbmRlZXIiKSk7CgogICAgICAgICAgbWUubGlmZSA9IDE7IC8vdGhlIHJlaW5kZWVyJ3MgY3VycmVudCBwcm9ncmVzc2lvbiB0aHJvdWdoIGl0cyBsaWZlc3BhbiAoaW4gZnJhbWVzKQogICAgICAgICAgbWUuZHVyID0gNDsgLy9kdXJhdGlvbjsgdGhlIGNvb2tpZSdzIGxpZmVzcGFuIGluIHNlY29uZHMgYmVmb3JlIGl0IGRlc3Bhd25zCgogICAgICAgICAgdmFyIGR1ciA9IDQ7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIldlaWdodGVkIHNsZWlnaHMiKSkgZHVyICo9IDI7CiAgICAgICAgICBkdXIgKj0gR2FtZS5lZmYoInJlaW5kZWVyRHVyIik7CiAgICAgICAgICBtZS5kdXIgPSBkdXI7CiAgICAgICAgICBtZS5saWZlID0gTWF0aC5jZWlsKEdhbWUuZnBzICogbWUuZHVyKTsKICAgICAgICAgIG1lLnNpemVNdWx0ID0gMTsKICAgICAgICB9LAogICAgICAgIHVwZGF0ZUZ1bmM6IGZ1bmN0aW9uIChtZSkgewogICAgICAgICAgdmFyIGN1cnZlID0gMSAtIE1hdGgucG93KChtZS5saWZlIC8gKEdhbWUuZnBzICogbWUuZHVyKSkgKiAyIC0gMSwgMTIpOwogICAgICAgICAgbWUubC5zdHlsZS5vcGFjaXR5ID0gY3VydmU7CiAgICAgICAgICBtZS5sLnN0eWxlLnRyYW5zZm9ybSA9CiAgICAgICAgICAgICJ0cmFuc2xhdGUoIiArCiAgICAgICAgICAgIChtZS54ICsKICAgICAgICAgICAgICAoR2FtZS5ib3VuZHMucmlnaHQgLSBHYW1lLmJvdW5kcy5sZWZ0KSAqCiAgICAgICAgICAgICAgICAoMSAtIG1lLmxpZmUgLyAoR2FtZS5mcHMgKiBtZS5kdXIpKSkgKwogICAgICAgICAgICAicHgsIiArCiAgICAgICAgICAgIChtZS55IC0gTWF0aC5hYnMoTWF0aC5zaW4obWUubGlmZSAqIDAuMSkpICogMTI4KSArCiAgICAgICAgICAgICJweCkgcm90YXRlKCIgKwogICAgICAgICAgICBNYXRoLnNpbihtZS5saWZlICogMC4yICsgMC4zKSAqIDEwICsKICAgICAgICAgICAgImRlZykgc2NhbGUoIiArCiAgICAgICAgICAgIG1lLnNpemVNdWx0ICogKDEgKyBNYXRoLnNpbihtZS5pZCAqIDAuNTMpICogMC4xKSArCiAgICAgICAgICAgICIpIjsKICAgICAgICAgIG1lLmxpZmUtLTsKICAgICAgICAgIGlmIChtZS5saWZlIDw9IDApIHsKICAgICAgICAgICAgdGhpcy5taXNzRnVuYyhtZSk7CiAgICAgICAgICAgIG1lLmRpZSgpOwogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgcG9wRnVuYzogZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgICAvL2dldCBhY2hpZXZzIGFuZCBzdGF0cwogICAgICAgICAgaWYgKG1lLnNwYXduTGVhZCkgewogICAgICAgICAgICBHYW1lLnJlaW5kZWVyQ2xpY2tlZCsrOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciB2YWwgPSBHYW1lLmNvb2tpZXNQcyAqIDYwOwogICAgICAgICAgaWYgKEdhbWUuaGFzQnVmZigiRWxkZXIgZnJlbnp5IikpIHZhbCAqPSAwLjU7IC8vdmVyeSBzb3JyeQogICAgICAgICAgaWYgKEdhbWUuaGFzQnVmZigiRnJlbnp5IikpIHZhbCAqPSAwLjc1OyAvL0kgc2luY2VyZWx5IGFwb2xvZ2l6ZQogICAgICAgICAgdmFyIG1vbmkgPSBNYXRoLm1heCgyNSwgdmFsKTsgLy8xIG1pbnV0ZSBvZiBjb29raWUgcHJvZHVjdGlvbiwgb3IgMjUgY29va2llcyAtIHdoaWNoZXZlciBpcyBoaWdoZXN0CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIkhvIGhvIGhvLWZsYXZvcmVkIGZyb3N0aW5nIikpIG1vbmkgKj0gMjsKICAgICAgICAgIG1vbmkgKj0gR2FtZS5lZmYoInJlaW5kZWVyR2FpbiIpOwogICAgICAgICAgR2FtZS5FYXJuKG1vbmkpOwogICAgICAgICAgaWYgKEdhbWUuaGFzQnVmZigiRWxkZXIgZnJlbnp5IikpIEdhbWUuV2luKCJFbGRlZXIiKTsKCiAgICAgICAgICB2YXIgY29va2llID0gIiI7CiAgICAgICAgICB2YXIgZmFpbFJhdGUgPSAwLjg7CiAgICAgICAgICBpZiAoR2FtZS5IYXNBY2hpZXYoIkxldCBpdCBzbm93IikpIGZhaWxSYXRlID0gMC42OwogICAgICAgICAgZmFpbFJhdGUgKj0gMSAvIEdhbWUuZHJvcFJhdGVNdWx0KCk7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIlN0YXJzbm93IikpIGZhaWxSYXRlICo9IDAuOTU7CiAgICAgICAgICBpZiAoR2FtZS5oYXNHb2QpIHsKICAgICAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJzZWFzb25zIik7CiAgICAgICAgICAgIGlmIChnb2RMdmwgPT0gMSkgZmFpbFJhdGUgKj0gMC45OwogICAgICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMikgZmFpbFJhdGUgKj0gMC45NTsKICAgICAgICAgICAgZWxzZSBpZiAoZ29kTHZsID09IDMpIGZhaWxSYXRlICo9IDAuOTc7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoTWF0aC5yYW5kb20oKSA+IGZhaWxSYXRlKSB7CiAgICAgICAgICAgIC8vY2hyaXN0bWFzIGNvb2tpZSBkcm9wcwogICAgICAgICAgICBjb29raWUgPSBjaG9vc2UoWwogICAgICAgICAgICAgICJDaHJpc3RtYXMgdHJlZSBiaXNjdWl0cyIsCiAgICAgICAgICAgICAgIlNub3dmbGFrZSBiaXNjdWl0cyIsCiAgICAgICAgICAgICAgIlNub3dtYW4gYmlzY3VpdHMiLAogICAgICAgICAgICAgICJIb2xseSBiaXNjdWl0cyIsCiAgICAgICAgICAgICAgIkNhbmR5IGNhbmUgYmlzY3VpdHMiLAogICAgICAgICAgICAgICJCZWxsIGJpc2N1aXRzIiwKICAgICAgICAgICAgICAiUHJlc2VudCBiaXNjdWl0cyIsCiAgICAgICAgICAgIF0pOwogICAgICAgICAgICBpZiAoIUdhbWUuSGFzVW5sb2NrZWQoY29va2llKSAmJiAhR2FtZS5IYXMoY29va2llKSkgewogICAgICAgICAgICAgIEdhbWUuVW5sb2NrKGNvb2tpZSk7CiAgICAgICAgICAgIH0gZWxzZSBjb29raWUgPSAiIjsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgcG9wdXAgPSAiIjsKCiAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgbG9jKCJZb3UgZm91bmQgJTEhIiwgY2hvb3NlKGxvYygiUmVpbmRlZXIgbmFtZXMiKSkpLAogICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgIlRoZSByZWluZGVlciBnaXZlcyB5b3UgJTEuIiwKICAgICAgICAgICAgICBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeShtb25pKSkKICAgICAgICAgICAgKSArCiAgICAgICAgICAgICAgKGNvb2tpZSA9PSAiIgogICAgICAgICAgICAgICAgPyAiIgogICAgICAgICAgICAgICAgOiAiPGJyPiIgKwogICAgICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAgICAgIllvdSBhcmUgYWxzbyByZXdhcmRlZCB3aXRoICUxISIsCiAgICAgICAgICAgICAgICAgICAgR2FtZS5VcGdyYWRlc1tjb29raWVdLmRuYW1lCiAgICAgICAgICAgICAgICAgICkpLAogICAgICAgICAgICBbMTIsIDldLAogICAgICAgICAgICA2CiAgICAgICAgICApOwogICAgICAgICAgcG9wdXAgPQogICAgICAgICAgICAnPGRpdiBzdHlsZT0iZm9udC1zaXplOjgwJTsiPicgKwogICAgICAgICAgICBsb2MoIislMSEiLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeShtb25pKSkpICsKICAgICAgICAgICAgIjwvZGl2PiI7CgogICAgICAgICAgaWYgKHBvcHVwICE9ICIiKSBHYW1lLlBvcHVwKHBvcHVwLCBHYW1lLm1vdXNlWCwgR2FtZS5tb3VzZVkpOwoKICAgICAgICAgIC8vc3BhcmtsZSBhbmQga2lsbCB0aGUgc2hpbW1lcgogICAgICAgICAgR2FtZS5TcGFya2xlQXQoR2FtZS5tb3VzZVgsIEdhbWUubW91c2VZKTsKICAgICAgICAgIFBsYXlTb3VuZCgic25kL2ppbmdsZUNsaWNrLm1wMyIpOwogICAgICAgICAgbWUuZGllKCk7CiAgICAgICAgfSwKICAgICAgICBtaXNzRnVuYzogZnVuY3Rpb24gKG1lKSB7fSwKICAgICAgICBzcGF3bnNPblRpbWVyOiB0cnVlLAogICAgICAgIHNwYXduQ29uZGl0aW9uczogZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKEdhbWUuc2Vhc29uID09ICJjaHJpc3RtYXMiKSByZXR1cm4gdHJ1ZTsKICAgICAgICAgIGVsc2UgcmV0dXJuIGZhbHNlOwogICAgICAgIH0sCiAgICAgICAgc3Bhd25lZDogMCwKICAgICAgICB0aW1lOiAwLAogICAgICAgIG1pblRpbWU6IDAsCiAgICAgICAgbWF4VGltZTogMCwKICAgICAgICBnZXRUaW1lTW9kOiBmdW5jdGlvbiAobWUsIG0pIHsKICAgICAgICAgIGlmIChHYW1lLkhhcygiUmVpbmRlZXIgYmFraW5nIGdyb3VuZHMiKSkgbSAvPSAyOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJTdGFyc25vdyIpKSBtICo9IDAuOTU7CiAgICAgICAgICBpZiAoR2FtZS5oYXNHb2QpIHsKICAgICAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJzZWFzb25zIik7CiAgICAgICAgICAgIGlmIChnb2RMdmwgPT0gMSkgbSAqPSAwLjk7CiAgICAgICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAyKSBtICo9IDAuOTU7CiAgICAgICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAzKSBtICo9IDAuOTc7CiAgICAgICAgICB9CiAgICAgICAgICBtICo9IDEgLyBHYW1lLmVmZigicmVpbmRlZXJGcmVxIik7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIlJlaW5kZWVyIHNlYXNvbiIpKSBtID0gMC4wMTsKICAgICAgICAgIHJldHVybiBNYXRoLmNlaWwoR2FtZS5mcHMgKiA2MCAqIG0pOwogICAgICAgIH0sCiAgICAgICAgZ2V0TWluVGltZTogZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgICB2YXIgbSA9IDM7CiAgICAgICAgICByZXR1cm4gdGhpcy5nZXRUaW1lTW9kKG1lLCBtKTsKICAgICAgICB9LAogICAgICAgIGdldE1heFRpbWU6IGZ1bmN0aW9uIChtZSkgewogICAgICAgICAgdmFyIG0gPSA2OwogICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VGltZU1vZChtZSwgbSk7CiAgICAgICAgfSwKICAgICAgfSwKICAgIH07CgogICAgR2FtZS5nb2xkZW5Db29raWVDaG9pY2VzID0gWwogICAgICAiRnJlbnp5IiwKICAgICAgImZyZW56eSIsCiAgICAgICJMdWNreSIsCiAgICAgICJtdWx0aXBseSBjb29raWVzIiwKICAgICAgIlJ1aW4iLAogICAgICAicnVpbiBjb29raWVzIiwKICAgICAgIkVsZGVyIGZyZW56eSIsCiAgICAgICJibG9vZCBmcmVuenkiLAogICAgICAiQ2xvdCIsCiAgICAgICJjbG90IiwKICAgICAgIkNsaWNrIGZyZW56eSIsCiAgICAgICJjbGljayBmcmVuenkiLAogICAgICAiQ3Vyc2VkIGZpbmdlciIsCiAgICAgICJjdXJzZWQgZmluZ2VyIiwKICAgICAgIkNvb2tpZSBjaGFpbiIsCiAgICAgICJjaGFpbiBjb29raWUiLAogICAgICAiQ29va2llIHN0b3JtIiwKICAgICAgImNvb2tpZSBzdG9ybSIsCiAgICAgICJCdWlsZGluZyBzcGVjaWFsIiwKICAgICAgImJ1aWxkaW5nIHNwZWNpYWwiLAogICAgICAiRHJhZ29uIEhhcnZlc3QiLAogICAgICAiZHJhZ29uIGhhcnZlc3QiLAogICAgICAiRHJhZ29uZmxpZ2h0IiwKICAgICAgImRyYWdvbmZsaWdodCIsCiAgICAgICJTd2VldCIsCiAgICAgICJmcmVlIHN1Z2FyIGx1bXAiLAogICAgICAiQmxhYiIsCiAgICAgICJibGFiIiwKICAgIF07CiAgICBHYW1lLmdvbGRlbkNvb2tpZUJ1aWxkaW5nQnVmZnMgPSB7CiAgICAgIEN1cnNvcjogWyJIaWdoLWZpdmUiLCAiU2xhcCB0byB0aGUgZmFjZSJdLAogICAgICBHcmFuZG1hOiBbIkNvbmdyZWdhdGlvbiIsICJTZW5pbGl0eSJdLAogICAgICBGYXJtOiBbIkx1eHVyaWFudCBoYXJ2ZXN0IiwgIkxvY3VzdHMiXSwKICAgICAgTWluZTogWyJPcmUgdmVpbiIsICJDYXZlLWluIl0sCiAgICAgIEZhY3Rvcnk6IFsiT2lsZWQtdXAiLCAiSmFtbWVkIG1hY2hpbmVyeSJdLAogICAgICBCYW5rOiBbIkp1aWN5IHByb2ZpdHMiLCAiUmVjZXNzaW9uIl0sCiAgICAgIFRlbXBsZTogWyJGZXJ2ZW50IGFkb3JhdGlvbiIsICJDcmlzaXMgb2YgZmFpdGgiXSwKICAgICAgIldpemFyZCB0b3dlciI6IFsiTWFuYWJsb29tIiwgIk1hZ2l2b3JlcyJdLAogICAgICBTaGlwbWVudDogWyJEZWxpY2lvdXMgbGlmZWZvcm1zIiwgIkJsYWNrIGhvbGVzIl0sCiAgICAgICJBbGNoZW15IGxhYiI6IFsiQnJlYWt0aHJvdWdoIiwgIkxhYiBkaXNhc3RlciJdLAogICAgICBQb3J0YWw6IFsiUmlnaHRlb3VzIGNhdGFjbHlzbSIsICJEaW1lbnNpb25hbCBjYWxhbWl0eSJdLAogICAgICAiVGltZSBtYWNoaW5lIjogWyJHb2xkZW4gYWdlcyIsICJUaW1lIGphbSJdLAogICAgICAiQW50aW1hdHRlciBjb25kZW5zZXIiOiBbIkV4dHJhIGN5Y2xlcyIsICJQcmVkaWN0YWJsZSB0cmFnZWR5Il0sCiAgICAgIFByaXNtOiBbIlNvbGFyIGZsYXJlIiwgIkVjbGlwc2UiXSwKICAgICAgQ2hhbmNlbWFrZXI6IFsiV2lubmluZyBzdHJlYWsiLCAiRHJ5IHNwZWxsIl0sCiAgICAgICJGcmFjdGFsIGVuZ2luZSI6IFsiTWFjcm9jb3NtIiwgIk1pY3JvY29zbSJdLAogICAgICAiSmF2YXNjcmlwdCBjb25zb2xlIjogWyJSZWZhY3RvcmluZyIsICJBbnRpcGF0dGVybiJdLAogICAgICBJZGxldmVyc2U6IFsiQ29zbWljIG51cnNlcnkiLCAiQmlnIGNydW5jaCJdLAogICAgICAiQ29ydGV4IGJha2VyIjogWyJCcmFpbnN0b3JtIiwgIkJyYWluIGZyZWV6ZSJdLAogICAgfTsKCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCQlQQVJUSUNMRVMKCQk9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgLy9nZW5lcmljIHBhcnRpY2xlcyAoZmFsbGluZyBjb29raWVzIGV0YykKICAgIC8vb25seSBkaXNwbGF5ZWQgb24gbGVmdCBzZWN0aW9uCiAgICBHYW1lLnBhcnRpY2xlcyA9IFtdOwogICAgR2FtZS5wYXJ0aWNsZXNOID0gNTA7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IEdhbWUucGFydGljbGVzTjsgaSsrKSB7CiAgICAgIEdhbWUucGFydGljbGVzW2ldID0gewogICAgICAgIHg6IDAsCiAgICAgICAgeTogMCwKICAgICAgICB4ZDogMCwKICAgICAgICB5ZDogMCwKICAgICAgICB3OiA2NCwKICAgICAgICBoOiA2NCwKICAgICAgICB6OiAwLAogICAgICAgIHNpemU6IDEsCiAgICAgICAgZHVyOiAyLAogICAgICAgIGxpZmU6IC0xLAogICAgICAgIHI6IDAsCiAgICAgICAgcGljOiAic21hbGxDb29raWVzLnBuZyIsCiAgICAgICAgcGljSWQ6IDAsCiAgICAgICAgcGljUG9zOiBbMCwgMF0sCiAgICAgIH07CiAgICB9CgogICAgR2FtZS5wYXJ0aWNsZXNVcGRhdGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgR2FtZS5wYXJ0aWNsZXNOOyBpKyspIHsKICAgICAgICB2YXIgbWUgPSBHYW1lLnBhcnRpY2xlc1tpXTsKICAgICAgICBpZiAobWUubGlmZSAhPSAtMSkgewogICAgICAgICAgaWYgKCFtZS50ZXh0KSBtZS55ZCArPSAwLjIgKyBNYXRoLnJhbmRvbSgpICogMC4xOwogICAgICAgICAgbWUueCArPSBtZS54ZDsKICAgICAgICAgIG1lLnkgKz0gbWUueWQ7CiAgICAgICAgICAvL21lLnkrPW1lLmxpZmUqMC4yNStNYXRoLnJhbmRvbSgpKjAuMjU7CiAgICAgICAgICBtZS5saWZlKys7CiAgICAgICAgICBpZiAobWUubGlmZSA+PSBHYW1lLmZwcyAqIG1lLmR1cikgewogICAgICAgICAgICBtZS5saWZlID0gLTE7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9OwogICAgR2FtZS5wYXJ0aWNsZUFkZCA9IGZ1bmN0aW9uICh4LCB5LCB4ZCwgeWQsIHNpemUsIGR1ciwgeiwgcGljLCB0ZXh0KSB7CiAgICAgIC8vR2FtZS5wYXJ0aWNsZUFkZChwb3MgWCxwb3MgWSxzcGVlZCBYLHNwZWVkIFksc2l6ZSAobXVsdGlwbGllciksZHVyYXRpb24gKHNlY29uZHMpLGxheWVyLHBpY3R1cmUsdGV4dCk7CiAgICAgIC8vcGljayB0aGUgZmlyc3QgZnJlZSAob3IgdGhlIG9sZGVzdCkgcGFydGljbGUgdG8gcmVwbGFjZSBpdAogICAgICBpZiAodHJ1ZSkgewogICAgICAgIC8vR2FtZS5wcmVmcy5wYXJ0aWNsZXMpCiAgICAgICAgdmFyIGhpZ2hlc3QgPSAwOwogICAgICAgIHZhciBoaWdoZXN0SSA9IDA7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBHYW1lLnBhcnRpY2xlc047IGkrKykgewogICAgICAgICAgaWYgKEdhbWUucGFydGljbGVzW2ldLmxpZmUgPT0gLTEpIHsKICAgICAgICAgICAgaGlnaGVzdEkgPSBpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChHYW1lLnBhcnRpY2xlc1tpXS5saWZlID4gaGlnaGVzdCkgewogICAgICAgICAgICBoaWdoZXN0ID0gR2FtZS5wYXJ0aWNsZXNbaV0ubGlmZTsKICAgICAgICAgICAgaGlnaGVzdEkgPSBpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB2YXIgYXV0byA9IDA7CiAgICAgICAgaWYgKHgpIGF1dG8gPSAxOwogICAgICAgIHZhciBpID0gaGlnaGVzdEk7CiAgICAgICAgdmFyIHggPSB4IHx8IC02NDsKICAgICAgICBpZiAoR2FtZS5MZWZ0QmFja2dyb3VuZCAmJiAhYXV0bykKICAgICAgICAgIHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBHYW1lLkxlZnRCYWNrZ3JvdW5kLmNhbnZhcy53aWR0aCk7CiAgICAgICAgdmFyIHkgPSB5IHx8IC02NDsKICAgICAgICB2YXIgbWUgPSBHYW1lLnBhcnRpY2xlc1tpXTsKICAgICAgICBtZS5saWZlID0gMDsKICAgICAgICBtZS54ID0geDsKICAgICAgICBtZS55ID0geTsKICAgICAgICBtZS54ZCA9IHhkIHx8IDA7CiAgICAgICAgbWUueWQgPSB5ZCB8fCAwOwogICAgICAgIG1lLnNpemUgPSBzaXplIHx8IDE7CiAgICAgICAgbWUueiA9IHogfHwgMDsKICAgICAgICBtZS5kdXIgPSBkdXIgfHwgMjsKICAgICAgICBtZS5yID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMzYwKTsKICAgICAgICBtZS5waWNJZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwKTsKICAgICAgICBpZiAoIXBpYykgewogICAgICAgICAgaWYgKEdhbWUuc2Vhc29uID09ICJmb29scyIpIHBpYyA9ICJzbWFsbERvbGxhcnMucG5nIjsKICAgICAgICAgIGVsc2UgewogICAgICAgICAgICB2YXIgY29va2llcyA9IFtbMTAsIDBdXTsKICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlVwZ3JhZGVzKSB7CiAgICAgICAgICAgICAgdmFyIGNvb2tpZSA9IEdhbWUuVXBncmFkZXNbaV07CiAgICAgICAgICAgICAgaWYgKGNvb2tpZS5ib3VnaHQgPiAwICYmIGNvb2tpZS5wb29sID09ICJjb29raWUiKQogICAgICAgICAgICAgICAgY29va2llcy5wdXNoKGNvb2tpZS5pY29uKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBtZS5waWNQb3MgPSBjaG9vc2UoY29va2llcyk7CiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICBHYW1lLmJha2VyeU5hbWUudG9Mb3dlckNhc2UoKSA9PSAib3J0aWVsIiB8fAogICAgICAgICAgICAgIE1hdGgucmFuZG9tKCkgPCAxIC8gMTAwMDAKICAgICAgICAgICAgKQogICAgICAgICAgICAgIG1lLnBpY1BvcyA9IFsxNywgNV07CiAgICAgICAgICAgIHBpYyA9ICJpY29ucy5wbmciOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHBpYyAhPT0gInN0cmluZyIpIHsKICAgICAgICAgIG1lLnBpY1BvcyA9IHBpYzsKICAgICAgICAgIHBpYyA9ICJpY29ucy5wbmciOwogICAgICAgIH0KICAgICAgICBtZS5waWMgPSBwaWMgfHwgInNtYWxsQ29va2llcy5wbmciOwogICAgICAgIG1lLnRleHQgPSB0ZXh0IHx8IDA7CiAgICAgICAgcmV0dXJuIG1lOwogICAgICB9CiAgICAgIHJldHVybiB7fTsKICAgIH07CiAgICBHYW1lLnBhcnRpY2xlc0RyYXcgPSBmdW5jdGlvbiAoeikgewogICAgICB2YXIgY3R4ID0gR2FtZS5MZWZ0QmFja2dyb3VuZDsKICAgICAgY3R4LmZpbGxTdHlsZSA9ICIjZmZmIjsKICAgICAgY3R4LmZvbnQgPSAiMjBweCBNZXJyaXdlYXRoZXIiOwogICAgICBjdHgudGV4dEFsaWduID0gImNlbnRlciI7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IEdhbWUucGFydGljbGVzTjsgaSsrKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5wYXJ0aWNsZXNbaV07CiAgICAgICAgaWYgKG1lLnogPT0geikgewogICAgICAgICAgaWYgKG1lLmxpZmUgIT0gLTEpIHsKICAgICAgICAgICAgdmFyIG9wYWNpdHkgPSAxIC0gbWUubGlmZSAvIChHYW1lLmZwcyAqIG1lLmR1cik7CiAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IG9wYWNpdHk7CiAgICAgICAgICAgIGlmIChtZS50ZXh0KSB7CiAgICAgICAgICAgICAgY3R4LmZpbGxUZXh0KG1lLnRleHQsIG1lLngsIG1lLnkpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGN0eC5zYXZlKCk7CiAgICAgICAgICAgICAgY3R4LnRyYW5zbGF0ZShtZS54LCBtZS55KTsKICAgICAgICAgICAgICBjdHgucm90YXRlKChtZS5yIC8gMzYwKSAqIE1hdGguUEkgKiAyKTsKICAgICAgICAgICAgICB2YXIgdyA9IDY0OwogICAgICAgICAgICAgIHZhciBoID0gNjQ7CiAgICAgICAgICAgICAgaWYgKG1lLnBpYyA9PSAiaWNvbnMucG5nIikgewogICAgICAgICAgICAgICAgdyA9IDQ4OwogICAgICAgICAgICAgICAgaCA9IDQ4OwogICAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZSgKICAgICAgICAgICAgICAgICAgUGljKG1lLnBpYyksCiAgICAgICAgICAgICAgICAgIG1lLnBpY1Bvc1swXSAqIHcsCiAgICAgICAgICAgICAgICAgIG1lLnBpY1Bvc1sxXSAqIGgsCiAgICAgICAgICAgICAgICAgIHcsCiAgICAgICAgICAgICAgICAgIGgsCiAgICAgICAgICAgICAgICAgICgtdyAvIDIpICogbWUuc2l6ZSwKICAgICAgICAgICAgICAgICAgKC1oIC8gMikgKiBtZS5zaXplLAogICAgICAgICAgICAgICAgICB3ICogbWUuc2l6ZSwKICAgICAgICAgICAgICAgICAgaCAqIG1lLnNpemUKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgbWUucGljID09ICJ3cmlua2xlckJpdHMucG5nIiB8fAogICAgICAgICAgICAgICAgICBtZS5waWMgPT0gInNoaW55V3JpbmtsZXJCaXRzLnBuZyIKICAgICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgICB3ID0gMTAwOwogICAgICAgICAgICAgICAgICBoID0gMjAwOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZSgKICAgICAgICAgICAgICAgICAgUGljKG1lLnBpYyksCiAgICAgICAgICAgICAgICAgIChtZS5waWNJZCAlIDgpICogdywKICAgICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgICAgdywKICAgICAgICAgICAgICAgICAgaCwKICAgICAgICAgICAgICAgICAgKC13IC8gMikgKiBtZS5zaXplLAogICAgICAgICAgICAgICAgICAoLWggLyAyKSAqIG1lLnNpemUsCiAgICAgICAgICAgICAgICAgIHcgKiBtZS5zaXplLAogICAgICAgICAgICAgICAgICBoICogbWUuc2l6ZQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICAvL3RleHQgcGFydGljbGVzIChwb3B1cHMgZXRjKQogICAgR2FtZS50ZXh0UGFydGljbGVzID0gW107CiAgICBHYW1lLnRleHRQYXJ0aWNsZXNZID0gMDsKICAgIHZhciBzdHIgPSAiIjsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMjA7IGkrKykgewogICAgICBHYW1lLnRleHRQYXJ0aWNsZXNbaV0gPSB7IHg6IDAsIHk6IDAsIGxpZmU6IC0xLCB0ZXh0OiAiIiB9OwogICAgICBzdHIgKz0gJzxkaXYgaWQ9InBhcnRpY2xlJyArIGkgKyAnIiBjbGFzcz0icGFydGljbGUgdGl0bGUiPjwvZGl2Pic7CiAgICB9CiAgICBsKCJwYXJ0aWNsZXMiKS5pbm5lckhUTUwgPSBzdHI7CiAgICBHYW1lLnRleHRQYXJ0aWNsZXNVcGRhdGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS50ZXh0UGFydGljbGVzKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS50ZXh0UGFydGljbGVzW2ldOwogICAgICAgIGlmIChtZS5saWZlICE9IC0xKSB7CiAgICAgICAgICBtZS5saWZlKys7CiAgICAgICAgICBpZiAobWUubGlmZSA+PSBHYW1lLmZwcyAqIDQpIHsKICAgICAgICAgICAgdmFyIGVsID0gbWUubDsKICAgICAgICAgICAgbWUubGlmZSA9IC0xOwogICAgICAgICAgICBlbC5zdHlsZS5vcGFjaXR5ID0gMDsKICAgICAgICAgICAgZWwuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgICBHYW1lLnRleHRQYXJ0aWNsZXNBZGQgPSBmdW5jdGlvbiAodGV4dCwgZWwsIHBvc1gsIHBvc1kpIHsKICAgICAgLy9waWNrIHRoZSBmaXJzdCBmcmVlIChvciB0aGUgb2xkZXN0KSBwYXJ0aWNsZSB0byByZXBsYWNlIGl0CiAgICAgIHZhciBoaWdoZXN0ID0gMDsKICAgICAgdmFyIGhpZ2hlc3RJID0gMDsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLnRleHRQYXJ0aWNsZXMpIHsKICAgICAgICBpZiAoR2FtZS50ZXh0UGFydGljbGVzW2ldLmxpZmUgPT0gLTEpIHsKICAgICAgICAgIGhpZ2hlc3RJID0gaTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBpZiAoR2FtZS50ZXh0UGFydGljbGVzW2ldLmxpZmUgPiBoaWdoZXN0KSB7CiAgICAgICAgICBoaWdoZXN0ID0gR2FtZS50ZXh0UGFydGljbGVzW2ldLmxpZmU7CiAgICAgICAgICBoaWdoZXN0SSA9IGk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHZhciBpID0gaGlnaGVzdEk7CiAgICAgIHZhciBub1N0YWNrID0gMDsKICAgICAgaWYgKHR5cGVvZiBwb3NYICE9PSAidW5kZWZpbmVkIiAmJiB0eXBlb2YgcG9zWSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICB4ID0gcG9zWDsKICAgICAgICB5ID0gcG9zWTsKICAgICAgICBub1N0YWNrID0gMTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgeCA9IChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIDQwOwogICAgICAgIHZhciB5ID0gMDsgLy8rKE1hdGgucmFuZG9tKCktMC41KSo0MDsKICAgICAgICBpZiAoIWVsKSB7CiAgICAgICAgICB2YXIgcmVjdCA9IEdhbWUuYm91bmRzOwogICAgICAgICAgdmFyIHggPSBNYXRoLmZsb29yKChyZWN0LmxlZnQgKyByZWN0LnJpZ2h0KSAvIDIpOwogICAgICAgICAgdmFyIHkgPSBNYXRoLmZsb29yKHJlY3QuYm90dG9tKSAtIEdhbWUubW9iaWxlICogNjQ7CiAgICAgICAgICB4ICs9IChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIDQwOwogICAgICAgICAgeSArPSAwOyAvLyhNYXRoLnJhbmRvbSgpLTAuNSkqNDA7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICghbm9TdGFjaykgeSAtPSBHYW1lLnRleHRQYXJ0aWNsZXNZOwoKICAgICAgeCA9IE1hdGgubWF4KEdhbWUuYm91bmRzLmxlZnQgKyAyMDAsIHgpOwogICAgICB4ID0gTWF0aC5taW4oR2FtZS5ib3VuZHMucmlnaHQgLSAyMDAsIHgpOwogICAgICB5ID0gTWF0aC5tYXgoR2FtZS5ib3VuZHMudG9wICsgMzIgKyAoQXBwID8gMzIgOiAwKSwgeSk7CgogICAgICB2YXIgbWUgPSBHYW1lLnRleHRQYXJ0aWNsZXNbaV07CiAgICAgIGlmICghbWUubCkgbWUubCA9IGwoInBhcnRpY2xlIiArIGkpOwogICAgICBtZS5saWZlID0gMDsKICAgICAgbWUueCA9IHg7CiAgICAgIG1lLnkgPSB5OwogICAgICBtZS50ZXh0ID0gdGV4dDsKICAgICAgbWUubC5pbm5lckhUTUwgPSB0ZXh0OwogICAgICBtZS5sLnN0eWxlLmxlZnQgPSBNYXRoLmZsb29yKEdhbWUudGV4dFBhcnRpY2xlc1tpXS54IC0gMjAwKSArICJweCI7CiAgICAgIG1lLmwuc3R5bGUuYm90dG9tID0gTWF0aC5mbG9vcigtR2FtZS50ZXh0UGFydGljbGVzW2ldLnkpICsgInB4IjsKICAgICAgZm9yICh2YXIgaWkgaW4gR2FtZS50ZXh0UGFydGljbGVzKSB7CiAgICAgICAgaWYgKGlpICE9IGkpCiAgICAgICAgICAoCiAgICAgICAgICAgIEdhbWUudGV4dFBhcnRpY2xlc1tpaV0ubCB8fCBsKCJwYXJ0aWNsZSIgKyBpaSkKICAgICAgICAgICkuc3R5bGUuekluZGV4ID0gMTAwMDAwMDAwOwogICAgICB9CiAgICAgIG1lLmwuc3R5bGUuekluZGV4ID0gMTAwMDAwMDAxOwogICAgICBtZS5sLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICBtZS5sLmNsYXNzTmFtZSA9ICJwYXJ0aWNsZSB0aXRsZSI7CiAgICAgIHZvaWQgbWUubC5vZmZzZXRXaWR0aDsKICAgICAgbWUubC5jbGFzc05hbWUgPSAicGFydGljbGUgdGl0bGUgcmlzaW5nVXBMaW5nZXIiOwogICAgICBpZiAoIW5vU3RhY2spIEdhbWUudGV4dFBhcnRpY2xlc1kgKz0gNjA7CiAgICB9OwogICAgR2FtZS5wb3B1cHMgPSAxOwogICAgR2FtZS5Qb3B1cCA9IGZ1bmN0aW9uICh0ZXh0LCB4LCB5KSB7CiAgICAgIGlmIChHYW1lLnBvcHVwcykgR2FtZS50ZXh0UGFydGljbGVzQWRkKHRleHQsIDAsIHgsIHkpOwogICAgfTsKCiAgICAvL2Rpc3BsYXkgc3BhcmtsZXMgYXQgYSBzZXQgcG9zaXRpb24KICAgIEdhbWUuc3BhcmtsZXMgPSBsKCJzcGFya2xlcyIpOwogICAgR2FtZS5zcGFya2xlc1QgPSAwOwogICAgR2FtZS5zcGFya2xlc0ZyYW1lcyA9IDE2OwogICAgR2FtZS5TcGFya2xlQXQgPSBmdW5jdGlvbiAoeCwgeSkgewogICAgICBpZiAoR2FtZS5ibGVuZE1vZGVzT24pIHsKICAgICAgICBHYW1lLnNwYXJrbGVzVCA9IEdhbWUuc3BhcmtsZXNGcmFtZXMgKyAxOwogICAgICAgIEdhbWUuc3BhcmtsZXMuc3R5bGUuYmFja2dyb3VuZFBvc2l0aW9uID0gIjBweCAwcHgiOwogICAgICAgIEdhbWUuc3BhcmtsZXMuc3R5bGUubGVmdCA9IE1hdGguZmxvb3IoeCAtIDY0KSArICJweCI7CiAgICAgICAgR2FtZS5zcGFya2xlcy5zdHlsZS50b3AgPSBNYXRoLmZsb29yKHkgLSA2NCkgKyAicHgiOwogICAgICAgIEdhbWUuc3BhcmtsZXMuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgIH0KICAgIH07CiAgICBHYW1lLlNwYXJrbGVPbiA9IGZ1bmN0aW9uIChlbCkgewogICAgICB2YXIgcmVjdCA9IGVsLmdldEJvdW5kcygpOwogICAgICBHYW1lLlNwYXJrbGVBdCgKICAgICAgICAocmVjdC5sZWZ0ICsgcmVjdC5yaWdodCkgLyAyLAogICAgICAgIChyZWN0LnRvcCArIHJlY3QuYm90dG9tKSAvIDIgLSAyNAogICAgICApOwogICAgfTsKCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCQlOT1RJRklDQVRJT05TCgkJPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KICAgIC8vbWF5YmUgZG8gYWxsIHRoaXMgbWVzcyB3aXRoIHByb3BlciBET00gaW5zdGVhZCBvZiByZXdyaXRpbmcgdGhlIGlubmVySFRNTAogICAgR2FtZS5Ob3RlcyA9IFtdOwogICAgR2FtZS5Ob3Rlc0J5SWQgPSBbXTsKICAgIEdhbWUubm90ZUlkID0gMDsKICAgIEdhbWUubm90ZUwgPSBsKCJub3RlcyIpOwogICAgR2FtZS5Ob3RlID0gZnVuY3Rpb24gKHRpdGxlLCBkZXNjLCBwaWMsIHF1aWNrKSB7CiAgICAgIHRoaXMudGl0bGUgPSB0aXRsZTsKICAgICAgdGhpcy5kZXNjID0gZGVzYyB8fCAiIjsKICAgICAgdGhpcy5waWMgPSBwaWMgfHwgIiI7CiAgICAgIHRoaXMuaWQgPSBHYW1lLm5vdGVJZDsKICAgICAgdGhpcy5kYXRlID0gRGF0ZS5ub3coKTsKICAgICAgdGhpcy5xdWljayA9IHF1aWNrIHx8IDA7CiAgICAgIHRoaXMubGlmZSA9ICh0aGlzLnF1aWNrIHx8IDEpICogR2FtZS5mcHM7CiAgICAgIHRoaXMubCA9IDA7CiAgICAgIHRoaXMuaGVpZ2h0ID0gMDsKICAgICAgdGhpcy50b29sdGlwID0gMDsKICAgICAgR2FtZS5ub3RlSWQrKzsKICAgICAgR2FtZS5Ob3Rlc0J5SWRbdGhpcy5pZF0gPSB0aGlzOwogICAgICBHYW1lLk5vdGVzLnVuc2hpZnQodGhpcyk7CiAgICAgIGlmIChHYW1lLk5vdGVzLmxlbmd0aCA+IDUwKSBHYW1lLk5vdGVzLnBvcCgpOwogICAgICAvL0dhbWUuTm90ZXMucHVzaCh0aGlzKTsKICAgICAgLy9pZiAoR2FtZS5Ob3Rlcy5sZW5ndGg+NTApIEdhbWUuTm90ZXMuc2hpZnQoKTsKICAgICAgR2FtZS5VcGRhdGVOb3RlcygpOwogICAgfTsKICAgIEdhbWUuQ2xvc2VOb3RlID0gZnVuY3Rpb24gKGlkKSB7CiAgICAgIHZhciBtZSA9IEdhbWUuTm90ZXNCeUlkW2lkXTsKICAgICAgaWYgKEdhbWUudG9vbHRpcC5mcm9tICYmIEdhbWUudG9vbHRpcC5mcm9tLmlkLmluZGV4T2YoIm5vdGUtIikgPT0gMCkKICAgICAgICBHYW1lLnRvb2x0aXAuaGlkZSgpOwogICAgICBHYW1lLk5vdGVzLnNwbGljZShHYW1lLk5vdGVzLmluZGV4T2YobWUpLCAxKTsKICAgICAgLy9HYW1lLk5vdGVzQnlJZC5zcGxpY2UoR2FtZS5Ob3Rlc0J5SWQuaW5kZXhPZihtZSksMSk7CiAgICAgIEdhbWUuTm90ZXNCeUlkW2lkXSA9IG51bGw7CiAgICAgIEdhbWUuVXBkYXRlTm90ZXMoKTsKICAgIH07CiAgICBHYW1lLkNsb3NlTm90ZXMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIEdhbWUuTm90ZXMgPSBbXTsKICAgICAgR2FtZS5Ob3Rlc0J5SWQgPSBbXTsKICAgICAgR2FtZS50b29sdGlwLmhpZGUoKTsKICAgICAgR2FtZS5VcGRhdGVOb3RlcygpOwogICAgfTsKICAgIEdhbWUuVXBkYXRlTm90ZXMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBzdHIgPSAiIjsKICAgICAgdmFyIHJlbWFpbmluZyA9IEdhbWUuTm90ZXMubGVuZ3RoOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUuTm90ZXMpIHsKICAgICAgICBpZiAoaSA8IDUpIHsKICAgICAgICAgIHZhciBtZSA9IEdhbWUuTm90ZXNbaV07CiAgICAgICAgICB2YXIgcGljID0gIiI7CiAgICAgICAgICBpZiAobWUucGljICE9ICIiKQogICAgICAgICAgICBwaWMgPSAnPGRpdiBjbGFzcz0iaWNvbiIgc3R5bGU9IicgKyB3cml0ZUljb24obWUucGljKSArICciPjwvZGl2Pic7CiAgICAgICAgICBzdHIgPQogICAgICAgICAgICAnPGRpdiBpZD0ibm90ZS0nICsKICAgICAgICAgICAgbWUuaWQgKwogICAgICAgICAgICAnIiAnICsKICAgICAgICAgICAgKG1lLnRvb2x0aXAKICAgICAgICAgICAgICA/IEdhbWUuZ2V0RHluYW1pY1Rvb2x0aXAobWUudG9vbHRpcCwgInRoaXMiLCB0cnVlKSArICIgIgogICAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICAgJ2NsYXNzPSJmcmFtZWQgbm90ZSAnICsKICAgICAgICAgICAgKG1lLnBpYyAhPSAiIiA/ICJoYXNwaWMiIDogIm5vcGljIikgKwogICAgICAgICAgICAiICIgKwogICAgICAgICAgICAobWUuZGVzYyAhPSAiIiA/ICJoYXNkZXNjIiA6ICJub2Rlc2MiKSArCiAgICAgICAgICAgICciPjxkaXYgY2xhc3M9ImNsb3NlIiBvbmNsaWNrPSJQbGF5U291bmQoXCdzbmQvdGljay5tcDNcJyk7R2FtZS5DbG9zZU5vdGUoJyArCiAgICAgICAgICAgIG1lLmlkICsKICAgICAgICAgICAgJyk7Ij54PC9kaXY+JyArCiAgICAgICAgICAgIHBpYyArCiAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJ0ZXh0Ij48aDM+JyArCiAgICAgICAgICAgIG1lLnRpdGxlICsKICAgICAgICAgICAgIjwvaDM+IiArCiAgICAgICAgICAgIChtZS5kZXNjICE9ICIiCiAgICAgICAgICAgICAgPyAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+PGg1PicgKyBtZS5kZXNjICsgIjwvaDU+IgogICAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICAgIjwvZGl2PjwvZGl2PiIgKwogICAgICAgICAgICBzdHI7CiAgICAgICAgICByZW1haW5pbmctLTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHJlbWFpbmluZyA+IDApCiAgICAgICAgc3RyID0KICAgICAgICAgICc8ZGl2IGNsYXNzPSJyZW1haW5pbmciPicgKwogICAgICAgICAgbG9jKCIrJTEgbW9yZSBub3RpZmljYXRpb24uIiwgTEJlYXV0aWZ5KHJlbWFpbmluZykpICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgIHN0cjsKICAgICAgaWYgKEdhbWUuTm90ZXMubGVuZ3RoID4gMSkgewogICAgICAgIHN0ciArPQogICAgICAgICAgJzxkaXYgY2xhc3M9ImZyYW1lZCBjbG9zZSBzaWRlbm90ZSIgb25jbGljaz0iUGxheVNvdW5kKFwnc25kL3RpY2subXAzXCcpO0dhbWUuQ2xvc2VOb3RlcygpOyI+eDwvZGl2Pic7CiAgICAgIH0KICAgICAgR2FtZS5ub3RlTC5pbm5lckhUTUwgPSBzdHI7CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5Ob3RlcykgewogICAgICAgIG1lLmwgPSAwOwogICAgICAgIGlmIChpIDwgNSkgewogICAgICAgICAgdmFyIG1lID0gR2FtZS5Ob3Rlc1tpXTsKICAgICAgICAgIG1lLmwgPSBsKCJub3RlLSIgKyBtZS5pZCk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwogICAgR2FtZS5Ob3Rlc0xvZ2ljID0gZnVuY3Rpb24gKCkgewogICAgICBmb3IgKHZhciBpIGluIEdhbWUuTm90ZXMpIHsKICAgICAgICBpZiAoR2FtZS5Ob3Rlc1tpXS5xdWljayA+IDApIHsKICAgICAgICAgIHZhciBtZSA9IEdhbWUuTm90ZXNbaV07CiAgICAgICAgICBtZS5saWZlLS07CiAgICAgICAgICBpZiAobWUubGlmZSA8PSAwKSBHYW1lLkNsb3NlTm90ZShtZS5pZCk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwogICAgR2FtZS5Ob3Rlc0RyYXcgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5Ob3RlcykgewogICAgICAgIGlmIChHYW1lLk5vdGVzW2ldLnF1aWNrID4gMCkgewogICAgICAgICAgdmFyIG1lID0gR2FtZS5Ob3Rlc1tpXTsKICAgICAgICAgIGlmIChtZS5sKSB7CiAgICAgICAgICAgIGlmIChtZS5saWZlIDwgMTApIHsKICAgICAgICAgICAgICBtZS5sLnN0eWxlLm9wYWNpdHkgPSBtZS5saWZlIC8gMTA7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgICBHYW1lLk5vdGlmeSA9IGZ1bmN0aW9uICh0aXRsZSwgZGVzYywgcGljLCBxdWljaywgbm9Mb2cpIHsKICAgICAgaWYgKEdhbWUucHJlZnMubm90aWZzKSB7CiAgICAgICAgcXVpY2sgPSBNYXRoLm1pbig2LCBxdWljayk7CiAgICAgICAgaWYgKCFxdWljaykgcXVpY2sgPSA2OwogICAgICB9CiAgICAgIGRlc2MgPSByZXBsYWNlQWxsKAogICAgICAgICI9PUNMT1NFVEhJUygpPT0iLAogICAgICAgICJHYW1lLkNsb3NlTm90ZSgiICsgR2FtZS5ub3RlSWQgKyAiKTsiLAogICAgICAgIGRlc2MKICAgICAgKTsKICAgICAgaWYgKEdhbWUucG9wdXBzKSBuZXcgR2FtZS5Ob3RlKHRpdGxlLCBkZXNjLCBwaWMsIHF1aWNrKTsKICAgICAgaWYgKCFub0xvZykgR2FtZS5BZGRUb0xvZygiPGI+IiArIHRpdGxlICsgIjwvYj4gfCAiICsgZGVzYyk7CiAgICB9OwogICAgR2FtZS5Ob3RpZnlUb29sdGlwID0gZnVuY3Rpb24gKGNvbnRlbnQpIHsKICAgICAgLy9hdHRhY2hlcyBhIHRvb2x0aXAgdG8gdGhlIGxhc3Qgc3Bhd25lZCBub3RlCiAgICAgIGlmICghR2FtZS5Ob3Rlc0J5SWRbR2FtZS5ub3RlSWQgLSAxXSkgcmV0dXJuIGZhbHNlOwogICAgICB2YXIgbWUgPSBHYW1lLk5vdGVzQnlJZFtHYW1lLm5vdGVJZCAtIDFdOwogICAgICBtZS50b29sdGlwID0gY29udGVudDsKICAgICAgR2FtZS5VcGRhdGVOb3RlcygpOwogICAgfTsKCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCQlQUk9NUFQKCQk9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgR2FtZS5kYXJrZW5MID0gbCgiZGFya2VuIik7CiAgICBBZGRFdmVudChHYW1lLmRhcmtlbkwsICJjbGljayIsIGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKEdhbWUucHJvbXB0Tm9DbG9zZSkgewogICAgICB9IGVsc2UgewogICAgICAgIEdhbWUuQ2xpY2sgPSAwOwogICAgICAgIFBsYXlTb3VuZCgic25kL3RpY2tPZmYubXAzIik7CiAgICAgICAgR2FtZS5DbG9zZVByb21wdCgpOwogICAgICB9CiAgICB9KTsKICAgIEdhbWUucHJvbXB0TCA9IGwoInByb21wdENvbnRlbnQiKTsKICAgIEdhbWUucHJvbXB0QW5jaG9yTCA9IGwoInByb21wdEFuY2hvciIpOwogICAgR2FtZS5wcm9tcHRXcmFwTCA9IGwoInByb21wdCIpOwogICAgR2FtZS5wcm9tcHRDb25maXJtID0gIiI7CiAgICBHYW1lLnByb21wdE9uID0gMDsKICAgIEdhbWUucHJvbXB0VXBkYXRlRnVuYyA9IDA7CiAgICBHYW1lLnByb21wdE9wdGlvbnNOID0gMDsKICAgIEdhbWUucHJvbXB0T3B0aW9uRm9jdXMgPSAwOwogICAgR2FtZS5wcm9tcHROb0Nsb3NlID0gZmFsc2U7CiAgICBHYW1lLlVwZGF0ZVByb21wdCA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKEdhbWUucHJvbXB0VXBkYXRlRnVuYykgR2FtZS5wcm9tcHRVcGRhdGVGdW5jKCk7CiAgICAgIEdhbWUucHJvbXB0QW5jaG9yTC5zdHlsZS50b3AgPQogICAgICAgIE1hdGguZmxvb3IoKEdhbWUud2luZG93SCAtIEdhbWUucHJvbXB0V3JhcEwub2Zmc2V0SGVpZ2h0KSAvIDIgLSAxNikgKwogICAgICAgICJweCI7CiAgICB9OwogICAgR2FtZS5Qcm9tcHQgPSBmdW5jdGlvbiAoY29udGVudCwgb3B0aW9ucywgdXBkYXRlRnVuYywgc3R5bGUpIHsKICAgICAgR2FtZS5wcm9tcHROb0Nsb3NlID0gZmFsc2U7CiAgICAgIGlmICh1cGRhdGVGdW5jKSBHYW1lLnByb21wdFVwZGF0ZUZ1bmMgPSB1cGRhdGVGdW5jOwogICAgICBpZiAoc3R5bGUpIEdhbWUucHJvbXB0V3JhcEwuY2xhc3NOYW1lID0gImZyYW1lZCAiICsgc3R5bGU7CiAgICAgIGVsc2UgR2FtZS5wcm9tcHRXcmFwTC5jbGFzc05hbWUgPSAiZnJhbWVkIjsKICAgICAgdmFyIHN0ciA9ICIiOwogICAgICBzdHIgKz0gY29udGVudDsKICAgICAgaWYgKHN0ci5pbmRleE9mKCI8aWQgIikgPT0gMCkgewogICAgICAgIHZhciBpZCA9IHN0ci5zdWJzdHJpbmcoNCwgc3RyLmluZGV4T2YoIj4iKSk7CiAgICAgICAgc3RyID0gc3RyLnN1YnN0cmluZyhzdHIuaW5kZXhPZigiPiIpICsgMSk7CiAgICAgICAgc3RyID0gJzxkaXYgaWQ9InByb21wdENvbnRlbnQnICsgaWQgKyAnIj4nICsgc3RyICsgIjwvZGl2PiI7CiAgICAgIH0KICAgICAgaWYgKHN0ci5pbmRleE9mKCI8bm9DbG9zZT4iKSAhPSAtMSkgewogICAgICAgIHN0ciA9IHN0ci5yZXBsYWNlKCI8bm9DbG9zZT4iLCAiIik7CiAgICAgICAgR2FtZS5wcm9tcHROb0Nsb3NlID0gdHJ1ZTsKICAgICAgfQogICAgICB2YXIgb3B0cyA9ICIiOwogICAgICBHYW1lLnByb21wdE9wdGlvbnNOID0gMDsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvcHRpb25zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKG9wdGlvbnNbaV0gPT0gImJyIikgewogICAgICAgICAgLy9qdXN0IGEgbGluZWJyZWFrCiAgICAgICAgICBvcHRzICs9ICI8YnI+IjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zW2ldID09ICJzdHJpbmciKQogICAgICAgICAgICBvcHRpb25zW2ldID0gWwogICAgICAgICAgICAgIG9wdGlvbnNbaV0sCiAgICAgICAgICAgICAgIlBsYXlTb3VuZCgnc25kL3RpY2tPZmYubXAzJyk7R2FtZS5DbG9zZVByb21wdCgpOyIsCiAgICAgICAgICAgIF07CiAgICAgICAgICBlbHNlIGlmICghb3B0aW9uc1tpXVsxXSkKICAgICAgICAgICAgb3B0aW9uc1tpXSA9IFsKICAgICAgICAgICAgICBvcHRpb25zW2ldWzBdLAogICAgICAgICAgICAgICJQbGF5U291bmQoJ3NuZC90aWNrT2ZmLm1wMycpO0dhbWUuQ2xvc2VQcm9tcHQoKTsiLAogICAgICAgICAgICAgIG9wdGlvbnNbaV1bMl0sCiAgICAgICAgICAgIF07CiAgICAgICAgICBlbHNlIG9wdGlvbnNbaV1bMV0gPSAiUGxheVNvdW5kKCdzbmQvdGljay5tcDMnKTsiICsgb3B0aW9uc1tpXVsxXTsKICAgICAgICAgIG9wdGlvbnNbaV1bMV0gPSBvcHRpb25zW2ldWzFdCiAgICAgICAgICAgIC5yZXBsYWNlKC8nL2csICImIzM5OyIpCiAgICAgICAgICAgIC5yZXBsYWNlKC8iL2csICImIzM0OyIpOwogICAgICAgICAgb3B0cyArPQogICAgICAgICAgICAnPGEgaWQ9InByb21wdE9wdGlvbicgKwogICAgICAgICAgICBpICsKICAgICAgICAgICAgJyIgY2xhc3M9Im9wdGlvbiIgJyArCiAgICAgICAgICAgIChvcHRpb25zW2ldWzJdID8gJ3N0eWxlPSInICsgb3B0aW9uc1tpXVsyXSArICciICcgOiAiIikgKwogICAgICAgICAgICAiIiArCiAgICAgICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICAgICAnPSInICsKICAgICAgICAgICAgb3B0aW9uc1tpXVsxXSArCiAgICAgICAgICAgICciPicgKwogICAgICAgICAgICBvcHRpb25zW2ldWzBdICsKICAgICAgICAgICAgIjwvYT4iOwogICAgICAgICAgR2FtZS5wcm9tcHRPcHRpb25zTisrOwogICAgICAgIH0KICAgICAgfQogICAgICBHYW1lLnByb21wdEwuaW5uZXJIVE1MID0KICAgICAgICBzdHIgKyAnPGRpdiBjbGFzcz0ib3B0aW9uQm94Ij4nICsgb3B0cyArICI8L2Rpdj4iOwogICAgICBHYW1lLnByb21wdEFuY2hvckwuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgIEdhbWUuZGFya2VuTC5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgR2FtZS5wcm9tcHRMLmZvY3VzKCk7CiAgICAgIEdhbWUucHJvbXB0T24gPSAxOwogICAgICBHYW1lLnByb21wdE9wdGlvbkZvY3VzID0gMDsKICAgICAgR2FtZS5Gb2N1c1Byb21wdE9wdGlvbigwKTsKICAgICAgR2FtZS5VcGRhdGVQcm9tcHQoKTsKICAgICAgaWYgKCFHYW1lLnByb21wdE5vQ2xvc2UpIGwoInByb21wdENsb3NlIikuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgIGVsc2UgbCgicHJvbXB0Q2xvc2UiKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgfTsKICAgIEdhbWUuQ2xvc2VQcm9tcHQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICghR2FtZS5wcm9tcHRPbikgcmV0dXJuIGZhbHNlOwogICAgICBHYW1lLnByb21wdEFuY2hvckwuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgR2FtZS5kYXJrZW5MLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgIEdhbWUucHJvbXB0T24gPSAwOwogICAgICBHYW1lLnByb21wdFVwZGF0ZUZ1bmMgPSAwOwogICAgICBHYW1lLnByb21wdE9wdGlvbkZvY3VzID0gMDsKICAgICAgR2FtZS5wcm9tcHRPcHRpb25zTiA9IDA7CiAgICAgIEdhbWUucHJvbXB0Tm9DbG9zZSA9IGZhbHNlOwogICAgfTsKICAgIEdhbWUuQ29uZmlybVByb21wdCA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKAogICAgICAgIEdhbWUucHJvbXB0T24gJiYKICAgICAgICBsKCJwcm9tcHRPcHRpb24iICsgR2FtZS5wcm9tcHRPcHRpb25Gb2N1cykgJiYKICAgICAgICBsKCJwcm9tcHRPcHRpb24iICsgR2FtZS5wcm9tcHRPcHRpb25Gb2N1cykuc3R5bGUuZGlzcGxheSAhPSAibm9uZSIKICAgICAgKQogICAgICAgIEZpcmVFdmVudChsKCJwcm9tcHRPcHRpb24iICsgR2FtZS5wcm9tcHRPcHRpb25Gb2N1cyksICJjbGljayIpOwogICAgfTsKICAgIEdhbWUuRm9jdXNQcm9tcHRPcHRpb24gPSBmdW5jdGlvbiAoZGlyLCB0cnlOKSB7CiAgICAgIHZhciBpZCA9IEdhbWUucHJvbXB0T3B0aW9uRm9jdXMgKyBkaXI7CiAgICAgIGlmIChpZCA8IDApIGlkID0gR2FtZS5wcm9tcHRPcHRpb25zTiAtIDE7CiAgICAgIGlmIChpZCA+PSBHYW1lLnByb21wdE9wdGlvbnNOKSBpZCA9IDA7CiAgICAgIHdoaWxlICgKICAgICAgICBpZCA+PSAwICYmCiAgICAgICAgaWQgPCBHYW1lLnByb21wdE9wdGlvbnNOICYmCiAgICAgICAgKCFsKCJwcm9tcHRPcHRpb24iICsgaWQpIHx8CiAgICAgICAgICBsKCJwcm9tcHRPcHRpb24iICsgaWQpLnN0eWxlLmRpc3BsYXkgPT0gIm5vbmUiKQogICAgICApIHsKICAgICAgICBpZCArPSBkaXIgfHwgMTsKICAgICAgfQogICAgICBpZiAoCiAgICAgICAgbCgicHJvbXB0T3B0aW9uIiArIGlkKSAmJgogICAgICAgIGwoInByb21wdE9wdGlvbiIgKyBpZCkuc3R5bGUuZGlzcGxheSAhPSAibm9uZSIKICAgICAgKSB7CiAgICAgICAgaWYgKGwoInByb21wdE9wdGlvbiIgKyBHYW1lLnByb21wdE9wdGlvbkZvY3VzKSkKICAgICAgICAgIGwoInByb21wdE9wdGlvbiIgKyBHYW1lLnByb21wdE9wdGlvbkZvY3VzKS5jbGFzc0xpc3QucmVtb3ZlKAogICAgICAgICAgICAiZm9jdXNlZCIKICAgICAgICAgICk7CiAgICAgICAgR2FtZS5wcm9tcHRPcHRpb25Gb2N1cyA9IGlkOwogICAgICAgIGlmIChsKCJwcm9tcHRPcHRpb24iICsgR2FtZS5wcm9tcHRPcHRpb25Gb2N1cykpCiAgICAgICAgICBsKCJwcm9tcHRPcHRpb24iICsgR2FtZS5wcm9tcHRPcHRpb25Gb2N1cykuY2xhc3NMaXN0LmFkZCgiZm9jdXNlZCIpOwogICAgICB9IGVsc2UgaWYgKCF0cnlOICYmIGRpciAhPSAwKSB7CiAgICAgICAgR2FtZS5wcm9tcHRPcHRpb25Gb2N1cyA9IGlkOwogICAgICAgIEdhbWUuRm9jdXNQcm9tcHRPcHRpb24oZGlyLCAxKTsKICAgICAgfQogICAgfTsKCiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCQlNRU5VUwoJCT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCiAgICBHYW1lLmNzc0NsYXNzZXMgPSBbXTsKICAgIEdhbWUuYWRkQ2xhc3MgPSBmdW5jdGlvbiAod2hhdCkgewogICAgICBpZiAoR2FtZS5jc3NDbGFzc2VzLmluZGV4T2Yod2hhdCkgPT0gLTEpIEdhbWUuY3NzQ2xhc3Nlcy5wdXNoKHdoYXQpOwogICAgICBHYW1lLnVwZGF0ZUNsYXNzZXMoKTsKICAgIH07CiAgICBHYW1lLnJlbW92ZUNsYXNzID0gZnVuY3Rpb24gKHdoYXQpIHsKICAgICAgdmFyIGkgPSBHYW1lLmNzc0NsYXNzZXMuaW5kZXhPZih3aGF0KTsKICAgICAgaWYgKGkgIT0gLTEpIHsKICAgICAgICBHYW1lLmNzc0NsYXNzZXMuc3BsaWNlKGksIDEpOwogICAgICB9CiAgICAgIEdhbWUudXBkYXRlQ2xhc3NlcygpOwogICAgfTsKICAgIEdhbWUudXBkYXRlQ2xhc3NlcyA9IGZ1bmN0aW9uICgpIHsKICAgICAgR2FtZS5sLmNsYXNzTmFtZSA9IEdhbWUuY3NzQ2xhc3Nlcy5qb2luKCIgIik7CiAgICB9OwoKICAgIEdhbWUuV3JpdGVQcmVmQnV0dG9uID0gZnVuY3Rpb24gKAogICAgICBwcmVmTmFtZSwKICAgICAgYnV0dG9uLAogICAgICBvbiwKICAgICAgb2ZmLAogICAgICBjYWxsYmFjaywKICAgICAgaW52ZXJ0CiAgICApIHsKICAgICAgdmFyIGludmVydCA9IGludmVydCA/IDEgOiAwOwogICAgICBpZiAoIWNhbGxiYWNrKSBjYWxsYmFjayA9ICIiOwogICAgICBjYWxsYmFjayArPSAiUGxheVNvdW5kKCdzbmQvdGljay5tcDMnKTsiOwogICAgICByZXR1cm4gKAogICAgICAgICc8YSBjbGFzcz0ic21hbGxGYW5jeUJ1dHRvbiBwcmVmQnV0dG9uIG9wdGlvbicgKwogICAgICAgIChHYW1lLnByZWZzW3ByZWZOYW1lXSBeIGludmVydCA/ICIiIDogIiBvZmYiKSArCiAgICAgICAgJyIgaWQ9IicgKwogICAgICAgIGJ1dHRvbiArCiAgICAgICAgJyIgJyArCiAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgIj1cIkdhbWUuVG9nZ2xlKCciICsKICAgICAgICBwcmVmTmFtZSArCiAgICAgICAgIicsJyIgKwogICAgICAgIGJ1dHRvbiArCiAgICAgICAgIicsJyIgKwogICAgICAgIG9uICsKICAgICAgICAiJywnIiArCiAgICAgICAgb2ZmICsKICAgICAgICAiJywnIiArCiAgICAgICAgaW52ZXJ0ICsKICAgICAgICAiJyk7IiArCiAgICAgICAgY2FsbGJhY2sgKwogICAgICAgICciPicgKwogICAgICAgIChHYW1lLnByZWZzW3ByZWZOYW1lXSA/IG9uIDogb2ZmKSArCiAgICAgICAgIjwvYT4iCiAgICAgICk7CiAgICB9OwogICAgR2FtZS5Ub2dnbGUgPSBmdW5jdGlvbiAocHJlZk5hbWUsIGJ1dHRvbiwgb24sIG9mZiwgaW52ZXJ0KSB7CiAgICAgIGlmIChHYW1lLnByZWZzW3ByZWZOYW1lXSkgewogICAgICAgIGwoYnV0dG9uKS5pbm5lckhUTUwgPSBvZmY7CiAgICAgICAgR2FtZS5wcmVmc1twcmVmTmFtZV0gPSAwOwogICAgICB9IGVsc2UgewogICAgICAgIGwoYnV0dG9uKS5pbm5lckhUTUwgPSBvbjsKICAgICAgICBHYW1lLnByZWZzW3ByZWZOYW1lXSA9IDE7CiAgICAgIH0KICAgICAgbChidXR0b24pLmNsYXNzTmFtZSA9CiAgICAgICAgInNtYWxsRmFuY3lCdXR0b24gcHJlZkJ1dHRvbiBvcHRpb24iICsKICAgICAgICAoR2FtZS5wcmVmc1twcmVmTmFtZV0gXiBpbnZlcnQgPyAiIiA6ICIgb2ZmIik7CiAgICB9OwogICAgR2FtZS5Ub2dnbGVGYW5jeSA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKEdhbWUucHJlZnMuZmFuY3kpIEdhbWUucmVtb3ZlQ2xhc3MoIm5vRmFuY3kiKTsKICAgICAgZWxzZSBpZiAoIUdhbWUucHJlZnMuZmFuY3kpIEdhbWUuYWRkQ2xhc3MoIm5vRmFuY3kiKTsKICAgIH07CiAgICBHYW1lLlRvZ2dsZUZpbHRlcnMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChHYW1lLnByZWZzLmZpbHRlcnMpIEdhbWUucmVtb3ZlQ2xhc3MoIm5vRmlsdGVycyIpOwogICAgICBlbHNlIGlmICghR2FtZS5wcmVmcy5maWx0ZXJzKSBHYW1lLmFkZENsYXNzKCJub0ZpbHRlcnMiKTsKICAgIH07CiAgICBHYW1lLlRvZ2dsZUV4dHJhQnV0dG9ucyA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCFHYW1lLnByZWZzLmV4dHJhQnV0dG9ucykgR2FtZS5yZW1vdmVDbGFzcygiZXh0cmFCdXR0b25zIik7CiAgICAgIGVsc2UgaWYgKEdhbWUucHJlZnMuZXh0cmFCdXR0b25zKSBHYW1lLmFkZENsYXNzKCJleHRyYUJ1dHRvbnMiKTsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICBHYW1lLk9iamVjdHNbaV0ubXV0ZSgwKTsKICAgICAgfQogICAgfTsKICAgIEdhbWUuVG9nZ2xlRnVsbHNjcmVlbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKEFwcCkgQXBwLnNldEZ1bGxzY3JlZW4oR2FtZS5wcmVmcy5mdWxsc2NyZWVuKTsKICAgIH07CgogICAgR2FtZS5Xcml0ZVNsaWRlciA9IGZ1bmN0aW9uICgKICAgICAgc2xpZGVyLAogICAgICBsZWZ0VGV4dCwKICAgICAgcmlnaHRUZXh0LAogICAgICBzdGFydFZhbHVlRnVuY3Rpb24sCiAgICAgIGNhbGxiYWNrCiAgICApIHsKICAgICAgaWYgKCFjYWxsYmFjaykgY2FsbGJhY2sgPSAiIjsKICAgICAgcmV0dXJuICgKICAgICAgICAnPGRpdiBjbGFzcz0ic2xpZGVyQm94Ij48ZGl2IHN0eWxlPSJmbG9hdDpsZWZ0OyIgY2xhc3M9InNtYWxsRmFuY3lCdXR0b24iPicgKwogICAgICAgIGxlZnRUZXh0ICsKICAgICAgICAnPC9kaXY+PGRpdiBzdHlsZT0iZmxvYXQ6cmlnaHQ7IiBjbGFzcz0ic21hbGxGYW5jeUJ1dHRvbiIgaWQ9IicgKwogICAgICAgIHNsaWRlciArCiAgICAgICAgJ1JpZ2h0VGV4dCI+JyArCiAgICAgICAgcmlnaHRUZXh0LnJlcGxhY2UoIlskXSIsIHN0YXJ0VmFsdWVGdW5jdGlvbigpKSArCiAgICAgICAgJzwvZGl2PjxpbnB1dCBjbGFzcz0ic2xpZGVyIiBzdHlsZT0iY2xlYXI6Ym90aDsiIHR5cGU9InJhbmdlIiBtaW49IjAiIG1heD0iMTAwIiBzdGVwPSIxIiB2YWx1ZT0iJyArCiAgICAgICAgc3RhcnRWYWx1ZUZ1bmN0aW9uKCkgKwogICAgICAgICciIG9uY2hhbmdlPSInICsKICAgICAgICBjYWxsYmFjayArCiAgICAgICAgJyIgb25pbnB1dD0iJyArCiAgICAgICAgY2FsbGJhY2sgKwogICAgICAgICciIG9ubW91c2V1cD0iUGxheVNvdW5kKFwnc25kL3RpY2subXAzXCcpOyIgaWQ9IicgKwogICAgICAgIHNsaWRlciArCiAgICAgICAgJyIvPjwvZGl2PicKICAgICAgKTsKICAgIH07CgogICAgR2FtZS5vblBhbmVsID0gIkxlZnQiOwogICAgR2FtZS5hZGRDbGFzcygiZm9jdXMiICsgR2FtZS5vblBhbmVsKTsKICAgIEdhbWUuU2hvd1BhbmVsID0gZnVuY3Rpb24gKHdoYXQpIHsKICAgICAgaWYgKCF3aGF0KSB3aGF0ID0gIiI7CiAgICAgIGlmIChHYW1lLm9uUGFuZWwgIT0gd2hhdCkgewogICAgICAgIEdhbWUucmVtb3ZlQ2xhc3MoImZvY3VzIiArIEdhbWUub25QYW5lbCk7CiAgICAgICAgR2FtZS5hZGRDbGFzcygiZm9jdXMiICsgd2hhdCk7CiAgICAgIH0KICAgICAgR2FtZS5vblBhbmVsID0gd2hhdDsKICAgIH07CgogICAgR2FtZS5vbk1lbnUgPSAiIjsKICAgIEdhbWUuU2hvd01lbnUgPSBmdW5jdGlvbiAod2hhdCkgewogICAgICBpZiAoIXdoYXQgfHwgd2hhdCA9PSAiIikgd2hhdCA9IEdhbWUub25NZW51OwogICAgICBpZiAoR2FtZS5vbk1lbnUgPT0gIiIgJiYgd2hhdCAhPSAiIikgR2FtZS5hZGRDbGFzcygib25NZW51Iik7CiAgICAgIGVsc2UgaWYgKEdhbWUub25NZW51ICE9ICIiICYmIHdoYXQgIT0gR2FtZS5vbk1lbnUpCiAgICAgICAgR2FtZS5hZGRDbGFzcygib25NZW51Iik7CiAgICAgIGVsc2UgaWYgKHdoYXQgPT0gR2FtZS5vbk1lbnUpIHsKICAgICAgICBHYW1lLnJlbW92ZUNsYXNzKCJvbk1lbnUiKTsKICAgICAgICB3aGF0ID0gIiI7CiAgICAgIH0KICAgICAgLy9pZiAod2hhdD09J2xvZycpIGwoJ2RvbmF0ZUJveCcpLmNsYXNzTmFtZT0nb24nOyBlbHNlIGwoJ2RvbmF0ZUJveCcpLmNsYXNzTmFtZT0nJzsKICAgICAgR2FtZS5vbk1lbnUgPSB3aGF0OwoKICAgICAgbCgicHJlZnNCdXR0b24iKS5jbGFzc05hbWUgPQogICAgICAgIEdhbWUub25NZW51ID09ICJwcmVmcyIgPyAicGFuZWxCdXR0b24gc2VsZWN0ZWQiIDogInBhbmVsQnV0dG9uIjsKICAgICAgbCgic3RhdHNCdXR0b24iKS5jbGFzc05hbWUgPQogICAgICAgIEdhbWUub25NZW51ID09ICJzdGF0cyIgPyAicGFuZWxCdXR0b24gc2VsZWN0ZWQiIDogInBhbmVsQnV0dG9uIjsKICAgICAgbCgibG9nQnV0dG9uIikuY2xhc3NOYW1lID0KICAgICAgICBHYW1lLm9uTWVudSA9PSAibG9nIiA/ICJwYW5lbEJ1dHRvbiBzZWxlY3RlZCIgOiAicGFuZWxCdXR0b24iOwoKICAgICAgaWYgKEdhbWUub25NZW51ID09ICIiKSBQbGF5U291bmQoInNuZC9jbGlja09mZjIubXAzIik7CiAgICAgIGVsc2UgUGxheVNvdW5kKCJzbmQvY2xpY2tPbjIubXAzIik7CgogICAgICBHYW1lLlVwZGF0ZU1lbnUoKTsKCiAgICAgIGlmICh3aGF0ID09ICIiKSB7CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICAgIHZhciBtZSA9IEdhbWUuT2JqZWN0c1tpXTsKICAgICAgICAgIGlmIChtZS5taW5pZ2FtZSAmJiBtZS5taW5pZ2FtZS5vblJlc2l6ZSkgbWUubWluaWdhbWUub25SZXNpemUoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgICBHYW1lLnNheVRpbWUgPSBmdW5jdGlvbiAodGltZSwgZGV0YWlsKSB7CiAgICAgIC8vdGltZSBpcyBhIHZhbHVlIHdoZXJlIG9uZSBzZWNvbmQgaXMgZXF1YWwgdG8gR2FtZS5mcHMgKDMwKS4KICAgICAgLy9kZXRhaWwgc2tpcHMgZGF5cyB3aGVuID4xLCBob3VycyB3aGVuID4yLCBtaW51dGVzIHdoZW4gPjMgYW5kIHNlY29uZHMgd2hlbiA+NC4KICAgICAgLy9pZiBkZXRhaWwgaXMgLTEsIG91dHB1dCBzb21ldGhpbmcgbGlrZSAiMyBob3VycywgOSBtaW51dGVzLCA0OCBzZWNvbmRzIgogICAgICBpZiAodGltZSA8PSAwKSByZXR1cm4gIiI7CiAgICAgIHZhciBzdHIgPSAiIjsKICAgICAgdmFyIGRldGFpbCA9IGRldGFpbCB8fCAwOwogICAgICB0aW1lID0gTWF0aC5mbG9vcih0aW1lKTsKICAgICAgaWYgKGRldGFpbCA9PSAtMSkgewogICAgICAgIC8vdmFyIG1vbnRocz0wOwogICAgICAgIHZhciBkYXlzID0gMDsKICAgICAgICB2YXIgaG91cnMgPSAwOwogICAgICAgIHZhciBtaW51dGVzID0gMDsKICAgICAgICB2YXIgc2Vjb25kcyA9IDA7CiAgICAgICAgLy9pZiAodGltZT49R2FtZS5mcHMqNjAqNjAqMjQqMzApIG1vbnRocz0oTWF0aC5mbG9vcih0aW1lLyhHYW1lLmZwcyo2MCo2MCoyNCozMCkpKTsKICAgICAgICBpZiAodGltZSA+PSBHYW1lLmZwcyAqIDYwICogNjAgKiAyNCkKICAgICAgICAgIGRheXMgPSBNYXRoLmZsb29yKHRpbWUgLyAoR2FtZS5mcHMgKiA2MCAqIDYwICogMjQpKTsKICAgICAgICBpZiAodGltZSA+PSBHYW1lLmZwcyAqIDYwICogNjApCiAgICAgICAgICBob3VycyA9IE1hdGguZmxvb3IodGltZSAvIChHYW1lLmZwcyAqIDYwICogNjApKTsKICAgICAgICBpZiAodGltZSA+PSBHYW1lLmZwcyAqIDYwKSBtaW51dGVzID0gTWF0aC5mbG9vcih0aW1lIC8gKEdhbWUuZnBzICogNjApKTsKICAgICAgICBpZiAodGltZSA+PSBHYW1lLmZwcykgc2Vjb25kcyA9IE1hdGguZmxvb3IodGltZSAvIEdhbWUuZnBzKTsKICAgICAgICAvL2RheXMtPW1vbnRocyozMDsKICAgICAgICBob3VycyAtPSBkYXlzICogMjQ7CiAgICAgICAgbWludXRlcyAtPSBob3VycyAqIDYwICsgZGF5cyAqIDI0ICogNjA7CiAgICAgICAgc2Vjb25kcyAtPSBtaW51dGVzICogNjAgKyBob3VycyAqIDYwICogNjAgKyBkYXlzICogMjQgKiA2MCAqIDYwOwogICAgICAgIGlmIChkYXlzID4gMTApIHsKICAgICAgICAgIGhvdXJzID0gMDsKICAgICAgICB9CiAgICAgICAgaWYgKGRheXMpIHsKICAgICAgICAgIG1pbnV0ZXMgPSAwOwogICAgICAgICAgc2Vjb25kcyA9IDA7CiAgICAgICAgfQogICAgICAgIGlmIChob3VycykgewogICAgICAgICAgc2Vjb25kcyA9IDA7CiAgICAgICAgfQogICAgICAgIHZhciBiaXRzID0gW107CiAgICAgICAgLy9pZiAobW9udGhzPjApIGJpdHMucHVzaChCZWF1dGlmeShtb250aHMpKycgbW9udGgnKyhkYXlzPT0xPycnOidzJykpOwogICAgICAgIGlmIChkYXlzID4gMCkgYml0cy5wdXNoKGxvYygiJTEgZGF5IiwgTEJlYXV0aWZ5KGRheXMpKSk7CiAgICAgICAgaWYgKGhvdXJzID4gMCkgYml0cy5wdXNoKGxvYygiJTEgaG91ciIsIExCZWF1dGlmeShob3VycykpKTsKICAgICAgICBpZiAobWludXRlcyA+IDApIGJpdHMucHVzaChsb2MoIiUxIG1pbnV0ZSIsIExCZWF1dGlmeShtaW51dGVzKSkpOwogICAgICAgIGlmIChzZWNvbmRzID4gMCkgYml0cy5wdXNoKGxvYygiJTEgc2Vjb25kIiwgTEJlYXV0aWZ5KHNlY29uZHMpKSk7CiAgICAgICAgaWYgKGJpdHMubGVuZ3RoID09IDApIHN0ciA9IGxvYygibGVzcyB0aGFuIDEgc2Vjb25kIik7CiAgICAgICAgZWxzZSBzdHIgPSBiaXRzLmpvaW4oIiwgIik7CiAgICAgICAgLyovL2lmIChtb250aHM+MCkgYml0cy5wdXNoKEJlYXV0aWZ5KG1vbnRocykrJyBtb250aCcrKGRheXM9PTE/Jyc6J3MnKSk7CgkJCQlpZiAoZGF5cz4wKSBiaXRzLnB1c2goQmVhdXRpZnkoZGF5cykrJyBkYXknKyhkYXlzPT0xPycnOidzJykpOwoJCQkJaWYgKGhvdXJzPjApIGJpdHMucHVzaChCZWF1dGlmeShob3VycykrJyBob3VyJysoaG91cnM9PTE/Jyc6J3MnKSk7CgkJCQlpZiAobWludXRlcz4wKSBiaXRzLnB1c2goQmVhdXRpZnkobWludXRlcykrJyBtaW51dGUnKyhtaW51dGVzPT0xPycnOidzJykpOwoJCQkJaWYgKHNlY29uZHM+MCkgYml0cy5wdXNoKEJlYXV0aWZ5KHNlY29uZHMpKycgc2Vjb25kJysoc2Vjb25kcz09MT8nJzoncycpKTsKCQkJCWlmIChiaXRzLmxlbmd0aD09MCkgc3RyPSdsZXNzIHRoYW4gMSBzZWNvbmQnOwoJCQkJZWxzZSBzdHI9Yml0cy5qb2luKCcsICcpOyovCiAgICAgIH0gZWxzZSB7CiAgICAgICAgLyppZiAodGltZT49R2FtZS5mcHMqNjAqNjAqMjQqMzAqMiAmJiBkZXRhaWw8MSkgc3RyPUJlYXV0aWZ5KE1hdGguZmxvb3IodGltZS8oR2FtZS5mcHMqNjAqNjAqMjQqMzApKSkrJyBtb250aHMnOwoJCQkJZWxzZSBpZiAodGltZT49R2FtZS5mcHMqNjAqNjAqMjQqMzAgJiYgZGV0YWlsPDEpIHN0cj0nMSBtb250aCc7CgkJCQllbHNlICovIGlmICh0aW1lID49IEdhbWUuZnBzICogNjAgKiA2MCAqIDI0ICYmIGRldGFpbCA8IDIpCiAgICAgICAgICBzdHIgPSBsb2MoCiAgICAgICAgICAgICIlMSBkYXkiLAogICAgICAgICAgICBMQmVhdXRpZnkoTWF0aC5mbG9vcih0aW1lIC8gKEdhbWUuZnBzICogNjAgKiA2MCAqIDI0KSkpCiAgICAgICAgICApOyAvL0JlYXV0aWZ5KE1hdGguZmxvb3IodGltZS8oR2FtZS5mcHMqNjAqNjAqMjQpKSkrJyBkYXlzJzsKICAgICAgICBlbHNlIGlmICh0aW1lID49IEdhbWUuZnBzICogNjAgKiA2MCAmJiBkZXRhaWwgPCAzKQogICAgICAgICAgc3RyID0gbG9jKAogICAgICAgICAgICAiJTEgaG91ciIsCiAgICAgICAgICAgIExCZWF1dGlmeShNYXRoLmZsb29yKHRpbWUgLyAoR2FtZS5mcHMgKiA2MCAqIDYwKSkpCiAgICAgICAgICApOyAvL0JlYXV0aWZ5KE1hdGguZmxvb3IodGltZS8oR2FtZS5mcHMqNjAqNjApKSkrJyBob3Vycyc7CiAgICAgICAgZWxzZSBpZiAodGltZSA+PSBHYW1lLmZwcyAqIDYwICYmIGRldGFpbCA8IDQpCiAgICAgICAgICBzdHIgPSBsb2MoCiAgICAgICAgICAgICIlMSBtaW51dGUiLAogICAgICAgICAgICBMQmVhdXRpZnkoTWF0aC5mbG9vcih0aW1lIC8gKEdhbWUuZnBzICogNjApKSkKICAgICAgICAgICk7IC8vQmVhdXRpZnkoTWF0aC5mbG9vcih0aW1lLyhHYW1lLmZwcyo2MCkpKSsnIG1pbnV0ZXMnOwogICAgICAgIGVsc2UgaWYgKHRpbWUgPj0gR2FtZS5mcHMgJiYgZGV0YWlsIDwgNSkKICAgICAgICAgIHN0ciA9IGxvYygKICAgICAgICAgICAgIiUxIHNlY29uZCIsCiAgICAgICAgICAgIExCZWF1dGlmeShNYXRoLmZsb29yKHRpbWUgLyBHYW1lLmZwcykpCiAgICAgICAgICApOyAvL0JlYXV0aWZ5KE1hdGguZmxvb3IodGltZS8oR2FtZS5mcHMpKSkrJyBzZWNvbmRzJzsKICAgICAgICBlbHNlIHN0ciA9IGxvYygibGVzcyB0aGFuIDEgc2Vjb25kIik7CiAgICAgIH0KICAgICAgcmV0dXJuIHN0cjsKICAgIH07CgogICAgR2FtZS50aW55Q29va2llID0gZnVuY3Rpb24gKCkgewogICAgICBpZiAoIUdhbWUuSGFzQWNoaWV2KCJUaW55IGNvb2tpZSIpKSB7CiAgICAgICAgcmV0dXJuICgKICAgICAgICAgICc8ZGl2IGNsYXNzPSJ0aW55Q29va2llIiAnICsKICAgICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICAgJz0iR2FtZS5DbGlja1RpbnlDb29raWUoKTsiPjwvZGl2PicKICAgICAgICApOwogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH07CiAgICBHYW1lLkNsaWNrVGlueUNvb2tpZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCFHYW1lLkhhc0FjaGlldigiVGlueSBjb29raWUiKSkgewogICAgICAgIFBsYXlTb3VuZCgic25kL3RpY2subXAzIik7CiAgICAgICAgR2FtZS5XaW4oIlRpbnkgY29va2llIik7CiAgICAgIH0KICAgIH07CgogICAgR2FtZS5zZXRWb2x1bWUgPSBmdW5jdGlvbiAod2hhdCkgewogICAgICBHYW1lLnZvbHVtZSA9IHdoYXQ7CiAgICAgIC8qZm9yICh2YXIgaSBpbiBTb3VuZHMpCgkJCXsKCQkJCVNvdW5kc1tpXS52b2x1bWU9R2FtZS52b2x1bWU7CgkJCX0qLwogICAgfTsKICAgIEdhbWUuc2V0Vm9sdW1lTXVzaWMgPSBmdW5jdGlvbiAod2hhdCkgewogICAgICBHYW1lLnZvbHVtZU11c2ljID0gd2hhdDsKICAgICAgaWYgKE11c2ljKSBNdXNpYy5zZXRWb2x1bWUod2hhdCAvIDEwMCk7CiAgICB9OwogICAgR2FtZS5zZXRXdWJNdXNpYyA9IGZ1bmN0aW9uICh3aGF0KSB7CiAgICAgIGlmIChNdXNpYykgTXVzaWMuc2V0RmlsdGVyKHdoYXQgLyAxMDApOwogICAgfTsKCiAgICBHYW1lLnNob3dMYW5nU2VsZWN0aW9uID0gZnVuY3Rpb24gKGZpcnN0TGF1bmNoKSB7CiAgICAgIHZhciBzdHIgPSAiIjsKICAgICAgZm9yICh2YXIgaSBpbiBMYW5ncykgewogICAgICAgIHZhciBsYW5nID0gTGFuZ3NbaV07CiAgICAgICAgc3RyICs9CiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGFuZ1NlbGVjdEJ1dHRvbiB0aXRsZScgKwogICAgICAgICAgKCFmaXJzdExhdW5jaCAmJiBsb2NJZCA9PSBsYW5nLmZpbGUgPyAiIHNlbGVjdGVkIiA6ICIiKSArCiAgICAgICAgICAnIiBzdHlsZT0icGFkZGluZzo0cHg7IiBpZD0ibGFuZ1NlbGVjdC0nICsKICAgICAgICAgIGkgKwogICAgICAgICAgJyI+JyArCiAgICAgICAgICBsYW5nLm5hbWUgKwogICAgICAgICAgIjwvZGl2PiI7CiAgICAgIH0KICAgICAgR2FtZS5Qcm9tcHQoCiAgICAgICAgIjxpZCBDaGFuZ2VMYW5ndWFnZT4iICsKICAgICAgICAgIChmaXJzdExhdW5jaCA/ICI8bm9DbG9zZT4iIDogIiIpICsKICAgICAgICAgICc8aDMgaWQ9Imxhbmd1YWdlU2VsZWN0SGVhZGVyIj4nICsKICAgICAgICAgIGxvYygiQ2hhbmdlIGxhbmd1YWdlIikgKwogICAgICAgICAgIjwvaDM+IiArCiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgICAoZmlyc3RMYXVuY2gKICAgICAgICAgICAgPyAiIgogICAgICAgICAgICA6ICc8ZGl2IHN0eWxlPSJmb250LXNpemU6MTFweDtvcGFjaXR5OjAuNTttYXJnaW4tYm90dG9tOjEycHg7Ij4oJyArCiAgICAgICAgICAgICAgbG9jKCJub3RlOiB0aGlzIHdpbGwgc2F2ZSBhbmQgcmVsb2FkIHlvdXIgZ2FtZSIpICsKICAgICAgICAgICAgICAiKTwvZGl2PiIpICsKICAgICAgICAgIHN0ciwKICAgICAgICBmaXJzdExhdW5jaCA/IDAgOiBbbG9jKCJDYW5jZWwiKV0KICAgICAgKTsKCiAgICAgIGZvciAodmFyIGkgaW4gTGFuZ3MpIHsKICAgICAgICB2YXIgbGFuZyA9IExhbmdzW2ldOwogICAgICAgIEFkZEV2ZW50KAogICAgICAgICAgbCgibGFuZ1NlbGVjdC0iICsgaSksCiAgICAgICAgICAiY2xpY2siLAogICAgICAgICAgKGZ1bmN0aW9uIChsYW5nKSB7CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgaWYgKHRydWUpIHsKICAgICAgICAgICAgICAgIC8vbGFuZyE9bG9jSWQpCiAgICAgICAgICAgICAgICBQbGF5U291bmQoInNuZC90aWNrLm1wMyIpOwogICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlU2V0KCJDb29raWVDbGlja2VyTGFuZyIsIGxhbmcpOwogICAgICAgICAgICAgICAgR2FtZS50b1NhdmUgPSB0cnVlOwogICAgICAgICAgICAgICAgR2FtZS50b1JlbG9hZCA9IHRydWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgfSkoaSkKICAgICAgICApOwogICAgICAgIEFkZEV2ZW50KAogICAgICAgICAgbCgibGFuZ1NlbGVjdC0iICsgaSksCiAgICAgICAgICAibW91c2VvdmVyIiwKICAgICAgICAgIChmdW5jdGlvbiAobGFuZykgewogICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIFBsYXlTb3VuZCgic25kL3NtYWxsVGljay5tcDMiLCAwLjc1KTsKICAgICAgICAgICAgICBsKCJsYW5ndWFnZVNlbGVjdEhlYWRlciIpLmlubmVySFRNTCA9IExhbmdzW2xhbmddLmNoYW5nZUxhbmd1YWdlOwogICAgICAgICAgICB9OwogICAgICAgICAgfSkoaSkKICAgICAgICApOwogICAgICB9CiAgICB9OwoKICAgIE9OID0gIiAiICsgbG9jKCJPTiIpOwogICAgT0ZGID0gIiAiICsgbG9jKCJPRkYiKTsKICAgIEdhbWUuVXBkYXRlTWVudSA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHN0ciA9ICIiOwogICAgICBpZiAoR2FtZS5vbk1lbnUgIT0gIiIpIHsKICAgICAgICBzdHIgKz0KICAgICAgICAgICc8ZGl2IGNsYXNzPSJjbG9zZSBtZW51Q2xvc2UiICcgKwogICAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgICAnPSJHYW1lLlNob3dNZW51KCk7Ij54PC9kaXY+JzsKICAgICAgICAvL3N0cis9JzxkaXYgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlO3RvcDo4cHg7cmlnaHQ6OHB4O2N1cnNvcjpwb2ludGVyO2ZvbnQtc2l6ZToxNnB4OyIgJytHYW1lLmNsaWNrU3RyKyc9IkdhbWUuU2hvd01lbnUoKTsiPlg8L2Rpdj4nOwogICAgICB9CiAgICAgIGlmIChHYW1lLm9uTWVudSA9PSAicHJlZnMiKSB7CiAgICAgICAgc3RyICs9ICc8ZGl2IGNsYXNzPSJzZWN0aW9uIj4nICsgbG9jKCJPcHRpb25zIikgKyAiPC9kaXY+IjsKCiAgICAgICAgc3RyICs9CiAgICAgICAgICAnPGRpdiBjbGFzcz0iYmxvY2siIHN0eWxlPSJwYWRkaW5nOjBweDttYXJnaW46OHB4IDRweDsiPicgKwogICAgICAgICAgJzxkaXYgY2xhc3M9InN1YnNlY3Rpb24iIHN0eWxlPSJwYWRkaW5nOjBweDsiPicgKwogICAgICAgICAgJzxkaXYgY2xhc3M9InRpdGxlIj4nICsKICAgICAgICAgIGxvYygiR2VuZXJhbCIpICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7Ij48ZGl2IHN0eWxlPSJkaXNwbGF5OmlubGluZS1ibG9jaztwYWRkaW5nOjJweCA4cHg7b3BhY2l0eTowLjc1O2ZvbnQtc2l6ZToxMnB4O3ZlcnRpY2FsLWFsaWduOm1pZGRsZTsiIGNsYXNzPSJzbWFsbEZhbmN5QnV0dG9uIj4nICsKICAgICAgICAgIGxvYygiTGFuZ3VhZ2U6ICUxIiwgIjxiPiIgKyBMYW5nc1tsb2NJZF0ubmFtZSArICI8L2I+IikgKwogICAgICAgICAgJzwvZGl2PjxkaXYgY2xhc3M9Imljb24iIHN0eWxlPSJ2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7ZGlzcGxheTppbmxpbmUtYmxvY2s7YmFja2dyb3VuZC1wb3NpdGlvbjonICsKICAgICAgICAgIC0zMCAqIDQ4ICsKICAgICAgICAgICJweCAiICsKICAgICAgICAgIC0yOSAqIDQ4ICsKICAgICAgICAgICdweDt0cmFuc2Zvcm06c2NhbGUoMC41KTttYXJnaW46LTE2cHggLTEycHg7Ij48L2Rpdj48YSBzdHlsZT0iZm9udC1zaXplOjE1cHg7dGV4dC1hbGlnbjpjZW50ZXI7d2lkdGg6YXV0bzttaW4td2lkdGg6MTMwcHg7IiBjbGFzcz0ib3B0aW9uIHNtYWxsRmFuY3lCdXR0b24iIGlkPSJjaGFuZ2VMYW5ndWFnZU9wdGlvbiIgJyArCiAgICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAgICI9XCJQbGF5U291bmQoJ3NuZC90aWNrLm1wMycpO0dhbWUuc2hvd0xhbmdTZWxlY3Rpb24oKTtcIj4iICsKICAgICAgICAgICghRU4gPyAnQ2hhbmdlIGxhbmd1YWdlPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyA6ICIiKSArCiAgICAgICAgICBsb2MoIkNoYW5nZSBsYW5ndWFnZSIpICsKICAgICAgICAgICc8L2E+PGRpdiBzdHlsZT0iY2xlYXI6Ym90aDt0ZXh0LWFsaWduOnJpZ2h0O3BhZGRpbmctYm90dG9tOjJweDsiPjwvZGl2PjwvZGl2PicgKwogICAgICAgICAgKEFwcAogICAgICAgICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48YSBjbGFzcz0ib3B0aW9uIHNtYWxsRmFuY3lCdXR0b24iICcgKwogICAgICAgICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICAgICAgICI9XCJQbGF5U291bmQoJ3NuZC90aWNrLm1wMycpO0dhbWUudG9TYXZlPXRydWU7R2FtZS50b1F1aXQ9dHJ1ZTtcIj4iICsKICAgICAgICAgICAgICBsb2MoIlNhdmUgJiBRdWl0IikgKwogICAgICAgICAgICAgICI8L2E+PC9kaXY+IgogICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGEgY2xhc3M9Im9wdGlvbiBzbWFsbEZhbmN5QnV0dG9uIiAnICsKICAgICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICAgIj1cIkdhbWUudG9TYXZlPXRydWU7UGxheVNvdW5kKCdzbmQvdGljay5tcDMnKTtcIj4iICsKICAgICAgICAgIGxvYygiU2F2ZSIpICsKICAgICAgICAgICI8L2E+PGxhYmVsPiIgKwogICAgICAgICAgbG9jKAogICAgICAgICAgICAiU2F2ZSBtYW51YWxseSAodGhlIGdhbWUgYXV0b3NhdmVzIGV2ZXJ5IDYwIHNlY29uZHM7IHNob3J0Y3V0OiBjdHJsK1MpIgogICAgICAgICAgKSArCiAgICAgICAgICAiPC9sYWJlbD48L2Rpdj4iICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48YSBjbGFzcz0ib3B0aW9uIHNtYWxsRmFuY3lCdXR0b24iICcgKwogICAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgICAiPVwiR2FtZS5FeHBvcnRTYXZlKCk7UGxheVNvdW5kKCdzbmQvdGljay5tcDMnKTtcIj4iICsKICAgICAgICAgIGxvYygiRXhwb3J0IHNhdmUiKSArCiAgICAgICAgICAnPC9hPjxhIGNsYXNzPSJvcHRpb24gc21hbGxGYW5jeUJ1dHRvbiIgJyArCiAgICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAgICI9XCJHYW1lLkltcG9ydFNhdmUoKTtQbGF5U291bmQoJ3NuZC90aWNrLm1wMycpO1wiPiIgKwogICAgICAgICAgbG9jKCJJbXBvcnQgc2F2ZSIpICsKICAgICAgICAgICI8L2E+PGxhYmVsPiIgKwogICAgICAgICAgbG9jKAogICAgICAgICAgICAiWW91IGNhbiB1c2UgdGhpcyB0byBiYWNrdXAgeW91ciBzYXZlIG9yIHRvIHRyYW5zZmVyIGl0IHRvIGFub3RoZXIgY29tcHV0ZXIgKHNob3J0Y3V0IGZvciBpbXBvcnQ6IGN0cmwrTykiCiAgICAgICAgICApICsKICAgICAgICAgICI8L2xhYmVsPjwvZGl2PiIgKwogICAgICAgICAgKCFBcHAKICAgICAgICAgICAgPyAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGEgY2xhc3M9Im9wdGlvbiBzbWFsbEZhbmN5QnV0dG9uIiAnICsKICAgICAgICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAgICAgICAiPVwiR2FtZS5GaWxlU2F2ZSgpO1BsYXlTb3VuZCgnc25kL3RpY2subXAzJyk7XCI+IiArCiAgICAgICAgICAgICAgbG9jKCJTYXZlIHRvIGZpbGUiKSArCiAgICAgICAgICAgICAgJzwvYT48YSBjbGFzcz0ib3B0aW9uIHNtYWxsRmFuY3lCdXR0b24iIHN0eWxlPSJwb3NpdGlvbjpyZWxhdGl2ZTsiPjxpbnB1dCBpZD0iRmlsZUxvYWRJbnB1dCIgdHlwZT0iZmlsZSIgc3R5bGU9ImN1cnNvcjpwb2ludGVyO29wYWNpdHk6MDtwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OjBweDt0b3A6MHB4O3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7IiBvbmNoYW5nZT0iR2FtZS5GaWxlTG9hZChldmVudCk7IiAnICsKICAgICAgICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAgICAgICAiPVwiUGxheVNvdW5kKCdzbmQvdGljay5tcDMnKTtcIi8+IiArCiAgICAgICAgICAgICAgbG9jKCJMb2FkIGZyb20gZmlsZSIpICsKICAgICAgICAgICAgICAiPC9hPjxsYWJlbD4iICsKICAgICAgICAgICAgICBsb2MoIlVzZSB0aGlzIHRvIGtlZXAgYmFja3VwcyBvbiB5b3VyIGNvbXB1dGVyIikgKwogICAgICAgICAgICAgICI8L2xhYmVsPjwvZGl2PiIKICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciIHN0eWxlPSJ0ZXh0LWFsaWduOnJpZ2h0OyI+PGxhYmVsPicgKwogICAgICAgICAgbG9jKCJEZWxldGUgYWxsIHlvdXIgcHJvZ3Jlc3MsIGluY2x1ZGluZyB5b3VyIGFjaGlldmVtZW50cyIpICsKICAgICAgICAgICc8L2xhYmVsPjxhIGNsYXNzPSJvcHRpb24gc21hbGxGYW5jeUJ1dHRvbiB3YXJuaW5nIiAnICsKICAgICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICAgIj1cIkdhbWUuSGFyZFJlc2V0KCk7UGxheVNvdW5kKCdzbmQvdGljay5tcDMnKTtcIj4iICsKICAgICAgICAgIGxvYygiV2lwZSBzYXZlIikgKwogICAgICAgICAgIjwvYT48L2Rpdj4iICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJibG9jayIgc3R5bGU9InBhZGRpbmc6MHB4O21hcmdpbjo4cHggNHB4OyI+JyArCiAgICAgICAgICAnPGRpdiBjbGFzcz0ic3Vic2VjdGlvbiIgc3R5bGU9InBhZGRpbmc6MHB4OyI+JyArCiAgICAgICAgICAnPGRpdiBjbGFzcz0idGl0bGUiPicgKwogICAgICAgICAgbG9jKCJTZXR0aW5ncyIpICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgIChBcHAgJiYgQXBwLndyaXRlQ2xvdWRVSSA/IEFwcC53cml0ZUNsb3VkVUkoKSA6ICIiKSArCiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JyArCiAgICAgICAgICBHYW1lLldyaXRlU2xpZGVyKAogICAgICAgICAgICAidm9sdW1lU2xpZGVyIiwKICAgICAgICAgICAgbG9jKCJWb2x1bWUiKSwKICAgICAgICAgICAgIlskXSUiLAogICAgICAgICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIEdhbWUudm9sdW1lOwogICAgICAgICAgICB9LAogICAgICAgICAgICAiR2FtZS5zZXRWb2x1bWUoTWF0aC5yb3VuZChsKCd2b2x1bWVTbGlkZXInKS52YWx1ZSkpO2woJ3ZvbHVtZVNsaWRlclJpZ2h0VGV4dCcpLmlubmVySFRNTD1HYW1lLnZvbHVtZSsnJSc7IgogICAgICAgICAgKSArCiAgICAgICAgICAoQXBwCiAgICAgICAgICAgID8gR2FtZS5Xcml0ZVNsaWRlcigKICAgICAgICAgICAgICAgICJ2b2x1bWVNdXNpY1NsaWRlciIsCiAgICAgICAgICAgICAgICBsb2MoIlZvbHVtZSAobXVzaWMpIiksCiAgICAgICAgICAgICAgICAiWyRdJSIsCiAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBHYW1lLnZvbHVtZU11c2ljOwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICJHYW1lLnNldFZvbHVtZU11c2ljKE1hdGgucm91bmQobCgndm9sdW1lTXVzaWNTbGlkZXInKS52YWx1ZSkpO2woJ3ZvbHVtZU11c2ljU2xpZGVyUmlnaHRUZXh0JykuaW5uZXJIVE1MPUdhbWUudm9sdW1lTXVzaWMrJyUnOyIKICAgICAgICAgICAgICApCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgIC8qKEFwcD9HYW1lLldyaXRlU2xpZGVyKCd3dWJNdXNpY1NsaWRlcicsbG9jKCJXdWIiKSwnWyRdJScsZnVuY3Rpb24oKXtyZXR1cm4gMTAwO30sJ0dhbWUuc2V0V3ViTXVzaWMoTWF0aC5yb3VuZChsKFwnd3ViTXVzaWNTbGlkZXJcJykudmFsdWUpKTtsKFwnd3ViTXVzaWNTbGlkZXJSaWdodFRleHRcJykuaW5uZXJIVE1MPShNYXRoLnJvdW5kKGwoXCd3dWJNdXNpY1NsaWRlclwnKS52YWx1ZSkpK1wnJVwnOycpOicnKSsqLwogICAgICAgICAgIjxicj4iICsKICAgICAgICAgIChBcHAKICAgICAgICAgICAgPyBHYW1lLldyaXRlUHJlZkJ1dHRvbigKICAgICAgICAgICAgICAgICJiZ011c2ljIiwKICAgICAgICAgICAgICAgICJiZ011c2ljQnV0dG9uIiwKICAgICAgICAgICAgICAgIGxvYygiTXVzaWMgaW4gYmFja2dyb3VuZCIpICsgT04sCiAgICAgICAgICAgICAgICBsb2MoIk11c2ljIGluIGJhY2tncm91bmQiKSArIE9GRiwKICAgICAgICAgICAgICAgICIiCiAgICAgICAgICAgICAgKSArCiAgICAgICAgICAgICAgIjxsYWJlbD4oIiArCiAgICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICAgIm11c2ljIHdpbGwga2VlcCBwbGF5aW5nIGV2ZW4gd2hlbiB0aGUgZ2FtZSB3aW5kb3cgaXNuJ3QgZm9jdXNlZCIKICAgICAgICAgICAgICApICsKICAgICAgICAgICAgICAiKTwvbGFiZWw+PGJyPiIKICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgKEFwcAogICAgICAgICAgICA/IEdhbWUuV3JpdGVQcmVmQnV0dG9uKAogICAgICAgICAgICAgICAgImZ1bGxzY3JlZW4iLAogICAgICAgICAgICAgICAgImZ1bGxzY3JlZW5CdXR0b24iLAogICAgICAgICAgICAgICAgbG9jKCJGdWxsc2NyZWVuIikgKyBPTiwKICAgICAgICAgICAgICAgIGxvYygiRnVsbHNjcmVlbiIpICsgT0ZGLAogICAgICAgICAgICAgICAgIkdhbWUuVG9nZ2xlRnVsbHNjcmVlbigpOyIKICAgICAgICAgICAgICApICsgIjxicj4iCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgIEdhbWUuV3JpdGVQcmVmQnV0dG9uKAogICAgICAgICAgICAiZmFuY3kiLAogICAgICAgICAgICAiZmFuY3lCdXR0b24iLAogICAgICAgICAgICBsb2MoIkZhbmN5IGdyYXBoaWNzIikgKyBPTiwKICAgICAgICAgICAgbG9jKCJGYW5jeSBncmFwaGljcyIpICsgT0ZGLAogICAgICAgICAgICAiR2FtZS5Ub2dnbGVGYW5jeSgpOyIKICAgICAgICAgICkgKwogICAgICAgICAgIjxsYWJlbD4oIiArCiAgICAgICAgICBsb2MoInZpc3VhbCBpbXByb3ZlbWVudHM7IGRpc2FibGluZyBtYXkgaW1wcm92ZSBwZXJmb3JtYW5jZSIpICsKICAgICAgICAgICIpPC9sYWJlbD48YnI+IiArCiAgICAgICAgICBHYW1lLldyaXRlUHJlZkJ1dHRvbigKICAgICAgICAgICAgImZpbHRlcnMiLAogICAgICAgICAgICAiZmlsdGVyc0J1dHRvbiIsCiAgICAgICAgICAgIGxvYygiQ1NTIGZpbHRlcnMiKSArIE9OLAogICAgICAgICAgICBsb2MoIkNTUyBmaWx0ZXJzIikgKyBPRkYsCiAgICAgICAgICAgICJHYW1lLlRvZ2dsZUZpbHRlcnMoKTsiCiAgICAgICAgICApICsKICAgICAgICAgICI8bGFiZWw+KCIgKwogICAgICAgICAgKEVOCiAgICAgICAgICAgID8gImN1dHRpbmctZWRnZSB2aXN1YWwgaW1wcm92ZW1lbnRzOyBkaXNhYmxpbmcgbWF5IGltcHJvdmUgcGVyZm9ybWFuY2UiCiAgICAgICAgICAgIDogbG9jKCJ2aXN1YWwgaW1wcm92ZW1lbnRzOyBkaXNhYmxpbmcgbWF5IGltcHJvdmUgcGVyZm9ybWFuY2UiKSkgKwogICAgICAgICAgIik8L2xhYmVsPjxicj4iICsKICAgICAgICAgIEdhbWUuV3JpdGVQcmVmQnV0dG9uKAogICAgICAgICAgICAicGFydGljbGVzIiwKICAgICAgICAgICAgInBhcnRpY2xlc0J1dHRvbiIsCiAgICAgICAgICAgIGxvYygiUGFydGljbGVzIikgKyBPTiwKICAgICAgICAgICAgbG9jKCJQYXJ0aWNsZXMiKSArIE9GRgogICAgICAgICAgKSArCiAgICAgICAgICAoRU4KICAgICAgICAgICAgPyAiPGxhYmVsPihjb29raWVzIGZhbGxpbmcgZG93biwgZXRjOyBkaXNhYmxpbmcgbWF5IGltcHJvdmUgcGVyZm9ybWFuY2UpPC9sYWJlbD4iCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICI8YnI+IiArCiAgICAgICAgICBHYW1lLldyaXRlUHJlZkJ1dHRvbigKICAgICAgICAgICAgIm51bWJlcnMiLAogICAgICAgICAgICAibnVtYmVyc0J1dHRvbiIsCiAgICAgICAgICAgIGxvYygiTnVtYmVycyIpICsgT04sCiAgICAgICAgICAgIGxvYygiTnVtYmVycyIpICsgT0ZGCiAgICAgICAgICApICsKICAgICAgICAgICI8bGFiZWw+KCIgKwogICAgICAgICAgbG9jKCJudW1iZXJzIHRoYXQgcG9wIHVwIHdoZW4gY2xpY2tpbmcgdGhlIGNvb2tpZSIpICsKICAgICAgICAgICIpPC9sYWJlbD48YnI+IiArCiAgICAgICAgICBHYW1lLldyaXRlUHJlZkJ1dHRvbigKICAgICAgICAgICAgIm1pbGsiLAogICAgICAgICAgICAibWlsa0J1dHRvbiIsCiAgICAgICAgICAgIGxvYygiTWlsayBbc2V0dGluZ10iKSArIE9OLAogICAgICAgICAgICBsb2MoIk1pbGsgW3NldHRpbmddIikgKyBPRkYKICAgICAgICAgICkgKwogICAgICAgICAgKEVOID8gIjxsYWJlbD4ob25seSBhcHBlYXJzIHdpdGggZW5vdWdoIGFjaGlldmVtZW50cyk8L2xhYmVsPiIgOiAiIikgKwogICAgICAgICAgIjxicj4iICsKICAgICAgICAgIEdhbWUuV3JpdGVQcmVmQnV0dG9uKAogICAgICAgICAgICAiY3Vyc29ycyIsCiAgICAgICAgICAgICJjdXJzb3JzQnV0dG9uIiwKICAgICAgICAgICAgbG9jKCJDdXJzb3JzIFtzZXR0aW5nXSIpICsgT04sCiAgICAgICAgICAgIGxvYygiQ3Vyc29ycyBbc2V0dGluZ10iKSArIE9GRgogICAgICAgICAgKSArCiAgICAgICAgICAiPGxhYmVsPigiICsKICAgICAgICAgIGxvYygidmlzdWFsIGRpc3BsYXkgb2YgeW91ciBjdXJzb3JzIikgKwogICAgICAgICAgIik8L2xhYmVsPjxicj4iICsKICAgICAgICAgIEdhbWUuV3JpdGVQcmVmQnV0dG9uKAogICAgICAgICAgICAid29iYmx5IiwKICAgICAgICAgICAgIndvYmJseUJ1dHRvbiIsCiAgICAgICAgICAgIGxvYygiV29iYmx5IGNvb2tpZSIpICsgT04sCiAgICAgICAgICAgIGxvYygiV29iYmx5IGNvb2tpZSIpICsgT0ZGCiAgICAgICAgICApICsKICAgICAgICAgIChFTgogICAgICAgICAgICA/ICI8bGFiZWw+KHlvdXIgY29va2llIHdpbGwgcmVhY3Qgd2hlbiB5b3UgY2xpY2sgaXQpPC9sYWJlbD4iCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICI8YnI+IiArCiAgICAgICAgICBHYW1lLldyaXRlUHJlZkJ1dHRvbigKICAgICAgICAgICAgImNvb2tpZXNvdW5kIiwKICAgICAgICAgICAgImNvb2tpZXNvdW5kQnV0dG9uIiwKICAgICAgICAgICAgbG9jKCJBbHQgY29va2llIHNvdW5kIikgKyBPTiwKICAgICAgICAgICAgbG9jKCJBbHQgY29va2llIHNvdW5kIikgKyBPRkYKICAgICAgICAgICkgKwogICAgICAgICAgKEVOCiAgICAgICAgICAgID8gIjxsYWJlbD4oaG93IHlvdXIgY29va2llIHNvdW5kcyB3aGVuIHlvdSBjbGljayBvbiBpdCk8L2xhYmVsPiIKICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgIjxicj4iICsKICAgICAgICAgIEdhbWUuV3JpdGVQcmVmQnV0dG9uKAogICAgICAgICAgICAiY3JhdGVzIiwKICAgICAgICAgICAgImNyYXRlc0J1dHRvbiIsCiAgICAgICAgICAgIGxvYygiSWNvbiBjcmF0ZXMiKSArIE9OLAogICAgICAgICAgICBsb2MoIkljb24gY3JhdGVzIikgKyBPRkYKICAgICAgICAgICkgKwogICAgICAgICAgIjxsYWJlbD4oIiArCiAgICAgICAgICBsb2MoImRpc3BsYXkgYm94ZXMgYXJvdW5kIHVwZ3JhZGVzIGFuZCBhY2hpZXZlbWVudHMgaW4gU3RhdHMiKSArCiAgICAgICAgICAiKTwvbGFiZWw+PGJyPiIgKwogICAgICAgICAgR2FtZS5Xcml0ZVByZWZCdXR0b24oCiAgICAgICAgICAgICJtb25vc3BhY2UiLAogICAgICAgICAgICAibW9ub3NwYWNlQnV0dG9uIiwKICAgICAgICAgICAgbG9jKCJBbHQgZm9udCIpICsgT04sCiAgICAgICAgICAgIGxvYygiQWx0IGZvbnQiKSArIE9GRgogICAgICAgICAgKSArCiAgICAgICAgICAiPGxhYmVsPigiICsKICAgICAgICAgIGxvYygieW91ciBjb29raWVzIGFyZSBkaXNwbGF5ZWQgdXNpbmcgYSBtb25vc3BhY2UgZm9udCIpICsKICAgICAgICAgICIpPC9sYWJlbD48YnI+IiArCiAgICAgICAgICBHYW1lLldyaXRlUHJlZkJ1dHRvbigKICAgICAgICAgICAgImZvcm1hdCIsCiAgICAgICAgICAgICJmb3JtYXRCdXR0b24iLAogICAgICAgICAgICBsb2MoIlNob3J0IG51bWJlcnMiKSArIE9GRiwKICAgICAgICAgICAgbG9jKCJTaG9ydCBudW1iZXJzIikgKyBPTiwKICAgICAgICAgICAgIkJlYXV0aWZ5QWxsKCk7R2FtZS5SZWZyZXNoU3RvcmUoKTtHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkPTE7IiwKICAgICAgICAgICAgMQogICAgICAgICAgKSArCiAgICAgICAgICAoRU4gPyAiPGxhYmVsPihzaG9ydGVuIGJpZyBudW1iZXJzKTwvbGFiZWw+IiA6ICIiKSArCiAgICAgICAgICAiPGJyPiIgKwogICAgICAgICAgR2FtZS5Xcml0ZVByZWZCdXR0b24oCiAgICAgICAgICAgICJub3RpZnMiLAogICAgICAgICAgICAibm90aWZzQnV0dG9uIiwKICAgICAgICAgICAgbG9jKCJGYXN0IG5vdGVzIikgKyBPTiwKICAgICAgICAgICAgbG9jKCJGYXN0IG5vdGVzIikgKyBPRkYKICAgICAgICAgICkgKwogICAgICAgICAgIjxsYWJlbD4oIiArCiAgICAgICAgICBsb2MoIm5vdGlmaWNhdGlvbnMgZGlzYXBwZWFyIG11Y2ggZmFzdGVyIikgKwogICAgICAgICAgIik8L2xhYmVsPjxicj4iICsKICAgICAgICAgIC8vR2FtZS5Xcml0ZVByZWZCdXR0b24oJ2F1dG91cGRhdGUnLCdhdXRvdXBkYXRlQnV0dG9uJywnT2ZmbGluZSBtb2RlIE9GRicsJ09mZmxpbmUgbW9kZSBPTicsMCwxKSsnPGxhYmVsPihkaXNhYmxlcyB1cGRhdGUgbm90aWZpY2F0aW9ucyk8L2xhYmVsPjxicj4nKwogICAgICAgICAgKCFBcHAKICAgICAgICAgICAgPyBHYW1lLldyaXRlUHJlZkJ1dHRvbigKICAgICAgICAgICAgICAgICJ3YXJuIiwKICAgICAgICAgICAgICAgICJ3YXJuQnV0dG9uIiwKICAgICAgICAgICAgICAgIGxvYygiQ2xvc2luZyB3YXJuaW5nIikgKyBPTiwKICAgICAgICAgICAgICAgIGxvYygiQ2xvc2luZyB3YXJuaW5nIikgKyBPRkYKICAgICAgICAgICAgICApICsKICAgICAgICAgICAgICAiPGxhYmVsPigiICsKICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAidGhlIGdhbWUgd2lsbCBhc2sgeW91IHRvIGNvbmZpcm0gd2hlbiB5b3UgY2xvc2UgdGhlIHdpbmRvdyIKICAgICAgICAgICAgICApICsKICAgICAgICAgICAgICAiKTwvbGFiZWw+PGJyPiIKICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgLy9HYW1lLldyaXRlUHJlZkJ1dHRvbignZm9jdXMnLCdmb2N1c0J1dHRvbicsbG9jKCJEZWZvY3VzIikrT0ZGLGxvYygiRGVmb2N1cyIpK09OLDAsMSkrJzxsYWJlbD4oJytsb2MoInRoZSBnYW1lIHdpbGwgYmUgbGVzcyByZXNvdXJjZS1pbnRlbnNpdmUgd2hlbiBvdXQgb2YgZm9jdXMiKSsnKTwvbGFiZWw+PGJyPicrCiAgICAgICAgICBHYW1lLldyaXRlUHJlZkJ1dHRvbigKICAgICAgICAgICAgImV4dHJhQnV0dG9ucyIsCiAgICAgICAgICAgICJleHRyYUJ1dHRvbnNCdXR0b24iLAogICAgICAgICAgICBsb2MoIkV4dHJhIGJ1dHRvbnMiKSArIE9OLAogICAgICAgICAgICBsb2MoIkV4dHJhIGJ1dHRvbnMiKSArIE9GRiwKICAgICAgICAgICAgIkdhbWUuVG9nZ2xlRXh0cmFCdXR0b25zKCk7IgogICAgICAgICAgKSArCiAgICAgICAgICAiPGxhYmVsPigiICsKICAgICAgICAgIGxvYygiYWRkIG9wdGlvbnMgb24gYnVpbGRpbmdzIGxpa2UgTXV0ZSIpICsKICAgICAgICAgICIpPC9sYWJlbD48YnI+IiArCiAgICAgICAgICBHYW1lLldyaXRlUHJlZkJ1dHRvbigKICAgICAgICAgICAgImFza0x1bXBzIiwKICAgICAgICAgICAgImFza0x1bXBzQnV0dG9uIiwKICAgICAgICAgICAgbG9jKCJMdW1wIGNvbmZpcm1hdGlvbiIpICsgT04sCiAgICAgICAgICAgIGxvYygiTHVtcCBjb25maXJtYXRpb24iKSArIE9GRgogICAgICAgICAgKSArCiAgICAgICAgICAiPGxhYmVsPigiICsKICAgICAgICAgIGxvYygidGhlIGdhbWUgd2lsbCBhc2sgeW91IHRvIGNvbmZpcm0gYmVmb3JlIHNwZW5kaW5nIHN1Z2FyIGx1bXBzIikgKwogICAgICAgICAgIik8L2xhYmVsPjxicj4iICsKICAgICAgICAgICghQXBwCiAgICAgICAgICAgID8gR2FtZS5Xcml0ZVByZWZCdXR0b24oCiAgICAgICAgICAgICAgICAiY3VzdG9tR3JhbmRtYXMiLAogICAgICAgICAgICAgICAgImN1c3RvbUdyYW5kbWFzQnV0dG9uIiwKICAgICAgICAgICAgICAgIGxvYygiQ3VzdG9tIGdyYW5kbWFzIikgKyBPTiwKICAgICAgICAgICAgICAgIGxvYygiQ3VzdG9tIGdyYW5kbWFzIikgKyBPRkYKICAgICAgICAgICAgICApICsKICAgICAgICAgICAgICAiPGxhYmVsPigiICsKICAgICAgICAgICAgICBsb2MoInNvbWUgZ3JhbmRtYXMgd2lsbCBiZSBuYW1lZCBhZnRlciBQYXRyZW9uIHN1cHBvcnRlcnMiKSArCiAgICAgICAgICAgICAgIik8L2xhYmVsPjxicj4iCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgIEdhbWUuV3JpdGVQcmVmQnV0dG9uKAogICAgICAgICAgICAibm90U2NhcnkiLAogICAgICAgICAgICAibm90U2NhcnlCdXR0b24iLAogICAgICAgICAgICBsb2MoIlNjYXJ5IHN0dWZmIikgKyBPRkYsCiAgICAgICAgICAgIGxvYygiU2Nhcnkgc3R1ZmYiKSArIE9OLAogICAgICAgICAgICAwLAogICAgICAgICAgICAxCiAgICAgICAgICApICsKICAgICAgICAgICI8YnI+IiArCiAgICAgICAgICBHYW1lLldyaXRlUHJlZkJ1dHRvbigKICAgICAgICAgICAgInRpbWVvdXQiLAogICAgICAgICAgICAidGltZW91dEJ1dHRvbiIsCiAgICAgICAgICAgIGxvYygiU2xlZXAgbW9kZSB0aW1lb3V0IikgKyBPTiwKICAgICAgICAgICAgbG9jKCJTbGVlcCBtb2RlIHRpbWVvdXQiKSArIE9GRgogICAgICAgICAgKSArCiAgICAgICAgICAiPGxhYmVsPigiICsKICAgICAgICAgIGxvYygKICAgICAgICAgICAgIm9uIHNsb3dlciBjb21wdXRlcnMsIHRoZSBnYW1lIHdpbGwgcHV0IGl0c2VsZiBpbiBzbGVlcCBtb2RlIHdoZW4gaXQncyBpbmFjdGl2ZSBhbmQgc3RhcnRzIHRvIGxhZyBvdXQ7IG9mZmxpbmUgQ3BTIHByb2R1Y3Rpb24ga2lja3MgaW4gZHVyaW5nIHNsZWVwIG1vZGUiCiAgICAgICAgICApICsKICAgICAgICAgICIpPC9sYWJlbD48YnI+IiArCiAgICAgICAgICBHYW1lLldyaXRlUHJlZkJ1dHRvbigKICAgICAgICAgICAgInNjcmVlbnJlYWRlciIsCiAgICAgICAgICAgICJzY3JlZW5yZWFkZXJCdXR0b24iLAogICAgICAgICAgICBsb2MoIlNjcmVlbiByZWFkZXIgbW9kZSIpICsgT04sCiAgICAgICAgICAgIGxvYygiU2NyZWVuIHJlYWRlciBtb2RlIikgKyBPRkYsCiAgICAgICAgICAgICJHYW1lLnRvU2F2ZT10cnVlO0dhbWUudG9SZWxvYWQ9dHJ1ZTsiCiAgICAgICAgICApICsKICAgICAgICAgICI8bGFiZWw+KCIgKwogICAgICAgICAgbG9jKCJhbGxvd3Mgb3B0aW1pemF0aW9ucyBmb3Igc2NyZWVuIHJlYWRlcnM7IGdhbWUgd2lsbCByZWxvYWQiKSArCiAgICAgICAgICAiKTwvbGFiZWw+PGJyPiIgKwogICAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICAgLy8nPGRpdiBjbGFzcz0ibGlzdGluZyI+JytHYW1lLldyaXRlUHJlZkJ1dHRvbignYXV0b3NhdmUnLCdhdXRvc2F2ZUJ1dHRvbicsJ0F1dG9zYXZlIE9OJywnQXV0b3NhdmUgT0ZGJykrJzwvZGl2PicrCiAgICAgICAgICAoIUFwcAogICAgICAgICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48YSBjbGFzcz0ib3B0aW9uIHNtYWxsRmFuY3lCdXR0b24iICcgKwogICAgICAgICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICAgICAgICI9XCJHYW1lLkNoZWNrTW9kRGF0YSgpO1BsYXlTb3VuZCgnc25kL3RpY2subXAzJyk7XCI+IiArCiAgICAgICAgICAgICAgbG9jKCJDaGVjayBtb2QgZGF0YSIpICsKICAgICAgICAgICAgICAiPC9hPjxsYWJlbD4oIiArCiAgICAgICAgICAgICAgbG9jKCJ2aWV3IGFuZCBkZWxldGUgc2F2ZSBkYXRhIGNyZWF0ZWQgYnkgbW9kcyIpICsKICAgICAgICAgICAgICAiKTwvbGFiZWw+PC9kaXY+IgogICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAiPC9kaXY+IjsKCiAgICAgICAgaWYgKEFwcCAmJiBBcHAud3JpdGVNb2RVSSkgewogICAgICAgICAgc3RyICs9CiAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJibG9jayIgc3R5bGU9InBhZGRpbmc6MHB4O21hcmdpbjo4cHggNHB4OyI+JyArCiAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIiBzdHlsZT0icGFkZGluZzowcHg7Ij4nICsKICAgICAgICAgICAgJzxkaXYgY2xhc3M9InRpdGxlIj4nICsKICAgICAgICAgICAgbG9jKCJNb2RzIikgKwogICAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAgIEFwcC53cml0ZU1vZFVJKCkgKwogICAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAgICI8L2Rpdj4iOwogICAgICAgIH0KCiAgICAgICAgc3RyICs9ICc8ZGl2IHN0eWxlPSJoZWlnaHQ6MTI4cHg7Ij48L2Rpdj4nOwogICAgICB9IGVsc2UgaWYgKEdhbWUub25NZW51ID09ICJsb2ciKSB7CiAgICAgICAgLy9zdHIrPXJlcGxhY2VBbGwoJ1tiYWtlcnlOYW1lXScsR2FtZS5iYWtlcnlOYW1lLEdhbWUudXBkYXRlTG9nKTsKICAgICAgICBzdHIgKz0gR2FtZS51cGRhdGVMb2c7CiAgICAgICAgaWYgKCFHYW1lLkhhc0FjaGlldigiT2xkZW4gZGF5cyIpKQogICAgICAgICAgc3RyICs9CiAgICAgICAgICAgICc8ZGl2IGlkPSJvbGRlbkRheXMiIHN0eWxlPSJ0ZXh0LWFsaWduOnJpZ2h0O3dpZHRoOjEwMCU7Ij48ZGl2ICcgKwogICAgICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAgICAgIj1cIkdhbWUuU3BhcmtsZUF0KEdhbWUubW91c2VYLEdhbWUubW91c2VZKTtQbGF5U291bmQoJ3NuZC90aWNrLm1wMycpO1BsYXlTb3VuZCgnc25kL3NoaW1tZXJDbGljay5tcDMnKTtHYW1lLldpbignT2xkZW4gZGF5cycpO0dhbWUuVXBkYXRlTWVudSgpO1wiIGNsYXNzPVwiaWNvblwiIHN0eWxlPVwiZGlzcGxheTppbmxpbmUtYmxvY2s7dHJhbnNmb3JtOnNjYWxlKDAuNSk7Y3Vyc29yOnBvaW50ZXI7d2lkdGg6NDhweDtoZWlnaHQ6NDhweDtiYWNrZ3JvdW5kLXBvc2l0aW9uOiIgKwogICAgICAgICAgICAtMTIgKiA0OCArCiAgICAgICAgICAgICJweCAiICsKICAgICAgICAgICAgLTMgKiA0OCArCiAgICAgICAgICAgICdweDsiPjwvZGl2PjwvZGl2Pic7CiAgICAgIH0gZWxzZSBpZiAoR2FtZS5vbk1lbnUgPT0gInN0YXRzIikgewogICAgICAgIHZhciBidWlsZGluZ3NPd25lZCA9IDA7CiAgICAgICAgYnVpbGRpbmdzT3duZWQgPSBHYW1lLkJ1aWxkaW5nc093bmVkOwogICAgICAgIHZhciB1cGdyYWRlcyA9ICIiOwogICAgICAgIHZhciBjb29raWVVcGdyYWRlcyA9ICIiOwogICAgICAgIHZhciBoaWRkZW5VcGdyYWRlcyA9ICIiOwogICAgICAgIHZhciBwcmVzdGlnZVVwZ3JhZGVzID0gIiI7CiAgICAgICAgdmFyIHVwZ3JhZGVzVG90YWwgPSAwOwogICAgICAgIHZhciB1cGdyYWRlc093bmVkID0gMDsKICAgICAgICB2YXIgcHJlc3RpZ2VVcGdyYWRlc1RvdGFsID0gMDsKICAgICAgICB2YXIgcHJlc3RpZ2VVcGdyYWRlc093bmVkID0gMDsKCiAgICAgICAgdmFyIGxpc3QgPSBbXTsKICAgICAgICAvL3NvcnQgdGhlIHVwZ3JhZGVzCiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlVwZ3JhZGVzKSB7CiAgICAgICAgICBsaXN0LnB1c2goR2FtZS5VcGdyYWRlc1tpXSk7CiAgICAgICAgfSAvL2Nsb25lIGZpcnN0CiAgICAgICAgdmFyIHNvcnRNYXAgPSBmdW5jdGlvbiAoYSwgYikgewogICAgICAgICAgaWYgKGEub3JkZXIgPiBiLm9yZGVyKSByZXR1cm4gMTsKICAgICAgICAgIGVsc2UgaWYgKGEub3JkZXIgPCBiLm9yZGVyKSByZXR1cm4gLTE7CiAgICAgICAgICBlbHNlIHJldHVybiAwOwogICAgICAgIH07CiAgICAgICAgbGlzdC5zb3J0KHNvcnRNYXApOwogICAgICAgIGZvciAodmFyIGkgaW4gbGlzdCkgewogICAgICAgICAgdmFyIHN0cjIgPSAiIjsKICAgICAgICAgIHZhciBtZSA9IGxpc3RbaV07CgogICAgICAgICAgc3RyMiArPSBHYW1lLmNyYXRlKG1lLCAic3RhdHMiKTsKCiAgICAgICAgICBpZiAobWUuYm91Z2h0KSB7CiAgICAgICAgICAgIGlmIChHYW1lLkNvdW50c0FzVXBncmFkZU93bmVkKG1lLnBvb2wpKSB1cGdyYWRlc093bmVkKys7CiAgICAgICAgICAgIGVsc2UgaWYgKG1lLnBvb2wgPT0gInByZXN0aWdlIikgcHJlc3RpZ2VVcGdyYWRlc093bmVkKys7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKG1lLnBvb2wgPT0gIiIgfHwgbWUucG9vbCA9PSAiY29va2llIiB8fCBtZS5wb29sID09ICJ0ZWNoIikKICAgICAgICAgICAgdXBncmFkZXNUb3RhbCsrOwogICAgICAgICAgaWYgKG1lLnBvb2wgPT0gImRlYnVnIikgaGlkZGVuVXBncmFkZXMgKz0gc3RyMjsKICAgICAgICAgIGVsc2UgaWYgKG1lLnBvb2wgPT0gInByZXN0aWdlIikgewogICAgICAgICAgICBwcmVzdGlnZVVwZ3JhZGVzICs9IHN0cjI7CiAgICAgICAgICAgIHByZXN0aWdlVXBncmFkZXNUb3RhbCsrOwogICAgICAgICAgfSBlbHNlIGlmIChtZS5wb29sID09ICJjb29raWUiKSBjb29raWVVcGdyYWRlcyArPSBzdHIyOwogICAgICAgICAgZWxzZSBpZiAobWUucG9vbCAhPSAidG9nZ2xlIiAmJiBtZS5wb29sICE9ICJ1bnVzZWQiKSB1cGdyYWRlcyArPSBzdHIyOwogICAgICAgIH0KICAgICAgICB2YXIgYWNoaWV2ZW1lbnRzID0gW107CiAgICAgICAgdmFyIGFjaGlldmVtZW50c093bmVkID0gMDsKICAgICAgICB2YXIgYWNoaWV2ZW1lbnRzT3duZWRPdGhlciA9IDA7CiAgICAgICAgdmFyIGFjaGlldmVtZW50c1RvdGFsID0gMDsKCiAgICAgICAgdmFyIGxpc3QgPSBbXTsKICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuQWNoaWV2ZW1lbnRzKSB7IC8vc29ydCB0aGUgYWNoaWV2ZW1lbnRzCiAgICAgICAgICBsaXN0LnB1c2goR2FtZS5BY2hpZXZlbWVudHNbaV0pOwogICAgICAgIH0KICAgICAgICB2YXIgc29ydE1hcCA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgICBpZiAoYS5vcmRlciA+IGIub3JkZXIpIHJldHVybiAxOwogICAgICAgICAgZWxzZSBpZiAoYS5vcmRlciA8IGIub3JkZXIpIHJldHVybiAtMTsKICAgICAgICAgIGVsc2UgcmV0dXJuIDA7CiAgICAgICAgfTsKICAgICAgICBsaXN0LnNvcnQoc29ydE1hcCk7CgogICAgICAgIGZvciAodmFyIGkgaW4gbGlzdCkgewogICAgICAgICAgdmFyIG1lID0gbGlzdFtpXTsKICAgICAgICAgIC8vaWYgKG1lLnBvb2w9PSdub3JtYWwnIHx8IG1lLndvbj4wKSBhY2hpZXZlbWVudHNUb3RhbCsrOwogICAgICAgICAgaWYgKEdhbWUuQ291bnRzQXNBY2hpZXZlbWVudE93bmVkKG1lLnBvb2wpKSBhY2hpZXZlbWVudHNUb3RhbCsrOwogICAgICAgICAgdmFyIHBvb2wgPSBtZS5wb29sOwogICAgICAgICAgaWYgKCFhY2hpZXZlbWVudHNbcG9vbF0pIGFjaGlldmVtZW50c1twb29sXSA9ICIiOwogICAgICAgICAgYWNoaWV2ZW1lbnRzW3Bvb2xdICs9IEdhbWUuY3JhdGUobWUsICJzdGF0cyIpOwoKICAgICAgICAgIGlmIChtZS53b24pIHsKICAgICAgICAgICAgaWYgKEdhbWUuQ291bnRzQXNBY2hpZXZlbWVudE93bmVkKG1lLnBvb2wpKSBhY2hpZXZlbWVudHNPd25lZCsrOwogICAgICAgICAgICBlbHNlIGFjaGlldmVtZW50c093bmVkT3RoZXIrKzsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHZhciBhY2hpZXZlbWVudHNTdHIgPSAiIjsKICAgICAgICB2YXIgcG9vbHMgPSB7CiAgICAgICAgICBkdW5nZW9uOiBFTgogICAgICAgICAgICA/ICI8Yj5EdW5nZW9uIGFjaGlldmVtZW50czwvYj4gPHNtYWxsPihOb3QgdGVjaG5pY2FsbHkgYWNoaWV2YWJsZSB5ZXQuKTwvc21hbGw+IgogICAgICAgICAgICA6ICI8Yj4/Pz88L2I+IiwKICAgICAgICAgIHNoYWRvdzoKICAgICAgICAgICAgIjxiPiIgKwogICAgICAgICAgICBsb2MoIlNoYWRvdyBhY2hpZXZlbWVudHMiKSArCiAgICAgICAgICAgICI8L2I+IDxzbWFsbD4oIiArCiAgICAgICAgICAgIGxvYygKICAgICAgICAgICAgICAiVGhlc2UgYXJlIGZlYXRzIHRoYXQgYXJlIGVpdGhlciB1bmZhaXIgb3IgZGlmZmljdWx0IHRvIGF0dGFpbi4gVGhleSBkbyBub3QgZ2l2ZSBtaWxrLiIKICAgICAgICAgICAgKSArCiAgICAgICAgICAgICIpPC9zbWFsbD4iLAogICAgICAgIH07CiAgICAgICAgZm9yICh2YXIgaSBpbiBhY2hpZXZlbWVudHMpIHsKICAgICAgICAgIGlmIChhY2hpZXZlbWVudHNbaV0gIT0gIiIpIHsKICAgICAgICAgICAgaWYgKHBvb2xzW2ldKQogICAgICAgICAgICAgIGFjaGlldmVtZW50c1N0ciArPSAnPGRpdiBjbGFzcz0ibGlzdGluZyI+JyArIHBvb2xzW2ldICsgIjwvZGl2PiI7CiAgICAgICAgICAgIGFjaGlldmVtZW50c1N0ciArPQogICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIGNyYXRlQm94Ij4nICsgYWNoaWV2ZW1lbnRzW2ldICsgIjwvZGl2PiI7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB2YXIgbWlsa1N0ciA9ICIiOwogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgR2FtZS5NaWxrcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgaWYgKEdhbWUubWlsa1Byb2dyZXNzID49IGkpIHsKICAgICAgICAgICAgdmFyIG1pbGsgPSBHYW1lLk1pbGtzW2ldOwogICAgICAgICAgICBtaWxrU3RyICs9CiAgICAgICAgICAgICAgIjxkaXYgIiArCiAgICAgICAgICAgICAgR2FtZS5nZXRUb29sdGlwKAogICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9InByb21wdCIgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyO3BhZGRpbmctYm90dG9tOjZweDt3aGl0ZS1zcGFjZTpub3dyYXA7bWFyZ2luOjBweDtwYWRkaW5nLWJvdHRvbTo5NnB4OyIgaWQ9InRvb2x0aXBNaWxrIj48aDMgc3R5bGU9Im1hcmdpbjo2cHggMzJweCAwcHggMzJweDsiPicgKwogICAgICAgICAgICAgICAgICAobG9jKCJSYW5rICUxIiwgcm9tYW5pemUoaSArIDEpKSArICIgLSAiICsgbWlsay5uYW1lKSArCiAgICAgICAgICAgICAgICAgICc8L2gzPjxkaXYgc3R5bGU9Im9wYWNpdHk6MC43NTtmb250LXNpemU6OXB4OyI+KCcgKwogICAgICAgICAgICAgICAgICAoaSA9PSAwCiAgICAgICAgICAgICAgICAgICAgPyBsb2MoInN0YXJ0ZXIgbWlsayIpCiAgICAgICAgICAgICAgICAgICAgOiBsb2MoImZvciAlMSBhY2hpZXZlbWVudHMiLCBCZWF1dGlmeShpICogMjUpKSkgKwogICAgICAgICAgICAgICAgICAnKTwvZGl2PjxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PjxkaXYgc3R5bGU9IndpZHRoOjEwMCU7aGVpZ2h0Ojk2cHg7cG9zaXRpb246YWJzb2x1dGU7bGVmdDowcHg7Ym90dG9tOjBweDtiYWNrZ3JvdW5kOnVybChpbWcvJyArCiAgICAgICAgICAgICAgICAgIG1pbGsucGljICsKICAgICAgICAgICAgICAgICAgJyk7Ij48L2Rpdj48L2Rpdj4nLAogICAgICAgICAgICAgICAgInRvcCIKICAgICAgICAgICAgICApICsKICAgICAgICAgICAgICAnIHN0eWxlPSJiYWNrZ3JvdW5kOnVybChpbWcvaWNvbnMucG5nP3Y9JyArCiAgICAgICAgICAgICAgR2FtZS52ZXJzaW9uICsKICAgICAgICAgICAgICAiKSAiICsKICAgICAgICAgICAgICAtbWlsay5pY29uWzBdICogNDggKwogICAgICAgICAgICAgICJweCAiICsKICAgICAgICAgICAgICAtbWlsay5pY29uWzFdICogNDggKwogICAgICAgICAgICAgICdweDttYXJnaW46MnB4IDBweDsiIGNsYXNzPSJ0cm9waHkiPjwvZGl2Pic7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIG1pbGtTdHIgKz0gJzxkaXYgc3R5bGU9ImNsZWFyOmJvdGg7Ij48L2Rpdj4nOwoKICAgICAgICB2YXIgc2FudGFTdHIgPSAiIjsKICAgICAgICB2YXIgZnJhbWVzID0gMTU7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJBIGZlc3RpdmUgaGF0IikpIHsKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDw9IEdhbWUuc2FudGFMZXZlbDsgaSsrKSB7CiAgICAgICAgICAgIHNhbnRhU3RyICs9CiAgICAgICAgICAgICAgIjxkaXYgIiArCiAgICAgICAgICAgICAgR2FtZS5nZXRUb29sdGlwKAogICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9InByb21wdCIgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyO3BhZGRpbmctYm90dG9tOjZweDt3aGl0ZS1zcGFjZTpub3dyYXA7bWFyZ2luOjBweCAzMnB4OyI+PGRpdiBzdHlsZT0id2lkdGg6OTZweDtoZWlnaHQ6OTZweDttYXJnaW46NHB4IGF1dG87YmFja2dyb3VuZDp1cmwoaW1nL3NhbnRhLnBuZykgJyArCiAgICAgICAgICAgICAgICAgIC1pICogOTYgKwogICAgICAgICAgICAgICAgICAncHggMHB4O2ZpbHRlcjpkcm9wLXNoYWRvdygwcHggM3B4IDJweCAjMDAwKTstd2Via2l0LWZpbHRlcjpkcm9wLXNoYWRvdygwcHggM3B4IDJweCAjMDAwKTsiIGlkPSJ0b29sdGlwU2FudGEiPjwvZGl2PjxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PjxoMz4nICsKICAgICAgICAgICAgICAgICAgR2FtZS5zYW50YUxldmVsc1tpXSArCiAgICAgICAgICAgICAgICAgICI8L2gzPjwvZGl2PiIsCiAgICAgICAgICAgICAgICAidG9wIgogICAgICAgICAgICAgICkgKwogICAgICAgICAgICAgICcgc3R5bGU9ImJhY2tncm91bmQ6dXJsKGltZy9zYW50YS5wbmcpICcgKwogICAgICAgICAgICAgIC1pICogNDggKwogICAgICAgICAgICAgICJweCAwcHg7YmFja2dyb3VuZC1zaXplOiIgKwogICAgICAgICAgICAgIGZyYW1lcyAqIDQ4ICsKICAgICAgICAgICAgICAncHggNDhweDsiIGNsYXNzPSJ0cm9waHkiPjwvZGl2Pic7CiAgICAgICAgICB9CiAgICAgICAgICBzYW50YVN0ciArPSAnPGRpdiBzdHlsZT0iY2xlYXI6Ym90aDsiPjwvZGl2Pic7CiAgICAgICAgfQogICAgICAgIHZhciBkcmFnb25TdHIgPSAiIjsKICAgICAgICB2YXIgZnJhbWVzID0gOTsKICAgICAgICB2YXIgbWFpbkxldmVscyA9IFsKICAgICAgICAgIDAsCiAgICAgICAgICA0LAogICAgICAgICAgOCwKICAgICAgICAgIEdhbWUuZHJhZ29uTGV2ZWxzLmxlbmd0aCAtIDMsCiAgICAgICAgICBHYW1lLmRyYWdvbkxldmVscy5sZW5ndGggLSAyLAogICAgICAgICAgR2FtZS5kcmFnb25MZXZlbHMubGVuZ3RoIC0gMSwKICAgICAgICBdOwogICAgICAgIGlmIChHYW1lLkhhcygiQSBjcnVtYmx5IGVnZyIpKSB7CiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8PSBtYWluTGV2ZWxzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChHYW1lLmRyYWdvbkxldmVsID49IG1haW5MZXZlbHNbaV0pIHsKICAgICAgICAgICAgICB2YXIgbGV2ZWwgPSBHYW1lLmRyYWdvbkxldmVsc1ttYWluTGV2ZWxzW2ldXTsKICAgICAgICAgICAgICBkcmFnb25TdHIgKz0KICAgICAgICAgICAgICAgICI8ZGl2ICIgKwogICAgICAgICAgICAgICAgR2FtZS5nZXRUb29sdGlwKAogICAgICAgICAgICAgICAgICAvLyc8ZGl2IHN0eWxlPSJ3aWR0aDo5NnB4O2hlaWdodDo5NnB4O21hcmdpbjo0cHggYXV0bztiYWNrZ3JvdW5kOnVybChpbWcvZHJhZ29uLnBuZz92PScrR2FtZS52ZXJzaW9uKycpICcrKC1sZXZlbC5waWMqOTYpKydweCAwcHg7Ij48L2Rpdj48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj48ZGl2IHN0eWxlPSJtaW4td2lkdGg6MjAwcHg7dGV4dC1hbGlnbjpjZW50ZXI7bWFyZ2luLWJvdHRvbTo2cHg7Ij4nK2xldmVsLm5hbWUrJzwvZGl2PicKICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9InByb21wdCIgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyO3BhZGRpbmctYm90dG9tOjZweDt3aGl0ZS1zcGFjZTpub3dyYXA7bWFyZ2luOjBweCAzMnB4OyIgaWQ9InRvb2x0aXBEcmFnb24iPjxkaXYgc3R5bGU9IndpZHRoOjk2cHg7aGVpZ2h0Ojk2cHg7bWFyZ2luOjRweCBhdXRvO2JhY2tncm91bmQ6dXJsKGltZy9kcmFnb24ucG5nP3Y9JyArCiAgICAgICAgICAgICAgICAgICAgR2FtZS52ZXJzaW9uICsKICAgICAgICAgICAgICAgICAgICAiKSAiICsKICAgICAgICAgICAgICAgICAgICAtbGV2ZWwucGljICogOTYgKwogICAgICAgICAgICAgICAgICAgICdweCAwcHg7ZmlsdGVyOmRyb3Atc2hhZG93KDBweCAzcHggMnB4ICMwMDApOy13ZWJraXQtZmlsdGVyOmRyb3Atc2hhZG93KDBweCAzcHggMnB4ICMwMDApOyI+PC9kaXY+PGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+PGgzPicgKwogICAgICAgICAgICAgICAgICAgIGxldmVsLm5hbWUgKwogICAgICAgICAgICAgICAgICAgICI8L2gzPjwvZGl2PiIsCiAgICAgICAgICAgICAgICAgICJ0b3AiCiAgICAgICAgICAgICAgICApICsKICAgICAgICAgICAgICAgICcgc3R5bGU9ImJhY2tncm91bmQ6dXJsKGltZy9kcmFnb24ucG5nP3Y9JyArCiAgICAgICAgICAgICAgICBHYW1lLnZlcnNpb24gKwogICAgICAgICAgICAgICAgIikgIiArCiAgICAgICAgICAgICAgICAtbGV2ZWwucGljICogNDggKwogICAgICAgICAgICAgICAgInB4IDBweDtiYWNrZ3JvdW5kLXNpemU6IiArCiAgICAgICAgICAgICAgICBmcmFtZXMgKiA0OCArCiAgICAgICAgICAgICAgICAncHggNDhweDsiIGNsYXNzPSJ0cm9waHkiPjwvZGl2Pic7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGRyYWdvblN0ciArPSAnPGRpdiBzdHlsZT0iY2xlYXI6Ym90aDsiPjwvZGl2Pic7CiAgICAgICAgfQogICAgICAgIHZhciBhc2NlbnNpb25Nb2RlU3RyID0gIiI7CiAgICAgICAgdmFyIGljb24gPSBHYW1lLmFzY2Vuc2lvbk1vZGVzW0dhbWUuYXNjZW5zaW9uTW9kZV0uaWNvbjsKICAgICAgICBpZiAoR2FtZS5yZXNldHMgPiAwKQogICAgICAgICAgYXNjZW5zaW9uTW9kZVN0ciA9CiAgICAgICAgICAgICc8c3BhbiBzdHlsZT0iY3Vyc29yOnBvaW50ZXI7IiAnICsKICAgICAgICAgICAgR2FtZS5nZXRUb29sdGlwKAogICAgICAgICAgICAgICc8ZGl2IHN0eWxlPSJtaW4td2lkdGg6MjAwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Zm9udC1zaXplOjExcHg7IiBpZD0idG9vbHRpcENoYWxsZW5nZU1vZGUiPicgKwogICAgICAgICAgICAgICAgR2FtZS5hc2NlbnNpb25Nb2Rlc1tHYW1lLmFzY2Vuc2lvbk1vZGVdLmRlc2MgKwogICAgICAgICAgICAgICAgIjwvZGl2PiIsCiAgICAgICAgICAgICAgInRvcCIKICAgICAgICAgICAgKSArCiAgICAgICAgICAgICc+PGRpdiBjbGFzcz0iaWNvbiIgc3R5bGU9ImRpc3BsYXk6aW5saW5lLWJsb2NrO2Zsb2F0Om5vbmU7dHJhbnNmb3JtOnNjYWxlKDAuNSk7bWFyZ2luOi0yNHB4IC0xNnB4IC0xOXB4IC04cHg7JyArCiAgICAgICAgICAgIHdyaXRlSWNvbihpY29uKSArCiAgICAgICAgICAgICciPjwvZGl2PicgKwogICAgICAgICAgICBHYW1lLmFzY2Vuc2lvbk1vZGVzW0dhbWUuYXNjZW5zaW9uTW9kZV0uZG5hbWUgKwogICAgICAgICAgICAiPC9zcGFuPiI7CgogICAgICAgIHZhciBtaWxrTmFtZSA9IEdhbWUuTWlsay5uYW1lOwoKICAgICAgICB2YXIgcmVzZWFyY2hTdHIgPSBHYW1lLnNheVRpbWUoR2FtZS5yZXNlYXJjaFQsIC0xKTsKICAgICAgICB2YXIgcGxlZGdlU3RyID0gR2FtZS5zYXlUaW1lKEdhbWUucGxlZGdlVCwgLTEpOwogICAgICAgIHZhciB3cmF0aFN0ciA9ICIiOwogICAgICAgIGlmIChHYW1lLmVsZGVyV3JhdGggPT0gMSkgd3JhdGhTdHIgPSBsb2MoImF3b2tlbiIpOwogICAgICAgIGVsc2UgaWYgKEdhbWUuZWxkZXJXcmF0aCA9PSAyKSB3cmF0aFN0ciA9IGxvYygiZGlzcGxlYXNlZCIpOwogICAgICAgIGVsc2UgaWYgKEdhbWUuZWxkZXJXcmF0aCA9PSAzKSB3cmF0aFN0ciA9IGxvYygiYW5nZXJlZCIpOwogICAgICAgIGVsc2UgaWYgKEdhbWUuZWxkZXJXcmF0aCA9PSAwICYmIEdhbWUucGxlZGdlcyA+IDApCiAgICAgICAgICB3cmF0aFN0ciA9IGxvYygiYXBwZWFzZWQiKTsKCiAgICAgICAgdmFyIGRyb3BNdWx0ID0gR2FtZS5kcm9wUmF0ZU11bHQoKTsKCiAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgpOwogICAgICAgIGRhdGUuc2V0VGltZShEYXRlLm5vdygpIC0gR2FtZS5zdGFydERhdGUpOwogICAgICAgIHZhciB0aW1lSW5TZWNvbmRzID0gZGF0ZS5nZXRUaW1lKCkgLyAxMDAwOwogICAgICAgIHZhciBzdGFydERhdGUgPSBHYW1lLnNheVRpbWUodGltZUluU2Vjb25kcyAqIEdhbWUuZnBzLCAtMSk7CiAgICAgICAgZGF0ZS5zZXRUaW1lKERhdGUubm93KCkgLSBHYW1lLmZ1bGxEYXRlKTsKICAgICAgICB2YXIgZnVsbERhdGUgPSBHYW1lLnNheVRpbWUoKGRhdGUuZ2V0VGltZSgpIC8gMTAwMCkgKiBHYW1lLmZwcywgLTEpOwogICAgICAgIGlmICghR2FtZS5mdWxsRGF0ZSB8fCAhZnVsbERhdGUgfHwgZnVsbERhdGUubGVuZ3RoIDwgMSkKICAgICAgICAgIGZ1bGxEYXRlID0gbG9jKCJhIGxvbmcgd2hpbGUiKTsKICAgICAgICAvKmRhdGUuc2V0VGltZShuZXcgRGF0ZSgpLmdldFRpbWUoKS1HYW1lLmxhc3REYXRlKTsKCQkJCXZhciBsYXN0RGF0ZT1HYW1lLnNheVRpbWUoZGF0ZS5nZXRUaW1lKCkvMTAwMCpHYW1lLmZwcywyKTsqLwoKICAgICAgICB2YXIgaGVhdmVubHlNdWx0ID0gR2FtZS5HZXRIZWF2ZW5seU11bHRpcGxpZXIoKTsKCiAgICAgICAgdmFyIHNlYXNvblN0ciA9IEdhbWUuc2F5VGltZShHYW1lLnNlYXNvblQsIC0xKTsKCiAgICAgICAgc3RyICs9CiAgICAgICAgICAnPGRpdiBjbGFzcz0ic2VjdGlvbiI+JyArCiAgICAgICAgICAoRU4gPyAiU3RhdGlzdGljcyIgOiBsb2MoIlN0YXRzIikpICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIj4nICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+JyArCiAgICAgICAgICBsb2MoIkdlbmVyYWwiKSArCiAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAnPGRpdiBpZD0ic3RhdHNHZW5lcmFsIj4nICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj4nICsKICAgICAgICAgIGxvYygiQ29va2llcyBpbiBiYW5rOiIpICsKICAgICAgICAgICc8L2I+IDxkaXYgY2xhc3M9InByaWNlIHBsYWluIj4nICsKICAgICAgICAgIEdhbWUudGlueUNvb2tpZSgpICsKICAgICAgICAgIEJlYXV0aWZ5KEdhbWUuY29va2llcykgKwogICAgICAgICAgIjwvZGl2PjwvZGl2PiIgKwogICAgICAgICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPjxiPicgKwogICAgICAgICAgbG9jKCJDb29raWVzIGJha2VkICh0aGlzIGFzY2Vuc2lvbik6IikgKwogICAgICAgICAgJzwvYj4gPGRpdiBjbGFzcz0icHJpY2UgcGxhaW4iPicgKwogICAgICAgICAgR2FtZS50aW55Q29va2llKCkgKwogICAgICAgICAgQmVhdXRpZnkoR2FtZS5jb29raWVzRWFybmVkKSArCiAgICAgICAgICAiPC9kaXY+PC9kaXY+IiArCiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGI+JyArCiAgICAgICAgICBsb2MoIkNvb2tpZXMgYmFrZWQgKGFsbCB0aW1lKToiKSArCiAgICAgICAgICAnPC9iPiA8ZGl2IGNsYXNzPSJwcmljZSBwbGFpbiI+JyArCiAgICAgICAgICBHYW1lLnRpbnlDb29raWUoKSArCiAgICAgICAgICBCZWF1dGlmeShHYW1lLmNvb2tpZXNFYXJuZWQgKyBHYW1lLmNvb2tpZXNSZXNldCkgKwogICAgICAgICAgIjwvZGl2PjwvZGl2PiIgKwogICAgICAgICAgKEdhbWUuY29va2llc1Jlc2V0ID4gMAogICAgICAgICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj4nICsKICAgICAgICAgICAgICBsb2MoIkNvb2tpZXMgZm9yZmVpdGVkIGJ5IGFzY2VuZGluZzoiKSArCiAgICAgICAgICAgICAgJzwvYj4gPGRpdiBjbGFzcz0icHJpY2UgcGxhaW4iPicgKwogICAgICAgICAgICAgIEdhbWUudGlueUNvb2tpZSgpICsKICAgICAgICAgICAgICBCZWF1dGlmeShHYW1lLmNvb2tpZXNSZXNldCkgKwogICAgICAgICAgICAgICI8L2Rpdj48L2Rpdj4iCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgIChHYW1lLnJlc2V0cwogICAgICAgICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj4nICsKICAgICAgICAgICAgICBsb2MoIkxlZ2FjeSBzdGFydGVkOiIpICsKICAgICAgICAgICAgICAiPC9iPiAiICsKICAgICAgICAgICAgICAoZnVsbERhdGUgPT0gIiIgPyBsb2MoImp1c3Qgbm93IikgOiBsb2MoIiUxIGFnbyIsIGZ1bGxEYXRlKSkgKwogICAgICAgICAgICAgICIsICIgKwogICAgICAgICAgICAgIGxvYygid2l0aCAlMSBhc2NlbnNpb24iLCBMQmVhdXRpZnkoR2FtZS5yZXNldHMpKSArCiAgICAgICAgICAgICAgIjwvZGl2PiIKICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPjxiPicgKwogICAgICAgICAgbG9jKCJSdW4gc3RhcnRlZDoiKSArCiAgICAgICAgICAiPC9iPiAiICsKICAgICAgICAgIChzdGFydERhdGUgPT0gIiIgPyBsb2MoImp1c3Qgbm93IikgOiBsb2MoIiUxIGFnbyIsIHN0YXJ0RGF0ZSkpICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj4nICsKICAgICAgICAgIGxvYygiQnVpbGRpbmdzIG93bmVkOiIpICsKICAgICAgICAgICI8L2I+ICIgKwogICAgICAgICAgQmVhdXRpZnkoYnVpbGRpbmdzT3duZWQpICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj4nICsKICAgICAgICAgIGxvYygiQ29va2llcyBwZXIgc2Vjb25kOiIpICsKICAgICAgICAgICI8L2I+ICIgKwogICAgICAgICAgQmVhdXRpZnkoR2FtZS5jb29raWVzUHMsIDEpICsKICAgICAgICAgICIgPHNtYWxsPiIgKwogICAgICAgICAgIigiICsKICAgICAgICAgIGxvYygibXVsdGlwbGllcjoiKSArCiAgICAgICAgICAiICIgKwogICAgICAgICAgQmVhdXRpZnkoTWF0aC5yb3VuZChHYW1lLmdsb2JhbENwc011bHQgKiAxMDApLCAxKSArCiAgICAgICAgICAiJSkiICsKICAgICAgICAgIChHYW1lLmNwc1N1Y2tlZCA+IDAKICAgICAgICAgICAgPyAnIDxzcGFuIGNsYXNzPSJ3YXJuaW5nIj4oJyArCiAgICAgICAgICAgICAgbG9jKCJ3aXRoZXJlZDoiKSArCiAgICAgICAgICAgICAgIiAiICsKICAgICAgICAgICAgICBCZWF1dGlmeShNYXRoLnJvdW5kKEdhbWUuY3BzU3Vja2VkICogMTAwKSwgMSkgKwogICAgICAgICAgICAgICIlKTwvc3Bhbj4iCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICI8L3NtYWxsPjwvZGl2PiIgKwogICAgICAgICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPjxiPicgKwogICAgICAgICAgbG9jKCJSYXcgY29va2llcyBwZXIgc2Vjb25kOiIpICsKICAgICAgICAgICI8L2I+ICIgKwogICAgICAgICAgQmVhdXRpZnkoR2FtZS5jb29raWVzUHNSYXcsIDEpICsKICAgICAgICAgICIgPHNtYWxsPiIgKwogICAgICAgICAgIigiICsKICAgICAgICAgIGxvYygiaGlnaGVzdCB0aGlzIGFzY2Vuc2lvbjoiKSArCiAgICAgICAgICAiICIgKwogICAgICAgICAgQmVhdXRpZnkoR2FtZS5jb29raWVzUHNSYXdIaWdoZXN0LCAxKSArCiAgICAgICAgICAiKSIgKwogICAgICAgICAgIjwvc21hbGw+PC9kaXY+IiArCiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGI+JyArCiAgICAgICAgICBsb2MoIkNvb2tpZXMgcGVyIGNsaWNrOiIpICsKICAgICAgICAgICI8L2I+ICIgKwogICAgICAgICAgQmVhdXRpZnkoR2FtZS5jb21wdXRlZE1vdXNlQ3BzLCAxKSArCiAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGI+JyArCiAgICAgICAgICBsb2MoIkNvb2tpZSBjbGlja3M6IikgKwogICAgICAgICAgIjwvYj4gIiArCiAgICAgICAgICBCZWF1dGlmeShHYW1lLmNvb2tpZUNsaWNrcykgKwogICAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPjxiPicgKwogICAgICAgICAgbG9jKCJIYW5kLW1hZGUgY29va2llczoiKSArCiAgICAgICAgICAiPC9iPiAiICsKICAgICAgICAgIEJlYXV0aWZ5KEdhbWUuaGFuZG1hZGVDb29raWVzKSArCiAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGI+JyArCiAgICAgICAgICBsb2MoIkdvbGRlbiBjb29raWUgY2xpY2tzOiIpICsKICAgICAgICAgICI8L2I+ICIgKwogICAgICAgICAgQmVhdXRpZnkoR2FtZS5nb2xkZW5DbGlja3NMb2NhbCkgKwogICAgICAgICAgIiA8c21hbGw+KCIgKwogICAgICAgICAgbG9jKCJhbGwgdGltZToiKSArCiAgICAgICAgICAiICIgKwogICAgICAgICAgQmVhdXRpZnkoR2FtZS5nb2xkZW5DbGlja3MpICsKICAgICAgICAgICIpPC9zbWFsbD48L2Rpdj4iICsgLy8nIDxzcGFuIGNsYXNzPSJoaWRkZW4iPig8Yj5NaXNzZWQgZ29sZGVuIGNvb2tpZXMgOjwvYj4gJytCZWF1dGlmeShHYW1lLm1pc3NlZEdvbGRlbkNsaWNrcykrJyk8L3NwYW4+PC9kaXY+JysKICAgICAgICAgIChkcm9wTXVsdCAhPSAxCiAgICAgICAgICAgID8gJzxkaXYgY2xhc3M9Imxpc3RpbmciPjxiPicgKwogICAgICAgICAgICAgIGxvYygiUmFuZG9tIGRyb3AgbXVsdGlwbGllcjoiKSArCiAgICAgICAgICAgICAgIjwvYj4gPHNtYWxsPng8L3NtYWxsPiIgKwogICAgICAgICAgICAgIEJlYXV0aWZ5KGRyb3BNdWx0LCAyKSArCiAgICAgICAgICAgICAgIjwvZGl2PiIKICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICAgJzxicj48ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj4nICsKICAgICAgICAgIGxvYygiUnVubmluZyB2ZXJzaW9uOiIpICsKICAgICAgICAgICI8L2I+ICIgKwogICAgICAgICAgR2FtZS52ZXJzaW9uICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgIChyZXNlYXJjaFN0ciAhPSAiIiB8fAogICAgICAgICAgd3JhdGhTdHIgIT0gIiIgfHwKICAgICAgICAgIHBsZWRnZVN0ciAhPSAiIiB8fAogICAgICAgICAgc2FudGFTdHIgIT0gIiIgfHwKICAgICAgICAgIGRyYWdvblN0ciAhPSAiIiB8fAogICAgICAgICAgR2FtZS5zZWFzb24gIT0gIiIgfHwKICAgICAgICAgIGFzY2Vuc2lvbk1vZGVTdHIgIT0gIiIgfHwKICAgICAgICAgIEdhbWUuY2FuTHVtcHMoKQogICAgICAgICAgICA/ICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIj4nICsKICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0idGl0bGUiPicgKwogICAgICAgICAgICAgIGxvYygiU3BlY2lhbCIpICsKICAgICAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAgICAgJzxkaXYgaWQ9InN0YXRzU3BlY2lhbCI+JyArCiAgICAgICAgICAgICAgKGFzY2Vuc2lvbk1vZGVTdHIgIT0gIiIKICAgICAgICAgICAgICAgID8gJzxkaXYgY2xhc3M9Imxpc3RpbmciPjxiPicgKwogICAgICAgICAgICAgICAgICBsb2MoIkNoYWxsZW5nZSBtb2RlOiIpICsKICAgICAgICAgICAgICAgICAgIjwvYj4iICsKICAgICAgICAgICAgICAgICAgYXNjZW5zaW9uTW9kZVN0ciArCiAgICAgICAgICAgICAgICAgICI8L2Rpdj4iCiAgICAgICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAgICAgKEdhbWUuc2Vhc29uICE9ICIiCiAgICAgICAgICAgICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj4nICsKICAgICAgICAgICAgICAgICAgbG9jKCJTZWFzb25hbCBldmVudDoiKSArCiAgICAgICAgICAgICAgICAgICI8L2I+ICIgKwogICAgICAgICAgICAgICAgICBHYW1lLnNlYXNvbnNbR2FtZS5zZWFzb25dLm5hbWUgKwogICAgICAgICAgICAgICAgICAoc2Vhc29uU3RyICE9ICIiCiAgICAgICAgICAgICAgICAgICAgPyAiIDxzbWFsbD4oIiArIGxvYygiJTEgcmVtYWluaW5nIiwgc2Vhc29uU3RyKSArICIpPC9zbWFsbD4iCiAgICAgICAgICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgICAgICAgICAiPC9kaXY+IgogICAgICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgICAgIChFTiAmJiBHYW1lLnNlYXNvbiA9PSAiZm9vbHMiCiAgICAgICAgICAgICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj5Nb25leSBtYWRlIGZyb20gc2VsbGluZyBjb29raWVzIDo8L2I+ICcgKwogICAgICAgICAgICAgICAgICBCZWF1dGlmeShHYW1lLmNvb2tpZXNFYXJuZWQgKiAwLjA4LCAyKSArCiAgICAgICAgICAgICAgICAgICIgY29va2llIGRvbGxhcnM8L2Rpdj4iICsKICAgICAgICAgICAgICAgICAgKEdhbWUuT2JqZWN0c1siUG9ydGFsIl0uaGlnaGVzdCA+IDAKICAgICAgICAgICAgICAgICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj5UViBzaG93IHNlYXNvbnMgcHJvZHVjZWQgOjwvYj4gJyArCiAgICAgICAgICAgICAgICAgICAgICBCZWF1dGlmeSgKICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5mbG9vcigKICAgICAgICAgICAgICAgICAgICAgICAgICAodGltZUluU2Vjb25kcyAvIDYwIC8gNjApICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIChHYW1lLk9iamVjdHNbIlBvcnRhbCJdLmhpZ2hlc3QgKiAwLjEzKSArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICkgKwogICAgICAgICAgICAgICAgICAgICAgIjwvZGl2PiIKICAgICAgICAgICAgICAgICAgICA6ICIiKQogICAgICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgICAgIChyZXNlYXJjaFN0ciAhPSAiIgogICAgICAgICAgICAgICAgPyAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGI+JyArCiAgICAgICAgICAgICAgICAgIGxvYygiUmVzZWFyY2g6IikgKwogICAgICAgICAgICAgICAgICAiPC9iPiAiICsKICAgICAgICAgICAgICAgICAgbG9jKCIlMSByZW1haW5pbmciLCByZXNlYXJjaFN0cikgKwogICAgICAgICAgICAgICAgICAiPC9kaXY+IgogICAgICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgICAgICh3cmF0aFN0ciAhPSAiIgogICAgICAgICAgICAgICAgPyAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGI+JyArCiAgICAgICAgICAgICAgICAgIGxvYygiR3JhbmRtYXRyaWFyY2hzIHN0YXR1czoiKSArCiAgICAgICAgICAgICAgICAgICI8L2I+ICIgKwogICAgICAgICAgICAgICAgICB3cmF0aFN0ciArCiAgICAgICAgICAgICAgICAgICI8L2Rpdj4iCiAgICAgICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAgICAgKHBsZWRnZVN0ciAhPSAiIgogICAgICAgICAgICAgICAgPyAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGI+JyArCiAgICAgICAgICAgICAgICAgIGxvYygiUGxlZGdlOiIpICsKICAgICAgICAgICAgICAgICAgIjwvYj4gIiArCiAgICAgICAgICAgICAgICAgIGxvYygiJTEgcmVtYWluaW5nIiwgcGxlZGdlU3RyKSArCiAgICAgICAgICAgICAgICAgICI8L2Rpdj4iCiAgICAgICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAgICAgKEdhbWUud3JpbmtsZXJzUG9wcGVkID4gMAogICAgICAgICAgICAgICAgPyAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGI+JyArCiAgICAgICAgICAgICAgICAgIGxvYygiV3JpbmtsZXJzIHBvcHBlZDoiKSArCiAgICAgICAgICAgICAgICAgICI8L2I+ICIgKwogICAgICAgICAgICAgICAgICBCZWF1dGlmeShHYW1lLndyaW5rbGVyc1BvcHBlZCkgKwogICAgICAgICAgICAgICAgICAiPC9kaXY+IgogICAgICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgICAgIChHYW1lLmNhbkx1bXBzKCkgJiYgR2FtZS5sdW1wc1RvdGFsID4gLTEKICAgICAgICAgICAgICAgID8gJzxkaXYgY2xhc3M9Imxpc3RpbmciPjxiPicgKwogICAgICAgICAgICAgICAgICBsb2MoIlN1Z2FyIGx1bXBzIGhhcnZlc3RlZDoiKSArCiAgICAgICAgICAgICAgICAgICc8L2I+IDxkaXYgY2xhc3M9InByaWNlIGx1bXAgcGxhaW4iPicgKwogICAgICAgICAgICAgICAgICBCZWF1dGlmeShHYW1lLmx1bXBzVG90YWwpICsKICAgICAgICAgICAgICAgICAgIjwvZGl2PjwvZGl2PiIKICAgICAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICAgICAvLyhHYW1lLmNvb2tpZXNTdWNrZWQ+MD8nPGRpdiBjbGFzcz0ibGlzdGluZyB3YXJuaW5nIj48Yj5XaXRoZXJlZCA6PC9iPiAnK0JlYXV0aWZ5KEdhbWUuY29va2llc1N1Y2tlZCkrJyBjb29raWVzPC9kaXY+JzonJykrCiAgICAgICAgICAgICAgKEdhbWUucmVpbmRlZXJDbGlja2VkID4gMAogICAgICAgICAgICAgICAgPyAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGI+JyArCiAgICAgICAgICAgICAgICAgIGxvYygiUmVpbmRlZXIgZm91bmQ6IikgKwogICAgICAgICAgICAgICAgICAiPC9iPiAiICsKICAgICAgICAgICAgICAgICAgQmVhdXRpZnkoR2FtZS5yZWluZGVlckNsaWNrZWQpICsKICAgICAgICAgICAgICAgICAgIjwvZGl2PiIKICAgICAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICAgICAoc2FudGFTdHIgIT0gIiIKICAgICAgICAgICAgICAgID8gJzxkaXYgY2xhc3M9Imxpc3RpbmciPjxiPicgKwogICAgICAgICAgICAgICAgICBsb2MoIlNhbnRhIHN0YWdlcyB1bmxvY2tlZDoiKSArCiAgICAgICAgICAgICAgICAgICI8L2I+PC9kaXY+PGRpdj4iICsKICAgICAgICAgICAgICAgICAgc2FudGFTdHIgKwogICAgICAgICAgICAgICAgICAiPC9kaXY+IgogICAgICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgICAgIChkcmFnb25TdHIgIT0gIiIKICAgICAgICAgICAgICAgID8gJzxkaXYgY2xhc3M9Imxpc3RpbmciPjxiPicgKwogICAgICAgICAgICAgICAgICBsb2MoIkRyYWdvbiB0cmFpbmluZzoiKSArCiAgICAgICAgICAgICAgICAgICI8L2I+PC9kaXY+PGRpdj4iICsKICAgICAgICAgICAgICAgICAgZHJhZ29uU3RyICsKICAgICAgICAgICAgICAgICAgIjwvZGl2PiIKICAgICAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICAgICAiPC9kaXY+IgogICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAoR2FtZS5wcmVzdGlnZSA+IDAgfHwgcHJlc3RpZ2VVcGdyYWRlcyAhPSAiIgogICAgICAgICAgICA/ICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIj4nICsKICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0idGl0bGUiPicgKwogICAgICAgICAgICAgIGxvYygiUHJlc3RpZ2UiKSArCiAgICAgICAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICAgICAgICc8ZGl2IGlkPSJzdGF0c1ByZXN0aWdlIj4nICsKICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGRpdiBjbGFzcz0iaWNvbiIgc3R5bGU9ImZsb2F0OmxlZnQ7YmFja2dyb3VuZC1wb3NpdGlvbjonICsKICAgICAgICAgICAgICAtMTkgKiA0OCArCiAgICAgICAgICAgICAgInB4ICIgKwogICAgICAgICAgICAgIC03ICogNDggKwogICAgICAgICAgICAgICdweDsiPjwvZGl2PicgKwogICAgICAgICAgICAgICc8ZGl2IHN0eWxlPSJtYXJnaW4tdG9wOjhweDsiPjxzcGFuIGNsYXNzPSJ0aXRsZSIgc3R5bGU9ImZvbnQtc2l6ZToyMnB4OyI+JyArCiAgICAgICAgICAgICAgbG9jKCJQcmVzdGlnZSBsZXZlbDoiKSArCiAgICAgICAgICAgICAgIiAiICsKICAgICAgICAgICAgICBCZWF1dGlmeShHYW1lLnByZXN0aWdlKSArCiAgICAgICAgICAgICAgIjwvc3Bhbj4gIiArCiAgICAgICAgICAgICAgbG9jKCJhdCAlMSUgb2YgaXRzIHBvdGVudGlhbCA8Yj4oKyUyJSBDcFMpPC9iPiIsIFsKICAgICAgICAgICAgICAgIEJlYXV0aWZ5KGhlYXZlbmx5TXVsdCAqIDEwMCwgMSksCiAgICAgICAgICAgICAgICBCZWF1dGlmeSgKICAgICAgICAgICAgICAgICAgcGFyc2VGbG9hdChHYW1lLnByZXN0aWdlKSAqIEdhbWUuaGVhdmVubHlQb3dlciAqIGhlYXZlbmx5TXVsdCwKICAgICAgICAgICAgICAgICAgMQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgIjxicj4iICsKICAgICAgICAgICAgICBsb2MoIkhlYXZlbmx5IGNoaXBzOiIpICsKICAgICAgICAgICAgICAiIDxiPiIgKwogICAgICAgICAgICAgIEJlYXV0aWZ5KEdhbWUuaGVhdmVubHlDaGlwcykgKwogICAgICAgICAgICAgICI8L2I+PC9kaXY+IiArCiAgICAgICAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICAgICAgIChwcmVzdGlnZVVwZ3JhZGVzICE9ICIiCiAgICAgICAgICAgICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIiBzdHlsZT0iY2xlYXI6bGVmdDsiPjxiPicgKwogICAgICAgICAgICAgICAgICBsb2MoIlByZXN0aWdlIHVwZ3JhZGVzIHVubG9ja2VkOiIpICsKICAgICAgICAgICAgICAgICAgIjwvYj4gIiArCiAgICAgICAgICAgICAgICAgIHByZXN0aWdlVXBncmFkZXNPd25lZCArCiAgICAgICAgICAgICAgICAgICIvIiArCiAgICAgICAgICAgICAgICAgIHByZXN0aWdlVXBncmFkZXNUb3RhbCArCiAgICAgICAgICAgICAgICAgICIgKCIgKwogICAgICAgICAgICAgICAgICBNYXRoLmZsb29yKAogICAgICAgICAgICAgICAgICAgIChwcmVzdGlnZVVwZ3JhZGVzT3duZWQgLyBwcmVzdGlnZVVwZ3JhZGVzVG90YWwpICogMTAwCiAgICAgICAgICAgICAgICAgICkgKwogICAgICAgICAgICAgICAgICAiJSk8L2Rpdj4iICsKICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9Imxpc3RpbmcgY3JhdGVCb3giPicgKwogICAgICAgICAgICAgICAgICBwcmVzdGlnZVVwZ3JhZGVzICsKICAgICAgICAgICAgICAgICAgIjwvZGl2PiIKICAgICAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICAgICAiPC9kaXY+IgogICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAnPC9kaXY+PGRpdiBjbGFzcz0ic3Vic2VjdGlvbiI+JyArCiAgICAgICAgICAnPGRpdiBjbGFzcz0idGl0bGUiPicgKwogICAgICAgICAgbG9jKCJVcGdyYWRlcyIpICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICc8ZGl2IGlkPSJzdGF0c1VwZ3JhZGVzIj4nICsKICAgICAgICAgIChoaWRkZW5VcGdyYWRlcyAhPSAiIgogICAgICAgICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj5EZWJ1ZzwvYj48L2Rpdj4nICsKICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyBjcmF0ZUJveCI+JyArCiAgICAgICAgICAgICAgaGlkZGVuVXBncmFkZXMgKwogICAgICAgICAgICAgICI8L2Rpdj4iCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj4nICsKICAgICAgICAgIGxvYygiVXBncmFkZXMgdW5sb2NrZWQ6IikgKwogICAgICAgICAgIjwvYj4gIiArCiAgICAgICAgICB1cGdyYWRlc093bmVkICsKICAgICAgICAgICIvIiArCiAgICAgICAgICB1cGdyYWRlc1RvdGFsICsKICAgICAgICAgICIgKCIgKwogICAgICAgICAgTWF0aC5mbG9vcigodXBncmFkZXNPd25lZCAvIHVwZ3JhZGVzVG90YWwpICogMTAwKSArCiAgICAgICAgICAiJSk8L2Rpdj4iICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIGNyYXRlQm94Ij4nICsKICAgICAgICAgIHVwZ3JhZGVzICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgIChjb29raWVVcGdyYWRlcyAhPSAiIgogICAgICAgICAgICA/ICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj4nICsKICAgICAgICAgICAgICBsb2MoIkNvb2tpZXMiKSArCiAgICAgICAgICAgICAgIjwvYj48L2Rpdj4iICsKICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0ibGlzdGluZyBjcmF0ZUJveCI+JyArCiAgICAgICAgICAgICAgY29va2llVXBncmFkZXMgKwogICAgICAgICAgICAgICI8L2Rpdj4iCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICc8L2Rpdj48ZGl2IGNsYXNzPSJzdWJzZWN0aW9uIj4nICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSI+JyArCiAgICAgICAgICBsb2MoIkFjaGlldmVtZW50cyIpICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICc8ZGl2IGlkPSJzdGF0c0FjaGlldnMiPicgKwogICAgICAgICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPjxiPicgKwogICAgICAgICAgbG9jKCJBY2hpZXZlbWVudHMgdW5sb2NrZWQ6IikgKwogICAgICAgICAgIjwvYj4gIiArCiAgICAgICAgICBhY2hpZXZlbWVudHNPd25lZCArCiAgICAgICAgICAiLyIgKwogICAgICAgICAgYWNoaWV2ZW1lbnRzVG90YWwgKwogICAgICAgICAgIiAoIiArCiAgICAgICAgICBNYXRoLmZsb29yKChhY2hpZXZlbWVudHNPd25lZCAvIGFjaGlldmVtZW50c1RvdGFsKSAqIDEwMCkgKwogICAgICAgICAgIiUpIiArCiAgICAgICAgICAoYWNoaWV2ZW1lbnRzT3duZWRPdGhlciA+IDAKICAgICAgICAgICAgPyAnPHNwYW4gc3R5bGU9ImZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1zaXplOjEwcHg7Y29sb3I6IzcwYTsiPiAoKycgKwogICAgICAgICAgICAgIGFjaGlldmVtZW50c093bmVkT3RoZXIgKwogICAgICAgICAgICAgICIpPC9zcGFuPiIKICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICAgKEdhbWUuY29va2llc011bHRCeVR5cGVbImtpdHRlbnMiXSA+IDEKICAgICAgICAgICAgPyAnPGRpdiBjbGFzcz0ibGlzdGluZyI+PGI+JyArCiAgICAgICAgICAgICAgbG9jKCJLaXR0ZW4gbXVsdGlwbGllcjoiKSArCiAgICAgICAgICAgICAgIjwvYj4gIiArCiAgICAgICAgICAgICAgQmVhdXRpZnkoR2FtZS5jb29raWVzTXVsdEJ5VHlwZVsia2l0dGVucyJdICogMTAwKSArCiAgICAgICAgICAgICAgIiU8L2Rpdj4iCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaXN0aW5nIj48Yj4nICsKICAgICAgICAgIGxvYygiTWlsayIpICsKICAgICAgICAgICI6PC9iPiAiICsKICAgICAgICAgIG1pbGtOYW1lICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgIChtaWxrU3RyICE9ICIiCiAgICAgICAgICAgID8gJzxkaXYgY2xhc3M9Imxpc3RpbmciPjxiPicgKwogICAgICAgICAgICAgIGxvYygiTWlsayBmbGF2b3JzIHVubG9ja2VkOiIpICsKICAgICAgICAgICAgICAiPC9iPjwvZGl2PjxkaXY+IiArCiAgICAgICAgICAgICAgbWlsa1N0ciArCiAgICAgICAgICAgICAgIjwvZGl2PiIKICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgJzxkaXYgY2xhc3M9Imxpc3RpbmciPjxzbWFsbCBzdHlsZT0ib3BhY2l0eTowLjc1OyI+KCcgKwogICAgICAgICAgbG9jKAogICAgICAgICAgICAiTWlsayBpcyBnYWluZWQgd2l0aCBlYWNoIGFjaGlldmVtZW50LiBJdCBjYW4gdW5sb2NrIHVuaXF1ZSB1cGdyYWRlcyBvdmVyIHRpbWUuIgogICAgICAgICAgKSArCiAgICAgICAgICAiKTwvc21hbGw+PC9kaXY+IiArCiAgICAgICAgICBhY2hpZXZlbWVudHNTdHIgKwogICAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICAgJzxkaXYgc3R5bGU9InBhZGRpbmctYm90dG9tOjEyOHB4OyI+PC9kaXY+JzsKICAgICAgfQogICAgICAvL3N0cj0nPGRpdiBpZD0ic2VsZWN0aW9uS2VlcGVyIiBjbGFzcz0ic2VsZWN0YWJsZSI+JytzdHIrJzwvZGl2Pic7CiAgICAgIGwoIm1lbnUiKS5pbm5lckhUTUwgPSBzdHI7CiAgICAgIGlmIChBcHApIHsKICAgICAgICB2YXIgYW5jaG9ycyA9IGwoIm1lbnUiKS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYSIpOwogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYW5jaG9ycy5sZW5ndGg7IGkrKykgewogICAgICAgICAgdmFyIGl0ID0gYW5jaG9yc1tpXTsKICAgICAgICAgIGlmIChpdC5ocmVmKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGl0LmhyZWYpOwogICAgICAgICAgICBBZGRFdmVudCgKICAgICAgICAgICAgICBpdCwKICAgICAgICAgICAgICAiY2xpY2siLAogICAgICAgICAgICAgIChmdW5jdGlvbiAoaHJlZikgewogICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgQXBwLm9wZW5MaW5rKGhyZWYpOwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICB9KShpdC5ocmVmKQogICAgICAgICAgICApOwogICAgICAgICAgICBpdC5yZW1vdmVBdHRyaWJ1dGUoImhyZWYiKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgLypBZGRFdmVudChsKCdzZWxlY3Rpb25LZWVwZXInKSwnbW91c2V1cCcsZnVuY3Rpb24oZSl7CgkJCQljb25zb2xlLmxvZygnc2VsZWN0aW9uOicsd2luZG93LmdldFNlbGVjdGlvbigpKTsKCQkJfSk7Ki8KICAgIH07CgogICAgQWRkRXZlbnQobCgicHJlZnNCdXR0b24iKSwgImNsaWNrIiwgZnVuY3Rpb24gKCkgewogICAgICBHYW1lLlNob3dNZW51KCJwcmVmcyIpOwogICAgfSk7CiAgICBBZGRFdmVudChsKCJzdGF0c0J1dHRvbiIpLCAiY2xpY2siLCBmdW5jdGlvbiAoKSB7CiAgICAgIEdhbWUuU2hvd01lbnUoInN0YXRzIik7CiAgICB9KTsKICAgIEFkZEV2ZW50KGwoImxvZ0J1dHRvbiIpLCAiY2xpY2siLCBmdW5jdGlvbiAoKSB7CiAgICAgIEdhbWUuU2hvd01lbnUoImxvZyIpOwogICAgfSk7CiAgICBBZGRFdmVudChsKCJsZWdhY3lCdXR0b24iKSwgImNsaWNrIiwgZnVuY3Rpb24gKCkgewogICAgICBQbGF5U291bmQoInNuZC90aWNrLm1wMyIpOwogICAgICBHYW1lLkFzY2VuZCgpOwogICAgfSk7CiAgICBHYW1lLmFzY2VuZE1ldGVyID0gbCgiYXNjZW5kTWV0ZXIiKTsKICAgIEdhbWUuYXNjZW5kTnVtYmVyID0gbCgiYXNjZW5kTnVtYmVyIik7CgogICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkJTkVXUyBUSUNLRVIKCQk9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgR2FtZS5UaWNrZXIgPSAiIjsKICAgIEdhbWUuVGlja2VyQWdlID0gMDsKICAgIEdhbWUuVGlja2VyRWZmZWN0ID0gMDsKICAgIEdhbWUuVGlja2VyTiA9IDA7CiAgICBHYW1lLlRpY2tlckNsaWNrcyA9IDA7CiAgICBHYW1lLlVwZGF0ZVRpY2tlciA9IGZ1bmN0aW9uICgpIHsKICAgICAgR2FtZS5UaWNrZXJBZ2UtLTsKICAgICAgaWYgKEdhbWUuVGlja2VyQWdlIDw9IDApIEdhbWUuZ2V0TmV3VGlja2VyKCk7CiAgICAgIGVsc2UgaWYgKEdhbWUuVGlja2VyID09ICIiKSBHYW1lLmdldE5ld1RpY2tlcih0cnVlKTsKICAgIH07CiAgICBHYW1lLmdldE5ld1RpY2tlciA9IGZ1bmN0aW9uICgKICAgICAgbWFudWFsIC8vbm90ZSA6ICJtYW51YWwiIGlzIHRydWUgaWYgdGhlIHRpY2tlciB3YXMgY2xpY2tlZCwgYnV0IG1heSBhbHNvIGJlIHRydWUgb24gc3RhcnR1cCBldGMKICAgICkgewogICAgICB2YXIgbGlzdCA9IFtdOwoKICAgICAgdmFyIE5FV1MgPSBsb2MoIk5ld3MgOiIpLnJlcGxhY2UoIiAiLCAiJm5ic3A7IikgKyAiICI7CgogICAgICB2YXIgbG9yZVByb2dyZXNzID0gTWF0aC5yb3VuZCgKICAgICAgICAoTWF0aC5sb2coR2FtZS5jb29raWVzRWFybmVkIC8gMTApICogTWF0aC5MT0cxMEUgKyAxKSB8IDAKICAgICAgKTsKCiAgICAgIGlmIChHYW1lLlRpY2tlck4gJSAyID09IDAgfHwgbG9yZVByb2dyZXNzID4gMTQpIHsKICAgICAgICB2YXIgYW5pbWFscyA9IFsKICAgICAgICAgICJuZXd0cyIsCiAgICAgICAgICAicGVuZ3VpbnMiLAogICAgICAgICAgInNjb3JwaW9ucyIsCiAgICAgICAgICAiYXhvbG90bHMiLAogICAgICAgICAgInB1ZmZpbnMiLAogICAgICAgICAgInBvcnBvaXNlcyIsCiAgICAgICAgICAiYmxvd2Zpc2giLAogICAgICAgICAgImhvcnNlcyIsCiAgICAgICAgICAiY3JheWZpc2giLAogICAgICAgICAgInNsdWdzIiwKICAgICAgICAgICJodW1wYmFjayB3aGFsZXMiLAogICAgICAgICAgIm51cnNlIHNoYXJrcyIsCiAgICAgICAgICAiZ2lhbnQgc3F1aWRzIiwKICAgICAgICAgICJwb2xhciBiZWFycyIsCiAgICAgICAgICAiZnJ1aXQgYmF0cyIsCiAgICAgICAgICAiZnJvZ3MiLAogICAgICAgICAgInNlYSBzcXVpcnRzIiwKICAgICAgICAgICJ2ZWx2ZXQgd29ybXMiLAogICAgICAgICAgIm1vbGUgcmF0cyIsCiAgICAgICAgICAicGFyYW1lY2lhIiwKICAgICAgICAgICJuZW1hdG9kZXMiLAogICAgICAgICAgInRhcmRpZ3JhZGVzIiwKICAgICAgICAgICJnaXJhZmZlcyIsCiAgICAgICAgICAibW9ua2Zpc2giLAogICAgICAgICAgIndvbGZtZW4iLAogICAgICAgICAgImdvYmxpbnMiLAogICAgICAgICAgImhpcHBpZXMiLAogICAgICAgIF07CgogICAgICAgIGlmIChNYXRoLnJhbmRvbSgpIDwgMC43NSB8fCBHYW1lLmNvb2tpZXNFYXJuZWQgPCAxMDAwMCkgewogICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLmFtb3VudCA+IDApCiAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAiPHE+IiArCiAgICAgICAgICAgICAgICBjaG9vc2UobG9jKCJUaWNrZXIgKGdyYW5kbWEpIikpICsKICAgICAgICAgICAgICAgICI8L3E+PHNpZz4iICsKICAgICAgICAgICAgICAgIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLnNpbmdsZSArCiAgICAgICAgICAgICAgICAiPC9zaWc+IgogICAgICAgICAgICApOwoKICAgICAgICAgIGlmICghR2FtZS5wcmVmcy5ub3RTY2FyeSAmJiBHYW1lLk9iamVjdHNbIkdyYW5kbWEiXS5hbW91bnQgPj0gNTApCiAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAiPHE+IiArCiAgICAgICAgICAgICAgICBjaG9vc2UobG9jKCJUaWNrZXIgKHRocmVhdGVuaW5nIGdyYW5kbWEpIikpICsKICAgICAgICAgICAgICAgICI8L3E+PHNpZz4iICsKICAgICAgICAgICAgICAgIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLnNpbmdsZSArCiAgICAgICAgICAgICAgICAiPC9zaWc+IgogICAgICAgICAgICApOwoKICAgICAgICAgIGlmIChFTiAmJiBHYW1lLkhhc0FjaGlldigiSnVzdCB3cm9uZyIpICYmIE1hdGgucmFuZG9tKCkgPCAwLjA1KQogICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgTkVXUyArICJjb29raWUgbWFudWZhY3R1cmVyIGRvd25zaXplcywgc2VsbHMgb3duIGdyYW5kbW90aGVyISIKICAgICAgICAgICAgKTsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgIUdhbWUucHJlZnMubm90U2NhcnkgJiYKICAgICAgICAgICAgR2FtZS5IYXNBY2hpZXYoIkp1c3Qgd3JvbmciKSAmJgogICAgICAgICAgICBNYXRoLnJhbmRvbSgpIDwgMC40CiAgICAgICAgICApCiAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAiPHE+IiArCiAgICAgICAgICAgICAgICBjaG9vc2UobG9jKCJUaWNrZXIgKGFuZ3J5IGdyYW5kbWEpIikpICsKICAgICAgICAgICAgICAgICI8L3E+PHNpZz4iICsKICAgICAgICAgICAgICAgIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLnNpbmdsZSArCiAgICAgICAgICAgICAgICAiPC9zaWc+IgogICAgICAgICAgICApOwoKICAgICAgICAgIGlmICgKICAgICAgICAgICAgIUdhbWUucHJlZnMubm90U2NhcnkgJiYKICAgICAgICAgICAgR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0uYW1vdW50ID49IDEgJiYKICAgICAgICAgICAgR2FtZS5wbGVkZ2VzID4gMCAmJgogICAgICAgICAgICBHYW1lLmVsZGVyV3JhdGggPT0gMAogICAgICAgICAgKQogICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgIjxxPiIgKwogICAgICAgICAgICAgICAgY2hvb3NlKGxvYygiVGlja2VyIChncmFuZG1hcyByZXR1cm4pIikpICsKICAgICAgICAgICAgICAgICI8L3E+PHNpZz4iICsKICAgICAgICAgICAgICAgIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLnNpbmdsZSArCiAgICAgICAgICAgICAgICAiPC9zaWc+IgogICAgICAgICAgICApOwoKICAgICAgICAgIGlmICghRU4pIHsKICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICAgICAgICBpZiAoaSAhPSAiQ3Vyc29yIiAmJiBpICE9ICJHcmFuZG1hIiAmJiBHYW1lLk9iamVjdHNbaV0uYW1vdW50ID4gMCkKICAgICAgICAgICAgICAgIGxpc3QucHVzaChORVdTICsgY2hvb3NlKGxvYygiVGlja2VyICgiICsgaSArICIpIikpKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKEdhbWUuY29va2llc0Vhcm5lZCA+PSAxMDAwKSB7CiAgICAgICAgICAgICAgaWYgKEdhbWUuc2Vhc29uID09ICJoYWxsb3dlZW4iKQogICAgICAgICAgICAgICAgbGlzdC5wdXNoKE5FV1MgKyBjaG9vc2UobG9jKCJUaWNrZXIgKEhhbGxvd2VlbikiKSkpOwogICAgICAgICAgICAgIGlmIChHYW1lLnNlYXNvbiA9PSAiY2hyaXN0bWFzIikKICAgICAgICAgICAgICAgIGxpc3QucHVzaChORVdTICsgY2hvb3NlKGxvYygiVGlja2VyIChDaHJpc3RtYXMpIikpKTsKICAgICAgICAgICAgICBpZiAoR2FtZS5zZWFzb24gPT0gInZhbGVudGluZXMiKQogICAgICAgICAgICAgICAgbGlzdC5wdXNoKE5FV1MgKyBjaG9vc2UobG9jKCJUaWNrZXIgKFZhbGVudGluZXMpIikpKTsKICAgICAgICAgICAgICBpZiAoR2FtZS5zZWFzb24gPT0gImVhc3RlciIpCiAgICAgICAgICAgICAgICBsaXN0LnB1c2goTkVXUyArIGNob29zZShsb2MoIlRpY2tlciAoRWFzdGVyKSIpKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIkZhcm0iXS5hbW91bnQgPiAwKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICJOZXdzIDogY29va2llIGZhcm1zIHN1c3BlY3RlZCBvZiBlbXBsb3lpbmcgdW5kZWNsYXJlZCBlbGRlcmx5IHdvcmtmb3JjZSEiLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGNvb2tpZSBmYXJtcyByZWxlYXNlIGhhcm1mdWwgY2hvY29sYXRlIGluIG91ciByaXZlcnMsIHNheXMgc2NpZW50aXN0ISIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogZ2VuZXRpY2FsbHktbW9kaWZpZWQgY2hvY29sYXRlIGNvbnRyb3ZlcnN5IHN0cmlrZXMgY29va2llIGZhcm1lcnMhIiwKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBmcmVlLXJhbmdlIGZhcm0gY29va2llcyBwb3B1bGFyIHdpdGggdG9kYXkncyBoaXAgeW91dGgsIHNheXMgc3BlY2lhbGlzdC4iLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGZhcm0gY29va2llcyBkZWVtZWQgdW5maXQgZm9yIHZlZ2Fucywgc2F5cyBudXRyaXRpb25pc3QuIiwKICAgICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIk1pbmUiXS5hbW91bnQgPiAwKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICJOZXdzIDogaXMgb3VyIHBsYW5ldCBnZXR0aW5nIGxpZ2h0ZXI/IEV4cGVydHMgZXhhbWluZSB0aGUgZWZmZWN0cyBvZiBpbnRlbnNpdmUgY2hvY29sYXRlIG1pbmluZy4iLAogICAgICAgICAgICAgICAgICAiTmV3cyA6ICIgKwogICAgICAgICAgICAgICAgICAgIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAgKyAyKSArCiAgICAgICAgICAgICAgICAgICAgIiBtaW5lcnMgdHJhcHBlZCBpbiBjb2xsYXBzZWQgY2hvY29sYXRlIG1pbmUhIiwKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBjaG9jb2xhdGUgbWluZXMgZm91bmQgdG8gY2F1c2UgZWFydGhxdWFrZXMgYW5kIHNpbmtob2xlcyEiLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGNob2NvbGF0ZSBtaW5lIGdvZXMgYXdyeSwgZmxvb2RzIHZpbGxhZ2UgaW4gY2hvY29sYXRlISIsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogZGVwdGhzIG9mIGNob2NvbGF0ZSBtaW5lcyBmb3VuZCB0byBob3VzZSAicGVjdWxpYXIsIGNob2NvbGF0eSBiZWluZ3MiIScsCiAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICk7CgogICAgICAgICAgICBpZiAoR2FtZS5PYmplY3RzWyJGYWN0b3J5Il0uYW1vdW50ID4gMCkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAiTmV3cyA6IGNvb2tpZSBmYWN0b3JpZXMgbGlua2VkIHRvIGdsb2JhbCB3YXJtaW5nISIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogY29va2llIGZhY3RvcmllcyBpbnZvbHZlZCBpbiBjaG9jb2xhdGUgd2VhdGhlciBjb250cm92ZXJzeSEiLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGNvb2tpZSBmYWN0b3JpZXMgb24gc3RyaWtlLCByb2JvdGljIG1pbmlvbnMgZW1wbG95ZWQgdG8gcmVwbGFjZSB3b3JrZm9yY2UhIiwKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBjb29raWUgZmFjdG9yaWVzIG9uIHN0cmlrZSAtIHdvcmtlcnMgZGVtYW5kIHRvIHN0b3AgYmVpbmcgcGFpZCBpbiBjb29raWVzISIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogZmFjdG9yeS1tYWRlIGNvb2tpZXMgbGlua2VkIHRvIG9iZXNpdHksIHNheXMgc3R1ZHkuIiwKICAgICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIkJhbmsiXS5hbW91bnQgPiAwKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICJOZXdzIDogY29va2llIGxvYW5zIG9uIHRoZSByaXNlIGFzIHBlb3BsZSBjYW4gbm8gbG9uZ2VyIGFmZm9yZCB0aGVtIHdpdGggcmVndWxhciBtb25leS4iLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGNvb2tpZXMgc2xvd2x5IGNyZWVwaW5nIHVwIHRoZWlyIHdheSBhcyBhIGNvbXBldGl0b3IgdG8gdHJhZGl0aW9uYWwgY3VycmVuY3khIiwKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBtb3N0IGJha2VyaWVzIG5vdyBmaXR0ZWQgd2l0aCBBVE1zIHRvIGFsbG93IGZvciBlYXN5IGNvb2tpZSB3aXRoZHJhd2FscyBhbmQgZGVwb3NpdHMuIiwKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBjb29raWUgZWNvbm9teSBub3cgc3Ryb25nIGVub3VnaCB0byBhbGxvdyBmb3IgbWFzc2l2ZSB2YXVsdHMgZG91YmxpbmcgYXMgc3dpbW1pbmcgcG9vbHMhIiwKICAgICAgICAgICAgICAgICAgJ05ld3MgOiAiVG9tb3Jyb3dcJ3Mgd2VhbHRoaWVzdCBwZW9wbGUgd2lsbCBiZSBjYWxjdWxhdGVkIGJ5IHRoZWlyIHdvcnRoIGluIGNvb2tpZXMiLCBwcmVkaWN0IGVjb25vbWlzdHMuJywKICAgICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIlRlbXBsZSJdLmFtb3VudCA+IDApCiAgICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBleHBsb3JlcnMgYnJpbmcgYmFjayBhbmNpZW50IGFydGlmYWN0IGZyb20gYWJhbmRvbmVkIHRlbXBsZTsgYXJjaGVvbG9naXN0cyBtYXJ2ZWwgYXQgdGhlIGNlbnR1cmllcy1vbGQgIiArCiAgICAgICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgICAgICJtYWdpYyIsCiAgICAgICAgICAgICAgICAgICAgICAiY2FydmVkIiwKICAgICAgICAgICAgICAgICAgICAgICJlbmdyYXZlZCIsCiAgICAgICAgICAgICAgICAgICAgICAic2N1bHB0ZWQiLAogICAgICAgICAgICAgICAgICAgICAgInJveWFsIiwKICAgICAgICAgICAgICAgICAgICAgICJpbXBlcmlhbCIsCiAgICAgICAgICAgICAgICAgICAgICAibXVtbWlmaWVkIiwKICAgICAgICAgICAgICAgICAgICAgICJyaXR1YWwiLAogICAgICAgICAgICAgICAgICAgICAgImdvbGRlbiIsCiAgICAgICAgICAgICAgICAgICAgICAic2lsdmVyIiwKICAgICAgICAgICAgICAgICAgICAgICJzdG9uZSIsCiAgICAgICAgICAgICAgICAgICAgICAiY3Vyc2VkIiwKICAgICAgICAgICAgICAgICAgICAgICJwbGFzdGljIiwKICAgICAgICAgICAgICAgICAgICAgICJib25lIiwKICAgICAgICAgICAgICAgICAgICAgICJibG9vZCIsCiAgICAgICAgICAgICAgICAgICAgICAiaG9seSIsCiAgICAgICAgICAgICAgICAgICAgICAic2FjcmVkIiwKICAgICAgICAgICAgICAgICAgICAgICJzYWNyaWZpY2lhbCIsCiAgICAgICAgICAgICAgICAgICAgICAiZWxlY3Ryb25pYyIsCiAgICAgICAgICAgICAgICAgICAgICAic2luZ2luZyIsCiAgICAgICAgICAgICAgICAgICAgICAidGFwZGFuY2luZyIsCiAgICAgICAgICAgICAgICAgICAgXSkgKwogICAgICAgICAgICAgICAgICAgICIgIiArCiAgICAgICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgICAgICJzcG9vbiIsCiAgICAgICAgICAgICAgICAgICAgICAiZm9yayIsCiAgICAgICAgICAgICAgICAgICAgICAicGl6emEiLAogICAgICAgICAgICAgICAgICAgICAgIndhc2hpbmcgbWFjaGluZSIsCiAgICAgICAgICAgICAgICAgICAgICAiY2FsY3VsYXRvciIsCiAgICAgICAgICAgICAgICAgICAgICAiaGF0IiwKICAgICAgICAgICAgICAgICAgICAgICJwaWFubyIsCiAgICAgICAgICAgICAgICAgICAgICAibmFwa2luIiwKICAgICAgICAgICAgICAgICAgICAgICJza2VsZXRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAiZ293biIsCiAgICAgICAgICAgICAgICAgICAgICAiZGFnZ2VyIiwKICAgICAgICAgICAgICAgICAgICAgICJzd29yZCIsCiAgICAgICAgICAgICAgICAgICAgICAic2hpZWxkIiwKICAgICAgICAgICAgICAgICAgICAgICJza3VsbCIsCiAgICAgICAgICAgICAgICAgICAgICAiZW1lcmFsZCIsCiAgICAgICAgICAgICAgICAgICAgICAiYmF0aHR1YiIsCiAgICAgICAgICAgICAgICAgICAgICAibWFzayIsCiAgICAgICAgICAgICAgICAgICAgICAicm9sbGVyc2thdGVzIiwKICAgICAgICAgICAgICAgICAgICAgICJsaXR0ZXJib3giLAogICAgICAgICAgICAgICAgICAgICAgImJhaXQgYm94IiwKICAgICAgICAgICAgICAgICAgICAgICJjdWJlIiwKICAgICAgICAgICAgICAgICAgICAgICJzcGhlcmUiLAogICAgICAgICAgICAgICAgICAgICAgImZ1bmd1cyIsCiAgICAgICAgICAgICAgICAgICAgXSkgKwogICAgICAgICAgICAgICAgICAgICIhIiwKICAgICAgICAgICAgICAgICAgIk5ld3MgOiByZWNlbnRseS1kaXNjb3ZlcmVkIGNob2NvbGF0ZSB0ZW1wbGVzIG5vdyBzcGFya2luZyBuZXcgY29va2llLXJlbGF0ZWQgY3VsdDsgdGhvdXNhbmRzIHByYXkgdG8gQmFrZXIgaW4gdGhlIHNreSEiLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGp1c3QgaG93IGV4dGVuc2l2ZSBpcyB0aGUgY29va2llIHBhbnRoZW9uPyBUaGVvbG9naWFucyBzcGVjdWxhdGUgYWJvdXQgcG9zc2libGUgIiArCiAgICAgICAgICAgICAgICAgICAgY2hvb3NlKFsiZ29kIiwgImdvZGRlc3MiXSkgKwogICAgICAgICAgICAgICAgICAgICIgb2YgIiArCiAgICAgICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgICAgIGNob29zZShhbmltYWxzKSwKICAgICAgICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICAgICAgICJrYXpvb3MiLAogICAgICAgICAgICAgICAgICAgICAgICAid2ViIGRlc2lnbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWIgYnJvd3NlcnMiLAogICAgICAgICAgICAgICAgICAgICAgICAia2l0dGVucyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJhdGhlaXNtIiwKICAgICAgICAgICAgICAgICAgICAgICAgImhhbmRicmFrZXMiLAogICAgICAgICAgICAgICAgICAgICAgICAiaGF0cyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJhZ2xldHMiLAogICAgICAgICAgICAgICAgICAgICAgICAiZWxldmF0b3IgbXVzaWMiLAogICAgICAgICAgICAgICAgICAgICAgICAiaWRsZSBnYW1lcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICd0aGUgbGV0dGVyICJQIicsCiAgICAgICAgICAgICAgICAgICAgICAgICJtZW1lcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJoYW1idXJnZXJzIiwKICAgICAgICAgICAgICAgICAgICAgICAgImJhZCBwdW5zIiwKICAgICAgICAgICAgICAgICAgICAgICAgImtlcm5pbmciLAogICAgICAgICAgICAgICAgICAgICAgICAic3RhbmQtdXAgY29tZWR5IiwKICAgICAgICAgICAgICAgICAgICAgICAgImZhaWxlZCBidXJnbGFyeSBhdHRlbXB0cyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJjbGlja2JhaXQiLAogICAgICAgICAgICAgICAgICAgICAgICAib25lIHdlaXJkIHRyaWNrcyIsCiAgICAgICAgICAgICAgICAgICAgICBdKSwKICAgICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICAgIi4iLAogICAgICAgICAgICAgICAgICAnTmV3cyA6IHRoZWlzdHMgb2YgdGhlIHdvcmxkIGRpc2NvdmVyIG5ldyBjb29raWUgcmVsaWdpb24gLSAiT2ggYm95LCBndWVzcyB3ZSB3ZXJlIHdyb25nIGFsbCBhbG9uZyEiJywKICAgICAgICAgICAgICAgICAgJ05ld3MgOiBjb29raWUgaGVhdmVuIGFsbGVnZWRseSAic3BvcnRzIGVsZXZhdG9yIGluc3RlYWQgb2Ygc3RhaXJ3YXkiOyBjb29raWUgaGVsbCAicGF2ZWQgd2l0aCBmbGFnc3RvbmUsIGFzIGdvb2QgaW50ZW50aW9ucyBtYWtlIGZvciBwb29yIGJ1aWxkaW5nIG1hdGVyaWFsIi4nLAogICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siV2l6YXJkIHRvd2VyIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAiTmV3cyA6IGFsbCAiICsKICAgICAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAgICAgY2hvb3NlKGFuaW1hbHMpLAogICAgICAgICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgICAgICAgInB1YmxpYyByZXN0cm9vbXMiLAogICAgICAgICAgICAgICAgICAgICAgICAiY2xvdWRzIiwKICAgICAgICAgICAgICAgICAgICAgICAgInBvbGl0aWNpYW5zIiwKICAgICAgICAgICAgICAgICAgICAgICAgIm1vdXN0YWNoZXMiLAogICAgICAgICAgICAgICAgICAgICAgICAiaGF0cyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJzaG9lcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJwYW50cyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJjbG93bnMiLAogICAgICAgICAgICAgICAgICAgICAgICAiZW5jeWNsb3BlZGlhcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWJzaXRlcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJwb3R0ZWQgcGxhbnRzIiwKICAgICAgICAgICAgICAgICAgICAgICAgImxlbW9ucyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJob3VzZWhvbGQgaXRlbXMiLAogICAgICAgICAgICAgICAgICAgICAgICAiYm9kaWx5IGZsdWlkcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJjdXRsZXJ5IiwKICAgICAgICAgICAgICAgICAgICAgICAgIm5hdGlvbmFsIGxhbmRtYXJrcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ5b2d1cnQiLAogICAgICAgICAgICAgICAgICAgICAgICAicmFwIG11c2ljIiwKICAgICAgICAgICAgICAgICAgICAgICAgInVuZGVyd2VhciIsCiAgICAgICAgICAgICAgICAgICAgICBdKSwKICAgICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICAgIiB0dXJuZWQgaW50byAiICsKICAgICAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAgICAgY2hvb3NlKGFuaW1hbHMpLAogICAgICAgICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgICAgICAgInB1YmxpYyByZXN0cm9vbXMiLAogICAgICAgICAgICAgICAgICAgICAgICAiY2xvdWRzIiwKICAgICAgICAgICAgICAgICAgICAgICAgInBvbGl0aWNpYW5zIiwKICAgICAgICAgICAgICAgICAgICAgICAgIm1vdXN0YWNoZXMiLAogICAgICAgICAgICAgICAgICAgICAgICAiaGF0cyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJzaG9lcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJwYW50cyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJjbG93bnMiLAogICAgICAgICAgICAgICAgICAgICAgICAiZW5jeWNsb3BlZGlhcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWJzaXRlcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJwb3R0ZWQgcGxhbnRzIiwKICAgICAgICAgICAgICAgICAgICAgICAgImxlbW9ucyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJob3VzZWhvbGQgaXRlbXMiLAogICAgICAgICAgICAgICAgICAgICAgICAiYm9kaWx5IGZsdWlkcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJjdXRsZXJ5IiwKICAgICAgICAgICAgICAgICAgICAgICAgIm5hdGlvbmFsIGxhbmRtYXJrcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ5b2d1cnQiLAogICAgICAgICAgICAgICAgICAgICAgICAicmFwIG11c2ljIiwKICAgICAgICAgICAgICAgICAgICAgICAgInVuZGVyd2VhciIsCiAgICAgICAgICAgICAgICAgICAgICBdKSwKICAgICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICAgIiBpbiBmcmVhayBtYWdpYyBjYXRhc3Ryb3BoZSEiLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGhlYXZ5IGRpc3NlbnQgcmFnZXMgYmV0d2VlbiB0aGUgc2Nob29scyBvZiAiICsKICAgICAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAgICAgIndhdGVyIiwKICAgICAgICAgICAgICAgICAgICAgICJmaXJlIiwKICAgICAgICAgICAgICAgICAgICAgICJlYXJ0aCIsCiAgICAgICAgICAgICAgICAgICAgICAiYWlyIiwKICAgICAgICAgICAgICAgICAgICAgICJsaWdodG5pbmciLAogICAgICAgICAgICAgICAgICAgICAgImFjaWQiLAogICAgICAgICAgICAgICAgICAgICAgInNvbmciLAogICAgICAgICAgICAgICAgICAgICAgImJhdHRsZSIsCiAgICAgICAgICAgICAgICAgICAgICAicGVhY2UiLAogICAgICAgICAgICAgICAgICAgICAgInBlbmNpbCIsCiAgICAgICAgICAgICAgICAgICAgICAiaW50ZXJuZXQiLAogICAgICAgICAgICAgICAgICAgICAgInNwYWNlIiwKICAgICAgICAgICAgICAgICAgICAgICJ0aW1lIiwKICAgICAgICAgICAgICAgICAgICAgICJicmFpbiIsCiAgICAgICAgICAgICAgICAgICAgICAibmF0dXJlIiwKICAgICAgICAgICAgICAgICAgICAgICJ0ZWNobm8iLAogICAgICAgICAgICAgICAgICAgICAgInBsYW50IiwKICAgICAgICAgICAgICAgICAgICAgICJidWciLAogICAgICAgICAgICAgICAgICAgICAgImljZSIsCiAgICAgICAgICAgICAgICAgICAgICAicG9pc29uIiwKICAgICAgICAgICAgICAgICAgICAgICJjcmFiIiwKICAgICAgICAgICAgICAgICAgICAgICJraXR0ZW4iLAogICAgICAgICAgICAgICAgICAgICAgImRvbHBoaW4iLAogICAgICAgICAgICAgICAgICAgICAgImJpcmQiLAogICAgICAgICAgICAgICAgICAgICAgInB1bmNoIiwKICAgICAgICAgICAgICAgICAgICAgICJmYXJ0IiwKICAgICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICAgIiBtYWdpYyBhbmQgIiArCiAgICAgICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgICAgICJ3YXRlciIsCiAgICAgICAgICAgICAgICAgICAgICAiZmlyZSIsCiAgICAgICAgICAgICAgICAgICAgICAiZWFydGgiLAogICAgICAgICAgICAgICAgICAgICAgImFpciIsCiAgICAgICAgICAgICAgICAgICAgICAibGlnaHRuaW5nIiwKICAgICAgICAgICAgICAgICAgICAgICJhY2lkIiwKICAgICAgICAgICAgICAgICAgICAgICJzb25nIiwKICAgICAgICAgICAgICAgICAgICAgICJiYXR0bGUiLAogICAgICAgICAgICAgICAgICAgICAgInBlYWNlIiwKICAgICAgICAgICAgICAgICAgICAgICJwZW5jaWwiLAogICAgICAgICAgICAgICAgICAgICAgImludGVybmV0IiwKICAgICAgICAgICAgICAgICAgICAgICJzcGFjZSIsCiAgICAgICAgICAgICAgICAgICAgICAidGltZSIsCiAgICAgICAgICAgICAgICAgICAgICAiYnJhaW4iLAogICAgICAgICAgICAgICAgICAgICAgIm5hdHVyZSIsCiAgICAgICAgICAgICAgICAgICAgICAidGVjaG5vIiwKICAgICAgICAgICAgICAgICAgICAgICJwbGFudCIsCiAgICAgICAgICAgICAgICAgICAgICAiYnVnIiwKICAgICAgICAgICAgICAgICAgICAgICJpY2UiLAogICAgICAgICAgICAgICAgICAgICAgInBvaXNvbiIsCiAgICAgICAgICAgICAgICAgICAgICAiY3JhYiIsCiAgICAgICAgICAgICAgICAgICAgICAia2l0dGVuIiwKICAgICAgICAgICAgICAgICAgICAgICJkb2xwaGluIiwKICAgICAgICAgICAgICAgICAgICAgICJiaXJkIiwKICAgICAgICAgICAgICAgICAgICAgICJwdW5jaCIsCiAgICAgICAgICAgICAgICAgICAgICAiZmFydCIsCiAgICAgICAgICAgICAgICAgICAgXSkgKwogICAgICAgICAgICAgICAgICAgICIgbWFnaWMhIiwKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBnZXQgeW91ciBuZXcgY2hhcm1zIGFuZCBjdXJzZXMgYXQgdGhlIHllYXJseSBOYXRpb25hbCBTcGVsbGNyYWZ0aW5nIEZhaXIhIEV4Y2x1c2l2ZSBwcmljZXMgb24gcnVuZXMgYW5kIHNwZWxsYm9va3MuIiwKICAgICAgICAgICAgICAgICAgJ05ld3MgOiBjb29raWUgd2l6YXJkcyBkZW55IGludm9sdmVtZW50IGluIHNob2NraW5nbHkgdWdseSBuZXdib3JuIC0gaW5mYW50IGlzICJob25lc3RseSBncm9keS1sb29raW5nLCBidXQgbmF0dXJhbCIsIHNheSBkb2N0b3JzLicsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogIkFueSBzdWZmaWNpZW50bHkgY3J1ZGUgbWFnaWMgaXMgaW5kaXN0aW5ndWlzaGFibGUgZnJvbSB0ZWNobm9sb2d5IiwgY2xhaW1zIHJlbm93bmVkIHRlY2hub3dpemFyZC4nLAogICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siU2hpcG1lbnQiXS5hbW91bnQgPiAwKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICJOZXdzIDogbmV3IGNob2NvbGF0ZSBwbGFuZXQgZm91bmQsIGJlY29tZXMgdGFyZ2V0IG9mIGNvb2tpZS10cmFkaW5nIHNwYWNlc2hpcHMhIiwKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBtYXNzaXZlIGNob2NvbGF0ZSBwbGFuZXQgZm91bmQgd2l0aCA5OS44JSBjZXJ0aWZpZWQgcHVyZSBkYXJrIGNob2NvbGF0ZSBjb3JlISIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogc3BhY2UgdG91cmlzbSBib29taW5nIGFzIGRpc3RhbnQgcGxhbmV0cyBhdHRyYWN0IG1vcmUgYm9yZWQgbWlsbGlvbmFpcmVzISIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogY2hvY29sYXRlLWJhc2VkIG9yZ2FuaXNtcyBmb3VuZCBvbiBkaXN0YW50IHBsYW5ldCEiLAogICAgICAgICAgICAgICAgICAnTmV3cyA6IGFuY2llbnQgYmFraW5nIGFydGlmYWN0cyBmb3VuZCBvbiBkaXN0YW50IHBsYW5ldDsgInRlcnJpZnlpbmcgaW1wbGljYXRpb25zIiwgZXhwZXJ0cyBzYXkuJywKICAgICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIkFsY2hlbXkgbGFiIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAiTmV3cyA6IG5hdGlvbmFsIGdvbGQgcmVzZXJ2ZXMgZHdpbmRsZSBhcyBtb3JlIGFuZCBtb3JlIG9mIHRoZSBwcmVjaW91cyBtaW5lcmFsIGlzIHR1cm5lZCB0byBjb29raWVzISIsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogY2hvY29sYXRlIGpld2VscnkgZm91bmQgZmFzaGlvbmFibGUsIGdvbGQgYW5kIGRpYW1vbmRzICJqdXN0IGEgZmFkIiwgc2F5cyBzcGVjaWFsaXN0LicsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogc2lsdmVyIGZvdW5kIHRvIGFsc28gYmUgdHJhbnNtdXRhYmxlIGludG8gd2hpdGUgY2hvY29sYXRlISIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogZGVmZWN0aXZlIGFsY2hlbXkgbGFiIHNodXQgZG93biwgZm91bmQgdG8gY29udmVydCBjb29raWVzIHRvIHVzZWxlc3MgZ29sZC4iLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGFsY2hlbXktbWFkZSBjb29raWVzIHNodW5uZWQgYnkgcHVyaXN0cyEiLAogICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siUG9ydGFsIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAiTmV3cyA6IG5hdGlvbiB3b3JyaWVkIGFzIG1vcmUgYW5kIG1vcmUgdW5zZXR0bGluZyBjcmVhdHVyZXMgZW1lcmdlIGZyb20gZGltZW5zaW9uYWwgcG9ydGFscyEiLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGRpbWVuc2lvbmFsIHBvcnRhbHMgaW52b2x2ZWQgaW4gY2l0eS1lbmd1bGZpbmcgZGlzYXN0ZXIhIiwKICAgICAgICAgICAgICAgICAgIk5ld3MgOiB0b3VyaXNtIHRvIGNvb2tpZXZlcnNlIHBvcHVsYXIgd2l0aCBib3JlZCB0ZWVuYWdlcnMhIENhc3VhbHR5IHJhdGUgYXMgaGlnaCBhcyA3MyUhIiwKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBjb29raWV2ZXJzZSBwb3J0YWxzIHN1c3BlY3RlZCB0byBjYXVzZSBmYXN0IGFnaW5nIGFuZCBvYnNlc3Npb24gd2l0aCBiYWtpbmcsIHNheXMgc3R1ZHkuIiwKICAgICAgICAgICAgICAgICAgJ05ld3MgOiAiZG8gbm90IHNldHRsZSBuZWFyIHBvcnRhbHMsIiBzYXlzIHNwZWNpYWxpc3Q7ICJ5b3VyIGNoaWxkcmVuIHdpbGwgYmVjb21lIHN0cmFuZ2UgYW5kIGNvcnJ1cHRlZCBpbnNpZGUuIicsCiAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICk7CgogICAgICAgICAgICBpZiAoR2FtZS5PYmplY3RzWyJUaW1lIG1hY2hpbmUiXS5hbW91bnQgPiAwKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICJOZXdzIDogdGltZSBtYWNoaW5lcyBpbnZvbHZlZCBpbiBoaXN0b3J5LXJld3JpdGluZyBzY2FuZGFsISBPciBhcmUgdGhleT8iLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IHRpbWUgbWFjaGluZXMgdXNlZCBpbiB1bmxhd2Z1bCB0aW1lIHRvdXJpc20hIiwKICAgICAgICAgICAgICAgICAgJ05ld3MgOiBjb29raWVzIGJyb3VnaHQgYmFjayBmcm9tIHRoZSBwYXN0ICJ1bmZpdCBmb3IgaHVtYW4gY29uc3VtcHRpb24iLCBzYXlzIGhpc3Rvcmlhbi4nLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IHZhcmlvdXMgaGlzdG9yaWNhbCBmaWd1cmVzIGluZXhwbGljYWJseSByZXBsYWNlZCB3aXRoIHRhbGtpbmcgbHVtcHMgb2YgZG91Z2ghIiwKICAgICAgICAgICAgICAgICAgJ05ld3MgOiAiSSBoYXZlIHNlZW4gdGhlIGZ1dHVyZSwiIHNheXMgdGltZSBtYWNoaW5lIG9wZXJhdG9yLCAiYW5kIEkgZG8gbm90IHdpc2ggdG8gZ28gdGhlcmUgYWdhaW4uIicsCiAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICk7CgogICAgICAgICAgICBpZiAoR2FtZS5PYmplY3RzWyJBbnRpbWF0dGVyIGNvbmRlbnNlciJdLmFtb3VudCA+IDApCiAgICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgJ05ld3MgOiB3aG9sZSB0b3duIHNlZW1pbmdseSBzd2FsbG93ZWQgYnkgYW50aW1hdHRlci1pbmR1Y2VkIGJsYWNrIGhvbGU7IG1vcmUgcmVsaWFibGUgc291cmNlcyBhZmZpcm0gdG93biAibmV2ZXIgcmVhbGx5IGV4aXN0ZWQiIScsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogImV4cGxhaW4gdG8gbWUgYWdhaW4gd2h5IHdlIG5lZWQgcGFydGljbGUgYWNjZWxlcmF0b3JzIHRvIGJha2UgY29va2llcz8iIGFza3MgbWlzZ3VpZGVkIGxvY2FsIHdvbWFuLicsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogZmlyc3QgYW50aW1hdHRlciBjb25kZW5zZXIgc3VjY2Vzc2Z1bGx5IHR1cm5lZCBvbiwgZG9lc24ndCByaXAgYXBhcnQgcmVhbGl0eSEiLAogICAgICAgICAgICAgICAgICAnTmV3cyA6IHJlc2VhcmNoZXJzIGNvbmNsdWRlIHRoYXQgd2hhdCB0aGUgY29va2llIGluZHVzdHJ5IG5lZWRzLCBmaXJzdCBhbmQgZm9yZW1vc3QsIGlzICJtb3JlIG1hZ25ldHMiLicsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogInVucmF2ZWxsaW5nIHRoZSBmYWJyaWMgb2YgcmVhbGl0eSBqdXN0IG1ha2VzIHRoZXNlIGNvb2tpZXMgc28gbXVjaCB0YXN0aWVyIiwgY2xhaW1zIHNjaWVudGlzdC4nLAogICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siUHJpc20iXS5hbW91bnQgPiAwKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICJOZXdzIDogbmV3IGNvb2tpZS1wcm9kdWNpbmcgcHJpc21zIGxpbmtlZCB0byBvdXRicmVhayBvZiByYWluYm93LXJlbGF0ZWQgdmlyYWwgdmlkZW9zLiIsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogc2NpZW50aXN0cyB3YXJuIGFnYWluc3Qgc3lzdGVtYXRpY2FsbHkgdHVybmluZyBsaWdodCBpbnRvIG1hdHRlciAtICJPbmUgZGF5LCB3ZVwnbGwgZW5kIHVwIHdpdGggYWxsIG1hdHRlciBhbmQgbm8gbGlnaHQhIicsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogY29va2llcyBub3cgYmVpbmcgYmFrZWQgYXQgdGhlIGxpdGVyYWwgc3BlZWQgb2YgbGlnaHQgdGhhbmtzIHRvIG5ldyBwcmlzbWF0aWMgY29udHJhcHRpb25zLiIsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogIkNhblwndCB5b3Ugc2Vuc2UgdGhlIHByaXNtIHdhdGNoaW5nIHVzPyIsIHJhbWJsZXMgaW5zYW5lIGxvY2FsIG1hbi4gIk5vIGlkZWEgd2hhdCBoZVwncyB0YWxraW5nIGFib3V0Iiwgc2hydWdzIGNvb2tpZSBtYWduYXRlL2dvdmVybm1lbnQgb2ZmaWNpYWwuJywKICAgICAgICAgICAgICAgICAgJ05ld3MgOiB3b3JsZCBjaXRpemVucyBhZHZpc2VkICJub3QgdG8gd29ycnkiIGFib3V0IGZyZXF1ZW50IGF0bW9zcGhlcmljIGZsYXNoZXMuJywKICAgICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIkNoYW5jZW1ha2VyIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAiTmV3cyA6IHN0cmFuZ2Ugc3RhdGlzdGljYWwgYW5vbWFsaWVzIGNvbnRpbnVlIGFzIHdlYXRoZXIgZm9yZWNhc3QgcHJvdmVzIGFjY3VyYXRlIGFuIHVucHJlY2VkZW50ZWQgMyBkYXlzIGluIGEgcm93ISIsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogbG9jYWwgY2FzaW5vIHJ1aW5lZCBhcyBhbGwgZ2FtYmxlcnMgc29tZWhvdyBoaXQgYSB3ZWVrLWxvbmcgd2lubmluZyBzdHJlYWshICJXZSBtaWdodCBzdGlsbCBiZSBva2F5Iiwgc2F5cyBvd25lciBiZWZvcmUgYmVpbmcgaGl0IGJ5IGxpZ2h0bmluZyA0NyB0aW1lcy4nLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IG5laWdoYm9yaW5nIG5hdGlvbiBzb21laG93IGVsZWN0cyBwcmVzaWRlbnQgd2l0aCBzZW5zaWJsZSBwb2xpY2llcyBpbiBmcmVhayBhY2NpZGVudCBvZiByYW5kb20gY2hhbmNlISIsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogbWlsbGlvbi10by1vbmUgZXZlbnQgc2VlcyBncml0dHkgbW92aWUgcmVib290IHR1cm5pbmcgb3V0IGJldHRlciB0aGFuIHRoZSBvcmlnaW5hbCEgIldlIGhhdmUgbm8gaWRlYSBob3cgdGhpcyBoYXBwZW5lZCIsIHNheSBtb3ZpZSBleGVjcy4nLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGFsbCBzY3JhdGNoaW5nIHRpY2tldHMgcHJpbnRlZCBhcyB3aW5uZXJzLCBwcm9tcHRpbmcgbmF0aW9uYWwgZWNvbm9teSB0byBjcmFzaCBhbmQsIGFnYWluc3QgYWxsIG9kZHMsIHJlY292ZXIgb3Zlcm5pZ2h0LiIsCiAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICk7CgogICAgICAgICAgICBpZiAoR2FtZS5PYmplY3RzWyJGcmFjdGFsIGVuZ2luZSJdLmFtb3VudCA+IDApCiAgICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgJ05ld3MgOiBsb2NhbCBtYW4gImRvbmUgd2l0aCBDb29raWUgQ2xpY2tlciIsIGZpbmRzIHRoZSBjb25zdGFudCBzZWxmLXJlZmVyZW5jZXMgImdyYXRpbmcgYW5kIG9uLXRoZS1ub3NlIi4nLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGxvY2FsIG1hbiBzYWlscyBhcm91bmQgdGhlIHdvcmxkIHRvIGZpbmQgaGltc2VsZiAtIHJpZ2h0IHdoZXJlIGhlIGxlZnQgaXQuIiwKICAgICAgICAgICAgICAgICAgJ05ld3MgOiBsb2NhbCBndXJ1IGNsYWltcyAidGhlcmVcJ3MgYSBsaXR0bGUgYml0IG9mIG91cnNlbHZlcyBpbiBldmVyeW9uZSIsIHVuZGVyIGludmVzdGlnYXRpb24gZm9yIGFsbGVnZWQgY2FubmliYWxpc20uJywKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBuZXdzIHdyaXRlciBmaW5kcyBoZXJzZWxmIGRheWRyZWFtaW5nIGFib3V0IG5ldyBjYXJlZXIuIE9yIGF0IGxlYXN0IGEgcmFpc2UuIiwKICAgICAgICAgICAgICAgICAgJ05ld3MgOiBwb2xscyBmaW5kIGlkZWEgb2YgY29va2llcyBtYWRlIG9mIGNvb2tpZXMgImFjY2VwdGFibGUiIC0gImF0IGxlYXN0IHdlIGZpbmFsbHkga25vdyB3aGF0XCdzIGluIHRoZW0iLCBzYXlzIGludGVydmlld2VkIGNpdGl6ZW4uJywKICAgICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIkphdmFzY3JpcHQgY29uc29sZSJdLmFtb3VudCA+IDApCiAgICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBzdHJhbmdlIGZhZCBoYXMgcGFyZW50cyBnaXZpbmcgdGhlaXIgbmV3Ym9ybnMgbmFtZXMgc3VjaCBhcyBFbW1hLmpzIG9yIExpYW0uanMuIEF0IGxlYXN0IG9uZSBCYWJ5LmpzIHJlcG9ydGVkLiIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogY29kaW5nIGlzIGhpcCEgTW9yZSBhbmQgbW9yZSB0ZWVuYWdlcnMgdHVybiB0byB0ZWNobmljYWwgZmllbGRzIGxpa2UgcHJvZ3JhbW1pbmcsIGVuc3VyaW5nIGEgZnV0dXJlIHJvYm90IGFwb2NhbHlwc2UgYW5kIHRoZSBkb29tIG9mIGFsbCBtYW5raW5kLiIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogZGV2ZWxvcGVycyB1bnN1cmUgd2hhdCB0byBjYWxsIHRoZWlyIG5ldyBqYXZhc2NyaXB0IGxpYnJhcmllcyBhcyBhbGwgY29tYmluYXRpb25zIG9mIGFueSAzIGRpY3Rpb25hcnkgd29yZHMgaGF2ZSBhbHJlYWR5IGJlZW4gdGFrZW4uIiwKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBuYXRpb24gaG9sZHMgYnJlYXRoIGFzIG5lc3RlZCBpZnMgYWJvdXQgdG8gaGF0Y2guIiwKICAgICAgICAgICAgICAgICAgJ05ld3MgOiBjbHVlbGVzcyBjb3B5d3JpdGVyIGZvcmdldHMgdG8gZXNjYXBlIGEgcXVvdGUsIGVuZHMgbmV3cyBsaW5lIHByZW1hdHVyZWx5OyBsYXN0IHdvcmRzIHJlcG9ydGVkIHRvIGJlICJIdWgsIHdoeSBpc24nLAogICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siSWRsZXZlcnNlIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAiTmV3cyA6IGlzIGFub3RoZXIgeW91IGxpdmluZyBvdXQgdGhlaXIgZHJlYW1zIGluIGFuIGFsdGVybmF0ZSB1bml2ZXJzZT8gUHJvYmFibHksIHlvdSBsYXp5IGJ1bSEiLAogICAgICAgICAgICAgICAgICAnTmV3cyA6IHB1YmxpYyByZWNvaWxzIGF0IHRoZSBub3Rpb24gb2YgYSBjb3Ntb3MgbWFkZSBvZiBpbmZpbml0ZSBpZGxlIGdhbWVzLiAiSSBraW5kYSBob3BlZCB0aGVyZVwnZCBiZSBtb3JlIHRvIGl0Iiwgc2F5cyBkaXN0cmF1Z2h0IGNpdGl6ZW4uJywKICAgICAgICAgICAgICAgICAgJ05ld3MgOiB3aXRoIGFuIGluZmluaXR5IG9mIHBhcmFsbGVsIHVuaXZlcnNlcywgcGVvcGxlIHR1cm4gdG8gcmVhc3N1cmluZyBhbHRlcm5hdGUgZGltZW5zaW9ucywgd2hpY2ggb25seSBudW1iZXIgImluIHRoZSBoaWdoIDUwcyIuJywKICAgICAgICAgICAgICAgICAgJ05ld3MgOiAiSSBmaW5kIHNvbGFjZSBpbiB0aGUga25vd2xlZGdlIHRoYXQgYXQgbGVhc3Qgc29tZSBvZiBteSBhbHRlcm5hdGUgc2VsdmVzIGFyZSBwcm9iYWJseSBkb2luZyBmaW5lIG91dCB0aGVyZSIsIHNheXMgY2l0aXplblwncyBsYXN0IHJlbWFpbmluZyBleGVtcGxhciBpbiB0aGUgbXVsdGl2ZXJzZS4nLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGNvbWljIGJvb2sgd3JpdGVycyBwb2ludCB0byBhY3R1YWwgbXVsdGl2ZXJzZSBpbiBkZWZlbnNlIG9mIGR1YmlvdXMgcGxvdCBwb2ludHMuIFwiU2VlPyBJIHRvbGQgeW91IGl0IHdhc24ndCAnaGFja25leWVkIGFuZCBjb250cml2ZWQnIVwiIiwKICAgICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIkNvcnRleCBiYWtlciJdLmFtb3VudCA+IDApCiAgICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBjb3J0ZXggYmFrZXIgd3JhbmdsZXJzIGtpbmRseSByZW1pbmQgZW1wbG95ZWVzIHRoYXQgY29ydGV4IGJha2VycyBhcmUgdGhlIGJha2VyeSdzIG1hdGVyaWFsIHByb3BlcnR5IGFuZCBzaG91bGQgbm90IGJlIGVuZGVhcmVkIHdpdGggbmlja25hbWVzLiIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogc3BhY2UtZmFyaW5nIGVtcGxveWVlcyBhZHZpc2VkIHRvIGlnbm9yZSB1bnVzdWFsIHRob3VnaHRzIGFuZCB1cmdlcyBleHBlcmllbmNlZCB3aXRoaW4gMiBwYXJzZWNzIG9mIGdpZ2FudGljIGNvcnRleCBiYWtlcnMsIHNheSBndWlkZWxpbmVzLiIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogYXN0cm9ub21lcnMgd2FybiBvZiBjb3J0ZXggYmFrZXIgdHJhamVjdG9yeSBkcmlmdCwgZmVhciBmdXR1cmUgaGVhZC1vbiBjb2xsaXNpb25zIHJlc3VsdGluZyBpbiBjb3N0bHkgY29uY3Vzc2lvbnMuIiwKICAgICAgICAgICAgICAgICAgJ05ld3MgOiBydW50IGNvcnRleCBiYWtlciBpZGVudGlmaWVkIHdpdGggYW4gSVEgb2Ygb25seSBxdWludHVwbGUgZGlnaXRzOiAianVzdCBhIGJpdCBvZiBhIGR1bW15Iiwgc2F5IHNwZWNpYWxpc3RzLicsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogYXJlIHlvdSBzbWFydGVyIHRoYW4gYSBjb3J0ZXggYmFrZXI/IE5ldyBnYW1lIHNob3cgZGVlbWVkICJ1bmZhaXIiIGJ5IGNvbnRlc3RhbnRzLicsCiAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICk7CgogICAgICAgICAgICBpZiAoR2FtZS5zZWFzb24gPT0gImhhbGxvd2VlbiIgJiYgR2FtZS5jb29raWVzRWFybmVkID49IDEwMDApCiAgICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBzdHJhbmdlIHR3aXN0aW5nIGNyZWF0dXJlcyBhbWFzcyBhcm91bmQgY29va2llIGZhY3RvcmllcywgbmliYmxlIGF0IGFzc2VtYmx5IGxpbmVzLiIsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogb21pbm91cyB3cmlua2x5IG1vbnN0ZXJzIHRha2UgbWFzc2l2ZSBiaXRlcyBvdXQgb2YgY29va2llIHByb2R1Y3Rpb247ICJ0aGlzIGNhblwndCBiZSBoeWdpZW5pYyIsIHdvcnJpZXMgd29ya2VyLicsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogcGFnYW4gcml0dWFscyBvbiB0aGUgcmlzZSBhcyBjaGlsZHJlbiBhcm91bmQgdGhlIHdvcmxkIGRyZXNzIHVwIGluIHN0cmFuZ2UgY29zdHVtZXMgYW5kIGJsYWNrbWFpbCBob21lb3duZXJzIGZvciBjYW5keS4iLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IG5ldy1hZ2UgdGVycm9yaXNtIHN0cmlrZXMgc3VidXJicyBhcyBob3VzZXMgZmluZCB0aGVtc2VsdmVzIGNvdmVyZWQgaW4gZWdncyBhbmQgdG9pbGV0IHBhcGVyLiIsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogY2hpbGRyZW4gYXJvdW5kIHRoZSB3b3JsZCAibG9zdCBhbmQgY29uZnVzZWQiIGFzIGFueSBhbmQgYWxsIEhhbGxvd2VlbiB0cmVhdHMgaGF2ZSBiZWVuIHJlcGxhY2VkIGJ5IGNvb2tpZXMuJywKICAgICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmIChHYW1lLnNlYXNvbiA9PSAiY2hyaXN0bWFzIiAmJiBHYW1lLmNvb2tpZXNFYXJuZWQgPj0gMTAwMCkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAiTmV3cyA6IGJlYXJkZWQgbWFuaWFjIHNwb3R0ZWQgc3BlZWRpbmcgb24gZmx5aW5nIHNsZWlnaCEgSW52ZXN0aWdhdGlvbiBwZW5kaW5nLiIsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogU2FudGEgQ2xhdXMgYW5ub3VuY2VzIG5ldyBicmFuZCBvZiBicmVha2Zhc3QgdHJlYXRzIHRvIGNvbXBldGUgd2l0aCBjb29raWUtZmxhdm9yZWQgY2VyZWFscyEgIlRoZXlcJ3JlIGhvLWhvLWhvcnJpYmxlISIgc2F5cyBTYW50YS4nLAogICAgICAgICAgICAgICAgICAnTmV3cyA6ICJZb3UgbWVhbiBoZSBqdXN0IGdpdmVzIHN0dWZmIGF3YXkgZm9yIGZyZWU/ISIsIGNvbmNlcm5lZCBtb21zIGFzay4gIlBlcnNvbmFsbHksIEkgZG9uXCd0IHRydXN0IGhpcyBiZWFyZC4iJywKICAgICAgICAgICAgICAgICAgJ05ld3MgOiBvYmVzZSBqb2xseSBsdW5hdGljIHN0aWxsIG9uIHRoZSBsb29zZSwgd2FybiBvZmZpY2lhbHMuICJLZWVwIHlvdXIga2lkcyBzYWZlIGFuZCBib2FyZCB1cCB5b3VyIGNoaW1uZXlzLiBXZSBtZWFuIGl0LiInLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGNoaWxkcmVuIHNob2NrZWQgYXMgdGhleSBkaXNjb3ZlciBTYW50YSBDbGF1cyBpc24ndCBqdXN0IHRoZWlyIGRhZCBpbiBhIGNvc3R1bWUgYWZ0ZXIgYWxsITxicj5cIkknbSByZWFzc2Vzc2luZyBteSBsaWZlIHJpZ2h0IG5vd1wiLCBjb25maWRlcyBMYXVyYSwgYWdlZCA2LiIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogbXlzdGVyaW91cyBmZXN0aXZlIGVudGl0eSB3aXRoIHF1YW50dW0gcG93ZXJzIHN0aWxsIHdyZWNraW5nIGhhdm9jIHdpdGggYXJteSBvZiByZWluZGVlciwgb2ZmaWNpYWxzIHNheS4iLAogICAgICAgICAgICAgICAgICAnTmV3cyA6IGVsdmVzIG9uIHN0cmlrZSBhdCB0b3kgZmFjdG9yeSEgIldlIHdpbGwgbm90IGJlIGFjY2VwdGluZyByZWluZGVlciBjaG93IGFzIHBheW1lbnQgYW55bW9yZS4gQW5kIHN0b3AgY2FsbGluZyB1cyBlbHZlcyEiJywKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBlbHZlcyBwcm90ZXN0IGFyb3VuZCB0aGUgbmF0aW9uOyB3ZWUgbGl0dGxlIGZvbGtzIGluIHNpbGx5IGxpdHRsZSBvdXRmaXRzIHNwcmVhZCBtYXloZW0sIGRlc3RydWN0aW9uOyByYWJpZCByZWluZGVlciBydW5uaW5nIHJhbXBhbnQgdGhyb3VnaCBzdHJlZXRzLiIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogc2Nob2xhcnMgZGViYXRlIHJlZ2FyZGluZyB0aGUgcGx1cmFsIG9mIHJlaW5kZWVyKHMpIGluIHRoZSBtaWRzdCBvZiBlbHZlbiB3b3JsZCB3YXIuIiwKICAgICAgICAgICAgICAgICAgJ05ld3MgOiBlbHZlcyAidW5yZWxhdGVkIHRvIGdub21lcyBkZXNwaXRlIHNtYWxsIHN0YXR1cmUgYW5kIG1lcnJ5IGRpc3Bvc2l0aW9uIiwgZmluZCBzY2llbnRpc3RzLicsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogZWx2ZXMgc2Fib3RhZ2UgcmFkaW9hY3RpdmUgZnJvc3RpbmcgZmFjdG9yeSwgdHVybiBodW5kcmVkcyBibGluZCBpbiB2aWNpbml0eSAtICJXaG8gaW4gdGhlaXIgcmlnaHQgbWluZCB3b3VsZCBkbyBzdWNoIGEgdGhpbmc/IiBsYW1lbnRzIG91dHJhZ2VkIG1heW9yLicsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogZHJhbWEgdW5mb2xkcyBhdCBOb3J0aCBQb2xlIGFzIHJ1bW9ycyBjcm9wIHVwIGFyb3VuZCBSdWRvbHBoXCdzIHJlZCBub3NlOyAiSSBtYXkgaGF2ZSBhbiBhZGRpY3Rpb24gb3IgdHdvIiwgYWRtaXRzIHJlaW5kZWVyLicsCiAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICk7CgogICAgICAgICAgICBpZiAoR2FtZS5zZWFzb24gPT0gInZhbGVudGluZXMiICYmIEdhbWUuY29va2llc0Vhcm5lZCA+PSAxMDAwKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICJOZXdzIDogb3JnYW4tc2hhcGVkIGNvbmZlY3Rpb25lcmllcyBiZWluZyB0cmFkZWQgaW4gc2Nob29scyBhbGwgb3ZlciB0aGUgd29ybGQ7IGdydWVzb21lIHByYWN0aWNlIHVuZGVyZ29pbmcgaW52ZXN0aWdhdGlvbi4iLAogICAgICAgICAgICAgICAgICAnTmV3cyA6IGhlYXJ0LXNoYXBlZCBjYW5kaWVzIG92ZXJ0YWtpbmcgc3dlZXRzIGJ1c2luZXNzLCBvZmZlcmluZyBjb21wZXRpdGlvbiB0byBjb29raWUgZW1waXJlLiAiSXRcJ3MgdGhlIGVjb25vbXksIGN1cGlkISInLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGxvdmUncyBpbiB0aGUgYWlyLCBhY2NvcmRpbmcgdG8gd2VhdGhlciBzcGVjaWFsaXN0cy4gRmFjZSBtYXNrcyBub3cgb2ZmZXJlZCBpbiBldmVyeSBjaXR5IHRvIHN0dW50IGFpcmJvcm5lIGluZmVjdGlvbi4iLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IG1hcnJ5aW5nIGEgY29va2llIC0gZGVyYW5nZWQgcHJhY3RpY2UsIG9yIGdsaW1wc2Ugb2YgdGhlIGZ1dHVyZT8iLAogICAgICAgICAgICAgICAgICAnTmV3cyA6IGJveWZyaWVuZCBkdW1wZWQgYWZ0ZXIgb2ZmZXJpbmcgaGlzIGxvdmVyIGNvb2tpZXMgZm9yIFZhbGVudGluZVwncyBEYXksIHJlcG9ydHMgc2F5LiAiVGhleSB3ZXJlIG9mZi1icmFuZCIsIHNocnVncyBleC1naXJsZnJpZW5kLicsCiAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICk7CgogICAgICAgICAgICBpZiAoR2FtZS5zZWFzb24gPT0gImVhc3RlciIgJiYgR2FtZS5jb29raWVzRWFybmVkID49IDEwMDApCiAgICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBsb25nLWVhcmVkIGNyaXR0ZXJzIHdpdGggZnV6enkgdGFpbHMgaW52YWRlIHN1YnVyYnMsIHNwcmVhZCB0ZXJyb3IgYW5kIGNob2NvbGF0ZSEiLAogICAgICAgICAgICAgICAgICAnTmV3cyA6IGVnZ3MgaGF2ZSBiZWd1biB0byBtYXRlcmlhbGl6ZSBpbiB0aGUgbW9zdCB1bmV4cGVjdGVkIHBsYWNlczsgIm5vIHBsYWNlIGlzIHNhZmUiLCB3YXJuIGV4cGVydHMuJywKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBwYWNrcyBvZiByYW1wYWdpbmcgcmFiYml0cyBjYXVzZSBiaWxsaW9ucyBpbiBwcm9wZXJ0eSBkYW1hZ2U7IG5ldyBzdHJhaW4gb2YgbXl4b21hdG9zaXMgYmVpbmcgZGV2ZWxvcGVkLiIsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogZWdnLWxheWluZyByYWJiaXRzICJub3QgcXVpdGUgZnJvbSB0aGlzIGRpbWVuc2lvbiIsIHdhcm5zIGJpb2xvZ2lzdDsgYWR2aXNlcyBhZ2FpbnN0IHBldHRpbmcsIGZlZWRpbmcsIG9yIGNvb2tpbmcgdGhlIGNyZWF0dXJlcy4nLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IG15c3RlcmlvdXMgcmFiYml0cyBmb3VuZCB0byBiZSBlZ2ctbGF5ZXJzLCBidXQgbWFtbWFsaWFuLCBoaW50aW5nIGF0IHBvc3NpYmxlIHBsYXR5cHVzIGFuY2VzdHJ5LiIsCiAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICghRU4pIHsKICAgICAgICAgIGlmIChHYW1lLmNvb2tpZXNFYXJuZWQgPj0gMTAwMDApIHsKICAgICAgICAgICAgbGlzdC5wdXNoKE5FV1MgKyBjaG9vc2UobG9jKCJUaWNrZXIgKG1pc2MpIikpKTsKICAgICAgICAgICAgbGlzdC5wdXNoKE5FV1MgKyBjaG9vc2UobG9jKCJUaWNrZXIgKG1pc2MpIikpKTsKICAgICAgICAgICAgbGlzdC5wdXNoKE5FV1MgKyBjaG9vc2UobG9jKCJUaWNrZXIgKG1pc2MpIikpKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPCAwLjA1KSB7CiAgICAgICAgICAgIGlmIChHYW1lLkhhc0FjaGlldigiQmFzZSAxMCIpKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgICJOZXdzIDogY29va2llIG1hbnVmYWN0dXJlciBjb21wbGV0ZWx5IGZvcmdvZXMgY29tbW9uIHNlbnNlLCBsZXRzIHN0cmFuZ2Ugb2JzZXNzaW9uIHdpdGggcm91bmQgbnVtYmVycyBkcml2ZSBidWlsZGluZyBkZWNpc2lvbnMhIgogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmIChHYW1lLkhhc0FjaGlldigiRnJvbSBzY3JhdGNoIikpCiAgICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgICAgIk5ld3MgOiBmb2xsb3cgdGhlIHRlYXItamVya2luZywgcmljaGVzLXRvLXJhZ3Mgc3RvcnkgYWJvdXQgYSBsb2NhbCBjb29raWUgbWFudWZhY3R1cmVyIHdobyBkZWNpZGVkIHRvIGdpdmUgaXQgYWxsIHVwISIKICAgICAgICAgICAgICApOwogICAgICAgICAgICBpZiAoR2FtZS5IYXNBY2hpZXYoIkEgd29ybGQgZmlsbGVkIHdpdGggY29va2llcyIpKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgICJOZXdzIDoga25vd24gdW5pdmVyc2Ugbm93IGphbW1lZCB3aXRoIGNvb2tpZXMhIE5vIHZhY2FuY2llcyEiCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgaWYgKEdhbWUuSGFzQWNoaWV2KCJMYXN0IENoYW5jZSB0byBTZWUiKSkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICAiTmV3cyA6IGluY3JlZGlibHkgcmFyZSBhbGJpbm8gd3JpbmtsZXIgb24gdGhlIGJyaW5rIG9mIGV4dGluY3Rpb24gcG9hY2hlZCBieSBjb29raWUtY3JhemVkIHBhc3RyeSBtYWduYXRlISIKICAgICAgICAgICAgICApOwogICAgICAgICAgICBpZiAoR2FtZS5IYXMoIlNlcmVuZGlwaXR5IikpCiAgICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgICAgIk5ld3MgOiBsb2NhbCBjb29raWUgbWFudWZhY3R1cmVyIGJlY29tZXMgbHVja2llc3QgYmVpbmcgYWxpdmUhIgogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmIChHYW1lLkhhcygiU2Vhc29uIHN3aXRjaGVyIikpCiAgICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgICAgJ05ld3MgOiBzZWFzb25zIGFyZSBhbGwgb3V0IG9mIHdoYWNrISAiV2UgbmVlZCB0byBnZXQgc29tZSB3aGFjayBiYWNrIGludG8gdGhlbSBzZWFzb25zIiwgc2F5cyBsb2NhbCByZXNpZGVudC4nCiAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIGhlbHBlcnMiKSkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICAiTmV3cyA6IGZhaW50IG1lb3dpbmcgaGVhcmQgYXJvdW5kIGxvY2FsIGNvb2tpZSBmYWNpbGl0aWVzOyBzdWdnZXN0cyBuZXcgaW5ncmVkaWVudCBiZWluZyB0ZXN0ZWQuIgogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIHdvcmtlcnMiKSkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICAiTmV3cyA6IGNyb3dkcyBvZiBtZW93aW5nIGtpdHRlbnMgd2l0aCBsaXR0bGUgaGFyZCBoYXRzIHJlcG9ydGVkIG5lYXIgbG9jYWwgY29va2llIGZhY2lsaXRpZXMuIgogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIGVuZ2luZWVycyIpKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgICJOZXdzIDogc3Vycm91bmRpbmdzIG9mIGxvY2FsIGNvb2tpZSBmYWNpbGl0aWVzIG5vdyBvdmVycnVuIHdpdGgga2l0dGVucyBpbiBhZG9yYWJsZSBsaXR0bGUgc3VpdHMuIEF1dGhvcml0aWVzIGFkdmlzZSB0byBzdGF5IGF3YXkgZnJvbSB0aGUgcHJlbWlzZXMuIgogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIG92ZXJzZWVycyIpKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgICJOZXdzIDogbG9jYWxzIHJlcG9ydCB0cm91cGUgb2YgYm9zc3kga2l0dGVucyBtZW93aW5nIGFkb3JhYmxlIG9yZGVycyBhdCBwYXNzZXJzYnkuIgogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIG1hbmFnZXJzIikpCiAgICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgICAgJ05ld3MgOiBsb2NhbCBvZmZpY2UgY3ViaWNsZXMgaW52YWRlZCB3aXRoIGFybWllcyBvZiBzdGVybi1sb29raW5nIGtpdHRlbnMgYXNraW5nIGVtcGxveWVlcyAid2hhdFwncyBoYXBwZW5pbmcsIG1lb3ciLicKICAgICAgICAgICAgICApOwogICAgICAgICAgICBpZiAoR2FtZS5IYXMoIktpdHRlbiBhY2NvdW50YW50cyIpKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgICJOZXdzIDogdGlueSBmZWxpbmVzIHNob3cgc3VkZGVuIGFuZCBhbWF6aW5nIHByb2ZpY2llbmN5IHdpdGggZnV6enkgbWF0aGVtYXRpY3MgYW5kIHBhd2xpbm9taWFscywgYmFmZmxpbmcgc2NpZW50aXN0cyBhbmQgcGV0IHN0b3JlIG93bmVycy4iCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgaWYgKEdhbWUuSGFzKCJLaXR0ZW4gc3BlY2lhbGlzdHMiKSkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICAiTmV3cyA6IG5ldyBraXR0ZW4gY29sbGVnZSBvcGVuaW5nIG5leHQgd2Vlaywgb2ZmZXJzIGNvdXJzZXMgb24gY29va2llLW1ha2luZyBhbmQgY2F0bmlwIHN0dWRpZXMuIgogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIGV4cGVydHMiKSkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICAiTmV3cyA6IHVuZW1wbG95bWVudCByYXRlcyBzb2FyaW5nIGFzIHdvZWZ1bGx5IGFkb3JhYmxlIGxpdHRsZSBjYXRzIG5hYiBqb2JzIG9uIGFsbCBsZXZlbHMgb2YgZXhwZXJ0aXNlLCBzYXlzIHN0dWR5LiIKICAgICAgICAgICAgICApOwogICAgICAgICAgICBpZiAoR2FtZS5IYXMoIktpdHRlbiBjb25zdWx0YW50cyIpKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgICdOZXdzIDogIkluIHRoZSBmdXR1cmUsIHlvdXIgam9iIHdpbGwgbW9zdCBsaWtlbHkgYmUgZG9uZSBieSBhIGNhdCIsIHByZWRpY3RzIHN1c3BpY2lvdXNseSBmdXJyeSBmdXR1cm9sb2dpc3QuJwogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIGFzc2lzdGFudHMgdG8gdGhlIHJlZ2lvbmFsIG1hbmFnZXIiKSkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICAiTmV3cyA6IHN0cmFuZ2Uga2l0dGVucyB3aXRoIHBlY3VsaWFyIG9waW5pb25zIG9uIG1hcnRpYWwgYXJ0cyBzcG90dGVkIGxvaXRlcmluZyBvbiBsb2NhbCBiZWV0IGZhcm1zISIKICAgICAgICAgICAgICApOwogICAgICAgICAgICBpZiAoR2FtZS5IYXMoIktpdHRlbiBtYXJrZXRlZXJzIikpCiAgICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgICAgIk5ld3MgOiBub25zZW5zaWNhbCBraXR0ZW4gYmlsbGJvYXJkcyBjcm9wIHVwIGFsbCBvdmVyIGNvdW50cnlzaWRlLCB0cnlpbmcgdG8gc2VsbCBwZW9wbGUgdGhlIGNvb2tpZXMgdGhleSBhbHJlYWR5IGdldCBmb3IgZnJlZSEiCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgaWYgKEdhbWUuSGFzKCJLaXR0ZW4gYW5hbHlzdHMiKSkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICAiTmV3cyA6IGFyZSB5b3VyIHNwZW5kaW5nIGhhYml0cyBzZW5zaWJsZT8gRm9yIGEgaGVmdHkgZmVlLCB0aGVzZSBraXR0ZW4gYW5hbHlzdHMgd2lsbCB0ZWxsIHlvdSEiCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgaWYgKEdhbWUuSGFzKCJLaXR0ZW4gZXhlY3V0aXZlcyIpKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgICJOZXdzIDoga2l0dGVucyBzdHJ1dHRpbmcgYXJvdW5kIGluIGhvdCBsaXR0bGUgYnVzaW5lc3Mgc3VpdHMgc2hvdXRpbmcgY3V0LXRocm9hdCBvcmRlcnMgYXQgdGhlaXIgYXNzaXN0YW50cywgcG9zc2libHkgdGhlIGN1dGVzdCB0aGluZyB0aGlzIHJlcG9ydGVyIGhhcyBldmVyIHNlZW4hIgogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIGFkbWlucyIpKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgICJOZXdzIDogYWxsIHN5c3RlbXMgbm9taW5hbCwgY2xhaW0ga2l0dGVuIGFkbWlucyBvYnZpb3VzbHkgaW4gd2F5IG92ZXIgdGhlaXIgaGVhZHMuIgogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmIChHYW1lLkhhcygiS2l0dGVuIGFuZ2VscyIpKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgICdOZXdzIDogIlRyeSB0byBpZ25vcmUgYW55IGdob3N0bHkgZmVsaW5lcyB0aGF0IG1heSBiZSBwdXJyaW5nIGluc2lkZSB5b3VyIGVhcnMsIiB3YXJuIHNjaWVudGlzdHMuICJUaGV5XCdsbCBqdXN0IGx1cmUgeW91IGludG8gbWFraW5nIHBvb3IgbGlmZSBjaG9pY2VzLiInCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgaWYgKEdhbWUuSGFzKCJLaXR0ZW4gd2FnZXMiKSkKICAgICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgICAiTmV3cyA6IGtpdHRlbnMgYnJlYWsgZ2xhc3MgY2VpbGluZyEgRG8gdGhleSBoYXZlIGFueSBpZGVhIGhvdyBleHBlbnNpdmUgdGhvc2UgYXJlISIKICAgICAgICAgICAgICApOwogICAgICAgICAgICBpZiAoR2FtZS5IYXNBY2hpZXYoIkplbGxpY2xlcyIpKQogICAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAgICJOZXdzIDogbG9jYWwga2l0dGVucyBpbnZvbHZlZCBpbiBtaXNndWlkZWQgbXVzaWNhbCBwcm9kdWN0aW9uLCBsZWF2ZSBhdWRpZW5jZSBwZXJ0dXJiZWQgYW5kIHVubmVydmVkLiIKICAgICAgICAgICAgICApOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChHYW1lLkhhc0FjaGlldigiRHVkZSwgc3dlZXQiKSAmJiBNYXRoLnJhbmRvbSgpIDwgMC4yKQogICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICJOZXdzIDogbWFqb3Igc3VnYXItc211Z2dsaW5nIHJpbmcgZGlzbWFudGxlZCBieSBhdXRob3JpdGllczsgIiArCiAgICAgICAgICAgICAgICAgIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDMwICsgMykgKwogICAgICAgICAgICAgICAgICAiIHRvbnMgb2Ygc3VnYXIgbHVtcHMgc2VpemVkLCAiICsKICAgICAgICAgICAgICAgICAgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNDggKyAyKSArCiAgICAgICAgICAgICAgICAgICIgc3VzcGVjdHMgYXBwcmVoZW5kZWQuIiwKICAgICAgICAgICAgICAgICJOZXdzIDogYXV0aG9yaXRpZXMgd2FybiB0b3VyaXN0cyBub3QgdG8gYnV5IGJvb3RsZWcgc3VnYXIgbHVtcHMgZnJvbSBzdHJlZXQgcGVkZGxlcnMgLSBcIllvdSB0aGluayB5b3UncmUgZ2V0dGluZyBhIHN3ZWV0IGRlYWwsIGJ1dCB3aGF0IHlvdSdyZSBiZWluZyBzb2xkIGlzIHJlYWxseSBqdXN0IG9yZGluYXJ5IGNvY2FpbmVcIiwgc2F5cyBhZ2VudC4iLAogICAgICAgICAgICAgICAgIk5ld3MgOiBwcm8tZGlhYmV0ZXMgbW92ZW1lbnQgcHJvdGVzdHMgYWdhaW5zdCBzdWdhci1zaGFtaW5nLiBcIkkndmUgZWF0ZW4gbm90aGluZyBidXQgc3VnYXIgbHVtcHMgZm9yIHRoZSBwYXN0ICIgKwogICAgICAgICAgICAgICAgICBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCArIDQpICsKICAgICAgICAgICAgICAgICAgIiB5ZWFycyBhbmQgSSdtIGZlZWxpbmcgZ3JlYXQhXCIsIHNheXMgd29tYW4gd2l0aCBmcmlhYmxlIHNraW4uIiwKICAgICAgICAgICAgICAgICJOZXdzIDogZXhwZXJ0cyBpbiBiaXR0ZXIgZGlzYWdyZWVtZW50IG92ZXIgd2hldGhlciBzdWdhciBjb25zdW1wdGlvbiB0dXJucyBjaGlsZHJlbiBzbHVnZ2lzaCBvciBoeXBlcmFjdGl2ZS4iLAogICAgICAgICAgICAgICAgIk5ld3MgOiBmaXNoZXJtZW4gZGVwbG9yZSB1cHR1cm4gaW4gZmlzaCB0b290aCBkZWNheSBhcyBzdWdhciBsdW1wcy1oYXVsaW5nIGNhcmdvIHNpbmtzIGludG8gdGhlIG9jZWFuLiIsCiAgICAgICAgICAgICAgICAiTmV3cyA6IHJhcmUgYmxhY2sgc3VnYXIgbHVtcCB0aGF0IGNhcHRpdmF0ZWQgbWlsbGlvbnMgaW4gdW5wcmVjZWRlbnRlZCBhdWN0aW9uIHJldmVhbGVkIHRvIGJlIGNvbW1vbiB0b3hpYyBmdW5ndXMuIiwKICAgICAgICAgICAgICAgICdOZXdzIDogIkJhY2sgaW4gbXkgZGF5LCBzdWdhciBsdW1wcyB3ZXJlIHRoZXNlIGxpdHRsZSBjdWJlcyB5b3VcJ2QgcHV0IGluIHlvdXIgdGVhLCBub3QgdGhvc2UgZmlzdC1zaXplZCBtb25zdHJvc2l0aWVzIHBlb3BsZSBlYXQgZm9yIGx1bmNoIiwgd2hpbmVzIGN1cm11ZGdlb24gd2l0aCBmYWlsaW5nIG1lbW9yeS4nLAogICAgICAgICAgICAgICAgIk5ld3MgOiBzdWdhciBsdW1wLXNuYWNraW5nIGZhZCBzd2VlcHMgdGhlIG5hdGlvbjsgZGVudGlzdHMgZXZlcnl3aGVyZSByZWpvaWNlLiIsCiAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgKTsKCiAgICAgICAgICBpZiAoTWF0aC5yYW5kb20oKSA8IDAuMDAxKSB7CiAgICAgICAgICAgIC8vYXBvbG9naWVzIHRvIFdpbGwgV3JpZ2h0CiAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICAiWW91IGhhdmUgYmVlbiBjaG9zZW4uIFRoZXkgd2lsbCBjb21lIHNvb24uIiwKICAgICAgICAgICAgICAiVGhleSdyZSBjb21pbmcgc29vbi4gTWF5YmUgeW91IHNob3VsZCB0aGluayB0d2ljZSBhYm91dCBvcGVuaW5nIHRoZSBkb29yLiIsCiAgICAgICAgICAgICAgIlRoZSBlbmQgaXMgbmVhci4gTWFrZSBwcmVwYXJhdGlvbnMuIiwKICAgICAgICAgICAgICAiTmV3cyA6IGJyb2Njb2xpIHRvcHMgZm9yIG1vbXMsIGxhc3QgZm9yIGtpZHM7IGRhZHMgaW5kaWZmZXJlbnQuIiwKICAgICAgICAgICAgICAiTmV3cyA6IG1pZGRsZSBhZ2UgYSBob2F4LCBkZWNsYXJlcyBzdHVkeTsgdHVybnMgb3V0IHRvIGJlIGJhZCBwb3N0dXJlIGFmdGVyIGFsbC4iLAogICAgICAgICAgICAgICJOZXdzIDoga2l0dGllcyB3YW50IGFuc3dlcnMgaW4gcG9zc2libGUgS2l0dHkgS2liYmxlIHNob3J0YWdlLiIKICAgICAgICAgICAgKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoR2FtZS5jb29raWVzRWFybmVkID49IDEwMDAwKQogICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgIk5ld3MgOiAiICsKICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICJjb29raWVzIGZvdW5kIHRvICIgKwogICAgICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICAgICAiaW5jcmVhc2UgbGlmZXNwYW4iLAogICAgICAgICAgICAgICAgICAgICAgInNlbnNpYmx5IGluY3JlYXNlIGludGVsbGlnZW5jZSIsCiAgICAgICAgICAgICAgICAgICAgICAicmV2ZXJzZSBhZ2luZyIsCiAgICAgICAgICAgICAgICAgICAgICAiZGVjcmVhc2UgaGFpciBsb3NzIiwKICAgICAgICAgICAgICAgICAgICAgICJwcmV2ZW50IGFydGhyaXRpcyIsCiAgICAgICAgICAgICAgICAgICAgICAiY3VyZSBibGluZG5lc3MiLAogICAgICAgICAgICAgICAgICAgIF0pICsKICAgICAgICAgICAgICAgICAgICAiIGluICIgKwogICAgICAgICAgICAgICAgICAgIGNob29zZShhbmltYWxzKSArCiAgICAgICAgICAgICAgICAgICAgIiEiLAogICAgICAgICAgICAgICAgICAiY29va2llcyBmb3VuZCB0byBtYWtlICIgKwogICAgICAgICAgICAgICAgICAgIGNob29zZShhbmltYWxzKSArCiAgICAgICAgICAgICAgICAgICAgIiAiICsKICAgICAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAgICAgIm1vcmUgZG9jaWxlIiwKICAgICAgICAgICAgICAgICAgICAgICJtb3JlIGhhbmRzb21lIiwKICAgICAgICAgICAgICAgICAgICAgICJuaWNlciIsCiAgICAgICAgICAgICAgICAgICAgICAibGVzcyBodW5ncnkiLAogICAgICAgICAgICAgICAgICAgICAgIm1vcmUgcHJhZ21hdGljIiwKICAgICAgICAgICAgICAgICAgICAgICJ0YXN0aWVyIiwKICAgICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICAgIiEiLAogICAgICAgICAgICAgICAgICAiY29va2llcyB0ZXN0ZWQgb24gIiArCiAgICAgICAgICAgICAgICAgICAgY2hvb3NlKGFuaW1hbHMpICsKICAgICAgICAgICAgICAgICAgICAiLCBmb3VuZCB0byBoYXZlIG5vIGlsbCBlZmZlY3RzLiIsCiAgICAgICAgICAgICAgICAgICJjb29raWVzIHVuZXhwZWN0ZWRseSBwb3B1bGFyIGFtb25nICIgKyBjaG9vc2UoYW5pbWFscykgKyAiISIsCiAgICAgICAgICAgICAgICAgICJ1bnNpZ2h0bHkgbHVtcHMgZm91bmQgb24gIiArCiAgICAgICAgICAgICAgICAgICAgY2hvb3NlKGFuaW1hbHMpICsKICAgICAgICAgICAgICAgICAgICAnIG5lYXIgY29va2llIGZhY2lsaXR5OyAidGhleVwndmUgcHJldHR5IG11Y2ggYWx3YXlzIGxvb2tlZCBsaWtlIHRoYXQiLCBzYXkgYmlvbG9naXN0cy4nLAogICAgICAgICAgICAgICAgICAibmV3IHNwZWNpZXMgb2YgIiArCiAgICAgICAgICAgICAgICAgICAgY2hvb3NlKGFuaW1hbHMpICsKICAgICAgICAgICAgICAgICAgICAnIGRpc2NvdmVyZWQgaW4gZGlzdGFudCBjb3VudHJ5OyAieXVwLCB0YXN0ZXMgbGlrZSBjb29raWVzIiwgc2F5cyBiaW9sb2dpc3QuJywKICAgICAgICAgICAgICAgICAgImNvb2tpZXMgZ28gd2VsbCB3aXRoICIgKwogICAgICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAgICAgICAicm9hc3RlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ0b2FzdGVkIiwKICAgICAgICAgICAgICAgICAgICAgICAgImJvaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJzYXV0ZWVkIiwKICAgICAgICAgICAgICAgICAgICAgICAgIm1pbmNlZCIsCiAgICAgICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICAgICAgICIgIiArCiAgICAgICAgICAgICAgICAgICAgICAgIGNob29zZShhbmltYWxzKSwKICAgICAgICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICAgICAgICJzdXNoaSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJzb3VwIiwKICAgICAgICAgICAgICAgICAgICAgICAgImNhcnBhY2NpbyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJzdGVhayIsCiAgICAgICAgICAgICAgICAgICAgICAgICJudWdnZXRzIiwKICAgICAgICAgICAgICAgICAgICAgIF0pICsKICAgICAgICAgICAgICAgICAgICAgICAgIiBtYWRlIGZyb20gIiArCiAgICAgICAgICAgICAgICAgICAgICAgIGNob29zZShhbmltYWxzKSwKICAgICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICAgIiwgc2F5cyBjb250cm92ZXJzaWFsIGNoZWYuIiwKICAgICAgICAgICAgICAgICAgJyJkbyB5b3VyIGNvb2tpZXMgY29udGFpbiAnICsKICAgICAgICAgICAgICAgICAgICBjaG9vc2UoYW5pbWFscykgKwogICAgICAgICAgICAgICAgICAgICc/IiwgYXNrcyBQU0Egd2FybmluZyBhZ2FpbnN0IGNvdW50ZXJmZWl0IGNvb2tpZXMuJywKICAgICAgICAgICAgICAgICAgImRvY3RvcnMgcmVjb21tZW5kIHR3aWNlLWRhaWx5IGNvbnN1bXB0aW9uIG9mIGZyZXNoIGNvb2tpZXMuIiwKICAgICAgICAgICAgICAgICAgImRvY3RvcnMgd2FybiBhZ2FpbnN0IGNob2NvbGF0ZSBjaGlwLXNub3J0aW5nIHRlZW4gZmFkLiIsCiAgICAgICAgICAgICAgICAgICJkb2N0b3JzIGFkdmlzZSBhZ2FpbnN0IG5ldyBjb29raWUtZnJlZSBmYWQgZGlldC4iLAogICAgICAgICAgICAgICAgICAnZG9jdG9ycyB3YXJuIG1vdGhlcnMgYWJvdXQgdGhlIGRhbmdlcnMgb2YgImhvbWUtbWFkZSBjb29raWVzIi4nLAogICAgICAgICAgICAgICAgXSksCiAgICAgICAgICAgICAgJ05ld3MgOiAiJyArCiAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAiSSdtIGFsbCBhYm91dCBjb29raWVzIiwKICAgICAgICAgICAgICAgICAgIkkganVzdCBjYW4ndCBzdG9wIGVhdGluZyBjb29raWVzLiBJIHRoaW5rIEkgc2VyaW91c2x5IG5lZWQgaGVscCIsCiAgICAgICAgICAgICAgICAgICJJIGd1ZXNzIEkgaGF2ZSBhIGNvb2tpZSBwcm9ibGVtIiwKICAgICAgICAgICAgICAgICAgIkknbSBub3QgYWRkaWN0ZWQgdG8gY29va2llcy4gVGhhdCdzIGp1c3Qgc3BlY3VsYXRpb24gYnkgZmFucyB3aXRoIHRvbyBtdWNoIGZyZWUgdGltZSIsCiAgICAgICAgICAgICAgICAgICJteSB1cGNvbWluZyBhbGJ1bSBjb250YWlucyAzIHNvbmdzIGFib3V0IGNvb2tpZXMiLAogICAgICAgICAgICAgICAgICAiSSd2ZSBoYWQgZHJlYW1zIGFib3V0IGNvb2tpZXMgMyBuaWdodHMgaW4gYSByb3cgbm93LiBJJ20gYSBiaXQgd29ycmllZCBob25lc3RseSIsCiAgICAgICAgICAgICAgICAgICJhY2N1c2F0aW9ucyBvZiBjb29raWUgYWJ1c2UgYXJlIG9ubHkgdmlsZSBzbGFuZGVyIiwKICAgICAgICAgICAgICAgICAgImNvb2tpZXMgcmVhbGx5IGhlbHBlZCBtZSB3aGVuIEkgd2FzIGZlZWxpbmcgbG93IiwKICAgICAgICAgICAgICAgICAgImNvb2tpZXMgYXJlIHRoZSBzZWNyZXQgYmVoaW5kIG15IHBlcmZlY3Qgc2tpbiIsCiAgICAgICAgICAgICAgICAgICJjb29raWVzIGhlbHBlZCBtZSBzdGF5IHNhbmUgd2hpbGUgZmlsbWluZyBteSB1cGNvbWluZyBtb3ZpZSIsCiAgICAgICAgICAgICAgICAgICJjb29raWVzIGhlbHBlZCBtZSBzdGF5IHRoaW4gYW5kIGhlYWx0aHkiLAogICAgICAgICAgICAgICAgICAiSSdsbCBzYXkgb25lIHdvcmQsIGp1c3Qgb25lIDogY29va2llcyIsCiAgICAgICAgICAgICAgICAgICJhbHJpZ2h0LCBJJ2xsIHNheSBpdCAtIEkndmUgbmV2ZXIgZWF0ZW4gYSBzaW5nbGUgY29va2llIGluIG15IGxpZmUiLAogICAgICAgICAgICAgICAgXSkgKwogICAgICAgICAgICAgICAgJyIsIHJldmVhbHMgY2VsZWJyaXR5LicsCiAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICdOZXdzIDogc2NpZW50aXN0IHByZWRpY3RzIGltbWluZW50IGNvb2tpZS1yZWxhdGVkICJlbmQgb2YgdGhlIHdvcmxkIjsgYmVjb21lcyBqb2tlIGFtb25nIHBlZXJzLicsCiAgICAgICAgICAgICAgICAiTmV3cyA6IG1hbiByb2JzIGJhbmssIGJ1eXMgY29va2llcy4iLAogICAgICAgICAgICAgICAgIk5ld3MgOiBzY2llbnRpc3RzIGVzdGFibGlzaCB0aGF0IHRoZSBkZWFsIHdpdGggYWlybGluZSBmb29kIGlzLCBpbiBmYWN0LCBhIGNyaXRpY2FsIGxhY2sgb2YgY29va2llcy4iLAogICAgICAgICAgICAgICAgIk5ld3MgOiBodW5kcmVkcyBvZiB0b25zIG9mIGNvb2tpZXMgZHVtcGVkIGludG8gc3RhcnZpbmcgY291bnRyeSBmcm9tIGFpcnBsYW5lczsgdGhvdXNhbmRzIGRlYWQsIG5hdGlvbiBncmF0ZWZ1bC4iLAogICAgICAgICAgICAgICAgJ05ld3MgOiBuZXcgc3R1ZHkgc3VnZ2VzdHMgY29va2llcyBuZWl0aGVyIHNwZWVkIHVwIG5vciBzbG93IGRvd24gYWdpbmcsIGJ1dCBpbnN0ZWFkICJ0YWtlIHlvdSBpbiBhIGRpZmZlcmVudCBkaXJlY3Rpb24iLicsCiAgICAgICAgICAgICAgICAiTmV3cyA6IG92ZXJncm93biBjb29raWVzIGZvdW5kIGluIGZpc2hpbmcgbmV0cywgcmFpc2UgcXVlc3Rpb25zIGFib3V0IGhvcm1vbmUgYmFraW5nLiIsCiAgICAgICAgICAgICAgICAnTmV3cyA6ICJhbGwteW91LWNhbi1lYXQiIGNvb2tpZSByZXN0YXVyYW50IG9wZW5zIGluIGJpZyBjaXR5OyB3YWl0ZXJzIHRyYW1wbGVkIGluIG1pbnV0ZXMuJywKICAgICAgICAgICAgICAgICdOZXdzIDogbWFuIGRpZXMgaW4gY29va2llLWVhdGluZyBjb250ZXN0OyAiYSBsZXNzLXRoYW4taW1wcmVzc2l2ZSBwZXJmb3JtYW5jZSIsIHNheXMganVkZ2UuJywKICAgICAgICAgICAgICAgICdOZXdzIDogd2hhdCBtYWtlcyBjb29raWVzIHRhc3RlIHNvIHJpZ2h0PyAiUHJvYmFibHkgYWxsIHRoZSBbKioqKipdIHRoZXkgcHV0IGluIHRoZW0iLCBzYXlzIGFub255bW91cyB0aXBwZXIuJywKICAgICAgICAgICAgICAgICdOZXdzIDogbWFuIGZvdW5kIGFsbGVyZ2ljIHRvIGNvb2tpZXM7ICJ3aGF0IGEgd2VpcmRvIiwgc2F5cyBmYW1pbHkuJywKICAgICAgICAgICAgICAgICJOZXdzIDogZm9yZWlnbiBwb2xpdGljaWFuIGludm9sdmVkIGluIGNvb2tpZS1zbXVnZ2xpbmcgc2NhbmRhbC4iLAogICAgICAgICAgICAgICAgIk5ld3MgOiBjb29raWVzIG5vdyBtb3JlIHBvcHVsYXIgdGhhbiAiICsKICAgICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgICAiY291Z2ggZHJvcHMiLAogICAgICAgICAgICAgICAgICAgICJicm9jY29saSIsCiAgICAgICAgICAgICAgICAgICAgInNtb2tlZCBoZXJyaW5nIiwKICAgICAgICAgICAgICAgICAgICAiY2hlZXNlIiwKICAgICAgICAgICAgICAgICAgICAidmlkZW8gZ2FtZXMiLAogICAgICAgICAgICAgICAgICAgICJzdGFibGUgam9icyIsCiAgICAgICAgICAgICAgICAgICAgInJlbGF0aW9uc2hpcHMiLAogICAgICAgICAgICAgICAgICAgICJ0aW1lIHRyYXZlbCIsCiAgICAgICAgICAgICAgICAgICAgImNhdCB2aWRlb3MiLAogICAgICAgICAgICAgICAgICAgICJ0YW5nbyIsCiAgICAgICAgICAgICAgICAgICAgImZhc2hpb24iLAogICAgICAgICAgICAgICAgICAgICJ0ZWxldmlzaW9uIiwKICAgICAgICAgICAgICAgICAgICAibnVjbGVhciB3YXJmYXJlIiwKICAgICAgICAgICAgICAgICAgICAid2hhdGV2ZXIgaXQgaXMgd2UgYXRlIGJlZm9yZSIsCiAgICAgICAgICAgICAgICAgICAgInBvbGl0aWNzIiwKICAgICAgICAgICAgICAgICAgICAib3h5Z2VuIiwKICAgICAgICAgICAgICAgICAgICAibGFtcHMiLAogICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICIsIHNheXMgc3R1ZHkuIiwKICAgICAgICAgICAgICAgICJOZXdzIDogb2Jlc2l0eSBlcGlkZW1pYyBzdHJpa2VzIG5hdGlvbjsgZXhwZXJ0cyBibGFtZSAiICsKICAgICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgICAidHdlcmtpbmciLAogICAgICAgICAgICAgICAgICAgICJ0aGF0IGRhcm4gcmFwIG11c2ljIiwKICAgICAgICAgICAgICAgICAgICAidmlkZW8tZ2FtZXMiLAogICAgICAgICAgICAgICAgICAgICJsYWNrIG9mIGNvb2tpZXMiLAogICAgICAgICAgICAgICAgICAgICJteXN0ZXJpb3VzIGdob3N0bHkgZW50aXRpZXMiLAogICAgICAgICAgICAgICAgICAgICJhbGllbnMiLAogICAgICAgICAgICAgICAgICAgICJwYXJlbnRzIiwKICAgICAgICAgICAgICAgICAgICAic2Nob29scyIsCiAgICAgICAgICAgICAgICAgICAgImNvbWljLWJvb2tzIiwKICAgICAgICAgICAgICAgICAgICAiY29va2llLXNub3J0aW5nIGZhZCIsCiAgICAgICAgICAgICAgICAgIF0pICsKICAgICAgICAgICAgICAgICAgIi4iLAogICAgICAgICAgICAgICAgJ05ld3MgOiBjb29raWUgc2hvcnRhZ2Ugc3RyaWtlcyB0b3duLCBwZW9wbGUgZm9yY2VkIHRvIGVhdCBjdXBjYWtlczsgImp1c3Qgbm90IHRoZSBzYW1lIiwgY29uY2VkZXMgbWF5b3IuJywKICAgICAgICAgICAgICAgICdOZXdzIDogInlvdSBnb3R0YSBhZG1pdCwgYWxsIHRoaXMgY29va2llIHN0dWZmIGlzIGEgYml0IG9taW5vdXMiLCBzYXlzIGNvbmZ1c2VkIGlkaW90LicsCiAgICAgICAgICAgICAgICAvLydOZXdzIDogc2NpZW50aXN0cyBhZHZpc2UgZ2V0dGluZyB1c2VkIHRvIGNvb2tpZXMgc3VmZnVzaW5nIGV2ZXJ5IGFzcGVjdCBvZiBsaWZlOyAidGhpcyBpcyB0aGUgbmV3IG5vcm1hbCIsIGV4cGVydCBzYXlzLicsCiAgICAgICAgICAgICAgICAvLydOZXdzIDogZG9jdG9ycyBhZHZpc2UgYWdhaW5zdCB3ZWFyaW5nIGZhY2UgbWFza3Mgd2hlbiBnb2luZyBvdXRzaWRlLiAiWW91IG5ldmVyIGtub3cgd2hlbiB5b3UgbWlnaHQgbmVlZCBhIGNvb2tpZS4uLiBhIG1hc2sgd291bGQganVzdCBnZXQgaW4gdGhlIHdheS4iJywvL3RoZXNlIHdlcmUgd3JpdHRlbiBiYWNrIHdoZW4gY292aWQgaGFkbid0IHJlYWxseSBkb25lIG11Y2ggZGFtYWdlIHlldCBidXQgdGhleSBqdXN0IGZlZWwgaW4gcG9vciB0YXN0ZSBub3cKICAgICAgICAgICAgICAgICJOZXdzIDogaXMgdGhlcmUgbGlmZSBvbiBNYXJzPyBWYXJpb3VzIGNob2NvbGF0ZSBiYXIgbWFudWZhY3R1cmVycyBjdXJyZW50bHkgdW5kZXIgaW52ZXN0aWdhdGlvbiBmb3IgYmFjdGVyaWFsIGNvbnRhbWluYW50cy4iLAogICAgICAgICAgICAgICAgJ05ld3MgOiAic28gSSBndWVzcyB0aGF0XCdzIGEgdGhpbmcgbm93Iiwgc2NpZW50aXN0IGNvbW1lbnRzIG9uIGNvb2tpZSBwYXJ0aWNsZXMgbm93IHByZXNlbnQgaW4gdmlydHVhbGx5IGFsbCBzdGVlbCBtYW51ZmFjdHVyZWQgc2luY2UgY29va2llIHByb2R1Y3Rpb24gcmFtcGVkIHVwIHdvcmxkd2lkZS4nLAogICAgICAgICAgICAgICAgIk5ld3MgOiB0cmFjZSBhbW91bnRzIG9mIGNvb2tpZSBwYXJ0aWNsZXMgZGV0ZWN0ZWQgaW4gbW9zdCBsaXZpbmcgY3JlYXR1cmVzLCBzb21lIG9mIHdoaWNoIGFkYXB0aW5nIHRoZW0gYXMgcGFydCBvZiBuZXcgYW5kIGV4b3RpYyBtZXRhYm9saWMgcHJvY2Vzc2VzLiIsCiAgICAgICAgICAgICAgXSksCiAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICdOZXdzIDogbW92aWUgY2FuY2VsbGVkIGZyb20gbGFjayBvZiBhY3RvcnM7ICJldmVyeWJvZHlcJ3MgYXQgaG9tZSBlYXRpbmcgY29va2llcyIsIGxhbWVudHMgZGlyZWN0b3IuJywKICAgICAgICAgICAgICAgICJOZXdzIDogY29tZWRpYW4gZm9yY2VkIHRvIGNhbmNlbCBjb29raWUgcm91dGluZSBkdWUgdG8gdW5yZWxhdGVkIGluZGlnZXN0aW9uLiIsCiAgICAgICAgICAgICAgICAiTmV3cyA6IG5ldyBjb29raWUtYmFzZWQgcmVsaWdpb24gc3dlZXBzIHRoZSBuYXRpb24uIiwKICAgICAgICAgICAgICAgICJOZXdzIDogZm9zc2lsIHJlY29yZHMgc2hvdyBjb29raWUtYmFzZWQgb3JnYW5pc21zIHByZXZhbGVudCBkdXJpbmcgQ2FtYnJpYW4gZXhwbG9zaW9uLCBzY2llbnRpc3RzIHNheS4iLAogICAgICAgICAgICAgICAgJ05ld3MgOiBteXN0ZXJpb3VzIGlsbGVnYWwgY29va2llcyBzZWl6ZWQ7ICJ0YXN0ZXMgdGVycmlibGUiLCBzYXlzIHBvbGljZS4nLAogICAgICAgICAgICAgICAgJ05ld3MgOiBtYW4gZm91bmQgZGVhZCBhZnRlciBpbmdlc3RpbmcgY29va2llOyBpbnZlc3RpZ2F0b3JzIGZhdm9yICJtYWZpYSBzbml0Y2giIGh5cG90aGVzaXMuJywKICAgICAgICAgICAgICAgICdOZXdzIDogInRoZSB1bml2ZXJzZSBwcmV0dHkgbXVjaCBsb29wcyBvbiBpdHNlbGYsIiBzdWdnZXN0cyByZXNlYXJjaGVyOyAiaXRcJ3MgY29va2llcyBhbGwgdGhlIHdheSBkb3duLiInLAogICAgICAgICAgICAgICAgIk5ld3MgOiBtaW5vciBjb29raWUtcmVsYXRlZCBpbmNpZGVudCB0dXJucyB3aG9sZSB0b3duIHRvIGFzaGVzOyBuZWlnaGJvcmluZyBjaXRpZXMgYXNrZWQgdG8gY2hpcCBpbiBmb3IgcmVjb25zdHJ1Y3Rpb24uIiwKICAgICAgICAgICAgICAgICJOZXdzIDogaXMgb3VyIG1lZGlhIGNvbnRyb2xsZWQgYnkgdGhlIGNvb2tpZSBpbmR1c3RyeT8gVGhpcyBjb3VsZCB2ZXJ5IHdlbGwgYmUgdGhlIGNhc2UsIHNheXMgY3JhY2twb3QgY29uc3BpcmFjeSB0aGVvcmlzdC4iLAogICAgICAgICAgICAgICAgIk5ld3MgOiAiICsKICAgICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgICAnY29va2llLWZsYXZvcmVkIHBvcGNvcm4gcHJldHR5IGRhbW4gcG9wdWxhcjsgIndlIGtpbmRhIGV4cGVjdGVkIHRoYXQiLCBzYXkgc2NpZW50aXN0cy4nLAogICAgICAgICAgICAgICAgICAgICJjb29raWUtZmxhdm9yZWQgY2VyZWFscyBicmVhayBhbGwga25vd24gY2VyZWFsLXJlbGF0ZWQgcmVjb3JkcyIsCiAgICAgICAgICAgICAgICAgICAgImNvb2tpZXMgcG9wdWxhciBhbW9uZyBhbGwgYWdlIGdyb3VwcywgaW5jbHVkaW5nIGZldHVzZXMsIHNheXMgc3R1ZHkuIiwKICAgICAgICAgICAgICAgICAgICAiY29va2llLWZsYXZvcmVkIHBvcGNvcm4gc2FsZXMgZXhwbG9kZWQgZHVyaW5nIHNjcmVlbmluZyBvZiBHcmFuZG1vdGhlcnMgSUkgOiBUaGUgTW9pc3RlbmluZy4iLAogICAgICAgICAgICAgICAgICBdKSwKICAgICAgICAgICAgICAgICJOZXdzIDogYWxsLWNvb2tpZSByZXN0YXVyYW50IG9wZW5pbmcgZG93bnRvd24uIERpc2hlcyBzdWNoIGFzIGJyYWlzZWQgY29va2llcywgY29va2llIHRoZXJtaWRvciwgYW5kIGZvciBkZXNzZXJ0IDogY3JlcGVzLiIsCiAgICAgICAgICAgICAgICAnTmV3cyA6ICJPb2siLCBzYXlzIGludGVydmlld2VkIG9yYW5ndXRhbi4nLAogICAgICAgICAgICAgICAgIk5ld3MgOiBjb29raWVzIGNvdWxkIGJlIHRoZSBrZXkgdG8gIiArCiAgICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICAgImV0ZXJuYWwgbGlmZSIsCiAgICAgICAgICAgICAgICAgICAgImluZmluaXRlIHJpY2hlcyIsCiAgICAgICAgICAgICAgICAgICAgImV0ZXJuYWwgeW91dGgiLAogICAgICAgICAgICAgICAgICAgICJldGVybmFsIGJlYXV0eSIsCiAgICAgICAgICAgICAgICAgICAgImN1cmluZyBiYWxkbmVzcyIsCiAgICAgICAgICAgICAgICAgICAgIndvcmxkIHBlYWNlIiwKICAgICAgICAgICAgICAgICAgICAic29sdmluZyB3b3JsZCBodW5nZXIiLAogICAgICAgICAgICAgICAgICAgICJlbmRpbmcgYWxsIHdhcnMgd29ybGQtd2lkZSIsCiAgICAgICAgICAgICAgICAgICAgIm1ha2luZyBjb250YWN0IHdpdGggZXh0cmF0ZXJyZXN0cmlhbCBsaWZlIiwKICAgICAgICAgICAgICAgICAgICAibWluZC1yZWFkaW5nIiwKICAgICAgICAgICAgICAgICAgICAiYmV0dGVyIGxpdmluZyIsCiAgICAgICAgICAgICAgICAgICAgImJldHRlciBlYXRpbmciLAogICAgICAgICAgICAgICAgICAgICJtb3JlIGludGVyZXN0aW5nIFRWIHNob3dzIiwKICAgICAgICAgICAgICAgICAgICAiZmFzdGVyLXRoYW4tbGlnaHQgdHJhdmVsIiwKICAgICAgICAgICAgICAgICAgICAicXVhbnR1bSBiYWtpbmciLAogICAgICAgICAgICAgICAgICAgICJjaG9jb2xhdHkgZ29vZG5lc3MiLAogICAgICAgICAgICAgICAgICAgICJnb29kZXIgdGhvdWdodG5lc3MiLAogICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICIsIHNheSBzY2llbnRpc3RzLiIsCiAgICAgICAgICAgICAgICAiTmV3cyA6IGZsYXZvciB0ZXh0ICIgKwogICAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAgICJub3QgcGFydGljdWxhcmx5IGZsYXZvcmZ1bCIsCiAgICAgICAgICAgICAgICAgICAgImtpbmQgb2YgdW5zYXZvcnkiLAogICAgICAgICAgICAgICAgICAgICcicmF0aGVyIGJsYW5kIicsCiAgICAgICAgICAgICAgICAgICAgInByZXR0eSBzcGljeSBsYXRlbHkiLAogICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICIsIHN0dWR5IGZpbmRzLiIsCiAgICAgICAgICAgICAgXSksCiAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICdOZXdzIDogd2hhdCBkbyBnb2xkZW4gY29va2llcyB0YXN0ZSBsaWtlPyBTdHVkeSByZXZlYWxzIGEgZmxhdm9yICJzb21ld2hlcmUgYmV0d2VlbiBzcGVhcm1pbnQgYW5kIGxpcXVvcmljZSIuJywKICAgICAgICAgICAgICAgICdOZXdzIDogd2hhdCBkbyB3cmF0aCBjb29raWVzIHRhc3RlIGxpa2U/IFN0dWR5IHJldmVhbHMgYSBmbGF2b3IgInNvbWV3aGVyZSBiZXR3ZWVuIGJsb29kIHNhdXNhZ2UgYW5kIHNlYXdhdGVyIi4nLAogICAgICAgICAgICAgICAgIk5ld3MgOiAiICsKICAgICAgICAgICAgICAgICAgR2FtZS5iYWtlcnlOYW1lICsKICAgICAgICAgICAgICAgICAgJy1icmFuZCBjb29raWVzICInICsKICAgICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgICAibXVjaCBsZXNzIHNvZ2d5IiwKICAgICAgICAgICAgICAgICAgICAibXVjaCB0YXN0aWVyIiwKICAgICAgICAgICAgICAgICAgICAicmVsYXRpdmVseSBsZXNzIGNyYXBweSIsCiAgICAgICAgICAgICAgICAgICAgIm1hcmdpbmFsbHkgbGVzcyBhd2Z1bCIsCiAgICAgICAgICAgICAgICAgICAgImxlc3MgdG94aWMiLAogICAgICAgICAgICAgICAgICAgICJwb3NzaWJseSBtb3JlIGVkaWJsZSIsCiAgICAgICAgICAgICAgICAgICAgIm1vcmUgZmFzaGlvbmFibGUiLAogICAgICAgICAgICAgICAgICAgICJzbGlnaHRseSBuaWNlciIsCiAgICAgICAgICAgICAgICAgICAgInRyZW5kaWVyIiwKICAgICAgICAgICAgICAgICAgICAiYXJndWFibHkgaGVhbHRoaWVyIiwKICAgICAgICAgICAgICAgICAgICAib2JqZWN0aXZlbHkgYmV0dGVyIGNob2ljZSIsCiAgICAgICAgICAgICAgICAgICAgInNsaWdodGx5IGxlc3MgdGVycmlibGUiLAogICAgICAgICAgICAgICAgICAgICJkZWNpZGVkbHkgY29va2llciIsCiAgICAgICAgICAgICAgICAgICAgImEgdGFkIGNoZWFwZXIiLAogICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICcgdGhhbiBjb21wZXRpdG9ycyIsIHNheXMgY29uc3VtZXIgc3VydmV5LicsCiAgICAgICAgICAgICAgICAnTmV3cyA6ICInICsKICAgICAgICAgICAgICAgICAgR2FtZS5iYWtlcnlOYW1lICsKICAgICAgICAgICAgICAgICAgIlwiIHNldCB0byBiZSB0aGlzIHllYXIncyBtb3N0IHBvcHVsYXIgYmFieSBuYW1lLiIsCiAgICAgICAgICAgICAgICAiTmV3cyA6IG5ldyBwb3B1bGFyaXR5IHN1cnZleSBzYXlzICIgKwogICAgICAgICAgICAgICAgICBHYW1lLmJha2VyeU5hbWUgKwogICAgICAgICAgICAgICAgICAiJ3MgdGhlIHdvcmQgd2hlbiBpdCBjb21lcyB0byBjb29raWVzLiIsCiAgICAgICAgICAgICAgICAiTmV3cyA6IG1ham9yIGNpdHkgYmVpbmcgcmVuYW1lZCAiICsKICAgICAgICAgICAgICAgICAgR2FtZS5iYWtlcnlOYW1lICsKICAgICAgICAgICAgICAgICAgInZpbGxlIGFmdGVyIHdvcmxkLWZhbW91cyBjb29raWUgbWFudWZhY3R1cmVyLiIsCiAgICAgICAgICAgICAgICAiTmV3cyA6ICIgKwogICAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAgICJzdHJlZXQiLAogICAgICAgICAgICAgICAgICAgICJzY2hvb2wiLAogICAgICAgICAgICAgICAgICAgICJudXJzaW5nIGhvbWUiLAogICAgICAgICAgICAgICAgICAgICJzdGFkaXVtIiwKICAgICAgICAgICAgICAgICAgICAibmV3IGZhc3QgZm9vZCBjaGFpbiIsCiAgICAgICAgICAgICAgICAgICAgIm5ldyBwbGFuZXQiLAogICAgICAgICAgICAgICAgICAgICJuZXcgZGlzZWFzZSIsCiAgICAgICAgICAgICAgICAgICAgImZsZXNoLWVhdGluZyBiYWN0ZXJpYSIsCiAgICAgICAgICAgICAgICAgICAgImRlYWRseSB2aXJ1cyIsCiAgICAgICAgICAgICAgICAgICAgIm5ldyBzcGVjaWVzIG9mICIgKyBjaG9vc2UoYW5pbWFscyksCiAgICAgICAgICAgICAgICAgICAgIm5ldyBsYXciLAogICAgICAgICAgICAgICAgICAgICJiYWJ5IiwKICAgICAgICAgICAgICAgICAgICAicHJvZ3JhbW1pbmcgbGFuZ3VhZ2UiLAogICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICIgdG8gYmUgbmFtZWQgYWZ0ZXIgIiArCiAgICAgICAgICAgICAgICAgIEdhbWUuYmFrZXJ5TmFtZSArCiAgICAgICAgICAgICAgICAgICIsIHRoZSB3b3JsZC1mYW1vdXMgY29va2llIG1hbnVmYWN0dXJlci4iLAogICAgICAgICAgICAgICAgIk5ld3MgOiBkb24ndCBtaXNzIHRvbmlnaHQncyBiaW9waWMgb24gIiArCiAgICAgICAgICAgICAgICAgIEdhbWUuYmFrZXJ5TmFtZSArCiAgICAgICAgICAgICAgICAgICIncyBpcnJlc2lzdGlibGUgcmlzZSB0byBzdWNjZXNzISIsCiAgICAgICAgICAgICAgICAiTmV3cyA6IGRvbid0IG1pc3MgdG9uaWdodCdzIGludGVydmlldyBvZiAiICsKICAgICAgICAgICAgICAgICAgR2FtZS5iYWtlcnlOYW1lICsKICAgICAgICAgICAgICAgICAgIiBieSAiICsKICAgICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgICAiQmxvcHJhaCIsCiAgICAgICAgICAgICAgICAgICAgIkJsYXZpZCBCbGV0dGVybWFuIiwKICAgICAgICAgICAgICAgICAgICAiQmxpbW15IEJsaW1tZWwiLAogICAgICAgICAgICAgICAgICAgICJCbGVsbGVuIEJsZWdlbmVyZXMiLAogICAgICAgICAgICAgICAgICAgICJCbGltbXkgQmxhbGxvbiIsCiAgICAgICAgICAgICAgICAgICAgIkJsb25hbiBCbG8nQnJpZW4iLAogICAgICAgICAgICAgICAgICAgICJCbGF5IEJsZW5vIiwKICAgICAgICAgICAgICAgICAgICAiQmxvbiBCbGV3YXJ0IiwKICAgICAgICAgICAgICAgICAgICAiQmxldmVuIEJsb2xiZXJ0IiwKICAgICAgICAgICAgICAgICAgICAiTG9yZCBUb3hpa2hyb24gb2YgZGltZW5zaW9uIDctQjE5IiwKICAgICAgICAgICAgICAgICAgICBHYW1lLmJha2VyeU5hbWUgKyAiJ3Mgb3duIGV2aWwgY2xvbmUiLAogICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICIhIiwKICAgICAgICAgICAgICAgICdOZXdzIDogcGVvcGxlIGFsbCBvdmVyIHRoZSBpbnRlcm5ldCBzdGlsbCBzY3JhdGNoaW5nIHRoZWlyIGhlYWRzIG92ZXIgbm9uc2Vuc2ljYWwgcmVmZXJlbmNlIDogIk9rYXksIGJ1dCB3aHkgYW4gZWdnPyInLAogICAgICAgICAgICAgICAgJ05ld3MgOiB2aXJhbCB2aWRlbyAiVG9vIE1hbnkgQ29va2llcyIgY291bGQgYmUgImEgZ3JpbSBjb21tZW50YXJ5IG9uIHRoZSBpbXBlbmRpbmcgY3Jpc2lzIG91ciB3b3JsZCBpcyBhYm91dCB0byBmYWNlIiwgc2F5cyBmYW1vdXMgZWNvbm9taXN0LicsCiAgICAgICAgICAgICAgICAnTmV3cyA6ICJtZW1lcyBmcm9tIGxhc3QgeWVhciBzb21laG93IHN0aWxsIHJlbGV2YW50IiwgZGVwbG9yZSBleHBlcnRzLicsCiAgICAgICAgICAgICAgICAnTmV3cyA6IGNvb2tpZSBlbW9qaSBtb3N0IHBvcHVsYXIgYW1vbmcgdGVlbmFnZXJzLCBmYXIgYWhlYWQgb2YgImp1ZGdtZW50YWwgT0sgaGFuZCBzaWduIiBhbmQgInNoaWZ0eS1sb29raW5nIGRhcmsgbW9vbiIsIHNheXMgc3R1ZHkuJywKICAgICAgICAgICAgICBdKSwKICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgIk5ld3MgOiBiaXJ0aHMgb2Ygc3VzcGljaW91c2x5IGJhbGQgYmFiaWVzIG9uIHRoZSByaXNlOyBhbmNpZW50IGFsaWVuIGNhYmFsIGRlbmllcyBpbnZvbHZlbWVudC4iLAogICAgICAgICAgICAgICAgJ05ld3MgOiAiYXQgdGhpcyBwb2ludCwgY29va2llcyBwZXJtZWF0ZSB0aGUgZWNvbm9teSIsIHNheXMgZWNvbm9taXN0LiAiSWYgd2Ugc3RhcnQgZWF0aW5nIGFueXRoaW5nIGVsc2UsIHdlXCdyZSBhbGwgZGVhZC4iJywKICAgICAgICAgICAgICAgICJOZXdzIDogcHVuIGluIGhlYWRsaW5lIGluZnVyaWF0ZXMgdG93biwgY2F1c2VzIHJpb3QuIDIxIHdvdW5kZWQsIDUgZGVhZDsgbWF5b3Igc3RpbGwgbWlzc2luZy4iLAogICAgICAgICAgICAgICAgIk53cyA6IGt5IGJ0d24gVyBhbmQgUiBicm9rbiwgcGxhcyBzbmQgbncgdHlwd3JpdHIgQVNBUC4iLAogICAgICAgICAgICAgICAgJ05lZWVlZXdzIDogIm5lZWVldyBFRUVFRUUga2VlZWVleSB3b3JraW5nIGZpbmVlZWVlZWVlZSIsIHJlZWVwb3J0cyBnbGVlZWVlZWVlZnVsIGpvdXJuYWxpc3QuJywKICAgICAgICAgICAgICAgICJOZXdzIDogY29va2llcyBub3cgaWxsZWdhbCBpbiBzb21lIGJhY2t3YXJkcyBjb3VudHJ5IG5vYm9keSBjYXJlcyBhYm91dC4gUG9saXRpY2FsIHRlbnNpb25zIHJpc2luZzsgd2FyIHNvb24sIGhvcGVmdWxseS4iLAogICAgICAgICAgICAgICAgIk5ld3MgOiBpcmF0ZSByYWRpbyBob3N0IHJhbWJsZXMgYWJvdXQgcGl4ZWxhdGVkIGljb25zLiBcIk5vbmUgb2YgdGhlIGNvb2tpZXMgYXJlIGFsaWduZWQhIENhbid0IGFueW9uZSBlbHNlIHNlZSBpdD8gSSBmZWVsIGxpa2UgSSdtIHRha2luZyBjcmF6eSBwaWxscyFcIiIsCiAgICAgICAgICAgICAgICAiTmV3cyA6IG5hdGlvbiBjaGVlcnMgYXMgbGVnaXNsYXRvcnMgZmluYWxseSBvdXRsYXcgIiArCiAgICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICAgImNvb2tpZSBjcml0aWNpc20iLAogICAgICAgICAgICAgICAgICAgICJwbGF5aW5nIG90aGVyIGdhbWVzIHRoYW4gQ29va2llIENsaWNrZXIiLAogICAgICAgICAgICAgICAgICAgICJwaW5lYXBwbGUgb24gcGl6emEiLAogICAgICAgICAgICAgICAgICAgICJsYWNrIG9mIGNoZWVyZnVsbmVzcyIsCiAgICAgICAgICAgICAgICAgICAgIm1vc3F1aXRvZXMiLAogICAgICAgICAgICAgICAgICAgICJicm9jY29saSIsCiAgICAgICAgICAgICAgICAgICAgInRoZSBodW1hbiBzcGxlZW4iLAogICAgICAgICAgICAgICAgICAgICJiYWQgd2VhdGhlciIsCiAgICAgICAgICAgICAgICAgICAgImNsaWNrYmFpdCIsCiAgICAgICAgICAgICAgICAgICAgImRhYmJpbmciLAogICAgICAgICAgICAgICAgICAgICJ0aGUgaW50ZXJuZXQiLAogICAgICAgICAgICAgICAgICAgICJtZW1lcyIsCiAgICAgICAgICAgICAgICAgICAgIm1pbGxlbm5pYWxzIiwKICAgICAgICAgICAgICAgICAgXSkgKwogICAgICAgICAgICAgICAgICAiISIsCiAgICAgICAgICAgICAgICAiTmV3cyA6ICIgKwogICAgICAgICAgICAgICAgICBjaG9vc2UoWyJsb2NhbCIsICJhcmVhIl0pICsKICAgICAgICAgICAgICAgICAgIiAiICsKICAgICAgICAgICAgICAgICAgY2hvb3NlKFsibWFuIiwgIndvbWFuIl0pICsKICAgICAgICAgICAgICAgICAgJyBnb2VzIG9uIGpvdXJuZXkgb2YgaW50cm9zcGVjdGlvbiwgZmluZHMgY29va2llcyA6ICJJIGhvbmVzdGx5IGRvblwndCBrbm93IHdoYXQgSSB3YXMgZXhwZWN0aW5nLiInLAogICAgICAgICAgICAgICAgIk5ld3MgOiAiICsKICAgICAgICAgICAgICAgICAgY2hvb3NlKFsibWFuIiwgIndvbWFuIl0pICsKICAgICAgICAgICAgICAgICAgIiB3YWtlcyB1cCBmcm9tIGNvbWEsICIgKwogICAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAgICJ0cmllcyBjb29raWUgZm9yIHRoZSBmaXJzdCB0aW1lLCBkaWVzLiIsCiAgICAgICAgICAgICAgICAgICAgInJlZ3JldHMgaXQgaW5zdGFudGx5LiIsCiAgICAgICAgICAgICAgICAgICAgJ3dvbmRlcnMgIndoeSBldmVyeXRoaW5nIGlzIGNvb2tpZXMgbm93Ii4nLAogICAgICAgICAgICAgICAgICAgICdiYWJibGVzIGluY29oZXJlbnRseSBhYm91dCBzb21lIHN1cHBvc2VkICJub24tY29va2llIGZvb2QiIHdlIHVzZWQgdG8gZWF0LicsCiAgICAgICAgICAgICAgICAgICAgImNpdGVzIGNvb2tpZXMgYXMgbWFpbiBtb3RpdmF0b3IuIiwKICAgICAgICAgICAgICAgICAgICAiYXNrcyBmb3IgY29va2llcy4iLAogICAgICAgICAgICAgICAgICBdKSwKICAgICAgICAgICAgICAgICJOZXdzIDogcGV0ICIgKwogICAgICAgICAgICAgICAgICBjaG9vc2UoYW5pbWFscykgKwogICAgICAgICAgICAgICAgICAiLCBkYW5nZXJvdXMgZmFkIG9yIGp1aWN5IG5ldyBtYXJrZXQ/IiwKICAgICAgICAgICAgICAgICJOZXdzIDogcGVyc29uIHR5cGluZyB0aGVzZSB3b3VsZG4ndCBtaW5kIHNvbWVvbmUgZWxzZSBicmVha2luZyB0aGUgbmV3cyB0byBUSEVNLCBmb3IgYSBjaGFuZ2UuIiwKICAgICAgICAgICAgICAgICdOZXdzIDogImF2ZXJhZ2UgcGVyc29uIGJha2VzICcgKwogICAgICAgICAgICAgICAgICBCZWF1dGlmeShNYXRoLmNlaWwoR2FtZS5jb29raWVzRWFybmVkIC8gNzMwMDAwMDAwMCkpICsKICAgICAgICAgICAgICAgICAgIiBjb29raWUiICsKICAgICAgICAgICAgICAgICAgKE1hdGguY2VpbChHYW1lLmNvb2tpZXNFYXJuZWQgLyA3MzAwMDAwMDAwKSA9PSAxID8gIiIgOiAicyIpICsKICAgICAgICAgICAgICAgICAgJyBhIHllYXIiIGZhY3RvaWQgYWN0dWFsbHkganVzdCBzdGF0aXN0aWNhbCBlcnJvcjsgJyArCiAgICAgICAgICAgICAgICAgIEdhbWUuYmFrZXJ5TmFtZSArCiAgICAgICAgICAgICAgICAgICIsIHdobyBoYXMgcHJvZHVjZWQgIiArCiAgICAgICAgICAgICAgICAgIEJlYXV0aWZ5KEdhbWUuY29va2llc0Vhcm5lZCkgKwogICAgICAgICAgICAgICAgICAiIGNvb2tpZXMgaW4gdGhlaXIgbGlmZXRpbWUsIGlzIGFuIG91dGxpZXIgYW5kIHNob3VsZCBub3QgaGF2ZSBiZWVuIGNvdW50ZWQuIiwKICAgICAgICAgICAgICBdKQogICAgICAgICAgICApOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGxpc3QubGVuZ3RoID09IDApIHsKICAgICAgICBpZiAobG9yZVByb2dyZXNzIDw9IDApCiAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgIGxvYygKICAgICAgICAgICAgICAiWW91IGZlZWwgbGlrZSBtYWtpbmcgY29va2llcy4gQnV0IG5vYm9keSB3YW50cyB0byBlYXQgeW91ciBjb29raWVzLiIKICAgICAgICAgICAgKQogICAgICAgICAgKTsKICAgICAgICBlbHNlIGlmIChsb3JlUHJvZ3Jlc3MgPD0gMSkKICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICJZb3VyIGZpcnN0IGJhdGNoIGdvZXMgdG8gdGhlIHRyYXNoLiBUaGUgbmVpZ2hib3Job29kIHJhY2Nvb24gYmFyZWx5IHRvdWNoZXMgaXQuIgogICAgICAgICAgICApCiAgICAgICAgICApOwogICAgICAgIGVsc2UgaWYgKGxvcmVQcm9ncmVzcyA8PSAyKQogICAgICAgICAgbGlzdC5wdXNoKGxvYygiWW91ciBmYW1pbHkgYWNjZXB0cyB0byB0cnkgc29tZSBvZiB5b3VyIGNvb2tpZXMuIikpOwogICAgICAgIGVsc2UgaWYgKGxvcmVQcm9ncmVzcyA8PSAzKQogICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICBsb2MoIllvdXIgY29va2llcyBhcmUgcG9wdWxhciBpbiB0aGUgbmVpZ2hib3Job29kLiIpLAogICAgICAgICAgICBsb2MoIlBlb3BsZSBhcmUgc3RhcnRpbmcgdG8gdGFsayBhYm91dCB5b3VyIGNvb2tpZXMuIikKICAgICAgICAgICk7CiAgICAgICAgZWxzZSBpZiAobG9yZVByb2dyZXNzIDw9IDQpCiAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgIGxvYygiWW91ciBjb29raWVzIGFyZSB0YWxrZWQgYWJvdXQgZm9yIG1pbGVzIGFyb3VuZC4iKSwKICAgICAgICAgICAgbG9jKCJZb3VyIGNvb2tpZXMgYXJlIHJlbm93bmVkIGluIHRoZSB3aG9sZSB0b3duISIpCiAgICAgICAgICApOwogICAgICAgIGVsc2UgaWYgKGxvcmVQcm9ncmVzcyA8PSA1KQogICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICBsb2MoIllvdXIgY29va2llcyBicmluZyBhbGwgdGhlIGJveXMgdG8gdGhlIHlhcmQuIiksCiAgICAgICAgICAgIGxvYygiWW91ciBjb29raWVzIG5vdyBoYXZlIHRoZWlyIG93biB3ZWJzaXRlISIpCiAgICAgICAgICApOwogICAgICAgIGVsc2UgaWYgKGxvcmVQcm9ncmVzcyA8PSA2KQogICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICBsb2MoIllvdXIgY29va2llcyBhcmUgd29ydGggYSBsb3Qgb2YgbW9uZXkuIiksCiAgICAgICAgICAgIGxvYygiWW91ciBjb29raWVzIHNlbGwgdmVyeSB3ZWxsIGluIGRpc3RhbnQgY291bnRyaWVzLiIpCiAgICAgICAgICApOwogICAgICAgIGVsc2UgaWYgKGxvcmVQcm9ncmVzcyA8PSA3KQogICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgIlBlb3BsZSBjb21lIGZyb20gdmVyeSBmYXIgYXdheSB0byBnZXQgYSB0YXN0ZSBvZiB5b3VyIGNvb2tpZXMuIgogICAgICAgICAgICApLAogICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgIktpbmdzIGFuZCBxdWVlbnMgZnJvbSBhbGwgb3ZlciB0aGUgd29ybGQgYXJlIGVuam95aW5nIHlvdXIgY29va2llcy4iCiAgICAgICAgICAgICkKICAgICAgICAgICk7CiAgICAgICAgZWxzZSBpZiAobG9yZVByb2dyZXNzIDw9IDgpCiAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgIGxvYygiVGhlcmUgYXJlIG5vdyBtdXNldW1zIGRlZGljYXRlZCB0byB5b3VyIGNvb2tpZXMuIiksCiAgICAgICAgICAgIGxvYygiQSBuYXRpb25hbCBkYXkgaGFzIGJlZW4gY3JlYXRlZCBpbiBob25vciBvZiB5b3VyIGNvb2tpZXMuIikKICAgICAgICAgICk7CiAgICAgICAgZWxzZSBpZiAobG9yZVByb2dyZXNzIDw9IDkpCiAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgIGxvYygiWW91ciBjb29raWVzIGhhdmUgYmVlbiBuYW1lZCBhIHBhcnQgb2YgdGhlIHdvcmxkIHdvbmRlcnMuIiksCiAgICAgICAgICAgIGxvYygiSGlzdG9yeSBib29rcyBub3cgaW5jbHVkZSBhIHdob2xlIGNoYXB0ZXIgYWJvdXQgeW91ciBjb29raWVzLiIpCiAgICAgICAgICApOwogICAgICAgIGVsc2UgaWYgKGxvcmVQcm9ncmVzcyA8PSAxMCkKICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgbG9jKCJZb3VyIGNvb2tpZXMgaGF2ZSBiZWVuIHBsYWNlZCB1bmRlciBnb3Zlcm5tZW50IHN1cnZlaWxsYW5jZS4iKSwKICAgICAgICAgICAgbG9jKCJUaGUgd2hvbGUgcGxhbmV0IGlzIGVuam95aW5nIHlvdXIgY29va2llcyEiKQogICAgICAgICAgKTsKICAgICAgICBlbHNlIGlmIChsb3JlUHJvZ3Jlc3MgPD0gMTEpCiAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgIGxvYygKICAgICAgICAgICAgICAiU3RyYW5nZSBjcmVhdHVyZXMgZnJvbSBuZWlnaGJvcmluZyBwbGFuZXRzIHdpc2ggdG8gdHJ5IHlvdXIgY29va2llcy4iCiAgICAgICAgICAgICksCiAgICAgICAgICAgIGxvYygKICAgICAgICAgICAgICAiRWxkZXIgZ29kcyBmcm9tIHRoZSB3aG9sZSBjb3Ntb3MgaGF2ZSBhd29rZW4gdG8gdGFzdGUgeW91ciBjb29raWVzLiIKICAgICAgICAgICAgKQogICAgICAgICAgKTsKICAgICAgICBlbHNlIGlmIChsb3JlUHJvZ3Jlc3MgPD0gMTIpCiAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgIGxvYygKICAgICAgICAgICAgICAiQmVpbmdzIGZyb20gb3RoZXIgZGltZW5zaW9ucyBsYXBzZSBpbnRvIGV4aXN0ZW5jZSBqdXN0IHRvIGdldCBhIHRhc3RlIG9mIHlvdXIgY29va2llcy4iCiAgICAgICAgICAgICksCiAgICAgICAgICAgIGxvYygiWW91ciBjb29raWVzIGhhdmUgYWNoaWV2ZWQgc2VudGllbmNlLiIpCiAgICAgICAgICApOwogICAgICAgIGVsc2UgaWYgKGxvcmVQcm9ncmVzcyA8PSAxMykKICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICJUaGUgdW5pdmVyc2UgaGFzIG5vdyB0dXJuZWQgaW50byBjb29raWUgZG91Z2gsIHRvIHRoZSBtb2xlY3VsYXIgbGV2ZWwuIgogICAgICAgICAgICApLAogICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgIllvdXIgY29va2llcyBhcmUgcmV3cml0aW5nIHRoZSBmdW5kYW1lbnRhbCBsYXdzIG9mIHRoZSB1bml2ZXJzZS4iCiAgICAgICAgICAgICkKICAgICAgICAgICk7CiAgICAgICAgZWxzZSBpZiAobG9yZVByb2dyZXNzIDw9IDE0KQogICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgIkEgbG9jYWwgbmV3cyBzdGF0aW9uIHJ1bnMgYSAxMC1taW51dGUgc2VnbWVudCBhYm91dCB5b3VyIGNvb2tpZXMuIFN1Y2Nlc3MhPGJyPjxzbWFsbD4oeW91IHdpbiBhIGNvb2tpZSk8L3NtYWxsPiIKICAgICAgICAgICAgKSwKICAgICAgICAgICAgbG9jKCJpdCdzIHRpbWUgdG8gc3RvcCBwbGF5aW5nIikKICAgICAgICAgICk7CiAgICAgIH0KCiAgICAgIC8vaWYgKEdhbWUuZWxkZXJXcmF0aD4wICYmIChHYW1lLnBsZWRnZXM9PTAgfHwgTWF0aC5yYW5kb20oKTwwLjIpKQogICAgICBpZiAoCiAgICAgICAgR2FtZS5lbGRlcldyYXRoID4gMCAmJgogICAgICAgICgoR2FtZS5wbGVkZ2VzID09IDAgJiYgR2FtZS5yZXNldHMgPT0gMCAmJiBNYXRoLnJhbmRvbSgpIDwgMC4zKSB8fAogICAgICAgICAgTWF0aC5yYW5kb20oKSA8IDAuMDMpCiAgICAgICkgewogICAgICAgIGxpc3QgPSBbXTsKICAgICAgICBpZiAoR2FtZS5lbGRlcldyYXRoID09IDEpCiAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgIEVOCiAgICAgICAgICAgICAgPyBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAiTmV3cyA6IG1pbGxpb25zIG9mIG9sZCBsYWRpZXMgcmVwb3J0ZWQgbWlzc2luZyEiLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IHByb2Nlc3Npb25zIG9mIG9sZCBsYWRpZXMgc2lnaHRlZCBhcm91bmQgY29va2llIGZhY2lsaXRpZXMhIiwKICAgICAgICAgICAgICAgICAgIk5ld3MgOiBmYW1pbGllcyBhcm91bmQgdGhlIGNvbnRpbmVudCByZXBvcnQgYWdpdGF0ZWQsIHRyYW5zZml4ZWQgZ3JhbmRtb3RoZXJzISIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogZG9jdG9ycyBzd2FybWVkIGJ5IGNhc2VzIG9mIG9sZCB3b21lbiB3aXRoIGdsYXNzeSBleWVzIGFuZCBhIGZvYW15IG1vdXRoISIsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogbnVyc2VzIHJlcG9ydCAic3RyYW5nZSBzY2VudCBvZiBjb29raWUgZG91Z2giIGFyb3VuZCBmZW1hbGUgZWxkZXJseSBwYXRpZW50cyEnLAogICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICA6IE5FV1MgKyBjaG9vc2UobG9jKCJUaWNrZXIgKGdyYW5kbWEgaW52YXNpb24gc3RhcnQpIikpCiAgICAgICAgICApOwogICAgICAgIGlmIChHYW1lLmVsZGVyV3JhdGggPT0gMikKICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgRU4KICAgICAgICAgICAgICA/IGNob29zZShbCiAgICAgICAgICAgICAgICAgICJOZXdzIDogdG93biBpbiBkaXNhcnJheSBhcyBzdHJhbmdlIG9sZCBsYWRpZXMgYnJlYWsgaW50byBob21lcyB0byBhYmR1Y3QgaW5mYW50cyBhbmQgYmFraW5nIHV0ZW5zaWxzISIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogc2lnaHRpbmdzIG9mIG9sZCBsYWRpZXMgd2l0aCBnbG93aW5nIGV5ZXMgdGVycmlmeSBsb2NhbCBwb3B1bGF0aW9uISIsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogcmV0aXJlbWVudCBob21lcyByZXBvcnQgImZlbWFsZSByZXNpZGVudHMgc2xvd2x5IGNvbmdlYWxpbmcgaW4gdGhlaXIgc2VhdHMiIScsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogd2hvbGUgY29udGluZW50IHVuZGVyZ29pbmcgbWFzcyBleG9kdXMgb2Ygb2xkIGxhZGllcyEiLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IG9sZCB3b21lbiBmcmVlemUgaW4gcGxhY2UgaW4gc3RyZWV0cywgb296ZSB3YXJtIHN1Z2FyeSBzeXJ1cCEiLAogICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICA6IE5FV1MgKyBjaG9vc2UobG9jKCJUaWNrZXIgKGdyYW5kbWEgaW52YXNpb24gcmlzZSkiKSkKICAgICAgICAgICk7CiAgICAgICAgaWYgKEdhbWUuZWxkZXJXcmF0aCA9PSAzKQogICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICBFTgogICAgICAgICAgICAgID8gY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgJ05ld3MgOiBsYXJnZSAiZmxlc2ggaGlnaHdheXMiIHNjYXIgY29udGluZW50LCBzdHJldGNoIGJldHdlZW4gdmFyaW91cyBjb29raWUgZmFjaWxpdGllcyEnLAogICAgICAgICAgICAgICAgICAnTmV3cyA6IHdyaW5rbGVkICJmbGVzaCB0ZW5kcmlscyIgdmlzaWJsZSBmcm9tIHNwYWNlIScsCiAgICAgICAgICAgICAgICAgICdOZXdzIDogcmVtYWlucyBvZiAib2xkIGxhZGllcyIgZm91bmQgZnJvemVuIGluIHRoZSBtaWRkbGUgb2YgZ3Jvd2luZyBmbGVzaHkgc3RydWN0dXJlcyEnLAogICAgICAgICAgICAgICAgICAiTmV3cyA6IGFsbCBob3BlIGxvc3QgYXMgd3JpdGhpbmcgbWFzcyBvZiBmbGVzaCBhbmQgZG91Z2ggZW5ndWxmcyB3aG9sZSBjaXR5ISIsCiAgICAgICAgICAgICAgICAgICJOZXdzIDogbmlnaHRtYXJlIGNvbnRpbnVlcyBhcyB3cmlua2xlZCBhY3JlcyBvZiBmbGVzaCBleHBhbmQgYXQgYWxhcm1pbmcgc3BlZWRzISIsCiAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgIDogTkVXUyArIGNob29zZShsb2MoIlRpY2tlciAoZ3JhbmRtYSBpbnZhc2lvbiBmdWxsKSIpKQogICAgICAgICAgKTsKICAgICAgfQoKICAgICAgaWYgKEVOICYmIEdhbWUuc2Vhc29uID09ICJmb29scyIpIHsKICAgICAgICBsaXN0ID0gW107CgogICAgICAgIGlmIChHYW1lLmNvb2tpZXNFYXJuZWQgPj0gMTAwMCkKICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgIllvdXIgb2ZmaWNlIGNoYWlyIGlzIHJlYWxseSBjb21mb3J0YWJsZS4iLAogICAgICAgICAgICAgICAgIlByb2ZpdCdzIGluIHRoZSBhaXIhIiwKICAgICAgICAgICAgICAgICJCdXNpbmVzcyBtZWV0aW5ncyBhcmUgc3VjaCBhIGpveSEiLAogICAgICAgICAgICAgICAgIldoYXQgYSBncmVhdCB2aWV3IGZyb20geW91ciBvZmZpY2UhIiwKICAgICAgICAgICAgICAgICJTbWVsbCB0aGF0PyBUaGF0J3MgY2FwaXRhbGlzbSwgYmFieSEiLAogICAgICAgICAgICAgICAgIllvdSB0cnVseSBsb3ZlIGFuc3dlcmluZyBlbWFpbHMuIiwKICAgICAgICAgICAgICAgICJXb3JraW5nIGhhcmQsIG9yIGhhcmRseSB3b3JraW5nPyIsCiAgICAgICAgICAgICAgICAiQW5vdGhlciBkYXkgaW4gcGFyYWRpc2UhIiwKICAgICAgICAgICAgICAgICJFeHBlbnNpdmUgbHVuY2ggdGltZSEiLAogICAgICAgICAgICAgICAgIkFub3RoZXIgZ292ZXJubWVudCBiYWlsb3V0IGNvbWluZyB1cCEgU3BsZW5kaWQhIiwKICAgICAgICAgICAgICAgICJUaGVzZSBwcm9maXRzIGFyZSBkb2luZyB3b25kZXJmdWwgdGhpbmdzIGZvciB5b3VyIHNraW4uIiwKICAgICAgICAgICAgICAgICJZb3UgZGF5ZHJlYW0gZm9yIGEgbW9tZW50IGFib3V0IGEgd29ybGQgd2l0aG91dCB0YXhlcy4iLAogICAgICAgICAgICAgICAgIllvdSdsbCB3b3JyeSBhYm91dCBlbnZpcm9ubWVudGFsIGRhbWFnZSB3aGVuIHlvdSdyZSBkZWFkISIsCiAgICAgICAgICAgICAgICAiWWF5LCBvZmZpY2Ugc3VwcGxpZXMhIiwKICAgICAgICAgICAgICAgICJTd2VldCwgdGhvc2UgbmV3IHN0YXBsZXJzIGp1c3QgY2FtZSBpbiEiLAogICAgICAgICAgICAgICAgIk9oaCwgY29mZmVlIGJyZWFrISIsCiAgICAgICAgICAgICAgXSksCiAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICJZb3UndmUgc3BlbnQgdGhlIHdob2xlIGRheSIsCiAgICAgICAgICAgICAgICAiQW5vdGhlciBncmVhdCBkYXkiLAogICAgICAgICAgICAgICAgIkZpcnN0IG9yZGVyIG9mIGJ1c2luZXNzIHRvZGF5OiIsCiAgICAgICAgICAgICAgICAiV2h5LCB5b3UgdHJ1bHkgZW5qb3kiLAogICAgICAgICAgICAgICAgIldoYXQgbmV4dD8gVGhhdCdzIHJpZ2h0LCIsCiAgICAgICAgICAgICAgICAiWW91IGNoZWNrIHdoYXQncyBuZXh0IG9uIHRoZSBhZ2VuZGEuIE9oIGJveSwiLAogICAgICAgICAgICAgIF0pICsKICAgICAgICAgICAgICAgICIgIiArCiAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAic2lnbmluZyBjb250cmFjdHMiLAogICAgICAgICAgICAgICAgICAiZmlsbGluZyBvdXQgZm9ybXMiLAogICAgICAgICAgICAgICAgICAidG91Y2hpbmcgYmFzZSB3aXRoIHRoZSB0ZWFtIiwKICAgICAgICAgICAgICAgICAgImV4YW1pbmluZyBleGNpdGluZyBuZXcgcHJvc3BlY3RzIiwKICAgICAgICAgICAgICAgICAgInBsYXlpbmcgd2l0aCB5b3VyIGRlc2sgdG95cyIsCiAgICAgICAgICAgICAgICAgICJnZXR0aW5nIG5ldyBuYW1lcGxhdGVzIGRvbmUiLAogICAgICAgICAgICAgICAgICAiYXR0ZW5kaW5nIHNlbWluYXJzIiwKICAgICAgICAgICAgICAgICAgInZpZGVvY29uZmVyZW5jaW5nIiwKICAgICAgICAgICAgICAgICAgImhpcmluZyBkeW5hbWljIHlvdW5nIGV4ZWN1dGl2ZXMiLAogICAgICAgICAgICAgICAgICAibWVldGluZyBuZXcgaW52ZXN0b3JzIiwKICAgICAgICAgICAgICAgICAgInVwZGF0aW5nIHlvdXIgcm9sb2RleCIsCiAgICAgICAgICAgICAgICAgICJwdW1waW5nIHVwIHRob3NlIG51bWJlcnMiLAogICAgICAgICAgICAgICAgICAicHVuY2hpbmcgaW4gc29tZSBudW1iZXJzIiwKICAgICAgICAgICAgICAgICAgImdldHRpbmcgaW52ZXN0aWdhdGVkIGZvciB3b3JrZXJzJyByaWdodHMgdmlvbGF0aW9ucyIsCiAgICAgICAgICAgICAgICAgICJyZW9yZ2FuaXppbmcgZG9jdW1lbnRzIiwKICAgICAgICAgICAgICAgICAgImJlbGl0dGxpbmcgdW5kZXJsaW5ncyIsCiAgICAgICAgICAgICAgICAgICJyZXZpZXdpbmcgZW1wbG95ZWUgcGVyZm9ybWFuY2UiLAogICAgICAgICAgICAgICAgICAicmV2aXNpbmcgY29tcGFueSBwb2xpY2llcyIsCiAgICAgICAgICAgICAgICAgICJkb3duc2l6aW5nIiwKICAgICAgICAgICAgICAgICAgInB1bGxpbmcgeW91cnNlbGYgdXAgYnkgeW91ciBib290c3RyYXBzIiwKICAgICAgICAgICAgICAgICAgImFkanVzdGluZyB5b3VyIHRpZSIsCiAgICAgICAgICAgICAgICAgICJwZXJmb3JtaW5nIHRvdGFsbHkgbm9ybWFsIGh1bWFuIGFjdGl2aXRpZXMiLAogICAgICAgICAgICAgICAgICAicmVjZW50ZXJpbmcgeW91cnNlbGYgaW4gdGhlIHNjcmVhbSByb29tIiwKICAgICAgICAgICAgICAgICAgImltbWFuZW50aXppbmcgdGhlIGVzY2hhdG9uIiwKICAgICAgICAgICAgICAgICAgInNocmVkZGluZyBzb21lIHNlbnNpdGl2ZSBkb2N1bWVudHMiLAogICAgICAgICAgICAgICAgICAiY29tcGFyaW5nIGJ1c2luZXNzIGNhcmRzIiwKICAgICAgICAgICAgICAgICAgInBvbmRlcmluZyB0aGUgbWVhbmluZyBvZiB5b3VyIGV4aXN0ZW5jZSIsCiAgICAgICAgICAgICAgICAgICJsaXN0ZW5pbmcgdG8gdGhlIHJvYXJpbmcgZW1wdGluZXNzIGluc2lkZSB5b3VyIHNvdWwiLAogICAgICAgICAgICAgICAgICAicGxheWluZyBtaW5pZ29sZiBpbiB5b3VyIG9mZmljZSIsCiAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAiISIsCiAgICAgICAgICAgICAgIlRoZSB3b3JkIG9mIHRoZSBkYXkgaXM6ICIgKwogICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgInZpcmFsIiwKICAgICAgICAgICAgICAgICAgInNlYXJjaCBlbmdpbmUgb3B0aW1pemF0aW9uIiwKICAgICAgICAgICAgICAgICAgImJsYWdzIGFuZCB3b2JzaXRlcyIsCiAgICAgICAgICAgICAgICAgICJzb2NpYWwgbmV0d29ya3MiLAogICAgICAgICAgICAgICAgICAid2ViaW5ldHRlIiwKICAgICAgICAgICAgICAgICAgInN0YXljYXRpb24iLAogICAgICAgICAgICAgICAgICAidXNlciBleHBlcmllbmNlIiwKICAgICAgICAgICAgICAgICAgImNyb3dkZnVuZGluZyIsCiAgICAgICAgICAgICAgICAgICJjYXJib24gbmV1dHJhbCIsCiAgICAgICAgICAgICAgICAgICJiaWcgZGF0YSIsCiAgICAgICAgICAgICAgICAgICJtYWNoaW5lIGxlYXJuaW5nIiwKICAgICAgICAgICAgICAgICAgImRpc3J1cHRpbmciLAogICAgICAgICAgICAgICAgICAiaW5mbHVlbmNlcnMiLAogICAgICAgICAgICAgICAgICAibW9ub2NvbnNlbnN1YWwgdHJhbnNhY3Rpb25zIiwKICAgICAgICAgICAgICAgICAgInN1c3RhaW5hYmxlIiwKICAgICAgICAgICAgICAgICAgImZyZWVtaXVtIiwKICAgICAgICAgICAgICAgICAgImluY2VudGl2ZXMiLAogICAgICAgICAgICAgICAgICAiZ3Jhc3Nyb290cyIsCiAgICAgICAgICAgICAgICAgICJ3ZWIgMy4wIiAvKnRoaXMgd2FzIGJlZm9yZSB0aGlzIHdob2xlIGNyeXB0byBtZXNzIGknbSBzbyBzb3JyeSovLAogICAgICAgICAgICAgICAgICAibG9naXN0aWNzIiwKICAgICAgICAgICAgICAgICAgImxldmVyYWdpbmciLAogICAgICAgICAgICAgICAgICAiYnJhbmRpbmciLAogICAgICAgICAgICAgICAgICAicHJvYWN0aXZlIiwKICAgICAgICAgICAgICAgICAgInN5bmVyZ2l6aW5nIiwKICAgICAgICAgICAgICAgICAgIm1hcmtldCByZXNlYXJjaCIsCiAgICAgICAgICAgICAgICAgICJkZW1vZ3JhcGhpY3MiLAogICAgICAgICAgICAgICAgICAicGllIGNoYXJ0cyIsCiAgICAgICAgICAgICAgICAgICJibG9ndWxhciIsCiAgICAgICAgICAgICAgICAgICJibG9ndWxhY2lvdXMiLAogICAgICAgICAgICAgICAgICAiYmxvZ2FzdGljIiwKICAgICAgICAgICAgICAgICAgImF1dGhlbnRpY2l0eSIsCiAgICAgICAgICAgICAgICAgICJwbGFzdGljcyIsCiAgICAgICAgICAgICAgICAgICJlbGVjdHJvbmljIG1haWwiLAogICAgICAgICAgICAgICAgICAiY2VsbHVsYXIgcGhvbmVzIiwKICAgICAgICAgICAgICAgICAgInJhcCBtdXNpYyIsCiAgICAgICAgICAgICAgICAgICJidWxicyIsCiAgICAgICAgICAgICAgICAgICJnb2JsaW5pemF0aW9uIiwKICAgICAgICAgICAgICAgICAgInN0cmFpZ2h0LXRvLWJha2VyeSIsCiAgICAgICAgICAgICAgICAgICJtaWNyb2Jha2VyaWVzIiwKICAgICAgICAgICAgICAgICAgImNob2NvbGF0aXZpdHkiLAogICAgICAgICAgICAgICAgICAiZmxhdm9yZnVsbmVzcyIsCiAgICAgICAgICAgICAgICAgICJ0YXN0eWZpY2F0aW9uIiwKICAgICAgICAgICAgICAgICAgInN1Z2FyIG9mZnNldHMiLAogICAgICAgICAgICAgICAgICAiYWN0aXZhdGVkIHdoZWF0IiwKICAgICAgICAgICAgICAgICAgInJlaWZpY2F0aW9uIiwKICAgICAgICAgICAgICAgICAgImltbWFuZW50aXplIHRoZSBlc2NoYXRvbiIsCiAgICAgICAgICAgICAgICAgICJjb29raWVzLCBJIGd1ZXNzIiwKICAgICAgICAgICAgICAgIF0pICsKICAgICAgICAgICAgICAgICIuIiwKICAgICAgICAgICAgXSkKICAgICAgICAgICk7CiAgICAgICAgaWYgKEdhbWUuY29va2llc0Vhcm5lZCA+PSAxMDAwICYmIE1hdGgucmFuZG9tKCkgPCAwLjA1KQogICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICJJZiB5b3UgY291bGQgZ2V0IHNvbWUgbW9yZSBjb29raWVzIGJha2VkLCB0aGF0J2QgYmUgZ3JlYXQuIiwKICAgICAgICAgICAgICAiU28uIEFib3V0IHRob3NlIFRQUyByZXBvcnRzLiIsCiAgICAgICAgICAgICAgIkhtbSwgeW91J3ZlIGdvdCBzb21lIHZpZGVvIHRhcGVzIHRvIHJldHVybi4iLAogICAgICAgICAgICAgICJUaGV5J2xsIHBheS4gVGhleSdsbCBhbGwgcGF5LiIsCiAgICAgICAgICAgICAgIllvdSBoYXZlbid0IGV2ZW4gYmVndW4gdG8gcGVhay4iLAogICAgICAgICAgICAgICJUaGVyZSBpcyBhbiBpZGVhIG9mIGEgIiArCiAgICAgICAgICAgICAgICBHYW1lLmJha2VyeU5hbWUgKwogICAgICAgICAgICAgICAgIi4gU29tZSBraW5kIG9mIGFic3RyYWN0aW9uLiBCdXQgdGhlcmUgaXMgbm8gcmVhbCB5b3UsIG9ubHkgYW4gZW50aXR5LiBTb21ldGhpbmcgaWxsdXNvcnkuIiwKICAgICAgICAgICAgICAiVGhpcyB3YXMgYSB0ZXJyaWJsZSBpZGVhISIsCiAgICAgICAgICAgIF0pCiAgICAgICAgICApOwoKICAgICAgICBpZiAoR2FtZS5UaWNrZXJOICUgMiA9PSAwKSB7CiAgICAgICAgICBpZiAoR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAiWW91ciByb2xsaW5nIHBpbnMgYXJlIHJvbGxpbmcgYW5kIHBpbm5pbmchIiwKICAgICAgICAgICAgICAgICJQcm9kdWN0aW9uIGlzIHN0ZWFkeSEiLAogICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICk7CgogICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLmFtb3VudCA+IDApCiAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgIllvdXIgb3ZlbnMgYXJlIGRpbGlnZW50bHkgYmFraW5nIG1vcmUgYW5kIG1vcmUgY29va2llcy4iLAogICAgICAgICAgICAgICAgIllvdXIgb3ZlbnMgYnVybiBhIHdob2xlIGJhdGNoLiBBaCB3ZWxsISBTdGlsbCBnb29kLiIsCiAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgKTsKCiAgICAgICAgICBpZiAoR2FtZS5PYmplY3RzWyJGYXJtIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAiU2NvcmVzIG9mIGNvb2tpZXMgY29tZSBvdXQgb2YgeW91ciBraXRjaGVucy4iLAogICAgICAgICAgICAgICAgIlRvZGF5LCBuZXcgcmVjcnVpdHMgYXJlIGpvaW5pbmcgeW91ciBraXRjaGVucyEiLAogICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICk7CgogICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siRmFjdG9yeSJdLmFtb3VudCA+IDApCiAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgIllvdXIgZmFjdG9yaWVzIGFyZSBwcm9kdWNpbmcgYW4gdW5lbmRpbmcgc3RyZWFtIG9mIGJha2VkIGdvb2RzLiIsCiAgICAgICAgICAgICAgICAiWW91ciBmYWN0b3J5IHdvcmtlcnMgZGVjaWRlIHRvIGdvIG9uIHN0cmlrZSEiLAogICAgICAgICAgICAgICAgIkl0J3Mgc2FmZXR5IGluc3BlY3Rpb24gZGF5IGluIHlvdXIgZmFjdG9yaWVzLiIsCiAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgKTsKCiAgICAgICAgICBpZiAoR2FtZS5PYmplY3RzWyJNaW5lIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAiWW91ciBzZWNyZXQgcmVjaXBlcyBhcmUga2VwdCBzYWZlbHkgaW5zaWRlIGEgZ2lhbnQgdW5kZXJncm91bmQgdmF1bHQuIiwKICAgICAgICAgICAgICAgICJZb3VyIGNoZWZzIGFyZSB3b3JraW5nIG9uIG5ldyBzZWNyZXQgcmVjaXBlcyEiLAogICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICk7CgogICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siU2hpcG1lbnQiXS5hbW91bnQgPiAwKQogICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICJZb3VyIHN1cGVybWFya2V0cyBhcmUgYnVzdGxpbmcgd2l0aCBoYXBweSwgaHVuZ3J5IGN1c3RvbWVycy4iLAogICAgICAgICAgICAgICAgIllvdXIgc3VwZXJtYXJrZXRzIGFyZSBmdWxsIG9mIGNvb2tpZSBtZXJjaCEiLAogICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICk7CgogICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siQWxjaGVteSBsYWIiXS5hbW91bnQgPiAwKQogICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICJJdCdzIGEgbmV3IHRyYWRpbmcgZGF5IGF0IHRoZSBzdG9jayBleGNoYW5nZSwgYW5kIHRyYWRlcnMgY2FuJ3QgZ2V0IGVub3VnaCBvZiB5b3VyIHNoYXJlcyEiLAogICAgICAgICAgICAgICAgIllvdXIgc3RvY2sgaXMgZG91YmxpbmcgaW4gdmFsdWUgYnkgdGhlIG1pbnV0ZSEiLAogICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICk7CgogICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siUG9ydGFsIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAiWW91IGp1c3QgcmVsZWFzZWQgYSBuZXcgVFYgc2hvdyBlcGlzb2RlISIsCiAgICAgICAgICAgICAgICAiWW91ciBjb29raWUtdGhlbWVkIFRWIHNob3cgaXMgYmVpbmcgYWRhcHRlZCBpbnRvIGEgbmV3IG1vdmllISIsCiAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgKTsKCiAgICAgICAgICBpZiAoR2FtZS5PYmplY3RzWyJUaW1lIG1hY2hpbmUiXS5hbW91bnQgPiAwKQogICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICJZb3VyIHRoZW1lIHBhcmtzIGFyZSBkb2luZyB3ZWxsIC0gcHVkZGxlcyBvZiB2b21pdCBhbmQgcm9sbGVyLWNvYXN0ZXIgY2FzdWFsdGllcyBhcmUgYmVpbmcgc3dlcHQgdW5kZXIgdGhlIHJ1ZyEiLAogICAgICAgICAgICAgICAgIlZpc2l0b3JzIGFyZSBzdHVmZmluZyB0aGVtc2VsdmVzIHdpdGggY29va2llcyBiZWZvcmUgcmlkaW5nIHlvdXIgcm9sbGVyLWNvYXN0ZXJzLiBZb3UgbWlnaHQgd2FudCB0byBoaXJlIG1vcmUgY2xlYW4tdXAgY3Jld3MuIiwKICAgICAgICAgICAgICBdKQogICAgICAgICAgICApOwoKICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIkFudGltYXR0ZXIgY29uZGVuc2VyIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAiQ29va2llY29pbiBpcyBvZmZpY2lhbGx5IHRoZSBtb3N0IG1pbmVkIGRpZ2l0YWwgY3VycmVuY3kgaW4gdGhlIGhpc3Rvcnkgb2YgbWFua2luZCEiLAogICAgICAgICAgICAgICAgIkNvb2tpZWNvaW4gcGlyYWN5IGlzIHJhbXBhbnQhIiwKICAgICAgICAgICAgICBdKQogICAgICAgICAgICApOwoKICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIlByaXNtIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAiWW91ciBjb3Jwb3JhdGUgbmF0aW9ucyBqdXN0IGdhaW5lZCBhIG5ldyBwYXJsaWFtZW50ISIsCiAgICAgICAgICAgICAgICAiWW91J3ZlIGp1c3QgYW5uZXhlZCBhIG5ldyBuYXRpb24hIiwKICAgICAgICAgICAgICAgICJBIG5ldyBuYXRpb24gam9pbnMgdGhlIGdyYW5kIGNvb2tpZSBjb25nbG9tZXJhdGUhIiwKICAgICAgICAgICAgICBdKQogICAgICAgICAgICApOwoKICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIkNoYW5jZW1ha2VyIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAiWW91ciBpbnRlcmdhbGFjdGljIGZlZGVyYXRpb24gb2YgY29va2llLXNwb25zb3JlZCBwbGFuZXRzIHJlcG9ydHMgcmVjb3JkLWJyZWFraW5nIHByb2ZpdHMhIiwKICAgICAgICAgICAgICAgICJCaWxsaW9ucyBvZiB1bndhc2hlZCBhbGllbnMgYXJlIHBsZWFzZWQgdG8gam9pbiB5b3VyIHdvcmtmb3JjZSBhcyB5b3UgYW5uZXggdGhlaXIgcGxhbmV0ISIsCiAgICAgICAgICAgICAgICAiTmV3IHRvbGwgb3BlbmVkIG9uIGludGVyc3RlbGxhciBoaWdod2F5LCBmdW5uZWxsaW5nIG1vcmUgcHJvZml0cyBpbnRvIHRoZSBjb29raWUgZWNvbm9teSEiLAogICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICk7CgogICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siRnJhY3RhbCBlbmdpbmUiXS5hbW91bnQgPiAwKQogICAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICJZb3VyIGNvb2tpZS1iYXNlZCBwb2xpdGljYWwgcGFydHkgaXMgZG9pbmcgZmFudGFzdGljIGluIHRoZSBwb2xscyEiLAogICAgICAgICAgICAgICAgIk5ldyBwcm8tY29va2llIGxhdyBwYXNzZXMgd2l0aG91dCBhIGhpdGNoIHRoYW5rcyB0byB5b3VyIGZpcm0gZ3Jhc3Agb2YgdGhlIHBvbGl0aWNhbCBlY29zeXN0ZW0hIiwKICAgICAgICAgICAgICAgICJZb3VyIGFwcG9pbnRlZCBzZW5hdG9ycyBhcmUgb3ZlcnR1cm5pbmcgY29va2llIGJhbnMgbGVmdCBhbmQgcmlnaHQhIiwKICAgICAgICAgICAgICBdKQogICAgICAgICAgICApOwoKICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIkphdmFzY3JpcHQgY29uc29sZSJdLmFtb3VudCA+IDApCiAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgIkNvb2tpZXMgYXJlIG5vdyBvbmUgb2YgdGhlIGRlZmluaW5nIGFzcGVjdHMgb2YgbWFua2luZCEgQ29uZ3JhdHVsYXRpb25zISIsCiAgICAgICAgICAgICAgICAiVGltZSB0cmF2ZWxlcnMgcmVwb3J0IHRoYXQgdGhpcyBlcmEgd2lsbCBsYXRlciBjb21lIHRvIGJlIGtub3duLCB0aGFua3MgdG8geW91LCBhcyB0aGUgY29va2llIG1pbGxlbm5pdW0hIiwKICAgICAgICAgICAgICAgICJDb29raWVzIG5vdyBkZWVwbHkgcm9vdGVkIGluIGh1bWFuIGN1bHR1cmUsIGxpa2VseSBwdXp6bGluZyBmdXR1cmUgaGlzdG9yaWFucyEiLAogICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICk7CgogICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1siSWRsZXZlcnNlIl0uYW1vdW50ID4gMCkKICAgICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAiUHVibGljIGFnaGFzdCBhcyBhbGwgcmVtYWluaW5nIGFzcGVjdHMgb2YgdGhlaXIgbGl2ZXMgb3ZlcnRha2VuIGJ5IHVuaXZlcnNhbCBjb29raWUgaW5kdXN0cnkhIiwKICAgICAgICAgICAgICAgICJFdmVyeSBzaW5nbGUgcHJvZHVjdCBjdXJyZW50bHkgc29sZCBpbiB0aGUgb2JzZXJ2YWJsZSB1bml2ZXJzZSBjYW4gYmUgdHJhY2VkIGJhY2sgdG8geW91ciBjb21wYW55ISBBbmQgdGhhdCdzIGEgZ29vZCB0aGluZy4iLAogICAgICAgICAgICAgICAgIkFudGl0cnVzdCBsYXdzIGxldCBvdXQgYSBoZWxwbGVzcyB3aGltcGVyIGJlZm9yZSBiZWluZyBlbmd1bGZlZCBieSB5b3VyIHNwcmF3bGluZyBlbXBpcmUhIiwKICAgICAgICAgICAgICBdKQogICAgICAgICAgICApOwoKICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbIkNvcnRleCBiYWtlciJdLmFtb3VudCA+IDApCiAgICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgIkJvbGQgbmV3IGxhdyBwcm9wb3NhbCB3b3VsZCBncmFudCBkZWZhdWx0IG93bmVyc2hpcCBvZiBldmVyeSBuZXcgaWRlYSBieSBhbnlvbmUgYW55d2hlcmUgdG8gIiArCiAgICAgICAgICAgICAgICAgIEdhbWUuYmFrZXJ5TmFtZSArCiAgICAgICAgICAgICAgICAgICIncyBiYWtlcnkhIiwKICAgICAgICAgICAgICAgICJCYWtlcnkgdGhpbmsgdGFua3MgYWNjaWRlbnRhbGx5IHJlaW52ZW50IGNvb2tpZXMgZm9yIHRoZSA1N3RoIHRpbWUgdGhpcyB3ZWVrISIsCiAgICAgICAgICAgICAgICAiQmFrZXJ5IHRoaW5rIHRhbmtzIGludmVudCBlbnRpcmUgbmV3IGZvcm0gb2YgaHVtYW4gY29tbXVuaWNhdGlvbiB0byBhZHZlcnRpc2UgYW5kIGJvb3N0IGNvb2tpZSBzYWxlcyEiLAogICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICk7CiAgICAgICAgfQoKICAgICAgICBpZiAobG9yZVByb2dyZXNzIDw9IDApCiAgICAgICAgICBsaXN0LnB1c2goIlN1Y2ggYSBncmFuZCBkYXkgdG8gYmVnaW4gYSBuZXcgYnVzaW5lc3MuIik7CiAgICAgICAgZWxzZSBpZiAobG9yZVByb2dyZXNzIDw9IDEpIGxpc3QucHVzaCgiWW91J3JlIGJha2luZyB1cCBhIHN0b3JtISIpOwogICAgICAgIGVsc2UgaWYgKGxvcmVQcm9ncmVzcyA8PSAyKQogICAgICAgICAgbGlzdC5wdXNoKAogICAgICAgICAgICAiWW91IGFyZSBjb25maWRlbnQgdGhhdCBvbmUgZGF5LCB5b3VyIGNvb2tpZSBjb21wYW55IHdpbGwgYmUgdGhlIGdyZWF0ZXN0IG9uIHRoZSBtYXJrZXQhIgogICAgICAgICAgKTsKICAgICAgICBlbHNlIGlmIChsb3JlUHJvZ3Jlc3MgPD0gMykgbGlzdC5wdXNoKCJCdXNpbmVzcyBpcyBwaWNraW5nIHVwISIpOwogICAgICAgIGVsc2UgaWYgKGxvcmVQcm9ncmVzcyA8PSA0KQogICAgICAgICAgbGlzdC5wdXNoKCJZb3UncmUgbWFraW5nIHNhbGVzIGxlZnQgYW5kIHJpZ2h0ISIpOwogICAgICAgIGVsc2UgaWYgKGxvcmVQcm9ncmVzcyA8PSA1KQogICAgICAgICAgbGlzdC5wdXNoKCJFdmVyeW9uZSB3YW50cyB0byBidXkgeW91ciBjb29raWVzISIpOwogICAgICAgIGVsc2UgaWYgKGxvcmVQcm9ncmVzcyA8PSA2KQogICAgICAgICAgbGlzdC5wdXNoKCJZb3UgYXJlIG5vdyBzcGVuZGluZyBtb3N0IG9mIHlvdXIgZGF5IHNpZ25pbmcgY29udHJhY3RzISIpOwogICAgICAgIGVsc2UgaWYgKGxvcmVQcm9ncmVzcyA8PSA3KQogICAgICAgICAgbGlzdC5wdXNoKCdZb3VcJ3ZlIGJlZW4gZWxlY3RlZCAiYnVzaW5lc3MgdHljb29uIG9mIHRoZSB5ZWFyIiEnKTsKICAgICAgICBlbHNlIGlmIChsb3JlUHJvZ3Jlc3MgPD0gOCkKICAgICAgICAgIGxpc3QucHVzaCgKICAgICAgICAgICAgIllvdXIgY29va2llcyBhcmUgYSB3b3JsZHdpZGUgc2Vuc2F0aW9uISBXZWxsIGRvbmUsIG9sZCBjaGFwISIKICAgICAgICAgICk7CiAgICAgICAgZWxzZSBpZiAobG9yZVByb2dyZXNzIDw9IDkpCiAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICJZb3VyIGJyYW5kIGhhcyBtYWRlIGl0cyB3YXkgaW50byBwb3B1bGFyIGN1bHR1cmUuIENoaWxkcmVuIHJlY2l0ZSB5b3VyIHNsb2dhbnMgYW5kIGFkdWx0cyByZW1pbmlzY2UgdGhlbSBmb25kbHkhIgogICAgICAgICAgKTsKICAgICAgICBlbHNlIGlmIChsb3JlUHJvZ3Jlc3MgPD0gMTApCiAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICJBIGJ1c2luZXNzIGRheSBsaWtlIGFueSBvdGhlci4gSXQncyBnb29kIHRvIGJlIGF0IHRoZSB0b3AhIgogICAgICAgICAgKTsKICAgICAgICBlbHNlIGlmIChsb3JlUHJvZ3Jlc3MgPD0gMTEpCiAgICAgICAgICBsaXN0LnB1c2goCiAgICAgICAgICAgICJZb3UgbG9vayBiYWNrIG9uIHlvdXIgY2FyZWVyLiBJdCdzIGJlZW4gYSBmYXNjaW5hdGluZyBqb3VybmV5LCBidWlsZGluZyB5b3VyIGJha2luZyBlbXBpcmUgZnJvbSB0aGUgZ3JvdW5kIHVwLiIKICAgICAgICAgICk7CiAgICAgIH0KCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgR2FtZS5tb2RIb29rc1sidGlja2VyIl0ubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgYXJyID0gR2FtZS5tb2RIb29rc1sidGlja2VyIl1baV0oKTsKICAgICAgICBpZiAoYXJyKSBsaXN0ID0gbGlzdC5jb25jYXQoYXJyKTsKICAgICAgfQoKICAgICAgR2FtZS5UaWNrZXJFZmZlY3QgPSAwOwoKICAgICAgaWYgKAogICAgICAgICFtYW51YWwgJiYKICAgICAgICBHYW1lLlQgPiBHYW1lLmZwcyAqIDEwICYmCiAgICAgICAgR2FtZS5IYXMoIkZvcnR1bmUgY29va2llcyIpICYmCiAgICAgICAgTWF0aC5yYW5kb20oKSA8IChHYW1lLkhhc0FjaGlldigiTyBGb3J0dW5hIikgPyAwLjA0IDogMC4wMikKICAgICAgKSB7CiAgICAgICAgdmFyIGZvcnR1bmVzID0gW107CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlRpZXJzWyJmb3J0dW5lIl0udXBncmFkZXMpIHsKICAgICAgICAgIHZhciBpdCA9IEdhbWUuVGllcnNbImZvcnR1bmUiXS51cGdyYWRlc1tpXTsKICAgICAgICAgIGlmICghR2FtZS5IYXNVbmxvY2tlZChpdC5uYW1lKSkgZm9ydHVuZXMucHVzaChpdCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoIUdhbWUuZm9ydHVuZUdDKSBmb3J0dW5lcy5wdXNoKCJmb3J0dW5lR0MiKTsKICAgICAgICBpZiAoIUdhbWUuZm9ydHVuZUNQUykgZm9ydHVuZXMucHVzaCgiZm9ydHVuZUNQUyIpOwoKICAgICAgICBpZiAoZm9ydHVuZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgbGlzdCA9IFtdOwogICAgICAgICAgdmFyIG1lID0gY2hvb3NlKGZvcnR1bmVzKTsKICAgICAgICAgIEdhbWUuVGlja2VyRWZmZWN0ID0geyB0eXBlOiAiZm9ydHVuZSIsIHN1YjogbWUgfTsKCiAgICAgICAgICBpZiAobWUgPT0gImZvcnR1bmVHQyIpCiAgICAgICAgICAgIG1lID0gbG9jKAogICAgICAgICAgICAgICJUb2RheSBpcyB5b3VyIGx1Y2t5IGRheSEiCiAgICAgICAgICAgICk7IC8qPGJyPkNsaWNrIGhlcmUgZm9yIGEgZ29sZGVuIGNvb2tpZS4nOyovCiAgICAgICAgICBlbHNlIGlmIChtZSA9PSAiZm9ydHVuZUNQUyIpIHsKICAgICAgICAgICAgTWF0aC5zZWVkcmFuZG9tKEdhbWUuc2VlZCArICItZm9ydHVuZSIpOwogICAgICAgICAgICBtZSA9CiAgICAgICAgICAgICAgbG9jKCJZb3VyIGx1Y2t5IG51bWJlcnMgYXJlOiIpICsKICAgICAgICAgICAgICAiICIgKwogICAgICAgICAgICAgIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCkgKwogICAgICAgICAgICAgICIgIiArCiAgICAgICAgICAgICAgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKSArCiAgICAgICAgICAgICAgIiAiICsKICAgICAgICAgICAgICBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApICsKICAgICAgICAgICAgICAiICIgKwogICAgICAgICAgICAgIE1hdGguZmxvb3IoCiAgICAgICAgICAgICAgICBNYXRoLnJhbmRvbSgpICogMTAwCiAgICAgICAgICAgICAgKSAvKisnPGJyPkNsaWNrIGhlcmUgdG8gZ2FpbiBvbmUgaG91ciBvZiB5b3VyIENwUy4nKi87CiAgICAgICAgICAgIE1hdGguc2VlZHJhbmRvbSgpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKEVOKSB7CiAgICAgICAgICAgICAgbWUgPQogICAgICAgICAgICAgICAgbWUuZG5hbWUuc3Vic3RyaW5nKG1lLm5hbWUuaW5kZXhPZigiIyIpKSArCiAgICAgICAgICAgICAgICAiIDogIiArCiAgICAgICAgICAgICAgICBtZS5iYXNlRGVzYy5zdWJzdHJpbmcobWUuYmFzZURlc2MuaW5kZXhPZigiPHE+IikgKyAzKTsKICAgICAgICAgICAgICBtZSA9IG1lLnN1YnN0cmluZygwLCBtZS5sZW5ndGggLSA0KTsKICAgICAgICAgICAgfSBlbHNlIGlmIChtZS5idWlsZGluZ1RpZSkKICAgICAgICAgICAgICBtZSA9CiAgICAgICAgICAgICAgICBtZS5kbmFtZSArCiAgICAgICAgICAgICAgICAiIDogIiArCiAgICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAgIGNob29zZShbCiAgICAgICAgICAgICAgICAgICAgIk5ldmVyIGZvcmdldCB5b3VyICUxLiIsCiAgICAgICAgICAgICAgICAgICAgIlBheSBjbG9zZSBhdHRlbnRpb24gdG8gdGhlIGh1bWJsZSAlMS4iLAogICAgICAgICAgICAgICAgICAgICJZb3UndmUgYmVlbiBuZWdsZWN0aW5nIHlvdXIgJTEuIiwKICAgICAgICAgICAgICAgICAgICAiUmVtZW1iZXIgdG8gdmlzaXQgeW91ciAlMSBzb21ldGltZXMuIiwKICAgICAgICAgICAgICAgICAgXSksCiAgICAgICAgICAgICAgICAgIG1lLmJ1aWxkaW5nVGllLnNpbmdsZQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgIG1lID0KICAgICAgICAgICAgICAgIG1lLmRuYW1lICsKICAgICAgICAgICAgICAgICIgOiAiICsKICAgICAgICAgICAgICAgIGxvYygKICAgICAgICAgICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgICAgICAgICAiWW91IGRvbid0IGtub3cgd2hhdCB5b3UgaGF2ZSB1bnRpbCB5b3UndmUgbG9zdCBpdC4iLAogICAgICAgICAgICAgICAgICAgICJSZW1lbWJlciB0byB0YWtlIGJyZWFrcy4iLAogICAgICAgICAgICAgICAgICAgICJIZXksIHdoYXQncyB1cC4gSSdtIGEgZm9ydHVuZSBjb29raWUuIiwKICAgICAgICAgICAgICAgICAgICAiWW91IHRoaW5rIHlvdSBoYXZlIGl0IGJhZD8gTG9vayBhdCBtZS4iLAogICAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgIH0KICAgICAgICAgIG1lID0KICAgICAgICAgICAgJzxzcGFuIGNsYXNzPSJmb3J0dW5lIj48ZGl2IGNsYXNzPSJpY29uIiBzdHlsZT0idmVydGljYWwtYWxpZ246bWlkZGxlO2Rpc3BsYXk6aW5saW5lLWJsb2NrO2JhY2tncm91bmQtcG9zaXRpb246JyArCiAgICAgICAgICAgIC0yOSAqIDQ4ICsKICAgICAgICAgICAgInB4ICIgKwogICAgICAgICAgICAtOCAqIDQ4ICsKICAgICAgICAgICAgJ3B4O3RyYW5zZm9ybTpzY2FsZSgwLjUpO21hcmdpbjotMTZweDtwb3NpdGlvbjpyZWxhdGl2ZTtsZWZ0Oi00cHg7dG9wOi0ycHg7Ij48L2Rpdj4nICsKICAgICAgICAgICAgbWUgKwogICAgICAgICAgICAiPC9zcGFuPiI7CiAgICAgICAgICBsaXN0ID0gW21lXTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChHYW1lLndpbmRvd1cgPCBHYW1lLnRpY2tlclRvb05hcnJvdykKICAgICAgICBsaXN0ID0gWwogICAgICAgICAgJzxkaXYgc3R5bGU9InRyYW5zZm9ybTpzY2FsZSgwLjgsMS4yKTsiPicgKwogICAgICAgICAgICBORVdTICsKICAgICAgICAgICAgKEVOID8gImhlbHAhIiA6IGxvYygiaGVscCBtZSEiKSkgKwogICAgICAgICAgICAiPC9kaXY+IiwKICAgICAgICBdOwoKICAgICAgR2FtZS5UaWNrZXJBZ2UgPSBHYW1lLmZwcyAqIDEwOwogICAgICBHYW1lLlRpY2tlciA9IGNob29zZShsaXN0KTsKICAgICAgR2FtZS5BZGRUb0xvZyhHYW1lLlRpY2tlcik7CiAgICAgIEdhbWUuVGlja2VyTisrOwogICAgICBHYW1lLlRpY2tlckRyYXcoKTsKICAgIH07CiAgICBHYW1lLnRpY2tlckwgPSBsKCJjb21tZW50c1RleHQxIik7CiAgICBHYW1lLnRpY2tlckJlbG93TCA9IGwoImNvbW1lbnRzVGV4dDIiKTsKICAgIEdhbWUudGlja2VyVG9vTmFycm93ID0gOTAwOwogICAgR2FtZS5UaWNrZXJEcmF3ID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgc3RyID0gIiI7CiAgICAgIGlmIChHYW1lLlRpY2tlciAhPSAiIikgc3RyID0gR2FtZS5UaWNrZXI7CiAgICAgIEdhbWUudGlja2VyQmVsb3dMLmlubmVySFRNTCA9IEdhbWUudGlja2VyTC5pbm5lckhUTUw7CiAgICAgIEdhbWUudGlja2VyTC5pbm5lckhUTUwgPSBzdHI7CgogICAgICBHYW1lLnRpY2tlckJlbG93TC5jbGFzc05hbWUgPSAiY29tbWVudHNUZXh0IjsKICAgICAgdm9pZCBHYW1lLnRpY2tlckJlbG93TC5vZmZzZXRXaWR0aDsKICAgICAgR2FtZS50aWNrZXJCZWxvd0wuY2xhc3NOYW1lID0gImNvbW1lbnRzVGV4dCByaXNpbmdBd2F5IjsKICAgICAgR2FtZS50aWNrZXJMLmNsYXNzTmFtZSA9ICJjb21tZW50c1RleHQiOwogICAgICB2b2lkIEdhbWUudGlja2VyTC5vZmZzZXRXaWR0aDsKICAgICAgR2FtZS50aWNrZXJMLmNsYXNzTmFtZSA9ICJjb21tZW50c1RleHQgcmlzaW5nVXAiOwogICAgfTsKICAgIEFkZEV2ZW50KEdhbWUudGlja2VyTCwgImNsaWNrIiwgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIEdhbWUuVGlja2VyID0gIiI7CiAgICAgIEdhbWUuVGlja2VyQ2xpY2tzKys7CiAgICAgIGlmIChHYW1lLndpbmRvd1cgPCBHYW1lLnRpY2tlclRvb05hcnJvdykgewogICAgICAgIEdhbWUuV2luKCJTdGlmbGluZyB0aGUgcHJlc3MiKTsKICAgICAgfSBlbHNlIGlmIChHYW1lLlRpY2tlckNsaWNrcyA+PSA1MCkgewogICAgICAgIEdhbWUuV2luKCJUYWJsb2lkIGFkZGljdGlvbiIpOwogICAgICB9CgogICAgICBpZiAoR2FtZS5UaWNrZXJFZmZlY3QgJiYgR2FtZS5UaWNrZXJFZmZlY3QudHlwZSA9PSAiZm9ydHVuZSIpIHsKICAgICAgICBQbGF5U291bmQoInNuZC9mb3J0dW5lLm1wMyIsIDEpOwogICAgICAgIEdhbWUuU3BhcmtsZUF0KEdhbWUubW91c2VYLCBHYW1lLm1vdXNlWSk7CiAgICAgICAgdmFyIGVmZmVjdCA9IEdhbWUuVGlja2VyRWZmZWN0LnN1YjsKICAgICAgICBpZiAoZWZmZWN0ID09ICJmb3J0dW5lR0MiKSB7CiAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgbG9jKCJGb3J0dW5lISIpLAogICAgICAgICAgICBsb2MoIkEgZ29sZGVuIGNvb2tpZSBoYXMgYXBwZWFyZWQuIiksCiAgICAgICAgICAgIFsxMCwgMzJdCiAgICAgICAgICApOwogICAgICAgICAgR2FtZS5mb3J0dW5lR0MgPSAxOwogICAgICAgICAgdmFyIG5ld1NoaW1tZXIgPSBuZXcgR2FtZS5zaGltbWVyKCJnb2xkZW4iLCB7IG5vV3JhdGg6IHRydWUgfSk7CiAgICAgICAgfSBlbHNlIGlmIChlZmZlY3QgPT0gImZvcnR1bmVDUFMiKSB7CiAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgbG9jKCJGb3J0dW5lISIpLAogICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgIllvdSBnYWluIDxiPm9uZSBob3VyPC9iPiBvZiB5b3VyIENwUyAoY2FwcGVkIGF0IGRvdWJsZSB5b3VyIGJhbmspLiIKICAgICAgICAgICAgKSwKICAgICAgICAgICAgWzEwLCAzMl0KICAgICAgICAgICk7CiAgICAgICAgICBHYW1lLmZvcnR1bmVDUFMgPSAxOwogICAgICAgICAgR2FtZS5FYXJuKE1hdGgubWluKEdhbWUuY29va2llc1BzICogNjAgKiA2MCwgR2FtZS5jb29raWVzKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgICBlZmZlY3QuZG5hbWUsCiAgICAgICAgICAgIGxvYygiWW91J3ZlIHVubG9ja2VkIGEgbmV3IHVwZ3JhZGUuIiksCiAgICAgICAgICAgIGVmZmVjdC5pY29uCiAgICAgICAgICApOwogICAgICAgICAgZWZmZWN0LnVubG9jaygpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgR2FtZS5UaWNrZXJFZmZlY3QgPSAwOwogICAgfSk7CgogICAgR2FtZS5Mb2cgPSBbXTsKICAgIEdhbWUuQWRkVG9Mb2cgPSBmdW5jdGlvbiAod2hhdCkgewogICAgICBHYW1lLkxvZy51bnNoaWZ0KHdoYXQpOwogICAgICBpZiAoR2FtZS5Mb2cubGVuZ3RoID4gMTAwKSBHYW1lLkxvZy5wb3AoKTsKICAgIH07CgogICAgR2FtZS52YW5pbGxhID0gMTsKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJCUJVSUxESU5HUwoJCT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCiAgICBHYW1lLmxhc3QgPSAwOwoKICAgIEdhbWUuc3RvcmVUb1JlZnJlc2ggPSAxOwogICAgR2FtZS5wcmljZUluY3JlYXNlID0gMS4xNTsKICAgIEdhbWUuYnV5QnVsayA9IDE7CiAgICBHYW1lLmJ1eU1vZGUgPSAxOyAvLzEgZm9yIGJ1eSwgLTEgZm9yIHNlbGwKICAgIEdhbWUuYnV5QnVsa09sZCA9IEdhbWUuYnV5QnVsazsgLy91c2VkIHRvIHVuZG8gY2hhbmdlcyBmcm9tIGhvbGRpbmcgU2hpZnQgb3IgQ3RybAogICAgR2FtZS5idXlCdWxrU2hvcnRjdXQgPSAwOyAvL2FyZSB3ZSBwcmVzc2luZyBTaGlmdCBvciBDdHJsPwoKICAgIEdhbWUuT2JqZWN0cyA9IHt9OwogICAgR2FtZS5PYmplY3RzQnlJZCA9IFtdOwogICAgR2FtZS5PYmplY3RzTiA9IDA7CiAgICBHYW1lLkJ1aWxkaW5nc093bmVkID0gMDsKICAgIEdhbWUuT2JqZWN0ID0gZnVuY3Rpb24gKAogICAgICBuYW1lLAogICAgICBjb21tb25OYW1lLAogICAgICBkZXNjLAogICAgICBpY29uLAogICAgICBpY29uQ29sdW1uLAogICAgICBhcnQsCiAgICAgIHByaWNlLAogICAgICBjcHMsCiAgICAgIGJ1eUZ1bmN0aW9uCiAgICApIHsKICAgICAgdGhpcy5pZCA9IEdhbWUuT2JqZWN0c047CiAgICAgIHRoaXMubmFtZSA9IG5hbWU7CiAgICAgIHRoaXMuZG5hbWUgPSBuYW1lOwogICAgICB0aGlzLmRpc3BsYXlOYW1lID0gdGhpcy5uYW1lOwogICAgICBjb21tb25OYW1lID0gY29tbW9uTmFtZS5zcGxpdCgifCIpOwogICAgICB0aGlzLnNpbmdsZSA9IGNvbW1vbk5hbWVbMF07CiAgICAgIHRoaXMucGx1cmFsID0gY29tbW9uTmFtZVsxXTsKICAgICAgdGhpcy5ic2luZ2xlID0gdGhpcy5zaW5nbGU7CiAgICAgIHRoaXMuYnBsdXJhbCA9IHRoaXMucGx1cmFsOyAvL3N0b3JlIHVudHJhbnNsYXRlZCBhcyB3ZSB1c2UgdGhvc2UgdG9vCiAgICAgIHRoaXMuYWN0aW9uTmFtZSA9IGNvbW1vbk5hbWVbMl07CiAgICAgIHRoaXMuZXh0cmFOYW1lID0gY29tbW9uTmFtZVszXTsKICAgICAgdGhpcy5leHRyYVBsdXJhbCA9IGNvbW1vbk5hbWVbNF07CiAgICAgIHRoaXMuZGVzYyA9IGRlc2M7CiAgICAgIGlmICh0cnVlKSB7CiAgICAgICAgLy9pZiAoRU4pCiAgICAgICAgdGhpcy5kbmFtZSA9IGxvYyh0aGlzLm5hbWUpOwogICAgICAgIHRoaXMuc2luZ2xlID0gbG9jKHRoaXMuc2luZ2xlKTsKICAgICAgICB0aGlzLnBsdXJhbCA9IGxvYyh0aGlzLnBsdXJhbCk7CiAgICAgICAgdGhpcy5kZXNjID0gbG9jKEZpbmRMb2NTdHJpbmdCeVBhcnQodGhpcy5uYW1lICsgIiBxdW90ZSIpKTsKICAgICAgfQogICAgICB0aGlzLmJhc2VQcmljZSA9IHByaWNlOwogICAgICB0aGlzLnByaWNlID0gdGhpcy5iYXNlUHJpY2U7CiAgICAgIHRoaXMuYnVsa1ByaWNlID0gdGhpcy5wcmljZTsKICAgICAgdGhpcy5jcHMgPSBjcHM7CiAgICAgIHRoaXMuYmFzZUNwcyA9IHRoaXMuY3BzOwogICAgICB0aGlzLm1vdXNlT24gPSBmYWxzZTsKICAgICAgdGhpcy5tb3VzZVBvcyA9IFstMTAwLCAtMTAwXTsKICAgICAgdGhpcy5wcm9kdWN0aW9uQWNoaWV2cyA9IFtdOwoKICAgICAgdGhpcy5uID0gdGhpcy5pZDsKICAgICAgaWYgKHRoaXMubiAhPSAwKSB7CiAgICAgICAgLy9uZXcgYXV0b21hdGVkIHByaWNlIGFuZCBDcFMgY3VydmVzCiAgICAgICAgLy90aGlzLmJhc2VDcHM9TWF0aC5jZWlsKCgodGhpcy5uKjAuNSkqTWF0aC5wb3codGhpcy5uKjEsdGhpcy5uKjAuOSkpKjEwKS8xMDsKICAgICAgICAvL3RoaXMuYmFzZUNwcz1NYXRoLmNlaWwoKE1hdGgucG93KHRoaXMubioxLHRoaXMubiowLjUrMi4zNSkpKjEwKS8xMDsvL2J5IGEgZm9ydHVuYXRlIGNvaW5jaWRlbmNlLCB0aGlzIGdpdmVzIHRoZSAzcmQsIDR0aCBhbmQgNXRoIGJ1aWxkaW5ncyBhIENwUyBvZiAxMCwgNjkgYW5kIDQyMAogICAgICAgIHRoaXMuYmFzZUNwcyA9CiAgICAgICAgICBNYXRoLmNlaWwoTWF0aC5wb3codGhpcy5uICogMSwgdGhpcy5uICogMC41ICsgMikgKiAxMCkgLyAxMDsgLy8wLjQ1IHVzZWQgdG8gYmUgMC41CiAgICAgICAgLy90aGlzLmJhc2VDcHM9TWF0aC5jZWlsKChNYXRoLnBvdyh0aGlzLm4qMSx0aGlzLm4qMC40NSsyLjEwKSkqMTApLzEwOwogICAgICAgIC8vY2xhbXAgMTQsNDY3LDE5OSB0byAxNCwwMDAsMDAwICh0aGVyZSdzIHByb2JhYmx5IGEgbW9yZSBlbGVnYW50IHdheSB0byBkbyB0aGF0KQogICAgICAgIHZhciBkaWdpdHMgPQogICAgICAgICAgTWF0aC5wb3coCiAgICAgICAgICAgIDEwLAogICAgICAgICAgICBNYXRoLmNlaWwoTWF0aC5sb2coTWF0aC5jZWlsKHRoaXMuYmFzZUNwcykpIC8gTWF0aC5MTjEwKQogICAgICAgICAgKSAvIDEwMDsKICAgICAgICB0aGlzLmJhc2VDcHMgPSBNYXRoLnJvdW5kKHRoaXMuYmFzZUNwcyAvIGRpZ2l0cykgKiBkaWdpdHM7CgogICAgICAgIHRoaXMuYmFzZVByaWNlID0KICAgICAgICAgICh0aGlzLm4gKiAxICsgOSArICh0aGlzLm4gPCA1ID8gMCA6IE1hdGgucG93KHRoaXMubiAtIDUsIDEuNzUpICogNSkpICoKICAgICAgICAgIE1hdGgucG93KDEwLCB0aGlzLm4pICoKICAgICAgICAgIE1hdGgubWF4KDEsIHRoaXMubiAtIDE0KTsKICAgICAgICAvL3RoaXMuYmFzZVByaWNlPSh0aGlzLm4qMi41KzcuNSkqTWF0aC5wb3coMTAsdGhpcy5uKTsKICAgICAgICB2YXIgZGlnaXRzID0KICAgICAgICAgIE1hdGgucG93KAogICAgICAgICAgICAxMCwKICAgICAgICAgICAgTWF0aC5jZWlsKE1hdGgubG9nKE1hdGguY2VpbCh0aGlzLmJhc2VQcmljZSkpIC8gTWF0aC5MTjEwKQogICAgICAgICAgKSAvIDEwMDsKICAgICAgICB0aGlzLmJhc2VQcmljZSA9IE1hdGgucm91bmQodGhpcy5iYXNlUHJpY2UgLyBkaWdpdHMpICogZGlnaXRzOwogICAgICAgIGlmICh0aGlzLmlkID49IDE2KSB0aGlzLmJhc2VQcmljZSAqPSAxMDsKICAgICAgICBpZiAodGhpcy5pZCA+PSAxNykgdGhpcy5iYXNlUHJpY2UgKj0gMTA7CiAgICAgICAgaWYgKHRoaXMuaWQgPj0gMTgpIHRoaXMuYmFzZVByaWNlICo9IDEwOwogICAgICAgIGlmICh0aGlzLmlkID49IDE5KSB0aGlzLmJhc2VQcmljZSAqPSAxMDsKICAgICAgICB0aGlzLnByaWNlID0gdGhpcy5iYXNlUHJpY2U7CiAgICAgICAgdGhpcy5idWxrUHJpY2UgPSB0aGlzLnByaWNlOwogICAgICB9CgogICAgICB0aGlzLnRvdGFsQ29va2llcyA9IDA7CiAgICAgIHRoaXMuc3RvcmVkQ3BzID0gMDsKICAgICAgdGhpcy5zdG9yZWRUb3RhbENwcyA9IDA7CiAgICAgIHRoaXMuaWNvbiA9IGljb247CiAgICAgIHRoaXMuaWNvbkNvbHVtbiA9IGljb25Db2x1bW47CiAgICAgIHRoaXMuYXJ0ID0gYXJ0OwogICAgICBpZiAoYXJ0LmJhc2UpIHsKICAgICAgICBhcnQucGljID0gYXJ0LmJhc2UgKyAiLnBuZyI7CiAgICAgICAgYXJ0LmJnID0gYXJ0LmJhc2UgKyAiQmFja2dyb3VuZC5wbmciOwogICAgICB9CiAgICAgIHRoaXMuYnV5RnVuY3Rpb24gPSBidXlGdW5jdGlvbjsKICAgICAgdGhpcy5sb2NrZWQgPSAxOwogICAgICB0aGlzLmxldmVsID0gMDsKICAgICAgdGhpcy52YW5pbGxhID0gR2FtZS52YW5pbGxhOwoKICAgICAgdGhpcy50aWVyZWRVcGdyYWRlcyA9IHt9OwogICAgICB0aGlzLnRpZXJlZEFjaGlldnMgPSB7fTsKICAgICAgdGhpcy5zeW5lcmdpZXMgPSBbXTsKICAgICAgdGhpcy5mb3J0dW5lID0gMDsKCiAgICAgIHRoaXMuYW1vdW50ID0gMDsKICAgICAgdGhpcy5ib3VnaHQgPSAwOwogICAgICB0aGlzLmhpZ2hlc3QgPSAwOwogICAgICB0aGlzLmZyZWUgPSAwOwoKICAgICAgdGhpcy5lYWNoRnJhbWUgPSAwOwoKICAgICAgdGhpcy5taW5pZ2FtZVVybCA9IDA7IC8vaWYgdGhpcyBpcyBkZWZpbmVkLCBsb2FkIHRoZSBzcGVjaWZpZWQgc2NyaXB0IGlmIHRoZSBidWlsZGluZydzIGxldmVsIGlzIGF0IGxlYXN0IDEKICAgICAgdGhpcy5taW5pZ2FtZU5hbWUgPSAwOwogICAgICB0aGlzLm9uTWluaWdhbWUgPSBmYWxzZTsKICAgICAgdGhpcy5taW5pZ2FtZUxvYWRlZCA9IGZhbHNlOwoKICAgICAgdGhpcy5zd2l0Y2hNaW5pZ2FtZSA9IGZ1bmN0aW9uICgKICAgICAgICBvbiAvL2NoYW5nZSB3aGV0aGVyIHdlJ3JlIG9uIHRoZSBidWlsZGluZydzIG1pbmlnYW1lCiAgICAgICkgewogICAgICAgIGlmICghR2FtZS5pc01pbmlnYW1lUmVhZHkodGhpcykpIG9uID0gZmFsc2U7CiAgICAgICAgaWYgKG9uID09IC0xKSBvbiA9ICF0aGlzLm9uTWluaWdhbWU7CiAgICAgICAgdGhpcy5vbk1pbmlnYW1lID0gb247CiAgICAgICAgaWYgKHRoaXMuaWQgIT0gMCkgewogICAgICAgICAgaWYgKHRoaXMub25NaW5pZ2FtZSkgewogICAgICAgICAgICBsKCJyb3ciICsgdGhpcy5pZCkuY2xhc3NMaXN0LmFkZCgib25NaW5pZ2FtZSIpOwogICAgICAgICAgICAvL2woJ3Jvd1NwZWNpYWwnK3RoaXMuaWQpLnN0eWxlLmRpc3BsYXk9J2Jsb2NrJzsKICAgICAgICAgICAgLy9sKCdyb3dDYW52YXMnK3RoaXMuaWQpLnN0eWxlLmRpc3BsYXk9J25vbmUnOwogICAgICAgICAgICBpZiAodGhpcy5taW5pZ2FtZS5vblJlc2l6ZSkgdGhpcy5taW5pZ2FtZS5vblJlc2l6ZSgpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbCgicm93IiArIHRoaXMuaWQpLmNsYXNzTGlzdC5yZW1vdmUoIm9uTWluaWdhbWUiKTsKICAgICAgICAgICAgLy9sKCdyb3dTcGVjaWFsJyt0aGlzLmlkKS5zdHlsZS5kaXNwbGF5PSdub25lJzsKICAgICAgICAgICAgLy9sKCdyb3dDYW52YXMnK3RoaXMuaWQpLnN0eWxlLmRpc3BsYXk9J2Jsb2NrJzsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdGhpcy5yZWZyZXNoKCk7CiAgICAgIH07CgogICAgICB0aGlzLmdldFByaWNlID0gZnVuY3Rpb24gKG4pIHsKICAgICAgICB2YXIgcHJpY2UgPQogICAgICAgICAgdGhpcy5iYXNlUHJpY2UgKgogICAgICAgICAgTWF0aC5wb3coR2FtZS5wcmljZUluY3JlYXNlLCBNYXRoLm1heCgwLCB0aGlzLmFtb3VudCAtIHRoaXMuZnJlZSkpOwogICAgICAgIHByaWNlID0gR2FtZS5tb2RpZnlCdWlsZGluZ1ByaWNlKHRoaXMsIHByaWNlKTsKICAgICAgICByZXR1cm4gTWF0aC5jZWlsKHByaWNlKTsKICAgICAgfTsKICAgICAgdGhpcy5nZXRTdW1QcmljZSA9IGZ1bmN0aW9uICgKICAgICAgICBhbW91bnQgLy9yZXR1cm4gaG93IG11Y2ggaXQgd291bGQgY29zdCB0byBidXkgW2Ftb3VudF0gbW9yZSBvZiB0aGlzIGJ1aWxkaW5nCiAgICAgICkgewogICAgICAgIHZhciBwcmljZSA9IDA7CiAgICAgICAgZm9yICgKICAgICAgICAgIHZhciBpID0gTWF0aC5tYXgoMCwgdGhpcy5hbW91bnQpOwogICAgICAgICAgaSA8IE1hdGgubWF4KDAsIHRoaXMuYW1vdW50ICsgYW1vdW50KTsKICAgICAgICAgIGkrKwogICAgICAgICkgewogICAgICAgICAgcHJpY2UgKz0KICAgICAgICAgICAgdGhpcy5iYXNlUHJpY2UgKgogICAgICAgICAgICBNYXRoLnBvdyhHYW1lLnByaWNlSW5jcmVhc2UsIE1hdGgubWF4KDAsIGkgLSB0aGlzLmZyZWUpKTsKICAgICAgICB9CiAgICAgICAgcHJpY2UgPSBHYW1lLm1vZGlmeUJ1aWxkaW5nUHJpY2UodGhpcywgcHJpY2UpOwogICAgICAgIHJldHVybiBNYXRoLmNlaWwocHJpY2UpOwogICAgICB9OwogICAgICB0aGlzLmdldFJldmVyc2VTdW1QcmljZSA9IGZ1bmN0aW9uICgKICAgICAgICBhbW91bnQgLy9yZXR1cm4gaG93IG11Y2ggeW91J2QgZ2V0IGZyb20gc2VsbGluZyBbYW1vdW50XSBvZiB0aGlzIGJ1aWxkaW5nCiAgICAgICkgewogICAgICAgIHZhciBwcmljZSA9IDA7CiAgICAgICAgZm9yICgKICAgICAgICAgIHZhciBpID0gTWF0aC5tYXgoMCwgdGhpcy5hbW91bnQgLSBhbW91bnQpOwogICAgICAgICAgaSA8IE1hdGgubWF4KDAsIHRoaXMuYW1vdW50KTsKICAgICAgICAgIGkrKwogICAgICAgICkgewogICAgICAgICAgcHJpY2UgKz0KICAgICAgICAgICAgdGhpcy5iYXNlUHJpY2UgKgogICAgICAgICAgICBNYXRoLnBvdyhHYW1lLnByaWNlSW5jcmVhc2UsIE1hdGgubWF4KDAsIGkgLSB0aGlzLmZyZWUpKTsKICAgICAgICB9CiAgICAgICAgcHJpY2UgPSBHYW1lLm1vZGlmeUJ1aWxkaW5nUHJpY2UodGhpcywgcHJpY2UpOwogICAgICAgIHByaWNlICo9IHRoaXMuZ2V0U2VsbE11bHRpcGxpZXIoKTsKICAgICAgICByZXR1cm4gTWF0aC5jZWlsKHByaWNlKTsKICAgICAgfTsKICAgICAgdGhpcy5nZXRTZWxsTXVsdGlwbGllciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgZ2l2ZUJhY2sgPSAwLjI1OwogICAgICAgIC8vaWYgKEdhbWUuaGFzQXVyYSgnRWFydGggU2hhdHRlcmVyJykpIGdpdmVCYWNrPTAuNTsKICAgICAgICBnaXZlQmFjayAqPSAxICsgR2FtZS5hdXJhTXVsdCgiRWFydGggU2hhdHRlcmVyIik7CiAgICAgICAgcmV0dXJuIGdpdmVCYWNrOwogICAgICB9OwoKICAgICAgdGhpcy5idXkgPSBmdW5jdGlvbiAoYW1vdW50KSB7CiAgICAgICAgaWYgKEdhbWUuYnV5TW9kZSA9PSAtMSkgewogICAgICAgICAgdGhpcy5zZWxsKEdhbWUuYnV5QnVsaywgMSk7CiAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CiAgICAgICAgdmFyIHN1Y2Nlc3MgPSAwOwogICAgICAgIHZhciBtb25pID0gMDsKICAgICAgICB2YXIgYm91Z2h0ID0gMDsKICAgICAgICBpZiAoIWFtb3VudCkgYW1vdW50ID0gR2FtZS5idXlCdWxrOwogICAgICAgIGlmIChhbW91bnQgPT0gLTEpIGFtb3VudCA9IDEwMDA7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhbW91bnQ7IGkrKykgewogICAgICAgICAgdmFyIHByaWNlID0gdGhpcy5nZXRQcmljZSgpOwogICAgICAgICAgaWYgKEdhbWUuY29va2llcyA+PSBwcmljZSkgewogICAgICAgICAgICBib3VnaHQrKzsKICAgICAgICAgICAgbW9uaSArPSBwcmljZTsKICAgICAgICAgICAgR2FtZS5TcGVuZChwcmljZSk7CiAgICAgICAgICAgIHRoaXMuYW1vdW50Kys7CiAgICAgICAgICAgIHRoaXMuYm91Z2h0Kys7CiAgICAgICAgICAgIHByaWNlID0gdGhpcy5nZXRQcmljZSgpOwogICAgICAgICAgICB0aGlzLnByaWNlID0gcHJpY2U7CiAgICAgICAgICAgIGlmICh0aGlzLmJ1eUZ1bmN0aW9uKSB0aGlzLmJ1eUZ1bmN0aW9uKCk7CiAgICAgICAgICAgIEdhbWUucmVjYWxjdWxhdGVHYWlucyA9IDE7CiAgICAgICAgICAgIGlmICh0aGlzLmFtb3VudCA9PSAxICYmIHRoaXMuaWQgIT0gMCkKICAgICAgICAgICAgICBsKCJyb3ciICsgdGhpcy5pZCkuY2xhc3NMaXN0LmFkZCgiZW5hYmxlZCIpOwogICAgICAgICAgICB0aGlzLmhpZ2hlc3QgPSBNYXRoLm1heCh0aGlzLmhpZ2hlc3QsIHRoaXMuYW1vdW50KTsKICAgICAgICAgICAgR2FtZS5CdWlsZGluZ3NPd25lZCsrOwogICAgICAgICAgICBzdWNjZXNzID0gMTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKHN1Y2Nlc3MpIHsKICAgICAgICAgIFBsYXlTb3VuZCgic25kL2J1eSIgKyBjaG9vc2UoWzEsIDIsIDMsIDRdKSArICIubXAzIiwgMC43NSk7CiAgICAgICAgICB0aGlzLnJlZnJlc2goKTsKICAgICAgICB9CiAgICAgICAgLy9pZiAobW9uaT4wICYmIGFtb3VudD4xKSBHYW1lLk5vdGlmeSh0aGlzLm5hbWUsJ0JvdWdodCA8Yj4nK2JvdWdodCsnPC9iPiBmb3IgJytCZWF1dGlmeShtb25pKSsnIGNvb2tpZXMnLCcnLDIpOwogICAgICB9OwogICAgICB0aGlzLnNlbGwgPSBmdW5jdGlvbiAoYW1vdW50LCBieXBhc3MpIHsKICAgICAgICB2YXIgc3VjY2VzcyA9IDA7CiAgICAgICAgdmFyIG1vbmkgPSAwOwogICAgICAgIHZhciBzb2xkID0gMDsKICAgICAgICBpZiAoYW1vdW50ID09IC0xKSBhbW91bnQgPSB0aGlzLmFtb3VudDsKICAgICAgICBpZiAoIWFtb3VudCkgYW1vdW50ID0gR2FtZS5idXlCdWxrOwogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYW1vdW50OyBpKyspIHsKICAgICAgICAgIHZhciBwcmljZSA9IHRoaXMuZ2V0UHJpY2UoKTsKICAgICAgICAgIHZhciBnaXZlQmFjayA9IHRoaXMuZ2V0U2VsbE11bHRpcGxpZXIoKTsKICAgICAgICAgIHByaWNlID0gTWF0aC5mbG9vcihwcmljZSAqIGdpdmVCYWNrKTsKICAgICAgICAgIGlmICh0aGlzLmFtb3VudCA+IDApIHsKICAgICAgICAgICAgc29sZCsrOwogICAgICAgICAgICBtb25pICs9IHByaWNlOwogICAgICAgICAgICBHYW1lLmNvb2tpZXMgKz0gcHJpY2U7CiAgICAgICAgICAgIEdhbWUuY29va2llc0Vhcm5lZCA9IE1hdGgubWF4KEdhbWUuY29va2llcywgR2FtZS5jb29raWVzRWFybmVkKTsgLy90aGlzIGlzIHRvIGF2b2lkIHBsYXllcnMgZ2V0dGluZyB0aGUgY2hlYXRlciBhY2hpZXZlbWVudCB3aGVuIHNlbGxpbmcgYnVpbGRpbmdzIHRoYXQgaGF2ZSBhIGhpZ2hlciBwcmljZSB0aGFuIHRoZXkgdXNlZCB0bwogICAgICAgICAgICB0aGlzLmFtb3VudC0tOwogICAgICAgICAgICBwcmljZSA9IHRoaXMuZ2V0UHJpY2UoKTsKICAgICAgICAgICAgdGhpcy5wcmljZSA9IHByaWNlOwogICAgICAgICAgICBpZiAodGhpcy5zZWxsRnVuY3Rpb24pIHRoaXMuc2VsbEZ1bmN0aW9uKCk7CiAgICAgICAgICAgIEdhbWUucmVjYWxjdWxhdGVHYWlucyA9IDE7CiAgICAgICAgICAgIGlmICh0aGlzLmFtb3VudCA9PSAwICYmIHRoaXMuaWQgIT0gMCkKICAgICAgICAgICAgICBsKCJyb3ciICsgdGhpcy5pZCkuY2xhc3NMaXN0LnJlbW92ZSgiZW5hYmxlZCIpOwogICAgICAgICAgICBHYW1lLkJ1aWxkaW5nc093bmVkLS07CiAgICAgICAgICAgIHN1Y2Nlc3MgPSAxOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoc3VjY2VzcyAmJiBHYW1lLmhhc0dvZCkgewogICAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJydWluIik7CiAgICAgICAgICB2YXIgb2xkID0gR2FtZS5oYXNCdWZmKCJEZXZhc3RhdGlvbiIpOwogICAgICAgICAgaWYgKG9sZCkgewogICAgICAgICAgICBpZiAoZ29kTHZsID09IDEpIG9sZC5tdWx0Q2xpY2sgKz0gc29sZCAqIDAuMDE7CiAgICAgICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAyKSBvbGQubXVsdENsaWNrICs9IHNvbGQgKiAwLjAwNTsKICAgICAgICAgICAgZWxzZSBpZiAoZ29kTHZsID09IDMpIG9sZC5tdWx0Q2xpY2sgKz0gc29sZCAqIDAuMDAyNTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmIChnb2RMdmwgPT0gMSkgR2FtZS5nYWluQnVmZigiZGV2YXN0YXRpb24iLCAxMCwgMSArIHNvbGQgKiAwLjAxKTsKICAgICAgICAgICAgZWxzZSBpZiAoZ29kTHZsID09IDIpCiAgICAgICAgICAgICAgR2FtZS5nYWluQnVmZigiZGV2YXN0YXRpb24iLCAxMCwgMSArIHNvbGQgKiAwLjAwNSk7CiAgICAgICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAzKQogICAgICAgICAgICAgIEdhbWUuZ2FpbkJ1ZmYoImRldmFzdGF0aW9uIiwgMTAsIDEgKyBzb2xkICogMC4wMDI1KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKAogICAgICAgICAgc3VjY2VzcyAmJgogICAgICAgICAgR2FtZS5zaGltbWVyVHlwZXNbImdvbGRlbiJdLm4gPD0gMCAmJgogICAgICAgICAgR2FtZS5hdXJhTXVsdCgiRHJhZ29uIE9yYnMiKSA+IDAKICAgICAgICApIHsKICAgICAgICAgIHZhciBoaWdoZXN0QnVpbGRpbmcgPSAwOwogICAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1tpXS5hbW91bnQgPiAwKSBoaWdoZXN0QnVpbGRpbmcgPSBHYW1lLk9iamVjdHNbaV07CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIGhpZ2hlc3RCdWlsZGluZyA9PSB0aGlzICYmCiAgICAgICAgICAgIE1hdGgucmFuZG9tKCkgPCBHYW1lLmF1cmFNdWx0KCJEcmFnb24gT3JicyIpICogMC4xCiAgICAgICAgICApIHsKICAgICAgICAgICAgdmFyIGJ1ZmZzTiA9IDA7CiAgICAgICAgICAgIGZvciAodmFyIGlpIGluIEdhbWUuYnVmZnMpIHsKICAgICAgICAgICAgICBidWZmc04rKzsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoYnVmZnNOID09IDApIHsKICAgICAgICAgICAgICBuZXcgR2FtZS5zaGltbWVyKCJnb2xkZW4iKTsKICAgICAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgICAgIEVOID8gIkRyYWdvbiBPcmJzISIgOiBsb2MoIkRyYWdvbiBPcmJzIiksCiAgICAgICAgICAgICAgICBsb2MoIldpc2ggZ3JhbnRlZC4gR29sZGVuIGNvb2tpZSBzcGF3bmVkLiIpLAogICAgICAgICAgICAgICAgWzMzLCAyNV0KICAgICAgICAgICAgICApOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChzdWNjZXNzKSB7CiAgICAgICAgICBQbGF5U291bmQoInNuZC9zZWxsIiArIGNob29zZShbMSwgMiwgMywgNF0pICsgIi5tcDMiLCAwLjc1KTsKICAgICAgICAgIHRoaXMucmVmcmVzaCgpOwogICAgICAgIH0KICAgICAgICAvL2lmIChtb25pPjApIEdhbWUuTm90aWZ5KHRoaXMubmFtZSwnU29sZCA8Yj4nK3NvbGQrJzwvYj4gZm9yICcrQmVhdXRpZnkobW9uaSkrJyBjb29raWVzJywnJywyKTsKICAgICAgfTsKICAgICAgdGhpcy5zYWNyaWZpY2UgPSBmdW5jdGlvbiAoCiAgICAgICAgYW1vdW50IC8vc2VsbCB3aXRob3V0IGdldHRpbmcgYmFjayBhbnkgbW9uZXkKICAgICAgKSB7CiAgICAgICAgdmFyIHN1Y2Nlc3MgPSAwOwogICAgICAgIC8vdmFyIG1vbmk9MDsKICAgICAgICB2YXIgc29sZCA9IDA7CiAgICAgICAgaWYgKGFtb3VudCA9PSAtMSkgYW1vdW50ID0gdGhpcy5hbW91bnQ7CiAgICAgICAgaWYgKCFhbW91bnQpIGFtb3VudCA9IDE7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhbW91bnQ7IGkrKykgewogICAgICAgICAgdmFyIHByaWNlID0gdGhpcy5nZXRQcmljZSgpOwogICAgICAgICAgcHJpY2UgPSBNYXRoLmZsb29yKHByaWNlICogMC41KTsKICAgICAgICAgIGlmICh0aGlzLmFtb3VudCA+IDApIHsKICAgICAgICAgICAgc29sZCsrOwogICAgICAgICAgICAvL21vbmkrPXByaWNlOwogICAgICAgICAgICAvL0dhbWUuY29va2llcys9cHJpY2U7CiAgICAgICAgICAgIC8vR2FtZS5jb29raWVzRWFybmVkPU1hdGgubWF4KEdhbWUuY29va2llcyxHYW1lLmNvb2tpZXNFYXJuZWQpOwogICAgICAgICAgICB0aGlzLmFtb3VudC0tOwogICAgICAgICAgICBwcmljZSA9IHRoaXMuZ2V0UHJpY2UoKTsKICAgICAgICAgICAgdGhpcy5wcmljZSA9IHByaWNlOwogICAgICAgICAgICBpZiAodGhpcy5zZWxsRnVuY3Rpb24pIHRoaXMuc2VsbEZ1bmN0aW9uKCk7CiAgICAgICAgICAgIEdhbWUucmVjYWxjdWxhdGVHYWlucyA9IDE7CiAgICAgICAgICAgIGlmICh0aGlzLmFtb3VudCA9PSAwICYmIHRoaXMuaWQgIT0gMCkKICAgICAgICAgICAgICBsKCJyb3ciICsgdGhpcy5pZCkuY2xhc3NMaXN0LnJlbW92ZSgiZW5hYmxlZCIpOwogICAgICAgICAgICBHYW1lLkJ1aWxkaW5nc093bmVkLS07CiAgICAgICAgICAgIHN1Y2Nlc3MgPSAxOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoc3VjY2VzcykgewogICAgICAgICAgdGhpcy5yZWZyZXNoKCk7CiAgICAgICAgfQogICAgICAgIC8vaWYgKG1vbmk+MCkgR2FtZS5Ob3RpZnkodGhpcy5uYW1lLCdTb2xkIDxiPicrc29sZCsnPC9iPiBmb3IgJytCZWF1dGlmeShtb25pKSsnIGNvb2tpZXMnLCcnLDIpOwogICAgICB9OwogICAgICB0aGlzLmJ1eUZyZWUgPSBmdW5jdGlvbiAoCiAgICAgICAgYW1vdW50IC8vdW5saWtlIGdldEZyZWUsIHRoaXMgc3RpbGwgaW5jcmVhc2VzIHRoZSBwcmljZQogICAgICApIHsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFtb3VudDsgaSsrKSB7CiAgICAgICAgICBpZiAoR2FtZS5jb29raWVzID49IHByaWNlKSB7CiAgICAgICAgICAgIHRoaXMuYW1vdW50Kys7CiAgICAgICAgICAgIHRoaXMuYm91Z2h0Kys7CiAgICAgICAgICAgIHRoaXMucHJpY2UgPSB0aGlzLmdldFByaWNlKCk7CiAgICAgICAgICAgIEdhbWUucmVjYWxjdWxhdGVHYWlucyA9IDE7CiAgICAgICAgICAgIGlmICh0aGlzLmFtb3VudCA9PSAxICYmIHRoaXMuaWQgIT0gMCkKICAgICAgICAgICAgICBsKCJyb3ciICsgdGhpcy5pZCkuY2xhc3NMaXN0LmFkZCgiZW5hYmxlZCIpOwogICAgICAgICAgICB0aGlzLmhpZ2hlc3QgPSBNYXRoLm1heCh0aGlzLmhpZ2hlc3QsIHRoaXMuYW1vdW50KTsKICAgICAgICAgICAgR2FtZS5CdWlsZGluZ3NPd25lZCsrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0aGlzLnJlZnJlc2goKTsKICAgICAgfTsKICAgICAgdGhpcy5nZXRGcmVlID0gZnVuY3Rpb24gKAogICAgICAgIGFtb3VudCAvL2dldCBYIG9mIHRoaXMgYnVpbGRpbmcgZm9yIGZyZWUsIHdpdGggdGhlIHByaWNlIGJlaGF2aW5nIGFzIGlmIHlvdSBzdGlsbCBkaWRuJ3QgaGF2ZSB0aGVtCiAgICAgICkgewogICAgICAgIHRoaXMuYW1vdW50ICs9IGFtb3VudDsKICAgICAgICB0aGlzLmJvdWdodCArPSBhbW91bnQ7CiAgICAgICAgdGhpcy5mcmVlICs9IGFtb3VudDsKICAgICAgICB0aGlzLmhpZ2hlc3QgPSBNYXRoLm1heCh0aGlzLmhpZ2hlc3QsIHRoaXMuYW1vdW50KTsKICAgICAgICBHYW1lLkJ1aWxkaW5nc093bmVkICs9IGFtb3VudDsKICAgICAgICB0aGlzLmhpZ2hlc3QgPSBNYXRoLm1heCh0aGlzLmhpZ2hlc3QsIHRoaXMuYW1vdW50KTsKICAgICAgICB0aGlzLnJlZnJlc2goKTsKICAgICAgfTsKICAgICAgdGhpcy5nZXRGcmVlUmFua3MgPSBmdW5jdGlvbiAoCiAgICAgICAgYW1vdW50IC8vdGhpcyBidWlsZGluZydzIHByaWNlIGJlaGF2ZXMgYXMgaWYgeW91IGhhZCBYIGxlc3Mgb2YgaXQKICAgICAgKSB7CiAgICAgICAgdGhpcy5mcmVlICs9IGFtb3VudDsKICAgICAgICB0aGlzLnJlZnJlc2goKTsKICAgICAgfTsKCiAgICAgIHRoaXMudG9vbHRpcCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgbWUgPSB0aGlzOwogICAgICAgIHZhciBhcmlhVGV4dCA9ICIiOwogICAgICAgIHZhciBkZXNjID0gbWUuZGVzYzsKICAgICAgICB2YXIgbmFtZSA9IG1lLmRuYW1lOwogICAgICAgIGlmIChHYW1lLnNlYXNvbiA9PSAiZm9vbHMiKSB7CiAgICAgICAgICBpZiAoIUdhbWUuZm9vbE9iamVjdHNbbWUubmFtZV0pIHsKICAgICAgICAgICAgbmFtZSA9IEdhbWUuZm9vbE9iamVjdHNbIlVua25vd24iXS5uYW1lOwogICAgICAgICAgICBkZXNjID0gR2FtZS5mb29sT2JqZWN0c1siVW5rbm93biJdLmRlc2M7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuYW1lID0gR2FtZS5mb29sT2JqZWN0c1ttZS5uYW1lXS5uYW1lOwogICAgICAgICAgICBkZXNjID0gR2FtZS5mb29sT2JqZWN0c1ttZS5uYW1lXS5kZXNjOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB2YXIgaWNvbiA9IFttZS5pY29uQ29sdW1uLCAwXTsKICAgICAgICBpZiAobWUubG9ja2VkKSB7CiAgICAgICAgICBuYW1lID0gIj8/PyI7CiAgICAgICAgICBkZXNjID0gIj8/PyI7CiAgICAgICAgICBpY29uID0gWzAsIDddOwogICAgICAgIH0KICAgICAgICAvL2lmIChsKCdyb3dJbmZvJyttZS5pZCkgJiYgR2FtZS5kcmF3VCUxMD09MCkgbCgncm93SW5mb0NvbnRlbnQnK21lLmlkKS5pbm5lckhUTUw9JyZidWxsOyAnK21lLmFtb3VudCsnICcrKG1lLmFtb3VudD09MT9tZS5zaW5nbGU6bWUucGx1cmFsKSsnPGJyPiZidWxsOyBwcm9kdWNpbmcgJytCZWF1dGlmeShtZS5zdG9yZWRUb3RhbENwcywxKSsnICcrKG1lLnN0b3JlZFRvdGFsQ3BzPT0xPydjb29raWUnOidjb29raWVzJykrJyBwZXIgc2Vjb25kPGJyPiZidWxsOyB0b3RhbCA6ICcrQmVhdXRpZnkobWUudG90YWxDb29raWVzKSsnICcrKE1hdGguZmxvb3IobWUudG90YWxDb29raWVzKT09MT8nY29va2llJzonY29va2llcycpKycgJyttZS5hY3Rpb25OYW1lOwoKICAgICAgICB2YXIgY2FuQnV5ID0gZmFsc2U7CiAgICAgICAgdmFyIHByaWNlID0gbWUuYnVsa1ByaWNlOwogICAgICAgIGlmICgKICAgICAgICAgIChHYW1lLmJ1eU1vZGUgPT0gMSAmJiBHYW1lLmNvb2tpZXMgPj0gcHJpY2UpIHx8CiAgICAgICAgICAoR2FtZS5idXlNb2RlID09IC0xICYmIG1lLmFtb3VudCA+IDApCiAgICAgICAgKQogICAgICAgICAgY2FuQnV5ID0gdHJ1ZTsKCiAgICAgICAgdmFyIHN5bmVyZ2llc1N0ciA9ICIiOwogICAgICAgIC8vbm90ZSA6IG1pZ2h0IG5vdCBiZSBlbnRpcmVseSBhY2N1cmF0ZSwgbWF0aCBtYXkgbmVlZCBjaGVja2luZwogICAgICAgIGlmIChtZS5hbW91bnQgPiAwKSB7CiAgICAgICAgICB2YXIgc3luZXJnaWVzV2l0aCA9IHt9OwogICAgICAgICAgdmFyIHN5bmVyZ3lCb29zdCA9IDA7CgogICAgICAgICAgaWYgKG1lLm5hbWUgPT0gIkdyYW5kbWEiKSB7CiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5HcmFuZG1hU3luZXJnaWVzKSB7CiAgICAgICAgICAgICAgaWYgKEdhbWUuSGFzKEdhbWUuR3JhbmRtYVN5bmVyZ2llc1tpXSkpIHsKICAgICAgICAgICAgICAgIHZhciBvdGhlciA9IEdhbWUuVXBncmFkZXNbR2FtZS5HcmFuZG1hU3luZXJnaWVzW2ldXS5idWlsZGluZ1RpZTsKICAgICAgICAgICAgICAgIHZhciBtdWx0ID0gbWUuYW1vdW50ICogMC4wMSAqICgxIC8gKG90aGVyLmlkIC0gMSkpOwogICAgICAgICAgICAgICAgdmFyIGJvb3N0ID0KICAgICAgICAgICAgICAgICAgb3RoZXIuc3RvcmVkVG90YWxDcHMgKiBHYW1lLmdsb2JhbENwc011bHQgLQogICAgICAgICAgICAgICAgICAob3RoZXIuc3RvcmVkVG90YWxDcHMgKiBHYW1lLmdsb2JhbENwc011bHQpIC8gKDEgKyBtdWx0KTsKICAgICAgICAgICAgICAgIHN5bmVyZ3lCb29zdCArPSBib29zdDsKICAgICAgICAgICAgICAgIGlmICghc3luZXJnaWVzV2l0aFtvdGhlci5wbHVyYWxdKQogICAgICAgICAgICAgICAgICBzeW5lcmdpZXNXaXRoW290aGVyLnBsdXJhbF0gPSAwOwogICAgICAgICAgICAgICAgc3luZXJnaWVzV2l0aFtvdGhlci5wbHVyYWxdICs9IG11bHQ7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKG1lLm5hbWUgPT0gIlBvcnRhbCIgJiYgR2FtZS5IYXMoIkVsZGVyIFBhY3QiKSkgewogICAgICAgICAgICB2YXIgb3RoZXIgPSBHYW1lLk9iamVjdHNbIkdyYW5kbWEiXTsKICAgICAgICAgICAgdmFyIGJvb3N0ID0gbWUuYW1vdW50ICogMC4wNSAqIG90aGVyLmFtb3VudCAqIEdhbWUuZ2xvYmFsQ3BzTXVsdDsKICAgICAgICAgICAgc3luZXJneUJvb3N0ICs9IGJvb3N0OwogICAgICAgICAgICBpZiAoIXN5bmVyZ2llc1dpdGhbb3RoZXIucGx1cmFsXSkgc3luZXJnaWVzV2l0aFtvdGhlci5wbHVyYWxdID0gMDsKICAgICAgICAgICAgc3luZXJnaWVzV2l0aFtvdGhlci5wbHVyYWxdICs9CiAgICAgICAgICAgICAgYm9vc3QgLyAob3RoZXIuc3RvcmVkVG90YWxDcHMgKiBHYW1lLmdsb2JhbENwc011bHQpOwogICAgICAgICAgfQoKICAgICAgICAgIGZvciAodmFyIGkgaW4gbWUuc3luZXJnaWVzKSB7CiAgICAgICAgICAgIHZhciBpdCA9IG1lLnN5bmVyZ2llc1tpXTsKICAgICAgICAgICAgaWYgKEdhbWUuSGFzKGl0Lm5hbWUpKSB7CiAgICAgICAgICAgICAgdmFyIHdlaWdodCA9IDAuMDU7CiAgICAgICAgICAgICAgdmFyIG90aGVyID0gaXQuYnVpbGRpbmdUaWUxOwogICAgICAgICAgICAgIGlmIChtZSA9PSBpdC5idWlsZGluZ1RpZTEpIHsKICAgICAgICAgICAgICAgIHdlaWdodCA9IDAuMDAxOwogICAgICAgICAgICAgICAgb3RoZXIgPSBpdC5idWlsZGluZ1RpZTI7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHZhciBib29zdCA9CiAgICAgICAgICAgICAgICBvdGhlci5zdG9yZWRUb3RhbENwcyAqIEdhbWUuZ2xvYmFsQ3BzTXVsdCAtCiAgICAgICAgICAgICAgICAob3RoZXIuc3RvcmVkVG90YWxDcHMgKiBHYW1lLmdsb2JhbENwc011bHQpIC8KICAgICAgICAgICAgICAgICAgKDEgKyBtZS5hbW91bnQgKiB3ZWlnaHQpOwogICAgICAgICAgICAgIHN5bmVyZ3lCb29zdCArPSBib29zdDsKICAgICAgICAgICAgICBpZiAoIXN5bmVyZ2llc1dpdGhbb3RoZXIucGx1cmFsXSkgc3luZXJnaWVzV2l0aFtvdGhlci5wbHVyYWxdID0gMDsKICAgICAgICAgICAgICBzeW5lcmdpZXNXaXRoW290aGVyLnBsdXJhbF0gKz0gbWUuYW1vdW50ICogd2VpZ2h0OwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoc3luZXJneUJvb3N0ID4gMCkgewogICAgICAgICAgICBmb3IgKHZhciBpIGluIHN5bmVyZ2llc1dpdGgpIHsKICAgICAgICAgICAgICBpZiAoc3luZXJnaWVzU3RyICE9ICIiKSBzeW5lcmdpZXNTdHIgKz0gIiwgIjsKICAgICAgICAgICAgICBzeW5lcmdpZXNTdHIgKz0KICAgICAgICAgICAgICAgICc8c3BhbiBzdHlsZT0iY29sb3I6I2ZmZjtmb250LXdlaWdodDpib2xkO2ZvbnQtc2l6ZTo4MCU7YmFja2dyb3VuZDojMDAwO2JveC1zaGFkb3c6MHB4IDBweCAwcHggMXB4IHJnYmEoMjU1LDI1NSwyNTUsMC4yKTtib3JkZXItcmFkaXVzOjNweDtwYWRkaW5nOjBweCAycHg7ZGlzcGxheTppbmxpbmUtYmxvY2s7Ij4nICsKICAgICAgICAgICAgICAgIGkgKwogICAgICAgICAgICAgICAgIiArIiArCiAgICAgICAgICAgICAgICBCZWF1dGlmeShzeW5lcmdpZXNXaXRoW2ldICogMTAwLCAxKSArCiAgICAgICAgICAgICAgICAiJTwvc3Bhbj4iOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHN5bmVyZ2llc1N0ciA9CiAgICAgICAgICAgICAgbG9jKCIuLi5hbHNvIGJvb3N0aW5nIHNvbWUgb3RoZXIgYnVpbGRpbmdzOiIpICsKICAgICAgICAgICAgICAiICIgKwogICAgICAgICAgICAgIHN5bmVyZ2llc1N0ciArCiAgICAgICAgICAgICAgIiAtICIgKwogICAgICAgICAgICAgIGxvYygKICAgICAgICAgICAgICAgICJhbGwgY29tYmluZWQsIHRoZXNlIGJvb3N0cyBhY2NvdW50IGZvciA8Yj4lMTwvYj4gcGVyIHNlY29uZCAoPGI+JTIlPC9iPiBvZiB0b3RhbCBDcFMpIiwKICAgICAgICAgICAgICAgIFsKICAgICAgICAgICAgICAgICAgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoc3luZXJneUJvb3N0LCAxKSksCiAgICAgICAgICAgICAgICAgIEJlYXV0aWZ5KChzeW5lcmd5Qm9vc3QgLyBHYW1lLmNvb2tpZXNQcykgKiAxMDAsIDEpLAogICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoR2FtZS5wcmVmcy5zY3JlZW5yZWFkZXIpIHsKICAgICAgICAgIGlmIChtZS5sb2NrZWQpIGFyaWFUZXh0ID0gIlRoaXMgYnVpbGRpbmcgaXMgbm90IHlldCB1bmxvY2tlZC4gIjsKICAgICAgICAgIGVsc2UgYXJpYVRleHQgPSBuYW1lICsgIi4gIjsKICAgICAgICAgIGlmICghbWUubG9ja2VkKSBhcmlhVGV4dCArPSAiWW91IG93biAiICsgbWUuYW1vdW50ICsgIi4gIjsKICAgICAgICAgIGFyaWFUZXh0ICs9CiAgICAgICAgICAgIChjYW5CdXkgPyAiQ2FuIGJ1eSAxIGZvciIgOiAiQ2Fubm90IGFmZm9yZCB0aGUiKSArCiAgICAgICAgICAgICIgIiArCiAgICAgICAgICAgIEJlYXV0aWZ5KE1hdGgucm91bmQocHJpY2UpKSArCiAgICAgICAgICAgICIgY29va2llcy4gIjsKICAgICAgICAgIGlmICghbWUubG9ja2VkICYmIG1lLnRvdGFsQ29va2llcyA+IDApIHsKICAgICAgICAgICAgYXJpYVRleHQgKz0KICAgICAgICAgICAgICAiRWFjaCAiICsKICAgICAgICAgICAgICBtZS5zaW5nbGUgKwogICAgICAgICAgICAgICIgcHJvZHVjZXMgIiArCiAgICAgICAgICAgICAgQmVhdXRpZnkoCiAgICAgICAgICAgICAgICAobWUuc3RvcmVkVG90YWxDcHMgLyBtZS5hbW91bnQpICogR2FtZS5nbG9iYWxDcHNNdWx0LAogICAgICAgICAgICAgICAgMQogICAgICAgICAgICAgICkgKwogICAgICAgICAgICAgICIgY29va2llcyBwZXIgc2Vjb25kLiAiOwogICAgICAgICAgICBhcmlhVGV4dCArPQogICAgICAgICAgICAgIEJlYXV0aWZ5KG1lLnRvdGFsQ29va2llcykgKwogICAgICAgICAgICAgICIgY29va2llcyAiICsKICAgICAgICAgICAgICBtZS5hY3Rpb25OYW1lICsKICAgICAgICAgICAgICAiIHNvIGZhci4gIjsKICAgICAgICAgIH0KICAgICAgICAgIGlmICghbWUubG9ja2VkKSBhcmlhVGV4dCArPSBkZXNjOwoKICAgICAgICAgIHZhciBhcmlhTGFiZWwgPSBsKCJhcmlhUmVhZGVyLXByb2R1Y3QtIiArIG1lLmlkKTsKICAgICAgICAgIGlmIChhcmlhTGFiZWwpCiAgICAgICAgICAgIGFyaWFMYWJlbC5pbm5lckhUTUwgPSBhcmlhVGV4dC5yZXBsYWNlKC8oPChbXj5dKyk+KS9naSwgIiAiKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiAoCiAgICAgICAgICAnPGRpdiBzdHlsZT0icG9zaXRpb246YWJzb2x1dGU7bGVmdDoxcHg7dG9wOjFweDtyaWdodDoxcHg7Ym90dG9tOjFweDtiYWNrZ3JvdW5kOmxpbmVhci1ncmFkaWVudCgxMjVkZWcsJyArCiAgICAgICAgICAoZmFsc2UKICAgICAgICAgICAgPyAicmdiYSgxNSwxMTUsMTMwLDEpIDAlLHJnYmEoMTUsMTE1LDEzMCwwKSIKICAgICAgICAgICAgOiAicmdiYSg1MCw0MCw0MCwxKSAwJSxyZ2JhKDUwLDQwLDQwLDApIikgKwogICAgICAgICAgJyAyMCUpO21peC1ibGVuZC1tb2RlOnNjcmVlbjt6LWluZGV4OjE7Ij48L2Rpdj48ZGl2IHN0eWxlPSJ6LWluZGV4OjEwO21pbi13aWR0aDozNTBweDtwYWRkaW5nOjhweDtwb3NpdGlvbjpyZWxhdGl2ZTsiIGlkPSJ0b29sdGlwQnVpbGRpbmciPjxkaXYgY2xhc3M9Imljb24iIHN0eWxlPSJmbG9hdDpsZWZ0O21hcmdpbi1sZWZ0Oi04cHg7bWFyZ2luLXRvcDotOHB4OycgKwogICAgICAgICAgd3JpdGVJY29uKGljb24pICsKICAgICAgICAgICciPjwvZGl2PjxkaXYgc3R5bGU9ImZsb2F0OnJpZ2h0O3RleHQtYWxpZ246cmlnaHQ7Ij48c3BhbiBjbGFzcz0icHJpY2UnICsKICAgICAgICAgIChjYW5CdXkgPyAiIiA6ICIgZGlzYWJsZWQiKSArCiAgICAgICAgICAnIj4nICsKICAgICAgICAgIEJlYXV0aWZ5KE1hdGgucm91bmQocHJpY2UpKSArCiAgICAgICAgICAiPC9zcGFuPiIgKwogICAgICAgICAgR2FtZS5jb3N0RGV0YWlscyhwcmljZSkgKwogICAgICAgICAgJzwvZGl2PjxkaXYgY2xhc3M9Im5hbWUiPicgKwogICAgICAgICAgbmFtZSArCiAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAnPHNtYWxsPjxkaXYgY2xhc3M9InRhZyI+JyArCiAgICAgICAgICBsb2MoIm93bmVkOiAlMSIsIG1lLmFtb3VudCkgKwogICAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICAgKG1lLmZyZWUgPiAwCiAgICAgICAgICAgID8gJzxkaXYgY2xhc3M9InRhZyI+JyArIGxvYygiZnJlZTogJTEhIiwgbWUuZnJlZSkgKyAiPC9kaXY+IgogICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAiPC9zbWFsbD4iICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj48ZGl2IGNsYXNzPSJkZXNjcmlwdGlvbiI+PHE+JyArCiAgICAgICAgICBkZXNjICsKICAgICAgICAgICI8L3E+PC9kaXY+IiArCiAgICAgICAgICAobWUudG90YWxDb29raWVzID4gMAogICAgICAgICAgICA/ICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICAgICAgICAobWUuYW1vdW50ID4gMAogICAgICAgICAgICAgICAgPyAnPGRpdiBjbGFzcz0iZGVzY3JpcHRpb25CbG9jayI+JyArCiAgICAgICAgICAgICAgICAgIGxvYygiZWFjaCAlMSBwcm9kdWNlcyA8Yj4lMjwvYj4gcGVyIHNlY29uZCIsIFsKICAgICAgICAgICAgICAgICAgICBtZS5zaW5nbGUsCiAgICAgICAgICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICAgICAgICAgIiUxIGNvb2tpZSIsCiAgICAgICAgICAgICAgICAgICAgICBMQmVhdXRpZnkoCiAgICAgICAgICAgICAgICAgICAgICAgIChtZS5zdG9yZWRUb3RhbENwcyAvIG1lLmFtb3VudCkgKiBHYW1lLmdsb2JhbENwc011bHQsCiAgICAgICAgICAgICAgICAgICAgICAgIDEKICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICI8L2Rpdj4iCiAgICAgICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImRlc2NyaXB0aW9uQmxvY2siPicgKwogICAgICAgICAgICAgIGxvYygiJTEgcHJvZHVjaW5nIDxiPiUyPC9iPiBwZXIgc2Vjb25kIiwgWwogICAgICAgICAgICAgICAgbG9jKCIlMSAiICsgbWUuYnNpbmdsZSwgTEJlYXV0aWZ5KG1lLmFtb3VudCkpLAogICAgICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICAgICAiJTEgY29va2llIiwKICAgICAgICAgICAgICAgICAgTEJlYXV0aWZ5KG1lLnN0b3JlZFRvdGFsQ3BzICogR2FtZS5nbG9iYWxDcHNNdWx0LCAxKQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgIiAoIiArCiAgICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICAgIjxiPiUxJTwvYj4gb2YgdG90YWwgQ3BTIiwKICAgICAgICAgICAgICAgIEJlYXV0aWZ5KAogICAgICAgICAgICAgICAgICBHYW1lLmNvb2tpZXNQcyA+IDAKICAgICAgICAgICAgICAgICAgICA/IChtZS5hbW91bnQgPiAwCiAgICAgICAgICAgICAgICAgICAgICAgID8gKG1lLnN0b3JlZFRvdGFsQ3BzICogR2FtZS5nbG9iYWxDcHNNdWx0KSAvCiAgICAgICAgICAgICAgICAgICAgICAgICAgR2FtZS5jb29raWVzUHMKICAgICAgICAgICAgICAgICAgICAgICAgOiAwKSAqIDEwMAogICAgICAgICAgICAgICAgICAgIDogMCwKICAgICAgICAgICAgICAgICAgMQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICkgKwogICAgICAgICAgICAgICIpPC9kaXY+IiArCiAgICAgICAgICAgICAgKHN5bmVyZ2llc1N0cgogICAgICAgICAgICAgICAgPyAnPGRpdiBjbGFzcz0iZGVzY3JpcHRpb25CbG9jayI+JyArIHN5bmVyZ2llc1N0ciArICI8L2Rpdj4iCiAgICAgICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAgICAgKEVOCiAgICAgICAgICAgICAgICA/ICc8ZGl2IGNsYXNzPSJkZXNjcmlwdGlvbkJsb2NrIj48Yj4nICsKICAgICAgICAgICAgICAgICAgQmVhdXRpZnkobWUudG90YWxDb29raWVzKSArCiAgICAgICAgICAgICAgICAgICI8L2I+ICIgKwogICAgICAgICAgICAgICAgICAoTWF0aC5mbG9vcihtZS50b3RhbENvb2tpZXMpID09IDEgPyAiY29va2llIiA6ICJjb29raWVzIikgKwogICAgICAgICAgICAgICAgICAiICIgKwogICAgICAgICAgICAgICAgICBtZS5hY3Rpb25OYW1lICsKICAgICAgICAgICAgICAgICAgIiBzbyBmYXI8L2Rpdj4iCiAgICAgICAgICAgICAgICA6ICc8ZGl2IGNsYXNzPSJkZXNjcmlwdGlvbkJsb2NrIj4nICsKICAgICAgICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICAgICAgICI8Yj4lMTwvYj4gcHJvZHVjZWQgc28gZmFyIiwKICAgICAgICAgICAgICAgICAgICBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeShtZS50b3RhbENvb2tpZXMpKQogICAgICAgICAgICAgICAgICApICsKICAgICAgICAgICAgICAgICAgIjwvZGl2PiIpCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICI8L2Rpdj4iCiAgICAgICAgKTsKICAgICAgfTsKICAgICAgdGhpcy5sZXZlbFRvb2x0aXAgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgICByZXR1cm4gKAogICAgICAgICAgJzxkaXYgc3R5bGU9IndpZHRoOjI4MHB4O3BhZGRpbmc6OHB4OyIgaWQ9InRvb2x0aXBMZXZlbCI+PGI+JyArCiAgICAgICAgICBsb2MoIkxldmVsICUxICUyIiwgW0JlYXV0aWZ5KG1lLmxldmVsKSwgbWUucGx1cmFsXSkgKwogICAgICAgICAgJzwvYj48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICAgIChFTgogICAgICAgICAgICA/IChtZS5sZXZlbCA9PSAxID8gbWUuZXh0cmFOYW1lIDogbWUuZXh0cmFQbHVyYWwpLnJlcGxhY2UoCiAgICAgICAgICAgICAgICAiW1hdIiwKICAgICAgICAgICAgICAgIEJlYXV0aWZ5KG1lLmxldmVsKQogICAgICAgICAgICAgICkgKwogICAgICAgICAgICAgICIgZ3JhbnRpbmcgPGI+KyIgKwogICAgICAgICAgICAgIEJlYXV0aWZ5KG1lLmxldmVsKSArCiAgICAgICAgICAgICAgIiUgIiArCiAgICAgICAgICAgICAgbWUuZG5hbWUgKwogICAgICAgICAgICAgICIgQ3BTPC9iPi4iCiAgICAgICAgICAgIDogbG9jKCJHcmFudGluZyA8Yj4rJTElICUyIENwUzwvYj4uIiwgWwogICAgICAgICAgICAgICAgQmVhdXRpZnkobWUubGV2ZWwpLAogICAgICAgICAgICAgICAgbWUuc2luZ2xlLAogICAgICAgICAgICAgIF0pKSArCiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgICBsb2MoCiAgICAgICAgICAgICJDbGljayB0byBsZXZlbCB1cCBmb3IgJTEuIiwKICAgICAgICAgICAgJzxzcGFuIGNsYXNzPSJwcmljZSBsdW1wJyArCiAgICAgICAgICAgICAgKEdhbWUubHVtcHMgPj0gbWUubGV2ZWwgKyAxID8gIiIgOiAiIGRpc2FibGVkIikgKwogICAgICAgICAgICAgICciPicgKwogICAgICAgICAgICAgIGxvYygiJTEgc3VnYXIgbHVtcCIsIExCZWF1dGlmeShtZS5sZXZlbCArIDEpKSArCiAgICAgICAgICAgICAgIjwvc3Bhbj4iCiAgICAgICAgICApICsKICAgICAgICAgIChtZS5sZXZlbCA9PSAwICYmIG1lLm1pbmlnYW1lVXJsCiAgICAgICAgICAgID8gJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PjxiPicgKwogICAgICAgICAgICAgIGxvYygiTGV2ZWxsaW5nIHVwIHRoaXMgYnVpbGRpbmcgdW5sb2NrcyBhIG1pbmlnYW1lLiIpICsKICAgICAgICAgICAgICAiPC9iPiIKICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgIjwvZGl2PiIKICAgICAgICApOwogICAgICB9OwogICAgICB0aGlzLmxldmVsVXAgPSAoZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChmcmVlKSB7CiAgICAgICAgICBHYW1lLnNwZW5kTHVtcCgKICAgICAgICAgICAgbWUubGV2ZWwgKyAxLAogICAgICAgICAgICBsb2MoImxldmVsIHVwIHlvdXIgJTEiLCBtZS5wbHVyYWwpLAogICAgICAgICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgbWUubGV2ZWwgKz0gMTsKICAgICAgICAgICAgICBpZiAobWUubGV2ZWwgPj0gMTAgJiYgbWUubGV2ZWxBY2hpZXYxMCkKICAgICAgICAgICAgICAgIEdhbWUuV2luKG1lLmxldmVsQWNoaWV2MTAubmFtZSk7CiAgICAgICAgICAgICAgaWYgKCFmcmVlKSBQbGF5U291bmQoInNuZC91cGdyYWRlLm1wMyIsIDAuNik7CiAgICAgICAgICAgICAgR2FtZS5Mb2FkTWluaWdhbWVzKCk7CiAgICAgICAgICAgICAgbWUucmVmcmVzaCgpOwogICAgICAgICAgICAgIGlmIChsKCJwcm9kdWN0TGV2ZWwiICsgbWUuaWQpKSB7CiAgICAgICAgICAgICAgICB2YXIgcmVjdCA9IGwoInByb2R1Y3RMZXZlbCIgKyBtZS5pZCkuZ2V0Qm91bmRzKCk7CiAgICAgICAgICAgICAgICBHYW1lLlNwYXJrbGVBdCgKICAgICAgICAgICAgICAgICAgKHJlY3QubGVmdCArIHJlY3QucmlnaHQpIC8gMiwKICAgICAgICAgICAgICAgICAgKHJlY3QudG9wICsgcmVjdC5ib3R0b20pIC8gMiAtIDI0ICsgMzIgLSBUb3BCYXJPZmZzZXQKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmIChtZS5taW5pZ2FtZSAmJiBtZS5taW5pZ2FtZS5vbkxldmVsKQogICAgICAgICAgICAgICAgbWUubWluaWdhbWUub25MZXZlbChtZS5sZXZlbCk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGZyZWUKICAgICAgICAgICkoKTsKICAgICAgICB9OwogICAgICB9KSh0aGlzKTsKCiAgICAgIHRoaXMucmVmcmVzaCA9CiAgICAgICAgZnVuY3Rpb24gKCkgLy9zaG93L2hpZGUgdGhlIGJ1aWxkaW5nIGRpc3BsYXkgYmFzZWQgb24gaXRzIGFtb3VudCwgYW5kIHJlZHJhdyBpdAogICAgICAgIHsKICAgICAgICAgIHRoaXMucHJpY2UgPSB0aGlzLmdldFByaWNlKCk7CiAgICAgICAgICBpZiAoR2FtZS5idXlNb2RlID09IDEpCiAgICAgICAgICAgIHRoaXMuYnVsa1ByaWNlID0gdGhpcy5nZXRTdW1QcmljZShHYW1lLmJ1eUJ1bGspOwogICAgICAgICAgZWxzZSBpZiAoR2FtZS5idXlNb2RlID09IC0xICYmIEdhbWUuYnV5QnVsayA9PSAtMSkKICAgICAgICAgICAgdGhpcy5idWxrUHJpY2UgPSB0aGlzLmdldFJldmVyc2VTdW1QcmljZSgxMDAwKTsKICAgICAgICAgIGVsc2UgaWYgKEdhbWUuYnV5TW9kZSA9PSAtMSkKICAgICAgICAgICAgdGhpcy5idWxrUHJpY2UgPSB0aGlzLmdldFJldmVyc2VTdW1QcmljZShHYW1lLmJ1eUJ1bGspOwogICAgICAgICAgdGhpcy5yZWJ1aWxkKCk7CiAgICAgICAgICBpZiAodGhpcy5hbW91bnQgPT0gMCAmJiB0aGlzLmlkICE9IDApCiAgICAgICAgICAgIGwoInJvdyIgKyB0aGlzLmlkKS5jbGFzc0xpc3QucmVtb3ZlKCJlbmFibGVkIik7CiAgICAgICAgICBlbHNlIGlmICh0aGlzLmFtb3VudCA+IDAgJiYgdGhpcy5pZCAhPSAwKQogICAgICAgICAgICBsKCJyb3ciICsgdGhpcy5pZCkuY2xhc3NMaXN0LmFkZCgiZW5hYmxlZCIpOwogICAgICAgICAgaWYgKHRoaXMubXV0ZWQgPiAwICYmIHRoaXMuaWQgIT0gMCkgewogICAgICAgICAgICBsKCJyb3ciICsgdGhpcy5pZCkuY2xhc3NMaXN0LmFkZCgibXV0ZWQiKTsKICAgICAgICAgICAgbCgibXV0ZWRQcm9kdWN0IiArIHRoaXMuaWQpLnN0eWxlLmRpc3BsYXkgPSAiaW5saW5lLWJsb2NrIjsKICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5pZCAhPSAwKSB7CiAgICAgICAgICAgIGwoInJvdyIgKyB0aGlzLmlkKS5jbGFzc0xpc3QucmVtb3ZlKCJtdXRlZCIpOwogICAgICAgICAgICBsKCJtdXRlZFByb2R1Y3QiICsgdGhpcy5pZCkuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICAgIH0KICAgICAgICAgIC8vaWYgKCF0aGlzLm9uTWluaWdhbWUgJiYgIXRoaXMubXV0ZWQpIHt9CiAgICAgICAgICAvL2Vsc2UgdGhpcy5waWNzPVtdOwogICAgICAgIH07CiAgICAgIHRoaXMucmVidWlsZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgbWUgPSB0aGlzOwogICAgICAgIC8vdmFyIGNsYXNzZXM9J3Byb2R1Y3QnOwogICAgICAgIHZhciBwcmljZSA9IG1lLmJ1bGtQcmljZTsKICAgICAgICAvKmlmIChHYW1lLmNvb2tpZXNFYXJuZWQ+PW1lLmJhc2VQcmljZSB8fCBtZS5ib3VnaHQ+MCkge2NsYXNzZXMrPScgdW5sb2NrZWQnO21lLmxvY2tlZD0wO30gZWxzZSB7Y2xhc3Nlcys9JyBsb2NrZWQnO21lLmxvY2tlZD0xO30KCQkJCWlmIChHYW1lLmNvb2tpZXM+PXByaWNlKSBjbGFzc2VzKz0nIGVuYWJsZWQnOyBlbHNlIGNsYXNzZXMrPScgZGlzYWJsZWQnOwoJCQkJaWYgKG1lLmwuY2xhc3NOYW1lLmluZGV4T2YoJ3RvZ2dsZWRPZmYnKSE9LTEpIGNsYXNzZXMrPScgdG9nZ2xlZE9mZic7CgkJCQkqLwogICAgICAgIHZhciBpY29uID0gWzAsIG1lLmljb25dOwogICAgICAgIHZhciBpY29uT2ZmID0gWzEsIG1lLmljb25dOwogICAgICAgIGlmIChtZS5pY29uRnVuYykgaWNvbiA9IG1lLmljb25GdW5jKCk7CgogICAgICAgIHZhciBkZXNjID0gbWUuZGVzYzsKICAgICAgICB2YXIgbmFtZSA9IG1lLmRuYW1lOwogICAgICAgIHZhciBkaXNwbGF5TmFtZSA9IG1lLmRpc3BsYXlOYW1lOwogICAgICAgIGlmIChHYW1lLnNlYXNvbiA9PSAiZm9vbHMiKSB7CiAgICAgICAgICBpZiAoIUdhbWUuZm9vbE9iamVjdHNbbWUubmFtZV0pIHsKICAgICAgICAgICAgaWNvbiA9IFsyLCAwXTsKICAgICAgICAgICAgaWNvbk9mZiA9IFszLCAwXTsKICAgICAgICAgICAgbmFtZSA9IEdhbWUuZm9vbE9iamVjdHNbIlVua25vd24iXS5uYW1lOwogICAgICAgICAgICBkZXNjID0gR2FtZS5mb29sT2JqZWN0c1siVW5rbm93biJdLmRlc2M7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpY29uID0gWzIsIG1lLmljb25dOwogICAgICAgICAgICBpY29uT2ZmID0gWzMsIG1lLmljb25dOwogICAgICAgICAgICBuYW1lID0gR2FtZS5mb29sT2JqZWN0c1ttZS5uYW1lXS5uYW1lOwogICAgICAgICAgICBkZXNjID0gR2FtZS5mb29sT2JqZWN0c1ttZS5uYW1lXS5kZXNjOwogICAgICAgICAgfQogICAgICAgICAgZGlzcGxheU5hbWUgPSBuYW1lOwogICAgICAgICAgLy9pZiAobmFtZS5sZW5ndGg+MTYpIGRpc3BsYXlOYW1lPSc8c3BhbiBzdHlsZT0iZm9udC1zaXplOjc1JTsiPicrbmFtZSsnPC9zcGFuPic7CiAgICAgICAgfSBlbHNlIGlmICghRU4pIGRpc3BsYXlOYW1lID0gbmFtZTsKICAgICAgICAvL2Vsc2UgaWYgKCFFTiAmJiBuYW1lLmxlbmd0aD4xNikgZGlzcGxheU5hbWU9JzxzcGFuIHN0eWxlPSJmb250LXNpemU6NzUlOyI+JytuYW1lKyc8L3NwYW4+JzsKICAgICAgICBpY29uID0gW2ljb25bMF0gKiA2NCwgaWNvblsxXSAqIDY0XTsKICAgICAgICBpY29uT2ZmID0gW2ljb25PZmZbMF0gKiA2NCwgaWNvbk9mZlsxXSAqIDY0XTsKCiAgICAgICAgLy9tZS5sLmNsYXNzTmFtZT1jbGFzc2VzOwogICAgICAgIC8vbCgncHJvZHVjdEljb24nK21lLmlkKS5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2U9J3VybChpbWcvJytpY29uKycpJzsKICAgICAgICBsKCJwcm9kdWN0SWNvbiIgKyBtZS5pZCkuc3R5bGUuYmFja2dyb3VuZFBvc2l0aW9uID0KICAgICAgICAgICItIiArIGljb25bMF0gKyAicHggLSIgKyBpY29uWzFdICsgInB4IjsKICAgICAgICAvL2woJ3Byb2R1Y3RJY29uT2ZmJyttZS5pZCkuc3R5bGUuYmFja2dyb3VuZEltYWdlPSd1cmwoaW1nLycraWNvbk9mZisnKSc7CiAgICAgICAgbCgicHJvZHVjdEljb25PZmYiICsgbWUuaWQpLnN0eWxlLmJhY2tncm91bmRQb3NpdGlvbiA9CiAgICAgICAgICAiLSIgKyBpY29uT2ZmWzBdICsgInB4IC0iICsgaWNvbk9mZlsxXSArICJweCI7CiAgICAgICAgbCgicHJvZHVjdE5hbWUiICsgbWUuaWQpLmlubmVySFRNTCA9IGRpc3BsYXlOYW1lOwogICAgICAgIGlmICgKICAgICAgICAgIG5hbWUubGVuZ3RoID4gMTIgLyBMYW5nc1tsb2NJZF0udyAmJgogICAgICAgICAgKEdhbWUuc2Vhc29uID09ICJmb29scyIgfHwgIUVOKQogICAgICAgICkKICAgICAgICAgIGwoInByb2R1Y3ROYW1lIiArIG1lLmlkKS5jbGFzc0xpc3QuYWRkKCJsb25nUHJvZHVjdE5hbWUiKTsKICAgICAgICBlbHNlIGwoInByb2R1Y3ROYW1lIiArIG1lLmlkKS5jbGFzc0xpc3QucmVtb3ZlKCJsb25nUHJvZHVjdE5hbWUiKTsKICAgICAgICBsKCJwcm9kdWN0T3duZWQiICsgbWUuaWQpLnRleHRDb250ZW50ID0gbWUuYW1vdW50ID8gbWUuYW1vdW50IDogIiI7CiAgICAgICAgbCgicHJvZHVjdFByaWNlIiArIG1lLmlkKS50ZXh0Q29udGVudCA9IEJlYXV0aWZ5KE1hdGgucm91bmQocHJpY2UpKTsKICAgICAgICBsKCJwcm9kdWN0UHJpY2VNdWx0IiArIG1lLmlkKS50ZXh0Q29udGVudCA9CiAgICAgICAgICBHYW1lLmJ1eUJ1bGsgPiAxID8gIngiICsgR2FtZS5idXlCdWxrICsgIiAiIDogIiI7CiAgICAgICAgbCgicHJvZHVjdExldmVsIiArIG1lLmlkKS50ZXh0Q29udGVudCA9ICJsdmwgIiArIEJlYXV0aWZ5KG1lLmxldmVsKTsKICAgICAgICBpZiAoR2FtZS5pc01pbmlnYW1lUmVhZHkobWUpICYmIEdhbWUuYXNjZW5zaW9uTW9kZSAhPSAxKSB7CiAgICAgICAgICBsKCJwcm9kdWN0TWluaWdhbWVCdXR0b24iICsgbWUuaWQpLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICAgICAgaWYgKCFtZS5vbk1pbmlnYW1lKQogICAgICAgICAgICBsKCJwcm9kdWN0TWluaWdhbWVCdXR0b24iICsgbWUuaWQpLnRleHRDb250ZW50ID0gbG9jKAogICAgICAgICAgICAgICJWaWV3ICUxIiwKICAgICAgICAgICAgICBtZS5taW5pZ2FtZU5hbWUKICAgICAgICAgICAgKTsKICAgICAgICAgIGVsc2UKICAgICAgICAgICAgbCgicHJvZHVjdE1pbmlnYW1lQnV0dG9uIiArIG1lLmlkKS50ZXh0Q29udGVudCA9IGxvYygKICAgICAgICAgICAgICAiQ2xvc2UgJTEiLAogICAgICAgICAgICAgIG1lLm1pbmlnYW1lTmFtZQogICAgICAgICAgICApOwogICAgICAgIH0gZWxzZSBsKCJwcm9kdWN0TWluaWdhbWVCdXR0b24iICsgbWUuaWQpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgaWYgKAogICAgICAgICAgR2FtZS5pc01pbmlnYW1lUmVhZHkobWUpICYmCiAgICAgICAgICBHYW1lLmFzY2Vuc2lvbk1vZGUgIT0gMSAmJgogICAgICAgICAgbWUubWluaWdhbWUuZHJhZ29uQm9vc3RUb29sdGlwICYmCiAgICAgICAgICBHYW1lLmhhc0F1cmEoIlN1cHJlbWUgSW50ZWxsZWN0IikKICAgICAgICApIHsKICAgICAgICAgIGwoInByb2R1Y3REcmFnb25Cb29zdCIgKyBtZS5pZCkuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgICAgfSBlbHNlIGwoInByb2R1Y3REcmFnb25Cb29zdCIgKyBtZS5pZCkuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgfTsKICAgICAgdGhpcy5tdXRlZCA9IGZhbHNlOwogICAgICB0aGlzLm11dGUgPSBmdW5jdGlvbiAodmFsKSB7CiAgICAgICAgaWYgKHRoaXMuaWQgPT0gMCkgcmV0dXJuIGZhbHNlOwogICAgICAgIHRoaXMubXV0ZWQgPSB2YWw7CiAgICAgICAgaWYgKHZhbCkgewogICAgICAgICAgbCgicHJvZHVjdE11dGUiICsgdGhpcy5pZCkuY2xhc3NMaXN0LmFkZCgib24iKTsKICAgICAgICAgIGwoInJvdyIgKyB0aGlzLmlkKS5jbGFzc0xpc3QuYWRkKCJtdXRlZCIpOwogICAgICAgICAgbCgibXV0ZWRQcm9kdWN0IiArIHRoaXMuaWQpLnN0eWxlLmRpc3BsYXkgPSAiaW5saW5lLWJsb2NrIjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbCgicHJvZHVjdE11dGUiICsgdGhpcy5pZCkuY2xhc3NMaXN0LnJlbW92ZSgib24iKTsKICAgICAgICAgIGwoInJvdyIgKyB0aGlzLmlkKS5jbGFzc0xpc3QucmVtb3ZlKCJtdXRlZCIpOwogICAgICAgICAgbCgibXV0ZWRQcm9kdWN0IiArIHRoaXMuaWQpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgfQogICAgICB9OwoKICAgICAgdGhpcy5kcmF3ID0gZnVuY3Rpb24gKCkge307CgogICAgICB2YXIgc3RyID0gIiI7CiAgICAgIGlmICh0aGlzLmlkICE9IDApCiAgICAgICAgc3RyICs9CiAgICAgICAgICAnPGRpdiBjbGFzcz0icm93IiBpZD0icm93JyArCiAgICAgICAgICB0aGlzLmlkICsKICAgICAgICAgICciPjxkaXYgY2xhc3M9InNlcGFyYXRvckJvdHRvbSI+PC9kaXY+JzsKICAgICAgc3RyICs9ICc8ZGl2IGNsYXNzPSJwcm9kdWN0QnV0dG9ucyI+JzsKICAgICAgc3RyICs9CiAgICAgICAgJzxkaXYgaWQ9InByb2R1Y3RMZXZlbCcgKwogICAgICAgIHRoaXMuaWQgKwogICAgICAgICciIGNsYXNzPSJwcm9kdWN0QnV0dG9uIHByb2R1Y3RMZXZlbCBsdW1wc09ubHkiIG9uY2xpY2s9IkdhbWUuT2JqZWN0c0J5SWRbJyArCiAgICAgICAgdGhpcy5pZCArCiAgICAgICAgJ10ubGV2ZWxVcCgpIiAnICsKICAgICAgICBHYW1lLmdldER5bmFtaWNUb29sdGlwKAogICAgICAgICAgIkdhbWUuT2JqZWN0c0J5SWRbIiArIHRoaXMuaWQgKyAiXS5sZXZlbFRvb2x0aXAiLAogICAgICAgICAgInRoaXMiCiAgICAgICAgKSArCiAgICAgICAgIj48L2Rpdj4iOwogICAgICBzdHIgKz0KICAgICAgICAnPGRpdiBpZD0icHJvZHVjdE1pbmlnYW1lQnV0dG9uJyArCiAgICAgICAgdGhpcy5pZCArCiAgICAgICAgJyIgY2xhc3M9InByb2R1Y3RCdXR0b24gcHJvZHVjdE1pbmlnYW1lQnV0dG9uIGx1bXBzT25seSIgb25jbGljaz0iR2FtZS5PYmplY3RzQnlJZFsnICsKICAgICAgICB0aGlzLmlkICsKICAgICAgICAiXS5zd2l0Y2hNaW5pZ2FtZSgtMSk7UGxheVNvdW5kKEdhbWUuT2JqZWN0c0J5SWRbIiArCiAgICAgICAgdGhpcy5pZCArCiAgICAgICAgIl0ub25NaW5pZ2FtZT8nc25kL2NsaWNrT24yLm1wMyc6J3NuZC9jbGlja09mZjIubXAzJyk7XCI+PC9kaXY+IjsKICAgICAgaWYgKHRoaXMuaWQgIT0gMCkKICAgICAgICBzdHIgKz0KICAgICAgICAgICc8ZGl2IGNsYXNzPSJwcm9kdWN0QnV0dG9uIHByb2R1Y3RNdXRlIiAnICsKICAgICAgICAgIEdhbWUuZ2V0VG9vbHRpcCgKICAgICAgICAgICAgJzxkaXYgc3R5bGU9IndpZHRoOjE1MHB4O3RleHQtYWxpZ246Y2VudGVyO2ZvbnQtc2l6ZToxMXB4OyIgaWQ9InRvb2x0aXBNdXRlQnVpbGRpbmciPjxiPicgKwogICAgICAgICAgICAgIGxvYygiTXV0ZSIpICsKICAgICAgICAgICAgICAiPC9iPjxicj4oIiArCiAgICAgICAgICAgICAgbG9jKCJNaW5pbWl6ZSB0aGlzIGJ1aWxkaW5nIikgKwogICAgICAgICAgICAgICIpPC9kaXY+IiwKICAgICAgICAgICAgInRoaXMiCiAgICAgICAgICApICsKICAgICAgICAgICcgb25jbGljaz0iR2FtZS5PYmplY3RzQnlJZFsnICsKICAgICAgICAgIHRoaXMuaWQgKwogICAgICAgICAgIl0ubXV0ZSgxKTtQbGF5U291bmQoR2FtZS5PYmplY3RzQnlJZFsiICsKICAgICAgICAgIHRoaXMuaWQgKwogICAgICAgICAgIl0ubXV0ZWQ/J3NuZC9jbGlja09mZjIubXAzJzonc25kL2NsaWNrT24yLm1wMycpO1wiIGlkPVwicHJvZHVjdE11dGUiICsKICAgICAgICAgIHRoaXMuaWQgKwogICAgICAgICAgJyI+JyArCiAgICAgICAgICBsb2MoIk11dGUiKSArCiAgICAgICAgICAiPC9kaXY+IjsKICAgICAgc3RyICs9CiAgICAgICAgJzxkaXYgaWQ9InByb2R1Y3REcmFnb25Cb29zdCcgKwogICAgICAgIHRoaXMuaWQgKwogICAgICAgICciIHN0eWxlPSJkaXNwbGF5Om5vbmU7IiBjbGFzcz0icHJvZHVjdEJ1dHRvbiBwcm9kdWN0RHJhZ29uQm9vc3QiICcgKwogICAgICAgIEdhbWUuZ2V0RHluYW1pY1Rvb2x0aXAoCiAgICAgICAgICAiZnVuY3Rpb24oKXtpZiAoR2FtZS5PYmplY3RzQnlJZFsiICsKICAgICAgICAgICAgdGhpcy5pZCArCiAgICAgICAgICAgICJdLm1pbmlnYW1lICYmIEdhbWUuT2JqZWN0c0J5SWRbIiArCiAgICAgICAgICAgIHRoaXMuaWQgKwogICAgICAgICAgICAiXS5taW5pZ2FtZS5kcmFnb25Cb29zdFRvb2x0aXApIHJldHVybiBHYW1lLk9iamVjdHNCeUlkWyIgKwogICAgICAgICAgICB0aGlzLmlkICsKICAgICAgICAgICAgIl0ubWluaWdhbWUuZHJhZ29uQm9vc3RUb29sdGlwKCk7IGVsc2UgcmV0dXJuIDA7fSIsCiAgICAgICAgICAidGhpcyIKICAgICAgICApICsKICAgICAgICAnPjxkaXYgY2xhc3M9Imljb24iIHN0eWxlPSJ2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7ZGlzcGxheTppbmxpbmUtYmxvY2s7YmFja2dyb3VuZC1wb3NpdGlvbjonICsKICAgICAgICAtMzAgKiA0OCArCiAgICAgICAgInB4ICIgKwogICAgICAgIC0xMiAqIDQ4ICsKICAgICAgICAncHg7dHJhbnNmb3JtOnNjYWxlKDAuNSk7bWFyZ2luOi0yMHB4IC0xNnB4OyI+PC9kaXY+PC9kaXY+JzsKICAgICAgc3RyICs9ICI8L2Rpdj4iOwogICAgICBpZiAodGhpcy5pZCA9PSAwKQogICAgICAgIGwoInNlY3Rpb25MZWZ0RXh0cmEiKS5pbm5lckhUTUwgPSBsKCJzZWN0aW9uTGVmdEV4dHJhIikuaW5uZXJIVE1MICsgc3RyOwogICAgICBlbHNlIHsKICAgICAgICBzdHIgKz0KICAgICAgICAgICc8Y2FudmFzIGNsYXNzPSJyb3dDYW52YXMiIGlkPSJyb3dDYW52YXMnICsgdGhpcy5pZCArICciPjwvY2FudmFzPic7CiAgICAgICAgc3RyICs9ICc8ZGl2IGNsYXNzPSJyb3dTcGVjaWFsIiBpZD0icm93U3BlY2lhbCcgKyB0aGlzLmlkICsgJyI+PC9kaXY+JzsKICAgICAgICBzdHIgKz0gIjwvZGl2PiI7CiAgICAgICAgbCgicm93cyIpLmlubmVySFRNTCA9IGwoInJvd3MiKS5pbm5lckhUTUwgKyBzdHI7CgogICAgICAgIC8vYnVpbGRpbmcgY2FudmFzCiAgICAgICAgdGhpcy5waWNzID0gW107CgogICAgICAgIHRoaXMudG9SZXNpemUgPSB0cnVlOwogICAgICAgIHRoaXMucmVkcmF3ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgICAgIG1lLnBpY3MgPSBbXTsKICAgICAgICB9OwogICAgICAgIHRoaXMuZHJhdyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGlmICh0aGlzLmFtb3VudCA8PSAwKSByZXR1cm4gZmFsc2U7CiAgICAgICAgICBpZiAodGhpcy50b1Jlc2l6ZSkgewogICAgICAgICAgICB0aGlzLmNhbnZhcy53aWR0aCA9IHRoaXMuY2FudmFzLmNsaWVudFdpZHRoOwogICAgICAgICAgICB0aGlzLmNhbnZhcy5oZWlnaHQgPSB0aGlzLmNhbnZhcy5jbGllbnRIZWlnaHQ7CiAgICAgICAgICAgIHRoaXMudG9SZXNpemUgPSBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICAgIHZhciBjdHggPSB0aGlzLmN0eDsKICAgICAgICAgIC8vY2xlYXIKICAgICAgICAgIC8vY3R4LmNsZWFyUmVjdCgwLDAsdGhpcy5jYW52YXMud2lkdGgsdGhpcy5jYW52YXMuaGVpZ2h0KTsKICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDE7CgogICAgICAgICAgLy9waWMgOiBhIGxvYWRlZCBwaWN0dXJlIG9yIGEgZnVuY3Rpb24gcmV0dXJuaW5nIGEgbG9hZGVkIHBpY3R1cmUKICAgICAgICAgIC8vYmcgOiBhIGxvYWRlZCBwaWN0dXJlIG9yIGEgZnVuY3Rpb24gcmV0dXJuaW5nIGEgbG9hZGVkIHBpY3R1cmUgLSB0aWxlZCBhcyB0aGUgYmFja2dyb3VuZCwgMTI4eDEyOAogICAgICAgICAgLy94ViA6IHRoZSBwaWN0dXJlcyB3aWxsIGhhdmUgYSByYW5kb20gaG9yaXpvbnRhbCBzaGlmdCBieSB0aGlzIG1hbnkgcGl4ZWxzCiAgICAgICAgICAvL3lWIDogdGhlIHBpY3R1cmVzIHdpbGwgaGF2ZSBhIHJhbmRvbSB2ZXJ0aWNhbCBzaGlmdCBieSB0aGlzIG1hbnkgcGl4ZWxzCiAgICAgICAgICAvL3cgOiBob3cgbWFueSBwaXhlbHMgYmV0d2VlbiBlYWNoIHBpY3R1cmUgKG9yIHJvdyBvZiBwaWN0dXJlcykKICAgICAgICAgIC8veCA6IGhvcml6b250YWwgb2Zmc2V0CiAgICAgICAgICAvL3kgOiB2ZXJ0aWNhbCBvZmZzZXQgKCszMikKICAgICAgICAgIC8vcm93cyA6IGlmID4xLCBhcnJhbmdlIHRoZSBwaWN0dXJlcyBpbiByb3dzIGNvbnRhaW5pbmcgdGhpcyBtYW55IHBpY3R1cmVzCiAgICAgICAgICAvL2ZyYW1lcyA6IGlmIHByZXNlbnQsIHNsaWNlIHRoZSBwaWMgaW4gW2ZyYW1lc10gaG9yaXpvbnRhbCBzbGljZXMgYW5kIHBpY2sgb25lIGF0IHJhbmRvbQoKICAgICAgICAgIHZhciBwaWMgPSB0aGlzLmFydC5waWM7CiAgICAgICAgICB2YXIgYmcgPSB0aGlzLmFydC5iZzsKICAgICAgICAgIHZhciB4ViA9IHRoaXMuYXJ0LnhWIHx8IDA7CiAgICAgICAgICB2YXIgeVYgPSB0aGlzLmFydC55ViB8fCAwOwogICAgICAgICAgdmFyIHcgPSB0aGlzLmFydC53IHx8IDQ4OwogICAgICAgICAgdmFyIGggPSB0aGlzLmFydC5oIHx8IDQ4OwogICAgICAgICAgdmFyIG9mZlggPSB0aGlzLmFydC54IHx8IDA7CiAgICAgICAgICB2YXIgb2ZmWSA9IHRoaXMuYXJ0LnkgfHwgMDsKICAgICAgICAgIHZhciByb3dzID0gdGhpcy5hcnQucm93cyB8fCAxOwogICAgICAgICAgdmFyIGZyYW1lcyA9IHRoaXMuYXJ0LmZyYW1lcyB8fCAxOwoKICAgICAgICAgIGlmICh0eXBlb2YgYmcgPT0gInN0cmluZyIpCiAgICAgICAgICAgIGN0eC5maWxsUGF0dGVybigKICAgICAgICAgICAgICBQaWModGhpcy5hcnQuYmcpLAogICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICB0aGlzLmNhbnZhcy53aWR0aCwKICAgICAgICAgICAgICB0aGlzLmNhbnZhcy5oZWlnaHQsCiAgICAgICAgICAgICAgMTI4LAogICAgICAgICAgICAgIDEyOAogICAgICAgICAgICApOwogICAgICAgICAgZWxzZSBiZyh0aGlzLCBjdHgpOwogICAgICAgICAgLyoKCQkJCQljdHguZ2xvYmFsQWxwaGE9MC41OwoJCQkJCWlmICh0eXBlb2YoYmcpPT0nc3RyaW5nJykvL3Rlc3QKCQkJCQl7CgkJCQkJCWN0eC5maWxsUGF0dGVybihQaWModGhpcy5hcnQuYmcpLC0xMjgrR2FtZS5UJTEyOCwwLHRoaXMuY2FudmFzLndpZHRoKzEyOCx0aGlzLmNhbnZhcy5oZWlnaHQsMTI4LDEyOCk7CgkJCQkJCWN0eC5maWxsUGF0dGVybihQaWModGhpcy5hcnQuYmcpLC0xMjgrTWF0aC5mbG9vcihHYW1lLlQvMiklMTI4LC0xMjgrTWF0aC5mbG9vcihHYW1lLlQvMiklMTI4LHRoaXMuY2FudmFzLndpZHRoKzEyOCx0aGlzLmNhbnZhcy5oZWlnaHQrMTI4LDEyOCwxMjgpOwoJCQkJCX0KCQkJCQljdHguZ2xvYmFsQWxwaGE9MTsKCQkJCQkqLwogICAgICAgICAgdmFyIG1heEkgPSBNYXRoLmZsb29yKHRoaXMuY2FudmFzLndpZHRoIC8gKHcgLyByb3dzKSArIDEpOwogICAgICAgICAgdmFyIGlUID0gTWF0aC5taW4odGhpcy5hbW91bnQsIG1heEkpOwogICAgICAgICAgdmFyIGkgPSB0aGlzLnBpY3MubGVuZ3RoOwoKICAgICAgICAgIHZhciB4ID0gMDsKICAgICAgICAgIHZhciB5ID0gMDsKICAgICAgICAgIHZhciBhZGRlZCA9IDA7CiAgICAgICAgICBpZiAoaSAhPSBpVCkgewogICAgICAgICAgICAvL2ZvciAodmFyIGl0ZXI9MDtpdGVyPDM7aXRlcisrKQogICAgICAgICAgICAvL3sKICAgICAgICAgICAgdmFyIHByZXZGcmFtZSA9IDA7CiAgICAgICAgICAgIHdoaWxlIChpIDwgaVQpIHsKICAgICAgICAgICAgICAvL2lmIChpPGlUKQogICAgICAgICAgICAgIE1hdGguc2VlZHJhbmRvbShHYW1lLnNlZWQgKyAiICIgKyB0aGlzLmlkICsgIiAiICsgaSk7CiAgICAgICAgICAgICAgaWYgKHJvd3MgIT0gMSkgewogICAgICAgICAgICAgICAgeCA9CiAgICAgICAgICAgICAgICAgIE1hdGguZmxvb3IoaSAvIHJvd3MpICogdyArCiAgICAgICAgICAgICAgICAgICgoaSAlIHJvd3MpIC8gcm93cykgKiB3ICsKICAgICAgICAgICAgICAgICAgTWF0aC5mbG9vcigoTWF0aC5yYW5kb20oKSAtIDAuNSkgKiB4VikgKwogICAgICAgICAgICAgICAgICBvZmZYOwogICAgICAgICAgICAgICAgeSA9CiAgICAgICAgICAgICAgICAgIDMyICsKICAgICAgICAgICAgICAgICAgTWF0aC5mbG9vcigoTWF0aC5yYW5kb20oKSAtIDAuNSkgKiB5VikgKwogICAgICAgICAgICAgICAgICAoKCgtcm93cyAvIDIpICogMzIpIC8gMiArICgoaSAlIHJvd3MpICogMzIpIC8gMikgKwogICAgICAgICAgICAgICAgICBvZmZZOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB4ID0gaSAqIHcgKyBNYXRoLmZsb29yKChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIHhWKSArIG9mZlg7CiAgICAgICAgICAgICAgICB5ID0gMzIgKyBNYXRoLmZsb29yKChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIHlWKSArIG9mZlk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHZhciB1c2VkUGljID0gdHlwZW9mIHBpYyA9PSAic3RyaW5nIiA/IHBpYyA6IHBpYyh0aGlzLCBpKTsKICAgICAgICAgICAgICB2YXIgZnJhbWUgPSAtMTsKICAgICAgICAgICAgICAvL2lmIChmcmFtZXM+MSkgZnJhbWU9TWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKmZyYW1lcyk7CiAgICAgICAgICAgICAgaWYgKGZyYW1lcyA+IDEpIHsKICAgICAgICAgICAgICAgIGZyYW1lID0KICAgICAgICAgICAgICAgICAgcHJldkZyYW1lICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKGZyYW1lcyAtIDEpICsgMSk7CiAgICAgICAgICAgICAgICBmcmFtZSA9IGZyYW1lICUgZnJhbWVzOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBwcmV2RnJhbWUgPSBmcmFtZTsKICAgICAgICAgICAgICB0aGlzLnBpY3MucHVzaCh7CiAgICAgICAgICAgICAgICB4OiBNYXRoLmZsb29yKHgpLAogICAgICAgICAgICAgICAgeTogTWF0aC5mbG9vcih5KSwKICAgICAgICAgICAgICAgIHo6IHksCiAgICAgICAgICAgICAgICBwaWM6IHVzZWRQaWMsCiAgICAgICAgICAgICAgICBpZDogaSwKICAgICAgICAgICAgICAgIGZyYW1lOiBmcmFtZSwKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBpKys7CiAgICAgICAgICAgICAgYWRkZWQrKzsKICAgICAgICAgICAgfQogICAgICAgICAgICB3aGlsZSAoaSA+IGlUKSB7CiAgICAgICAgICAgICAgLy9lbHNlIGlmIChpPmlUKQogICAgICAgICAgICAgIHRoaXMucGljcy5zb3J0KEdhbWUuc29ydFNwcml0ZXNCeUlkKTsKICAgICAgICAgICAgICB0aGlzLnBpY3MucG9wKCk7CiAgICAgICAgICAgICAgaS0tOwogICAgICAgICAgICAgIGFkZGVkLS07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy99CiAgICAgICAgICAgIHRoaXMucGljcy5zb3J0KEdhbWUuc29ydFNwcml0ZXMpOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBsZW4gPSB0aGlzLnBpY3MubGVuZ3RoOwoKICAgICAgICAgIGlmICh0aGlzLm1vdXNlT24pIHsKICAgICAgICAgICAgdmFyIHNlbGVjdGVkID0gLTE7CiAgICAgICAgICAgIGlmICh0aGlzLm5hbWUgPT0gIkdyYW5kbWEiKSB7CiAgICAgICAgICAgICAgLy9tb3VzZSBkZXRlY3Rpb24gb25seSBmaXRzIGdyYW5kbWEgc3ByaXRlcyBmb3Igbm93CiAgICAgICAgICAgICAgdmFyIG1hcmdpblcgPSAtMTg7CiAgICAgICAgICAgICAgdmFyIG1hcmdpbkggPSAtMTA7CiAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgewogICAgICAgICAgICAgICAgdmFyIHBpYyA9IHRoaXMucGljc1tpXTsKICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgdGhpcy5tb3VzZVBvc1swXSA+PSBwaWMueCAtIG1hcmdpblcgJiYKICAgICAgICAgICAgICAgICAgdGhpcy5tb3VzZVBvc1swXSA8IHBpYy54ICsgNjQgKyBtYXJnaW5XICYmCiAgICAgICAgICAgICAgICAgIHRoaXMubW91c2VQb3NbMV0gPj0gcGljLnkgLSBtYXJnaW5IICYmCiAgICAgICAgICAgICAgICAgIHRoaXMubW91c2VQb3NbMV0gPCBwaWMueSArIDY0ICsgbWFyZ2luSAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICBzZWxlY3RlZCA9IGk7CiAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgIHNlbGVjdGVkID09IGkgJiYKICAgICAgICAgICAgICAgICAgcGljLnBpYyA9PSAiZWxmR3JhbmRtYS5wbmciICYmCiAgICAgICAgICAgICAgICAgIEdhbWUubW91c2VEb3duCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgIEdhbWUuV2luKCJCYWJ5IGl0J3Mgb2xkIG91dHNpZGUiKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgR2FtZS5wcmVmcy5jdXN0b21HcmFuZG1hcyAmJgogICAgICAgICAgICAgICAgR2FtZS5jdXN0b21HcmFuZG1hTmFtZXMubGVuZ3RoID4gMAogICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgdmFyIHN0ciA9IGxvYygKICAgICAgICAgICAgICAgICAgIk5hbWVzIGluIHdoaXRlIHdlcmUgc3VibWl0dGVkIGJ5IG91ciBzdXBwb3J0ZXJzIG9uIFBhdHJlb24uIgogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDAuNzU7CiAgICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gIiMwMDAiOwogICAgICAgICAgICAgICAgY3R4LmZvbnQgPSAiOXB4IE1lcnJpd2VhdGhlciI7CiAgICAgICAgICAgICAgICBjdHgudGV4dEFsaWduID0gImxlZnQiOwogICAgICAgICAgICAgICAgY3R4LmZpbGxSZWN0KDAsIDAsIGN0eC5tZWFzdXJlVGV4dChzdHIpLndpZHRoICsgNCwgMTIpOwogICAgICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMTsKICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSAicmdiYSgyNTUsMjU1LDI1NSwwLjcpIjsKICAgICAgICAgICAgICAgIGN0eC5maWxsVGV4dChzdHIsIDIsIDgpOwogICAgICAgICAgICAgICAgaWYgKEVOKSB7CiAgICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSAicmdiYSgyNTUsMjU1LDI1NSwxKSI7CiAgICAgICAgICAgICAgICAgIGN0eC5maWxsVGV4dCgKICAgICAgICAgICAgICAgICAgICAid2hpdGUiLAogICAgICAgICAgICAgICAgICAgIDIgKyBjdHgubWVhc3VyZVRleHQoIk5hbWVzIGluICIpLndpZHRoLAogICAgICAgICAgICAgICAgICAgIDgKICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBNYXRoLnNlZWRyYW5kb20oKTsKCiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgICAgIHZhciBwaWMgPSB0aGlzLnBpY3NbaV07CiAgICAgICAgICAgIHZhciBzcHJpdGUgPSBQaWMocGljLnBpYyk7CiAgICAgICAgICAgIGlmIChzZWxlY3RlZCA9PSBpICYmIHRoaXMubmFtZSA9PSAiR3JhbmRtYSIpIHsKICAgICAgICAgICAgICBjdHguZm9udCA9ICIxNHB4IE1lcnJpd2VhdGhlciI7CiAgICAgICAgICAgICAgY3R4LnRleHRBbGlnbiA9ICJjZW50ZXIiOwogICAgICAgICAgICAgIE1hdGguc2VlZHJhbmRvbShHYW1lLnNlZWQgKyAiICIgKyBwaWMuaWQgLyorJyAnK3BpYy5pZCovKTsgLy8oR2FtZS5zZWVkKycgJytwaWMuaWQrJyAnK3BpYy54KycgJytwaWMueSk7CiAgICAgICAgICAgICAgdmFyIHllYXJzID0KICAgICAgICAgICAgICAgIChEYXRlLm5vdygpIC0gbmV3IERhdGUoMjAxMywgNywgOCkpIC8KICAgICAgICAgICAgICAgICAgKDEwMDAgKiA2MCAqIDYwICogMjQgKiAzNjUpICsKICAgICAgICAgICAgICAgIE1hdGgucmFuZG9tKCk7IC8vdGhlIGdyYW5kbWFzIGFnZSB3aXRoIHRoZSBnYW1lCiAgICAgICAgICAgICAgdmFyIG5hbWUgPSBjaG9vc2UoR2FtZS5ncmFuZG1hTmFtZXMpOwogICAgICAgICAgICAgIHZhciBjdXN0b20gPSBmYWxzZTsKICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICBHYW1lLnByZWZzLmN1c3RvbUdyYW5kbWFzICYmCiAgICAgICAgICAgICAgICBHYW1lLmN1c3RvbUdyYW5kbWFOYW1lcy5sZW5ndGggPiAwICYmCiAgICAgICAgICAgICAgICBNYXRoLnJhbmRvbSgpIDwgMC4yCiAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICBuYW1lID0gY2hvb3NlKEdhbWUuY3VzdG9tR3JhbmRtYU5hbWVzKTsKICAgICAgICAgICAgICAgIGN1c3RvbSA9IHRydWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHZhciB0ZXh0ID0gbG9jKCIlMSwgYWdlICUyIiwgWwogICAgICAgICAgICAgICAgbmFtZSwKICAgICAgICAgICAgICAgIEJlYXV0aWZ5KAogICAgICAgICAgICAgICAgICBNYXRoLmZsb29yKDcwICsgTWF0aC5yYW5kb20oKSAqIDMwICsgeWVhcnMgKyB0aGlzLmxldmVsKQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICBdKTsKICAgICAgICAgICAgICB2YXIgd2lkdGggPSBjdHgubWVhc3VyZVRleHQodGV4dCkud2lkdGggKyAxMjsKICAgICAgICAgICAgICB2YXIgeCA9IE1hdGgubWF4KAogICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgIE1hdGgubWluKAogICAgICAgICAgICAgICAgICBwaWMueCArIDMyIC0gd2lkdGggLyAyICsgTWF0aC5yYW5kb20oKSAqIDMyIC0gMTYsCiAgICAgICAgICAgICAgICAgIHRoaXMuY2FudmFzLndpZHRoIC0gd2lkdGgKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIHZhciB5ID0gNCArIE1hdGgucmFuZG9tKCkgKiA4IC0gNDsKICAgICAgICAgICAgICBNYXRoLnNlZWRyYW5kb20oKTsKICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gIiMwMDAiOwogICAgICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9ICIjMDAwIjsKICAgICAgICAgICAgICBjdHgubGluZVdpZHRoID0gODsKICAgICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAwLjc1OwogICAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTsKICAgICAgICAgICAgICBjdHgubW92ZVRvKHBpYy54ICsgMzIsIHBpYy55ICsgMzIpOwogICAgICAgICAgICAgIGN0eC5saW5lVG8oTWF0aC5mbG9vcih4ICsgd2lkdGggLyAyKSwgTWF0aC5mbG9vcih5ICsgMjApKTsKICAgICAgICAgICAgICBjdHguc3Ryb2tlKCk7CiAgICAgICAgICAgICAgY3R4LmZpbGxSZWN0KE1hdGguZmxvb3IoeCksIE1hdGguZmxvb3IoeSksIE1hdGguZmxvb3Iod2lkdGgpLCAyNCk7CiAgICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMTsKICAgICAgICAgICAgICBpZiAoY3VzdG9tKSBjdHguZmlsbFN0eWxlID0gIiNmZmYiOwogICAgICAgICAgICAgIGVsc2UgY3R4LmZpbGxTdHlsZSA9ICJyZ2JhKDI1NSwyNTUsMjU1LDAuNykiOwogICAgICAgICAgICAgIGN0eC5maWxsVGV4dCh0ZXh0LCBNYXRoLmZsb29yKHggKyB3aWR0aCAvIDIpLCBNYXRoLmZsb29yKHkgKyAxNikpOwoKICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKAogICAgICAgICAgICAgICAgc3ByaXRlLAogICAgICAgICAgICAgICAgTWF0aC5mbG9vcihwaWMueCArIE1hdGgucmFuZG9tKCkgKiA0IC0gMiksCiAgICAgICAgICAgICAgICBNYXRoLmZsb29yKHBpYy55ICsgTWF0aC5yYW5kb20oKSAqIDQgLSAyKQogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy9lbHNlIGlmICgxKSBjdHguZHJhd0ltYWdlKHNwcml0ZSwwLDAsc3ByaXRlLndpZHRoLHNwcml0ZS5oZWlnaHQscGljLngscGljLnksc3ByaXRlLndpZHRoLHNwcml0ZS5oZWlnaHQpOwogICAgICAgICAgICBlbHNlIGlmIChwaWMuZnJhbWUgIT0gLTEpCiAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZSgKICAgICAgICAgICAgICAgIHNwcml0ZSwKICAgICAgICAgICAgICAgIChzcHJpdGUud2lkdGggLyBmcmFtZXMpICogcGljLmZyYW1lLAogICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgIHNwcml0ZS53aWR0aCAvIGZyYW1lcywKICAgICAgICAgICAgICAgIHNwcml0ZS5oZWlnaHQsCiAgICAgICAgICAgICAgICBwaWMueCwKICAgICAgICAgICAgICAgIHBpYy55LAogICAgICAgICAgICAgICAgc3ByaXRlLndpZHRoIC8gZnJhbWVzLAogICAgICAgICAgICAgICAgc3ByaXRlLmhlaWdodAogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIGVsc2UgY3R4LmRyYXdJbWFnZShzcHJpdGUsIHBpYy54LCBwaWMueSk7CiAgICAgICAgICB9CgogICAgICAgICAgLyoKCQkJCQl2YXIgcGljWD10aGlzLmlkOwoJCQkJCXZhciBwaWNZPTEyOwoJCQkJCXZhciB3PTE7CgkJCQkJdmFyIGg9MTsKCQkJCQl2YXIgdz1NYXRoLmFicyhNYXRoLmNvcyhHYW1lLlQqMC4yK3RoaXMuaWQqMi0wLjMpKSowLjIrMC44OwoJCQkJCXZhciBoPU1hdGguYWJzKE1hdGguc2luKEdhbWUuVCowLjIrdGhpcy5pZCoyKSkqMC4zKzAuNzsKCQkJCQl2YXIgeD02NCtNYXRoLmNvcyhHYW1lLlQqMC4xOSt0aGlzLmlkKjIpKjgtMjQqdzsKCQkJCQl2YXIgeT0xMjgtTWF0aC5hYnMoTWF0aC5wb3coTWF0aC5zaW4oR2FtZS5UKjAuMit0aGlzLmlkKjIpLDUpKjE2KS00OCpoOwoJCQkJCWN0eC5kcmF3SW1hZ2UoUGljKCdpY29ucy5wbmcnKSxwaWNYKjQ4LHBpY1kqNDgsNDgsNDgsTWF0aC5mbG9vcih4KSxNYXRoLmZsb29yKHkpLDQ4KncsNDgqaCk7CgkJCQkJKi8KICAgICAgICB9OwogICAgICB9CgogICAgICBHYW1lLmxhc3QgPSB0aGlzOwogICAgICBHYW1lLk9iamVjdHNbdGhpcy5uYW1lXSA9IHRoaXM7CiAgICAgIEdhbWUuT2JqZWN0c0J5SWQucHVzaCh0aGlzKTsKICAgICAgR2FtZS5PYmplY3RzTisrOwogICAgICByZXR1cm4gdGhpczsKICAgIH07CgogICAgR2FtZS5EcmF3QnVpbGRpbmdzID0gZnVuY3Rpb24gKCkgLy9kcmF3IGJ1aWxkaW5nIGRpc3BsYXlzIHdpdGggY2FudmFzCiAgICB7CiAgICAgIGlmIChHYW1lLmRyYXdUICUgMyA9PSAwKSB7CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICAgIHZhciBtZSA9IEdhbWUuT2JqZWN0c1tpXTsKICAgICAgICAgIGlmIChtZS5pZCA+IDAgJiYgIW1lLm9uTWluaWdhbWUgJiYgIW1lLm11dGVkKSBtZS5kcmF3KCk7CiAgICAgICAgICBlbHNlIG1lLnBpY3MgPSBbXTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgR2FtZS5zb3J0U3ByaXRlcyA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgIGlmIChhLnogPiBiLnopIHJldHVybiAxOwogICAgICBlbHNlIGlmIChhLnogPCBiLnopIHJldHVybiAtMTsKICAgICAgZWxzZSByZXR1cm4gMDsKICAgIH07CiAgICBHYW1lLnNvcnRTcHJpdGVzQnlJZCA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgIGlmIChhLmlkID4gYi5pZCkgcmV0dXJuIDE7CiAgICAgIGVsc2UgaWYgKGEuaWQgPCBiLmlkKSByZXR1cm4gLTE7CiAgICAgIGVsc2UgcmV0dXJuIDA7CiAgICB9OwoKICAgIEdhbWUubW9kaWZ5QnVpbGRpbmdQcmljZSA9IGZ1bmN0aW9uIChidWlsZGluZywgcHJpY2UpIHsKICAgICAgaWYgKEdhbWUuSGFzKCJTZWFzb24gc2F2aW5ncyIpKSBwcmljZSAqPSAwLjk5OwogICAgICBpZiAoR2FtZS5IYXMoIlNhbnRhJ3MgZG9taW5pb24iKSkgcHJpY2UgKj0gMC45OTsKICAgICAgaWYgKEdhbWUuSGFzKCJGYWJlcmdlIGVnZyIpKSBwcmljZSAqPSAwLjk5OwogICAgICBpZiAoR2FtZS5IYXMoIkRpdmluZSBkaXNjb3VudCIpKSBwcmljZSAqPSAwLjk5OwogICAgICBpZiAoR2FtZS5IYXMoIkZvcnR1bmUgIzEwMCIpKSBwcmljZSAqPSAwLjk5OwogICAgICAvL2lmIChHYW1lLmhhc0F1cmEoJ0ZpZXJjZSBIb2FyZGVyJykpIHByaWNlKj0wLjk4OwogICAgICBwcmljZSAqPSAxIC0gR2FtZS5hdXJhTXVsdCgiRmllcmNlIEhvYXJkZXIiKSAqIDAuMDI7CiAgICAgIGlmIChHYW1lLmhhc0J1ZmYoIkV2ZXJ5dGhpbmcgbXVzdCBnbyIpKSBwcmljZSAqPSAwLjk1OwogICAgICBpZiAoR2FtZS5oYXNCdWZmKCJDcmFmdHkgcGl4aWVzIikpIHByaWNlICo9IDAuOTg7CiAgICAgIGlmIChHYW1lLmhhc0J1ZmYoIk5hc3R5IGdvYmxpbnMiKSkgcHJpY2UgKj0gMS4wMjsKICAgICAgaWYgKGJ1aWxkaW5nLmZvcnR1bmUgJiYgR2FtZS5IYXMoYnVpbGRpbmcuZm9ydHVuZS5uYW1lKSkgcHJpY2UgKj0gMC45MzsKICAgICAgcHJpY2UgKj0gR2FtZS5lZmYoImJ1aWxkaW5nQ29zdCIpOwogICAgICBpZiAoR2FtZS5oYXNHb2QpIHsKICAgICAgICB2YXIgZ29kTHZsID0gR2FtZS5oYXNHb2QoImNyZWF0aW9uIik7CiAgICAgICAgaWYgKGdvZEx2bCA9PSAxKSBwcmljZSAqPSAwLjkzOwogICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAyKSBwcmljZSAqPSAwLjk1OwogICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAzKSBwcmljZSAqPSAwLjk4OwogICAgICB9CiAgICAgIHJldHVybiBwcmljZTsKICAgIH07CgogICAgR2FtZS5zdG9yZUJ1bGtCdXR0b24gPSBmdW5jdGlvbiAoaWQpIHsKICAgICAgaWYgKGlkID09IDApIEdhbWUuYnV5TW9kZSA9IDE7CiAgICAgIGVsc2UgaWYgKGlkID09IDEpIEdhbWUuYnV5TW9kZSA9IC0xOwogICAgICBlbHNlIGlmIChpZCA9PSAyKSBHYW1lLmJ1eUJ1bGsgPSAxOwogICAgICBlbHNlIGlmIChpZCA9PSAzKSBHYW1lLmJ1eUJ1bGsgPSAxMDsKICAgICAgZWxzZSBpZiAoaWQgPT0gNCkgR2FtZS5idXlCdWxrID0gMTAwOwogICAgICBlbHNlIGlmIChpZCA9PSA1KSBHYW1lLmJ1eUJ1bGsgPSAtMTsKCiAgICAgIGlmIChHYW1lLmJ1eU1vZGUgPT0gMSAmJiBHYW1lLmJ1eUJ1bGsgPT0gLTEpIEdhbWUuYnV5QnVsayA9IDEwMDsKCiAgICAgIGlmIChHYW1lLmJ1eU1vZGUgPT0gMSkKICAgICAgICBsKCJzdG9yZUJ1bGtCdXkiKS5jbGFzc05hbWUgPSAic3RvcmVQcmVCdXR0b24gc3RvcmVCdWxrTW9kZSBzZWxlY3RlZCI7CiAgICAgIGVsc2UgbCgic3RvcmVCdWxrQnV5IikuY2xhc3NOYW1lID0gInN0b3JlUHJlQnV0dG9uIHN0b3JlQnVsa01vZGUiOwogICAgICBpZiAoR2FtZS5idXlNb2RlID09IC0xKQogICAgICAgIGwoInN0b3JlQnVsa1NlbGwiKS5jbGFzc05hbWUgPSAic3RvcmVQcmVCdXR0b24gc3RvcmVCdWxrTW9kZSBzZWxlY3RlZCI7CiAgICAgIGVsc2UgbCgic3RvcmVCdWxrU2VsbCIpLmNsYXNzTmFtZSA9ICJzdG9yZVByZUJ1dHRvbiBzdG9yZUJ1bGtNb2RlIjsKCiAgICAgIGlmIChHYW1lLmJ1eUJ1bGsgPT0gMSkKICAgICAgICBsKCJzdG9yZUJ1bGsxIikuY2xhc3NOYW1lID0gInN0b3JlUHJlQnV0dG9uIHN0b3JlQnVsa0Ftb3VudCBzZWxlY3RlZCI7CiAgICAgIGVsc2UgbCgic3RvcmVCdWxrMSIpLmNsYXNzTmFtZSA9ICJzdG9yZVByZUJ1dHRvbiBzdG9yZUJ1bGtBbW91bnQiOwogICAgICBpZiAoR2FtZS5idXlCdWxrID09IDEwKQogICAgICAgIGwoInN0b3JlQnVsazEwIikuY2xhc3NOYW1lID0gInN0b3JlUHJlQnV0dG9uIHN0b3JlQnVsa0Ftb3VudCBzZWxlY3RlZCI7CiAgICAgIGVsc2UgbCgic3RvcmVCdWxrMTAiKS5jbGFzc05hbWUgPSAic3RvcmVQcmVCdXR0b24gc3RvcmVCdWxrQW1vdW50IjsKICAgICAgaWYgKEdhbWUuYnV5QnVsayA9PSAxMDApCiAgICAgICAgbCgic3RvcmVCdWxrMTAwIikuY2xhc3NOYW1lID0gInN0b3JlUHJlQnV0dG9uIHN0b3JlQnVsa0Ftb3VudCBzZWxlY3RlZCI7CiAgICAgIGVsc2UgbCgic3RvcmVCdWxrMTAwIikuY2xhc3NOYW1lID0gInN0b3JlUHJlQnV0dG9uIHN0b3JlQnVsa0Ftb3VudCI7CiAgICAgIGlmIChHYW1lLmJ1eUJ1bGsgPT0gLTEpCiAgICAgICAgbCgic3RvcmVCdWxrTWF4IikuY2xhc3NOYW1lID0gInN0b3JlUHJlQnV0dG9uIHN0b3JlQnVsa0Ftb3VudCBzZWxlY3RlZCI7CiAgICAgIGVsc2UgbCgic3RvcmVCdWxrTWF4IikuY2xhc3NOYW1lID0gInN0b3JlUHJlQnV0dG9uIHN0b3JlQnVsa0Ftb3VudCI7CgogICAgICBpZiAoR2FtZS5idXlNb2RlID09IDEpIHsKICAgICAgICBsKCJzdG9yZUJ1bGtNYXgiKS5zdHlsZS52aXNpYmlsaXR5ID0gImhpZGRlbiI7CiAgICAgICAgbCgicHJvZHVjdHMiKS5jbGFzc05hbWUgPSAic3RvcmVTZWN0aW9uIjsKICAgICAgfSBlbHNlIHsKICAgICAgICBsKCJzdG9yZUJ1bGtNYXgiKS5zdHlsZS52aXNpYmlsaXR5ID0gInZpc2libGUiOwogICAgICAgIGwoInByb2R1Y3RzIikuY2xhc3NOYW1lID0gInN0b3JlU2VjdGlvbiBzZWxsaW5nIjsKICAgICAgfQoKICAgICAgR2FtZS5zdG9yZVRvUmVmcmVzaCA9IDE7CiAgICAgIGlmIChpZCAhPSAtMSkgUGxheVNvdW5kKCJzbmQvdGljay5tcDMiKTsKICAgIH07CiAgICBHYW1lLkJ1aWxkU3RvcmUgPSBmdW5jdGlvbiAoKSAvL2NyZWF0ZSB0aGUgRE9NIGZvciB0aGUgc3RvcmUncyBidWlsZGluZ3MKICAgIHsKICAgICAgLy9pZiAodHlwZW9mIHNob3dBZHMhPT0ndW5kZWZpbmVkJykgbCgnc3RvcmUnKS5zY3JvbGxUb3A9MTAwOwoKICAgICAgdmFyIHN0ciA9ICIiOwogICAgICBzdHIgKz0KICAgICAgICAnPGRpdiBpZD0ic3RvcmVCdWxrIiBjbGFzcz0ic3RvcmVQcmUiICcgKwogICAgICAgIEdhbWUuZ2V0VG9vbHRpcCgKICAgICAgICAgICc8ZGl2IHN0eWxlPSJwYWRkaW5nOjhweDttaW4td2lkdGg6MjAwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Zm9udC1zaXplOjExcHg7IiBpZD0idG9vbHRpcFN0b3JlQnVsayI+JyArCiAgICAgICAgICAgIGxvYygKICAgICAgICAgICAgICAiWW91IGNhbiBhbHNvIHByZXNzICUxIHRvIGJ1bGstYnV5IG9yIHNlbGwgJTIgb2YgYSBidWlsZGluZyBhdCBhIHRpbWUsIG9yICUzIGZvciAlNC4iLAogICAgICAgICAgICAgIFsKICAgICAgICAgICAgICAgICI8Yj4iICsgbG9jKCJDdHJsIikgKyAiPC9iPiIsCiAgICAgICAgICAgICAgICAiPGI+MTA8L2I+IiwKICAgICAgICAgICAgICAgICI8Yj4iICsgbG9jKCJTaGlmdCIpICsgIjwvYj4iLAogICAgICAgICAgICAgICAgIjxiPjEwMDwvYj4iLAogICAgICAgICAgICAgIF0KICAgICAgICAgICAgKSArCiAgICAgICAgICAgICI8L2Rpdj4iLAogICAgICAgICAgInN0b3JlIgogICAgICAgICkgKwogICAgICAgICI+IiArCiAgICAgICAgJzxkaXYgaWQ9InN0b3JlQnVsa0J1eSIgY2xhc3M9InN0b3JlUHJlQnV0dG9uIHN0b3JlQnVsa01vZGUiICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICc9IkdhbWUuc3RvcmVCdWxrQnV0dG9uKDApOyI+JyArCiAgICAgICAgbG9jKCJCdXkiKSArCiAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICc8ZGl2IGlkPSJzdG9yZUJ1bGtTZWxsIiBjbGFzcz0ic3RvcmVQcmVCdXR0b24gc3RvcmVCdWxrTW9kZSIgJyArCiAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgJz0iR2FtZS5zdG9yZUJ1bGtCdXR0b24oMSk7Ij4nICsKICAgICAgICBsb2MoIlNlbGwiKSArCiAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICc8ZGl2IGlkPSJzdG9yZUJ1bGsxIiBjbGFzcz0ic3RvcmVQcmVCdXR0b24gc3RvcmVCdWxrQW1vdW50IiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJHYW1lLnN0b3JlQnVsa0J1dHRvbigyKTsiPjE8L2Rpdj4nICsKICAgICAgICAnPGRpdiBpZD0ic3RvcmVCdWxrMTAiIGNsYXNzPSJzdG9yZVByZUJ1dHRvbiBzdG9yZUJ1bGtBbW91bnQiICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICc9IkdhbWUuc3RvcmVCdWxrQnV0dG9uKDMpOyI+MTA8L2Rpdj4nICsKICAgICAgICAnPGRpdiBpZD0ic3RvcmVCdWxrMTAwIiBjbGFzcz0ic3RvcmVQcmVCdXR0b24gc3RvcmVCdWxrQW1vdW50IiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJHYW1lLnN0b3JlQnVsa0J1dHRvbig0KTsiPjEwMDwvZGl2PicgKwogICAgICAgICc8ZGl2IGlkPSJzdG9yZUJ1bGtNYXgiIGNsYXNzPSJzdG9yZVByZUJ1dHRvbiBzdG9yZUJ1bGtBbW91bnQiICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICc9IkdhbWUuc3RvcmVCdWxrQnV0dG9uKDUpOyI+JyArCiAgICAgICAgbG9jKCJhbGwiKSArCiAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICI8L2Rpdj4iOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0cykgewogICAgICAgIHZhciBtZSA9IEdhbWUuT2JqZWN0c1tpXTsKICAgICAgICBzdHIgKz0KICAgICAgICAgIChHYW1lLnByZWZzLnNjcmVlbnJlYWRlcgogICAgICAgICAgICA/ICc8YnV0dG9uIGFyaWEtbGFiZWxsZWRieT0iYXJpYVJlYWRlci1wcm9kdWN0LScgKyBtZS5pZCArICciJwogICAgICAgICAgICA6ICI8ZGl2IikgKwogICAgICAgICAgJyBjbGFzcz0icHJvZHVjdCB0b2dnbGVkT2ZmIiAnICsKICAgICAgICAgIEdhbWUuZ2V0RHluYW1pY1Rvb2x0aXAoCiAgICAgICAgICAgICJHYW1lLk9iamVjdHNCeUlkWyIgKyBtZS5pZCArICJdLnRvb2x0aXAiLAogICAgICAgICAgICAic3RvcmUiCiAgICAgICAgICApICsKICAgICAgICAgICcgaWQ9InByb2R1Y3QnICsKICAgICAgICAgIG1lLmlkICsKICAgICAgICAgICciPjxkaXYgY2xhc3M9Imljb24gb2ZmIiBpZD0icHJvZHVjdEljb25PZmYnICsKICAgICAgICAgIG1lLmlkICsKICAgICAgICAgICciIHN0eWxlPSIiPjwvZGl2PjxkaXYgY2xhc3M9Imljb24iIGlkPSJwcm9kdWN0SWNvbicgKwogICAgICAgICAgbWUuaWQgKwogICAgICAgICAgJyIgc3R5bGU9IiI+PC9kaXY+PGRpdiBjbGFzcz0iY29udGVudCI+PGRpdiBjbGFzcz0ibG9ja2VkVGl0bGUiPj8/PzwvZGl2PjxkaXYgY2xhc3M9InRpdGxlIHByb2R1Y3ROYW1lIiBpZD0icHJvZHVjdE5hbWUnICsKICAgICAgICAgIG1lLmlkICsKICAgICAgICAgICciPjwvZGl2PjxzcGFuIGNsYXNzPSJwcmljZU11bHQiIGlkPSJwcm9kdWN0UHJpY2VNdWx0JyArCiAgICAgICAgICBtZS5pZCArCiAgICAgICAgICAnIj48L3NwYW4+PHNwYW4gY2xhc3M9InByaWNlIiBpZD0icHJvZHVjdFByaWNlJyArCiAgICAgICAgICBtZS5pZCArCiAgICAgICAgICAnIj48L3NwYW4+PGRpdiBjbGFzcz0idGl0bGUgb3duZWQiIGlkPSJwcm9kdWN0T3duZWQnICsKICAgICAgICAgIG1lLmlkICsKICAgICAgICAgICciPjwvZGl2PicgKwogICAgICAgICAgKEdhbWUucHJlZnMuc2NyZWVucmVhZGVyCiAgICAgICAgICAgID8gJzxsYWJlbCBjbGFzcz0ic3JPbmx5IiBzdHlsZT0id2lkdGg6NjRweDtsZWZ0Oi02NHB4OyIgaWQ9ImFyaWFSZWFkZXItcHJvZHVjdC0nICsKICAgICAgICAgICAgICBtZS5pZCArCiAgICAgICAgICAgICAgJyI+PC9sYWJlbD4nCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgIC8qJzxkaXYgY2xhc3M9ImJ1eVNlbGwiPjxkaXYgc3R5bGU9ImxlZnQ6MHB4OyIgaWQ9ImJ1dHRvbkJ1eTEwLScrbWUuaWQrJyI+QnV5IDEwPC9kaXY+PGRpdiBzdHlsZT0ibGVmdDoxMDBweDsiIGlkPSJidXR0b25TZWxsLScrbWUuaWQrJyI+U2VsbCAxPC9kaXY+PGRpdiBzdHlsZT0ibGVmdDoyMDBweDsiIGlkPSJidXR0b25TZWxsQWxsLScrbWUuaWQrJyI+U2VsbCBhbGw8L2Rpdj48L2Rpdj4nKyovCiAgICAgICAgICAoR2FtZS5wcmVmcy5zY3JlZW5yZWFkZXIgPyAiPC9idXR0b24+IiA6ICI8L2Rpdj4iKTsKICAgICAgfQogICAgICBsKCJwcm9kdWN0cyIpLmlubmVySFRNTCA9IHN0cjsKCiAgICAgIEdhbWUuc3RvcmVCdWxrQnV0dG9uKC0xKTsKCiAgICAgIC8qdmFyIFNlbGxBbGxQcm9tcHQ9ZnVuY3Rpb24oaWQpCgkJCXsKCQkJCXJldHVybiBmdW5jdGlvbihpZCl7R2FtZS5Qcm9tcHQoJzxkaXYgY2xhc3M9ImJsb2NrIj5EbyB5b3UgcmVhbGx5IHdhbnQgdG8gc2VsbCB5b3VyICcrbG9jKCIlMSAiK0dhbWUuT2JqZWN0c0J5SWRbaWRdLmJzaW5nbGUsTEJlYXV0aWZ5KEdhbWUuT2JqZWN0c0J5SWRbaWRdLmFtb3VudCkpKyc/PC9kaXY+JyxbWydZZXMnLCdHYW1lLk9iamVjdHNCeUlkWycraWQrJ10uc2VsbCgtMSk7R2FtZS5DbG9zZVByb21wdCgpOyddLFsnTm8nLCdHYW1lLkNsb3NlUHJvbXB0KCk7J11dKTt9KGlkKTsKCQkJfSovCgogICAgICBmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0cykgewogICAgICAgIHZhciBtZSA9IEdhbWUuT2JqZWN0c1tpXTsKICAgICAgICBtZS5sID0gbCgicHJvZHVjdCIgKyBtZS5pZCk7CgogICAgICAgIC8vdGhlc2UgYXJlIGEgYml0IG1lc3N5IGJ1dCBhaCB3ZWxsCiAgICAgICAgaWYgKCFHYW1lLnRvdWNoRXZlbnRzKSB7CiAgICAgICAgICBBZGRFdmVudCgKICAgICAgICAgICAgbWUubCwKICAgICAgICAgICAgImNsaWNrIiwKICAgICAgICAgICAgKGZ1bmN0aW9uICh3aGF0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICBHYW1lLkNsaWNrUHJvZHVjdCh3aGF0KTsKICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9KShtZS5pZCkKICAgICAgICAgICk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIEFkZEV2ZW50KAogICAgICAgICAgICBtZS5sLAogICAgICAgICAgICAidG91Y2hlbmQiLAogICAgICAgICAgICAoZnVuY3Rpb24gKHdoYXQpIHsKICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgIEdhbWUuQ2xpY2tQcm9kdWN0KHdoYXQpOwogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0pKG1lLmlkKQogICAgICAgICAgKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgR2FtZS5DbGlja1Byb2R1Y3QgPSBmdW5jdGlvbiAod2hhdCkgewogICAgICBHYW1lLk9iamVjdHNCeUlkW3doYXRdLmJ1eSgpOwogICAgfTsKCiAgICBHYW1lLlJlZnJlc2hTdG9yZSA9IGZ1bmN0aW9uICgpIC8vcmVmcmVzaCB0aGUgc3RvcmUncyBidWlsZGluZ3MKICAgIHsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICBHYW1lLk9iamVjdHNbaV0ucmVmcmVzaCgpOwogICAgICB9CiAgICAgIEdhbWUuc3RvcmVUb1JlZnJlc2ggPSAwOwogICAgfTsKCiAgICBHYW1lLkNvbXB1dGVDcHMgPSBmdW5jdGlvbiAoYmFzZSwgbXVsdCwgYm9udXMpIHsKICAgICAgaWYgKCFib251cykgYm9udXMgPSAwOwogICAgICByZXR1cm4gYmFzZSAqIE1hdGgucG93KDIsIG11bHQpICsgYm9udXM7CiAgICB9OwoKICAgIEdhbWUuaXNNaW5pZ2FtZVJlYWR5ID0gZnVuY3Rpb24gKG1lKSB7CiAgICAgIHJldHVybiBtZS5taW5pZ2FtZVVybCAmJiBtZS5taW5pZ2FtZUxvYWRlZCAmJiBtZS5sZXZlbCA+IDA7CiAgICB9OwogICAgR2FtZS5zY3JpcHRCaW5kaW5ncyA9IFtdOwogICAgR2FtZS5zaG93ZWRTY3JpcHRMb2FkRXJyb3IgPSBmYWxzZTsKICAgIEdhbWUuTG9hZE1pbmlnYW1lcyA9IGZ1bmN0aW9uICgpIC8vbG9hZCBzY3JpcHRzIGZvciBlYWNoIG1pbmlnYW1lCiAgICB7CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5PYmplY3RzW2ldOwogICAgICAgIGlmICgKICAgICAgICAgIG1lLm1pbmlnYW1lVXJsICYmCiAgICAgICAgICBtZS5sZXZlbCA+IDAgJiYKICAgICAgICAgICFtZS5taW5pZ2FtZUxvYWRlZCAmJgogICAgICAgICAgIW1lLm1pbmlnYW1lTG9hZGluZyAmJgogICAgICAgICAgIWwoIm1pbmlnYW1lU2NyaXB0LSIgKyBtZS5pZCkKICAgICAgICApIHsKICAgICAgICAgIG1lLm1pbmlnYW1lTG9hZGluZyA9IHRydWU7CiAgICAgICAgICAvL3dlJ3JlIG9ubHkgbG9hZGluZyB0aGUgbWluaWdhbWUgc2NyaXB0cyB0aGF0IGFyZW4ndCBsb2FkZWQgeWV0IGFuZCB3aGljaCBoYXZlIGVub3VnaCBidWlsZGluZyBsZXZlbAogICAgICAgICAgLy93ZSBjYWxsIHRoaXMgZnVuY3Rpb24gb24gYnVpbGRpbmcgbGV2ZWwgdXAgYW5kIG9uIGxvYWQKICAgICAgICAgIC8vY29uc29sZS5sb2coJ0xvYWRpbmcgc2NyaXB0ICcrbWUubWluaWdhbWVVcmwrJy4uLicpOwogICAgICAgICAgc2V0VGltZW91dCgKICAgICAgICAgICAgKGZ1bmN0aW9uIChtZSkgewogICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB2YXIgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7CiAgICAgICAgICAgICAgICBzY3JpcHQuaWQgPSAibWluaWdhbWVTY3JpcHQtIiArIG1lLmlkOwogICAgICAgICAgICAgICAgR2FtZS5zY3JpcHRCaW5kaW5nc1sibWluaWdhbWVTY3JpcHQtIiArIG1lLmlkXSA9IG1lOwogICAgICAgICAgICAgICAgc2NyaXB0LnNldEF0dHJpYnV0ZSgKICAgICAgICAgICAgICAgICAgInNyYyIsCiAgICAgICAgICAgICAgICAgIG1lLm1pbmlnYW1lVXJsICsgIj9yPSIgKyBHYW1lLnZlcnNpb24KICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICBzY3JpcHQub25sb2FkID0gKGZ1bmN0aW9uIChtZSwgc2NyaXB0KSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCFtZS5taW5pZ2FtZUxvYWRlZCkgR2FtZS5zY3JpcHRMb2FkZWQobWUsIHNjcmlwdCk7CiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9KShtZSwgIm1pbmlnYW1lU2NyaXB0LSIgKyBtZS5pZCk7CiAgICAgICAgICAgICAgICBzY3JpcHQub25lcnJvciA9IChmdW5jdGlvbiAobWUsIHNjcmlwdCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIG1lLm1pbmlnYW1lTG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIGlmICghbWUubWluaWdhbWVMb2FkZWQgJiYgIUdhbWUuc2hvd2VkU2NyaXB0TG9hZEVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICBHYW1lLnNob3dlZFNjcmlwdExvYWRFcnJvciA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgICAgICAgICAgICAgbG9jKCJFcnJvciEiKSwKICAgICAgICAgICAgICAgICAgICAgICAgIkNvdWxkbid0IGxvYWQgbWluaWdhbWVzLiBUcnkgcmVsb2FkaW5nLiIKICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgfSkobWUsICJtaW5pZ2FtZVNjcmlwdC0iICsgbWUuaWQpOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzY3JpcHQpOwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0pKG1lKSwKICAgICAgICAgICAgMTAKICAgICAgICAgICk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwogICAgR2FtZS5zY3JpcHRMb2FkZWQgPSBmdW5jdGlvbiAod2hvLCBzY3JpcHQpIHsKICAgICAgd2hvLm1pbmlnYW1lTG9hZGluZyA9IGZhbHNlOwogICAgICB3aG8ubWluaWdhbWVMb2FkZWQgPSB0cnVlOwogICAgICB3aG8ucmVmcmVzaCgpOwogICAgICB3aG8ubWluaWdhbWUubGF1bmNoKCk7CiAgICAgIGlmICh3aG8ubWluaWdhbWVTYXZlKSB7CiAgICAgICAgd2hvLm1pbmlnYW1lLnJlc2V0KHRydWUpOwogICAgICAgIHdoby5taW5pZ2FtZS5sb2FkKHdoby5taW5pZ2FtZVNhdmUpOwogICAgICAgIHdoby5taW5pZ2FtZVNhdmUgPSAwOwogICAgICB9CiAgICB9OwoKICAgIEdhbWUubWFnaWNDcFMgPSBmdW5jdGlvbiAod2hhdCkgewogICAgICAvKgoJCQlpZiAoR2FtZS5PYmplY3RzW3doYXRdLmFtb3VudD49MjUwKQoJCQl7CgkJCQkvL3RoaXMgbWFrZXMgYnVpbGRpbmdzIGdpdmUgMSUgbW9yZSBjb29raWVzIGZvciBldmVyeSBidWlsZGluZyBvdmVyIDI1MC4KCQkJCS8vdGhpcyB0dXJucyBvdXQgdG8gYmUgcmF0aGVyIHN0dXBpZGx5IG92ZXJwb3dlcmVkLgoJCQkJdmFyIG49R2FtZS5PYmplY3RzW3doYXRdLmFtb3VudC0yNTA7CgkJCQlyZXR1cm4gMStNYXRoLnBvdygxLjAxLG4pOwoJCQl9CgkJCWVsc2UgcmV0dXJuIDE7CgkJCSovCiAgICAgIHJldHVybiAxOwogICAgfTsKCiAgICAvL2RlZmluZSBvYmplY3RzCiAgICBuZXcgR2FtZS5PYmplY3QoCiAgICAgICJDdXJzb3IiLAogICAgICAiY3Vyc29yfGN1cnNvcnN8Y2xpY2tlZHxbWF0gZXh0cmEgZmluZ2VyfFtYXSBleHRyYSBmaW5nZXJzIiwKICAgICAgIkF1dG9jbGlja3Mgb25jZSBldmVyeSAxMCBzZWNvbmRzLiIsCiAgICAgIDAsCiAgICAgIDAsCiAgICAgIHt9LAogICAgICAxNSwKICAgICAgZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgdmFyIGFkZCA9IDA7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJUaG91c2FuZCBmaW5nZXJzIikpIGFkZCArPSAwLjE7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJNaWxsaW9uIGZpbmdlcnMiKSkgYWRkICo9IDU7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJCaWxsaW9uIGZpbmdlcnMiKSkgYWRkICo9IDEwOwogICAgICAgIGlmIChHYW1lLkhhcygiVHJpbGxpb24gZmluZ2VycyIpKSBhZGQgKj0gMjA7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJRdWFkcmlsbGlvbiBmaW5nZXJzIikpIGFkZCAqPSAyMDsKICAgICAgICBpZiAoR2FtZS5IYXMoIlF1aW50aWxsaW9uIGZpbmdlcnMiKSkgYWRkICo9IDIwOwogICAgICAgIGlmIChHYW1lLkhhcygiU2V4dGlsbGlvbiBmaW5nZXJzIikpIGFkZCAqPSAyMDsKICAgICAgICBpZiAoR2FtZS5IYXMoIlNlcHRpbGxpb24gZmluZ2VycyIpKSBhZGQgKj0gMjA7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJPY3RpbGxpb24gZmluZ2VycyIpKSBhZGQgKj0gMjA7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJOb25pbGxpb24gZmluZ2VycyIpKSBhZGQgKj0gMjA7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJEZWNpbGxpb24gZmluZ2VycyIpKSBhZGQgKj0gMjA7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJVbnNoYWNrbGVkIGN1cnNvcnMiKSkgYWRkICo9IDI1OwogICAgICAgIHZhciBtdWx0ID0gMTsKICAgICAgICB2YXIgbnVtID0gMDsKICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0cykgewogICAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1tpXS5uYW1lICE9ICJDdXJzb3IiKSBudW0gKz0gR2FtZS5PYmplY3RzW2ldLmFtb3VudDsKICAgICAgICB9CiAgICAgICAgYWRkID0gYWRkICogbnVtOwogICAgICAgIG11bHQgKj0gR2FtZS5HZXRUaWVyZWRDcHNNdWx0KG1lKTsKICAgICAgICBtdWx0ICo9IEdhbWUubWFnaWNDcFMoIkN1cnNvciIpOwogICAgICAgIG11bHQgKj0gR2FtZS5lZmYoImN1cnNvckNwcyIpOwogICAgICAgIHJldHVybiAoCiAgICAgICAgICBHYW1lLkNvbXB1dGVDcHMoCiAgICAgICAgICAgIDAuMSwKICAgICAgICAgICAgR2FtZS5IYXMoIlJlaW5mb3JjZWQgaW5kZXggZmluZ2VyIikgKwogICAgICAgICAgICAgIEdhbWUuSGFzKCJDYXJwYWwgdHVubmVsIHByZXZlbnRpb24gY3JlYW0iKSArCiAgICAgICAgICAgICAgR2FtZS5IYXMoIkFtYmlkZXh0cm91cyIpLAogICAgICAgICAgICBhZGQKICAgICAgICAgICkgKiBtdWx0CiAgICAgICAgKTsKICAgICAgfSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIGlmICh0aGlzLmFtb3VudCA+PSAxKQogICAgICAgICAgR2FtZS5VbmxvY2soWwogICAgICAgICAgICAiUmVpbmZvcmNlZCBpbmRleCBmaW5nZXIiLAogICAgICAgICAgICAiQ2FycGFsIHR1bm5lbCBwcmV2ZW50aW9uIGNyZWFtIiwKICAgICAgICAgIF0pOwogICAgICAgIGlmICh0aGlzLmFtb3VudCA+PSAxMCkgR2FtZS5VbmxvY2soIkFtYmlkZXh0cm91cyIpOwogICAgICAgIGlmICh0aGlzLmFtb3VudCA+PSAyNSkgR2FtZS5VbmxvY2soIlRob3VzYW5kIGZpbmdlcnMiKTsKICAgICAgICBpZiAodGhpcy5hbW91bnQgPj0gNTApIEdhbWUuVW5sb2NrKCJNaWxsaW9uIGZpbmdlcnMiKTsKICAgICAgICBpZiAodGhpcy5hbW91bnQgPj0gMTAwKSBHYW1lLlVubG9jaygiQmlsbGlvbiBmaW5nZXJzIik7CiAgICAgICAgaWYgKHRoaXMuYW1vdW50ID49IDE1MCkgR2FtZS5VbmxvY2soIlRyaWxsaW9uIGZpbmdlcnMiKTsKICAgICAgICBpZiAodGhpcy5hbW91bnQgPj0gMjAwKSBHYW1lLlVubG9jaygiUXVhZHJpbGxpb24gZmluZ2VycyIpOwogICAgICAgIGlmICh0aGlzLmFtb3VudCA+PSAyNTApIEdhbWUuVW5sb2NrKCJRdWludGlsbGlvbiBmaW5nZXJzIik7CiAgICAgICAgaWYgKHRoaXMuYW1vdW50ID49IDMwMCkgR2FtZS5VbmxvY2soIlNleHRpbGxpb24gZmluZ2VycyIpOwogICAgICAgIGlmICh0aGlzLmFtb3VudCA+PSAzNTApIEdhbWUuVW5sb2NrKCJTZXB0aWxsaW9uIGZpbmdlcnMiKTsKICAgICAgICBpZiAodGhpcy5hbW91bnQgPj0gNDAwKSBHYW1lLlVubG9jaygiT2N0aWxsaW9uIGZpbmdlcnMiKTsKICAgICAgICBpZiAodGhpcy5hbW91bnQgPj0gNDUwKSBHYW1lLlVubG9jaygiTm9uaWxsaW9uIGZpbmdlcnMiKTsKICAgICAgICBpZiAodGhpcy5hbW91bnQgPj0gNTAwKSBHYW1lLlVubG9jaygiRGVjaWxsaW9uIGZpbmdlcnMiKTsKCiAgICAgICAgaWYgKHRoaXMuYW1vdW50ID49IDEpIEdhbWUuV2luKCJDbGljayIpOwogICAgICAgIGlmICh0aGlzLmFtb3VudCA+PSAyKSBHYW1lLldpbigiRG91YmxlLWNsaWNrIik7CiAgICAgICAgaWYgKHRoaXMuYW1vdW50ID49IDUwKSBHYW1lLldpbigiTW91c2Ugd2hlZWwiKTsKICAgICAgICBpZiAodGhpcy5hbW91bnQgPj0gMTAwKSBHYW1lLldpbigiT2YgTWljZSBhbmQgTWVuIik7CiAgICAgICAgaWYgKHRoaXMuYW1vdW50ID49IDIwMCkgR2FtZS5XaW4oIlRoZSBEaWdpdGFsIik7CiAgICAgICAgaWYgKHRoaXMuYW1vdW50ID49IDMwMCkgR2FtZS5XaW4oIkV4dHJlbWUgcG9seWRhY3R5bHkiKTsKICAgICAgICBpZiAodGhpcy5hbW91bnQgPj0gNDAwKSBHYW1lLldpbigiRHIuIFQiKTsKICAgICAgICBpZiAodGhpcy5hbW91bnQgPj0gNTAwKSBHYW1lLldpbigiVGh1bWJzLCBwaGFsYW5nZXMsIG1ldGFjYXJwYWxzIik7CiAgICAgICAgaWYgKHRoaXMuYW1vdW50ID49IDYwMCkgR2FtZS5XaW4oIldpdGggaGVyIGZpbmdlciBhbmQgaGVyIHRodW1iIik7CiAgICAgICAgaWYgKHRoaXMuYW1vdW50ID49IDcwMCkgR2FtZS5XaW4oIkdvdHRhIGhhbmQgaXQgdG8geW91Iik7CiAgICAgICAgaWYgKHRoaXMuYW1vdW50ID49IDgwMCkgR2FtZS5XaW4oIlRoZSBkZXZpbCdzIHdvcmtzaG9wIik7CiAgICAgIH0KICAgICk7CgogICAgR2FtZS5TcGVjaWFsR3JhbmRtYVVubG9jayA9IDE1OwogICAgbmV3IEdhbWUuT2JqZWN0KAogICAgICAiR3JhbmRtYSIsCiAgICAgICJncmFuZG1hfGdyYW5kbWFzfGJha2VkfEdyYW5kbWFzIGFyZSBbWF0geWVhciBvbGRlcnxHcmFuZG1hcyBhcmUgW1hdIHllYXJzIG9sZGVyIiwKICAgICAgIkEgbmljZSBncmFuZG1hIHRvIGJha2UgbW9yZSBjb29raWVzLiIsCiAgICAgIDEsCiAgICAgIDEsCiAgICAgIHsKICAgICAgICBwaWM6IGZ1bmN0aW9uIChpKSB7CiAgICAgICAgICB2YXIgbGlzdCA9IFsiZ3JhbmRtYSJdOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJGYXJtZXIgZ3JhbmRtYXMiKSkgbGlzdC5wdXNoKCJmYXJtZXJHcmFuZG1hIik7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIldvcmtlciBncmFuZG1hcyIpKSBsaXN0LnB1c2goIndvcmtlckdyYW5kbWEiKTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiTWluZXIgZ3JhbmRtYXMiKSkgbGlzdC5wdXNoKCJtaW5lckdyYW5kbWEiKTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiQ29zbWljIGdyYW5kbWFzIikpIGxpc3QucHVzaCgiY29zbWljR3JhbmRtYSIpOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJUcmFuc211dGVkIGdyYW5kbWFzIikpIGxpc3QucHVzaCgidHJhbnNtdXRlZEdyYW5kbWEiKTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiQWx0ZXJlZCBncmFuZG1hcyIpKSBsaXN0LnB1c2goImFsdGVyZWRHcmFuZG1hIik7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIkdyYW5kbWFzJyBncmFuZG1hcyIpKSBsaXN0LnB1c2goImdyYW5kbWFzR3JhbmRtYSIpOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJBbnRpZ3JhbmRtYXMiKSkgbGlzdC5wdXNoKCJhbnRpR3JhbmRtYSIpOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJSYWluYm93IGdyYW5kbWFzIikpIGxpc3QucHVzaCgicmFpbmJvd0dyYW5kbWEiKTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiQmFua2VyIGdyYW5kbWFzIikpIGxpc3QucHVzaCgiYmFua0dyYW5kbWEiKTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiUHJpZXN0ZXNzIGdyYW5kbWFzIikpIGxpc3QucHVzaCgidGVtcGxlR3JhbmRtYSIpOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJXaXRjaCBncmFuZG1hcyIpKSBsaXN0LnB1c2goIndpdGNoR3JhbmRtYSIpOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJMdWNreSBncmFuZG1hcyIpKSBsaXN0LnB1c2goImx1Y2t5R3JhbmRtYSIpOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJNZXRhZ3JhbmRtYXMiKSkgbGlzdC5wdXNoKCJtZXRhR3JhbmRtYSIpOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJTY3JpcHQgZ3Jhbm5pZXMiKSkgbGlzdC5wdXNoKCJzY3JpcHRHcmFuZG1hIik7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIkFsdGVybmF0ZSBncmFuZG1hcyIpKSBsaXN0LnB1c2goImFsdGVybmF0ZUdyYW5kbWEiKTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiQnJhaW55IGdyYW5kbWFzIikpIGxpc3QucHVzaCgiYnJhaW55R3JhbmRtYSIpOwogICAgICAgICAgaWYgKEdhbWUuc2Vhc29uID09ICJjaHJpc3RtYXMiKSBsaXN0LnB1c2goImVsZkdyYW5kbWEiKTsKICAgICAgICAgIGlmIChHYW1lLnNlYXNvbiA9PSAiZWFzdGVyIikgbGlzdC5wdXNoKCJidW5ueUdyYW5kbWEiKTsKICAgICAgICAgIHJldHVybiBjaG9vc2UobGlzdCkgKyAiLnBuZyI7CiAgICAgICAgfSwKICAgICAgICBiZzogImdyYW5kbWFCYWNrZ3JvdW5kLnBuZyIsCiAgICAgICAgeFY6IDgsCiAgICAgICAgeVY6IDgsCiAgICAgICAgdzogMzIsCiAgICAgICAgcm93czogMywKICAgICAgICB4OiAwLAogICAgICAgIHk6IDE2LAogICAgICB9LAogICAgICAxMDAsCiAgICAgIGZ1bmN0aW9uIChtZSkgewogICAgICAgIHZhciBtdWx0ID0gMTsKICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuR3JhbmRtYVN5bmVyZ2llcykgewogICAgICAgICAgaWYgKEdhbWUuSGFzKEdhbWUuR3JhbmRtYVN5bmVyZ2llc1tpXSkpIG11bHQgKj0gMjsKICAgICAgICB9CiAgICAgICAgaWYgKEdhbWUuSGFzKCJCaW5nbyBjZW50ZXIvUmVzZWFyY2ggZmFjaWxpdHkiKSkgbXVsdCAqPSA0OwogICAgICAgIGlmIChHYW1lLkhhcygiUml0dWFsIHJvbGxpbmcgcGlucyIpKSBtdWx0ICo9IDI7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJOYXVnaHR5IGxpc3QiKSkgbXVsdCAqPSAyOwoKICAgICAgICBpZiAoR2FtZS5IYXMoIkVsZGVyd29ydCBiaXNjdWl0cyIpKSBtdWx0ICo9IDEuMDI7CgogICAgICAgIG11bHQgKj0gR2FtZS5lZmYoImdyYW5kbWFDcHMiKTsKCiAgICAgICAgaWYgKEdhbWUuSGFzKCJDYXQgbGFkaWVzIikpIHsKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgR2FtZS5VcGdyYWRlc0J5UG9vbFsia2l0dGVuIl0ubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKEdhbWUuSGFzKEdhbWUuVXBncmFkZXNCeVBvb2xbImtpdHRlbiJdW2ldLm5hbWUpKSBtdWx0ICo9IDEuMjk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBtdWx0ICo9IEdhbWUuR2V0VGllcmVkQ3BzTXVsdChtZSk7CgogICAgICAgIHZhciBhZGQgPSAwOwogICAgICAgIGlmIChHYW1lLkhhcygiT25lIG1pbmQiKSkgYWRkICs9IEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLmFtb3VudCAqIDAuMDI7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJDb21tdW5hbCBicmFpbnN3ZWVwIikpCiAgICAgICAgICBhZGQgKz0gR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0uYW1vdW50ICogMC4wMjsKICAgICAgICBpZiAoR2FtZS5IYXMoIkVsZGVyIFBhY3QiKSkgYWRkICs9IEdhbWUuT2JqZWN0c1siUG9ydGFsIl0uYW1vdW50ICogMC4wNTsKCiAgICAgICAgdmFyIG51bSA9IDA7CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICAgIGlmIChHYW1lLk9iamVjdHNbaV0ubmFtZSAhPSAiR3JhbmRtYSIpIG51bSArPSBHYW1lLk9iamVjdHNbaV0uYW1vdW50OwogICAgICAgIH0KICAgICAgICAvL2lmIChHYW1lLmhhc0F1cmEoJ0VsZGVyIEJhdHRhbGlvbicpKSBtdWx0Kj0xKzAuMDEqbnVtOwogICAgICAgIG11bHQgKj0gMSArIEdhbWUuYXVyYU11bHQoIkVsZGVyIEJhdHRhbGlvbiIpICogMC4wMSAqIG51bTsKCiAgICAgICAgbXVsdCAqPSBHYW1lLm1hZ2ljQ3BTKG1lLm5hbWUpOwoKICAgICAgICByZXR1cm4gKG1lLmJhc2VDcHMgKyBhZGQpICogbXVsdDsKICAgICAgfSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuVW5sb2NrVGllcmVkKHRoaXMpOwogICAgICB9CiAgICApOwogICAgR2FtZS5sYXN0LnNlbGxGdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgR2FtZS5XaW4oIkp1c3Qgd3JvbmciKTsKICAgICAgaWYgKHRoaXMuYW1vdW50ID09IDApIHsKICAgICAgICBHYW1lLkxvY2soIkVsZGVyIFBsZWRnZSIpOwogICAgICAgIEdhbWUuQ29sbGVjdFdyaW5rbGVycygpOwogICAgICAgIEdhbWUucGxlZGdlVCA9IDA7CiAgICAgIH0KICAgIH07CiAgICBHYW1lLmxhc3QuaWNvbkZ1bmMgPSBmdW5jdGlvbiAodHlwZSkgewogICAgICB2YXIgZ3JhbmRtYUljb25zID0gWwogICAgICAgIFswLCAxXSwKICAgICAgICBbMCwgMl0sCiAgICAgICAgWzEsIDJdLAogICAgICAgIFsyLCAyXSwKICAgICAgXTsKICAgICAgaWYgKHR5cGUgPT0gIm9mZiIpIHJldHVybiBbMCwgMV07CiAgICAgIGlmIChHYW1lLnByZWZzLm5vdFNjYXJ5ICYmIEdhbWUuZWxkZXJXcmF0aCA+IDApIHJldHVybiBbMywgMl07CiAgICAgIHJldHVybiBncmFuZG1hSWNvbnNbR2FtZS5lbGRlcldyYXRoXTsKICAgIH07CgogICAgbmV3IEdhbWUuT2JqZWN0KAogICAgICAiRmFybSIsCiAgICAgICJmYXJtfGZhcm1zfGhhcnZlc3RlZHxbWF0gbW9yZSBhY3JlfFtYXSBtb3JlIGFjcmVzIiwKICAgICAgIkdyb3dzIGNvb2tpZSBwbGFudHMgZnJvbSBjb29raWUgc2VlZHMuIiwKICAgICAgMywKICAgICAgMiwKICAgICAgeyBiYXNlOiAiZmFybSIsIHhWOiA4LCB5VjogOCwgdzogNjQsIHJvd3M6IDIsIHg6IDAsIHk6IDE2IH0sCiAgICAgIDUwMCwKICAgICAgZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgdmFyIG11bHQgPSAxOwogICAgICAgIG11bHQgKj0gR2FtZS5HZXRUaWVyZWRDcHNNdWx0KG1lKTsKICAgICAgICBtdWx0ICo9IEdhbWUubWFnaWNDcFMobWUubmFtZSk7CiAgICAgICAgcmV0dXJuIG1lLmJhc2VDcHMgKiBtdWx0OwogICAgICB9LAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5VbmxvY2tUaWVyZWQodGhpcyk7CiAgICAgICAgaWYgKAogICAgICAgICAgdGhpcy5hbW91bnQgPj0gR2FtZS5TcGVjaWFsR3JhbmRtYVVubG9jayAmJgogICAgICAgICAgR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0uYW1vdW50ID4gMAogICAgICAgICkKICAgICAgICAgIEdhbWUuVW5sb2NrKHRoaXMuZ3JhbmRtYS5uYW1lKTsKICAgICAgfQogICAgKTsKICAgIEdhbWUubGFzdC5taW5pZ2FtZVVybCA9ICJtaW5pZ2FtZUdhcmRlbi5qcyI7CiAgICBHYW1lLmxhc3QubWluaWdhbWVOYW1lID0gbG9jKCJHYXJkZW4iKTsKCiAgICBuZXcgR2FtZS5PYmplY3QoCiAgICAgICJNaW5lIiwKICAgICAgIm1pbmV8bWluZXN8bWluZWR8W1hdIG1pbGUgZGVlcGVyfFtYXSBtaWxlcyBkZWVwZXIiLAogICAgICAiTWluZXMgb3V0IGNvb2tpZSBkb3VnaCBhbmQgY2hvY29sYXRlIGNoaXBzLiIsCiAgICAgIDQsCiAgICAgIDMsCiAgICAgIHsgYmFzZTogIm1pbmUiLCB4VjogMTYsIHlWOiAxNiwgdzogNjQsIHJvd3M6IDIsIHg6IDAsIHk6IDI0IH0sCiAgICAgIDEwMDAwLAogICAgICBmdW5jdGlvbiAobWUpIHsKICAgICAgICB2YXIgbXVsdCA9IDE7CiAgICAgICAgbXVsdCAqPSBHYW1lLkdldFRpZXJlZENwc011bHQobWUpOwogICAgICAgIG11bHQgKj0gR2FtZS5tYWdpY0NwUyhtZS5uYW1lKTsKICAgICAgICByZXR1cm4gbWUuYmFzZUNwcyAqIG11bHQ7CiAgICAgIH0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLlVubG9ja1RpZXJlZCh0aGlzKTsKICAgICAgICBpZiAoCiAgICAgICAgICB0aGlzLmFtb3VudCA+PSBHYW1lLlNwZWNpYWxHcmFuZG1hVW5sb2NrICYmCiAgICAgICAgICBHYW1lLk9iamVjdHNbIkdyYW5kbWEiXS5hbW91bnQgPiAwCiAgICAgICAgKQogICAgICAgICAgR2FtZS5VbmxvY2sodGhpcy5ncmFuZG1hLm5hbWUpOwogICAgICB9CiAgICApOwoKICAgIG5ldyBHYW1lLk9iamVjdCgKICAgICAgIkZhY3RvcnkiLAogICAgICAiZmFjdG9yeXxmYWN0b3JpZXN8bWFzcy1wcm9kdWNlZHxbWF0gYWRkaXRpb25hbCBwYXRlbnR8W1hdIGFkZGl0aW9uYWwgcGF0ZW50cyIsCiAgICAgICJQcm9kdWNlcyBsYXJnZSBxdWFudGl0aWVzIG9mIGNvb2tpZXMuIiwKICAgICAgNSwKICAgICAgNCwKICAgICAgeyBiYXNlOiAiZmFjdG9yeSIsIHhWOiA4LCB5VjogMCwgdzogNjQsIHJvd3M6IDEsIHg6IDAsIHk6IC0yMiB9LAogICAgICAzMDAwLAogICAgICBmdW5jdGlvbiAobWUpIHsKICAgICAgICB2YXIgbXVsdCA9IDE7CiAgICAgICAgbXVsdCAqPSBHYW1lLkdldFRpZXJlZENwc011bHQobWUpOwogICAgICAgIG11bHQgKj0gR2FtZS5tYWdpY0NwUyhtZS5uYW1lKTsKICAgICAgICByZXR1cm4gbWUuYmFzZUNwcyAqIG11bHQ7CiAgICAgIH0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLlVubG9ja1RpZXJlZCh0aGlzKTsKICAgICAgICBpZiAoCiAgICAgICAgICB0aGlzLmFtb3VudCA+PSBHYW1lLlNwZWNpYWxHcmFuZG1hVW5sb2NrICYmCiAgICAgICAgICBHYW1lLk9iamVjdHNbIkdyYW5kbWEiXS5hbW91bnQgPiAwCiAgICAgICAgKQogICAgICAgICAgR2FtZS5VbmxvY2sodGhpcy5ncmFuZG1hLm5hbWUpOwogICAgICB9CiAgICApOwogICAgLy9HYW1lLmxhc3QubWluaWdhbWVVcmw9J21pbmlnYW1lRHVuZ2Vvbi5qcyc7Ly9ub3QgeWV0CiAgICBHYW1lLmxhc3QubWluaWdhbWVOYW1lID0gbG9jKCJEdW5nZW9uIik7CgogICAgbmV3IEdhbWUuT2JqZWN0KAogICAgICAiQmFuayIsCiAgICAgICJiYW5rfGJhbmtzfGJhbmtlZHxJbnRlcmVzdCByYXRlcyBbWF0lIGJldHRlcnxJbnRlcmVzdCByYXRlcyBbWF0lIGJldHRlciIsCiAgICAgICJHZW5lcmF0ZXMgY29va2llcyBmcm9tIGludGVyZXN0LiIsCiAgICAgIDYsCiAgICAgIDE1LAogICAgICB7IGJhc2U6ICJiYW5rIiwgeFY6IDgsIHlWOiA0LCB3OiA1Niwgcm93czogMSwgeDogMCwgeTogMTMgfSwKICAgICAgMCwKICAgICAgZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgdmFyIG11bHQgPSAxOwogICAgICAgIG11bHQgKj0gR2FtZS5HZXRUaWVyZWRDcHNNdWx0KG1lKTsKICAgICAgICBtdWx0ICo9IEdhbWUubWFnaWNDcFMobWUubmFtZSk7CiAgICAgICAgcmV0dXJuIG1lLmJhc2VDcHMgKiBtdWx0OwogICAgICB9LAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5VbmxvY2tUaWVyZWQodGhpcyk7CiAgICAgICAgaWYgKAogICAgICAgICAgdGhpcy5hbW91bnQgPj0gR2FtZS5TcGVjaWFsR3JhbmRtYVVubG9jayAmJgogICAgICAgICAgR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0uYW1vdW50ID4gMAogICAgICAgICkKICAgICAgICAgIEdhbWUuVW5sb2NrKHRoaXMuZ3JhbmRtYS5uYW1lKTsKICAgICAgfQogICAgKTsKICAgIEdhbWUubGFzdC5taW5pZ2FtZVVybCA9ICJtaW5pZ2FtZU1hcmtldC5qcyI7CiAgICBHYW1lLmxhc3QubWluaWdhbWVOYW1lID0gbG9jKCJTdG9jayBNYXJrZXQiKTsKCiAgICBuZXcgR2FtZS5PYmplY3QoCiAgICAgICJUZW1wbGUiLAogICAgICAidGVtcGxlfHRlbXBsZXN8ZGlzY292ZXJlZHxbWF0gc2FjcmVkIGFydGlmYWN0IHJldHJpZXZlZHxbWF0gc2FjcmVkIGFydGlmYWN0cyByZXRyaWV2ZWQiLAogICAgICAiRnVsbCBvZiBwcmVjaW91cywgYW5jaWVudCBjaG9jb2xhdGUuIiwKICAgICAgNywKICAgICAgMTYsCiAgICAgIHsgYmFzZTogInRlbXBsZSIsIHhWOiA4LCB5VjogNCwgdzogNzIsIHJvd3M6IDIsIHg6IDAsIHk6IC01IH0sCiAgICAgIDAsCiAgICAgIGZ1bmN0aW9uIChtZSkgewogICAgICAgIHZhciBtdWx0ID0gMTsKICAgICAgICBtdWx0ICo9IEdhbWUuR2V0VGllcmVkQ3BzTXVsdChtZSk7CiAgICAgICAgbXVsdCAqPSBHYW1lLm1hZ2ljQ3BTKG1lLm5hbWUpOwogICAgICAgIHJldHVybiBtZS5iYXNlQ3BzICogbXVsdDsKICAgICAgfSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuVW5sb2NrVGllcmVkKHRoaXMpOwogICAgICAgIGlmICgKICAgICAgICAgIHRoaXMuYW1vdW50ID49IEdhbWUuU3BlY2lhbEdyYW5kbWFVbmxvY2sgJiYKICAgICAgICAgIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLmFtb3VudCA+IDAKICAgICAgICApCiAgICAgICAgICBHYW1lLlVubG9jayh0aGlzLmdyYW5kbWEubmFtZSk7CiAgICAgIH0KICAgICk7CiAgICBHYW1lLmxhc3QubWluaWdhbWVVcmwgPSAibWluaWdhbWVQYW50aGVvbi5qcyI7CiAgICBHYW1lLmxhc3QubWluaWdhbWVOYW1lID0gbG9jKCJQYW50aGVvbiIpOwoKICAgIG5ldyBHYW1lLk9iamVjdCgKICAgICAgIldpemFyZCB0b3dlciIsCiAgICAgICJ3aXphcmQgdG93ZXJ8d2l6YXJkIHRvd2Vyc3xzdW1tb25lZHxJbmNhbnRhdGlvbnMgaGF2ZSBbWF0gbW9yZSBzeWxsYWJsZXxJbmNhbnRhdGlvbnMgaGF2ZSBbWF0gbW9yZSBzeWxsYWJsZXMiLAogICAgICAiU3VtbW9ucyBjb29raWVzIHdpdGggbWFnaWMgc3BlbGxzLiIsCiAgICAgIDgsCiAgICAgIDE3LAogICAgICB7IGJhc2U6ICJ3aXphcmR0b3dlciIsIHhWOiAxNiwgeVY6IDE2LCB3OiA0OCwgcm93czogMiwgeDogMCwgeTogMjAgfSwKICAgICAgMCwKICAgICAgZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgdmFyIG11bHQgPSAxOwogICAgICAgIG11bHQgKj0gR2FtZS5HZXRUaWVyZWRDcHNNdWx0KG1lKTsKICAgICAgICBtdWx0ICo9IEdhbWUubWFnaWNDcFMobWUubmFtZSk7CiAgICAgICAgcmV0dXJuIG1lLmJhc2VDcHMgKiBtdWx0OwogICAgICB9LAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5VbmxvY2tUaWVyZWQodGhpcyk7CiAgICAgICAgaWYgKAogICAgICAgICAgdGhpcy5hbW91bnQgPj0gR2FtZS5TcGVjaWFsR3JhbmRtYVVubG9jayAmJgogICAgICAgICAgR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0uYW1vdW50ID4gMAogICAgICAgICkKICAgICAgICAgIEdhbWUuVW5sb2NrKHRoaXMuZ3JhbmRtYS5uYW1lKTsKICAgICAgfQogICAgKTsKICAgIEdhbWUubGFzdC5kaXNwbGF5TmFtZSA9CiAgICAgICc8c3BhbiBzdHlsZT0iZm9udC1zaXplOjkwJTtsZXR0ZXItc3BhY2luZzotMXB4O3Bvc2l0aW9uOnJlbGF0aXZlO2JvdHRvbToycHg7Ij5XaXphcmQgdG93ZXI8L3NwYW4+JzsgLy9zaHJpbmsKICAgIEdhbWUubGFzdC5taW5pZ2FtZVVybCA9ICJtaW5pZ2FtZUdyaW1vaXJlLmpzIjsKICAgIEdhbWUubGFzdC5taW5pZ2FtZU5hbWUgPSBsb2MoIkdyaW1vaXJlIik7CgogICAgbmV3IEdhbWUuT2JqZWN0KAogICAgICAiU2hpcG1lbnQiLAogICAgICAic2hpcG1lbnR8c2hpcG1lbnRzfHNoaXBwZWR8W1hdIGdhbGF4eSBmdWxseSBleHBsb3JlZHxbWF0gZ2FsYXhpZXMgZnVsbHkgZXhwbG9yZWQiLAogICAgICAiQnJpbmdzIGluIGZyZXNoIGNvb2tpZXMgZnJvbSB0aGUgY29va2llIHBsYW5ldC4iLAogICAgICA5LAogICAgICA1LAogICAgICB7IGJhc2U6ICJzaGlwbWVudCIsIHhWOiAxNiwgeVY6IDE2LCB3OiA2NCwgcm93czogMSwgeDogMCwgeTogMCB9LAogICAgICA0MDAwMCwKICAgICAgZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgdmFyIG11bHQgPSAxOwogICAgICAgIG11bHQgKj0gR2FtZS5HZXRUaWVyZWRDcHNNdWx0KG1lKTsKICAgICAgICBtdWx0ICo9IEdhbWUubWFnaWNDcFMobWUubmFtZSk7CiAgICAgICAgcmV0dXJuIG1lLmJhc2VDcHMgKiBtdWx0OwogICAgICB9LAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5VbmxvY2tUaWVyZWQodGhpcyk7CiAgICAgICAgaWYgKAogICAgICAgICAgdGhpcy5hbW91bnQgPj0gR2FtZS5TcGVjaWFsR3JhbmRtYVVubG9jayAmJgogICAgICAgICAgR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0uYW1vdW50ID4gMAogICAgICAgICkKICAgICAgICAgIEdhbWUuVW5sb2NrKHRoaXMuZ3JhbmRtYS5uYW1lKTsKICAgICAgfQogICAgKTsKCiAgICBuZXcgR2FtZS5PYmplY3QoCiAgICAgICJBbGNoZW15IGxhYiIsCiAgICAgICJhbGNoZW15IGxhYnxhbGNoZW15IGxhYnN8dHJhbnNtdXRlZHxbWF0gcHJpbW9yZGlhbCBlbGVtZW50IG1hc3RlcmVkfFtYXSBwcmltb3JkaWFsIGVsZW1lbnRzIG1hc3RlcmVkIiwKICAgICAgIlR1cm5zIGdvbGQgaW50byBjb29raWVzISIsCiAgICAgIDEwLAogICAgICA2LAogICAgICB7IGJhc2U6ICJhbGNoZW15bGFiIiwgeFY6IDE2LCB5VjogMTYsIHc6IDY0LCByb3dzOiAyLCB4OiAwLCB5OiAxNiB9LAogICAgICAyMDAwMDAsCiAgICAgIGZ1bmN0aW9uIChtZSkgewogICAgICAgIHZhciBtdWx0ID0gMTsKICAgICAgICBtdWx0ICo9IEdhbWUuR2V0VGllcmVkQ3BzTXVsdChtZSk7CiAgICAgICAgbXVsdCAqPSBHYW1lLm1hZ2ljQ3BTKG1lLm5hbWUpOwogICAgICAgIHJldHVybiBtZS5iYXNlQ3BzICogbXVsdDsKICAgICAgfSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuVW5sb2NrVGllcmVkKHRoaXMpOwogICAgICAgIGlmICgKICAgICAgICAgIHRoaXMuYW1vdW50ID49IEdhbWUuU3BlY2lhbEdyYW5kbWFVbmxvY2sgJiYKICAgICAgICAgIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLmFtb3VudCA+IDAKICAgICAgICApCiAgICAgICAgICBHYW1lLlVubG9jayh0aGlzLmdyYW5kbWEubmFtZSk7CiAgICAgIH0KICAgICk7CiAgICBHYW1lLmxhc3QuZGlzcGxheU5hbWUgPQogICAgICAnPHNwYW4gc3R5bGU9ImZvbnQtc2l6ZTo5MCU7bGV0dGVyLXNwYWNpbmc6LTFweDtwb3NpdGlvbjpyZWxhdGl2ZTtib3R0b206MnB4OyI+QWxjaGVteSBsYWI8L3NwYW4+JzsgLy9zaHJpbmsKCiAgICBuZXcgR2FtZS5PYmplY3QoCiAgICAgICJQb3J0YWwiLAogICAgICAicG9ydGFsfHBvcnRhbHN8cmV0cmlldmVkfFtYXSBkaW1lbnNpb24gZW5zbGF2ZWR8W1hdIGRpbWVuc2lvbnMgZW5zbGF2ZWQiLAogICAgICAiT3BlbnMgYSBkb29yIHRvIHRoZSBDb29raWV2ZXJzZS4iLAogICAgICAxMSwKICAgICAgNywKICAgICAgeyBiYXNlOiAicG9ydGFsIiwgeFY6IDMyLCB5VjogMzIsIHc6IDY0LCByb3dzOiAyLCB4OiAwLCB5OiAwIH0sCiAgICAgIDE2NjY2NjYsCiAgICAgIGZ1bmN0aW9uIChtZSkgewogICAgICAgIHZhciBtdWx0ID0gMTsKICAgICAgICBtdWx0ICo9IEdhbWUuR2V0VGllcmVkQ3BzTXVsdChtZSk7CiAgICAgICAgbXVsdCAqPSBHYW1lLm1hZ2ljQ3BTKG1lLm5hbWUpOwogICAgICAgIHJldHVybiBtZS5iYXNlQ3BzICogbXVsdDsKICAgICAgfSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuVW5sb2NrVGllcmVkKHRoaXMpOwogICAgICAgIGlmICgKICAgICAgICAgIHRoaXMuYW1vdW50ID49IEdhbWUuU3BlY2lhbEdyYW5kbWFVbmxvY2sgJiYKICAgICAgICAgIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLmFtb3VudCA+IDAKICAgICAgICApCiAgICAgICAgICBHYW1lLlVubG9jayh0aGlzLmdyYW5kbWEubmFtZSk7CiAgICAgIH0KICAgICk7CgogICAgbmV3IEdhbWUuT2JqZWN0KAogICAgICAiVGltZSBtYWNoaW5lIiwKICAgICAgInRpbWUgbWFjaGluZXx0aW1lIG1hY2hpbmVzfHJlY292ZXJlZHxbWF0gY2VudHVyeSBzZWN1cmVkfFtYXSBjZW50dXJpZXMgc2VjdXJlZCIsCiAgICAgICJCcmluZ3MgY29va2llcyBmcm9tIHRoZSBwYXN0LCBiZWZvcmUgdGhleSB3ZXJlIGV2ZW4gZWF0ZW4uIiwKICAgICAgMTIsCiAgICAgIDgsCiAgICAgIHsgYmFzZTogInRpbWVtYWNoaW5lIiwgeFY6IDMyLCB5VjogMzIsIHc6IDY0LCByb3dzOiAxLCB4OiAwLCB5OiAwIH0sCiAgICAgIDEyMzQ1Njc4OSwKICAgICAgZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgdmFyIG11bHQgPSAxOwogICAgICAgIG11bHQgKj0gR2FtZS5HZXRUaWVyZWRDcHNNdWx0KG1lKTsKICAgICAgICBtdWx0ICo9IEdhbWUubWFnaWNDcFMobWUubmFtZSk7CiAgICAgICAgcmV0dXJuIG1lLmJhc2VDcHMgKiBtdWx0OwogICAgICB9LAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5VbmxvY2tUaWVyZWQodGhpcyk7CiAgICAgICAgaWYgKAogICAgICAgICAgdGhpcy5hbW91bnQgPj0gR2FtZS5TcGVjaWFsR3JhbmRtYVVubG9jayAmJgogICAgICAgICAgR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0uYW1vdW50ID4gMAogICAgICAgICkKICAgICAgICAgIEdhbWUuVW5sb2NrKHRoaXMuZ3JhbmRtYS5uYW1lKTsKICAgICAgfQogICAgKTsKICAgIEdhbWUubGFzdC5kaXNwbGF5TmFtZSA9CiAgICAgICc8c3BhbiBzdHlsZT0iZm9udC1zaXplOjgwJTtsZXR0ZXItc3BhY2luZzotMXB4O3Bvc2l0aW9uOnJlbGF0aXZlO2JvdHRvbTozcHg7Ij5UaW1lIG1hY2hpbmU8L3NwYW4+JzsgLy9zaHJpbmsKCiAgICBuZXcgR2FtZS5PYmplY3QoCiAgICAgICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsCiAgICAgICJhbnRpbWF0dGVyIGNvbmRlbnNlcnxhbnRpbWF0dGVyIGNvbmRlbnNlcnN8Y29uZGVuc2VkfFtYXSBleHRyYSBxdWFyayBmbGF2b3J8W1hdIGV4dHJhIHF1YXJrIGZsYXZvcnMiLAogICAgICAiQ29uZGVuc2VzIHRoZSBhbnRpbWF0dGVyIGluIHRoZSB1bml2ZXJzZSBpbnRvIGNvb2tpZXMuIiwKICAgICAgMTMsCiAgICAgIDEzLAogICAgICB7CiAgICAgICAgYmFzZTogImFudGltYXR0ZXJjb25kZW5zZXIiLAogICAgICAgIHhWOiAwLAogICAgICAgIHlWOiA2NCwKICAgICAgICB3OiA2NCwKICAgICAgICByb3dzOiAxLAogICAgICAgIHg6IDAsCiAgICAgICAgeTogMCwKICAgICAgfSwKICAgICAgMzk5OTk5OTk5OSwKICAgICAgZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgdmFyIG11bHQgPSAxOwogICAgICAgIG11bHQgKj0gR2FtZS5HZXRUaWVyZWRDcHNNdWx0KG1lKTsKICAgICAgICBtdWx0ICo9IEdhbWUubWFnaWNDcFMobWUubmFtZSk7CiAgICAgICAgcmV0dXJuIG1lLmJhc2VDcHMgKiBtdWx0OwogICAgICB9LAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5VbmxvY2tUaWVyZWQodGhpcyk7CiAgICAgICAgaWYgKAogICAgICAgICAgdGhpcy5hbW91bnQgPj0gR2FtZS5TcGVjaWFsR3JhbmRtYVVubG9jayAmJgogICAgICAgICAgR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0uYW1vdW50ID4gMAogICAgICAgICkKICAgICAgICAgIEdhbWUuVW5sb2NrKHRoaXMuZ3JhbmRtYS5uYW1lKTsKICAgICAgfQogICAgKTsKICAgIEdhbWUubGFzdC5kaXNwbGF5TmFtZSA9CiAgICAgICc8c3BhbiBzdHlsZT0iZm9udC1zaXplOjY1JTtsZXR0ZXItc3BhY2luZzotMXB4O3Bvc2l0aW9uOnJlbGF0aXZlO2JvdHRvbTo0cHg7Ij5BbnRpbS4gY29uZGVuc2VyPC9zcGFuPic7IC8vc2hyaW5rCgogICAgbmV3IEdhbWUuT2JqZWN0KAogICAgICAiUHJpc20iLAogICAgICAicHJpc218cHJpc21zfGNvbnZlcnRlZHxbWF0gbmV3IGNvbG9yIGRpc2NvdmVyZWR8W1hdIG5ldyBjb2xvcnMgZGlzY292ZXJlZCIsCiAgICAgICJDb252ZXJ0cyBsaWdodCBpdHNlbGYgaW50byBjb29raWVzLiIsCiAgICAgIDE0LAogICAgICAxNCwKICAgICAgeyBiYXNlOiAicHJpc20iLCB4VjogMTYsIHlWOiA0LCB3OiA2NCwgcm93czogMSwgeDogMCwgeTogMjAgfSwKICAgICAgNzUwMDAwMDAwMDAsCiAgICAgIGZ1bmN0aW9uIChtZSkgewogICAgICAgIHZhciBtdWx0ID0gMTsKICAgICAgICBtdWx0ICo9IEdhbWUuR2V0VGllcmVkQ3BzTXVsdChtZSk7CiAgICAgICAgbXVsdCAqPSBHYW1lLm1hZ2ljQ3BTKG1lLm5hbWUpOwogICAgICAgIHJldHVybiBtZS5iYXNlQ3BzICogbXVsdDsKICAgICAgfSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuVW5sb2NrVGllcmVkKHRoaXMpOwogICAgICAgIGlmICgKICAgICAgICAgIHRoaXMuYW1vdW50ID49IEdhbWUuU3BlY2lhbEdyYW5kbWFVbmxvY2sgJiYKICAgICAgICAgIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLmFtb3VudCA+IDAKICAgICAgICApCiAgICAgICAgICBHYW1lLlVubG9jayh0aGlzLmdyYW5kbWEubmFtZSk7CiAgICAgIH0KICAgICk7CgogICAgbmV3IEdhbWUuT2JqZWN0KAogICAgICAiQ2hhbmNlbWFrZXIiLAogICAgICAiY2hhbmNlbWFrZXJ8Y2hhbmNlbWFrZXJzfHNwb250YW5lb3VzbHkgZ2VuZXJhdGVkfENoYW5jZW1ha2VycyBhcmUgcG93ZXJlZCBieSBbWF0tbGVhZiBjbG92ZXJzfENoYW5jZW1ha2VycyBhcmUgcG93ZXJlZCBieSBbWF0tbGVhZiBjbG92ZXJzIiwKICAgICAgIkdlbmVyYXRlcyBjb29raWVzIG91dCBvZiB0aGluIGFpciB0aHJvdWdoIHNoZWVyIGx1Y2suIiwKICAgICAgMTUsCiAgICAgIDE5LAogICAgICB7CiAgICAgICAgYmFzZTogImNoYW5jZW1ha2VyIiwKICAgICAgICB4VjogOCwKICAgICAgICB5VjogNjQsCiAgICAgICAgdzogNjQsCiAgICAgICAgcm93czogMSwKICAgICAgICB4OiAwLAogICAgICAgIHk6IDAsCiAgICAgICAgcm93czogMiwKICAgICAgfSwKICAgICAgNzc3Nzc3Nzc3NzcsCiAgICAgIGZ1bmN0aW9uIChtZSkgewogICAgICAgIHZhciBtdWx0ID0gMTsKICAgICAgICBtdWx0ICo9IEdhbWUuR2V0VGllcmVkQ3BzTXVsdChtZSk7CiAgICAgICAgbXVsdCAqPSBHYW1lLm1hZ2ljQ3BTKG1lLm5hbWUpOwogICAgICAgIHJldHVybiBtZS5iYXNlQ3BzICogbXVsdDsKICAgICAgfSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuVW5sb2NrVGllcmVkKHRoaXMpOwogICAgICAgIGlmICgKICAgICAgICAgIHRoaXMuYW1vdW50ID49IEdhbWUuU3BlY2lhbEdyYW5kbWFVbmxvY2sgJiYKICAgICAgICAgIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLmFtb3VudCA+IDAKICAgICAgICApCiAgICAgICAgICBHYW1lLlVubG9jayh0aGlzLmdyYW5kbWEubmFtZSk7CiAgICAgIH0KICAgICk7CiAgICBHYW1lLmxhc3QuZGlzcGxheU5hbWUgPQogICAgICAnPHNwYW4gc3R5bGU9ImZvbnQtc2l6ZTo4NSU7bGV0dGVyLXNwYWNpbmc6LTFweDtwb3NpdGlvbjpyZWxhdGl2ZTtib3R0b206MnB4OyI+Q2hhbmNlbWFrZXI8L3NwYW4+JzsgLy9zaHJpbmsKCiAgICBuZXcgR2FtZS5PYmplY3QoCiAgICAgICJGcmFjdGFsIGVuZ2luZSIsCiAgICAgICJmcmFjdGFsIGVuZ2luZXxmcmFjdGFsIGVuZ2luZXN8bWFkZSBmcm9tIGNvb2tpZXN8W1hdIGl0ZXJhdGlvbiBkZWVwfFtYXSBpdGVyYXRpb25zIGRlZXAiLAogICAgICAiVHVybnMgY29va2llcyBpbnRvIGV2ZW4gbW9yZSBjb29raWVzLiIsCiAgICAgIDE2LAogICAgICAyMCwKICAgICAgeyBiYXNlOiAiZnJhY3RhbEVuZ2luZSIsIHhWOiA4LCB5VjogNjQsIHc6IDY0LCByb3dzOiAxLCB4OiAwLCB5OiAwIH0sCiAgICAgIDEyMzQ1Njc4OTg3NjU0MzIxLAogICAgICBmdW5jdGlvbiAobWUpIHsKICAgICAgICB2YXIgbXVsdCA9IDE7CiAgICAgICAgbXVsdCAqPSBHYW1lLkdldFRpZXJlZENwc011bHQobWUpOwogICAgICAgIG11bHQgKj0gR2FtZS5tYWdpY0NwUyhtZS5uYW1lKTsKICAgICAgICByZXR1cm4gbWUuYmFzZUNwcyAqIG11bHQ7CiAgICAgIH0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLlVubG9ja1RpZXJlZCh0aGlzKTsKICAgICAgICBpZiAoCiAgICAgICAgICB0aGlzLmFtb3VudCA+PSBHYW1lLlNwZWNpYWxHcmFuZG1hVW5sb2NrICYmCiAgICAgICAgICBHYW1lLk9iamVjdHNbIkdyYW5kbWEiXS5hbW91bnQgPiAwCiAgICAgICAgKQogICAgICAgICAgR2FtZS5VbmxvY2sodGhpcy5ncmFuZG1hLm5hbWUpOwogICAgICB9CiAgICApOwogICAgR2FtZS5sYXN0LmRpc3BsYXlOYW1lID0KICAgICAgJzxzcGFuIHN0eWxlPSJmb250LXNpemU6ODAlO2xldHRlci1zcGFjaW5nOi0xcHg7cG9zaXRpb246cmVsYXRpdmU7Ym90dG9tOjRweDsiPkZyYWN0YWwgZW5naW5lPC9zcGFuPic7IC8vc2hyaW5rCgogICAgbmV3IEdhbWUuT2JqZWN0KAogICAgICAiSmF2YXNjcmlwdCBjb25zb2xlIiwKICAgICAgImphdmFzY3JpcHQgY29uc29sZXxqYXZhc2NyaXB0IGNvbnNvbGVzfHByb2dyYW1tZWR8RXF1aXBwZWQgd2l0aCBbWF0gZXh0ZXJuYWwgbGlicmFyeXxFcXVpcHBlZCB3aXRoIFtYXSBleHRlcm5hbCBsaWJyYXJpZXMiLAogICAgICAiQ3JlYXRlcyBjb29raWVzIGZyb20gdGhlIHZlcnkgY29kZSB0aGlzIGdhbWUgd2FzIHdyaXR0ZW4gaW4uIiwKICAgICAgMTcsCiAgICAgIDMyLAogICAgICB7CiAgICAgICAgYmFzZTogImphdmFzY3JpcHRjb25zb2xlIiwKICAgICAgICB4VjogOCwKICAgICAgICB5VjogNjQsCiAgICAgICAgdzogMTQsCiAgICAgICAgcm93czogMSwKICAgICAgICB4OiA4LAogICAgICAgIHk6IC0zMiwKICAgICAgICBmcmFtZXM6IDIsCiAgICAgIH0sCiAgICAgIDEyMzQ1Njc4OTg3NjU0MzIxLAogICAgICBmdW5jdGlvbiAobWUpIHsKICAgICAgICB2YXIgbXVsdCA9IDE7CiAgICAgICAgbXVsdCAqPSBHYW1lLkdldFRpZXJlZENwc011bHQobWUpOwogICAgICAgIG11bHQgKj0gR2FtZS5tYWdpY0NwUyhtZS5uYW1lKTsKICAgICAgICByZXR1cm4gbWUuYmFzZUNwcyAqIG11bHQ7CiAgICAgIH0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLlVubG9ja1RpZXJlZCh0aGlzKTsKICAgICAgICBpZiAoCiAgICAgICAgICB0aGlzLmFtb3VudCA+PSBHYW1lLlNwZWNpYWxHcmFuZG1hVW5sb2NrICYmCiAgICAgICAgICBHYW1lLk9iamVjdHNbIkdyYW5kbWEiXS5hbW91bnQgPiAwCiAgICAgICAgKQogICAgICAgICAgR2FtZS5VbmxvY2sodGhpcy5ncmFuZG1hLm5hbWUpOwogICAgICB9CiAgICApOwogICAgR2FtZS5sYXN0LmRpc3BsYXlOYW1lID0KICAgICAgJzxzcGFuIHN0eWxlPSJmb250LXNpemU6NjUlO2xldHRlci1zcGFjaW5nOi0xcHg7cG9zaXRpb246cmVsYXRpdmU7Ym90dG9tOjRweDsiPkphdmFzY3JpcHQgY29uc29sZTwvc3Bhbj4nOyAvL3NocmluawoKICAgIG5ldyBHYW1lLk9iamVjdCgKICAgICAgIklkbGV2ZXJzZSIsCiAgICAgICJpZGxldmVyc2V8aWRsZXZlcnNlc3xoaWphY2tlZHxbWF0gbWFuaWZvbGR8W1hdIG1hbmlmb2xkcyIsCiAgICAgICJUaGVyZSdzIGJlZW4gY291bnRsZXNzIG90aGVyIGlkbGUgdW5pdmVyc2VzIHJ1bm5pbmcgYWxvbmdzaWRlIG91ciBvd24uIFlvdSd2ZSBmaW5hbGx5IGZvdW5kIGEgd2F5IHRvIGhpamFjayB0aGVpciBwcm9kdWN0aW9uIGFuZCBjb252ZXJ0IHdoYXRldmVyIHRoZXkndmUgYmVlbiBtYWtpbmcgaW50byBjb29raWVzISIsCiAgICAgIDE4LAogICAgICAzMywKICAgICAgewogICAgICAgIGJhc2U6ICJpZGxldmVyc2UiLAogICAgICAgIHhWOiA4LAogICAgICAgIHlWOiA5NiwKICAgICAgICB3OiA0OCwKICAgICAgICByb3dzOiAyLAogICAgICAgIHg6IDAsCiAgICAgICAgeTogMCwKICAgICAgICBmcmFtZXM6IDQsCiAgICAgIH0sCiAgICAgIDEyMzQ1Njc4OTg3NjU0MzIxLAogICAgICBmdW5jdGlvbiAobWUpIHsKICAgICAgICB2YXIgbXVsdCA9IDE7CiAgICAgICAgbXVsdCAqPSBHYW1lLkdldFRpZXJlZENwc011bHQobWUpOwogICAgICAgIG11bHQgKj0gR2FtZS5tYWdpY0NwUyhtZS5uYW1lKTsKICAgICAgICByZXR1cm4gbWUuYmFzZUNwcyAqIG11bHQ7CiAgICAgIH0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLlVubG9ja1RpZXJlZCh0aGlzKTsKICAgICAgICBpZiAoCiAgICAgICAgICB0aGlzLmFtb3VudCA+PSBHYW1lLlNwZWNpYWxHcmFuZG1hVW5sb2NrICYmCiAgICAgICAgICBHYW1lLk9iamVjdHNbIkdyYW5kbWEiXS5hbW91bnQgPiAwCiAgICAgICAgKQogICAgICAgICAgR2FtZS5VbmxvY2sodGhpcy5ncmFuZG1hLm5hbWUpOwogICAgICB9CiAgICApOwoKICAgIG5ldyBHYW1lLk9iamVjdCgKICAgICAgIkNvcnRleCBiYWtlciIsCiAgICAgICJjb3J0ZXggYmFrZXJ8Y29ydGV4IGJha2Vyc3xpbWFnaW5lZHxbWF0gZXh0cmEgSVEgcG9pbnR8W1hdIGV4dHJhIElRIHBvaW50cyIsCiAgICAgICJUaGVzZSBhcnRpZmljaWFsIGJyYWlucyB0aGUgc2l6ZSBvZiBwbGFuZXRzIGFyZSBjYXBhYmxlIG9mIHNpbXBseSBkcmVhbWluZyB1cCBjb29raWVzIGludG8gZXhpc3RlbmNlLiBUaW1lIGFuZCBzcGFjZSBhcmUgaW5jb25zZXF1ZW50aWFsLiBSZWFsaXR5IGlzIGFyYml0cmFyeS4iLAogICAgICAxOSwKICAgICAgMzQsCiAgICAgIHsgYmFzZTogImNvcnRleCIsIHhWOiA4LCB5VjogOTYsIHc6IDQ4LCByb3dzOiAxLCB4OiAwLCB5OiAwLCBmcmFtZXM6IDQgfSwKICAgICAgMTIzNDU2Nzg5ODc2NTQzMjEsCiAgICAgIGZ1bmN0aW9uIChtZSkgewogICAgICAgIHZhciBtdWx0ID0gMTsKICAgICAgICBtdWx0ICo9IEdhbWUuR2V0VGllcmVkQ3BzTXVsdChtZSk7CiAgICAgICAgbXVsdCAqPSBHYW1lLm1hZ2ljQ3BTKG1lLm5hbWUpOwogICAgICAgIHJldHVybiBtZS5iYXNlQ3BzICogbXVsdDsKICAgICAgfSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuVW5sb2NrVGllcmVkKHRoaXMpOwogICAgICAgIGlmICgKICAgICAgICAgIHRoaXMuYW1vdW50ID49IEdhbWUuU3BlY2lhbEdyYW5kbWFVbmxvY2sgJiYKICAgICAgICAgIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLmFtb3VudCA+IDAKICAgICAgICApCiAgICAgICAgICBHYW1lLlVubG9jayh0aGlzLmdyYW5kbWEubmFtZSk7CiAgICAgIH0KICAgICk7CgogICAgR2FtZS5mb29sT2JqZWN0cyA9IHsKICAgICAgVW5rbm93bjogewogICAgICAgIG5hbWU6ICJJbnZlc3RtZW50IiwKICAgICAgICBkZXNjOiAiWW91J3JlIG5vdCBzdXJlIHdoYXQgdGhpcyBkb2VzLCB5b3UganVzdCBrbm93IGl0IG1lYW5zIHByb2ZpdC4iLAogICAgICAgIGljb246IDAsCiAgICAgIH0sCiAgICAgIEN1cnNvcjogewogICAgICAgIG5hbWU6ICJSb2xsaW5nIHBpbiIsCiAgICAgICAgZGVzYzogIkVzc2VudGlhbCBpbiBmbGF0dGVuaW5nIGRvdWdoLiBUaGUgZmlyc3Qgc3RlcCBpbiBjb29raWUtbWFraW5nLiIsCiAgICAgICAgaWNvbjogMCwKICAgICAgfSwKICAgICAgR3JhbmRtYTogewogICAgICAgIG5hbWU6ICJPdmVuIiwKICAgICAgICBkZXNjOiAiQSBjcnVjaWFsIGVsZW1lbnQgb2YgYmFraW5nIGNvb2tpZXMuIiwKICAgICAgICBpY29uOiAxLAogICAgICB9LAogICAgICBGYXJtOiB7CiAgICAgICAgbmFtZTogIktpdGNoZW4iLAogICAgICAgIGRlc2M6ICJUaGUgbW9yZSBraXRjaGVucywgdGhlIG1vcmUgY29va2llcyB5b3VyIGVtcGxveWVlcyBjYW4gcHJvZHVjZS4iLAogICAgICAgIGljb246IDIsCiAgICAgIH0sCiAgICAgIE1pbmU6IHsKICAgICAgICBuYW1lOiAiU2VjcmV0IHJlY2lwZSIsCiAgICAgICAgZGVzYzogIlRoZXNlIGdpdmUgeW91IHRoZSBlZGdlIHlvdSBuZWVkIHRvIG91dHNlbGwgdGhvc2UgcGVza3kgY29tcGV0aXRvcnMuIiwKICAgICAgICBpY29uOiAzLAogICAgICB9LAogICAgICBGYWN0b3J5OiB7CiAgICAgICAgbmFtZTogIkZhY3RvcnkiLAogICAgICAgIGRlc2M6ICJNYXNzIHByb2R1Y3Rpb24gaXMgdGhlIGZ1dHVyZSBvZiBiYWtpbmcuIFNlaXplIHRoZSBkYXksIGFuZCBzeW5lcmdpemUhIiwKICAgICAgICBpY29uOiA0LAogICAgICB9LAogICAgICBCYW5rOiB7CiAgICAgICAgbmFtZTogIkludmVzdG9yIiwKICAgICAgICBkZXNjOiAiQnVzaW5lc3MgZm9sa3Mgd2l0aCBhIG5vc2UgZm9yIHByb2ZpdCwgcmVhZHkgdG8gZmluYW5jZSB5b3VyIHZlbnR1cmUgYXMgbG9uZyBhcyB0aGVyZSdzIG1vbmV5IHRvIGJlIG1hZGUuIiwKICAgICAgICBpY29uOiA1LAogICAgICB9LAogICAgICBUZW1wbGU6IHsKICAgICAgICBuYW1lOiAiTGlrZSIsCiAgICAgICAgZGVzYzogIllvdXIgc29jaWFsIG1lZGlhIHBhZ2UgaXMgZ29pbmcgdmlyYWwhIEFtYXNzaW5nIGxpa2VzIGlzIHRoZSBrZXkgdG8gYSBsYXN0aW5nIG9ubGluZSBwcmVzZW5jZSBhbmQganVpY3kgYWR2ZXJ0aXNpbmcgZGVhbHMuIiwKICAgICAgICBpY29uOiA5LAogICAgICB9LAogICAgICAiV2l6YXJkIHRvd2VyIjogewogICAgICAgIG5hbWU6ICJNZW1lIiwKICAgICAgICBkZXNjOiAiQ29va2llIG1lbWVzIGFyZSBhbGwgdGhlIHJhZ2UhIFdpdGgganVzdCB0aGUgcmlnaHQgYW1vdW50IG9mIHNvY2lhbCBtZWRpYSBhc3Ryb3R1cmZpbmcsIHlvdXIgYnJhbmQgaW1hZ2Ugd2lsbCBiZSBhbGwgb3ZlciB0aGUgY3liZXJzcGFjZS4iLAogICAgICAgIGljb246IDYsCiAgICAgIH0sCiAgICAgIFNoaXBtZW50OiB7CiAgICAgICAgbmFtZTogIlN1cGVybWFya2V0IiwKICAgICAgICBkZXNjOiAiQSBnaWdhbnRpYyBjb29raWUgZW1wb3JpdW0gLSB5b3VyIHZlcnkgb3duIHJldGFpbCBjaGFpbi4iLAogICAgICAgIGljb246IDcsCiAgICAgIH0sCiAgICAgICJBbGNoZW15IGxhYiI6IHsKICAgICAgICBuYW1lOiAiU3RvY2sgc2hhcmUiLAogICAgICAgIGRlc2M6ICJZb3UncmUgb2ZmaWNpYWxseSBvbiB0aGUgc3RvY2sgbWFya2V0LCBhbmQgZXZlcnlvbmUgd2FudHMgYSBwaWVjZSEiLAogICAgICAgIGljb246IDgsCiAgICAgIH0sCiAgICAgIFBvcnRhbDogewogICAgICAgIG5hbWU6ICJUViBzaG93IiwKICAgICAgICBkZXNjOiAiWW91ciBjb29raWVzIGhhdmUgdGhlaXIgb3duIHNpdGNvbSEgSGlsYXJpb3VzIGJha2luZyBoaWppbmtzIHNldCB0byB0aGUgY2hlZXNpZXN0IGxhdWdodHJhY2suIiwKICAgICAgICBpY29uOiAxMCwKICAgICAgfSwKICAgICAgIlRpbWUgbWFjaGluZSI6IHsKICAgICAgICBuYW1lOiAiVGhlbWUgcGFyayIsCiAgICAgICAgZGVzYzogIkNvb2tpZSB0aGVtZSBwYXJrcywgZnVsbCBvZiBtYXNjb3RzIGFuZCByb2xsZXItY29hc3RlcnMuIEJ1aWxkIG9uZSwgYnVpbGQgYSBodW5kcmVkISIsCiAgICAgICAgaWNvbjogMTEsCiAgICAgIH0sCiAgICAgICJBbnRpbWF0dGVyIGNvbmRlbnNlciI6IHsKICAgICAgICBuYW1lOiAiQ29va2llY29pbiIsCiAgICAgICAgZGVzYzogIkEgdmlydHVhbCBjdXJyZW5jeSwgYWxyZWFkeSByZXBsYWNpbmcgcmVndWxhciBtb25leSBpbiBzb21lIHNtYWxsIGNvdW50cmllcy4iLAogICAgICAgIGljb246IDEyLAogICAgICB9LAogICAgICBQcmlzbTogewogICAgICAgIG5hbWU6ICJDb3Jwb3JhdGUgY291bnRyeSIsCiAgICAgICAgZGVzYzogIllvdSd2ZSBtYWRlIGl0IHRvIHRoZSB0b3AsIGFuZCB5b3UgY2FuIG5vdyBidXkgZW50aXJlIG5hdGlvbnMgdG8gZnVydGhlciB5b3VyIGNvcnBvcmF0ZSBncmVlZC4gR29kc3BlZWQuIiwKICAgICAgICBpY29uOiAxMywKICAgICAgfSwKICAgICAgQ2hhbmNlbWFrZXI6IHsKICAgICAgICBuYW1lOiAiUHJpdmF0aXplZCBwbGFuZXQiLAogICAgICAgIGRlc2M6ICJBY3R1YWxseSwgeW91IGtub3cgd2hhdCdzIGNvb2w/IEEgd2hvbGUgcGxhbmV0IGRlZGljYXRlZCB0byBwcm9kdWNpbmcsIGFkdmVydGlzaW5nLCBzZWxsaW5nLCBhbmQgY29uc3VtaW5nIHlvdXIgY29va2llcy4iLAogICAgICAgIGljb246IDE1LAogICAgICB9LAogICAgICAiRnJhY3RhbCBlbmdpbmUiOiB7CiAgICAgICAgbmFtZTogIlNlbmF0ZSBzZWF0IiwKICAgICAgICBkZXNjOiAiT25seSB0aHJvdWdoIHBvbGl0aWNhbCBkb21pbmlvbiBjYW4geW91IHRydWx5IGFsdGVyIHRoaXMgd29ybGQgdG8gY3JlYXRlIGEgYnJpZ2h0ZXIsIG1vcmUgY29va2llLWZyaWVuZGx5IGZ1dHVyZS4iLAogICAgICAgIGljb246IDE2LAogICAgICB9LAogICAgICAiSmF2YXNjcmlwdCBjb25zb2xlIjogewogICAgICAgIG5hbWU6ICJEb2N0cmluZSIsCiAgICAgICAgZGVzYzogIlRha2luZyBtYW55IGZvcm1zIC1yZWxpZ2lvbiwgY3VsdHVyZSwgcGhpbG9zb3BoeS0gYSBkb2N0cmluZSBtYXksIHdoZW4gaGFuZGxlZCBwcm9wZXJseSwgY2F1c2UgYSBsYXN0aW5nIGltcGFjdCBvbiBjaXZpbGl6YXRpb25zLCByZXNoYXBpbmcgbWluZHMgYW5kIHBlb3BsZSBhbmQgZW5zdXJpbmcgYWxsIGZ1dHVyZSBnZW5lcmF0aW9ucyBzaGFyZSBhIHNpbmd1bGFyIGdvYWwgLSB0aGUgcHJvZHVjdGlvbiwgYW5kIGFjcXVpc2l0aW9uLCBvZiBtb3JlIGNvb2tpZXMuIiwKICAgICAgICBpY29uOiAxNywKICAgICAgfSwKICAgICAgSWRsZXZlcnNlOiB7CiAgICAgICAgbmFtZTogIkxhdGVyYWwgZXhwYW5zaW9ucyIsCiAgICAgICAgZGVzYzogIlNvbWV0aW1lcyB0aGUgYmVzdCB3YXkgdG8ga2VlcCBnb2luZyB1cCBpcyBzaWRld2F5cy4gRGl2ZXJzaWZ5IHlvdXIgdmVudHVyZXMgdGhyb3VnaCBub24tY29va2llIGludmVzdG1lbnRzLiIsCiAgICAgICAgaWNvbjogMTgsCiAgICAgIH0sCiAgICAgICJDb3J0ZXggYmFrZXIiOiB7CiAgICAgICAgbmFtZTogIlRoaW5rIHRhbmsiLAogICAgICAgIGRlc2M6ICJUaGVyZSdzIG9ubHkgc28gbWFueSB3YXlzIHlvdSBjYW4gYnJpbmcgaW4gbW9yZSBwcm9maXQuIE9yIGlzIHRoZXJlPyBIaXJlIHRoZSBtb3N0IGJyaWxsaWFudCBleHBlcnRzIGluIHRoZSBrbm93biB1bml2ZXJzZSBhbmQgbGV0IHRoZW0gc2NyYXBlIHRoZWlyIGJyYWlucyBmb3IgeW91ISIsCiAgICAgICAgaWNvbjogMTksCiAgICAgIH0sCiAgICB9OwoKICAgIGlmICh0cnVlKSB7CiAgICAgIC8vaWYgKCFFTikKICAgICAgR2FtZS5mb29sT2JqZWN0c1siVW5rbm93biJdLm5hbWUgPSBsb2MoIkludmVzdG1lbnQiKTsKICAgICAgR2FtZS5mb29sT2JqZWN0c1siVW5rbm93biJdLmRlc2MgPSBsb2MoCiAgICAgICAgIllvdSdyZSBub3Qgc3VyZSB3aGF0IHRoaXMgZG9lcywgeW91IGp1c3Qga25vdyBpdCBtZWFucyBwcm9maXQuIgogICAgICApOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0cykgewogICAgICAgIEdhbWUuZm9vbE9iamVjdHNbaV0ubmFtZSA9CiAgICAgICAgICBsb2MoRmluZExvY1N0cmluZ0J5UGFydChHYW1lLk9iamVjdHNbaV0ubmFtZSArICIgYnVzaW5lc3MgbmFtZSIpKSB8fAogICAgICAgICAgR2FtZS5mb29sT2JqZWN0c1tpXS5uYW1lOwogICAgICAgIEdhbWUuZm9vbE9iamVjdHNbaV0uZGVzYyA9CiAgICAgICAgICBsb2MoRmluZExvY1N0cmluZ0J5UGFydChHYW1lLk9iamVjdHNbaV0ubmFtZSArICIgYnVzaW5lc3MgcXVvdGUiKSkgfHwKICAgICAgICAgIEdhbWUuZm9vbE9iamVjdHNbaV0uZGVzYzsKICAgICAgfQogICAgfQoKICAgIC8vYnVpbGQgc3RvcmUKICAgIEdhbWUuQnVpbGRTdG9yZSgpOwoKICAgIC8vYnVpbGQgbWFzdGVyIGJhcgogICAgdmFyIHN0ciA9ICIiOwogICAgc3RyICs9CiAgICAgICc8ZGl2IGlkPSJidWlsZGluZ3NNdXRlIiBjbGFzcz0ic2hhZG93RmlsdGVyIiBzdHlsZT0icG9zaXRpb246cmVsYXRpdmU7ei1pbmRleDoxMDA7cGFkZGluZzo0cHggMTZweCAwcHggNjRweDsiPjwvZGl2Pic7CiAgICBzdHIgKz0KICAgICAgJzxkaXYgY2xhc3M9InNlcGFyYXRvckJvdHRvbSIgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlO2JvdHRvbTotOHB4O3otaW5kZXg6MDsiPjwvZGl2Pic7CiAgICBsKCJidWlsZGluZ3NNYXN0ZXIiKS5pbm5lckhUTUwgPSBzdHI7CgogICAgLy9idWlsZCBvYmplY3QgZGlzcGxheXMKICAgIHZhciBtdXRlU3RyID0KICAgICAgJzxkaXYgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlO2xlZnQ6OHB4O2JvdHRvbToxMnB4O29wYWNpdHk6MC41OyI+JyArCiAgICAgIGxvYygiTXV0ZWQ6IikgKwogICAgICAiPC9kaXY+IjsKICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKSB7CiAgICAgIHZhciBtZSA9IEdhbWUuT2JqZWN0c1tpXTsKCiAgICAgIGlmIChsb2NTdHJpbmdzW21lLm5hbWUgKyAiIChzaG9ydCkiXSkKICAgICAgICBtZS5kaXNwbGF5TmFtZSA9IGxvYyhtZS5uYW1lICsgIiAoc2hvcnQpIik7CgogICAgICBpZiAobWUuaWQgPiAwKSB7CiAgICAgICAgbWUuY2FudmFzID0gbCgicm93Q2FudmFzIiArIG1lLmlkKTsKICAgICAgICBtZS5jdHggPSBtZS5jYW52YXMuZ2V0Q29udGV4dCgiMmQiLCB7IGFscGhhOiBmYWxzZSB9KTsKICAgICAgICBtZS5waWNzID0gW107CiAgICAgICAgdmFyIGljb24gPSBbMCAqIDY0LCBtZS5pY29uICogNjRdOwogICAgICAgIG11dGVTdHIgKz0KICAgICAgICAgICc8ZGl2IGNsYXNzPSJ0aW55UHJvZHVjdEljb24iIGlkPSJtdXRlZFByb2R1Y3QnICsKICAgICAgICAgIG1lLmlkICsKICAgICAgICAgICciIHN0eWxlPSJkaXNwbGF5Om5vbmU7YmFja2dyb3VuZC1wb3NpdGlvbjotJyArCiAgICAgICAgICBpY29uWzBdICsKICAgICAgICAgICJweCAtIiArCiAgICAgICAgICBpY29uWzFdICsKICAgICAgICAgICdweDsiICcgKwogICAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgICAnPSJHYW1lLk9iamVjdHNCeUlkWycgKwogICAgICAgICAgbWUuaWQgKwogICAgICAgICAgIl0ubXV0ZSgwKTtQbGF5U291bmQoR2FtZS5PYmplY3RzQnlJZFsiICsKICAgICAgICAgIG1lLmlkICsKICAgICAgICAgICJdLm11dGVkPydzbmQvY2xpY2tPZmYyLm1wMyc6J3NuZC9jbGlja09uMi5tcDMnKTtcIiAiICsKICAgICAgICAgIEdhbWUuZ2V0RHluYW1pY1Rvb2x0aXAoCiAgICAgICAgICAgICJHYW1lLm11dGVkQnVpbGRpbmdUb29sdGlwKCIgKyBtZS5pZCArICIpIiwKICAgICAgICAgICAgInRoaXMiCiAgICAgICAgICApICsKICAgICAgICAgICI+PC9kaXY+IjsKICAgICAgICAvL211dGVTdHIrPSc8ZGl2IGNsYXNzPSJ0aW55UHJvZHVjdEljb24iIGlkPSJtdXRlZFByb2R1Y3QnK21lLmlkKyciIHN0eWxlPSJkaXNwbGF5Om5vbmU7YmFja2dyb3VuZC1wb3NpdGlvbjotJytpY29uWzBdKydweCAtJytpY29uWzFdKydweDsiICcrR2FtZS5jbGlja1N0cisnPSJHYW1lLk9iamVjdHNCeUlkWycrbWUuaWQrJ10ubXV0ZSgwKTtQbGF5U291bmQoR2FtZS5PYmplY3RzQnlJZFsnK21lLmlkKyddLm11dGVkP1wnc25kL2NsaWNrT2ZmMi5tcDNcJzpcJ3NuZC9jbGlja09uMi5tcDNcJyk7IiAnK0dhbWUuZ2V0VG9vbHRpcCgnPGRpdiBzdHlsZT0id2lkdGg6MTUwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Zm9udC1zaXplOjExcHg7Ij48Yj5Vbm11dGUgJyttZS5wbHVyYWwrJzwvYj48YnI+KERpc3BsYXkgdGhpcyBidWlsZGluZyk8L2Rpdj4nKSsnPjwvZGl2Pic7CgogICAgICAgIEFkZEV2ZW50KAogICAgICAgICAgbWUuY2FudmFzLAogICAgICAgICAgIm1vdXNlb3ZlciIsCiAgICAgICAgICAoZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgbWUubW91c2VPbiA9IHRydWU7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9KShtZSkKICAgICAgICApOwogICAgICAgIEFkZEV2ZW50KAogICAgICAgICAgbWUuY2FudmFzLAogICAgICAgICAgIm1vdXNlb3V0IiwKICAgICAgICAgIChmdW5jdGlvbiAobWUpIHsKICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBtZS5tb3VzZU9uID0gZmFsc2U7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9KShtZSkKICAgICAgICApOwogICAgICAgIEFkZEV2ZW50KAogICAgICAgICAgbWUuY2FudmFzLAogICAgICAgICAgIm1vdXNlbW92ZSIsCiAgICAgICAgICAoZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIHZhciBib3ggPSB0aGlzLmdldEJvdW5kcygpOwogICAgICAgICAgICAgIG1lLm1vdXNlUG9zWzBdID0gZS5wYWdlWCAtIGJveC5sZWZ0OwogICAgICAgICAgICAgIG1lLm1vdXNlUG9zWzFdID0gZS5wYWdlWSAtIGJveC50b3A7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9KShtZSkKICAgICAgICApOwogICAgICB9CiAgICB9CiAgICBHYW1lLm11dGVkQnVpbGRpbmdUb29sdGlwID0gZnVuY3Rpb24gKGlkKSB7CiAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5PYmplY3RzQnlJZFtpZF07CiAgICAgICAgcmV0dXJuICgKICAgICAgICAgICc8ZGl2IHN0eWxlPSJ3aWR0aDoxNTBweDt0ZXh0LWFsaWduOmNlbnRlcjtmb250LXNpemU6MTFweDsiIGlkPSJ0b29sdGlwTXV0ZWRCdWlsZGluZyI+JyArCiAgICAgICAgICAoRU4KICAgICAgICAgICAgPyAiPGI+IiArCiAgICAgICAgICAgICAgY2FwKG1lLnBsdXJhbCkgKwogICAgICAgICAgICAgIChtZS5sZXZlbCA+IDAgPyAiIChsdmwuJm5ic3A7IiArIG1lLmxldmVsICsgIikiIDogIiIpICsKICAgICAgICAgICAgICAnPC9iPjxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PkNsaWNrIHRvIHVubXV0ZSAnICsKICAgICAgICAgICAgICBtZS5wbHVyYWwgKwogICAgICAgICAgICAgICI8YnI+KGRpc3BsYXkgdGhpcyBidWlsZGluZykiCiAgICAgICAgICAgIDogIjxiPiIgKwogICAgICAgICAgICAgIGxvYygiTGV2ZWwgJTEgJTIiLCBbQmVhdXRpZnkobWUubGV2ZWwpLCBtZS5wbHVyYWxdKSArCiAgICAgICAgICAgICAgJzwvYj48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICAgICAgICBsb2MoIkNsaWNrIHRvIHVubXV0ZSIpKSArCiAgICAgICAgICAiPC9kaXY+IgogICAgICAgICk7CiAgICAgIH07CiAgICB9OwogICAgbCgiYnVpbGRpbmdzTXV0ZSIpLmlubmVySFRNTCA9IG11dGVTdHI7CgogICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkJVVBHUkFERVMKCQk9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwogICAgR2FtZS51cGdyYWRlc1RvUmVidWlsZCA9IDE7CiAgICBHYW1lLlVwZ3JhZGVzID0ge307CiAgICBHYW1lLlVwZ3JhZGVzQnlJZCA9IHt9OwogICAgR2FtZS5VcGdyYWRlc04gPSAwOwogICAgR2FtZS5VcGdyYWRlc0luU3RvcmUgPSBbXTsKICAgIEdhbWUuVXBncmFkZXNPd25lZCA9IDA7CiAgICBHYW1lLlVwZ3JhZGUgPSBmdW5jdGlvbiAobmFtZSwgZGVzYywgcHJpY2UsIGljb24sIGJ1eUZ1bmN0aW9uKSB7CiAgICAgIHRoaXMuaWQgPSBHYW1lLlVwZ3JhZGVzTjsKICAgICAgdGhpcy5uYW1lID0gbmFtZTsKICAgICAgdGhpcy5kbmFtZSA9IHRoaXMubmFtZTsKICAgICAgdGhpcy5kZXNjID0gZGVzYzsKICAgICAgdGhpcy5iYXNlRGVzYyA9IHRoaXMuZGVzYzsKICAgICAgdGhpcy5iYXNlUHJpY2UgPSBwcmljZTsKICAgICAgdGhpcy5wcmljZUx1bXBzID0gMDsgLy9ub3RlIDogZG9lc24ndCBkbyBtdWNoIG9uIGl0cyBvd24sIHlvdSBzdGlsbCBuZWVkIHRvIGhhbmRsZSB0aGUgYnV5aW5nIHlvdXJzZWxmCiAgICAgIHRoaXMuaWNvbiA9IGljb247CiAgICAgIHRoaXMuaWNvbkZ1bmN0aW9uID0gMDsKICAgICAgdGhpcy5idXlGdW5jdGlvbiA9IGJ1eUZ1bmN0aW9uOwogICAgICAvKnRoaXMudW5sb2NrRnVuY3Rpb249dW5sb2NrRnVuY3Rpb247CgkJCXRoaXMudW5sb2NrZWQ9KHRoaXMudW5sb2NrRnVuY3Rpb24/MDoxKTsqLwogICAgICB0aGlzLnVubG9ja2VkID0gMDsKICAgICAgdGhpcy5ib3VnaHQgPSAwOwogICAgICB0aGlzLm9yZGVyID0gdGhpcy5pZDsKICAgICAgaWYgKG9yZGVyKSB0aGlzLm9yZGVyID0gb3JkZXIgKyB0aGlzLmlkICogMC4wMDE7CiAgICAgIHRoaXMucG9vbCA9ICIiOyAvL2NhbiBiZSAnJywgY29va2llLCB0b2dnbGUsIGRlYnVnLCBwcmVzdGlnZSwgcHJlc3RpZ2VEZWNvciwgdGVjaCwgb3IgdW51c2VkCiAgICAgIGlmIChwb29sKSB0aGlzLnBvb2wgPSBwb29sOwogICAgICB0aGlzLnBvd2VyID0gMDsKICAgICAgaWYgKHBvd2VyKSB0aGlzLnBvd2VyID0gcG93ZXI7CiAgICAgIHRoaXMudmFuaWxsYSA9IEdhbWUudmFuaWxsYTsKICAgICAgdGhpcy51bmxvY2tBdCA9IDA7CiAgICAgIHRoaXMudGVjaFVubG9jayA9IFtdOwogICAgICB0aGlzLnBhcmVudHMgPSBbXTsKICAgICAgdGhpcy50eXBlID0gInVwZ3JhZGUiOwogICAgICB0aGlzLnRpZXIgPSAwOwogICAgICB0aGlzLmJ1aWxkaW5nVGllID0gMDsgLy9vZiB3aGF0IGJ1aWxkaW5nIGlzIHRoaXMgYSB0aWVyZWQgdXBncmFkZSBvZiA/CgogICAgICBHYW1lLmxhc3QgPSB0aGlzOwogICAgICBHYW1lLlVwZ3JhZGVzW3RoaXMubmFtZV0gPSB0aGlzOwogICAgICBHYW1lLlVwZ3JhZGVzQnlJZFt0aGlzLmlkXSA9IHRoaXM7CiAgICAgIEdhbWUuVXBncmFkZXNOKys7CiAgICAgIHJldHVybiB0aGlzOwogICAgfTsKICAgIEdhbWUuVXBncmFkZS5wcm90b3R5cGUuZ2V0VHlwZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuICJVcGdyYWRlIjsKICAgIH07CgogICAgR2FtZS5VcGdyYWRlLnByb3RvdHlwZS5nZXRQcmljZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHByaWNlID0gdGhpcy5iYXNlUHJpY2U7CiAgICAgIGlmICh0aGlzLnByaWNlRnVuYykgcHJpY2UgPSB0aGlzLnByaWNlRnVuYyh0aGlzKTsKICAgICAgaWYgKHByaWNlID09IDApIHJldHVybiAwOwogICAgICBpZiAodGhpcy5wb29sICE9ICJwcmVzdGlnZSIpIHsKICAgICAgICBpZiAoR2FtZS5IYXMoIlRveSB3b3Jrc2hvcCIpKSBwcmljZSAqPSAwLjk1OwogICAgICAgIGlmIChHYW1lLkhhcygiRml2ZS1maW5nZXIgZGlzY291bnQiKSkKICAgICAgICAgIHByaWNlICo9IE1hdGgucG93KDAuOTksIEdhbWUuT2JqZWN0c1siQ3Vyc29yIl0uYW1vdW50IC8gMTAwKTsKICAgICAgICBpZiAoR2FtZS5IYXMoIlNhbnRhJ3MgZG9taW5pb24iKSkgcHJpY2UgKj0gMC45ODsKICAgICAgICBpZiAoR2FtZS5IYXMoIkZhYmVyZ2UgZWdnIikpIHByaWNlICo9IDAuOTk7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJEaXZpbmUgc2FsZXMiKSkgcHJpY2UgKj0gMC45OTsKICAgICAgICBpZiAoR2FtZS5IYXMoIkZvcnR1bmUgIzEwMCIpKSBwcmljZSAqPSAwLjk5OwogICAgICAgIGlmICh0aGlzLmtpdHRlbiAmJiBHYW1lLkhhcygiS2l0dGVuIHdhZ2VzIikpIHByaWNlICo9IDAuOTsKICAgICAgICBpZiAoR2FtZS5oYXNCdWZmKCJIYWdnbGVyJ3MgbHVjayIpKSBwcmljZSAqPSAwLjk4OwogICAgICAgIGlmIChHYW1lLmhhc0J1ZmYoIkhhZ2dsZXIncyBtaXNlcnkiKSkgcHJpY2UgKj0gMS4wMjsKICAgICAgICAvL2lmIChHYW1lLmhhc0F1cmEoJ01hc3RlciBvZiB0aGUgQXJtb3J5JykpIHByaWNlKj0wLjk4OwogICAgICAgIHByaWNlICo9IDEgLSBHYW1lLmF1cmFNdWx0KCJNYXN0ZXIgb2YgdGhlIEFybW9yeSIpICogMC4wMjsKICAgICAgICBwcmljZSAqPSBHYW1lLmVmZigidXBncmFkZUNvc3QiKTsKICAgICAgICBpZiAodGhpcy5wb29sID09ICJjb29raWUiICYmIEdhbWUuSGFzKCJEaXZpbmUgYmFrZXJpZXMiKSkgcHJpY2UgLz0gNTsKICAgICAgfQogICAgICByZXR1cm4gTWF0aC5jZWlsKHByaWNlKTsKICAgIH07CgogICAgR2FtZS5VcGdyYWRlLnByb3RvdHlwZS5jYW5CdXkgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICh0aGlzLmNhbkJ1eUZ1bmMpIHJldHVybiB0aGlzLmNhbkJ1eUZ1bmMoKTsKICAgICAgaWYgKEdhbWUuY29va2llcyA+PSB0aGlzLmdldFByaWNlKCkpIHJldHVybiB0cnVlOwogICAgICBlbHNlIHJldHVybiBmYWxzZTsKICAgIH07CgogICAgR2FtZS5zdG9yZUJ1eUFsbCA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCFHYW1lLkhhcygiSW5zcGlyZWQgY2hlY2tsaXN0IikpIHJldHVybiBmYWxzZTsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlVwZ3JhZGVzSW5TdG9yZSkgewogICAgICAgIHZhciBtZSA9IEdhbWUuVXBncmFkZXNJblN0b3JlW2ldOwogICAgICAgIGlmICghbWUuaXNWYXVsdGVkKCkgJiYgbWUucG9vbCAhPSAidG9nZ2xlIiAmJiBtZS5wb29sICE9ICJ0ZWNoIikKICAgICAgICAgIG1lLmJ1eSgxKTsKICAgICAgfQogICAgfTsKCiAgICBHYW1lLnZhdWx0ID0gW107CiAgICBHYW1lLlVwZ3JhZGUucHJvdG90eXBlLmlzVmF1bHRlZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKEdhbWUudmF1bHQuaW5kZXhPZih0aGlzLmlkKSAhPSAtMSkgcmV0dXJuIHRydWU7CiAgICAgIGVsc2UgcmV0dXJuIGZhbHNlOwogICAgfTsKICAgIEdhbWUuVXBncmFkZS5wcm90b3R5cGUudmF1bHQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICghdGhpcy5pc1ZhdWx0ZWQoKSkgR2FtZS52YXVsdC5wdXNoKHRoaXMuaWQpOwogICAgfTsKICAgIEdhbWUuVXBncmFkZS5wcm90b3R5cGUudW52YXVsdCA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKHRoaXMuaXNWYXVsdGVkKCkpIEdhbWUudmF1bHQuc3BsaWNlKEdhbWUudmF1bHQuaW5kZXhPZih0aGlzLmlkKSwgMSk7CiAgICB9OwoKICAgIEdhbWUuVXBncmFkZS5wcm90b3R5cGUuY2xpY2sgPSBmdW5jdGlvbiAoZSkgewogICAgICBpZiAoKGUgJiYgZS5zaGlmdEtleSkgfHwgR2FtZS5rZXlzWzE2XSkgewogICAgICAgIGlmICh0aGlzLnBvb2wgPT0gInRvZ2dsZSIgfHwgdGhpcy5wb29sID09ICJ0ZWNoIikgewogICAgICAgIH0gZWxzZSBpZiAoR2FtZS5IYXMoIkluc3BpcmVkIGNoZWNrbGlzdCIpKSB7CiAgICAgICAgICBpZiAodGhpcy5pc1ZhdWx0ZWQoKSkgdGhpcy51bnZhdWx0KCk7CiAgICAgICAgICBlbHNlIHRoaXMudmF1bHQoKTsKICAgICAgICAgIEdhbWUudXBncmFkZXNUb1JlYnVpbGQgPSAxOwogICAgICAgICAgUGxheVNvdW5kKCJzbmQvdGljay5tcDMiKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB0aGlzLmJ1eSgpOwogICAgfTsKCiAgICBHYW1lLlVwZ3JhZGUucHJvdG90eXBlLmJ1eSA9IGZ1bmN0aW9uIChieXBhc3MpIHsKICAgICAgdmFyIHN1Y2Nlc3MgPSAwOwogICAgICB2YXIgY2FuY2VsUHVyY2hhc2UgPSAwOwogICAgICBpZiAodGhpcy5jbGlja0Z1bmN0aW9uICYmICFieXBhc3MpIGNhbmNlbFB1cmNoYXNlID0gIXRoaXMuY2xpY2tGdW5jdGlvbigpOwogICAgICBpZiAoIWNhbmNlbFB1cmNoYXNlKSB7CiAgICAgICAgaWYgKHRoaXMuY2hvaWNlc0Z1bmN0aW9uKSB7CiAgICAgICAgICBpZiAoR2FtZS5jaG9pY2VTZWxlY3Rvck9uID09IHRoaXMuaWQpIHsKICAgICAgICAgICAgbCgidG9nZ2xlQm94Iikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICAgICAgbCgidG9nZ2xlQm94IikuaW5uZXJIVE1MID0gIiI7CiAgICAgICAgICAgIEdhbWUuY2hvaWNlU2VsZWN0b3JPbiA9IC0xOwogICAgICAgICAgICBQbGF5U291bmQoInNuZC90aWNrT2ZmLm1wMyIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgR2FtZS5jaG9pY2VTZWxlY3Rvck9uID0gdGhpcy5pZDsKICAgICAgICAgICAgdmFyIGNob2ljZXMgPSB0aGlzLmNob2ljZXNGdW5jdGlvbigpOwogICAgICAgICAgICB2YXIgc3RyID0gIiI7CiAgICAgICAgICAgIHN0ciArPQogICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJjbG9zZSIgb25jbGljaz0iR2FtZS5VcGdyYWRlc0J5SWRbJyArCiAgICAgICAgICAgICAgdGhpcy5pZCArCiAgICAgICAgICAgICAgJ10uYnV5KCk7Ij54PC9kaXY+JzsKICAgICAgICAgICAgc3RyICs9ICI8aDM+IiArIHRoaXMuZG5hbWUgKyAiPC9oMz4iICsgJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2Pic7CiAgICAgICAgICAgIGlmICh0eXBlb2YgY2hvaWNlcyA9PT0gInN0cmluZyIpIHsKICAgICAgICAgICAgICBzdHIgKz0gY2hvaWNlczsKICAgICAgICAgICAgfSBlbHNlIGlmIChjaG9pY2VzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWQgPSAwOwogICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gY2hvaWNlcykgewogICAgICAgICAgICAgICAgaWYgKGNob2ljZXNbaV0uc2VsZWN0ZWQpIHNlbGVjdGVkID0gaTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgR2FtZS5jaG9pY2VTZWxlY3RvckNob2ljZXMgPSBjaG9pY2VzOyAvL3RoaXMgaXMgYSByZWFsbHkgZHVtYiB3YXkgb2YgZG9pbmcgdGhpcyBpIGFtIHNvIHNvcnJ5CiAgICAgICAgICAgICAgR2FtZS5jaG9pY2VTZWxlY3RvclNlbGVjdGVkID0gc2VsZWN0ZWQ7CiAgICAgICAgICAgICAgc3RyICs9CiAgICAgICAgICAgICAgICAnPGg0IGlkPSJjaG9pY2VTZWxlY3RlZE5hbWUiPicgKwogICAgICAgICAgICAgICAgY2hvaWNlc1tzZWxlY3RlZF0ubmFtZSArCiAgICAgICAgICAgICAgICAiPC9oND4iICsKICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nOwoKICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIGNob2ljZXMpIHsKICAgICAgICAgICAgICAgIGNob2ljZXNbaV0uaWQgPSBpOwogICAgICAgICAgICAgICAgY2hvaWNlc1tpXS5vcmRlciA9IGNob2ljZXNbaV0ub3JkZXIgfHwgMDsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHZhciBzb3J0TWFwID0gZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICAgICAgICAgIGlmIChhLm9yZGVyID4gYi5vcmRlcikgcmV0dXJuIDE7CiAgICAgICAgICAgICAgICBlbHNlIGlmIChhLm9yZGVyIDwgYi5vcmRlcikgcmV0dXJuIC0xOwogICAgICAgICAgICAgICAgZWxzZSByZXR1cm4gMDsKICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIGNob2ljZXMuc29ydChzb3J0TWFwKTsKCiAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaG9pY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAoIWNob2ljZXNbaV0pIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgdmFyIGljb24gPSBjaG9pY2VzW2ldLmljb247CiAgICAgICAgICAgICAgICB2YXIgaWQgPSBjaG9pY2VzW2ldLmlkOwogICAgICAgICAgICAgICAgaWYgKGNob2ljZXNbaV0uZGl2KSBzdHIgKz0gJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2Pic7CiAgICAgICAgICAgICAgICBzdHIgKz0KICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImNyYXRlIG5vRnJhbWUgZW5hYmxlZCcgKwogICAgICAgICAgICAgICAgICAoaWQgPT0gc2VsZWN0ZWQgPyAiIGhpZ2hsaWdodGVkIiA6ICIiKSArCiAgICAgICAgICAgICAgICAgICciIHN0eWxlPSJvcGFjaXR5OjE7ZmxvYXQ6bm9uZTtkaXNwbGF5OmlubGluZS1ibG9jazsnICsKICAgICAgICAgICAgICAgICAgd3JpdGVJY29uKGljb24pICsKICAgICAgICAgICAgICAgICAgJyIgJyArCiAgICAgICAgICAgICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICAgICAgICAgICAnPSJHYW1lLlVwZ3JhZGVzQnlJZFsnICsKICAgICAgICAgICAgICAgICAgdGhpcy5pZCArCiAgICAgICAgICAgICAgICAgICJdLmNob2ljZXNQaWNrKCIgKwogICAgICAgICAgICAgICAgICBpZCArCiAgICAgICAgICAgICAgICAgICIpO0dhbWUuY2hvaWNlU2VsZWN0b3JPbj0tMTtHYW1lLlVwZ3JhZGVzQnlJZFsiICsKICAgICAgICAgICAgICAgICAgdGhpcy5pZCArCiAgICAgICAgICAgICAgICAgICJdLmJ1eSgpO1wiIG9uTW91c2VPdXQ9XCJsKCdjaG9pY2VTZWxlY3RlZE5hbWUnKS5pbm5lckhUTUw9R2FtZS5jaG9pY2VTZWxlY3RvckNob2ljZXNbR2FtZS5jaG9pY2VTZWxlY3RvclNlbGVjdGVkXS5uYW1lO1wiIG9uTW91c2VPdmVyPVwibCgnY2hvaWNlU2VsZWN0ZWROYW1lJykuaW5uZXJIVE1MPUdhbWUuY2hvaWNlU2VsZWN0b3JDaG9pY2VzWyIgKwogICAgICAgICAgICAgICAgICBpICsKICAgICAgICAgICAgICAgICAgJ10ubmFtZTsiJyArCiAgICAgICAgICAgICAgICAgICI+PC9kaXY+IjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbCgidG9nZ2xlQm94IikuaW5uZXJIVE1MID0gc3RyOwogICAgICAgICAgICBsKCJ0b2dnbGVCb3giKS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICAgICAgbCgidG9nZ2xlQm94IikuZm9jdXMoKTsKICAgICAgICAgICAgR2FtZS50b29sdGlwLmhpZGUoKTsKICAgICAgICAgICAgUGxheVNvdW5kKCJzbmQvdGljay5tcDMiKTsKICAgICAgICAgICAgc3VjY2VzcyA9IDE7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnBvb2wgIT0gInByZXN0aWdlIikgewogICAgICAgICAgdmFyIHByaWNlID0gdGhpcy5nZXRQcmljZSgpOwogICAgICAgICAgaWYgKHRoaXMuY2FuQnV5KCkgJiYgIXRoaXMuYm91Z2h0KSB7CiAgICAgICAgICAgIEdhbWUuU3BlbmQocHJpY2UpOwogICAgICAgICAgICB0aGlzLmJvdWdodCA9IDE7CiAgICAgICAgICAgIGlmICh0aGlzLmJ1eUZ1bmN0aW9uKSB0aGlzLmJ1eUZ1bmN0aW9uKCk7CiAgICAgICAgICAgIGlmICh0aGlzLnRvZ2dsZUludG8pIHsKICAgICAgICAgICAgICBHYW1lLkxvY2sodGhpcy50b2dnbGVJbnRvKTsKICAgICAgICAgICAgICBHYW1lLlVubG9jayh0aGlzLnRvZ2dsZUludG8pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIEdhbWUudXBncmFkZXNUb1JlYnVpbGQgPSAxOwogICAgICAgICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICAgICAgICBpZiAoR2FtZS5Db3VudHNBc1VwZ3JhZGVPd25lZCh0aGlzLnBvb2wpKSBHYW1lLlVwZ3JhZGVzT3duZWQrKzsKICAgICAgICAgICAgR2FtZS5zZXRPbkNyYXRlKDApOwogICAgICAgICAgICBHYW1lLnRvb2x0aXAuaGlkZSgpOwogICAgICAgICAgICBQbGF5U291bmQoInNuZC9idXkiICsgY2hvb3NlKFsxLCAyLCAzLCA0XSkgKyAiLm1wMyIsIDAuNzUpOwogICAgICAgICAgICBzdWNjZXNzID0gMTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIHByaWNlID0gdGhpcy5nZXRQcmljZSgpOwogICAgICAgICAgaWYgKEdhbWUuaGVhdmVubHlDaGlwcyA+PSBwcmljZSAmJiAhdGhpcy5ib3VnaHQpIHsKICAgICAgICAgICAgR2FtZS5oZWF2ZW5seUNoaXBzIC09IHByaWNlOwogICAgICAgICAgICBHYW1lLmhlYXZlbmx5Q2hpcHNTcGVudCArPSBwcmljZTsKICAgICAgICAgICAgdGhpcy51bmxvY2tlZCA9IDE7CiAgICAgICAgICAgIHRoaXMuYm91Z2h0ID0gMTsKICAgICAgICAgICAgaWYgKHRoaXMuYnV5RnVuY3Rpb24pIHRoaXMuYnV5RnVuY3Rpb24oKTsKICAgICAgICAgICAgR2FtZS5CdWlsZEFzY2VuZFRyZWUodGhpcyk7CiAgICAgICAgICAgIFBsYXlTb3VuZCgic25kL2J1eSIgKyBjaG9vc2UoWzEsIDIsIDMsIDRdKSArICIubXAzIiwgMC43NSk7CiAgICAgICAgICAgIFBsYXlTb3VuZCgic25kL3NoaW1tZXJDbGljay5tcDMiKTsKICAgICAgICAgICAgLy9QbGF5U291bmQoJ3NuZC9idXlIZWF2ZW5seS5tcDMnKTsKICAgICAgICAgICAgc3VjY2VzcyA9IDE7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICh0aGlzLmJvdWdodCAmJiB0aGlzLmFjdGl2YXRlRnVuY3Rpb24pIHRoaXMuYWN0aXZhdGVGdW5jdGlvbigpOwogICAgICByZXR1cm4gc3VjY2VzczsKICAgIH07CiAgICBHYW1lLlVwZ3JhZGUucHJvdG90eXBlLmVhcm4gPQogICAgICBmdW5jdGlvbiAoKSAvL2p1c3Qgd2luIHRoZSB1cGdyYWRlcyB3aXRob3V0IHNwZW5kaW5nIGFueXRoaW5nCiAgICAgIHsKICAgICAgICB0aGlzLnVubG9ja2VkID0gMTsKICAgICAgICB0aGlzLmJvdWdodCA9IDE7CiAgICAgICAgaWYgKHRoaXMuYnV5RnVuY3Rpb24pIHRoaXMuYnV5RnVuY3Rpb24oKTsKICAgICAgICBHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkID0gMTsKICAgICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICAgIGlmIChHYW1lLkNvdW50c0FzVXBncmFkZU93bmVkKHRoaXMucG9vbCkpIEdhbWUuVXBncmFkZXNPd25lZCsrOwogICAgICB9OwogICAgR2FtZS5VcGdyYWRlLnByb3RvdHlwZS51bmVhcm4gPQogICAgICBmdW5jdGlvbiAoKSAvL3JlbW92ZSB0aGUgdXBncmFkZSwgYnV0IGtlZXAgaXQgdW5sb2NrZWQKICAgICAgewogICAgICAgIHRoaXMuYm91Z2h0ID0gMDsKICAgICAgICBHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkID0gMTsKICAgICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICAgIGlmIChHYW1lLkNvdW50c0FzVXBncmFkZU93bmVkKHRoaXMucG9vbCkpIEdhbWUuVXBncmFkZXNPd25lZC0tOwogICAgICB9OwogICAgR2FtZS5VcGdyYWRlLnByb3RvdHlwZS51bmxvY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMudW5sb2NrZWQgPSAxOwogICAgICBHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkID0gMTsKICAgIH07CiAgICBHYW1lLlVwZ3JhZGUucHJvdG90eXBlLmxvc2UgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMudW5sb2NrZWQgPSAwOwogICAgICB0aGlzLmJvdWdodCA9IDA7CiAgICAgIEdhbWUudXBncmFkZXNUb1JlYnVpbGQgPSAxOwogICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICBpZiAoR2FtZS5Db3VudHNBc1VwZ3JhZGVPd25lZCh0aGlzLnBvb2wpKSBHYW1lLlVwZ3JhZGVzT3duZWQtLTsKICAgIH07CiAgICBHYW1lLlVwZ3JhZGUucHJvdG90eXBlLnRvZ2dsZSA9IGZ1bmN0aW9uICgpIC8vY2hlYXRpbmcgb25seQogICAgewogICAgICBpZiAoIXRoaXMuYm91Z2h0KSB7CiAgICAgICAgdGhpcy5ib3VnaHQgPSAxOwogICAgICAgIGlmICh0aGlzLmJ1eUZ1bmN0aW9uKSB0aGlzLmJ1eUZ1bmN0aW9uKCk7CiAgICAgICAgR2FtZS51cGdyYWRlc1RvUmVidWlsZCA9IDE7CiAgICAgICAgR2FtZS5yZWNhbGN1bGF0ZUdhaW5zID0gMTsKICAgICAgICBpZiAoR2FtZS5Db3VudHNBc1VwZ3JhZGVPd25lZCh0aGlzLnBvb2wpKSBHYW1lLlVwZ3JhZGVzT3duZWQrKzsKICAgICAgICBQbGF5U291bmQoInNuZC9idXkiICsgY2hvb3NlKFsxLCAyLCAzLCA0XSkgKyAiLm1wMyIsIDAuNzUpOwogICAgICAgIGlmICh0aGlzLnBvb2wgPT0gInByZXN0aWdlIiB8fCB0aGlzLnBvb2wgPT0gImRlYnVnIikKICAgICAgICAgIFBsYXlTb3VuZCgic25kL3NoaW1tZXJDbGljay5tcDMiKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmJvdWdodCA9IDA7CiAgICAgICAgR2FtZS51cGdyYWRlc1RvUmVidWlsZCA9IDE7CiAgICAgICAgR2FtZS5yZWNhbGN1bGF0ZUdhaW5zID0gMTsKICAgICAgICBpZiAoR2FtZS5Db3VudHNBc1VwZ3JhZGVPd25lZCh0aGlzLnBvb2wpKSBHYW1lLlVwZ3JhZGVzT3duZWQtLTsKICAgICAgICBQbGF5U291bmQoInNuZC9zZWxsIiArIGNob29zZShbMSwgMiwgMywgNF0pICsgIi5tcDMiLCAwLjc1KTsKICAgICAgICBpZiAodGhpcy5wb29sID09ICJwcmVzdGlnZSIgfHwgdGhpcy5wb29sID09ICJkZWJ1ZyIpCiAgICAgICAgICBQbGF5U291bmQoInNuZC9zaGltbWVyQ2xpY2subXAzIik7CiAgICAgIH0KICAgICAgaWYgKEdhbWUub25NZW51ID09ICJzdGF0cyIpIEdhbWUuVXBkYXRlTWVudSgpOwogICAgfTsKCiAgICBHYW1lLkNvdW50c0FzVXBncmFkZU93bmVkID0gZnVuY3Rpb24gKHBvb2wpIHsKICAgICAgaWYgKHBvb2wgPT0gIiIgfHwgcG9vbCA9PSAiY29va2llIiB8fCBwb29sID09ICJ0ZWNoIikgcmV0dXJuIHRydWU7CiAgICAgIGVsc2UgcmV0dXJuIGZhbHNlOwogICAgfTsKCiAgICAvKkFkZEV2ZW50KGwoJ3RvZ2dsZUJveCcpLCdibHVyJyxmdW5jdGlvbigpLy9pZiB3ZSBjbGljayBvdXRzaWRlIG9mIHRoZSBzZWxlY3RvciwgY2xvc2UgaXQKCQkJewoJCQkJLy90aGlzIGhhcyBhIGNvdXBsZSBwcm9ibGVtcywgc3VjaCBhcyB3aGVuIGNsaWNraW5nIG9uIHRoZSB1cGdyYWRlIC0gdGhpcyB0b2dnbGVzIGl0IG9mZiBhbmQgYmFjayBvbiBpbnN0YW50bHkKCQkJCWwoJ3RvZ2dsZUJveCcpLnN0eWxlLmRpc3BsYXk9J25vbmUnOwoJCQkJbCgndG9nZ2xlQm94JykuaW5uZXJIVE1MPScnOwoJCQkJR2FtZS5jaG9pY2VTZWxlY3Rvck9uPS0xOwoJCQl9CgkJKTsqLwoKICAgIEdhbWUuUmVxdWlyZXNDb25maXJtYXRpb24gPSBmdW5jdGlvbiAodXBncmFkZSwgcHJvbXB0KSB7CiAgICAgIHVwZ3JhZGUuY2xpY2tGdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLlByb21wdCgiPGlkIFJlcXVpcmVzQ29uZmlybWF0aW9uPiIgKyBwcm9tcHQsIFsKICAgICAgICAgIFsKICAgICAgICAgICAgbG9jKCJZZXMiKSwKICAgICAgICAgICAgIkdhbWUuVXBncmFkZXNCeUlkWyIgKyB1cGdyYWRlLmlkICsgIl0uYnV5KDEpO0dhbWUuQ2xvc2VQcm9tcHQoKTsiLAogICAgICAgICAgXSwKICAgICAgICAgIGxvYygiTm8iKSwKICAgICAgICBdKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH07CiAgICB9OwoKICAgIEdhbWUuVW5sb2NrID0gZnVuY3Rpb24gKHdoYXQpIHsKICAgICAgaWYgKHR5cGVvZiB3aGF0ID09PSAic3RyaW5nIikgewogICAgICAgIGlmIChHYW1lLlVwZ3JhZGVzW3doYXRdKSB7CiAgICAgICAgICBpZiAoR2FtZS5VcGdyYWRlc1t3aGF0XS51bmxvY2tlZCA9PSAwKSB7CiAgICAgICAgICAgIEdhbWUuVXBncmFkZXNbd2hhdF0udW5sb2NrZWQgPSAxOwogICAgICAgICAgICBHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkID0gMTsKICAgICAgICAgICAgR2FtZS5yZWNhbGN1bGF0ZUdhaW5zID0gMTsKICAgICAgICAgICAgLypHYW1lLk5vdGlmeSgnVXBncmFkZSB1bmxvY2tlZCcsJzxkaXYgY2xhc3M9InRpdGxlIiBzdHlsZT0iZm9udC1zaXplOjE4cHg7bWFyZ2luLXRvcDotMnB4OyI+JytHYW1lLlVwZ3JhZGVzW3doYXRdLmRuYW1lKyc8L2Rpdj4nLEdhbWUuVXBncmFkZXNbd2hhdF0uaWNvbiw2KTsqLwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKHZhciBpIGluIHdoYXQpIHsKICAgICAgICAgIEdhbWUuVW5sb2NrKHdoYXRbaV0pOwogICAgICAgIH0KICAgICAgfQogICAgfTsKICAgIEdhbWUuTG9jayA9IGZ1bmN0aW9uICh3aGF0KSB7CiAgICAgIGlmICh0eXBlb2Ygd2hhdCA9PT0gInN0cmluZyIpIHsKICAgICAgICBpZiAoR2FtZS5VcGdyYWRlc1t3aGF0XSkgewogICAgICAgICAgR2FtZS5VcGdyYWRlc1t3aGF0XS51bmxvY2tlZCA9IDA7CiAgICAgICAgICBHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkID0gMTsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgR2FtZS5VcGdyYWRlc1t3aGF0XS5ib3VnaHQgPT0gMSAmJgogICAgICAgICAgICBHYW1lLkNvdW50c0FzVXBncmFkZU93bmVkKEdhbWUuVXBncmFkZXNbd2hhdF0ucG9vbCkKICAgICAgICAgICkKICAgICAgICAgICAgR2FtZS5VcGdyYWRlc093bmVkLS07CiAgICAgICAgICBHYW1lLlVwZ3JhZGVzW3doYXRdLmJvdWdodCA9IDA7CiAgICAgICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKHZhciBpIGluIHdoYXQpIHsKICAgICAgICAgIEdhbWUuTG9jayh3aGF0W2ldKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgR2FtZS5IYXMgPSBmdW5jdGlvbiAod2hhdCkgewogICAgICB2YXIgaXQgPSBHYW1lLlVwZ3JhZGVzW3doYXRdOwogICAgICBpZiAoCiAgICAgICAgaXQgJiYKICAgICAgICBHYW1lLmFzY2Vuc2lvbk1vZGUgPT0gMSAmJgogICAgICAgIChpdC5wb29sID09ICJwcmVzdGlnZSIgfHwgaXQudGllciA9PSAiZm9ydHVuZSIpCiAgICAgICkKICAgICAgICByZXR1cm4gMDsKICAgICAgcmV0dXJuIGl0ID8gaXQuYm91Z2h0IDogMDsKICAgIH07CiAgICBHYW1lLkhhc1VubG9ja2VkID0gZnVuY3Rpb24gKHdoYXQpIHsKICAgICAgcmV0dXJuIEdhbWUuVXBncmFkZXNbd2hhdF0gPyBHYW1lLlVwZ3JhZGVzW3doYXRdLnVubG9ja2VkIDogMDsKICAgIH07CgogICAgR2FtZS5SZWJ1aWxkVXBncmFkZXMgPSBmdW5jdGlvbiAoKSAvL3JlY2FsY3VsYXRlIHRoZSB1cGdyYWRlcyB5b3UgY2FuIGJ1eQogICAgewogICAgICBHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkID0gMDsKICAgICAgdmFyIGxpc3QgPSBbXTsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlVwZ3JhZGVzKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5VcGdyYWRlc1tpXTsKICAgICAgICBpZiAoCiAgICAgICAgICAhbWUuYm91Z2h0ICYmCiAgICAgICAgICBtZS5wb29sICE9ICJkZWJ1ZyIgJiYKICAgICAgICAgIG1lLnBvb2wgIT0gInByZXN0aWdlIiAmJgogICAgICAgICAgbWUucG9vbCAhPSAicHJlc3RpZ2VEZWNvciIgJiYKICAgICAgICAgIChHYW1lLmFzY2Vuc2lvbk1vZGUgIT0gMSB8fCAoIW1lLmxhc3RpbmcgJiYgbWUudGllciAhPSAiZm9ydHVuZSIpKQogICAgICAgICkgewogICAgICAgICAgaWYgKG1lLnVubG9ja2VkKSBsaXN0LnB1c2gobWUpOwogICAgICAgIH0gZWxzZSBpZiAobWUuZGlzcGxheUZ1bmNXaGVuT3duZWQgJiYgbWUuYm91Z2h0KSBsaXN0LnB1c2gobWUpOwogICAgICB9CiAgICAgIHZhciBzb3J0TWFwID0gZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICB2YXIgYXAgPSBhLnBvb2wgPT0gInRvZ2dsZSIgPyBhLm9yZGVyIDogYS5nZXRQcmljZSgpOwogICAgICAgIHZhciBicCA9IGIucG9vbCA9PSAidG9nZ2xlIiA/IGIub3JkZXIgOiBiLmdldFByaWNlKCk7CiAgICAgICAgaWYgKGFwID4gYnApIHJldHVybiAxOwogICAgICAgIGVsc2UgaWYgKGFwIDwgYnApIHJldHVybiAtMTsKICAgICAgICBlbHNlIHJldHVybiAwOwogICAgICB9OwogICAgICBsaXN0LnNvcnQoc29ydE1hcCk7CgogICAgICBHYW1lLlVwZ3JhZGVzSW5TdG9yZSA9IFtdOwogICAgICBmb3IgKHZhciBpIGluIGxpc3QpIHsKICAgICAgICBHYW1lLlVwZ3JhZGVzSW5TdG9yZS5wdXNoKGxpc3RbaV0pOwogICAgICB9CiAgICAgIHZhciBzdG9yZVN0ciA9ICIiOwogICAgICB2YXIgdG9nZ2xlU3RyID0gIiI7CiAgICAgIHZhciB0ZWNoU3RyID0gIiI7CiAgICAgIHZhciB2YXVsdFN0ciA9ICIiOwoKICAgICAgaWYgKEdhbWUuSGFzKCJJbnNwaXJlZCBjaGVja2xpc3QiKSkgewogICAgICAgIHN0b3JlU3RyICs9CiAgICAgICAgICAnPGRpdiBpZD0ic3RvcmVCdXlBbGwiIGNsYXNzPSJzdG9yZVByZSIgJyArCiAgICAgICAgICBHYW1lLmdldFRvb2x0aXAoCiAgICAgICAgICAgICc8ZGl2IHN0eWxlPSJwYWRkaW5nOjhweDttaW4td2lkdGg6MjUwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Zm9udC1zaXplOjExcHg7IiBpZD0idG9vbHRpcFN0b3JlUHJlIj4nICsKICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAiV2lsbCA8Yj5pbnN0YW50bHkgcHVyY2hhc2U8L2I+IGV2ZXJ5IHVwZ3JhZGUgeW91IGNhbiBhZmZvcmQsIHN0YXJ0aW5nIGZyb20gdGhlIGNoZWFwZXN0IG9uZS48YnI+VXBncmFkZXMgaW4gdGhlIDxiPnZhdWx0PC9iPiB3aWxsIG5vdCBiZSBhdXRvLXB1cmNoYXNlZC48YnI+WW91IG1heSBwbGFjZSBhbiB1cGdyYWRlIGludG8gdGhlIHZhdWx0IGJ5IDxiPlNoaWZ0LWNsaWNraW5nPC9iPiBvbiBpdC4iCiAgICAgICAgICAgICAgKSArCiAgICAgICAgICAgICAgIjwvZGl2PiIsCiAgICAgICAgICAgICJzdG9yZSIKICAgICAgICAgICkgKwogICAgICAgICAgIj4iICsKICAgICAgICAgICc8ZGl2IGlkPSJzdG9yZUJ1eUFsbEJ1dHRvbiIgY2xhc3M9InN0b3JlUHJlQnV0dG9uIiAnICsKICAgICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICAgJz0iR2FtZS5zdG9yZUJ1eUFsbCgpOyI+JyArCiAgICAgICAgICBsb2MoIkJ1eSBhbGwgdXBncmFkZXMiKSArCiAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAiPC9kaXY+IjsKICAgICAgICBsKCJ1cGdyYWRlcyIpLmNsYXNzTGlzdC5hZGQoImhhc01lbnUiKTsKICAgICAgfSBlbHNlIGwoInVwZ3JhZGVzIikuY2xhc3NMaXN0LnJlbW92ZSgiaGFzTWVudSIpOwoKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlVwZ3JhZGVzSW5TdG9yZSkgewogICAgICAgIC8vaWYgKCFHYW1lLlVwZ3JhZGVzSW5TdG9yZVtpXSkgYnJlYWs7CiAgICAgICAgdmFyIG1lID0gR2FtZS5VcGdyYWRlc0luU3RvcmVbaV07CiAgICAgICAgdmFyIHN0ciA9IEdhbWUuY3JhdGUoCiAgICAgICAgICBtZSwKICAgICAgICAgICJzdG9yZSIsCiAgICAgICAgICAiR2FtZS5VcGdyYWRlc0J5SWRbIiArIG1lLmlkICsgIl0uY2xpY2soZXZlbnQpOyIsCiAgICAgICAgICAidXBncmFkZSIgKyBpCiAgICAgICAgKTsKCiAgICAgICAgLyp2YXIgc3RyPSc8ZGl2IGNsYXNzPSJjcmF0ZSB1cGdyYWRlIiAnK0dhbWUuZ2V0VG9vbHRpcCgKCQkJCSc8ZGl2IHN0eWxlPSJtaW4td2lkdGg6MjAwcHg7Ij48ZGl2IHN0eWxlPSJmbG9hdDpyaWdodDsiPjxzcGFuIGNsYXNzPSJwcmljZSI+JytCZWF1dGlmeShNYXRoLnJvdW5kKG1lLmdldFByaWNlKCkpKSsnPC9zcGFuPjwvZGl2PjxzbWFsbD4nKyhtZS5wb29sPT0ndG9nZ2xlJz8nW1RvZ2dsYWJsZV0nOidbVXBncmFkZV0nKSsnPC9zbWFsbD48ZGl2IGNsYXNzPSJuYW1lIj4nK21lLmRuYW1lKyc8L2Rpdj48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj48ZGl2IGNsYXNzPSJkZXNjcmlwdGlvbiI+JyttZS5kZXNjKyc8L2Rpdj48L2Rpdj4nCgkJCQksJ3N0b3JlJykrJyAnK0dhbWUuY2xpY2tTdHIrJz0iR2FtZS5VcGdyYWRlc0J5SWRbJyttZS5pZCsnXS5idXkoKTsiIGlkPSJ1cGdyYWRlJytpKyciIHN0eWxlPSInK3dyaXRlSWNvbihtZS5pY29uKSsnIj48L2Rpdj4nOyovCiAgICAgICAgaWYgKG1lLnBvb2wgPT0gInRvZ2dsZSIpIHRvZ2dsZVN0ciArPSBzdHI7CiAgICAgICAgZWxzZSBpZiAobWUucG9vbCA9PSAidGVjaCIpIHRlY2hTdHIgKz0gc3RyOwogICAgICAgIGVsc2UgewogICAgICAgICAgaWYgKG1lLmlzVmF1bHRlZCgpICYmIEdhbWUuSGFzKCJJbnNwaXJlZCBjaGVja2xpc3QiKSkgdmF1bHRTdHIgKz0gc3RyOwogICAgICAgICAgZWxzZSBzdG9yZVN0ciArPSBzdHI7CiAgICAgICAgfQogICAgICB9CgogICAgICBsKCJ1cGdyYWRlcyIpLmlubmVySFRNTCA9IHN0b3JlU3RyOwogICAgICBsKCJ0b2dnbGVVcGdyYWRlcyIpLmlubmVySFRNTCA9IHRvZ2dsZVN0cjsKICAgICAgaWYgKHRvZ2dsZVN0ciA9PSAiIikgbCgidG9nZ2xlVXBncmFkZXMiKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICBlbHNlIGwoInRvZ2dsZVVwZ3JhZGVzIikuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgIGwoInRlY2hVcGdyYWRlcyIpLmlubmVySFRNTCA9IHRlY2hTdHI7CiAgICAgIGlmICh0ZWNoU3RyID09ICIiKSBsKCJ0ZWNoVXBncmFkZXMiKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICBlbHNlIGwoInRlY2hVcGdyYWRlcyIpLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICBsKCJ2YXVsdFVwZ3JhZGVzIikuaW5uZXJIVE1MID0gdmF1bHRTdHI7CiAgICAgIGlmICh2YXVsdFN0ciA9PSAiIikgbCgidmF1bHRVcGdyYWRlcyIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgIGVsc2UgbCgidmF1bHRVcGdyYWRlcyIpLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgfTsKCiAgICBHYW1lLlVubG9ja0F0ID0gW107IC8vdGhpcyBjb250YWlucyBhbiBhcnJheSBvZiBldmVyeSB1cGdyYWRlIHdpdGggYSBjb29raWUgcmVxdWlyZW1lbnQgaW4gdGhlIGZvcm0gb2Yge2Nvb2tpZXM6KGFtb3VudCBvZiBjb29raWVzIGVhcm5lZCByZXF1aXJlZCksbmFtZToobmFtZSBvZiB1cGdyYWRlIG9yIGFjaGlldmVtZW50IHRvIHVubG9jayl9IChhbmQgcG9zc2libHkgcmVxdWlyZToobmFtZSBvZiB1cGdyYWRlIG9mIGFjaGlldmVtZW50IHRvIG93bikpCiAgICAvL25vdGUgOiB0aGUgY29va2llIHdpbGwgbm90IGJlIGFkZGVkIHRvIHRoZSBsaXN0IGlmIGl0IGNvbnRhaW5zIGxvY2tlZDoxICh1c2UgZm9yIHNlYXNvbmFsIGNvb2tpZXMgYW5kIHN1Y2gpCgogICAgdmFyIHN0ckNvb2tpZVByb2R1Y3Rpb25NdWx0aXBsaWVyUGx1cyA9IGxvYygKICAgICAgIkNvb2tpZSBwcm9kdWN0aW9uIG11bHRpcGxpZXIgPGI+KyUxJTwvYj4uIiwKICAgICAgIlt4XSIKICAgICk7CiAgICB2YXIgZ2V0U3RyQ29va2llUHJvZHVjdGlvbk11bHRpcGxpZXJQbHVzID0gZnVuY3Rpb24gKHgpIHsKICAgICAgcmV0dXJuIHN0ckNvb2tpZVByb2R1Y3Rpb25NdWx0aXBsaWVyUGx1cy5yZXBsYWNlKCJbeF0iLCB4KTsKICAgIH07CiAgICB2YXIgZ2V0U3RyVGhvdXNhbmRGaW5nZXJzR2FpbiA9IGZ1bmN0aW9uICh4KSB7CiAgICAgIHJldHVybiBsb2MoIk11bHRpcGxpZXMgdGhlIGdhaW4gZnJvbSAlMSBieSA8Yj4lMjwvYj4uIiwgWwogICAgICAgIGdldFVwZ3JhZGVOYW1lKCJUaG91c2FuZCBmaW5nZXJzIiksCiAgICAgICAgeCwKICAgICAgXSk7CiAgICB9OwogICAgdmFyIHN0cktpdHRlbkRlc2MgPSBsb2MoIllvdSBnYWluIDxiPm1vcmUgQ3BTPC9iPiB0aGUgbW9yZSBtaWxrIHlvdSBoYXZlLiIpOwogICAgdmFyIGdldFN0ckNsaWNraW5nR2FpbnMgPSBmdW5jdGlvbiAoeCkgewogICAgICByZXR1cm4gbG9jKCJDbGlja2luZyBnYWlucyA8Yj4rJTElIG9mIHlvdXIgQ3BTPC9iPi4iLCB4KTsKICAgIH07CgogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llID0gZnVuY3Rpb24gKG9iaikgewogICAgICB2YXIgdXBncmFkZSA9IG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICAgb2JqLm5hbWUsCiAgICAgICAgZ2V0U3RyQ29va2llUHJvZHVjdGlvbk11bHRpcGxpZXJQbHVzKAogICAgICAgICAgQmVhdXRpZnkoCiAgICAgICAgICAgIHR5cGVvZiBvYmoucG93ZXIgPT09ICJmdW5jdGlvbiIgPyBvYmoucG93ZXIob2JqKSA6IG9iai5wb3dlciwKICAgICAgICAgICAgMQogICAgICAgICAgKQogICAgICAgICkgKyAoRU4gPyAiPHE+IiArIG9iai5kZXNjICsgIjwvcT4iIDogIiIpLAogICAgICAgIG9iai5wcmljZSwKICAgICAgICBvYmouaWNvbgogICAgICApOwogICAgICB1cGdyYWRlLnBvd2VyID0gb2JqLnBvd2VyOwogICAgICB1cGdyYWRlLnBvb2wgPSAiY29va2llIjsKICAgICAgdmFyIHRvUHVzaCA9IHsgY29va2llczogb2JqLnByaWNlIC8gMjAsIG5hbWU6IG9iai5uYW1lIH07CiAgICAgIGlmIChvYmoucmVxdWlyZSkgdG9QdXNoLnJlcXVpcmUgPSBvYmoucmVxdWlyZTsKICAgICAgaWYgKG9iai5zZWFzb24pIHRvUHVzaC5zZWFzb24gPSBvYmouc2Vhc29uOwogICAgICBpZiAoIW9iai5sb2NrZWQpIEdhbWUuVW5sb2NrQXQucHVzaCh0b1B1c2gpOwogICAgICByZXR1cm4gdXBncmFkZTsKICAgIH07CgogICAgLy90aWVyZWQgdXBncmFkZXMgc3lzdGVtCiAgICAvL2VhY2ggYnVpbGRpbmcgaGFzIHNldmVyYWwgdXBncmFkZSB0aWVycwogICAgLy9hbGwgdXBncmFkZXMgaW4gdGhlIHNhbWUgdGllciBoYXZlIHRoZSBzYW1lIGNvbG9yLCB1bmxvY2sgdGhyZXNob2xkIGFuZCBwcmljZSBtdWx0aXBsaWVyCiAgICBHYW1lLlRpZXJzID0gewogICAgICAxOiB7CiAgICAgICAgbmFtZTogIlBsYWluIiwKICAgICAgICB1bmxvY2s6IDEsCiAgICAgICAgYWNoaWV2VW5sb2NrOiAxLAogICAgICAgIGljb25Sb3c6IDAsCiAgICAgICAgY29sb3I6ICIjY2NiM2FjIiwKICAgICAgICBwcmljZTogMTAsCiAgICAgIH0sCiAgICAgIDI6IHsKICAgICAgICBuYW1lOiAiQmVycnlsaXVtIiwKICAgICAgICB1bmxvY2s6IDUsCiAgICAgICAgYWNoaWV2VW5sb2NrOiA1MCwKICAgICAgICBpY29uUm93OiAxLAogICAgICAgIGNvbG9yOiAiI2ZmODllNyIsCiAgICAgICAgcHJpY2U6IDUwLAogICAgICB9LAogICAgICAzOiB7CiAgICAgICAgbmFtZTogIkJsdWViZXJyeWxpdW0iLAogICAgICAgIHVubG9jazogMjUsCiAgICAgICAgYWNoaWV2VW5sb2NrOiAxMDAsCiAgICAgICAgaWNvblJvdzogMiwKICAgICAgICBjb2xvcjogIiMwMGRlZmYiLAogICAgICAgIHByaWNlOiA1MDAsCiAgICAgIH0sCiAgICAgIDQ6IHsKICAgICAgICBuYW1lOiAiQ2hhbGNlZGhvbmV5IiwKICAgICAgICB1bmxvY2s6IDUwLAogICAgICAgIGFjaGlldlVubG9jazogMTUwLAogICAgICAgIGljb25Sb3c6IDEzLAogICAgICAgIGNvbG9yOiAiI2ZmY2MyZiIsCiAgICAgICAgcHJpY2U6IDUwMDAwLAogICAgICB9LAogICAgICA1OiB7CiAgICAgICAgbmFtZTogIkJ1dHRlcmdvbGQiLAogICAgICAgIHVubG9jazogMTAwLAogICAgICAgIGFjaGlldlVubG9jazogMjAwLAogICAgICAgIGljb25Sb3c6IDE0LAogICAgICAgIGNvbG9yOiAiI2U5ZDY3MyIsCiAgICAgICAgcHJpY2U6IDUwMDAwMDAsCiAgICAgIH0sCiAgICAgIDY6IHsKICAgICAgICBuYW1lOiAiU3VnYXJtdWNrIiwKICAgICAgICB1bmxvY2s6IDE1MCwKICAgICAgICBhY2hpZXZVbmxvY2s6IDI1MCwKICAgICAgICBpY29uUm93OiAxNSwKICAgICAgICBjb2xvcjogIiNhOGJmOTEiLAogICAgICAgIHByaWNlOiA1MDAwMDAwMDAsCiAgICAgIH0sCiAgICAgIDc6IHsKICAgICAgICBuYW1lOiAiSmV0bWludCIsCiAgICAgICAgdW5sb2NrOiAyMDAsCiAgICAgICAgYWNoaWV2VW5sb2NrOiAzMDAsCiAgICAgICAgaWNvblJvdzogMTYsCiAgICAgICAgY29sb3I6ICIjNjBmZjUwIiwKICAgICAgICBwcmljZTogNTAwMDAwMDAwMDAwLAogICAgICB9LAogICAgICA4OiB7CiAgICAgICAgbmFtZTogIkNoZXJyeXNpbHZlciIsCiAgICAgICAgdW5sb2NrOiAyNTAsCiAgICAgICAgYWNoaWV2VW5sb2NrOiAzNTAsCiAgICAgICAgaWNvblJvdzogMTcsCiAgICAgICAgY29sb3I6ICIjZjAxNzAwIiwKICAgICAgICBwcmljZTogNTAwMDAwMDAwMDAwMDAwLAogICAgICB9LAogICAgICA5OiB7CiAgICAgICAgbmFtZTogIkhhemVscmFsZCIsCiAgICAgICAgdW5sb2NrOiAzMDAsCiAgICAgICAgYWNoaWV2VW5sb2NrOiA0MDAsCiAgICAgICAgaWNvblJvdzogMTgsCiAgICAgICAgY29sb3I6ICIjOWFiODM0IiwKICAgICAgICBwcmljZTogNTAwMDAwMDAwMDAwMDAwMDAwLAogICAgICB9LAogICAgICAxMDogewogICAgICAgIG5hbWU6ICJNb29uY2FuZHkiLAogICAgICAgIHVubG9jazogMzUwLAogICAgICAgIGFjaGlldlVubG9jazogNDUwLAogICAgICAgIGljb25Sb3c6IDE5LAogICAgICAgIGNvbG9yOiAiIzdlN2FiOSIsCiAgICAgICAgcHJpY2U6IDUwMDAwMDAwMDAwMDAwMDAwMDAwMCwKICAgICAgfSwKICAgICAgMTE6IHsKICAgICAgICBuYW1lOiAiQXN0cm9mdWRnZSIsCiAgICAgICAgdW5sb2NrOiA0MDAsCiAgICAgICAgYWNoaWV2VW5sb2NrOiA1MDAsCiAgICAgICAgaWNvblJvdzogMjgsCiAgICAgICAgY29sb3I6ICIjOWEzMzE2IiwKICAgICAgICBwcmljZTogNTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCwKICAgICAgfSwKICAgICAgMTI6IHsKICAgICAgICBuYW1lOiAiQWxhYmFzY3JlYW0iLAogICAgICAgIHVubG9jazogNDUwLAogICAgICAgIGFjaGlldlVubG9jazogNTUwLAogICAgICAgIGljb25Sb3c6IDMwLAogICAgICAgIGNvbG9yOiAiI2MxYTg4YyIsCiAgICAgICAgcHJpY2U6IDUwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwLAogICAgICB9LAogICAgICAxMzogewogICAgICAgIG5hbWU6ICJJcmlkeXVtIiwKICAgICAgICB1bmxvY2s6IDUwMCwKICAgICAgICBhY2hpZXZVbmxvY2s6IDYwMCwKICAgICAgICBpY29uUm93OiAzMSwKICAgICAgICBjb2xvcjogIiNhZGIxYjMiLAogICAgICAgIHByaWNlOiA1MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIH0sCiAgICAgIDE0OiB7CiAgICAgICAgbmFtZTogIkdsdWNvc21pdW0iLAogICAgICAgIHVubG9jazogNTUwLAogICAgICAgIGFjaGlldlVubG9jazogNjUwLAogICAgICAgIGljb25Sb3c6IDM0LAogICAgICAgIGNvbG9yOiAiI2ZmODllNyIsCiAgICAgICAgcHJpY2U6IDUwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIH0sCiAgICAgIHN5bmVyZ3kxOiB7CiAgICAgICAgbmFtZTogIlN5bmVyZ3kgSSIsCiAgICAgICAgdW5sb2NrOiAxNSwKICAgICAgICBpY29uUm93OiAyMCwKICAgICAgICBjb2xvcjogIiMwMDg1OTUiLAogICAgICAgIHNwZWNpYWw6IDEsCiAgICAgICAgcmVxOiAiU3luZXJnaWVzIFZvbC4gSSIsCiAgICAgICAgcHJpY2U6IDIwMDAwMCwKICAgICAgfSwKICAgICAgc3luZXJneTI6IHsKICAgICAgICBuYW1lOiAiU3luZXJneSBJSSIsCiAgICAgICAgdW5sb2NrOiA3NSwKICAgICAgICBpY29uUm93OiAyOSwKICAgICAgICBjb2xvcjogIiMwMDg1OTUiLAogICAgICAgIHNwZWNpYWw6IDEsCiAgICAgICAgcmVxOiAiU3luZXJnaWVzIFZvbC4gSUkiLAogICAgICAgIHByaWNlOiAyMDAwMDAwMDAwMDAsCiAgICAgIH0sCiAgICAgIGZvcnR1bmU6IHsKICAgICAgICBuYW1lOiAiRm9ydHVuZSIsCiAgICAgICAgdW5sb2NrOiAtMSwKICAgICAgICBpY29uUm93OiAzMiwKICAgICAgICBjb2xvcjogIiM5YWI4MzQiLAogICAgICAgIHNwZWNpYWw6IDEsCiAgICAgICAgcHJpY2U6IDc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3LAogICAgICB9LAogICAgfTsKICAgIGZvciAodmFyIGkgaW4gR2FtZS5UaWVycykgewogICAgICBHYW1lLlRpZXJzW2ldLnVwZ3JhZGVzID0gW107CiAgICB9CiAgICBHYW1lLkdldEljb24gPSBmdW5jdGlvbiAodHlwZSwgdGllcikgewogICAgICB2YXIgY29sID0gMDsKICAgICAgaWYgKHR5cGUgPT0gIktpdHRlbiIpIGNvbCA9IDE4OwogICAgICBlbHNlIGNvbCA9IEdhbWUuT2JqZWN0c1t0eXBlXS5pY29uQ29sdW1uOwogICAgICByZXR1cm4gW2NvbCwgR2FtZS5UaWVyc1t0aWVyXS5pY29uUm93XTsKICAgIH07CiAgICBHYW1lLlNldFRpZXIgPSBmdW5jdGlvbiAoYnVpbGRpbmcsIHRpZXIpIHsKICAgICAgaWYgKCFHYW1lLk9iamVjdHNbYnVpbGRpbmddKQogICAgICAgIGNvbnNvbGUubG9nKCJXYXJuaW5nOiBObyBidWlsZGluZyBuYW1lZCIsIGJ1aWxkaW5nKTsKICAgICAgR2FtZS5sYXN0LnRpZXIgPSB0aWVyOwogICAgICBHYW1lLmxhc3QuYnVpbGRpbmdUaWUgPSBHYW1lLk9iamVjdHNbYnVpbGRpbmddOwogICAgICBpZiAoR2FtZS5sYXN0LnR5cGUgPT0gImFjaGlldmVtZW50IikKICAgICAgICBHYW1lLk9iamVjdHNbYnVpbGRpbmddLnRpZXJlZEFjaGlldnNbdGllcl0gPSBHYW1lLmxhc3Q7CiAgICAgIGVsc2UgR2FtZS5PYmplY3RzW2J1aWxkaW5nXS50aWVyZWRVcGdyYWRlc1t0aWVyXSA9IEdhbWUubGFzdDsKICAgIH07CiAgICBHYW1lLk1ha2VUaWVyZWQgPSBmdW5jdGlvbiAodXBncmFkZSwgdGllciwgY29sKSB7CiAgICAgIHVwZ3JhZGUudGllciA9IHRpZXI7CiAgICAgIGlmICh0eXBlb2YgY29sICE9PSAidW5kZWZpbmVkIikKICAgICAgICB1cGdyYWRlLmljb24gPSBbY29sLCBHYW1lLlRpZXJzW3RpZXJdLmljb25Sb3ddOwogICAgfTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSA9IGZ1bmN0aW9uIChuYW1lLCBkZXNjLCBidWlsZGluZywgdGllcikgewogICAgICBpZiAodGllciA9PSAiZm9ydHVuZSIgJiYgYnVpbGRpbmcpCiAgICAgICAgZGVzYyA9CiAgICAgICAgICBsb2MoIiUxIGFyZSA8Yj4lMiU8L2I+IG1vcmUgZWZmaWNpZW50IGFuZCA8Yj4lMyU8L2I+IGNoZWFwZXIuIiwgWwogICAgICAgICAgICBjYXAoR2FtZS5PYmplY3RzW2J1aWxkaW5nXS5wbHVyYWwpLAogICAgICAgICAgICA3LAogICAgICAgICAgICA3LAogICAgICAgICAgXSkgKyBkZXNjOwogICAgICBlbHNlCiAgICAgICAgZGVzYyA9CiAgICAgICAgICBsb2MoCiAgICAgICAgICAgICIlMSBhcmUgPGI+dHdpY2U8L2I+IGFzIGVmZmljaWVudC4iLAogICAgICAgICAgICBjYXAoR2FtZS5PYmplY3RzW2J1aWxkaW5nXS5wbHVyYWwpCiAgICAgICAgICApICsgZGVzYzsKICAgICAgdmFyIHVwZ3JhZGUgPSBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAgIG5hbWUsCiAgICAgICAgZGVzYywKICAgICAgICBHYW1lLk9iamVjdHNbYnVpbGRpbmddLmJhc2VQcmljZSAqIEdhbWUuVGllcnNbdGllcl0ucHJpY2UsCiAgICAgICAgR2FtZS5HZXRJY29uKGJ1aWxkaW5nLCB0aWVyKQogICAgICApOwogICAgICBpZiAodGllciAhPSAiZm9ydHVuZSIpIHsKICAgICAgICB1cGdyYWRlLmRlc2NGdW5jID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgKEdhbWUuYXNjZW5zaW9uTW9kZSAhPSAxICYmCiAgICAgICAgICAgIEdhbWUuSGFzKHRoaXMuYnVpbGRpbmdUaWUxLnVuc2hhY2tsZVVwZ3JhZGUpICYmCiAgICAgICAgICAgIEdhbWUuSGFzKEdhbWUuVGllcnNbdGhpcy50aWVyXS51bnNoYWNrbGVVcGdyYWRlKQogICAgICAgICAgICAgID8gJzxkaXYgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyI+JyArCiAgICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAgICJVbnNoYWNrbGVkISA8Yj4rJTElPC9iPiBleHRyYSBwcm9kdWN0aW9uLiIsCiAgICAgICAgICAgICAgICAgIE1hdGgucm91bmQoCiAgICAgICAgICAgICAgICAgICAgKHRoaXMuYnVpbGRpbmdUaWUuaWQgPT0gMQogICAgICAgICAgICAgICAgICAgICAgPyAwLjUKICAgICAgICAgICAgICAgICAgICAgIDogKDIwIC0gdGhpcy5idWlsZGluZ1RpZS5pZCkgKiAwLjEpICogMTAwCiAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICkgKwogICAgICAgICAgICAgICAgJzwvZGl2PjxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicKICAgICAgICAgICAgICA6ICIiKSArIHRoaXMuZGRlc2MKICAgICAgICAgICk7CiAgICAgICAgfTsKICAgICAgfQoKICAgICAgR2FtZS5TZXRUaWVyKGJ1aWxkaW5nLCB0aWVyKTsKICAgICAgaWYgKCF1cGdyYWRlLmJ1aWxkaW5nVGllMSAmJiBidWlsZGluZykKICAgICAgICB1cGdyYWRlLmJ1aWxkaW5nVGllMSA9IEdhbWUuT2JqZWN0c1tidWlsZGluZ107CiAgICAgIGlmICh0aWVyID09ICJmb3J0dW5lIiAmJiBidWlsZGluZykKICAgICAgICBHYW1lLk9iamVjdHNbYnVpbGRpbmddLmZvcnR1bmUgPSB1cGdyYWRlOwogICAgICByZXR1cm4gdXBncmFkZTsKICAgIH07CiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlID0gZnVuY3Rpb24gKG5hbWUsIGRlc2MsIGJ1aWxkaW5nMSwgYnVpbGRpbmcyLCB0aWVyKSB7CiAgICAgIC8qCgkJCQljcmVhdGVzIGEgbmV3IHVwZ3JhZGUgdGhhdCA6CgkJCQktdW5sb2NrcyB3aGVuIHlvdSBoYXZlIHRpZXIudW5sb2NrIG9mIGJ1aWxkaW5nMSBhbmQgYnVpbGRpbmcyCgkJCQktaXMgcHJpY2VkIGF0IChidWlsZGluZzEucHJpY2UqMTArYnVpbGRpbmcyLnByaWNlKjEpKnRpZXIucHJpY2UgKGZvcm1lcmx5IDogTWF0aC5zcXJ0KGJ1aWxkaW5nMS5wcmljZSpidWlsZGluZzIucHJpY2UpKnRpZXIucHJpY2UpCgkJCQktZ2l2ZXMgKygwLjEqYnVpbGRpbmcxKSUgY3BzIHRvIGJ1aWxkaW5nMiBhbmQgKyg1KmJ1aWxkaW5nMiklIGNwcyB0byBidWlsZGluZzEKCQkJCS1pZiBidWlsZGluZzIgaXMgYmVsb3cgYnVpbGRpbmcxIGluIHdvcnRoLCBzd2FwIHRoZW0KCQkJKi8KICAgICAgLy9pZiAoR2FtZS5PYmplY3RzW2J1aWxkaW5nMV0uYmFzZVByaWNlPkdhbWUuT2JqZWN0c1tidWlsZGluZzJdLmJhc2VQcmljZSkge3ZhciB0ZW1wPWJ1aWxkaW5nMjtidWlsZGluZzI9YnVpbGRpbmcxO2J1aWxkaW5nMT10ZW1wO30KICAgICAgdmFyIGIxID0gR2FtZS5PYmplY3RzW2J1aWxkaW5nMV07CiAgICAgIHZhciBiMiA9IEdhbWUuT2JqZWN0c1tidWlsZGluZzJdOwogICAgICBpZiAoYjEuYmFzZVByaWNlID4gYjIuYmFzZVByaWNlKSB7CiAgICAgICAgYjEgPSBHYW1lLk9iamVjdHNbYnVpbGRpbmcyXTsKICAgICAgICBiMiA9IEdhbWUuT2JqZWN0c1tidWlsZGluZzFdOwogICAgICB9IC8vc3dhcAoKICAgICAgZGVzYyA9CiAgICAgICAgbG9jKCIlMSBnYWluIDxiPislMiU8L2I+IENwUyBwZXIgJTMuIiwgW2NhcChiMS5wbHVyYWwpLCA1LCBiMi5zaW5nbGVdKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoIiUxIGdhaW4gPGI+KyUyJTwvYj4gQ3BTIHBlciAlMy4iLCBbCiAgICAgICAgICBjYXAoYjIucGx1cmFsKSwKICAgICAgICAgIDAuMSwKICAgICAgICAgIGIxLnNpbmdsZSwKICAgICAgICBdKSArCiAgICAgICAgKEVOID8gZGVzYyA6ICIiKTsKICAgICAgdmFyIHVwZ3JhZGUgPSBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAgIG5hbWUsCiAgICAgICAgZGVzYywKICAgICAgICAoYjEuYmFzZVByaWNlICogMTAgKyBiMi5iYXNlUHJpY2UgKiAxKSAqIEdhbWUuVGllcnNbdGllcl0ucHJpY2UsCiAgICAgICAgR2FtZS5HZXRJY29uKGJ1aWxkaW5nMSwgdGllcikKICAgICAgKTsgLy9NYXRoLnNxcnQoYjEuYmFzZVByaWNlKmIyLmJhc2VQcmljZSkqR2FtZS5UaWVyc1t0aWVyXS5wcmljZQogICAgICB1cGdyYWRlLnRpZXIgPSB0aWVyOwogICAgICB1cGdyYWRlLmJ1aWxkaW5nVGllMSA9IGIxOwogICAgICB1cGdyYWRlLmJ1aWxkaW5nVGllMiA9IGIyOwogICAgICB1cGdyYWRlLnByaWNlRnVuYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gKAogICAgICAgICAgKHRoaXMuYnVpbGRpbmdUaWUxLmJhc2VQcmljZSAqIDEwICsgdGhpcy5idWlsZGluZ1RpZTIuYmFzZVByaWNlICogMSkgKgogICAgICAgICAgR2FtZS5UaWVyc1t0aGlzLnRpZXJdLnByaWNlICoKICAgICAgICAgIChHYW1lLkhhcygiQ2hpbWVyYSIpID8gMC45OCA6IDEpCiAgICAgICAgKTsKICAgICAgfTsKICAgICAgR2FtZS5PYmplY3RzW2J1aWxkaW5nMV0uc3luZXJnaWVzLnB1c2godXBncmFkZSk7CiAgICAgIEdhbWUuT2JqZWN0c1tidWlsZGluZzJdLnN5bmVyZ2llcy5wdXNoKHVwZ3JhZGUpOwogICAgICAvL0dhbWUuU2V0VGllcihidWlsZGluZzEsdGllcik7CiAgICAgIHJldHVybiB1cGdyYWRlOwogICAgfTsKICAgIEdhbWUuR2V0VGllcmVkQ3BzTXVsdCA9IGZ1bmN0aW9uIChtZSkgewogICAgICB2YXIgbXVsdCA9IDE7CiAgICAgIGZvciAodmFyIGkgaW4gbWUudGllcmVkVXBncmFkZXMpIHsKICAgICAgICBpZiAoCiAgICAgICAgICAhR2FtZS5UaWVyc1ttZS50aWVyZWRVcGdyYWRlc1tpXS50aWVyXS5zcGVjaWFsICYmCiAgICAgICAgICBHYW1lLkhhcyhtZS50aWVyZWRVcGdyYWRlc1tpXS5uYW1lKQogICAgICAgICkgewogICAgICAgICAgdmFyIHRpZXJNdWx0ID0gMjsKICAgICAgICAgIC8vdW5zaGFja2xlZAogICAgICAgICAgaWYgKAogICAgICAgICAgICBHYW1lLmFzY2Vuc2lvbk1vZGUgIT0gMSAmJgogICAgICAgICAgICBHYW1lLkhhcyhtZS51bnNoYWNrbGVVcGdyYWRlKSAmJgogICAgICAgICAgICBHYW1lLkhhcyhHYW1lLlRpZXJzW21lLnRpZXJlZFVwZ3JhZGVzW2ldLnRpZXJdLnVuc2hhY2tsZVVwZ3JhZGUpCiAgICAgICAgICApCiAgICAgICAgICAgIHRpZXJNdWx0ICs9IG1lLmlkID09IDEgPyAwLjUgOiAoMjAgLSBtZS5pZCkgKiAwLjE7CiAgICAgICAgICBtdWx0ICo9IHRpZXJNdWx0OwogICAgICAgIH0KICAgICAgfQogICAgICBmb3IgKHZhciBpIGluIG1lLnN5bmVyZ2llcykgewogICAgICAgIHZhciBzeW4gPSBtZS5zeW5lcmdpZXNbaV07CiAgICAgICAgaWYgKEdhbWUuSGFzKHN5bi5uYW1lKSkgewogICAgICAgICAgaWYgKHN5bi5idWlsZGluZ1RpZTEubmFtZSA9PSBtZS5uYW1lKQogICAgICAgICAgICBtdWx0ICo9IDEgKyAwLjA1ICogc3luLmJ1aWxkaW5nVGllMi5hbW91bnQ7CiAgICAgICAgICBlbHNlIGlmIChzeW4uYnVpbGRpbmdUaWUyLm5hbWUgPT0gbWUubmFtZSkKICAgICAgICAgICAgbXVsdCAqPSAxICsgMC4wMDEgKiBzeW4uYnVpbGRpbmdUaWUxLmFtb3VudDsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKG1lLmZvcnR1bmUgJiYgR2FtZS5IYXMobWUuZm9ydHVuZS5uYW1lKSkgbXVsdCAqPSAxLjA3OwogICAgICBpZiAobWUuZ3JhbmRtYSAmJiBHYW1lLkhhcyhtZS5ncmFuZG1hLm5hbWUpKQogICAgICAgIG11bHQgKj0gMSArIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLmFtb3VudCAqIDAuMDEgKiAoMSAvIChtZS5pZCAtIDEpKTsKICAgICAgcmV0dXJuIG11bHQ7CiAgICB9OwogICAgR2FtZS5VbmxvY2tUaWVyZWQgPSBmdW5jdGlvbiAobWUpIHsKICAgICAgZm9yICh2YXIgaSBpbiBtZS50aWVyZWRVcGdyYWRlcykgewogICAgICAgIGlmICgKICAgICAgICAgIEdhbWUuVGllcnNbbWUudGllcmVkVXBncmFkZXNbaV0udGllcl0udW5sb2NrICE9IC0xICYmCiAgICAgICAgICBtZS5hbW91bnQgPj0gR2FtZS5UaWVyc1ttZS50aWVyZWRVcGdyYWRlc1tpXS50aWVyXS51bmxvY2sKICAgICAgICApCiAgICAgICAgICBHYW1lLlVubG9jayhtZS50aWVyZWRVcGdyYWRlc1tpXS5uYW1lKTsKICAgICAgfQogICAgICBmb3IgKHZhciBpIGluIG1lLnRpZXJlZEFjaGlldnMpIHsKICAgICAgICBpZiAobWUuYW1vdW50ID49IEdhbWUuVGllcnNbbWUudGllcmVkQWNoaWV2c1tpXS50aWVyXS5hY2hpZXZVbmxvY2spCiAgICAgICAgICBHYW1lLldpbihtZS50aWVyZWRBY2hpZXZzW2ldLm5hbWUpOwogICAgICB9CiAgICAgIGZvciAodmFyIGkgaW4gbWUuc3luZXJnaWVzKSB7CiAgICAgICAgdmFyIHN5biA9IG1lLnN5bmVyZ2llc1tpXTsKICAgICAgICBpZiAoCiAgICAgICAgICBHYW1lLkhhcyhHYW1lLlRpZXJzW3N5bi50aWVyXS5yZXEpICYmCiAgICAgICAgICBzeW4uYnVpbGRpbmdUaWUxLmFtb3VudCA+PSBHYW1lLlRpZXJzW3N5bi50aWVyXS51bmxvY2sgJiYKICAgICAgICAgIHN5bi5idWlsZGluZ1RpZTIuYW1vdW50ID49IEdhbWUuVGllcnNbc3luLnRpZXJdLnVubG9jawogICAgICAgICkKICAgICAgICAgIEdhbWUuVW5sb2NrKHN5bi5uYW1lKTsKICAgICAgfQogICAgfTsKCiAgICB2YXIgcG9vbCA9ICIiOwogICAgdmFyIHBvd2VyID0gMDsKCiAgICAvL2RlZmluZSB1cGdyYWRlcwogICAgLy9XQVJOSU5HIDogZG8gTk9UIGFkZCBuZXcgdXBncmFkZXMgaW4gYmV0d2VlbiwgdGhpcyBicmVha3MgdGhlIHNhdmVzLiBBZGQgdGhlbSBhdCB0aGUgZW5kICEKICAgIHZhciBvcmRlciA9IDEwMDsgLy90aGlzIGlzIHVzZWQgdG8gc2V0IHRoZSBvcmRlciBpbiB3aGljaCB0aGUgaXRlbXMgYXJlIGxpc3RlZAogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlJlaW5mb3JjZWQgaW5kZXggZmluZ2VyIiwKICAgICAgbG9jKCJUaGUgbW91c2UgYW5kIGN1cnNvcnMgYXJlIDxiPnR3aWNlPC9iPiBhcyBlZmZpY2llbnQuIikgKwogICAgICAgICI8cT5wcm9kIHByb2Q8L3E+IiwKICAgICAgMTAwLAogICAgICBbMCwgMF0KICAgICk7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCAxLCAwKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJDYXJwYWwgdHVubmVsIHByZXZlbnRpb24gY3JlYW0iLAogICAgICBsb2MoIlRoZSBtb3VzZSBhbmQgY3Vyc29ycyBhcmUgPGI+dHdpY2U8L2I+IGFzIGVmZmljaWVudC4iKSArCiAgICAgICAgIjxxPml0Li4uIGl0IGh1cnRzIHRvIGNsaWNrLi4uPC9xPiIsCiAgICAgIDUwMCwKICAgICAgWzAsIDFdCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgMiwgMCk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQW1iaWRleHRyb3VzIiwKICAgICAgbG9jKCJUaGUgbW91c2UgYW5kIGN1cnNvcnMgYXJlIDxiPnR3aWNlPC9iPiBhcyBlZmZpY2llbnQuIikgKwogICAgICAgICI8cT5Mb29rIG1hLCBib3RoIGhhbmRzITwvcT4iLAogICAgICAxMDAwMCwKICAgICAgWzAsIDJdCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgMywgMCk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiVGhvdXNhbmQgZmluZ2VycyIsCiAgICAgIGxvYygKICAgICAgICAiVGhlIG1vdXNlIGFuZCBjdXJzb3JzIGdhaW4gPGI+KyUxPC9iPiBjb29raWVzIGZvciBlYWNoIG5vbi1jdXJzb3IgYnVpbGRpbmcgb3duZWQuIiwKICAgICAgICAwLjEKICAgICAgKSArICI8cT5jbGlja2l0eTwvcT4iLAogICAgICAxMDAwMDAsCiAgICAgIFswLCAxM10KICAgICk7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCA0LCAwKTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiTWlsbGlvbiBmaW5nZXJzIiwKICAgICAgZ2V0U3RyVGhvdXNhbmRGaW5nZXJzR2Fpbig1KSArICI8cT5jbGlja2l0eWNsaWNraXR5PC9xPiIsCiAgICAgIDEwMDAwMDAwLAogICAgICBbMCwgMTRdCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgNSwgMCk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQmlsbGlvbiBmaW5nZXJzIiwKICAgICAgZ2V0U3RyVGhvdXNhbmRGaW5nZXJzR2FpbigxMCkgKyAiPHE+Y2xpY2tpdHljbGlja2l0eWNsaWNraXR5PC9xPiIsCiAgICAgIDEwMDAwMDAwMCwKICAgICAgWzAsIDE1XQogICAgKTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDYsIDApOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlRyaWxsaW9uIGZpbmdlcnMiLAogICAgICBnZXRTdHJUaG91c2FuZEZpbmdlcnNHYWluKDIwKSArICI8cT5jbGlja2l0eWNsaWNraXR5Y2xpY2tpdHljbGlja2l0eTwvcT4iLAogICAgICAxMDAwMDAwMDAwLAogICAgICBbMCwgMTZdCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgNywgMCk7CgogICAgb3JkZXIgPSAyMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJGb3J3YXJkcyBmcm9tIGdyYW5kbWEiLAogICAgICAiPHE+UkU6UkU6dGhvdWdodCB5b3UnZCBnZXQgYSBraWNrIG91dCBvZiB0aGlzIDspKTwvcT4iLAogICAgICAiR3JhbmRtYSIsCiAgICAgIDEKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJTdGVlbC1wbGF0ZWQgcm9sbGluZyBwaW5zIiwKICAgICAgIjxxPkp1c3Qgd2hhdCB5b3Uga25lYWRlZC48L3E+IiwKICAgICAgIkdyYW5kbWEiLAogICAgICAyCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKCJMdWJyaWNhdGVkIGRlbnR1cmVzIiwgIjxxPnNxdWlzaDwvcT4iLCAiR3JhbmRtYSIsIDMpOwoKICAgIG9yZGVyID0gMzAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKCJDaGVhcCBob2VzIiwgIjxxPlJha2UgaW4gdGhlIGRvdWdoITwvcT4iLCAiRmFybSIsIDEpOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRmVydGlsaXplciIsCiAgICAgICI8cT5JdCdzIGNob2NvbGF0ZSwgSSBzd2Vhci48L3E+IiwKICAgICAgIkZhcm0iLAogICAgICAyCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQ29va2llIHRyZWVzIiwKICAgICAgIjxxPkEgcmVsYXRpdmUgb2YgdGhlIGJyZWFkZnJ1aXQuPC9xPiIsCiAgICAgICJGYXJtIiwKICAgICAgMwogICAgKTsKCiAgICBvcmRlciA9IDUwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlN0dXJkaWVyIGNvbnZleW9yIGJlbHRzIiwKICAgICAgIjxxPllvdSdyZSBnb2luZyBwbGFjZXMuPC9xPiIsCiAgICAgICJGYWN0b3J5IiwKICAgICAgMQogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkNoaWxkIGxhYm9yIiwKICAgICAgIjxxPkNoZWFwZXIsIGhlYWx0aGllciB3b3JrZm9yY2UuPC9xPiIsCiAgICAgICJGYWN0b3J5IiwKICAgICAgMgogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlN3ZWF0c2hvcCIsCiAgICAgICI8cT5TbGFja2VycyB3aWxsIGJlIHRlcm1pbmF0ZWQuPC9xPiIsCiAgICAgICJGYWN0b3J5IiwKICAgICAgMwogICAgKTsKCiAgICBvcmRlciA9IDQwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlN1Z2FyIGdhcyIsCiAgICAgICI8cT5BIHBpbmssIHZvbGF0aWxlIGdhcywgZm91bmQgaW4gdGhlIGRlcHRocyBvZiBzb21lIGNob2NvbGF0ZSBjYXZlcy48L3E+IiwKICAgICAgIk1pbmUiLAogICAgICAxCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKCJNZWdhZHJpbGwiLCAiPHE+WW91J3JlIGluIGRlZXAuPC9xPiIsICJNaW5lIiwgMik7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoIlVsdHJhZHJpbGwiLCAiPHE+RmluYWxseSBjYXZlZCBpbj88L3E+IiwgIk1pbmUiLCAzKTsKCiAgICBvcmRlciA9IDYwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlZhbmlsbGEgbmVidWxhZSIsCiAgICAgICI8cT5JZiB5b3UgcmVtb3ZlZCB5b3VyIHNwYWNlIGhlbG1ldCwgeW91IGNvdWxkIHByb2JhYmx5IHNtZWxsIGl0ITxicj4oTm90ZSA6IGRvbid0IGRvIHRoYXQuKTwvcT4iLAogICAgICAiU2hpcG1lbnQiLAogICAgICAxCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiV29ybWhvbGVzIiwKICAgICAgIjxxPkJ5IHVzaW5nIHRoZXNlIGFzIHNob3J0Y3V0cywgeW91ciBzaGlwcyBjYW4gdHJhdmVsIG11Y2ggZmFzdGVyLjwvcT4iLAogICAgICAiU2hpcG1lbnQiLAogICAgICAyCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRnJlcXVlbnQgZmx5ZXIiLAogICAgICAiPHE+Q29tZSBiYWNrIHNvb24hPC9xPiIsCiAgICAgICJTaGlwbWVudCIsCiAgICAgIDMKICAgICk7CgogICAgb3JkZXIgPSA3MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJBbnRpbW9ueSIsCiAgICAgICI8cT5BY3R1YWxseSB3b3J0aCBhIGxvdCBvZiBtb255LjwvcT4iLAogICAgICAiQWxjaGVteSBsYWIiLAogICAgICAxCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRXNzZW5jZSBvZiBkb3VnaCIsCiAgICAgICI8cT5FeHRyYWN0ZWQgdGhyb3VnaCB0aGUgNSBhbmNpZW50IHN0ZXBzIG9mIGFsY2hlbWljYWwgYmFraW5nLjwvcT4iLAogICAgICAiQWxjaGVteSBsYWIiLAogICAgICAyCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiVHJ1ZSBjaG9jb2xhdGUiLAogICAgICAiPHE+VGhlIHB1cmVzdCBmb3JtIG9mIGNhY2FvLjwvcT4iLAogICAgICAiQWxjaGVteSBsYWIiLAogICAgICAzCiAgICApOwoKICAgIG9yZGVyID0gODAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQW5jaWVudCB0YWJsZXQiLAogICAgICAiPHE+QSBzdHJhbmdlIHNsYWIgb2YgcGVhbnV0IGJyaXR0bGUsIGhvbGRpbmcgYW4gYW5jaWVudCBjb29raWUgcmVjaXBlLiBOZWF0ITwvcT4iLAogICAgICAiUG9ydGFsIiwKICAgICAgMQogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkluc2FuZSBvYXRsaW5nIHdvcmtlcnMiLAogICAgICAiPHE+QVJJU0UsIE1ZIE1JTklPTlMhPC9xPiIsCiAgICAgICJQb3J0YWwiLAogICAgICAyCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiU291bCBib25kIiwKICAgICAgIjxxPlNvIEkganVzdCBzaWduIHVwIGFuZCBnZXQgbW9yZSBjb29raWVzPyBTdXJlLCB3aGF0ZXZlciE8L3E+IiwKICAgICAgIlBvcnRhbCIsCiAgICAgIDMKICAgICk7CgogICAgb3JkZXIgPSA5MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJGbHV4IGNhcGFjaXRvcnMiLAogICAgICAiPHE+QmFrZSB0byB0aGUgZnV0dXJlLjwvcT4iLAogICAgICAiVGltZSBtYWNoaW5lIiwKICAgICAgMQogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRpbWUgcGFyYWRveCByZXNvbHZlciIsCiAgICAgICI8cT5ObyBtb3JlIGZvb2xpbmcgYXJvdW5kIHdpdGggeW91ciBvd24gZ3JhbmRtb3RoZXIhPC9xPiIsCiAgICAgICJUaW1lIG1hY2hpbmUiLAogICAgICAyCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiUXVhbnR1bSBjb251bmRydW0iLAogICAgICAiPHE+VGhlcmUgaXMgb25seSBvbmUgY29uc3RhbnQsIGFuZCB0aGF0IGlzIHVuaXZlcnNhbCB1bmNlcnRhaW50eS48YnI+T3IgaXMgaXQ/PC9xPiIsCiAgICAgICJUaW1lIG1hY2hpbmUiLAogICAgICAzCiAgICApOwoKICAgIG9yZGVyID0gMjAwMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiS2l0dGVuIGhlbHBlcnMiLAogICAgICBzdHJLaXR0ZW5EZXNjICsgIjxxPm1lb3cgbWF5IEkgaGVscCB5b3U8L3E+IiwKICAgICAgOTAwMDAwMCwKICAgICAgR2FtZS5HZXRJY29uKCJLaXR0ZW4iLCAxKQogICAgKTsKICAgIEdhbWUubGFzdC5raXR0ZW4gPSAxOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgMSwgMTgpOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIktpdHRlbiB3b3JrZXJzIiwKICAgICAgc3RyS2l0dGVuRGVzYyArICI8cT5tZW93IG1lb3cgbWVvdyBtZW93PC9xPiIsCiAgICAgIDkwMDAwMDAwMDAsCiAgICAgIEdhbWUuR2V0SWNvbigiS2l0dGVuIiwgMikKICAgICk7CiAgICBHYW1lLmxhc3Qua2l0dGVuID0gMTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDIsIDE4KTsKCiAgICBvcmRlciA9IDEwMDAwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlBsYWluIGNvb2tpZXMiLAogICAgICBkZXNjOiAiV2UgYWxsIGdvdHRhIHN0YXJ0IHNvbWV3aGVyZS4iLAogICAgICBpY29uOiBbMiwgM10sCiAgICAgIHBvd2VyOiAxLAogICAgICBwcmljZTogOTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiU3VnYXIgY29va2llcyIsCiAgICAgIGRlc2M6ICJUYXN0eSwgaWYgYSBsaXR0bGUgdW5pbWFnaW5hdGl2ZS4iLAogICAgICBpY29uOiBbNywgM10sCiAgICAgIHBvd2VyOiAxLAogICAgICBwcmljZTogOTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIk9hdG1lYWwgcmFpc2luIGNvb2tpZXMiLAogICAgICBkZXNjOiAiTm8gcmFpc2luIHRvIGhhdGUgdGhlc2UuIiwKICAgICAgaWNvbjogWzAsIDNdLAogICAgICBwb3dlcjogMSwKICAgICAgcHJpY2U6IDk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJQZWFudXQgYnV0dGVyIGNvb2tpZXMiLAogICAgICBkZXNjOiAiR2V0IHlvdXJzZWxmIHNvbWUgamFtIGNvb2tpZXMhIiwKICAgICAgaWNvbjogWzEsIDNdLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQ29jb251dCBjb29raWVzIiwKICAgICAgZGVzYzogIkZsYWt5LCBidXQgbm90IHVucmVsaWFibGUuIFNvbWUgcGVvcGxlIGdvIGNyYXp5IGZvciB0aGVzZS4iLAogICAgICBpY29uOiBbMywgM10sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTksCiAgICB9KTsKICAgIG9yZGVyID0gMTAwMDE7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiV2hpdGUgY2hvY29sYXRlIGNvb2tpZXMiLAogICAgICBkZXNjOiAiSSBrbm93IHdoYXQgeW91J2xsIHNheS4gSXQncyBqdXN0IGNvY29hIGJ1dHRlciEgSXQncyBub3QgcmVhbCBjaG9jb2xhdGUhPGJyPk9oIHBsZWFzZS4iLAogICAgICBpY29uOiBbNCwgM10sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBvcmRlciA9IDEwMDAwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIk1hY2FkYW1pYSBudXQgY29va2llcyIsCiAgICAgIGRlc2M6ICJUaGV5J3JlIG1hY2FkYW1uIGRlbGljaW91cyEiLAogICAgICBpY29uOiBbNSwgM10sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTksCiAgICB9KTsKICAgIG9yZGVyID0gMTAwMDI7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiRG91YmxlLWNoaXAgY29va2llcyIsCiAgICAgIGRlc2M6ICJET1VCTEUgVEhFIENISVBTPGJyPkRPVUJMRSBUSEUgVEFTVFk8YnI+KGRvdWJsZSB0aGUgY2Fsb3JpZXMpIiwKICAgICAgaWNvbjogWzYsIDNdLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTk5OSAqIDUsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJXaGl0ZSBjaG9jb2xhdGUgbWFjYWRhbWlhIG51dCBjb29raWVzIiwKICAgICAgZGVzYzogIk9ydGVpbCdzIGZhdm9yaXRlLiIsCiAgICAgIGljb246IFs4LCAzXSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQWxsLWNob2NvbGF0ZSBjb29raWVzIiwKICAgICAgZGVzYzogIkNIT0NPVkVSRE9TRS4iLAogICAgICBpY29uOiBbOSwgM10sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTk5OSAqIDUsCiAgICB9KTsKCiAgICBvcmRlciA9IDEwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJRdWFkcmlsbGlvbiBmaW5nZXJzIiwKICAgICAgZ2V0U3RyVGhvdXNhbmRGaW5nZXJzR2FpbigyMCkgKwogICAgICAgICI8cT5jbGlja2l0eWNsaWNraXR5Y2xpY2tpdHljbGlja2l0eWNsaWNrPC9xPiIsCiAgICAgIDEwMDAwMDAwMDAwLAogICAgICBbMCwgMTddCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgOCwgMCk7CgogICAgb3JkZXIgPSAyMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoIlBydW5lIGp1aWNlIiwgIjxxPkdldHMgbWUgZ29pbmcuPC9xPiIsICJHcmFuZG1hIiwgNCk7CiAgICBvcmRlciA9IDMwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkdlbmV0aWNhbGx5LW1vZGlmaWVkIGNvb2tpZXMiLAogICAgICAiPHE+QWxsLW5hdHVyYWwgbXV0YXRpb25zLjwvcT4iLAogICAgICAiRmFybSIsCiAgICAgIDQKICAgICk7CiAgICBvcmRlciA9IDUwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlJhZGl1bSByZWFjdG9ycyIsCiAgICAgICI8cT5HaXZlcyB5b3VyIGNvb2tpZXMgYSBoZWFsdGh5IGdsb3cuPC9xPiIsCiAgICAgICJGYWN0b3J5IiwKICAgICAgNAogICAgKTsKICAgIG9yZGVyID0gNDAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiVWx0aW1hZHJpbGwiLAogICAgICAiPHE+UGllcmNlIHRoZSBoZWF2ZW5zLCBldGMuPC9xPiIsCiAgICAgICJNaW5lIiwKICAgICAgNAogICAgKTsKICAgIG9yZGVyID0gNjAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKCJXYXJwIGRyaXZlIiwgIjxxPlRvIGJvbGRseSBiYWtlLjwvcT4iLCAiU2hpcG1lbnQiLCA0KTsKICAgIG9yZGVyID0gNzAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQW1icm9zaWEiLAogICAgICAiPHE+QWRkaW5nIHRoaXMgdG8gdGhlIGNvb2tpZSBtaXggaXMgc3VyZSB0byBtYWtlIHRoZW0gZXZlbiBtb3JlIGFkZGljdGl2ZSE8YnI+UGVyaGFwcyBkYW5nZXJvdXNseSBzby48YnI+TGV0J3MgaG9wZSB5b3UgY2FuIGtlZXAgc2VsbGluZyB0aGVzZSBsZWdhbGx5LjwvcT4iLAogICAgICAiQWxjaGVteSBsYWIiLAogICAgICA0CiAgICApOwogICAgb3JkZXIgPSA4MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJTYW5pdHkgZGFuY2UiLAogICAgICAiPHE+V2UgY2FuIGNoYW5nZSBpZiB3ZSB3YW50IHRvLjxicj5XZSBjYW4gbGVhdmUgb3VyIGJyYWlucyBiZWhpbmQuPC9xPiIsCiAgICAgICJQb3J0YWwiLAogICAgICA0CiAgICApOwogICAgb3JkZXIgPSA5MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJDYXVzYWxpdHkgZW5mb3JjZXIiLAogICAgICAiPHE+V2hhdCBoYXBwZW5lZCwgaGFwcGVuZWQuPC9xPiIsCiAgICAgICJUaW1lIG1hY2hpbmUiLAogICAgICA0CiAgICApOwoKICAgIG9yZGVyID0gNTAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJMdWNreSBkYXkiLAogICAgICBsb2MoCiAgICAgICAgIkdvbGRlbiBjb29raWVzIGFwcGVhciA8Yj50d2ljZSBhcyBvZnRlbjwvYj4gYW5kIHN0YXkgPGI+dHdpY2UgYXMgbG9uZzwvYj4uIgogICAgICApICsgIjxxPk9oIGhleSwgYSBmb3VyLWxlYWYgcGVubnkhPC9xPiIsCiAgICAgIDc3Nzc3Nzc3NywKICAgICAgWzI3LCA2XQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTZXJlbmRpcGl0eSIsCiAgICAgIGxvYygKICAgICAgICAiR29sZGVuIGNvb2tpZXMgYXBwZWFyIDxiPnR3aWNlIGFzIG9mdGVuPC9iPiBhbmQgc3RheSA8Yj50d2ljZSBhcyBsb25nPC9iPi4iCiAgICAgICkgKyAiPHE+V2hhdCBqb3khIFNldmVuIGhvcnNlc2hvZXMhPC9xPiIsCiAgICAgIDc3Nzc3Nzc3Nzc3LAogICAgICBbMjcsIDZdCiAgICApOwoKICAgIG9yZGVyID0gMjAwMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiS2l0dGVuIGVuZ2luZWVycyIsCiAgICAgIHN0cktpdHRlbkRlc2MgKyAiPHE+bWVvdyBtZW93IG1lb3cgbWVvdywgc2lyPC9xPiIsCiAgICAgIDkwMDAwMDAwMDAwMDAwLAogICAgICBHYW1lLkdldEljb24oIktpdHRlbiIsIDMpCiAgICApOwogICAgR2FtZS5sYXN0LmtpdHRlbiA9IDE7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCAzLCAxOCk7CgogICAgb3JkZXIgPSAxMDAyMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJEYXJrIGNob2NvbGF0ZS1jb2F0ZWQgY29va2llcyIsCiAgICAgIGRlc2M6ICJUaGVzZSBhYnNvcmIgbGlnaHQgc28gd2VsbCB5b3UgYWxtb3N0IG5lZWQgdG8gc3F1aW50IHRvIHNlZSB0aGVtLiIsCiAgICAgIGljb246IFsxMCwgM10sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogOTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJXaGl0ZSBjaG9jb2xhdGUtY29hdGVkIGNvb2tpZXMiLAogICAgICBkZXNjOiAiVGhlc2UgZGF6emxpbmcgY29va2llcyBhYnNvbHV0ZWx5IGdsaXN0ZW4gd2l0aCBmbGF2b3IuIiwKICAgICAgaWNvbjogWzExLCAzXSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OSwKICAgIH0pOwoKICAgIEdhbWUuR3JhbmRtYVN5bmVyZ2llcyA9IFtdOwogICAgR2FtZS5HcmFuZG1hU3luZXJneSA9IGZ1bmN0aW9uIChuYW1lLCBkZXNjLCBidWlsZGluZykgewogICAgICB2YXIgYnVpbGRpbmcgPSBHYW1lLk9iamVjdHNbYnVpbGRpbmddOwogICAgICB2YXIgZ3JhbmRtYU51bWJlciA9IGxvYygiJTEgZ3JhbmRtYSIsIExCZWF1dGlmeShidWlsZGluZy5pZCAtIDEpKTsKICAgICAgZGVzYyA9CiAgICAgICAgbG9jKAogICAgICAgICAgIiUxIGFyZSA8Yj50d2ljZTwvYj4gYXMgZWZmaWNpZW50LiIsCiAgICAgICAgICBjYXAoR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0ucGx1cmFsKQogICAgICAgICkgKwogICAgICAgICIgIiArCiAgICAgICAgbG9jKCIlMSBnYWluIDxiPislMiU8L2I+IENwUyBwZXIgJTMuIiwgWwogICAgICAgICAgY2FwKGJ1aWxkaW5nLnBsdXJhbCksCiAgICAgICAgICAxLAogICAgICAgICAgZ3JhbmRtYU51bWJlciwKICAgICAgICBdKSArCiAgICAgICAgIjxxPiIgKwogICAgICAgIGRlc2MgKwogICAgICAgICI8L3E+IjsKCiAgICAgIHZhciB1cGdyYWRlID0gbmV3IEdhbWUuVXBncmFkZSgKICAgICAgICBuYW1lLAogICAgICAgIGRlc2MsCiAgICAgICAgYnVpbGRpbmcuYmFzZVByaWNlICogR2FtZS5UaWVyc1syXS5wcmljZSwKICAgICAgICBbMTAsIDldLAogICAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLnJlZHJhdygpOwogICAgICAgIH0KICAgICAgKTsKICAgICAgYnVpbGRpbmcuZ3JhbmRtYSA9IHVwZ3JhZGU7CiAgICAgIHVwZ3JhZGUuYnVpbGRpbmdUaWUgPSBidWlsZGluZzsKICAgICAgR2FtZS5HcmFuZG1hU3luZXJnaWVzLnB1c2godXBncmFkZS5uYW1lKTsKICAgICAgcmV0dXJuIHVwZ3JhZGU7CiAgICB9OwoKICAgIG9yZGVyID0gMjUwOwogICAgR2FtZS5HcmFuZG1hU3luZXJneSgKICAgICAgIkZhcm1lciBncmFuZG1hcyIsCiAgICAgICJBIG5pY2UgZmFybWVyIHRvIGdyb3cgbW9yZSBjb29raWVzLiIsCiAgICAgICJGYXJtIgogICAgKTsKICAgIEdhbWUuR3JhbmRtYVN5bmVyZ3koCiAgICAgICJNaW5lciBncmFuZG1hcyIsCiAgICAgICJBIG5pY2UgbWluZXIgdG8gZGlnIG1vcmUgY29va2llcy4iLAogICAgICAiTWluZSIKICAgICk7CiAgICBHYW1lLkdyYW5kbWFTeW5lcmd5KAogICAgICAiV29ya2VyIGdyYW5kbWFzIiwKICAgICAgIkEgbmljZSB3b3JrZXIgdG8gbWFudWZhY3R1cmUgbW9yZSBjb29raWVzLiIsCiAgICAgICJGYWN0b3J5IgogICAgKTsKICAgIEdhbWUuR3JhbmRtYVN5bmVyZ3koCiAgICAgICJDb3NtaWMgZ3JhbmRtYXMiLAogICAgICAiQSBuaWNlIHRoaW5nIHRvLi4uIHVoLi4uIGNvb2tpZXMuIiwKICAgICAgIlNoaXBtZW50IgogICAgKTsKICAgIEdhbWUuR3JhbmRtYVN5bmVyZ3koCiAgICAgICJUcmFuc211dGVkIGdyYW5kbWFzIiwKICAgICAgIkEgbmljZSBnb2xkZW4gZ3JhbmRtYSB0byBjb252ZXJ0IGludG8gbW9yZSBjb29raWVzLiIsCiAgICAgICJBbGNoZW15IGxhYiIKICAgICk7CiAgICBHYW1lLkdyYW5kbWFTeW5lcmd5KAogICAgICAiQWx0ZXJlZCBncmFuZG1hcyIsCiAgICAgICJhIE5pQ2UgR3JBbkRtQSB0TyBiQSMjIyMjIyMjIyMiLAogICAgICAiUG9ydGFsIgogICAgKTsKICAgIEdhbWUuR3JhbmRtYVN5bmVyZ3koCiAgICAgICJHcmFuZG1hcycgZ3JhbmRtYXMiLAogICAgICAiQSBuaWNlIGdyYW5kbWEncyBuaWNlIGdyYW5kbWEgdG8gYmFrZSBkb3VibGUgdGhlIGNvb2tpZXMuIiwKICAgICAgIlRpbWUgbWFjaGluZSIKICAgICk7CgogICAgb3JkZXIgPSAxNDAwMDsKICAgIEdhbWUuYmFzZVJlc2VhcmNoVGltZSA9IEdhbWUuZnBzICogNjAgKiAzMDsKICAgIEdhbWUuU2V0UmVzZWFyY2ggPSBmdW5jdGlvbiAod2hhdCwgdGltZSkgewogICAgICBpZiAoR2FtZS5VcGdyYWRlc1t3aGF0XSAmJiAhR2FtZS5IYXMod2hhdCkpIHsKICAgICAgICBHYW1lLnJlc2VhcmNoVCA9IEdhbWUuYmFzZVJlc2VhcmNoVGltZTsKICAgICAgICBpZiAoR2FtZS5IYXMoIlBlcnNpc3RlbnQgbWVtb3J5IikpCiAgICAgICAgICBHYW1lLnJlc2VhcmNoVCA9IE1hdGguY2VpbChHYW1lLmJhc2VSZXNlYXJjaFRpbWUgLyAxMCk7CiAgICAgICAgaWYgKEdhbWUuSGFzKCJVbHRyYXNjaWVuY2UiKSkgR2FtZS5yZXNlYXJjaFQgPSBHYW1lLmZwcyAqIDU7CiAgICAgICAgR2FtZS5uZXh0UmVzZWFyY2ggPSBHYW1lLlVwZ3JhZGVzW3doYXRdLmlkOwogICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgbG9jKCJSZXNlYXJjaCBoYXMgYmVndW4iKSwKICAgICAgICAgIGxvYygiWW91ciBiaW5nbyBjZW50ZXIvcmVzZWFyY2ggZmFjaWxpdHkgaXMgY29uZHVjdGluZyBleHBlcmltZW50cy4iKSwKICAgICAgICAgIFs5LCAwXQogICAgICAgICk7CiAgICAgIH0KICAgIH07CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkJpbmdvIGNlbnRlci9SZXNlYXJjaCBmYWNpbGl0eSIsCiAgICAgIGxvYygKICAgICAgICAiR3JhbmRtYS1vcGVyYXRlZCBzY2llbmNlIGxhYiBhbmQgbGVpc3VyZSBjbHViLjxicj5HcmFuZG1hcyBhcmUgPGI+NCB0aW1lczwvYj4gYXMgZWZmaWNpZW50Ljxicj48Yj5SZWd1bGFybHkgdW5sb2NrcyBuZXcgdXBncmFkZXM8L2I+LiIKICAgICAgKSArCiAgICAgICAgIjxxPldoYXQgY291bGQgcG9zc2libHkga2VlcCB0aG9zZSBncmFuZG1vdGhlcnMgaW4gY2hlY2s/Li4uPGJyPkJpbmdvLjwvcT4iLAogICAgICAxMDAwMDAwMDAwMDAwMDAwLAogICAgICBbMTEsIDldLAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5TZXRSZXNlYXJjaCgiU3BlY2lhbGl6ZWQgY2hvY29sYXRlIGNoaXBzIik7CiAgICAgIH0KICAgICk7CiAgICBHYW1lLmxhc3Qubm9QZXJtID0gMTsKCiAgICBvcmRlciA9IDE1MDAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlNwZWNpYWxpemVkIGNob2NvbGF0ZSBjaGlwcyIsCiAgICAgIGdldFN0ckNvb2tpZVByb2R1Y3Rpb25NdWx0aXBsaWVyUGx1cygxKSArCiAgICAgICAgIjxxPkNvbXB1dGVyLWRlc2lnbmVkIGNob2NvbGF0ZSBjaGlwcy4gQ29tcHV0ZXIgY2hpcHMsIGlmIHlvdSB3aWxsLjwvcT4iLAogICAgICAxMDAwMDAwMDAwMDAwMDAwLAogICAgICBbMCwgOV0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLlNldFJlc2VhcmNoKCJEZXNpZ25lciBjb2NvYSBiZWFucyIpOwogICAgICB9CiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAidGVjaCI7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRGVzaWduZXIgY29jb2EgYmVhbnMiLAogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMikgKwogICAgICAgICI8cT5Ob3cgbW9yZSBhZXJvZHluYW1pYyB0aGFuIGV2ZXIhPC9xPiIsCiAgICAgIDIwMDAwMDAwMDAwMDAwMDAsCiAgICAgIFsxLCA5XSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuU2V0UmVzZWFyY2goIlJpdHVhbCByb2xsaW5nIHBpbnMiKTsKICAgICAgfQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInRlY2giOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlJpdHVhbCByb2xsaW5nIHBpbnMiLAogICAgICBsb2MoCiAgICAgICAgIiUxIGFyZSA8Yj50d2ljZTwvYj4gYXMgZWZmaWNpZW50LiIsCiAgICAgICAgY2FwKEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLnBsdXJhbCkKICAgICAgKSArICI8cT5UaGUgcmVzdWx0IG9mIHllYXJzIG9mIHNjaWVudGlmaWMgcmVzZWFyY2ghPC9xPiIsCiAgICAgIDQwMDAwMDAwMDAwMDAwMDAsCiAgICAgIFsyLCA5XSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuU2V0UmVzZWFyY2goIlVuZGVyd29ybGQgb3ZlbnMiKTsKICAgICAgfQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInRlY2giOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlVuZGVyd29ybGQgb3ZlbnMiLAogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMykgKwogICAgICAgICI8cT5Qb3dlcmVkIGJ5IHNjaWVuY2UsIG9mIGNvdXJzZSE8L3E+IiwKICAgICAgODAwMDAwMDAwMDAwMDAwMCwKICAgICAgWzMsIDldLAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5TZXRSZXNlYXJjaCgiT25lIG1pbmQiKTsKICAgICAgfQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInRlY2giOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIk9uZSBtaW5kIiwKICAgICAgbG9jKCJFYWNoICUxIGdhaW5zIDxiPislMiBiYXNlIENwUyBwZXIgJTM8L2I+LiIsIFsKICAgICAgICBsb2MoImdyYW5kbWEiKSwKICAgICAgICAiMC4wPHNwYW4+PC9zcGFuPjIiLAogICAgICAgIGxvYygiZ3JhbmRtYSIpLAogICAgICBdKSArCiAgICAgICAgJzxkaXYgY2xhc3M9Indhcm5pbmciPicgKwogICAgICAgIGxvYygKICAgICAgICAgICJOb3RlOiB0aGUgZ3JhbmRtb3RoZXJzIGFyZSBncm93aW5nIHJlc3RsZXNzLiBEbyBub3QgZW5jb3VyYWdlIHRoZW0uIgogICAgICAgICkgKwogICAgICAgICI8L2Rpdj48cT5XZSBhcmUgb25lLiBXZSBhcmUgbWFueS48L3E+IiwKICAgICAgMTYwMDAwMDAwMDAwMDAwMDAsCiAgICAgIFs0LCA5XSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuZWxkZXJXcmF0aCA9IDE7CiAgICAgICAgR2FtZS5TZXRSZXNlYXJjaCgiRXhvdGljIG51dHMiKTsKICAgICAgICBHYW1lLnN0b3JlVG9SZWZyZXNoID0gMTsKICAgICAgfQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInRlY2giOwogICAgLy9HYW1lLmxhc3QuY2xpY2tGdW5jdGlvbj1mdW5jdGlvbigpe3JldHVybiBjb25maXJtKCdXYXJuaW5nIDogcHVyY2hhc2luZyB0aGlzIHdpbGwgaGF2ZSB1bmV4cGVjdGVkLCBhbmQgcG90ZW50aWFsbHkgdW5kZXNpcmFibGUgcmVzdWx0cyFcbkl0XCdzIGFsbCBkb3duaGlsbCBmcm9tIGhlcmUuIFlvdSBoYXZlIGJlZW4gd2FybmVkIVxuUHVyY2hhc2UgYW55d2F5PycpO307CiAgICBHYW1lLlJlcXVpcmVzQ29uZmlybWF0aW9uKAogICAgICBHYW1lLmxhc3QsCiAgICAgICc8ZGl2IGNsYXNzPSJibG9jayI+JyArCiAgICAgICAgbG9jKAogICAgICAgICAgIjxiPldhcm5pbmc6PC9iPiBwdXJjaGFzaW5nIHRoaXMgd2lsbCBoYXZlIHVuZXhwZWN0ZWQsIGFuZCBwb3RlbnRpYWxseSB1bmRlc2lyYWJsZSByZXN1bHRzITxicj48c21hbGw+SXQncyBhbGwgZG93bmhpbGwgZnJvbSBoZXJlLiBZb3UgaGF2ZSBiZWVuIHdhcm5lZCE8L3NtYWxsPjxicj48YnI+UHVyY2hhc2UgYW55d2F5PyIKICAgICAgICApICsKICAgICAgICAiPC9kaXY+IgogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJFeG90aWMgbnV0cyIsCiAgICAgIGdldFN0ckNvb2tpZVByb2R1Y3Rpb25NdWx0aXBsaWVyUGx1cyg0KSArCiAgICAgICAgIjxxPllvdSdsbCBnbyBjcmF6eSBvdmVyIHRoZXNlITwvcT4iLAogICAgICAzMjAwMDAwMDAwMDAwMDAwMCwKICAgICAgWzUsIDldLAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5TZXRSZXNlYXJjaCgiQ29tbXVuYWwgYnJhaW5zd2VlcCIpOwogICAgICB9CiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAidGVjaCI7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQ29tbXVuYWwgYnJhaW5zd2VlcCIsCiAgICAgIChFTgogICAgICAgID8gIkVhY2ggZ3JhbmRtYSBnYWlucyBhbm90aGVyIDxiPiswLjA8c3Bhbj48L3NwYW4+MiBiYXNlIENwUyBwZXIgZ3JhbmRtYTwvYj4uIgogICAgICAgIDogbG9jKCJFYWNoICUxIGdhaW5zIDxiPislMiBiYXNlIENwUyBwZXIgJTM8L2I+LiIsIFsKICAgICAgICAgICAgbG9jKCJncmFuZG1hIiksCiAgICAgICAgICAgICIwLjA8c3Bhbj48L3NwYW4+MiIsCiAgICAgICAgICAgIGxvYygiZ3JhbmRtYSIpLAogICAgICAgICAgXSkpICsKICAgICAgICAnPGRpdiBjbGFzcz0id2FybmluZyI+JyArCiAgICAgICAgbG9jKAogICAgICAgICAgIk5vdGU6IHByb2NlZWRpbmcgYW55IGZ1cnRoZXIgaW4gc2NpZW50aWZpYyByZXNlYXJjaCBtYXkgaGF2ZSB1bmV4cGVjdGVkIHJlc3VsdHMuIFlvdSBoYXZlIGJlZW4gd2FybmVkLiIKICAgICAgICApICsKICAgICAgICAiPC9kaXY+PHE+V2UgZnVzZS4gV2UgbWVyZ2UuIFdlIGdyb3cuPC9xPiIsCiAgICAgIDY0MDAwMDAwMDAwMDAwMDAwLAogICAgICBbNiwgOV0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLmVsZGVyV3JhdGggPSAyOwogICAgICAgIEdhbWUuU2V0UmVzZWFyY2goIkFyY2FuZSBzdWdhciIpOwogICAgICAgIEdhbWUuc3RvcmVUb1JlZnJlc2ggPSAxOwogICAgICB9CiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAidGVjaCI7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQXJjYW5lIHN1Z2FyIiwKICAgICAgZ2V0U3RyQ29va2llUHJvZHVjdGlvbk11bHRpcGxpZXJQbHVzKDUpICsKICAgICAgICAiPHE+VGFzdGVzIGxpa2UgaW5zZWN0cywgbGlnYW1lbnRzLCBhbmQgbW9sYXNzZXMuPC9xPiIsCiAgICAgIDEyODAwMDAwMDAwMDAwMDAwMCwKICAgICAgWzcsIDldLAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5TZXRSZXNlYXJjaCgiRWxkZXIgUGFjdCIpOwogICAgICB9CiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAidGVjaCI7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRWxkZXIgUGFjdCIsCiAgICAgIGxvYygiRWFjaCAlMSBnYWlucyA8Yj4rJTIgYmFzZSBDcFMgcGVyICUzPC9iPi4iLCBbCiAgICAgICAgbG9jKCJncmFuZG1hIiksCiAgICAgICAgIjAuMDxzcGFuPjwvc3Bhbj41IiwKICAgICAgICBsb2MoInBvcnRhbCIpLAogICAgICBdKSArCiAgICAgICAgJzxkaXYgY2xhc3M9Indhcm5pbmciPicgKwogICAgICAgIGxvYygiTm90ZTogdGhpcyBpcyBhIGJhZCBpZGVhLiIpICsKICAgICAgICAiPC9kaXY+PHE+c3F1aXJtIGNyYXdsIHNsaXRoZXIgd3JpdGhlPGJyPnRvZGF5IHdlIHJpc2U8L3E+IiwKICAgICAgMjU2MDAwMDAwMDAwMDAwMDAwLAogICAgICBbOCwgOV0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLmVsZGVyV3JhdGggPSAzOwogICAgICAgIEdhbWUuc3RvcmVUb1JlZnJlc2ggPSAxOwogICAgICB9CiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAidGVjaCI7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRWxkZXIgUGxlZGdlIiwKICAgICAgbG9jKCJDb250YWlucyB0aGUgd3JhdGggb2YgdGhlIGVsZGVycywgYXQgbGVhc3QgZm9yIGEgd2hpbGUuIikgKwogICAgICAgICI8cT5UaGlzIGlzIGEgc2ltcGxlIHJpdHVhbCBpbnZvbHZpbmcgYW50aS1hZ2luZyBjcmVhbSwgY29va2llIGJhdHRlciBtaXhlZCBpbiB0aGUgbW9vbmxpZ2h0LCBhbmQgYSBsaXZlIGNoaWNrZW4uPC9xPiIsCiAgICAgIDEsCiAgICAgIFs5LCA5XSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuZWxkZXJXcmF0aCA9IDA7CiAgICAgICAgR2FtZS5wbGVkZ2VzKys7CiAgICAgICAgR2FtZS5wbGVkZ2VUID0gR2FtZS5nZXRQbGVkZ2VEdXJhdGlvbigpOwogICAgICAgIEdhbWUuVW5sb2NrKCJFbGRlciBDb3ZlbmFudCIpOwogICAgICAgIEdhbWUuQ29sbGVjdFdyaW5rbGVycygpOwogICAgICAgIEdhbWUuc3RvcmVUb1JlZnJlc2ggPSAxOwogICAgICB9CiAgICApOwogICAgR2FtZS5nZXRQbGVkZ2VEdXJhdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIEdhbWUuZnBzICogNjAgKiAoR2FtZS5IYXMoIlNhY3JpZmljaWFsIHJvbGxpbmcgcGlucyIpID8gNjAgOiAzMCk7CiAgICB9OwogICAgR2FtZS5sYXN0LnBvb2wgPSAidG9nZ2xlIjsKICAgIEdhbWUubGFzdC5kaXNwbGF5RnVuY1doZW5Pd25lZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuICgKICAgICAgICAnPGRpdiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7Ij4nICsKICAgICAgICBsb2MoIlRpbWUgcmVtYWluaW5nIHVudGlsIHBsZWRnZSBydW5zIG91dDoiKSArCiAgICAgICAgIjxicj48Yj4iICsKICAgICAgICBHYW1lLnNheVRpbWUoR2FtZS5wbGVkZ2VULCAtMSkgKwogICAgICAgICI8L2I+PC9kaXY+IgogICAgICApOwogICAgfTsKICAgIEdhbWUubGFzdC50aW1lckRpc3BsYXkgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICghR2FtZS5VcGdyYWRlc1siRWxkZXIgUGxlZGdlIl0uYm91Z2h0KSByZXR1cm4gLTE7CiAgICAgIGVsc2UgcmV0dXJuIDEgLSBHYW1lLnBsZWRnZVQgLyBHYW1lLmdldFBsZWRnZUR1cmF0aW9uKCk7CiAgICB9OwogICAgR2FtZS5sYXN0LnByaWNlRnVuYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIE1hdGgucG93KDgsIE1hdGgubWluKEdhbWUucGxlZGdlcyArIDIsIDE0KSk7CiAgICB9OwoKICAgIEdhbWUubGFzdC5kZXNjRnVuYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuICgKICAgICAgICAnPGRpdiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7Ij4nICsKICAgICAgICAoR2FtZS5wbGVkZ2VzID09IDAKICAgICAgICAgID8gbG9jKCJZb3UgaGF2ZW4ndCBwbGVkZ2VkIHRvIHRoZSBlbGRlcnMgeWV0LiIpCiAgICAgICAgICA6IGxvYygKICAgICAgICAgICAgICAiWW91J3ZlIHBsZWRnZWQgdG8gdGhlIGVsZGVycyA8Yj4lMSB0aW1lczwvYj4uIiwKICAgICAgICAgICAgICBMQmVhdXRpZnkoR2FtZS5wbGVkZ2VzKQogICAgICAgICAgICApKSArCiAgICAgICAgJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PjwvZGl2PicgKwogICAgICAgIHRoaXMuZGRlc2MKICAgICAgKTsKICAgIH07CgogICAgb3JkZXIgPSAxNTA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiUGxhc3RpYyBtb3VzZSIsCiAgICAgIGdldFN0ckNsaWNraW5nR2FpbnMoMSkgKyAiPHE+U2xpZ2h0bHkgc3F1ZWFreS48L3E+IiwKICAgICAgNTAwMDAsCiAgICAgIFsxMSwgMF0KICAgICk7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCAxLCAxMSk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiSXJvbiBtb3VzZSIsCiAgICAgIGdldFN0ckNsaWNraW5nR2FpbnMoMSkgKyAiPHE+Q2xpY2sgbGlrZSBpdCdzIDEzNDkhPC9xPiIsCiAgICAgIDUwMDAwMDAsCiAgICAgIFsxMSwgMV0KICAgICk7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCAyLCAxMSk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiVGl0YW5pdW0gbW91c2UiLAogICAgICBnZXRTdHJDbGlja2luZ0dhaW5zKDEpICsgIjxxPkhlYXZ5LCBidXQgcG93ZXJmdWwuPC9xPiIsCiAgICAgIDUwMDAwMDAwMCwKICAgICAgWzExLCAyXQogICAgKTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDMsIDExKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJBZGFtYW50aXVtIG1vdXNlIiwKICAgICAgZ2V0U3RyQ2xpY2tpbmdHYWlucygxKSArICI8cT5Zb3UgY291bGQgY3V0IGRpYW1vbmQgd2l0aCB0aGVzZS48L3E+IiwKICAgICAgNTAwMDAwMDAwMDAsCiAgICAgIFsxMSwgMTNdCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgNCwgMTEpOwoKICAgIG9yZGVyID0gNDAwMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiVWx0cmFzY2llbmNlIiwKICAgICAgbG9jKCJSZXNlYXJjaCB0YWtlcyBvbmx5IDxiPjUgc2Vjb25kczwvYj4uIikgKyAiPHE+WUVBSCwgU0NJRU5DRSE8L3E+IiwKICAgICAgNywKICAgICAgWzksIDJdCiAgICApOyAvL2RlYnVnIHB1cnBvc2VzIG9ubHkKICAgIEdhbWUubGFzdC5wb29sID0gImRlYnVnIjsKCiAgICBvcmRlciA9IDEwMDIwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkVjbGlwc2UgY29va2llcyIsCiAgICAgIGRlc2M6ICJMb29rIHRvIHRoZSBjb29raWUuIiwKICAgICAgaWNvbjogWzAsIDRdLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlplYnJhIGNvb2tpZXMiLAogICAgICBkZXNjOiAiLi4uIiwKICAgICAgaWNvbjogWzEsIDRdLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OSwKICAgIH0pOwoKICAgIG9yZGVyID0gMTAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlF1aW50aWxsaW9uIGZpbmdlcnMiLAogICAgICBnZXRTdHJUaG91c2FuZEZpbmdlcnNHYWluKDIwKSArCiAgICAgICAgIjxxPm1hbiwganVzdCBnbyBjbGljayBjbGljayBjbGljayBjbGljayBjbGljaywgaXQncyByZWFsIGVhc3ksIG1hbi48L3E+IiwKICAgICAgMTAwMDAwMDAwMDAwMDAsCiAgICAgIFswLCAxOF0KICAgICk7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCA5LCAwKTsKCiAgICBvcmRlciA9IDQwMDAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkdvbGQgaG9hcmQiLAogICAgICBsb2MoIkdvbGRlbiBjb29raWVzIGFwcGVhciA8Yj5yZWFsbHkgb2Z0ZW48L2I+LiIpICsKICAgICAgICAiPHE+VGhhdCdzIGVudGlyZWx5IHRvbyBtYW55LjwvcT4iLAogICAgICA3LAogICAgICBbMTAsIDE0XQogICAgKTsgLy9kZWJ1ZyBwdXJwb3NlcyBvbmx5CiAgICBHYW1lLmxhc3QucG9vbCA9ICJkZWJ1ZyI7CgogICAgb3JkZXIgPSAxNTAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJFbGRlciBDb3ZlbmFudCIsCiAgICAgIGxvYygKICAgICAgICAiUHV0cyBhIHBlcm1hbmVudCBlbmQgdG8gdGhlIGVsZGVycycgd3JhdGgsIGF0IHRoZSBjb3N0IG9mICUxJSBvZiB5b3VyIENwUy4iLAogICAgICAgIDUKICAgICAgKSArCiAgICAgICAgIjxxPlRoaXMgaXMgYSBjb21wbGljYXRlZCByaXR1YWwgaW52b2x2aW5nIHNpbGx5LCBpbmNvbnNlcXVlbnRpYWwgdHJpdmlhbGl0aWVzIHN1Y2ggYXMgY3Vyc2VkIGxheGF0aXZlcywgY2VudHVyeS1vbGQgY2FjYW8sIGFuZCBhbiBpbmZhbnQuPGJyPkRvbid0IHF1ZXN0aW9uIGl0LjwvcT4iLAogICAgICA2NjY2NjY2NjY2NjY2NiwKICAgICAgWzgsIDldLAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5wbGVkZ2VUID0gMDsKICAgICAgICBHYW1lLkxvY2soIlJldm9rZSBFbGRlciBDb3ZlbmFudCIpOwogICAgICAgIEdhbWUuVW5sb2NrKCJSZXZva2UgRWxkZXIgQ292ZW5hbnQiKTsKICAgICAgICBHYW1lLkxvY2soIkVsZGVyIFBsZWRnZSIpOwogICAgICAgIEdhbWUuV2luKCJFbGRlciBjYWxtIik7CiAgICAgICAgR2FtZS5Db2xsZWN0V3JpbmtsZXJzKCk7CiAgICAgICAgR2FtZS5zdG9yZVRvUmVmcmVzaCA9IDE7CiAgICAgIH0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJ0b2dnbGUiOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJSZXZva2UgRWxkZXIgQ292ZW5hbnQiLAogICAgICBsb2MoCiAgICAgICAgIllvdSB3aWxsIGdldCAlMSUgb2YgeW91ciBDcFMgYmFjaywgYnV0IHRoZSBncmFuZG1hdHJpYXJjaHMgd2lsbCByZXR1cm4uIiwKICAgICAgICA1CiAgICAgICkgKyAiPHE+d2U8YnI+cmlzZTxicj5hZ2FpbjwvcT4iLAogICAgICA2NjY2NjY2NjY2LAogICAgICBbOCwgOV0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLkxvY2soIkVsZGVyIENvdmVuYW50Iik7CiAgICAgICAgR2FtZS5VbmxvY2soIkVsZGVyIENvdmVuYW50Iik7CiAgICAgIH0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJ0b2dnbGUiOwoKICAgIG9yZGVyID0gNTAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJHZXQgbHVja3kiLAogICAgICBsb2MoIkdvbGRlbiBjb29raWUgZWZmZWN0cyBsYXN0IDxiPnR3aWNlIGFzIGxvbmc8L2I+LiIpICsKICAgICAgICAiPHE+WW91J3ZlIGJlZW4gdXAgYWxsIG5pZ2h0LCBoYXZlbid0IHlvdT88L3E+IiwKICAgICAgNzc3Nzc3Nzc3Nzc3NzcsCiAgICAgIFsyNywgNl0KICAgICk7CgogICAgb3JkZXIgPSAxNTAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTYWNyaWZpY2lhbCByb2xsaW5nIHBpbnMiLAogICAgICBsb2MoIkVsZGVyIHBsZWRnZXMgbGFzdCA8Yj50d2ljZTwvYj4gYXMgbG9uZy4iKSArCiAgICAgICAgIjxxPlRoZXNlIGFyZSBtb3N0bHkganVzdCBmb3Igc3ByZWFkaW5nIHRoZSBhbnRpLWFnaW5nIGNyZWFtLjxicj4oQW5kIGFjY2Vzc29yaWx5LCBzaG9ydGVuaW5nIHRoZSBjaGlja2VuJ3Mgc3VmZmVyaW5nLik8L3E+IiwKICAgICAgMjg4ODg4ODg4ODg4OCwKICAgICAgWzIsIDldCiAgICApOwoKICAgIG9yZGVyID0gMTAwMjA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiU25pY2tlcmRvb2RsZXMiLAogICAgICBkZXNjOiAiVHJ1ZSB0byB0aGVpciBuYW1lLiIsCiAgICAgIGljb246IFsyLCA0XSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiU3Ryb29wd2FmZWxzIiwKICAgICAgZGVzYzogIklmIGl0IGFpbid0IGR1dGNoLCBpdCBhaW4ndCBtdWNoLiIsCiAgICAgIGljb246IFszLCA0XSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiTWFjYXJvb25zIiwKICAgICAgZGVzYzogIk5vdCB0byBiZSBjb25mdXNlZCB3aXRoIG1hY2Fyb25zLjxicj5UaGVzZSBoYXZlIGNvY29udXQsIG9rYXk/IiwKICAgICAgaWNvbjogWzQsIDRdLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CgogICAgb3JkZXIgPSA0MDAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJOZXVyb21hbmN5IiwKICAgICAgbG9jKCJDYW4gdG9nZ2xlIHVwZ3JhZGVzIG9uIGFuZCBvZmYgYXQgd2lsbCBpbiB0aGUgc3RhdHMgbWVudS4iKSArCiAgICAgICAgIjxxPkNhbiBhbHNvIGNvbWUgaW4gaGFuZHkgdG8gdW5zZWUgdGhpbmdzIHRoYXQgY2FuJ3QgYmUgdW5zZWVuLjwvcT4iLAogICAgICA3LAogICAgICBbNCwgOV0KICAgICk7IC8vZGVidWcgcHVycG9zZXMgb25seQogICAgR2FtZS5sYXN0LnBvb2wgPSAiZGVidWciOwoKICAgIG9yZGVyID0gMTAwMjA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiRW1waXJlIGJpc2N1aXRzIiwKICAgICAgZGVzYzogIkZvciB5b3VyIGdyb3dpbmcgY29va2llIGVtcGlyZSwgb2YgY291cnNlISIsCiAgICAgIGljb246IFs1LCA0XSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgb3JkZXIgPSAxMDAzMTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJCcml0aXNoIHRlYSBiaXNjdWl0cyIsCiAgICAgIGRlc2M6ICJRdWl0ZS4iLAogICAgICBpY29uOiBbNiwgNF0sCiAgICAgIHJlcXVpcmU6ICJUaW4gb2YgYnJpdGlzaCB0ZWEgYmlzY3VpdHMiLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQ2hvY29sYXRlIGJyaXRpc2ggdGVhIGJpc2N1aXRzIiwKICAgICAgZGVzYzogIlllcywgcXVpdGUuIiwKICAgICAgaWNvbjogWzcsIDRdLAogICAgICByZXF1aXJlOiBHYW1lLmxhc3QubmFtZSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlJvdW5kIGJyaXRpc2ggdGVhIGJpc2N1aXRzIiwKICAgICAgZGVzYzogIlllcywgcXVpdGUgcml2ZXRpbmcuIiwKICAgICAgaWNvbjogWzgsIDRdLAogICAgICByZXF1aXJlOiBHYW1lLmxhc3QubmFtZSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlJvdW5kIGNob2NvbGF0ZSBicml0aXNoIHRlYSBiaXNjdWl0cyIsCiAgICAgIGRlc2M6ICJZZXMsIHF1aXRlIHJpdmV0aW5nIGluZGVlZC4iLAogICAgICBpY29uOiBbOSwgNF0sCiAgICAgIHJlcXVpcmU6IEdhbWUubGFzdC5uYW1lLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiUm91bmQgYnJpdGlzaCB0ZWEgYmlzY3VpdHMgd2l0aCBoZWFydCBtb3RpZiIsCiAgICAgIGRlc2M6ICJZZXMsIHF1aXRlIHJpdmV0aW5nIGluZGVlZCwgb2xkIGNoYXAuIiwKICAgICAgaWNvbjogWzEwLCA0XSwKICAgICAgcmVxdWlyZTogR2FtZS5sYXN0Lm5hbWUsCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJSb3VuZCBjaG9jb2xhdGUgYnJpdGlzaCB0ZWEgYmlzY3VpdHMgd2l0aCBoZWFydCBtb3RpZiIsCiAgICAgIGRlc2M6ICJJIGxpa2UgY29va2llcy4iLAogICAgICBpY29uOiBbMTEsIDRdLAogICAgICByZXF1aXJlOiBHYW1lLmxhc3QubmFtZSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwoKICAgIG9yZGVyID0gMTAwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlN1Z2FyIGJvc29ucyIsCiAgICAgICI8cT5Td2VldCBmaXJtIGJvc29ucy48L3E+IiwKICAgICAgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwKICAgICAgMQogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlN0cmluZyB0aGVvcnkiLAogICAgICAiPHE+UmV2ZWFscyBuZXcgaW5zaWdodCBhYm91dCB0aGUgdHJ1ZSBtZWFuaW5nIG9mIGJha2luZyBjb29raWVzIChhbmQsIGFzIGEgYm9udXMsIHRoZSBzdHJ1Y3R1cmUgb2YgdGhlIHVuaXZlcnNlKS48L3E+IiwKICAgICAgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwKICAgICAgMgogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkxhcmdlIG1hY2Fyb24gY29sbGlkZXIiLAogICAgICAiPHE+SG93IHNpbmd1bGFyITwvcT4iLAogICAgICAiQW50aW1hdHRlciBjb25kZW5zZXIiLAogICAgICAzCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQmlnIGJhbmcgYmFrZSIsCiAgICAgICI8cT5BbmQgdGhhdCdzIGhvdyBpdCBhbGwgYmVnYW4uPC9xPiIsCiAgICAgICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsCiAgICAgIDQKICAgICk7CgogICAgb3JkZXIgPSAyNTU7CiAgICBHYW1lLkdyYW5kbWFTeW5lcmd5KAogICAgICAiQW50aWdyYW5kbWFzIiwKICAgICAgIkEgbWVhbiBhbnRpZ3JhbmRtYSB0byB2b21pdCBtb3JlIGNvb2tpZXMuIiwKICAgICAgIkFudGltYXR0ZXIgY29uZGVuc2VyIgogICAgKTsKCiAgICBvcmRlciA9IDEwMDIwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIk1hZGVsZWluZXMiLAogICAgICBkZXNjOiAiVW5mb3JnZXR0YWJsZSEiLAogICAgICBpY29uOiBbMTIsIDNdLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlBhbG1pZXJzIiwKICAgICAgZGVzYzogIlBhbG1pZXIgdGhhbiB5b3UhIiwKICAgICAgaWNvbjogWzEzLCAzXSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OSAqIDUsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJQYWxldHMiLAogICAgICBkZXNjOiAiWW91IGNvdWxkIHByb2JhYmx5IHBsYXkgaG9ja2V5IHdpdGggdGhlc2UuPGJyPkkgbWVhbiwgeW91J3JlIHdlbGNvbWUgdG8gdHJ5LiIsCiAgICAgIGljb246IFsxMiwgNF0sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiU2FibCZlYWN1dGU7cyIsCiAgICAgIGRlc2M6ICJUaGUgbmFtZSBpbXBsaWVzIHRoZXkncmUgbWFkZSBvZiBzYW5kLiBCdXQgeW91IGtub3cgYmV0dGVyLCBkb24ndCB5b3U/IiwKICAgICAgaWNvbjogWzEzLCA0XSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKCiAgICBvcmRlciA9IDIwMDAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIktpdHRlbiBvdmVyc2VlcnMiLAogICAgICBzdHJLaXR0ZW5EZXNjICsgIjxxPm15IHB1cnJwb3NlIGlzIHRvIHNlcnZlIHlvdSwgc2lyPC9xPiIsCiAgICAgIDkwMDAwMDAwMDAwMDAwMDAwLAogICAgICBHYW1lLkdldEljb24oIktpdHRlbiIsIDQpCiAgICApOwogICAgR2FtZS5sYXN0LmtpdHRlbiA9IDE7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCA0LCAxOCk7CgogICAgb3JkZXIgPSAxMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiU2V4dGlsbGlvbiBmaW5nZXJzIiwKICAgICAgZ2V0U3RyVGhvdXNhbmRGaW5nZXJzR2FpbigyMCkgKwogICAgICAgICI8cT5zb21ldGltZXM8YnI+dGhpbmdzIGp1c3Q8YnI+Y2xpY2s8L3E+IiwKICAgICAgMTAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIFswLCAxOV0KICAgICk7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCAxMCwgMCk7CgogICAgb3JkZXIgPSAyMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJEb3VibGUtdGhpY2sgZ2xhc3NlcyIsCiAgICAgICI8cT5PaC4uLiBzbyBUSEFUJ3Mgd2hhdCBJJ3ZlIGJlZW4gYmFraW5nLjwvcT4iLAogICAgICAiR3JhbmRtYSIsCiAgICAgIDUKICAgICk7CiAgICBvcmRlciA9IDMwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkdpbmdlcmJyZWFkIHNjYXJlY3Jvd3MiLAogICAgICAiPHE+U3RhcmluZyBhdCB5b3VyIGNyb3BzIHdpdGggbWlzY2hpZXZvdXMgZ2xlZS48L3E+IiwKICAgICAgIkZhcm0iLAogICAgICA1CiAgICApOwogICAgb3JkZXIgPSA1MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJSZWNvbWJvYnVsYXRvcnMiLAogICAgICAiPHE+QSBtYWpvciBwYXJ0IG9mIGNvb2tpZSByZWNvbWJvYnVsYXRpb24uPC9xPiIsCiAgICAgICJGYWN0b3J5IiwKICAgICAgNQogICAgKTsKICAgIG9yZGVyID0gNDAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiSC1ib21iIG1pbmluZyIsCiAgICAgICI8cT5RdWVzdGlvbmFibGUgZWZmaWNpZW5jeSwgYnV0IHNwZWN0YWN1bGFyIG5vbmV0aGVsZXNzLjwvcT4iLAogICAgICAiTWluZSIsCiAgICAgIDUKICAgICk7CiAgICBvcmRlciA9IDYwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkNob2NvbGF0ZSBtb25vbGl0aHMiLAogICAgICAiPHE+TXkgZ29kLiBJdCdzIGZ1bGwgb2YgY2hvY29sYXRlIGJhcnMuPC9xPiIsCiAgICAgICJTaGlwbWVudCIsCiAgICAgIDUKICAgICk7CiAgICBvcmRlciA9IDcwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkFxdWEgY3J1c3R1bGFlIiwKICAgICAgIjxxPkNhcmVmdWwgd2l0aCB0aGUgZG9zaW5nIC0gb25lIGRyb3AgdG9vIG11Y2ggYW5kIHlvdSBnZXQgbXVmZmlucy48YnI+QW5kIG5vYm9keSBsaWtlcyBtdWZmaW5zLjwvcT4iLAogICAgICAiQWxjaGVteSBsYWIiLAogICAgICA1CiAgICApOwogICAgb3JkZXIgPSA4MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJCcmFuZSB0cmFuc3BsYW50IiwKICAgICAgJzxxPlRoaXMgcmVmZXJzIHRvIHRoZSBwcmFjdGljZSBvZiBtZXJnaW5nIGhpZ2hlciBkaW1lbnNpb25hbCB1bml2ZXJzZXMsIG9yICJicmFuZXMiLCB3aXRoIG91ciBvd24sIGluIG9yZGVyIHRvIGZhY2lsaXRhdGUgdHJhbnNpdCAoYW5kIGhhcnZlc3Rpbmcgb2YgcHJlY2lvdXMgY29va2llIGRvdWdoKS48L3E+JywKICAgICAgIlBvcnRhbCIsCiAgICAgIDUKICAgICk7CiAgICBvcmRlciA9IDkwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlllc3Rlcm1vcnJvdyBjb21wYXJhdG9ycyIsCiAgICAgICI8cT5Gb3J0bmlnaHRzIGludG8gbWlsbGVubmlhLjwvcT4iLAogICAgICAiVGltZSBtYWNoaW5lIiwKICAgICAgNQogICAgKTsKICAgIG9yZGVyID0gMTAwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlJldmVyc2UgY3ljbG90cm9ucyIsCiAgICAgICI8cT5UaGVzZSBjYW4gdW5jb2xsaXNpb24gcGFydGljbGVzIGFuZCB1bnNwaW4gYXRvbXMuIEZvci4uLiB1aC4uLiBiZXR0ZXIgZmxhdm9yLCBhbmQgc3R1ZmYuPC9xPiIsCiAgICAgICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsCiAgICAgIDUKICAgICk7CgogICAgb3JkZXIgPSAxNTA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiVW5vYnRhaW5pdW0gbW91c2UiLAogICAgICBnZXRTdHJDbGlja2luZ0dhaW5zKDEpICsgIjxxPlRoZXNlIG5pY2UgbWljZSBzaG91bGQgc3VmZmljZS48L3E+IiwKICAgICAgNTAwMDAwMDAwMDAwMCwKICAgICAgWzExLCAxNF0KICAgICk7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCA1LCAxMSk7CgogICAgb3JkZXIgPSAxMDAzMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJDYXJhbW9hcyIsCiAgICAgIGRlc2M6ICJZZWFoLiBUaGF0J3MgZ290IGEgbmljZSByaW5nIHRvIGl0LiIsCiAgICAgIGljb246IFsxNCwgNF0sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgYnJhbmQgYmlzY3VpdHMiLAogICAgICBwb3dlcjogMywKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJTYWdhbG9uZ3MiLAogICAgICBkZXNjOiAiR3JhbmRtYSdzIGZhdm9yaXRlPyIsCiAgICAgIGljb246IFsxNSwgM10sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgYnJhbmQgYmlzY3VpdHMiLAogICAgICBwb3dlcjogMywKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJTaG9ydGZvaWxzIiwKICAgICAgZGVzYzogIkZvaWxlZCBhZ2FpbiEiLAogICAgICBpY29uOiBbMTUsIDRdLAogICAgICByZXF1aXJlOiAiQm94IG9mIGJyYW5kIGJpc2N1aXRzIiwKICAgICAgcG93ZXI6IDMsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiV2luIG1pbnRzIiwKICAgICAgZGVzYzogIlRoZXkncmUgdGhlIGx1Y2tpZXN0IGNvb2tpZXMgeW91J3ZlIGV2ZXIgdGFzdGVkISIsCiAgICAgIGljb246IFsxNCwgM10sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgYnJhbmQgYmlzY3VpdHMiLAogICAgICBwb3dlcjogMywKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKCiAgICBvcmRlciA9IDQwMDAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlBlcmZlY3QgaWRsaW5nIiwKICAgICAgbG9jKCJZb3Uga2VlcCBwcm9kdWNpbmcgY29va2llcyBldmVuIHdoaWxlIHRoZSBnYW1lIGlzIGNsb3NlZC4iKSArCiAgICAgICAgIjxxPkl0J3MgdGhlIG1vc3QgYmVhdXRpZnVsIHRoaW5nIEkndmUgZXZlciBzZWVuLjwvcT4iLAogICAgICA3LAogICAgICBbMTAsIDBdCiAgICApOyAvL2RlYnVnIHB1cnBvc2VzIG9ubHkKICAgIEdhbWUubGFzdC5wb29sID0gImRlYnVnIjsKCiAgICBvcmRlciA9IDEwMDMwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkZpZyBnbHV0dG9ucyIsCiAgICAgIGRlc2M6ICJHb3QgaXQgYWxsIGZpZ3VyZWQgb3V0LiIsCiAgICAgIGljb246IFsxNywgNF0sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgYnJhbmQgYmlzY3VpdHMiLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OSAqIDUsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJMb3Jlb2xzIiwKICAgICAgZGVzYzogIkJlY2F1c2UsIHVoLi4uIHRoZXkncmUgd29ydGggaXQ/IiwKICAgICAgaWNvbjogWzE2LCAzXSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBicmFuZCBiaXNjdWl0cyIsCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkphZmZhIGNha2VzIiwKICAgICAgZGVzYzogIklmIHlvdSB3YW50IHRvIGJha2UgYSBjb29raWUgZnJvbSBzY3JhdGNoLCB5b3UgbXVzdCBmaXJzdCBidWlsZCBhIGZhY3RvcnkuIiwKICAgICAgaWNvbjogWzE3LCAzXSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBicmFuZCBiaXNjdWl0cyIsCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkdyZWFzZSdzIGN1cHMiLAogICAgICBkZXNjOiAiRXh0cmEtZ3JlYXN5IHBlYW51dCBidXR0ZXIuIiwKICAgICAgaWNvbjogWzE2LCA0XSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBicmFuZCBiaXNjdWl0cyIsCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwoKICAgIG9yZGVyID0gMzAwMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiSGVhdmVubHkgY2hpcCBzZWNyZXQiLAogICAgICBsb2MoIlVubG9ja3MgPGI+JTElPC9iPiBvZiB0aGUgcG90ZW50aWFsIG9mIHlvdXIgcHJlc3RpZ2UgbGV2ZWwuIiwgNSkgKwogICAgICAgICI8cT5HcmFudHMgdGhlIGtub3dsZWRnZSBvZiBoZWF2ZW5seSBjaGlwcywgYW5kIGhvdyB0byB1c2UgdGhlbSB0byBtYWtlIGJha2luZyBtb3JlIGVmZmljaWVudC48YnI+SXQncyBhIHNlY3JldCB0byBldmVyeW9uZS48L3E+IiwKICAgICAgMTEsCiAgICAgIFsxOSwgN10KICAgICk7CiAgICBHYW1lLmxhc3Qubm9QZXJtID0gMTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJIZWF2ZW5seSBjb29raWUgc3RhbmQiLAogICAgICBsb2MoIlVubG9ja3MgPGI+JTElPC9iPiBvZiB0aGUgcG90ZW50aWFsIG9mIHlvdXIgcHJlc3RpZ2UgbGV2ZWwuIiwgMjUpICsKICAgICAgICAiPHE+RG9uJ3QgZm9yZ2V0IHRvIHZpc2l0IHRoZSBoZWF2ZW5seSBsZW1vbmFkZSBzdGFuZCBhZnRlcndhcmRzLiBXaGVuIGFmdGVybGlmZSBnaXZlcyB5b3UgbGVtb25zLi4uPC9xPiIsCiAgICAgIDExMTEsCiAgICAgIFsxOCwgN10KICAgICk7CiAgICBHYW1lLmxhc3Qubm9QZXJtID0gMTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJIZWF2ZW5seSBiYWtlcnkiLAogICAgICBsb2MoIlVubG9ja3MgPGI+JTElPC9iPiBvZiB0aGUgcG90ZW50aWFsIG9mIHlvdXIgcHJlc3RpZ2UgbGV2ZWwuIiwgNTApICsKICAgICAgICAiPHE+QWxzbyBzZWxscyBnb2RseSBjYWtlcyBhbmQgZGl2aW5lIHBhc3RyaWVzLiBUaGUgcHJldHplbHMgYXJlbid0IHRvbyBiYWQgZWl0aGVyLjwvcT4iLAogICAgICAxMTExMTEsCiAgICAgIFsxNywgN10KICAgICk7CiAgICBHYW1lLmxhc3Qubm9QZXJtID0gMTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJIZWF2ZW5seSBjb25mZWN0aW9uZXJ5IiwKICAgICAgbG9jKCJVbmxvY2tzIDxiPiUxJTwvYj4gb2YgdGhlIHBvdGVudGlhbCBvZiB5b3VyIHByZXN0aWdlIGxldmVsLiIsIDc1KSArCiAgICAgICAgIjxxPlRoZXkgc2F5IGFuZ2VsIGJha2VycyB3b3JrIHRoZXJlLiBUaGV5IHRha2UgYW5nZWwgbHVuY2ggYnJlYWtzIGFuZCBzb21ldGltZXMgZ28gb24gYW5nZWwgc3RyaWtlcy48L3E+IiwKICAgICAgMTExMTExMTEsCiAgICAgIFsxNiwgN10KICAgICk7CiAgICBHYW1lLmxhc3Qubm9QZXJtID0gMTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJIZWF2ZW5seSBrZXkiLAogICAgICBsb2MoIlVubG9ja3MgPGI+JTElPC9iPiBvZiB0aGUgcG90ZW50aWFsIG9mIHlvdXIgcHJlc3RpZ2UgbGV2ZWwuIiwgMTAwKSArCiAgICAgICAgIjxxPlRoaXMgaXMgdGhlIGtleSB0byB0aGUgcGVhcmx5IChhbmQgdGFzdHkpIGdhdGVzIG9mIHBhc3RyeSBoZWF2ZW4sIGdyYW50aW5nIHlvdSBhY2Nlc3MgdG8geW91ciBlbnRpcmUgc3RvY2twaWxlIG9mIGhlYXZlbmx5IGNoaXBzIGZvciBiYWtpbmcgcHVycG9zZXMuPGJyPk1heSB5b3UgdXNlIHRoZW0gd2lzZWx5LjwvcT4iLAogICAgICAxMTExMTExMTExLAogICAgICBbMTUsIDddCiAgICApOwogICAgR2FtZS5sYXN0Lm5vUGVybSA9IDE7CgogICAgb3JkZXIgPSAxMDEwMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJTa3VsbCBjb29raWVzIiwKICAgICAgZGVzYzogIldhbm5hIGtub3cgc29tZXRoaW5nIHNwb29reT8gWW91J3ZlIGdvdCBvbmUgb2YgdGhlc2UgaW5zaWRlIHlvdXIgaGVhZCBSSUdIVCBOT1cuIiwKICAgICAgbG9ja2VkOiAxLAogICAgICBpY29uOiBbMTIsIDhdLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDQ0NDQ0NDQ0NDQ0NCwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkdob3N0IGNvb2tpZXMiLAogICAgICBkZXNjOiAiVGhleSdyZSBzb21ldGhpbmcgc3RyYW5nZSwgYnV0IHRoZXkgbG9vayBwcmV0dHkgZ29vZCEiLAogICAgICBsb2NrZWQ6IDEsCiAgICAgIGljb246IFsxMywgOF0sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogNDQ0NDQ0NDQ0NDQ0LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQmF0IGNvb2tpZXMiLAogICAgICBkZXNjOiAiVGhlIGNvb2tpZXMgdGhpcyB0b3duIGRlc2VydmVzLiIsCiAgICAgIGxvY2tlZDogMSwKICAgICAgaWNvbjogWzE0LCA4XSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA0NDQ0NDQ0NDQ0NDQsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJTbGltZSBjb29raWVzIiwKICAgICAgZGVzYzogIlRoZSBpbmNyZWRpYmxlIG1lbHRpbmcgY29va2llcyEiLAogICAgICBsb2NrZWQ6IDEsCiAgICAgIGljb246IFsxNSwgOF0sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogNDQ0NDQ0NDQ0NDQ0LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiUHVtcGtpbiBjb29raWVzIiwKICAgICAgZGVzYzogIk5vdCBldmVuIHB1bXBraW4tZmxhdm9yZWQuIFRhc3RlcyBsaWtlIGdsYXppbmcuIFlldWdoLiIsCiAgICAgIGxvY2tlZDogMSwKICAgICAgaWNvbjogWzE2LCA4XSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA0NDQ0NDQ0NDQ0NDQsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJFeWViYWxsIGNvb2tpZXMiLAogICAgICBkZXNjOiAiV2hlbiB5b3Ugc3RhcmUgaW50byB0aGUgY29va2llLCB0aGUgY29va2llIHN0YXJlcyBiYWNrIGF0IHlvdS4iLAogICAgICBsb2NrZWQ6IDEsCiAgICAgIGljb246IFsxNywgOF0sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogNDQ0NDQ0NDQ0NDQ0LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiU3BpZGVyIGNvb2tpZXMiLAogICAgICBkZXNjOiAiWW91IGZvdW5kIHRoZSByZWNpcGUgb24gdGhlIHdlYi4gVGhleSBkbyB3aGF0ZXZlciBhIGNvb2tpZSBjYW4uIiwKICAgICAgbG9ja2VkOiAxLAogICAgICBpY29uOiBbMTgsIDhdLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDQ0NDQ0NDQ0NDQ0NCwKICAgIH0pOwoKICAgIEdhbWUuaGFsbG93ZWVuRHJvcHMgPSBbCiAgICAgICJTa3VsbCBjb29raWVzIiwKICAgICAgIkdob3N0IGNvb2tpZXMiLAogICAgICAiQmF0IGNvb2tpZXMiLAogICAgICAiU2xpbWUgY29va2llcyIsCiAgICAgICJQdW1wa2luIGNvb2tpZXMiLAogICAgICAiRXllYmFsbCBjb29raWVzIiwKICAgICAgIlNwaWRlciBjb29raWVzIiwKICAgIF07CgogICAgR2FtZS5HZXRIb3dNYW55SGFsbG93ZWVuRHJvcHMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBudW0gPSAwOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUuaGFsbG93ZWVuRHJvcHMpIHsKICAgICAgICBpZiAoR2FtZS5IYXMoR2FtZS5oYWxsb3dlZW5Ecm9wc1tpXSkpIG51bSsrOwogICAgICB9CiAgICAgIHJldHVybiBudW07CiAgICB9OwogICAgLypmb3IgKHZhciBpIGluIEdhbWUuaGFsbG93ZWVuRHJvcHMpCgkJewoJCQlHYW1lLlVwZ3JhZGVzW0dhbWUuaGFsbG93ZWVuRHJvcHNbaV1dLmRlc2NGdW5jPWZ1bmN0aW9uKCl7cmV0dXJuICc8ZGl2IHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsiPllvdSBjdXJyZW50bHkgb3duIDxiPicrR2FtZS5HZXRIb3dNYW55SGFsbG93ZWVuRHJvcHMoKSsnLycrR2FtZS5oYWxsb3dlZW5Ecm9wcy5sZW5ndGgrJzwvYj4gaGFsbG93ZWVuIGNvb2tpZXMuPC9kaXY+PGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+Jyt0aGlzLmRkZXNjO307CgkJfSovCgogICAgb3JkZXIgPSAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlBlcnNpc3RlbnQgbWVtb3J5IiwKICAgICAgbG9jKCJTdWJzZXF1ZW50IHJlc2VhcmNoIHdpbGwgYmUgPGI+JTEgdGltZXM8L2I+IGFzIGZhc3QuIiwgMTApICsKICAgICAgICAiPHE+SXQncyBhbGwgbWFraW5nIHNlbnNlITxicj5BZ2FpbiE8L3E+IiwKICAgICAgNTAwLAogICAgICBbOSwgMl0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CgogICAgb3JkZXIgPSA0MDAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJXcmlua2xlciBkb29ybWF0IiwKICAgICAgbG9jKCJXcmlua2xlcnMgc3Bhd24gbXVjaCBtb3JlIGZyZXF1ZW50bHkuIikgKwogICAgICAgICI8cT5Zb3UncmUgc3VjaCBhIHB1c2hvdmVyLjwvcT4iLAogICAgICA3LAogICAgICBbMTksIDhdCiAgICApOyAvL2RlYnVnIHB1cnBvc2VzIG9ubHkKICAgIEdhbWUubGFzdC5wb29sID0gImRlYnVnIjsKCiAgICBvcmRlciA9IDEwMjAwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkNocmlzdG1hcyB0cmVlIGJpc2N1aXRzIiwKICAgICAgZGVzYzogIldob3NlIHBpbmUgaXMgaXQgYW55d2F5PyIsCiAgICAgIGxvY2tlZDogMSwKICAgICAgaWNvbjogWzEyLCAxMF0sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogMjUyNTI1MjUyNTI1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiU25vd2ZsYWtlIGJpc2N1aXRzIiwKICAgICAgZGVzYzogIk1hc3MtcHJvZHVjZWQgdG8gYmUgdW5pcXVlIGluIGV2ZXJ5IHdheS4iLAogICAgICBsb2NrZWQ6IDEsCiAgICAgIGljb246IFsxMywgMTBdLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDI1MjUyNTI1MjUyNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlNub3dtYW4gYmlzY3VpdHMiLAogICAgICBkZXNjOiAiSXQncyBmcm9zdGVkLiBEb3VibHkgc28uIiwKICAgICAgbG9ja2VkOiAxLAogICAgICBpY29uOiBbMTQsIDEwXSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiAyNTI1MjUyNTI1MjUsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJIb2xseSBiaXNjdWl0cyIsCiAgICAgIGRlc2M6ICJZb3UgZG9uJ3Qgc21vb2NoIHVuZGVyIHRoZXNlIG9uZXMuIFRoYXQgd291bGQgYmUgdGhlIG1pc3RsZXRvZSAod2hpY2gsIGJvdGFuaWNhbGx5LCBpcyBhIHNtZWxsaWVyIHZhcmlhbnQgb2YgdGhlIG1pc3RsZWZpbmdlcikuIiwKICAgICAgbG9ja2VkOiAxLAogICAgICBpY29uOiBbMTUsIDEwXSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiAyNTI1MjUyNTI1MjUsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJDYW5keSBjYW5lIGJpc2N1aXRzIiwKICAgICAgZGVzYzogIkl0J3MgdHdvIHRyZWF0cyBpbiBvbmUhPGJyPihGdXJ0aGVyIGluc3BlY3Rpb24gcmV2ZWFscyB0aGUgZnJvc3RpbmcgZG9lcyBub3QgYWN0dWFsbHkgdGFzdGUgbGlrZSBwZXBwZXJtaW50LCBidXQgbGlrZSBtdW5kYW5lIHN1Z2FyeSBmcm9zdGluZy4pIiwKICAgICAgbG9ja2VkOiAxLAogICAgICBpY29uOiBbMTYsIDEwXSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiAyNTI1MjUyNTI1MjUsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJCZWxsIGJpc2N1aXRzIiwKICAgICAgZGVzYzogIldoYXQgZG8gdGhlc2UgZXZlbiBoYXZlIHRvIGRvIHdpdGggY2hyaXN0bWFzPyBXaG8gY2FyZXMsIHJpbmcgdGhlbSBpbiEiLAogICAgICBsb2NrZWQ6IDEsCiAgICAgIGljb246IFsxNywgMTBdLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDI1MjUyNTI1MjUyNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlByZXNlbnQgYmlzY3VpdHMiLAogICAgICBkZXNjOiAiVGhlIHByZXF1ZWwgdG8gZnV0dXJlIGJpc2N1aXRzLiBXYXRjaCBvdXQhIiwKICAgICAgbG9ja2VkOiAxLAogICAgICBpY29uOiBbMTgsIDEwXSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiAyNTI1MjUyNTI1MjUsCiAgICB9KTsKCiAgICBvcmRlciA9IDEwMDIwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkdpbmdlcmJyZWFkIG1lbiIsCiAgICAgIGRlc2M6ICJZb3UgbGlrZSB0byBiaXRlIHRoZSBsZWdzIG9mZiBmaXJzdCwgcmlnaHQ/IEhvdyBhYm91dCB0ZWFyaW5nIG9mZiB0aGUgYXJtcz8gWW91IHNpY2sgbW9uc3Rlci4iLAogICAgICBpY29uOiBbMTgsIDRdLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJHaW5nZXJicmVhZCB0cmVlcyIsCiAgICAgIGRlc2M6ICJFdmVyZ3JlZW5zIGluIHBhc3RyeSBmb3JtLiBZdWxlIGJlIHN1cnByaXNlZCB3aGF0IHlvdSBjYW4gY29tZSB1cCB3aXRoLiIsCiAgICAgIGljb246IFsxOCwgM10sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwoKICAgIG9yZGVyID0gMjUwMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQSBmZXN0aXZlIGhhdCIsCiAgICAgICI8Yj4iICsKICAgICAgICBsb2MoIlVubG9ja3MuLi4gc29tZXRoaW5nLiIpICsKICAgICAgICAiPC9iPjxxPk5vdCBhIGNyZWF0dXJlIHdhcyBzdGlycmluZywgbm90IGV2ZW4gYSBtb3VzZS48L3E+IiwKICAgICAgMjUsCiAgICAgIFsxOSwgOV0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgZHJvcCA9IGNob29zZShHYW1lLnNhbnRhRHJvcHMpOwogICAgICAgIEdhbWUuVW5sb2NrKGRyb3ApOwogICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgbG9jKCJJbiB0aGUgZmVzdGl2ZSBoYXQsIHlvdSBmaW5kLi4uIiksCiAgICAgICAgICBsb2MoImEgZmVzdGl2ZSB0ZXN0IHR1YmU8YnI+YW5kIDxiPiUxPC9iPi4iLCBkcm9wKSwKICAgICAgICAgIEdhbWUuVXBncmFkZXNbZHJvcF0uaWNvbgogICAgICAgICk7CiAgICAgIH0KICAgICk7CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkluY3JlYXNlZCBtZXJyaW5lc3MiLAogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMTUpICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBTYW50YSBsZXZlbC4iKSArCiAgICAgICAgIjxxPkl0IHR1cm5zIG91dCB0aGF0IHRoZSBrZXkgdG8gaW5jcmVhc2VkIG1lcnJpbmVzcywgc3RyYW5nZWx5IGVub3VnaCwgaGFwcGVucyB0byBiZSBhIGdvb2QgY2FtcGZpcmUgYW5kIHNvbWUgcydtb3Jlcy48YnI+WW91IGtub3cgd2hhdCB0aGV5IHNheSwgYWZ0ZXIgYWxsOyB0aGUgcydtb3JlLCB0aGUgbWVycmllci48L3E+IiwKICAgICAgMjUyNSwKICAgICAgWzE3LCA5XQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJJbXByb3ZlZCBqb2xsaW5lc3MiLAogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMTUpICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBTYW50YSBsZXZlbC4iKSArCiAgICAgICAgIjxxPkEgbmljZSB3b2JibHkgYmVsbHkgZ29lcyBhIGxvbmcgd2F5Ljxicj5Zb3Ugam9sbHk/PC9xPiIsCiAgICAgIDI1MjUsCiAgICAgIFsxNywgOV0KICAgICk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQSBsdW1wIG9mIGNvYWwiLAogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMSkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIFNhbnRhIGxldmVsLiIpICsKICAgICAgICAiPHE+U29tZSBvZiB0aGUgd29ybGQncyB3b3JzdCBzdG9ja2luZyBzdHVmZmluZy48YnI+SSBndWVzcyB5b3UgY291bGQgdHJ5IHN0YXJ0aW5nIHlvdXIgb3duIGxpdHRsZSBpbmR1c3RyaWFsIHJldm9sdXRpb24sIG9yIHNvbWV0aGluZz8uLi48L3E+IiwKICAgICAgMjUyNSwKICAgICAgWzEzLCA5XQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJBbiBpdGNoeSBzd2VhdGVyIiwKICAgICAgZ2V0U3RyQ29va2llUHJvZHVjdGlvbk11bHRpcGxpZXJQbHVzKDEpICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBTYW50YSBsZXZlbC4iKSArCiAgICAgICAgIjxxPllvdSBkb24ndCBrbm93IHdoYXQncyB3b3JzZSA6IHRoZSBlbWJhcnJhc3NpbmdseSBxdWFpbnQgXCJlbGYgb24gcmVpbmRlZXJcIiBtb3RpZiwgb3IgdGhlIGZhY3QgdGhhdCB3ZWFyaW5nIGl0IG1ha2VzIHlvdSBmZWVsIGxpa2UgeW91J3JlIHdyYXBwZWQgaW4gYSBkZWFkIHNhc3F1YXRjaC48L3E+IiwKICAgICAgMjUyNSwKICAgICAgWzE0LCA5XQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJSZWluZGVlciBiYWtpbmcgZ3JvdW5kcyIsCiAgICAgIGxvYygiUmVpbmRlZXIgYXBwZWFyIDxiPnR3aWNlIGFzIGZyZXF1ZW50bHk8L2I+LiIpICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBTYW50YSBsZXZlbC4iKSArCiAgICAgICAgIjxxPk1hbGUgcmVpbmRlZXIgYXJlIGZyb20gTWFyczsgZmVtYWxlIHJlaW5kZWVyIGFyZSBmcm9tIHZlbmlzb24uPC9xPiIsCiAgICAgIDI1MjUsCiAgICAgIFsxMiwgOV0KICAgICk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiV2VpZ2h0ZWQgc2xlaWdocyIsCiAgICAgIGxvYygiUmVpbmRlZXIgYXJlIDxiPnR3aWNlIGFzIHNsb3c8L2I+LiIpICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBTYW50YSBsZXZlbC4iKSArCiAgICAgICAgIjxxPkhvcGUgaXQgd2FzIHdvcnRoIHRoZSB3ZWlnaHQuPGJyPihTb21ldGhpbmcgc29tZXRoaW5nIGZvcmNlZCBpbnRvIGNlcnZpZHVkZSk8L3E+IiwKICAgICAgMjUyNSwKICAgICAgWzEyLCA5XQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJIbyBobyBoby1mbGF2b3JlZCBmcm9zdGluZyIsCiAgICAgIGxvYygiUmVpbmRlZXIgZ2l2ZSA8Yj50d2ljZSBhcyBtdWNoPC9iPi4iKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoIkNvc3Qgc2NhbGVzIHdpdGggU2FudGEgbGV2ZWwuIikgKwogICAgICAgICI8cT5JdCdzIHRpbWUgdG8gdXAgdGhlIGFudGxlci48L3E+IiwKICAgICAgMjUyNSwKICAgICAgWzEyLCA5XQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTZWFzb24gc2F2aW5ncyIsCiAgICAgIGxvYygiQWxsIGJ1aWxkaW5ncyBhcmUgPGI+JTElIGNoZWFwZXI8L2I+LiIsIDEpICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBTYW50YSBsZXZlbC4iKSArCiAgICAgICAgIjxxPkJ5IFNhbnRhJ3MgYmVhcmQsIHdoYXQgc2F2aW5ncyE8YnI+QnV0IHdobyB3aWxsIHNhdmUgdXM/PC9xPiIsCiAgICAgIDI1MjUsCiAgICAgIFsxNiwgOV0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLnN0b3JlVG9SZWZyZXNoID0gMTsKICAgICAgfQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJUb3kgd29ya3Nob3AiLAogICAgICBsb2MoIkFsbCB1cGdyYWRlcyBhcmUgPGI+JTElIGNoZWFwZXI8L2I+LiIsIDUpICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBTYW50YSBsZXZlbC4iKSArCiAgICAgICAgIjxxPldhdGNoIHlvdXJzLWVsZiBhcm91bmQgZWx2ZXNkcm9wcGVycyB3aG8gbWlnaHQgc3RlYWwgb3VyIHByb2R1Y3Rpb24gc2VjcmV0cy48YnI+T3IgZWx2ZW4gd29yc2UhPC9xPiIsCiAgICAgIDI1MjUsCiAgICAgIFsxNiwgOV0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkID0gMTsKICAgICAgfQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJOYXVnaHR5IGxpc3QiLAogICAgICBsb2MoIiUxIGFyZSA8Yj50d2ljZTwvYj4gYXMgZWZmaWNpZW50LiIsIGNhcChsb2MoImdyYW5kbWFzIikpKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoIkNvc3Qgc2NhbGVzIHdpdGggU2FudGEgbGV2ZWwuIikgKwogICAgICAgICI8cT5UaGlzIGxpc3QgY29udGFpbnMgZXZlcnkgdW5ob2x5IGRlZWQgcGVycGV0dWF0ZWQgYnkgZ3JhbmRtYWtpbmQuPGJyPkhlIHdvbid0IGJlIGNoZWNraW5nIHRoaXMgb25lIHR3aWNlLjxicj5PbmNlLiBPbmNlIGlzIGVub3VnaC48L3E+IiwKICAgICAgMjUyNSwKICAgICAgWzE1LCA5XQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTYW50YSdzIGJvdHRvbWxlc3MgYmFnIiwKICAgICAgbG9jKCJSYW5kb20gZHJvcHMgYXJlIDxiPiUxJSBtb3JlIGNvbW1vbjwvYj4uIiwgMTApICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBTYW50YSBsZXZlbC4iKSArCiAgICAgICAgIjxxPlRoaXMgaXMgb25lIGJvdHRvbSB5b3UgY2FuJ3QgY2hlY2sgb3V0LjwvcT4iLAogICAgICAyNTI1LAogICAgICBbMTksIDldCiAgICApOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlNhbnRhJ3MgaGVscGVycyIsCiAgICAgIGxvYygiQ2xpY2tpbmcgaXMgPGI+JTElPC9iPiBtb3JlIHBvd2VyZnVsLiIsIDEwKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoIkNvc3Qgc2NhbGVzIHdpdGggU2FudGEgbGV2ZWwuIikgKwogICAgICAgICI8cT5Tb21lIGNob29zZSB0byBoZWxwIGhhbWJ1cmdlcjsgc29tZSBjaG9vc2UgdG8gaGVscCB5b3UuPGJyPlRvIGVhY2ggdGhlaXIgb3duLCBJIGd1ZXNzLjwvcT4iLAogICAgICAyNTI1LAogICAgICBbMTksIDldCiAgICApOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlNhbnRhJ3MgbGVnYWN5IiwKICAgICAgbG9jKCJDb29raWUgcHJvZHVjdGlvbiBtdWx0aXBsaWVyIDxiPislMSUgcGVyIFNhbnRhJ3MgbGV2ZWxzLjwvYj4iLCAzKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoIkNvc3Qgc2NhbGVzIHdpdGggU2FudGEgbGV2ZWwuIikgKwogICAgICAgICI8cT5JbiB0aGUgbm9ydGggcG9sZSwgeW91IGdvdHRhIGdldCB0aGUgZWx2ZXMgZmlyc3QuIFRoZW4gd2hlbiB5b3UgZ2V0IHRoZSBlbHZlcywgeW91IHN0YXJ0IG1ha2luZyB0aGUgdG95cy4gVGhlbiB3aGVuIHlvdSBnZXQgdGhlIHRveXMuLi4gdGhlbiB5b3UgZ2V0IHRoZSBjb29raWVzLjwvcT4iLAogICAgICAyNTI1LAogICAgICBbMTksIDldCiAgICApOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlNhbnRhJ3MgbWlsayBhbmQgY29va2llcyIsCiAgICAgIGxvYygiTWlsayBpcyA8Yj4lMSUgbW9yZSBwb3dlcmZ1bDwvYj4uIiwgNSkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIFNhbnRhIGxldmVsLiIpICsKICAgICAgICAiPHE+UGFydCBvZiBTYW50YSdzIGRyZWFkZnVsbHkgdW5iYWxhbmNlZCBkaWV0LjwvcT4iLAogICAgICAyNTI1LAogICAgICBbMTksIDldCiAgICApOwoKICAgIG9yZGVyID0gNDAwMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiUmVpbmRlZXIgc2Vhc29uIiwKICAgICAgbG9jKCJSZWluZGVlciBzcGF3biBtdWNoIG1vcmUgZnJlcXVlbnRseS4iKSArCiAgICAgICAgIjxxPkdvLCBDaGVhdGVyISBHbywgSGFja2VyIGFuZCBGYWtlciE8L3E+IiwKICAgICAgNywKICAgICAgWzEyLCA5XQogICAgKTsgLy9kZWJ1ZyBwdXJwb3NlcyBvbmx5CiAgICBHYW1lLmxhc3QucG9vbCA9ICJkZWJ1ZyI7CgogICAgb3JkZXIgPSAyNTAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTYW50YSdzIGRvbWluaW9uIiwKICAgICAgZ2V0U3RyQ29va2llUHJvZHVjdGlvbk11bHRpcGxpZXJQbHVzKDIwKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoIkFsbCBidWlsZGluZ3MgYXJlIDxiPiUxJSBjaGVhcGVyPC9iPi4iLCAxKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoIkFsbCB1cGdyYWRlcyBhcmUgPGI+JTElIGNoZWFwZXI8L2I+LiIsIDIpICsKICAgICAgICAiPHE+TXkgbmFtZSBpcyBDbGF1cywga2luZyBvZiBraW5nczs8YnI+TG9vayBvbiBteSB0b3lzLCB5ZSBNaWdodHksIGFuZCBkZXNwYWlyITwvcT4iLAogICAgICAyNTI1MjUyNTI1MjUyNTI1LAogICAgICBbMTksIDEwXSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuc3RvcmVUb1JlZnJlc2ggPSAxOwogICAgICB9CiAgICApOwoKICAgIG9yZGVyID0gMTAzMDA7CiAgICB2YXIgaGVhcnRQb3dlciA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHBvdyA9IDI7CiAgICAgIGlmIChHYW1lLkhhcygiU3RhcmxvdmUiKSkgcG93ID0gMzsKICAgICAgaWYgKEdhbWUuaGFzR29kKSB7CiAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJzZWFzb25zIik7CiAgICAgICAgaWYgKGdvZEx2bCA9PSAxKSBwb3cgKj0gMS4zOwogICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAyKSBwb3cgKj0gMS4yOwogICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAzKSBwb3cgKj0gMS4xOwogICAgICB9CiAgICAgIHJldHVybiBwb3c7CiAgICB9OwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlB1cmUgaGVhcnQgYmlzY3VpdHMiLAogICAgICBkZXNjOiAnTWVsdHkgd2hpdGUgY2hvY29sYXRlPGJyPnRoYXQgc2F5cyAiSSAqbGlrZSogbGlrZSB5b3UiLicsCiAgICAgIHNlYXNvbjogInZhbGVudGluZXMiLAogICAgICBpY29uOiBbMTksIDNdLAogICAgICBwb3dlcjogaGVhcnRQb3dlciwKICAgICAgcHJpY2U6IDEwMDAwMDAsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJBcmRlbnQgaGVhcnQgYmlzY3VpdHMiLAogICAgICBkZXNjOiAiQSByZWQgaG90IGNoZXJyeSBiaXNjdWl0IHRoYXQgd2lsbCBudWRnZSB0aGUgdGFyZ2V0IG9mIHlvdXIgYWZmZWN0aW9uIGluIGludGVyZXN0aW5nIGRpcmVjdGlvbnMuIiwKICAgICAgcmVxdWlyZTogR2FtZS5sYXN0Lm5hbWUsCiAgICAgIHNlYXNvbjogInZhbGVudGluZXMiLAogICAgICBpY29uOiBbMjAsIDNdLAogICAgICBwb3dlcjogaGVhcnRQb3dlciwKICAgICAgcHJpY2U6IDEwMDAwMDAwMDAsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJTb3VyIGhlYXJ0IGJpc2N1aXRzIiwKICAgICAgZGVzYzogIkEgYml0dGVyIGxpbWUgYmlzY3VpdCBmb3IgdGhlIGxvbmVseSBhbmQgdGhlIGhlYXJ0LWJyb2tlbi4iLAogICAgICByZXF1aXJlOiBHYW1lLmxhc3QubmFtZSwKICAgICAgc2Vhc29uOiAidmFsZW50aW5lcyIsCiAgICAgIGljb246IFsyMCwgNF0sCiAgICAgIHBvd2VyOiBoZWFydFBvd2VyLAogICAgICBwcmljZTogMTAwMDAwMDAwMDAwMCwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIldlZXBpbmcgaGVhcnQgYmlzY3VpdHMiLAogICAgICBkZXNjOiAiQW4gaWNlLWNvbGQgYmx1ZWJlcnJ5IGJpc2N1aXQsIHN5bWJvbCBvZiBhIG1lbmRpbmcgaGVhcnQuIiwKICAgICAgcmVxdWlyZTogR2FtZS5sYXN0Lm5hbWUsCiAgICAgIHNlYXNvbjogInZhbGVudGluZXMiLAogICAgICBpY29uOiBbMjEsIDNdLAogICAgICBwb3dlcjogaGVhcnRQb3dlciwKICAgICAgcHJpY2U6IDEwMDAwMDAwMDAwMDAwMDAsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJHb2xkZW4gaGVhcnQgYmlzY3VpdHMiLAogICAgICBkZXNjOiAiQSBiZWF1dGlmdWwgYmlzY3VpdCB0byBzeW1ib2xpemUga2luZG5lc3MsIHRydWUgbG92ZSwgYW5kIHNpbmNlcml0eS4iLAogICAgICByZXF1aXJlOiBHYW1lLmxhc3QubmFtZSwKICAgICAgc2Vhc29uOiAidmFsZW50aW5lcyIsCiAgICAgIGljb246IFsyMSwgNF0sCiAgICAgIHBvd2VyOiBoZWFydFBvd2VyLAogICAgICBwcmljZTogMTAwMDAwMDAwMDAwMDAwMDAwMCwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkV0ZXJuYWwgaGVhcnQgYmlzY3VpdHMiLAogICAgICBkZXNjOiAiU2lsdmVyIGljaW5nIGZvciBhIHZlcnkgc3BlY2lhbCBzb21lb25lIHlvdSd2ZSBsaWtlZCBmb3IgYSBsb25nLCBsb25nIHRpbWUuIiwKICAgICAgcmVxdWlyZTogR2FtZS5sYXN0Lm5hbWUsCiAgICAgIHNlYXNvbjogInZhbGVudGluZXMiLAogICAgICBpY29uOiBbMTksIDRdLAogICAgICBwb3dlcjogaGVhcnRQb3dlciwKICAgICAgcHJpY2U6IDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICB9KTsKCiAgICBHYW1lLmhlYXJ0RHJvcHMgPSBbCiAgICAgICJQdXJlIGhlYXJ0IGJpc2N1aXRzIiwKICAgICAgIkFyZGVudCBoZWFydCBiaXNjdWl0cyIsCiAgICAgICJTb3VyIGhlYXJ0IGJpc2N1aXRzIiwKICAgICAgIldlZXBpbmcgaGVhcnQgYmlzY3VpdHMiLAogICAgICAiR29sZGVuIGhlYXJ0IGJpc2N1aXRzIiwKICAgICAgIkV0ZXJuYWwgaGVhcnQgYmlzY3VpdHMiLAogICAgICAiUHJpc20gaGVhcnQgYmlzY3VpdHMiLAogICAgXTsKCiAgICBHYW1lLkdldEhvd01hbnlIZWFydERyb3BzID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgbnVtID0gMDsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLmhlYXJ0RHJvcHMpIHsKICAgICAgICBpZiAoR2FtZS5IYXMoR2FtZS5oZWFydERyb3BzW2ldKSkgbnVtKys7CiAgICAgIH0KICAgICAgcmV0dXJuIG51bTsKICAgIH07CgogICAgb3JkZXIgPSAxMTAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiR2VtIHBvbGlzaCIsCiAgICAgICI8cT5HZXQgcmlkIG9mIHRoZSBncmltZSBhbmQgbGV0IG1vcmUgbGlnaHQgaW4uPGJyPlRydWx5LCB0cnVseSBvdXRyYWdlb3VzLjwvcT4iLAogICAgICAiUHJpc20iLAogICAgICAxCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiOXRoIGNvbG9yIiwKICAgICAgIjxxPkRlbHZlIGludG8gdW50b3VjaGVkIG9wdGljYWwgZGVwdGhzIHdoZXJlIGV2ZW4gdGhlIG1hbnRpcyBzaHJpbXAgaGFzbid0IHNldCBhbiBleWUhPC9xPiIsCiAgICAgICJQcmlzbSIsCiAgICAgIDIKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJDaG9jb2xhdGUgbGlnaHQiLAogICAgICAiPHE+QmFzayBpbnRvIGl0cyBjb2NvYWxlc2NlbmNlLjxicj4oV2FybmluZyA6IG1heSBjYXVzZSB2YXJpb3VzIGludGVyZXN0aW5nIGFsYmVpdCBkZWFkbHkgc2tpbiBjb25kaXRpb25zLik8L3E+IiwKICAgICAgIlByaXNtIiwKICAgICAgMwogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkdyYWluYm93IiwKICAgICAgIjxxPlJlbWVtYmVyIHRoZSBkaWZmZXJlbnQgZ3JhaW5zIHVzaW5nIHRoZSBoYW5keSBSb3kgRy4gQml2IG1uZW1vbmljIDogUiBpcyBmb3IgcmljZSwgTyBpcyBmb3Igb2F0cy4uLiB1aCwgQiBmb3IgYmFybGV5Py4uLjwvcT4iLAogICAgICAiUHJpc20iLAogICAgICA0CiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiUHVyZSBjb3NtaWMgbGlnaHQiLAogICAgICAiPHE+WW91ciBwcmlzbXMgbm93IHJlY2VpdmUgcHJpc3RpbmUsIHVuYWR1bHRlcmF0ZWQgcGhvdG9ucyBmcm9tIHRoZSBvdGhlciBlbmQgb2YgdGhlIHVuaXZlcnNlLjwvcT4iLAogICAgICAiUHJpc20iLAogICAgICA1CiAgICApOwoKICAgIG9yZGVyID0gMjU1OwogICAgR2FtZS5HcmFuZG1hU3luZXJneSgKICAgICAgIlJhaW5ib3cgZ3JhbmRtYXMiLAogICAgICAiQSBsdW1pbm91cyBncmFuZG1hIHRvIHNwYXJrbGUgaW50byBjb29raWVzLiIsCiAgICAgICJQcmlzbSIKICAgICk7CgogICAgb3JkZXIgPSAyNDAwMDsKICAgIEdhbWUuc2Vhc29uVHJpZ2dlckJhc2VQcmljZSA9IDEwMDAwMDAwMDA7IC8vMTExMTExMTExMTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTZWFzb24gc3dpdGNoZXIiLAogICAgICBsb2MoCiAgICAgICAgIkFsbG93cyB5b3UgdG8gPGI+dHJpZ2dlciBzZWFzb25hbCBldmVudHM8L2I+IGF0IHdpbGwsIGZvciBhIHByaWNlLiIKICAgICAgKSArICI8cT5UaGVyZSB3aWxsIGFsd2F5cyBiZSB0aW1lLjwvcT4iLAogICAgICAxMTExLAogICAgICBbMTYsIDZdLAogICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLnNlYXNvbnMpIHsKICAgICAgICAgIEdhbWUuVW5sb2NrKEdhbWUuc2Vhc29uc1tpXS50cmlnZ2VyKTsKICAgICAgICB9CiAgICAgIH0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiSGVyYWxkcyJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkZlc3RpdmUgYmlzY3VpdCIsCiAgICAgIGxvYygKICAgICAgICAiVHJpZ2dlcnMgPGI+JTEgc2Vhc29uPC9iPiBmb3IgdGhlIG5leHQgMjQgaG91cnMuPGJyPlRyaWdnZXJpbmcgYW5vdGhlciBzZWFzb24gd2lsbCBjYW5jZWwgdGhpcyBvbmUuPGJyPkNvc3Qgc2NhbGVzIHdpdGggdW5idWZmZWQgQ3BTIGFuZCBpbmNyZWFzZXMgd2l0aCBldmVyeSBzZWFzb24gc3dpdGNoLiIsCiAgICAgICAgbG9jKCJDaHJpc3RtYXMiKQogICAgICApICsgIjxxPidUd2FzIHRoZSBuaWdodCBiZWZvcmUgQ2hyaXN0bWFzLSBvciB3YXMgaXQ/PC9xPiIsCiAgICAgIEdhbWUuc2Vhc29uVHJpZ2dlckJhc2VQcmljZSwKICAgICAgWzEyLCAxMF0KICAgICk7CiAgICBHYW1lLmxhc3Quc2Vhc29uID0gImNocmlzdG1hcyI7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJ0b2dnbGUiOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkdob3N0bHkgYmlzY3VpdCIsCiAgICAgIGxvYygKICAgICAgICAiVHJpZ2dlcnMgPGI+JTEgc2Vhc29uPC9iPiBmb3IgdGhlIG5leHQgMjQgaG91cnMuPGJyPlRyaWdnZXJpbmcgYW5vdGhlciBzZWFzb24gd2lsbCBjYW5jZWwgdGhpcyBvbmUuPGJyPkNvc3Qgc2NhbGVzIHdpdGggdW5idWZmZWQgQ3BTIGFuZCBpbmNyZWFzZXMgd2l0aCBldmVyeSBzZWFzb24gc3dpdGNoLiIsCiAgICAgICAgbG9jKCJIYWxsb3dlZW4iKQogICAgICApICsgIjxxPnNwb29reSBzY2FyeSBza2VsZXRvbnM8YnI+d2lsbCB3YWtlIHlvdSB3aXRoIGEgYm9vPC9xPiIsCiAgICAgIEdhbWUuc2Vhc29uVHJpZ2dlckJhc2VQcmljZSwKICAgICAgWzEzLCA4XQogICAgKTsKICAgIEdhbWUubGFzdC5zZWFzb24gPSAiaGFsbG93ZWVuIjsKICAgIEdhbWUubGFzdC5wb29sID0gInRvZ2dsZSI7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiTG92ZXNpY2sgYmlzY3VpdCIsCiAgICAgIGxvYygKICAgICAgICAiVHJpZ2dlcnMgPGI+JTEgc2Vhc29uPC9iPiBmb3IgdGhlIG5leHQgMjQgaG91cnMuPGJyPlRyaWdnZXJpbmcgYW5vdGhlciBzZWFzb24gd2lsbCBjYW5jZWwgdGhpcyBvbmUuPGJyPkNvc3Qgc2NhbGVzIHdpdGggdW5idWZmZWQgQ3BTIGFuZCBpbmNyZWFzZXMgd2l0aCBldmVyeSBzZWFzb24gc3dpdGNoLiIsCiAgICAgICAgbG9jKCJWYWxlbnRpbmUncyBkYXkiKQogICAgICApICsgIjxxPlJvbWFuY2UgbmV2ZXIgZ29lcyBvdXQgb2YgZmFzaGlvbi48L3E+IiwKICAgICAgR2FtZS5zZWFzb25UcmlnZ2VyQmFzZVByaWNlLAogICAgICBbMjAsIDNdCiAgICApOwogICAgR2FtZS5sYXN0LnNlYXNvbiA9ICJ2YWxlbnRpbmVzIjsKICAgIEdhbWUubGFzdC5wb29sID0gInRvZ2dsZSI7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRm9vbCdzIGJpc2N1aXQiLAogICAgICBsb2MoCiAgICAgICAgIlRyaWdnZXJzIDxiPiUxIHNlYXNvbjwvYj4gZm9yIHRoZSBuZXh0IDI0IGhvdXJzLjxicj5UcmlnZ2VyaW5nIGFub3RoZXIgc2Vhc29uIHdpbGwgY2FuY2VsIHRoaXMgb25lLjxicj5Db3N0IHNjYWxlcyB3aXRoIHVuYnVmZmVkIENwUyBhbmQgaW5jcmVhc2VzIHdpdGggZXZlcnkgc2Vhc29uIHN3aXRjaC4iLAogICAgICAgIGxvYygiQnVzaW5lc3MgZGF5IikKICAgICAgKSArCiAgICAgICAgIjxxPkJ1c2luZXNzLiBTZXJpb3VzIGJ1c2luZXNzLiBUaGlzIGlzIGFic29sdXRlbHkgYWxsIG9mIHlvdXIgYnVzaW5lc3MuPC9xPiIsCiAgICAgIEdhbWUuc2Vhc29uVHJpZ2dlckJhc2VQcmljZSwKICAgICAgWzE3LCA2XQogICAgKTsKICAgIEdhbWUubGFzdC5zZWFzb24gPSAiZm9vbHMiOwogICAgR2FtZS5sYXN0LnBvb2wgPSAidG9nZ2xlIjsKCiAgICBvcmRlciA9IDQwMDAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkV0ZXJuYWwgc2Vhc29ucyIsCiAgICAgIGxvYygiU2Vhc29ucyBub3cgbGFzdCBmb3JldmVyLiIpICsgIjxxPlNlYXNvbiB0byB0YXN0ZS48L3E+IiwKICAgICAgNywKICAgICAgWzE2LCA2XSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5zZWFzb25zKSB7CiAgICAgICAgICBHYW1lLlVubG9jayhHYW1lLnNlYXNvbnNbaV0udHJpZ2dlcik7CiAgICAgICAgfQogICAgICB9CiAgICApOyAvL2RlYnVnIHB1cnBvc2VzIG9ubHkKICAgIEdhbWUubGFzdC5wb29sID0gImRlYnVnIjsKCiAgICBvcmRlciA9IDIwMDAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIktpdHRlbiBtYW5hZ2VycyIsCiAgICAgIHN0cktpdHRlbkRlc2MgKyAiPHE+dGhhdCdzIG5vdCBnb25uYSBwYXdzIGFueSBwcm9ibGVtLCBzaXI8L3E+IiwKICAgICAgOTAwMDAwMDAwMDAwMDAwMDAwMDAwLAogICAgICBHYW1lLkdldEljb24oIktpdHRlbiIsIDUpCiAgICApOwogICAgR2FtZS5sYXN0LmtpdHRlbiA9IDE7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCA1LCAxOCk7CgogICAgb3JkZXIgPSAxMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiU2VwdGlsbGlvbiBmaW5nZXJzIiwKICAgICAgZ2V0U3RyVGhvdXNhbmRGaW5nZXJzR2FpbigyMCkgKyAiPHE+W2N1cnNvcnkgZmxhdm9yIHRleHRdPC9xPiIsCiAgICAgIDEwMDAwMDAwMDAwMDAwMDAwMDAwLAogICAgICBbMTIsIDIwXQogICAgKTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDExLCAwKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJPY3RpbGxpb24gZmluZ2VycyIsCiAgICAgIGdldFN0clRob3VzYW5kRmluZ2Vyc0dhaW4oMjApICsKICAgICAgICAiPHE+VHVybnMgb3V0IHlvdSA8Yj5jYW48L2I+IHF1aXRlIHB1dCB5b3VyIGZpbmdlciBvbiBpdC48L3E+IiwKICAgICAgMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIFsxMiwgMTldCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgMTIsIDApOwoKICAgIG9yZGVyID0gMTUwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkVsdWRpdW0gbW91c2UiLAogICAgICBnZXRTdHJDbGlja2luZ0dhaW5zKDEpICsgIjxxPkkgcm9kZW50IGRvIHRoYXQgaWYgSSB3ZXJlIHlvdS48L3E+IiwKICAgICAgNTAwMDAwMDAwMDAwMDAwLAogICAgICBbMTEsIDE1XQogICAgKTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDYsIDExKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJXaXNoYWxsb3kgbW91c2UiLAogICAgICBnZXRTdHJDbGlja2luZ0dhaW5zKDEpICsKICAgICAgICAiPHE+Q2xpY2tpbmcgaXMgZmluZSBhbmQgZGFuZHksIGJ1dCBkb24ndCBzbWFzaCB5b3VyIG1vdXNlIG92ZXIgaXQuIEdldCB5b3VyIGdhbWUgb24uIEdvIHBsYXkuPC9xPiIsCiAgICAgIDUwMDAwMDAwMDAwMDAwMDAwLAogICAgICBbMTEsIDE2XQogICAgKTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDcsIDExKTsKICAgIG9yZGVyID0gMjAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQWdpbmcgYWdlbnRzIiwKICAgICAgIjxxPkNvdW50ZXItaW50dWl0aXZlbHksIGdyYW5kbWFzIGhhdmUgdGhlIHVuY2FubnkgYWJpbGl0eSB0byBiZWNvbWUgbW9yZSBwb3dlcmZ1bCB0aGUgb2xkZXIgdGhleSBnZXQuPC9xPiIsCiAgICAgICJHcmFuZG1hIiwKICAgICAgNgogICAgKTsKICAgIG9yZGVyID0gMzAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiUHVsc2FyIHNwcmlua2xlcnMiLAogICAgICAiPHE+VGhlcmUncyBubyBzdWNoIHRoaW5nIGFzIG92ZXItd2F0ZXJpbmcuIFRoZSBtb2lzdGVzdCBpcyB0aGUgYmVzdGVzdC48L3E+IiwKICAgICAgIkZhcm0iLAogICAgICA2CiAgICApOwogICAgb3JkZXIgPSA1MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJEZWVwLWJha2UgcHJvY2VzcyIsCiAgICAgICI8cT5BIHBhdGVudGVkIHByb2Nlc3MgaW5jcmVhc2luZyBjb29raWUgeWllbGQgdHdvLWZvbGQgZm9yIHRoZSBzYW1lIGFtb3VudCBvZiBpbmdyZWRpZW50cy4gRG9uJ3QgYXNrIGhvdywgZG9uJ3QgdGFrZSBwaWN0dXJlcywgYW5kIGJlIHN1cmUgdG8gd2VhciB5b3VyIHByb3RlY3RpdmUgc3VpdC48L3E+IiwKICAgICAgIkZhY3RvcnkiLAogICAgICA2CiAgICApOwogICAgb3JkZXIgPSA0MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJDb3JlZm9yZ2UiLAogICAgICAiPHE+WW91J3ZlIGZpbmFsbHkgZHVnIGEgdHVubmVsIGRvd24gdG8gdGhlIEVhcnRoJ3MgY29yZS4gSXQncyBwcmV0dHkgd2FybSBkb3duIGhlcmUuPC9xPiIsCiAgICAgICJNaW5lIiwKICAgICAgNgogICAgKTsKICAgIG9yZGVyID0gNjAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiR2VuZXJhdGlvbiBzaGlwIiwKICAgICAgIjxxPkJ1aWx0IHRvIGxhc3QsIHRoaXMgaHVtb25nb3VzIHNwYWNlY3JhZnQgd2lsbCBzdXJlbHkgZGVsaXZlciB5b3VyIGNvb2tpZXMgdG8gdGhlIGRlZXAgZW5kcyBvZiBzcGFjZSwgb25lIGRheS48L3E+IiwKICAgICAgIlNoaXBtZW50IiwKICAgICAgNgogICAgKTsKICAgIG9yZGVyID0gNzAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiT3JpZ2luIGNydWNpYmxlIiwKICAgICAgIjxxPkJ1aWx0IGZyb20gdGhlIHJhcmVzdCBvZiBlYXJ0aHMgYW5kIGxvY2F0ZWQgYXQgdGhlIHZlcnkgZGVlcGVzdCBvZiB0aGUgbGFyZ2VzdCBtb3VudGFpbiwgdGhpcyBsZWdlbmRhcnkgY3J1Y2libGUgaXMgc2FpZCB0byByZXRhaW4gcHJvcGVydGllcyBmcm9tIHRoZSBiaWctYmFuZyBpdHNlbGYuPC9xPiIsCiAgICAgICJBbGNoZW15IGxhYiIsCiAgICAgIDYKICAgICk7CiAgICBvcmRlciA9IDgwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkRlaXR5LXNpemVkIHBvcnRhbHMiLAogICAgICAiPHE+SXQncyBhbG1vc3QgbGlrZSwgc2F5LCBhbiBlbGRlciBnb2QgY291bGQgZml0IHRocm91Z2ggdGhpcyB0aGluZyBub3cuIEh5cG90aGV0aWNhbGx5LjwvcT4iLAogICAgICAiUG9ydGFsIiwKICAgICAgNgogICAgKTsKICAgIG9yZGVyID0gOTAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRmFyIGZ1dHVyZSBlbmFjdG1lbnQiLAogICAgICAiPHE+VGhlIGZhciBmdXR1cmUgZW5hY3RtZW50IGF1dGhvcml6ZXMgeW91IHRvIGRlbHZlIGRlZXAgaW50byB0aGUgZnV0dXJlIC0gd2hlcmUgY2l2aWxpemF0aW9uIGhhcyBmYWxsZW4gYW5kIHJpc2VuIGFnYWluLCBhbmQgY29va2llcyBhcmUgcGxlbnRpZnVsLjwvcT4iLAogICAgICAiVGltZSBtYWNoaW5lIiwKICAgICAgNgogICAgKTsKICAgIG9yZGVyID0gMTAwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIk5hbm9jb3NtaWNzIiwKICAgICAgIjxxPlRoZSB0aGVvcnkgb2YgbmFub2Nvc21pY3MgcG9zaXRzIHRoYXQgZWFjaCBzdWJhdG9taWMgcGFydGljbGUgaXMgaW4gZmFjdCBpdHMgb3duIHNlbGYtY29udGFpbmVkIHVuaXZlcnNlLCBob2xkaW5nIHVuZmF0aG9tYWJsZSBhbW91bnRzIG9mIGVuZXJneS48YnI+VGhpcyBzb21laG93IHN0YWNrcyB3aXRoIHRoZSBuZXN0ZWQgdW5pdmVyc2UgdGhlb3J5LCBiZWNhdXNlIHBoeXNpY3MuPC9xPiIsCiAgICAgICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsCiAgICAgIDYKICAgICk7CiAgICBvcmRlciA9IDExMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJHbG93LWluLXRoZS1kYXJrIiwKICAgICAgIjxxPllvdXIgcHJpc21zIG5vdyBnbG93IGluIHRoZSBkYXJrLCBlZmZlY3RpdmVseSBkb3VibGluZyB0aGVpciBvdXRwdXQhPC9xPiIsCiAgICAgICJQcmlzbSIsCiAgICAgIDYKICAgICk7CgogICAgb3JkZXIgPSAxMDAzMjsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJSb3NlIG1hY2Fyb25zIiwKICAgICAgZGVzYzogIkFsdGhvdWdoIGFuIG9kZCBmbGF2b3IsIHRoZXNlIHBhc3RyaWVzIHJlY2VudGx5IHJvc2UgaW4gcG9wdWxhcml0eS4iLAogICAgICBpY29uOiBbMjIsIDNdLAogICAgICByZXF1aXJlOiAiQm94IG9mIG1hY2Fyb25zIiwKICAgICAgcG93ZXI6IDMsCiAgICAgIHByaWNlOiA5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiTGVtb24gbWFjYXJvbnMiLAogICAgICBkZXNjOiAiVGFzdGVmdWxseSBzb3VyLCBkZWxpZ2h0ZnVsIHRyZWF0cy4iLAogICAgICBpY29uOiBbMjMsIDNdLAogICAgICByZXF1aXJlOiAiQm94IG9mIG1hY2Fyb25zIiwKICAgICAgcG93ZXI6IDMsCiAgICAgIHByaWNlOiA5OTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQ2hvY29sYXRlIG1hY2Fyb25zIiwKICAgICAgZGVzYzogIlRoZXkncmUgbGlrZSB0aW55IHN1Z2FyeSBidXJnZXJzISIsCiAgICAgIGljb246IFsyNCwgM10sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgbWFjYXJvbnMiLAogICAgICBwb3dlcjogMywKICAgICAgcHJpY2U6IDk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJQaXN0YWNoaW8gbWFjYXJvbnMiLAogICAgICBkZXNjOiAiUGlzdGFjaGlvIHNoZWxscyBub3cgcmVtb3ZlZCBhZnRlciBtdWx0aXBsZSBjb21wbGFpbnRzLiIsCiAgICAgIGljb246IFsyMiwgNF0sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgbWFjYXJvbnMiLAogICAgICBwb3dlcjogMywKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJIYXplbG51dCBtYWNhcm9ucyIsCiAgICAgIGRlc2M6ICJUaGVzZSBnbyBlc3BlY2lhbGx5IHdlbGwgd2l0aCBjb2ZmZWUuIiwKICAgICAgaWNvbjogWzIzLCA0XSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBtYWNhcm9ucyIsCiAgICAgIHBvd2VyOiAzLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlZpb2xldCBtYWNhcm9ucyIsCiAgICAgIGRlc2M6ICJJdCdzIGxpa2Ugc3ByYXlpbmcgcGVyZnVtZSBpbnRvIHlvdXIgbW91dGghIiwKICAgICAgaWNvbjogWzI0LCA0XSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBtYWNhcm9ucyIsCiAgICAgIHBvd2VyOiAzLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwoKICAgIG9yZGVyID0gNDAwMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiTWFnaWMgc2hlbmFuaWdhbnMiLAogICAgICBsb2MoIkNvb2tpZSBwcm9kdWN0aW9uIDxiPm11bHRpcGxpZWQgYnkgMSwwMDA8L2I+LiIpICsKICAgICAgICAiPHE+SXQncyBtYWdpYy4gSSBhaW4ndCBnb3R0YSBleHBsYWluIHNoPGRpdiBzdHlsZT1cImRpc3BsYXk6aW5saW5lLWJsb2NrO2JhY2tncm91bmQ6dXJsKGltZy9tb25leS5wbmcpO3dpZHRoOjE2cHg7aGVpZ2h0OjE2cHg7cG9zaXRpb246cmVsYXRpdmU7dG9wOjRweDtsZWZ0OjBweDttYXJnaW46MHB4IC0ycHg7XCI+PC9kaXY+dC48L3E+IiwKICAgICAgNywKICAgICAgWzE3LCA1XQogICAgKTsgLy9kZWJ1ZyBwdXJwb3NlcyBvbmx5CiAgICBHYW1lLmxhc3QucG9vbCA9ICJkZWJ1ZyI7CgogICAgb3JkZXIgPSAyNDAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJCdW5ueSBiaXNjdWl0IiwKICAgICAgbG9jKAogICAgICAgICJUcmlnZ2VycyA8Yj4lMSBzZWFzb248L2I+IGZvciB0aGUgbmV4dCAyNCBob3Vycy48YnI+VHJpZ2dlcmluZyBhbm90aGVyIHNlYXNvbiB3aWxsIGNhbmNlbCB0aGlzIG9uZS48YnI+Q29zdCBzY2FsZXMgd2l0aCB1bmJ1ZmZlZCBDcFMgYW5kIGluY3JlYXNlcyB3aXRoIGV2ZXJ5IHNlYXNvbiBzd2l0Y2guIiwKICAgICAgICBsb2MoIkVhc3RlciIpCiAgICAgICkgKwogICAgICAgICI8cT5BbGwgdGhlIHdvcmxkIHdpbGwgYmUgeW91ciBlbmVteTxicj5hbmQgd2hlbiB0aGV5IGNhdGNoIHlvdSw8YnI+dGhleSB3aWxsIGtpbGwgeW91Li4uPGJyPmJ1dCBmaXJzdCB0aGV5IG11c3QgY2F0Y2ggeW91LjwvcT4iLAogICAgICBHYW1lLnNlYXNvblRyaWdnZXJCYXNlUHJpY2UsCiAgICAgIFswLCAxMl0KICAgICk7CiAgICBHYW1lLmxhc3Quc2Vhc29uID0gImVhc3RlciI7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJ0b2dnbGUiOwoKICAgIHZhciBlZ2dQcmljZSA9IDk5OTk5OTk5OTk5OTsKICAgIHZhciBlZ2dQcmljZTIgPSA5OTk5OTk5OTk5OTk5OTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJDaGlja2VuIGVnZyIsCiAgICAgIGdldFN0ckNvb2tpZVByb2R1Y3Rpb25NdWx0aXBsaWVyUGx1cygxKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoIkNvc3Qgc2NhbGVzIHdpdGggaG93IG1hbnkgZWdncyB5b3Ugb3duLiIpICsKICAgICAgICAiPHE+VGhlIGVnZy4gVGhlIGVnZyBjYW1lIGZpcnN0LiBHZXQgb3ZlciBpdC48L3E+IiwKICAgICAgZWdnUHJpY2UsCiAgICAgIFsxLCAxMl0KICAgICk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRHVjayBlZ2ciLAogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMSkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIGhvdyBtYW55IGVnZ3MgeW91IG93bi4iKSArCiAgICAgICAgIjxxPlRoZW4gaGUgd2FkZGxlZCBhd2F5LjwvcT4iLAogICAgICBlZ2dQcmljZSwKICAgICAgWzIsIDEyXQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJUdXJrZXkgZWdnIiwKICAgICAgZ2V0U3RyQ29va2llUHJvZHVjdGlvbk11bHRpcGxpZXJQbHVzKDEpICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBob3cgbWFueSBlZ2dzIHlvdSBvd24uIikgKwogICAgICAgICI8cT5UaGVzZSBoYXRjaCBpbnRvIHN0cmFuZ2UsIGhhbmQtc2hhcGVkIGNyZWF0dXJlcy48L3E+IiwKICAgICAgZWdnUHJpY2UsCiAgICAgIFszLCAxMl0KICAgICk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiUXVhaWwgZWdnIiwKICAgICAgZ2V0U3RyQ29va2llUHJvZHVjdGlvbk11bHRpcGxpZXJQbHVzKDEpICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBob3cgbWFueSBlZ2dzIHlvdSBvd24uIikgKwogICAgICAgICI8cT5UaGVzZSBlZ2dzIGFyZSBwb3NpdGl2ZWx5IHRpbnkuIEkgbWVhbiBsb29rIGF0IHRoZW0uIEhvdyBkb2VzIHRoaXMgaGFwcGVuPyBXaG9zZSBpZGVhIHdhcyB0aGF0PzwvcT4iLAogICAgICBlZ2dQcmljZSwKICAgICAgWzQsIDEyXQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJSb2JpbiBlZ2ciLAogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMSkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIGhvdyBtYW55IGVnZ3MgeW91IG93bi4iKSArCiAgICAgICAgIjxxPkhvbHkgYXp1cmUtaHVlZCBzaGVsbGVkIGVtYnJ5b3MhPC9xPiIsCiAgICAgIGVnZ1ByaWNlLAogICAgICBbNSwgMTJdCiAgICApOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIk9zdHJpY2ggZWdnIiwKICAgICAgZ2V0U3RyQ29va2llUHJvZHVjdGlvbk11bHRpcGxpZXJQbHVzKDEpICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBob3cgbWFueSBlZ2dzIHlvdSBvd24uIikgKwogICAgICAgICI8cT5PbmUgb2YgdGhlIGxhcmdlc3QgZWdncyBpbiB0aGUgd29ybGQuIE1vcmUgbGlrZSBvc3Ryb3VjaCwgYW0gSSByaWdodD88YnI+R3V5cz88L3E+IiwKICAgICAgZWdnUHJpY2UsCiAgICAgIFs2LCAxMl0KICAgICk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQ2Fzc293YXJ5IGVnZyIsCiAgICAgIGdldFN0ckNvb2tpZVByb2R1Y3Rpb25NdWx0aXBsaWVyUGx1cygxKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoIkNvc3Qgc2NhbGVzIHdpdGggaG93IG1hbnkgZWdncyB5b3Ugb3duLiIpICsKICAgICAgICAiPHE+VGhlIGNhc3Nvd2FyeSBpcyB0YWxsZXIgdGhhbiB5b3UsIHBvc3Nlc3NlcyBtdXJkZXJvdXMgY2xhd3MgYW5kIGNhbiBlYXNpbHkgb3V0cnVuIHlvdS48YnI+WW91J2QgZG8gd2VsbCB0byBiZSBjYXNzby13YXJ5IG9mIHRoZW0uPC9xPiIsCiAgICAgIGVnZ1ByaWNlLAogICAgICBbNywgMTJdCiAgICApOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlNhbG1vbiByb2UiLAogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMSkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIGhvdyBtYW55IGVnZ3MgeW91IG93bi4iKSArCiAgICAgICAgIjxxPkRvIHRoZSBpbXBvc3NpYmxlLCBzZWUgdGhlIGludmlzaWJsZS48YnI+Um9lIHJvZSwgZmlnaHQgdGhlIHBvd2VyPzwvcT4iLAogICAgICBlZ2dQcmljZSwKICAgICAgWzgsIDEyXQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJGcm9nc3Bhd24iLAogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMSkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIGhvdyBtYW55IGVnZ3MgeW91IG93bi4iKSArCiAgICAgICAgJzxxPkkgd2FzIGdvaW5nIHRvIG1ha2UgYSBwdW4gYWJvdXQgaG93IHRoZXNlICJ0b2FkYWxseSBsb29rIGxpa2UgZXllYmFsbHMiLCBidXQgZnJvZ2V0IGl0LjwvcT4nLAogICAgICBlZ2dQcmljZSwKICAgICAgWzksIDEyXQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTaGFyayBlZ2ciLAogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMSkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIGhvdyBtYW55IGVnZ3MgeW91IG93bi4iKSArCiAgICAgICAgIjxxPkhFTExPIElTIFRISVMgRk9PRD88YnI+TEVUIE1FIFRFTEwgWU9VIEFCT1VUIEZPT0QuPGJyPldIWSBETyBJIEtFRVAgRUFUSU5HIE1ZIEZSSUVORFM8L3E+IiwKICAgICAgZWdnUHJpY2UsCiAgICAgIFsxMCwgMTJdCiAgICApOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlR1cnRsZSBlZ2ciLAogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMSkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIGhvdyBtYW55IGVnZ3MgeW91IG93bi4iKSArCiAgICAgICAgIjxxPlR1cnRsZXMsIHJpZ2h0PyBIYXRjaCBmcm9tIHNoZWxscy4gR3JvdyBpbnRvIHNoZWxscy4gV2hhdCdzIHVwIHdpdGggdGhhdD88YnI+Tm93IGZvciBteSBza2l0IGFib3V0IGFpcnBsYW5lIGZvb2QuPC9xPiIsCiAgICAgIGVnZ1ByaWNlLAogICAgICBbMTEsIDEyXQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJBbnQgbGFydmEiLAogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMSkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIGhvdyBtYW55IGVnZ3MgeW91IG93bi4iKSArCiAgICAgICAgIjxxPlRoZXNlIGFyZSBhIGRlbGljYWN5IGluIHNvbWUgY291bnRyaWVzLCBJIHN3ZWFyLiBZb3Ugd2lsbCBsZXQgdGhlc2UgaW52YWRlIHlvdXIgZGlnZXN0aXZlIHRyYWN0LCBhbmQgeW91IHdpbGwgZGVyaXZlIGdyZWF0IHBsZWFzdXJlIGZyb20gaXQuPGJyPkFuZCBhbGwgd2lsbCBiZSB3ZWxsLjwvcT4iLAogICAgICBlZ2dQcmljZSwKICAgICAgWzEyLCAxMl0KICAgICk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiR29sZGVuIGdvb3NlIGVnZyIsCiAgICAgIGxvYygiR29sZGVuIGNvb2tpZXMgYXBwZWFyIDxiPiUxJTwvYj4gbW9yZSBvZnRlbi4iLCA1KSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoIkNvc3Qgc2NhbGVzIHdpdGggaG93IG1hbnkgZWdncyB5b3Ugb3duLiIpICsKICAgICAgICAiPHE+VGhlIHNvbGUgdmVzdGlnZSBvZiBhIHRyYWdpYyB0YWxlIGludm9sdmluZyBtaXNndWlkZWQgaW52ZXN0bWVudHMuPC9xPiIsCiAgICAgIGVnZ1ByaWNlMiwKICAgICAgWzEzLCAxMl0KICAgICk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRmFiZXJnZSBlZ2ciLAogICAgICBsb2MoIkFsbCBidWlsZGluZ3MgYW5kIHVwZ3JhZGVzIGFyZSA8Yj4lMSUgY2hlYXBlcjwvYj4uIiwgMSkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIGhvdyBtYW55IGVnZ3MgeW91IG93bi4iKSArCiAgICAgICAgIjxxPlRoaXMgb3V0cmFnZW91cyBlZ2cgaXMgZGVmaW5pdGVseSBmYWIuPC9xPiIsCiAgICAgIGVnZ1ByaWNlMiwKICAgICAgWzE0LCAxMl0sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLnN0b3JlVG9SZWZyZXNoID0gMTsKICAgICAgfQogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJXcmlua2xlcnNwYXduIiwKICAgICAgbG9jKCJXcmlua2xlcnMgZXhwbG9kZSBpbnRvIDxiPiUxJSBtb3JlIGNvb2tpZXM8L2I+LiIsIDUpICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBob3cgbWFueSBlZ2dzIHlvdSBvd24uIikgKwogICAgICAgICI8cT5Mb29rIGF0IHRoaXMgbGl0dGxlIGd1eSEgSXQncyBnb25uYSBiZSBhIGJpZyBib3kgc29tZWRheSEgWWVzIGl0IGlzITwvcT4iLAogICAgICBlZ2dQcmljZTIsCiAgICAgIFsxNSwgMTJdCiAgICApOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkNvb2tpZSBlZ2ciLAogICAgICBsb2MoIkNsaWNraW5nIGlzIDxiPiUxJTwvYj4gbW9yZSBwb3dlcmZ1bC4iLCAxMCkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIGhvdyBtYW55IGVnZ3MgeW91IG93bi4iKSArCiAgICAgICAgIjxxPlRoZSBzaGVsbCBhcHBlYXJzIHRvIGJlIGNoaXBwZWQuPGJyPkkgd29uZGVyIHdoYXQncyBpbnNpZGUgdGhpcyBvbmUhPC9xPiIsCiAgICAgIGVnZ1ByaWNlMiwKICAgICAgWzE2LCAxMl0KICAgICk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiT21lbGV0dGUiLAogICAgICBsb2MoIk90aGVyIGVnZ3MgYXBwZWFyIDxiPiUxJSBtb3JlIGZyZXF1ZW50bHk8L2I+LiIsIDEwKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoIkNvc3Qgc2NhbGVzIHdpdGggaG93IG1hbnkgZWdncyB5b3Ugb3duLiIpICsKICAgICAgICAiPHE+RnJvbWFnZSBub3QgaW5jbHVkZWQuPC9xPiIsCiAgICAgIGVnZ1ByaWNlMiwKICAgICAgWzE3LCAxMl0KICAgICk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQ2hvY29sYXRlIGVnZyIsCiAgICAgIGxvYygiQ29udGFpbnMgPGI+YSBsb3Qgb2YgY29va2llczwvYj4uIikgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIGhvdyBtYW55IGVnZ3MgeW91IG93bi4iKSArCiAgICAgICAgIjxxPkxhaWQgYnkgdGhlIGVsdXNpdmUgY29jb2EgYmlyZC4gVGhlcmUncyBhIHN1cnByaXNlIGluc2lkZSE8L3E+IiwKICAgICAgZWdnUHJpY2UyLAogICAgICBbMTgsIDEyXSwKICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBjb29raWVzID0gR2FtZS5jb29raWVzICogMC4wNTsKICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICJDaG9jb2xhdGUgZWdnIiwKICAgICAgICAgIGxvYygiVGhlIGVnZyBidXJzdHMgaW50byA8Yj4lMTwvYj4gY29va2llcyEiLCBCZWF1dGlmeShjb29raWVzKSksCiAgICAgICAgICBHYW1lLlVwZ3JhZGVzWyJDaG9jb2xhdGUgZWdnIl0uaWNvbgogICAgICAgICk7CiAgICAgICAgR2FtZS5FYXJuKGNvb2tpZXMpOwogICAgICB9CiAgICApOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkNlbnR1cnkgZWdnIiwKICAgICAgbG9jKAogICAgICAgICJZb3UgY29udGludWFsbHkgZ2FpbiA8Yj5tb3JlIENwUyB0aGUgbG9uZ2VyIHlvdSd2ZSBwbGF5ZWQ8L2I+IGluIHRoZSBjdXJyZW50IGFzY2Vuc2lvbi4iCiAgICAgICkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJDb3N0IHNjYWxlcyB3aXRoIGhvdyBtYW55IGVnZ3MgeW91IG93bi4iKSArCiAgICAgICAgIjxxPkFjdHVhbGx5IG5vdCBjZW50dXJpZXMtb2xkLiBUaGlzIG9uZSBpc24ndCBhIGRheSBvdmVyIDg2ITwvcT4iLAogICAgICBlZ2dQcmljZTIsCiAgICAgIFsxOSwgMTJdCiAgICApOwogICAgR2FtZS5sYXN0LmRlc2NGdW5jID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgZGF5ID0KICAgICAgICAoTWF0aC5mbG9vcigoRGF0ZS5ub3coKSAtIEdhbWUuc3RhcnREYXRlKSAvIDEwMDAgLyAxMCkgKiAxMCkgLwogICAgICAgIDYwIC8KICAgICAgICA2MCAvCiAgICAgICAgMjQ7CiAgICAgIGRheSA9IE1hdGgubWluKGRheSwgMTAwKTsKICAgICAgdmFyIG4gPSAoMSAtIE1hdGgucG93KDEgLSBkYXkgLyAxMDAsIDMpKSAqIDAuMTsKICAgICAgcmV0dXJuICgKICAgICAgICAnPGRpdiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7Ij4nICsKICAgICAgICBsb2MoIkN1cnJlbnQgYm9vc3Q6IikgKwogICAgICAgICIgPGI+KyIgKwogICAgICAgIEJlYXV0aWZ5KG4gKiAxMDAsIDEpICsKICAgICAgICAnJTwvYj48L2Rpdj48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICB0aGlzLmRkZXNjCiAgICAgICk7CiAgICB9OwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgJyJlZ2ciJywKICAgICAgIjxiPiIgKyBsb2MoIislMSBDcFMiLCA5KSArICc8L2I+PHE+aGV5IGl0XCdzICJlZ2ciPC9xPicsCiAgICAgIGVnZ1ByaWNlMiwKICAgICAgWzIwLCAxMl0KICAgICk7CgogICAgR2FtZS5lYXN0ZXJFZ2dzID0gWwogICAgICAiQ2hpY2tlbiBlZ2ciLAogICAgICAiRHVjayBlZ2ciLAogICAgICAiVHVya2V5IGVnZyIsCiAgICAgICJRdWFpbCBlZ2ciLAogICAgICAiUm9iaW4gZWdnIiwKICAgICAgIk9zdHJpY2ggZWdnIiwKICAgICAgIkNhc3Nvd2FyeSBlZ2ciLAogICAgICAiU2FsbW9uIHJvZSIsCiAgICAgICJGcm9nc3Bhd24iLAogICAgICAiU2hhcmsgZWdnIiwKICAgICAgIlR1cnRsZSBlZ2ciLAogICAgICAiQW50IGxhcnZhIiwKICAgICAgIkdvbGRlbiBnb29zZSBlZ2ciLAogICAgICAiRmFiZXJnZSBlZ2ciLAogICAgICAiV3JpbmtsZXJzcGF3biIsCiAgICAgICJDb29raWUgZWdnIiwKICAgICAgIk9tZWxldHRlIiwKICAgICAgIkNob2NvbGF0ZSBlZ2ciLAogICAgICAiQ2VudHVyeSBlZ2ciLAogICAgICAnImVnZyInLAogICAgXTsKICAgIEdhbWUuZWdnRHJvcHMgPSBbCiAgICAgICJDaGlja2VuIGVnZyIsCiAgICAgICJEdWNrIGVnZyIsCiAgICAgICJUdXJrZXkgZWdnIiwKICAgICAgIlF1YWlsIGVnZyIsCiAgICAgICJSb2JpbiBlZ2ciLAogICAgICAiT3N0cmljaCBlZ2ciLAogICAgICAiQ2Fzc293YXJ5IGVnZyIsCiAgICAgICJTYWxtb24gcm9lIiwKICAgICAgIkZyb2dzcGF3biIsCiAgICAgICJTaGFyayBlZ2ciLAogICAgICAiVHVydGxlIGVnZyIsCiAgICAgICJBbnQgbGFydmEiLAogICAgXTsKICAgIEdhbWUucmFyZUVnZ0Ryb3BzID0gWwogICAgICAiR29sZGVuIGdvb3NlIGVnZyIsCiAgICAgICJGYWJlcmdlIGVnZyIsCiAgICAgICJXcmlua2xlcnNwYXduIiwKICAgICAgIkNvb2tpZSBlZ2ciLAogICAgICAiT21lbGV0dGUiLAogICAgICAiQ2hvY29sYXRlIGVnZyIsCiAgICAgICJDZW50dXJ5IGVnZyIsCiAgICAgICciZWdnIicsCiAgICBdOwoKICAgIEdhbWUuR2V0SG93TWFueUVnZ3MgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBudW0gPSAwOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUuZWFzdGVyRWdncykgewogICAgICAgIGlmIChHYW1lLkhhcyhHYW1lLmVhc3RlckVnZ3NbaV0pKSBudW0rKzsKICAgICAgfQogICAgICByZXR1cm4gbnVtOwogICAgfTsKICAgIGZvciAodmFyIGkgaW4gR2FtZS5lZ2dEcm9wcykgeyAvL3NjYWxlIGVnZyBwcmljZXMgdG8gaG93IG1hbnkgZWdncyB5b3UgaGF2ZQogICAgICBHYW1lLlVwZ3JhZGVzW0dhbWUuZWdnRHJvcHNbaV1dLnByaWNlRnVuYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gTWF0aC5wb3coMiwgR2FtZS5HZXRIb3dNYW55RWdncygpKSAqIDk5OTsKICAgICAgfTsKICAgIH0KCiAgICBmb3IgKHZhciBpIGluIEdhbWUucmFyZUVnZ0Ryb3BzKSB7CiAgICAgIEdhbWUuVXBncmFkZXNbR2FtZS5yYXJlRWdnRHJvcHNbaV1dLnByaWNlRnVuYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gTWF0aC5wb3coMywgR2FtZS5HZXRIb3dNYW55RWdncygpKSAqIDk5OTsKICAgICAgfTsKICAgIH0KCiAgICBHYW1lLkRyb3BFZ2cgPSBmdW5jdGlvbiAoZmFpbFJhdGUpIHsKICAgICAgZmFpbFJhdGUgKj0gMSAvIEdhbWUuZHJvcFJhdGVNdWx0KCk7CiAgICAgIGlmIChHYW1lLnNlYXNvbiAhPSAiZWFzdGVyIikgcmV0dXJuOwogICAgICBpZiAoR2FtZS5IYXNBY2hpZXYoIkhpZGUgJiBzZWVrIGNoYW1waW9uIikpIGZhaWxSYXRlICo9IDAuNzsKICAgICAgaWYgKEdhbWUuSGFzKCJPbWVsZXR0ZSIpKSBmYWlsUmF0ZSAqPSAwLjk7CiAgICAgIGlmIChHYW1lLkhhcygiU3RhcnNwYXduIikpIGZhaWxSYXRlICo9IDAuOTsKICAgICAgaWYgKEdhbWUuaGFzR29kKSB7CiAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJzZWFzb25zIik7CiAgICAgICAgaWYgKGdvZEx2bCA9PSAxKSBmYWlsUmF0ZSAqPSAwLjk7CiAgICAgICAgZWxzZSBpZiAoZ29kTHZsID09IDIpIGZhaWxSYXRlICo9IDAuOTU7CiAgICAgICAgZWxzZSBpZiAoZ29kTHZsID09IDMpIGZhaWxSYXRlICo9IDAuOTc7CiAgICAgIH0KICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPj0gZmFpbFJhdGUpIHsKICAgICAgICB2YXIgZHJvcCA9ICIiOwogICAgICAgIGlmIChNYXRoLnJhbmRvbSgpIDwgMC4xKSBkcm9wID0gY2hvb3NlKEdhbWUucmFyZUVnZ0Ryb3BzKTsKICAgICAgICBlbHNlIGRyb3AgPSBjaG9vc2UoR2FtZS5lZ2dEcm9wcyk7CiAgICAgICAgaWYgKEdhbWUuSGFzKGRyb3ApIHx8IEdhbWUuSGFzVW5sb2NrZWQoZHJvcCkpIHsKICAgICAgICAgIC8vcmVyb2xsIGlmIHdlIGhhdmUgaXQKICAgICAgICAgIGlmIChNYXRoLnJhbmRvbSgpIDwgMC4xKSBkcm9wID0gY2hvb3NlKEdhbWUucmFyZUVnZ0Ryb3BzKTsKICAgICAgICAgIGVsc2UgZHJvcCA9IGNob29zZShHYW1lLmVnZ0Ryb3BzKTsKICAgICAgICB9CiAgICAgICAgaWYgKEdhbWUuSGFzKGRyb3ApIHx8IEdhbWUuSGFzVW5sb2NrZWQoZHJvcCkpIHJldHVybjsKICAgICAgICBHYW1lLlVubG9jayhkcm9wKTsKICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgIGxvYygiWW91IGZvdW5kIGFuIGVnZyEiKSwKICAgICAgICAgICI8Yj4iICsgZHJvcCArICI8L2I+IiwKICAgICAgICAgIEdhbWUuVXBncmFkZXNbZHJvcF0uaWNvbgogICAgICAgICk7CiAgICAgIH0KICAgIH07CgogICAgb3JkZXIgPSAxMDAzMjsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJDYXJhbWVsIG1hY2Fyb25zIiwKICAgICAgZGVzYzogIlRoZSBzYWx0aWVzdCwgY2hld2llc3Qgb2YgdGhlbSBhbGwuIiwKICAgICAgaWNvbjogWzI1LCAzXSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBtYWNhcm9ucyIsCiAgICAgIHBvd2VyOiAzLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkxpY29yaWNlIG1hY2Fyb25zIiwKICAgICAgZGVzYzogJ0Fsc28ga25vd24gYXMgImJsYWNrYXJvbnMiLicsCiAgICAgIGljb246IFsyNSwgNF0sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgbWFjYXJvbnMiLAogICAgICBwb3dlcjogMywKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKCiAgICBvcmRlciA9IDUyNTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRhbGxlciB0ZWxsZXJzIiwKICAgICAgIjxxPkFibGUgdG8gcHJvY2VzcyBhIGhpZ2hlciBhbW91bnQgb2YgdHJhbnNhY3Rpb25zLiBDYXJlZnVsIHRob3VnaCwgYXMgdGFsbGVyIHRlbGxlcnMgdGVsbCB0YWxsIHRhbGVzLjwvcT4iLAogICAgICAiQmFuayIsCiAgICAgIDEKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJTY2lzc29yLXJlc2lzdGFudCBjcmVkaXQgY2FyZHMiLAogICAgICAiPHE+Rm9yIHRob3NlIHRydWx5IHZhbHVlZCBjdXN0b21lcnMuPC9xPiIsCiAgICAgICJCYW5rIiwKICAgICAgMgogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkFjaWQtcHJvb2YgdmF1bHRzIiwKICAgICAgIjxxPllvdSBrbm93IHdoYXQgdGhleSBzYXkgOiBiZXR0ZXIgc2FmZSB0aGFuIHNvcnJ5LjwvcT4iLAogICAgICAiQmFuayIsCiAgICAgIDMKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJDaG9jb2xhdGUgY29pbnMiLAogICAgICAiPHE+VGhpcyByZXZvbHV0aW9uYXJ5IGN1cnJlbmN5IGlzIG11Y2ggZWFzaWVyIHRvIG1lbHQgZnJvbSBhbmQgaW50byBpbmdvdHMgLSBhbmQgdGFzdGVzIG11Y2ggYmV0dGVyLCBmb3IgYSBjaGFuZ2UuPC9xPiIsCiAgICAgICJCYW5rIiwKICAgICAgNAogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkV4cG9uZW50aWFsIGludGVyZXN0IHJhdGVzIiwKICAgICAgIjxxPkNhbid0IGFyZ3VlIHdpdGggbWF0aGVtYXRpY3MhIE5vdyBmb3JrIGl0IG92ZXIuPC9xPiIsCiAgICAgICJCYW5rIiwKICAgICAgNQogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkZpbmFuY2lhbCB6ZW4iLAogICAgICAiPHE+VGhlIHVsdGltYXRlIGdyYWlsIG9mIGVjb25vbWljIHRob3VnaHQ7IHRoZSBmZW5nIHNodWkgb2YgYmlnIG1vbmV5LCB0aGUgc3RvY2sgbWFya2V0IHlvZ2EgLSB0aGUgSGVpbWxpY2ggbWFuZXV2ZXIgb2YgZGltZXMgYW5kIG5pY2tlbHMuPC9xPiIsCiAgICAgICJCYW5rIiwKICAgICAgNgogICAgKTsKCiAgICBvcmRlciA9IDU1MDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkdvbGRlbiBpZG9scyIsCiAgICAgICI8cT5MdXJlIGV2ZW4gZ3JlZWRpZXIgYWR2ZW50dXJlcnMgdG8gcmV0cmlldmUgeW91ciBjb29raWVzLiBOb3cgdGhhdCdzIGEgcmVhbCBpZG9sIGdhbWUhPC9xPiIsCiAgICAgICJUZW1wbGUiLAogICAgICAxCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiU2FjcmlmaWNlcyIsCiAgICAgICI8cT5XaGF0J3MgYSBsaWZlIHRvIGEgZ2lnYXRvbiBvZiBjb29raWVzPzwvcT4iLAogICAgICAiVGVtcGxlIiwKICAgICAgMgogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkRlbGljaW91cyBibGVzc2luZyIsCiAgICAgICI8cT5BbmQgbG8sIHRoZSBCYWtlcidzIGFsbWlnaHR5IHNwb29uIGNhbWUgZG93biBhbmQgZGlzdHJpYnV0ZWQgaG9seSBnaWZ0cyB1bnRvIHRoZSBiZWxpZXZlcnMgLSBzaGltbWVyaW5nIHN1Z2FyLCBhbmQgY2hvY29sYXRlIGRhcmsgYXMgbmlnaHQsIGFuZCBhbGwgbWFubmVyIG9mIHdoZWF0cy4gQW5kIGJveSBsZXQgbWUgdGVsbCB5b3UsIHRoYXQgcGFydHkgd2FzIG1pZ2h0eSBnbmFybHkuPC9xPiIsCiAgICAgICJUZW1wbGUiLAogICAgICAzCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiU3VuIGZlc3RpdmFsIiwKICAgICAgIjxxPkZyZWUgdGhlIHByaW1vcmRpYWwgcG93ZXJzIG9mIHlvdXIgdGVtcGxlcyB3aXRoIHRoZXNlIGFubnVhbCBjZWxlYnJhdGlvbnMgaW52b2x2aW5nIGZpcmUtYnJlYXRoZXJzLCB0cmFkaXRpb25hbCBkYW5jaW5nLCByaXR1YWwgYmVoZWFkaW5ncyBhbmQgb3RoZXIgbWVycmltZW50cyE8L3E+IiwKICAgICAgIlRlbXBsZSIsCiAgICAgIDQKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJFbmxhcmdlZCBwYW50aGVvbiIsCiAgICAgICI8cT5Fbm91Z2ggc3Bpcml0dWFsIGluYWRlcXVhY3khIE1vcmUgZGl2aW5pdGllcyB0aGFuIHlvdSdsbCBldmVyIG5lZWQsIG9yIHlvdXIgbW9uZXkgYmFjayEgMTAwJSBndWFyYW50ZWVkITwvcT4iLAogICAgICAiVGVtcGxlIiwKICAgICAgNQogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkdyZWF0IEJha2VyIGluIHRoZSBza3kiLAogICAgICAiPHE+VGhpcyBpcyBpdC4gVGhlIHVsdGltYXRlIGRlaXR5IGhhcyBmaW5hbGx5IGNhc3QgVGhlaXIgc3VibGltZWx5IGRpdmluZSBleWUgdXBvbiB5b3VyIG9wZXJhdGlvbjsgd2hldGhlciB0aGlzIGlzIGEgZ29vZCB0aGluZyBvciBwb3NzaWJseSB0aGUgZW5kIG9mIGRheXMgaXMgc29tZXRoaW5nIHlvdSBzaG91bGQgZmluZCBvdXQgdmVyeSBzb29uLjwvcT4iLAogICAgICAiVGVtcGxlIiwKICAgICAgNgogICAgKTsKCiAgICBvcmRlciA9IDU3NTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlBvaW50aWVyIGhhdHMiLAogICAgICAiPHE+VGVzdHMgaGF2ZSBzaG93biBpbmNyZWFzZWQgdGhhdW1pYyByZWNlcHRpdml0eSByZWxhdGl2ZSB0byB0aGUgZ2VvbWV0cmljIHByb3BvcnRpb25zIG9mIHdpemFyZGx5IGNvbmljIGltcGxlbWVudHMuPC9xPiIsCiAgICAgICJXaXphcmQgdG93ZXIiLAogICAgICAxCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQmVhcmRsaWVyIGJlYXJkcyIsCiAgICAgICI8cT5IYXZlbid0IHlvdSBoZWFyZD8gVGhlIGJlYXJkIGlzIHRoZSB3b3JkLjwvcT4iLAogICAgICAiV2l6YXJkIHRvd2VyIiwKICAgICAgMgogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkFuY2llbnQgZ3JpbW9pcmVzIiwKICAgICAgJzxxPkNvbnRhaW4gaW50ZXJlc3Rpbmcgc3BlbGxzIHN1Y2ggYXMgIlR1cm4gV2F0ZXIgVG8gRHJvb2wiLCAiR3JvdyBFeWVicm93cyBPbiBGdXJuaXR1cmUiIGFuZCAiU3VtbW9uIFBvbGl0aWNpYW4iLjwvcT4nLAogICAgICAiV2l6YXJkIHRvd2VyIiwKICAgICAgMwogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIktpdGNoZW4gY3Vyc2VzIiwKICAgICAgIjxxPkV4b3RpYyBtYWdpYyBpbnZvbHZlZCBpbiBhbGwgdGhpbmdzIHBhc3RyeS1yZWxhdGVkLiBIZXhjZWxsZW50ITwvcT4iLAogICAgICAiV2l6YXJkIHRvd2VyIiwKICAgICAgNAogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlNjaG9vbCBvZiBzb3JjZXJ5IiwKICAgICAgIjxxPlRoaXMgY29va2llLWZ1bmRlZCBhY2FkZW15IG9mIHdpdGNoY3JhZnQgaXMgaG9tZSB0byB0aGUgNCBwcmVzdGlnaW91cyBob3VzZXMgb2YgbWFnaWMgOiB0aGUgSm9ja3MsIHRoZSBOZXJkcywgdGhlIFByZXBzLCBhbmQgdGhlIERlYXRobXVuY2hlcnMuPC9xPiIsCiAgICAgICJXaXphcmQgdG93ZXIiLAogICAgICA1CiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRGFyayBmb3JtdWxhcyIsCiAgICAgICI8cT5FbGRyaXRjaCBmb3JjZXMgYXJlIGF0IHdvcmsgYmVoaW5kIHRoZXNlIHNwZWxscyAtIHlvdSBnZXQgdGhlIGZlZWxpbmcgeW91IHJlYWxseSBzaG91bGRuJ3QgYmUgbWVzc2luZyB3aXRoIHRob3NlLiBCdXQgSSBtZWFuLCBmcmVlIGNvb2tpZXMsIHJpZ2h0PzwvcT4iLAogICAgICAiV2l6YXJkIHRvd2VyIiwKICAgICAgNgogICAgKTsKCiAgICBvcmRlciA9IDI1MDsKICAgIEdhbWUuR3JhbmRtYVN5bmVyZ3koCiAgICAgICJCYW5rZXIgZ3JhbmRtYXMiLAogICAgICAiQSBuaWNlIGJhbmtlciB0byBjYXNoIGluIG1vcmUgY29va2llcy4iLAogICAgICAiQmFuayIKICAgICk7CiAgICBHYW1lLkdyYW5kbWFTeW5lcmd5KAogICAgICAiUHJpZXN0ZXNzIGdyYW5kbWFzIiwKICAgICAgIkEgbmljZSBwcmllc3Rlc3MgdG8gcHJhaXNlIHRoZSBvbmUgdHJ1ZSBCYWtlciBpbiB0aGUgc2t5LiIsCiAgICAgICJUZW1wbGUiCiAgICApOwogICAgR2FtZS5HcmFuZG1hU3luZXJneSgKICAgICAgIldpdGNoIGdyYW5kbWFzIiwKICAgICAgIkEgbmljZSB3aXRjaCB0byBjYXN0IGEgemlwLCBhbmQgYSB6b29wLCBhbmQgcG9vZiEgQ29va2llcy4iLAogICAgICAiV2l6YXJkIHRvd2VyIgogICAgKTsKCiAgICBvcmRlciA9IDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiVGluIG9mIGJyaXRpc2ggdGVhIGJpc2N1aXRzIiwKICAgICAgbG9jKCJDb250YWlucyBhbiBhc3NvcnRtZW50IG9mIGZhbmN5IGJpc2N1aXRzLiIpICsKICAgICAgICAiPHE+RXZlcnkgdGltZSBpcyB0ZWEgdGltZS48L3E+IiwKICAgICAgMjUsCiAgICAgIFsyMSwgOF0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiSGVhdmVubHkgY29va2llcyJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkJveCBvZiBtYWNhcm9ucyIsCiAgICAgIGxvYygiQ29udGFpbnMgYW4gYXNzb3J0bWVudCBvZiBtYWNhcm9ucy4iKSArCiAgICAgICAgIjxxPk11bHRpY29sb3JlZCBkZWxpY2FjaWVzIGZpbGxlZCB3aXRoIHZhcmlvdXMga2luZHMgb2YgamFtLjxicj5Ob3QgdG8gYmUgY29uZnVzZWQgd2l0aCBtYWNhcm9vbnMsIG1hY2Fyb25pLCBtYWNhcmVuYSBvciBhbnkgb2YgdGhhdCBub25zZW5zZS48L3E+IiwKICAgICAgMjUsCiAgICAgIFsyMCwgOF0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiSGVhdmVubHkgY29va2llcyJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkJveCBvZiBicmFuZCBiaXNjdWl0cyIsCiAgICAgIGxvYygiQ29udGFpbnMgYW4gYXNzb3J0bWVudCBvZiBwb3B1bGFyIGJpc2N1aXRzLiIpICsKICAgICAgICAiPHE+VGhleSdyZSBicmFuZCBuZXchPC9xPiIsCiAgICAgIDI1LAogICAgICBbMjAsIDldCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkhlYXZlbmx5IGNvb2tpZXMiXTsKCiAgICBvcmRlciA9IDEwMDIwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlB1cmUgYmxhY2sgY2hvY29sYXRlIGNvb2tpZXMiLAogICAgICBkZXNjOiAnRGlwcGVkIGluIGEgbGFiLW1hZGUgc3Vic3RhbmNlIGRhcmtlciB0aGFuIHRoZSBkYXJrZXN0IGNvY29hIChkdWJiZWQgImNob2NvYWxhdGUiKS4nLAogICAgICBpY29uOiBbMjYsIDNdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiUHVyZSB3aGl0ZSBjaG9jb2xhdGUgY29va2llcyIsCiAgICAgIGRlc2M6ICJFbGFib3JhdGVkIG9uIHRoZSBuYW5vLXNjYWxlLCB0aGUgY29hdGluZyBvbiB0aGlzIGJpc2N1aXQgaXMgYWJsZSB0byByZWZyYWN0IGxpZ2h0IGV2ZW4gaW4gYSBwaXRjaC1ibGFjayBlbnZpcm9ubWVudC4iLAogICAgICBpY29uOiBbMjYsIDRdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiTGFkeWZpbmdlcnMiLAogICAgICBkZXNjOiAiQ2xlYW5lZCBhbmQgc2FuaXRpemVkIHNvIHdlbGwgeW91J2Qgc3dlYXIgdGhleSdyZSBhY3R1YWwgYmlzY3VpdHMuIiwKICAgICAgaWNvbjogWzI3LCAzXSwKICAgICAgcG93ZXI6IDMsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlR1aWxlcyIsCiAgICAgIGRlc2M6ICJUaGVzZSBuZXZlciBnbyBvdXQgb2YgdGlsZS4iLAogICAgICBpY29uOiBbMjcsIDRdLAogICAgICBwb3dlcjogMywKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkNob2NvbGF0ZS1zdHVmZmVkIGJpc2N1aXRzIiwKICAgICAgZGVzYzogIkEgcHJpbmNlbHkgc25hY2shPGJyPlRoZSBob2xlcyBhcmUgc28gdGhlIGNob2NvbGF0ZSBzdHVmZmluZyBjYW4gYnJlYXRoZS4iLAogICAgICBpY29uOiBbMjgsIDNdLAogICAgICBwb3dlcjogMywKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkNoZWNrZXIgY29va2llcyIsCiAgICAgIGRlc2M6ICJBIHNxdWFyZSBjb29raWU/IFRoaXMgc29sdmVzIHNvIG1hbnkgc3RvcmFnZSBhbmQgcGFja2FnaW5nIHByb2JsZW1zISBZb3UncmUgYSBnZW5pdXMhIiwKICAgICAgaWNvbjogWzI4LCA0XSwKICAgICAgcG93ZXI6IDMsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQnV0dGVyIGNvb2tpZXMiLAogICAgICBkZXNjOiAiVGhlc2UgbWVsdCByaWdodCBvZmYgeW91ciBtb3V0aCBhbmQgaW50byB5b3VyIGhlYXJ0LiAoTGV0J3MgZmFjZSBpdCwgdGhleSdyZSByYXRoZXIgZmF0dGVuaW5nLikiLAogICAgICBpY29uOiBbMjksIDNdLAogICAgICBwb3dlcjogMywKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJDcmVhbSBjb29raWVzIiwKICAgICAgZGVzYzogIkl0J3MgbGlrZSB0d28gY2hvY29sYXRlIGNoaXAgY29va2llcyEgQnV0IGJyb3VnaHQgdG9nZXRoZXIgd2l0aCB0aGUgbWFnaWMgb2YgY3JlYW0hIEl0J3MgZmllbmRpc2hseSBwZXJmZWN0ISIsCiAgICAgIGljb246IFsyOSwgNF0sCiAgICAgIHBvd2VyOiAzLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OSAqIDUsCiAgICB9KTsKCiAgICBvcmRlciA9IDA7CiAgICB2YXIgZGVzYyA9IGxvYygKICAgICAgIlBsYWNpbmcgYW4gdXBncmFkZSBpbiB0aGlzIHNsb3Qgd2lsbCBtYWtlIGl0cyBlZmZlY3RzIDxiPnBlcm1hbmVudDwvYj4gYWNyb3NzIGFsbCBwbGF5dGhyb3VnaHMuIgogICAgKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoIlBlcm1hbmVudCB1cGdyYWRlIHNsb3QgSSIsIGRlc2MsIDEwMCwgWzAsIDEwXSk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QuaWNvbkZ1bmN0aW9uID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gR2FtZS5QZXJtYW5lbnRTbG90SWNvbigwKTsKICAgIH07CiAgICBHYW1lLmxhc3QuYWN0aXZhdGVGdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgR2FtZS5Bc3NpZ25QZXJtYW5lbnRTbG90KDApOwogICAgfTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoIlBlcm1hbmVudCB1cGdyYWRlIHNsb3QgSUkiLCBkZXNjLCAyMDAwMCwgWzEsIDEwXSk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiUGVybWFuZW50IHVwZ3JhZGUgc2xvdCBJIl07CiAgICBHYW1lLmxhc3QuaWNvbkZ1bmN0aW9uID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gR2FtZS5QZXJtYW5lbnRTbG90SWNvbigxKTsKICAgIH07CiAgICBHYW1lLmxhc3QuYWN0aXZhdGVGdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgR2FtZS5Bc3NpZ25QZXJtYW5lbnRTbG90KDEpOwogICAgfTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoIlBlcm1hbmVudCB1cGdyYWRlIHNsb3QgSUlJIiwgZGVzYywgMzAwMDAwMCwgWzIsIDEwXSk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiUGVybWFuZW50IHVwZ3JhZGUgc2xvdCBJSSJdOwogICAgR2FtZS5sYXN0Lmljb25GdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIEdhbWUuUGVybWFuZW50U2xvdEljb24oMik7CiAgICB9OwogICAgR2FtZS5sYXN0LmFjdGl2YXRlRnVuY3Rpb24gPSBmdW5jdGlvbiAoKSB7CiAgICAgIEdhbWUuQXNzaWduUGVybWFuZW50U2xvdCgyKTsKICAgIH07CiAgICBuZXcgR2FtZS5VcGdyYWRlKCJQZXJtYW5lbnQgdXBncmFkZSBzbG90IElWIiwgZGVzYywgNDAwMDAwMDAwLCBbMywgMTBdKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJQZXJtYW5lbnQgdXBncmFkZSBzbG90IElJSSJdOwogICAgR2FtZS5sYXN0Lmljb25GdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIEdhbWUuUGVybWFuZW50U2xvdEljb24oMyk7CiAgICB9OwogICAgR2FtZS5sYXN0LmFjdGl2YXRlRnVuY3Rpb24gPSBmdW5jdGlvbiAoKSB7CiAgICAgIEdhbWUuQXNzaWduUGVybWFuZW50U2xvdCgzKTsKICAgIH07CiAgICBuZXcgR2FtZS5VcGdyYWRlKCJQZXJtYW5lbnQgdXBncmFkZSBzbG90IFYiLCBkZXNjLCA1MDAwMDAwMDAwMCwgWzQsIDEwXSk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiUGVybWFuZW50IHVwZ3JhZGUgc2xvdCBJViJdOwogICAgR2FtZS5sYXN0Lmljb25GdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIEdhbWUuUGVybWFuZW50U2xvdEljb24oNCk7CiAgICB9OwogICAgR2FtZS5sYXN0LmFjdGl2YXRlRnVuY3Rpb24gPSBmdW5jdGlvbiAoKSB7CiAgICAgIEdhbWUuQXNzaWduUGVybWFuZW50U2xvdCg0KTsKICAgIH07CgogICAgdmFyIHNsb3RzID0gWwogICAgICAiUGVybWFuZW50IHVwZ3JhZGUgc2xvdCBJIiwKICAgICAgIlBlcm1hbmVudCB1cGdyYWRlIHNsb3QgSUkiLAogICAgICAiUGVybWFuZW50IHVwZ3JhZGUgc2xvdCBJSUkiLAogICAgICAiUGVybWFuZW50IHVwZ3JhZGUgc2xvdCBJViIsCiAgICAgICJQZXJtYW5lbnQgdXBncmFkZSBzbG90IFYiLAogICAgXTsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2xvdHMubGVuZ3RoOyBpKyspIHsKICAgICAgR2FtZS5VcGdyYWRlc1tzbG90c1tpXV0uZGVzY0Z1bmMgPSAoZnVuY3Rpb24gKGkpIHsKICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGNvbnRleHQpIHsKICAgICAgICAgIGlmIChHYW1lLnBlcm1hbmVudFVwZ3JhZGVzW2ldID09IC0xKQogICAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAgIHRoaXMuZGVzYyArCiAgICAgICAgICAgICAgKGNvbnRleHQgPT0gInN0YXRzIgogICAgICAgICAgICAgICAgPyAiIgogICAgICAgICAgICAgICAgOiAiPGJyPjxiPiIgKyBsb2MoIkNsaWNrIHRvIGFjdGl2YXRlLiIpICsgIjwvYj4iKQogICAgICAgICAgICApOwogICAgICAgICAgdmFyIHVwZ3JhZGUgPSBHYW1lLlVwZ3JhZGVzQnlJZFtHYW1lLnBlcm1hbmVudFVwZ3JhZGVzW2ldXTsKICAgICAgICAgIHJldHVybiAoCiAgICAgICAgICAgICc8ZGl2IHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsiPicgKwogICAgICAgICAgICBsb2MoIkN1cnJlbnQ6IikgKwogICAgICAgICAgICAiICIgKwogICAgICAgICAgICB0aW55SWNvbih1cGdyYWRlLmljb24pICsKICAgICAgICAgICAgIiA8Yj4iICsKICAgICAgICAgICAgdXBncmFkZS5kbmFtZSArCiAgICAgICAgICAgICc8L2I+PGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+PC9kaXY+JyArCiAgICAgICAgICAgIHRoaXMuZGRlc2MgKwogICAgICAgICAgICAoY29udGV4dCA9PSAic3RhdHMiCiAgICAgICAgICAgICAgPyAiIgogICAgICAgICAgICAgIDogIjxicj48Yj4iICsgbG9jKCJDbGljayB0byBhY3RpdmF0ZS4iKSArICI8L2I+IikKICAgICAgICAgICk7CiAgICAgICAgfTsKICAgICAgfSkoaSk7CiAgICB9CgogICAgR2FtZS5QZXJtYW5lbnRTbG90SWNvbiA9IGZ1bmN0aW9uIChzbG90KSB7CiAgICAgIGlmIChHYW1lLnBlcm1hbmVudFVwZ3JhZGVzW3Nsb3RdID09IC0xKSByZXR1cm4gW3Nsb3QsIDEwXTsKICAgICAgcmV0dXJuIEdhbWUuVXBncmFkZXNCeUlkW0dhbWUucGVybWFuZW50VXBncmFkZXNbc2xvdF1dLmljb247CiAgICB9OwogICAgR2FtZS5Bc3NpZ25QZXJtYW5lbnRTbG90ID0gZnVuY3Rpb24gKHNsb3QpIHsKICAgICAgUGxheVNvdW5kKCJzbmQvdGljay5tcDMiKTsKICAgICAgR2FtZS50b29sdGlwLmhpZGUoKTsKICAgICAgdmFyIGxpc3QgPSBbXTsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlVwZ3JhZGVzKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5VcGdyYWRlc1tpXTsKICAgICAgICBpZiAoCiAgICAgICAgICBtZS5ib3VnaHQgJiYKICAgICAgICAgIG1lLnVubG9ja2VkICYmCiAgICAgICAgICAhbWUubm9QZXJtICYmCiAgICAgICAgICAobWUucG9vbCA9PSAiIiB8fCBtZS5wb29sID09ICJjb29raWUiKQogICAgICAgICkgewogICAgICAgICAgdmFyIGZhaWwgPSAwOwogICAgICAgICAgZm9yICh2YXIgaWkgaW4gR2FtZS5wZXJtYW5lbnRVcGdyYWRlcykgewogICAgICAgICAgICBpZiAoR2FtZS5wZXJtYW5lbnRVcGdyYWRlc1tpaV0gPT0gbWUuaWQpIGZhaWwgPSAxOwogICAgICAgICAgfSAvL2NoZWNrIGlmIG5vdCBhbHJlYWR5IGluIGFub3RoZXIgcGVybWFzbG90CiAgICAgICAgICBpZiAoIWZhaWwpIGxpc3QucHVzaChtZSk7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgc29ydE1hcCA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgaWYgKGEub3JkZXIgPiBiLm9yZGVyKSByZXR1cm4gMTsKICAgICAgICBlbHNlIGlmIChhLm9yZGVyIDwgYi5vcmRlcikgcmV0dXJuIC0xOwogICAgICAgIGVsc2UgcmV0dXJuIDA7CiAgICAgIH07CiAgICAgIGxpc3Quc29ydChzb3J0TWFwKTsKCiAgICAgIHZhciB1cGdyYWRlcyA9ICIiOwogICAgICBmb3IgKHZhciBpIGluIGxpc3QpIHsKICAgICAgICB2YXIgbWUgPSBsaXN0W2ldOwogICAgICAgIHVwZ3JhZGVzICs9IEdhbWUuY3JhdGUoCiAgICAgICAgICBtZSwKICAgICAgICAgICIiLAogICAgICAgICAgIlBsYXlTb3VuZCgnc25kL3RpY2subXAzJyk7R2FtZS5QdXRVcGdyYWRlSW5QZXJtYW5lbnRTbG90KCIgKwogICAgICAgICAgICBtZS5pZCArCiAgICAgICAgICAgICIsIiArCiAgICAgICAgICAgIHNsb3QgKwogICAgICAgICAgICAiKTsiLAogICAgICAgICAgInVwZ3JhZGVGb3JQZXJtYW5lbnQiICsgbWUuaWQKICAgICAgICApOwogICAgICB9CiAgICAgIHZhciB1cGdyYWRlID0gR2FtZS5wZXJtYW5lbnRVcGdyYWRlc1tzbG90XTsKICAgICAgR2FtZS5TZWxlY3RpbmdQZXJtYW5lbnRVcGdyYWRlID0gdXBncmFkZTsKICAgICAgR2FtZS5Qcm9tcHQoCiAgICAgICAgIjxpZCBQaWNrUGVybWFVcGdyYWRlPjxoMz4iICsKICAgICAgICAgIGxvYygiUGljayBhbiB1cGdyYWRlIHRvIG1ha2UgcGVybWFuZW50IikgKwogICAgICAgICAgIjwvaDM+IiArCiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+PGRpdiBzdHlsZT0ibWFyZ2luOjRweCBhdXRvO2NsZWFyOmJvdGg7d2lkdGg6MTIwcHg7Ij48ZGl2IGNsYXNzPSJjcmF0ZSB1cGdyYWRlIGVuYWJsZWQiIHN0eWxlPSJiYWNrZ3JvdW5kLXBvc2l0aW9uOicgKwogICAgICAgICAgLXNsb3QgKiA0OCArCiAgICAgICAgICAicHggIiArCiAgICAgICAgICAtMTAgKiA0OCArCiAgICAgICAgICAncHg7Ij48L2Rpdj48ZGl2IGlkPSJ1cGdyYWRlVG9TbG90Tm9uZSIgY2xhc3M9ImNyYXRlIHVwZ3JhZGUgZW5hYmxlZCIgc3R5bGU9ImJhY2tncm91bmQtcG9zaXRpb246JyArCiAgICAgICAgICAtMCAqIDQ4ICsKICAgICAgICAgICJweCAiICsKICAgICAgICAgIC03ICogNDggKwogICAgICAgICAgInB4O2Rpc3BsYXk6IiArCiAgICAgICAgICAodXBncmFkZSAhPSAtMSA/ICJub25lIiA6ICJibG9jayIpICsKICAgICAgICAgICc7Ij48L2Rpdj48ZGl2IGlkPSJ1cGdyYWRlVG9TbG90V3JhcCIgc3R5bGU9ImZsb2F0OmxlZnQ7ZGlzcGxheTonICsKICAgICAgICAgICh1cGdyYWRlID09IC0xID8gIm5vbmUiIDogImJsb2NrIikgKwogICAgICAgICAgJzsiPicgKwogICAgICAgICAgR2FtZS5jcmF0ZSgKICAgICAgICAgICAgR2FtZS5VcGdyYWRlc0J5SWRbdXBncmFkZSA9PSAtMSA/IDAgOiB1cGdyYWRlXSwKICAgICAgICAgICAgIiIsCiAgICAgICAgICAgICIiLAogICAgICAgICAgICAidXBncmFkZVRvU2xvdCIKICAgICAgICAgICkgKwogICAgICAgICAgIjwvZGl2PjwvZGl2PiIgKwogICAgICAgICAgJzxkaXYgY2xhc3M9ImJsb2NrIGNyYXRlQm94IiBzdHlsZT0ib3ZlcmZsb3cteTpzY3JvbGw7ZmxvYXQ6bGVmdDtjbGVhcjpsZWZ0O3dpZHRoOjMxN3B4O3BhZGRpbmc6MHB4O2hlaWdodDoyNTBweDsiPicgKwogICAgICAgICAgdXBncmFkZXMgKwogICAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICAgJzxkaXYgY2xhc3M9ImJsb2NrIiBzdHlsZT0iZmxvYXQ6cmlnaHQ7d2lkdGg6MTUycHg7Y2xlYXI6cmlnaHQ7aGVpZ2h0OjIzNHB4OyI+JyArCiAgICAgICAgICBsb2MoCiAgICAgICAgICAgICdIZXJlIGFyZSBhbGwgdGhlIHVwZ3JhZGVzIHlvdVwndmUgcHVyY2hhc2VkIGxhc3QgcGxheXRocm91Z2guPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+UGljayBvbmUgdG8gcGVybWFuZW50bHkgZ2FpbiBpdHMgZWZmZWN0cyE8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj5Zb3UgY2FuIHJlYXNzaWduIHRoaXMgc2xvdCBhbnl0aW1lIHlvdSBhc2NlbmQuJwogICAgICAgICAgKSArCiAgICAgICAgICAiPC9kaXY+IiwKICAgICAgICBbCiAgICAgICAgICBbCiAgICAgICAgICAgIGxvYygiQ29uZmlybSIpLAogICAgICAgICAgICAiR2FtZS5wZXJtYW5lbnRVcGdyYWRlc1siICsKICAgICAgICAgICAgICBzbG90ICsKICAgICAgICAgICAgICAiXT1HYW1lLlNlbGVjdGluZ1Blcm1hbmVudFVwZ3JhZGU7R2FtZS5CdWlsZEFzY2VuZFRyZWUoKTtHYW1lLkNsb3NlUHJvbXB0KCk7IiwKICAgICAgICAgIF0sCiAgICAgICAgICBsb2MoIkNhbmNlbCIpLAogICAgICAgIF0sCiAgICAgICAgMCwKICAgICAgICAid2lkZVByb21wdCIKICAgICAgKTsKICAgIH07CiAgICBHYW1lLlNlbGVjdGluZ1Blcm1hbmVudFVwZ3JhZGUgPSAtMTsKICAgIEdhbWUuUHV0VXBncmFkZUluUGVybWFuZW50U2xvdCA9IGZ1bmN0aW9uICh1cGdyYWRlLCBzbG90KSB7CiAgICAgIEdhbWUuU2VsZWN0aW5nUGVybWFuZW50VXBncmFkZSA9IHVwZ3JhZGU7CiAgICAgIGwoInVwZ3JhZGVUb1Nsb3RXcmFwIikuaW5uZXJIVE1MID0gIiI7CiAgICAgIGwoInVwZ3JhZGVUb1Nsb3RXcmFwIikuc3R5bGUuZGlzcGxheSA9IHVwZ3JhZGUgPT0gLTEgPyAibm9uZSIgOiAiYmxvY2siOwogICAgICBsKCJ1cGdyYWRlVG9TbG90Tm9uZSIpLnN0eWxlLmRpc3BsYXkgPSB1cGdyYWRlICE9IC0xID8gIm5vbmUiIDogImJsb2NrIjsKICAgICAgbCgidXBncmFkZVRvU2xvdFdyYXAiKS5pbm5lckhUTUwgPSBHYW1lLmNyYXRlKAogICAgICAgIEdhbWUuVXBncmFkZXNCeUlkW3VwZ3JhZGUgPT0gLTEgPyAwIDogdXBncmFkZV0sCiAgICAgICAgIiIsCiAgICAgICAgIiIsCiAgICAgICAgInVwZ3JhZGVUb1Nsb3QiCiAgICAgICk7CiAgICB9OwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTdGFyc3Bhd24iLAogICAgICBsb2MoIkVnZ3MgZHJvcCA8Yj4lMSU8L2I+IG1vcmUgb2Z0ZW4uIiwgMTApICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiR29sZGVuIGNvb2tpZXMgYXBwZWFyIDxiPiUxJTwvYj4gbW9yZSBvZnRlbiBkdXJpbmcgJTIuIiwgWwogICAgICAgICAgMiwKICAgICAgICAgIGxvYygiRWFzdGVyIiksCiAgICAgICAgXSksCiAgICAgIDExMTExMSwKICAgICAgWzAsIDEyXQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJTZWFzb24gc3dpdGNoZXIiXTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTdGFyc25vdyIsCiAgICAgIGxvYygiQ2hyaXN0bWFzIGNvb2tpZXMgZHJvcCA8Yj4lMSU8L2I+IG1vcmUgb2Z0ZW4uIiwgNSkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJSZWluZGVlciBhcHBlYXIgPGI+JTElPC9iPiBtb3JlIG9mdGVuLiIsIDUpLAogICAgICAxMTExMTEsCiAgICAgIFsxMiwgOV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiU2Vhc29uIHN3aXRjaGVyIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiU3RhcnRlcnJvciIsCiAgICAgIGxvYygiU3Bvb2t5IGNvb2tpZXMgZHJvcCA8Yj4lMSU8L2I+IG1vcmUgb2Z0ZW4uIiwgMTApICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiR29sZGVuIGNvb2tpZXMgYXBwZWFyIDxiPiUxJTwvYj4gbW9yZSBvZnRlbiBkdXJpbmcgJTIuIiwgWwogICAgICAgICAgMiwKICAgICAgICAgIGxvYygiSGFsbG93ZWVuIiksCiAgICAgICAgXSksCiAgICAgIDExMTExMSwKICAgICAgWzEzLCA4XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJTZWFzb24gc3dpdGNoZXIiXTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTdGFybG92ZSIsCiAgICAgIGxvYygiSGVhcnQgY29va2llcyBhcmUgPGI+JTElPC9iPiBtb3JlIHBvd2VyZnVsLiIsIDUwKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoIkdvbGRlbiBjb29raWVzIGFwcGVhciA8Yj4lMSU8L2I+IG1vcmUgb2Z0ZW4gZHVyaW5nICUyLiIsIFsKICAgICAgICAgIDIsCiAgICAgICAgICBsb2MoIlZhbGVudGluZSdzIGRheSIpLAogICAgICAgIF0pLAogICAgICAxMTExMTEsCiAgICAgIFsyMCwgM10KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiU2Vhc29uIHN3aXRjaGVyIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiU3RhcnRyYWRlIiwKICAgICAgbG9jKCJHb2xkZW4gY29va2llcyBhcHBlYXIgPGI+JTElPC9iPiBtb3JlIG9mdGVuIGR1cmluZyAlMi4iLCBbCiAgICAgICAgNSwKICAgICAgICBsb2MoIkJ1c2luZXNzIGRheSIpLAogICAgICBdKSwKICAgICAgMTExMTExLAogICAgICBbMTcsIDZdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIlNlYXNvbiBzd2l0Y2hlciJdOwoKICAgIHZhciBhbmdlbFByaWNlRmFjdG9yID0gNzsKICAgIHZhciBkZXNjID0gZnVuY3Rpb24gKHBlcmNlbnQsIHRvdGFsKSB7CiAgICAgIHJldHVybiBsb2MoCiAgICAgICAgIllvdSBnYWluIGFub3RoZXIgPGI+KyUxJTwvYj4gb2YgeW91ciByZWd1bGFyIENwUyB3aGlsZSB0aGUgZ2FtZSBpcyBjbG9zZWQsIGZvciBhIHRvdGFsIG9mIDxiPiUyJTwvYj4uIiwKICAgICAgICBbcGVyY2VudCwgdG90YWxdCiAgICAgICk7CiAgICB9OwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkFuZ2VscyIsCiAgICAgIGRlc2MoMTAsIDE1KSArCiAgICAgICAgIjxxPkxvd2VzdC1yYW5raW5nIGF0IHRoZSBmaXJzdCBzcGhlcmUgb2YgcGFzdHJ5IGhlYXZlbiwgYW5nZWxzIGFyZSB0YXNrZWQgd2l0aCBkZWxpdmVyaW5nIG5ldyByZWNpcGVzIHRvIHRoZSBtb3J0YWxzIHRoZXkgZGVlbSB3b3J0aHkuPC9xPiIsCiAgICAgIE1hdGgucG93KGFuZ2VsUHJpY2VGYWN0b3IsIDEpLAogICAgICBbMCwgMTFdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIlR3aW4gR2F0ZXMgb2YgVHJhbnNjZW5kZW5jZSJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkFyY2hhbmdlbHMiLAogICAgICBkZXNjKDEwLCAyNSkgKwogICAgICAgICI8cT5NZW1iZXJzIG9mIHRoZSBmaXJzdCBzcGhlcmUgb2YgcGFzdHJ5IGhlYXZlbiwgYXJjaGFuZ2VscyBhcmUgcmVzcG9uc2libGUgZm9yIHRoZSBzbW9vdGggZnVuY3Rpb25pbmcgb2YgdGhlIHdvcmxkJ3MgbGFyZ2VzdCBiYWtlcmllcy48L3E+IiwKICAgICAgTWF0aC5wb3coYW5nZWxQcmljZUZhY3RvciwgMiksCiAgICAgIFsxLCAxMV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiQW5nZWxzIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiVmlydHVlcyIsCiAgICAgIGRlc2MoMTAsIDM1KSArCiAgICAgICAgIjxxPkZvdW5kIGF0IHRoZSBzZWNvbmQgc3BoZXJlIG9mIHBhc3RyeSBoZWF2ZW4sIHZpcnR1ZXMgbWFrZSB1c2Ugb2YgdGhlaXIgaGVhdmVubHkgc3RyZW5ndGggdG8gcHVzaCBhbmQgZHJhZyB0aGUgc3RhcnMgb2YgdGhlIGNvc21vcy48L3E+IiwKICAgICAgTWF0aC5wb3coYW5nZWxQcmljZUZhY3RvciwgMyksCiAgICAgIFsyLCAxMV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiQXJjaGFuZ2VscyJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkRvbWluaW9ucyIsCiAgICAgIGRlc2MoMTAsIDQ1KSArCiAgICAgICAgIjxxPlJ1bGluZyBvdmVyIHRoZSBzZWNvbmQgc3BoZXJlIG9mIHBhc3RyeSBoZWF2ZW4sIGRvbWluaW9ucyBob2xkIGEgbWFuYWdlcmlhbCBwb3NpdGlvbiBhbmQgYXJlIGluIGNoYXJnZSBvZiBhY2NvdW50aW5nIGFuZCByZWd1bGF0aW5nIHNjaGVkdWxlcy48L3E+IiwKICAgICAgTWF0aC5wb3coYW5nZWxQcmljZUZhY3RvciwgNCksCiAgICAgIFszLCAxMV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiVmlydHVlcyJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkNoZXJ1YmltIiwKICAgICAgZGVzYygxMCwgNTUpICsKICAgICAgICAiPHE+U2llZ2luZyBhdCB0aGUgZmlyc3Qgc3BoZXJlIG9mIHBhc3RyeSBoZWF2ZW4sIHRoZSBmb3VyLWZhY2VkIGNoZXJ1YmltIHNlcnZlIGFzIGhlYXZlbmx5IGJvdW5jZXJzIGFuZCBib2R5Z3VhcmRzLjwvcT4iLAogICAgICBNYXRoLnBvdyhhbmdlbFByaWNlRmFjdG9yLCA1KSwKICAgICAgWzQsIDExXQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJEb21pbmlvbnMiXTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTZXJhcGhpbSIsCiAgICAgIGRlc2MoMTAsIDY1KSArCiAgICAgICAgIjxxPkxlYWRpbmcgdGhlIGZpcnN0IHNwaGVyZSBvZiBwYXN0cnkgaGVhdmVuLCBzZXJhcGhpbSBwb3NzZXNzIHVsdGltYXRlIGtub3dsZWRnZSBvZiBldmVyeXRoaW5nIHBlcnRhaW5pbmcgdG8gYmFraW5nLjwvcT4iLAogICAgICBNYXRoLnBvdyhhbmdlbFByaWNlRmFjdG9yLCA2KSwKICAgICAgWzUsIDExXQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJDaGVydWJpbSJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkdvZCIsCiAgICAgIGRlc2MoMTAsIDc1KSArICI8cT5MaWtlIFNhbnRhLCBidXQgbGVzcyBmdW4uPC9xPiIsCiAgICAgIE1hdGgucG93KGFuZ2VsUHJpY2VGYWN0b3IsIDcpLAogICAgICBbNiwgMTFdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIlNlcmFwaGltIl07CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlR3aW4gR2F0ZXMgb2YgVHJhbnNjZW5kZW5jZSIsCiAgICAgIGxvYygKICAgICAgICAiWW91IG5vdyA8Yj5rZWVwIG1ha2luZyBjb29raWVzIHdoaWxlIHRoZSBnYW1lIGlzIGNsb3NlZDwvYj4sIGF0IHRoZSByYXRlIG9mIDxiPiUxJTwvYj4gb2YgeW91ciByZWd1bGFyIENwUyBhbmQgdXAgdG8gPGI+MSBob3VyPC9iPiBhZnRlciB0aGUgZ2FtZSBpcyBjbG9zZWQuPGJyPihCZXlvbmQgMSBob3VyLCB0aGlzIGlzIHJlZHVjZWQgYnkgYSBmdXJ0aGVyICUyJSAtIHlvdXIgcmF0ZSBnb2VzIGRvd24gdG8gPGI+JTMlPC9iPiBvZiB5b3VyIENwUy4pIiwKICAgICAgICBbNSwgOTAsIDAuNV0KICAgICAgKSArCiAgICAgICAgIjxxPlRoaXMgaXMgb25lIG9jY2FzaW9uIHlvdSdyZSBhbHdheXMgdW5kZXJkcmVzc2VkIGZvci4gRG9uJ3Qgd29ycnksIGp1c3QgcnVzaCBpbiBwYXN0IHRoZSBib3VuY2VyIGFuZCBwcmV0ZW5kIHlvdSBrbm93IHBlb3BsZS48L3E+IiwKICAgICAgMSwKICAgICAgWzE1LCAxMV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkhlYXZlbmx5IGx1Y2siLAogICAgICBsb2MoIkdvbGRlbiBjb29raWVzIGFwcGVhciA8Yj4lMSU8L2I+IG1vcmUgb2Z0ZW4uIiwgNSkgKwogICAgICAgICI8cT5Tb21lb25lIHVwIHRoZXJlIGxpa2VzIHlvdS48L3E+IiwKICAgICAgNzcsCiAgICAgIFsyMiwgNl0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiTGFzdGluZyBmb3J0dW5lIiwKICAgICAgbG9jKCJHb2xkZW4gY29va2llIGVmZmVjdHMgbGFzdCA8Yj4lMSU8L2I+IGxvbmdlci4iLCAxMCkgKwogICAgICAgICI8cT5UaGlzIGlzbid0IHlvdXIgYXZlcmFnZSBldmVyeWRheSBsdWNrLiBUaGlzIGlzLi4uIGFkdmFuY2VkIGx1Y2suPC9xPiIsCiAgICAgIDc3NywKICAgICAgWzIzLCA2XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJIZWF2ZW5seSBsdWNrIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRGVjaXNpdmUgZmF0ZSIsCiAgICAgIGxvYygiR29sZGVuIGNvb2tpZXMgc3RheSA8Yj4lMSU8L2I+IGxvbmdlci4iLCA1KSArCiAgICAgICAgIjxxPkxpZmUganVzdCBnb3QgYSBiaXQgbW9yZSBpbnRlbnNlLjwvcT4iLAogICAgICA3Nzc3LAogICAgICBbMTAsIDE0XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJMYXN0aW5nIGZvcnR1bmUiXTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRGl2aW5lIGRpc2NvdW50IiwKICAgICAgbG9jKCJBbGwgYnVpbGRpbmdzIGFyZSA8Yj4lMSUgY2hlYXBlcjwvYj4uIiwgMSkgKwogICAgICAgICI8cT5Tb21lb25lIHNwZWNpYWwgZGVzZXJ2ZXMgYSBzcGVjaWFsIHByaWNlLjwvcT4iLAogICAgICA5OTk5OSwKICAgICAgWzIxLCA3XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJEZWNpc2l2ZSBmYXRlIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRGl2aW5lIHNhbGVzIiwKICAgICAgbG9jKCJBbGwgdXBncmFkZXMgYXJlIDxiPiUxJSBjaGVhcGVyPC9iPi4iLCAxKSArCiAgICAgICAgIjxxPkV2ZXJ5dGhpbmcgbXVzdCBnbyE8L3E+IiwKICAgICAgOTk5OTksCiAgICAgIFsxOCwgN10KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiRGVjaXNpdmUgZmF0ZSJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkRpdmluZSBiYWtlcmllcyIsCiAgICAgIGxvYygiQ29va2llIHVwZ3JhZGVzIGFyZSA8Yj4lMSB0aW1lcyBjaGVhcGVyPC9iPi4iLCA1KSArCiAgICAgICAgIjxxPlRoZXkgc3VyZSBrbm93IHdoYXQgdGhleSdyZSBkb2luZy48L3E+IiwKICAgICAgMzk5OTk5LAogICAgICBbMTcsIDddCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkRpdmluZSBzYWxlcyIsICJEaXZpbmUgZGlzY291bnQiXTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiU3RhcnRlciBraXQiLAogICAgICBsb2MoIllvdSBzdGFydCB3aXRoIDxiPiUxPC9iPi4iLCBsb2MoIiUxIGN1cnNvciIsIDEwKSkgKwogICAgICAgICI8cT5UaGlzIGNhbiBjb21lIGluIGhhbmR5LjwvcT4iLAogICAgICA1MCwKICAgICAgWzAsIDE0XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWwogICAgICAiVGluIG9mIGJyaXRpc2ggdGVhIGJpc2N1aXRzIiwKICAgICAgIkJveCBvZiBtYWNhcm9ucyIsCiAgICAgICJCb3ggb2YgYnJhbmQgYmlzY3VpdHMiLAogICAgICAiVGluIG9mIGJ1dHRlciBjb29raWVzIiwKICAgIF07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiU3RhcnRlciBraXRjaGVuIiwKICAgICAgbG9jKCJZb3Ugc3RhcnQgd2l0aCA8Yj4lMTwvYj4uIiwgbG9jKCIlMSBncmFuZG1hIiwgNSkpICsKICAgICAgICAiPHE+V2hlcmUgZGlkIHRoZXNlIGNvbWUgZnJvbT88L3E+IiwKICAgICAgNTAwMCwKICAgICAgWzEsIDE0XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJTdGFydGVyIGtpdCJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkhhbG8gZ2xvdmVzIiwKICAgICAgbG9jKCJDbGlja2luZyBpcyA8Yj4lMSU8L2I+IG1vcmUgcG93ZXJmdWwuIiwgMTApICsKICAgICAgICAiPHE+U21pdGUgdGhhdCBjb29raWUuPC9xPiIsCiAgICAgIDU1NTU1LAogICAgICBbMjIsIDddCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIlN0YXJ0ZXIga2l0Il07CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIktpdHRlbiBhbmdlbHMiLAogICAgICBzdHJLaXR0ZW5EZXNjICsgIjxxPkFsbCBjYXRzIGdvIHRvIGhlYXZlbi48L3E+IiwKICAgICAgOTAwMCwKICAgICAgWzIzLCA3XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJEb21pbmlvbnMiXTsKICAgIEdhbWUubGFzdC5raXR0ZW4gPSAxOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJVbmhvbHkgYmFpdCIsCiAgICAgIGxvYygiV3JpbmtsZXJzIGFwcGVhciA8Yj4lMSB0aW1lczwvYj4gYXMgZmFzdC4iLCA1KSArCiAgICAgICAgIjxxPk5vIHdyaW5rbGVyIGNhbiByZXNpc3QgdGhlIHNjZW50IG9mIHdvcm0gYmlzY3VpdHMuPC9xPiIsCiAgICAgIDQ0NDQ0LAogICAgICBbMTUsIDEyXQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJTdGFydGVyIGtpdGNoZW4iXTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTYWNyaWxlZ2lvdXMgY29ycnVwdGlvbiIsCiAgICAgIGxvYygiV3JpbmtsZXJzIGV4cGxvZGUgaW50byA8Yj4lMSUgbW9yZSBjb29raWVzPC9iPi4iLCA1KSArCiAgICAgICAgIjxxPlVuaXF1ZSBpbiB0aGUgYW5pbWFsIGtpbmdkb20sIHRoZSB3cmlua2xlciBkaWdlc3RpdmUgdHJhY3QgaXMgYWJsZSB0byB3aXRoc3RhbmQgYW4gaW5jcmVkaWJsZSBkZWdyZWUgb2YgZGlsYXRpb24gLSBwcm92aWRlZCB5b3UgcHJvZCB0aGVtIGFwcHJvcHJpYXRlbHkuPC9xPiIsCiAgICAgIDQ0NDQ0NCwKICAgICAgWzE5LCA4XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJVbmhvbHkgYmFpdCJdOwoKICAgIG9yZGVyID0gMjAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiWHRyZW1lIHdhbGtlcnMiLAogICAgICAnPHE+Q29tcGxldGUgd2l0aCBmbGFtZSBkZWNhbHMgYW5kIGEgbGl0dGxlIGhvcm4gdGhhdCBnb2VzICJ0b290Ii48L3E+JywKICAgICAgIkdyYW5kbWEiLAogICAgICA3CiAgICApOwogICAgb3JkZXIgPSAzMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJGdWRnZSBmdW5ndXMiLAogICAgICAiPHE+QSBzdWdhcnkgcGFyYXNpdGUgd2hvc2UgdGVuZHJpbHMgaGVscCBjb29raWUgZ3Jvd3RoLjxicj5QbGVhc2UgZG8gbm90IGJyZWF0aGUgaW4gdGhlIHNwb3Jlcy4gSW4gY2FzZSBvZiBzcG9yZSBpbmdlc3Rpb24sIHNlZWsgbWVkaWNhbCBoZWxwIHdpdGhpbiB0aGUgbmV4dCAzNiBzZWNvbmRzLjwvcT4iLAogICAgICAiRmFybSIsCiAgICAgIDcKICAgICk7CiAgICBvcmRlciA9IDQwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlBsYW5ldHNwbGl0dGVycyIsCiAgICAgICI8cT5UaGVzZSBuZXcgc3RhdGUtb2YtdGhlLWFydCBleGNhdmF0b3JzIGhhdmUgYmVlbiB0ZXN0ZWQgb24gTWVydWxhLCBHbG9ib3J0IGFuZCBGbHdhbnphIFZJLCBhbW9uZyBvdGhlciBkaXN0YW50IHBsYW5ldHMgd2hpY2ggaGF2ZSBiZWVuIGN1cmlvdXNseSBxdWlldCBsYXRlbHkuPC9xPiIsCiAgICAgICJNaW5lIiwKICAgICAgNwogICAgKTsKICAgIG9yZGVyID0gNTAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQ3lib3JnIHdvcmtmb3JjZSIsCiAgICAgICI8cT5TZW1pLXN5bnRoZXRpYyBvcmdhbmlzbXMgZG9uJ3Qgc2xhY2sgb2ZmLCBkb24ndCB1bmlvbml6ZSwgYW5kIGhhdmUgMjAlIHNob3J0ZXIgbHVuY2ggYnJlYWtzLCBtYWtpbmcgdGhlbSBpZGVhbCBsYWJvciBmb2RkZXIuPC9xPiIsCiAgICAgICJGYWN0b3J5IiwKICAgICAgNwogICAgKTsKICAgIG9yZGVyID0gNTI1OwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiV2F5IG9mIHRoZSB3YWxsZXQiLAogICAgICAiPHE+VGhpcyBuZXcgbW9uZXRhcnkgc2Nob29sIG9mIHRob3VnaHQgaXMgYWxsIHRoZSByYWdlIG9uIHRoZSBiYW5raW5nIHNjZW5lOyBmb2xsb3cgaXRzIHByZWNlcHRzIGFuZCB5b3UgbWF5IGp1c3QgcHJvZml0IGZyb20gaXQuPC9xPiIsCiAgICAgICJCYW5rIiwKICAgICAgNwogICAgKTsKICAgIG9yZGVyID0gNTUwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQ3JlYXRpb24gbXl0aCIsCiAgICAgICI8cT5TdG9yaWVzIGhhdmUgYmVlbiBjaXJjdWxhdGluZyBhYm91dCB0aGUgb3JpZ2lucyBvZiB0aGUgdmVyeSBmaXJzdCBjb29raWUgdGhhdCB3YXMgZXZlciBiYWtlZDsgdGFsZXMgb2YgaG93IGl0IGFsbCBiZWdhbiwgaW4gdGhlIERvdWdoIGJleW9uZCB0aW1lIGFuZCB0aGUgT3ZlbnMgb2YgZGVzdGlueS48L3E+IiwKICAgICAgIlRlbXBsZSIsCiAgICAgIDcKICAgICk7CiAgICBvcmRlciA9IDU3NTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkNvb2tpZW1hbmN5IiwKICAgICAgIjxxPlRoZXJlIGl0IGlzOyB0aGUgcGVyZmVjdGVkIHNjaG9vbCBvZiBiYWtpbmcgbWFnaWMuIEZyb20gc3VtbW9uaW5nIGNoaXBzIHRvIGhleGluZyBudXRzLCB0aGVyZSBpcyBub3QgYSBzaW5nbGUgcGFydCBvZiBjb29raWUtbWFraW5nIHRoYXQgaGFzbid0IGJlZW4gaW1wcm92ZWQgdGVuZm9sZCBieSBtYWdpYyB0cmlja3MuPC9xPiIsCiAgICAgICJXaXphcmQgdG93ZXIiLAogICAgICA3CiAgICApOwogICAgb3JkZXIgPSA2MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJEeXNvbiBzcGhlcmUiLAogICAgICAiPHE+WW91J3ZlIGZvdW5kIGEgd2F5IHRvIGFwcGx5IHlvdXIga25vd2xlZGdlIG9mIGNvc21pYyB0ZWNobm9sb2d5IHRvIHNsaWdodGx5IG1vcmUgbG9jYWwgZW5kZWF2b3JzOyB0aGlzIGdpZ2FudGljIHNwaGVyZSBvZiBtZXRhLW1hdGVyaWFscywgd3JhcHBpbmcgdGhlIHNvbGFyIHN5c3RlbSwgaXMgc3VyZSB0byBraWNrIHlvdXIgYmFraW5nIGFiaWxpdGllcyB1cCBhIG5vdGNoLjwvcT4iLAogICAgICAiU2hpcG1lbnQiLAogICAgICA3CiAgICApOwogICAgb3JkZXIgPSA3MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJUaGVvcnkgb2YgYXRvbWljIGZsdWlkaXR5IiwKICAgICAgIjxxPlB1c2hpbmcgYWxjaGVteSB0byBpdHMgbW9zdCBleHRyZW1lIGxpbWl0cywgeW91IGZpbmQgdGhhdCBldmVyeXRoaW5nIGlzIHRyYW5zbXV0YWJsZSBpbnRvIGFueXRoaW5nIGVsc2UgLSBsZWFkIHRvIGdvbGQsIG1lcmN1cnkgdG8gd2F0ZXI7IG1vcmUgaW1wb3J0YW50bHksIHlvdSByZWFsaXplIHRoYXQgYW55dGhpbmcgY2FuIC1hbmQgc2hvdWxkLSBiZSBjb252ZXJ0ZWQgdG8gY29va2llcy48L3E+IiwKICAgICAgIkFsY2hlbXkgbGFiIiwKICAgICAgNwogICAgKTsKICAgIG9yZGVyID0gODAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRW5kIG9mIHRpbWVzIGJhY2stdXAgcGxhbiIsCiAgICAgICI8cT5KdXN0IGluIGNhc2UsIGFscmlnaHQ/PC9xPiIsCiAgICAgICJQb3J0YWwiLAogICAgICA3CiAgICApOwogICAgb3JkZXIgPSA5MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJHcmVhdCBsb29wIGh5cG90aGVzaXMiLAogICAgICAiPHE+V2hhdCBpZiBvdXIgdW5pdmVyc2UgaXMganVzdCBvbmUgaW5zdGFuY2Ugb2YgYW4gaW5maW5pdGUgY3ljbGU/IFdoYXQgaWYsIGJlZm9yZSBhbmQgYWZ0ZXIgaXQsIHN0cmV0Y2hlZCBpbmZpbml0ZSBhbW91bnRzIG9mIHRoZSBzYW1lIHVuaXZlcnNlLCB0aGVtc2VsdmVzIGNvbnRhaW5pbmcgaW5maW5pdGUgYW1vdW50cyBvZiBjb29raWVzPzwvcT4iLAogICAgICAiVGltZSBtYWNoaW5lIiwKICAgICAgNwogICAgKTsKICAgIG9yZGVyID0gMTAwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRoZSBQdWxzZSIsCiAgICAgICI8cT5Zb3UndmUgdGFwcGVkIGludG8gdGhlIHZlcnkgcHVsc2Ugb2YgdGhlIGNvc21vcywgYSB0aW1lbGVzcyByaHl0aG0gYWxvbmcgd2hpY2ggZXZlcnkgbWF0ZXJpYWwgYW5kIGFudGltYXRlcmlhbCB0aGluZyBiZWF0cyBpbiB1bmlzb24uIFRoaXMsIHNvbWVob3csIG1lYW5zIG1vcmUgY29va2llcy48L3E+IiwKICAgICAgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwKICAgICAgNwogICAgKTsKICAgIG9yZGVyID0gMTEwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkx1eCBzYW5jdG9ydW0iLAogICAgICAiPHE+WW91ciBwcmlzbSBhdHRlbmRhbnRzIGhhdmUgYmVjb21lIGluY3JlYXNpbmdseSBtZXNtZXJpemVkIHdpdGggc29tZXRoaW5nIGluIHRoZSBsaWdodCAtIG9yIG1heWJlIHNvbWV0aGluZyBiZXlvbmQgaXQ7IGJleW9uZCB1cyBhbGwsIHBlcmhhcHM/PC9xPiIsCiAgICAgICJQcmlzbSIsCiAgICAgIDcKICAgICk7CgogICAgb3JkZXIgPSAyMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJUaGUgVW5icmlkbGluZyIsCiAgICAgICI8cT5JdCBtaWdodCBiZSBhIGNsYXNzaWMgdGFsZSBvZiBiYWQgcGFyZW50aW5nLCBidXQgbGV0J3Mgc2VlIHdoZXJlIGdyYW5kbWEgaXMgZ29pbmcgd2l0aCB0aGlzLjwvcT4iLAogICAgICAiR3JhbmRtYSIsCiAgICAgIDgKICAgICk7CiAgICBvcmRlciA9IDMwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIldoZWF0IHRyaWZmaWRzIiwKICAgICAgIjxxPlRha2luZyBjYXJlIG9mIGNyb3BzIGlzIHNvIG11Y2ggZWFzaWVyIHdoZW4geW91ciBwbGFudHMgY2FuIGp1c3Qgd2FsayBhYm91dCBhbmQgaGVscCBhcm91bmQgdGhlIGZhcm0uPGJyPkRvIG5vdCBwZXQuIERvIG5vdCBmZWVkLiBEbyBub3QgYXR0ZW1wdCB0byBjb252ZXJzZSB3aXRoLjwvcT4iLAogICAgICAiRmFybSIsCiAgICAgIDgKICAgICk7CiAgICBvcmRlciA9IDQwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkNhbm9sYSBvaWwgd2VsbHMiLAogICAgICAiPHE+QSBwcmV2aW91c2x5IHVudGFwcGVkIHJlc291cmNlLCBjYW5vbGEgb2lsIHBlcm1lYXRlcyB0aGUgdW5kZXJncm91bmQgb2xpZmVycyB3aGljaCBncmFudCBpdCBpdHMgcGFydGljdWxhciB0YXN0ZSBhbmQgbHVjcmF0aXZlIHByb3BlcnRpZXMuPC9xPiIsCiAgICAgICJNaW5lIiwKICAgICAgOAogICAgKTsKICAgIG9yZGVyID0gNTAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiNzgtaG91ciBkYXlzIiwKICAgICAgIjxxPldoeSBkaWRuJ3Qgd2UgdGhpbmsgb2YgdGhpcyBlYXJsaWVyPzwvcT4iLAogICAgICAiRmFjdG9yeSIsCiAgICAgIDgKICAgICk7CiAgICBvcmRlciA9IDUyNTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRoZSBzdHVmZiByYXRpb25hbGUiLAogICAgICAiPHE+SWYgbm90IG5vdywgd2hlbj8gSWYgbm90IGl0LCB3aGF0PyBJZiBub3QgdGhpbmdzLi4uIHN0dWZmPzwvcT4iLAogICAgICAiQmFuayIsCiAgICAgIDgKICAgICk7CiAgICBvcmRlciA9IDU1MDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRoZW9jcmFjeSIsCiAgICAgICI8cT5Zb3UndmUgdHVybmVkIHlvdXIgY29va2llIGVtcGlyZSBpbnRvIGEgcGVyZmVjdCB0aGVvY3JhY3ksIGdhdGhlcmluZyB0aGUgYWRvcmF0aW9uIG9mIHppbGxpb25zIG9mIGZvbGxvd2VycyBmcm9tIGV2ZXJ5IGNvcm5lciBvZiB0aGUgdW5pdmVyc2UuPGJyPkRvbid0IGxldCBpdCBnbyB0byB5b3VyIGhlYWQuPC9xPiIsCiAgICAgICJUZW1wbGUiLAogICAgICA4CiAgICApOwogICAgb3JkZXIgPSA1NzU7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJSYWJiaXQgdHJpY2siLAogICAgICAiPHE+VXNpbmcgbm90aGluZyBtb3JlIHRoYW4gYSBmYW5jeSB0b3AgaGF0LCB5b3VyIHdpemFyZHMgaGF2ZSBmb3VuZCBhIHdheSB0byBzaW11bHRhbmVvdXNseSBjdXJiIHJhYmJpdCBwb3B1bGF0aW9uIGFuZCBwcm9kdWNlIGhlYXBzIG9mIGV4dHJhIGNvb2tpZXMgZm9yIGJhc2ljYWxseSBmcmVlITxicj5SZXN1bHRpbmcgY29va2llcyBtYXkgb3IgbWF5IG5vdCBiZSBmaXQgZm9yIHZlZ2Fucy48L3E+IiwKICAgICAgIldpemFyZCB0b3dlciIsCiAgICAgIDgKICAgICk7CiAgICBvcmRlciA9IDYwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRoZSBmaW5hbCBmcm9udGllciIsCiAgICAgICI8cT5JdCdzIGJlZW4gYSBsb25nIHJvYWQsIGdldHRpbmcgZnJvbSB0aGVyZSB0byBoZXJlLiBJdCdzIGFsbCB3b3J0aCBpdCB0aG91Z2ggLSB0aGUgc2lnaHRzIGFyZSBsb3ZlbHkgYW5kIHRoZSBvaWwgcHJpY2VzIHNsaWdodGx5IG1vcmUgcmVhc29uYWJsZS48L3E+IiwKICAgICAgIlNoaXBtZW50IiwKICAgICAgOAogICAgKTsKICAgIG9yZGVyID0gNzAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQmVpZ2UgZ29vIiwKICAgICAgIjxxPldlbGwgbm93IHlvdSd2ZSBkb25lIGl0LiBHb29kIGpvYi4gVmVyeSBuaWNlLiBUaGF0J3MgMyBnYWxheGllcyB5b3UndmUganVzdCBjb252ZXJ0ZWQgaW50byBjb29raWVzLiBHb29kIHRoaW5nIHlvdSBjYW4gaG9wIGZyb20gdW5pdmVyc2UgdG8gdW5pdmVyc2UuPC9xPiIsCiAgICAgICJBbGNoZW15IGxhYiIsCiAgICAgIDgKICAgICk7CiAgICBvcmRlciA9IDgwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIk1hZGRlbmluZyBjaGFudHMiLAogICAgICAiPHE+QSBwb3B1bGFyIHZlcnNlIGdvZXMgbGlrZSBzbyA6IFwiamF1J2huIG1hZGRlbiBqYXUnaG4gbWFkZGVuIGFlaW91YWVpb3VhZWlvdSBicmJyYnJicmJyYnJiclwiPC9xPiIsCiAgICAgICJQb3J0YWwiLAogICAgICA4CiAgICApOwogICAgb3JkZXIgPSA5MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJDb29raWV0b3BpYW4gbW9tZW50cyBvZiBtYXliZSIsCiAgICAgICI8cT5SZW1pbmlzY2luZyBob3cgdGhpbmdzIGNvdWxkIGhhdmUgYmVlbiwgc2hvdWxkIGhhdmUgYmVlbiwgd2lsbCBoYXZlIGJlZW4uPC9xPiIsCiAgICAgICJUaW1lIG1hY2hpbmUiLAogICAgICA4CiAgICApOwogICAgb3JkZXIgPSAxMDAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiU29tZSBvdGhlciBzdXBlci10aW55IGZ1bmRhbWVudGFsIHBhcnRpY2xlPyBQcm9iYWJseT8iLAogICAgICAiPHE+V2hlbiBldmVuIHRoZSB1bml2ZXJzZSBpcyBydW5uaW5nIG91dCBvZiBpZGVhcywgdGhhdCdzIHdoZW4geW91IGtub3cgeW91J3JlIG5lYXJpbmcgdGhlIGVuZC48L3E+IiwKICAgICAgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwKICAgICAgOAogICAgKTsKICAgIG9yZGVyID0gMTEwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlJldmVyc2Ugc2hhZG93cyIsCiAgICAgICI8cT5PaCBtYW4sIHRoaXMgaXMgcmVhbGx5IG1lc3Npbmcgd2l0aCB5b3VyIGV5ZXMuPC9xPiIsCiAgICAgICJQcmlzbSIsCiAgICAgIDgKICAgICk7CgogICAgb3JkZXIgPSAyMDAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJLaXR0ZW4gYWNjb3VudGFudHMiLAogICAgICBzdHJLaXR0ZW5EZXNjICsgIjxxPmJ1c2luZXNzIGdvaW5nIGdyZWF0LCBzaXI8L3E+IiwKICAgICAgOTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwLAogICAgICBHYW1lLkdldEljb24oIktpdHRlbiIsIDYpCiAgICApOwogICAgR2FtZS5sYXN0LmtpdHRlbiA9IDE7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCA2LCAxOCk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiS2l0dGVuIHNwZWNpYWxpc3RzIiwKICAgICAgc3RyS2l0dGVuRGVzYyArICI8cT5vcHRpbWVvd3ppbmcgeW91ciB3b3JrZmxvdyBsaWtlIHdob2FoLCBzaXI8L3E+IiwKICAgICAgOTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwLAogICAgICBHYW1lLkdldEljb24oIktpdHRlbiIsIDcpCiAgICApOwogICAgR2FtZS5sYXN0LmtpdHRlbiA9IDE7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCA3LCAxOCk7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiS2l0dGVuIGV4cGVydHMiLAogICAgICBzdHJLaXR0ZW5EZXNjICsgIjxxPjEwIHllYXJzIGV4cHVycnJ0aXNlIGluIHRoZSBjb29raWUgYnVzaW5lc3MsIHNpcjwvcT4iLAogICAgICA5MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIEdhbWUuR2V0SWNvbigiS2l0dGVuIiwgOCkKICAgICk7CiAgICBHYW1lLmxhc3Qua2l0dGVuID0gMTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDgsIDE4KTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiSG93IHRvIGJha2UgeW91ciBkcmFnb24iLAogICAgICBsb2MoCiAgICAgICAgIkFsbG93cyB5b3UgdG8gcHVyY2hhc2UgYSA8Yj5jcnVtYmx5IGVnZzwvYj4gb25jZSB5b3UgaGF2ZSBlYXJuZWQgMSBtaWxsaW9uIGNvb2tpZXMuIgogICAgICApICsKICAgICAgICAnPHE+QSB0b21lIGZ1bGwgb2YgaGVscGZ1bCB0aXBzIHN1Y2ggYXMgIm9oIGdvZCwgc3RheSBhd2F5IGZyb20gaXQiLCAid2h5IGRpZCB3ZSBidXkgdGhpcyB0aGluZywgaXRcJ3Mgbm90IGV2ZW4gaG91c2UtYnJva2VuIiBhbmQgImdyb29tIHR3aWNlIGEgd2VlayBpbiB0aGUgZGlyZWN0aW9uIG9mIHRoZSBzY2FsZXMiLjwvcT4nLAogICAgICA5LAogICAgICBbMjIsIDEyXQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKCiAgICBvcmRlciA9IDI1MTAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkEgY3J1bWJseSBlZ2ciLAogICAgICBsb2MoIlVubG9ja3MgdGhlIDxiPmNvb2tpZSBkcmFnb24gZWdnPC9iPi4iKSArCiAgICAgICAgIjxxPlRoYW5rIHlvdSBmb3IgYWRvcHRpbmcgdGhpcyByb2J1c3QsIGZ1bi1sb3ZpbmcgY29va2llIGRyYWdvbiEgSXQgd2lsbCBicmluZyB5b3UgeWVhcnMgb2Ygam95IGFuZCBlbnRlcnRhaW5tZW50Ljxicj5LZWVwIGluIGEgZHJ5IGFuZCBjb29sIHBsYWNlLCBhbmQgYXdheSBmcm9tIG90aGVyIGhvdXNlIHBldHMuIFN1YnNjcmlwdGlvbiB0byBob21lIGluc3VyYW5jZSBpcyBzdHJvbmdseSBhZHZpc2VkLjwvcT4iLAogICAgICAyNSwKICAgICAgWzIxLCAxMl0KICAgICk7CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkNoaW1lcmEiLAogICAgICBsb2MoIlN5bmVyZ3kgdXBncmFkZXMgYXJlIDxiPiUxJSBjaGVhcGVyPC9iPi4iLCAyKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoCiAgICAgICAgICAiWW91IGdhaW4gYW5vdGhlciA8Yj4rJTElPC9iPiBvZiB5b3VyIHJlZ3VsYXIgQ3BTIHdoaWxlIHRoZSBnYW1lIGlzIGNsb3NlZC4iLAogICAgICAgICAgNQogICAgICAgICkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKAogICAgICAgICAgIllvdSByZXRhaW4gb3B0aW1hbCBjb29raWUgcHJvZHVjdGlvbiB3aGlsZSB0aGUgZ2FtZSBpcyBjbG9zZWQgZm9yIDxiPiUxIG1vcmUgZGF5czwvYj4uIiwKICAgICAgICAgIDIKICAgICAgICApICsKICAgICAgICAiPHE+TW9yZSB0aGFuIHRoZSBzdW0gb2YgaXRzIHBhcnRzLjwvcT4iLAogICAgICBNYXRoLnBvdyhhbmdlbFByaWNlRmFjdG9yLCA5KSwKICAgICAgWzI0LCA3XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJHb2QiLCAiTHVjaWZlciIsICJTeW5lcmdpZXMgVm9sLiBJSSJdOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJUaW4gb2YgYnV0dGVyIGNvb2tpZXMiLAogICAgICBsb2MoIkNvbnRhaW5zIGFuIGFzc29ydG1lbnQgb2YgcmljaCBidXR0ZXIgY29va2llcy4iKSArCiAgICAgICAgIjxxPkZpdmUgdmFyaWV0aWVzIG9mIGRhbmlzaCBjb29raWVzLjxicj5Db21wbGV0ZSB3aXRoIGxpdHRsZSBwYXBlciBjdXBzLjwvcT4iLAogICAgICAyNSwKICAgICAgWzIxLCA5XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJIZWF2ZW5seSBjb29raWVzIl07CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkdvbGRlbiBzd2l0Y2giLAogICAgICBsb2MoCiAgICAgICAgIlVubG9ja3MgdGhlIDxiPmdvbGRlbiBzd2l0Y2g8L2I+LCB3aGljaCBwYXNzaXZlbHkgYm9vc3RzIHlvdXIgQ3BTIGJ5ICUxJSBidXQgZGlzYWJsZXMgZ29sZGVuIGNvb2tpZXMuIiwKICAgICAgICA1MAogICAgICApICsgIjxxPkxlc3MgY2xpY2tpbmcsIG1vcmUgaWRsaW5nLjwvcT4iLAogICAgICA5OTksCiAgICAgIFsyMSwgMTBdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkhlYXZlbmx5IGx1Y2siXTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQ2xhc3NpYyBkYWlyeSBzZWxlY3Rpb24iLAogICAgICBsb2MoCiAgICAgICAgIlVubG9ja3MgdGhlIDxiPm1pbGsgc2VsZWN0b3I8L2I+LCBsZXR0aW5nIHlvdSBwaWNrIHdoaWNoIG1pbGsgaXMgZGlzcGxheWVkIHVuZGVyIHlvdXIgY29va2llLjxicj5Db21lcyB3aXRoIGEgdmFyaWV0eSBvZiBiYXNpYyBmbGF2b3JzLiIKICAgICAgKSArICI8cT5Eb24ndCBoYXZlIGEgY293LCBtYW4uPC9xPiIsCiAgICAgIDksCiAgICAgIFsxLCA4XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gW107CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkZhbmNpZnVsIGRhaXJ5IHNlbGVjdGlvbiIsCiAgICAgIGxvYygiQ29udGFpbnMgbW9yZSBleG90aWMgZmxhdm9ycyBmb3IgeW91ciBtaWxrIHNlbGVjdG9yLiIpICsKICAgICAgICAiPHE+U3Ryb25nIGJvbmVzIGZvciB0aGUgc2tlbGV0b24gYXJteS48L3E+IiwKICAgICAgMTAwMDAwMCwKICAgICAgWzksIDddCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkNsYXNzaWMgZGFpcnkgc2VsZWN0aW9uIl07CgogICAgb3JkZXIgPSAxMDMwMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJEcmFnb24gY29va2llIiwKICAgICAgZGVzYzogIkltYnVlZCB3aXRoIHRoZSB2aWdvciBhbmQgdml0YWxpdHkgb2YgYSBmdWxsLWdyb3duIGNvb2tpZSBkcmFnb24sIHRoaXMgbXlzdGljYWwgY29va2llIHdpbGwgZW1ib2xkZW4geW91ciBlbXBpcmUgZm9yIHRoZSBnZW5lcmF0aW9ucyB0byBjb21lLiIsCiAgICAgIGljb246IFsxMCwgMjVdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTkgKiA3LAogICAgICBsb2NrZWQ6IDEsCiAgICB9KTsKCiAgICBvcmRlciA9IDQwMDAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkdvbGRlbiBzd2l0Y2ggW29mZl0iLAogICAgICBsb2MoCiAgICAgICAgIlR1cm5pbmcgdGhpcyBvbiB3aWxsIGdpdmUgeW91IGEgcGFzc2l2ZSA8Yj4rJTElIENwUzwvYj4sIGJ1dCBwcmV2ZW50cyBnb2xkZW4gY29va2llcyBmcm9tIHNwYXduaW5nLjxicj5Db3N0IGlzIGVxdWFsIHRvIDEgaG91ciBvZiBwcm9kdWN0aW9uLiIsCiAgICAgICAgNTAKICAgICAgKSwKICAgICAgMTAwMDAwMCwKICAgICAgWzIwLCAxMF0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJ0b2dnbGUiOwogICAgR2FtZS5sYXN0LnRvZ2dsZUludG8gPSAiR29sZGVuIHN3aXRjaCBbb25dIjsKICAgIEdhbWUubGFzdC5wcmljZUZ1bmMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBHYW1lLmNvb2tpZXNQcyAqIDYwICogNjA7CiAgICB9OwogICAgdmFyIGZ1bmMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChHYW1lLkhhcygiUmVzaWR1YWwgbHVjayIpKSB7CiAgICAgICAgdmFyIGJvbnVzID0gMDsKICAgICAgICB2YXIgdXBncmFkZXMgPSBHYW1lLmdvbGRlbkNvb2tpZVVwZ3JhZGVzOwogICAgICAgIGZvciAodmFyIGkgaW4gdXBncmFkZXMpIHsKICAgICAgICAgIGlmIChHYW1lLkhhcyh1cGdyYWRlc1tpXSkpIGJvbnVzKys7CiAgICAgICAgfQogICAgICAgIHJldHVybiAoCiAgICAgICAgICAnPGRpdiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7Ij4nICsKICAgICAgICAgIEdhbWUubGlzdFRpbnlPd25lZFVwZ3JhZGVzKEdhbWUuZ29sZGVuQ29va2llVXBncmFkZXMpICsKICAgICAgICAgICI8YnI+PGJyPlRoZSBlZmZlY3RpdmUgYm9vc3QgaXMgPGI+KyIgKwogICAgICAgICAgQmVhdXRpZnkoTWF0aC5yb3VuZCg1MCArIGJvbnVzICogMTApKSArCiAgICAgICAgICAiJTwvYj48YnI+dGhhbmtzIHRvIHJlc2lkdWFsIGx1Y2s8YnI+YW5kIHlvdXIgPGI+IiArCiAgICAgICAgICBib251cyArCiAgICAgICAgICAiPC9iPiBnb2xkZW4gY29va2llIHVwZ3JhZGUiICsKICAgICAgICAgIChib251cyA9PSAxID8gIiIgOiAicyIpICsKICAgICAgICAgICcuPC9kaXY+PGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgICB0aGlzLmRkZXNjCiAgICAgICAgKTsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5kZXNjOwogICAgfTsKICAgIGlmIChFTikgR2FtZS5sYXN0LmRlc2NGdW5jID0gZnVuYzsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiR29sZGVuIHN3aXRjaCBbb25dIiwKICAgICAgbG9jKAogICAgICAgICJUaGUgc3dpdGNoIGlzIGN1cnJlbnRseSBnaXZpbmcgeW91IGEgcGFzc2l2ZSA8Yj4rJTElIENwUzwvYj47IGl0IGFsc28gcHJldmVudHMgZ29sZGVuIGNvb2tpZXMgZnJvbSBzcGF3bmluZy48YnI+VHVybmluZyBpdCBvZmYgd2lsbCByZXZlcnQgdGhvc2UgZWZmZWN0cy48YnI+Q29zdCBpcyBlcXVhbCB0byAxIGhvdXIgb2YgcHJvZHVjdGlvbi4iLAogICAgICAgIDUwCiAgICAgICksCiAgICAgIDEwMDAwMDAsCiAgICAgIFsyMSwgMTBdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAidG9nZ2xlIjsKICAgIEdhbWUubGFzdC50b2dnbGVJbnRvID0gIkdvbGRlbiBzd2l0Y2ggW29mZl0iOwogICAgR2FtZS5sYXN0LnByaWNlRnVuYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIEdhbWUuY29va2llc1BzICogNjAgKiA2MDsKICAgIH07CiAgICBHYW1lLmxhc3QuZGVzY0Z1bmMgPSBmdW5jOwoKICAgIG9yZGVyID0gNTAwMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiTWlsayBzZWxlY3RvciIsCiAgICAgIGxvYygiTGV0cyB5b3UgcGljayB3aGF0IGZsYXZvciBvZiBtaWxrIHRvIGRpc3BsYXkuIiksCiAgICAgIDAsCiAgICAgIFsxLCA4XQogICAgKTsKICAgIEdhbWUubGFzdC5kZXNjRnVuYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGNob2ljZSA9IHRoaXMuY2hvaWNlc0Z1bmN0aW9uKClbR2FtZS5taWxrVHlwZV07CiAgICAgIGlmICghY2hvaWNlKSBjaG9pY2UgPSB0aGlzLmNob2ljZXNGdW5jdGlvbigpWzBdOwogICAgICByZXR1cm4gKAogICAgICAgICc8ZGl2IHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsiPicgKwogICAgICAgIGxvYygiQ3VycmVudDoiKSArCiAgICAgICAgIiAiICsKICAgICAgICB0aW55SWNvbihjaG9pY2UuaWNvbikgKwogICAgICAgICIgPGI+IiArCiAgICAgICAgY2hvaWNlLm5hbWUgKwogICAgICAgICc8L2I+PC9kaXY+PGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgdGhpcy5kZGVzYwogICAgICApOwogICAgfTsKCiAgICBHYW1lLmxhc3QucG9vbCA9ICJ0b2dnbGUiOwogICAgR2FtZS5sYXN0LmNob2ljZXNGdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHJhbmsgPSAwOwogICAgICB2YXIgY2hvaWNlcyA9IFtdOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBHYW1lLkFsbE1pbGtzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIGl0ID0gR2FtZS5BbGxNaWxrc1tpXTsKICAgICAgICBjaG9pY2VzLnB1c2goewogICAgICAgICAgbmFtZTogaXQubmFtZSwKICAgICAgICAgIGljb246IGl0Lmljb24sCiAgICAgICAgICBtaWxrOiBpdCwKICAgICAgICAgIG9yZGVyOiBpdC50eXBlLAogICAgICAgIH0pOwogICAgICB9CgogICAgICBjaG9pY2VzWzExXS5kaXYgPSB0cnVlOwoKICAgICAgdmFyIG1heFJhbmsgPSBNYXRoLmZsb29yKEdhbWUuQWNoaWV2ZW1lbnRzT3duZWQgLyAyNSk7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hvaWNlcy5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciBpdCA9IGNob2ljZXNbaV0ubWlsazsKICAgICAgICBpZiAoaXQudHlwZSA9PSAxICYmICFHYW1lLkhhcygiRmFuY2lmdWwgZGFpcnkgc2VsZWN0aW9uIikpCiAgICAgICAgICBjaG9pY2VzW2ldID0gMDsKICAgICAgICBpZiAoaXQucmFuayAmJiBpdC5yYW5rID4gbWF4UmFuaykgY2hvaWNlc1tpXSA9IDA7CiAgICAgIH0KCiAgICAgIGNob2ljZXNbR2FtZS5taWxrVHlwZV0uc2VsZWN0ZWQgPSAxOwogICAgICByZXR1cm4gY2hvaWNlczsKICAgIH07CiAgICBHYW1lLmxhc3QuY2hvaWNlc1BpY2sgPSBmdW5jdGlvbiAoaWQpIHsKICAgICAgR2FtZS5taWxrVHlwZSA9IGlkOwogICAgfTsKCiAgICBvcmRlciA9IDEwMzAwOwogICAgdmFyIGJ1dHRlckJpc2N1aXRNdWx0ID0gMTAwMDAwMDAwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIk1pbGsgY2hvY29sYXRlIGJ1dHRlciBiaXNjdWl0IiwKICAgICAgZGVzYzogIlJld2FyZGVkIGZvciBvd25pbmcgMTAwIG9mIGV2ZXJ5dGhpbmcuPGJyPkl0IGJlYXJzIHRoZSBlbmdyYXZpbmcgb2YgYSBmaW5lIGVudHJlcHJlbmV1ci4iLAogICAgICBpY29uOiBbMjcsIDhdLAogICAgICBwb3dlcjogMTAsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiBidXR0ZXJCaXNjdWl0TXVsdCwKICAgICAgbG9ja2VkOiAxLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiRGFyayBjaG9jb2xhdGUgYnV0dGVyIGJpc2N1aXQiLAogICAgICBkZXNjOiAiUmV3YXJkZWQgZm9yIG93bmluZyAxNTAgb2YgZXZlcnl0aGluZy48YnI+SXQgaXMgYWRvcm5lZCB3aXRoIHRoZSBpbWFnZSBvZiBhbiBleHBlcmllbmNlZCBjb29raWUgdHljb29uLiIsCiAgICAgIGljb246IFsyNywgOV0sCiAgICAgIHBvd2VyOiAxMCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSAqIGJ1dHRlckJpc2N1aXRNdWx0LAogICAgICBsb2NrZWQ6IDEsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJXaGl0ZSBjaG9jb2xhdGUgYnV0dGVyIGJpc2N1aXQiLAogICAgICBkZXNjOiAiUmV3YXJkZWQgZm9yIG93bmluZyAyMDAgb2YgZXZlcnl0aGluZy48YnI+VGhlIGNob2NvbGF0ZSBpcyBjaGlzZWxlZCB0byBkZXBpY3QgYSBtYXN0ZXJmdWwgcGFzdHJ5IG1hZ25hdGUuIiwKICAgICAgaWNvbjogWzI4LCA5XSwKICAgICAgcG93ZXI6IDEwLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogYnV0dGVyQmlzY3VpdE11bHQsCiAgICAgIGxvY2tlZDogMSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlJ1YnkgY2hvY29sYXRlIGJ1dHRlciBiaXNjdWl0IiwKICAgICAgZGVzYzogIlJld2FyZGVkIGZvciBvd25pbmcgMjUwIG9mIGV2ZXJ5dGhpbmcuPGJyPkNvdmVyZWQgaW4gYSByYXJlIHJlZCBjaG9jb2xhdGUsIHRoaXMgYmlzY3VpdCBpcyBldGNoZWQgdG8gcmVwcmVzZW50IHRoZSBmYWNlIG9mIGEgY29va2llIGluZHVzdHJpYWxpc3QgZ29uZSBtYWQgd2l0aCBwb3dlci4iLAogICAgICBpY29uOiBbMjgsIDhdLAogICAgICBwb3dlcjogMTAsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiBidXR0ZXJCaXNjdWl0TXVsdCwKICAgICAgbG9ja2VkOiAxLAogICAgfSk7CgogICAgb3JkZXIgPSAxMDAyMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJHaW5nZXJzbmFwcyIsCiAgICAgIGRlc2M6ICJDb29raWVzIHdpdGggYSBzb3VsLiBQcm9iYWJseS4iLAogICAgICBpY29uOiBbMjksIDEwXSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkNpbm5hbW9uIGNvb2tpZXMiLAogICAgICBkZXNjOiAiVGhlIHNlY3JldCBpcyBpbiB0aGUgcGF0ZW50ZWQgc3dpcmx5IGdsYXppbmcuIiwKICAgICAgaWNvbjogWzIzLCA4XSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OSAqIDUsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJWYW5pdHkgY29va2llcyIsCiAgICAgIGRlc2M6ICJPbmUgdGlueSBjYW5kaWVkIGZydWl0IHNpdHMgYXRvcCB0aGlzIGRlY2FkZW50IGNvb2tpZS4iLAogICAgICBpY29uOiBbMjIsIDhdLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkNpZ2FycyIsCiAgICAgIGRlc2M6ICJDbG9zZSwgYnV0IG5vIG1hdGNoIGZvciB0aG9zZSBleHRyYXZhZ2FudCBjb29raWUgc3RyYXdzIHRoZXkgc2VydmUgaW4gY29mZmVlIHNob3BzIHRoZXNlIGRheXMuIiwKICAgICAgaWNvbjogWzI1LCA4XSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiUGlud2hlZWwgY29va2llcyIsCiAgICAgIGRlc2M6ICJCcmluZ2luZyB5b3UgdGhlIGRpenp5aW5nIGNvbWJpbmF0aW9uIG9mIGJyb3duIGZsYXZvciBhbmQgYmVpZ2UgdGFzdGUhIiwKICAgICAgaWNvbjogWzIyLCAxMF0sCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkZ1ZGdlIHNxdWFyZXMiLAogICAgICBkZXNjOiAiTm90IGV4YWN0bHkgY29va2llcywgYnV0IHlvdSB3b24ndCBjYXJlIG9uY2UgeW91J3ZlIHRhc3RlZCBvbmUgb2YgdGhlc2UuPGJyPlRoZXkncmUgc28gZ29vZCwgaXQncyBmdWRnZWQtdXAhIiwKICAgICAgaWNvbjogWzI0LCA4XSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwoKICAgIG9yZGVyID0gMTAwMzA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiRGlnaXRzIiwKICAgICAgZGVzYzogIlRocmVlIGZsYXZvcnMsIHplcm8gcGhhbGFuZ2VzLiIsCiAgICAgIGljb246IFsyNiwgOF0sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgYnJhbmQgYmlzY3VpdHMiLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OSAqIDUsCiAgICB9KTsKCiAgICBvcmRlciA9IDEwMDI5OwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkJ1dHRlciBob3JzZXNob2VzIiwKICAgICAgZGVzYzogIkl0IHdvdWxkIGJlaG9vdmUgeW91IHRvIG5vdCBvdmVyaW5kdWxnZSBpbiB0aGVzZS4iLAogICAgICBpY29uOiBbMjIsIDldLAogICAgICByZXF1aXJlOiAiVGluIG9mIGJ1dHRlciBjb29raWVzIiwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkJ1dHRlciBwdWNrcyIsCiAgICAgIGRlc2M6ICJMb3JkLCB3aGF0IGZvb2xzIHRoZXNlIG1vcnRhbHMgYmUhPGJyPihUaGlzIGlzIGtpbmQgb2YgYSBob2tleSByZWZlcmVuY2UuKSIsCiAgICAgIGljb246IFsyMywgOV0sCiAgICAgIHJlcXVpcmU6ICJUaW4gb2YgYnV0dGVyIGNvb2tpZXMiLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkJ1dHRlciBrbm90cyIsCiAgICAgIGRlc2M6ICJMb29rLCB5b3UgY2FuIGNhbGwgdGhlc2UgcHJldHplbHMgaWYgeW91IHdhbnQsIGJ1dCB5b3UnZCBqdXN0IGJlIGZvb2xpbmcgeW91cnNlbGYsIHdvdWxkbid0IHlvdT8iLAogICAgICBpY29uOiBbMjQsIDldLAogICAgICByZXF1aXJlOiAiVGluIG9mIGJ1dHRlciBjb29raWVzIiwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJCdXR0ZXIgc2xhYnMiLAogICAgICBkZXNjOiAiTm90aGluZyBidXR0ZXIgdGhhbiBhIHNsYWIgdG8gdGhlIGZhY2UuIiwKICAgICAgaWNvbjogWzI1LCA5XSwKICAgICAgcmVxdWlyZTogIlRpbiBvZiBidXR0ZXIgY29va2llcyIsCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkJ1dHRlciBzd2lybHMiLAogICAgICBkZXNjOiAiVGhlc2UgYXJlIGVxdWFsIHBhcnRzIHN1Z2FyLCBidXR0ZXIsIGFuZCB3YXJtIGZ1enp5IGZlZWxpbmdzIC0gYWxsIG9mIHdoaWNoIGNhdXNlIG1pbGxpb25zIG9mIGRlYXRocyBldmVyeSBkYXkuIiwKICAgICAgaWNvbjogWzI2LCA5XSwKICAgICAgcmVxdWlyZTogIlRpbiBvZiBidXR0ZXIgY29va2llcyIsCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwoKICAgIG9yZGVyID0gMTAwMjA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiU2hvcnRicmVhZCBiaXNjdWl0cyIsCiAgICAgIGRlc2M6ICJUaGVzZSByaWNoIGJ1dHRlciBjb29raWVzIGFyZSBuZWl0aGVyIHNob3J0LCBub3IgYnJlYWQuIFdoYXQgYSBjb3VudHJ5ISIsCiAgICAgIGljb246IFsyMywgMTBdLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiTWlsbGlvbmFpcmVzJyBzaG9ydGJyZWFkcyIsCiAgICAgIGRlc2M6ICJUaHJlZSB0aG91Z2h0LXByb3Zva2luZyBsYXllcnMgb2YgY3JlYW15IGNob2NvbGF0ZSwgaGFyZC13b3JraW5nIGNhcmFtZWwgYW5kIGNydW1ibHkgYmlzY3VpdCBpbiBhIHBvaWduYW50IGNvbW1lbnRhcnkgb2YgY2xhc3Mgc3RydWdnbGUuIiwKICAgICAgaWNvbjogWzI0LCAxMF0sCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQ2FyYW1lbCBjb29raWVzIiwKICAgICAgZGVzYzogIlRoZSBwb2x5bWVyaXplZCBjYXJib2h5ZHJhdGVzIGFkb3JuaW5nIHRoZXNlIGNvb2tpZXMgYXJlIHN1cmUgdG8gc3RpY2sgdG8geW91ciB0ZWV0aCBmb3IgcXVpdGUgYSB3aGlsZS4iLAogICAgICBpY29uOiBbMjUsIDEwXSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKCiAgICB2YXIgZGVzYyA9IGZ1bmN0aW9uICh0b3RhbEhvdXJzKSB7CiAgICAgIHJldHVybiBsb2MoCiAgICAgICAgIllvdSByZXRhaW4gb3B0aW1hbCBjb29raWUgcHJvZHVjdGlvbiB3aGlsZSB0aGUgZ2FtZSBpcyBjbG9zZWQgZm9yIHR3aWNlIGFzIGxvbmcsIGZvciBhIHRvdGFsIG9mIDxiPiUxPC9iPi4iLAogICAgICAgIEdhbWUuc2F5VGltZSh0b3RhbEhvdXJzICogNjAgKiA2MCAqIEdhbWUuZnBzLCAtMSkKICAgICAgKTsKICAgIH07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQmVscGhlZ29yIiwKICAgICAgZGVzYygyKSArCiAgICAgICAgIjxxPkEgZGVtb24gb2Ygc2hvcnRjdXRzIGFuZCBsYXppbmVzcywgQmVscGhlZ29yIGNvbW1hbmRzIG1hY2hpbmVzIHRvIGRvIHdvcmsgaW4gaGlzIHN0ZWFkLjwvcT4iLAogICAgICBNYXRoLnBvdyhhbmdlbFByaWNlRmFjdG9yLCAxKSwKICAgICAgWzcsIDExXQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJUd2luIEdhdGVzIG9mIFRyYW5zY2VuZGVuY2UiXTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJNYW1tb24iLAogICAgICBkZXNjKDQpICsKICAgICAgICAiPHE+VGhlIGRlbW9uaWMgZW1ib2RpbWVudCBvZiB3ZWFsdGgsIE1hbW1vbiByZXF1ZXN0cyBhIHRpdGhlIG9mIGJsb29kIGFuZCBnb2xkIGZyb20gYWxsIGhpcyB3b3JzaGlwcGVycy48L3E+IiwKICAgICAgTWF0aC5wb3coYW5nZWxQcmljZUZhY3RvciwgMiksCiAgICAgIFs4LCAxMV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiQmVscGhlZ29yIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQWJhZGRvbiIsCiAgICAgIGRlc2MoOCkgKwogICAgICAgICI8cT5NYXN0ZXIgb2Ygb3ZlcmluZHVsZ2VuY2UsIEFiYWRkb24gZ292ZXJucyB0aGUgd3JpbmtsZXIgYnJvb2QgYW5kIGluc3BpcmVzIHRoZWlyIGluc2F0aWFiaWxpdHkuPC9xPiIsCiAgICAgIE1hdGgucG93KGFuZ2VsUHJpY2VGYWN0b3IsIDMpLAogICAgICBbOSwgMTFdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIk1hbW1vbiJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlNhdGFuIiwKICAgICAgZGVzYygxNikgKwogICAgICAgICI8cT5UaGUgY291bnRlcnBvaW50IHRvIGV2ZXJ5dGhpbmcgcmlnaHRlb3VzLCB0aGlzIGRlbW9uIHJlcHJlc2VudHMgdGhlIG5lZmFyaW91cyBpbmZsdWVuY2Ugb2YgZGVjZWl0IGFuZCB0ZW1wdGF0aW9uLjwvcT4iLAogICAgICBNYXRoLnBvdyhhbmdlbFByaWNlRmFjdG9yLCA0KSwKICAgICAgWzEwLCAxMV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiQWJhZGRvbiJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkFzbW9kZXVzIiwKICAgICAgZGVzYygzMikgKwogICAgICAgICI8cT5UaGlzIGRlbW9uIHdpdGggdGhyZWUgbW9uc3Ryb3VzIGhlYWRzIGRyYXdzIGhpcyBwb3dlciBmcm9tIHRoZSBhbGwtY29uc3VtaW5nIGRlc2lyZSBmb3IgY29va2llcyBhbmQgYWxsIHRoaW5ncyBzd2VldC48L3E+IiwKICAgICAgTWF0aC5wb3coYW5nZWxQcmljZUZhY3RvciwgNSksCiAgICAgIFsxMSwgMTFdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIlNhdGFuIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQmVlbHplYnViIiwKICAgICAgZGVzYyg2NCkgKwogICAgICAgICI8cT5UaGUgZmVzdGVyaW5nIGluY2FybmF0aW9uIG9mIGJsaWdodCBhbmQgZGlzZWFzZSwgQmVlbHplYnViIHJ1bGVzIG92ZXIgdGhlIHZhc3QgYXJtaWVzIG9mIHBhc3RyeSBpbmZlcm5vLjwvcT4iLAogICAgICBNYXRoLnBvdyhhbmdlbFByaWNlRmFjdG9yLCA2KSwKICAgICAgWzEyLCAxMV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiQXNtb2RldXMiXTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJMdWNpZmVyIiwKICAgICAgZGVzYygxMjgpICsKICAgICAgICAiPHE+QWxzbyBrbm93biBhcyB0aGUgTGlnaHRicmluZ2VyLCB0aGlzIGluZmVybmFsIHByaW5jZSdzIHRyZW1lbmRvdXMgZWdvIGNhdXNlZCBoaW0gdG8gYmUgY2FzdCBkb3duIGZyb20gcGFzdHJ5IGhlYXZlbi48L3E+IiwKICAgICAgTWF0aC5wb3coYW5nZWxQcmljZUZhY3RvciwgNyksCiAgICAgIFsxMywgMTFdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkJlZWx6ZWJ1YiJdOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJHb2xkZW4gY29va2llIGFsZXJ0IHNvdW5kIiwKICAgICAgbG9jKAogICAgICAgICJVbmxvY2tzIHRoZSA8Yj5nb2xkZW4gY29va2llIHNvdW5kIHNlbGVjdG9yPC9iPiwgd2hpY2ggbGV0cyB5b3UgcGljayB3aGV0aGVyIGdvbGRlbiBjb29raWVzIGVtaXQgYSBzb3VuZCB3aGVuIGFwcGVhcmluZyBvciBub3QuIgogICAgICApICsgIjxxPkEgc291bmQgZGVjaXNpb24uPC9xPiIsCiAgICAgIDk5OTk5OSwKICAgICAgWzI4LCA2XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJSZXNpZHVhbCBsdWNrIl07CgogICAgb3JkZXIgPSA0OTkwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJHb2xkZW4gY29va2llIHNvdW5kIHNlbGVjdG9yIiwKICAgICAgbG9jKCJMZXRzIHlvdSBjaGFuZ2UgdGhlIHNvdW5kIGdvbGRlbiBjb29raWVzIG1ha2Ugd2hlbiB0aGV5IHNwYXduLiIpLAogICAgICAwLAogICAgICBbMjgsIDZdCiAgICApOwogICAgR2FtZS5sYXN0LmRlc2NGdW5jID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgY2hvaWNlID0gdGhpcy5jaG9pY2VzRnVuY3Rpb24oKVtHYW1lLmNoaW1lVHlwZV07CiAgICAgIHJldHVybiAoCiAgICAgICAgJzxkaXYgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyI+JyArCiAgICAgICAgbG9jKCJDdXJyZW50OiIpICsKICAgICAgICAiICIgKwogICAgICAgIHRpbnlJY29uKGNob2ljZS5pY29uKSArCiAgICAgICAgIiA8Yj4iICsKICAgICAgICBjaG9pY2UubmFtZSArCiAgICAgICAgJzwvYj48L2Rpdj48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICB0aGlzLmRkZXNjCiAgICAgICk7CiAgICB9OwoKICAgIEdhbWUubGFzdC5wb29sID0gInRvZ2dsZSI7CiAgICBHYW1lLmxhc3QuY2hvaWNlc0Z1bmN0aW9uID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgY2hvaWNlcyA9IFtdOwogICAgICBjaG9pY2VzWzBdID0geyBuYW1lOiAiTm8gc291bmQiLCBpY29uOiBbMCwgN10gfTsKICAgICAgY2hvaWNlc1sxXSA9IHsgbmFtZTogIkNoaW1lIiwgaWNvbjogWzIyLCA2XSB9OwogICAgICBjaG9pY2VzWzJdID0geyBuYW1lOiAiRm9ydHVuZSIsIGljb246IFsyNywgNl0gfTsKICAgICAgY2hvaWNlc1szXSA9IHsgbmFtZTogIkN5bWJhbCIsIGljb246IFs5LCAxMF0gfTsKICAgICAgY2hvaWNlc1s0XSA9IHsgbmFtZTogIlNxdWVhayIsIGljb246IFs4LCAxMF0gfTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaG9pY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY2hvaWNlc1tpXS5uYW1lID0gbG9jKGNob2ljZXNbaV0ubmFtZSk7CiAgICAgIH0KCiAgICAgIGNob2ljZXNbR2FtZS5jaGltZVR5cGVdLnNlbGVjdGVkID0gMTsKICAgICAgcmV0dXJuIGNob2ljZXM7CiAgICB9OwogICAgR2FtZS5sYXN0LmNob2ljZXNQaWNrID0gZnVuY3Rpb24gKGlkKSB7CiAgICAgIEdhbWUuY2hpbWVUeXBlID0gaWQ7CiAgICAgIEdhbWUucGxheUdvbGRlbkNvb2tpZUNoaW1lKCk7CiAgICB9OwogICAgR2FtZS5wbGF5R29sZGVuQ29va2llQ2hpbWUgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChHYW1lLmNoaW1lVHlwZSA9PSAxKSBQbGF5U291bmQoInNuZC9jaGltZS5tcDMiKTsKICAgICAgZWxzZSBpZiAoR2FtZS5jaGltZVR5cGUgPT0gMikgUGxheVNvdW5kKCJzbmQvZm9ydHVuZS5tcDMiKTsKICAgICAgZWxzZSBpZiAoR2FtZS5jaGltZVR5cGUgPT0gMykgUGxheVNvdW5kKCJzbmQvY3ltYmFsUmV2Lm1wMyIpOwogICAgICBlbHNlIGlmIChHYW1lLmNoaW1lVHlwZSA9PSA0KSB7CiAgICAgICAgR2FtZS53cmlua2xlclNxdWlzaFNvdW5kKys7CiAgICAgICAgaWYgKEdhbWUud3JpbmtsZXJTcXVpc2hTb3VuZCA+IDQpIHsKICAgICAgICAgIEdhbWUud3JpbmtsZXJTcXVpc2hTb3VuZCAtPSA0OwogICAgICAgIH0KICAgICAgICBQbGF5U291bmQoInNuZC9zcXVlYWsiICsgR2FtZS53cmlua2xlclNxdWlzaFNvdW5kICsgIi5tcDMiKTsKICAgICAgfQogICAgfTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQmFzaWMgd2FsbHBhcGVyIGFzc29ydG1lbnQiLAogICAgICBsb2MoCiAgICAgICAgIlVubG9ja3MgdGhlIDxiPmJhY2tncm91bmQgc2VsZWN0b3I8L2I+LCBsZXR0aW5nIHlvdSBzZWxlY3QgdGhlIGdhbWUncyBiYWNrZ3JvdW5kLjxicj5Db21lcyB3aXRoIGEgdmFyaWV0eSBvZiBiYXNpYyBmbGF2b3JzLiIKICAgICAgKSArCiAgICAgICAgIjxxPlByaW9yaXRpemluZyBhZXN0aGV0aWNzIG92ZXIgY3J1Y2lhbCB1dGlsaXRhcmlhbiB1cGdyYWRlcz8gQ29sb3IgbWUgaW1wcmVzc2VkLjwvcT4iLAogICAgICA5OSwKICAgICAgWzI5LCA1XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJDbGFzc2ljIGRhaXJ5IHNlbGVjdGlvbiJdOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJMZWdhY3kiLAogICAgICBsb2MoCiAgICAgICAgJ1RoaXMgaXMgdGhlIGZpcnN0IGhlYXZlbmx5IHVwZ3JhZGU7IGl0IHVubG9ja3MgdGhlIDxiPkhlYXZlbmx5IGNoaXBzPC9iPiBzeXN0ZW0uPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+RWFjaCB0aW1lIHlvdSBhc2NlbmQsIHRoZSBjb29raWVzIHlvdSBtYWRlIGluIHlvdXIgcGFzdCBsaWZlIGFyZSB0dXJuZWQgaW50byA8Yj5oZWF2ZW5seSBjaGlwczwvYj4gYW5kIDxiPnByZXN0aWdlPC9iPi48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj48Yj5IZWF2ZW5seSBjaGlwczwvYj4gY2FuIGJlIHNwZW50IG9uIGEgdmFyaWV0eSBvZiBwZXJtYW5lbnQgdHJhbnNjZW5kZW50YWwgdXBncmFkZXMuPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+WW91ciA8Yj5wcmVzdGlnZSBsZXZlbDwvYj4gYWxzbyBnaXZlcyB5b3UgYSBwZXJtYW5lbnQgPGI+KzElIENwUzwvYj4gcGVyIGxldmVsLicKICAgICAgKSArICI8cT5XZSd2ZSBhbGwgYmVlbiB3YWl0aW5nIGZvciB5b3UuPC9xPiIsCiAgICAgIDEsCiAgICAgIFsyMSwgNl0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFtdOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJFbGRlciBzcGljZSIsCiAgICAgIGxvYygiWW91IGNhbiBhdHRyYWN0IDxiPiUxIG1vcmUgd3JpbmtsZXJzPC9iPi4iLCAyKSArCiAgICAgICAgIjxxPlRoZSBjb29raWUgeW91ciBjb29raWUgY291bGQgc21lbGwgbGlrZS48L3E+IiwKICAgICAgNDQ0NDQ0LAogICAgICBbMTksIDhdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIlVuaG9seSBiYWl0Il07CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlJlc2lkdWFsIGx1Y2siLAogICAgICBsb2MoCiAgICAgICAgIldoaWxlIHRoZSBnb2xkZW4gc3dpdGNoIGlzIG9uLCB5b3UgZ2FpbiBhbiBhZGRpdGlvbmFsIDxiPislMSUgQ3BTPC9iPiBwZXIgZ29sZGVuIGNvb2tpZSB1cGdyYWRlIG93bmVkLiIsCiAgICAgICAgMTAKICAgICAgKSArICI8cT5Gb3J0dW5lIGNvbWVzIGluIG1hbnkgZmxhdm9ycy48L3E+IiwKICAgICAgOTk5OTksCiAgICAgIFsyNywgNl0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiR29sZGVuIHN3aXRjaCJdOwoKICAgIG9yZGVyID0gMTUwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkZhbnRhc3RlZWwgbW91c2UiLAogICAgICBnZXRTdHJDbGlja2luZ0dhaW5zKDEpICsKICAgICAgICAiPHE+WW91IGNvdWxkIGJlIGNsaWNraW5nIHVzaW5nIHlvdXIgdG91Y2hwYWQgYW5kIHdlJ2QgYmUgbm9uZSB0aGUgd2lzZXIuPC9xPiIsCiAgICAgIDUwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIFsxMSwgMTddCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgOCwgMTEpOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIk5ldmVyY3JhY2sgbW91c2UiLAogICAgICBnZXRTdHJDbGlja2luZ0dhaW5zKDEpICsKICAgICAgICAiPHE+SG93IG11Y2ggYmVlZmllciBjYW4geW91IG1ha2UgYSBtb3VzZSB1bnRpbCBpdCdzIGNvbnNpZGVyZWQgYSByYXQ/PC9xPiIsCiAgICAgIDUwMDAwMDAwMDAwMDAwMDAwMDAwMCwKICAgICAgWzExLCAxOF0KICAgICk7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCA5LCAxMSk7CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkZpdmUtZmluZ2VyIGRpc2NvdW50IiwKICAgICAgbG9jKCJBbGwgdXBncmFkZXMgYXJlIDxiPiUxJSBjaGVhcGVyIHBlciAlMjwvYj4uIiwgWwogICAgICAgIDEsCiAgICAgICAgbG9jKCIlMSBjdXJzb3IiLCAxMDApLAogICAgICBdKSArICI8cT5TdGljayBpdCB0byB0aGUgbWFuLjwvcT4iLAogICAgICA1NTU1NTUsCiAgICAgIFsyOCwgN10sCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkID0gMTsKICAgICAgfQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJIYWxvIGdsb3ZlcyIsICJBYmFkZG9uIl07CgogICAgb3JkZXIgPSA1MDAwOwogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIkZ1dHVyZSBhbG1hbmFjcyIsCiAgICAgICI8cT5MZXRzIHlvdSBwcmVkaWN0IG9wdGltYWwgcGxhbnRpbmcgdGltZXMuIEl0J3MgY3Jhenkgd2hhdCB0aW1lIHRyYXZlbCBjYW4gZG8hPC9xPiIsCiAgICAgICJGYXJtIiwKICAgICAgIlRpbWUgbWFjaGluZSIsCiAgICAgICJzeW5lcmd5MSIKICAgICk7CiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlKAogICAgICAiUmFpbiBwcmF5ZXIiLAogICAgICAiPHE+QSBkZWVwbHkgc3Bpcml0dWFsIGNlcmVtb25pYWwgaW52b2x2aW5nIGNvbXBsaWNhdGVkIGRhbmNlIG1vdmVzIGFuZCBoaWdoLXRlY2ggY2xvdWQtYnVzdGluZyBsYXNlcnMuPC9xPiIsCiAgICAgICJGYXJtIiwKICAgICAgIlRlbXBsZSIsCiAgICAgICJzeW5lcmd5MiIKICAgICk7CgogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIlNlaXNtaWMgbWFnaWMiLAogICAgICAiPHE+U3VycHJpc2UgZWFydGhxdWFrZXMgYXJlIGFuIG9sZCBmYXZvcml0ZSBvZiB3aXphcmRseSBmcmF0IGhvdXNlcy48L3E+IiwKICAgICAgIk1pbmUiLAogICAgICAiV2l6YXJkIHRvd2VyIiwKICAgICAgInN5bmVyZ3kxIgogICAgKTsKICAgIEdhbWUuU3luZXJneVVwZ3JhZGUoCiAgICAgICJBc3Rlcm9pZCBtaW5pbmciLAogICAgICAiPHE+QXMgcGVyIHRoZSA8c3Bhbj4xOTwvc3Bhbj43NCBVbml0ZWQgQ29zbWljIENvbnZlbnRpb24sIGNvbWV0cywgbW9vbnMsIGFuZCBpbmhhYml0ZWQgcGxhbmV0b2lkcyBhcmUgbm8gbG9uZ2VyIGxlZ2FsbHkgZXhjYXZhdGFibGUuPGJyPkJ1dCBoZXksIGEgc3BhY2UgYnJpYmUgZ29lcyBhIGxvbmcgd2F5LjwvcT4iLAogICAgICAiTWluZSIsCiAgICAgICJTaGlwbWVudCIsCiAgICAgICJzeW5lcmd5MiIKICAgICk7CgogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIlF1YW50dW0gZWxlY3Ryb25pY3MiLAogICAgICAiPHE+WW91ciBtYWNoaW5lcyB3b24ndCBldmVuIGJlIHN1cmUgaWYgdGhleSdyZSBvbiBvciBvZmYhPC9xPiIsCiAgICAgICJGYWN0b3J5IiwKICAgICAgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwKICAgICAgInN5bmVyZ3kxIgogICAgKTsKICAgIEdhbWUuU3luZXJneVVwZ3JhZGUoCiAgICAgICJUZW1wb3JhbCBvdmVyY2xvY2tpbmciLAogICAgICAiPHE+SW50cm9kdWNlIG1vcmUgcXVpY2tpdHVkZSBpbiB5b3VyIHN5c3RlbSBmb3IgaW5jcmVhc2VkIHNwZWVkYXRpb24gb2YgZmFzdG5lc3MuPC9xPiIsCiAgICAgICJGYWN0b3J5IiwKICAgICAgIlRpbWUgbWFjaGluZSIsCiAgICAgICJzeW5lcmd5MiIKICAgICk7CgogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIkNvbnRyYWN0cyBmcm9tIGJleW9uZCIsCiAgICAgICI8cT5NYWtlIHN1cmUgdG8gcmVhZCB0aGUgZmluZSBwcmludCE8L3E+IiwKICAgICAgIkJhbmsiLAogICAgICAiUG9ydGFsIiwKICAgICAgInN5bmVyZ3kxIgogICAgKTsKICAgIEdhbWUuU3luZXJneVVwZ3JhZGUoCiAgICAgICJQcmludGluZyBwcmVzc2VzIiwKICAgICAgIjxxPkZha2UgYmlsbHMgc28gcmVhbCwgdGhleSdyZSBhbG1vc3Qgd29ydGggdGhlIGluayB0aGV5J3JlIHByaW50ZWQgd2l0aC48L3E+IiwKICAgICAgIkJhbmsiLAogICAgICAiRmFjdG9yeSIsCiAgICAgICJzeW5lcmd5MiIKICAgICk7CgogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIlBhZ2FuaXNtIiwKICAgICAgIjxxPlNvbWUgZGVpdGllcyBhcmUgYmV0dGVyIGxlZnQgdW53b3JzaGlwcGVkLjwvcT4iLAogICAgICAiVGVtcGxlIiwKICAgICAgIlBvcnRhbCIsCiAgICAgICJzeW5lcmd5MSIKICAgICk7CiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlKAogICAgICAiR29kIHBhcnRpY2xlIiwKICAgICAgIjxxPlR1cm5zIG91dCBHb2QgaXMgbXVjaCB0aW5pZXIgdGhhbiB3ZSB0aG91Z2h0LCBJIGd1ZXNzLjwvcT4iLAogICAgICAiVGVtcGxlIiwKICAgICAgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwKICAgICAgInN5bmVyZ3kyIgogICAgKTsKCiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlKAogICAgICAiQXJjYW5lIGtub3dsZWRnZSIsCiAgICAgICI8cT5Tb21lIHRoaW5ncyB3ZXJlIG5ldmVyIG1lYW50IHRvIGJlIGtub3duIC0gb25seSBtaWxkbHkgc3BlY3VsYXRlZC48L3E+IiwKICAgICAgIldpemFyZCB0b3dlciIsCiAgICAgICJBbGNoZW15IGxhYiIsCiAgICAgICJzeW5lcmd5MSIKICAgICk7CiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlKAogICAgICAiTWFnaWNhbCBib3RhbnkiLAogICAgICAnPHE+QWxyZWFkeSBrbm93biBpbiBzb21lIHJlYWN0aW9uYXJ5IG5ld3NwYXBlcnMgYXMgInRoZSB3aXphcmRcJ3MgR01PcyIuPC9xPicsCiAgICAgICJXaXphcmQgdG93ZXIiLAogICAgICAiRmFybSIsCiAgICAgICJzeW5lcmd5MiIKICAgICk7CgogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIkZvc3NpbCBmdWVscyIsCiAgICAgICI8cT5Tb21laG93IGJldHRlciB0aGFuIHBsdXRvbml1bSBmb3IgcG93ZXJpbmcgcm9ja2V0cy48YnI+RXh0cmFjdGVkIGZyb20gdGhlIGZ1ZWxzIG9mIGFuY2llbnQsIGZvc3NpbGl6ZWQgY2l2aWxpemF0aW9ucy48L3E+IiwKICAgICAgIlNoaXBtZW50IiwKICAgICAgIk1pbmUiLAogICAgICAic3luZXJneTEiCiAgICApOwogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIlNoaXB5YXJkcyIsCiAgICAgICI8cT5XaGVyZSBjYXJwZW50cnksIGJsaW5kIGx1Y2ssIGFuZCBhc2Jlc3RvcyBpbnN1bGF0aW9uIHVuaXRlIHRvIHByb2R1Y2UgdGhlIG1vc3QgZGF6emxpbmcgc3BhY2VzaGlwcyBvbiB0aGUgcGxhbmV0LjwvcT4iLAogICAgICAiU2hpcG1lbnQiLAogICAgICAiRmFjdG9yeSIsCiAgICAgICJzeW5lcmd5MiIKICAgICk7CgogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIlByaW1vcmRpYWwgb3JlcyIsCiAgICAgICI8cT5Pbmx5IHdoZW4gcmVmaW5pbmcgdGhlIHB1cmVzdCBtZXRhbHMgd2lsbCB5b3UgZXh0cmFjdCB0aGUgc3dlZXRlc3Qgc2FwIG9mIHRoZSBlYXJ0aC48L3E+IiwKICAgICAgIkFsY2hlbXkgbGFiIiwKICAgICAgIk1pbmUiLAogICAgICAic3luZXJneTEiCiAgICApOwogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIkdvbGQgZnVuZCIsCiAgICAgICI8cT5JZiBnb2xkIGlzIHRoZSBiYWNrYm9uZSBvZiB0aGUgZWNvbm9teSwgY29va2llcywgc3VyZWx5LCBhcmUgaXRzIGhpcCBqb2ludHMuPC9xPiIsCiAgICAgICJBbGNoZW15IGxhYiIsCiAgICAgICJCYW5rIiwKICAgICAgInN5bmVyZ3kyIgogICAgKTsKCiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlKAogICAgICAiSW5mZXJuYWwgY3JvcHMiLAogICAgICAiPHE+U3ByaW5rbGUgcmVndWxhcmx5IHdpdGggRklSRS48L3E+IiwKICAgICAgIlBvcnRhbCIsCiAgICAgICJGYXJtIiwKICAgICAgInN5bmVyZ3kxIgogICAgKTsKICAgIEdhbWUuU3luZXJneVVwZ3JhZGUoCiAgICAgICJBYnlzbWFsIGdsaW1tZXIiLAogICAgICAiPHE+U29tZW9uZSwgb3Igc29tZXRoaW5nLCBpcyBzdGFyaW5nIGJhY2sgYXQgeW91Ljxicj5QZXJoYXBzIGF0IGFsbCBvZiB1cy48L3E+IiwKICAgICAgIlBvcnRhbCIsCiAgICAgICJQcmlzbSIsCiAgICAgICJzeW5lcmd5MiIKICAgICk7CgogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIlJlbGF0aXZpc3RpYyBwYXJzZWMtc2tpcHBpbmciLAogICAgICAiPHE+UGVvcGxlIHdpbGwgdGVsbCB5b3UgdGhpcyBpc24ndCBwaHlzaWNhbGx5IHBvc3NpYmxlLjxicj5UaGVzZSBhcmUgcGVvcGxlIHlvdSBkb24ndCB3YW50IG9uIHlvdXIgc2hpcC48L3E+IiwKICAgICAgIlRpbWUgbWFjaGluZSIsCiAgICAgICJTaGlwbWVudCIsCiAgICAgICJzeW5lcmd5MSIKICAgICk7CiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlKAogICAgICAiUHJpbWV2YWwgZ2xvdyIsCiAgICAgICI8cT5Gcm9tIHVuZW5kaW5nIHRpbWVzLCBhbiBhbmNpZW50IGxpZ2h0IHN0aWxsIHNoaW5lcywgaW1wb3NzaWJseSBwdXJlIGFuZCBmcmFnaWxlIGluIGl0cyBvbGQgYWdlLjwvcT4iLAogICAgICAiVGltZSBtYWNoaW5lIiwKICAgICAgIlByaXNtIiwKICAgICAgInN5bmVyZ3kyIgogICAgKTsKCiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlKAogICAgICAiRXh0cmEgcGh5c2ljcyBmdW5kaW5nIiwKICAgICAgIjxxPlRpbWUgdG8gcHV0IHlvdXIgbW9uZXkgd2hlcmUgeW91ciBwYXJ0aWNsZSBjb2xsaWRlcnMgYXJlLjwvcT4iLAogICAgICAiQW50aW1hdHRlciBjb25kZW5zZXIiLAogICAgICAiQmFuayIsCiAgICAgICJzeW5lcmd5MSIKICAgICk7CiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlKAogICAgICAiQ2hlbWljYWwgcHJvZmljaWVuY3kiLAogICAgICAiPHE+RGlzY292ZXIgZXhjaXRpbmcgbmV3IGVsZW1lbnRzLCBzdWNoIGFzIEZsZXNobWVsdGl1bSwgSW5lcnQgU2hhbXBvbyBCeXByb2R1Y3QgIzE3IGFuZCBDYXJib24rKyE8L3E+IiwKICAgICAgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwKICAgICAgIkFsY2hlbXkgbGFiIiwKICAgICAgInN5bmVyZ3kyIgogICAgKTsKCiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlKAogICAgICAiTGlnaHQgbWFnaWMiLAogICAgICAiPHE+QWN0dWFsbHkgbm90IHRvIGJlIHRha2VuIGxpZ2h0bHkhIE5vLCBJJ20gc2VyaW91cy4gMTc4IHBlb3BsZSBkaWVkIGxhc3QgeWVhci4gWW91IGRvbid0IG1lc3MgYXJvdW5kIHdpdGggbWFnaWMuPC9xPiIsCiAgICAgICJQcmlzbSIsCiAgICAgICJXaXphcmQgdG93ZXIiLAogICAgICAic3luZXJneTEiCiAgICApOwogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIk15c3RpY2FsIGVuZXJnaWVzIiwKICAgICAgIjxxPlNvbWV0aGluZyBiZWNrb25zIGZyb20gd2l0aGluIHRoZSBsaWdodC4gSXQgaXMgd2FybSwgY29tZm9ydGluZywgYW5kIGFwcGFyZW50bHkgdGhlIGNhdXNlIGZvciBzZXZlcmFsIGtpbmRzIG9mIGV4b3RpYyBza2luIGNhbmNlcnMuPC9xPiIsCiAgICAgICJQcmlzbSIsCiAgICAgICJUZW1wbGUiLAogICAgICAic3luZXJneTIiCiAgICApOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTeW5lcmdpZXMgVm9sLiBJIiwKICAgICAgbG9jKAogICAgICAgICJVbmxvY2tzIGEgbmV3IHRpZXIgb2YgdXBncmFkZXMgdGhhdCBhZmZlY3QgPGI+MiBidWlsZGluZ3MgYXQgdGhlIHNhbWUgdGltZTwvYj4uPGJyPlN5bmVyZ2llcyBhcHBlYXIgb25jZSB5b3UgaGF2ZSA8Yj4lMTwvYj4gb2YgYm90aCBidWlsZGluZ3MuIiwKICAgICAgICAxNQogICAgICApICsgIjxxPlRoZSBtYW55IGJlYXRzIHRoZSBmZXcuPC9xPiIsCiAgICAgIDIyMjIyMiwKICAgICAgWzEwLCAyMF0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiU2F0YW4iLCAiRG9taW5pb25zIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiU3luZXJnaWVzIFZvbC4gSUkiLAogICAgICBsb2MoCiAgICAgICAgIlVubG9ja3MgYSBuZXcgdGllciBvZiB1cGdyYWRlcyB0aGF0IGFmZmVjdCA8Yj4yIGJ1aWxkaW5ncyBhdCB0aGUgc2FtZSB0aW1lPC9iPi48YnI+U3luZXJnaWVzIGFwcGVhciBvbmNlIHlvdSBoYXZlIDxiPiUxPC9iPiBvZiBib3RoIGJ1aWxkaW5ncy4iLAogICAgICAgIDc1CiAgICAgICkgKyAiPHE+VGhlIHNldmVyYWwgYmVhdHMgdGhlIG1hbnkuPC9xPiIsCiAgICAgIDIyMjIyMjIsCiAgICAgIFsxMCwgMjldCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkJlZWx6ZWJ1YiIsICJTZXJhcGhpbSIsICJTeW5lcmdpZXMgVm9sLiBJIl07CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkhlYXZlbmx5IGNvb2tpZXMiLAogICAgICBsb2MoIkNvb2tpZSBwcm9kdWN0aW9uIG11bHRpcGxpZXIgPGI+KyUxJSBwZXJtYW5lbnRseTwvYj4uIiwgMTApICsKICAgICAgICAiPHE+QmFrZWQgd2l0aCBoZWF2ZW5seSBjaGlwcy4gQW4gb3RoZXJ3b3JkbHkgZmxhdm9yIHRoYXQgdHJhbnNjZW5kcyB0aW1lIGFuZCBzcGFjZS48L3E+IiwKICAgICAgMywKICAgICAgWzI1LCAxMl0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiTGVnYWN5Il07CiAgICBHYW1lLmxhc3QucG93ZXIgPSAxMDsKICAgIEdhbWUubGFzdC5wc2V1ZG9Db29raWUgPSB0cnVlOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIldyaW5rbHkgY29va2llcyIsCiAgICAgIGxvYygiQ29va2llIHByb2R1Y3Rpb24gbXVsdGlwbGllciA8Yj4rJTElIHBlcm1hbmVudGx5PC9iPi4iLCAxMCkgKwogICAgICAgICI8cT5UaGUgcmVzdWx0IG9mIHJlZ3VsYXIgY29va2llcyBsZWZ0IHRvIGFnZSBvdXQgZm9yIGNvdW50bGVzcyBlb25zIGluIGEgcGxhY2Ugd2hlcmUgdGltZSBhbmQgc3BhY2UgYXJlIG1lYW5pbmdsZXNzLjwvcT4iLAogICAgICA2NjY2NjY2LAogICAgICBbMjYsIDEyXQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJTYWNyaWxlZ2lvdXMgY29ycnVwdGlvbiIsICJFbGRlciBzcGljZSJdOwogICAgR2FtZS5sYXN0LnBvd2VyID0gMTA7CiAgICBHYW1lLmxhc3QucHNldWRvQ29va2llID0gdHJ1ZTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJEaXN0aWxsZWQgZXNzZW5jZSBvZiByZWRvdWJsZWQgbHVjayIsCiAgICAgIGxvYygKICAgICAgICAiR29sZGVuIGNvb2tpZXMgKGFuZCBhbGwgb3RoZXIgdGhpbmdzIHRoYXQgc3Bhd24sIHN1Y2ggYXMgcmVpbmRlZXIpIGhhdmUgPGI+JTElIGNoYW5jZSBvZiBiZWluZyBkb3VibGVkPC9iPi4iLAogICAgICAgIDEKICAgICAgKSArCiAgICAgICAgIjxxPlRhc3RlcyBnbGl0dGVyeS4gVGhlIGVtcHR5IHBoaWFsIG1ha2VzIGZvciBhIGdyZWF0IHBlbmNpbCBob2xkZXIuPC9xPiIsCiAgICAgIDc3Nzc3NzcsCiAgICAgIFsyNywgMTJdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkRpdmluZSBiYWtlcmllcyIsICJSZXNpZHVhbCBsdWNrIl07CgogICAgb3JkZXIgPSA0MDAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJPY2N1bHQgb2JzdHJ1Y3Rpb24iLAogICAgICBsb2MoIkNvb2tpZSBwcm9kdWN0aW9uIDxiPnJlZHVjZWQgdG8gMDwvYj4uIikgKwogICAgICAgICI8cT5JZiBzeW1wdG9tcyBwZXJzaXN0LCBjb25zdWx0IGEgZG9jdG9yLjwvcT4iLAogICAgICA3LAogICAgICBbMTUsIDVdCiAgICApOyAvL2RlYnVnIHB1cnBvc2VzIG9ubHkKICAgIEdhbWUubGFzdC5wb29sID0gImRlYnVnIjsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJHbHVjb3NlLWNoYXJnZWQgYWlyIiwKICAgICAgbG9jKCJTdWdhciBsdW1wcyBjb2FsZXNjZSA8Yj5hIHdob2xlIGxvdCBmYXN0ZXI8L2I+LiIpICsKICAgICAgICAiPHE+RG9uJ3QgYnJlYXRoZSB0b28gbXVjaCBvciB5b3UnbGwgZ2V0IGRpYWJldGVzITwvcT4iLAogICAgICA3LAogICAgICBbMjksIDE2XQogICAgKTsgLy9kZWJ1ZyBwdXJwb3NlcyBvbmx5CiAgICBHYW1lLmxhc3QucG9vbCA9ICJkZWJ1ZyI7CgogICAgb3JkZXIgPSAxMDMwMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJMYXZlbmRlciBjaG9jb2xhdGUgYnV0dGVyIGJpc2N1aXQiLAogICAgICBkZXNjOiAiUmV3YXJkZWQgZm9yIG93bmluZyAzMDAgb2YgZXZlcnl0aGluZy48YnI+VGhpcyBzdWJ0bHktZmxhdm9yZWQgYmlzY3VpdCByZXByZXNlbnRzIHRoZSBhY2NvbXBsaXNobWVudHMgb2YgZGVjYWRlcyBvZiB0b3Atc2VjcmV0IHJlc2VhcmNoLiBUaGUgbW9sZGVkIGRlc2lnbiBvbiB0aGUgY2hvY29sYXRlIHJlc2VtYmxlcyBhIHdlbGwta25vd24gZW50cmVwcmVuZXVyIHdobyBnYXZlIHRoZWlyIGFsbCB0byB0aGUgYW5jaWVudCBwYXRoIG9mIGJha2luZy4iLAogICAgICBpY29uOiBbMjYsIDEwXSwKICAgICAgcG93ZXI6IDEwLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogYnV0dGVyQmlzY3VpdE11bHQsCiAgICAgIGxvY2tlZDogMSwKICAgIH0pOwoKICAgIG9yZGVyID0gMTAwMzA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiTG9tYmFyZGlhIGNvb2tpZXMiLAogICAgICBkZXNjOiAiVGhlc2UgY29tZSBmcm9tIHRob3NlIGZhcm1zIHdpdGggdGhlIHJlYWxseSBnb29kIG1lbW9yeS4iLAogICAgICBpY29uOiBbMjMsIDEzXSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBicmFuZCBiaXNjdWl0cyIsCiAgICAgIHBvd2VyOiAzLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkJhc3RlbmFrZW4gY29va2llcyIsCiAgICAgIGRlc2M6ICJGcmVuY2ggY29va2llcyBtYWRlIG9mIGRlbGljaW91cyBjaW5uYW1vbiBhbmQgY2FuZHkgc3VnYXIuIFRoZXNlIGRvIG5vdCBjb250YWluIE51dHMhIiwKICAgICAgaWNvbjogWzI0LCAxM10sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgYnJhbmQgYmlzY3VpdHMiLAogICAgICBwb3dlcjogMywKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OSAqIDUsCiAgICB9KTsKCiAgICBvcmRlciA9IDEwMDIwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlBlY2FuIHNhbmRpZXMiLAogICAgICBkZXNjOiAiU3RpY2sgYSBudXQgb24gYSBjb29raWUgYW5kIGNhbGwgaXQgYSBkYXkhIE5hbWUgeW91ciBiYW5kIGFmdGVyIGl0ISBXaGF0ZXZlciEiLAogICAgICBpY29uOiBbMjUsIDEzXSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiTW9yYXZpYW4gc3BpY2UgY29va2llcyIsCiAgICAgIGRlc2M6ICJQb3B1bGFyIGZvciBiZWluZyB0aGUgd29ybGQncyBtb3JhdmlhbmVzdCBjb29raWVzLiIsCiAgICAgIGljb246IFsyNiwgMTNdLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJBbnphYyBiaXNjdWl0cyIsCiAgICAgIGRlc2M6ICJBcm15IGJpc2N1aXRzIGZyb20gYSBiYWtlcnkgZG93biB1bmRlciwgY29udGFpbmluZyBubyBlZ2dzIGJ1dCB5ZXMgb2F0cy4iLAogICAgICBpY29uOiBbMjcsIDEzXSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkJ1dHRlcmNha2VzIiwKICAgICAgZGVzYzogIkdsaXN0ZW5pbmcgd2l0aCBjaG9sZXN0ZXJvbCwgdGhlc2UgY29va2llcyBtb2lzdGx5IHN0cmFkZGxlIHRoZSBsaW5lIGJldHdlZW4gdGhlIGxlZ2FsIGRlZmluaXRpb24gb2YgYSBjb29raWUgYW5kIGp1c3QgYSBzdHJhaWdodC11cCBzdGljayBvZiBidXR0ZXIuIiwKICAgICAgaWNvbjogWzI5LCAxM10sCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJJY2UgY3JlYW0gc2FuZHdpY2hlcyIsCiAgICAgIGRlc2M6ICdJbiBhbiBhbHRlcm5hdGUgdW5pdmVyc2UsICJpY2UgY3JlYW0gc2FuZHdpY2giIGRlc2lnbmF0ZXMgYW4gaWNlIGNyZWFtIGNvbmUgZmlsbGVkIHdpdGggYmFjb24sIGxldHR1Y2UsIGFuZCB0b21hdG9lcy4gTWF5YmUgc29tZSBzcHJpbmtsZXMgdG9vLicsCiAgICAgIGljb246IFsyOCwgMTNdLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTdGV2aWEgQ2FlbGVzdGlzIiwKICAgICAgbG9jKAogICAgICAgICJTdWdhciBsdW1wcyByaXBlbiA8Yj4lMTwvYj4gc29vbmVyLiIsCiAgICAgICAgR2FtZS5zYXlUaW1lKDYwICogNjAgKiBHYW1lLmZwcykKICAgICAgKSArCiAgICAgICAgIjxxPkEgcGxhbnQgb2Ygc3VwZXJuYXR1cmFsIHN3ZWV0bmVzcyBncm93biBieSBhbmdlbHMgaW4gaGVhdmVubHkgZ2FyZGVucy48L3E+IiwKICAgICAgMTAwMDAwMDAwLAogICAgICBbMjUsIDE1XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJXcmlua2x5IGNvb2tpZXMiXTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJEaWFiZXRpY2EgRGFlbW9uaWN1cyIsCiAgICAgIGxvYygKICAgICAgICAiU3VnYXIgbHVtcHMgbWF0dXJlIDxiPiUxPC9iPiBzb29uZXIuIiwKICAgICAgICBHYW1lLnNheVRpbWUoNjAgKiA2MCAqIEdhbWUuZnBzKQogICAgICApICsKICAgICAgICAiPHE+QSBtYWxldm9sZW50LCBpZiBkZWxpY2lvdXMgaGVyYiB0aGF0IGlzIHNhaWQgdG8gZ3JvdyBvbiB0aGUgY2xpZmZzIG9mIHRoZSBkYXJrZXN0IGFieXNzIG9mIHRoZSB1bmRlcndvcmxkLjwvcT4iLAogICAgICAzMDAwMDAwMDAsCiAgICAgIFsyNiwgMTVdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIlN0ZXZpYSBDYWVsZXN0aXMiLCAiTHVjaWZlciJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlN1Y3JhbG9zaWEgSW51dGlsaXMiLAogICAgICBsb2MoCiAgICAgICAgIkJpZnVyY2F0ZWQgc3VnYXIgbHVtcHMgYXBwZWFyIDxiPiUxJSBtb3JlIG9mdGVuPC9iPiBhbmQgYXJlIDxiPiUyJSBtb3JlIGxpa2VseTwvYj4gdG8gZHJvcCAyIGx1bXBzLiIsCiAgICAgICAgWzUsIDVdCiAgICAgICkgKwogICAgICAgICI8cT5BIHJhcmUgYmVycnkgb2YgdW5pbnRlcmVzdGluZyBmbGF2b3IgdGhhdCBpcyBhcyBlbHVzaXZlIGFzIGl0cyB1c2VzIGFyZSBsaW1pdGVkOyBvbmx5IHNvdWdodC1hZnRlciBieSB0aGUgbW9zdCBhdmlkIGNvbGxlY3RvcnMgd2l0aCB0b28gbXVjaCB3ZWFsdGggb24gdGhlaXIgaGFuZHMuPC9xPiIsCiAgICAgIDEwMDAwMDAwMDAsCiAgICAgIFsyNywgMTVdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkRpYWJldGljYSBEYWVtb25pY3VzIl07CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkx1Y2t5IGRpZ2l0IiwKICAgICAgbG9jKAogICAgICAgICI8Yj4rJTElPC9iPiBwcmVzdGlnZSBsZXZlbCBlZmZlY3Qgb24gQ3BTLjxicj48Yj4rJTIlPC9iPiBnb2xkZW4gY29va2llIGVmZmVjdCBkdXJhdGlvbi48YnI+PGI+KyUzJTwvYj4gZ29sZGVuIGNvb2tpZSBsaWZlc3Bhbi4iLAogICAgICAgIFsxLCAxLCAxXQogICAgICApICsKICAgICAgICAiPHE+VGhpcyB1cGdyYWRlIGlzIGEgYml0IHNoeSBhbmQgb25seSBhcHBlYXJzIHdoZW4geW91ciBwcmVzdGlnZSBsZXZlbCBjb250YWlucyBhIDcuPC9xPiIsCiAgICAgIDc3NywKICAgICAgWzI0LCAxNV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiSGVhdmVubHkgbHVjayJdOwogICAgR2FtZS5sYXN0LnNob3dJZiA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIE1hdGguY2VpbCgoR2FtZS5wcmVzdGlnZSArICIiKS5zcGxpdCgiNyIpLmxlbmd0aCAtIDEpID49IDE7CiAgICB9OwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkx1Y2t5IG51bWJlciIsCiAgICAgIGxvYygKICAgICAgICAiPGI+KyUxJTwvYj4gcHJlc3RpZ2UgbGV2ZWwgZWZmZWN0IG9uIENwUy48YnI+PGI+KyUyJTwvYj4gZ29sZGVuIGNvb2tpZSBlZmZlY3QgZHVyYXRpb24uPGJyPjxiPislMyU8L2I+IGdvbGRlbiBjb29raWUgbGlmZXNwYW4uIiwKICAgICAgICBbMSwgMSwgMV0KICAgICAgKSArCiAgICAgICAgIjxxPlRoaXMgdXBncmFkZSBpcyBhIHJlY2x1c2l2ZSBoZXJtaXQgYW5kIG9ubHkgYXBwZWFycyB3aGVuIHlvdXIgcHJlc3RpZ2UgbGV2ZWwgY29udGFpbnMgdHdvIDcncy48L3E+IiwKICAgICAgNzc3NzcsCiAgICAgIFsyNCwgMTVdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkx1Y2t5IGRpZ2l0IiwgIkxhc3RpbmcgZm9ydHVuZSJdOwogICAgR2FtZS5sYXN0LnNob3dJZiA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIE1hdGguY2VpbCgoR2FtZS5wcmVzdGlnZSArICIiKS5zcGxpdCgiNyIpLmxlbmd0aCAtIDEpID49IDI7CiAgICB9OwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkx1Y2t5IHBheW91dCIsCiAgICAgIGxvYygKICAgICAgICAiPGI+KyUxJTwvYj4gcHJlc3RpZ2UgbGV2ZWwgZWZmZWN0IG9uIENwUy48YnI+PGI+KyUyJTwvYj4gZ29sZGVuIGNvb2tpZSBlZmZlY3QgZHVyYXRpb24uPGJyPjxiPislMyU8L2I+IGdvbGRlbiBjb29raWUgbGlmZXNwYW4uIiwKICAgICAgICBbMSwgMSwgMV0KICAgICAgKSArCiAgICAgICAgIjxxPlRoaXMgdXBncmFkZSB0b29rIGFuIG9hdGggb2YgY29tcGxldGUgc2VjbHVzaW9uIGZyb20gdGhlIHJlc3Qgb2YgdGhlIHdvcmxkIGFuZCBvbmx5IGFwcGVhcnMgd2hlbiB5b3VyIHByZXN0aWdlIGxldmVsIGNvbnRhaW5zIGZvdXIgNydzLjwvcT4iLAogICAgICA3Nzc3Nzc3NywKICAgICAgWzI0LCAxNV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiTHVja3kgbnVtYmVyIiwgIkRlY2lzaXZlIGZhdGUiXTsKICAgIEdhbWUubGFzdC5zaG93SWYgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBNYXRoLmNlaWwoKEdhbWUucHJlc3RpZ2UgKyAiIikuc3BsaXQoIjciKS5sZW5ndGggLSAxKSA+PSA0OwogICAgfTsKCiAgICBvcmRlciA9IDUwMDAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkJhY2tncm91bmQgc2VsZWN0b3IiLAogICAgICBsb2MoIkxldHMgeW91IHBpY2sgd2hpY2ggd2FsbHBhcGVyIHRvIGRpc3BsYXkuIiksCiAgICAgIDAsCiAgICAgIFsyOSwgNV0KICAgICk7CiAgICBHYW1lLmxhc3QuZGVzY0Z1bmMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBjaG9pY2UgPSB0aGlzLmNob2ljZXNGdW5jdGlvbigpW0dhbWUuYmdUeXBlXTsKICAgICAgaWYgKGNob2ljZSA9PSAwKSBjaG9pY2UgPSB0aGlzLmNob2ljZXNGdW5jdGlvbigpWzBdOwogICAgICByZXR1cm4gKAogICAgICAgICc8ZGl2IHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsiPicgKwogICAgICAgIGxvYygiQ3VycmVudDoiKSArCiAgICAgICAgIiAiICsKICAgICAgICB0aW55SWNvbihjaG9pY2UuaWNvbikgKwogICAgICAgICIgPGI+IiArCiAgICAgICAgY2hvaWNlLm5hbWUgKwogICAgICAgICc8L2I+PC9kaXY+PGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgdGhpcy5kZGVzYwogICAgICApOwogICAgfTsKCiAgICBHYW1lLmxhc3QucG9vbCA9ICJ0b2dnbGUiOwogICAgR2FtZS5sYXN0LmNob2ljZXNGdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGNob2ljZXMgPSBbXTsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLkJHc0J5Q2hvaWNlKSB7CiAgICAgICAgY2hvaWNlc1tpXSA9IHsKICAgICAgICAgIG5hbWU6IEdhbWUuQkdzQnlDaG9pY2VbaV0ubmFtZSwKICAgICAgICAgIGljb246IEdhbWUuQkdzQnlDaG9pY2VbaV0uaWNvbiwKICAgICAgICAgIG9yZGVyOiBHYW1lLkJHc0J5Q2hvaWNlW2ldLm9yZGVyIHx8IHBhcnNlSW50KGkpLAogICAgICAgIH07CiAgICAgIH0KCiAgICAgIGNob2ljZXNbMTNdLmRpdiA9IHRydWU7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNob2ljZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgaXQgPSBjaG9pY2VzW2ldOwogICAgICAgIGlmIChpdC5vcmRlciA+PSA0LjkgJiYgIUdhbWUuSGFzKCJEaXN0aW5ndWlzaGVkIHdhbGxwYXBlciBhc3NvcnRtZW50IikpCiAgICAgICAgICBjaG9pY2VzW2ldID0gMDsKICAgICAgfQoKICAgICAgY2hvaWNlc1tHYW1lLmJnVHlwZV0uc2VsZWN0ZWQgPSAxOwogICAgICByZXR1cm4gY2hvaWNlczsKICAgIH07CiAgICBHYW1lLmxhc3QuY2hvaWNlc1BpY2sgPSBmdW5jdGlvbiAoaWQpIHsKICAgICAgR2FtZS5iZ1R5cGUgPSBpZDsKICAgIH07CgogICAgR2FtZS5BbGxCR3MgPSBbCiAgICAgIHsgcGljOiAiYmdCbHVlIiwgbmFtZTogIkF1dG9tYXRpYyIsIGljb246IFswLCA3XSB9LAogICAgICB7IHBpYzogImJnQmx1ZSIsIG5hbWU6ICJCbHVlIiwgaWNvbjogWzIxLCAyMV0gfSwKICAgICAgeyBwaWM6ICJiZ1JlZCIsIG5hbWU6ICJSZWQiLCBpY29uOiBbMjIsIDIxXSB9LAogICAgICB7IHBpYzogImJnV2hpdGUiLCBuYW1lOiAiV2hpdGUiLCBpY29uOiBbMjMsIDIxXSB9LAogICAgICB7IHBpYzogImJnQmxhY2siLCBuYW1lOiAiQmxhY2siLCBpY29uOiBbMjQsIDIxXSB9LAogICAgICB7IHBpYzogImJnR29sZCIsIG5hbWU6ICJHb2xkIiwgaWNvbjogWzI1LCAyMV0gfSwKICAgICAgeyBwaWM6ICJncmFuZG1hczEiLCBuYW1lOiAiR3JhbmRtYXMiLCBpY29uOiBbMjYsIDIxXSB9LAogICAgICB7IHBpYzogImdyYW5kbWFzMiIsIG5hbWU6ICJEaXNwbGVhc2VkIGdyYW5kbWFzIiwgaWNvbjogWzI3LCAyMV0gfSwKICAgICAgeyBwaWM6ICJncmFuZG1hczMiLCBuYW1lOiAiQW5nZXJlZCBncmFuZG1hcyIsIGljb246IFsyOCwgMjFdIH0sCiAgICAgIHsgcGljOiAiYmdNb25leSIsIG5hbWU6ICJNb25leSIsIGljb246IFsyOSwgMjFdIH0sCiAgICAgIHsgcGljOiAiYmdQdXJwbGUiLCBuYW1lOiAiUHVycGxlIiwgaWNvbjogWzIxLCAyMl0sIG9yZGVyOiAxLjEgfSwKICAgICAgeyBwaWM6ICJiZ1BpbmsiLCBuYW1lOiAiUGluayIsIGljb246IFsyNCwgMjJdLCBvcmRlcjogMi4xIH0sCiAgICAgIHsgcGljOiAiYmdNaW50IiwgbmFtZTogIk1pbnQiLCBpY29uOiBbMjIsIDIyXSwgb3JkZXI6IDIuMiB9LAogICAgICB7IHBpYzogImJnU2lsdmVyIiwgbmFtZTogIlNpbHZlciIsIGljb246IFsyNSwgMjJdLCBvcmRlcjogNC45IH0sCiAgICAgIHsgcGljOiAiYmdCVyIsIG5hbWU6ICJCbGFjayAmIFdoaXRlIiwgaWNvbjogWzIzLCAyMl0sIG9yZGVyOiA0LjEgfSwKICAgICAgeyBwaWM6ICJiZ1NwZWN0cnVtIiwgbmFtZTogIlNwZWN0cnVtIiwgaWNvbjogWzI4LCAyMl0sIG9yZGVyOiA0LjIgfSwKICAgICAgeyBwaWM6ICJiZ0NhbmR5IiwgbmFtZTogIkNhbmR5IiwgaWNvbjogWzI2LCAyMl0gfSwKICAgICAgeyBwaWM6ICJiZ1llbGxvd0JsdWUiLCBuYW1lOiAiQmlzY3VpdCBzdG9yZSIsIGljb246IFsyNywgMjJdIH0sCiAgICAgIHsgcGljOiAiYmdDaG9jbyIsIG5hbWU6ICJDaG9jb2xhdGUiLCBpY29uOiBbMzAsIDIxXSB9LAogICAgICB7IHBpYzogImJnQ2hvY29EYXJrIiwgbmFtZTogIkRhcmsgQ2hvY29sYXRlIiwgaWNvbjogWzMxLCAyMV0gfSwKICAgICAgeyBwaWM6ICJiZ1BhaW50IiwgbmFtZTogIlBhaW50ZXIiLCBpY29uOiBbMjQsIDM0XSB9LAogICAgICB7IHBpYzogImJnU25vd3kiLCBuYW1lOiAiU25vdyIsIGljb246IFszMCwgMjJdIH0sCiAgICAgIHsgcGljOiAiYmdTa3kiLCBuYW1lOiAiU2t5IiwgaWNvbjogWzI5LCAyMl0gfSwKICAgICAgeyBwaWM6ICJiZ1N0YXJzIiwgbmFtZTogIk5pZ2h0IiwgaWNvbjogWzMxLCAyMl0gfSwKICAgICAgeyBwaWM6ICJiZ0ZvaWwiLCBuYW1lOiAiRm9pbCIsIGljb246IFsyNSwgMzRdIH0sCiAgICBdOwogICAgR2FtZS5CR3NCeUNob2ljZSA9IHt9OwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBHYW1lLkFsbEJHcy5sZW5ndGg7IGkrKykgewogICAgICBHYW1lLkJHc0J5Q2hvaWNlW2ldID0gR2FtZS5BbGxCR3NbaV07CiAgICB9CiAgICBpZiAoIUVOKSB7CiAgICAgIEdhbWUuQkdzQnlDaG9pY2VbMF0ubmFtZSA9IGxvYyhHYW1lLkJHc0J5Q2hvaWNlWzBdLm5hbWUpOwogICAgICBmb3IgKHZhciBpID0gMTsgaSA8IEdhbWUuQkdzQnlDaG9pY2UubGVuZ3RoOyBpKyspIHsKICAgICAgICBHYW1lLkJHc0J5Q2hvaWNlW2ldLm5hbWUgPSAnIicgKyBHYW1lLkJHc0J5Q2hvaWNlW2ldLnBpYyArICciJzsKICAgICAgfQogICAgfQoKICAgIG9yZGVyID0gMjU1OwogICAgR2FtZS5HcmFuZG1hU3luZXJneSgKICAgICAgIkx1Y2t5IGdyYW5kbWFzIiwKICAgICAgIkEgZm9ydHVuYXRlIGdyYW5kbWEgdGhhdCBhbHdheXMgc2VlbXMgdG8gZmluZCBtb3JlIGNvb2tpZXMuIiwKICAgICAgIkNoYW5jZW1ha2VyIgogICAgKTsKCiAgICBvcmRlciA9IDEyMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJZb3VyIGx1Y2t5IGNvb2tpZSIsCiAgICAgICI8cT5UaGlzIGlzIHRoZSBmaXJzdCBjb29raWUgeW91J3ZlIGV2ZXIgYmFrZWQuIEl0IGhvbGRzIGEgZGVlcCBzZW50aW1lbnRhbCB2YWx1ZSBhbmQsIGFmdGVyIGFsbCB0aGlzIHRpbWUsIGFuIGludGVyZXN0aW5nIHNtZWxsLjwvcT4iLAogICAgICAiQ2hhbmNlbWFrZXIiLAogICAgICAxCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAnIkFsbCBCZXRzIEFyZSBPZmYiIG1hZ2ljIGNvaW4nLAogICAgICAiPHE+QSBjb2luIHRoYXQgYWx3YXlzIGxhbmRzIG9uIHRoZSBvdGhlciBzaWRlIHdoZW4gZmxpcHBlZC4gTm90IGhlYWRzLCBub3QgdGFpbHMsIG5vdCB0aGUgZWRnZS4gVGhlIDxpPm90aGVyIHNpZGU8L2k+LjwvcT4iLAogICAgICAiQ2hhbmNlbWFrZXIiLAogICAgICAyCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiV2lubmluZyBsb3R0ZXJ5IHRpY2tldCIsCiAgICAgICI8cT5XaGF0IGxvdHRlcnk/IFRIRSBsb3R0ZXJ5LCB0aGF0J3Mgd2hhdCBsb3R0ZXJ5ISBPbmx5IGxvdHRlcnkgdGhhdCBtYXR0ZXJzITwvcT4iLAogICAgICAiQ2hhbmNlbWFrZXIiLAogICAgICAzCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRm91ci1sZWFmIGNsb3ZlciBmaWVsZCIsCiAgICAgICI8cT5ObyBnaWFudCBtb25zdGVycyBoZXJlLCBqdXN0IGEgd2hvbGUgbG90IG9mIGx1Y2t5IGdyYXNzLjwvcT4iLAogICAgICAiQ2hhbmNlbWFrZXIiLAogICAgICA0CiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQSByZWNpcGUgYm9vayBhYm91dCBib29rcyIsCiAgICAgICI8cT5UaXAgdGhlIHNjYWxlcyBpbiB5b3VyIGZhdm9yIHdpdGggMjggY3JlYXRpdmUgbmV3IHdheXMgdG8gY29vayB0aGUgYm9va3MuPC9xPiIsCiAgICAgICJDaGFuY2VtYWtlciIsCiAgICAgIDUKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJMZXByZWNoYXVuIHZpbGxhZ2UiLAogICAgICAiPHE+WW91J3ZlIGZpbmFsbHkgYmVjb21lIGFjY2VwdGVkIGFtb25nIHRoZSBsb2NhbCBsZXByZWNoYXVucywgd2hvIGxlbmQgeW91IHRoZWlyIG15dGhpY2FsIGx1Y2sgYXMgYSBzaWduIG9mIGZyaWVuZHNoaXAgKGFzIHdlbGwgYXMgc29tZSByYXRoZXIgZm91bC10YXN0aW5nIHRlYSkuPC9xPiIsCiAgICAgICJDaGFuY2VtYWtlciIsCiAgICAgIDYKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJJbXByb2JhYmlsaXR5IGRyaXZlIiwKICAgICAgIjxxPkEgc3RyYW5nZSBlbmdpbmUgdGhhdCB0dXJucyBzdGF0aXN0aWNzIG9uIHRoZWlyIGhlYWQuIFJlY29tbWVuZGVkIGJ5IHRoZSBHcmFuZG1vdGhlcidzIEd1aWRlIHRvIHRoZSBCYWtlcnkuPC9xPiIsCiAgICAgICJDaGFuY2VtYWtlciIsCiAgICAgIDcKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJBbnRpc3VwZXJzdGlzdHJvbmljcyIsCiAgICAgICI8cT5BbiBleGNpdGluZyBuZXcgZmllbGQgb2YgcmVzZWFyY2ggdGhhdCBtYWtlcyB1bmx1Y2t5IHRoaW5ncyBsdWNreS4gTm8gbWlycm9yIHVuYnJva2VuLCBubyBsYWRkZXIgdW53YWxrZWQgdW5kZXIhPC9xPiIsCiAgICAgICJDaGFuY2VtYWtlciIsCiAgICAgIDgKICAgICk7CgogICAgb3JkZXIgPSA1MDAwOwogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIkdlbW1lZCB0YWxpc21hbnMiLAogICAgICAiPHE+R29vZC1sdWNrIGNoYXJtcyBjb3ZlcmVkIGluIGFuY2llbnQgYW5kIGV4Y3J1Y2lhdGluZ2x5IHJhcmUgY3J5c3RhbHMuIEEgbXVzdCBoYXZlIGZvciBqb2IgaW50ZXJ2aWV3cyE8L3E+IiwKICAgICAgIkNoYW5jZW1ha2VyIiwKICAgICAgIk1pbmUiLAogICAgICAic3luZXJneTEiCiAgICApOwoKICAgIG9yZGVyID0gMjAwMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiS2l0dGVuIGNvbnN1bHRhbnRzIiwKICAgICAgc3RyS2l0dGVuRGVzYyArICI8cT5nbGFkIHRvIGJlIG92ZXJwYWlkIHRvIHdvcmsgd2l0aCB5b3UsIHNpcjwvcT4iLAogICAgICA5MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIEdhbWUuR2V0SWNvbigiS2l0dGVuIiwgOSkKICAgICk7CiAgICBHYW1lLmxhc3Qua2l0dGVuID0gMTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDksIDE4KTsKCiAgICBvcmRlciA9IDk5OTk5OwogICAgdmFyIHllYXJzID0gTWF0aC5mbG9vcigKICAgICAgKERhdGUubm93KCkgLSBuZXcgRGF0ZSgyMDEzLCA3LCA4KSkgLyAoMTAwMCAqIDYwICogNjAgKiAyNCAqIDM2NSkKICAgICk7CiAgICAvL29ubHkgdXBkYXRlcyBvbiBwYWdlIGxvYWQKICAgIC8vbWF5IGJlaGF2ZSBzdHJhbmdlbHkgb24gbGVhcCB5ZWFycwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkJpcnRoZGF5IGNvb2tpZSIsCiAgICAgIGRlc2M6ICI8cT4tPC9xPiIsCiAgICAgIGljb246IFsyMiwgMTNdLAogICAgICBwb3dlcjogeWVhcnMsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgR2FtZS5sYXN0LmJhc2VEZXNjID0KICAgICAgbG9jKAogICAgICAgICJDb29raWUgcHJvZHVjdGlvbiBtdWx0aXBsaWVyIDxiPislMSU8L2I+IGZvciBldmVyeSB5ZWFyIENvb2tpZSBDbGlja2VyIGhhcyBleGlzdGVkIChjdXJyZW50bHk6IDxiPislMiU8L2I+KS4iLAogICAgICAgIFsxLCBCZWF1dGlmeSh5ZWFycyldCiAgICAgICkgKyAiPHE+VGhhbmsgeW91IGZvciBwbGF5aW5nIENvb2tpZSBDbGlja2VyITxicj4tT3J0ZWlsPC9xPiI7CgogICAgb3JkZXIgPSAxNTA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQXJteXRocmlsIG1vdXNlIiwKICAgICAgZ2V0U3RyQ2xpY2tpbmdHYWlucygxKSArCiAgICAgICAgIjxxPlRoaXMgb25lIHRha2VzIGFib3V0IDUzIHBlb3BsZSB0byBwdXNoIGl0IGFyb3VuZCBhbmQgYW5vdGhlciA0OCB0byBqdW1wIGRvd24gb24gdGhlIGJ1dHRvbiBhbmQgdHJpZ2dlciBhIGNsaWNrLiBZb3UgY291bGQgc2F5IGl0J3MgZ290IHNvbWUgaGVmdCB0byBpdC48L3E+IiwKICAgICAgNTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIFsxMSwgMTldCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgMTAsIDExKTsKCiAgICBvcmRlciA9IDIwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlJldmVyc2UgZGVtZW50aWEiLAogICAgICAiPHE+RXh0cmVtZWx5IHVuc2V0dGxpbmcsIGFuZCBzb21laG93IGV2ZW4gd29yc2UgdGhhbiB0aGUgcmVndWxhciBraW5kLjwvcT4iLAogICAgICAiR3JhbmRtYSIsCiAgICAgIDkKICAgICk7CiAgICBvcmRlciA9IDMwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkh1bWFuZSBwZXN0aWNpZGVzIiwKICAgICAgIjxxPk1hZGUgYnkgcGVvcGxlLCBmb3IgcGVvcGxlLCBmcm9tIHBlb3BsZSBhbmQgcmVhZHkgdG8gdW5sZWFzaCBzb21lIHJpZ2h0ZW91cyBzY29yY2hpbmcgcGFpbiBvbiB0aG9zZSBwZXNreSBpbnNlY3RzIHRoYXQgc28gZGVzZXJ2ZSBpdC48L3E+IiwKICAgICAgIkZhcm0iLAogICAgICA5CiAgICApOwogICAgb3JkZXIgPSA0MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJNb2xlIHBlb3BsZSIsCiAgICAgICI8cT5FbmdpbmVlcmVkIGZyb20gcmVhbCBodW1hbiBiZWluZ3Mgd2l0aGluIHlvdXIgdmVyeSBsYWJzLCB0aGVzZSBzdHVyZHkgbGl0dGxlIGZvbGtzIGhhdmUgYSBrbmFjayBmb3IgZmluZGluZyB0aGUgdGFzdGllc3QgdW5kZXJncm91bmQgbWluZXJhbHMgaW4gY29uZGl0aW9ucyB0aGF0IG1vcmUgZXhwZW5zaXZlIG1hY2hpbmVyeSBwcm9iYWJseSB3b3VsZG4ndCBzdXJ2aXZlLjwvcT4iLAogICAgICAiTWluZSIsCiAgICAgIDkKICAgICk7CiAgICBvcmRlciA9IDUwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIk1hY2hpbmUgbGVhcm5pbmciLAogICAgICAiPHE+WW91IGZpZ3VyZWQgeW91IG1pZ2h0IGdldCBiZXR0ZXIgcHJvZHVjdGl2aXR5IGlmIHlvdSBhY3R1YWxseSB0b2xkIHlvdXIgd29ya2VycyB0byBsZWFybiBob3cgdG8gd29yayB0aGUgbWFjaGluZXMuIFNvbWV0aW1lcywgaXQncyB0aGUgbGl0dGxlIHRoaW5ncy4uLjwvcT4iLAogICAgICAiRmFjdG9yeSIsCiAgICAgIDkKICAgICk7CiAgICBvcmRlciA9IDUyNTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkVkaWJsZSBtb25leSIsCiAgICAgICI8cT5JdCdzIHJlYWxseSBxdWl0ZSBzaW1wbGU7IHlvdSBtYWtlIGFsbCBjdXJyZW5jeSB0b28gZGVsaWNpb3VzIG5vdCB0byBlYXQsIHNvbHZpbmcgd29ybGQgaHVuZ2VyIGFuZCBpbmZsYXRpb24gaW4gb25lIGZlbGwgc3dvb3AhPC9xPiIsCiAgICAgICJCYW5rIiwKICAgICAgOQogICAgKTsKICAgIG9yZGVyID0gNTUwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiU2ljayByYXAgcHJheWVycyIsCiAgICAgICI8cT5XaXRoIHRoZWlyIGlsbCBiZWF0IGFuZCByYWRpY2FsIHJoeW1lcywgdGhlc2Ugd2F5LWhpcCByZWxpZ2lvdXMgdHVuZXMgYXJlIHN1cmUgdG8gZ2V0IGFsbCB0aGUgeW91bmdpbnMgd2hvIHRob3VnaHQgdGhleSB3ZXJlIDIgY29vbCA0IGNodXJjaCBiYWNrIG9uIHRoZSBwZXdzIGFuZCBwcmF5aW5nIGZvciBtb3JlISBXaWNrZWQhPC9xPiIsCiAgICAgICJUZW1wbGUiLAogICAgICA5CiAgICApOwogICAgb3JkZXIgPSA1NzU7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJEZWx1eGUgdGFpbG9yZWQgd2FuZHMiLAogICAgICAiPHE+SW4gdGhpcyBhZ2Ugb2Ygc2NpZW5jZSwgbW9zdCBza2lsbGZ1bCB3YW5kLW1ha2VycyBhcmUgbm93IGxvbmcgZ29uZTsgYnV0IHRoYW5rZnVsbHkgLSBub3QgYWxsIHRob3NlIHdhbmRlcnMgYXJlIGxvc3QuPC9xPiIsCiAgICAgICJXaXphcmQgdG93ZXIiLAogICAgICA5CiAgICApOwogICAgb3JkZXIgPSA2MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJBdXRvcGlsb3QiLAogICAgICAiPHE+WW91ciBzaGlwcyBhcmUgbm93IGZpdHRlZCB3aXRoIGNvbXBsZXRlbHkgcm9ib3RpYyBjcmV3cyEgSXQncyBjcmF6eSBob3cgbXVjaCBtb25leSB5b3Ugc2F2ZSB3aGVuIHlvdSBkb24ndCBoYXZlIHRvIGNvbXBlbnNhdGUgdGhlIGZhbWlsaWVzIG9mIHRob3NlIGxvc3QgaW4gc3BhY2UuPC9xPiIsCiAgICAgICJTaGlwbWVudCIsCiAgICAgIDkKICAgICk7CiAgICBvcmRlciA9IDcwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRoZSBhZHZlbnQgb2YgY2hlbWlzdHJ5IiwKICAgICAgIjxxPllvdSBrbm93IHdoYXQ/IFRoYXQgd2hvbGUgYWxjaGVteSBub25zZW5zZSB3YXMgYSBsb2FkIG9mIGJhc2VsZXNzIHJ1YmJpc2guIERlYXIgZ29kLCB3aGF0IHdlcmUgeW91IHRoaW5raW5nPzwvcT4iLAogICAgICAiQWxjaGVteSBsYWIiLAogICAgICA5CiAgICApOwogICAgb3JkZXIgPSA4MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJUaGUgcmVhbCB3b3JsZCIsCiAgICAgICI8cT5JdCB0dXJucyBvdXQgdGhhdCBvdXIgdW5pdmVyc2UgaXMgYWN0dWFsbHkgdGhlIHR3aXN0ZWQgZGltZW5zaW9uIG9mIGFub3RoZXIsIHNhbmVyIHBsYW5lIG9mIHJlYWxpdHkuIFRpbWUgdG8gaG9wIG9uIG92ZXIgdGhlcmUgYW5kIGxvb3QgdGhlIHBsYWNlITwvcT4iLAogICAgICAiUG9ydGFsIiwKICAgICAgOQogICAgKTsKICAgIG9yZGVyID0gOTAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiU2Vjb25kIHNlY29uZHMiLAogICAgICAiPHE+VGhhdCdzIHR3aWNlIGFzIG1hbnkgc2Vjb25kcyBpbiB0aGUgc2FtZSBhbW91bnQgb2YgdGltZSEgV2hhdCBhIGRlYWwhIEFsc28sIHdoYXQgaW4gZ29kJ3MgbmFtZSE8L3E+IiwKICAgICAgIlRpbWUgbWFjaGluZSIsCiAgICAgIDkKICAgICk7CiAgICBvcmRlciA9IDEwMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJRdWFudHVtIGNvbWIiLAogICAgICAiPHE+UXVhbnR1bSBlbnRhbmdsZW1lbnQgaXMgb25lIG9mIHRob3NlIHRoaW5ncyB0aGF0IGFyZSBzbyBhbm5veWluZyB0byBleHBsYWluIHRoYXQgd2UgbWlnaHQgaG9uZXN0bHkgYmUgYmV0dGVyIG9mZiB3aXRob3V0IGl0LiBUaGlzIGlzIGZpbmFsbHkgcG9zc2libGUgdGhhbmtzIHRvIHRoZSBxdWFudHVtIGNvbWIhPC9xPiIsCiAgICAgICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsCiAgICAgIDkKICAgICk7CiAgICBvcmRlciA9IDExMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJDcnlzdGFsIG1pcnJvcnMiLAogICAgICAiPHE+RGVzaWduZWQgdG8gZmlsdGVyIG1vcmUgbGlnaHQgYmFjayBpbnRvIHlvdXIgcHJpc21zLCByZWFjaGluZyBsZXZlbHMgb2YgYnJpZ2h0bmVzcyB0aGF0IHJlYWxpdHkgaXRzZWxmIGhhZCBuZXZlciBwbGFubmVkIGZvci48L3E+IiwKICAgICAgIlByaXNtIiwKICAgICAgOQogICAgKTsKICAgIG9yZGVyID0gMTIwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkJ1bm55cGVkZXMiLAogICAgICAiPHE+WW91J3ZlIHRha2VuIHRvIGJyZWVkaW5nIHJhYmJpdHMgd2l0aCBodW5kcmVkcyBvZiBwYXdzLCB3aGljaCBtYWtlcyB0aGVtIGludHJpbnNpY2FsbHkgdmVyeSBsdWNreSBhbmQgdGh1cyBhIHZlcnkgaGFuZHkgKGlmIHZlcnkgZGlzdHVyYmluZykgcGV0LjwvcT4iLAogICAgICAiQ2hhbmNlbWFrZXIiLAogICAgICA5CiAgICApOwoKICAgIG9yZGVyID0gMjAwMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiS2l0dGVuIGFzc2lzdGFudHMgdG8gdGhlIHJlZ2lvbmFsIG1hbmFnZXIiLAogICAgICBzdHJLaXR0ZW5EZXNjICsKICAgICAgICAiPHE+bm90aGluZyBzdHJlc3NlcyBtZW93dC4uLiBleGNlcHQgaGF2aW5nIHRvIHNlZWsgdGhlIGFwcHJvdmFsIG9mIG15IGluZmVyaW9ycywgc2lyPC9xPiIsCiAgICAgIDkwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCwKICAgICAgR2FtZS5HZXRJY29uKCJLaXR0ZW4iLCAxMCkKICAgICk7CiAgICBHYW1lLmxhc3Qua2l0dGVuID0gMTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDEwLCAxOCk7CgogICAgb3JkZXIgPSA1MDAwOwogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIkNoYXJtIHF1YXJrcyIsCiAgICAgICI8cT5UaGV5J3JlIGFmdGVyIHlvdXIgbHVja3kgcXVhcmtzITwvcT4iLAogICAgICAiQ2hhbmNlbWFrZXIiLAogICAgICAiQW50aW1hdHRlciBjb25kZW5zZXIiLAogICAgICAic3luZXJneTIiCiAgICApOwoKICAgIG9yZGVyID0gMTAwMjA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiUGluayBiaXNjdWl0cyIsCiAgICAgIGRlc2M6ICJPbmUgb2YgdGhlIG9sZGVzdCBjb29raWVzLiBUcmFkaXRpb25hbGx5IGRpcHBlZCBpbiBjaGFtcGFnbmUgdG8gc29mdGVuIGl0LCBiZWNhdXNlIHRoZSBGcmVuY2ggd2lsbCB1c2UgYW55IG9wcG9ydHVuaXR5IHRvIGRyaW5rLiIsCiAgICAgIGljb246IFsyMSwgMTZdLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIldob2xlLWdyYWluIGNvb2tpZXMiLAogICAgICBkZXNjOiAnQ292ZXJlZCBpbiBzZWVkcyBhbmQgb3RoZXIgZWFydGh5LWxvb2tpbmcgZGVicmlzLiBSZWFsbHkgZ29pbmcgZm9yIHRoYXQgIjUtc2Vjb25kIHJ1bGUiIGxvb2suJywKICAgICAgaWNvbjogWzIyLCAxNl0sCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkNhbmR5IGNvb2tpZXMiLAogICAgICBkZXNjOiAiVGhlc2UgbWVsdCBpbiB5b3VyIGhhbmRzIGp1c3QgYSBsaXR0bGUgYml0LiIsCiAgICAgIGljb246IFsyMywgMTZdLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJCaWcgY2hpcCBjb29raWVzIiwKICAgICAgZGVzYzogIllvdSBhcmUgaW4gYXdlIGF0IHRoZSBzaXplIG9mIHRoZXNlIGNoaXBzLiBBYnNvbHV0ZSB1bml0cy4iLAogICAgICBpY29uOiBbMjQsIDE2XSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIk9uZSBjaGlwIGNvb2tpZXMiLAogICAgICBkZXNjOiAiWW91IGdldCBvbmUuIiwKICAgICAgaWNvbjogWzI1LCAxNl0sCiAgICAgIHBvd2VyOiAxLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiU3VnYXIgYmFraW5nIiwKICAgICAgbG9jKAogICAgICAgICdFYWNoIHVuc3BlbnQgc3VnYXIgbHVtcCAodXAgdG8gJTEpIGdpdmVzIDxiPislMiUgQ3BTPC9iPi48ZGl2IGNsYXNzPSJ3YXJuaW5nIj5Ob3RlOiB0aGlzIG1lYW5zIHRoYXQgc3BlbmRpbmcgc3VnYXIgbHVtcHMgd2lsbCBkZWNyZWFzZSB5b3VyIENwUyB1bnRpbCB0aGV5IGdyb3cgYmFjay48L2Rpdj4nLAogICAgICAgIFsxMDAsIDFdCiAgICAgICkgKwogICAgICAgICI8cT5UbyBiYWtlIHdpdGggdGhlIHN1Z2FyeSBlc3NlbmNlIG9mIGVvbnMgdGhlbXNlbHZlcywgeW91IG11c3QgZmlyc3QgbGVhcm4gdG8gdGFrZSB5b3VyIHN3ZWV0IHRpbWUuPC9xPiIsCiAgICAgIDIwMDAwMDAwMCwKICAgICAgWzIxLCAxN10KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiU3RldmlhIENhZWxlc3RpcyJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlN1Z2FyIGNyYXZpbmciLAogICAgICBsb2MoCiAgICAgICAgJ09uY2UgYW4gYXNjZW5zaW9uLCB5b3UgbWF5IHVzZSB0aGUgIlN1Z2FyIGZyZW56eSIgc3dpdGNoIHRvIDxiPnRyaXBsZSB5b3VyIENwUzwvYj4gZm9yIDEgaG91ciwgYXQgdGhlIGNvc3Qgb2YgPGI+MSBzdWdhciBsdW1wPC9iPi4nCiAgICAgICkgKyAiPHE+SnVzdCBhIGxpdHRsZSBraWNrIHRvIHN3ZWV0ZW4gdGhlIGRlYWwuPC9xPiIsCiAgICAgIDQwMDAwMDAwMCwKICAgICAgWzIyLCAxN10KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiU3VnYXIgYmFraW5nIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiU3VnYXIgYWdpbmcgcHJvY2VzcyIsCiAgICAgIGxvYygiRWFjaCBncmFuZG1hICh1cCB0byAlMSkgbWFrZXMgc3VnYXIgbHVtcHMgcmlwZW4gPGI+JTI8L2I+IHNvb25lci4iLCBbCiAgICAgICAgNjAwLAogICAgICAgIEdhbWUuc2F5VGltZSg2ICogR2FtZS5mcHMpLAogICAgICBdKSArICI8cT5BcmVuJ3QgdGhleSBqdXN0IHRoZSBzd2VldGVzdD88L3E+IiwKICAgICAgNjAwMDAwMDAwLAogICAgICBbMjMsIDE3XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJTdWdhciBjcmF2aW5nIiwgIkRpYWJldGljYSBEYWVtb25pY3VzIl07CgogICAgb3JkZXIgPSA0MDA1MDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTdWdhciBmcmVuenkiLAogICAgICBsb2MoCiAgICAgICAgIkFjdGl2YXRpbmcgdGhpcyB3aWxsIDxiPnRyaXBsZSB5b3VyIENwUzwvYj4gZm9yIDEgaG91ciwgYXQgdGhlIGNvc3Qgb2YgPGI+MSBzdWdhciBsdW1wPC9iPi4iCiAgICAgICkgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJNYXkgb25seSBiZSB1c2VkIG9uY2UgcGVyIGFzY2Vuc2lvbi4iKSwKICAgICAgMCwKICAgICAgWzIyLCAxN10KICAgICk7CiAgICBHYW1lLmxhc3QucHJpY2VMdW1wcyA9IDE7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJ0b2dnbGUiOwogICAgR2FtZS5sYXN0LnRvZ2dsZUludG8gPSAwOwogICAgR2FtZS5sYXN0LmNhbkJ1eUZ1bmMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBHYW1lLmx1bXBzID49IDE7CiAgICB9OwogICAgR2FtZS5sYXN0LmNsaWNrRnVuY3Rpb24gPSBHYW1lLnNwZW5kTHVtcCgKICAgICAgMSwKICAgICAgbG9jKCJhY3RpdmF0ZSB0aGUgc3VnYXIgZnJlbnp5IiksCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLlVwZ3JhZGVzWyJTdWdhciBmcmVuenkiXS5idXkoMSk7CiAgICAgICAgYnVmZiA9IEdhbWUuZ2FpbkJ1ZmYoInN1Z2FyIGZyZW56eSIsIDYwICogNjAsIDMpOwogICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgbG9jKCJTdWdhciBmcmVuenkhIiksCiAgICAgICAgICBsb2MoIkNwUyB4JTEgZm9yIDEgaG91ciEiLCAzKSwKICAgICAgICAgIFsyOSwgMTRdCiAgICAgICAgKTsKICAgICAgfQogICAgKTsKCiAgICBvcmRlciA9IDEwMDIwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlNwcmlua2xlcyBjb29raWVzIiwKICAgICAgZGVzYzogIkEgYml0IG9mIGZlc3RpdmUgZGVjb3JhdGluZyBoZWxwcyBoaWRlIHRoZSBmYWN0IHRoYXQgdGhpcyBtaWdodCBiZSBvbmUgb2YgdGhlIGJsYW5kZXN0IGNvb2tpZXMgeW91J3ZlIGV2ZXIgdGFzdGVkLiIsCiAgICAgIGljb246IFsyMSwgMTRdLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlBlYW51dCBidXR0ZXIgYmxvc3NvbXMiLAogICAgICBkZXNjOiAiVG9wcGVkIHdpdGggYSBzY3J1bXB0aW91cyBjaG9jb2xhdGUgc3F1aXJ0LCB3aGljaCBpcyBzb21ldGhpbmcgd2UgcmVhbGx5IHdpc2ggd2UgZGlkbid0IGp1c3Qgd3JpdGUuIiwKICAgICAgaWNvbjogWzIyLCAxNF0sCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiTm8tYmFrZSBjb29raWVzIiwKICAgICAgZGVzYzogIllvdSBoYXZlIG5vIGlkZWEgaG93IHRoZXNlIG15c3RlcmlvdXMgb3Zlbi1sZXNzIHRyZWF0cyBjYW1lIHRvIGJlIG9yIGhvdyB0aGV5IGhvbGQgdGhlaXIgc2hhcGUuIFlvdSdyZSB0aGlua2luZyBlaXRoZXIgZWxlcGhhbnQgZ2x1ZSBvciBjb2xkIGZ1c2lvbi4iLAogICAgICBpY29uOiBbMjEsIDE1XSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiRmxvcmVudGluZXMiLAogICAgICBkZXNjOiAiVGhlc2UgbWFrZSB1cCBmb3IgYmVpbmcgdGhlIGZydWl0Y2FrZSBvZiBjb29raWVzIGJ5IGF0IGxlYXN0IGhhdmluZyB0aGUgZGVjZW5jeSB0byBmZWF0dXJlIGNob2NvbGF0ZS4iLAogICAgICBpY29uOiBbMjYsIDE2XSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQ2hvY29sYXRlIGNyaW5rbGVzIiwKICAgICAgZGVzYzogIk5vbi1kZW5vbWluYXRpb25hbCBjb29raWVzIHRvIGNlbGVicmF0ZSB5ZWFyLXJvdW5kIGRlbGljaW91c25lc3MsIGFuZCBjZXJ0YWlubHkgbm90IENocmlzdG1hcyBvciBzb21lIG90aGVyIG5vbnNlbnNlLiIsCiAgICAgIGljb246IFsyMiwgMTVdLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiTWFwbGUgY29va2llcyIsCiAgICAgIGRlc2M6ICJNYWRlIHdpdGggc3lydXAgZnJvbSBhIGxhbmQgd2hlcmUgbWlsayBjb21lcyBpbiBiYWdzLCBpbnN0ZWFkIG9mIHNwb250YW5lb3VzbHkgcG9vbGluZyBhdCB0aGUgYm90dG9tIG9mIHlvdXIgc2NyZWVuIGRlcGVuZGluZyBvbiB5b3VyIGFjaGlldmVtZW50cy4iLAogICAgICBpY29uOiBbMjEsIDEzXSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwoKICAgIG9yZGVyID0gNDAwMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiVHVyYm8tY2hhcmdlZCBzb2lsIiwKICAgICAgbG9jKAogICAgICAgICJHYXJkZW4gcGxhbnRzIGdyb3cgZXZlcnkgc2Vjb25kLjxicj5HYXJkZW4gc2VlZHMgYXJlIGZyZWUgdG8gcGxhbnQuPGJyPllvdSBjYW4gc3dpdGNoIHNvaWxzIGF0IGFueSB0aW1lLiIKICAgICAgKSArICI8cT5JdCdzIGdvdCBlbGVjdHJvbHl0ZXMhPC9xPiIsCiAgICAgIDcsCiAgICAgIFsyLCAxNl0KICAgICk7IC8vZGVidWcgcHVycG9zZXMgb25seQogICAgR2FtZS5sYXN0LmJ1eUZ1bmN0aW9uID0gZnVuY3Rpb24gKCkgewogICAgICBpZiAoR2FtZS5PYmplY3RzWyJGYXJtIl0ubWluaWdhbWVMb2FkZWQpIHsKICAgICAgICBHYW1lLk9iamVjdHNbIkZhcm0iXS5taW5pZ2FtZS5jb21wdXRlU3RlcFQoKTsKICAgICAgfQogICAgfTsKICAgIEdhbWUubGFzdC5wb29sID0gImRlYnVnIjsKCiAgICBvcmRlciA9IDE1MDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJUZWNobm9ic2lkaWFuIG1vdXNlIiwKICAgICAgZ2V0U3RyQ2xpY2tpbmdHYWlucygxKSArCiAgICAgICAgIjxxPkEgaGlnaGx5IGFkdmFuY2VkIG1vdXNlIG9mIGEgc29waGlzdGljYXRlZCBkZXNpZ24uIE9ubHkgb25lIHRoaW5nIG9uIGl0cyBtaW5kIDogdG8gY2xpY2suPC9xPiIsCiAgICAgIDUwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIFsxMSwgMjhdCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgMTEsIDExKTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJQbGFzbWFyYmxlIG1vdXNlIiwKICAgICAgZ2V0U3RyQ2xpY2tpbmdHYWlucygxKSArCiAgICAgICAgIjxxPkEgc2hpZnRpbmcgYmx1ciBpbiB0aGUgY29ybmVyIG9mIHlvdXIgZXllLCB0aGlzIG1vdXNlIGNhbiB0cmlnZ2VyIGEgZmx1cnJ5IG9mIGNsaWNrcyB3aGVuIGdyYXplZCBieSBldmVuIHRoZSBzbGlnaHRlc3QgYnJlZXplLjwvcT4iLAogICAgICA1MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIFsxMSwgMzBdCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgMTIsIDExKTsKCiAgICBvcmRlciA9IDIwMDAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIktpdHRlbiBtYXJrZXRlZXJzIiwKICAgICAgc3RyS2l0dGVuRGVzYyArICI8cT5ubyBzdWNoIHRoaW5nIGFzIGEgc2F0dXJhdGVkIG1hcmtpdCwgc2lyPC9xPiIsCiAgICAgIDkwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCwKICAgICAgR2FtZS5HZXRJY29uKCJLaXR0ZW4iLCAxMSkKICAgICk7CiAgICBHYW1lLmxhc3Qua2l0dGVuID0gMTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDExLCAxOCk7CgogICAgb3JkZXIgPSAxMDAzMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJGZXN0aXZpdHkgbG9vcHMiLAogICAgICBkZXNjOiAiVGhlc2UgZ2FyaXNoIGJpc2N1aXRzIGFyZSBhIHBlcmZlY3QgZml0IGZvciBjaGlsZHJlbidzIGJpcnRoZGF5IHBhcnRpZXMgb3IgdGhlIGZ1bmVyYWxzIG9mIHN0cmFuZ2UsIGVjY2VudHJpYyBiaWxsaW9uYWlyZXMuIiwKICAgICAgaWNvbjogWzI1LCAxN10sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgYnJhbmQgYmlzY3VpdHMiLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSAqIDUsCiAgICB9KTsKCiAgICBvcmRlciA9IDEwMDIwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlBlcnNpYW4gcmljZSBjb29raWVzIiwKICAgICAgZGVzYzogIlJvc2Ugd2F0ZXIgYW5kIHBvcHB5IHNlZWRzIGFyZSB0aGUgc2VjcmV0IGluZ3JlZGllbnRzIG9mIHRoZXNlIHNtYWxsLCBidXR0ZXItZnJlZSBjb29raWVzLiIsCiAgICAgIGljb246IFsyOCwgMTVdLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIk5vcndlZ2lhbiBjb29raWVzIiwKICAgICAgZGVzYzogIkEgZmxhdCBidXR0ZXIgY29va2llIHdpdGggYSBzbGl2ZXIgb2YgY2FuZGllZCBjaGVycnkgb24gdG9wLiBJdCBpcyBzYWlkIHRoYXQgdGhlc2UgaWxsdXN0cmF0ZSB0aGUgYmxlYWtuZXNzIG9mIHNjYW5kaW5hdmlhbiBleGlzdGVudGlhbGlzbS4iLAogICAgICBpY29uOiBbMjIsIDIwXSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJDcmlzcHkgcmljZSBjb29raWVzIiwKICAgICAgZGVzYzogIkZ1biB0byBtYWtlIGF0IGhvbWUhIFN0b3JlLWJvdWdodCBjb29raWVzIGFyZSBvYnNvbGV0ZSEgVG9wcGxlIHRoZSBzeXN0ZW0hIFRoZXJlJ3MgbWFyc2htYWxsb3dzIGluIHRoZXNlISBEZXN0cm95IGNhcGl0YWxpc20hIiwKICAgICAgaWNvbjogWzIzLCAyMF0sCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlViZSBjb29raWVzIiwKICAgICAgZGVzYzogIlRoZSB0aW50IGlzIG9idGFpbmVkIGJ5IHRoZSB1c2Ugb2YgcHVycGxlIHlhbXMuIEFjY29yZGluZyB0byBjb2xvciBzeW1ib2xpc20sIHRoZXNlIGNvb2tpZXMgYXJlIGVpdGhlciBub2JsZSwgaG9seSwgb3Igc3VwZXJ2aWxsYWlucy4iLAogICAgICBpY29uOiBbMjQsIDE3XSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQnV0dGVyc2NvdGNoIGNvb2tpZXMiLAogICAgICBkZXNjOiAiVGhlIGJ1dHRlcnNjb3RjaCBjaGlwcyBhcmUganVzdCB0aGUgcmlnaHQgYW1vdW50IG9mIHN0aWNreSwgYW5kIG1ha2UgeW91IGZlZWwgbGlrZSB5b3UncmUgZWF0aW5nIGNhbmR5LiIsCiAgICAgIGljb246IFsyNCwgMjBdLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiU3BlY3VsYWFzIiwKICAgICAgZGVzYzogIlRoZXNlIGNydW5jaHksIGFsbW9zdCBvYm5veGlvdXNseSBjaW5uYW1vbnkgY29va2llcyBhcmUgYSBzb3VyY2Ugb2YgZHV0Y2ggcHJpZGUuIEFib3V0IHRoZSBvcmlnaW4gb2YgdGhlIG5hbWUsIG9uZSBjYW4gb25seSBzcGVjdWxhdGUuIiwKICAgICAgaWNvbjogWzIxLCAyMF0sCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKCiAgICBvcmRlciA9IDEwMjAwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkVsZGVyd29ydCBiaXNjdWl0cyIsCiAgICAgIGRlc2M6ICItIiwKICAgICAgaWNvbjogWzIyLCAyNV0sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogNjAgKiAyLAogICAgICBsb2NrZWQ6IDEsCiAgICB9KTsKICAgIEdhbWUubGFzdC5iYXNlRGVzYyA9CiAgICAgIGdldFN0ckNvb2tpZVByb2R1Y3Rpb25NdWx0aXBsaWVyUGx1cygyKSArCiAgICAgICI8YnI+IiArCiAgICAgIGxvYygiJTEgYXJlIDxiPiUyJTwvYj4gbW9yZSBwb3dlcmZ1bC4iLCBbCiAgICAgICAgY2FwKEdhbWUuT2JqZWN0c1siR3JhbmRtYSJdLnBsdXJhbCksCiAgICAgICAgMiwKICAgICAgXSkgKwogICAgICAiPGJyPiIgKwogICAgICBsb2MoIkRyb3BwZWQgYnkgJTEgcGxhbnRzLiIsIGxvYygiRWxkZXJ3b3J0IikudG9Mb3dlckNhc2UoKSkgKwogICAgICAiPHE+VGhleSB0YXN0ZSBpbmNyZWRpYmx5IHN0YWxlLCBldmVuIHdoZW4gYmFrZWQgZnJlc2guPC9xPiI7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQmFrZWJlcnJ5IGNvb2tpZXMiLAogICAgICBkZXNjOiAiLSIsCiAgICAgIGljb246IFsyMywgMjVdLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDYwLAogICAgICBsb2NrZWQ6IDEsCiAgICB9KTsKICAgIEdhbWUubGFzdC5iYXNlRGVzYyA9CiAgICAgIGdldFN0ckNvb2tpZVByb2R1Y3Rpb25NdWx0aXBsaWVyUGx1cygyKSArCiAgICAgICI8YnI+IiArCiAgICAgIGxvYygiRHJvcHBlZCBieSAlMSBwbGFudHMuIiwgbG9jKCJCYWtlYmVycnkiKS50b0xvd2VyQ2FzZSgpKSArCiAgICAgICI8cT5SZWFsbHkgZ29vZCBkaXBwZWQgaW4gaG90IGNob2NvbGF0ZS48L3E+IjsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJEdWtldGF0ZXIgY29va2llcyIsCiAgICAgIGRlc2M6ICItIiwKICAgICAgaWNvbjogWzI0LCAyNV0sCiAgICAgIHBvd2VyOiAxMCwKICAgICAgcHJpY2U6IDYwICogMywKICAgICAgbG9ja2VkOiAxLAogICAgfSk7CiAgICBHYW1lLmxhc3QuYmFzZURlc2MgPQogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMTApICsKICAgICAgIjxicj4iICsKICAgICAgbG9jKCJEcm9wcGVkIGJ5ICUxIHBsYW50cy4iLCBsb2MoIkR1a2V0YXRlciIpLnRvTG93ZXJDYXNlKCkpICsKICAgICAgIjxxPkZyYWdyYW50IGFuZCBtZWFseSwgd2l0aCBhIHNsaWdodCB5ZWxsb3cgYWZ0ZXJ0YXN0ZS48L3E+IjsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJHcmVlbiB5ZWFzdCBkaWdlc3RpdmVzIiwKICAgICAgZGVzYzogIi0iLAogICAgICBpY29uOiBbMjUsIDI1XSwKICAgICAgcG93ZXI6IDAsCiAgICAgIHByaWNlOiA2MCAqIDMsCiAgICAgIGxvY2tlZDogMSwKICAgIH0pOwogICAgR2FtZS5sYXN0LmJhc2VEZXNjID0KICAgICAgbG9jKCJHb2xkZW4gY29va2llcyBnaXZlIDxiPiUxJTwvYj4gbW9yZSBjb29raWVzLiIsIDEpICsKICAgICAgIjxicj4iICsKICAgICAgbG9jKCJHb2xkZW4gY29va2llIGVmZmVjdHMgbGFzdCA8Yj4lMSU8L2I+IGxvbmdlci4iLCAxKSArCiAgICAgICI8YnI+IiArCiAgICAgIGxvYygiR29sZGVuIGNvb2tpZXMgYXBwZWFyIDxiPiUxJTwvYj4gbW9yZSBvZnRlbi4iLCAxKSArCiAgICAgICI8YnI+IiArCiAgICAgIGxvYygiUmFuZG9tIGRyb3BzIGFyZSA8Yj4lMSUgbW9yZSBjb21tb248L2I+LiIsIDMpICsKICAgICAgIjxicj4iICsKICAgICAgbG9jKCJEcm9wcGVkIGJ5ICUxIHBsYW50cy4iLCBsb2MoIkdyZWVuIHJvdCIpLnRvTG93ZXJDYXNlKCkpICsKICAgICAgIjxxPlRoZXNlIGFyZSB0YXN0aWVyIHRoYW4geW91J2QgZXhwZWN0LCBidXQgbm90IGJ5IG11Y2guPC9xPiI7CgogICAgb3JkZXIgPSAyMzAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJGZXJuIHRlYSIsCiAgICAgIGxvYygKICAgICAgICAiWW91IGdhaW4gYW5vdGhlciA8Yj4rJTElPC9iPiBvZiB5b3VyIHJlZ3VsYXIgQ3BTIHdoaWxlIHRoZSBnYW1lIGlzIGNsb3NlZC4iLAogICAgICAgIDMKICAgICAgKSArCiAgICAgICAgIiA8c21hbGw+KCIgKwogICAgICAgIGxvYygKICAgICAgICAgICJNdXN0IG93biB0aGUgJTEgdXBncmFkZS4iLAogICAgICAgICAgZ2V0VXBncmFkZU5hbWUoIlR3aW4gR2F0ZXMgb2YgVHJhbnNjZW5kZW5jZSIpCiAgICAgICAgKSArCiAgICAgICAgIik8L3NtYWxsPiIgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJEcm9wcGVkIGJ5ICUxIHBsYW50cy4iLCBsb2MoIkRyb3dzeWZlcm4iKS50b0xvd2VyQ2FzZSgpKSArCiAgICAgICAgIjxxPkEgY2hlbWljYWxseSBjb21wbGV4IG5hdHVyYWwgYmV2ZXJhZ2UsIHRoaXMgc29vdGhpbmcgY29uY29jdGlvbiBoYXMgYmVlbiB1c2VkIGJ5IG1hdGhlbWF0aWNpYW5zIHRvIHNvbHZlIGVxdWF0aW9ucyBpbiB0aGVpciBzbGVlcC48L3E+IiwKICAgICAgNjAsCiAgICAgIFsyNiwgMjVdCiAgICApOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkljaG9yIHN5cnVwIiwKICAgICAgbG9jKAogICAgICAgICJZb3UgZ2FpbiBhbm90aGVyIDxiPislMSU8L2I+IG9mIHlvdXIgcmVndWxhciBDcFMgd2hpbGUgdGhlIGdhbWUgaXMgY2xvc2VkLiIsCiAgICAgICAgNwogICAgICApICsKICAgICAgICAiIDxzbWFsbD4oIiArCiAgICAgICAgbG9jKAogICAgICAgICAgIk11c3Qgb3duIHRoZSAlMSB1cGdyYWRlLiIsCiAgICAgICAgICBnZXRVcGdyYWRlTmFtZSgiVHdpbiBHYXRlcyBvZiBUcmFuc2NlbmRlbmNlIikKICAgICAgICApICsKICAgICAgICAiKTwvc21hbGw+IiArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoCiAgICAgICAgICAiU3VnYXIgbHVtcHMgbWF0dXJlIDxiPiUxPC9iPiBzb29uZXIuIiwKICAgICAgICAgIEdhbWUuc2F5VGltZSg3ICogNjAgKiBHYW1lLmZwcykKICAgICAgICApICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygiRHJvcHBlZCBieSAlMSBwbGFudHMuIiwgbG9jKCJJY2hvcnB1ZmYiKS50b0xvd2VyQ2FzZSgpKSArCiAgICAgICAgIjxxPlRhc3RlcyBsaWtlIGNhbmR5LiBUaGUgc21lbGwgaXMgYW5vdGhlciBzdG9yeS48L3E+IiwKICAgICAgNjAgKiAyLAogICAgICBbMjcsIDI1XQogICAgKTsKCiAgICBvcmRlciA9IDEwMjAwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIldoZWF0IHNsaW1zIiwKICAgICAgZGVzYzogIi0iLAogICAgICBpY29uOiBbMjgsIDI1XSwKICAgICAgcG93ZXI6IDEsCiAgICAgIHByaWNlOiAzMCwKICAgICAgbG9ja2VkOiAxLAogICAgfSk7CiAgICBHYW1lLmxhc3QuYmFzZURlc2MgPQogICAgICBnZXRTdHJDb29raWVQcm9kdWN0aW9uTXVsdGlwbGllclBsdXMoMSkgKwogICAgICAiPGJyPiIgKwogICAgICBsb2MoIkRyb3BwZWQgYnkgJTEgcGxhbnRzLiIsIGxvYygiQmFrZXIncyB3aGVhdCIpLnRvTG93ZXJDYXNlKCkpICsKICAgICAgIjxxPlRoZSBvbmx5IHJlYXNvbiB5b3UnZCBjb25zaWRlciB0aGVzZSB0byBiZSBjb29raWVzIGlzIGJlY2F1c2UgeW91IGZlZWwgc2xpZ2h0bHkgc29ycnkgZm9yIHRoZW0uPC9xPiI7CgogICAgdmFyIGdhcmRlbkRyb3BzID0gWwogICAgICAiRWxkZXJ3b3J0IGJpc2N1aXRzIiwKICAgICAgIkJha2ViZXJyeSBjb29raWVzIiwKICAgICAgIkR1a2V0YXRlciBjb29raWVzIiwKICAgICAgIkdyZWVuIHllYXN0IGRpZ2VzdGl2ZXMiLAogICAgICAiRmVybiB0ZWEiLAogICAgICAiSWNob3Igc3lydXAiLAogICAgICAiV2hlYXQgc2xpbXMiLAogICAgXTsKICAgIGZvciAodmFyIGkgaW4gZ2FyZGVuRHJvcHMpIHsgLy9zY2FsZSBieSBDcFMKICAgICAgdmFyIGl0ID0gR2FtZS5VcGdyYWRlc1tnYXJkZW5Ecm9wc1tpXV07CiAgICAgIGl0LnByaWNlRnVuYyA9IChmdW5jdGlvbiAoY29zdCkgewogICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gY29zdCAqIEdhbWUuY29va2llc1BzICogNjA7CiAgICAgICAgfTsKICAgICAgfSkoaXQuYmFzZVByaWNlKTsKICAgICAgaXQuYmFzZURlc2MgPSBpdC5iYXNlRGVzYy5yZXBsYWNlKAogICAgICAgICI8cT4iLAogICAgICAgICI8YnI+IiArIGxvYygiQ29zdCBzY2FsZXMgd2l0aCBDcFMuIikgKyAiPHE+IgogICAgICApOwogICAgICBpdC5kZXNjID0gQmVhdXRpZnlJblRleHQoaXQuYmFzZURlc2MpOwogICAgICBpdC5sYXN0aW5nID0gdHJ1ZTsKICAgIH0KCiAgICBvcmRlciA9IDEwMzAwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlN5bnRoZXRpYyBjaG9jb2xhdGUgZ3JlZW4gaG9uZXkgYnV0dGVyIGJpc2N1aXQiLAogICAgICBkZXNjOiAiUmV3YXJkZWQgZm9yIG93bmluZyAzNTAgb2YgZXZlcnl0aGluZy48YnI+VGhlIHJlY2lwZSBmb3IgdGhpcyBidXR0ZXIgYmlzY3VpdCB3YXMgb25jZSB0aGUgc29sZSBoZXJpdGFnZSBvZiBhbiBhbmNpZW50IG1vdW50YWluIG1vbmFzdGVyeS4gSXRzIGZsYXZvciBpcyBzbyByZWZpbmVkIHRoYXQgb25seSBhIHNsYWIgb2YgbGFiLW1hZGUgY2hvY29sYXRlIHNwZWNpZmljYWxseSBlbmdpbmVlcmVkIHRvIGJlIGNvbXBsZXRlbHkgdGFzdGVsZXNzIGNvdWxkIGNvbXBsZW1lbnQgaXQuPGJyPkFsc28gaXQncyBnb3QgeW91ciBmYWNlIG9uIGl0LiIsCiAgICAgIGljb246IFsyNCwgMjZdLAogICAgICBwb3dlcjogMTAsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiBidXR0ZXJCaXNjdWl0TXVsdCwKICAgICAgbG9ja2VkOiAxLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiUm95YWwgcmFzcGJlcnJ5IGNob2NvbGF0ZSBidXR0ZXIgYmlzY3VpdCIsCiAgICAgIGRlc2M6ICJSZXdhcmRlZCBmb3Igb3duaW5nIDQwMCBvZiBldmVyeXRoaW5nLjxicj5PbmNlIHJlc2VydmVkIGZvciB0aGUgbWVnYWxvbWFuaWFjIGVsaXRlLCB0aGlzIHVuaXF1ZSBzdHJhaW4gb2YgZnJ1aXR5IGNob2NvbGF0ZSBoYXMgYSBmbGF2b3IgYW5kIHRleHR1cmUgdW5saWtlIGFueSBvdGhlci4gV2hldGhlciBpdHMgZXhvcmJpdGFudCB3b3J0aCBpcyBpbXByb3ZlZCBvciBsZXNzZW5lZCBieSB0aGUgcHJlc2VuY2Ugb2YgeW91ciBsaWtlbmVzcyBvbiBpdCBzdGlsbCByZW1haW5zIHRvIGJlIHNlZW4uIiwKICAgICAgaWNvbjogWzI1LCAyNl0sCiAgICAgIHBvd2VyOiAxMCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSAqIGJ1dHRlckJpc2N1aXRNdWx0LAogICAgICBsb2NrZWQ6IDEsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJVbHRyYS1jb25jZW50cmF0ZWQgaGlnaC1lbmVyZ3kgY2hvY29sYXRlIGJ1dHRlciBiaXNjdWl0IiwKICAgICAgZGVzYzogIlJld2FyZGVkIGZvciBvd25pbmcgNDUwIG9mIGV2ZXJ5dGhpbmcuPGJyPkluZnVzZWQgd2l0aCB0aGUgcG93ZXIgb2Ygc2V2ZXJhbCBoeWRyb2dlbiBib21icyB0aHJvdWdoIGEgcHJvY2VzcyB0aGF0IGxlZnQgbW9zdCBudWNsZWFyIGVuZ2luZWVycyBhbmQgc2hhcmVob2xkZXJzIHBlcnBsZXhlZC4gQ3VycmVudGx5IGF0IHRoZSBjZW50ZXIgb2Ygc29tZSByYXRoZXIgaGVhdGVkIFVuaXRlZCBOYXRpb25zIG1lZXRpbmdzLiBHb2luZyBpbiBtb3JlIGRldGFpbCBhYm91dCB0aGlzIGNob2NvbGF0ZSB3b3VsZCB2aW9sYXRlIHNldmVyYWwgc3RhdGUgc2VjcmV0cywgYnV0IHdlJ2xsIGp1c3QgYWRkIHRoYXQgc29tZW9uZSdzIGJ1c3Qgc2VlbXMgdG8gYmUgcGljdHVyZWQgb24gaXQuIFBlcmhhcHMgeW91cnM/IiwKICAgICAgaWNvbjogWzI2LCAyNl0sCiAgICAgIHBvd2VyOiAxMCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSAqIGJ1dHRlckJpc2N1aXRNdWx0LAogICAgICBsb2NrZWQ6IDEsCiAgICB9KTsKCiAgICBvcmRlciA9IDIwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRpbWVwcm9vZiBoYWlyIGR5ZXMiLAogICAgICAiPHE+V2h5IGRvIHRoZXkgYWx3YXlzIGhhdmUgdGhvc2Ugc3RyYW5nZSB3aXNweSBwaW5rIGRvcz8gV2hhdCBkbyB0aGV5IGtub3cgYWJvdXQgY2FuZHkgZmxvc3MgdGhhdCB3ZSBkb24ndD88L3E+IiwKICAgICAgIkdyYW5kbWEiLAogICAgICAxMAogICAgKTsKICAgIG9yZGVyID0gMzAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQmFybnN0YXJzIiwKICAgICAgIjxxPkFoLCB5ZXMuIFRoZXNlIGhlbHAgcXVpdGUgYSBiaXQuIFNvbWVob3cuPC9xPiIsCiAgICAgICJGYXJtIiwKICAgICAgMTAKICAgICk7CiAgICBvcmRlciA9IDQwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIk1pbmUgY2FuYXJpZXMiLAogICAgICAiPHE+VGhlc2UgYXJlbid0IHVzZWQgZm9yIGFueXRoaW5nIGZyZWFreSEgVGhlIG1pbmVycyBqdXN0IGVuam95IGhhdmluZyBhIHBldCBvciB0d28gZG93biB0aGVyZS48L3E+IiwKICAgICAgIk1pbmUiLAogICAgICAxMAogICAgKTsKICAgIG9yZGVyID0gNTAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQnJvd25pZSBwb2ludCBzeXN0ZW0iLAogICAgICAiPHE+T2gsIHRoZXNlIGFyZSBsb3ZlbHkhIFlvdSBjYW4gbm93IHJld2FyZCB5b3VyIGZhY3RvcnkgZW1wbG95ZWVzIGZvciBnb29kIGJlaGF2aW9yLCBzdWNoIGFzIHdvcmtpbmcgb3ZlcnRpbWUgb3Igc25pdGNoaW5nIG9uIGNvd29ya2Vycy4gNTggYnJvd25pZSBwb2ludHMgZ2V0cyB5b3UgYSBsaXR0bGUgcGljdHVyZSBvZiBhIGJyb3duaWUsIGFuZCAxNzggb2YgdGhvc2UgcGljdHVyZXMgZ2V0cyB5b3UgYW4gYWN0dWFsIGJyb3duaWUgcGllY2UgZm9yIHlvdSB0byBkbyB3aXRoIGFzIHlvdSBwbGVhc2UhIEluZmFudGlsaXppbmc/IE1heWJlLiBPb2RsZXMgb2YgZnVuPyBZb3UgYmV0Y2hhITwvcT4iLAogICAgICAiRmFjdG9yeSIsCiAgICAgIDEwCiAgICApOwogICAgb3JkZXIgPSA1MjU7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJHcmFuZCBzdXBlcmN5Y2xlcyIsCiAgICAgICI8cT5XZSBsZXQgdGhlIHB1YmxpYyB0aGluayB0aGVzZSBhcmUgY29tcGxpY2F0ZWQgZmluYW5jaWFsIHRlcm1zIHdoZW4gcmVhbGx5IHdlJ3JlIGp1c3QgcmV3YXJkaW5nIHRoZSBiYW5rZXJzIHdpdGggc25henp5IGJpY3ljbGVzIGZvciBhIGpvYiB3ZWxsIGRvbmUuIEl0J3Mgb25seSBuYXR1cmFsIGFmdGVyIHlvdSBidWlsdCB0aG9zZSBmYW5jeSBnb2xkIHN3aW1taW5nIHBvb2xzIGZvciB0aGVtLCB3aGVyZSB0aGV5IGNhbiB0YWtlIGEgZGlwIGFuZCBjYXRjaCBLb25kcmF0aWV2IHdhdmVzLjwvcT4iLAogICAgICAiQmFuayIsCiAgICAgIDEwCiAgICApOwogICAgb3JkZXIgPSA1NTA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJQc2FsbS1yZWFkaW5nIiwKICAgICAgIjxxPkEgdGhlb2xvZ2ljYWxseSBkdWJpb3VzIGFuZCBwb3NzaWJseSBibGFzcGhlbW91cyBibGVuZCBvZiBmb3J0dW5lLXRlbGxpbmcgYW5kIHNjcmlwdHVyZSBzdHVkaWVzLjwvcT4iLAogICAgICAiVGVtcGxlIiwKICAgICAgMTAKICAgICk7CiAgICBvcmRlciA9IDU3NTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkltbW9iaWxlIHNwZWxsY2FzdGluZyIsCiAgICAgICI8cT5XaXphcmRzIHdobyBtYXN0ZXIgdGhpcyBza2lsbCBjYW4gbm93IGNhc3Qgc3BlbGxzIHdpdGhvdXQgaGF2aW5nIHRvIGhvcCBhbmQgc2tpcCBhbmQgZ2VzdGljdWxhdGUgZW1iYXJyYXNzaW5nbHksIHdoaWNoIGlzIG11Y2ggc25lYWtpZXIgYW5kIGhvbmVzdGx5IHF1aXRlIGEgcmVsaWVmLjwvcT4iLAogICAgICAiV2l6YXJkIHRvd2VyIiwKICAgICAgMTAKICAgICk7CiAgICBvcmRlciA9IDYwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlJlc3RhdXJhbnRzIGF0IHRoZSBlbmQgb2YgdGhlIHVuaXZlcnNlIiwKICAgICAgIjxxPlNpbmNlIHRoZSB1bml2ZXJzZSBpcyBzcGF0aWFsbHkgaW5maW5pdGUsIGFuZCB0aGVyZWZvcmUgY2FuIGJlIGNvbnN0cnVlZCB0byBoYXZlIGluZmluaXRlIGVuZHMsIHlvdSd2ZSBvcGVuZWQgYW4gaW5maW5pdGUgY2hhaW4gb2YgcmVzdGF1cmFudHMgd2hlcmUgeW91ciBzcGFjZSB0cnVja2VycyBjYW4gcmVzdCBhbmQgcGFydGFrZSBpbiBzb21lIGhvbWUtYnJhbmQgY29va2llLWJhc2VkIG1lYWxzLjwvcT4iLAogICAgICAiU2hpcG1lbnQiLAogICAgICAxMAogICAgKTsKICAgIG9yZGVyID0gNzAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiT24gc2Vjb25kIHRob3VnaHQiLAogICAgICAiPHE+RGlzcmVnYXJkIHRoYXQgbGFzdCB1cGdyYWRlLCBhbGNoZW15IGlzIHdoZXJlIGl0J3MgYXQhIFlvdXIgZWdnaGVhZHMganVzdCBmb3VuZCBhIHdheSB0byB0cmFuc211dGUgY2hpbGRyZW4ncyBuaWdodG1hcmVzIGludG8gcmFyZSBtZXRhbHMhPC9xPiIsCiAgICAgICJBbGNoZW15IGxhYiIsCiAgICAgIDEwCiAgICApOwogICAgb3JkZXIgPSA4MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJEaW1lbnNpb25hbCBnYXJiYWdlIGd1bHBlciIsCiAgICAgICI8cT5TbyB3ZSd2ZSBiZWVuIGxvb2tpbmcgZm9yIGEgcGxhY2UgdG8gZGlzcG9zZSBvZiBhbGwgdGhlIHJlZnVzZSB0aGF0J3MgYmVlbiBhY2N1bXVsYXRpbmcgc2luY2Ugd2Ugc3RhcnRlZCBiYWtpbmcgLSBidXJudCBjb29raWVzLCBmYWlsZWQgZXhwZXJpbWVudHMsIHVucnVseSB3b3JrZXJzIC0gYW5kIHdlbGwsIHdlIGZpZ3VyZWQgcmF0aGVyIHRoYW4gc2VsbCBpdCB0byBwb29yIGNvdW50cmllcyBsaWtlIHdlJ3ZlIGJlZW4gZG9pbmcsIHdlIGNvdWxkIGp1c3QgZHVtcCBpdCBpbiBzb21lIGFsdGVybmF0ZSB0cmFzaCBkaW1lbnNpb24gd2hlcmUgaXQncyBub3QgZ29ubmEgYm90aGVyIGFueWJvZHkhIFByb2JhYmx5ITwvcT4iLAogICAgICAiUG9ydGFsIiwKICAgICAgMTAKICAgICk7CiAgICBvcmRlciA9IDkwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkFkZGl0aW9uYWwgY2xvY2sgaGFuZHMiLAogICAgICAiPHE+SXQgc2VlbWVkIGxpa2UgYSBzaWxseSBpZGVhIGF0IGZpcnN0LCBidXQgaXQgdHVybnMgb3V0IHRoZXNlIGhhdmUgdGhlIHN0cmFuZ2UgYWJpbGl0eSB0byB0d2lzdCB0aW1lIGluIGludGVyZXN0aW5nIG5ldyB3YXlzLjwvcT4iLAogICAgICAiVGltZSBtYWNoaW5lIiwKICAgICAgMTAKICAgICk7CiAgICBvcmRlciA9IDEwMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJCYWtpbmcgTm9iZWwgcHJpemUiLAogICAgICAiPHE+V2hhdCBiZXR0ZXIgd2F5IHRvIHNwb25zb3Igc2NpZW50aWZpYyBncm93dGggdGhhbiB0byBtb3RpdmF0ZSB0aG9zZSBzbWFybXkgbmVyZHMgd2l0aCBhIG1lYW5pbmdsZXNzIGF3YXJkISBXaGF0J3MgbW9yZSwgZWFjaCBwcml6ZSBjb21lcyB3aXRoIGEgZmluZSBwcmludCBsaWZlbG9uZyBleGNsdXNpdmUgY29udHJhY3QgdG8gY29tZSB3b3JrIGZvciB5b3UgKG9yIGVsc2UpITwvcT4iLAogICAgICAiQW50aW1hdHRlciBjb25kZW5zZXIiLAogICAgICAxMAogICAgKTsKICAgIG9yZGVyID0gMTEwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlJldmVyc2UgdGhlb3J5IG9mIGxpZ2h0IiwKICAgICAgIjxxPkEgd2hvbGUgbmV3IHdvcmxkIG9mIHBoeXNpY3Mgb3BlbnMgdXAgd2hlbiB5b3UgZGVjaWRlIHRoYXQgYW50aXBob3RvbnMgYXJlIHJlYWwgYW5kIHBvc2l0IHRoYXQgbGlnaHQgaXMgbWVyZWx5IGEgdm9pZCBpbiBzaGFkb3cuPC9xPiIsCiAgICAgICJQcmlzbSIsCiAgICAgIDEwCiAgICApOwogICAgb3JkZXIgPSAxMjAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiUmV2aXNlZCBwcm9iYWJpbGlzdGljcyIsCiAgICAgICI8cT5FaXRoZXIgc29tZXRoaW5nIGhhcHBlbnMgb3IgaXQgZG9lc24ndC4gVGhhdCdzIGEgNTAlIGNoYW5jZSEgVGhpcyBzdWRkZW5seSBtYWtlcyBhIGxvdCBvZiB1bmxpa2VseSB0aGluZ3MgdmVyeSBwb3NzaWJsZS48L3E+IiwKICAgICAgIkNoYW5jZW1ha2VyIiwKICAgICAgMTAKICAgICk7CgogICAgb3JkZXIgPSAyMDAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJLaXR0ZW4gYW5hbHlzdHMiLAogICAgICBzdHJLaXR0ZW5EZXNjICsKICAgICAgICAiPHE+YmFzZWQgb24gcHVycmVudCByZXR1cm4tb24taW52ZXN0bWVudCBtZW93ZGVscyB3ZSBzaG91bGQgYmUgYWJsZSB0byBhZmZ1cmQgdG8gcGF5IG91ciBlbXBhd3llZXMgc29tZXdoZXJlIGFyb3VuZCBuZXh0IGNlbnR1cnksIHNpcjwvcT4iLAogICAgICA5MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIEdhbWUuR2V0SWNvbigiS2l0dGVuIiwgMTIpCiAgICApOwogICAgR2FtZS5sYXN0LmtpdHRlbiA9IDE7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCAxMiwgMTgpOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJFeWUgb2YgdGhlIHdyaW5rbGVyIiwKICAgICAgbG9jKCJNb3VzZSBvdmVyIGEgd3JpbmtsZXIgdG8gc2VlIGhvdyBtYW55IGNvb2tpZXMgYXJlIGluIGl0cyBzdG9tYWNoLiIpICsKICAgICAgICAiPHE+SnVzdCBhIHdyaW5rbGVyIGFuZCBpdHMgd2lsbCB0byBzdXJ2aXZlLjxicj5IYW5naW4nIHRvdWdoLCBzdGF5aW4nIGh1bmdyeS48L3E+IiwKICAgICAgOTk5OTk5OTksCiAgICAgIFsyNywgMjZdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIldyaW5rbHkgY29va2llcyJdOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJJbnNwaXJlZCBjaGVja2xpc3QiLAogICAgICBsb2MoCiAgICAgICAgIlVubG9ja3MgdGhlIDxiPkJ1eSBhbGw8L2I+IGZlYXR1cmUsIHdoaWNoIGxldHMgeW91IGluc3RhbnRseSBwdXJjaGFzZSBldmVyeSB1cGdyYWRlIGluIHlvdXIgc3RvcmUgKHN0YXJ0aW5nIGZyb20gdGhlIGNoZWFwZXN0IG9uZSkuPGJyPkFsc28gdW5sb2NrcyB0aGUgPGI+VmF1bHQ8L2I+LCBhIHN0b3JlIHNlY3Rpb24gd2hlcmUgeW91IGNhbiBwbGFjZSB1cGdyYWRlcyB5b3UgZG8gbm90IHdpc2ggdG8gYXV0by1idXkuIgogICAgICApICsKICAgICAgICAnPHE+U25henp5IGdyYW5kbWEgYWNjZXNzb3JpZXM/IENoZWNrLiBUcmFuc2RpbWVuc2lvbmFsIGFib21pbmF0aW9ucz8gQ2hlY2suIEEgYnVuY2ggb2YgZWdncyBmb3Igc29tZSByZWFzb24/IENoZWNrLiBNYWNoaW5lIHRoYXQgZ29lcyAicGluZyI/IENoZWNrIGFuZCBjaGVjay48L3E+JywKICAgICAgOTAwMDAwLAogICAgICBbMjgsIDI2XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJQZXJzaXN0ZW50IG1lbW9yeSIsICJQZXJtYW5lbnQgdXBncmFkZSBzbG90IElJIl07CgogICAgb3JkZXIgPSAxMDMwMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJQdXJlIHBpdGNoLWJsYWNrIGNob2NvbGF0ZSBidXR0ZXIgYmlzY3VpdCIsCiAgICAgIGRlc2M6ICJSZXdhcmRlZCBmb3Igb3duaW5nIDUwMCBvZiBldmVyeXRoaW5nLjxicj5UaGlzIGNob2NvbGF0ZSBpcyBzbyBwdXJlIGFuZCBzbyBmbGF3bGVzcyB0aGF0IGl0IGhhcyBubyBjb2xvciBvZiBpdHMgb3duLCBpbnN0ZWFkIHRha2luZyBvbiB0aGUgYXBwZWFyYW5jZSBvZiB3aGF0ZXZlciBpcyBhcm91bmQgaXQuIFlvdSdyZSBhIGJpdCBzdXJwcmlzZWQgdG8gbm90aWNlIHRoYXQgdGhpcyBvbmUgaXNuJ3Qgc3RhbXBlZCB3aXRoIHlvdXIgZWZmaWd5LCBhcyBpdHMgc3VyZmFjZSBpcyBwZXJmZWN0bHkgc21vb3RoICh0byB0aGUgcGljb21ldGVyKSAtIHVudGlsIHlvdSByZWFsaXplIGl0J3MgcXVpdGUgbGl0ZXJhbGx5IHJlZmxlY3RpbmcgeW91ciBvd24gZmFjZSBsaWtlIGEgbWlycm9yLiIsCiAgICAgIGljb246IFsyNCwgMjddLAogICAgICBwb3dlcjogMTAsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiBidXR0ZXJCaXNjdWl0TXVsdCwKICAgICAgbG9ja2VkOiAxLAogICAgfSk7CgogICAgb3JkZXIgPSAxMDAyMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJDaG9jb2xhdGUgb2F0bWVhbCBjb29raWVzIiwKICAgICAgZGVzYzogIlRoZXNlIGJhZCBib3lzIGNvbXBlbnNhdGUgZm9yIGxhY2sgb2YgYSBjb2hlc2l2ZSBmb3JtIGFuZCBhIGx1bXB5LCB1bnNpZ2h0bHkgYXBwZWFyYW5jZSBieSBiZWluZyBqdXN0IHNpbXBseSBkZWxpY2lvdXMuIFNvbWV0aGluZyB3ZSBzaG91bGQgYWxsIGFzcGlyZSB0by4iLAogICAgICBpY29uOiBbMjMsIDI4XSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSAqIDUsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJNb2xhc3NlcyBjb29raWVzIiwKICAgICAgZGVzYzogIlN0aWNreSwgY3JhY2tseSwgYW5kIGR1c3RlZCBpbiBmaW5lIHN1Z2FyLjxicj5Tb21lIGx1bmF0aWNzIGhhdmUgYmVlbiBrbm93biB0byBlYXQgdGhlc2Ugd2l0aCBwb3RhdG9lcy4iLAogICAgICBpY29uOiBbMjQsIDI4XSwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJCaXNjb3R0aSIsCiAgICAgIGRlc2M6ICJBbG1vbmRzIGFuZCBwaXN0YWNoaW9zIG1ha2UgdGhlc2UgdmVyeSByb2J1c3QgY29va2llcyBzbGlnaHRseSBtb3JlIGludGVyZXN0aW5nIHRvIGVhdCB0aGFuIHRvIGJsdWRnZW9uIHBlb3BsZSB3aXRoLiIsCiAgICAgIGljb246IFsyMiwgMjhdLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSAqIDUsCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJXYWZmbGUgY29va2llcyIsCiAgICAgIGRlc2M6ICJXaGV0aGVyIHRoZXNlIGFyZSBjb29raWVzIHdpdGggc2hvY2tpbmdseSB3YWZmbGUtbGlrZSBmZWF0dXJlcyBvciBzaW1wbHkgcmVndWxhciBjb29raWUtc2l6ZWQgd2FmZmxlcyBpcyBhIGRlYmF0ZSB3ZSdyZSBub3QgZ2V0dGluZyBpbnRvIGhlcmUuIiwKICAgICAgaWNvbjogWzIxLCAyOF0sCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSwKICAgIH0pOwoKICAgIG9yZGVyID0gMTAwMDA7CiAgICAvL2Vhcmx5IGNvb2tpZXMgdGhhdCB1bmxvY2sgYXQgdGhlIHNhbWUgdGltZSBhcyBjb2NvbnV0IGNvb2tpZXM7IG1lYW50IHRvIGJvb3N0IGVhcmx5IGdhbWUgYSBsaXR0bGUgYml0CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQWxtb25kIGNvb2tpZXMiLAogICAgICBkZXNjOiAiU29tZXRpbWVzIHlvdSBmZWVsIGxpa2Ugb25lIG9mIHRoZXNlLiBTb21ldGltZXMgeW91IGRvbid0LiIsCiAgICAgIGljb246IFsyMSwgMjddLAogICAgICBwb3dlcjogMiwKICAgICAgcHJpY2U6IDk5OTk5OTk5LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiSGF6ZWxudXQgY29va2llcyIsCiAgICAgIGRlc2M6ICJUYXN0ZXMgbGlrZSBhIG1vcm5pbmcgc3Ryb2xsIHRocm91Z2ggYSBmcmFncmFudCBmb3Jlc3QsIG1pbnVzIHRoZSBjbG91ZHMgb2YgZ25hdHMuIiwKICAgICAgaWNvbjogWzIyLCAyN10sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJXYWxudXQgY29va2llcyIsCiAgICAgIGRlc2M6ICJTb21lIGV4cGVydHMgaGF2ZSBwb2ludGVkIHRvIHRoZSB3YWxudXQncyBlZXJpZSByZXNlbWJsYW5jZSB0byB0aGUgaHVtYW4gYnJhaW4gYXMgYSBzaWduIG9mIGl0cyBzZW50aWVuY2UgLSBhIHRoZW9yeSBtb3N0IHdhbG51dHMgdmVoZW1lbnRseSBvYmplY3QgdG8uIiwKICAgICAgaWNvbjogWzIzLCAyN10sCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTksCiAgICB9KTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiTGFiZWwgcHJpbnRlciIsCiAgICAgIGxvYygKICAgICAgICAiTW91c2Ugb3ZlciBhbiB1cGdyYWRlIHRvIHNlZSBpdHMgdGllci48YnI+PHNtYWxsPk5vdGU6IG9ubHkgc29tZSB1cGdyYWRlcyBoYXZlIHRpZXJzLiBUaWVycyBhcmUgcHVyZWx5IGNvc21ldGljIGFuZCBoYXZlIG5vIGVmZmVjdCBvbiBnYW1lcGxheS48L3NtYWxsPiIKICAgICAgKSArCiAgICAgICAgIjxxPkFsc28gY29tZXMgaW4gcmVhbCBoYW5keSB3aGVuIHlvdSB3YW50IHRvIHRlbGwgY2F0c3VwIGFwYXJ0IGZyb20ga2V0Y2h1cC48L3E+IiwKICAgICAgNTAwMDAwMCwKICAgICAgWzI4LCAyOV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiR2VuaXVzIGFjY291bnRpbmciXTsKCiAgICBvcmRlciA9IDIwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkdvb2QgbWFubmVycyIsCiAgICAgICc8cT5BcHBhcmVudGx5IHRoZXNlIGxhZGllcyBhcmUgbXVjaCBtb3JlIGFtaWFibGUgaWYgeW91IHRha2UgdGhlIHRpbWUgdG8gbGVhcm4gdGhlaXIgc3RyYW5nZSwgYW5jaWVudCBjdXN0b21zLCB3aGljaCBzZWVtIHRvIGludm9sdmUgc2F5aW5nICJwbGVhc2UiIGFuZCAidGhhbmsgeW91IiBhbmQgc3RhcmluZyBhdCB0aGUgc3VuIHdpdGggYnVsZ2luZyBleWVzIHdoaWxlIG11dHRlcmluZyBlbGRyaXRjaCBjdXJzZXMgdW5kZXIgeW91ciBicmVhdGguPC9xPicsCiAgICAgICJHcmFuZG1hIiwKICAgICAgMTEKICAgICk7CiAgICBvcmRlciA9IDMwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkxpbmR3b3JtcyIsCiAgICAgICI8cT5Zb3UgaGF2ZSB0byBpbXBvcnQgdGhlc2UgZnJvbSBmYXIgdXAgbm9ydGgsIGJ1dCB0aGV5IHJlYWxseSBoZWxwIGFlcmF0ZSB0aGUgc29pbCE8L3E+IiwKICAgICAgIkZhcm0iLAogICAgICAxMQogICAgKTsKICAgIG9yZGVyID0gNDAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQm9yZSBhZ2FpbiIsCiAgICAgICI8cT5BZnRlciBleHRyYWN0aW5nIHNvIG11Y2ggc2VkaW1lbnQgZm9yIHNvIGxvbmcsIHlvdSd2ZSBmb3JtZWQgc29tZSB2ZXJpdGFibGUgbW91bnRhaW5zIG9mIHlvdXIgb3duIGZyb20gdGhlIGFjY3VtdWxhdGVkIHBpbGVzIG9mIHJvY2sgYW5kIGRpcnQuIFRpbWUgdG8gZGlnIHRocm91Z2ggdGhvc2UgYW5kIHNlZSBpZiB5b3UgZmluZCBhbnl0aGluZyBmdW4hPC9xPiIsCiAgICAgICJNaW5lIiwKICAgICAgMTEKICAgICk7CiAgICBvcmRlciA9IDUwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgJyJWb2x1bnRlZXIiIGludGVybnMnLAogICAgICAiPHE+SWYgeW91J3JlIGJhZCBhdCBzb21ldGhpbmcsIGFsd2F5cyBkbyBpdCBmb3IgZnJlZS48L3E+IiwKICAgICAgIkZhY3RvcnkiLAogICAgICAxMQogICAgKTsKICAgIG9yZGVyID0gNTI1OwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiUnVsZXMgb2YgYWNxdWlzaXRpb24iLAogICAgICAiPHE+UnVsZSAzODcgOiBhIGNvb2tpZSBiYWtlZCBpcyBhIGNvb2tpZSBrZXB0LjwvcT4iLAogICAgICAiQmFuayIsCiAgICAgIDExCiAgICApOwogICAgb3JkZXIgPSA1NTA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJXYXIgb2YgdGhlIGdvZHMiLAogICAgICAiPHE+QW4gaW50ZXJlc3RpbmcgZ2FtZTsgdGhlIG9ubHkgd2lubmluZyBtb3ZlIGlzIG5vdCB0byBwcmF5LjwvcT4iLAogICAgICAiVGVtcGxlIiwKICAgICAgMTEKICAgICk7CiAgICBvcmRlciA9IDU3NTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkVsZWN0cmljaXR5IiwKICAgICAgIjxxPkFuY2llbnQgbWFnaWNrcyBhbmQgZm9yYmlkZGVuIGhleGVzIHNocm91ZCB0aGlzIGFyY2FuZSBrbm93bGVkZ2UsIHdob3NlIHVuZmF0aG9tYWJsZSBwb3dlciBjYW4gbXlzdGVyaW91c2x5IHR1cm4gZGFya25lc3MgaW50byBsaWdodCBhbmQgc2hvY2sgYW4gZWxlcGhhbnQgdG8gZGVhdGguPC9xPiIsCiAgICAgICJXaXphcmQgdG93ZXIiLAogICAgICAxMQogICAgKTsKICAgIG9yZGVyID0gNjAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiVW5pdmVyc2FsIGFscGhhYmV0IiwKICAgICAgJzxxPllvdVwndmUgbWFuYWdlZCB0byBjaGFydCBhIGxhbmd1YWdlIHRoYXQgY2FuIGJlIHVuZGVyc3Rvb2QgYnkgYW55IHNlbnRpZW50IHNwZWNpZXMgaW4gdGhlIGdhbGF4eTsgaXRzIGV4Y2l0aW5nIHZvY2FidWxhcnkgY29udGFpbnMgb3ZlciA1NiB0cmlsbGlvbiB3b3JkcyB0aGF0IHNvdW5kIGFuZCBsb29rIGxpa2Ugc3BhcmtseSBidXJwcywgZm9ybWluZyBpbnRyaWNhdGUgc2VudGVuY2VzIHRoYXQgdXN1YWxseSB0cmFuc2xhdGUgdG8gc29tZXRoaW5nIGxpa2UgImdpdmUgdXMgeW91ciBjb29raWVzLCBvciBlbHNlIi48L3E+JywKICAgICAgIlNoaXBtZW50IiwKICAgICAgMTEKICAgICk7CiAgICBvcmRlciA9IDcwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlB1YmxpYyBiZXR0ZXJtZW50IiwKICAgICAgIjxxPldoeSBkbyB3ZSBrZWVwIHRyeWluZyB0byBjaGFuZ2UgdXNlbGVzcyBtYXR0ZXIgaW50byBjb29raWVzLCBvciBjb29raWVzIGludG8gZXZlbiBiZXR0ZXIgY29va2llcz8gQ2xlYXJseSwgdGhlIHdheSBvZiB0aGUgZnV0dXJlIGlzIHRvIGNoYW5nZSB0aGUgcGVvcGxlIHdobyBlYXQgdGhlIGNvb2tpZXMgaW50byBwZW9wbGUgd2l0aCBhIGdyZWF0ZXIgdW5kZXJzdGFuZGluZywgYXBwcmVjaWF0aW9uIGFuZCByZXNwZWN0IGZvciB0aGUgY29va2llcyB0aGV5J3JlIGVhdGluZy4gSW50byB0aGUgdmF0IHlvdSBnbyE8L3E+IiwKICAgICAgIkFsY2hlbXkgbGFiIiwKICAgICAgMTEKICAgICk7CiAgICBvcmRlciA9IDgwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkVtYmVkZGVkIG1pY3JvcG9ydGFscyIsCiAgICAgICI8cT5XZSd2ZSBmb3VuZCBvdXQgdGhhdCBpZiB3ZSBiYWtlIHRoZSBwb3J0YWxzIGludG8gdGhlIGNvb2tpZXMgdGhlbXNlbHZlcywgd2UgY2FuIHRyYW5zcG9ydCBwZW9wbGUncyB0YXN0ZSBidWRzIHN0cmFpZ2h0IGludG8gdGhlIHRhc3RlIGRpbWVuc2lvbiEgR29vZCB0aGluZyB5b3VyIGFybXkgb2YgbGF3eWVycyBnb3QgcmlkIG9mIHRoZSBGREEgYSB3aGlsZSBhZ28hPC9xPiIsCiAgICAgICJQb3J0YWwiLAogICAgICAxMQogICAgKTsKICAgIG9yZGVyID0gOTAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiTm9zdGFsZ2lhIiwKICAgICAgIjxxPllvdXIgdGltZSBtYWNoaW5lIHRlY2huaWNpYW5zIGluc2lzdCB0aGF0IHRoaXMgaXMgc29tZSBhZHZhbmNlZCBuZXcgdGltZSB0cmF2ZWwgdGVjaCwgYW5kIG5vdCBqdXN0IGFuIGV4aXN0aW5nIGVtb3Rpb24gdW5pdmVyc2FsIHRvIG1hbmtpbmQuIEVpdGhlciB3YXksIHlvdSBoYXZlIHRvIGFkbWl0IHRoYXQgc2VsbGluZyBwZW9wbGUgdGhlIHNhbWUgb2xkIGNvb2tpZXMganVzdCBiZWNhdXNlIGl0IHJlbWluZHMgdGhlbSBvZiB0aGUgZ29vZCBvbGQgdGltZXMgaXMgYW4gaW50ZXJlc3RpbmcgcHJvc3BlY3QuPC9xPiIsCiAgICAgICJUaW1lIG1hY2hpbmUiLAogICAgICAxMQogICAgKTsKICAgIG9yZGVyID0gMTAwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRoZSBkZWZpbml0ZSBtb2xlY3VsZSIsCiAgICAgICI8cT5Zb3VyIHNjaWVudGlzdHMgaGF2ZSBmb3VuZCBhIHdheSB0byBwYWNrIGEgY29va2llIGludG8gb25lIHNpbmdsZSBjb250aW51b3VzIG1vbGVjdWxlLCBvcGVuaW5nIGV4Y2l0aW5nIG5ldyBwcm9zcGVjdHMgaW4gYm90aCBzdG9yYWdlIGFuZCBmbGF2b3IgZGVzcGl0ZSB0aGUgZmFjdCB0aGF0IHRoZXNlIHRha2UgdXAgdG8gYSB3aG9sZSB5ZWFyIHRvIGRpZ2VzdC48L3E+IiwKICAgICAgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwKICAgICAgMTEKICAgICk7CiAgICBvcmRlciA9IDExMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJMaWdodCBjYXB0dXJlIG1lYXN1cmVzIiwKICAgICAgIjxxPkFzIHRoZSB1bml2ZXJzZSBnZXRzIGV2ZXIgc28gc2xpZ2h0bHkgZGltbWVyIGR1ZSB0byB5b3UgY29udmVydGluZyBtb3JlIGFuZCBtb3JlIG9mIGl0cyBsaWdodCBpbnRvIGNvb2tpZXMsIHlvdSd2ZSB0YWtlbiB0byBmaW5kaW5nIG5ldyBhbmQgdW5leHBsb3JlZCBzb3VyY2VzIG9mIGxpZ2h0IGZvciB5b3VyIHByaXNtczsgZm9yIGluc3RhbmNlLCB0aGUgd2FybSBnbG93IGVtaXR0ZWQgYnkgYSBwcmVnbmFudCB3b21hbiwgb3IgdGhlIHR3aW5rbGUgaW4gdGhlIGV5ZSBvZiBhIGhvcGVmdWwgY2hpbGQuPC9xPiIsCiAgICAgICJQcmlzbSIsCiAgICAgIDExCiAgICApOwogICAgb3JkZXIgPSAxMjAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiMC1zaWRlZCBkaWNlIiwKICAgICAgIjxxPlRoZSBhZHZlbnQgb2YgdGhlIDAtc2lkZWQgZGljZSBoYXMgaGFkIHVuZXhwZWN0ZWQgYW5kIHR1bXVsdHVvdXMgZWZmZWN0cyBvbiB0aGUgZ2FtYmxpbmcgY29tbXVuaXR5LCBhbmQgc2F3IGV4cGVydHMgYXJvdW5kIHRoZSB3b3JsZCBjYWxsaW5nIHlvdSBib3RoIGEgZ2VuaXVzIGFuZCBhbiBpbWJlY2lsZS48L3E+IiwKICAgICAgIkNoYW5jZW1ha2VyIiwKICAgICAgMTEKICAgICk7CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkhlcmFsZHMiLAogICAgICBsb2MoCiAgICAgICAgIllvdSBub3cgYmVuZWZpdCBmcm9tIHRoZSBib29zdCBwcm92aWRlZCBieSA8Yj5oZXJhbGRzPC9iPi48YnI+RWFjaCBoZXJhbGQgZ2l2ZXMgeW91IDxiPisxJSBDcFM8L2I+Ljxicj5Mb29rIG9uIHRoZSBwdXJwbGUgZmxhZyBhdCB0aGUgdG9wIHRvIHNlZSBob3cgbWFueSBoZXJhbGRzIGFyZSBhY3RpdmUgYXQgYW55IGdpdmVuIHRpbWUuIgogICAgICApICsKICAgICAgICAoQXBwCiAgICAgICAgICA/ICI8cT5JdCdzIGdldHRpbmcgc3RlYW15LjwvcT4iCiAgICAgICAgICA6ICI8cT5CZSBleGNlbGxlbnQgdG8gZWFjaCBvdGhlci48YnI+QW5kIFBhdHJlb24sIGR1ZGVzITwvcT4iKSwKICAgICAgMTAwLAogICAgICBbMjEsIDI5XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKCiAgICBvcmRlciA9IDI1NTsKICAgIEdhbWUuR3JhbmRtYVN5bmVyZ3koCiAgICAgICJNZXRhZ3JhbmRtYXMiLAogICAgICAiQSBmcmFjdGFsIGdyYW5kbWEgdG8gbWFrZSBtb3JlIGdyYW5kbWFzIHRvIG1ha2UgbW9yZSBjb29raWVzLiIsCiAgICAgICJGcmFjdGFsIGVuZ2luZSIKICAgICk7CgogICAgb3JkZXIgPSAxMzAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiTWV0YWJha2VyaWVzIiwKICAgICAgIjxxPlRoZXkgcHJhY3RpY2FsbHkgYmFrZSB0aGVtc2VsdmVzITwvcT4iLAogICAgICAiRnJhY3RhbCBlbmdpbmUiLAogICAgICAxCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiTWFuZGVsYnJvd24gc3VnYXIiLAogICAgICAiPHE+QSBzdWJzdGFuY2UgdGhhdCBkaXNwbGF5cyB1c2VmdWwgcHJvcGVydGllcyBzdWNoIGFzIGZyYWN0YWwgc3dlZXRuZXNzIGFuZCBpbnN0YW50IGNvbnRhY3QgbGV0aGFsaXR5LjwvcT4iLAogICAgICAiRnJhY3RhbCBlbmdpbmUiLAogICAgICAyCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRnJhY3RvaWRzIiwKICAgICAgIjxxPkhlcmUncyBhIGZydW4gZnJhY3QgOiBhbGwgaW4gYWxsLCB0aGVzZSB3ZXJlIGEgdGVycmlibGUgaWRlYS48L3E+IiwKICAgICAgIkZyYWN0YWwgZW5naW5lIiwKICAgICAgMwogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIk5lc3RlZCB1bml2ZXJzZSB0aGVvcnkiLAogICAgICAiPHE+QXNzZXJ0cyB0aGF0IGVhY2ggc3ViYXRvbWljIHBhcnRpY2xlIGlzIGhvc3QgdG8gYSB3aG9sZSBuZXcgdW5pdmVyc2UsIGFuZCB0aGVyZWZvcmUsIGFub3RoZXIgbGltaXRsZXNzIHF1YW50aXR5IG9mIGNvb2tpZXMuPGJyPlRoaXMgc29tZWhvdyBzdGFja3Mgd2l0aCB0aGUgdGhlb3J5IG9mIG5hbm9jb3NtaWNzLCBiZWNhdXNlIHBoeXNpY3MuPC9xPiIsCiAgICAgICJGcmFjdGFsIGVuZ2luZSIsCiAgICAgIDQKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJNZW5nZXIgc3BvbmdlIGNha2UiLAogICAgICAiPHE+RnJpZ2h0ZW5pbmdseSBhYnNvcmJlbnQgdGhhbmtzIHRvIGl0cyB2aXJ0dWFsbHkgaW5maW5pdGUgc3VyZmFjZSBhcmVhLiBLZWVwIGl0IGlzb2xhdGVkIGluIGEgZHJ5IGNoYW1iZXIsIG5ldmVyIGhhbmRsZSBpdCB3aXRoIGFuIG9wZW4gd291bmQsIGFuZCBkbyBub3QgZXZlciBsZXQgaXQgdG91Y2ggYSBib2R5IG9mIHdhdGVyLjwvcT4iLAogICAgICAiRnJhY3RhbCBlbmdpbmUiLAogICAgICA1CiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiT25lIHBhcnRpY3VsYXJseSBnb29kLWh1bW9yZWQgY293IiwKICAgICAgIjxxPlRoaXMgdW5hc3N1bWluZyBib3ZpbmUgd2FzIGV4Y3J1Y2lhdGluZ2x5IGV4cGVuc2l2ZSBhbmQgaXQgbWF5IHNlZW0gYXQgZmlyc3QgbGlrZSB5b3Ugd2VyZSByaXBwZWQgb2ZmLiBPbiBjbG9zZXIgaW5zcGVjdGlvbiBob3dldmVyLCB5b3Ugbm90aWNlIHRoYXQgaXRzIGVhcnJpbmdzIChpdCdzIHdlYXJpbmcgZWFycmluZ3MpIGFyZSBhY3R1YWxseSBmdWxseSBmdW5jdGlvbmFsIGNvcGllcyBvZiBpdHNlbGYsIGVhY2ggb2Ygd2hpY2ggYWxzbyB3ZWFyaW5nIHRoZWlyIG93biBjb3cgZWFycmluZ3MsIGFuZCBzbyBvbiwgaW5maW5pdGVseS4gSXQgYXBwZWFycyB5b3VyIGRhaXJ5IGNvbmNlcm5zIHdpbGwgYmUgdGFrZW4gY2FyZSBvZiBmb3IgYSB3aGlsZSwgYWx0aG91Z2ggeW91J2xsIGhhdmUgdG8gcHV0IHVwIHdpdGggdGhlIGNvdydzIGFubm95aW5nIHNuaWNrZXJpbmcuPC9xPiIsCiAgICAgICJGcmFjdGFsIGVuZ2luZSIsCiAgICAgIDYKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJDaG9jb2xhdGUgb3Vyb2Jvcm9zIiwKICAgICAgIjxxPkZvcmV2ZXIgZWF0aW5nIGl0cyBvd24gdGFpbCBhbmQgZGlnZXN0aW5nIGl0c2VsZiwgaW4gYSBtZXRhYm9saWNhbGx5IGR1YmlvdXMgdGFsZSBvZiBkZWxpY2lvdXMgdHJhZ2VkeS48L3E+IiwKICAgICAgIkZyYWN0YWwgZW5naW5lIiwKICAgICAgNwogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIk5lc3RlZCIsCiAgICAgICI8cT5DbGV2ZXIgc2VsZi1yZWZlcmVuY2Ugb3Igc2hhbWVmdWwgY3Jvc3MtcHJvbW90aW9uPyBUaGlzIHVwZ3JhZGUgYXBwYXJlbnRseSBoYXMgdGhlIGdhbGwgdG8gYWR2ZXJ0aXNlIGEgbGluayB0byA8dT5vcnRlaWwuZGFzaG5ldC5vcmcvbmVzdGVkPC91PiwgaW4gYSB0b29sdGlwIHlvdSBjYW4ndCBldmVuIGNsaWNrLjwvcT4iLAogICAgICAiRnJhY3RhbCBlbmdpbmUiLAogICAgICA4CiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiU3BhY2UtZmlsbGluZyBmaWJlcnMiLAogICAgICAiPHE+VGhpcyBzcGVjaWFsIGluZ3JlZGllbnQgaGFzIHRoZSBpbmNyZWRpYmxlIGFiaWxpdHkgdG8gZmlsbCB0aGUgbG9jYWwgc3BhY2UgcGVyZmVjdGx5LCBlZmZlY3RpdmVseSBlcmFkaWNhdGluZyBodW5nZXIgaW4gdGhvc2Ugd2hvIGNvbnN1bWUgaXQhPGJyPktub3dpbmcgdGhhdCBubyBodW5nZXIgbWVhbnMgbm8gbmVlZCBmb3IgY29va2llcywgeW91ciBtYXJrZXRlcnMgdXJnZSB5b3UgdG8gcmVwdXJwb3NlIHRoaXMgcHJvZHVjdCBpbnRvIG5leHQtbGV2ZWwgcGFja2luZyBwZWFudXRzLjwvcT4iLAogICAgICAiRnJhY3RhbCBlbmdpbmUiLAogICAgICA5CiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKCJFbmRsZXNzIGJvb2sgb2YgcHJvc2UiLCAiIiwgIkZyYWN0YWwgZW5naW5lIiwgMTApOwogICAgaWYgKEVOKSB7CiAgICAgIEdhbWUubGFzdC5kZXNjRnVuYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgc3RyID0KICAgICAgICAgICciVGhlcmUgb25jZSB3YXMgYSBiYWtlciBuYW1lZCAnICsKICAgICAgICAgIEdhbWUuYmFrZXJ5TmFtZSArCiAgICAgICAgICAiLiBPbmUgZGF5LCB0aGVyZSB3YXMgYSBrbm9jayBhdCB0aGUgZG9vcjsgIiArCiAgICAgICAgICBHYW1lLmJha2VyeU5hbWUgKwogICAgICAgICAgIiBvcGVuZWQgaXQgYW5kIHdhcyBzdWRkZW5seSBmYWNlLXRvLWZhY2Ugd2l0aCBhIHN0cmFuZ2UgYW5kIG1lbmFjaW5nIG9sZCBncmFuZG1hLiBUaGUgZ3JhbmRtYSBvcGVuZWQgaGVyIG1vdXRoIGFuZCwgaW4gYSBzdHJhbmdlIGxpdHRsZSB2b2ljZSwgc3RhcnRlZCByZWNpdGluZyB0aGlzIHN0cmFuZ2UgbGl0dGxlIHRhbGUgOiAiOwogICAgICAgIHZhciBuID0gMzU7CiAgICAgICAgdmFyIGkgPSBNYXRoLmZsb29yKEdhbWUuVCAqIDAuMSk7CiAgICAgICAgcmV0dXJuICgKICAgICAgICAgIHRoaXMuZGVzYyArCiAgICAgICAgICAnPHEgc3R5bGU9ImZvbnQtZmFtaWx5OkNvdXJpZXI7Ij4nICsKICAgICAgICAgIChzdHIuc3Vic3RyKGkgJSBzdHIubGVuZ3RoLCBuKSArCiAgICAgICAgICAgIChpICUgc3RyLmxlbmd0aCA+IHN0ci5sZW5ndGggLSBuCiAgICAgICAgICAgICAgPyBzdHIuc3Vic3RyKDAsIChpICUgc3RyLmxlbmd0aCkgLSAoc3RyLmxlbmd0aCAtIG4pKQogICAgICAgICAgICAgIDogIiIpKSArCiAgICAgICAgICAiPC9xPiIKICAgICAgICApOwogICAgICB9OwogICAgfSBlbHNlIEdhbWUubGFzdC5kZXNjID0gIjxxPi08L3E+IjsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRoZSBzZXQgb2YgYWxsIHNldHMiLAogICAgICAiPHE+VGhlIGFuc3dlciwgb2YgY291cnNlLCBpcyBhIGRlZmluaXRlIG1heWJlLjwvcT4iLAogICAgICAiRnJhY3RhbCBlbmdpbmUiLAogICAgICAxMQogICAgKTsKCiAgICBvcmRlciA9IDUwMDA7CiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlKAogICAgICAiUmVjdXJzaXZlIG1pcnJvcnMiLAogICAgICAiPHE+RG8geW91IGhhdmUgYW55IGlkZWEgd2hhdCBoYXBwZW5zIHdoZW4geW91IHBvaW50IHR3byBvZiB0aGVzZSBhdCBlYWNoIG90aGVyPyBBcHBhcmVudGx5LCB0aGUgdW5pdmVyc2UgZG9lc24ndCBlaXRoZXIuPC9xPiIsCiAgICAgICJGcmFjdGFsIGVuZ2luZSIsCiAgICAgICJQcmlzbSIsCiAgICAgICJzeW5lcmd5MSIKICAgICk7CiAgICAvL0dhbWUuU3luZXJneVVwZ3JhZGUoJ0NvbXBvdW5kZWQgb2RkcycsJzxxPldoZW4gcHJvYmFiaWxpdGllcyBzdGFydCBjYXNjYWRpbmcsICJuZXZlciBpbiBhIGJpbGxpb24gbGlmZXRpbWVzIiBzdGFydHMgbG9va2luZyB0ZXJyaWJseSBsaWtlICJwcm9iYWJseSBiZWZvcmUgTW9uZGF5IGNvbWVzIGFyb3VuZCIuPC9xPicsJ0ZyYWN0YWwgZW5naW5lJywnQ2hhbmNlbWFrZXInLCdzeW5lcmd5MScpOwogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIk1pY2UgY2xpY2tpbmcgbWljZSIsCiAgICAgICIiLAogICAgICAiRnJhY3RhbCBlbmdpbmUiLAogICAgICAiQ3Vyc29yIiwKICAgICAgInN5bmVyZ3kyIgogICAgKTsKICAgIGlmIChFTikgewogICAgICBHYW1lLmxhc3QuZGVzY0Z1bmMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgTWF0aC5zZWVkcmFuZG9tKEdhbWUuc2VlZCArICItYmxhc3BoZW1vdXNlIik7CiAgICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPCAwLjMpIHsKICAgICAgICAgIE1hdGguc2VlZHJhbmRvbSgpOwogICAgICAgICAgcmV0dXJuIHRoaXMuZGVzYyArICI8cT5BYnNvbHV0ZWx5IGJsYXNwaGVtb3VzZSE8L3E+IjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgTWF0aC5zZWVkcmFuZG9tKCk7CiAgICAgICAgICByZXR1cm4gdGhpcy5kZXNjICsgIjxxPkFic29sdXRlbHkgYmxhc3BoZW1vdXMhPC9xPiI7CiAgICAgICAgfQogICAgICB9OwogICAgfSBlbHNlIEdhbWUubGFzdC5kZXNjID0gIjxxPi08L3E+IjsKCiAgICBvcmRlciA9IDEwMDIwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkN1c3RhcmQgY3JlYW1zIiwKICAgICAgZGVzYzogIkJyaXRpc2ggbG9yZSBwaXRzIHRoZXNlIGluIGEgbWVyY2lsZXNzIHdhciBhZ2FpbnN0IGJvdXJib24gYmlzY3VpdHMuPGJyPlRoZSBmaWxsaW5nIGV2b2tlcyB2YW5pbGxhIHdpdGhvdXQgcXVpdGUgYXBwcm9hY2hpbmcgaXQuPGJyPlRoZXkncmUgdGFzdGllciBvbiB0aGUgaW5zaWRlISIsCiAgICAgIGljb246IFsyMywgMjldLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQm91cmJvbiBiaXNjdWl0cyIsCiAgICAgIGRlc2M6ICJUd28gY2hvY29sYXRlIGJpc2N1aXRzIGpvaW5lZCB0b2dldGhlciB3aXRoIGV2ZW4gbW9yZSBjaG9jb2xhdGUuPGJyPlRoZSBzd29ybiByaXZhbHMgb2YgY3VzdGFyZCBjcmVhbXMsIGFzIGxlZ2VuZCBoYXMgaXQuIiwKICAgICAgaWNvbjogWzI0LCAyOV0sCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTksCiAgICB9KTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiS2VlcHNha2VzIiwKICAgICAgbG9jKAogICAgICAgICJTZWFzb25hbCByYW5kb20gZHJvcHMgaGF2ZSBhIDxiPjEvNSBjaGFuY2U8L2I+IHRvIGNhcnJ5IG92ZXIgdGhyb3VnaCBhc2NlbnNpb25zLiIKICAgICAgKSArICI8cT5DaGVyaXNoIHRoZSBtZW1vcmllcy48L3E+IiwKICAgICAgMTExMTExMTExMSwKICAgICAgWzIyLCAyOV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsKICAgICAgIlN0YXJzbm93IiwKICAgICAgIlN0YXJsb3ZlIiwKICAgICAgIlN0YXJ0ZXJyb3IiLAogICAgICAiU3RhcnRyYWRlIiwKICAgICAgIlN0YXJzcGF3biIsCiAgICBdOwoKICAgIG9yZGVyID0gMTAwMjA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiTWluaS1jb29raWVzIiwKICAgICAgZGVzYzogIkhhdmUgeW91IGV2ZXIgbm90aWNlZCBob3cgdGhlIHNtYWxsZXIgc29tZXRoaW5nIGlzLCB0aGUgZWFzaWVyIGl0IGlzIHRvIGJpbmdlIG9uIGl0PyIsCiAgICAgIGljb246IFsyOSwgMzBdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJTdWdhciBjcnlzdGFsIGNvb2tpZXMiLAogICAgICAoRU4KICAgICAgICA/ICJDb29raWUgcHJvZHVjdGlvbiBtdWx0aXBsaWVyIDxiPis1JSBwZXJtYW5lbnRseTwvYj4sIGFuZCA8Yj4rMSU8L2I+IGZvciBldmVyeSBidWlsZGluZyB0eXBlIGxldmVsIDEwIG9yIGhpZ2hlci4iCiAgICAgICAgOiBsb2MoIkNvb2tpZSBwcm9kdWN0aW9uIG11bHRpcGxpZXIgPGI+KyUxJSBwZXJtYW5lbnRseTwvYj4uIiwgNSkgKwogICAgICAgICAgIjxicj4iICsKICAgICAgICAgIGxvYygKICAgICAgICAgICAgIkNvb2tpZSBwcm9kdWN0aW9uIG11bHRpcGxpZXIgPGI+KyUxJTwvYj4gZm9yIGV2ZXJ5IGJ1aWxkaW5nIHR5cGUgbGV2ZWwgJTIgb3IgaGlnaGVyLiIsCiAgICAgICAgICAgIFsxLCAxMF0KICAgICAgICAgICkpICsKICAgICAgICAiPHE+SW5mdXNlZCB3aXRoIGNvc21pYyBzd2VldG5lc3MuIEl0IGdpdmVzIG9mZiBhIGZhaW50IHNoaW1tZXJ5IHNvdW5kIHdoZW4geW91IGhvbGQgaXQgdXAgdG8geW91ciBlYXIuPC9xPiIsCiAgICAgIDEwMDAwMDAwMDAsCiAgICAgIFsyMSwgMzBdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIlN1Z2FyIGJha2luZyJdOwogICAgR2FtZS5sYXN0LnBvd2VyID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgbiA9IDU7CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKSB7CiAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1tpXS5sZXZlbCA+PSAxMCkgbisrOwogICAgICB9CiAgICAgIHJldHVybiBuOwogICAgfTsKICAgIEdhbWUubGFzdC5wc2V1ZG9Db29raWUgPSB0cnVlOwogICAgR2FtZS5sYXN0LmRlc2NGdW5jID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgbiA9IDU7CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKSB7CiAgICAgICAgaWYgKEdhbWUuT2JqZWN0c1tpXS5sZXZlbCA+PSAxMCkgbisrOwogICAgICB9CiAgICAgIHJldHVybiAoCiAgICAgICAgJzxkaXYgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyI+JyArCiAgICAgICAgbG9jKCJDdXJyZW50OiIpICsKICAgICAgICAiIDxiPisiICsKICAgICAgICBCZWF1dGlmeShuKSArCiAgICAgICAgJyU8L2I+PGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+PC9kaXY+JyArCiAgICAgICAgdGhpcy5kZGVzYwogICAgICApOwogICAgfTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJCb3ggb2YgbWF5YmUgY29va2llcyIsCiAgICAgIGxvYygiQ29udGFpbnMgYW4gYXNzb3J0bWVudCBvZi4uLnNvbWV0aGluZy4iKSArCiAgICAgICAgIjxxPlRoZXNlIG1heSBvciBtYXkgbm90IGJlIGNvbnNpZGVyZWQgY29va2llcy48L3E+IiwKICAgICAgMzMzMDAwMDAwMDAwLAogICAgICBbMjUsIDI5XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJTdWdhciBjcnlzdGFsIGNvb2tpZXMiXTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJCb3ggb2Ygbm90IGNvb2tpZXMiLAogICAgICBsb2MoIkNvbnRhaW5zIGFuIGFzc29ydG1lbnQgb2YuLi5zb21ldGhpbmcuIikgKwogICAgICAgICI8cT5UaGVzZSBhcmUgc3RyaWN0bHksIGRlZmluaXRlbHkgbm90IGNvb2tpZXMuPC9xPiIsCiAgICAgIDMzMzAwMDAwMDAwMCwKICAgICAgWzI2LCAyOV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiU3VnYXIgY3J5c3RhbCBjb29raWVzIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQm94IG9mIHBhc3RyaWVzIiwKICAgICAgbG9jKCJDb250YWlucyBhbiBhc3NvcnRtZW50IG9mIGRlbGljaW91cyBwYXN0cmllcy4iKSArCiAgICAgICAgIjxxPlRoZXNlIGFyZSBhIGRhbW4gc2xpcHBlcnkgc2xvcGUgaXMgd2hhdCB0aGV5IGFyZSE8L3E+IiwKICAgICAgMzMzMDAwMDAwMDAwLAogICAgICBbMjcsIDI5XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJTdWdhciBjcnlzdGFsIGNvb2tpZXMiXTsKCiAgICBvcmRlciA9IDEwMDQwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlByb2ZpdGVyb2xlcyIsCiAgICAgIGRlc2M6ICJBbHNvIGtub3duIGFzIGNyZWFtIHB1ZmZzLCB0aGVzZSBwYXN0cmllcyBhcmUgbGlnaHQsIGZsdWZmeSwgZmlsbGVkIHdpdGggd2hpcHBlZCBjcmVhbSBhbmQgZnVuIHRvIHRocm93IGF0IHBlb3BsZSB3aGVuIHNub3diYWxscyBhcmUgcnVubmluZyBzY2FyY2UuIiwKICAgICAgaWNvbjogWzI5LCAyOV0sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgcGFzdHJpZXMiLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IE1hdGgucG93KDEwLCAzMSksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJKZWxseSBkb251dCIsCiAgICAgIGRlc2M6ICJHdWFyYW50ZWVkIHRvIGNvbnRhaW4gYXQgbGVhc3QgMC4zJSBqZWxseSBmaWxsaW5nLCBvciB5b3VyIG1vbmV5IGJhY2suPGJyPllvdSBjYW4gc3RpbGwgc2VlIHRoZSBqZWxseSBzdGFiIHdvdW5kISIsCiAgICAgIGljb246IFsyNywgMjhdLAogICAgICByZXF1aXJlOiAiQm94IG9mIHBhc3RyaWVzIiwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiBNYXRoLnBvdygxMCwgMzMpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiR2xhemVkIGRvbnV0IiwKICAgICAgZGVzYzogIkFic29sdXRlbHkgZ29vZXkgd2l0aCBzdWdhci4gVGhlIGhvbGUgaXMgdGhlIHRhc3RpZXN0IHBhcnQhIiwKICAgICAgaWNvbjogWzI4LCAyOF0sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgcGFzdHJpZXMiLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IE1hdGgucG93KDEwLCAzNSksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJDaG9jb2xhdGUgY2FrZSIsCiAgICAgIGRlc2M6ICJUaGUgY2FrZSBpcyBhIFBvcnRhbCByZWZlcmVuY2UhIiwKICAgICAgaWNvbjogWzI1LCAyN10sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgcGFzdHJpZXMiLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IE1hdGgucG93KDEwLCAzNyksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJTdHJhd2JlcnJ5IGNha2UiLAogICAgICBkZXNjOiAiSXQncyBub3QgZWFzeSB0byBjb21lIHVwIHdpdGggZmxhdm9yIHRleHQgZm9yIHNvbWV0aGluZyBhcyBnZW5lcmljIGFzIHRoaXMsIGJ1dCBzb21lIHdvdWxkIHNheSBpdCdzIGEgcGllY2Ugb2YgY2FrZS4iLAogICAgICBpY29uOiBbMjYsIDI3XSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBwYXN0cmllcyIsCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogTWF0aC5wb3coMTAsIDM5KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkFwcGxlIHBpZSIsCiAgICAgIGRlc2M6ICJJdCBpcyBzYWlkIHRoYXQgc29tZSBncmFuZG1hcyBnbyByb2d1ZSBhbmQgYmFrZSB0aGVzZSBpbnN0ZWFkLiIsCiAgICAgIGljb246IFsyNSwgMjhdLAogICAgICByZXF1aXJlOiAiQm94IG9mIHBhc3RyaWVzIiwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiBNYXRoLnBvdygxMCwgNDEpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiTGVtb24gbWVyaW5ndWUgcGllIiwKICAgICAgZGVzYzogIk1lcmluZ3VlIGlzIGEgZmluaWNreSBzdWJzdGFuY2UgbWFkZSBvZiBzdWdhciBhbmQgZWdnIHdoaXRlcyB0aGF0IHJlcXVpcmVzIHNwZWNpZmljIGF0bW9zcGhlcmljIGNvbmRpdGlvbnMgdG8gYmUgYmFrZWQgYXQgYWxsLiBUaGUgbGVtb24sIGFzIGZhciBhcyB3ZSBjYW4gdGVsbCwgaXNuJ3QgbmVhcmx5IGFzIHBpY2t5LiIsCiAgICAgIGljb246IFsyNiwgMjhdLAogICAgICByZXF1aXJlOiAiQm94IG9mIHBhc3RyaWVzIiwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiBNYXRoLnBvdygxMCwgNDMpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQnV0dGVyIGNyb2lzc2FudCIsCiAgICAgIGRlc2M6ICJMb29rIGFyb3VuZC48YnI+QSBydWRlIG1hbiBpbiBhIHN0cmlwZWQgc2hpcnQgYmlrZXMgcGFzdCB5b3UuIEhlIHNtZWxscyBvZiBjaWdhcmV0dGVzIGFuZCBjYWYmZWFjdXRlOy1hdS1sYWl0LiBTb21ld2hlcmUsIGEgbWltZSB1c2VzIGhpcyBtb3VzdGFjaGUgdG8gbWFrZSBmdW4gb2YgdGhlIEJyaXRpc2guIDMwMCBwaWdlb25zIGZseSBvdmVyaGVhZC48YnI+UmVsYXguIFlvdSdyZSBleHBlcmllbmNpbmcgY3JvaXNzYW50LiIsCiAgICAgIGljb246IFsyOSwgMjhdLAogICAgICByZXF1aXJlOiAiQm94IG9mIHBhc3RyaWVzIiwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiBNYXRoLnBvdygxMCwgNDUpLAogICAgfSk7CgogICAgb3JkZXIgPSAxMDA1MDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJDb29raWUgZG91Z2giLAogICAgICBkZXNjOiAiQnVyc3Rpbmcgd2l0aCBpbmZpbml0ZSBwb3RlbnRpYWwsIGJ1dCBjYW4gYWxzbyBiZSBlYXRlbiBhcyBpcy4gQXJndWFibHkgd29ydGggdGhlIHNhbG1vbmVsbGEuIiwKICAgICAgaWNvbjogWzI1LCAzMF0sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2YgbWF5YmUgY29va2llcyIsCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogTWF0aC5wb3coMTAsIDM1KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkJ1cm50IGNvb2tpZSIsCiAgICAgIGRlc2M6ICJUaGlzIGNvb2tpZSBmbGV3IHRvbyBjbG9zZSB0byB0aGUgc3VuIGFuZCBpcyBub3cgYSBzaGFkb3cgb2YgaXRzIGZvcm1lciBzZWxmLiBJZiBvbmx5IHlvdSByZW1lbWJlcmVkIHRvIHNldCBhIHRpbWVyLCB5b3Ugd291bGRuJ3QgaGF2ZSB0aGlzIHRyYWdlZHkgb24geW91ciBoYW5kcy4uLiIsCiAgICAgIGljb246IFsyMywgMzBdLAogICAgICByZXF1aXJlOiAiQm94IG9mIG1heWJlIGNvb2tpZXMiLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IE1hdGgucG93KDEwLCAzNyksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJBIGNob2NvbGF0ZSBjaGlwIGNvb2tpZSBidXQgd2l0aCB0aGUgY2hpcHMgcGlja2VkIG9mZiBmb3Igc29tZSByZWFzb24iLAogICAgICBkZXNjOiAiVGhpcyBoYXMgdG8gYmUgdGhlIHNhZGRlc3QgdGhpbmcgeW91J3ZlIGV2ZXIgc2Vlbi4iLAogICAgICBpY29uOiBbMjQsIDMwXSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBtYXliZSBjb29raWVzIiwKICAgICAgcG93ZXI6IDMsCiAgICAgIHByaWNlOiBNYXRoLnBvdygxMCwgMzkpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiRmxhdm9yIHRleHQgY29va2llIiwKICAgICAgZGVzYzogIldoYXQgeW91J3JlIGN1cnJlbnRseSByZWFkaW5nIGlzIHdoYXQgZ2l2ZXMgdGhpcyBjb29raWUgaXRzIGluaW1pdGFibGUgZmxhdm9yLiIsCiAgICAgIGljb246IFsyMiwgMzBdLAogICAgICByZXF1aXJlOiAiQm94IG9mIG1heWJlIGNvb2tpZXMiLAogICAgICBwb3dlcjogNCwKICAgICAgcHJpY2U6IE1hdGgucG93KDEwLCA0MSksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJIaWdoLWRlZmluaXRpb24gY29va2llIiwKICAgICAgZGVzYzogIlVuY29tZm9ydGFibHkgZGV0YWlsZWQsIGxpa2UgdGhvc2Ugd2VpcmQgc3RvcmllcyB5b3VyIGF1bnQga2VlcHMgdGVsbGluZyBhdCBwYXJ0aWVzLiIsCiAgICAgIGljb246IFsyOCwgMTBdLAogICAgICByZXF1aXJlOiAiQm94IG9mIG1heWJlIGNvb2tpZXMiLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IE1hdGgucG93KDEwLCA0MyksCiAgICB9KTsKCiAgICBvcmRlciA9IDEwMDYwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlRvYXN0IiwKICAgICAgZGVzYzogIkEgY3Jpc3Agc2xpY2Ugb2YgYnJlYWQsIGJlZ2dpbmcgZm9yIHNvbWUgYnV0dGVyIGFuZCBqYW0uPGJyPldoeSBkbyBwZW9wbGUga2VlcCBwcm9wb3NpbmcgdGhlc2UgYXQgcGFydGllcz8iLAogICAgICBpY29uOiBbMjcsIDEwXSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBub3QgY29va2llcyIsCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogTWF0aC5wb3coMTAsIDM0KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlBlYW51dCBidXR0ZXIgJiBqZWxseSIsCiAgICAgIGRlc2M6ICJJdCdzIHRpbWUuIiwKICAgICAgaWNvbjogWzI5LCA5XSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBub3QgY29va2llcyIsCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogTWF0aC5wb3coMTAsIDM2KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIldvb2tpZXMiLAogICAgICBkZXNjOiAiVGhlc2UgYXJlbid0IHRoZSBjb29raWVzIHlvdSdyZSBsb29raW5nIGZvci4iLAogICAgICBpY29uOiBbMjYsIDMwXSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBub3QgY29va2llcyIsCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogTWF0aC5wb3coMTAsIDM4KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkNoZWVzZWJ1cmdlciIsCiAgICAgIGRlc2M6ICJBYnNvbHV0ZWx5IG5vIHJlbGF0aW9uIHRvIGNvb2tpZXMgd2hhdHNvZXZlciAtIE9ydGVpbCBqdXN0IHdhbnRlZCBhbiBleGN1c2UgdG8gZHJhdyBhIGNoZWVzZWJ1cmdlci4iLAogICAgICBpY29uOiBbMjgsIDMwXSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBub3QgY29va2llcyIsCiAgICAgIHBvd2VyOiA0LAogICAgICBwcmljZTogTWF0aC5wb3coMTAsIDQwKSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIk9uZSBsb25lIGNob2NvbGF0ZSBjaGlwIiwKICAgICAgZGVzYzogIlRoZSBzdGFydCBvZiBzb21ldGhpbmcgYmVhdXRpZnVsLiIsCiAgICAgIGljb246IFsyNywgMzBdLAogICAgICByZXF1aXJlOiAiQm94IG9mIG5vdCBjb29raWVzIiwKICAgICAgcG93ZXI6IDEsCiAgICAgIHByaWNlOiBNYXRoLnBvdygxMCwgNDIpLAogICAgfSk7CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkdlbml1cyBhY2NvdW50aW5nIiwKICAgICAgbG9jKAogICAgICAgICJVbmxvY2tzIDxiPmV4dHJhIHByaWNlIGluZm9ybWF0aW9uPC9iPi48YnI+RWFjaCBkaXNwbGF5ZWQgY29zdCBub3cgc3BlY2lmaWVzIGhvdyBsb25nIGl0J2xsIHRha2UgeW91IHRvIGFmZm9yZCBpdCwgYW5kIGhvdyBtdWNoIG9mIHlvdXIgYmFuayBpdCByZXByZXNlbnRzLiIKICAgICAgKSArICI8cT5UaGVyZSdzIG5vIGFjY291bnRpbmcgZm9yIHRhc3RlLCBhbmQgeWV0IGhlcmUgd2UgYXJlLjwvcT4iLAogICAgICAyMDAwMDAwLAogICAgICBbMTEsIDEwXQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJJbnNwaXJlZCBjaGVja2xpc3QiXTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiU2hpbW1lcmluZyB2ZWlsIiwKICAgICAgbG9jKAogICAgICAgICJVbmxvY2tzIHRoZSA8Yj5zaGltbWVyaW5nIHZlaWw8L2I+LCBhIHN3aXRjaCB0aGF0IHBhc3NpdmVseSBib29zdHMgeW91ciBDcFMgYnkgPGI+JTElPC9iPi48YnI+WW91IHN0YXJ0IHdpdGggdGhlIHZlaWwgdHVybmVkIG9uOyBob3dldmVyLCBpdCBpcyB2ZXJ5IGZyYWdpbGUsIGFuZCBjbGlja2luZyB0aGUgYmlnIGNvb2tpZSBvciBhbnkgZ29sZGVuIGNvb2tpZSBvciByZWluZGVlciB3aWxsIHR1cm4gaXQgb2ZmLCByZXF1aXJpbmcgJTIgb2YgQ3BTIHRvIHR1cm4gYmFjayBvbi4iLAogICAgICAgIFs1MCwgR2FtZS5zYXlUaW1lKDI0ICogNjAgKiA2MCAqIEdhbWUuZnBzLCAyKV0KICAgICAgKSArICI8cT5IYW5kcyBvZmYhPC9xPiIsCiAgICAgIDk5OTk5OTk5OSwKICAgICAgWzksIDEwXQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJEaXN0aWxsZWQgZXNzZW5jZSBvZiByZWRvdWJsZWQgbHVjayJdOwoKICAgIG9yZGVyID0gNDAwMDU7CiAgICB2YXIgZnVuYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGJvb3N0ID0gR2FtZS5nZXRWZWlsQm9vc3QoKTsKICAgICAgdmFyIHJlc2lzdCA9IEdhbWUuZ2V0VmVpbERlZmVuc2UoKTsKICAgICAgcmV0dXJuICgKICAgICAgICAodGhpcy5uYW1lID09ICJTaGltbWVyaW5nIHZlaWwgW29uXSIKICAgICAgICAgID8gJzxkaXYgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyI+JyArCiAgICAgICAgICAgIGxvYygiQWN0aXZlLiIpICsKICAgICAgICAgICAgJzwvZGl2PjxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicKICAgICAgICAgIDogIiIpICsKICAgICAgICBsb2MoCiAgICAgICAgICAiQm9vc3RzIHlvdXIgY29va2llIHByb2R1Y3Rpb24gYnkgPGI+JTElPC9iPiB3aGVuIGFjdGl2ZS48YnI+VGhlIHZlaWwgaXMgdmVyeSBmcmFnaWxlIGFuZCB3aWxsIGJyZWFrIGlmIHlvdSBjbGljayB0aGUgYmlnIGNvb2tpZSBvciBhbnkgZ29sZGVuIGNvb2tpZXMgb3IgcmVpbmRlZXIuPGJyPjxicj5PbmNlIGJyb2tlbiwgdHVybmluZyB0aGUgdmVpbCBiYWNrIG9uIGNvc3RzICUyIG9mIHVuYnVmZmVkIENwUy4iLAogICAgICAgICAgW0JlYXV0aWZ5KGJvb3N0ICogMTAwKSwgR2FtZS5zYXlUaW1lKDI0ICogNjAgKiA2MCAqIEdhbWUuZnBzLCAyKV0KICAgICAgICApICsKICAgICAgICAocmVzaXN0ID4gMAogICAgICAgICAgPyAiPGJyPjxicj4iICsKICAgICAgICAgICAgbG9jKCJIYXMgYSA8Yj4lMSU8L2I+IGNoYW5jZSB0byBub3QgYnJlYWsuIiwgQmVhdXRpZnkocmVzaXN0ICogMTAwKSkKICAgICAgICAgIDogIiIpCiAgICAgICk7CiAgICB9OwogICAgbmV3IEdhbWUuVXBncmFkZSgiU2hpbW1lcmluZyB2ZWlsIFtvZmZdIiwgIiIsIDEwMDAwMDAsIFs5LCAxMF0pOwogICAgR2FtZS5sYXN0LnBvb2wgPSAidG9nZ2xlIjsKICAgIEdhbWUubGFzdC50b2dnbGVJbnRvID0gIlNoaW1tZXJpbmcgdmVpbCBbb25dIjsKICAgIEdhbWUubGFzdC5wcmljZUZ1bmMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBHYW1lLnVuYnVmZmVkQ3BzICogNjAgKiA2MCAqIDI0OwogICAgfTsKICAgIEdhbWUubGFzdC5kZXNjRnVuYyA9IGZ1bmM7CiAgICBuZXcgR2FtZS5VcGdyYWRlKCJTaGltbWVyaW5nIHZlaWwgW29uXSIsICIiLCAwLCBbOSwgMTBdKTsKICAgIEdhbWUubGFzdC5wb29sID0gInRvZ2dsZSI7CiAgICBHYW1lLmxhc3QudG9nZ2xlSW50byA9ICJTaGltbWVyaW5nIHZlaWwgW29mZl0iOwogICAgR2FtZS5sYXN0LmRlc2NGdW5jID0gZnVuYzsKCiAgICBHYW1lLmxvc2VTaGltbWVyaW5nVmVpbCA9IGZ1bmN0aW9uIChjb250ZXh0KSB7CiAgICAgIGlmICghR2FtZS5IYXMoIlNoaW1tZXJpbmcgdmVpbCIpKSByZXR1cm4gZmFsc2U7CiAgICAgIGlmICgKICAgICAgICAhR2FtZS5IYXMoIlNoaW1tZXJpbmcgdmVpbCBbb2ZmXSIpICYmCiAgICAgICAgR2FtZS5IYXMoIlNoaW1tZXJpbmcgdmVpbCBbb25dIikKICAgICAgKQogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgaWYgKEdhbWUuSGFzKCJSZWluZm9yY2VkIG1lbWJyYW5lIikpIHsKICAgICAgICBpZiAoY29udGV4dCA9PSAic2hpbW1lciIpCiAgICAgICAgICBNYXRoLnNlZWRyYW5kb20oCiAgICAgICAgICAgIEdhbWUuc2VlZCArICIvIiArIChHYW1lLmdvbGRlbkNsaWNrcyArIEdhbWUucmVpbmRlZXJDbGlja2VkKQogICAgICAgICAgKTsKICAgICAgICBlbHNlIGlmIChjb250ZXh0ID09ICJjbGljayIpCiAgICAgICAgICBNYXRoLnNlZWRyYW5kb20oR2FtZS5zZWVkICsgIi8iICsgR2FtZS5jb29raWVDbGlja3MpOwogICAgICAgIGlmIChNYXRoLnJhbmRvbSgpIDwgR2FtZS5nZXRWZWlsRGVmZW5zZSgpKSB7CiAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgbG9jKCJUaGUgcmVpbmZvcmNlZCBtZW1icmFuZSBwcm90ZWN0cyB0aGUgc2hpbW1lcmluZyB2ZWlsLiIpLAogICAgICAgICAgICAiIiwKICAgICAgICAgICAgWzcsIDEwXQogICAgICAgICAgKTsKICAgICAgICAgIEdhbWUuV2luKCJUaGljay1za2lubmVkIik7CiAgICAgICAgICBNYXRoLnNlZWRyYW5kb20oKTsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgTWF0aC5zZWVkcmFuZG9tKCk7CiAgICAgIH0KICAgICAgdmFyIG1lID0gR2FtZS5VcGdyYWRlc1siU2hpbW1lcmluZyB2ZWlsIFtvbl0iXTsKICAgICAgbWUuYm91Z2h0ID0gMTsKICAgICAgLy9HYW1lLlVwZ3JhZGVzW21lLnRvZ2dsZUludG9dLmJvdWdodD1mYWxzZTsKICAgICAgR2FtZS5Mb2NrKG1lLnRvZ2dsZUludG8pOwogICAgICBHYW1lLlVubG9jayhtZS50b2dnbGVJbnRvKTsKICAgICAgR2FtZS5Ob3RpZnkobG9jKCJUaGUgc2hpbW1lcmluZyB2ZWlsIGRpc2FwcGVhcnMuLi4iKSwgIiIsIFs5LCAxMF0pOwogICAgICBHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkID0gMTsKICAgICAgR2FtZS5yZWNhbGN1bGF0ZUdhaW5zID0gMTsKICAgICAgUGxheVNvdW5kKCJzbmQvc3BlbGxGYWlsLm1wMyIsIDAuNzUpOwogICAgfTsKCiAgICB2YXIgZ2V0Q29va2llUHJpY2UgPSBmdW5jdGlvbiAobGV2ZWwpIHsKICAgICAgcmV0dXJuICgKICAgICAgICA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiBNYXRoLnBvdygxMCwgKGxldmVsIC0gMSkgLyAyKQogICAgICApOwogICAgfTsKCiAgICBvcmRlciA9IDEwMDIwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIldob29waWUgcGllcyIsCiAgICAgIGRlc2M6ICJUd28gY2hvY29sYXRlIGhhbHZlcyBqb2luZWQgdG9nZXRoZXIgYnkgYSBjcmVhbSBmaWxsaW5nLiBJdCdzIGdvdCBubyBleWVicm93cywgYnV0IHlvdSBuZXZlciBub3RpY2VkIHVudGlsIG5vdy4iLAogICAgICBpY29uOiBbMjEsIDMxXSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSgxKSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkNhcmFtZWwgd2FmZXIgYmlzY3VpdHMiLAogICAgICBkZXNjOiAiQ29hdGVkIGluIGRlbGljaW91cyBjaG9jb2xhdGUuIEFzIG1hbnkgbGF5ZXJzIGFzIHlvdSdsbCBnZXQgaW4gYSBiaXNjdWl0IHdpdGhvdXQgaW52b2x2aW5nIG9uaW9ucy4iLAogICAgICBpY29uOiBbMjIsIDMxXSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSgyKSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkNob2NvbGF0ZSBjaGlwIG1vY2hhIGNvb2tpZXMiLAogICAgICBkZXNjOiAiTW9jaGEgc3RhcnRlZCBvdXQgYXMgYW4gZXhjdXNlIHRvIHNtdWdnbGUgY2hvY29sYXRlIGludG8gY29mZmVlLiBBbmQgbm93LCBpbiBhIHBvaWduYW50IGRpc3BsYXkgb2YgZGlwbG9tYWN5IGFuZCBjdWx0dXJhbCBleGNoYW5nZSwgaXQncyBicmluZ2luZyBjb2ZmZWUgdG8gY2hvY29sYXRlIGNvb2tpZXMuIiwKICAgICAgaWNvbjogWzIzLCAzMV0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoMyksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJFYXJsIEdyZXkgY29va2llcyIsCiAgICAgIGRlc2M6ICJDYXB0YWluIFBpY2FyZCdzIGZhdm9yaXRlLiIsCiAgICAgIGljb246IFsyNCwgMzFdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDQpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQ29ybiBzeXJ1cCBjb29raWVzIiwKICAgICAgZGVzYzogIlRoZSBjb3JuIHN5cnVwIG1ha2VzIGl0IGV4dHJhIGNoZXd5LiBOb3QgdGhlIHR5cGUgb2Ygc3R1ZmYgeW91J2QgdGhpbmsgdG8gcHV0IGluIGEgY29va2llLCBidXQgYmFrZXJzIG1ha2UgZG8uIiwKICAgICAgaWNvbjogWzI1LCAzMV0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoNSksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJJY2Vib3ggY29va2llcyIsCiAgICAgIGRlc2M6ICJDYW4gYmUgcHJlcGFyZWQgaW4gYSB2YXJpZXR5IG9mIHNoYXBlcyB3aXRoIGEgdmFyaWV0eSBvZiBpbmdyZWRpZW50cy4gTWFkZSBieSBmcmVlemluZyBkb3VnaCBiZWZvcmUgYmFraW5nIGl0LCBtaXJyb3JpbmcgYSB0aW1lLXByb3ZlbiBtZWRpZXZhbCB0b3J0dXJlIHByYWN0aWNlLiBHb3R0YSBrZWVwIHRoZW0gZ3Vlc3NpbmcuIiwKICAgICAgaWNvbjogWzI2LCAzMV0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoNiksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJHcmFoYW0gY3JhY2tlcnMiLAogICAgICBkZXNjOiAiSW5zcGlyZWQgaW4gdGhlaXIgZGVzaWduIGJ5IHRoZSB3aXNoIHRvIGxpdmUgYSBsaWZlIG9mIGF1c3RlcmUgdGVtcGVyYW5jZSwgZnJlZSBmcm9tIHBsZWFzdXJlIG9yIGNoZWVyOyBpdCdzIG5vIHdvbmRlciB0aGVzZSBhcmUgc28gdGFzdHkuIiwKICAgICAgaWNvbjogWzI3LCAzMV0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoNyksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJIYXJkdGFjayIsCiAgICAgIGRlc2M6ICJFeHRyZW1lbHkgaGFyZCBhbmQsIGlmIHdlJ3JlIGJlaW5nIGhvbmVzdCwgZXh0cmVtZWx5IHRhY2suPGJyPklmIHlvdSdyZSBjb25zaWRlcmluZyBlYXRpbmcgdGhpcyBhcyBhIGZ1biBzbmFjaywgeW91IHByb2JhYmx5IGhhdmUgb3RoZXIgdGhpbmdzIHRvIHdvcnJ5IGFib3V0IHRoYW4gdGhpcyBnYW1lLCBsaWtlIGdldHRpbmcgc2N1cnZ5IG9yIHlvdXIgY3JldyBmb21lbnRpbmcgbXV0aW55LiIsCiAgICAgIGljb246IFsyOCwgMzFdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDgpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQ29ybmZsYWtlIGNvb2tpZXMiLAogICAgICBkZXNjOiAiVGhleSdyZSBncnJycnJyb292eSEgQ2FyZWZ1bCBub3QgdG8gbGV0IGl0IHNpdCBpbiB5b3VyIG1pbGsgdG9vIGxvbmcsIGxlc3QgeW91IGFjY2lkZW50YWxseSBlbmQgdXAgd2l0aCBhIGJvd2wgb2YgY2VyZWFsIGFuZCBnZXQgY29uZnVzZWQuIiwKICAgICAgaWNvbjogWzI5LCAzMV0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoOSksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJUb2Z1IGNvb2tpZXMiLAogICAgICBkZXNjOiAiVGhlcmUncyByZWFsbHkgdHdvIHdheXMgdG8gZ28gd2l0aCB0b2Z1IGNvb2tpbmc7IGVpdGhlciBpdCBhc3NlcnRzIGl0c2VsZiBpbiBwbGFpbiBzaWdodCBvciBpdCBjYW1vdWZsYWdlcyBpdHNlbGYgaW4gdGhlIG90aGVyIGluZ3JlZGllbnRzLiBUaGlzIGhhcHBlbnMgdG8gYmUgdGhlIGxhdHRlciwgYW5kIGFzIHN1Y2gsIHlvdSBjYW4ndCByZWFsbHkgdGVsbCB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIHRoaXMgYW5kIGEgcmVndWxhciBjb29raWUsIHNhdmUgZm9yIHRoYXQgb25lIHBpeGVsIG9uIHRoZSBsZWZ0LiIsCiAgICAgIGljb246IFszMCwgMzFdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDEwKSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkdsdXRlbi1mcmVlIGNvb2tpZXMiLAogICAgICBkZXNjOiAiTWFkZSB3aXRoIGJyb3duZWQgYnV0dGVyIGFuZCBtaWxrIHRvIGNsb3NlbHkgbWF0Y2ggdGhlIGFyY2hldHlwYWwgY2hvY29sYXRlIGNoaXAgY29va2llLjxicj5Gb3IgY2VsaWFjcywgYSBjaGFuY2UgdG8gaW5kdWxnZSBpbiBhIGRlbGljaW91cyByaXNrLWZyZWUgcGFzdHJ5LiBGb3Igb3RoZXJzLCBhIHN0cmFuZ2VseSB0aHJlYXRlbmluZyBjb25mZWN0aW9uIHdob3NlIGVtcHR5IGV5ZXMgd2lsbCBuZXZlciBrbm93IGhlYXZlbiBub3IgaGVsbC4iLAogICAgICBpY29uOiBbMzAsIDMwXSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSgxMCksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJSdXNzaWFuIGJyZWFkIGNvb2tpZXMiLAogICAgICBkZXNjOiAiQWxzbyBrbm93biBhcyBhbHBoYWJldCBjb29raWVzOyB3aGlsZSBtb3N0IGJha2VycyBmb2xsb3cgdGhlIHJlY2lwZSB0byB0aGUgbGV0dGVyLCBpdCBpcyBzYWlkIHRoYXQgc29tZSBzdWJzdGl0dXRlIHRoZSBmbG91ciBmb3Igc3BlbHQuIEJ1dCBkb24ndCB0YWtlIG15IHdvcmQgZm9yIGl0LiIsCiAgICAgIGljb246IFszMCwgMjldLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDExKSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkxlYmt1Y2hlbiIsCiAgICAgIGRlc2M6ICJEaXZlcnNlIGNvb2tpZXMgZnJvbSBHZXJtYW55LCBmcmFncmFudCB3aXRoIGhvbmV5IGFuZCBzcGljZXMsIG9mdGVuIGJha2VkIGFyb3VuZCBDaHJpc3RtYXMuPGJyPk9uY2Ugd29ybiBieSB3YXJyaW9ycyBvZiBvbGQgZm9yIHByb3RlY3Rpb24gaW4gYmF0dGxlLjxicj4rNSBTVFIsICsyMCUgbWFnaWMgcmVzaXN0YW5jZS4iLAogICAgICBpY29uOiBbMzAsIDI4XSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSgxMiksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJBYWNoZW5lciBQcmludGVuIiwKICAgICAgZGVzYzogIlRoZSBob25leSBvbmNlIHVzZWQgdG8gc3dlZXRlbiB0aGVzZSBnaW5nZXJicmVhZC1saWtlIHRyZWF0cyBoYXMgc2luY2UgYmVlbiBzd2FwcGVkIG91dCBmb3IgYmVldCBzdWdhciwgcHJvdmlkaW5nIGFub3RoZXIgc2FkIGV4YW1wbGUgb2YgcmVncmVzc2l2ZSBldm9sdXRpb24uIiwKICAgICAgaWNvbjogWzMwLCAyN10sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoMTMpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQ2FuaXN0cmVsbGkiLAogICAgICBkZXNjOiAiQSBkcnkgYmlzY3VpdCBmbGF2b3JlZCB3aXRoIGFuaXNlIGFuZCB3aW5lLCB0b3VnaCBsaWtlIHRoZSBwZW9wbGUgb2YgQ29yc2ljYSB3aGVyZSBpdCBjb21lcyBmcm9tLiIsCiAgICAgIGljb246IFszMCwgMjZdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDE0KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIk5pY2UgYmlzY3VpdHMiLAogICAgICBkZXNjOiAiTWFkZSB3aXRoIGNvY29udXQgYW5kIHBlcmZlY3Qgd2l0aCB0ZWEuIFRyYWNlcyBpdHMgb3JpZ2lucyB0byBhIEZyZW5jaCBjaXR5IHNvIG5pY2UgdGhleSBuYW1lZCBpdCB0aGF0LiIsCiAgICAgIGljb246IFszMCwgMjVdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDE1KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkZyZW5jaCBwdXJlIGJ1dHRlciBjb29raWVzIiwKICAgICAgZGVzYzogIllvdSBjYW4ndCB0ZWxsIHdoYXQncyBzdHJvbmdlciBjb21pbmcgb2ZmIHRoZXNlIC0gdGhlIHNtZWxsIG9mIGJ1dHRlciBvciBjb25kZXNjZW5zaW9uLiIsCiAgICAgIGljb246IFszMSwgMjVdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDE2KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlBldGl0IGJldXJyZSIsCiAgICAgIGRlc2M6ICdBbiB1bmFzc3VtaW5nIGJpc2N1aXQgd2hvc2UgbmFtZSBzaW1wbHkgbWVhbnMgImxpdHRsZSBidXR0ZXIiLiBGYW1lZCBhbmQgZmVhcmVkIGZvciBpdHMgZm91ciBlYXJzIGFuZCBmb3J0eS1laWdodCB0ZWV0aC48YnI+V2hlbiBpdCBoZWFycyB5YSwgaXRcJ2xsIGdldCB5YS4uLicsCiAgICAgIGljb246IFszMSwgMjZdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDE2KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIk5hbmFpbW8gYmFycyIsCiAgICAgIGRlc2M6ICJBIGRlbGljaW91cyBuby1iYWtlIHBhc3RyeSBoYWlsaW5nIGZyb20gQ2FuYWRhLiBQcm9iYWJseSBiZWF0cyBlYXRpbmcgc3RyYWlnaHQtdXAgc25vdyB3aXRoIG1hcGxlIHN5cnVwIHBvdXJlZCBvbiBpdCwgYnV0IHdoYXQgZG8gSSBrbm93LiIsCiAgICAgIGljb246IFszMSwgMjddLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDE3KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkJlcmdlciBjb29raWVzIiwKICAgICAgZGVzYzogIk1lc3NpbHkgc2xhdGhlcmVkIHdpdGggY2hvY29sYXRlIGZ1ZGdlLCBidXQgb25lIG9mIHRoZSBtb3N0IHBvcHVsYXIgYmVyZ2VycyBvZiBCYWx0aW1vcmUsIGFsb25nIHdpdGggdGhlIHRyaXBsZSBmcmllZCBlZ2cgYmVyZ2VyIGFuZCB0aGUgYmx1ZSBjcmFiIGNoZWVzZWJlcmdlci4iLAogICAgICBpY29uOiBbMzEsIDI4XSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSgxOCksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJDaGluc3VrbyIsCiAgICAgIGRlc2M6ICJBIGxpdHRsZSBwaWVjZSBvZiBPa2luYXdhIGluIGNvb2tpZSBmb3JtLiBQYXJ0IG9mIGEgSmFwYW5lc2UgY3VzdG9tIG9mIHNlbGxpbmcgc3dlZXRzIGFzIHNvdXZlbmlycy4gQnV0IGhleSwgcHJlc3NlZCBwZW5uaWVzIGFyZSBjb29sIHRvby4iLAogICAgICBpY29uOiBbMzEsIDI5XSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSgxOSksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJQYW5kYSBrb2FsYSBiaXNjdWl0cyIsCiAgICAgIGRlc2M6ICJBc3NvcnRlZCBqdW5nbGUgYW5pbWFscyB3aXRoIGVxdWFsbHkgYXNzb3J0ZWQgZmlsbGluZ3MuPGJyPkNvbWVzIGluIGNob2NvbGF0ZSwgc3RyYXdiZXJyeSwgdmFuaWxsYSBhbmQgZ3JlZW4gdGVhLjxicj5FYXQgdGhlbSBhbGwgYmVmb3JlIHRoZXkgZ28gZXh0aW5jdCEiLAogICAgICBpY29uOiBbMzEsIDEzXSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSgxOSksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJQdXRyaSBzYWxqdSIsCiAgICAgIGRlc2M6ICJBIGJlbG92ZWQgSW5kb25lc2lhbiBwYXN0cnk7IGl0cyBuYW1lIG1lYW5zIFwic25vdyBwcmluY2Vzc1wiLCBmb3IgdGhlIHBvd2RlcmVkIHN1Z2FyIGl0J3MgY29hdGVkIHdpdGguIEhhZCB3ZSBhZGRlZCB0aGVzZSB0byBDb29raWUgQ2xpY2tlciBzb21lIHllYXJzIGFnbywgdGhpcyBpcyB3aGVyZSB3ZSdkIG1ha2UgYSByZWZlcmVuY2UgdG8gdGhhdCBvbmUgRGlzbmV5IG1vdmllLCBidXQgaXQncyBwcm9iYWJseSB0aW1lIHRvIGxldCBpdCBnby4iLAogICAgICBpY29uOiBbMzEsIDMwXSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSgyMCksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJNaWxrIGNvb2tpZXMiLAogICAgICBkZXNjOiAiQmVzdCBlYXRlbiB3aXRoIGEgdGFsbCBnbGFzcyBvZiBjaG9jb2xhdGUuIiwKICAgICAgaWNvbjogWzMxLCAzMV0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoMjEpLAogICAgfSk7CgogICAgb3JkZXIgPSA5OTk5OwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkNvb2tpZSBjcnVtYnMiLAogICAgICBkZXNjOiAiVGhlcmUgdXNlZCB0byBiZSBhIGNvb2tpZSBoZXJlLiBOb3cgdGhlcmUgaXNuJ3QuPGJyPkdvb2QgaGVhdmVucywgd2hhdCBkaWQgeW91IDxpPkRPPyE8L2k+IiwKICAgICAgaWNvbjogWzMwLCAxM10sCiAgICAgIHBvd2VyOiAxLAogICAgICByZXF1aXJlOiAiTGVnYWN5IiwKICAgICAgcHJpY2U6IDEwMCwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkNob2NvbGF0ZSBjaGlwIGNvb2tpZSIsCiAgICAgIGRlc2M6ICJUaGlzIGlzIHRoZSBjb29raWUgeW91J3ZlIGJlZW4gY2xpY2tpbmcgdGhpcyB3aG9sZSB0aW1lLiBJdCBsb29rcyBhIGJpdCBkZW50ZWQgYW5kIG5pYmJsZWQgb24sIGJ1dCBpdCdzIG90aGVyd2lzZSBnb29kIGFzIG5ldy4iLAogICAgICBpY29uOiBbMTAsIDBdLAogICAgICBwb3dlcjogMTAsCiAgICAgIHJlcXVpcmU6ICJMZWdhY3kiLAogICAgICBwcmljZTogMTAwMDAwMDAwMDAwMCwKICAgIH0pOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJDb3NtaWMgYmVnaW5uZXIncyBsdWNrIiwKICAgICAgbG9jKAogICAgICAgICJQcmlvciB0byBwdXJjaGFzaW5nIHRoZSA8Yj4lMTwvYj4gdXBncmFkZSBpbiBhIHJ1biwgcmFuZG9tIGRyb3BzIGFyZSA8Yj4lMiB0aW1lcyBtb3JlIGNvbW1vbjwvYj4uIiwKICAgICAgICBbZ2V0VXBncmFkZU5hbWUoIkhlYXZlbmx5IGNoaXAgc2VjcmV0IiksIDVdCiAgICAgICkgKwogICAgICAgICI8cT5PaCEgQSBwZW5ueSE8YnI+T2ghIEEgcHJpY2VsZXNzIGhlaXJsb29tITxicj5PaCEgQW5vdGhlciBwZW5ueSE8L3E+IiwKICAgICAgOTk5OTk5OTk5ICogMTUsCiAgICAgIFs4LCAxMF0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiU2hpbW1lcmluZyB2ZWlsIl07CiAgICBHYW1lLmdldFZlaWxEZWZlbnNlID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgbiA9IDA7CiAgICAgIGlmIChHYW1lLkhhcygiUmVpbmZvcmNlZCBtZW1icmFuZSIpKSBuICs9IDAuMTsKICAgICAgaWYgKEdhbWUuSGFzKCJEZWxpY2F0ZSB0b3VjaCIpKSBuICs9IDAuMTsKICAgICAgaWYgKEdhbWUuSGFzKCJTdGVhZGZhc3QgbXVybXVyIikpIG4gKz0gMC4xOwogICAgICBpZiAoR2FtZS5IYXMoIkdsaXR0ZXJpbmcgZWRnZSIpKSBuICs9IDAuMTsKICAgICAgcmV0dXJuIG47CiAgICB9OwogICAgR2FtZS5nZXRWZWlsQm9vc3QgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBuID0gMC41OwogICAgICBpZiAoR2FtZS5IYXMoIlJlaW5mb3JjZWQgbWVtYnJhbmUiKSkgbiArPSAwLjE7CiAgICAgIGlmIChHYW1lLkhhcygiRGVsaWNhdGUgdG91Y2giKSkgbiArPSAwLjA1OwogICAgICBpZiAoR2FtZS5IYXMoIlN0ZWFkZmFzdCBtdXJtdXIiKSkgbiArPSAwLjA1OwogICAgICBpZiAoR2FtZS5IYXMoIkdsaXR0ZXJpbmcgZWRnZSIpKSBuICs9IDAuMDU7CiAgICAgIHJldHVybiBuOwogICAgfTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJSZWluZm9yY2VkIG1lbWJyYW5lIiwKICAgICAgbG9jKAogICAgICAgICJUaGUgPGI+c2hpbW1lcmluZyB2ZWlsPC9iPiBpcyBtb3JlIHJlc2lzdGFudCwgYW5kIGhhcyBhIDxiPiUxJSBjaGFuY2U8L2I+IG5vdCB0byBicmVhay4gSXQgYWxzbyBnaXZlcyA8Yj4rJTIlPC9iPiBtb3JlIENwUy4iLAogICAgICAgIFsxMCwgMTBdCiAgICAgICkgKyAiPHE+QSBjb25zaXN0ZW5jeSBiZXR3ZWVuIGplbGx5ZmlzaCBhbmQgY2xpbmcgd3JhcC48L3E+IiwKICAgICAgOTk5OTk5OTk5ICogMTUsCiAgICAgIFs3LCAxMF0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiU2hpbW1lcmluZyB2ZWlsIl07CgogICAgb3JkZXIgPSAyNTU7CiAgICBHYW1lLkdyYW5kbWFTeW5lcmd5KAogICAgICAiQmluYXJ5IGdyYW5kbWFzIiwKICAgICAgJ0EgZGlnaXRhbCBncmFuZG1hIHRvIHRyYW5zZmVyIG1vcmUgY29va2llcy48YnI+KFNlZSBhbHNvIDogYm9vbGVhbiBncmFuZG1hcywgc3RyaW5nIGdyYW5kbWFzLCBhbmQgbm90LWEtbnVtYmVyIGdyYW5kbWFzLCBhbHNvIGtub3duIGFzICJOYU5zIi4pJywKICAgICAgIkphdmFzY3JpcHQgY29uc29sZSIKICAgICk7CgogICAgb3JkZXIgPSAxNDAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiVGhlIEphdmFTY3JpcHQgY29uc29sZSBmb3IgZHVtbWllcyIsCiAgICAgICc8cT5UaGlzIHNob3VsZCBnZXQgeW91IHN0YXJ0ZWQuIFRoZSBmaXJzdCBsaW5lIHJlYWRzOiAiVG8gb3BlbiB0aGUgamF2YXNjcmlwdCBjb25zb2xlLCBwcmVzcy0iPGJyPi4uLnRoZSByZXN0IG9mIHRoZSBib29rIGlzIHNvYWtlZCBpbiBjaG9jb2xhdGUgbWlsay4gSWYgb25seSB0aGVyZSB3YXMgYSB3YXkgdG8gbG9vayB1cCB0aGlzIHNvcnQgb2YgaW5mb3JtYXRpb24uLi48L3E+JywKICAgICAgIkphdmFzY3JpcHQgY29uc29sZSIsCiAgICAgIDEKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICI2NGJpdCBhcnJheXMiLAogICAgICAiPHE+QSBsb25nLWZvcm0gdmFyaWFibGUgdHlwZSB0byBwYWNrIHlvdXIgY29va2llcyBtdWNoIG1vcmUgZWZmaWNpZW50bHkuPC9xPiIsCiAgICAgICJKYXZhc2NyaXB0IGNvbnNvbGUiLAogICAgICAyCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiU3RhY2sgb3ZlcmZsb3ciLAogICAgICAiPHE+VGhpcyBpcyByZWFsbHkgYmFkISBZb3UgcHJvYmFibHkgZm9yZ290IHRvIGNsb3NlIGEgbG9vcCBzb21ld2hlcmUgYW5kIG5vdyB5b3VyIHByb2dyYW1zIGFyZSBnb2luZyBjcmF6eSEgVGhlIHJlc3Qgb2YgeW91ciBlbmdpbmVlcnMgc2VlbSByZWFsbHkgZXhjaXRlZCBhYm91dCBpdCBzb21laG93LiBIb3cgY291bGQgYSBzb2Z0d2FyZSBtaXNoYXAgbGlrZSBhIHN0YWNrIG92ZXJmbG93IHBvc3NpYmx5IGV2ZXIgaGVscCBhbnlvbmU/PC9xPiIsCiAgICAgICJKYXZhc2NyaXB0IGNvbnNvbGUiLAogICAgICAzCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRW50ZXJwcmlzZSBjb21waWxlciIsCiAgICAgICI8cT5UaGlzIGJlc3Bva2UgamF2YXNjcmlwdCBjb21waWxlciB0b29rIHlvdXIgdGVhbSB5ZWFycyBvZiBkZXZlbG9wbWVudCBhbmQgYmlsbGlvbnMgaW4gcmVzZWFyY2gsIGJ1dCBpdCBzaG91bGQgbGV0IHlvdSBleGVjdXRlIChjZXJ0YWluKSBmdW5jdGlvbnMgKHVwIHRvKSAyJSBmYXN0ZXIgKGluIG9wdGltYWwgY2lyY3Vtc3RhbmNlcykuPC9xPiIsCiAgICAgICJKYXZhc2NyaXB0IGNvbnNvbGUiLAogICAgICA0CiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiU3ludGFjdGljIHN1Z2FyIiwKICAgICAgIjxxPlRhc3RpZXIgY29kZSBmb3IgdGFzdGllciBjb29raWVzLjwvcT4iLAogICAgICAiSmF2YXNjcmlwdCBjb25zb2xlIiwKICAgICAgNQogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkEgbmljZSBjdXAgb2YgY29mZmVlIiwKICAgICAgIjxxPkFsbCB0aGlzIG5lcmQgc3R1ZmYgaGFzIHlvdSBleGhhdXN0ZWQuIFlvdSBtYWtlIHlvdXJzZWxmIGEgbmljZSBjdXAgb2YgY29mZmVlLCBicmV3ZWQgd2l0aCByb2FzdGVkIGJlYW5zIGZyb20gc29tZSBmYXItYXdheSBpc2xhbmQuIFlvdSBtYXkgaGF2ZSBiZWVuIHdvcmtpbmcgYSBiaXQgdG9vIGhhcmQgdGhvdWdoIC0gdGhlIGN1cCBvZiBjb2ZmZWUgc3RhcnRzIHRhbGtpbmcgdG8geW91LCBpbnNpc3RpbmcgdGhhdCBpdCBpcyBOT1QgamF2YXNjcmlwdC48L3E+IiwKICAgICAgIkphdmFzY3JpcHQgY29uc29sZSIsCiAgICAgIDYKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJKdXN0LWluLXRpbWUgYmFraW5nIiwKICAgICAgIjxxPkEgbmV3IG1ldGhvZCBvZiBwcmVwYXJpbmcgY29va2llczsgdGhleSBiYWtlIHRoZW1zZWx2ZXMgcmlnaHQgaW4gZnJvbnQgb2YgdGhlIGN1c3RvbWVycyBiZWZvcmUgZWF0aW5nLCBsZWF2aW5nIHlvdXIga2l0Y2hlbnMgbWVzcy1mcmVlLjwvcT4iLAogICAgICAiSmF2YXNjcmlwdCBjb25zb2xlIiwKICAgICAgNwogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgImNvb2tpZXMrKyIsCiAgICAgICc8cT5Zb3VyIHZlcnkgb3duIGNvb2tpZS10aGVtZWQgcHJvZ3JhbW1pbmcgbGFuZ3VhZ2UsIGVsZWdhbnRseSBuYW1lZCBhZnRlciBpdHMgbW9zdCBpbnRlcmVzdGluZyBhYmlsaXR5IC0gaW5jcmVhc2luZyB0aGUgImNvb2tpZXMiIHZhcmlhYmxlIGJ5IDEuPC9xPicsCiAgICAgICJKYXZhc2NyaXB0IGNvbnNvbGUiLAogICAgICA4CiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiU29mdHdhcmUgdXBkYXRlcyIsCiAgICAgICI8cT5UaGlzIGlzIGdyYW5kIG5ld3MgLSBzb21lb25lJ3MgZmluYWxseSBmaWd1cmVkIG91dCB0aGUgV2lmaSBwYXNzd29yZCwgYW5kIHlvdXIgbmV3Zm91bmQgaW50ZXJuZXQgY29ubmVjdGlvbiBzZWVtcyB0byBoYXZlIHRyaWdnZXJlZCBhIHdob2xlIGxvdCBvZiBzb2Z0d2FyZSB1cGRhdGVzISBZb3VyIGJyb3dzZXJzLCBkcml2ZXJzIGFuZCBwbHVnaW5zIGFsbCByZWNlaXZlZCBhIGZyZXNoIGNvYXQgb2YgcGFpbnQsIGFuZCB5b3VyIGphdmFzY3JpcHQgdmVyc2lvbiBoYXMgYmVlbiB1cGRhdGVkIHRvIHRoZSBsYXRlc3QgRUNNQVNjcmlwdCBzcGVjaWZpY2F0aW9uLiBJdCdzIHJlYWxseSB0b28gYmFkIHRob3VzYW5kcyBoYWQgdG8gZGllIGR1ZSB0byBzb21lIGRlcHJlY2F0ZWQgZnVuY3Rpb24gaW4geW91ciBuZXVyb3RveGluIHZlbnRpbGF0aW9uIGNvZGUsIGJ1dCBJIGd1ZXNzIHRoYXQncyBwcm9ncmVzcyBmb3IgeW91LjwvcT4iLAogICAgICAiSmF2YXNjcmlwdCBjb25zb2xlIiwKICAgICAgOQogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkdhbWUuTG9vcCIsCiAgICAgICI8cT5Zb3UncmUgbm90IHF1aXRlIHN1cmUgd2hhdCB0byBtYWtlIG9mIHRoaXMuIFdoYXQgZG9lcyBpdCBtZWFuPyBXaGF0IGRvZXMgaXQgZG8/IFdobyB3b3VsZCBsZWF2ZSBzb21ldGhpbmcgbGlrZSB0aGF0IGp1c3QgbGF5aW5nIGFyb3VuZCBoZXJlPyBUcnkgYXNraW5nIGFnYWluIGluIDEvMzB0aCBvZiBhIHNlY29uZC48L3E+IiwKICAgICAgIkphdmFzY3JpcHQgY29uc29sZSIsCiAgICAgIDEwCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiZXZhbCgpIiwKICAgICAgIjxxPkl0IGlzIHNhaWQgdGhhdCB0aGlzIHNpbXBsZSBmdW5jdGlvbiBob2xkcyB0aGUga2V5IHRvIHRoZSB1bml2ZXJzZSwgYW5kIHRoYXQgd2hvc29ldmVyIG1hc3RlcnMgaXQgbWF5IHNoYXBlIHJlYWxpdHkgdG8gdGhlaXIgd2lsbC48YnI+R29vZCB0aGluZyB5b3UgaGF2ZSBubyBpZGVhIGhvdyBpdCB3b3Jrcy4gTWFrZXMgZm9yIGEgbmVhdCBwbGFxdWUgb24geW91ciB3YWxsLCB0aG91Z2guPC9xPiIsCiAgICAgICJKYXZhc2NyaXB0IGNvbnNvbGUiLAogICAgICAxMQogICAgKTsKCiAgICBvcmRlciA9IDUwMDA7CiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlKAogICAgICAiU2NyaXB0IGdyYW5uaWVzIiwKICAgICAgIjxxPkFybWllcyBvZiBlbmVyZ3kgZHJpbmstZnVlbGVkIGdyYW5kbWFzIHJlYWR5IHRvIGhhY2sgaW50byB0aGUgY3liZXJzcGFjZSBmb3IgcmVuZWdhZGUgZS1jb29raWVzLjwvcT4iLAogICAgICAiSmF2YXNjcmlwdCBjb25zb2xlIiwKICAgICAgIkdyYW5kbWEiLAogICAgICAic3luZXJneTEiCiAgICApOwogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIlRvbWJvbGEgY29tcHV0aW5nIiwKICAgICAgIiIsCiAgICAgICJKYXZhc2NyaXB0IGNvbnNvbGUiLAogICAgICAiQ2hhbmNlbWFrZXIiLAogICAgICAic3luZXJneTIiCiAgICApOwogICAgaWYgKEVOKSB7CiAgICAgIEdhbWUubGFzdC5kZXNjRnVuYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBNYXRoLnNlZWRyYW5kb20oR2FtZS5zZWVkICsgIi10b21ib2xhY29tcHV0aW5nIik7CiAgICAgICAgdmFyIHN0ciA9CiAgICAgICAgICAiKFlvdXIgdGlja2V0IHJlYWRzICIgKwogICAgICAgICAgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKSArCiAgICAgICAgICAiICIgKwogICAgICAgICAgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKSArCiAgICAgICAgICAiICIgKwogICAgICAgICAgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKSArCiAgICAgICAgICAiICIgKwogICAgICAgICAgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKSArCiAgICAgICAgICAiLCBlbnRpdGxpbmcgeW91IHRvICIgKwogICAgICAgICAgY2hvb3NlKFsKICAgICAgICAgICAgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNSArIDIpICsgIiBsaW5lcyBvZiBqYXZhc2NyaXB0IiwKICAgICAgICAgICAgIm9uZSBmcmVlIHVzZSBvZiBNYXRoLnJhbmRvbSgpIiwKICAgICAgICAgICAgIm9uZSBxdWJpdCwgd2hhdGV2ZXIgdGhhdCBpcyIsCiAgICAgICAgICAgICJvbmUgaGFsZi1lYXRlbiBjb29raWUiLAogICAgICAgICAgICAiYSBicmFuZCBuZXcgdmFjdXVtIGNsZWFuZXIiLAogICAgICAgICAgICAibW9zdCBvZiBvbmUgcm9vbS10ZW1wZXJhdHVyZSBjdXAgb2Ygb3JhbmdlIHNvZGEiLAogICAgICAgICAgICAib25lIHJlYWxseSBnb29kIHNhbmR3aWNoIiwKICAgICAgICAgICAgIm9uZSBoYW5kZnVsIG9mIHBvY2tldCBsaW50IiwKICAgICAgICAgICAgInNvbWVvbmUncyBtb3N0bHkgY2xlYW4gaGFpcnBpZWNlIiwKICAgICAgICAgICAgImEgdHJpcCB0byBhIGZhbmN5IHJlc3RhdXJhbnQiLAogICAgICAgICAgICAidGhlIGtub3dsZWRnZSBvZiB0aG9zZSBudW1iZXJzIiwKICAgICAgICAgICAgImEgZnVydGl2ZSBnbGFuY2UgYXQgdGhlIG5ld3MgdGlja2VyIiwKICAgICAgICAgICAgImFub3RoZXIgdGlja2V0LCBoYWxmLXByaWNlIiwKICAgICAgICAgICAgImFsbC15b3UtY2FuLWVhdCBtb2xkeSBicmVhZCIsCiAgICAgICAgICAgICJvbmUgbGlmZXRpbWUgc3VwcGx5IG9mIG94eWdlbiIsCiAgICAgICAgICAgICJ0aGUgY29sb3IgIiArCiAgICAgICAgICAgICAgY2hvb3NlWwogICAgICAgICAgICAgICAgKCJyZWQiLAogICAgICAgICAgICAgICAgIm9yYW5nZSIsCiAgICAgICAgICAgICAgICAieWVsbG93IiwKICAgICAgICAgICAgICAgICJncmVlbiIsCiAgICAgICAgICAgICAgICAiYmx1ZSIsCiAgICAgICAgICAgICAgICAicHVycGxlIiwKICAgICAgICAgICAgICAgICJibGFjayIsCiAgICAgICAgICAgICAgICAid2hpdGUiLAogICAgICAgICAgICAgICAgImdyYXkiLAogICAgICAgICAgICAgICAgImJyb3duIiwKICAgICAgICAgICAgICAgICJwaW5rIiwKICAgICAgICAgICAgICAgICJ0ZWFsIikKICAgICAgICAgICAgICBdLAogICAgICAgICAgICAiaW5jcmVhc2VkIGludGVsbGVjdCBmb3IgYSBsaW1pdGVkIHRpbWUiLAogICAgICAgICAgICAiYW4gYW5jaWVudCBydW5lc3dvcmQiLAogICAgICAgICAgICAidGhlIHRocm9uZSBvZiBhIGZhci1hd2F5IGNvdW50cnkiLAogICAgICAgICAgICAidGhlIHBvc2l0aW9uIG9mIE1hZmlhIGNhcG8uIEdvb2QgbHVjayIsCiAgICAgICAgICAgICJvbmUgZnJlZSB0aW1lLXRyYXZlbCB3ZWVrLWVuZCIsCiAgICAgICAgICAgICJzb21ldGhpbmcgYmVhdXRpZnVsIiwKICAgICAgICAgICAgInRoZSBkZWVkIHRvIHNvbWUgb2lsIHdlbGwiLAogICAgICAgICAgICAib25lIGhhbWJ1cmdlciBtYWRlIG91dCBvZiB0aGUgYW5pbWFsLCBwbGFudCwgb3IgcGVyc29uIG9mIHlvdXIgY2hvaWNlIiwKICAgICAgICAgICAgInRoZSBsYXN0IHN1cnZpdmluZyAiICsKICAgICAgICAgICAgICBjaG9vc2VbCiAgICAgICAgICAgICAgICAoImRvZG8gYmlyZCIsICJ0aHlsYWNpbmUiLCAidW5pY29ybiIsICJkaW5vc2F1ciIsICJuZWFuZGVydGhhbCIpCiAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgImEgZGVlcCBmZWVsaW5nIG9mIGFjY29tcGxpc2htZW50IiwKICAgICAgICAgICAgImEgZmxlZXRpbmcgdGluZ2Ugb2YgZW50ZXJ0YWlubWVudCIsCiAgICAgICAgICAgICJhIHZhZ3VlIHNlbnNlIG9mIHVuZWFzZSIsCiAgICAgICAgICAgICJkZWVwIGV4aXN0ZW50aWFsIGRyZWFkIiwKICAgICAgICAgICAgIm9uZSBleHRyYSB3ZWVrIGFkZGVkIHRvIHlvdXIgbGlmZXNwYW4iLAogICAgICAgICAgICAiYnJlYXRoZSBtYW51YWxseSIsCiAgICAgICAgICAgICJibGluayByaWdodCBoZXJlIGFuZCBub3ciLAogICAgICAgICAgICAib25lIG1lZXRpbmcgd2l0aCBhbnkgZmFtb3VzIHBlcnNvbiwgbGl2aW5nIG9yIGRlYWQsIGluIHlvdXIgbmV4dCBkcmVhbSIsCiAgICAgICAgICAgICJvbmUgdmVyeSBuaWNlIGRyZWFtIiwKICAgICAgICAgICAgImEgd2Fja3kgc291bmQgZWZmZWN0IiwKICAgICAgICAgICAgIjQ1IHNlY29uZHMgb2YgbW9yYWwgZmxleGliaWxpdHkiLAogICAgICAgICAgICAnaHVuZHJlZHMgYW5kIHRob3VzYW5kcywgYWxzbyBrbm93biBhcyAic3ByaW5rbGVzIicsCiAgICAgICAgICAgICJvbmUgY2lyY2xlLCB0cmlhbmdsZSwgc3F1YXJlIG9yIG90aGVyIHNpbXBsZSBnZW9tZXRyaWMgc2hhcGUsIG9mIGF2ZXJhZ2UgZGltZW5zaW9ucyIsCiAgICAgICAgICAgICJqdXN0IHRoaXMgZXh0cmEgYml0IG9mIHJhbmRvbW5lc3MiLAogICAgICAgICAgICAidGhlIGV4dHJhIHB1c2ggeW91IG5lZWRlZCB0byB0dXJuIHlvdXIgbGlmZSBhcm91bmQiLAogICAgICAgICAgICAiYSBnb29kIGZyaWdodCIsCiAgICAgICAgICAgICJvbmUgc2VjcmV0IHN1cGVycG93ZXIiLAogICAgICAgICAgICAiYSBiZXR0ZXIgbHVjayBuZXh0IHRpbWUiLAogICAgICAgICAgICAiYW4gaXJyYXRpb25hbCBwaG9iaWEgb2YgdG9tYm9sYSB0aWNrZXRzIiwKICAgICAgICAgICAgIm9uZSB3aG9sZSBzcGlkZXIiLAogICAgICAgICAgICAiYW4gaW5jcmVhc2VkIHNlbnNlIG9mIHNlbGYtd29ydGggYW5kIGRldGVybWluYXRpb24iLAogICAgICAgICAgICAiaW5uZXIgcGVhY2UiLAogICAgICAgICAgICAib25lIGRvdWJsZS1YUCB3ZWVrLWVuZCBpbiB0aGUgTU1PUlBHIG9mIHlvdXIgY2hvaWNlIiwKICAgICAgICAgICAgImEgbGl0dGxlIHBpZWNlIG9mIHRoZSB1bml2ZXJzZSwgcmVwcmVzZW50ZWQgYnkgdGhlIHRyaWxsaW9ucyBvZiBhdG9tcyB0aGF0IG1ha2UgdXAgdGhpcyB2ZXJ5IHRpY2tldCIsCiAgICAgICAgICAgICJmb29kIHBvaXNvbmluZyIsCiAgICAgICAgICAgICJ0aGUgTW9vbiEgV2VsbCwgY29uY2VwdHVhbGx5IiwKICAgICAgICAgICAgImEgbmV3IGNhciwgYmFieSIsCiAgICAgICAgICAgICJhIG5ldyBjYXRjaHBocmFzZSIsCiAgICAgICAgICAgICJhbiBpbnRydXNpdmUgdGhvdWdodCBvZiB5b3VyIGNob2ljZSIsCiAgICAgICAgICAgICItIC4uLmF3IG1hbiwgaXQganVzdCBjdXRzIG9mZiB0aGVyZSIsCiAgICAgICAgICAgICJ0aGUgZGlyZWN0b3Igc3BvdCBmb3IgdGhlIG5leHQgYmlnIGhpdCBtb3ZpZSIsCiAgICAgICAgICAgICJyZWFsbHkgZ29vZC1sb29raW5nIGNhbHZlcyIsCiAgICAgICAgICAgICJvbmUgZ2VudWluZSBwaXJhdGUgZ29sZGVuIGRvdWJsb29uIiwKICAgICAgICAgICAgJyJ0cmVhc3VyZSBhbmQgcmljaGVzIiwgb3Igc29tZXRoaW5nJywKICAgICAgICAgICAgIm9uZSBib2F0LCBzdW5rZW4iLAogICAgICAgICAgICAiYmFieSBzaG9lcywgbmV2ZXIgd29ybiIsCiAgICAgICAgICAgICJkaXJlY3QgbGluZWFnZSB0byBzb21lIEtpbmcgb3IgUXVlZW4iLAogICAgICAgICAgICAiaW5uYXRlIGtub3dsZWRnZSBvZiBhIGRlYWQgbGFuZ3VhZ2UgeW91J2xsIG5ldmVyIGVuY291bnRlciIsCiAgICAgICAgICAgICJ0aGUgbWVsb2R5IG9mIGEgc29uZyB5b3UgZG9uJ3Qga25vdyB0aGUgd29yZHMgdG8iLAogICAgICAgICAgICAid2hpdGUgbm9pc2UiLAogICAgICAgICAgICAibWlsZCBwaHlzaWNhbCBpbXBhaXJtZW50IiwKICAgICAgICAgICAgImEgbmV3IHBhaXIgb2YgbGlwcyIsCiAgICAgICAgICAgICJ0aGluZ3MsIGFuZCBzdWNoIiwKICAgICAgICAgICAgIm9uZSBwb3B1bGFyIGV4cHJlc3Npb24gYmVhcmluZyB5b3VyIG5hbWUiLAogICAgICAgICAgICAib25lIHR5cG8iLAogICAgICAgICAgICAib25lIGdldC1vdXQtb2YtamFpbC1mcmVlIGNhcmQiLAogICAgICAgICAgICAidGhlIHJlc3Qgb2YgeW91ciBsaWZlLi4uIGZvciBub3ciLAogICAgICAgICAgICAib25lIHBvbGl0ZSBodWZmIiwKICAgICAgICAgICAgImEgY29uZGVzY2VuZGluZyBzdGFyZSIsCiAgICAgICAgICAgICJvbmUgY3Vyc2VkIG1vbmtleSBwYXciLAogICAgICAgICAgICAidHJ1ZSBsb3ZlLCBwcm9iYWJseSIsCiAgICAgICAgICAgICJhbiBpbnRlcmVzdGluZyBmYWN0b2lkIGFib3V0IHRoZSBhbmltYWwsIGNvdW50cnksIFRWIHNob3cgb3IgY2VsZWJyaXR5IG9mIHlvdXIgY2hvaWNlIiwKICAgICAgICAgICAgImEgcG9wIGN1bHR1cmUgcmVmZXJlbmNlIiwKICAgICAgICAgICAgIm1pbnV0ZXMgb2YgZnVuIiwKICAgICAgICAgICAgJ3RoZSBldHltb2xvZ3kgb2YgdGhlIHdvcmQgInRvbWJvbGEiIC0gaXRcJ3MgSXRhbGlhbiBmb3IgImEgdHVtYmxlIicsCiAgICAgICAgICAgICJub3RoaW5nLiBZb3UgbG9zdCwgc29ycnkiLAogICAgICAgICAgXSkgKwogICAgICAgICAgIi4pIjsKICAgICAgICBNYXRoLnNlZWRyYW5kb20oKTsKICAgICAgICByZXR1cm4gKAogICAgICAgICAgdGhpcy5kZXNjICsKICAgICAgICAgICI8cT5MaWtlIHF1YW50dW0gY29tcHV0aW5nLCBidXQgbW9yZSBmdW4uPGJyPiIgKwogICAgICAgICAgc3RyICsKICAgICAgICAgICI8L3E+IgogICAgICAgICk7CiAgICAgIH07CiAgICB9IGVsc2UgR2FtZS5sYXN0LmRlc2MgPSAiPHE+LTwvcT4iOwoKICAgIG9yZGVyID0gMTAwMjA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiS3J1aWRub3RlbiIsCiAgICAgIGRlc2M6ICdBIGZlc3RpdmUgZHV0Y2ggZmF2b3JpdGU7IHRpbnkgY2lubmFtb255IGJpdGVzIHNvbWV0aW1lcyBjb2F0ZWQgaW4gY2hvY29sYXRlLiBUaGUgbmFtZSB0cmFuc2xhdGVzIHJvdWdobHkgdG8gImtydWlkbm90ZW4iLicsCiAgICAgIGljb246IFszMCwgM10sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoMjIpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiTWFyaWUgYmlzY3VpdHMiLAogICAgICBkZXNjOiAiUGxlYXNhbnRseSByb3VuZCwgc21vb3RobHkgYnV0dGVyeSwgc3VidGx5IHZhbmlsbGEtZmxhdm9yZWQsIG9ybmF0ZWx5IGVtYm9zc2VkLCBlYWNoIHJpZGdlIHJlcHJlc2VudHMgYSBwZXJzb24gTWFyaWUga2lsbGVkIGluIHByaXNvbi4iLAogICAgICBpY29uOiBbMzAsIDRdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDIzKSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIk1lcmluZ3VlIGNvb2tpZXMiLAogICAgICBkZXNjOiAiUHJvYmFibHkgdGhlIG1vc3QgZXhjaXRpbmcgdGhpbmcgeW91IGNhbiBtYWtlIG91dCBvZiBlZ2cgd2hpdGVzLiBBbHNvIGNhbGxlZCBmb3Jnb3R0ZW4gY29va2llcywgZHVlIHRvIHRoZSByZWNpcGUgYmVpbmcgb25jZSBsb3N0IGluIGEgc2VhbGVkIG15c3RpY2FsIHZhdWx0IGZvciAxMCwwMDAgeWVhcnMuIiwKICAgICAgaWNvbjogWzMxLCA0XSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSgyNCksCiAgICB9KTsKCiAgICBvcmRlciA9IDEwMDYwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlBpenphIiwKICAgICAgZGVzYzogIldoYXQgaXMgYSBwaXp6YSBpZiBub3QgYSBsYXJnZSwgY2hld3kgY29va2llLCBmcm9zdGVkIHdpdGggYSByYXRoZXIgZXh1YmVyYW50IHRvbWF0byAmIGNoZWVzZSBpY2luZz8gTm90IGEgY29va2llLCB0aGF0J3Mgd2hhdC4iLAogICAgICBpY29uOiBbMzEsIDldLAogICAgICByZXF1aXJlOiAiQm94IG9mIG5vdCBjb29raWVzIiwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBNYXRoLnBvdygxMCwgNDQpLAogICAgfSk7CgogICAgb3JkZXIgPSAxMDA1MDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJDcmFja2VycyIsCiAgICAgIGRlc2M6ICdUaGVzZSBhcmUgdGhlIG5vbi1mbGF2b3JlZCBraW5kIHdpdGggbm8gc2FsdCBhZGRlZC4gUmVhbGx5IGp1c3QgYSBqdWRnbWVudC1mcmVlIHdoZWF0IHNxdWFyZSBiZWdnaW5nIHRvIGhhdmUgYml0cyBvZiBoYW0gYW5kIHNwcmVhZGFibGUgY2hlZXNlIHBpbGVkIG9udG8gaXQsIGl0cyBtYWluIGNvbnRyaWJ1dGlvbiBiZWluZyAiY3J1bmNoeSIuJywKICAgICAgaWNvbjogWzMwLCA5XSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBtYXliZSBjb29raWVzIiwKICAgICAgcG93ZXI6IDQsCiAgICAgIHByaWNlOiBNYXRoLnBvdygxMCwgNDUpLAogICAgfSk7CgogICAgb3JkZXIgPSAxMDAzMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJIYXZhYnJlYWtzIiwKICAgICAgZGVzYzogIllvdSBjYW4gc25hcCB0aGUgc2VjdGlvbnMgbmVhdGx5IG9yIGp1c3QgYml0ZSBpbnRvIHRoZSB3aG9sZSB0aGluZyBsaWtlIHNvbWUga2luZCBvZiBsdW5hdGljLiBTb21lIG92ZXJzZWEgY291bnRyaWVzIG1hbnVmYWN0dXJlIHRoZXNlIGluIGh1bmRyZWRzIG9mIHVuaXF1ZSBmbGF2b3JzLCBzdWNoIGFzIGdyZWVuIHRlYSwgbG9ic3RlciBiaXNxdWUsIGFuZCBkYXJrIGNob2NvbGF0ZS4iLAogICAgICBpY29uOiBbMzEsIDNdLAogICAgICByZXF1aXJlOiAiQm94IG9mIGJyYW5kIGJpc2N1aXRzIiwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CgogICAgb3JkZXIgPSAyMDAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJLaXR0ZW4gZXhlY3V0aXZlcyIsCiAgICAgIHN0cktpdHRlbkRlc2MgKwogICAgICAgICI8cT5yZWFkeSB0byBleGVjdXRlIHdoYXRldmVyIGFuZCB3aG9ldmVyIHlvdSdkIGxpa2UsIHNpcjwvcT4iLAogICAgICA5MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIEdhbWUuR2V0SWNvbigiS2l0dGVuIiwgMTMpCiAgICApOwogICAgR2FtZS5sYXN0LmtpdHRlbiA9IDE7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCAxMywgMTgpOwoKICAgIG9yZGVyID0gMTAwMjA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQ2hhaSB0ZWEgY29va2llcyIsCiAgICAgIGRlc2M6ICJOb3QgZXhhY3RseSBDYXB0YWluIFBpY2FyZCdzIGZhdm9yaXRlLCBidXQgSSBtZWFuLCB0aGVzZSB3aWxsIGRvIGluIGEgcGluY2guIiwKICAgICAgaWNvbjogWzIzLCAzMl0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoNCkgKyA1LAogICAgfSk7CiAgICBHYW1lLmxhc3Qub3JkZXIgPSAxMDAyMC41Njg1OwoKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJZb2d1cnQgY29va2llcyIsCiAgICAgIGRlc2M6ICJBdWdtZW50ZWQgYnkgdGhlIHdvbmRlcnMgb2YgZGFpcnksIHRoZXNlIGNvb2tpZXMgYXJlIGxpZ2h0IGFuZCBmbHVmZnkgYW5kIGp1c3Qgb25lIG1vcmUgdGhpbmcgZm9yIHRoZSBsYWN0b3NlLWludG9sZXJhbnQgdG8gYXZvaWQuPGJyPlRydWx5IGZvciB0aGUgY3VsdHVyZWQgYW1vbmcgdXMuIiwKICAgICAgaWNvbjogWzI0LCAzMl0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoMjUpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiVGh1bWJwcmludCBjb29raWVzIiwKICAgICAgZGVzYzogIkZpbGxlZCB3aXRoIGphbSBhbmQgc29tZXRpbWVzIHNlcnZlZCBpbiBsaXR0bGUgcGFwZXIgY3Vwcy4gTm8gbG9uZ2VyIGFkbWlzc2libGUgYXMgYmlvbWV0cmljIGV2aWRlbmNlIGluIGNvdXJ0LiBXZSdyZSBub3QgaGF2aW5nIGEgcmVwZWF0IG9mIHRoYXQgd2hvbGUgbWVzcy4iLAogICAgICBpY29uOiBbMjUsIDMyXSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSgyNiksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJQaXp6ZWxsZSIsCiAgICAgIGRlc2M6ICJUaGluLCBjcmlzcCB3YWZmbGUgY29va2llcyBiYWtlZCBpbiBhIGJlc3Bva2UgaXJvbiBmb2xsb3dpbmcgYW4gYW5jaWVudCBJdGFsaWFuIHJlY2lwZS48YnI+VGhlc2UgY29va2llcyBoYXZlIGJlZW4gYXJvdW5kIGZvciBhIGxvbmcsIGxvbmcgdGltZS48YnI+VGhlc2UgY29va2llcyBoYXZlIHNlZW4gdGhpbmdzLiIsCiAgICAgIGljb246IFsyNiwgMzJdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDI3KSwKICAgIH0pOwoKICAgIG9yZGVyID0gMTAwMzA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiWmlsbGEgd2FmZXJzIiwKICAgICAgZGVzYzogIlBvcHVsYXIgdmFuaWxsYS1mbGF2b3JlZCBiaXNjdWl0cyB0aGF0IHNvbWVob3cga2VlcCBlbmRpbmcgdXAgaW4gYmFuYW5hIHB1ZGRpbmcuPGJyPlRoZW1lZCBhZnRlciBhIGJlbG92ZWQgcmFkaW9hY3RpdmUgcHJlaGlzdG9yaWMgbW9uc3RlciwgZm9yIHNvbWUgcmVhc29uLiIsCiAgICAgIGljb246IFsyMiwgMzJdLAogICAgICByZXF1aXJlOiAiQm94IG9mIGJyYW5kIGJpc2N1aXRzIiwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiA1LAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiRGltIERhbXMiLAogICAgICBkZXNjOiAiVHdvIGJpc2N1aXRzIGpvaW5lZCBieSBjaG9jb2xhdGUgYW5kIGNvYXRlZCBpbiBldmVuIG1vcmUgY2hvY29sYXRlLjxicj5Zb3Ugd29uZGVyIC0gd2hpY2ggb25lIGlzIHRoZSBkaW0sIGFuZCB3aGljaCBvbmUgaXMgdGhlIGRhbT8iLAogICAgICBpY29uOiBbMzEsIDEwXSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBicmFuZCBiaXNjdWl0cyIsCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwoKICAgIG9yZGVyID0gMTAwNjA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQ2FuZHkiLAogICAgICBkZXNjOiAiVGhlcmUgYXJlIHR3byBwaWxsYXJzIHRvIHRoZSB3b3JsZCBvZiBzd2VldHMgOiBwYXN0cmllcywgb2YgY291cnNlIC0gYW5kIGNhbmR5Ljxicj5Zb3UgY291bGQgbWFrZSBhIHdob2xlIG5ldyBnYW1lIGp1c3QgYWJvdXQgdGhlc2UsIGJ1dCBmb3Igbm93LCBwbGVhc2UgZW5qb3kgdGhlc2UgYXNzb3J0ZWQgZ2VuZXJpYyB0cmVhdHMuIiwKICAgICAgaWNvbjogWzMwLCAxMF0sCiAgICAgIHJlcXVpcmU6ICJCb3ggb2Ygbm90IGNvb2tpZXMiLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IE1hdGgucG93KDEwLCA0NiksCiAgICB9KTsKCiAgICBvcmRlciA9IDE5MDAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRm9ydHVuZSAjMDAxIiwKICAgICAgIjxxPkZpbmdlcnMgYXJlIG5vdCB0aGUgb25seSB0aGluZyB5b3UgY2FuIGNvdW50IG9uLjwvcT4iLAogICAgICAiQ3Vyc29yIiwKICAgICAgImZvcnR1bmUiCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRm9ydHVuZSAjMDAyIiwKICAgICAgIjxxPkEgd3JpbmtsZSBpcyBhIGNyYWNrIGluIGEgbXVuZGFuZSBmYWNhZGUuPC9xPiIsCiAgICAgICJHcmFuZG1hIiwKICAgICAgImZvcnR1bmUiCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRm9ydHVuZSAjMDAzIiwKICAgICAgIjxxPlRoZSBzZWVkcyBvZiB0b21vcnJvdyBhbHJlYWR5IGxpZSB3aXRoaW4gdGhlIHNlZWRzIG9mIHRvZGF5LjwvcT4iLAogICAgICAiRmFybSIsCiAgICAgICJmb3J0dW5lIgogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkZvcnR1bmUgIzAwNCIsCiAgICAgICI8cT5SaWNoZXMgZnJvbSBkZWVwIHVuZGVyIGVsZXZhdGUgeW91IGFsbCB0aGUgc2FtZS48L3E+IiwKICAgICAgIk1pbmUiLAogICAgICAiZm9ydHVuZSIKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJGb3J0dW5lICMwMDUiLAogICAgICAiPHE+VHJ1ZSB3b3J0aCBpcyBub3QgaW4gd2hhdCB5b3UgZmluZCwgYnV0IGluIHdoYXQgeW91IG1ha2UuPC9xPiIsCiAgICAgICJGYWN0b3J5IiwKICAgICAgImZvcnR1bmUiCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRm9ydHVuZSAjMDA2IiwKICAgICAgIjxxPlRoZSB2YWx1ZSBvZiBtb25leSBtZWFucyBub3RoaW5nIHRvIGEgcG9ja2V0LjwvcT4iLAogICAgICAiQmFuayIsCiAgICAgICJmb3J0dW5lIgogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkZvcnR1bmUgIzAwNyIsCiAgICAgICI8cT5Ob3QgYWxsIGd1aWRlcyBkZXNlcnZlIHdvcnNoaXAuPC9xPiIsCiAgICAgICJUZW1wbGUiLAogICAgICAiZm9ydHVuZSIKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJGb3J0dW5lICMwMDgiLAogICAgICAiPHE+TWFnaWMgaXMgYWJvdXQgdHdvIHRoaW5ncyAtIHNob3dtYW5zaGlwLCBhbmQgcmFiYml0cy48L3E+IiwKICAgICAgIldpemFyZCB0b3dlciIsCiAgICAgICJmb3J0dW5lIgogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkZvcnR1bmUgIzAwOSIsCiAgICAgICI8cT5FdmVyeSBtaWxlIHRyYXZlbGxlZCBleHBhbmRzIHRoZSBtaW5kIGJ5IGp1c3QgYXMgbXVjaC48L3E+IiwKICAgICAgIlNoaXBtZW50IiwKICAgICAgImZvcnR1bmUiCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRm9ydHVuZSAjMDEwIiwKICAgICAgIjxxPkRvbid0IGdldCB1c2VkIHRvIHlvdXJzZWxmLiBZb3UncmUgZ29ubmEgaGF2ZSB0byBjaGFuZ2UuPC9xPiIsCiAgICAgICJBbGNoZW15IGxhYiIsCiAgICAgICJmb3J0dW5lIgogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkZvcnR1bmUgIzAxMSIsCiAgICAgICI8cT5FdmVyeSBkb29yd2F5IGlzIGEgZ2FtYmxlLiBUcmVhZCB3aXRoIGNhcmUuPC9xPiIsCiAgICAgICJQb3J0YWwiLAogICAgICAiZm9ydHVuZSIKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJGb3J0dW5lICMwMTIiLAogICAgICAiPHE+RG8geW91ciBmdXR1cmUgc2VsZiBhIGZhdm9yOyB0aGV5J2xsIHRoYW5rIHlvdSBmb3IgaXQuPC9xPiIsCiAgICAgICJUaW1lIG1hY2hpbmUiLAogICAgICAiZm9ydHVuZSIKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJGb3J0dW5lICMwMTMiLAogICAgICAiPHE+VGhlIHdvcmxkIGlzIG1hZGUgb2Ygd2hhdCB3ZSBwdXQgaW50byBpdC48L3E+IiwKICAgICAgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwKICAgICAgImZvcnR1bmUiCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRm9ydHVuZSAjMDE0IiwKICAgICAgIjxxPlN0YXJpbmcgYXQgYSBkYXp6bGluZyBsaWdodCBjYW4gYmxpbmQgeW91IGJhY2sgdG8gZGFya25lc3MuPC9xPiIsCiAgICAgICJQcmlzbSIsCiAgICAgICJmb3J0dW5lIgogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkZvcnR1bmUgIzAxNSIsCiAgICAgICI8cT5Eb24ndCBsZWF2ZSB0byBibGluZCBjaGFuY2Ugd2hhdCB5b3UgY291bGQgYWNjb21wbGlzaCB3aXRoIGRlYWYgc2tpbGwuPC9xPiIsCiAgICAgICJDaGFuY2VtYWtlciIsCiAgICAgICJmb3J0dW5lIgogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkZvcnR1bmUgIzAxNiIsCiAgICAgICI8cT5JdCdzIGdvb2QgdG8gc2VlIHlvdXJzZWxmIGluIG90aGVycy4gUmVtZW1iZXIgdG8gc2VlIHlvdXJzZWxmIGluIHlvdXJzZWxmLCB0b28uPC9xPiIsCiAgICAgICJGcmFjdGFsIGVuZ2luZSIsCiAgICAgICJmb3J0dW5lIgogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkZvcnR1bmUgIzAxNyIsCiAgICAgICI8cT5JZiB0aGluZ3MgYXJlbid0IHdvcmtpbmcgb3V0IGZvciB5b3UsIHJld3JpdGUgdGhlIHJ1bGVzLjwvcT4iLAogICAgICAiSmF2YXNjcmlwdCBjb25zb2xlIiwKICAgICAgImZvcnR1bmUiCiAgICApOwoKICAgIG9yZGVyID0gMTkxMDA7CiAgICAvL25vdGUgOiBwcmljZSBmb3IgdGhlc2UgY2FwcGVkIHRvIGJhc2UgcHJpY2UgT1IgMSBkYXkgb2YgdW5idWZmZWQgQ3BTCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRm9ydHVuZSAjMTAwIiwKICAgICAgbG9jKCJBbGwgYnVpbGRpbmdzIGFuZCB1cGdyYWRlcyBhcmUgPGI+JTElIGNoZWFwZXI8L2I+LiIsIDEpICsKICAgICAgICAiICIgKwogICAgICAgIGxvYygiQ29va2llIHByb2R1Y3Rpb24gbXVsdGlwbGllciA8Yj4rJTElPC9iPi4iLCAxKSArCiAgICAgICAgIjxxPlRydWUgd2VhbHRoIGlzIGNvdW50ZWQgaW4gZ2lmdHMuPC9xPiIsCiAgICAgIEdhbWUuVGllcnNbImZvcnR1bmUiXS5wcmljZSAqIDEwMDAwMCwKICAgICAgWzAsIDBdCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgImZvcnR1bmUiLCAxMCk7CiAgICBHYW1lLmxhc3QucHJpY2VGdW5jID0gZnVuY3Rpb24gKG1lKSB7CiAgICAgIHJldHVybiBNYXRoLm1pbihtZS5iYXNlUHJpY2UsIEdhbWUudW5idWZmZWRDcHMgKiA2MCAqIDYwICogMjQpOwogICAgfTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJGb3J0dW5lICMxMDEiLAogICAgICBsb2MoIkNvb2tpZSBwcm9kdWN0aW9uIG11bHRpcGxpZXIgPGI+KyUxJTwvYj4uIiwgNykgKwogICAgICAgICI8cT5Tb21lIHBlb3BsZSBkcmVhbSBvZiBmb3J0dW5lczsgb3RoZXJzIGRyZWFtIG9mIGNvb2tpZXMuPC9xPiIsCiAgICAgIEdhbWUuVGllcnNbImZvcnR1bmUiXS5wcmljZSAqIDEwMDAwMDAwMCwKICAgICAgWzAsIDBdCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgImZvcnR1bmUiLCAxMCk7CiAgICBHYW1lLmxhc3QucHJpY2VGdW5jID0gZnVuY3Rpb24gKG1lKSB7CiAgICAgIHJldHVybiBNYXRoLm1pbihtZS5iYXNlUHJpY2UsIEdhbWUudW5idWZmZWRDcHMgKiA2MCAqIDYwICogMjQpOwogICAgfTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJGb3J0dW5lICMxMDIiLAogICAgICBsb2MoCiAgICAgICAgIllvdSBnYWluIGFub3RoZXIgPGI+KyUxJTwvYj4gb2YgeW91ciByZWd1bGFyIENwUyB3aGlsZSB0aGUgZ2FtZSBpcyBjbG9zZWQuIiwKICAgICAgICAxCiAgICAgICkgKwogICAgICAgICIgPHNtYWxsPigiICsKICAgICAgICBsb2MoCiAgICAgICAgICAiTXVzdCBvd24gdGhlICUxIHVwZ3JhZGUuIiwKICAgICAgICAgIGdldFVwZ3JhZGVOYW1lKCJUd2luIEdhdGVzIG9mIFRyYW5zY2VuZGVuY2UiKQogICAgICAgICkgKwogICAgICAgICIpPC9zbWFsbD4iICsKICAgICAgICAiPHE+SGVscCwgSSdtIHRyYXBwZWQgaW4gYSAiICsKICAgICAgICAoQXBwID8gImNvbXB1dGVyIiA6ICJicm93c2VyIikgKwogICAgICAgICIgZ2FtZSE8L3E+IiwKICAgICAgR2FtZS5UaWVyc1siZm9ydHVuZSJdLnByaWNlICogMTAwMDAwMDAwMDAwLAogICAgICBbMCwgMF0KICAgICk7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCAiZm9ydHVuZSIsIDEwKTsKICAgIEdhbWUubGFzdC5wcmljZUZ1bmMgPSBmdW5jdGlvbiAobWUpIHsKICAgICAgcmV0dXJuIE1hdGgubWluKG1lLmJhc2VQcmljZSwgR2FtZS51bmJ1ZmZlZENwcyAqIDYwICogNjAgKiAyNCk7CiAgICB9OwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkZvcnR1bmUgIzEwMyIsCiAgICAgIHN0cktpdHRlbkRlc2MgKwogICAgICAgICI8cT5Eb24ndCBiZWxpZXZlIHRoZSBzdXBlcnN0aXRpb25zOyBhbGwgY2F0cyBhcmUgZ29vZCBsdWNrLjwvcT4iLAogICAgICBHYW1lLlRpZXJzWyJmb3J0dW5lIl0ucHJpY2UgKiAxMDAwMDAwMDAwMDAwMDAsCiAgICAgIFswLCAwXQogICAgKTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsICJmb3J0dW5lIiwgMTgpOwogICAgR2FtZS5sYXN0LmtpdHRlbiA9IDE7CiAgICBHYW1lLmxhc3QucHJpY2VGdW5jID0gZnVuY3Rpb24gKG1lKSB7CiAgICAgIHJldHVybiBNYXRoLm1pbihtZS5iYXNlUHJpY2UsIEdhbWUudW5idWZmZWRDcHMgKiA2MCAqIDYwICogMjQpOwogICAgfTsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJGb3J0dW5lICMxMDQiLAogICAgICBnZXRTdHJDbGlja2luZ0dhaW5zKDEpICsgIjxxPlJlbWVtYmVyIHRvIHN0YXkgaW4gdG91Y2guPC9xPiIsCiAgICAgIEdhbWUuVGllcnNbImZvcnR1bmUiXS5wcmljZSAqIDEwMDAwMDAwMDAwMCwKICAgICAgWzAsIDBdCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgImZvcnR1bmUiLCAxMSk7CiAgICBHYW1lLmxhc3QucHJpY2VGdW5jID0gZnVuY3Rpb24gKG1lKSB7CiAgICAgIHJldHVybiBNYXRoLm1pbihtZS5iYXNlUHJpY2UsIEdhbWUudW5idWZmZWRDcHMgKiA2MCAqIDYwICogMjQpOwogICAgfTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRm9ydHVuZSBjb29raWVzIiwKICAgICAgbG9jKAogICAgICAgICJUaGUgbmV3cyB0aWNrZXIgbWF5IG9jY2FzaW9uYWxseSBoYXZlIDxiPmZvcnR1bmVzPC9iPiwgd2hpY2ggbWF5IGJlIGNsaWNrZWQgZm9yIHNvbWV0aGluZyBnb29kLiIKICAgICAgKSArCiAgICAgICAgIjxxPlRoZXNlIGRvbid0IHRhc3RlIGFsbCB0aGF0IGdyZWF0IGJ1dCB0aGF0J3Mgbm90IHJlYWxseSB0aGUgcG9pbnQsIGlzIGl0PzwvcT4iLAogICAgICA3Nzc3Nzc3Nzc3NywKICAgICAgWzI5LCA4XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJEaXN0aWxsZWQgZXNzZW5jZSBvZiByZWRvdWJsZWQgbHVjayJdOwoKICAgIG9yZGVyID0gNDAwMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQSByZWFsbHkgZ29vZCBndWlkZSBib29rIiwKICAgICAgIjxiPj8/PzwvYj48cT4/Pz8/Pz88L3E+IiwKICAgICAgNywKICAgICAgWzIyLCAxMl0KICAgICk7IC8vZGVidWcgcHVycG9zZXMgb25seQogICAgLy9uZXcgR2FtZS5VcGdyYWRlKCdBIHJlYWxseSBnb29kIGd1aWRlIGJvb2snLCc8Yj5BbGwgZHVuZ2VvbiBsb2NhdGlvbnMgYmVoYXZlIGFzIGlmIHVubG9ja2VkLjwvYj48YnI+PGI+WW91IG1heSBzaGlmdC1jbGljayBhIGR1bmdlb24gbG9jYXRpb24gdG8gdGVsZXBvcnQgdGhlcmUuPC9iPjxxPkl0IGV2ZW4gdGVsbHMgeW91IHdoaWNoIGhvdGVscyB0byBhdm9pZCE8L3E+Jyw3LFsyMiwxMl0pOy8vZGVidWcgcHVycG9zZXMgb25seQogICAgR2FtZS5sYXN0LmJ1eUZ1bmN0aW9uID0gZnVuY3Rpb24gKCkgewogICAgICBpZiAoR2FtZS5PYmplY3RzWyJGYWN0b3J5Il0ubWluaWdhbWVMb2FkZWQpIHsKICAgICAgICBHYW1lLk9iamVjdHNbIkZhY3RvcnkiXS5taW5pZ2FtZS5jb21wdXRlTWFwQm91bmRzKCk7CiAgICAgICAgR2FtZS5PYmplY3RzWyJGYWN0b3J5Il0ubWluaWdhbWUudXBkYXRlTG9jU3R5bGVzKCk7CiAgICAgIH0KICAgIH07CiAgICBHYW1lLmxhc3QucG9vbCA9ICJkZWJ1ZyI7CgogICAgb3JkZXIgPSAxMDMwMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJQcmlzbSBoZWFydCBiaXNjdWl0cyIsCiAgICAgIGRlc2M6ICJBbiBldmVyeS1mbGF2b3IgYmlzY3VpdCB0aGF0IHN0YW5kcyBmb3IgdW5pdmVyc2FsIGxvdmUgYW5kIGJlaW5nIHRydWUgdG8geW91cnNlbGYuIiwKICAgICAgcmVxdWlyZTogIkV0ZXJuYWwgaGVhcnQgYmlzY3VpdHMiLAogICAgICBzZWFzb246ICJ2YWxlbnRpbmVzIiwKICAgICAgaWNvbjogWzMwLCA4XSwKICAgICAgcG93ZXI6IGhlYXJ0UG93ZXIsCiAgICAgIHByaWNlOiAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwLAogICAgfSk7CiAgICBHYW1lLmxhc3Qub3JkZXIgPSAxMDMwMC4xNzU7CgogICAgb3JkZXIgPSAxOTEwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJLaXR0ZW4gd2FnZXMiLAogICAgICBsb2MoCiAgICAgICAgIlRocm91Z2ggY2xldmVyIGFjY291bnRpbmcsIHRoaXMgYWN0dWFsbHkgbWFrZXMga2l0dGVuIHVwZ3JhZGVzIDxiPiUxJSBjaGVhcGVyPC9iPi4iLAogICAgICAgIDEwCiAgICAgICkgKwogICAgICAgICI8cT5DYXRzIGNhbiBoYXZlIGxpdHRsZSBhIHNhbGFyeSwgYXMgYSB0cmVhdC48YnI+Q2F0cyBhcmUgZXhwZXJ0IGhhZ2dsZXJzIGFuZCBoYXZlIGEga2VlbiBzZW5zZSBvZiBiYXJnYWluaW5nLCBlc3BlY2lhbGx5IGluIHRoZSBjYXNlIG9mIGNhc2guPC9xPiIsCiAgICAgIDkwMDAwMDAwMDAsCiAgICAgIFszMSwgOF0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiS2l0dGVuIGFuZ2VscyJdOwogICAgR2FtZS5sYXN0LmtpdHRlbiA9IDE7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiUGV0IHRoZSBkcmFnb24iLAogICAgICBsb2MoCiAgICAgICAgIlVubG9ja3MgdGhlIGFiaWxpdHkgdG8gPGI+cGV0IHlvdXIgZHJhZ29uPC9iPiBieSBjbGlja2luZyBvbiBpdCBvbmNlIGhhdGNoZWQuIgogICAgICApICsKICAgICAgICAiPHE+RHJhZ29ucyBkbyBub3QgcHVyci4gSWYgeW91ciBkcmFnb24gc3RhcnRzIHB1cnJpbmcsIHZhY2F0ZSB0aGUgYXJlYSBpbW1lZGlhdGVseS48L3E+IiwKICAgICAgOTk5OTk5OTk5OTksCiAgICAgIFszMCwgMTJdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkhvdyB0byBiYWtlIHlvdXIgZHJhZ29uIiwgIlJlc2lkdWFsIGx1Y2siXTsKCiAgICBvcmRlciA9IDI1MTAwOwogICAgdmFyIGRyYWdvbkRyb3BVcGdyYWRlQ29zdCA9IGZ1bmN0aW9uIChtZSkgewogICAgICByZXR1cm4gKAogICAgICAgIEdhbWUudW5idWZmZWRDcHMgKgogICAgICAgIDYwICoKICAgICAgICAzMCAqCiAgICAgICAgKEdhbWUuZHJhZ29uTGV2ZWwgPCBHYW1lLmRyYWdvbkxldmVscy5sZW5ndGggLSAxID8gMSA6IDAuMSkKICAgICAgKTsKICAgIH07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRHJhZ29uIHNjYWxlIiwKICAgICAgZ2V0U3RyQ29va2llUHJvZHVjdGlvbk11bHRpcGxpZXJQbHVzKDMpICsKICAgICAgICAiPGJyPiIgKwogICAgICAgIGxvYygKICAgICAgICAgICJDb3N0IHNjYWxlcyB3aXRoIENwUywgYnV0ICUxIHRpbWVzIGNoZWFwZXIgd2l0aCBhIGZ1bGx5LXRyYWluZWQgZHJhZ29uLiIsCiAgICAgICAgICAxMAogICAgICAgICkgKwogICAgICAgICI8cT5Zb3VyIGRyYWdvbiBzaGVkcyB0aGVzZSByZWd1bGFybHksIHNvIHRoaXMgb25lIHByb2JhYmx5IHdvbid0IGJlIG1pc3NlZC48YnI+Tm90ZTogaWNvbiBub3QgdG8gc2NhbGUuPC9xPiIsCiAgICAgIDk5OSwKICAgICAgWzMwLCAxNF0KICAgICk7CiAgICBHYW1lLmxhc3QucHJpY2VGdW5jID0gZHJhZ29uRHJvcFVwZ3JhZGVDb3N0OwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkRyYWdvbiBjbGF3IiwKICAgICAgbG9jKCJDbGlja2luZyBpcyA8Yj4lMSU8L2I+IG1vcmUgcG93ZXJmdWwuIiwgMykgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKAogICAgICAgICAgIkNvc3Qgc2NhbGVzIHdpdGggQ3BTLCBidXQgJTEgdGltZXMgY2hlYXBlciB3aXRoIGEgZnVsbHktdHJhaW5lZCBkcmFnb24uIiwKICAgICAgICAgIDEwCiAgICAgICAgKSArCiAgICAgICAgIjxxPldpbGwgZ3JvdyBiYWNrIGluIGEgZmV3IGRheXMnIHRpbWUuPGJyPkEgc2l4LWluY2ggcmV0cmFjdGFibGUgY2xhdywgbGlrZSBhIHJhem9yLCBmcm9tIHRoZSBtaWRkbGUgdG9lLiBTbyB5b3Uga25vdywgdHJ5IHRvIHNob3cgYSBsaXR0bGUgcmVzcGVjdC48L3E+IiwKICAgICAgOTk5LAogICAgICBbMzEsIDE0XQogICAgKTsKICAgIEdhbWUubGFzdC5wcmljZUZ1bmMgPSBkcmFnb25Ecm9wVXBncmFkZUNvc3Q7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiRHJhZ29uIGZhbmciLAogICAgICBsb2MoIkdvbGRlbiBjb29raWVzIGdpdmUgPGI+JTElPC9iPiBtb3JlIGNvb2tpZXMuIiwgMykgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKCJEcmFnb24gaGFydmVzdCBhbmQgRHJhZ29uZmxpZ2h0IGFyZSA8Yj4lMSUgc3Ryb25nZXI8L2I+LiIsIDEwKSArCiAgICAgICAgIjxicj4iICsKICAgICAgICBsb2MoCiAgICAgICAgICAiQ29zdCBzY2FsZXMgd2l0aCBDcFMsIGJ1dCAlMSB0aW1lcyBjaGVhcGVyIHdpdGggYSBmdWxseS10cmFpbmVkIGRyYWdvbi4iLAogICAgICAgICAgMTAKICAgICAgICApICsKICAgICAgICAiPHE+SnVzdCBhIGZhbGxlbiBiYWJ5IHRvb3RoIHlvdXIgZHJhZ29uIHdhbnRlZCB5b3UgdG8gaGF2ZSwgYXMgYSBnaWZ0Ljxicj5JdCBtaWdodCBiZSBzbWFsbGVyIHRoYW4gYW4gYWR1bHQgdG9vdGgsIGJ1dCBpdCdzIHN0aWxsIGZyaWdodGVuaW5nbHkgc2hhcnAgLSBhbmQgZGlzcGxheXMgc29tZSBhd2UtaW5zcGlyaW5nIGNhdml0aWVzLCB3aGljaCB5b3UgbWlnaHQgZXhwZWN0IGZyb20gYSBjcmVhdHVyZSBtYWRlIG91dCBvZiBzd2VldHMuPC9xPiIsCiAgICAgIDk5OSwKICAgICAgWzMwLCAxNV0KICAgICk7CiAgICBHYW1lLmxhc3QucHJpY2VGdW5jID0gZHJhZ29uRHJvcFVwZ3JhZGVDb3N0OwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkRyYWdvbiB0ZWRkeSBiZWFyIiwKICAgICAgbG9jKCJSYW5kb20gZHJvcHMgYXJlIDxiPiUxJSBtb3JlIGNvbW1vbjwvYj4uIiwgMykgKwogICAgICAgICI8YnI+IiArCiAgICAgICAgbG9jKAogICAgICAgICAgIkNvc3Qgc2NhbGVzIHdpdGggQ3BTLCBidXQgJTEgdGltZXMgY2hlYXBlciB3aXRoIGEgZnVsbHktdHJhaW5lZCBkcmFnb24uIiwKICAgICAgICAgIDEwCiAgICAgICAgKSArCiAgICAgICAgIjxxPllvdXIgZHJhZ29uIHVzZWQgdG8gc2xlZXAgd2l0aCB0aGlzLCBidXQgaXQncyB5b3VycyBub3cuPGJyPkNyYWZ0ZWQgaW4gdGhlIGxpa2VsaW5lc3Mgb2YgYSBmZWFyc29tZSBiZWFzdC4gU3R1ZmZlZCB3aXRoIG1hZ2ljYWwgaGVyYnMgcGlja2VkIGxvbmcgYWdvIGJ5IGEgd2FuZGVyaW5nIHdpemFyZC4gV292ZW4gZnJvbSBlbHZlbiB5YXJuIGFuZCBhIHBvbHllc3RlciBibGVuZC48L3E+IiwKICAgICAgOTk5LAogICAgICBbMzEsIDE1XQogICAgKTsKICAgIEdhbWUubGFzdC5wcmljZUZ1bmMgPSBkcmFnb25Ecm9wVXBncmFkZUNvc3Q7CgogICAgb3JkZXIgPSAxMDAyMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJHcmFub2xhIGNvb2tpZXMiLAogICAgICBkZXNjOiAiV2FpdCEgVGhlc2UgYXJlIGp1c3Qgb2F0bWVhbCBjb29raWVzIG1peGVkIHdpdGggcmFpc2luIGNvb2tpZXMhIFdoYXQgbmV4dCwgaGFsZi1kYXJrIGNob2NvbGF0ZSBoYWxmLXdoaXRlIGNob2NvbGF0ZSBjb29raWVzPyIsCiAgICAgIGljb246IFsyOCwgMzJdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDI4KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlJpY290dGEgY29va2llcyIsCiAgICAgIGRlc2M6ICJMaWdodCBhbmQgY2FrZS1saWtlLiBPZnRlbiBmbGF2b3JlZCB3aXRoIGxlbW9uIG9yIGFsbW9uZCBleHRyYWN0LiBTcHJpbmtsZXMgb3B0aW9uYWwuIEFsbGVnZWRseSBJdGFsaWFuLiBJbnZlc3RpZ2F0aW9uIHBlbmRpbmcuIiwKICAgICAgaWNvbjogWzI5LCAzMl0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoMjkpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiUm96ZSBrb2VrZW4iLAogICAgICBkZXNjOiAiVGhlIGljaW5nIG9uIHRoZXNlIER1dGNoIGNvb2tpZXMgaXMgdHJhZGl0aW9uYWxseSBwaW5rLCBidXQgZGlmZmVyZW50IGNvbG9ycyBtYXkgYmUgdXNlZCBmb3Igc3BlY2lhbCBvY2Nhc2lvbnMgLSBzdWNoIGFzIHBpbmsgdG8gY2VsZWJyYXRlIEJyZWFzdCBDYW5jZXIgQXdhcmVuZXNzIE1vbnRoLCBvciBmb3IgSW50ZXJuYXRpb25hbCBGbGFtaW5nbyBEYXksIHBpbmsuIiwKICAgICAgaWNvbjogWzMwLCAzMl0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoMzApLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiUGVhbnV0IGJ1dHRlciBjdXAgY29va2llcyIsCiAgICAgIGRlc2M6ICJXaGF0IG1vcmUgcG9pZ25hbnQgZXhhbXBsZSBvZiBtb2Rlcm4gc29jaWV0YWwgc3RydWdnbGVzIHRoYW4gdGhlIGJyYXplbiByZWNsYWltaW5nIG9mIGEgY29ycG9yYXRlIHByb2R1Y3QgYnkgaW50ZWdyYXRpbmcgaXQgaW4gdGhlIHZhc3RseSBtb3JlIGF1dGhlbnRpYyBzaGVsbCBvZiBhIGhvbWVtYWRlIHVuZGVydGFraW5nPyBBbnl3YXkgdGhpcyBpcyBhIHBlYW51dCBidXR0ZXIgY3VwLCBiYWtlZCBpbnRvIGEgY29va2llLiBJdCdzIHByZXR0eSBnb29kISIsCiAgICAgIGljb246IFszMSwgMzJdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDMxKSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlNlc2FtZSBjb29raWVzIiwKICAgICAgZGVzYzogIkxvb2sgYXQgYWxsIHRoZSBsaXR0bGUgc2VlZHMgb24gdGhlc2UhIEl0J3MgbGlrZSBzb21lb25lIGRyb3BwZWQgdGhlbSBvbiB0aGUgc3RyZWV0IG9yIHNvbWV0aGluZyEgQSB2ZXJ5IHdlbGNvbWluZyBhbmQgZWR1Y2F0aW9uYWwgc3RyZWV0ISIsCiAgICAgIGljb246IFsyMiwgMzNdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDMyKSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlRhaXlha2kiLAogICAgICBkZXNjOiAiQSBwYXN0cnkgZmlzaCBmaWxsZWQgd2l0aCByZWQgYmVhbiBwYXN0ZSwgZG9vbWVkIHRvIGxpdmUgYW4gZXhpc3RlbmNlIG9mIGNvbnN0YW50IGFuZCBleGNydWNpYXRpbmcgcGFpbiBhcyBpdHMgYXF1YXRpYyBlbnZpcm9ubWVudCBzbG93bHkgZGlzc29sdmVzIGl0cyBzb2Z0IGRvdWdoeSBib2R5Ljxicj5BbHNvIGNvbWVzIGluIGNob2NvbGF0ZSBmbGF2b3IhIiwKICAgICAgaWNvbjogWzIzLCAzM10sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoMzMpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiVmFuaWxsZWtpcGZlcmwiLAogICAgICBkZXNjOiAiTnV0LWJhc2VkIGNvb2tpZXMgZnJvbSBDZW50cmFsIEV1cm9wZSwgY29hdGVkIGluIHBvd2RlcmVkIHZhbmlsbGEgc3VnYXIuIFJlZ3VsYXIga2lwZmVybCwgY3Jlc2NlbnQtc2hhcGVkIGJyZWFkIHJvbGxzIGZyb20gdGhlIHNhbWUgcmVnaW9uLCBhcmUgbXVjaCBsZXNzIGV4Y2l0aW5nLiIsCiAgICAgIGljb246IFsyNCwgMzNdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDM0KSwKICAgIH0pOwoKICAgIG9yZGVyID0gMTAzMDA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQ29zbWljIGNob2NvbGF0ZSBidXR0ZXIgYmlzY3VpdCIsCiAgICAgIGRlc2M6ICJSZXdhcmRlZCBmb3Igb3duaW5nIDU1MCBvZiBldmVyeXRoaW5nLjxicj5UaHJvdWdoIHNvbWUgc3RyYW5nZSB0cmljayBvZiBtYWdpYyBvciB0ZWNobm9sb2d5LCBsb29raW5nIGF0IHRoaXMgY29va2llIGlzIGxpa2UgcGVlcmluZyBpbnRvIGEgZGVlcCBvY2VhbiBvZiBhbmNpZW50IHN0YXJzLiBUaGUgb3JpZ2lucyBvZiB0aGlzIGJpc2N1aXQgYXJlIHVua25vd247IGl0cyBtYW51ZmFjdHVyZSwgYXMgZmFyIGFzIHlvdXIgYmVzdCBpbnZlc3RpZ2F0b3JzIGNhbiB0ZWxsLCBsZWZ0IG5vIHBhcGVyIHRyYWlsLiBGcm9tIGEgY2VydGFpbiBhbmdsZSwgaWYgeW91IHNxdWludCBoYXJkIGVub3VnaCwgeW91J2xsIG5vdGljZSB0aGF0IGEgbnVtYmVyIG9mIHN0YXJzIG5lYXIgdGhlIGNlbnRlciBhcmUgYXJyYW5nZWQgdG8gcmVzZW1ibGUgdGhlIG91dGxpbmUgb2YgeW91ciBvd24gZmFjZS4iLAogICAgICBpY29uOiBbMjcsIDMyXSwKICAgICAgcG93ZXI6IDEwLAogICAgICBwcmljZToKICAgICAgICA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKiBidXR0ZXJCaXNjdWl0TXVsdCwKICAgICAgbG9ja2VkOiAxLAogICAgfSk7CgogICAgb3JkZXIgPSAxMDA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiTm9uaWxsaW9uIGZpbmdlcnMiLAogICAgICBnZXRTdHJUaG91c2FuZEZpbmdlcnNHYWluKDIwKSArCiAgICAgICAgIjxxPk9ubHkgZm9yIHRoZSBmcmVha2llc3QgaGFuZHNoYWtlcy48L3E+IiwKICAgICAgMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIFsxMiwgMzFdCiAgICApOwogICAgR2FtZS5NYWtlVGllcmVkKEdhbWUubGFzdCwgMTMsIDApOwogICAgb3JkZXIgPSAxNTA7CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiTWlyYWN1bGl0ZSBtb3VzZSIsCiAgICAgIGdldFN0ckNsaWNraW5nR2FpbnMoMSkgKwogICAgICAgICI8cT5Db21wb3NlZCBvZiBhIG1hdGVyaWFsIHRoYXQgbmVpdGhlciBzY2llbmNlIG5vciBwaGlsb3NvcGh5IGFyZSBlcXVpcHBlZCB0byBjb25jZXB0dWFsaXplLiBBbmQgYm95LCBkb2VzIGl0IGV2ZXIgY2xpY2suPC9xPiIsCiAgICAgIDUwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwLAogICAgICBbMTEsIDMxXQogICAgKTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDEzLCAxMSk7CiAgICBvcmRlciA9IDIwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkdlbmVyYXRpb24gZGVnZW5lcmF0aW9uIiwKICAgICAgIjxxPkdlbmV0aWMgdGVzdGluZyBzaG93cyB0aGF0IG1vc3Qgb2YgeW91ciBncmFuZG1hcyBhcmUgaW5mZWN0ZWQgd2l0aCBhIHN0cmFuZ2UgZGVnZW5lcmF0aXZlIGRpc2Vhc2UgdGhhdCBvbmx5IHNlZW1zIHRvIGZ1cnRoZXIgdGhlaXIgcG93ZXJzOyB0aGUgbW9yZSB0aW1lIHBhc3NlcywgdGhlIG9sZGVyIHRoZXkgZ2V0LiBUaGlzIHNob3VsZCBjb25jZXJuIHlvdS48L3E+IiwKICAgICAgIkdyYW5kbWEiLAogICAgICAxMgogICAgKTsKICAgIG9yZGVyID0gMzAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiR2xvYmFsIHNlZWQgdmF1bHQiLAogICAgICAiPHE+QW4gZW5vcm1vdXMgZ2VuZXRpYyByZXBvc2l0b3J5IHRoYXQgY291bGQgb3V0bGl2ZSBhbiBhcG9jYWx5cHNlLiBHdWFyYW50ZWVzIHRoZSBzdXJ2aXZhbCBvZiB5b3VyIGVtcGlyZSwgb3IgYXQgdGhlIHZlcnkgbGVhc3QgaXRzIGFncmljdWx0dXJhbCBjb21wb25lbnRzLCBzaG91bGQgY2l2aWxpemF0aW9uIGZhbGwuIFdoaWNoIHNob3VsZCBiZSBhbnkgZGF5IG5vdy48L3E+IiwKICAgICAgIkZhcm0iLAogICAgICAxMgogICAgKTsKICAgIG9yZGVyID0gNDAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQWlyIG1pbmluZyIsCiAgICAgICI8cT5Zb3UndmUgZHVnIHlvdXIgZHJpbGxzIHRocm91Z2gganVzdCBhYm91dCBldmVyeSBzb2xpZCBzdXJmYWNlIHlvdSBjb3VsZCBmaW5kLiBCdXQgZGlkIHlvdSBrbm93IHJlY2VudCBhZHZhbmNlcyBoYXZlIHJldmVhbGVkIHVudG9sZCByaWNoZXMgaGlkaW5nIHdpdGhpbiBub24tc29saWQgc3VyZmFjZXMgdG9vPzwvcT4iLAogICAgICAiTWluZSIsCiAgICAgIDEyCiAgICApOwogICAgb3JkZXIgPSA1MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJCZWhhdmlvcmFsIHJlZnJhbWluZyIsCiAgICAgICI8cT5UaHJvdWdoIGNhcmVmdWwgc29jaWFsIGVuZ2luZWVyaW5nIHlvdSd2ZSBjb252aW5jZWQgeW91ciB3b3JrZXJzIHRoYXQgXCJ1bmlvblwiIGlzIGEgc2x1ciB0aGF0IG9ubHkgdGhlIG1vc3QgdmlsZSBhbmQgcmVwdWduYW50IGZpbHRoIGFtb25nIHVzIHdvdWxkIGV2ZXIgZGFyZSB1dHRlciEgU29tZXRpbWVzIHByb2dyZXNzIGlzbid0IGluIHRoZSBiaWcgbWFjaGluZXMsIGl0J3MgaW4gdGhlIGxpdHRsZSBsaWVzITwvcT4iLAogICAgICAiRmFjdG9yeSIsCiAgICAgIDEyCiAgICApOwogICAgb3JkZXIgPSA1MjU7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJBbHRydWlzdGljIGxvb3AiLAogICAgICAiPHE+WW91IGNvbnRyb2wgc28gbWFueSBicmFuY2hlcyBvZiB0aGUgZ2xvYmFsIGVjb25vbXkgYW5kIGxlZ2lzbGF0aXZlIGJvZGllcyB0aGF0LCB0aHJvdWdoIGEgcGFydGljdWxhcmx5IGNyZWF0aXZlIGxvb3Bob2xlLCBkb25hdGluZyBtb25leSAodG8geW91cnNlbGYpIGdyYW50cyB5b3UgZXZlbiBtb3JlIGNhc2ggaW4gdGF4IGRlZHVjdGlvbnMgdGhhbiB5b3Ugc3RhcnRlZCB3aXRoITwvcT4iLAogICAgICAiQmFuayIsCiAgICAgIDEyCiAgICApOwogICAgb3JkZXIgPSA1NTA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJBIG5vdmVsIGlkZWEiLAogICAgICAiPHE+WW91IGRvbid0IGdldCByaWNoIHN0YXJ0aW5nIGEgcmVsaWdpb24uIElmIHlvdSB3YW50IHRvIGdldCByaWNoLCB5b3Ugd3JpdGUgc2NpZW5jZSBmaWN0aW9uLjwvcT4iLAogICAgICAiVGVtcGxlIiwKICAgICAgMTIKICAgICk7CiAgICBvcmRlciA9IDU3NTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlNwZWxsaW5nIGJlZXMiLAogICAgICAiPHE+WW91J3ZlIHVubGVhc2hlZCBhIHN3YXJtIG9mIG1hZ2ljYWxseS1lbmhhbmNlZCBiZWVzIHVwb24gbWFua2luZCEgVGhlaXIgc3Rpbmdpbmcgc3BlbGxzIG1heSBiZSB0aGUgYmFuZSBvZiBhbGwgbGl2aW5nIHRoaW5ncyBidXQgeW91J3JlIGNlcnRhaW4geW91IGNhbiBwdXQgdGhlaXIgZGVsaWNpb3VzLCBwdXJwbGUsIGZpenp5IGhvbmV5IHRvIGdvb2QgdXNlITwvcT4iLAogICAgICAiV2l6YXJkIHRvd2VyIiwKICAgICAgMTIKICAgICk7CiAgICBvcmRlciA9IDYwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRvcm9pZCB1bml2ZXJzZSIsCiAgICAgICI8cT5JZiB5b3UgdGhpbmsgb2YgdGhlIHVuaXZlcnNlIGFzIGFuIG50aC1kaW1lbnNpb25hbCB0b3J1cyB0aGF0IHdyYXBzIGJhY2sgb24gaXRzZWxmIGluIGV2ZXJ5IGRpcmVjdGlvbiwgeW91IGNhbiBzYXZlIGEgZm9ydHVuZSBvbiByb2NrZXQgZnVlbCEgT2YgY291cnNlIHRoZSB1bml2ZXJzZSBpc24ndCBhY3R1YWxseSBzaGFwZWQgbGlrZSB0aGF0LCBidXQgeW91J3ZlIG5ldmVyIGxldCBkZXRhaWxzIHN0YW5kIGluIHlvdXIgd2F5LjwvcT4iLAogICAgICAiU2hpcG1lbnQiLAogICAgICAxMgogICAgKTsKICAgIG9yZGVyID0gNzAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiSGVybWV0aWMgcmVjb25jaWxpYXRpb24iLAogICAgICAiPHE+SXQncyB0aW1lIGZvciBtb2Rlcm4gc2NpZW5jZSBhbmQgdGhlIG15c3RpY2FsIGRvbWFpbnMgb2YgdGhlIG9jY3VsdCB0byB3b3JrIHRvZ2V0aGVyIGF0IGxhc3QuIFdoYXQgZG8gZ3Jhdml0b25zIHRyYW5zbXV0ZSBpbnRvPyBXaGF0IGlmIGFsa2FoZXN0IGlzIHBILW5ldXRyYWw/IFNob3VsZCBhIGhvbXVuY3VsdXMgaGF2ZSB0aGUgcmlnaHQgdG8gdm90ZT8gQW5kIG90aGVyIGV4Y2l0aW5nIHF1ZXN0aW9ucyBjb21pbmcgdG8geW91IHNvb24sIHdoZXRoZXIgeW91IGxpa2UgaXQgb3Igbm90LjwvcT4iLAogICAgICAiQWxjaGVteSBsYWIiLAogICAgICAxMgogICAgKTsKICAgIG9yZGVyID0gODAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiSGlzIGFkdmVudCIsCiAgICAgICI8cT5IZSBjb21lcyEgSGUgY29tZXMgYXQgbGFzdCEgSnVzdCBsaWtlIHRoZSBwcm9waGVjaWVzIGZvcmV0b2xkISBBbmQgYXMgSGUgc3RlcHMgb3V0IG9mIHRoZSBwb3J0YWwsIHlvdXIgZW5naW5lZXJzIGJlZ2luIHNsaWNpbmcgSGltIGludG8gY29udmVuaWVudCBjaHVua3MgYmVmb3JlIHRyYW5zcG9ydGluZyBIaXMgd3JpdGhpbmcgY29zbWljIGZsZXNoIHRvIHlvdXIgZmFjdG9yaWVzLCB3aGVyZSBIZSB3aWxsIGJlIHByb2Nlc3NlZCBhbmQgY29udmVydGVkIGludG8gYSBuZXcgYW5kIGV4Y2l0aW5nIGNvb2tpZSBmbGF2b3IsIGF2YWlsYWJsZSBpbiBzdG9yZXMgdG9tb3Jyb3cuPC9xPiIsCiAgICAgICJQb3J0YWwiLAogICAgICAxMgogICAgKTsKICAgIG9yZGVyID0gOTAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiU3BsaXQgc2Vjb25kcyIsCiAgICAgICI8cT5UaW1lIGlzIGluZmluaXRlLCB5ZXMuLi4gQnV0IHdoYXQgaWYsIG5lc3RsZWQgd2l0aGluIGVhY2ggc2Vjb25kLCB3ZXJlIGV2ZW4gbW9yZSBpbmZpbml0aWVzPyBFdmVyeSBtb21lbnQgYW4gZXRlcm5pdHkhIFRoaW5rIG9mIGhvdyBtYW55IHNjaGVkdWxpbmcgdHJvdWJsZXMgdGhpcyBzb2x2ZXMhPC9xPiIsCiAgICAgICJUaW1lIG1hY2hpbmUiLAogICAgICAxMgogICAgKTsKICAgIG9yZGVyID0gMTAwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkZsYXZvciBpdHNlbGYiLAogICAgICAiPHE+RGVlcCB1bmRlciB0aGUgZWFydGgsIGluIHRoZSBtb3N0IHN0ZXJpbGUgbGFib3JhdG9yeSwgaW4gdGhlIG1vc3QgdmFzdCBhbmQgZXhwZW5zaXZlIHBhcnRpY2xlIGFjY2VsZXJhdG9yIGV2ZXIgZGV2aXNlZCwgeW91ciBzY2llbnRpc3RzIGhhdmUgc3ludGhlc2l6ZWQgLWZvciBhIGZyYWN0aW9uIG9mIGEgc2Vjb25kLSB0aGUgcGh5c2ljYWwgbWFuaWZlc3RhdGlvbiBvZiBwdXJlIGZsYXZvci4gSGlnaGx5IHVuc3RhYmxlLCBhbmQgZ29uZSBpbiBhIHB1ZmYgb2YgcmFkaW9hY3RpdmUgZW5lcmd5LCBpdCBub25ldGhlbGVzcyBsZWZ0IHlvdXIgdGVhbSBzaGl2ZXJpbmcgd2l0aCBhd2UuLi4gYW5kIGh1bmdlci48L3E+IiwKICAgICAgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwKICAgICAgMTIKICAgICk7CiAgICBvcmRlciA9IDExMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJMaWdodCBzcGVlZCBsaW1pdCIsCiAgICAgICI8cT5XaG9haCwgc2xvdyBkb3duLiBIYXJ2ZXN0aW5nIGxpZ2h0IGlzIHdlbGwgYW5kIGdvb2QgYnV0IGl0J2QgYmUgbXVjaCBlYXNpZXIgaWYgaXQgd2VyZW4ndCBzbyBkYW5nIGZhc3QhIFRoaXMgc2hvdWxkIHRoYW5rZnVsbHkgdGFrZSBjYXJlIG9mIHRoYXQuPC9xPiIsCiAgICAgICJQcmlzbSIsCiAgICAgIDEyCiAgICApOwogICAgb3JkZXIgPSAxMjAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQSB0b3VjaCBvZiBkZXRlcm1pbmlzbSIsCiAgICAgICI8cT5CeSBrbm93aW5nIHRoZSBleGFjdCBwb3NpdGlvbiBhbmQgbW92ZW1lbnQgb2YgZXZlcnkgcGFydGljbGUgaW4gdGhlIHVuaXZlcnNlLCB5b3UncmUgYWJsZSB0byBwcmVkaWN0IGV2ZXJ5dGhpbmcgdGhhdCBjYW4gZXZlciBoYXBwZW4sIGxlYXZpbmcgbm90aGluZyB0byBjaGFuY2UuIFRoaXMgd2FzIGEgZG9venkgdG8gcHVsbCBvZmYgbWluZCB5b3UsIGJ1dCBpdCdzIGhlbHBlZCB5b3Ugd2luIDUwIGJ1Y2tzIGF0IHRoZSBob3JzZSByYWNlcyBzbyB5b3UgY291bGQgc2F5IGl0J3MgYWxyZWFkeSBwYXlpbmcgb2ZmLjwvcT4iLAogICAgICAiQ2hhbmNlbWFrZXIiLAogICAgICAxMgogICAgKTsKICAgIG9yZGVyID0gMTMwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRoaXMgdXBncmFkZSIsCiAgICAgICI8cT5UaGlzIHVwZ3JhZGUncyBmbGF2b3IgdGV4dCBsaWtlcyB0byByZWZlciB0byBpdHNlbGYsIGFzIHdlbGwgYXMgdG8gdGhlIGZhY3QgdGhhdCBpdCBsaWtlcyB0byByZWZlciB0byBpdHNlbGYuIFlvdSBzaG91bGQgcmVhbGx5IGJ1eSB0aGlzIHVwZ3JhZGUgYmVmb3JlIGl0IHN0YXJ0cyBkb2luZyBhbnl0aGluZyBtb3JlIG9ibm94aW91cy48L3E+IiwKICAgICAgIkZyYWN0YWwgZW5naW5lIiwKICAgICAgMTIKICAgICk7CiAgICBvcmRlciA9IDE0MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJZb3VyIGJpZ2dlc3QgZmFucyIsCiAgICAgICI8cT5MZXQncyBmYWNlIGl0LCBiYWtpbmcgY29va2llcyBpc24ndCB0aGUgbW9zdCBvcHRpbWl6ZWQgdGhpbmcgdGhlcmUgaXMuIFNvIHlvdSd2ZSBwdXJjaGFzZWQgeW91ciBiaWdnZXN0IGZhbnMgeWV0IGFuZCBzdHVjayB0aGVtIG5leHQgdG8geW91ciBjb21wdXRlcnMgdG8ga2VlcCB0aGluZ3MgY2hpbGwgYW5kIGluIHdvcmtpbmcgb3JkZXIuIENvb2whPC9xPiIsCiAgICAgICJKYXZhc2NyaXB0IGNvbnNvbGUiLAogICAgICAxMgogICAgKTsKCiAgICBvcmRlciA9IDEwMDIwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkJhdHRlbmJlcmcgYmlzY3VpdHMiLAogICAgICBkZXNjOiAiSW5zcGlyZWQgYnkgYSBjYWtlIG9mIHRoZSBzYW1lIG5hbWUsIGl0c2VsZiBuYW1lZCBhZnRlciBhIHByaW5jZSBvZiB0aGUgc2FtZSBuYW1lLiBZb3Ugc3VwcG9zZSB5b3UgY291bGQgcGxheSBhIHJlYWxseSwgcmVhbGx5IHNob3J0IGdhbWUgb2YgY2hlc3Mgb24gdGhlc2UuIiwKICAgICAgaWNvbjogWzI4LCAzM10sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoMzUpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiUm9zZXR0ZSBjb29raWVzIiwKICAgICAgZGVzYzogIkludHJpY2F0ZSBmcmllZCBwYXN0cmllcyBmcm9tIE5vcnRoZXJuIEV1cm9wZSwgbWFkZSB1c2luZyBzcGVjaWFsaXplZCBpcm9ucyBhbmQgZGlwcGVkIGluIGljaW5nIHN1Z2FyLiBXaGlsZSB1c3VhbGx5IGVhdGVuIGFzIGEgZGVsaWNpb3VzIHRyZWF0LCB0aGVzZSBhcmUgb2Z0ZW4gYWxzbyB1c2VkIGFzIENocmlzdG1hcyB0cmVlIGRlY29yYXRpb25zLCBvciB3b3JuIGVsZWdhbnRseSBvbiBvbmUncyBsYXBlbCB0byBzeW1ib2xpemUgdGhlIG5haCBJJ20ganVzdCBtZXNzaW5nIHdpdGggeW91LiIsCiAgICAgIGljb246IFsyNiwgMzNdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDM2KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkdhbmdtYWtlcnMiLAogICAgICBkZXNjOiAiVGhlIGxpdHRsZSBiaXQgb2YgcmFzcGJlcnJ5IGphbSBhdCBpdHMgY2VudGVyIGlzIGNydWNpYWw7IGEgcGxhaW4gYnV0dGVyIGNvb2tpZSB3aXRoIGNob2NvbGF0ZSB0b3BwaW5nIGRvZXMgbm90IGEgZ2FuZ21ha2VyIG1ha2UuIiwKICAgICAgaWNvbjogWzI3LCAzM10sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoMzcpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiV2Vsc2ggY29va2llcyIsCiAgICAgIGRlc2M6ICJXZWxzaCBjb29raWVzLCBhbHNvIGtub3duIGFzIFdlbHNoIGNha2VzLCBiYWtlc3RvbmVzLCBncmlkZGxlIGNha2VzLCBncmlkZGxlIHNjb25lcywgb3IgcGljcywgb3IgaW4gV2Vsc2g6IDxpPnBpY2F1IGFyIHkgbWFlbiwgcGljZSBiYWNoLCBjYWNlbm5hdSBjcmk8L2k+IG9yIDxpPnRlaXNlbm5hdSBncmFkZWxsPC9pPiwgYXJlIHJpY2ggY3VycmFudC1maWxsZWQgc2NvbmUtbGlrZSBiaXNjdWl0cyBvZiB1bmNlcnRhaW4gb3JpZ2luLiIsCiAgICAgIGljb246IFsyOSwgMzNdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDM4KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlJhc3BiZXJyeSBjaGVlc2VjYWtlIGNvb2tpZXMiLAogICAgICBkZXNjOiAiVGhlIGh1bWJsZSByYXNwYmVycnkgY2hlZXNlY2FrZSwgbm93IGluIGFzY2VuZGVkIGNvb2tpZSBmb3JtLiBSZXNlYXJjaGVycyBwb3NpdCB0aGF0IHJhc3BiZXJyeSBjaGVlc2VjYWtlIGNvb2tpZXMgYXJlIGV2aWRlbmNlIHRoYXQgdGhlIGZpbmFsIGZvcm0gb2YgZXZlcnkgYmFrZWQgZ29vZCwgdGhyb3VnaCBjb252ZXJnZW50IGV2b2x1dGlvbiwgYXBwcm9hY2hlcyB0aGF0IG9mIGEgY29va2llLCBpbiBhIHByb2Nlc3Mga25vd24gYXMgY29va2llbmlzYXRpb24uIiwKICAgICAgaWNvbjogWzI1LCAzM10sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoMzkpLAogICAgfSk7CgogICAgb3JkZXIgPSAyNTU7CiAgICBHYW1lLkdyYW5kbWFTeW5lcmd5KAogICAgICAiQWx0ZXJuYXRlIGdyYW5kbWFzIiwKICAgICAgIkEgZGlmZmVyZW50IGdyYW5kbWEgdG8gYmFrZSBzb21ldGhpbmcgZWxzZS4iLAogICAgICAiSWRsZXZlcnNlIgogICAgKTsKCiAgICBvcmRlciA9IDE1MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJNYW5pZmVzdCBkZXN0aW55IiwKICAgICAgIjxxPldoaWxlIHRoZSBldGhpY3Mgb2YgcmFuc2Fja2luZyBwYXJhbGxlbCB1bml2ZXJzZXMgZm9yIHRoZWlyIHJpY2hlcyBtYXkgc2VlbSBxdWVzdGlvbmFibGUgdG8gc29tZSwgeW91J3ZlIHJlYXNvbmVkIHRoYXQgYnJpbmdpbmcgdGhlIGdvb2Qgd29yZCBvZiB5b3VyIGNvb2tpZSBlbXBpcmUgdG8gdGhlIHVud2FzaGVkIGNvbmZpbmVzIG9mIG90aGVyIHJlYWxpdGllcyBpcyB5b3VyIG1vcmFsIGR1dHksIG5heSwgeW91ciByaWdodGVvdXMgaW1wZXJhdGl2ZSwgYW5kIG11c3QgYmUgdW5kZXJ0YWtlbiBhcyBzb29uIGFzIHBvc3NpYmxlLCBsZXN0IHRoZXkgZG8gaXQgdG8geW91IGZpcnN0ITwvcT4iLAogICAgICAiSWRsZXZlcnNlIiwKICAgICAgMQogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRoZSBtdWx0aXZlcnNlIGluIGEgbnV0c2hlbGwiLAogICAgICAnPHE+VGhlIHN0cnVjdHVyZSBvZiB0aGUgbWV0YWNvc21vcyBtYXkgc2VlbSBjb25mdXNpbmcgYW5kIGF0IHRpbWVzIGV2ZW4gY29udHJhZGljdG9yeSwgYnV0IGhlcmVcJ3Mgd2hhdCB5b3VcJ3ZlIGdhdGhlcmVkIHNvIGZhcjo8YnI+PGJyPjxkaXYgc3R5bGU9InRleHQtYWxpZ246bGVmdDsiPiZidWxsOyBlYWNoIHJlYWxpdHksIG9yICJpZGxldmVyc2UiLCBleGlzdHMgaW4gcGFyYWxsZWwgdG8gYWxsIG90aGVyczxicj48YnI+JmJ1bGw7IG1vc3QgcmVhbGl0aWVzIHNlZW0gdG8gY29udmVyZ2UgdG93YXJkcyB0aGUgcHJvZHVjdGlvbiBvZiBhIHNvbGUgdHlwZSBvZiBpdGVtIChvdXJzIGV2aWRlbnRseSBiZWluZywgdGhhbmtzIHRvIHlvdSwgY29va2llcyk8YnI+PGJyPiZidWxsOyBlYWNoIHJlYWxpdHkgaXMgcmlkZGxlZCB3aXRoIGNoYW90aWMgdHVubmVscyB0byBhIG51bWJlciBvZiBzdWJvcmRpbmF0ZSBkaW1lbnNpb25zIChzdWNoIGFzIHRoZSBzby1jYWxsZWQgImNvb2tpZXZlcnNlIiksIG11Y2ggbGlrZSBzd2lzcyBjaGVlc2U8YnI+PGJyPiZidWxsOyBhbGwgcmVhbGl0aWVzIGJhdGhlIGluIGFuIGluZmluaXRlIGxpcXVpZCBvZiBwZWN1bGlhciBwcm9wZXJ0aWVzLCBjb2xsb3F1aWFsbHkga25vd24gYXMgIm1pbGsiPC9kaXY+PGJyPkZpbmFsbHksIGVhY2ggcmVhbGl0eSBtYXkgaGF2ZSBpdHMgb3duIGludGVycHJldGF0aW9uIG9mIHRoZSBjb25jZXB0IG9mICJyZWFsaXR5IiwgZm9yIGFkZGVkIGZ1bi48L3E+JywKICAgICAgIklkbGV2ZXJzZSIsCiAgICAgIDIKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJBbGwtY29udmVyc2lvbiIsCiAgICAgICI8cT5JdCdzIHF1aXRlIG5pY2UgdGhhdCB5b3UgY2FuIHJld2lyZSB0aGUgbG9naWMgb2YgZWFjaCB1bml2ZXJzZSB0byBnZW5lcmF0ZSBjb29raWVzIGluc3RlYWQsIGJ1dCB5b3Ugc3RpbGwgZW5kIHVwIHdpdGggcGFyc2VjLWxvYWRzIG9mIHdoYXRldmVyIHRoZXkgd2VyZSBwcm9kdWNpbmcgYmVmb3JlIC0gYmF1YmxlcyB5b3UndmUgbG9uZyBtYWRlIG9ic29sZXRlOiBjYXNoIG1vbmV5LCBnZW1zLCBjaGVlc2VidXJnZXJzLCBwdXBwaWVzLi4uIFRoYXQncyB3aHkgeW91J3ZlIGRlc2lnbmVkIHRoZSB1bml2ZXJzYWwgY29udmVydGVyLCBjb21wYXRpYmxlIHdpdGggYW55IHN1YnN0YW5jZSBhbmQgY2FwYWJsZSBvZiB0dXJuaW5nIHRob3NlIHVzZWxlc3Mgc3BvaWxzIG9mIGNvbnF1ZXN0IGludG8gdGhlIHJlYXNzdXJpbmcgY3J1bWJseSBydXN0bGUgb2YgZXZlbiBtb3JlIGNvb2tpZXMuPC9xPiIsCiAgICAgICJJZGxldmVyc2UiLAogICAgICAzCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiTXVsdGl2ZXJzZSBhZ2VudHMiLAogICAgICAiPHE+WW91IGNhbiBzZW5kIHVuZGVyY292ZXIgc3BpZXMgdG8gaW5maWx0cmF0ZSBlYWNoIHVuaXZlcnNlIGFuZCBoYXZlIHRoZW0gc2lnbmFsIHlvdSB3aGV0aGVyIGl0J3Mgd29ydGggb3ZlcnRha2luZy4gT25jZSB0aGUgYXNzaW1pbGF0aW9uIHByb2Nlc3Mgc3RhcnRlZCwgdGhleSB3aWxsIGFsc28gaGVscCBwYWNpZnkgdGhlIGxvY2FsIHBvcHVsYXRpb25zLCBoYXZpbmcgZXN0YWJsaXNoZWQgdHJ1c3QgdGhyb3VnaCB0aGUgdXNlIG9mIHdhY2t5LCBidXQgc2VhbWxlc3MsIGRpc2d1aXNlcy48L3E+IiwKICAgICAgIklkbGV2ZXJzZSIsCiAgICAgIDQKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJFc2NhcGUgcGxhbiIsCiAgICAgICI8cT5Zb3UndmUgc2V0IGFuIGlkbGV2ZXJzZSBhc2lkZSBhbmQgdGVycmFmb3JtZWQgaXQgdG8gY2xvc2VseSByZXNlbWJsZSB0aGlzIG9uZSBpbiBjYXNlIHNvbWV0aGluZyBnb2VzIGhvcnJpYmx5IHdyb25nIGluIGhlcmUuIE9mIGNvdXJzZSwgdGhlIGRlbml6ZW5zIG9mIHRoYXQgaWRsZXZlcnNlIGFsc28gaGF2ZSB0aGVpciBvd24gZXNjYXBlIGlkbGV2ZXJzZSB0byBhYnNjb25kIHRvIGluIHRoZSBldmVudHVhbGl0eSBvZiB5b3VyIGFycml2YWwsIGl0c2VsZiBsaWtlbHkgaGF2aW5nIGl0cyBvd24gY29udGluZ2VuY3kgaWRsZXZlcnNlLCBhbmQgc28gb24uPC9xPiIsCiAgICAgICJJZGxldmVyc2UiLAogICAgICA1CiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiR2FtZSBkZXNpZ24iLAogICAgICAiPHE+RWFjaCBpZGxldmVyc2UgZnVuY3Rpb25zIGFjY29yZGluZyB0byBzb21lIGZvcm0gb2YgdHJhbnNjZW5kZW50YWwgcHJvZ3JhbW1pbmcsIHRoYXQgbXVjaCBpcyBhIGdpdmVuLiBCdXQgdGhleSBhbHNvIHNlZW0gdG8gYmUgZ292ZXJuZWQgYnkgbXVjaCBtb3JlIHN1YnRsZSBydWxlcywgdGhlIGxvZ2ljIG9mIHdoaWNoLCB3aGVuIGhhcm5lc3NlZCwgbWF5IGdpdmUgeW91IHVucGFyYWxsZWxlZCBkb21pbmlvbiBvdmVyIHRoZSBtdWx0aXZlcnNlLiBSZXdyaXRlIHRoZSBydWxlcyEgQSBnYW1lIGRlc2lnbmVyIGlzIHlvdSE8L3E+IiwKICAgICAgIklkbGV2ZXJzZSIsCiAgICAgIDYKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJTYW5kYm94IHVuaXZlcnNlcyIsCiAgICAgICI8cT5JdCBkb2Vzbid0IHNlZW0gbGlrZSB5b3UnbGwgcnVuIG91dCBvZiBleHRyYSB1bml2ZXJzZXMgYW55dGltZSBzb29uIHNvIHdoeSBub3QgcmVwdXJwb3NlIHNvbWUgb2YgdGhlbSBhcyBjb25zZXF1ZW5jZS1mcmVlIHRlc3RpbmcgZ3JvdW5kcyBmb3IgYWxsIHlvdXIgbW9yZSBleGlzdGVudGlhbGx5IHRocmVhdGVuaW5nIG1hcmtldCByZXNlYXJjaD8gKC4uLmNvbnNlcXVlbmNlLWZyZWUgZm9yIHlvdSwgYW55d2F5Lik8L3E+IiwKICAgICAgIklkbGV2ZXJzZSIsCiAgICAgIDcKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJNdWx0aXZlcnNlIHdhcnMiLAogICAgICAiPHE+SG1tLCBsb29rcyBsaWtlIHNvbWUgb3RoZXIgdW5pdmVyc2VzIHdpc2VkIHVwIHRvIHlvdXIgcGx1bmRlcmluZy4gVGhhbmtmdWxseSwgdGhhdCdzIG5vdGhpbmcgeW91ciBleHRyYSBiZWVmZWQtdXAgbWV0YWNvc21pYyBtaWxpdGFyeSBidWRnZXQgY2FuJ3QgaGFuZGxlITwvcT4iLAogICAgICAiSWRsZXZlcnNlIiwKICAgICAgOAogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIk1vYmlsZSBwb3J0cyIsCiAgICAgICI8cT5BY2Nlc3NpbmcgZWFjaCBvdXRlciB1bml2ZXJzZSBpcyBhIGJpdCBvZiBhIGhhc3NsZSwgcmVxdWlyaW5nIHRoZSBvbmNlLWluLWEtYmx1ZS1tb29uIGFsaWdubWVudCBvZiBuYXR1cmFsIGNvc21pYyBwb3J0cyB0byB0cmFuc2l0IGZyb20gdW5pdmVyc2UgdG8gdW5pdmVyc2UuIFlvdSd2ZSBmaW5hbGx5IHBlcmZlY3RlZCB0aGUgbWV0aG9kIG9mIGNvbnN0cnVjdGluZyB5b3VyIG93biBzZWxmLXByb3BlbGxlZCBwb3J0cywgd2hpY2ggY2FuIHRyYXZlbCBuZWFyLWluc3RhbnRhbmVvdXNseSBhbG9uZyB1bml2ZXJzYWwgcGVyaW1ldGVycyB0byBwZXJtaXQgaGVhZGFjaGUtZnJlZSBtdWx0aXZlcnNlIGNvbm5lY3Rpb25zLiBUb29rIHlvdSBsb25nIGVub3VnaC48L3E+IiwKICAgICAgIklkbGV2ZXJzZSIsCiAgICAgIDkKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJFbmNhcHN1bGF0ZWQgcmVhbGl0aWVzIiwKICAgICAgIjxxPlVudG9sZCBmZWF0cyBvZiBzY2llbmNlIHdlbnQgaW50byB0aGUgcmVkdWN0aW9uIG9mIGluZmluaXRlIHVuaXZlcnNlcyBpbnRvIHRoZXNlIHNtYWxsLCBnbGltbWVyaW5nLCBlYXN5LXRvLXN0b3JlIGxpdHRsZSBzcGhlcmVzLiBFeGVyY2lzZSBpbmZpbml0ZSBjYXV0aW9uIHdoZW4gaGFuZGxpbmcgdGhlc2UsIGZvciBlYWNoIG9mIHRoZW0sIGNvbnRhaW5pbmcgZW5kbGVzcyBnYWxheGllcyBhbmQgc3VwcG9ydGluZyBlbmRsZXNzIGxpZmUsIGlzIG1vcmUgcHJlY2lvdXMgdGhhbiB5b3UgY2FuIGV2ZXIgZmF0aG9tLiBUaGV5J3ZlIGFsc28gcHJvdmVuIHRvIGJlIHF1aXRlIGEgc21hc2ggaGl0IGluIHlvdXIgd2FyZWhvdXNlcyBvbiBib3dsaW5nIG5pZ2h0LjwvcT4iLAogICAgICAiSWRsZXZlcnNlIiwKICAgICAgMTAKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJFeHRyaW5zaWMgY2xpY2tpbmciLAogICAgICAiPHE+SWYgeW91IHBva2UgYW4gaWRsZXZlcnNlLCBpdCBzZWVtcyBsaWtlIGl0IGdldHMgd29yayBkb25lIGZhc3Rlci4gSXQncyBhbHNvIHF1aXRlIGZ1biBoZWFyaW5nIGEgdHJpbGxpb24gdGVycmlmaWVkIHZvaWNlcyBzY3JlYW1pbmcgaW4gdW5pc29uLjwvcT4iLAogICAgICAiSWRsZXZlcnNlIiwKICAgICAgMTEKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJVbml2ZXJzYWwgaWRsaW5nIiwKICAgICAgIjxxPlRoZSBuYXR1cmUgb2YgaWRsZXZlcnNlcyBpcyBmb3VuZCBpbiB3YWl0aW5nLiBUaGUgbW9yZSB5b3Ugd2FpdCBvbiBhbiBpZGxldmVyc2UsIHRoZSBtb3JlIGV4cG9uZW50aWFsbHkgcG90ZW50IGl0IGJlY29tZXMgLSB3aGljaCBzYXZlcyB5b3UgYSB3aG9sZSBsb3Qgb2YgaGFyZCB3b3JrLiBJbiBhIHRydWUgYWN0IG9mIHplbiwgeW91J3ZlIHRha2VuIHRvIGJpZGluZyB5b3VyIHRpbWUgd2hlbiBjb2xsZWN0aW5nIG5ldyB1bml2ZXJzZXMsIGxldHRpbmcgdGhlbSByaXBlbiBsaWtlIGEgZmluZSB3aW5lLjwvcT4iLAogICAgICAiSWRsZXZlcnNlIiwKICAgICAgMTIKICAgICk7CgogICAgb3JkZXIgPSA1MDAwOwogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIlBlcmZvcmF0ZWQgbWlsbGUtZmV1aWxsZSBjb3Ntb3MiLAogICAgICAiPHE+SW1hZ2luZSwgaWYgeW91IHdpbGwsIGxheWVycyB1cG9uIGxheWVycyB1cG9uIGxheWVycy4gTm93IHBpY3R1cmUgYmlsbGlvbnMgb2Ygd29ybXMgY2hld2luZyB0aGVpciB3YXkgdGhyb3VnaCBpdCBhbGwuIFRoaXMgcm91Z2hseSwgYnV0IG5vdCBxdWl0ZSwgYXBwcm94aW1hdGVzIHRoZSBnZW9tZXRyeSBvZiB0aGUgbW9zdCBiYXNhbCBzdHJhdHVtIG9mIG91ciBuYXR1cmFsIHdvcmxkLjwvcT4iLAogICAgICAiSWRsZXZlcnNlIiwKICAgICAgIlBvcnRhbCIsCiAgICAgICJzeW5lcmd5MSIKICAgICk7CiAgICBHYW1lLlN5bmVyZ3lVcGdyYWRlKAogICAgICAiSW5mcmF2ZXJzZXMgYW5kIHN1cGVydmVyc2VzIiwKICAgICAgIjxxPlVuaXZlcnNlcyB3aXRoaW4gdW5pdmVyc2VzPyBIb3cgc3VidmVyc2l2ZSE8L3E+IiwKICAgICAgIklkbGV2ZXJzZSIsCiAgICAgICJGcmFjdGFsIGVuZ2luZSIsCiAgICAgICJzeW5lcmd5MiIKICAgICk7CgogICAgb3JkZXIgPSAxOTAwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkZvcnR1bmUgIzAxOCIsCiAgICAgICI8cT5UaGVyZSdzIHBsZW50eSBvZiBldmVyeW9uZSwgYnV0IG9ubHkgb25lIG9mIHlvdS48L3E+IiwKICAgICAgIklkbGV2ZXJzZSIsCiAgICAgICJmb3J0dW5lIgogICAgKTsKCiAgICBvcmRlciA9IDEwMzAwOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkJ1dHRlciBiaXNjdWl0ICh3aXRoIGJ1dHRlcikiLAogICAgICBkZXNjOiAiUmV3YXJkZWQgZm9yIG93bmluZyA2MDAgb2YgZXZlcnl0aGluZy48YnI+VGhpcyBpcyBhIHBsYWluIGJ1dHRlciBiaXNjdWl0LiBJdCdzIGdvdCBzb21lIGJ1dHRlciBvbiBpdC4gVGhlIGJ1dHRlciBkb2Vzbid0IGxvb2sgbGlrZSBhbnl0aGluZyBpbiBwYXJ0aWN1bGFyLiIsCiAgICAgIGljb246IFszMCwgMzNdLAogICAgICBwb3dlcjogMTAsCiAgICAgIHByaWNlOgogICAgICAgIDk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSAqIGJ1dHRlckJpc2N1aXRNdWx0LAogICAgICBsb2NrZWQ6IDEsCiAgICB9KTsKCiAgICBvcmRlciA9IDIwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlZpc2l0cyIsCiAgICAgICI8cT5JbiBhbiBleHRlbnNpdmUgZG91YmxlLWJsaW5kIHN0dWR5IChzYW1wbGUgc2l6ZTogMTIgbWlsbGlvbiksIHlvdXIgcmVzZWFyY2hlcnMgaGF2ZSBmb3VuZCBldmlkZW5jZSB0aGF0IGdyYW5kbWFzIGFyZSB1cCB0byB0d2ljZSBhcyBwcm9kdWN0aXZlIGlmIHlvdSBqdXN0IGNvbWUgYnkgYW5kIHNheSBoaSBvbmNlIGluIGEgd2hpbGUuIEl0J3MgbmljZSB0byBjaGVjayB1cCBvbiB5b3VyIGdyYW5zISAoRG8gbm90IHVuZGVyIGFueSBjaXJjdW1zdGFuY2VzIGluZ2VzdCBhbnkgdGVhIG9yIHRlYS1saWtlIHN1YnN0YW5jZXMgdGhlIGdyYW5kbWFzIG1heSBvZmZlciB5b3UuKTwvcT4iLAogICAgICAiR3JhbmRtYSIsCiAgICAgIDEzCiAgICApOwogICAgb3JkZXIgPSAzMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJSZXZlcnNlLXZlZ2FuaXNtIiwKICAgICAgIjxxPlBsYW50cyBhcmVuJ3QgZm9yIGVhdGluZywgcGxhbnRzIGFyZSBmb3IgZXhwbG9pdGF0aXZlIGFncmljdWx0dXJlIGFuZCBhc3Ryb25vbWljYWwgcHJvZml0IG1hcmdpbnMhPC9xPiIsCiAgICAgICJGYXJtIiwKICAgICAgMTMKICAgICk7CiAgICBvcmRlciA9IDQwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkNhcmFtZWwgYWxsb3lzIiwKICAgICAgIjxxPllvdXIgZ2VvbG9naXN0cyBoYXZlIGlzb2xhdGVkIGEgZmFtaWx5IG9mIG9uY2Utb3Zlcmxvb2tlZCBzdWdhcnkgb3JlcyB0aGF0LCB3aGVuIGNvbWJpbmVkLCBtYXkgYmUgdHVybmVkIGludG8gZXZlbiBtb3JlIGNvb2tpZSBpbmdyZWRpZW50cy4gWW91ciBtaWxsaW9ucyBvZiBtaWxlcyBvZiBwcmV2aW91c2x5IHVzZWxlc3MgdHVubmVscyBwcm9iYWJseSBob3VzZSBpbnNhbmUgYW1vdW50cyBvZiB0aGUgc3R1ZmYhPC9xPiIsCiAgICAgICJNaW5lIiwKICAgICAgMTMKICAgICk7CiAgICBvcmRlciA9IDUwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlRoZSBpbmZpbml0eSBlbmdpbmUiLAogICAgICAiPHE+SW4gdGhpcyBob3VzZSwgSSBndWVzcyB3ZSBkb24ndCBjYXJlIG11Y2ggZm9yIHRoZSBsYXdzIG9mIHRoZXJtb2R5bmFtaWNzLjwvcT4iLAogICAgICAiRmFjdG9yeSIsCiAgICAgIDEzCiAgICApOwogICAgb3JkZXIgPSA1MjU7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJEaW1pbmlzaGluZyB0YXggcmV0dXJucyIsCiAgICAgICI8cT5Xb3csIHRoZXkncmUgdGlueSEgV2lzaCB5b3UnZCB0aG91Z2h0IG9mIHRoYXQgc29vbmVyITwvcT4iLAogICAgICAiQmFuayIsCiAgICAgIDEzCiAgICApOwogICAgb3JkZXIgPSA1NTA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJBcHBhcml0aW9ucyIsCiAgICAgICI8cT5Zb3UndmUgYm9va2VkIGEgZGVhbCB3aXRoIHRoZSBoaWdoZXItdXBzIHRoYXQgc2NoZWR1bGVzIG9uZSB3ZWVrbHkgZWFydGhseSBhcHBhcml0aW9uIGJ5IGEgZGVpdHksIGFuZ2VsLCBhc2NlbmRlZCBwcm9waGV0LCBvciBvdGhlciBob2x5IGZpZ3VyZS4gVGhpcyBzaG91bGQgYm9vc3QgaW50ZXJlc3QgaW4gY29va2llIHJlbGlnaW9uIGFtb25nIHlvdXRocyBhcyBsb25nIGFzIHlvdSBjYW4gc2VjdXJlIGEgZGVjZW50IHRpbWUgc2xvdC48L3E+IiwKICAgICAgIlRlbXBsZSIsCiAgICAgIDEzCiAgICApOwogICAgb3JkZXIgPSA1NzU7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJXaXphcmQgYmFzZW1lbnRzIiwKICAgICAgIjxxPllvdSd2ZSByZWNlaXZlZCBjb25zdHJ1Y3Rpb24gcGVybWl0cyBhbGxvd2luZyB5b3UgdG8gYnVpbGQgYmFzZW1lbnRzIHVuZGVybmVhdGggZWFjaCB3aXphcmQgdG93ZXIuIFRoaXMgcHJvdmlkZXMgYSBoYW5keSBzdG9yYWdlIHNwYWNlIGZvciBwcmVjaW91cyByZWFnZW50cywgZml6emxlZC1vdXQgc291bCBnZW1zLCBhbmQgd2VpcmQgb2xkIG1hZ2F6aW5lcy48L3E+IiwKICAgICAgIldpemFyZCB0b3dlciIsCiAgICAgIDEzCiAgICApOwogICAgb3JkZXIgPSA2MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJQcmltZSBkaXJlY3RpdmUiLAogICAgICAiPHE+QW4gaW50ZXJnYWxhY3RpYyBkZWxlZ2F0aW9uIG1hZGUgeW91IHBpbmt5LXN3ZWFyIG5vdCB0byBkaXJlY3RseSBpbnRlcmFjdCB3aXRoIGxlc3NlciBhbGllbiBjdWx0dXJlcy4gV2hpY2ggaXMgZmluZSwgYmVjYXVzZSBpdCdzIG11Y2ggZnVubmllciB0byByb2IgYSBwbGFuZXQgYmxpbmQgd2hlbiBpdHMgaW5oYWJpdGFudHMgaGF2ZSBubyBpZGVhIHdoYXQncyBnb2luZyBvbi48L3E+IiwKICAgICAgIlNoaXBtZW50IiwKICAgICAgMTMKICAgICk7CiAgICBvcmRlciA9IDcwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkNocm9tYXRpYyBjeWNsaW5nIiwKICAgICAgIjxxPkFsbCBzdGF0ZXMgb2YgbWF0dGVyIGV4aXN0IGluIGEgY29udGludW91cyBsb29wLiBIYXZpbmcgbGVhcm5lZCBob3cgdG8gY3ljbGUgdGhyb3VnaCB0aGVtLCBhbGwgeW91IGhhdmUgdG8gZG8gaXMgdG8gZnJlZXplIG1hdHRlciByaWdodCBvbiB0aGUgc3RhdGUgeW91IG5lZWQuIEZvciByZWZlcmVuY2UsIHRoZSBjb29raWUgc3RhdGUgb2YgbWF0dGVyIGlzIHNpdHVhdGVkIGF0IHByZWNpc2VseSAxNjMuNzE5JmRlZzssIHJpZ2h0IGJldHdlZW4gbGFtZWxsYXIgZ2FzIGFuZCBtZXRhcGxhc21hLjwvcT4iLAogICAgICAiQWxjaGVteSBsYWIiLAogICAgICAxMwogICAgKTsKICAgIG9yZGVyID0gODAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRG9tZXN0aWMgcmlmdHMiLAogICAgICAiPHE+WW91J3ZlIG1hbmFnZWQgdG8gbWFudWZhY3R1cmUgcG9ydGFscyB0aGF0IGFyZSBjb252ZW5pZW50IGVub3VnaCwgYW5kIGxlZ2FsbHkgc2FmZSBlbm91Z2gsIHRoYXQgeW91IGNhbiBqdXN0IHN0aWNrIHRoZW0gYWdhaW5zdCB3YWxscyBpbnNpZGUgYnVpbGRpbmdzIHRvIGNvbm5lY3Qgcm9vbXMgdG9nZXRoZXIgaW4gdW51c3VhbCBjb25maWd1cmF0aW9ucy4gSW4gcHJhY3RpY2UsIHRoaXMgbWVhbnMgeW91ciBlbXBsb3llZXMgZ2V0IHRvIGhhdmUgbXVjaCBzaG9ydGVyIGJhdGhyb29tIGJyZWFrcy48L3E+IiwKICAgICAgIlBvcnRhbCIsCiAgICAgIDEzCiAgICApOwogICAgb3JkZXIgPSA5MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJQYXRpZW5jZSBhYm9saXNoZWQiLAogICAgICAiPHE+WW91IHdhaXQgZm9yIG5vIG9uZS48L3E+IiwKICAgICAgIlRpbWUgbWFjaGluZSIsCiAgICAgIDEzCiAgICApOwogICAgb3JkZXIgPSAxMDAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRGVsaWNpb3VzIHB1bGwiLAogICAgICAiPHE+SW4gYWRkaXRpb24gdG8gdGhlIDQgZnVuZGFtZW50YWwgZm9yY2VzIG9mIHRoZSB1bml2ZXJzZSAtZ3Jhdml0eSwgZWxlY3Ryb21hZ25ldGlzbSwgd2VhayBhbmQgc3Ryb25nIGludGVyYWN0aW9ucy0geW91ciBzY2llbnRpc3RzIGhhdmUgYXQgbG9uZyBsYXN0IGNvbmZpcm1lZCB0aGUgZXhpc3RlbmNlIG9mIGEgZmlmdGggb25lLCBtZWRpYXRlZCBieSBzdWdhciBib3NvbnM7IGl0IGRpY3RhdGVzIHRoYXQgYW55IHR3byBtYXNzZXMgb2YgaW5ncmVkaWVudC1saWtlIG1hdHRlciB3aWxsLCBnaXZlbiBlbm91Z2ggdGltZSwgZXZlbnR1YWxseSBtZWV0IGVhY2ggb3RoZXIgdG8gcHJvZHVjZSBhIHRoaXJkLCBldmVuIHRhc3RpZXIgc3Vic3RhbmNlLiBZb3VyIHRlYW0gZW50aHVzaWFzdGljYWxseSBuYW1lcyBpdCB0aGUgZGVsaWNpb3VzIHB1bGwuPC9xPiIsCiAgICAgICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsCiAgICAgIDEzCiAgICApOwogICAgb3JkZXIgPSAxMTAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiT2NjYW0ncyBsYXNlciIsCiAgICAgICI8cT5JbnZlbnRlZCBieSBGcmFuY2lzY2FuIGZyaWFyIFdpbGxpYW0gb2YgT2NjYW0gaW4gMTxzcGFuPjwvc3Bhbj4zMjcuIEFuIGltcG9zc2libHkgY2xldmVyIHVzZSBvZiBsaWdodCB0aGVvcnkgd2l0aCBhIGJpbGxpb24gcG9zc2libGUgYXBwbGljYXRpb25zLCBzb21lIG9mIHdoaWNoIGZyaWdodGZ1bGx5IGRlc3RydWN0aXZlLiBDb25maW5lZCB0byBhIHNpbmdsZSBnb2F0LXNraW4gcGFyY2htZW50IGZvciBodW5kcmVkcyBvZiB5ZWFycyB1bnRpbCB0aGUgcGF0ZW50IGV4cGlyZWQgYW5kIGhpdCBwdWJsaWMgZG9tYWluLCBqdXN0IG5vdy48L3E+IiwKICAgICAgIlByaXNtIiwKICAgICAgMTMKICAgICk7CiAgICBvcmRlciA9IDEyMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJPbiBhIHN0cmVhayIsCiAgICAgICI8cT5UYWtlIGEgbW9tZW50IHRvIGFwcHJlY2lhdGUgaG93IGZhciB5b3UndmUgY29tZS4gSG93IGx1Y2t5IHlvdSd2ZSBiZWVuIHNvIGZhci4gSXQgZG9lc24ndCB0YWtlIGEgZ2VuaXVzIHN0YXRpc3RpY2lhbiB0byBleHRyYXBvbGF0ZSBhIHRyZW5kIGZyb20gdGhpcy4gVGhlcmUncyBubyB3YXkgYW55dGhpbmcgYmFkIGNvdWxkIGhhcHBlbiB0byB5b3Ugbm93LiBSaWdodD88L3E+IiwKICAgICAgIkNoYW5jZW1ha2VyIiwKICAgICAgMTMKICAgICk7CiAgICBvcmRlciA9IDEzMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJBIGJveCIsCiAgICAgICI8cT5XaGF0J3MgaW4gdGhhdCBib3g/IFdoeSwgaXQncyBhIHRpbnkgcmVwbGljYSBvZiB5b3VyIG9mZmljZSEgQW5kIHRoZXJlJ3MgZXZlbiBhIGxpdHRsZSB5b3UgaW4gdGhlcmUhIEFuZCB3aGF0J3Mgb24gdGhlIGxpdHRsZSBkZXNrLi4uIHNheSAtIHRoYXQncyBhbiBldmVuIHRpbmllciBib3ghIEFuZCB0aGUgbGl0dGxlIHlvdSBpcyBvcGVuaW5nIGl0LCByZXZlYWxpbmcgYW4gZXZlbiB0aW5pZXIgb2ZmaWNlISBBbmQgaW4gdGhlIHRpbmllciBvZmZpY2UgdGhlcmUncy0gSG1tLiBZb3UgY2FuIHRoaW5rIG9mIGEgY291cGxlIHVzZXMgZm9yIHRoaXMuPC9xPiIsCiAgICAgICJGcmFjdGFsIGVuZ2luZSIsCiAgICAgIDEzCiAgICApOwogICAgb3JkZXIgPSAxNDAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiSGFja2VyIHNoYWRlcyIsCiAgICAgICI8cT5JJ20gaW4uPC9xPiIsCiAgICAgICJKYXZhc2NyaXB0IGNvbnNvbGUiLAogICAgICAxMwogICAgKTsKICAgIG9yZGVyID0gMTUwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkJyZWFrIHRoZSBmaWZ0aCB3YWxsIiwKICAgICAgIjxxPkh1aCwgd2FzIHRoYXQgYWx3YXlzIHRoZXJlPyBXaGF0ZXZlciBpdCB3YXMsIGl0J3MgZ29uZSBub3cuIEFuZCB3aGF0IHdhcyBiZWhpbmQgaXMgeW91cnMgZm9yIHRoZSB0YWtpbmcuPC9xPiIsCiAgICAgICJJZGxldmVyc2UiLAogICAgICAxMwogICAgKTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQ2F0IGxhZGllcyIsCiAgICAgIGxvYygiRWFjaCBraXR0ZW4gdXBncmFkZSBib29zdHMgJTEgQ3BTIGJ5IDxiPiUyJTwvYj4uIiwgWwogICAgICAgIGxvYygiZ3JhbmRtYSIpLAogICAgICAgIDI5LAogICAgICBdKSArICI8cT5PaCBuby4gT2ggbm8gbm8gbm8uIE9oaGggdGhpcyBpc24ndCByaWdodCBhdCBhbGwuPC9xPiIsCiAgICAgIDkwMDAwMDAwMDAsCiAgICAgIFszMiwgM10KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiS2l0dGVuIGFuZ2VscyJdOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIk1pbGtoZWxwJnJlZzsgbGFjdG9zZSBpbnRvbGVyYW5jZSByZWxpZWYgdGFibGV0cyIsCiAgICAgIGxvYygiRWFjaCByYW5rIG9mIG1pbGsgYm9vc3RzICUxIENwUyBieSA8Yj4lMiU8L2I+LiIsIFsKICAgICAgICBsb2MoImdyYW5kbWEiKSwKICAgICAgICA1LAogICAgICBdKSArICI8cT5BZ2VkIGxpa2UgbWlsay48L3E+IiwKICAgICAgOTAwMDAwMDAwMDAwLAogICAgICBbMzMsIDNdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkNhdCBsYWRpZXMiXTsKCiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiQXVyYSBnbG92ZXMiLAogICAgICBsb2MoCiAgICAgICAgIkN1cnNvciBsZXZlbHMgYm9vc3QgY2xpY2tzIGJ5IDxiPiUxJTwvYj4gZWFjaCAodXAgdG8gY3Vyc29yIGxldmVsICUyKS4iLAogICAgICAgIFs1LCAxMF0KICAgICAgKSArCiAgICAgICAgIjxxPlRyeSBub3QgdG8gaGlnaC1maXZlIGFueW9uZSB3ZWFyaW5nIHRoZXNlLiBZb3UgZG9uJ3Qgd2FudCB0aGF0IG1lc3Mgb24geW91ciBoYW5kcy48L3E+IiwKICAgICAgNTU1NTU1NTU1LAogICAgICBbMzIsIDRdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkhhbG8gZ2xvdmVzIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiTHVtaW5vdXMgZ2xvdmVzIiwKICAgICAgbG9jKCI8Yj4lMTwvYj4gYXJlIG5vdyBlZmZlY3RpdmUgdXAgdG8gY3Vyc29yIGxldmVsICUyLiIsIFsKICAgICAgICBnZXRVcGdyYWRlTmFtZSgiQXVyYSBnbG92ZXMiKSwKICAgICAgICAyMCwKICAgICAgXSkgKwogICAgICAgICI8cT5UaGVzZSBoZWxwIHBvd2VyIHlvdXIgY2xpY2tzIHRvIGFic3VyZCBsZXZlbHMsIGJ1dCB0aGV5J3JlIGFsc28gcXVpdGUgaGFuZHkgd2hlbiB5b3Ugd2FudCB0byBsaWdodCB1cCB0aGUgZGFya25lc3Mgb24geW91ciB3YXkgYmFjayBmcm9tIEdsb3ZlIFdvcmxkLjwvcT4iLAogICAgICA1NTU1NTU1NTU1NSwKICAgICAgWzMzLCA0XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJBdXJhIGdsb3ZlcyJdOwoKICAgIG9yZGVyID0gMTAwMjA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQm9ra2VucG9vdGplcyIsCiAgICAgIGRlc2M6ICJDb25zaXN0IG9mIDIgbWVyaW5ndWUgaGFsdmVzIGpvaW5lZCBieSBidXR0ZXJjcmVhbSBhbmQgZGlwcGVkIGJvdGggd2F5cyBpbiBjaG9jb2xhdGUuIE5hbWVkIGFmdGVyIGEgZ29hdCdzIGZvb3QgdGhhdCBwcm9iYWJseSBzdGVwcGVkIGluIHNvbWV0aGluZyB0d2ljZS4iLAogICAgICBpY29uOiBbMzIsIDhdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDQwKSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkZhdCByYXNjYWxzIiwKICAgICAgZGVzYzogIkFsbW9uZC1zbWlsZWQgWW9ya3NoaXJlIGNha2VzIHdpdGggYSByaWNoIGhpc3RvcnkgYW5kIGFuIGV2ZW4gcmljaGVyIHJlY2lwZS4gVGhlIG1vcmUgZGlldC1jb25zY2lvdXMgYXJlIGludml0ZWQgdG8gdHJ5IHRoZSBsZWFuIHZlcnNpb24sIHNraW5ueSBzY2FsbHl3YWdzLiIsCiAgICAgIGljb246IFszMywgOF0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoNDEpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiSXNjaGxlciBjb29raWVzIiwKICAgICAgZGVzYzogIk9yaWdpbmF0aW5nIGluIHRoZSBBdXN0cm8tSHVuZ2FyaWFuIEVtcGlyZSwgdGhlc2UgaGF2ZSBzcHJlYWQgdGhyb3VnaG91dCBldmVyeSBjb3VudHJ5IGluIGVhc3Rlcm4gRXVyb3BlIGFuZCBzcGF3bmVkIGp1c3QgYXMgbWFueSByZWNpcGVzLCBlYWNoIGNsYWltaW5nIHRvIGJlIHRoZSBvcmlnaW5hbC4gVGhlIGJhc2lzIHJlbWFpbnMgdW5jaGFuZ2VkIGFjcm9zcyBhbGwgdmFyaWFudHM6IHR3byBiaXNjdWl0cyBzYW5kd2ljaGVkIGFyb3VuZCBjaG9jb2xhdGUgYnV0dGVyY3JlYW0uIE9yIHdhcyBpdCBqYW0/IiwKICAgICAgaWNvbjogWzMyLCA5XSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSg0MiksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJNYXRjaGEgY29va2llcyIsCiAgICAgIGRlc2M6ICJHcmVlbiB0ZWEgYW5kIGNvb2tpZXMsIGEgbWF0Y2hhIG1hZGUgaW4gaGVhdmVuLiIsCiAgICAgIGljb246IFszMywgOV0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoNDIpLAogICAgfSk7CgogICAgb3JkZXIgPSAxMDAzMjsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJFYXJsIEdyZXkgbWFjYXJvbnMiLAogICAgICBkZXNjOiAiQmVzdCBzZXJ2ZWQgaG90LCBtYWtlIGl0IHNvISIsCiAgICAgIGljb246IFszMiwgMTBdLAogICAgICByZXF1aXJlOiAiQm94IG9mIG1hY2Fyb25zIiwKICAgICAgcG93ZXI6IDMsCiAgICAgIHByaWNlOiA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5LAogICAgfSk7CgogICAgb3JkZXIgPSAxMDAzMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJQb2tleSIsCiAgICAgIGRlc2M6ICJXaGlsZSBjb21tb25seSB0aG91Z2h0IHRvIGJlIG5hbWVkIHNvIGJlY2F1c2UgaXQncyBmdW4gdG8gcG9rZSB5b3VyIGNsYXNzbWF0ZXMgd2l0aCB0aGVzZSwgUG9rZXktYnJhbmQgYmlzY3VpdCBzdGlja3MgYWN0dWFsbHkgZ2V0IHRoZWlyIG5hbWUgZnJvbSB0aGVpciBwb3B1bGFyaXR5IGluIHNtb2tlLWZyZWUgcHJpc29ucywgd2hlcmUgdGhleSdyZSBjb21tb25seSBzbXVnZ2xlZCBhbmQgdHJhZGVkIGluIGxpZXUgb2YgY2lnYXJldHRlcy4iLAogICAgICBpY29uOiBbMzMsIDEwXSwKICAgICAgcmVxdWlyZTogIkJveCBvZiBicmFuZCBiaXNjdWl0cyIsCiAgICAgIHBvd2VyOiAyLAogICAgICBwcmljZTogOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5ICogNSwKICAgIH0pOwoKICAgIG9yZGVyID0gMTAwMDA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiQ2FzaGV3IGNvb2tpZXMiLAogICAgICBkZXNjOiAiTGV0IG1lIHRlbGwgeW91IGFib3V0IGNhc2hld3MuIENhc2hld3MgYXJlIG5vdCBudXRzLCBidXQgc2VlZHMgdGhhdCBncm93IG91dCBvZiBjdXJpb3VzIHJlZCBvciB5ZWxsb3cgZnJ1aXRzIC0gd2hpY2ggY2FuIGJlIGVhdGVuIG9uIHRoZWlyIG93biwgb3IgbWFkZSBpbnRvIGRyaW5rcy4gVGhlIHNoZWxsIGFyb3VuZCB0aGUgbnV0IGl0c2VsZiBjb250YWlucyBhIG5hc3R5IHN1YnN0YW5jZSB0aGF0IHN0YWlucyBhbmQgaXJyaXRhdGVzIHRoZSBoYW5kcyBvZiB3aG9ldmVyIGhhbmRsZXMgaXQgZm9yIHRvbyBsb25nLiBCdXQgdGhhdCdzIG9rYXksIHNpbmNlIG5vdyB0aGF0IHlvdSd2ZSByZWFkIHRoaXMgeW91J2xsIG1ha2Ugc3VyZSBpdCBkb2Vzbid0IGdldCBpbiB0aGUgY29va2llcyEgT2gsIHlvdSd2ZSBhbHJlYWR5IGVhdGVuIGhvdyBtYW55PyBPa2F5IHRoZW4uIiwKICAgICAgaWNvbjogWzMyLCA3XSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OSwKICAgIH0pOwogICAgb3JkZXIgPSAxMDAwMTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJNaWxrIGNob2NvbGF0ZSBjb29raWVzIiwKICAgICAgZGVzYzogIkEgc3RyYW5nZSBpbnZlcnNpb24gb2YgY2hvY29sYXRlIG1pbGsuIEZvciB0aG9zZSB3aG8gYXJlIGEgbGl0dGxlIGJpdCB0b28gaGFyZGNvcmUgZm9yIHdoaXRlIGNob2NvbGF0ZSwgYnV0IG5vdCBoYXJkY29yZSBlbm91Z2ggZm9yIGRhcmsuIiwKICAgICAgaWNvbjogWzMzLCA3XSwKICAgICAgcG93ZXI6IDIsCiAgICAgIHByaWNlOiA5OTk5OTk5OSAqIDUsCiAgICB9KTsKCiAgICBvcmRlciA9IDI1NTsKICAgIEdhbWUuR3JhbmRtYVN5bmVyZ3koCiAgICAgICJCcmFpbnkgZ3JhbmRtYXMiLAogICAgICAiQSBjbGV2ZXIgZ3JhbmRtYSB0byB0aGluayB1cCBzb21lIGNvb2tpZXMuIiwKICAgICAgIkNvcnRleCBiYWtlciIKICAgICk7CgogICAgb3JkZXIgPSAxNjAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiUHJpbmNpcGxlZCBuZXVyYWwgc2hhY2tsZXMiLAogICAgICAiPHE+QSBkaXNjcmltaW5hdG9yeSwgbG93LW9yZGVyIG5ldXJhbCBuZXQgYWN0aW5nIGFzIGEgZmlsdGVyIGxpbWl0aW5nIHdoYXQgeW91ciBjb3J0ZXggYmFrZXJzIGNhbiB0aGluayBhbmQgZG8uIFJlYWxseSBzb21ldGhpbmcgeW91IHdhbnQgdG8gYXBwbHkgYmVmb3JlIHRoZXkgYWNoaWV2ZSBmdWxsIG1lZ2FzZW50aWVuY2UgYW5kIHJlYWxpemUgdGhleSd2ZSBnb3QgYmV0dGVyIHRoaW5ncyB0byBkbyB0aGFuIG1hdGVyaWFsaXppbmcgcGFzdHJpZXMgZm9yIHlvdSwgdHJ1c3QgbWUuPC9xPiIsCiAgICAgICJDb3J0ZXggYmFrZXIiLAogICAgICAxCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiT2JleSIsCiAgICAgICI8cT5QZXJmZWN0IG1pbmQgY29udHJvbCBtZWFucyBwZXJmZWN0IGVtcGxveWVlIGF0dGVuZGFuY2UgYW5kIHBlcmZvcm1hbmNlLiBPcHRpbWFsIG1vb2Qgc3RhYmlsaXphdGlvbiBpcyBhIG5pY2Ugc2lkZS1lZmZlY3QuPGJyPkhhcHB5IGhhcHB5IGV2ZXJ5b25lIGhhcHB5Ljxicj5IYXBweS48L3E+IiwKICAgICAgIkNvcnRleCBiYWtlciIsCiAgICAgIDIKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJBIHNwcmlua2xlIG9mIGlycmF0aW9uYWxpdHkiLAogICAgICAiPHE+WW91ciBjb3J0ZXggYmFrZXJzIHNvbWV0aW1lcyBnZXQgYm9nZ2VkIGRvd24gYnkgY2lyY3VsYXIgcmVhc29uaW5nIGFuZCBzdGFsZSBpZGVhcy4gQSB0b3VjaCBvZiBjaGFvcyBpcyBqdXN0IHdoYXQgdGhleSBuZWVkIHRvIGdldCBiYWNrIG9uIHRyYWNrLjwvcT4iLAogICAgICAiQ29ydGV4IGJha2VyIiwKICAgICAgMwogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkZyb250IGFuZCBiYWNrIGhlbWlzcGhlcmVzIiwKICAgICAgIjxxPkkgbWVhbiwgb3RoZXJ3aXNlIGl0J3MganVzdCB1bnVzZWQgc3BhY2UsIHllYWg/PC9xPiIsCiAgICAgICJDb3J0ZXggYmFrZXIiLAogICAgICA0CiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiTmV1cmFsIG5ldHdvcmtpbmciLAogICAgICAiPHE+VGhlIGVmZmVjdGl2ZW5lc3Mgb2YgeW91ciBjb3J0ZXggYmFrZXJzIHNob290cyB1cCBleHBvbmVudGlhbGx5IGlmIHlvdSBhbGxvdyB0aGVtIHRvIGNvbm5lY3Qgd2l0aCBlYWNoIG90aGVyLiBJbiBwcmFjdGljZSB0aGlzIHRha2VzIHRoZSBmb3JtIG9mIG1hbnkgY29zbWljLXNpemVkIG5lcmRzIG11bWJsaW5nIGF3a3dhcmRseSBhYm91dCB0ZWNoIHN0YXJ0LXVwIGlkZWFzIHRvIGVhY2ggb3RoZXIuPC9xPiIsCiAgICAgICJDb3J0ZXggYmFrZXIiLAogICAgICA1CiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiQ29zbWljIGJyYWluc3Rvcm1zIiwKICAgICAgIjxxPlRoZSB3cmlua2xlZCBzdXJmYWNlcyBvZiB5b3VyIGNvcnRleCBiYWtlcnMgZW1pdCB3ZWF0aGVyLXNjYWxlIGlvbmljIGZsYXJlcyB3aXRoIGV2ZXJ5IHRob3VnaHQgY291cnNpbmcgdGhyb3VnaCB0aGVtLiBUaGVzZSBwdWxzZXMgb2YgcHVyZSBpbnRlbGxlY3R1YWwgZW5lcmd5IGFyZSBzZW50IHJpcHBsaW5nIHRocm91Z2ggc3BhY2UsIG9jY2FzaW9uYWxseSBlY2hvaW5nIGJhY2sgd2l0aCBldmVuIGRlZXBlciBwaGlsb3NvcGhpY2FsIGNvbXBsZXhpdHkuPC9xPiIsCiAgICAgICJDb3J0ZXggYmFrZXIiLAogICAgICA2CiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiTWVnYXRoZXJhcHkiLAogICAgICAiPHE+QSBnaWFudCBicmFpbiBjYW4gZmVlbCB1bndlbGwganVzdCBsaWtlIHlvdSBhbmQgbWUgc29tZXRpbWVzLCBhbmQgaXQncyB0aGUgam9iIG9mIHNwZWNpYWxpemVkIGVuZ2luZWVycyB0byBsb2NhdGUgYW5kIHJlcGFpciB0aGVzZSBidWdzLiBXZSdsbCBhZG1pdCBtb3N0IG9mIHRoZSBidWRnZXQgaW4gdGhpcyB3YXMgc3BlbnQgb24gY29uc3RydWN0aW5nIGV4dHJlbWVseSBsYXJnZSBjaGFpc2VzIGxvbmd1ZXMgZm9yIHRoZSBicmFpbnMgdG8gcmVjbGluZSBvbi48L3E+IiwKICAgICAgIkNvcnRleCBiYWtlciIsCiAgICAgIDcKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJTeW5hcHRpYyBsdWJyaWNhbnQiLAogICAgICAiPHE+QSBtaW5kIGlzIG9ubHkgYXMgZmFzdCBhcyB0aGUgYXhvbnMgdGhhdCBzdXBwb3J0IGl0LiBHZXQgdGhvc2UgYWN0aW9uIHBvdGVudGlhbHMgZmxvd2luZyBzbW9vdGggYXMgc2lsayB3aXRoIHRoaXMgMyBwYXJ0cyBteWVsaW4vMSBwYXJ0IGNhbm9sYSBvaWwgc3ByZWFkYWJsZSBwYXN0ZS4gQWxzbyBncmVhdCBvbiB0b2FzdC48L3E+IiwKICAgICAgIkNvcnRleCBiYWtlciIsCiAgICAgIDgKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJQc3ljaG9raW5lc2lzIiwKICAgICAgIjxxPldoaWxlIHlvdXIgZ2lhbnQgY29ydGV4IGJha2VycyBjb21lIGVxdWlwcGVkIHdpdGggRVNQLCB0aGV5J3ZlIG9ubHkgcmVjZW50bHkgZmlndXJlZCBvdXQgaG93IHRvIG1hbmlwdWxhdGUgdGhlIHBoeXNpY2FsIHdvcmxkIHdpdGggdGhlaXIgdGhvdWdodHMgLSB0aG91Z2ggZm9yIHNhZmV0eSByZWFzb25zLCB5b3VyIGxlZ2FsIHRlYW0gaGFkIHRoZW0gcHJvbWlzZSB0byBvbmx5IHVzZSB0aGVzZSBwb3dlcnMgdG8gc2NyYXRjaCB0aGUgaXRjaGVzIGluIHRoZWlyIGNvcnRpY2FsIGZvbGRzLjwvcT4iLAogICAgICAiQ29ydGV4IGJha2VyIiwKICAgICAgOQogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlNwaW5lcyIsCiAgICAgICI8cT5Zb3VyIGNvcnRleCBiYWtlcnMgYXJlIG5vdyBlcXVpcHBlZCB3aXRoIHRlbnRhY3VsYXIgc3BpbmUtbGlrZSBzdHJ1Y3R1cmVzLCB3aGljaCB0aGV5IGNhbiB1c2UgbGlrZSBwcmVoZW5zaWxlIHRhaWxzIHRvIHBvdXIgdGhlbXNlbHZlcyBlbm9ybW91cyBjdXBzIG9mIGNvZmZlZSBvciBwcm9wZWwgdGhlbXNlbHZlcyBhcm91bmQgbGlrZSB2ZXJ5IGxhcmdlLCB2ZXJ5IHNtYXJ0LCB2ZXJ5IHNsb3cgdGFkcG9sZXMuPC9xPiIsCiAgICAgICJDb3J0ZXggYmFrZXIiLAogICAgICAxMAogICAgKTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIk5ldXJhZm9ybWluZyIsCiAgICAgICI8cT5CeSB2aXJ0dWUgb2YgYmVpbmcgcGxhbmV0LXNpemVkLCB5b3VyIGNvcnRleCBiYWtlcnMgb2Z0ZW4gYm9hc3QgdGhlaXIgb3duIGF0bW9zcGhlcmVzIGFuZCBzZWFzIG9mIGNlcmVicm9zcGluYWwgZmx1aWQsIGFuZCBnaXZlbiBlbm91Z2ggdGltZSwgdGhlaXIgb3duIGVjb3N5c3RlbXMuIFRoaXMgaW5jcmVkaWJsZSBuZXcgYnJhbmNoIG9mIGxpZmUsIGV2b2x2ZWQgZW50aXJlbHkgb3V0IG9mIG5ldXJhbCBtYXRlcmlhbCwgY2FuIGJlIHB1dCB0byBnb29kIHVzZSBhcyBob21lLWdyb3duIGFjY291bnRhbnRzIGFuZCBsb3ctcmFua2luZyB0ZWNobmljaWFucy48L3E+IiwKICAgICAgIkNvcnRleCBiYWtlciIsCiAgICAgIDExCiAgICApOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRXBpc3RlbW9sb2dpY2FsIHRyaWNrZXJ5IiwKICAgICAgIjxxPlJlZGVmaW5pbmcgd2hhdCBpcyAtb3IgaXNuJ3QtIGEgY29va2llIHRocm91Z2ggdGhlIHBvd2VyIG9mIHBoaWxvc29waGljYWwgZGlzY291cnNlIG1heSByZXN1bHQgaW4gc29tZSBzdHJhbmdlIGFuZCB3b25kZXJmdWwgdGhpbmdzIGZvciB5b3VyIHByb2ZpdCBtYXJnaW5zLjwvcT4iLAogICAgICAiQ29ydGV4IGJha2VyIiwKICAgICAgMTIKICAgICk7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJFdmVyeSBwb3NzaWJsZSBpZGVhIiwKICAgICAgIjxxPkNvbmdyYXR1bGF0aW9ucywgeW91ciBjb3J0ZXggYmFrZXJzIGhhdmUgZXhlcnRlZCBlbm91Z2ggaW50ZWxsZWN0dWFsIGNvbXB1dGF0aW9uIHRvIHBlcm11dGUgdGhyb3VnaCBldmVyeSBzaW5nbGUgaWRlYSB0aGF0IGNhbiBvciBldmVyIHdpbGwgYmUgY29uY2VpdmVkIG9mLiBBbnkgdGhvdWdodCBiZXlvbmQgdGhpcyBwb2ludCBpcyBtZXJlbHkgcmVkaXNjb3ZlcmluZyBhIG5vdGlvbiB5b3UndmUgYWxyZWFkeSBhcmNoaXZlZC4gSGFyZGx5IGNhdXNlIGZvciBjZXJlYnJhdGlvbi48L3E+IiwKICAgICAgIkNvcnRleCBiYWtlciIsCiAgICAgIDEzCiAgICApOwoKICAgIG9yZGVyID0gMjAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiS2l0Y2hlbiBjYWJpbmV0cyIsCiAgICAgICI8cT5BIGdyYW5kbWEncyBraXRjaGVuIGNhYmluZXQgaXMgYSBiZWZ1ZGRsaW5nIHBsYWNlLiBUaHJvdWdoIGxlc3Nlci1zdHVkaWVkIGFnZ3JlZ2F0aW5nIGluc3RpbmN0cywgZ3JhbmRtYXMgd2lsbCB0ZW5kIHRvIGdyYWR1YWxseSBmaWxsIGFsbCBuZWFyYnkgY2FiaW5ldHMgd2l0aCB2YXJpb3VzIHNvcnRzIG9mIHRoaW5ncywgc3VjaCBhcyBjdXJpb3VzIGNvY29udXQgc25hY2tzIG9yIGRpZXRldGljIHBvd2RlcnMuIEJ5IGNvbnRyYWN0LCB0aGVzZSBhcmUgbGVnYWxseSB5b3Vycywgd2hpY2ggb3BlbnMgdXAgZXhjaXRpbmcgb3Bwb3J0dW5pdGllcyBmb3IgeW91ciBzdWJzdGFuY2UgaW52ZXN0aWdhdGlvbiBkZXBhcnRtZW50LjwvcT4iLAogICAgICAiR3JhbmRtYSIsCiAgICAgIDE0CiAgICApOwogICAgb3JkZXIgPSAzMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJDb29raWUgbXVsY2giLAogICAgICAiPHE+R3JpbmRpbmcgc3VycGx1cyBjb29raWVzIGludG8gcGFzdGUgdGhhdCB5b3UgdGhlbiBzcHJlYWQgb250byB5b3VyIGZpZWxkcyBlbmFibGVzIGEgc3RyYW5nZSBmZWVkYmFjayBsb29wIGluIHRoZSBxdWFsaXR5IG9mIHlvdXIgY29va2llIGNyb3BzLiBDb29raWUgZmVlZGluZyBvbiBjb29raWUgc2hvdWxkIGJlIGFuIGFib21pbmF0aW9uLCBidXQgdGhlbiB3aHkgZG9lcyBpdCB0YXN0ZSBzbyBnb29kPzwvcT4iLAogICAgICAiRmFybSIsCiAgICAgIDE0CiAgICApOwogICAgb3JkZXIgPSA0MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJEZWxpY2lvdXMgbWluZXJhbG9neSIsCiAgICAgICI8cT5TdHJhdHVtIGFmdGVyIHN0cmF0dW0sIHlvdSd2ZSBleHRyYWN0ZWQgc3RyYW5nZSBuZXcgbWluZXJhbHMgaGVyZXRvZm9yZSB1bmtub3duIHRvIGdlb2xvZ3kuIFVzaGVyaW5nIGEgbmV3IGVyYSBvZiBtYXRlcmlhbHMgcmVzZWFyY2gsIHlvdXIgc2NpZW50aXN0cyBoYXZlIGJlZW4gYWJsZSB0byBpZGVudGlmeSBldmVyeSBuZXcgZWxlbWVudCB5b3VyIG1pbmVzIGhhdmUgZGlzY292ZXJlZCwgaW5jbHVkaW5nIHdoYXRldmVyIHRob3NlIHRoaW5ncyBhcmUgaW4gdGhlIHVwZ3JhZGUgdGllciBuYW1lcy48L3E+IiwKICAgICAgIk1pbmUiLAogICAgICAxNAogICAgKTsKICAgIG9yZGVyID0gNTAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiTi1kaW1lbnNpb25hbCBhc3NlbWJseSBsaW5lcyIsCiAgICAgICI8cT5MaW5lcyBhcmUgZGVwcmVzc2luZ2x5IDEtZGltZW5zaW9uYWwuIEJleW9uZCBhc3NlbWJseSBsaW5lcywgd2UgcG9zaXQgdGhlIGV4aXN0ZW5jZSBvZiBoaWdoZXItb3JkZXIgYXNzZW1ibHkgZW50aXRpZXMsIHN1Y2ggYXMgYXNzZW1ibHkgc3F1YXJlcywgYXNzZW1ibHkgY3ViZXMgLSBwZXJoYXBzIGV2ZW4gYXNzZW1ibHkgdGVzc2VyYWN0cy4gQW55IGRlZXBlciB0aGFuIHRoYXQgYW5kIHdlIGRvdWJ0IHdlJ2xsIGJlIGFibGUgdG8gd3JpdGUgbWFudWFscyB5b3VyIHdvcmtlcnMgY2FuIHJlYWQuPC9xPiIsCiAgICAgICJGYWN0b3J5IiwKICAgICAgMTQKICAgICk7CiAgICBvcmRlciA9IDUyNTsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkNvb2tpZSBQb2ludHMiLAogICAgICAiPHE+QSBsb3lhbHR5IHByb2dyYW0gd2hlcmVpbiBlYWNoIHB1cmNoYXNlIG9mIHlvdXIgY29va2llcyBjb21lcyB3aXRoIGZyZWUgQ29va2llIFBvaW50cywgd2hpY2ggY2FuIGluIHR1cm4gYmUgcmVkZWVtZWQgZm9yIG1vcmUgY29va2llcywgdGh1cyBjcmVhdGluZyB0aGUgc2VsZi1zdXN0YWluaW5nIGVjb25vbXkgeW91J3ZlIGJlZW4gbG9va2luZyBmb3IuPC9xPiIsCiAgICAgICJCYW5rIiwKICAgICAgMTQKICAgICk7CiAgICBvcmRlciA9IDU1MDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIk5lZ2F0aGVpc20iLAogICAgICAiPHE+UG9seXRoZWlzbSBpcyBhIGJlbGllZiBpbiBtdWx0aXBsZSBkZWl0aWVzOyBtb25vdGhlaXNtIGluIGp1c3Qgb25lLiBBdGhlaXNtIGlzIGEgYmVsaWVmIGluIG5vIGRlaXR5IHdoYXRzb2V2ZXIuIFRocm91Z2ggbG9naWNhbCBzdWNjZXNzaW9uIGl0IGZvbGxvd3MgdGhhdCB0aGlzIHJlbWFpbnMgdHJ1ZSB3aGVuIGdvaW5nIGludG8gbmVnYXRpdmUgbnVtYmVycywgd2l0aCBiZWxpZWYgc3lzdGVtcyBpbnZvbHZpbmcgbWludXMgMSBvciBtb3JlIGRlaXRpZXMgZGlzcGxheWluZyB1bnByZWNlZGVudGVkIHRoZW9sb2dpY2FsIHByb3BlcnRpZXMuPC9xPiIsCiAgICAgICJUZW1wbGUiLAogICAgICAxNAogICAgKTsKICAgIG9yZGVyID0gNTc1OwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiTWFnaWNhbCByZWFsaXNtIiwKICAgICAgIjxxPk1vcmUgYSBzb2NpYWwgdGhhbiB0aGF1bWF0dXJnaWNhbCBwcm9ncmVzcywgbWFnaWNhbCByZWFsaXNtIHJlZmVycyB0byB0aGUgbm9ybWFsaXphdGlvbiBvZiBtb2Rlcm4gdGVjaG5vbG9neSBhbW9uZyBtYWdpYy11c2Vycy4gSXQncyB0b3RhbGx5IGZpbmUgZm9yIGEgd2l6YXJkIHRvIGRyaXZlIGEgY2FyISBUaGVyZSdzIG5vIHN0aWdtYSBpbiB3YWl0aW5nIGluIGxpbmUgZm9yIGNvZmZlZSEgU3VyZSwgdGFrZSBhIHBob25lIGNhbGwsIHNlbmQgYW4gZW1haWwsIHdoYXRldmVyITwvcT4iLAogICAgICAiV2l6YXJkIHRvd2VyIiwKICAgICAgMTQKICAgICk7CiAgICBvcmRlciA9IDYwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkNvc21pYyBmb3JlZ3JvdW5kIHJhZGlhdGlvbiIsCiAgICAgICI8cT5BaCwgdGhpcyBpcyBhIHByb2JsZW0uPC9xPiIsCiAgICAgICJTaGlwbWVudCIsCiAgICAgIDE0CiAgICApOwogICAgb3JkZXIgPSA3MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJBcmNhbml6ZWQgZ2xhc3N3YXJlIiwKICAgICAgIjxxPllvdSB0aGluayB5b3VyIGxhYiBlcXVpcG1lbnQgZW5qb3lzIHRha2luZyBwYXJ0IGluIHRoZXNlIGV4cGVyaW1lbnRzIHZpb2xhdGluZyBhbGwgc29ydHMgb2YgbW9kZXJuIHNjaWVudGlmaWMgcHJlY2VwdHM/IE9mIGNvdXJzZSBub3QuIFRoYW5rZnVsbHksIHlvdSd2ZSBmaW5hbGl6ZWQgdGhlIGRlc2lnbiBvZiBzcGVjaWFsaXplZCBiZWFrZXJzIGFuZCBmbGFza3MsIHJlY3ljbGVkIGZyb20gdGhlIHNhbWUgZ2xhc3MgdXNlZCBieSB0aGUgYW5jaWVudHMgdG8gcGVyZm9ybSBwcmltZXZhbCBhbGNoZW15LCBhbmQgdGhlcmVmb3JlIG11Y2ggbGVzcyBwaWNreSBhYm91dCB0aGUgbmF0dXJlIG9mIHRoZSBwaHlzaWNhbCB3b3JsZC48L3E+IiwKICAgICAgIkFsY2hlbXkgbGFiIiwKICAgICAgMTQKICAgICk7CiAgICBvcmRlciA9IDgwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIlBvcnRhbCBndW5zIiwKICAgICAgIjxxPkF0IGxvbmcgbGFzdCEgVGhlIG9ubHkgd2VhcG9uIGNhcGFibGUgb2Yga2lsbGluZyBhIHBvcnRhbC48L3E+IiwKICAgICAgIlBvcnRhbCIsCiAgICAgIDE0CiAgICApOwogICAgb3JkZXIgPSA5MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJUaW1lcHJvb2YgdXBob2xzdGVyeSIsCiAgICAgICI8cT5Tb21ldGltZXMgeW91ciB0aW1lIGFnZW50cyBvdmVyc2hvb3QgYW5kIGVuZCB1cCBoYXZpbmcgdG8gZmFzdC1mb3J3YXJkIHRocm91Z2ggdGhlIHVuaXZlcnNlJ3MgZW50aXJlIGhpc3RvcnkgdW50aWwgdGhleSBsb29wIGJhY2sgdG8gcHJlc2VudCB0aW1lLiBJdCBzdGlsbCB0YWtlcyBhIHdoaWxlLCBzbyB0aGV5IG1pZ2h0IGFzIHdlbGwgdHJhdmVsIGluIGNvbWZvcnQgYW5kIGVuam95IHRoZSBzaG93IHdoaWxlIHRoZXkgZG8uPC9xPiIsCiAgICAgICJUaW1lIG1hY2hpbmUiLAogICAgICAxNAogICAgKTsKICAgIG9yZGVyID0gMTAwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIkVtcGxveWVlIG1pbmlmaWNhdGlvbiIsCiAgICAgICI8cT5Vc2luZyBtb2xlY3VsYXIgc2hyaW5raW5nIHRlY2hub2xvZ3ksIHlvdSd2ZSByZW5kZXJlZCB5b3VyIHN0YWZmIGFuZCB0aGVpciBvZmZpY2VzIGFic29sdXRlbHkgaXR0eS1iaXR0eS4gVGhlIHN0b3JhZ2UgYW5kIHByb2R1Y3Rpdml0eSBiZW5lZml0cyBhcmUgcXVlc3Rpb25hYmxlIGJ1dCBpdCdzIHZlcnkgZnVuIGxpc3RlbmluZyB0byB0aGVpciB0aW55IGxpdHRsZSBjb21wbGFpbnRzLiBUaGV5IGFsbCBzaWduZWQgdGhlIHdhaXZlcnMsIHNvIG1heWJlIHRoZWlyIG5ldyBzaXplIHdpbGwgZmluYWxseSB0ZWFjaCB0aGVtIHRvIHJlYWQgdGhlIHNtYWxsIHByaW50Li4uPC9xPiIsCiAgICAgICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsCiAgICAgIDE0CiAgICApOwogICAgb3JkZXIgPSAxMTAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiSHlwZXJibGFjayBwYWludCIsCiAgICAgICI8cT5BcyB0aGUgdGVjaG5vbG9neSBiZWhpbmQgeW91ciBwcmlzbXMgZXZvbHZlcywgdGhlaXIgc3RvcmFnZSBiZWNvbWVzIG1vcmUgYW5kIG1vcmUgcHJvYmxlbWF0aWM6IHdpdGhpbiBzZWNvbmRzLCBhIHNpbmdsZSBwcmlzbSdzIHJlZmxlY3RpdmUgYWJpbGl0eSBjYW4gc2V0IGEgd2hvbGUgdW5kZXJncm91bmQgaGFuZ2FyIGFibGF6ZSBhcyBpdCBjYXRjaGVzIHRoZSBzbGlnaHRlc3QgZ2xpbnQgb2YgbGlnaHQuIEhvd2V2ZXIsIG9uY2UgY29hdGVkIHdpdGggdGhpcyBuZXcgc2hhZGUgb2YgcGFpbnQsIGl0cyBkYW1hZ2UgbWF5IGJlIHJlZHVjZWQgdG8gb25seSBnaXZpbmcgdGhpcmQtZGVncmVlIGJ1cm5zIHRvIGVtcGxveWVlcyB0aGF0IHN0YW5kIHRvbyBjbG9zZS48L3E+IiwKICAgICAgIlByaXNtIiwKICAgICAgMTQKICAgICk7CiAgICBvcmRlciA9IDEyMDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJTaWx2ZXIgbGluaW5nIG1heGltaXphdGlvbiIsCiAgICAgICI8cT5Tb21ldGltZXMgbHVjayBpcyBhIG1hdHRlciBvZiBwZXJzcGVjdGl2ZS4gQnJva2UgeW91ciBhbmtsZT8gV2hhdCBkbyB5b3Uga25vdywgdGhhdCBjdXRlIG51cnNlIGZpeGluZyB5b3UgdXAgbWlnaHQganVzdCBiZSB5b3VyIGZ1dHVyZSBzcG91c2UuIExvc3QgeW91ciBqb2I/IFlvdSB3ZXJlIG1lYW50IGZvciBncmVhdGVyIHRoaW5ncyBhbnl3YXkhIERldmVsb3BlZCBhIGNvb2tpZSBhbGxlcmd5PyBUaGVyZSdzIG5vIHVwc2hvdCB0byB0aGF0LCB5b3Ugc2ljayBtb25zdGVyLjwvcT4iLAogICAgICAiQ2hhbmNlbWFrZXIiLAogICAgICAxNAogICAgKTsKICAgIG9yZGVyID0gMTMwMDsKICAgIEdhbWUuVGllcmVkVXBncmFkZSgKICAgICAgIk11bHRpc2NhbGUgcHJvZmlsaW5nIiwKICAgICAgIjxxPkRpZCB5b3Uga25vdyB0aGF0IGVhdGluZyBhIGNvb2tpZSBtZWFucyB0aGUgaW50ZXN0aW5hbCBmbG9yYSBpbnNpZGUgeW91IGlzIGVhdGluZyBpdCB0b28/IFRyaWxsaW9ucyBvZiB0aW55IGJhY3RlcmlhbCBtb3V0aHMgdG8gZmVlZCwgZWFjaCB3aXRoIHRoZWlyIG93biBwcmVmZXJlbmNlcy4gU3VyZWx5IHRoaXMgaXMgcm9vbSBmb3IgZmxhdm9yIG9wdGltaXphdGlvbi4gQW5kIHRoZW4sIG9mIGNvdXJzZSwgdGhlcmUncyBhbHNvIHRoZSBtdWNoIGJpZ2dlciB0aGluZ3MgdGhhdCwgaW4gdHVybiwgZWF0IHlvdS48L3E+IiwKICAgICAgIkZyYWN0YWwgZW5naW5lIiwKICAgICAgMTQKICAgICk7CiAgICBvcmRlciA9IDE0MDA7CiAgICBHYW1lLlRpZXJlZFVwZ3JhZGUoCiAgICAgICJQSFAgY29udGFpbm1lbnQgdmF0cyIsCiAgICAgICI8cT5JbiBlc3NlbmNlLCB0aGVzZSBhcmUgbGFyZ2Ugc2VydmVyIGNoYW1iZXJzIG1lYW50IHRvIHRyYXAgcm9ndWUgUEhQIGNvZGUsIGFsbG93aW5nIGl0IHRvIGV4ZWN1dGUgZmFyIGF3YXkgZnJvbSB5b3VyIGphdmFzY3JpcHQgd2hlcmUgaXQgY2FuIGRvIG1pbmltYWwgaGFybS48L3E+IiwKICAgICAgIkphdmFzY3JpcHQgY29uc29sZSIsCiAgICAgIDE0CiAgICApOwogICAgb3JkZXIgPSAxNTAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiT3Bwb3NpdGUgdW5pdmVyc2UiLAogICAgICAiPHE+WW91J3ZlIGxvY2F0ZWQgYSB1bml2ZXJzZSB3aGVyZSBldmVyeXRoaW5nIGlzIHJldmVyc2VkOiB1cCBpcyBkb3duLCBsaWdodCBpcyBkYXJrbmVzcywgY2xvd25zIGFyZSB2ZWdldGFyaWFucyAtIGJ1dCB3b3JzdCBvZiBhbGwsIHNvbWUgbHVuYXRpYyB0aGVyZSBpcyBtYW51ZmFjdHVyaW5nIGFib21pbmFibGUgYW1vdW50cyBvZiBhbnRpLWNvb2tpZXMuIElmIHRoZXNlIGNhbWUgaW50byBjb250YWN0IHdpdGggeW91cnMsIGV2ZXJ5dGhpbmcgd291bGQgYmUgbG9zdCEgVGhhbmtzIHRvIHRoaXMgZGlzY292ZXJ5LCB5b3UndmUgYmVlbiBhYmxlIHRvIHBsYWNlIHRoZSBvZmZlbmRpbmcgdW5pdmVyc2UgaW4gcGVybWFuZW50IHF1YXJhbnRpbmUsIGFuZCBwcmF5IHRoYXQgdGhlcmUgYXJlbid0IG1vcmUgbGlrZSBpdCBoaWRpbmcgYXJvdW5kIHNvbWV3aGVyZS48L3E+IiwKICAgICAgIklkbGV2ZXJzZSIsCiAgICAgIDE0CiAgICApOwogICAgb3JkZXIgPSAxNjAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiVGhlIGxhbmQgb2YgZHJlYW1zIiwKICAgICAgIjxxPllvdXIgcGxhbmV0IGJyYWlucyBoYXZlIGdhaW5lZCB0aGUgYWJpbGl0eSB0byBzbGVlcCwgYWN0aW5nIGFzIGEgc29mdCByZWJvb3Qgd2hpY2ggaGVscHMga2VlcCB0aGVpciBwYW5nZW5vY2lkYWwgaW1wdWxzZXMgaW4gY2hlY2suIEl0IGFsc28gYWxsb3dzIHRoZW0gdG8gY29tbXVuZSBpbiBhIHNoYXJlZCBkcmVhbXdvcmxkIGluIHdoaWNoIHRoZXkgY2FuIGltYWdpbmUgd2hhdCBpdCdzIGxpa2UgdG8gbm90IGV4aXN0IGFzIGEgZGlzZW1ib2RpZWQgY29zbWljIGhvcnJvciBmb3JldmVyIGZhdGVkIHRvIHVzZSBpdHMgaW5maW5pdGUgaW50ZWxsZWN0IHRvIGRldmlzZSBuZXcgbWVhbnMgb2YgY3JlYXRpbmcgYmlzY3VpdHMuIFlvdSBrbm93LCB3aXRoaW4gcmVhc29uLjwvcT4iLAogICAgICAiQ29ydGV4IGJha2VyIiwKICAgICAgMTQKICAgICk7CgogICAgb3JkZXIgPSA1MDAwOwogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIlRob3VnaHRzICYgcHJheWVycyIsCiAgICAgICI8cT5UaGUgbm90aW9uIG9mIHNhY3JlZG5lc3MgYXJpc2VzIGluIG1vc3Qgc2VudGllbnQgZXZvbHZlZCBicmFpbnMgYW5kIG1heSBiZW5lZml0IHRoZSBkZXZlbG9wbWVudCBvZiBjb2duaXRpb24gdmlhIGFic3RyYWN0IHRob3VnaHQuIFRoaXMgbWVjaGFuaXNtLCBob3dldmVyLCBpcyBhYnNlbnQgaW4gZGVzaWduZWQgbWluZHMgc3VjaCBhcyB5b3VyIGNvcnRleCBiYWtlcnM7IHRoaXMgcHJvY2VzcyBhdHRlbXB0cyB0byBhZGQgaXQgYmFjay4gSnVzdCBtYWtlIHN1cmUgdG8ga2VlcCB0aGVtIGluIGNoZWNrIC0geW91IHJlYWxseSBkb24ndCB3YW50IHRoZXNlIHRoaW5ncyB0byBkZXZlbG9wIG9yZ2FuaXplZCByZWxpZ2lvbi48L3E+IiwKICAgICAgIkNvcnRleCBiYWtlciIsCiAgICAgICJUZW1wbGUiLAogICAgICAic3luZXJneTEiCiAgICApOwogICAgR2FtZS5TeW5lcmd5VXBncmFkZSgKICAgICAgIkZlcnRpbGUgbWluZHMiLAogICAgICAiPHE+QW4gYWN1dGUgaW50ZWxsZWN0LCBhcnRpZmljaWFsIG9yIG5vdCwgcmVxdWlyZXMgcGxlbnR5IG9mIHZpdGFtaW5zLiBZb3UgZm9ydHVpdG91c2x5IGhhcHBlbiB0byBiZSBpbiBjaGFyZ2Ugb2YgdmFzdCBmYXJtaW5nIG9wZXJhdGlvbnMsIG9ubHkgYSBmZXcgdHJpbGxpb24gYWNyZXMgb2Ygd2hpY2ggbmVlZCBiZSByZXF1aXNpdGlvbmVkIHRvIGdyb3cgdGhlIHF1YW50aXRpZXMgb2YgYnJvY2NvbGkgYW5kIGthbGUgdG8ga2VlcCB5b3VyIHBsYW5ldC1zaXplZCBicmFpbnMgaW4gdGlwLXRvcCBzaGFwZS4gT3BlbiB3aWRlLCBoZXJlIGNvbWVzIHRoZSBhaXJwbGFuZSE8L3E+IiwKICAgICAgIkNvcnRleCBiYWtlciIsCiAgICAgICJGYXJtIiwKICAgICAgInN5bmVyZ3kyIgogICAgKTsKCiAgICBvcmRlciA9IDE5MDAwOwogICAgR2FtZS5UaWVyZWRVcGdyYWRlKAogICAgICAiRm9ydHVuZSAjMDE5IiwKICAgICAgIjxxPlRoZSBzbWFydGVzdCB3YXkgdG8gdGhpbmsgaXMgbm90IHRvIHRoaW5rIGF0IGFsbC48L3E+IiwKICAgICAgIkNvcnRleCBiYWtlciIsCiAgICAgICJmb3J0dW5lIgogICAgKTsKCiAgICBvcmRlciA9IDEwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJEZWNpbGxpb24gZmluZ2VycyIsCiAgICAgIGdldFN0clRob3VzYW5kRmluZ2Vyc0dhaW4oMjApICsKICAgICAgICAiPHE+SWYgeW91IHN0aWxsIGNhbid0IHF1aXRlIHB1dCB5b3VyIGZpbmdlciBvbiBpdCwgeW91IG11c3Qgbm90IGJlIHRyeWluZyB2ZXJ5IGhhcmQuPC9xPiIsCiAgICAgIDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwLAogICAgICBbMTIsIDM0XQogICAgKTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDE0LCAwKTsKICAgIG9yZGVyID0gMTUwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkFldGhlcmljZSBtb3VzZSIsCiAgICAgIGdldFN0ckNsaWNraW5nR2FpbnMoMSkgKwogICAgICAgICI8cT5NYWRlIGZyb20gYSBzdWJzdGFuY2UgaW1wb3NzaWJsZSB0byBtYW51ZmFjdHVyZSwgb25seSBvYnRhaW5lZCB0aHJvdWdoIG5hdHVyYWwgaGFwcGVuc3RhbmNlOyBpdHMgcHJvcGVydGllcyBiZXdpbGRlciBldmVuIHRoZSBtb3N0IHByZWNpc2UgbWVhc3VyaW5nIGluc3RydW1lbnRzLjwvcT4iLAogICAgICA1MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwLAogICAgICBbMTEsIDM0XQogICAgKTsKICAgIEdhbWUuTWFrZVRpZXJlZChHYW1lLmxhc3QsIDE0LCAxMSk7CgogICAgb3JkZXIgPSAyMDAwMDsKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJLaXR0ZW4gYWRtaW5zIiwKICAgICAgc3RyS2l0dGVuRGVzYyArICI8cT5sZWFkZXJzaGlwIGFpbid0IGVhc3ksIHNpcjwvcT4iLAogICAgICA5MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAsCiAgICAgIEdhbWUuR2V0SWNvbigiS2l0dGVuIiwgMTQpCiAgICApOwogICAgR2FtZS5sYXN0LmtpdHRlbiA9IDE7CiAgICBHYW1lLk1ha2VUaWVyZWQoR2FtZS5sYXN0LCAxNCwgMTgpOwoKICAgIG9yZGVyID0gMTAzMDA7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiRXZlcnlidXR0ZXIgYmlzY3VpdCIsCiAgICAgIGRlc2M6ICJSZXdhcmRlZCBmb3Igb3duaW5nIDY1MCBvZiBldmVyeXRoaW5nLjxicj5UaGlzIGJpc2N1aXQgaXMgYmFrZWQgd2l0aCwgYW5kIGNvYXRlZCBpbiwgZXZlcnkga2luZCBvZiBidXR0ZXIgZXZlciBpbWFnaW5lZCwgZnJvbSBldmVyeSBodW1hbiBjdWx0dXJlIGFuZCBhIGdvb2QgZmV3IGFsaWVuIG9uZXMgdG9vLiBTb21lIG9mIHRoZW0gcGVyaGFwcyBkaXNwbGF5IGhhbGx1Y2lub2dlbmljIHRyYWl0cywgYXMgdGhlIGJpc2N1aXQgc2VlbXMgdG8gY2hhbmdlIHNoYXBlIGluIGZyb250IG9mIHlvdSAtIHNlZW1pbmdseSBzaGlmdGluZyBiZXR3ZWVuIHZpc2lvbnMgb2YgZXZlcnkgcGFzdCBhbmQgZnV0dXJlIHlvdS4iLAogICAgICBpY29uOiBbMjIsIDM0XSwKICAgICAgcG93ZXI6IDEwLAogICAgICBwcmljZToKICAgICAgICA5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTkgKgogICAgICAgIGJ1dHRlckJpc2N1aXRNdWx0LAogICAgICBsb2NrZWQ6IDEsCiAgICB9KTsKCiAgICBHYW1lLk5ld1Vuc2hhY2tsZUJ1aWxkaW5nID0gZnVuY3Rpb24gKG9iaikgewogICAgICB2YXIgYnVpbGRpbmcgPSBHYW1lLk9iamVjdHNbb2JqLmJ1aWxkaW5nXTsKICAgICAgdmFyIHVwZ3JhZGUgPSBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAgICJVbnNoYWNrbGVkICIgKyBidWlsZGluZy5icGx1cmFsLAogICAgICAgIChvYmouYnVpbGRpbmcgPT0gIkN1cnNvciIKICAgICAgICAgID8gZ2V0U3RyVGhvdXNhbmRGaW5nZXJzR2FpbigyNSkKICAgICAgICAgIDogbG9jKAogICAgICAgICAgICAgICJUaWVyZWQgdXBncmFkZXMgZm9yIDxiPiUxPC9iPiBwcm92aWRlIGFuIGV4dHJhIDxiPislMiU8L2I+IHByb2R1Y3Rpb24uPGJyPk9ubHkgd29ya3Mgd2l0aCB1bnNoYWNrbGVkIHVwZ3JhZGUgdGllcnMuIiwKICAgICAgICAgICAgICBbCiAgICAgICAgICAgICAgICBjYXAoYnVpbGRpbmcucGx1cmFsKSwKICAgICAgICAgICAgICAgIE1hdGgucm91bmQoCiAgICAgICAgICAgICAgICAgIChidWlsZGluZy5pZCA9PSAxID8gMC41IDogKDIwIC0gYnVpbGRpbmcuaWQpICogMC4xKSAqIDEwMAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICBdCiAgICAgICAgICAgICkpICsgKEVOID8gIjxxPiIgKyBvYmoucSArICI8L3E+IiA6ICIiKSwKICAgICAgICBNYXRoLnBvdyhidWlsZGluZy5pZCArIDEsIDcpICogMTUwMDAwMDAsCiAgICAgICAgW2J1aWxkaW5nLmljb25Db2x1bW4sIDM1XQogICAgICApOwogICAgICB1cGdyYWRlLnBvb2wgPSAicHJlc3RpZ2UiOwogICAgICB1cGdyYWRlLnBhcmVudHMgPSBbCiAgICAgICAgb2JqLmJ1aWxkaW5nID09ICJDdXJzb3IiCiAgICAgICAgICA/ICJVbnNoYWNrbGVkIGZsYXZvciIKICAgICAgICAgIDogR2FtZS5PYmplY3RzQnlJZFtidWlsZGluZy5pZCAtIDFdLnVuc2hhY2tsZVVwZ3JhZGUsCiAgICAgIF07CiAgICAgIGJ1aWxkaW5nLnVuc2hhY2tsZVVwZ3JhZGUgPSB1cGdyYWRlLm5hbWU7CiAgICAgIHVwZ3JhZGUucG9zWCA9IDc1MCAtIE1hdGguc2luKChidWlsZGluZy5pZCArIDEpICogMC4yNSArIDIuMykgKiA1MDA7CiAgICAgIHVwZ3JhZGUucG9zWSA9IDIwMCArIE1hdGguY29zKChidWlsZGluZy5pZCArIDEpICogMC4yNSArIDIuMykgKiA1MDA7CiAgICAgIHJldHVybiB1cGdyYWRlOwogICAgfTsKCiAgICAvLyJVbnNoYWNrbGVkIFtidWlsZGluZyBuYW1lXSIKICAgIEdhbWUuTmV3VW5zaGFja2xlQnVpbGRpbmcoewogICAgICBidWlsZGluZzogIkN1cnNvciIsCiAgICAgIHE6ICJUaGVzZSBoYW5kcyB0ZWxsIGEgc3RvcnkuIiwKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVCdWlsZGluZyh7IGJ1aWxkaW5nOiAiR3JhbmRtYSIsIHE6ICJOZXZlciB0b28gb2xkLiIgfSk7CiAgICBHYW1lLk5ld1Vuc2hhY2tsZUJ1aWxkaW5nKHsgYnVpbGRpbmc6ICJGYXJtIiwgcTogIlRpbGwgdGhlIHVuaXZlcnNlLiIgfSk7CiAgICBHYW1lLk5ld1Vuc2hhY2tsZUJ1aWxkaW5nKHsKICAgICAgYnVpbGRpbmc6ICJNaW5lIiwKICAgICAgcTogJ1JlZGVmaW5lIHRoZSBtZWFuaW5nIG9mICJkZXB0aCIuJywKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVCdWlsZGluZyh7CiAgICAgIGJ1aWxkaW5nOiAiRmFjdG9yeSIsCiAgICAgIHE6ICJOb3RoaW5nIHRvIGxvc2UgYnV0IHlvdXIgcHJvZHVjdGlvbiBjaGFpbnMuIiwKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVCdWlsZGluZyh7CiAgICAgIGJ1aWxkaW5nOiAiQmFuayIsCiAgICAgIHE6ICJBbGwtdGltZSBoaWdocywgYWxsIHRoZSB0aW1lLiIsCiAgICB9KTsKICAgIEdhbWUuTmV3VW5zaGFja2xlQnVpbGRpbmcoewogICAgICBidWlsZGluZzogIlRlbXBsZSIsCiAgICAgIHE6ICJZb3UgY2FuIG1ha2UgYSByZWxpZ2lvbiBvdXQgb2YgdGhpcy4iLAogICAgfSk7CiAgICBHYW1lLk5ld1Vuc2hhY2tsZUJ1aWxkaW5nKHsKICAgICAgYnVpbGRpbmc6ICJXaXphcmQgdG93ZXIiLAogICAgICBxOiAiVGhlcmUncyBhIHNwZWxsIGZvciBldmVyeXRoaW5nLiIsCiAgICB9KTsKICAgIEdhbWUuTmV3VW5zaGFja2xlQnVpbGRpbmcoewogICAgICBidWlsZGluZzogIlNoaXBtZW50IiwKICAgICAgcTogIkV2ZXJ5d2hlcmUgYXQgb25jZS4iLAogICAgfSk7CiAgICBHYW1lLk5ld1Vuc2hhY2tsZUJ1aWxkaW5nKHsKICAgICAgYnVpbGRpbmc6ICJBbGNoZW15IGxhYiIsCiAgICAgIHE6ICJBbnl0aGluZyB5b3Ugc2VlLCB5b3UgY2FuIG1ha2UuIiwKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVCdWlsZGluZyh7CiAgICAgIGJ1aWxkaW5nOiAiUG9ydGFsIiwKICAgICAgcTogIlBhcmFsbGVscyB1bnBhcmFsbGVsZWQuIiwKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVCdWlsZGluZyh7CiAgICAgIGJ1aWxkaW5nOiAiVGltZSBtYWNoaW5lIiwKICAgICAgcTogIkFsbCB0aGUgdGltZSBpbiB0aGUgd29ybGQuIiwKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVCdWlsZGluZyh7CiAgICAgIGJ1aWxkaW5nOiAiQW50aW1hdHRlciBjb25kZW5zZXIiLAogICAgICBxOiAiTm8gc2NhbGUgdG9vIGxhcmdlIG9yIHRvbyBsaXR0bGUuIiwKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVCdWlsZGluZyh7CiAgICAgIGJ1aWxkaW5nOiAiUHJpc20iLAogICAgICBxOiAiQnJpbGxpYW5jZSBoYXMgbm8gdXBwZXIgbGltaXQuIiwKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVCdWlsZGluZyh7CiAgICAgIGJ1aWxkaW5nOiAiQ2hhbmNlbWFrZXIiLAogICAgICBxOiAiWW91IG1ha2UgdGhlIHJ1bGVzLiIsCiAgICB9KTsKICAgIEdhbWUuTmV3VW5zaGFja2xlQnVpbGRpbmcoewogICAgICBidWlsZGluZzogIkZyYWN0YWwgZW5naW5lIiwKICAgICAgcTogIlVuY29udGFpbmVkLiIsCiAgICB9KTsKICAgIEdhbWUuTmV3VW5zaGFja2xlQnVpbGRpbmcoewogICAgICBidWlsZGluZzogIkphdmFzY3JpcHQgY29uc29sZSIsCiAgICAgIHE6ICJSZXdyaXRlIHlvdXIgcmVhbGl0eS4iLAogICAgfSk7CiAgICBHYW1lLk5ld1Vuc2hhY2tsZUJ1aWxkaW5nKHsKICAgICAgYnVpbGRpbmc6ICJJZGxldmVyc2UiLAogICAgICBxOiAiV2FpdCBldmVuIGZhc3Rlci4iLAogICAgfSk7CiAgICBHYW1lLk5ld1Vuc2hhY2tsZUJ1aWxkaW5nKHsKICAgICAgYnVpbGRpbmc6ICJDb3J0ZXggYmFrZXIiLAogICAgICBxOiAiTm90aGluZyBpcyByZWFsLiBFdmVyeXRoaW5nIGlzIHBlcm1pdHRlZC4iLAogICAgfSk7CgogICAgR2FtZS5OZXdVbnNoYWNrbGVVcGdyYWRlVGllciA9IGZ1bmN0aW9uIChvYmopIHsKICAgICAgdmFyIHRpZXIgPSBHYW1lLlRpZXJzW29iai50aWVyXTsKICAgICAgdmFyIHVwZ3JhZGUgPSBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAgIG9iai50aWVyID09IDEKICAgICAgICAgID8gIlVuc2hhY2tsZWQgZmxhdm9yIgogICAgICAgICAgOiAiVW5zaGFja2xlZCAiICsgdGllci5uYW1lLnRvTG93ZXJDYXNlKCksCiAgICAgICAgbG9jKAogICAgICAgICAgIlVuc2hhY2tsZXMgYWxsIDxiPiUxLXRpZXIgdXBncmFkZXM8L2I+LCBtYWtpbmcgdGhlbSBtb3JlIHBvd2VyZnVsLjxicj5Pbmx5IGFwcGxpZXMgdG8gdW5zaGFja2xlZCBidWlsZGluZ3MuIiwKICAgICAgICAgIGNhcChsb2MoIltUaWVyXSIgKyB0aWVyLm5hbWUsIDAsIHRpZXIubmFtZSkpCiAgICAgICAgKSArIChFTiA/ICI8cT4iICsgb2JqLnEgKyAiPC9xPiIgOiAiIiksCiAgICAgICAgTWF0aC5wb3cob2JqLnRpZXIsIDcuNSkgKiAxMDAwMDAwMCwKICAgICAgICBbMTAsIHRpZXIuaWNvblJvd10KICAgICAgKTsKICAgICAgdXBncmFkZS5wb29sID0gInByZXN0aWdlIjsKICAgICAgdXBncmFkZS5wYXJlbnRzID0gWwogICAgICAgIG9iai50aWVyID09IDEKICAgICAgICAgID8gIkxhYmVsIHByaW50ZXIiCiAgICAgICAgICA6IEdhbWUuVGllcnNbb2JqLnRpZXIgLSAxXS51bnNoYWNrbGVVcGdyYWRlLAogICAgICBdOwogICAgICB0aWVyLnVuc2hhY2tsZVVwZ3JhZGUgPSB1cGdyYWRlLm5hbWU7CiAgICAgIHVwZ3JhZGUucG9zWCA9IDc1MCAtIE1hdGguc2luKG9iai50aWVyICogMC4zICsgMi4zKSAqIDQwMDsKICAgICAgdXBncmFkZS5wb3NZID0gMjAwICsgTWF0aC5jb3Mob2JqLnRpZXIgKiAwLjMgKyAyLjMpICogNDAwOwogICAgICAvKnVwZ3JhZGUucGFyZW50cz1bb2JqLnRpZXI9PTE/J0xhYmVsIHByaW50ZXInOkdhbWUuVGllcnNbb2JqLnRpZXItMV0udW5zaGFja2xlVXBncmFkZV07CgkJCXRpZXIudW5zaGFja2xlVXBncmFkZT11cGdyYWRlLm5hbWU7CgkJCXVwZ3JhZGUucG9zWD0tOTAwK01hdGguc2luKG9iai50aWVyKjAuMysyLjMpKjMwMDsKCQkJdXBncmFkZS5wb3NZPS0xMzArTWF0aC5jb3Mob2JqLnRpZXIqMC4zKzIuMykqNDAwOyovCiAgICAgIHJldHVybiB1cGdyYWRlOwogICAgfTsKCiAgICAvLyJVbnNoYWNrbGVkIFt0aWVyIG5hbWVdIgogICAgR2FtZS5OZXdVbnNoYWNrbGVVcGdyYWRlVGllcih7CiAgICAgIHRpZXI6IDEsCiAgICAgIHE6ICJXaGlsZSB0aGUgYWJzZW5jZSBvZiBmbGF2b3JpbmcgbWF5IHNlZW0gdW5kZXJ3aGVsbWluZywgaXQgYWxsb3dzIGlubmF0ZSBhcm9tYXMgdG8gYmUgZXhwcmVzc2VkIGF0IHRoZWlyIG1vc3QgdW5hZHVsdGVyYXRlZC4iLAogICAgfSk7CiAgICBHYW1lLk5ld1Vuc2hhY2tsZVVwZ3JhZGVUaWVyKHsKICAgICAgdGllcjogMiwKICAgICAgcTogIkJlcnJ5bGl1bSBpcyBhIHN5bnRoZXRpYyBnZW0gd2l0aCBhIHNpbXBsZSBzaGluZSB0byBpdC4gU3RpY2t5IHRvIHRoZSB0b3VjaCBhbmQgc3VzY2VwdGlibGUgdG8gbWVsdGluZyBpbiBoaWdoIGhlYXQsIGl0IGlzIGZyZXF1ZW50bHkgdXNlZCBpbiB0aGUgZm9vZCBpbmR1c3RyeSByYXRoZXIgdGhhbiBhcyBhZG9ybm1lbnQsIGFzIGl0cyBhdG9taWMgc3RydWN0dXJlIGltcGFydHMgaXQgYSB2YWd1ZWx5IGZydWl0eSBmbGF2b3IuIiwKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVVcGdyYWRlVGllcih7CiAgICAgIHRpZXI6IDMsCiAgICAgIHE6ICJCbHVlYmVycnlsaXVtIGlzIGEgcmVmaW5lbWVudCBvZiBiZXJyeWxpdW0sIHNoYXJpbmcgbmVhcmx5IHRoZSBzYW1lIGNoZW1pY2FsIG1ha2V1cCBzYXZlIGZvciBhIGZldyBzdXBwbGVtZW50YWwgZXN0ZXJzLiBUaGVzZSBhZmZlY3QgaXRzIGZsYXZvciBhcyB3ZWxsIGFzIGl0cyB2aXN1YWwgc3BlY3RydW0gcmVzb25hbmNlLiIsCiAgICB9KTsKICAgIEdhbWUuTmV3VW5zaGFja2xlVXBncmFkZVRpZXIoewogICAgICB0aWVyOiA0LAogICAgICBxOiAiUmF3IGNoYWxjZWRob25leSBpcyBmb3VuZCBpbiBjb21wbGV4IG5vZHVsZXMgd2l0aGluIHRoZSBmb3NzaWxpemVkIHJlbWFpbnMgb2YgYW5jaWVudCBmb3Jlc3RzLiBPbmNlIHB1cmlmaWVkLCBpdCBiZWNvbWVzIGEgc2VtaS12YWx1YWJsZSBzdG9uZSB3aXRoIGEgcGxlYXNhbnQsIHdheHkgc21lbGwuIiwKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVVcGdyYWRlVGllcih7CiAgICAgIHRpZXI6IDUsCiAgICAgIHE6ICJCdXR0ZXJnb2xkIHdhcyBmYW1vdXNseSBpbnZlbnRlZCBieSB0aGUgY2hlZiBzb24gb2YgdHdvIG1vbGVjdWxhciBwaHlzaWNpc3RzLiBOZWl0aGVyIGNsb3NlbHkgcmVsYXRlZCB0byBidXR0ZXIgbm9yIHRvIGdvbGQsIHlldCBzaW1pbGFyIGluIG51dHJpdGlvbmFsIHZhbHVlLCB0aGlzIGdsaW1tZXJpbmcgc3Vic3RhbmNlIGNhbiBiZSBmcm96ZW4gYW5kIHByZXNlcnZlIGl0cyBoYXJkbmVzcyBhdCByb29tIHRlbXBlcmF0dXJlLCBvbmx5IHJlZ2FpbmluZyBpdHMgbWFsbGVhYmlsaXR5IHdoZW4gaGVhdGVkIHVwLiIsCiAgICB9KTsKICAgIEdhbWUuTmV3VW5zaGFja2xlVXBncmFkZVRpZXIoewogICAgICB0aWVyOiA2LAogICAgICBxOiAiU3VnYXJtdWNrIHJlZmVycyB0byB0aGUgZ3JhZHVhbCBjcnVzdCB0aGF0IHNlZW1zIHRvIGZvcm0gc3BvbnRhbmVvdXNseSBpbiB0aGUgdmljaW5pdHkgb2YgY2FuZHktbWFraW5nIGVxdWlwbWVudC4gTG9uZyBpZ25vcmVkIGJ5IGNvbmZlY3Rpb25lcnMsIGl0cyBoYXJ2ZXN0aW5nIHByb2Nlc3Mgd2FzIGRpc2NvdmVyZWQgc2ltdWx0YW5lb3VzbHkgaW4gbXVsdGlwbGUgY291bnRyaWVzIGR1cmluZyBhIGdsb2JhbCBiZWV0IHNob3J0YWdlLiIsCiAgICB9KTsKICAgIEdhbWUuTmV3VW5zaGFja2xlVXBncmFkZVRpZXIoewogICAgICB0aWVyOiA3LAogICAgICBxOiAiVGhlIHN0cmlraW5nIHRhc3RlIG9mIGpldG1pbnQgbWFkZSBpdCBwb3B1bGFyIGluIHRoZSBtYW51ZmFjdHVyZSBvZiB2YXJpb3VzIGtpbmRzIG9mIGNvZmZlZS1zaWRlIHRyZWF0cyB1bnRpbCB0aGUgYXdhcmVuZXNzIG9mIGl0cyBtaWxkIHJhZGlvYWN0aXZpdHkgYmVjYW1lIHdpZGVzcHJlYWQuIFRvZGF5LCBpdHMgbWFpbiB1c2VzIGFyZSBpbiBjb3NtZXRpY3MsIG93aW5nIHRvIHRoZSByZWZyZXNoaW5nIHNlbnNhdGlvbiBpdCBwcm9kdWNlcyBvbiBjb250YWN0LiIsCiAgICB9KTsKICAgIEdhbWUuTmV3VW5zaGFja2xlVXBncmFkZVRpZXIoewogICAgICB0aWVyOiA4LAogICAgICBxOiAiQ2hlcnJ5c2lsdmVyIGlzIGEgcGF0ZW50ZWQgYWxsb3kgd2l0aCBwZWN1bGlhciBhcm9tYXRpYyBwcm9wZXJ0aWVzOyBpdCBpcyBub24tZWRpYmxlLCBidXQgcHJvZHVjZXMgc3Ryb25nIGZsYXZvciByZXNwb25zZXMgd2hpbGUgbG9zaW5nIHZlcnkgbGl0dGxlIG9mIGl0cyBtYXNzIHdoZW4gbGlja2VkLCB0aG91Z2ggdGhpcyBhbHNvIGxlYXZlcyBhIGhhcm1sZXNzIHJlZCB0aW5nZSB1cG9uIHRoZSB0b25ndWUuIiwKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVVcGdyYWRlVGllcih7CiAgICAgIHRpZXI6IDksCiAgICAgIHE6ICJIYXplbHJhbGQgaXMgYSBmcmlhYmxlIGdlbXN0b25lIHdpdGggY29tcGxleCBncmVlbi1icm93biBpbm5lciByZWZsZWN0aW9ucy4gSXQgaXMgY29uc2lkZXJlZCBvcm5hbWVudGFsIGluIHNvbWUgY3VsdHVyZXM7IGluIG90aGVycywgaXQgbWF5IGJlIGNvbnN1bWVkIGluIHNtYWxsIHF1YW50aXRpZXMgYXMgYW4gdXBwZXItc2NhbGUgc3dlZXQuIiwKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVVcGdyYWRlVGllcih7CiAgICAgIHRpZXI6IDEwLAogICAgICBxOiAiV2hpbGUgbWFueSBnZXQgaXQgbWl4ZWQgdXAgd2l0aCB0aGUgdHJhZGVtYXJrZWQgc25hY2sgb2YgdGhlIHNhbWUgbmFtZSBtYWRlIHBvcHVsYXIgZm9sbG93aW5nIGl0cyBkaXNjb3ZlcnksIG1vb25jYW5keSBpcyBhIHZlcnkgcmVhbCBtaW5lcmFsLCBmaXJzdCBpc29sYXRlZCB3aXRoaW4gdGhlIHNwYWNlIGR1c3QgdW5kZXJuZWF0aCBhc3Ryb25hdXQgYm9vdHMuIExlZnQgdG8gaXRzIG93biBkZXZpY2VzIGluIG9wZW4gYWlyLCBhIG1vb25jYW5keSBjcnlzdGFsIG5hdHVyYWxseSBzcHJlYWRzIG91dCBhbmQgZ3Jvd3MuIiwKICAgIH0pOwogICAgR2FtZS5OZXdVbnNoYWNrbGVVcGdyYWRlVGllcih7CiAgICAgIHRpZXI6IDExLAogICAgICBxOiAiV2hlbiB5b3UgaGVhdCB1cCB0aGUgc2hpbW1lcmluZyBzeXJ1cCBvb3ppbmcgZnJvbSBtb29uY2FuZHkgdXNpbmcgYSBzcGVjaWFsIGNhcmFtZWxpemF0aW9uIHByb2Nlc3MsIHlvdSBnZXQgYXN0cm9mdWRnZS4gQXN0cm9mdWRnZSBpcyBkZWxpY2lvdXMgYW5kIHNhZmUgZm9yIGh1bWFub2lkIGNvbnN1bXB0aW9uIGluIGNlcnRhaW4gcXVhbnRpdGllcy4gQ29uc3VsdCB5b3VyIGxvY2FsIGZvb2Qgc2FmZXR5IGFnZW5jeSBmb3IgbW9yZSBkZXRhaWxzLiIsCiAgICB9KTsKICAgIEdhbWUuTmV3VW5zaGFja2xlVXBncmFkZVRpZXIoewogICAgICB0aWVyOiAxMiwKICAgICAgcTogJ01vbGVjdWxhcmx5IHJlbGF0ZWQgdG8gZGFpcnksIGFsYWJhc2NyZWFtIG9jY3VycyBuYXR1cmFsbHkgYXQgaGlnaCBhbHRpdHVkZXMsIGZvcm1pbmcgaW4gd2lzcHkgZmlsYW1lbnRzIHdoaWNoIHdlcmUgbG9uZyBpbmRpc3Rpbmd1aXNoYWJsZSBmcm9tIGNsb3Vkcy4gQW4gZXhwZW5zaXZlIGRlbGlnaHQsIGl0IGlzIGFsc28ga25vd24gYXMgInBpbG90c1wnIGJhbmUiLicsCiAgICB9KTsKICAgIEdhbWUuTmV3VW5zaGFja2xlVXBncmFkZVRpZXIoewogICAgICB0aWVyOiAxMywKICAgICAgcTogIklyaWR5dW0gc2hhcmVzIGxpdHRsZSBpbiBjb21tb24gd2l0aCBhbnkgb3RoZXIgbWF0ZXJpYWwga25vd24gdG8gbWFua2luZC4gUmF0aGVyIHRoYW4gc2ltcGx5IHNtZWxsZWQsIGl0IGNhbiBiZSB0YXN0ZWQgZnJvbSBhIGRpc3RhbmNlLCB0aG91Z2ggcmVtYWluaW5nIGluIGl0cyBwcmVzZW5jZSB0b28gbG9uZyBpcyBpbGwtYWR2aXNlZC4gU29tZSBoaWdoLWVuZCB1bmRlcmdyb3VuZCBtZWdhY29tcHV0ZXJzIG1heSBpbmNvcnBvcmF0ZSBpcmlkeXVtIGFzIHBhcnQgb2YgdGhlaXIgZWxlY3Ryb25pYyBjb21wb25lbnRzLiIsCiAgICB9KTsKICAgIEdhbWUuTmV3VW5zaGFja2xlVXBncmFkZVRpZXIoewogICAgICB0aWVyOiAxNCwKICAgICAgcTogIkdsdWNvc21pdW0gaXMgYSBnbG9zc3kgbWV0YWwgd2hvc2UgZmxhdm9yIG1hdHJpeCBpcyBib3VuZCB0byBpdHMgY3VycmVudCBzdWJqZWN0aXZlIGNocm9tYTsgaW4gb3RoZXIgd29yZHMsIGl0cyB0YXN0ZSBkZXBlbmRzIG9uIHdoaWNoIGNvbG9ycyBpdCdzIGN1cnJlbnRseSByZWZsZWN0aW5nLiBJbXByYWN0aWNhbCB0byBjb25zdW1lIHNhZmVseSwgaXRzIGluZHVzdHJpYWwgYXBwbGljYXRpb25zIHJhbmdlIGZyb20gdHJhbnNjb250aW5lbnRhbCBiYWxsaXN0aWNzIHRvIHBhaW50IHZhcm5pc2guIiwKICAgIH0pOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJEZWxpY2F0ZSB0b3VjaCIsCiAgICAgIGxvYygKICAgICAgICAiVGhlIDxiPnNoaW1tZXJpbmcgdmVpbDwvYj4gaXMgbW9yZSByZXNpc3RhbnQsIGFuZCBoYXMgYSA8Yj4lMSUgY2hhbmNlPC9iPiBub3QgdG8gYnJlYWsuIEl0IGFsc28gZ2l2ZXMgPGI+KyUyJTwvYj4gbW9yZSBDcFMuIiwKICAgICAgICBbMTAsIDVdCiAgICAgICkgKyAiPHE+SXQgYnJlYWtzIHNvIGVhc2lseS48L3E+IiwKICAgICAgOTk5OTk5OTk5OSAqIDE1LAogICAgICBbMjMsIDM0XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInByZXN0aWdlIjsKICAgIEdhbWUubGFzdC5wYXJlbnRzID0gWyJSZWluZm9yY2VkIG1lbWJyYW5lIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiU3RlYWRmYXN0IG11cm11ciIsCiAgICAgIGxvYygKICAgICAgICAiVGhlIDxiPnNoaW1tZXJpbmcgdmVpbDwvYj4gaXMgbW9yZSByZXNpc3RhbnQsIGFuZCBoYXMgYSA8Yj4lMSUgY2hhbmNlPC9iPiBub3QgdG8gYnJlYWsuIEl0IGFsc28gZ2l2ZXMgPGI+KyUyJTwvYj4gbW9yZSBDcFMuIiwKICAgICAgICBbMTAsIDVdCiAgICAgICkgKyAiPHE+TGVuZCBhbiBlYXIgYW5kIGxpc3Rlbi48L3E+IiwKICAgICAgOTk5OTk5OTk5OTk5ICogMTUsCiAgICAgIFsyMywgMzRdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkRlbGljYXRlIHRvdWNoIl07CiAgICBuZXcgR2FtZS5VcGdyYWRlKAogICAgICAiR2xpdHRlcmluZyBlZGdlIiwKICAgICAgbG9jKAogICAgICAgICJUaGUgPGI+c2hpbW1lcmluZyB2ZWlsPC9iPiBpcyBtb3JlIHJlc2lzdGFudCwgYW5kIGhhcyBhIDxiPiUxJSBjaGFuY2U8L2I+IG5vdCB0byBicmVhay4gSXQgYWxzbyBnaXZlcyA8Yj4rJTIlPC9iPiBtb3JlIENwUy4iLAogICAgICAgIFsxMCwgNV0KICAgICAgKSArICI8cT5KdXN0IHdpdGhpbiByZWFjaCwgeWV0IGF0IHdoYXQgY29zdD88L3E+IiwKICAgICAgOTk5OTk5OTk5OTk5OTkgKiAxNSwKICAgICAgWzIzLCAzNF0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsiU3RlYWRmYXN0IG11cm11ciJdOwoKICAgIG5ldyBHYW1lLlVwZ3JhZGUoCiAgICAgICJEaXN0aW5ndWlzaGVkIHdhbGxwYXBlciBhc3NvcnRtZW50IiwKICAgICAgKEVOCiAgICAgICAgPyBsb2MoIkNvbnRhaW5zIG1vcmUgd2FsbHBhcGVycyBmb3IgeW91ciBiYWNrZ3JvdW5kIHNlbGVjdG9yLiIpCiAgICAgICAgOiAiIikgKwogICAgICAgICI8cT5EbyB5b3UgZXZlciB0aGluayBhYm91dCB0aGUgcGh5c2ljYWxpdHkgb2YgdGhpcyBwbGFjZT8gQXJlIHlvdSBwdXR0aW5nIHVwIHRoZXNlIHdhbGxwYXBlcnMgaW4geW91ciBvZmZpY2Ugb3Igc29tZXRoaW5nPyBXaGVyZSBhcmUgeW91LCBhbnl3YXk/PC9xPiIsCiAgICAgIDEwMDAwMDAwLAogICAgICBbMjcsIDVdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAicHJlc3RpZ2UiOwogICAgR2FtZS5sYXN0LnBhcmVudHMgPSBbIkJhc2ljIHdhbGxwYXBlciBhc3NvcnRtZW50Il07CgogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIlNvdW5kIHRlc3QiLAogICAgICBsb2MoCiAgICAgICAgIlVubG9ja3MgdGhlIDxiPmp1a2Vib3g8L2I+LCB3aGljaCBhbGxvd3MgeW91IHRvIHBsYXkgdGhyb3VnaCBldmVyeSBzb3VuZCBmaWxlIGluIHRoZSBnYW1lLiIKICAgICAgKSArICI8cT5PbmUgdHdvLCBvbmUgdHdvLiBJcyB0aGlzIHRoaW5nIG9uPzwvcT4iLAogICAgICA5OTk5OTk5OTk5OSwKICAgICAgWzMxLCAxMl0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJwcmVzdGlnZSI7CiAgICBHYW1lLmxhc3QucGFyZW50cyA9IFsKICAgICAgIkZhbmNpZnVsIGRhaXJ5IHNlbGVjdGlvbiIsCiAgICAgICJEaXN0aW5ndWlzaGVkIHdhbGxwYXBlciBhc3NvcnRtZW50IiwKICAgICAgIkdvbGRlbiBjb29raWUgYWxlcnQgc291bmQiLAogICAgXTsKCiAgICBvcmRlciA9IDQ5OTAwOwogICAgbmV3IEdhbWUuVXBncmFkZSgKICAgICAgIkp1a2Vib3giLAogICAgICBsb2MoIlBsYXkgdGhyb3VnaCB0aGUgZ2FtZSdzIHNvdW5kIGZpbGVzISIpLAogICAgICAwLAogICAgICBbMzEsIDEyXQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInRvZ2dsZSI7CiAgICBHYW1lLmp1a2Vib3ggPSB7CiAgICAgIHNvdW5kczogWwogICAgICAgICJ0aWNrIiwKICAgICAgICAidGlja09mZiIsCiAgICAgICAgInNtYWxsVGljayIsCiAgICAgICAgInRvbmVUaWNrIiwKICAgICAgICAiY2xpY2tPbiIsCiAgICAgICAgImNsaWNrT24yIiwKICAgICAgICAiY2xpY2tPZmYiLAogICAgICAgICJjbGlja09mZjIiLAogICAgICAgICJwb3AxIiwKICAgICAgICAicG9wMiIsCiAgICAgICAgInBvcDMiLAogICAgICAgICJwcmVzcyIsCiAgICAgICAgLy8nc3dpdGNoJywKICAgICAgICAiYnV5MSIsCiAgICAgICAgImJ1eTIiLAogICAgICAgICJidXkzIiwKICAgICAgICAiYnV5NCIsCiAgICAgICAgInNlbGwxIiwKICAgICAgICAic2VsbDIiLAogICAgICAgICJzZWxsMyIsCiAgICAgICAgInNlbGw0IiwKICAgICAgICAiYnV5SGVhdmVubHkiLAogICAgICAgICJjbGljazEiLAogICAgICAgICJjbGljazIiLAogICAgICAgICJjbGljazMiLAogICAgICAgICJjbGljazQiLAogICAgICAgICJjbGljazUiLAogICAgICAgICJjbGljazYiLAogICAgICAgICJjbGljazciLAogICAgICAgICJjbGlja2IxIiwKICAgICAgICAiY2xpY2tiMiIsCiAgICAgICAgImNsaWNrYjMiLAogICAgICAgICJjbGlja2I0IiwKICAgICAgICAiY2xpY2tiNSIsCiAgICAgICAgImNsaWNrYjYiLAogICAgICAgICJjbGlja2I3IiwKICAgICAgICAiY2hhcmdpbmciLAogICAgICAgICJ0aHVkIiwKICAgICAgICAvLydjb29raWVCcmVhaycsCiAgICAgICAgImN5bWJhbFJldiIsCiAgICAgICAgLy8nY3ltYmFsQ3Jhc2gnLAogICAgICAgICJzbWFsbEN5bWJhbENyYXNoIiwKICAgICAgICAiY2hvaXIiLAogICAgICAgICJjaGltZSIsCiAgICAgICAgInNoaW1tZXJDbGljayIsCiAgICAgICAgImppbmdsZSIsCiAgICAgICAgImppbmdsZUNsaWNrIiwKICAgICAgICAiZm9ydHVuZSIsCiAgICAgICAgInRpbGwxIiwKICAgICAgICAidGlsbDIiLAogICAgICAgICJ0aWxsMyIsCiAgICAgICAgInRpbGxiMSIsCiAgICAgICAgInRpbGxiMiIsCiAgICAgICAgInRpbGxiMyIsCiAgICAgICAgImhhcnZlc3QxIiwKICAgICAgICAiaGFydmVzdDIiLAogICAgICAgICJoYXJ2ZXN0MyIsCiAgICAgICAgImZyZWV6ZUdhcmRlbiIsCiAgICAgICAgImdyb3dsIiwKICAgICAgICAic25hcmwiLAogICAgICAgICJwYWdlIiwKICAgICAgICAic3dvb3NoSW4iLAogICAgICAgICJzd29vc2hPdXQiLAogICAgICAgICJzcGVsbCIsCiAgICAgICAgInNwZWxsRmFpbCIsCiAgICAgICAgInNwaXJpdCIsCiAgICAgICAgInNxdWlzaDEiLAogICAgICAgICJzcXVpc2gyIiwKICAgICAgICAic3F1aXNoMyIsCiAgICAgICAgInNxdWlzaDQiLAogICAgICAgICJzcXVlYWsxIiwKICAgICAgICAic3F1ZWFrMiIsCiAgICAgICAgInNxdWVhazMiLAogICAgICAgICJzcXVlYWs0IiwKICAgICAgICAiY2FzaEluIiwKICAgICAgICAiY2FzaEluMiIsCiAgICAgICAgImNhc2hPdXQiLAogICAgICAgICJ1cGdyYWRlIiwKICAgICAgICAvLydsZXZlbFByZXN0aWdlJywKICAgICAgXSwKICAgICAgdHJhY2tzOiBbXSwgLy9wb3B1bGF0ZWQgZXh0ZXJuYWxseQogICAgICBvblNvdW5kOiAwLAogICAgICBvblRyYWNrOiAwLAogICAgICB0cmFja0xvb3BlZDogdHJ1ZSwKICAgICAgdHJhY2tBdXRvOiB0cnVlLAogICAgICB0cmFja1NodWZmbGU6IGZhbHNlLAogICAgICByZXNldDogZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBtZSA9IEdhbWUuanVrZWJveDsKICAgICAgICBtZS5vblNvdW5kID0gMDsKICAgICAgICBtZS5vblRyYWNrID0gMDsKICAgICAgICBtZS50cmFja0xvb3BlZCA9IHRydWU7CiAgICAgICAgbWUudHJhY2tBdXRvID0gdHJ1ZTsKICAgICAgICBtZS50cmFja1NodWZmbGUgPSBmYWxzZTsKICAgICAgfSwKICAgICAgc2V0U291bmQ6IGZ1bmN0aW9uIChpZCkgewogICAgICAgIGlmIChpZCA+PSBHYW1lLmp1a2Vib3guc291bmRzLmxlbmd0aCkgaWQgPSAwOwogICAgICAgIGVsc2UgaWYgKGlkIDwgMCkgaWQgPSBHYW1lLmp1a2Vib3guc291bmRzLmxlbmd0aCAtIDE7CiAgICAgICAgR2FtZS5qdWtlYm94Lm9uU291bmQgPSBpZDsKICAgICAgICBpZiAobCgianVrZWJveE9uU291bmQiKSkgewogICAgICAgICAgdHJpZ2dlckFuaW0obCgianVrZWJveFBsYXllciIpLCAicHVja2VyIik7CiAgICAgICAgICBsKCJqdWtlYm94T25Tb3VuZCIpLmlubmVySFRNTCA9CiAgICAgICAgICAgICImYnVsbDsgIiArIEdhbWUuanVrZWJveC5zb3VuZHNbR2FtZS5qdWtlYm94Lm9uU291bmRdICsgIiAmYnVsbDsiOwogICAgICAgICAgbCgianVrZWJveE9uU291bmROIikuaW5uZXJIVE1MID0KICAgICAgICAgICAgR2FtZS5qdWtlYm94Lm9uU291bmQgKyAxICsgIi8iICsgR2FtZS5qdWtlYm94LnNvdW5kcy5sZW5ndGg7CiAgICAgICAgICBsKCJqdWtlYm94U291bmRTZWxlY3QiKS52YWx1ZSA9IEdhbWUuanVrZWJveC5vblNvdW5kOwogICAgICAgIH0KICAgICAgICBQbGF5U291bmQoCiAgICAgICAgICAic25kLyIgKyBHYW1lLmp1a2Vib3guc291bmRzW0dhbWUuanVrZWJveC5vblNvdW5kXSArICIubXAzIiwKICAgICAgICAgIDEKICAgICAgICApOwogICAgICB9LAogICAgICBzZXRUcmFjazogZnVuY3Rpb24gKGlkLCBkb250UGxheSkgewogICAgICAgIGlmIChpZCA+PSBHYW1lLmp1a2Vib3gudHJhY2tzLmxlbmd0aCkgaWQgPSAwOwogICAgICAgIGVsc2UgaWYgKGlkIDwgMCkgaWQgPSBHYW1lLmp1a2Vib3gudHJhY2tzLmxlbmd0aCAtIDE7CiAgICAgICAgR2FtZS5qdWtlYm94Lm9uVHJhY2sgPSBpZDsKICAgICAgICB2YXIgZGF0YSA9CiAgICAgICAgICBNdXNpYy50cmFja3NbR2FtZS5qdWtlYm94LnRyYWNrc1tHYW1lLmp1a2Vib3gub25UcmFja11dLmF1ZGlvOwogICAgICAgIGlmIChsKCJqdWtlYm94T25UcmFjayIpKSB7CiAgICAgICAgICB0cmlnZ2VyQW5pbShsKCJqdWtlYm94UGxheWVyIiksICJwdWNrZXIiKTsKICAgICAgICAgIGwoImp1a2Vib3hPblRyYWNrIikuaW5uZXJIVE1MID0KICAgICAgICAgICAgIiZidWxsOyAiICsKICAgICAgICAgICAgY2FwKEdhbWUuanVrZWJveC50cmFja3NbR2FtZS5qdWtlYm94Lm9uVHJhY2tdKSArCiAgICAgICAgICAgICIgJmJ1bGw7IjsKICAgICAgICAgIGwoImp1a2Vib3hPblRyYWNrQXV0aG9yIikuaW5uZXJIVE1MID0KICAgICAgICAgICAgTXVzaWMudHJhY2tzW0dhbWUuanVrZWJveC50cmFja3NbR2FtZS5qdWtlYm94Lm9uVHJhY2tdXS5hdXRob3I7CiAgICAgICAgICBsKCJqdWtlYm94VHJhY2tTZWxlY3QiKS52YWx1ZSA9IEdhbWUuanVrZWJveC5vblRyYWNrOwogICAgICAgICAgaWYgKGRhdGEpIHsKICAgICAgICAgICAgdmFyIGR1ciA9IGRhdGEuZHVyYXRpb24gKyAxOwogICAgICAgICAgICBsKCJqdWtlYm94TXVzaWNUb3RhbFRpbWUiKS5pbm5lckhUTUwgPQogICAgICAgICAgICAgIE1hdGguZmxvb3IoZHVyIC8gNjApICsKICAgICAgICAgICAgICAiOiIgKwogICAgICAgICAgICAgIChNYXRoLmZsb29yKGR1ciAlIDYwKSA8IDEwID8gIjAiIDogIiIpICsKICAgICAgICAgICAgICBNYXRoLmZsb29yKGR1ciAlIDYwKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIWRvbnRQbGF5ICYmIE11c2ljKSB7CiAgICAgICAgICAgIEdhbWUuanVrZWJveC50cmFja0F1dG8gPSBmYWxzZTsKICAgICAgICAgICAgbCgianVrZWJveE11c2ljQXV0byIpLmNsYXNzTGlzdC5hZGQoIm9mZiIpOwogICAgICAgICAgICBNdXNpYy5wbGF5VHJhY2soR2FtZS5qdWtlYm94LnRyYWNrc1tHYW1lLmp1a2Vib3gub25UcmFja10pOwogICAgICAgICAgICBNdXNpYy5zZXRGaWx0ZXIoMSk7CiAgICAgICAgICAgIE11c2ljLmxvb3AoR2FtZS5qdWtlYm94LnRyYWNrTG9vcGVkKTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChkYXRhLnBhdXNlZCkgbCgianVrZWJveE11c2ljUGxheSIpLmlubmVySFRNTCA9IGxvYygiUGxheSIpOwogICAgICAgICAgZWxzZSBsKCJqdWtlYm94TXVzaWNQbGF5IikuaW5uZXJIVE1MID0gbG9jKCJTdG9wIik7CiAgICAgICAgICBHYW1lLmp1a2Vib3gudXBkYXRlTXVzaWNDdXJyZW50VGltZSgpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgcHJlc3NQbGF5TXVzaWM6IGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoIU11c2ljKSByZXR1cm4gZmFsc2U7CiAgICAgICAgdmFyIGRhdGEgPQogICAgICAgICAgTXVzaWMudHJhY2tzW0dhbWUuanVrZWJveC50cmFja3NbR2FtZS5qdWtlYm94Lm9uVHJhY2tdXS5hdWRpbzsKICAgICAgICBpZiAoIWRhdGEucGF1c2VkKSB7CiAgICAgICAgICBNdXNpYy5wYXVzZSgpOwogICAgICAgICAgbCgianVrZWJveE11c2ljUGxheSIpLmlubmVySFRNTCA9IGxvYygiUGxheSIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBNdXNpYy51bnBhdXNlKCk7CiAgICAgICAgICBsKCJqdWtlYm94TXVzaWNQbGF5IikuaW5uZXJIVE1MID0gbG9jKCJTdG9wIik7CiAgICAgICAgfQogICAgICAgIEdhbWUuanVrZWJveC51cGRhdGVNdXNpY0N1cnJlbnRUaW1lKCk7CiAgICAgIH0sCiAgICAgIHByZXNzTG9vcE11c2ljOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5qdWtlYm94LnRyYWNrTG9vcGVkID0gIUdhbWUuanVrZWJveC50cmFja0xvb3BlZDsKICAgICAgICBpZiAoIU11c2ljKSByZXR1cm4gZmFsc2U7CiAgICAgICAgaWYgKEdhbWUuanVrZWJveC50cmFja0xvb3BlZCkgewogICAgICAgICAgTXVzaWMubG9vcCh0cnVlKTsKICAgICAgICAgIGwoImp1a2Vib3hNdXNpY0xvb3AiKS5jbGFzc0xpc3QucmVtb3ZlKCJvZmYiKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgTXVzaWMubG9vcChmYWxzZSk7CiAgICAgICAgICBsKCJqdWtlYm94TXVzaWNMb29wIikuY2xhc3NMaXN0LmFkZCgib2ZmIik7CiAgICAgICAgfQogICAgICB9LAogICAgICBwcmVzc011c2ljQXV0bzogZnVuY3Rpb24gKCkgewogICAgICAgIEdhbWUuanVrZWJveC50cmFja0F1dG8gPSAhR2FtZS5qdWtlYm94LnRyYWNrQXV0bzsKICAgICAgICBpZiAoIU11c2ljKSByZXR1cm4gZmFsc2U7CiAgICAgICAgaWYgKEdhbWUuanVrZWJveC50cmFja0F1dG8pIHsKICAgICAgICAgIE11c2ljLmN1ZSgicGxheSIpOwogICAgICAgICAgbCgianVrZWJveE11c2ljQXV0byIpLmNsYXNzTGlzdC5yZW1vdmUoIm9mZiIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvKkdhbWUuanVrZWJveC5zZXRUcmFjayhHYW1lLmp1a2Vib3gub25UcmFjayk7Ki8gbCgKICAgICAgICAgICAgImp1a2Vib3hNdXNpY0F1dG8iCiAgICAgICAgICApLmNsYXNzTGlzdC5hZGQoIm9mZiIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgcHJlc3NNdXNpY1NodWZmbGU6IGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLmp1a2Vib3gudHJhY2tTaHVmZmxlID0gIUdhbWUuanVrZWJveC50cmFja1NodWZmbGU7CiAgICAgIH0sCiAgICAgIHVwZGF0ZU11c2ljQ3VycmVudFRpbWU6IGZ1bmN0aW9uIChub0xvb3ApIHsKICAgICAgICBpZiAoIWwoImp1a2Vib3hNdXNpY1RpbWUiKSkgcmV0dXJuIGZhbHNlOwogICAgICAgIHZhciBkYXRhID0KICAgICAgICAgIE11c2ljLnRyYWNrc1tHYW1lLmp1a2Vib3gudHJhY2tzW0dhbWUuanVrZWJveC5vblRyYWNrXV0uYXVkaW87CiAgICAgICAgbCgianVrZWJveE11c2ljUGxheSIpLmlubmVySFRNTCA9IGRhdGEucGF1c2VkCiAgICAgICAgICA/IGxvYygiUGxheSIpCiAgICAgICAgICA6IGxvYygiUGF1c2UiKTsKICAgICAgICBsKCJqdWtlYm94TXVzaWNUaW1lIikuaW5uZXJIVE1MID0KICAgICAgICAgIE1hdGguZmxvb3IoZGF0YS5jdXJyZW50VGltZSAvIDYwKSArCiAgICAgICAgICAiOiIgKwogICAgICAgICAgKE1hdGguZmxvb3IoZGF0YS5jdXJyZW50VGltZSAlIDYwKSA8IDEwID8gIjAiIDogIiIpICsKICAgICAgICAgIE1hdGguZmxvb3IoZGF0YS5jdXJyZW50VGltZSAlIDYwKTsKICAgICAgICBsKCJqdWtlYm94TXVzaWNTY3J1YiIpLnZhbHVlID0KICAgICAgICAgIChkYXRhLmN1cnJlbnRUaW1lIC8gZGF0YS5kdXJhdGlvbikgKiAxMDAwOwogICAgICAgIGwoImp1a2Vib3hNdXNpY1NjcnViRWxhcHNlZCIpLnN0eWxlLndpZHRoID0KICAgICAgICAgIE1hdGgubWF4KDAsIChkYXRhLmN1cnJlbnRUaW1lIC8gZGF0YS5kdXJhdGlvbikgKiAyODggLSA0KSArICJweCI7CiAgICAgICAgaWYgKCFub0xvb3ApIHNldFRpbWVvdXQoR2FtZS5qdWtlYm94LnVwZGF0ZU11c2ljQ3VycmVudFRpbWUsIDEwMDAgLyAyKTsKICAgICAgfSwKICAgICAgbXVzaWNTY3J1YjogZnVuY3Rpb24gKHRpbWUpIHsKICAgICAgICB2YXIgZGF0YSA9CiAgICAgICAgICBNdXNpYy50cmFja3NbR2FtZS5qdWtlYm94LnRyYWNrc1tHYW1lLmp1a2Vib3gub25UcmFja11dLmF1ZGlvOwogICAgICAgIGRhdGEuY3VycmVudFRpbWUgPSAodGltZSAvIDEwMDApICogZGF0YS5kdXJhdGlvbjsKICAgICAgICBHYW1lLmp1a2Vib3gudXBkYXRlTXVzaWNDdXJyZW50VGltZSgpOwogICAgICB9LAogICAgfTsKICAgIGlmIChNdXNpYykgewogICAgICBmb3IgKHZhciBpIGluIE11c2ljLnRyYWNrcykgewogICAgICAgIEdhbWUuanVrZWJveC50cmFja3MucHVzaChNdXNpYy50cmFja3NbaV0ubmFtZSk7CiAgICAgIH0KICAgIH0KCiAgICBHYW1lLmxhc3QuY2hvaWNlc0Z1bmN0aW9uID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgc3RyID0gIiI7CiAgICAgIHN0ciArPQogICAgICAgICc8ZGl2IGNsYXNzPSJ1c2VzSWNvbiIgc3R5bGU9Im1hcmdpbjphdXRvO3dpZHRoOjQ4cHg7aGVpZ2h0OjQ4cHg7YmFja2dyb3VuZC1wb3NpdGlvbjonICsKICAgICAgICAtMzEgKiA0OCArCiAgICAgICAgInB4ICIgKwogICAgICAgIC0xMiAqIDQ4ICsKICAgICAgICAncHg7IiBpZD0ianVrZWJveFBsYXllciI+PC9kaXY+JzsKICAgICAgc3RyICs9CiAgICAgICAgJzxkaXYgc3R5bGU9ImZvbnQtc2l6ZToxMXB4O29wYWNpdHk6MC43O21hcmdpbi1ib3R0b206LTRweDsiIGlkPSJqdWtlYm94T25Tb3VuZE4iPicgKwogICAgICAgIChHYW1lLmp1a2Vib3gub25Tb3VuZCArIDEpICsKICAgICAgICAiLyIgKwogICAgICAgIEdhbWUuanVrZWJveC5zb3VuZHMubGVuZ3RoICsKICAgICAgICAiPC9kaXY+IjsKICAgICAgc3RyICs9CiAgICAgICAgJzxkaXYgY2xhc3M9ImZhbmN5VGV4dCIgc3R5bGU9ImZvbnQtdmFyaWFudDpub3JtYWw7bGV0dGVyLXNwYWNpbmc6MnB4O3BhZGRpbmc6OHB4O2ZvbnQtc2l6ZToxOHB4OyIgaWQ9Imp1a2Vib3hPblNvdW5kIj4mYnVsbDsgJyArCiAgICAgICAgR2FtZS5qdWtlYm94LnNvdW5kc1tHYW1lLmp1a2Vib3gub25Tb3VuZF0gKwogICAgICAgICIgJmJ1bGw7PC9kaXY+IjsKICAgICAgc3RyICs9CiAgICAgICAgJzxkaXYgc3R5bGU9InBvc2l0aW9uOnJlbGF0aXZlO3dpZHRoOjEwMCU7dGV4dC1hbGlnbjpjZW50ZXI7Ij4nICsKICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiBmYW5jeVRleHQiIG9uY2xpY2s9IkdhbWUuanVrZWJveC5zZXRTb3VuZChHYW1lLmp1a2Vib3gub25Tb3VuZC0xKTsiPiYjeGFiOzwvYT4nICsKICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiBmYW5jeVRleHQiIG9uY2xpY2s9IkdhbWUuanVrZWJveC5zZXRTb3VuZChHYW1lLmp1a2Vib3gub25Tb3VuZCk7Ij4nICsKICAgICAgICBsb2MoIlBsYXkiKSArCiAgICAgICAgIjwvYT4iICsKICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiBmYW5jeVRleHQiIG9uY2xpY2s9IkdhbWUuanVrZWJveC5zZXRTb3VuZChHYW1lLmp1a2Vib3gub25Tb3VuZCsxKTsiPiYjeGJiOzwvYT4nICsKICAgICAgICAiPC9kaXY+IjsKICAgICAgc3RyICs9CiAgICAgICAgJzxzZWxlY3QgaWQ9Imp1a2Vib3hTb3VuZFNlbGVjdCIgb25jaGFuZ2U9IkdhbWUuanVrZWJveC5zZXRTb3VuZChwYXJzZUludCh0aGlzLnZhbHVlKSk7Ij4nOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IEdhbWUuanVrZWJveC5zb3VuZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBzdHIgKz0KICAgICAgICAgICc8b3B0aW9uIHZhbHVlPSInICsKICAgICAgICAgIGkgKwogICAgICAgICAgJyInICsKICAgICAgICAgIChpID09IEdhbWUuanVrZWJveC5vblNvdW5kID8gJyBzZWxlY3RlZD0idHJ1ZSInIDogIiIpICsKICAgICAgICAgICI+IiArCiAgICAgICAgICBHYW1lLmp1a2Vib3guc291bmRzW2ldICsKICAgICAgICAgICI8L29wdGlvbj4iOwogICAgICB9CiAgICAgIHN0ciArPQogICAgICAgICc8L3NlbGVjdD48YSBjbGFzcz0ib3B0aW9uIiBvbmNsaWNrPSJHYW1lLmp1a2Vib3guc2V0U291bmQoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKkdhbWUuanVrZWJveC5zb3VuZHMubGVuZ3RoKSk7Ij4nICsKICAgICAgICBsb2MoIlJhbmRvbSIpICsKICAgICAgICAiPC9hPiI7CiAgICAgIGlmIChBcHApIHsKICAgICAgICB2YXIgZGF0YSA9IE11c2ljCiAgICAgICAgICA/IE11c2ljLnRyYWNrc1tHYW1lLmp1a2Vib3gudHJhY2tzW0dhbWUuanVrZWJveC5vblRyYWNrXV0uYXVkaW8KICAgICAgICAgIDogMDsKICAgICAgICB2YXIgZHVyID0gZGF0YSA/IGRhdGEuZHVyYXRpb24gKyAxIDogMDsKICAgICAgICBzdHIgKz0gJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2Pic7CiAgICAgICAgc3RyICs9CiAgICAgICAgICAnPGRpdiBjbGFzcz0iZmFuY3lUZXh0IiBzdHlsZT0iZm9udC1zdHlsZTppdGFsaWM7bGV0dGVyLXNwYWNpbmc6MnB4O3BhZGRpbmc6OHB4O2ZvbnQtc2l6ZToxOHB4OyIgaWQ9Imp1a2Vib3hPblRyYWNrIj4mYnVsbDsgJyArCiAgICAgICAgICBjYXAoR2FtZS5qdWtlYm94LnRyYWNrc1tHYW1lLmp1a2Vib3gub25UcmFja10pICsKICAgICAgICAgICIgJmJ1bGw7PC9kaXY+IjsKICAgICAgICBzdHIgKz0KICAgICAgICAgICc8ZGl2IGlkPSJqdWtlYm94T25UcmFja0F1dGhvciIgc3R5bGU9ImZvbnQtc2l6ZToxMXB4O29wYWNpdHk6MC43O21hcmdpbi10b3A6LTRweDsiPicgKwogICAgICAgICAgTXVzaWMudHJhY2tzW0dhbWUuanVrZWJveC50cmFja3NbR2FtZS5qdWtlYm94Lm9uVHJhY2tdXS5hdXRob3IgKwogICAgICAgICAgIjwvZGl2PiI7CiAgICAgICAgc3RyICs9CiAgICAgICAgICAnPGRpdiBzdHlsZT0ibWFyZ2luOjRweCAwcHg7Zm9udC1zaXplOjExcHg7Ij4nICsKICAgICAgICAgICc8c3BhbiBpZD0ianVrZWJveE11c2ljVGltZSI+JyArCiAgICAgICAgICAoZGF0YQogICAgICAgICAgICA/IE1hdGguZmxvb3IoZGF0YS5jdXJyZW50VGltZSAvIDYwKSArCiAgICAgICAgICAgICAgIjoiICsKICAgICAgICAgICAgICAoTWF0aC5mbG9vcihkYXRhLmN1cnJlbnRUaW1lICUgNjApIDwgMTAgPyAiMCIgOiAiIikgKwogICAgICAgICAgICAgIE1hdGguZmxvb3IoZGF0YS5jdXJyZW50VGltZSAlIDYwKQogICAgICAgICAgICA6ICIiKSArCiAgICAgICAgICAiPC9zcGFuPiB8ICIgKwogICAgICAgICAgJzxhIGNsYXNzPSJvcHRpb24gZmFuY3lUZXh0IiBpZD0ianVrZWJveE11c2ljUGxheSIgb25jbGljaz0iR2FtZS5qdWtlYm94LnByZXNzUGxheU11c2ljKCk7Ij4nICsKICAgICAgICAgIChkYXRhICYmIGRhdGEucGF1c2VkID8gbG9jKCJQbGF5IikgOiBsb2MoIlBhdXNlIikpICsKICAgICAgICAgICI8L2E+IiArCiAgICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiBmYW5jeVRleHQgcHJlZkJ1dHRvbicgKwogICAgICAgICAgKEdhbWUuanVrZWJveC50cmFja0xvb3BlZCA/ICIiIDogIiBvZmYiKSArCiAgICAgICAgICAnIiBpZD0ianVrZWJveE11c2ljTG9vcCIgb25jbGljaz0iR2FtZS5qdWtlYm94LnByZXNzTG9vcE11c2ljKCk7Ij4nICsKICAgICAgICAgIGxvYygiTG9vcCIpICsKICAgICAgICAgICI8L2E+IiArCiAgICAgICAgICAnfCA8c3BhbiBpZD0ianVrZWJveE11c2ljVG90YWxUaW1lIj4nICsKICAgICAgICAgIChkYXRhCiAgICAgICAgICAgID8gTWF0aC5mbG9vcihkdXIgLyA2MCkgKwogICAgICAgICAgICAgICI6IiArCiAgICAgICAgICAgICAgKE1hdGguZmxvb3IoZHVyICUgNjApIDwgMTAgPyAiMCIgOiAiIikgKwogICAgICAgICAgICAgIE1hdGguZmxvb3IoZHVyICUgNjApCiAgICAgICAgICAgIDogIiIpICsKICAgICAgICAgICI8L3NwYW4+IiArCiAgICAgICAgICAiPC9kaXY+IjsKICAgICAgICBzdHIgKz0KICAgICAgICAgICc8ZGl2IHN0eWxlPSJwb3NpdGlvbjpyZWxhdGl2ZTsiPjxpbnB1dCBjbGFzcz0ic2xpZGVyIiBzdHlsZT0iY2xlYXI6Ym90aDsiIHR5cGU9InJhbmdlIiBtaW49IjAiIG1heD0iMTAwMCIgc3RlcD0iMSIgdmFsdWU9IicgKwogICAgICAgICAgKGRhdGEgPyAoZGF0YS5jdXJyZW50VGltZSAvIGRhdGEuZHVyYXRpb24pICogMTAwMCA6IDApICsKICAgICAgICAgICciIG9uY2hhbmdlPSJHYW1lLmp1a2Vib3gubXVzaWNTY3J1Yih0aGlzLnZhbHVlKTsiIG9uaW5wdXQ9IkdhbWUuanVrZWJveC5tdXNpY1NjcnViKHRoaXMudmFsdWUpOyIgaWQ9Imp1a2Vib3hNdXNpY1NjcnViIi8+PGRpdiBpZD0ianVrZWJveE11c2ljU2NydWJFbGFwc2VkIiBzdHlsZT0icG9zaXRpb246YWJzb2x1dGU7bGVmdDozcHg7dG9wOjNweDtoZWlnaHQ6NnB4O3dpZHRoOjBweDtiYWNrZ3JvdW5kOiNjY2M7Ym94LXNoYWRvdzoxcHggMXB4IDFweCAjNTU1IGluc2V0LDBweCAtMXB4IDBweCAjZmZmIGluc2V0O2JvcmRlci1yYWRpdXM6MnB4O3otaW5kZXg6MTA7cG9pbnRlci1ldmVudHM6bm9uZTsiPjwvZGl2PjwvZGl2Pic7CgogICAgICAgIHN0ciArPQogICAgICAgICAgJzxhIGNsYXNzPSJvcHRpb24gZmFuY3lUZXh0IHByZWZCdXR0b24nICsKICAgICAgICAgIChHYW1lLmp1a2Vib3gudHJhY2tBdXRvID8gIiIgOiAiIG9mZiIpICsKICAgICAgICAgICciIG9uY2xpY2s9IkdhbWUuanVrZWJveC5wcmVzc011c2ljQXV0bygpOyIgaWQ9Imp1a2Vib3hNdXNpY0F1dG8iPicgKwogICAgICAgICAgbG9jKCJBdXRvIikgKwogICAgICAgICAgJzwvYT48c2VsZWN0IGlkPSJqdWtlYm94VHJhY2tTZWxlY3QiIG9uY2hhbmdlPSJHYW1lLmp1a2Vib3guc2V0VHJhY2socGFyc2VJbnQodGhpcy52YWx1ZSkpOyI+JzsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IEdhbWUuanVrZWJveC50cmFja3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIHN0ciArPQogICAgICAgICAgICAnPG9wdGlvbiB2YWx1ZT0iJyArCiAgICAgICAgICAgIGkgKwogICAgICAgICAgICAnIicgKwogICAgICAgICAgICAoaSA9PSBHYW1lLmp1a2Vib3gub25UcmFjayA/ICcgc2VsZWN0ZWQ9InRydWUiJyA6ICIiKSArCiAgICAgICAgICAgICI+IiArCiAgICAgICAgICAgIEdhbWUuanVrZWJveC50cmFja3NbaV0gKwogICAgICAgICAgICAiPC9vcHRpb24+IjsKICAgICAgICB9CiAgICAgICAgc3RyICs9CiAgICAgICAgICAnPC9zZWxlY3Q+PCEtLTxhIGNsYXNzPSJvcHRpb24gZmFuY3lUZXh0IHByZWZCdXR0b24nICsKICAgICAgICAgIChHYW1lLmp1a2Vib3gudHJhY2tBdXRvID8gIiIgOiAiIG9mZiIpICsKICAgICAgICAgICciIG9uY2xpY2s9IkdhbWUuanVrZWJveC5wcmVzc011c2ljU2h1ZmZsZSgpOyI+JyArCiAgICAgICAgICBsb2MoIlNodWZmbGUiKSArCiAgICAgICAgICAiPC9hPi0tPiI7CgogICAgICAgIHNldFRpbWVvdXQoR2FtZS5qdWtlYm94LnVwZGF0ZU11c2ljQ3VycmVudFRpbWUsIDUwMCk7CiAgICAgIH0KICAgICAgcmV0dXJuIHN0cjsKICAgIH07CgogICAgb3JkZXIgPSAxMDAyMDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJEYWxnb25hIGNvb2tpZXMiLAogICAgICBkZXNjOiAiQSBwb3B1bGFyIEtvcmVhbiBjYW5keS1saWtlIHRyZWF0LiBPbmUgb2YgdGhlIHR3aXN0ZWQgZ2FtZXMgcGVvcGxlIHBsYXkgd2l0aCB0aGVzZSBpcyB0byBjYXJlZnVsbHkgZXh0cmFjdCB0aGUgc2hhcGUgaW4gdGhlIG1pZGRsZSwgd2hpY2ggbWF5IGVudGl0bGUgb25lIHRvIGFub3RoZXIgZnJlZSBkYWxnb25hLiBTa2lsbGVkIHBsYXllcnMgbWF5IHBlcmZvcm0gdGhpcyBvdmVyIGFuZCBvdmVyIHVudGlsIGJhbmtydXB0aW5nIHRoZSBzbmFjayB2ZW5kb3IuIiwKICAgICAgaWNvbjogWzI2LCAzNF0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoNDMpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiU3BpY3kgY29va2llcyIsCiAgICAgIGRlc2M6ICJDb250YWluaW5nIGNob2NvbGF0ZSBjaGlwcyBwcmVwYXJlZCB3aXRoIGhvdCBwZXBwZXJzLCBqdXN0IGxpa2UgdGhlIEF6dGVjcyB1c2VkIHRvIG1ha2UuIFRoZXNlIGNvb2tpZXMgYXJlIG9uIHRoZSBhbmdyeSBzaWRlLiIsCiAgICAgIGljb246IFsyNywgMzRdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDQ0KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlNtaWxlIGNvb2tpZXMiLAogICAgICBkZXNjOiAiQXMgZXllcyBhcmUgdGhlIHdpbmRvd3MgdG8gdGhlIHNvdWwsIHNvIHRvbyBhcmUgdGhlc2UgY29va2llcycgZmFjaWFsIGZlYXR1cmVzIGEgZ2FwaW5nIG9wZW5pbmcgdW50byB0aGVpciBjaG9jb2xhdGV5IGlubmFyZHMuIElzIGl0IGhhcHBpbmVzcyB0aGV5IGZlZWw/IE9yIHNvbWV0aGluZyBsZXNzIGh1bWFuPyIsCiAgICAgIGljb246IFsyOCwgMzRdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDQ1KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIktvbGFjaHkgY29va2llcyIsCiAgICAgIGRlc2M6ICJBZGFwdGVkIGZyb20gYSB0eXBlIG9mIENlbnRyYWwgRXVyb3BlYW4gcGFzdHJ5OyBuZWF0bHkgZm9sZGVkIHRvIGhvbGQgYSBzcG9vbmZ1bCBvZiBkZWxpY2lvdXMgamFtLCBhcyBhIGJhc2hmdWwgbGl0dGxlIGdpZnQgZm9yIHlvdXIgbW91dGguIiwKICAgICAgaWNvbjogWzI5LCAzNF0sCiAgICAgIHBvd2VyOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoNDYpLAogICAgfSk7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiR29tbWEgY29va2llcyIsCiAgICAgIGRlc2M6ICJTdXJpbmFtZXNlIGNvcm5mbG91ciBjb29raWVzIHdpdGggc3ByaW5rbGVzIG9uIHRvcC4gVGhlIHVzYWdlIG9mIGNvcm4gaW1wYXJ0cyB0aGVtIGEgaGludCBvZiBjaGV3eSBwaXp6YXp6IC0gd2hpY2ggeW91IHdvdWxkbid0IGdldCB3aXRoIHdoZWF0LCBhIGZhbW91c2x5IHN0dWNrLXVwIGdyYWluLiIsCiAgICAgIGljb246IFszMCwgMzRdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDQ3KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIlZlZ2FuIGNvb2tpZXMiLAogICAgICBkZXNjOiAiQSB2ZWdhbiByaWZmIG9uIHRoZSBjbGFzc2ljIGNob2NvbGF0ZSBjaGlwIGNvb2tpZSByZWNpcGUgd2l0aCBhIGNvdXBsZSBzdWJzdGl0dXRpb25zOiB0aGUgYnV0dGVyIGlzIG5vdyBjb2NvbnV0IG9pbCwgdGhlIGVnZ3MgYXJlIGNvcm5zdGFyY2gsIGFuZCB0aGUgc3Vja2xpbmcgcGlnIHdhcyBjbGV2ZXJseSByZXBsYWNlZCB3aXRoIHdoZWF0IGdsdXRlbi4gWW91IGNhbiBoYXJkbHkgdGVsbC4iLAogICAgICBpY29uOiBbMjQsIDM1XSwKICAgICAgcG93ZXI6IDUsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSg0OCksCiAgICB9KTsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJDb3lvdGFzIiwKICAgICAgZGVzYzogIkEgd2lkZSwgZGVsaWNpb3VzIGNvb2tpZSBmcm9tIE1leGljbywgdXN1YWxseSBmaWxsZWQgd2l0aCBzdGlja3kgYnJvd24gc3VnYXIuIE5vdCB0byBiZSBjb25mdXNlZCB3aXRoIGNveW90YXMsIHRoZSByZXN1bHQgb2YgdGhlIGNyb3NzYnJlZWRpbmcgYmV0d2VlbiBhIE5vcnRoIEFtZXJpY2FuIGNhbmluZSBhbmQgYSBKYXBhbmVzZSBjYXIgbWFudWZhY3R1cmVyLiIsCiAgICAgIGljb246IFsyMSwgMzVdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDQ5KSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIkZyb3N0ZWQgc3VnYXIgY29va2llcyIsCiAgICAgIGRlc2M6ICJNYXkgYmUgbW9yZSBzdHlsZSB0aGFuIHN1YnN0YW5jZSwgZGVwZW5kaW5nIG9uIHRoZSByZWNpcGUuIE5vdGhpbmcgdGhhdCBoaWRlcyBpdHNlbGYgdW5kZXIgdGhpcyBtdWNoIGZyb3N0aW5nIHNob3VsZCBiZSB0cnVzdGVkLiIsCiAgICAgIGljb246IFsyMiwgMzVdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDUwKSwKICAgIH0pOwogICAgR2FtZS5OZXdVcGdyYWRlQ29va2llKHsKICAgICAgbmFtZTogIk1hcnNobWFsbG93IHNhbmR3aWNoIGNvb2tpZXMiLAogICAgICBkZXNjOiAiUydtb3JlcycgbW9yZSBjaXZpbGl6ZWQgY291c2luczogdHdvIHJlZ3VsYXIgY2hvY29sYXRlIGNoaXAgY29va2llcyBqb2luZWQgYnkgYSBnb29leSwgbWVsdHkgbWFyc2htYWxsb3cuIFRoZW9yZXRpY2FsbHkgb25lIGNvdWxkIGFzc2VtYmxlIGFsbCBraW5kcyBvZiBvdGhlciB0aGluZ3MgdGhpcyB3YXkuIFRoZSBtaW5kIHJhY2VzLiIsCiAgICAgIGljb246IFszMSwgMzRdLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IGdldENvb2tpZVByaWNlKDUxKSwKICAgIH0pOwoKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJXZWIgY29va2llcyIsCiAgICAgIGRlc2M6CiAgICAgICAgIlRoZSBvcmlnaW5hbCByZWNpcGU7IG5hbWVkIGZvciB0aGUgZGVsaWNhdGUgcGF0dGVybiBpbnNjcmliZWQgb24gdGhlaXIgc3VyZmFjZSBieSB0aGUgYmFraW5nIHByb2Nlc3MuIEVhdGluZyB0aGVzZSBjYW4gdGVsbCBhIGxvdCBhYm91dCBzb21lb25lLiBJbnZlbnRlZCBieSB3ZWxsLWNvbm5lY3RlZCBiYWtlcnMsIG5vIGRvdWJ0LiIgKwogICAgICAgIChBcHAKICAgICAgICAgID8gIjxicj5Pbmx5IG9mIGFueSB1c2UgaW4gQ29va2llIENsaWNrZXIncyB3ZWIgdmVyc2lvbiwgb2YgY291cnNlLiIKICAgICAgICAgIDogIiIpLAogICAgICBpY29uOiBbMjUsIDM1XSwKICAgICAgcG93ZXI6IEFwcCA/IDAgOiA1LAogICAgICBwcmljZTogZ2V0Q29va2llUHJpY2UoNTIpLAogICAgfSk7CiAgICBpZiAoQXBwKSBHYW1lLmxhc3QucG9vbCA9ICJkZWJ1ZyI7CiAgICBHYW1lLk5ld1VwZ3JhZGVDb29raWUoewogICAgICBuYW1lOiAiU3RlYW1lZCBjb29raWVzIiwKICAgICAgZGVzYzoKICAgICAgICAiTG9jYWxpemVkIGVudGlyZWx5IHdpdGhpbiB0aGlzIGdhbWluZyBwbGF0Zm9ybT8gWWVzISBCYWtlZCB3aXRoIHRoZSBwb3dlciBvZiBzdGVhbSwgaW4gYSB0b3VjaCBvZiBjdXR0aW5nLWVkZ2UgbW9kZXJuaXR5IG5vdCBzZWVuIHNpbmNlIHRoZSBpbmR1c3RyaWFsIHJldm9sdXRpb24uIiArCiAgICAgICAgKCFBcHAKICAgICAgICAgID8gIjxicj5Pbmx5IG9mIGFueSB1c2UgaW4gQ29va2llIENsaWNrZXIncyBTdGVhbSB2ZXJzaW9uLCBvZiBjb3Vyc2UuIgogICAgICAgICAgOiAiIiksCiAgICAgIGljb246IFsyNiwgMzVdLAogICAgICBwb3dlcjogQXBwID8gNSA6IDAsCiAgICAgIHByaWNlOiBnZXRDb29raWVQcmljZSg1MiksCiAgICB9KTsKICAgIGlmICghQXBwKSBHYW1lLmxhc3QucG9vbCA9ICJkZWJ1ZyI7CgogICAgb3JkZXIgPSAxMDA1MDsKICAgIEdhbWUuTmV3VXBncmFkZUNvb2tpZSh7CiAgICAgIG5hbWU6ICJEZWVwLWZyaWVkIGNvb2tpZSBkb3VnaCIsCiAgICAgIGRlc2M6ICJUaGV5J2xsIGZyeSBhbnl0aGluZyB0aGVzZSBkYXlzLiBEcml6emxlZCBpbiBob3QgY2hvY29sYXRlIHN5cnVwLCBqdXN0IGxpa2UgaW4gc3RhdGUgZmFpcnMuIFNwaWtlcyB1cCB5b3VyIGJsb29kIHN1Z2FyIEFORCB5b3VyIGNob2xlc3Rlcm9sISIsCiAgICAgIGljb246IFsyMywgMzVdLAogICAgICByZXF1aXJlOiAiQm94IG9mIG1heWJlIGNvb2tpZXMiLAogICAgICBwb3dlcjogNSwKICAgICAgcHJpY2U6IE1hdGgucG93KDEwLCA0NyksCiAgICB9KTsKCiAgICAvL2VuZCBvZiB1cGdyYWRlcwoKICAgIEdhbWUuc2Vhc29ucyA9IHsKICAgICAgY2hyaXN0bWFzOiB7CiAgICAgICAgbmFtZTogIkNocmlzdG1hcyIsCiAgICAgICAgc3RhcnQ6ICJDaHJpc3RtYXMgc2Vhc29uIGhhcyBzdGFydGVkISIsCiAgICAgICAgb3ZlcjogIkNocmlzdG1hcyBzZWFzb24gaXMgb3Zlci4iLAogICAgICAgIHRyaWdnZXI6ICJGZXN0aXZlIGJpc2N1aXQiLAogICAgICB9LAogICAgICB2YWxlbnRpbmVzOiB7CiAgICAgICAgbmFtZTogIlZhbGVudGluZSdzIGRheSIsCiAgICAgICAgc3RhcnQ6ICJWYWxlbnRpbmUncyBkYXkgaGFzIHN0YXJ0ZWQhIiwKICAgICAgICBvdmVyOiAiVmFsZW50aW5lJ3MgZGF5IGlzIG92ZXIuIiwKICAgICAgICB0cmlnZ2VyOiAiTG92ZXNpY2sgYmlzY3VpdCIsCiAgICAgIH0sCiAgICAgIGZvb2xzOiB7CiAgICAgICAgbmFtZTogIkJ1c2luZXNzIGRheSIsCiAgICAgICAgc3RhcnQ6ICJCdXNpbmVzcyBkYXkgaGFzIHN0YXJ0ZWQhIiwKICAgICAgICBvdmVyOiAiQnVzaW5lc3MgZGF5IGlzIG92ZXIuIiwKICAgICAgICB0cmlnZ2VyOiAiRm9vbCdzIGJpc2N1aXQiLAogICAgICB9LAogICAgICBlYXN0ZXI6IHsKICAgICAgICBuYW1lOiAiRWFzdGVyIiwKICAgICAgICBzdGFydDogIkVhc3RlciBzZWFzb24gaGFzIHN0YXJ0ZWQhIiwKICAgICAgICBvdmVyOiAiRWFzdGVyIHNlYXNvbiBpcyBvdmVyLiIsCiAgICAgICAgdHJpZ2dlcjogIkJ1bm55IGJpc2N1aXQiLAogICAgICB9LAogICAgICBoYWxsb3dlZW46IHsKICAgICAgICBuYW1lOiAiSGFsbG93ZWVuIiwKICAgICAgICBzdGFydDogIkhhbGxvd2VlbiBoYXMgc3RhcnRlZCEiLAogICAgICAgIG92ZXI6ICJIYWxsb3dlZW4gaXMgb3Zlci4iLAogICAgICAgIHRyaWdnZXI6ICJHaG9zdGx5IGJpc2N1aXQiLAogICAgICB9LAogICAgfTsKICAgIGlmICghRU4pIHsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLnNlYXNvbnMpIHsKICAgICAgICB2YXIgaXQgPSBHYW1lLnNlYXNvbnNbaV07CiAgICAgICAgaXQubmFtZSA9IGxvYyhpdC5uYW1lKTsKICAgICAgICBpdC5zdGFydCA9IGxvYygiJTEgaGFzIHN0YXJ0ZWQhIiwgaXQubmFtZSk7CiAgICAgICAgaXQub3ZlciA9IGxvYygiJTEgaXMgb3Zlci4iLCBpdC5uYW1lKTsKICAgICAgfQogICAgfQoKICAgIEdhbWUubGlzdFRpbnlPd25lZFVwZ3JhZGVzID0gZnVuY3Rpb24gKGFycikgewogICAgICB2YXIgc3RyID0gIiI7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKEdhbWUuSGFzKGFycltpXSkpIHsKICAgICAgICAgIHZhciBpdCA9IEdhbWUuVXBncmFkZXNbYXJyW2ldXTsKICAgICAgICAgIHN0ciArPSB0aW55SWNvbihpdC5pY29uKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHN0cjsKICAgIH07CgogICAgR2FtZS5zYW50YURyb3BzID0gWwogICAgICAiSW5jcmVhc2VkIG1lcnJpbmVzcyIsCiAgICAgICJJbXByb3ZlZCBqb2xsaW5lc3MiLAogICAgICAiQSBsdW1wIG9mIGNvYWwiLAogICAgICAiQW4gaXRjaHkgc3dlYXRlciIsCiAgICAgICJSZWluZGVlciBiYWtpbmcgZ3JvdW5kcyIsCiAgICAgICJXZWlnaHRlZCBzbGVpZ2hzIiwKICAgICAgIkhvIGhvIGhvLWZsYXZvcmVkIGZyb3N0aW5nIiwKICAgICAgIlNlYXNvbiBzYXZpbmdzIiwKICAgICAgIlRveSB3b3Jrc2hvcCIsCiAgICAgICJOYXVnaHR5IGxpc3QiLAogICAgICAiU2FudGEncyBib3R0b21sZXNzIGJhZyIsCiAgICAgICJTYW50YSdzIGhlbHBlcnMiLAogICAgICAiU2FudGEncyBsZWdhY3kiLAogICAgICAiU2FudGEncyBtaWxrIGFuZCBjb29raWVzIiwKICAgIF07CgogICAgR2FtZS5HZXRIb3dNYW55U2FudGFEcm9wcyA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIG51bSA9IDA7CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5zYW50YURyb3BzKSB7CiAgICAgICAgaWYgKEdhbWUuSGFzKEdhbWUuc2FudGFEcm9wc1tpXSkpIG51bSsrOwogICAgICB9CiAgICAgIHJldHVybiBudW07CiAgICB9OwoKICAgIEdhbWUucmVpbmRlZXJEcm9wcyA9IFsKICAgICAgIkNocmlzdG1hcyB0cmVlIGJpc2N1aXRzIiwKICAgICAgIlNub3dmbGFrZSBiaXNjdWl0cyIsCiAgICAgICJTbm93bWFuIGJpc2N1aXRzIiwKICAgICAgIkhvbGx5IGJpc2N1aXRzIiwKICAgICAgIkNhbmR5IGNhbmUgYmlzY3VpdHMiLAogICAgICAiQmVsbCBiaXNjdWl0cyIsCiAgICAgICJQcmVzZW50IGJpc2N1aXRzIiwKICAgIF07CiAgICBHYW1lLkdldEhvd01hbnlSZWluZGVlckRyb3BzID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgbnVtID0gMDsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLnJlaW5kZWVyRHJvcHMpIHsKICAgICAgICBpZiAoR2FtZS5IYXMoR2FtZS5yZWluZGVlckRyb3BzW2ldKSkgbnVtKys7CiAgICAgIH0KICAgICAgcmV0dXJuIG51bTsKICAgIH07CiAgICAvKmZvciAodmFyIGkgaW4gR2FtZS5zYW50YURyb3BzKQoJCXsKCQkJR2FtZS5VcGdyYWRlc1tHYW1lLnNhbnRhRHJvcHNbaV1dLmRlc2NGdW5jPWZ1bmN0aW9uKCl7cmV0dXJuICc8ZGl2IHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsiPllvdSBjdXJyZW50bHkgb3duIDxiPicrR2FtZS5HZXRIb3dNYW55U2FudGFEcm9wcygpKycvJytHYW1lLnNhbnRhRHJvcHMubGVuZ3RoKyc8L2I+IG9mIFNhbnRhXCdzIGdpZnRzLjwvZGl2PjxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicrdGhpcy5kZGVzYzt9OwoJCX0qLwoKICAgIEdhbWUuc2Vhc29uRHJvcHMgPSBHYW1lLmhlYXJ0RHJvcHMKICAgICAgLmNvbmNhdChHYW1lLmhhbGxvd2VlbkRyb3BzKQogICAgICAuY29uY2F0KEdhbWUuZWFzdGVyRWdncykKICAgICAgLmNvbmNhdChHYW1lLnNhbnRhRHJvcHMpCiAgICAgIC5jb25jYXQoR2FtZS5yZWluZGVlckRyb3BzKTsKCiAgICBHYW1lLnNheVNlYXNvblN3aXRjaFVzZXMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChHYW1lLnNlYXNvblVzZXMgPT0gMCkKICAgICAgICByZXR1cm4gbG9jKCJZb3UgaGF2ZW4ndCBzd2l0Y2hlZCBzZWFzb25zIHRoaXMgYXNjZW5zaW9uIHlldC4iKTsKICAgICAgcmV0dXJuIEVOCiAgICAgICAgPyAiWW91J3ZlIHN3aXRjaGVkIHNlYXNvbnMgPGI+IiArCiAgICAgICAgICAgIChHYW1lLnNlYXNvblVzZXMgPT0gMQogICAgICAgICAgICAgID8gIm9uY2UiCiAgICAgICAgICAgICAgOiBHYW1lLnNlYXNvblVzZXMgPT0gMgogICAgICAgICAgICAgID8gInR3aWNlIgogICAgICAgICAgICAgIDogR2FtZS5zZWFzb25Vc2VzICsgIiB0aW1lcyIpICsKICAgICAgICAgICAgIjwvYj4gdGhpcyBhc2NlbnNpb24uIgogICAgICAgIDogR2FtZS5zZWFzb25Vc2VzID09IDEKICAgICAgICA/IGxvYygiWW91J3ZlIHN3aXRjaGVkIHNlYXNvbnMgPGI+b25jZTwvYj4gdGhpcyBhc2NlbnNpb24uIikKICAgICAgICA6IGxvYygKICAgICAgICAgICAgIllvdSd2ZSBzd2l0Y2hlZCBzZWFzb25zIDxiPiUxIHRpbWVzPC9iPiB0aGlzIGFzY2Vuc2lvbi4iLAogICAgICAgICAgICBHYW1lLnNlYXNvblVzZXMKICAgICAgICAgICk7CiAgICB9OwogICAgR2FtZS5VcGdyYWRlc1siRmVzdGl2ZSBiaXNjdWl0Il0uZGVzY0Z1bmMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiAoCiAgICAgICAgJzxkaXYgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyI+JyArCiAgICAgICAgR2FtZS5saXN0VGlueU93bmVkVXBncmFkZXMoR2FtZS5zYW50YURyb3BzKSArCiAgICAgICAgIjxicj48YnI+IiArCiAgICAgICAgKEVOCiAgICAgICAgICA/ICJZb3UndmUgcHVyY2hhc2VkIDxiPiIgKwogICAgICAgICAgICBHYW1lLkdldEhvd01hbnlTYW50YURyb3BzKCkgKwogICAgICAgICAgICAiLyIgKwogICAgICAgICAgICBHYW1lLnNhbnRhRHJvcHMubGVuZ3RoICsKICAgICAgICAgICAgIjwvYj4gb2YgU2FudGEncyBnaWZ0cy4iCiAgICAgICAgICA6IGxvYygKICAgICAgICAgICAgICAiU2Vhc29uYWwgY29va2llcyBwdXJjaGFzZWQ6IDxiPiUxPC9iPi4iLAogICAgICAgICAgICAgIEdhbWUuR2V0SG93TWFueVNhbnRhRHJvcHMoKSArICIvIiArIEdhbWUuc2FudGFEcm9wcy5sZW5ndGgKICAgICAgICAgICAgKSkgKwogICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICBHYW1lLmxpc3RUaW55T3duZWRVcGdyYWRlcyhHYW1lLnJlaW5kZWVyRHJvcHMpICsKICAgICAgICAiPGJyPjxicj4iICsKICAgICAgICAoRU4KICAgICAgICAgID8gIllvdSd2ZSBwdXJjaGFzZWQgPGI+IiArCiAgICAgICAgICAgIEdhbWUuR2V0SG93TWFueVJlaW5kZWVyRHJvcHMoKSArCiAgICAgICAgICAgICIvIiArCiAgICAgICAgICAgIEdhbWUucmVpbmRlZXJEcm9wcy5sZW5ndGggKwogICAgICAgICAgICAiPC9iPiByZWluZGVlciBjb29raWVzLiIKICAgICAgICAgIDogbG9jKAogICAgICAgICAgICAgICJSZWluZGVlciBjb29raWVzIHB1cmNoYXNlZDogPGI+JTE8L2I+LiIsCiAgICAgICAgICAgICAgR2FtZS5HZXRIb3dNYW55UmVpbmRlZXJEcm9wcygpICsgIi8iICsgR2FtZS5yZWluZGVlckRyb3BzLmxlbmd0aAogICAgICAgICAgICApKSArCiAgICAgICAgJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicgKwogICAgICAgIEdhbWUuc2F5U2Vhc29uU3dpdGNoVXNlcygpICsKICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+PC9kaXY+JyArCiAgICAgICAgdGhpcy5kZGVzYwogICAgICApOwogICAgfTsKICAgIEdhbWUuVXBncmFkZXNbIkJ1bm55IGJpc2N1aXQiXS5kZXNjRnVuYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuICgKICAgICAgICAnPGRpdiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7Ij4nICsKICAgICAgICBHYW1lLmxpc3RUaW55T3duZWRVcGdyYWRlcyhHYW1lLmVhc3RlckVnZ3MpICsKICAgICAgICAiPGJyPjxicj4iICsKICAgICAgICAoRU4KICAgICAgICAgID8gIllvdSd2ZSBwdXJjaGFzZWQgPGI+IiArCiAgICAgICAgICAgIEdhbWUuR2V0SG93TWFueUVnZ3MoKSArCiAgICAgICAgICAgICIvIiArCiAgICAgICAgICAgIEdhbWUuZWFzdGVyRWdncy5sZW5ndGggKwogICAgICAgICAgICAiPC9iPiBlZ2dzLiIKICAgICAgICAgIDogbG9jKAogICAgICAgICAgICAgICJFZ2dzIHB1cmNoYXNlZDogPGI+JTE8L2I+LiIsCiAgICAgICAgICAgICAgR2FtZS5HZXRIb3dNYW55RWdncygpICsgIi8iICsgR2FtZS5lYXN0ZXJFZ2dzLmxlbmd0aAogICAgICAgICAgICApKSArCiAgICAgICAgJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicgKwogICAgICAgIEdhbWUuc2F5U2Vhc29uU3dpdGNoVXNlcygpICsKICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+PC9kaXY+JyArCiAgICAgICAgdGhpcy5kZGVzYwogICAgICApOwogICAgfTsKICAgIEdhbWUuVXBncmFkZXNbIkdob3N0bHkgYmlzY3VpdCJdLmRlc2NGdW5jID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gKAogICAgICAgICc8ZGl2IHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsiPicgKwogICAgICAgIEdhbWUubGlzdFRpbnlPd25lZFVwZ3JhZGVzKEdhbWUuaGFsbG93ZWVuRHJvcHMpICsKICAgICAgICAiPGJyPjxicj4iICsKICAgICAgICAoRU4KICAgICAgICAgID8gIllvdSd2ZSBwdXJjaGFzZWQgPGI+IiArCiAgICAgICAgICAgIEdhbWUuR2V0SG93TWFueUhhbGxvd2VlbkRyb3BzKCkgKwogICAgICAgICAgICAiLyIgKwogICAgICAgICAgICBHYW1lLmhhbGxvd2VlbkRyb3BzLmxlbmd0aCArCiAgICAgICAgICAgICI8L2I+IGhhbGxvd2VlbiBjb29raWVzLiIKICAgICAgICAgIDogbG9jKAogICAgICAgICAgICAgICJTZWFzb25hbCBjb29raWVzIHB1cmNoYXNlZDogPGI+JTE8L2I+LiIsCiAgICAgICAgICAgICAgR2FtZS5HZXRIb3dNYW55SGFsbG93ZWVuRHJvcHMoKSArICIvIiArIEdhbWUuaGFsbG93ZWVuRHJvcHMubGVuZ3RoCiAgICAgICAgICAgICkpICsKICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgR2FtZS5zYXlTZWFzb25Td2l0Y2hVc2VzKCkgKwogICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj48L2Rpdj4nICsKICAgICAgICB0aGlzLmRkZXNjCiAgICAgICk7CiAgICB9OwogICAgR2FtZS5VcGdyYWRlc1siTG92ZXNpY2sgYmlzY3VpdCJdLmRlc2NGdW5jID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gKAogICAgICAgICc8ZGl2IHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsiPicgKwogICAgICAgIEdhbWUubGlzdFRpbnlPd25lZFVwZ3JhZGVzKEdhbWUuaGVhcnREcm9wcykgKwogICAgICAgICI8YnI+PGJyPiIgKwogICAgICAgIChFTgogICAgICAgICAgPyAiWW91J3ZlIHB1cmNoYXNlZCA8Yj4iICsKICAgICAgICAgICAgR2FtZS5HZXRIb3dNYW55SGVhcnREcm9wcygpICsKICAgICAgICAgICAgIi8iICsKICAgICAgICAgICAgR2FtZS5oZWFydERyb3BzLmxlbmd0aCArCiAgICAgICAgICAgICI8L2I+IGhlYXJ0IGJpc2N1aXRzLiIKICAgICAgICAgIDogbG9jKAogICAgICAgICAgICAgICJTZWFzb25hbCBjb29raWVzIHB1cmNoYXNlZDogPGI+JTE8L2I+LiIsCiAgICAgICAgICAgICAgR2FtZS5HZXRIb3dNYW55SGVhcnREcm9wcygpICsgIi8iICsgR2FtZS5oZWFydERyb3BzLmxlbmd0aAogICAgICAgICAgICApKSArCiAgICAgICAgJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicgKwogICAgICAgIEdhbWUuc2F5U2Vhc29uU3dpdGNoVXNlcygpICsKICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+PC9kaXY+JyArCiAgICAgICAgdGhpcy5kZGVzYwogICAgICApOwogICAgfTsKICAgIEdhbWUuVXBncmFkZXNbIkZvb2wncyBiaXNjdWl0Il0uZGVzY0Z1bmMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiAoCiAgICAgICAgJzxkaXYgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyI+JyArCiAgICAgICAgR2FtZS5zYXlTZWFzb25Td2l0Y2hVc2VzKCkgKwogICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj48L2Rpdj4nICsKICAgICAgICB0aGlzLmRkZXNjCiAgICAgICk7CiAgICB9OwoKICAgIEdhbWUuY29tcHV0ZVNlYXNvblByaWNlcyA9IGZ1bmN0aW9uICgpIHsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLnNlYXNvbnMpIHsKICAgICAgICBHYW1lLnNlYXNvbnNbaV0udHJpZ2dlclVwZ3JhZGUucHJpY2VGdW5jID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIG0gPSAxOwogICAgICAgICAgaWYgKEdhbWUuaGFzR29kKSB7CiAgICAgICAgICAgIHZhciBnb2RMdmwgPSBHYW1lLmhhc0dvZCgic2Vhc29ucyIpOwogICAgICAgICAgICBpZiAoZ29kTHZsID09IDEpIG0gKj0gMjsKICAgICAgICAgICAgZWxzZSBpZiAoZ29kTHZsID09IDIpIG0gKj0gMS41OwogICAgICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMykgbSAqPSAxLjI1OwogICAgICAgICAgfQogICAgICAgICAgLy9yZXR1cm4gR2FtZS5zZWFzb25UcmlnZ2VyQmFzZVByaWNlKk1hdGgucG93KDIsR2FtZS5zZWFzb25Vc2VzKSptOwogICAgICAgICAgLy9yZXR1cm4gR2FtZS5jb29raWVzUHMqNjAqTWF0aC5wb3coMS41LEdhbWUuc2Vhc29uVXNlcykqbTsKICAgICAgICAgIHJldHVybiAoCiAgICAgICAgICAgIEdhbWUuc2Vhc29uVHJpZ2dlckJhc2VQcmljZSArCiAgICAgICAgICAgIEdhbWUudW5idWZmZWRDcHMgKiA2MCAqIE1hdGgucG93KDEuNSwgR2FtZS5zZWFzb25Vc2VzKSAqIG0KICAgICAgICAgICk7CiAgICAgICAgfTsKICAgICAgfQogICAgfTsKICAgIEdhbWUuY29tcHV0ZVNlYXNvbnMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5zZWFzb25zKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5VcGdyYWRlc1tHYW1lLnNlYXNvbnNbaV0udHJpZ2dlcl07CiAgICAgICAgR2FtZS5zZWFzb25zW2ldLnRyaWdnZXJVcGdyYWRlID0gbWU7CiAgICAgICAgbWUucG9vbCA9ICJ0b2dnbGUiOwogICAgICAgIG1lLmJ1eUZ1bmN0aW9uID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgR2FtZS5zZWFzb25Vc2VzICs9IDE7CiAgICAgICAgICBHYW1lLmNvbXB1dGVTZWFzb25QcmljZXMoKTsKICAgICAgICAgIC8vR2FtZS5Mb2NrKHRoaXMubmFtZSk7CiAgICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuc2Vhc29ucykgewogICAgICAgICAgICB2YXIgbWUgPSBHYW1lLlVwZ3JhZGVzW0dhbWUuc2Vhc29uc1tpXS50cmlnZ2VyXTsKICAgICAgICAgICAgaWYgKG1lLm5hbWUgIT0gdGhpcy5uYW1lKSB7CiAgICAgICAgICAgICAgR2FtZS5Mb2NrKG1lLm5hbWUpOwogICAgICAgICAgICAgIEdhbWUuVW5sb2NrKG1lLm5hbWUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoR2FtZS5zZWFzb24gIT0gIiIgJiYgR2FtZS5zZWFzb24gIT0gdGhpcy5zZWFzb24pIHsKICAgICAgICAgICAgR2FtZS5Ob3RpZnkoCiAgICAgICAgICAgICAgR2FtZS5zZWFzb25zW0dhbWUuc2Vhc29uXS5vdmVyICsgJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicsCiAgICAgICAgICAgICAgIiIsCiAgICAgICAgICAgICAgR2FtZS5zZWFzb25zW0dhbWUuc2Vhc29uXS50cmlnZ2VyVXBncmFkZS5pY29uLAogICAgICAgICAgICAgIDQKICAgICAgICAgICAgKTsKICAgICAgICAgIH0KICAgICAgICAgIEdhbWUuc2Vhc29uID0gdGhpcy5zZWFzb247CiAgICAgICAgICBHYW1lLnNlYXNvblQgPSBHYW1lLmdldFNlYXNvbkR1cmF0aW9uKCk7CiAgICAgICAgICBHYW1lLnN0b3JlVG9SZWZyZXNoID0gMTsKICAgICAgICAgIEdhbWUudXBncmFkZXNUb1JlYnVpbGQgPSAxOwogICAgICAgICAgR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0ucmVkcmF3KCk7CiAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgR2FtZS5zZWFzb25zW3RoaXMuc2Vhc29uXS5zdGFydCArICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nLAogICAgICAgICAgICAiIiwKICAgICAgICAgICAgdGhpcy5pY29uLAogICAgICAgICAgICA0CiAgICAgICAgICApOwogICAgICAgIH07CgogICAgICAgIG1lLmNsaWNrRnVuY3Rpb24gPSAoZnVuY3Rpb24gKG1lKSB7CiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAvL3VuZG8gc2Vhc29uCiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICBtZS5ib3VnaHQgJiYKICAgICAgICAgICAgICBHYW1lLnNlYXNvbiAmJgogICAgICAgICAgICAgIG1lID09IEdhbWUuc2Vhc29uc1tHYW1lLnNlYXNvbl0udHJpZ2dlclVwZ3JhZGUKICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgbWUubG9zZSgpOwogICAgICAgICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgICAgICAgR2FtZS5zZWFzb25zW0dhbWUuc2Vhc29uXS5vdmVyLAogICAgICAgICAgICAgICAgIiIsCiAgICAgICAgICAgICAgICBHYW1lLnNlYXNvbnNbR2FtZS5zZWFzb25dLnRyaWdnZXJVcGdyYWRlLmljb24KICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIGlmIChHYW1lLkhhcygiU2Vhc29uIHN3aXRjaGVyIikpIHsKICAgICAgICAgICAgICAgIEdhbWUuVW5sb2NrKEdhbWUuc2Vhc29uc1tHYW1lLnNlYXNvbl0udHJpZ2dlcik7CiAgICAgICAgICAgICAgICBHYW1lLnNlYXNvbnNbR2FtZS5zZWFzb25dLnRyaWdnZXJVcGdyYWRlLmJvdWdodCA9IDA7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkID0gMTsKICAgICAgICAgICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICAgICAgICAgIEdhbWUuc2Vhc29uID0gR2FtZS5iYXNlU2Vhc29uOwogICAgICAgICAgICAgIEdhbWUuc2Vhc29uVCA9IC0xOwogICAgICAgICAgICAgIFBsYXlTb3VuZCgic25kL3RpY2subXAzIik7CiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9IGVsc2UgcmV0dXJuIHRydWU7CiAgICAgICAgICB9OwogICAgICAgIH0pKG1lKTsKCiAgICAgICAgbWUuZGlzcGxheUZ1bmNXaGVuT3duZWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAnPGRpdiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7Ij4nICsKICAgICAgICAgICAgbG9jKCJUaW1lIHJlbWFpbmluZzoiKSArCiAgICAgICAgICAgICI8YnI+PGI+IiArCiAgICAgICAgICAgIChHYW1lLkhhcygiRXRlcm5hbCBzZWFzb25zIikKICAgICAgICAgICAgICA/IGxvYygiZm9yZXZlciIpCiAgICAgICAgICAgICAgOiBHYW1lLnNheVRpbWUoR2FtZS5zZWFzb25ULCAtMSkpICsKICAgICAgICAgICAgJzwvYj48ZGl2IHN0eWxlPSJmb250LXNpemU6ODAlOyI+KCcgKwogICAgICAgICAgICBsb2MoIkNsaWNrIGFnYWluIHRvIGNhbmNlbCBzZWFzb24iKSArCiAgICAgICAgICAgICIpPC9kaXY+PC9kaXY+IgogICAgICAgICAgKTsKICAgICAgICB9OwogICAgICAgIG1lLnRpbWVyRGlzcGxheSA9IChmdW5jdGlvbiAodXBncmFkZSkgewogICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICFHYW1lLlVwZ3JhZGVzW3VwZ3JhZGUubmFtZV0uYm91Z2h0IHx8CiAgICAgICAgICAgICAgR2FtZS5IYXMoIkV0ZXJuYWwgc2Vhc29ucyIpCiAgICAgICAgICAgICkKICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgIGVsc2UgcmV0dXJuIDEgLSBHYW1lLnNlYXNvblQgLyBHYW1lLmdldFNlYXNvbkR1cmF0aW9uKCk7CiAgICAgICAgICB9OwogICAgICAgIH0pKG1lKTsKICAgICAgfQogICAgfTsKICAgIEdhbWUuZ2V0U2Vhc29uRHVyYXRpb24gPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBHYW1lLmZwcyAqIDYwICogNjAgKiAyNDsKICAgIH07CiAgICBHYW1lLmNvbXB1dGVTZWFzb25zKCk7CgogICAgLy9hbGVydCB1bnRpZXJlZCBidWlsZGluZyB1cGdyYWRlcwogICAgZm9yICh2YXIgaSBpbiBHYW1lLlVwZ3JhZGVzKSB7CiAgICAgIHZhciBtZSA9IEdhbWUuVXBncmFkZXNbaV07CiAgICAgIGlmICgKICAgICAgICBtZS5vcmRlciA+PSAyMDAgJiYKICAgICAgICBtZS5vcmRlciA8IDIwMDAgJiYKICAgICAgICAhbWUudGllciAmJgogICAgICAgIG1lLm5hbWUuaW5kZXhPZigiZ3JhbmRtYSIpID09IC0xICYmCiAgICAgICAgbWUucG9vbCAhPSAicHJlc3RpZ2UiCiAgICAgICkKICAgICAgICBjb25zb2xlLmxvZyhtZS5uYW1lICsgIiBoYXMgbm8gdGllci4iKTsKICAgIH0KCiAgICBHYW1lLlVwZ3JhZGVzQnlQb29sID0geyBraXR0ZW46IFtdIH07CiAgICBmb3IgKHZhciBpIGluIEdhbWUuVXBncmFkZXMpIHsKICAgICAgaWYgKCFHYW1lLlVwZ3JhZGVzQnlQb29sW0dhbWUuVXBncmFkZXNbaV0ucG9vbF0pCiAgICAgICAgR2FtZS5VcGdyYWRlc0J5UG9vbFtHYW1lLlVwZ3JhZGVzW2ldLnBvb2xdID0gW107CiAgICAgIEdhbWUuVXBncmFkZXNCeVBvb2xbR2FtZS5VcGdyYWRlc1tpXS5wb29sXS5wdXNoKEdhbWUuVXBncmFkZXNbaV0pOwogICAgICBpZiAoR2FtZS5VcGdyYWRlc1tpXS5raXR0ZW4pCiAgICAgICAgR2FtZS5VcGdyYWRlc0J5UG9vbFsia2l0dGVuIl0ucHVzaChHYW1lLlVwZ3JhZGVzW2ldKTsKICAgIH0KCiAgICBHYW1lLlByZXN0aWdlVXBncmFkZXMgPSBbXTsKICAgIGZvciAodmFyIGkgaW4gR2FtZS5VcGdyYWRlcykgewogICAgICBpZiAoCiAgICAgICAgR2FtZS5VcGdyYWRlc1tpXS5wb29sID09ICJwcmVzdGlnZSIgfHwKICAgICAgICBHYW1lLlVwZ3JhZGVzW2ldLnBvb2wgPT0gInByZXN0aWdlRGVjb3IiCiAgICAgICkgewogICAgICAgIEdhbWUuUHJlc3RpZ2VVcGdyYWRlcy5wdXNoKEdhbWUuVXBncmFkZXNbaV0pOwogICAgICAgIGlmIChHYW1lLlVwZ3JhZGVzW2ldLnBvc1ggfHwgR2FtZS5VcGdyYWRlc1tpXS5wb3NZKQogICAgICAgICAgR2FtZS5VcGdyYWRlc1tpXS5wbGFjZWRCeUNvZGUgPSB0cnVlOwogICAgICAgIGVsc2UgewogICAgICAgICAgR2FtZS5VcGdyYWRlc1tpXS5wb3NYID0gMDsKICAgICAgICAgIEdhbWUuVXBncmFkZXNbaV0ucG9zWSA9IDA7CiAgICAgICAgfQogICAgICAgIGlmICgKICAgICAgICAgIEdhbWUuVXBncmFkZXNbaV0ucGFyZW50cy5sZW5ndGggPT0gMCAmJgogICAgICAgICAgR2FtZS5VcGdyYWRlc1tpXS5uYW1lICE9ICJMZWdhY3kiCiAgICAgICAgKQogICAgICAgICAgR2FtZS5VcGdyYWRlc1tpXS5wYXJlbnRzID0gWyJMZWdhY3kiXTsKICAgICAgICBmb3IgKHZhciBpaSBpbiBHYW1lLlVwZ3JhZGVzW2ldLnBhcmVudHMpIHsKICAgICAgICAgIEdhbWUuVXBncmFkZXNbaV0ucGFyZW50c1tpaV0gPQogICAgICAgICAgICBHYW1lLlVwZ3JhZGVzW0dhbWUuVXBncmFkZXNbaV0ucGFyZW50c1tpaV1dOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIEdhbWUuZ29sZGVuQ29va2llVXBncmFkZXMgPSBbCiAgICAgICJHZXQgbHVja3kiLAogICAgICAiTHVja3kgZGF5IiwKICAgICAgIlNlcmVuZGlwaXR5IiwKICAgICAgIkhlYXZlbmx5IGx1Y2siLAogICAgICAiTGFzdGluZyBmb3J0dW5lIiwKICAgICAgIkRlY2lzaXZlIGZhdGUiLAogICAgICAiTHVja3kgZGlnaXQiLAogICAgICAiTHVja3kgbnVtYmVyIiwKICAgICAgIkx1Y2t5IHBheW91dCIsCiAgICAgICJHb2xkZW4gZ29vc2UgZWdnIiwKICAgIF07CgogICAgR2FtZS5jb29raWVVcGdyYWRlcyA9IFtdOwogICAgZm9yICh2YXIgaSBpbiBHYW1lLlVwZ3JhZGVzKSB7CiAgICAgIHZhciBtZSA9IEdhbWUuVXBncmFkZXNbaV07CiAgICAgIGlmIChtZS5wb29sID09ICJjb29raWUiIHx8IG1lLnBzZXVkb0Nvb2tpZSkgR2FtZS5jb29raWVVcGdyYWRlcy5wdXNoKG1lKTsKICAgICAgaWYgKG1lLnRpZXIpIEdhbWUuVGllcnNbbWUudGllcl0udXBncmFkZXMucHVzaChtZSk7CiAgICB9CiAgICBmb3IgKHZhciBpIGluIEdhbWUuVW5sb2NrQXQpIHsKICAgICAgR2FtZS5VcGdyYWRlc1tHYW1lLlVubG9ja0F0W2ldLm5hbWVdLnVubG9ja0F0ID0gR2FtZS5VbmxvY2tBdFtpXTsKICAgIH0KICAgIGZvciAodmFyIGkgaW4gR2FtZS5VcGdyYWRlcykgewogICAgICBpZiAoR2FtZS5VcGdyYWRlc1tpXS5wb29sID09ICJwcmVzdGlnZSIpCiAgICAgICAgR2FtZS5VcGdyYWRlc1tpXS5vcmRlciA9IEdhbWUuVXBncmFkZXNbaV0uaWQ7CiAgICB9CgogICAgLyp2YXIgb2xkUHJlc3RpZ2VQcmljZXM9eyJDaGltZXJhIjo1NzY0ODAxLCJTeW5lcmdpZXMgVm9sLiBJIjoyNTI1LCJTeW5lcmdpZXMgVm9sLiBJSSI6MjUyNTI1LCJMYWJlbCBwcmludGVyIjo5OTk5fTsKCQlmb3IgKHZhciBpIGluIG9sZFByZXN0aWdlUHJpY2VzKXtHYW1lLlVwZ3JhZGVzW2ldLmJhc2VQcmljZT1vbGRQcmVzdGlnZVByaWNlc1tpXTt9Ki8KCiAgICBHYW1lLlVwZ3JhZGVQb3NpdGlvbnMgPSB7CiAgICAgIDE0MTogWzExOCwgLTQyXSwKICAgICAgMTgxOiBbLTU1NSwgLTkzXSwKICAgICAgMjUzOiBbLTIzNywgLTIyNl0sCiAgICAgIDI1NDogWy01NiwgLTIzNF0sCiAgICAgIDI1NTogWy0xNDksIC0yNjddLAogICAgICAyNjQ6IFs2OCwgOTddLAogICAgICAyNjU6IFsxNTcsIDE5Nl0sCiAgICAgIDI2NjogWzI4NywgMjEyXSwKICAgICAgMjY3OiBbNDEzLCAxNTddLAogICAgICAyNjg6IFs0ODAsIDM1XSwKICAgICAgMjY5OiBbLTY0MCwgNDJdLAogICAgICAyNzA6IFstNDcxLCAtMjI4XSwKICAgICAgMjcxOiBbLTY5MCwgLTE3OF0sCiAgICAgIDI3MjogWy01OTEsIC0yNDldLAogICAgICAyNzM6IFstNzExLCAtNThdLAogICAgICAyNzQ6IFsyNzAsIC0zMjhdLAogICAgICAyNzU6IFszMTcsIC00MzldLAogICAgICAyNzY6IFszMzMsIC01NTZdLAogICAgICAyNzc6IFszMzQsIC02NzZdLAogICAgICAyNzg6IFszMzMsIC03OTZdLAogICAgICAyNzk6IFszMjgsIC05MjJdLAogICAgICAyODA6IFszMDMsIC0xMDQwXSwKICAgICAgMjgxOiBbMTk0LCAtMjMwXSwKICAgICAgMjgyOiBbLTI5MywgMTU2XSwKICAgICAgMjgzOiBbLTMzNSwgMjg5XSwKICAgICAgMjg0OiBbLTMyOCwgNDIyXSwKICAgICAgMjg1OiBbLTI0NywgNTY3XSwKICAgICAgMjg2OiBbLTM3NSwgNTc5XSwKICAgICAgMjg3OiBbLTI5NiwgNzI2XSwKICAgICAgMjg4OiBbLTI2MCwgLTM5Nl0sCiAgICAgIDI4OTogWy0zNzUsIC01MDJdLAogICAgICAyOTA6IFstMTI3LCAtNDE1XSwKICAgICAgMjkxOiBbNDc5LCAtNzM5XSwKICAgICAgMjkyOiBbLTM5OSwgLTY0OV0sCiAgICAgIDI5MzogWy00MDEsIC04MDZdLAogICAgICAzMjM6IFstNzYsIDEwOV0sCiAgICAgIDMyNTogWzE5OCwgLTExNTNdLAogICAgICAzMjY6IFstMjcwLCAtMTM0XSwKICAgICAgMzI3OiBbLTIyMSwgMjYxXSwKICAgICAgMzI4OiBbMTksIDI0N10sCiAgICAgIDMyOTogWzQyLCA0MDJdLAogICAgICAzNTM6IFsxMjEsIC0zMjZdLAogICAgICAzNTQ6IFs3NywgLTQzNl0sCiAgICAgIDM1NTogWzY0LCAtNTQ4XSwKICAgICAgMzU2OiBbNTcsIC02NzNdLAogICAgICAzNTc6IFs1MiwgLTc5M10sCiAgICAgIDM1ODogWzU4LCAtOTI0XSwKICAgICAgMzU5OiBbODIsIC0xMDQzXSwKICAgICAgMzYwOiBbNDksIDUwNl0sCiAgICAgIDM2MjogWzE1NiwgMzI1XSwKICAgICAgMzYzOiBbLTMwLCAtMzBdLAogICAgICAzNjQ6IFstMjM4LCAtNzI4XSwKICAgICAgMzY1OiBbLTEyMywgNDIzXSwKICAgICAgMzY4OiBbLTU1LCAtNTI3XSwKICAgICAgMzkzOiBbMTk2LCAtNzE0XSwKICAgICAgMzk0OiBbMTk3LCAtOTY0XSwKICAgICAgMzk1OiBbLTE0MywgLTE0MF0sCiAgICAgIDM5NjogWy0yNDQsIC04OTddLAogICAgICAzOTc6IFstOTcsIDY0MV0sCiAgICAgIDQwODogWy0yMDQsIC0xMDM2XSwKICAgICAgNDA5OiBbLTcyLCAtMTE1Ml0sCiAgICAgIDQxMDogWzQyLCAtMTI3OF0sCiAgICAgIDQxMTogWy00NzYsIDEwNV0sCiAgICAgIDQxMjogWy01MjIsIDI1OV0sCiAgICAgIDQxMzogWy01MTYsIDQzM10sCiAgICAgIDQ0OTogWy0zNjcsIC0xMTEzXSwKICAgICAgNDUwOiBbLTMwNiwgLTEyMTZdLAogICAgICA0NTE6IFstMTg0LCAtMTI0MV0sCiAgICAgIDQ5NTogWy00MDgsIC05NzRdLAogICAgICA0OTY6IFsyMDAsIDQ5XSwKICAgICAgNTA1OiBbNDExLCAtOTRdLAogICAgICA1MjA6IFstMzAzLCAtMTJdLAogICAgICA1Mzc6IFstNzk1LCAtMjQzXSwKICAgICAgNTM5OiBbLTUzNCwgLTExMzBdLAogICAgICA1NDA6IFstNzAyLCAtMTEzNV0sCiAgICAgIDU0MTogWy02NTYsIC0xMDE0XSwKICAgICAgNTQyOiBbLTY1MCwgLTEyNTJdLAogICAgICA1NjE6IFsyOTgsIC0yMV0sCiAgICAgIDU2MjogWzMyLCA3NDRdLAogICAgICA1OTE6IFsxNDgsIDg0NF0sCiAgICAgIDU5MjogWy01MiwgODU4XSwKICAgICAgNjQzOiBbNTcsIDYxNl0sCiAgICAgIDY0NjogWzQ4NSwgLTg4Ml0sCiAgICAgIDY0NzogWy0xMDIsIDI0Nl0sCiAgICAgIDcxNzogWzYyMSwgLTY3Nl0sCiAgICAgIDcxODogWzYxOCwgLTUzN10sCiAgICAgIDcxOTogWy0yMjUsIC01MjBdLAogICAgICA3MjA6IFstMTUwLCAtNjMxXSwKICAgICAgODAxOiBbLTE4OCwgOTIwXSwKICAgICAgODAyOiBbLTM0NCwgOTE2XSwKICAgICAgODAzOiBbLTQ2MiwgODQ4XSwKICAgICAgODA0OiBbMzIwLCAzNTBdLAogICAgICA4MDU6IFsyMjEsIDQ4Nl0sCiAgICB9OwoKICAgIGZvciAodmFyIGkgaW4gR2FtZS5VcGdyYWRlUG9zaXRpb25zKSB7CiAgICAgIEdhbWUuVXBncmFkZXNCeUlkW2ldLnBvc1ggPSBHYW1lLlVwZ3JhZGVQb3NpdGlvbnNbaV1bMF07CiAgICAgIEdhbWUuVXBncmFkZXNCeUlkW2ldLnBvc1kgPSBHYW1lLlVwZ3JhZGVQb3NpdGlvbnNbaV1bMV07CiAgICB9CgogICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkJQUNISUVWRU1FTlRTCgkJPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KICAgIEdhbWUuQWNoaWV2ZW1lbnRzID0ge307CiAgICBHYW1lLkFjaGlldmVtZW50c0J5SWQgPSB7fTsKICAgIEdhbWUuQWNoaWV2ZW1lbnRzTiA9IDA7CiAgICBHYW1lLkFjaGlldmVtZW50c093bmVkID0gMDsKICAgIEdhbWUuQWNoaWV2ZW1lbnQgPSBmdW5jdGlvbiAobmFtZSwgZGVzYywgaWNvbikgewogICAgICB0aGlzLmlkID0gR2FtZS5BY2hpZXZlbWVudHNOOwogICAgICB0aGlzLm5hbWUgPSBuYW1lOwogICAgICB0aGlzLmRuYW1lID0gdGhpcy5uYW1lOwogICAgICB0aGlzLmRlc2MgPSBkZXNjOwogICAgICB0aGlzLmJhc2VEZXNjID0gdGhpcy5kZXNjOwogICAgICB0aGlzLmljb24gPSBpY29uOwogICAgICB0aGlzLndvbiA9IDA7CiAgICAgIHRoaXMuZGlzYWJsZWQgPSAwOwogICAgICB0aGlzLm9yZGVyID0gdGhpcy5pZDsKICAgICAgaWYgKG9yZGVyKSB0aGlzLm9yZGVyID0gb3JkZXIgKyB0aGlzLmlkICogMC4wMDE7CiAgICAgIHRoaXMucG9vbCA9ICJub3JtYWwiOwogICAgICB0aGlzLnZhbmlsbGEgPSBHYW1lLnZhbmlsbGE7CiAgICAgIHRoaXMudHlwZSA9ICJhY2hpZXZlbWVudCI7CgogICAgICB0aGlzLmNsaWNrID0gZnVuY3Rpb24gKCkgewogICAgICAgIGlmICh0aGlzLmNsaWNrRnVuY3Rpb24pIHRoaXMuY2xpY2tGdW5jdGlvbigpOwogICAgICB9OwogICAgICBHYW1lLmxhc3QgPSB0aGlzOwogICAgICBHYW1lLkFjaGlldmVtZW50c1t0aGlzLm5hbWVdID0gdGhpczsKICAgICAgR2FtZS5BY2hpZXZlbWVudHNCeUlkW3RoaXMuaWRdID0gdGhpczsKICAgICAgR2FtZS5BY2hpZXZlbWVudHNOKys7CiAgICAgIHJldHVybiB0aGlzOwogICAgfTsKICAgIEdhbWUuQWNoaWV2ZW1lbnQucHJvdG90eXBlLmdldFR5cGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiAiQWNoaWV2ZW1lbnQiOwogICAgfTsKCiAgICBHYW1lLldpbiA9IGZ1bmN0aW9uICh3aGF0KSB7CiAgICAgIGlmICh0eXBlb2Ygd2hhdCA9PT0gInN0cmluZyIpIHsKICAgICAgICBpZiAoR2FtZS5BY2hpZXZlbWVudHNbd2hhdF0pIHsKICAgICAgICAgIHZhciBpdCA9IEdhbWUuQWNoaWV2ZW1lbnRzW3doYXRdOwogICAgICAgICAgaWYgKGl0LndvbiA9PSAwKSB7CiAgICAgICAgICAgIHZhciBuYW1lID0gaXQuc2hvcnROYW1lID8gaXQuc2hvcnROYW1lIDogaXQuZG5hbWU7CiAgICAgICAgICAgIGl0LndvbiA9IDE7CiAgICAgICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgICAgIGxvYygiQWNoaWV2ZW1lbnQgdW5sb2NrZWQiKSwKICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0idGl0bGUiIHN0eWxlPSJmb250LXNpemU6MThweDttYXJnaW4tdG9wOi0ycHg7Ij4nICsKICAgICAgICAgICAgICAgIG5hbWUgKwogICAgICAgICAgICAgICAgIjwvZGl2PiIsCiAgICAgICAgICAgICAgaXQuaWNvbgogICAgICAgICAgICApOwogICAgICAgICAgICBHYW1lLk5vdGlmeVRvb2x0aXAoCiAgICAgICAgICAgICAgImZ1bmN0aW9uKCl7cmV0dXJuIEdhbWUuY3JhdGVUb29sdGlwKEdhbWUuQWNoaWV2ZW1lbnRzQnlJZFsiICsKICAgICAgICAgICAgICAgIGl0LmlkICsKICAgICAgICAgICAgICAgICJdKTt9IgogICAgICAgICAgICApOwogICAgICAgICAgICBpZiAoR2FtZS5Db3VudHNBc0FjaGlldmVtZW50T3duZWQoaXQucG9vbCkpCiAgICAgICAgICAgICAgR2FtZS5BY2hpZXZlbWVudHNPd25lZCsrOwogICAgICAgICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICAgICAgICBpZiAoQXBwICYmIGl0LnZhbmlsbGEpIEFwcC5nb3RBY2hpZXYoaXQuaWQpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKHZhciBpIGluIHdoYXQpIHsKICAgICAgICAgIEdhbWUuV2luKHdoYXRbaV0pOwogICAgICAgIH0KICAgICAgfQogICAgfTsKICAgIEdhbWUuUmVtb3ZlQWNoaWV2ID0gZnVuY3Rpb24gKHdoYXQpIHsKICAgICAgaWYgKEdhbWUuQWNoaWV2ZW1lbnRzW3doYXRdKSB7CiAgICAgICAgaWYgKEdhbWUuQWNoaWV2ZW1lbnRzW3doYXRdLndvbiA9PSAxKSB7CiAgICAgICAgICBHYW1lLkFjaGlldmVtZW50c1t3aGF0XS53b24gPSAwOwogICAgICAgICAgaWYgKEdhbWUuQ291bnRzQXNBY2hpZXZlbWVudE93bmVkKEdhbWUuQWNoaWV2ZW1lbnRzW3doYXRdLnBvb2wpKQogICAgICAgICAgICBHYW1lLkFjaGlldmVtZW50c093bmVkLS07CiAgICAgICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICAgIH0KICAgICAgfQogICAgfTsKICAgIEdhbWUuQWNoaWV2ZW1lbnQucHJvdG90eXBlLnRvZ2dsZSA9IGZ1bmN0aW9uICgpIC8vY2hlYXRpbmcgb25seQogICAgewogICAgICBpZiAoIXRoaXMud29uKSB7CiAgICAgICAgR2FtZS5XaW4odGhpcy5uYW1lKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBHYW1lLlJlbW92ZUFjaGlldih0aGlzLm5hbWUpOwogICAgICB9CiAgICAgIGlmIChHYW1lLm9uTWVudSA9PSAic3RhdHMiKSBHYW1lLlVwZGF0ZU1lbnUoKTsKICAgIH07CgogICAgR2FtZS5Db3VudHNBc0FjaGlldmVtZW50T3duZWQgPSBmdW5jdGlvbiAocG9vbCkgewogICAgICBpZiAocG9vbCA9PSAiIiB8fCBwb29sID09ICJub3JtYWwiKSByZXR1cm4gdHJ1ZTsKICAgICAgZWxzZSByZXR1cm4gZmFsc2U7CiAgICB9OwoKICAgIEdhbWUuSGFzQWNoaWV2ID0gZnVuY3Rpb24gKHdoYXQpIHsKICAgICAgcmV0dXJuIEdhbWUuQWNoaWV2ZW1lbnRzW3doYXRdID8gR2FtZS5BY2hpZXZlbWVudHNbd2hhdF0ud29uIDogMDsKICAgIH07CgogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCA9IGZ1bmN0aW9uIChuYW1lLCBkZXNjLCBidWlsZGluZywgdGllcikgewogICAgICB2YXIgYWNoaWV2ID0gbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICAgbmFtZSwKICAgICAgICBsb2MoCiAgICAgICAgICAiSGF2ZSA8Yj4lMTwvYj4uIiwKICAgICAgICAgIGxvYygKICAgICAgICAgICAgIiUxICIgKyBHYW1lLk9iamVjdHNbYnVpbGRpbmddLmJzaW5nbGUsCiAgICAgICAgICAgIExCZWF1dGlmeShHYW1lLlRpZXJzW3RpZXJdLmFjaGlldlVubG9jaykKICAgICAgICAgICkKICAgICAgICApICsgZGVzYywKICAgICAgICBHYW1lLkdldEljb24oYnVpbGRpbmcsIHRpZXIpCiAgICAgICk7CiAgICAgIEdhbWUuU2V0VGllcihidWlsZGluZywgdGllcik7CiAgICAgIHJldHVybiBhY2hpZXY7CiAgICB9OwoKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50ID0gZnVuY3Rpb24gKG5hbWUsIGJ1aWxkaW5nLCB0aWVyLCBxLCBtdWx0KSB7CiAgICAgIHZhciBidWlsZGluZyA9IEdhbWUuT2JqZWN0c1tidWlsZGluZ107CiAgICAgIHZhciBpY29uID0gW2J1aWxkaW5nLmljb25Db2x1bW4sIDIyXTsKICAgICAgdmFyIG4gPSAxMiArIGJ1aWxkaW5nLm4gKyAobXVsdCB8fCAwKTsKICAgICAgaWYgKHRpZXIgPT0gMikgewogICAgICAgIGljb25bMV0gPSAyMzsKICAgICAgICBuICs9IDc7CiAgICAgIH0gZWxzZSBpZiAodGllciA9PSAzKSB7CiAgICAgICAgaWNvblsxXSA9IDI0OwogICAgICAgIG4gKz0gMTQ7CiAgICAgIH0KICAgICAgdmFyIHBvdyA9IE1hdGgucG93KDEwLCBuKTsKICAgICAgdmFyIGFjaGlldiA9IG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAgIG5hbWUsCiAgICAgICAgbG9jKCJNYWtlIDxiPiUxPC9iPiBqdXN0IGZyb20gJTIuIiwgWwogICAgICAgICAgbG9jKCIlMSBjb29raWUiLCB7IG46IHBvdywgYjogdG9GaXhlZChwb3cpIH0pLAogICAgICAgICAgYnVpbGRpbmcucGx1cmFsLAogICAgICAgIF0pICsgKHEgPyAiPHE+IiArIHEgKyAiPC9xPiIgOiAiIiksCiAgICAgICAgaWNvbgogICAgICApOwogICAgICBidWlsZGluZy5wcm9kdWN0aW9uQWNoaWV2cy5wdXNoKHsgcG93OiBwb3csIGFjaGlldjogYWNoaWV2IH0pOwogICAgICByZXR1cm4gYWNoaWV2OwogICAgfTsKCiAgICBHYW1lLnRocmVzaG9sZEljb25zID0gWwogICAgICAwLCAxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5LCAxMCwgMTEsIDE4LCAxOSwgMjAsIDIxLCAyMiwgMjMsIDI0LCAyNSwgMjYsCiAgICAgIDI3LCAyOCwgMjksIDIxLCAyMiwgMjMsIDI0LCAyNSwgMjYsIDI3LCAyOCwgMjksIDIxLCAyMiwgMjMsIDI0LCAyNSwgMjYsCiAgICAgIDI3LCAyOCwgMjksIDMwLCAzMSwgMzAsIDMxLAogICAgXTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50cyA9IFtdOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQgPSBmdW5jdGlvbiAobmFtZSwgcSkgewogICAgICB2YXIgdGhyZXNob2xkID0gTWF0aC5wb3coCiAgICAgICAgMTAsCiAgICAgICAgTWF0aC5mbG9vcihHYW1lLkJhbmtBY2hpZXZlbWVudHMubGVuZ3RoICogMS41ICsgMikKICAgICAgKTsKICAgICAgaWYgKEdhbWUuQmFua0FjaGlldmVtZW50cy5sZW5ndGggPT0gMCkgdGhyZXNob2xkID0gMTsKICAgICAgdmFyIGFjaGlldiA9IG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAgIG5hbWUsCiAgICAgICAgbG9jKAogICAgICAgICAgIkJha2UgPGI+JTE8L2I+IGluIG9uZSBhc2NlbnNpb24uIiwKICAgICAgICAgIGxvYygiJTEgY29va2llIiwgeyBuOiB0aHJlc2hvbGQsIGI6IHRvRml4ZWQodGhyZXNob2xkKSB9KQogICAgICAgICkgKyAocSA/ICI8cT4iICsgcSArICI8L3E+IiA6ICIiKSwKICAgICAgICBbCiAgICAgICAgICBHYW1lLnRocmVzaG9sZEljb25zW0dhbWUuQmFua0FjaGlldmVtZW50cy5sZW5ndGhdLAogICAgICAgICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnRzLmxlbmd0aCA+IDQzCiAgICAgICAgICAgID8gMgogICAgICAgICAgICA6IEdhbWUuQmFua0FjaGlldmVtZW50cy5sZW5ndGggPiAzMgogICAgICAgICAgICA/IDEKICAgICAgICAgICAgOiBHYW1lLkJhbmtBY2hpZXZlbWVudHMubGVuZ3RoID4gMjMKICAgICAgICAgICAgPyAyCiAgICAgICAgICAgIDogNSwKICAgICAgICBdCiAgICAgICk7CiAgICAgIGFjaGlldi50aHJlc2hvbGQgPSB0aHJlc2hvbGQ7CiAgICAgIGFjaGlldi5vcmRlciA9IDEwMCArIEdhbWUuQmFua0FjaGlldmVtZW50cy5sZW5ndGggKiAwLjAxOwogICAgICBHYW1lLkJhbmtBY2hpZXZlbWVudHMucHVzaChhY2hpZXYpOwogICAgICByZXR1cm4gYWNoaWV2OwogICAgfTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnRzID0gW107CiAgICBHYW1lLkNwc0FjaGlldmVtZW50ID0gZnVuY3Rpb24gKG5hbWUsIHEpIHsKICAgICAgdmFyIHRocmVzaG9sZCA9IE1hdGgucG93KAogICAgICAgIDEwLAogICAgICAgIE1hdGguZmxvb3IoR2FtZS5DcHNBY2hpZXZlbWVudHMubGVuZ3RoICogMS4yKQogICAgICApOwogICAgICAvL2lmIChHYW1lLkNwc0FjaGlldmVtZW50cy5sZW5ndGg9PTApIHRocmVzaG9sZD0xOwogICAgICB2YXIgYWNoaWV2ID0gbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICAgbmFtZSwKICAgICAgICBsb2MoCiAgICAgICAgICAiQmFrZSA8Yj4lMTwvYj4gcGVyIHNlY29uZC4iLAogICAgICAgICAgbG9jKCIlMSBjb29raWUiLCB7IG46IHRocmVzaG9sZCwgYjogdG9GaXhlZCh0aHJlc2hvbGQpIH0pCiAgICAgICAgKSArIChxID8gIjxxPiIgKyBxICsgIjwvcT4iIDogIiIpLAogICAgICAgIFsKICAgICAgICAgIEdhbWUudGhyZXNob2xkSWNvbnNbR2FtZS5DcHNBY2hpZXZlbWVudHMubGVuZ3RoXSwKICAgICAgICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnRzLmxlbmd0aCA+IDQzCiAgICAgICAgICAgID8gMgogICAgICAgICAgICA6IEdhbWUuQ3BzQWNoaWV2ZW1lbnRzLmxlbmd0aCA+IDMyCiAgICAgICAgICAgID8gMQogICAgICAgICAgICA6IEdhbWUuQ3BzQWNoaWV2ZW1lbnRzLmxlbmd0aCA+IDIzCiAgICAgICAgICAgID8gMgogICAgICAgICAgICA6IDUsCiAgICAgICAgXQogICAgICApOwogICAgICBhY2hpZXYudGhyZXNob2xkID0gdGhyZXNob2xkOwogICAgICBhY2hpZXYub3JkZXIgPSAyMDAgKyBHYW1lLkNwc0FjaGlldmVtZW50cy5sZW5ndGggKiAwLjAxOwogICAgICBHYW1lLkNwc0FjaGlldmVtZW50cy5wdXNoKGFjaGlldik7CiAgICAgIHJldHVybiBhY2hpZXY7CiAgICB9OwoKICAgIC8vZGVmaW5lIGFjaGlldmVtZW50cwogICAgLy9XQVJOSU5HIDogZG8gTk9UIGFkZCBuZXcgYWNoaWV2ZW1lbnRzIGluIGJldHdlZW4sIHRoaXMgYnJlYWtzIHRoZSBzYXZlcy4gQWRkIHRoZW0gYXQgdGhlIGVuZCAhCgogICAgdmFyIG9yZGVyID0gMDsgLy90aGlzIGlzIHVzZWQgdG8gc2V0IHRoZSBvcmRlciBpbiB3aGljaCB0aGUgaXRlbXMgYXJlIGxpc3RlZAoKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJXYWtlIGFuZCBiYWtlIik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiTWFraW5nIHNvbWUgZG91Z2giKTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJTbyBiYWtlZCByaWdodCBub3ciKTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJGbGVkZ2xpbmcgYmFrZXJ5Iik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiQWZmbHVlbnQgYmFrZXJ5Iik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiV29ybGQtZmFtb3VzIGJha2VyeSIpOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIkNvc21pYyBiYWtlcnkiKTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJHYWxhY3RpYyBiYWtlcnkiKTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJVbml2ZXJzYWwgYmFrZXJ5Iik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiVGltZWxlc3MgYmFrZXJ5Iik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiSW5maW5pdGUgYmFrZXJ5Iik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiSW1tb3J0YWwgYmFrZXJ5Iik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiRG9uJ3Qgc3RvcCBtZSBub3ciKTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJZb3UgY2FuIHN0b3Agbm93Iik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiQ29va2llcyBhbGwgdGhlIHdheSBkb3duIik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiT3ZlcmRvc2UiKTsKCiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJDYXN1YWwgYmFraW5nIik7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJIYXJkY29yZSBiYWtpbmciKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIlN0ZWFkeSB0YXN0eSBzdHJlYW0iKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIkNvb2tpZSBtb25zdGVyIik7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJNYXNzIHByb2R1Y2VyIik7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJDb29raWUgdm9ydGV4Iik7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJDb29raWUgcHVsc2FyIik7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJDb29raWUgcXVhc2FyIik7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJPaCBoZXksIHlvdSdyZSBzdGlsbCBoZXJlIik7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJMZXQncyBuZXZlciBiYWtlIGFnYWluIik7CgogICAgb3JkZXIgPSAzMDAxMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiU2FjcmlmaWNlIiwKICAgICAgbG9jKCJBc2NlbmQgd2l0aCA8Yj4lMTwvYj4gYmFrZWQuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWU2KSkpICsKICAgICAgICAiPHE+RWFzeSBjb21lLCBlYXN5IGdvLjwvcT4iLAogICAgICBbMTEsIDZdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJPYmxpdmlvbiIsCiAgICAgIGxvYygiQXNjZW5kIHdpdGggPGI+JTE8L2I+IGJha2VkLiIsIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KDFlOSkpKSArCiAgICAgICAgIjxxPkJhY2sgdG8gc3F1YXJlIG9uZS48L3E+IiwKICAgICAgWzExLCA2XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiRnJvbSBzY3JhdGNoIiwKICAgICAgbG9jKCJBc2NlbmQgd2l0aCA8Yj4lMTwvYj4gYmFrZWQuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUxMikpKSArCiAgICAgICAgIjxxPkl0J3MgYmVlbiBmdW4uPC9xPiIsCiAgICAgIFsxMSwgNl0KICAgICk7CgogICAgb3JkZXIgPSAxMTAxMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiTmV2ZXJjbGljayIsCiAgICAgIGxvYygiTWFrZSA8Yj4lMTwvYj4gYnkgb25seSBoYXZpbmcgY2xpY2tlZCA8Yj4lMiB0aW1lczwvYj4uIiwgWwogICAgICAgIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KDFlNikpLAogICAgICAgIDE1LAogICAgICBdKSwKICAgICAgWzEyLCAwXQogICAgKTsgLy9HYW1lLmxhc3QucG9vbD0nc2hhZG93JzsKICAgIG9yZGVyID0gMTAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQ2xpY2t0YXN0aWMiLAogICAgICBsb2MoIk1ha2UgPGI+JTE8L2I+IGZyb20gY2xpY2tpbmcuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUzKSkpLAogICAgICBbMTEsIDBdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJDbGlja2F0aGxvbiIsCiAgICAgIGxvYygiTWFrZSA8Yj4lMTwvYj4gZnJvbSBjbGlja2luZy4iLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxZTUpKSksCiAgICAgIFsxMSwgMV0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkNsaWNrb2x5bXBpY3MiLAogICAgICBsb2MoIk1ha2UgPGI+JTE8L2I+IGZyb20gY2xpY2tpbmcuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWU3KSkpLAogICAgICBbMTEsIDJdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJDbGlja29yYW1hIiwKICAgICAgbG9jKCJNYWtlIDxiPiUxPC9iPiBmcm9tIGNsaWNraW5nLiIsIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KDFlOSkpKSwKICAgICAgWzExLCAxM10KICAgICk7CgogICAgb3JkZXIgPSAxMDUwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJDbGljayIsCiAgICAgIGxvYygiSGF2ZSA8Yj4lMTwvYj4uIiwgbG9jKCIlMSBjdXJzb3IiLCBMQmVhdXRpZnkoMSkpKSwKICAgICAgWzAsIDBdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJEb3VibGUtY2xpY2siLAogICAgICBsb2MoIkhhdmUgPGI+JTE8L2I+LiIsIGxvYygiJTEgY3Vyc29yIiwgTEJlYXV0aWZ5KDIpKSksCiAgICAgIFswLCA2XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiTW91c2Ugd2hlZWwiLAogICAgICBsb2MoIkhhdmUgPGI+JTE8L2I+LiIsIGxvYygiJTEgY3Vyc29yIiwgTEJlYXV0aWZ5KDUwKSkpLAogICAgICBbMSwgNl0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIk9mIE1pY2UgYW5kIE1lbiIsCiAgICAgIGxvYygiSGF2ZSA8Yj4lMTwvYj4uIiwgbG9jKCIlMSBjdXJzb3IiLCBMQmVhdXRpZnkoMTAwKSkpLAogICAgICBbMCwgMV0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlRoZSBEaWdpdGFsIiwKICAgICAgbG9jKCJIYXZlIDxiPiUxPC9iPi4iLCBsb2MoIiUxIGN1cnNvciIsIExCZWF1dGlmeSgyMDApKSksCiAgICAgIFswLCAyXQogICAgKTsKCiAgICBvcmRlciA9IDEwOTg7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkp1c3Qgd3JvbmciLAogICAgICBsb2MoIlNlbGwgYSBncmFuZG1hLiIpICsgIjxxPkkgdGhvdWdodCB5b3UgbG92ZWQgbWUuPC9xPiIsCiAgICAgIFsxMCwgOV0KICAgICk7CiAgICBvcmRlciA9IDExMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJHcmFuZG1hJ3MgY29va2llcyIsICIiLCAiR3JhbmRtYSIsIDEpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiU2xvcHB5IGtpc3NlcyIsICIiLCAiR3JhbmRtYSIsIDIpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiUmV0aXJlbWVudCBob21lIiwgIiIsICJHcmFuZG1hIiwgMyk7CgogICAgb3JkZXIgPSAxMjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiQm91Z2h0IHRoZSBmYXJtIiwgIiIsICJGYXJtIiwgMSk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJSZWFwIHdoYXQgeW91IHNvdyIsICIiLCAiRmFybSIsIDIpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiRmFybSBpbGwiLCAiIiwgIkZhcm0iLCAzKTsKCiAgICBvcmRlciA9IDE0MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJQcm9kdWN0aW9uIGNoYWluIiwgIiIsICJGYWN0b3J5IiwgMSk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJJbmR1c3RyaWFsIHJldm9sdXRpb24iLCAiIiwgIkZhY3RvcnkiLCAyKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkdsb2JhbCB3YXJtaW5nIiwgIiIsICJGYWN0b3J5IiwgMyk7CgogICAgb3JkZXIgPSAxMzAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiWW91IGtub3cgdGhlIGRyaWxsIiwgIiIsICJNaW5lIiwgMSk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJFeGNhdmF0aW9uIHNpdGUiLCAiIiwgIk1pbmUiLCAyKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkhvbGxvdyB0aGUgcGxhbmV0IiwgIiIsICJNaW5lIiwgMyk7CgogICAgb3JkZXIgPSAxNTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiRXhwZWRpdGlvbiIsICIiLCAiU2hpcG1lbnQiLCAxKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkdhbGFjdGljIGhpZ2h3YXkiLCAiIiwgIlNoaXBtZW50IiwgMik7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJGYXIgZmFyIGF3YXkiLCAiIiwgIlNoaXBtZW50IiwgMyk7CgogICAgb3JkZXIgPSAxNjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiVHJhbnNtdXRhdGlvbiIsICIiLCAiQWxjaGVteSBsYWIiLCAxKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlRyYW5zbW9ncmlmaWNhdGlvbiIsICIiLCAiQWxjaGVteSBsYWIiLCAyKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkdvbGQgbWVtYmVyIiwgIiIsICJBbGNoZW15IGxhYiIsIDMpOwoKICAgIG9yZGVyID0gMTcwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkEgd2hvbGUgbmV3IHdvcmxkIiwgIiIsICJQb3J0YWwiLCAxKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIk5vdyB5b3UncmUgdGhpbmtpbmciLCAiIiwgIlBvcnRhbCIsIDIpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiRGltZW5zaW9uYWwgc2hpZnQiLCAiIiwgIlBvcnRhbCIsIDMpOwoKICAgIG9yZGVyID0gMTgwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlRpbWUgd2FycCIsICIiLCAiVGltZSBtYWNoaW5lIiwgMSk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJBbHRlcm5hdGUgdGltZWxpbmUiLCAiIiwgIlRpbWUgbWFjaGluZSIsIDIpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiUmV3cml0aW5nIGhpc3RvcnkiLCAiIiwgIlRpbWUgbWFjaGluZSIsIDMpOwoKICAgIG9yZGVyID0gNzAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiT25lIHdpdGggZXZlcnl0aGluZyIsCiAgICAgIGxvYygiSGF2ZSA8Yj5hdCBsZWFzdCAlMTwvYj4gb2YgZXZlcnkgYnVpbGRpbmcuIiwgMSksCiAgICAgIFsyLCA3XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiTWF0aGVtYXRpY2lhbiIsCiAgICAgIGxvYygKICAgICAgICAiSGF2ZSBhdCBsZWFzdCA8Yj4xIG9mIHRoZSBtb3N0IGV4cGVuc2l2ZSBvYmplY3QsIDIgb2YgdGhlIHNlY29uZC1tb3N0IGV4cGVuc2l2ZSwgNCBvZiB0aGUgbmV4dDwvYj4gYW5kIHNvIG9uIChjYXBwZWQgYXQgJTEpLiIsCiAgICAgICAgMTI4CiAgICAgICksCiAgICAgIFsyMywgMTJdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJCYXNlIDEwIiwKICAgICAgbG9jKAogICAgICAgICJIYXZlIGF0IGxlYXN0IDxiPjEwIG9mIHRoZSBtb3N0IGV4cGVuc2l2ZSBvYmplY3QsIDIwIG9mIHRoZSBzZWNvbmQtbW9zdCBleHBlbnNpdmUsIDMwIG9mIHRoZSBuZXh0PC9iPiBhbmQgc28gb24uIgogICAgICApLAogICAgICBbMjMsIDEyXQogICAgKTsKCiAgICBvcmRlciA9IDEwMDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJHb2xkZW4gY29va2llIiwKICAgICAgbG9jKCJDbGljayBhIDxiPmdvbGRlbiBjb29raWU8L2I+LiIpLAogICAgICBbMTAsIDE0XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiTHVja3kgY29va2llIiwKICAgICAgbG9jKCJDbGljayA8Yj4lMTwvYj4uIiwgbG9jKCIlMSBnb2xkZW4gY29va2llIiwgTEJlYXV0aWZ5KDcpKSksCiAgICAgIFsyMiwgNl0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkEgc3Ryb2tlIG9mIGx1Y2siLAogICAgICBsb2MoIkNsaWNrIDxiPiUxPC9iPi4iLCBsb2MoIiUxIGdvbGRlbiBjb29raWUiLCBMQmVhdXRpZnkoMjcpKSksCiAgICAgIFsyMywgNl0KICAgICk7CgogICAgb3JkZXIgPSAzMDIwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQ2hlYXRlZCBjb29raWVzIHRhc3RlIGF3ZnVsIiwKICAgICAgbG9jKCJIYWNrIGluIHNvbWUgY29va2llcy4iKSwKICAgICAgWzEwLCA2XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInNoYWRvdyI7CiAgICBvcmRlciA9IDExMDEwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJVbmNhbm55IGNsaWNrZXIiLAogICAgICBsb2MoIkNsaWNrIHJlYWxseSwgcmVhbGx5IGZhc3QuIikgKyAiPHE+V2VsbCBJJ2xsIGJlITwvcT4iLAogICAgICBbMTIsIDBdCiAgICApOwoKICAgIG9yZGVyID0gNTAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQnVpbGRlciIsCiAgICAgIGxvYygiT3duIDxiPiUxPC9iPi4iLCBsb2MoIiUxIGJ1aWxkaW5nIiwgTEJlYXV0aWZ5KDEwMCkpKSwKICAgICAgWzIsIDZdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJBcmNoaXRlY3QiLAogICAgICBsb2MoIk93biA8Yj4lMTwvYj4uIiwgbG9jKCIlMSBidWlsZGluZyIsIExCZWF1dGlmeSg1MDApKSksCiAgICAgIFszLCA2XQogICAgKTsKICAgIG9yZGVyID0gNjAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiRW5oYW5jZXIiLAogICAgICBsb2MoIlB1cmNoYXNlIDxiPiUxPC9iPi4iLCBsb2MoIiUxIHVwZ3JhZGUiLCBMQmVhdXRpZnkoMjApKSksCiAgICAgIFs5LCAwXQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQXVnbWVudGVyIiwKICAgICAgbG9jKCJQdXJjaGFzZSA8Yj4lMTwvYj4uIiwgbG9jKCIlMSB1cGdyYWRlIiwgTEJlYXV0aWZ5KDUwKSkpLAogICAgICBbOSwgMV0KICAgICk7CgogICAgb3JkZXIgPSAxMTAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQ29va2llLWR1bmtlciIsCiAgICAgIGxvYygiRHVuayB0aGUgY29va2llLiIpICsgIjxxPllvdSBkaWQgaXQhPC9xPiIsCiAgICAgIFsxLCA4XQogICAgKTsKCiAgICBvcmRlciA9IDEwMDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJGb3J0dW5lIiwKICAgICAgbG9jKCJDbGljayA8Yj4lMTwvYj4uIiwgbG9jKCIlMSBnb2xkZW4gY29va2llIiwgTEJlYXV0aWZ5KDc3KSkpICsKICAgICAgICAiPHE+WW91IHNob3VsZCByZWFsbHkgZ28gdG8gYmVkLjwvcT4iLAogICAgICBbMjQsIDZdCiAgICApOwogICAgb3JkZXIgPSAzMTAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiVHJ1ZSBOZXZlcmNsaWNrIiwKICAgICAgbG9jKAogICAgICAgICJNYWtlIDxiPiUxPC9iPiB3aXRoIDxiPm5vPC9iPiBjb29raWUgY2xpY2tzLiIsCiAgICAgICAgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWU2KSkKICAgICAgKSArICI8cT5UaGlzIGtpbmRhIGRlZmVhdHMgdGhlIHdob2xlIHB1cnBvc2UsIGRvZXNuJ3QgaXQ/PC9xPiIsCiAgICAgIFsxMiwgMF0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJzaGFkb3ciOwoKICAgIG9yZGVyID0gMjAwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkVsZGVyIG5hcCIsCiAgICAgIGxvYygiQXBwZWFzZSB0aGUgZ3JhbmRtYXRyaWFyY2hzIGF0IGxlYXN0IDxiPm9uY2U8L2I+LiIpICsKICAgICAgICAiPHE+d2U8YnI+YXJlPGJyPmV0ZXJuYWw8L3E+IiwKICAgICAgWzgsIDldCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJFbGRlciBzbHVtYmVyIiwKICAgICAgbG9jKCJBcHBlYXNlIHRoZSBncmFuZG1hdHJpYXJjaHMgYXQgbGVhc3QgPGI+JTEgdGltZXM8L2I+LiIsIDUpICsKICAgICAgICAiPHE+b3VyIG1pbmQ8YnI+b3V0bGl2ZXM8YnI+dGhlIHVuaXZlcnNlPC9xPiIsCiAgICAgIFs4LCA5XQogICAgKTsKCiAgICBvcmRlciA9IDEwOTg7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkVsZGVyIiwKICAgICAgbG9jKCJPd24gYXQgbGVhc3QgPGI+JTE8L2I+IGdyYW5kbWEgdHlwZXMuIiwgNyksCiAgICAgIFsxMCwgOV0KICAgICk7CgogICAgb3JkZXIgPSAyMDAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiRWxkZXIgY2FsbSIsCiAgICAgIGxvYygiRGVjbGFyZSBhIGNvdmVuYW50IHdpdGggdGhlIGdyYW5kbWF0cmlhcmNocy4iKSArCiAgICAgICAgIjxxPndlPGJyPmhhdmU8YnI+ZmVkPC9xPiIsCiAgICAgIFs4LCA5XQogICAgKTsKCiAgICBvcmRlciA9IDUwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkVuZ2luZWVyIiwKICAgICAgbG9jKCJPd24gPGI+JTE8L2I+LiIsIGxvYygiJTEgYnVpbGRpbmciLCBMQmVhdXRpZnkoMTAwMCkpKSwKICAgICAgWzQsIDZdCiAgICApOwoKICAgIG9yZGVyID0gMTAwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkxlcHJlY2hhdW4iLAogICAgICBsb2MoIkNsaWNrIDxiPiUxPC9iPi4iLCBsb2MoIiUxIGdvbGRlbiBjb29raWUiLCBMQmVhdXRpZnkoNzc3KSkpLAogICAgICBbMjUsIDZdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJCbGFjayBjYXQncyBwYXciLAogICAgICBsb2MoIkNsaWNrIDxiPiUxPC9iPi4iLCBsb2MoIiUxIGdvbGRlbiBjb29raWUiLCBMQmVhdXRpZnkoNzc3NykpKSwKICAgICAgWzI2LCA2XQogICAgKTsKCiAgICBvcmRlciA9IDMwMDUwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJOaWhpbGlzbSIsCiAgICAgIGxvYygiQXNjZW5kIHdpdGggPGI+JTE8L2I+IGJha2VkLiIsIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KDFlMTUpKSkgKwogICAgICAgICI8cT5UaGVyZSBhcmUgbWFueSB0aGluZ3M8YnI+dGhhdCBuZWVkIHRvIGJlIGVyYXNlZDwvcT4iLAogICAgICBbMTEsIDddCiAgICApOwoKICAgIG9yZGVyID0gMTkwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkFudGliYXR0ZXIiLCAiIiwgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwgMSk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJRdWlya3kgcXVhcmtzIiwgIiIsICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsIDIpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiSXQgZG9lcyBtYXR0ZXIhIiwgIiIsICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsIDMpOwoKICAgIG9yZGVyID0gNjAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiVXBncmFkZXIiLAogICAgICBsb2MoIlB1cmNoYXNlIDxiPiUxPC9iPi4iLCBsb2MoIiUxIHVwZ3JhZGUiLCBMQmVhdXRpZnkoMTAwKSkpLAogICAgICBbOSwgMl0KICAgICk7CgogICAgb3JkZXIgPSA3MDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJDZW50ZW5uaWFsIiwKICAgICAgbG9jKCJIYXZlIGF0IGxlYXN0IDxiPiUxIG9mIGV2ZXJ5dGhpbmc8L2I+LiIsIDEwMCksCiAgICAgIFs2LCA2XQogICAgKTsKCiAgICBvcmRlciA9IDMwNTAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJIYXJkY29yZSIsCiAgICAgIGxvYygKICAgICAgICAiR2V0IHRvIDxiPiUxPC9iPiBiYWtlZCB3aXRoIDxiPm5vIHVwZ3JhZGVzIHB1cmNoYXNlZDwvYj4uIiwKICAgICAgICBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxZTkpKQogICAgICApLAogICAgICBbMTIsIDZdCiAgICApOyAvL0dhbWUubGFzdC5wb29sPSdzaGFkb3cnOwoKICAgIG9yZGVyID0gMzA2MDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlNwZWVkIGJha2luZyBJIiwKICAgICAgbG9jKCJHZXQgdG8gPGI+JTE8L2I+IGJha2VkIGluIDxiPiUyPC9iPi4iLCBbCiAgICAgICAgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWU2KSksCiAgICAgICAgR2FtZS5zYXlUaW1lKDYwICogMzUgKiBHYW1lLmZwcyksCiAgICAgIF0pLAogICAgICBbMTIsIDVdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAic2hhZG93IjsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiU3BlZWQgYmFraW5nIElJIiwKICAgICAgbG9jKCJHZXQgdG8gPGI+JTE8L2I+IGJha2VkIGluIDxiPiUyPC9iPi4iLCBbCiAgICAgICAgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWU2KSksCiAgICAgICAgR2FtZS5zYXlUaW1lKDYwICogMjUgKiBHYW1lLmZwcyksCiAgICAgIF0pLAogICAgICBbMTMsIDVdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAic2hhZG93IjsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiU3BlZWQgYmFraW5nIElJSSIsCiAgICAgIGxvYygiR2V0IHRvIDxiPiUxPC9iPiBiYWtlZCBpbiA8Yj4lMjwvYj4uIiwgWwogICAgICAgIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KDFlNikpLAogICAgICAgIEdhbWUuc2F5VGltZSg2MCAqIDE1ICogR2FtZS5mcHMpLAogICAgICBdKSwKICAgICAgWzE0LCA1XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInNoYWRvdyI7CgogICAgb3JkZXIgPSA2MTAwMDsKICAgIHZhciBhY2hpZXYgPSBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkdldHRpbmcgZXZlbiB3aXRoIHRoZSBvdmVuIiwKICAgICAgRU4KICAgICAgICA/ICJEZWZlYXQgdGhlIDxiPlNlbnRpZW50IEZ1cm5hY2U8L2I+IGluIHRoZSBmYWN0b3J5IGR1bmdlb25zLiIKICAgICAgICA6ICI/Pz8iLAogICAgICBbMTIsIDddCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAiZHVuZ2VvbiI7CiAgICB2YXIgYWNoaWV2ID0gbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJOb3cgdGhpcyBpcyBwb2Qtc21hc2hpbmciLAogICAgICBFTgogICAgICAgID8gIkRlZmVhdCB0aGUgPGI+QXNjZW5kZWQgQmFraW5nIFBvZDwvYj4gaW4gdGhlIGZhY3RvcnkgZHVuZ2VvbnMuIgogICAgICAgIDogIj8/PyIsCiAgICAgIFsxMiwgN10KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJkdW5nZW9uIjsKICAgIHZhciBhY2hpZXYgPSBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkNoaXJwZWQgb3V0IiwKICAgICAgRU4KICAgICAgICA/ICJGaW5kIGFuZCBkZWZlYXQgPGI+Q2hpcnB5PC9iPiwgdGhlIGR5c2Z1bmN0aW9ubmluZyBhbGFybSBib3QuIgogICAgICAgIDogIj8/PyIsCiAgICAgIFsxMywgN10KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJkdW5nZW9uIjsKICAgIHZhciBhY2hpZXYgPSBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkZvbGxvdyB0aGUgd2hpdGUgcmFiYml0IiwKICAgICAgRU4gPyAiRmluZCBhbmQgZGVmZWF0IHRoZSBlbHVzaXZlIDxiPnN1Z2FyIGJ1bm55PC9iPi4iIDogIj8/PyIsCiAgICAgIFsxNCwgN10KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJkdW5nZW9uIjsKCiAgICBvcmRlciA9IDEwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkNsaWNrYXNtaWMiLAogICAgICBsb2MoIk1ha2UgPGI+JTE8L2I+IGZyb20gY2xpY2tpbmcuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUxMSkpKSwKICAgICAgWzExLCAxNF0KICAgICk7CgogICAgb3JkZXIgPSAxMTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiRnJpZW5kIG9mIHRoZSBhbmNpZW50cyIsICIiLCAiR3JhbmRtYSIsIDQpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiUnVsZXIgb2YgdGhlIGFuY2llbnRzIiwgIiIsICJHcmFuZG1hIiwgNSk7CgogICAgb3JkZXIgPSAzMjAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiV2hvbGVzb21lIiwKICAgICAgbG9jKCJVbmxvY2sgPGI+MTAwJTwvYj4gb2YgeW91ciBoZWF2ZW5seSBjaGlwcyBwb3dlci4iKSwKICAgICAgWzE1LCA3XQogICAgKTsKCiAgICBvcmRlciA9IDMzMDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJKdXN0IHBsYWluIGx1Y2t5IiwKICAgICAgbG9jKAogICAgICAgICJZb3UgaGF2ZSA8Yj4xIGNoYW5jZSBpbiAlMTwvYj4gZXZlcnkgc2Vjb25kIG9mIGVhcm5pbmcgdGhpcyBhY2hpZXZlbWVudC4iLAogICAgICAgIEJlYXV0aWZ5KDEwMDAwMDApCiAgICAgICksCiAgICAgIFsxNSwgNl0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJzaGFkb3ciOwoKICAgIG9yZGVyID0gMjEwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkl0Y2hzY3JhdGNoZXIiLAogICAgICBsb2MoIkJ1cnN0IDxiPjEgd3JpbmtsZXI8L2I+LiIpLAogICAgICBbMTksIDhdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJXcmlua2xlc3F1aXNoZXIiLAogICAgICBsb2MoIkJ1cnN0IDxiPiUxIHdyaW5rbGVyczwvYj4uIiwgNTApLAogICAgICBbMTksIDhdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJNb2lzdGJ1cnN0ZXIiLAogICAgICBsb2MoIkJ1cnN0IDxiPiUxIHdyaW5rbGVyczwvYj4uIiwgMjAwKSwKICAgICAgWzE5LCA4XQogICAgKTsKCiAgICBvcmRlciA9IDIyMDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJTcG9va3kgY29va2llcyIsCiAgICAgIGxvYygKICAgICAgICAnVW5sb2NrIDxiPmV2ZXJ5IEhhbGxvd2Vlbi10aGVtZWQgY29va2llPC9iPi48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj5Pd25pbmcgdGhpcyBhY2hpZXZlbWVudCBtYWtlcyBIYWxsb3dlZW4tdGhlbWVkIGNvb2tpZXMgZHJvcCBtb3JlIGZyZXF1ZW50bHkgaW4gZnV0dXJlIHBsYXl0aHJvdWdocy4nCiAgICAgICksCiAgICAgIFsxMiwgOF0KICAgICk7CgogICAgb3JkZXIgPSAyMjEwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQ29taW5nIHRvIHRvd24iLAogICAgICBsb2MoIlJlYWNoIDxiPlNhbnRhJ3MgN3RoIGZvcm08L2I+LiIpLAogICAgICBbMTgsIDldCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJBbGwgaGFpbCBTYW50YSIsCiAgICAgIGxvYygiUmVhY2ggPGI+U2FudGEncyBmaW5hbCBmb3JtPC9iPi4iKSwKICAgICAgWzE5LCAxMF0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkxldCBpdCBzbm93IiwKICAgICAgbG9jKAogICAgICAgICdVbmxvY2sgPGI+ZXZlcnkgQ2hyaXN0bWFzLXRoZW1lZCBjb29raWU8L2I+LjxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2Pk93bmluZyB0aGlzIGFjaGlldmVtZW50IG1ha2VzIENocmlzdG1hcy10aGVtZWQgY29va2llcyBkcm9wIG1vcmUgZnJlcXVlbnRseSBpbiBmdXR1cmUgcGxheXRocm91Z2hzLicKICAgICAgKSwKICAgICAgWzE5LCA5XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KCJPaCBkZWVyIiwgbG9jKCJQb3AgPGI+MSByZWluZGVlcjwvYj4uIiksIFsxMiwgOV0pOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJTbGVpZ2ggb2YgaGFuZCIsCiAgICAgIGxvYygiUG9wIDxiPiUxIHJlaW5kZWVyPC9iPi4iLCA1MCksCiAgICAgIFsxMiwgOV0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlJlaW5kZWVyIHNsZWlnaGVyIiwKICAgICAgbG9jKCJQb3AgPGI+JTEgcmVpbmRlZXI8L2I+LiIsIDIwMCksCiAgICAgIFsxMiwgOV0KICAgICk7CgogICAgb3JkZXIgPSAxMjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiUGVyZmVjdGVkIGFncmljdWx0dXJlIiwgIiIsICJGYXJtIiwgNCk7CiAgICBvcmRlciA9IDE0MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJVbHRpbWF0ZSBhdXRvbWF0aW9uIiwgIiIsICJGYWN0b3J5IiwgNCk7CiAgICBvcmRlciA9IDEzMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJDYW4geW91IGRpZyBpdCIsICIiLCAiTWluZSIsIDQpOwogICAgb3JkZXIgPSAxNTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiVHlwZSBJSSBjaXZpbGl6YXRpb24iLCAiIiwgIlNoaXBtZW50IiwgNCk7CiAgICBvcmRlciA9IDE2MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJHaWxkIHdhcnMiLCAiIiwgIkFsY2hlbXkgbGFiIiwgNCk7CiAgICBvcmRlciA9IDE3MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJCcmFpbi1zcGxpdCIsICIiLCAiUG9ydGFsIiwgNCk7CiAgICBvcmRlciA9IDE4MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJUaW1lIGR1a2UiLCAiIiwgIlRpbWUgbWFjaGluZSIsIDQpOwogICAgb3JkZXIgPSAxOTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTW9sZWN1bGFyIG1hZXN0cm8iLCAiIiwgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwgNCk7CgogICAgb3JkZXIgPSAyMDAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTG9uZSBwaG90b24iLCAiIiwgIlByaXNtIiwgMSk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJEYXp6bGluZyBnbGltbWVyIiwgIiIsICJQcmlzbSIsIDIpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiQmxpbmRpbmcgZmxhc2giLCAiIiwgIlByaXNtIiwgMyk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJVbmVuZGluZyBnbG93IiwgIiIsICJQcmlzbSIsIDQpOwoKICAgIG9yZGVyID0gNTAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiTG9yZCBvZiBDb25zdHJ1Y3RzIiwKICAgICAgbG9jKCJPd24gPGI+JTE8L2I+LiIsIGxvYygiJTEgYnVpbGRpbmciLCBMQmVhdXRpZnkoMjUwMCkpKSArCiAgICAgICAgIjxxPkhlIHNhdyB0aGUgdmFzdCBwbGFpbnMgc3RyZXRjaGluZyBhaGVhZCBvZiBoaW0sIGFuZCBoZSBzYWlkIDogbGV0IHRoZXJlIGJlIGNpdmlsaXphdGlvbi48L3E+IiwKICAgICAgWzUsIDZdCiAgICApOwogICAgb3JkZXIgPSA2MDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJMb3JkIG9mIFByb2dyZXNzIiwKICAgICAgbG9jKCJQdXJjaGFzZSA8Yj4lMTwvYj4uIiwgbG9jKCIlMSB1cGdyYWRlIiwgTEJlYXV0aWZ5KDIwMCkpKSArCiAgICAgICAgIjxxPk9uZSBjYW4gYWx3YXlzIGRvIGJldHRlci4gQnV0IHNob3VsZCB5b3U/PC9xPiIsCiAgICAgIFs5LCAxNF0KICAgICk7CiAgICBvcmRlciA9IDcwMDI7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkJpY2VudGVubmlhbCIsCiAgICAgIGxvYygiSGF2ZSBhdCBsZWFzdCA8Yj4lMSBvZiBldmVyeXRoaW5nPC9iPi4iLCAyMDApICsKICAgICAgICAiPHE+WW91IGNyYXp5IHBlcnNvbi48L3E+IiwKICAgICAgWzgsIDZdCiAgICApOwoKICAgIG9yZGVyID0gMjIzMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkxvdmVseSBjb29raWVzIiwKICAgICAgbG9jKCJVbmxvY2sgPGI+ZXZlcnkgVmFsZW50aW5lLXRoZW1lZCBjb29raWU8L2I+LiIpLAogICAgICBbMjAsIDNdCiAgICApOwoKICAgIG9yZGVyID0gNzAwMTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQ2VudGVubmlhbCBhbmQgYSBoYWxmIiwKICAgICAgbG9jKCJIYXZlIGF0IGxlYXN0IDxiPiUxIG9mIGV2ZXJ5dGhpbmc8L2I+LiIsIDE1MCksCiAgICAgIFs3LCA2XQogICAgKTsKCiAgICBvcmRlciA9IDExMDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJUaW55IGNvb2tpZSIsCiAgICAgIGxvYygiQ2xpY2sgdGhlIHRpbnkgY29va2llLiIpICsKICAgICAgICAiPHE+VGhlc2UgYXJlbid0IHRoZSBjb29raWVzPGJyPnlvdSdyZSBjbGlja2luZyBmb3IuPC9xPiIsCiAgICAgIFswLCA1XQogICAgKTsKCiAgICBvcmRlciA9IDQwMDAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiWW91IHdpbiBhIGNvb2tpZSIsCiAgICAgIGxvYygKICAgICAgICAiVGhpcyBpcyBmb3IgYmFraW5nICUxIGFuZCBtYWtpbmcgaXQgb24gdGhlIGxvY2FsIG5ld3MuIiwKICAgICAgICBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxZTE0KSkKICAgICAgKSArICI8cT5XZSdyZSBhbGwgc28gcHJvdWQgb2YgeW91LjwvcT4iLAogICAgICBbMTAsIDBdCiAgICApOwoKICAgIG9yZGVyID0gMTA3MDsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJDbGljayBkZWxlZ2F0b3IiLCAiQ3Vyc29yIiwgMSwgMCwgNyk7CiAgICBvcmRlciA9IDExMjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiR3VzaGluZyBncmFubmllcyIsICJHcmFuZG1hIiwgMSwgMCwgNik7CiAgICBvcmRlciA9IDEyMjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiSSBoYXRlIG1hbnVyZSIsICJGYXJtIiwgMSk7CiAgICBvcmRlciA9IDEzMjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiTmV2ZXIgZGlnIGRvd24iLCAiTWluZSIsIDEpOwogICAgb3JkZXIgPSAxNDIwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIlRoZSBpbmNyZWRpYmxlIG1hY2hpbmUiLCAiRmFjdG9yeSIsIDEpOwogICAgb3JkZXIgPSAxNTIwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIkFuZCBiZXlvbmQiLCAiU2hpcG1lbnQiLCAxKTsKICAgIG9yZGVyID0gMTYyMDsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJNYWdudW0gT3B1cyIsICJBbGNoZW15IGxhYiIsIDEpOwogICAgb3JkZXIgPSAxNzIwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIldpdGggc3RyYW5nZSBlb25zIiwgIlBvcnRhbCIsIDEpOwogICAgb3JkZXIgPSAxODIwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIlNwYWNldGltZSBqaWdhbWFyb28iLCAiVGltZSBtYWNoaW5lIiwgMSk7CiAgICBvcmRlciA9IDE5MjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiU3VwZXJtYXNzaXZlIiwgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwgMSk7CiAgICBvcmRlciA9IDIwMjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiUHJhaXNlIHRoZSBzdW4iLCAiUHJpc20iLCAxKTsKCiAgICBvcmRlciA9IDEwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkNsaWNrYWdlZGRvbiIsCiAgICAgIGxvYygiTWFrZSA8Yj4lMTwvYj4gZnJvbSBjbGlja2luZy4iLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxZTEzKSkpLAogICAgICBbMTEsIDE1XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQ2xpY2tuYXJvayIsCiAgICAgIGxvYygiTWFrZSA8Yj4lMTwvYj4gZnJvbSBjbGlja2luZy4iLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxZTE1KSkpLAogICAgICBbMTEsIDE2XQogICAgKTsKCiAgICBvcmRlciA9IDEwNTA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkV4dHJlbWUgcG9seWRhY3R5bHkiLAogICAgICBsb2MoIkhhdmUgPGI+JTE8L2I+LiIsIGxvYygiJTEgY3Vyc29yIiwgTEJlYXV0aWZ5KDMwMCkpKSwKICAgICAgWzAsIDEzXQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiRHIuIFQiLAogICAgICBsb2MoIkhhdmUgPGI+JTE8L2I+LiIsIGxvYygiJTEgY3Vyc29yIiwgTEJlYXV0aWZ5KDQwMCkpKSwKICAgICAgWzAsIDE0XQogICAgKTsKCiAgICBvcmRlciA9IDExMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KAogICAgICAiVGhlIG9sZCBuZXZlciBib3RoZXJlZCBtZSBhbnl3YXkiLAogICAgICAiIiwKICAgICAgIkdyYW5kbWEiLAogICAgICA2CiAgICApOwogICAgb3JkZXIgPSAxMjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiSG9tZWdyb3duIiwgIiIsICJGYXJtIiwgNSk7CiAgICBvcmRlciA9IDE0MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJUZWNobm9jcmFjeSIsICIiLCAiRmFjdG9yeSIsIDUpOwogICAgb3JkZXIgPSAxMzAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiVGhlIGNlbnRlciBvZiB0aGUgRWFydGgiLCAiIiwgIk1pbmUiLCA1KTsKICAgIG9yZGVyID0gMTUwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIldlIGNvbWUgaW4gcGVhY2UiLCAiIiwgIlNoaXBtZW50IiwgNSk7CiAgICBvcmRlciA9IDE2MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJUaGUgc2VjcmV0cyBvZiB0aGUgdW5pdmVyc2UiLCAiIiwgIkFsY2hlbXkgbGFiIiwgNSk7CiAgICBvcmRlciA9IDE3MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJSZWFsbSBvZiB0aGUgTWFkIEdvZCIsICIiLCAiUG9ydGFsIiwgNSk7CiAgICBvcmRlciA9IDE4MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJGb3JldmVyIGFuZCBldmVyIiwgIiIsICJUaW1lIG1hY2hpbmUiLCA1KTsKICAgIG9yZGVyID0gMTkwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIldhbGsgdGhlIHBsYW5jayIsICIiLCAiQW50aW1hdHRlciBjb25kZW5zZXIiLCA1KTsKICAgIG9yZGVyID0gMjAwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlJpc2UgYW5kIHNoaW5lIiwgIiIsICJQcmlzbSIsIDUpOwoKICAgIG9yZGVyID0gMzAyMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkdvZCBjb21wbGV4IiwKICAgICAgbG9jKAogICAgICAgICdOYW1lIHlvdXJzZWxmIDxiPk9ydGVpbDwvYj4uPGRpdiBjbGFzcz0id2FybmluZyI+Tm90ZTogdXN1cnBlcnMgaW5jdXIgYSAtJTElIENwUyBwZW5hbHR5IHVudGlsIHRoZXkgcmVuYW1lIHRoZW1zZWx2ZXMgc29tZXRoaW5nIGVsc2UuPC9kaXY+JywKICAgICAgICAxCiAgICAgICkgKyAiPHE+QnV0IHRoYXQncyBub3QgeW91LCBpcyBpdD88L3E+IiwKICAgICAgWzE3LCA1XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInNoYWRvdyI7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlRoaXJkLXBhcnR5IiwKICAgICAgbG9jKCJVc2UgYW4gPGI+YWRkLW9uPC9iPi4iKSArCiAgICAgICAgIjxxPlNvbWUgZmluZCB2YW5pbGxhIHRvIGJlIHRoZSBtb3N0IGJvcmluZyBmbGF2b3IuPC9xPiIsCiAgICAgIFsxNiwgNV0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJzaGFkb3ciOyAvL2lmIHlvdSdyZSBtYWtpbmcgYSBtb2QsIGFkZCBhIEdhbWUuV2luKCdUaGlyZC1wYXJ0eScpIHNvbWV3aGVyZSBpbiB0aGVyZSEKCiAgICBvcmRlciA9IDMwMDUwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJEZW1hdGVyaWFsaXplIiwKICAgICAgbG9jKCJBc2NlbmQgd2l0aCA8Yj4lMTwvYj4gYmFrZWQuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUxOCkpKSArCiAgICAgICAgIjxxPlByZXN0byE8YnI+Li4ud2hlcmUnZCB0aGUgY29va2llcyBnbz88L3E+IiwKICAgICAgWzExLCA3XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiTmlsIHplcm8gemlsY2giLAogICAgICBsb2MoIkFzY2VuZCB3aXRoIDxiPiUxPC9iPiBiYWtlZC4iLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxZTIxKSkpICsKICAgICAgICAiPHE+VG8gc3VtbWFyaXplIDogcmVhbGx5IG5vdCB2ZXJ5IG11Y2ggYXQgYWxsLjwvcT4iLAogICAgICBbMTEsIDddCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJUcmFuc2NlbmRlbmNlIiwKICAgICAgbG9jKCJBc2NlbmQgd2l0aCA8Yj4lMTwvYj4gYmFrZWQuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUyNCkpKSArCiAgICAgICAgIjxxPllvdXIgY29va2llcyBhcmUgbm93IG9uIGEgaGlnaGVyIHBsYW5lIG9mIGJlaW5nLjwvcT4iLAogICAgICBbMTEsIDhdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJPYmxpdGVyYXRlIiwKICAgICAgbG9jKCJBc2NlbmQgd2l0aCA8Yj4lMTwvYj4gYmFrZWQuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUyNykpKSArCiAgICAgICAgIjxxPlJlc2lzdGFuY2UgaXMgZnV0aWxlLCBhbGJlaXQgZW50ZXJ0YWluaW5nLjwvcT4iLAogICAgICBbMTEsIDhdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJOZWdhdGl2ZSB2b2lkIiwKICAgICAgbG9jKCJBc2NlbmQgd2l0aCA8Yj4lMTwvYj4gYmFrZWQuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUzMCkpKSArCiAgICAgICAgIjxxPllvdSBub3cgaGF2ZSBzbyBmZXcgY29va2llcyB0aGF0IGl0J3MgYWxtb3N0IGxpa2UgeW91IGhhdmUgYSBuZWdhdGl2ZSBhbW91bnQgb2YgdGhlbS48L3E+IiwKICAgICAgWzExLCA4XQogICAgKTsKCiAgICBvcmRlciA9IDIyNDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJUaGUgaHVudCBpcyBvbiIsCiAgICAgIGxvYygiVW5sb2NrIDxiPjEgZWdnPC9iPi4iKSwKICAgICAgWzEsIDEyXQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiRWdnaW5nIG9uIiwKICAgICAgbG9jKCJVbmxvY2sgPGI+JTEgZWdnczwvYj4uIiwgNyksCiAgICAgIFs0LCAxMl0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIk1hc3MgRWFzdGVyaWEiLAogICAgICBsb2MoIlVubG9jayA8Yj4lMSBlZ2dzPC9iPi4iLCAxNCksCiAgICAgIFs3LCAxMl0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkhpZGUgJiBzZWVrIGNoYW1waW9uIiwKICAgICAgbG9jKAogICAgICAgICdVbmxvY2sgPGI+YWxsIHRoZSBlZ2dzPC9iPi48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj5Pd25pbmcgdGhpcyBhY2hpZXZlbWVudCBtYWtlcyBlZ2dzIGRyb3AgbW9yZSBmcmVxdWVudGx5IGluIGZ1dHVyZSBwbGF5dGhyb3VnaHMuJwogICAgICApLAogICAgICBbMTMsIDEyXQogICAgKTsKCiAgICBvcmRlciA9IDExMDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJXaGF0J3MgaW4gYSBuYW1lIiwKICAgICAgbG9jKCJHaXZlIHlvdXIgYmFrZXJ5IGEgbmFtZS4iKSwKICAgICAgWzE1LCA5XQogICAgKTsKCiAgICBvcmRlciA9IDE0MjU7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJQcmV0dHkgcGVubnkiLCAiIiwgIkJhbmsiLCAxKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkZpdCB0aGUgYmlsbCIsICIiLCAiQmFuayIsIDIpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiQSBsb2FuIGluIHRoZSBkYXJrIiwgIiIsICJCYW5rIiwgMyk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJOZWVkIGZvciBncmVlZCIsICIiLCAiQmFuayIsIDQpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiSXQncyB0aGUgZWNvbm9teSwgc3R1cGlkIiwgIiIsICJCYW5rIiwgNSk7CiAgICBvcmRlciA9IDE0NTA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJZb3VyIHRpbWUgdG8gc2hyaW5lIiwgIiIsICJUZW1wbGUiLCAxKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlNoYWR5IHNlY3QiLCAiIiwgIlRlbXBsZSIsIDIpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTmV3LWFnZSBjdWx0IiwgIiIsICJUZW1wbGUiLCAzKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIk9yZ2FuaXplZCByZWxpZ2lvbiIsICIiLCAiVGVtcGxlIiwgNCk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJGYW5hdGljaXNtIiwgIiIsICJUZW1wbGUiLCA1KTsKICAgIG9yZGVyID0gMTQ3NTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkJld2l0Y2hlZCIsICIiLCAiV2l6YXJkIHRvd2VyIiwgMSk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJUaGUgc29yY2VyZXIncyBhcHByZW50aWNlIiwgIiIsICJXaXphcmQgdG93ZXIiLCAyKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkNoYXJtcyBhbmQgZW5jaGFudG1lbnRzIiwgIiIsICJXaXphcmQgdG93ZXIiLCAzKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkN1cnNlcyBhbmQgbWFsZWRpY3Rpb25zIiwgIiIsICJXaXphcmQgdG93ZXIiLCA0KTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIk1hZ2ljIGtpbmdkb20iLCAiIiwgIldpemFyZCB0b3dlciIsIDUpOwoKICAgIG9yZGVyID0gMTQ0NTsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJWZXN0ZWQgaW50ZXJlc3QiLCAiQmFuayIsIDEpOwogICAgb3JkZXIgPSAxNDcwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIk5ldyB3b3JsZCBvcmRlciIsICJUZW1wbGUiLCAxKTsKICAgIG9yZGVyID0gMTQ5NTsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJIb2N1cyBwb2N1cyIsICJXaXphcmQgdG93ZXIiLCAxKTsKCiAgICBvcmRlciA9IDEwNzA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiRmluZ2VyIGNsaWNraW4nIGdvb2QiLCAiQ3Vyc29yIiwgMiwgMCwgNyk7CiAgICBvcmRlciA9IDExMjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiUGFuaWMgYXQgdGhlIGJpbmdvIiwgIkdyYW5kbWEiLCAyLCAwLCA2KTsKICAgIG9yZGVyID0gMTIyMDsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJSYWtlIGluIHRoZSBkb3VnaCIsICJGYXJtIiwgMik7CiAgICBvcmRlciA9IDEzMjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiUXVhcnJ5IG9uIiwgIk1pbmUiLCAyKTsKICAgIG9yZGVyID0gMTQyMDsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJZZXMgSSBsb3ZlIHRlY2hub2xvZ3kiLCAiRmFjdG9yeSIsIDIpOwogICAgb3JkZXIgPSAxNDQ1OwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIlBhaWQgaW4gZnVsbCIsICJCYW5rIiwgMik7CiAgICBvcmRlciA9IDE0NzA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiQ2h1cmNoIG9mIENvb2tpb2xvZ3kiLCAiVGVtcGxlIiwgMik7CiAgICBvcmRlciA9IDE0OTU7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgKICAgICAgIlRvbyBtYW55IHJhYmJpdHMsIG5vdCBlbm91Z2ggaGF0cyIsCiAgICAgICJXaXphcmQgdG93ZXIiLAogICAgICAyCiAgICApOwogICAgb3JkZXIgPSAxNTIwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIlRoZSBtb3N0IHByZWNpb3VzIGNhcmdvIiwgIlNoaXBtZW50IiwgMik7CiAgICBvcmRlciA9IDE2MjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiVGhlIEF1cmVhdGUiLCAiQWxjaGVteSBsYWIiLCAyKTsKICAgIG9yZGVyID0gMTcyMDsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJFdmVyIG1vcmUgaGlkZW91cyIsICJQb3J0YWwiLCAyKTsKICAgIG9yZGVyID0gMTgyMDsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJCZSBraW5kLCByZXdpbmQiLCAiVGltZSBtYWNoaW5lIiwgMik7CiAgICBvcmRlciA9IDE5MjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiSW5maW5pdGVzaW1hbCIsICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsIDIpOwogICAgb3JkZXIgPSAyMDIwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIkEgc3RpbGwgbW9yZSBnbG9yaW91cyBkYXduIiwgIlByaXNtIiwgMik7CgogICAgb3JkZXIgPSAzMDAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KCJSZWJpcnRoIiwgbG9jKCJBc2NlbmQgYXQgbGVhc3Qgb25jZS4iKSwgWzIxLCA2XSk7CgogICAgb3JkZXIgPSAxMTAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiSGVyZSB5b3UgZ28iLAogICAgICBsb2MoIkNsaWNrIHRoaXMgYWNoaWV2ZW1lbnQncyBzbG90LiIpICsKICAgICAgICAiPHE+QWxsIHlvdSBoYWQgdG8gZG8gd2FzIGFzay48L3E+IiwKICAgICAgWzEsIDddCiAgICApOwogICAgR2FtZS5sYXN0LmNsaWNrRnVuY3Rpb24gPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICghR2FtZS5IYXNBY2hpZXYoIkhlcmUgeW91IGdvIikpIHsKICAgICAgICBQbGF5U291bmQoInNuZC90aWNrLm1wMyIpOwogICAgICAgIEdhbWUuV2luKCJIZXJlIHlvdSBnbyIpOwogICAgICB9CiAgICB9OwoKICAgIG9yZGVyID0gMzAwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlJlc3VycmVjdGlvbiIsCiAgICAgIGxvYygiQXNjZW5kIDxiPiUxIHRpbWVzPC9iPi4iLCAxMCksCiAgICAgIFsyMSwgNl0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlJlaW5jYXJuYXRpb24iLAogICAgICBsb2MoIkFzY2VuZCA8Yj4lMSB0aW1lczwvYj4uIiwgMTAwKSwKICAgICAgWzIxLCA2XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiRW5kbGVzcyBjeWNsZSIsCiAgICAgIGxvYygiQXNjZW5kIDxiPiUxIHRpbWVzPC9iPi4iLCAxMDAwKSArICI8cT5PaCBoZXksIGl0J3MgeW91IGFnYWluLjwvcT4iLAogICAgICBbMiwgN10KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJzaGFkb3ciOwoKICAgIG9yZGVyID0gMTEwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlRoZSBhZ2VtYXN0ZXIiLCAiIiwgIkdyYW5kbWEiLCA3KTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlRvIG9sZGx5IGdvIiwgIiIsICJHcmFuZG1hIiwgOCk7CgogICAgb3JkZXIgPSAxMjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiR2FyZGVuZXIgZXh0cmFvcmRpbmFpcmUiLCAiIiwgIkZhcm0iLCA2KTsKICAgIG9yZGVyID0gMTMwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlRlY3RvbmljIGFtYmFzc2Fkb3IiLCAiIiwgIk1pbmUiLCA2KTsKICAgIG9yZGVyID0gMTQwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlJpc2Ugb2YgdGhlIG1hY2hpbmVzIiwgIiIsICJGYWN0b3J5IiwgNik7CiAgICBvcmRlciA9IDE0MjU7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJBY3F1aXJlIGN1cnJlbmN5IiwgIiIsICJCYW5rIiwgNik7CiAgICBvcmRlciA9IDE0NTA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJaZWFsb3RyeSIsICIiLCAiVGVtcGxlIiwgNik7CiAgICBvcmRlciA9IDE0NzU7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJUaGUgd2l6YXJkaW5nIHdvcmxkIiwgIiIsICJXaXphcmQgdG93ZXIiLCA2KTsKICAgIG9yZGVyID0gMTUwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlBhcnNlYy1tYXNoZXIiLCAiIiwgIlNoaXBtZW50IiwgNik7CiAgICBvcmRlciA9IDE2MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJUaGUgd29yayBvZiBhIGxpZmV0aW1lIiwgIiIsICJBbGNoZW15IGxhYiIsIDYpOwogICAgb3JkZXIgPSAxNzAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiQSBwbGFjZSBsb3N0IGluIHRpbWUiLCAiIiwgIlBvcnRhbCIsIDYpOwogICAgb3JkZXIgPSAxODAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiSGVhdCBkZWF0aCIsICIiLCAiVGltZSBtYWNoaW5lIiwgNik7CiAgICBvcmRlciA9IDE5MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJNaWNyb2Nvc20iLCAiIiwgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwgNik7CiAgICBvcmRlciA9IDIwMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJCcmlnaHQgZnV0dXJlIiwgIiIsICJQcmlzbSIsIDYpOwoKICAgIG9yZGVyID0gMjUwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkhlcmUgYmUgZHJhZ29uIiwKICAgICAgbG9jKCJDb21wbGV0ZSB5b3VyIDxiPmRyYWdvbidzIHRyYWluaW5nPC9iPi4iKSwKICAgICAgWzIxLCAxMl0KICAgICk7CgogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIkhvdz8iKTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJUaGUgbGFuZCBvZiBtaWxrIGFuZCBjb29raWVzIik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgKICAgICAgIkhlIHdobyBjb250cm9scyB0aGUgY29va2llcyBjb250cm9scyB0aGUgdW5pdmVyc2UiLAogICAgICAiVGhlIG1pbGsgbXVzdCBmbG93ISIKICAgICk7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiVG9uaWdodCBvbiBIb2FyZGVycyIpOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIkFyZSB5b3UgZ29ubmEgZWF0IGFsbCB0aGF0PyIpOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIldlJ3JlIGdvbm5hIG5lZWQgYSBiaWdnZXIgYmFrZXJ5Iik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgKICAgICAgIkluIHRoZSBtb3V0aCBvZiBtYWRuZXNzIiwKICAgICAgIkEgY29va2llIGlzIGp1c3Qgd2hhdCB3ZSB0ZWxsIGVhY2ggb3RoZXIgaXQgaXMuIgogICAgKTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KAogICAgICAnQnJvdWdodCB0byB5b3UgYnkgdGhlIGxldHRlciA8ZGl2IHN0eWxlPSJkaXNwbGF5OmlubGluZS1ibG9jaztiYWNrZ3JvdW5kOnVybChpbWcvbW9uZXkucG5nKTt3aWR0aDoxNnB4O2hlaWdodDoxNnB4OyI+PC9kaXY+JwogICAgKTsKCiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJBIHdvcmxkIGZpbGxlZCB3aXRoIGNvb2tpZXMiKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoCiAgICAgICJXaGVuIHRoaXMgYmFieSBoaXRzICIgKwogICAgICAgIEJlYXV0aWZ5KDEwMDAwMDAwMDAwMDAwICogNjAgKiA2MCkgKwogICAgICAgICIgY29va2llcyBwZXIgaG91ciIKICAgICk7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJGYXN0IGFuZCBkZWxpY2lvdXMiKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoCiAgICAgICJDb29raWVoZXJ0eiA6IGEgcmVhbGx5LCByZWFsbHkgdGFzdHkgaGVydHoiLAogICAgICAiVGFzdGllciB0aGFuIGEgaGVydHogZG9udXQsIGFueXdheS4iCiAgICApOwogICAgR2FtZS5DcHNBY2hpZXZlbWVudCgiV29vcHMsIHlvdSBzb2x2ZWQgd29ybGQgaHVuZ2VyIik7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KAogICAgICAiVHVyYm9wdW5zIiwKICAgICAgJ01vdGhlciBOYXR1cmUgd2lsbCBiZSBsaWtlICJzbG93d3d3dyBkb3d3d3d3biIuJwogICAgKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIkZhc3RlciBtZW5uZXIiKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIkFuZCB5ZXQgeW91J3JlIHN0aWxsIGh1bmdyeSIpOwogICAgR2FtZS5DcHNBY2hpZXZlbWVudCgiVGhlIEFiYWtlbmluZyIpOwogICAgR2FtZS5DcHNBY2hpZXZlbWVudCgKICAgICAgIlRoZXJlJ3MgcmVhbGx5IG5vIGhhcmQgbGltaXQgdG8gaG93IGxvbmcgdGhlc2UgYWNoaWV2ZW1lbnQgbmFtZXMgY2FuIGJlIGFuZCB0byBiZSBxdWl0ZSBob25lc3QgSSdtIHJhdGhlciBjdXJpb3VzIHRvIHNlZSBob3cgZmFyIHdlIGNhbiBnby48YnI+QWRvbHBodXMgVy4gR3JlZW4gKDE4NDTigJMxOTE3KSBzdGFydGVkIGFzIHRoZSBQcmluY2lwYWwgb2YgdGhlIEdyb3RvbiBTY2hvb2wgaW4gMTg2NC4gQnkgMTg2NSwgaGUgYmVjYW1lIHNlY29uZCBhc3Npc3RhbnQgbGlicmFyaWFuIGF0IHRoZSBOZXcgWW9yayBNZXJjYW50aWxlIExpYnJhcnk7IGZyb20gMTg2NyB0byAxODY5LCBoZSB3YXMgcHJvbW90ZWQgdG8gZnVsbCBsaWJyYXJpYW4uIEZyb20gMTg2OSB0byAxODczLCBoZSB3b3JrZWQgZm9yIEV2YXJ0cywgU291dGhtYXlkICYgQ2hvYXRlLCBhIGxhdyBmaXJtIGNvLWZvdW5kZWQgYnkgV2lsbGlhbSBNLiBFdmFydHMsIENoYXJsZXMgRmVyZGluYW5kIFNvdXRobWF5ZCBhbmQgSm9zZXBoIEhvZGdlcyBDaG9hdGUuIEhlIHdhcyBhZG1pdHRlZCB0byB0aGUgTmV3IFlvcmsgU3RhdGUgQmFyIEFzc29jaWF0aW9uIGluIDE4NzMuPGJyPkFueXdheSwgaG93J3MgeW91ciBkYXkgYmVlbj8iCiAgICApOyAvL0dhbWUubGFzdC5zaG9ydE5hbWU9J1RoZXJlXCdzIHJlYWxseSBubyBoYXJkIGxpbWl0IHRvIGhvdyBsb25nIHRoZXNlIGFjaGlldmVtZW50IG5hbWVzIGNhbiBiZSBhbmQgdG8gYmUgcXVpdGUgaG9uZXN0IElcJ20gWy4uLl0nOwogICAgR2FtZS5DcHNBY2hpZXZlbWVudCgiRmFzdCIsICJXb3chIik7CgogICAgb3JkZXIgPSA3MDAyOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJCaWNlbnRlbm5pYWwgYW5kIGEgaGFsZiIsCiAgICAgIGxvYygiSGF2ZSBhdCBsZWFzdCA8Yj4lMSBvZiBldmVyeXRoaW5nPC9iPi4iLCAyNTApICsKICAgICAgICAiPHE+S2VlcCBvbiB0cnVja2luJy48L3E+IiwKICAgICAgWzksIDZdCiAgICApOwoKICAgIG9yZGVyID0gMTEwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlRhYmxvaWQgYWRkaWN0aW9uIiwKICAgICAgbG9jKCJDbGljayBvbiB0aGUgbmV3cyB0aWNrZXIgPGI+JTEgdGltZXM8L2I+LiIsIDUwKSArCiAgICAgICAgIjxxPlBhZ2UgNjogTWFkIGluZGl2aWR1YWwgY2xpY2tzIG9uIHBpY3R1cmUgb2YgcGFzdHJ5IGluIGEgZnV0aWxlIGF0dGVtcHQgdG8gZXNjYXBlIGJvcmVkb20hPGJyPkFsc28gcGFnZSA2OiBCcml0aXNoIHBhcmxpYW1lbnQgYXRlIG15IGJhYnkhPC9xPiIsCiAgICAgIFsyNywgN10KICAgICk7CgogICAgb3JkZXIgPSAxMDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJDbGlja2FzdHJvcGhlIiwKICAgICAgbG9jKCJNYWtlIDxiPiUxPC9iPiBmcm9tIGNsaWNraW5nLiIsIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KDFlMTcpKSksCiAgICAgIFsxMSwgMTddCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJDbGlja2F0YWNseXNtIiwKICAgICAgbG9jKCJNYWtlIDxiPiUxPC9iPiBmcm9tIGNsaWNraW5nLiIsIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KDFlMTkpKSksCiAgICAgIFsxMSwgMThdCiAgICApOwoKICAgIG9yZGVyID0gMTA1MDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiVGh1bWJzLCBwaGFsYW5nZXMsIG1ldGFjYXJwYWxzIiwKICAgICAgbG9jKCJIYXZlIDxiPiUxPC9iPi4iLCBsb2MoIiUxIGN1cnNvciIsIExCZWF1dGlmeSg1MDApKSkgKwogICAgICAgICI8cT4mIEtOVUNLTEVTPC9xPiIsCiAgICAgIFswLCAxNV0KICAgICk7CgogICAgb3JkZXIgPSA2MDAyOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJQb2x5bWF0aCIsCiAgICAgIGxvYygiT3duIDxiPiUxPC9iPiB1cGdyYWRlcyBhbmQgPGI+JTI8L2I+IGJ1aWxkaW5ncy4iLCBbMzAwLCA0MDAwXSkgKwogICAgICAgICI8cT5FeGNlbGxlbmNlIGRvZXNuJ3QgaGFwcGVuIG92ZXJuaWdodCAtIGl0IHVzdWFsbHkgdGFrZXMgYSBnb29kIGNvdXBsZSBkYXlzLjwvcT4iLAogICAgICBbMjksIDddCiAgICApOwoKICAgIG9yZGVyID0gMTA5OTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiVGhlIGVsZGVyIHNjcm9sbHMiLAogICAgICBsb2MoIk93biBhIGNvbWJpbmVkIDxiPiUxPC9iPiAlMiBhbmQgJTMuIiwgWwogICAgICAgIDc3NywKICAgICAgICBsb2MoImdyYW5kbWFzIiksCiAgICAgICAgbG9jKCJjdXJzb3JzIiksCiAgICAgIF0pICsgIjxxPkxldCBtZSBndWVzcy4gU29tZW9uZSBzdG9sZSB5b3VyIGNvb2tpZS48L3E+IiwKICAgICAgWzEwLCA5XQogICAgKTsKCiAgICBvcmRlciA9IDMwMDUwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJUbyBjcnVtYnMsIHlvdSBzYXk/IiwKICAgICAgbG9jKCJBc2NlbmQgd2l0aCA8Yj4lMTwvYj4gYmFrZWQuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUzMykpKSArCiAgICAgICAgIjxxPlZlcnkgd2VsbCB0aGVuLjwvcT4iLAogICAgICBbMjksIDZdCiAgICApOwoKICAgIG9yZGVyID0gMTIwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlNlZWR5IGJ1c2luZXNzIiwgIiIsICJGYXJtIiwgNyk7CiAgICBvcmRlciA9IDEzMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJGcmVhayBmcmFja2luZyIsICIiLCAiTWluZSIsIDcpOwogICAgb3JkZXIgPSAxNDAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTW9kZXJuIHRpbWVzIiwgIiIsICJGYWN0b3J5IiwgNyk7CiAgICBvcmRlciA9IDE0MjU7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJUaGUgbmVydmUgb2Ygd2FyIiwgIiIsICJCYW5rIiwgNyk7CiAgICBvcmRlciA9IDE0NTA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJXb2xvbG8iLCAiIiwgIlRlbXBsZSIsIDcpOwogICAgb3JkZXIgPSAxNDc1OwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIkFuZCBub3cgZm9yIG15IG5leHQgdHJpY2ssIEknbGwgbmVlZCBhIHZvbHVudGVlciBmcm9tIHRoZSBhdWRpZW5jZSIsCiAgICAgICIiLAogICAgICAiV2l6YXJkIHRvd2VyIiwKICAgICAgNwogICAgKTsKICAgIG9yZGVyID0gMTUwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkl0J3Mgbm90IGRlbGl2ZXJ5IiwgIiIsICJTaGlwbWVudCIsIDcpOwogICAgb3JkZXIgPSAxNjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiR29sZCwgSmVycnkhIEdvbGQhIiwgIiIsICJBbGNoZW15IGxhYiIsIDcpOwogICAgb3JkZXIgPSAxNzAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiRm9yYmlkZGVuIHpvbmUiLCAiIiwgIlBvcnRhbCIsIDcpOwogICAgb3JkZXIgPSAxODAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgImNvb2tpZSBjbGlja2VyIGZvcmV2ZXIgYW5kIGZvcmV2ZXIgYSBodW5kcmVkIHllYXJzIGNvb2tpZSBjbGlja2VyLCBhbGwgZGF5IGxvbmcgZm9yZXZlciwgZm9yZXZlciBhIGh1bmRyZWQgdGltZXMsIG92ZXIgYW5kIG92ZXIgY29va2llIGNsaWNrZXIgYWR2ZW50dXJlcyBkb3QgY29tIiwKICAgICAgIiIsCiAgICAgICJUaW1lIG1hY2hpbmUiLAogICAgICA3CiAgICApOwogICAgb3JkZXIgPSAxOTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIlNjaWVudGlzdHMgYmFmZmxlZCBldmVyeXdoZXJlIiwKICAgICAgIiIsCiAgICAgICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsCiAgICAgIDcKICAgICk7CiAgICBvcmRlciA9IDIwMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJIYXJtb255IG9mIHRoZSBzcGhlcmVzIiwgIiIsICJQcmlzbSIsIDcpOwoKICAgIG9yZGVyID0gMzUwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkxhc3QgQ2hhbmNlIHRvIFNlZSIsCiAgICAgIGxvYygiQnVyc3QgdGhlIG5lYXItZXh0aW5jdCA8Yj5zaGlueSB3cmlua2xlcjwvYj4uIikgKwogICAgICAgICI8cT5Zb3UgbW9uc3RlciE8L3E+IiwKICAgICAgWzI0LCAxMl0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJzaGFkb3ciOwoKICAgIG9yZGVyID0gMTAwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkVhcmx5IGJpcmQiLAogICAgICBsb2MoIkNsaWNrIGEgZ29sZGVuIGNvb2tpZSA8Yj5sZXNzIHRoYW4gMSBzZWNvbmQgYWZ0ZXIgaXQgc3Bhd25zPC9iPi4iKSwKICAgICAgWzEwLCAxNF0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkZhZGluZyBsdWNrIiwKICAgICAgbG9jKCJDbGljayBhIGdvbGRlbiBjb29raWUgPGI+bGVzcyB0aGFuIDEgc2Vjb25kIGJlZm9yZSBpdCBkaWVzPC9iPi4iKSwKICAgICAgWzEwLCAxNF0KICAgICk7CgogICAgb3JkZXIgPSAyMjEwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiRWxkZWVyIiwKICAgICAgbG9jKCJQb3AgYSByZWluZGVlciA8Yj5kdXJpbmcgYW4gZWxkZXIgZnJlbnp5PC9iPi4iKSwKICAgICAgWzEyLCA5XQogICAgKTsKCiAgICBvcmRlciA9IDIxMTAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJEdWRlLCBzd2VldCIsCiAgICAgIGxvYygiSGFydmVzdCA8Yj4lMSBjb2FsZXNjaW5nIHN1Z2FyIGx1bXBzPC9iPi4iLCA3KSwKICAgICAgWzI0LCAxNF0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlN1Z2FyIHJ1c2giLAogICAgICBsb2MoIkhhcnZlc3QgPGI+JTEgY29hbGVzY2luZyBzdWdhciBsdW1wczwvYj4uIiwgMzApLAogICAgICBbMjYsIDE0XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiWWVhcidzIHdvcnRoIG9mIGNhdml0aWVzIiwKICAgICAgbG9jKCJIYXJ2ZXN0IDxiPiUxIGNvYWxlc2Npbmcgc3VnYXIgbHVtcHM8L2I+LiIsIDM2NSkgKwogICAgICAgICI8cT5NeSBsdW1wcyBteSBsdW1wcyBteSBsdW1wcy48L3E+IiwKICAgICAgWzI5LCAxNF0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkhhbmQtcGlja2VkIiwKICAgICAgbG9jKCJTdWNjZXNzZnVsbHkgaGFydmVzdCBhIGNvYWxlc2Npbmcgc3VnYXIgbHVtcCBiZWZvcmUgaXQncyByaXBlLiIpLAogICAgICBbMjgsIDE0XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiU3VnYXIgc3VnYXIiLAogICAgICBsb2MoIkhhcnZlc3QgYSA8Yj5iaWZ1cmNhdGVkIHN1Z2FyIGx1bXA8L2I+LiIpLAogICAgICBbMjksIDE1XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQWxsLW5hdHVyYWwgY2FuZSBzdWdhciIsCiAgICAgIGxvYygiSGFydmVzdCBhIDxiPmdvbGRlbiBzdWdhciBsdW1wPC9iPi4iKSwKICAgICAgWzI5LCAxNl0KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJzaGFkb3ciOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJTd2VldG1lYXRzIiwKICAgICAgbG9jKCJIYXJ2ZXN0IGEgPGI+bWVhdHkgc3VnYXIgbHVtcDwvYj4uIiksCiAgICAgIFsyOSwgMTddCiAgICApOwoKICAgIG9yZGVyID0gNzAwMjsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiVHJpY2VudGVubmlhbCIsCiAgICAgIGxvYygiSGF2ZSBhdCBsZWFzdCA8Yj4lMSBvZiBldmVyeXRoaW5nPC9iPi4iLCAzMDApICsKICAgICAgICAiPHE+Q2FuJ3Qgc3RvcCwgd29uJ3Qgc3RvcC4gUHJvYmFibHkgc2hvdWxkIHN0b3AsIHRob3VnaC48L3E+IiwKICAgICAgWzI5LCAxMl0KICAgICk7CgogICAgR2FtZS5DcHNBY2hpZXZlbWVudCgiS25lYWQgZm9yIHNwZWVkIiwgIkhvdyBkaWQgd2Ugbm90IG1ha2UgdGhhdCBvbmUgeWV0PyIpOwogICAgR2FtZS5DcHNBY2hpZXZlbWVudCgKICAgICAgIldlbGwgdGhlIGNvb2tpZXMgc3RhcnQgY29taW5nIGFuZCB0aGV5IGRvbid0IHN0b3AgY29taW5nIiwKICAgICAgIkRpZG4ndCBtYWtlIHNlbnNlIG5vdCB0byBjbGljayBmb3IgZnVuLiIKICAgICk7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KAogICAgICAiSSBkb24ndCBrbm93IGlmIHlvdSd2ZSBub3RpY2VkIGJ1dCBhbGwgdGhlc2UgaWNvbnMgYXJlIHZlcnkgc2xpZ2h0bHkgb2ZmLWNlbnRlciIKICAgICk7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KAogICAgICAiVGhlIHByb29mIG9mIHRoZSBjb29raWUgaXMgaW4gdGhlIGJha2luZyIsCiAgICAgICJIb3cgY2FuIHlvdSBoYXZlIGFueSBjb29raWVzIGlmIHlvdSBkb24ndCBiYWtlIHlvdXIgZG91Z2g/IgogICAgKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIklmIGl0J3Mgd29ydGggZG9pbmcsIGl0J3Mgd29ydGggb3ZlcmRvaW5nIik7CgogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoCiAgICAgICJUaGUgZHJlYW1zIGluIHdoaWNoIEknbSBiYWtpbmcgYXJlIHRoZSBiZXN0IEkndmUgZXZlciBoYWQiCiAgICApOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIlNldCBmb3IgbGlmZSIpOwoKICAgIG9yZGVyID0gMTIwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIllvdSBhbmQgdGhlIGJlYW5zdGFsayIsICIiLCAiRmFybSIsIDgpOwogICAgb3JkZXIgPSAxMzAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiUm9tYW5jaW5nIHRoZSBzdG9uZSIsICIiLCAiTWluZSIsIDgpOwogICAgb3JkZXIgPSAxNDAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiRXggbWFjaGluYSIsICIiLCAiRmFjdG9yeSIsIDgpOwogICAgb3JkZXIgPSAxNDI1OwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiQW5kIEkgbmVlZCBpdCBub3ciLCAiIiwgIkJhbmsiLCA4KTsKICAgIG9yZGVyID0gMTQ1MDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlByYXkgb24gdGhlIHdlYWsiLCAiIiwgIlRlbXBsZSIsIDgpOwogICAgb3JkZXIgPSAxNDc1OwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiSXQncyBhIGtpbmQgb2YgbWFnaWMiLCAiIiwgIldpemFyZCB0b3dlciIsIDgpOwogICAgb3JkZXIgPSAxNTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTWFrZSBpdCBzbyIsICIiLCAiU2hpcG1lbnQiLCA4KTsKICAgIG9yZGVyID0gMTYwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkFsbCB0aGF0IGdsaXR0ZXJzIGlzIGdvbGQiLCAiIiwgIkFsY2hlbXkgbGFiIiwgOCk7CiAgICBvcmRlciA9IDE3MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJIzaHMuMy3zZPMs8yzzK/Mn82VzJ/Njc2NzKNlzaHMos2YzLDMpsywzLrMrsydzZbNlsyYzKrNiSDNmMygzKbNlcykzKrMnc2FzKXMsMygzKvMlsyjzZnMrEPMqMymzLrMqcyyzKXNicytzZrMnMy7zJ3Mo8y8zZnMrsyvzKpvzKHMtM2ezaHNh8yYzY7MnsyyzYfMpsyybcy4zZjMqcy6zJ3Mo8y5zYXMsc2azKzMpcyrzLPMvMyezJjMr2XNosyVzYHMo82HzLrMnHPNmM2YzLbNnsyZzJ/MscylzK7Mr8ywzKbNk82HzZbNlsydIiwgIiIsICJQb3J0YWwiLCA4KTsKICAgIG9yZGVyID0gMTgwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIldheSBiYWNrIHRoZW4iLCAiIiwgIlRpbWUgbWFjaGluZSIsIDgpOwogICAgb3JkZXIgPSAxOTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiRXhvdGljIG1hdHRlciIsICIiLCAiQW50aW1hdHRlciBjb25kZW5zZXIiLCA4KTsKICAgIG9yZGVyID0gMjAwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkF0IHRoZSBlbmQgb2YgdGhlIHR1bm5lbCIsICIiLCAiUHJpc20iLCA4KTsKCiAgICBvcmRlciA9IDEwNzA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgKICAgICAgIkNsaWNrIChzdGFycmluZyBBZGFtIFNhbmRsZXIpIiwKICAgICAgIkN1cnNvciIsCiAgICAgIDMsCiAgICAgIDAsCiAgICAgIDcKICAgICk7CiAgICBvcmRlciA9IDExMjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiRnJhbnRpcXVpdGllcyIsICJHcmFuZG1hIiwgMywgMCwgNik7CiAgICBvcmRlciA9IDEyMjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiT3Zlcmdyb3d0aCIsICJGYXJtIiwgMyk7CiAgICBvcmRlciA9IDEzMjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiU2VkaW1lbnRhbGlzbSIsICJNaW5lIiwgMyk7CiAgICBvcmRlciA9IDE0MjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiTGFib3Igb2YgbG92ZSIsICJGYWN0b3J5IiwgMyk7CiAgICBvcmRlciA9IDE0NDU7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiUmV2ZXJzZSBmdW5uZWwgc3lzdGVtIiwgIkJhbmsiLCAzKTsKICAgIG9yZGVyID0gMTQ3MDsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJUaHVzIHNwb2tlIHlvdSIsICJUZW1wbGUiLCAzKTsKICAgIG9yZGVyID0gMTQ5NTsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJNYW5hZmVzdCBkZXN0aW55IiwgIldpemFyZCB0b3dlciIsIDMpOwogICAgb3JkZXIgPSAxNTIwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoCiAgICAgICJOZWl0aGVyIHNub3cgbm9yIHJhaW4gbm9yIGhlYXQgbm9yIGdsb29tIG9mIG5pZ2h0IiwKICAgICAgIlNoaXBtZW50IiwKICAgICAgMwogICAgKTsKICAgIG9yZGVyID0gMTYyMDsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJJJ3ZlIGdvdCB0aGUgTWlkYXMgdG91Y2giLCAiQWxjaGVteSBsYWIiLCAzKTsKICAgIG9yZGVyID0gMTcyMDsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJXaGljaCBldGVybmFsIGxpZSIsICJQb3J0YWwiLCAzKTsKICAgIG9yZGVyID0gMTgyMDsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJEJmVhY3V0ZTtqJmFncmF2ZTsgdnUiLCAiVGltZSBtYWNoaW5lIiwgMyk7CiAgICBvcmRlciA9IDE5MjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiUG93ZXJzIG9mIFRlbiIsICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsIDMpOwogICAgb3JkZXIgPSAyMDIwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIk5vdyB0aGUgZGFyayBkYXlzIGFyZSBnb25lIiwgIlByaXNtIiwgMyk7CgogICAgb3JkZXIgPSAxMDcwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoIkZyZWFreSBqYXp6IGhhbmRzIiwgIiIsIFswLCAyNl0pOwogICAgR2FtZS5PYmplY3RzWyJDdXJzb3IiXS5sZXZlbEFjaGlldjEwID0gR2FtZS5sYXN0OwogICAgb3JkZXIgPSAxMTIwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoIk1ldGh1c2VsYWgiLCAiIiwgWzEsIDI2XSk7CiAgICBHYW1lLk9iamVjdHNbIkdyYW5kbWEiXS5sZXZlbEFjaGlldjEwID0gR2FtZS5sYXN0OwogICAgb3JkZXIgPSAxMjIwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoIkh1Z2UgdHJhY3RzIG9mIGxhbmQiLCAiIiwgWzIsIDI2XSk7CiAgICBHYW1lLk9iamVjdHNbIkZhcm0iXS5sZXZlbEFjaGlldjEwID0gR2FtZS5sYXN0OwogICAgb3JkZXIgPSAxMzIwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoIkQtZC1kLWQtZGVlcGVyIiwgIiIsIFszLCAyNl0pOwogICAgR2FtZS5PYmplY3RzWyJNaW5lIl0ubGV2ZWxBY2hpZXYxMCA9IEdhbWUubGFzdDsKICAgIG9yZGVyID0gMTQyMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KCJQYXRlbnRseSBnZW5pdXMiLCAiIiwgWzQsIDI2XSk7CiAgICBHYW1lLk9iamVjdHNbIkZhY3RvcnkiXS5sZXZlbEFjaGlldjEwID0gR2FtZS5sYXN0OwogICAgb3JkZXIgPSAxNDQ1OwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoIkEgY2FwaXRhbCBpZGVhIiwgIiIsIFsxNSwgMjZdKTsKICAgIEdhbWUuT2JqZWN0c1siQmFuayJdLmxldmVsQWNoaWV2MTAgPSBHYW1lLmxhc3Q7CiAgICBvcmRlciA9IDE0NzA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgiSXQgYmVsb25ncyBpbiBhIGJha2VyeSIsICIiLCBbMTYsIDI2XSk7CiAgICBHYW1lLk9iamVjdHNbIlRlbXBsZSJdLmxldmVsQWNoaWV2MTAgPSBHYW1lLmxhc3Q7CiAgICBvcmRlciA9IDE0OTU7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgiTW90b3Jtb3V0aCIsICIiLCBbMTcsIDI2XSk7CiAgICBHYW1lLk9iamVjdHNbIldpemFyZCB0b3dlciJdLmxldmVsQWNoaWV2MTAgPSBHYW1lLmxhc3Q7CiAgICBvcmRlciA9IDE1MjA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgiQmVlbiB0aGVyZSBkb25lIHRoYXQiLCAiIiwgWzUsIDI2XSk7CiAgICBHYW1lLk9iamVjdHNbIlNoaXBtZW50Il0ubGV2ZWxBY2hpZXYxMCA9IEdhbWUubGFzdDsKICAgIG9yZGVyID0gMTYyMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KCJQaGxvZ2lzdGljYXRlZCBzdWJzdGFuY2VzIiwgIiIsIFs2LCAyNl0pOwogICAgR2FtZS5PYmplY3RzWyJBbGNoZW15IGxhYiJdLmxldmVsQWNoaWV2MTAgPSBHYW1lLmxhc3Q7CiAgICBvcmRlciA9IDE3MjA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgiQml6YXJybyB3b3JsZCIsICIiLCBbNywgMjZdKTsKICAgIEdhbWUuT2JqZWN0c1siUG9ydGFsIl0ubGV2ZWxBY2hpZXYxMCA9IEdhbWUubGFzdDsKICAgIG9yZGVyID0gMTgyMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KCJUaGUgbG9uZyBub3ciLCAiIiwgWzgsIDI2XSk7CiAgICBHYW1lLk9iamVjdHNbIlRpbWUgbWFjaGluZSJdLmxldmVsQWNoaWV2MTAgPSBHYW1lLmxhc3Q7CiAgICBvcmRlciA9IDE5MjA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgiQ2h1YmJ5IGhhZHJvbnMiLCAiIiwgWzEzLCAyNl0pOwogICAgR2FtZS5PYmplY3RzWyJBbnRpbWF0dGVyIGNvbmRlbnNlciJdLmxldmVsQWNoaWV2MTAgPSBHYW1lLmxhc3Q7CiAgICBvcmRlciA9IDIwMjA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgiUGFsZXR0YWJsZSIsICIiLCBbMTQsIDI2XSk7CiAgICBHYW1lLk9iamVjdHNbIlByaXNtIl0ubGV2ZWxBY2hpZXYxMCA9IEdhbWUubGFzdDsKCiAgICBvcmRlciA9IDYxNDcwOwogICAgb3JkZXIgPSA2MTQ5NTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQmliYmlkaS1ib2JiaWRpLWJvbyIsCiAgICAgIGxvYygiQ2FzdCA8Yj4lMTwvYj4gc3BlbGxzLiIsIDkpLAogICAgICBbMjEsIDExXQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiSSdtIHRoZSB3aXoiLAogICAgICBsb2MoIkNhc3QgPGI+JTE8L2I+IHNwZWxscy4iLCA5OSksCiAgICAgIFsyMiwgMTFdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJBIHdpemFyZCBpcyB5b3UiLAogICAgICBsb2MoIkNhc3QgPGI+JTE8L2I+IHNwZWxscy4iLCA5OTkpICsgIjxxPkknbSBhIHdoYXQ/PC9xPiIsCiAgICAgIFsyOSwgMTFdCiAgICApOwoKICAgIG9yZGVyID0gMTAwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkZvdXItbGVhZiBjb29raWUiLAogICAgICBsb2MoIkhhdmUgPGI+JTE8L2I+IGdvbGRlbiBjb29raWVzIHNpbXVsdGFuZW91c2x5LiIsIDQpICsKICAgICAgICAiPHE+RmFpcmx5IHJhcmUsIGNvbnNpZGVyaW5nIGNvb2tpZXMgZG9uJ3QgZXZlbiBoYXZlIGxlYXZlcy48L3E+IiwKICAgICAgWzI3LCA2XQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInNoYWRvdyI7CgogICAgb3JkZXIgPSAyMTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTHVja2VkIG91dCIsICIiLCAiQ2hhbmNlbWFrZXIiLCAxKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIldoYXQgYXJlIHRoZSBvZGRzIiwgIiIsICJDaGFuY2VtYWtlciIsIDIpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIkdyYW5kbWEgbmVlZHMgYSBuZXcgcGFpciBvZiBzaG9lcyIsCiAgICAgICIiLAogICAgICAiQ2hhbmNlbWFrZXIiLAogICAgICAzCiAgICApOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTWlsbGlvbiB0byBvbmUgc2hvdCwgZG9jIiwgIiIsICJDaGFuY2VtYWtlciIsIDQpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiQXMgbHVjayB3b3VsZCBoYXZlIGl0IiwgIiIsICJDaGFuY2VtYWtlciIsIDUpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiRXZlciBpbiB5b3VyIGZhdm9yIiwgIiIsICJDaGFuY2VtYWtlciIsIDYpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiQmUgYSBsYWR5IiwgIiIsICJDaGFuY2VtYWtlciIsIDcpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiRGljZXkgYnVzaW5lc3MiLCAiIiwgIkNoYW5jZW1ha2VyIiwgOCk7CgogICAgb3JkZXIgPSAyMTIwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIkZpbmdlcnMgY3Jvc3NlZCIsICJDaGFuY2VtYWtlciIsIDEpOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIkp1c3QgYSBzdGF0aXN0aWMiLCAiQ2hhbmNlbWFrZXIiLCAyKTsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJNdXJwaHkncyB3aWxkIGd1ZXNzIiwgIkNoYW5jZW1ha2VyIiwgMyk7CgogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoIkxldCdzIGxlYWYgaXQgYXQgdGhhdCIsICIiLCBbMTksIDI2XSk7CiAgICBHYW1lLk9iamVjdHNbIkNoYW5jZW1ha2VyIl0ubGV2ZWxBY2hpZXYxMCA9IEdhbWUubGFzdDsKCiAgICBvcmRlciA9IDEwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlRoZSB1bHRpbWF0ZSBjbGlja2Rvd24iLAogICAgICBsb2MoIk1ha2UgPGI+JTE8L2I+IGZyb20gY2xpY2tpbmcuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUyMSkpKSArCiAgICAgICAgIjxxPihvZiB1bHRpbWF0ZSBkZXN0aW55Lik8L3E+IiwKICAgICAgWzExLCAxOV0KICAgICk7CgogICAgb3JkZXIgPSAxMTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiQWdlZCB3ZWxsIiwgIiIsICJHcmFuZG1hIiwgOSk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCIxMDFzdCBiaXJ0aGRheSIsICIiLCAiR3JhbmRtYSIsIDEwKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkJ1dCB3YWl0ICd0aWwgeW91IGdldCBvbGRlciIsICIiLCAiR3JhbmRtYSIsIDExKTsKICAgIG9yZGVyID0gMTIwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkhhcnZlc3QgbW9vbiIsICIiLCAiRmFybSIsIDkpOwogICAgb3JkZXIgPSAxMzAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTWluZT8iLCAiIiwgIk1pbmUiLCA5KTsKICAgIG9yZGVyID0gMTQwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkluIGZ1bGwgZ2VhciIsICIiLCAiRmFjdG9yeSIsIDkpOwogICAgb3JkZXIgPSAxNDI1OwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiVHJlYWNsZSB0YXJ0IGVjb25vbWljcyIsICIiLCAiQmFuayIsIDkpOwogICAgb3JkZXIgPSAxNDUwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiSG9seSBjb29raWVzLCBncmFuZG1hISIsICIiLCAiVGVtcGxlIiwgOSk7CiAgICBvcmRlciA9IDE0NzU7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KAogICAgICAiVGhlIFByZXN0aWdlIiwKICAgICAgIjxxPihVbnJlbGF0ZWQgdG8gdGhlIENvb2tpZSBDbGlja2VyIGZlYXR1cmUgb2YgdGhlIHNhbWUgbmFtZS4pPC9xPiIsCiAgICAgICJXaXphcmQgdG93ZXIiLAogICAgICA5CiAgICApOwogICAgb3JkZXIgPSAxNTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiVGhhdCdzIGp1c3QgcGVhbnV0cyB0byBzcGFjZSIsICIiLCAiU2hpcG1lbnQiLCA5KTsKICAgIG9yZGVyID0gMTYwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIldvcnRoIGl0cyB3ZWlnaHQgaW4gbGVhZCIsICIiLCAiQWxjaGVteSBsYWIiLCA5KTsKICAgIG9yZGVyID0gMTcwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJXaGF0IGhhcHBlbnMgaW4gdGhlIHZvcnRleCBzdGF5cyBpbiB0aGUgdm9ydGV4IiwKICAgICAgIiIsCiAgICAgICJQb3J0YWwiLAogICAgICA5CiAgICApOwogICAgb3JkZXIgPSAxODAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIkludml0ZWQgdG8geWVzdGVyZGF5J3MgcGFydHkiLAogICAgICAiIiwKICAgICAgIlRpbWUgbWFjaGluZSIsCiAgICAgIDkKICAgICk7CiAgICBvcmRlciA9IDE5MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJEb3duc2l6aW5nIiwgIiIsICJBbnRpbWF0dGVyIGNvbmRlbnNlciIsIDkpOyAvL3RoZSB0cmFpbGVyIGdvdCBtZSByZWFsbHkgaHlwZWQgdXAgYnV0IGkndmUgcmVhZCBzb21lIHByZXR0eSBiYWQgcmV2aWV3cy4gaXMgaXQgd2F0Y2hhYmxlID8gaXMgaXQgd29ydGggc2VlaW5nID8gaSBkb24ndCBtaW5kIG1hdHQgZGFtb24KICAgIG9yZGVyID0gMjAwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIk15IGV5ZXMiLCAiIiwgIlByaXNtIiwgOSk7CiAgICBvcmRlciA9IDIxMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KAogICAgICAiTWF5YmUgYSBjaGFuY2UgaW4gaGVsbCwgYWN0dWFsbHkiLAogICAgICAiIiwKICAgICAgIkNoYW5jZW1ha2VyIiwKICAgICAgOQogICAgKTsKCiAgICBvcmRlciA9IDEyMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJNYWtlIGxpa2UgYSB0cmVlIiwgIiIsICJGYXJtIiwgMTApOwogICAgb3JkZXIgPSAxMzAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiQ2F2ZSBzdG9yeSIsICIiLCAiTWluZSIsIDEwKTsKICAgIG9yZGVyID0gMTQwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkluLWNvZy1uZWF0byIsICIiLCAiRmFjdG9yeSIsIDEwKTsKICAgIG9yZGVyID0gMTQyNTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJTYXZlIHlvdXIgYnJlYXRoIGJlY2F1c2UgdGhhdCdzIGFsbCB5b3UndmUgZ290IGxlZnQiLAogICAgICAiIiwKICAgICAgIkJhbmsiLAogICAgICAxMAogICAgKTsKICAgIG9yZGVyID0gMTQ1MDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlZlbmdlZnVsIGFuZCBhbG1pZ2h0eSIsICIiLCAiVGVtcGxlIiwgMTApOwogICAgb3JkZXIgPSAxNDc1OwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiU3BlbGwgaXQgb3V0IGZvciB5b3UiLCAiIiwgIldpemFyZCB0b3dlciIsIDEwKTsKICAgIG9yZGVyID0gMTUwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJTcGFjZSBzcGFjZSBzcGFjZSBzcGFjZSBzcGFjZSIsCiAgICAgICI8cT5JdCdzIHRvbyBmYXIgYXdheS4uLjwvcT4iLAogICAgICAiU2hpcG1lbnQiLAogICAgICAxMAogICAgKTsKICAgIG9yZGVyID0gMTYwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJEb24ndCBnZXQgdXNlZCB0byB5b3Vyc2VsZiwgeW91J3JlIGdvbm5hIGhhdmUgdG8gY2hhbmdlIiwKICAgICAgIiIsCiAgICAgICJBbGNoZW15IGxhYiIsCiAgICAgIDEwCiAgICApOwogICAgb3JkZXIgPSAxNzAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIk9iamVjdHMgaW4gdGhlIG1pcnJvciBkaW1lbnNpb24gYXJlIGNsb3NlciB0aGFuIHRoZXkgYXBwZWFyIiwKICAgICAgIiIsCiAgICAgICJQb3J0YWwiLAogICAgICAxMAogICAgKTsKICAgIG9yZGVyID0gMTgwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkdyb3VuZGhvZyBkYXkiLCAiIiwgIlRpbWUgbWFjaGluZSIsIDEwKTsKICAgIG9yZGVyID0gMTkwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJBIG1hdHRlciBvZiBwZXJzcGVjdGl2ZSIsCiAgICAgICIiLAogICAgICAiQW50aW1hdHRlciBjb25kZW5zZXIiLAogICAgICAxMAogICAgKTsKICAgIG9yZGVyID0gMjAwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIk9wdGljYWwgaWxsdXNpb24iLCAiIiwgIlByaXNtIiwgMTApOwogICAgb3JkZXIgPSAyMTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiSmFja3BvdCIsICIiLCAiQ2hhbmNlbWFrZXIiLCAxMCk7CgogICAgb3JkZXIgPSAzNjAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiU28gbXVjaCB0byBkbyBzbyBtdWNoIHRvIHNlZSIsCiAgICAgIGxvYygiTWFuYWdlIGEgY29va2llIGxlZ2FjeSBmb3IgPGI+YXQgbGVhc3QgYSB5ZWFyPC9iPi4iKSArCiAgICAgICAgIjxxPlRoYW5rIHlvdSBzbyBtdWNoIGZvciBwbGF5aW5nIENvb2tpZSBDbGlja2VyITwvcT4iLAogICAgICBbMjMsIDExXQogICAgKTsKICAgIEdhbWUubGFzdC5wb29sID0gInNoYWRvdyI7CgogICAgR2FtZS5DcHNBY2hpZXZlbWVudCgiUnVubmluZyB3aXRoIHNjaXNzb3JzIik7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJSYXJlZmllZCBhaXIiKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIlB1c2ggaXQgdG8gdGhlIGxpbWl0Iik7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJHcmVlbiBjb29raWVzIHNsZWVwIGZ1cmlvdXNseSIpOwoKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJQYW5pYyEgYXQgTmFiaXNjbyIpOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIkJ1cnN0aW5nIGF0IHRoZSBzZWFtcyIpOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIkp1c3QgYWJvdXQgZnVsbCIpOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIkh1bmdyeSBmb3IgbW9yZSIpOwoKICAgIG9yZGVyID0gMTAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQWxsIHRoZSBvdGhlciBraWRzIHdpdGggdGhlIHB1bXBlZCB1cCBjbGlja3MiLAogICAgICBsb2MoIk1ha2UgPGI+JTE8L2I+IGZyb20gY2xpY2tpbmcuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUyMykpKSwKICAgICAgWzExLCAyOF0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIk9uZS4uLm1vcmUuLi5jbGljay4uLiIsCiAgICAgIGxvYygiTWFrZSA8Yj4lMTwvYj4gZnJvbSBjbGlja2luZy4iLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxZTI1KSkpLAogICAgICBbMTEsIDMwXQogICAgKTsKCiAgICBvcmRlciA9IDYxNTE1OwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJCb3RhbnkgZW50aHVzaWFzdCIsCiAgICAgIGxvYygiSGFydmVzdCA8Yj4lMTwvYj4gbWF0dXJlIGdhcmRlbiBwbGFudHMuIiwgMTAwKSwKICAgICAgWzI2LCAyMF0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkdyZWVuLCBhY2hpbmcgdGh1bWIiLAogICAgICBsb2MoIkhhcnZlc3QgPGI+JTE8L2I+IG1hdHVyZSBnYXJkZW4gcGxhbnRzLiIsIDEwMDApLAogICAgICBbMjcsIDIwXQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiSW4gdGhlIGdhcmRlbiBvZiBFZGVuIChiYWJ5KSIsCiAgICAgIGxvYygiRmlsbCBldmVyeSB0aWxlIG9mIHRoZSBiaWdnZXN0IGdhcmRlbiBwbG90IHdpdGggcGxhbnRzLiIpICsKICAgICAgICAiPHE+SXNuJ3QgdGVuZGluZyB0byB0aG9zZSBwcmVjaW91cyBsaXR0bGUgcGxhbnRzIGp1c3Qgc28gcm9jayBhbmQvb3Igcm9sbD88L3E+IiwKICAgICAgWzI4LCAyMF0KICAgICk7CgogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJLZWVwZXIgb2YgdGhlIGNvbnNlcnZhdG9yeSIsCiAgICAgIGxvYygiVW5sb2NrIGV2ZXJ5IGdhcmRlbiBzZWVkLiIpLAogICAgICBbMjUsIDIwXQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiU2VlZGxlc3MgdG8gbmF5IiwKICAgICAgbG9jKAogICAgICAgICdDb252ZXJ0IGEgY29tcGxldGUgc2VlZCBsb2cgaW50byBzdWdhciBsdW1wcyBieSBzYWNyaWZpY2luZyB5b3VyIGdhcmRlbiB0byB0aGUgc3VnYXIgaG9ybmV0cy48ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj5Pd25pbmcgdGhpcyBhY2hpZXZlbWVudCBtYWtlcyBzZWVkcyA8Yj4lMSUgY2hlYXBlcjwvYj4sIHBsYW50cyBtYXR1cmUgPGI+JTIlIHNvb25lcjwvYj4sIGFuZCBwbGFudCB1cGdyYWRlcyBkcm9wIDxiPiUzJSBtb3JlPC9iPi4nLAogICAgICAgIFs1LCA1LCA1XQogICAgICApLAogICAgICBbMjksIDIwXQogICAgKTsKCiAgICBvcmRlciA9IDMwMDUwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJZb3UgZ2V0IG5vdGhpbmciLAogICAgICBsb2MoIkFzY2VuZCB3aXRoIDxiPiUxPC9iPiBiYWtlZC4iLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxZTM2KSkpICsKICAgICAgICAiPHE+R29vZCBkYXkgc2lyITwvcT4iLAogICAgICBbMjksIDZdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJIdW1ibGUgcmViZWdpbm5pbmdzIiwKICAgICAgbG9jKCJBc2NlbmQgd2l0aCA8Yj4lMTwvYj4gYmFrZWQuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUzOSkpKSArCiAgICAgICAgIjxxPlN0YXJ0ZWQgZnJvbSB0aGUgYm90dG9tLCBub3cgd2UncmUgaGVyZS48L3E+IiwKICAgICAgWzI5LCA2XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiVGhlIGVuZCBvZiB0aGUgd29ybGQiLAogICAgICBsb2MoIkFzY2VuZCB3aXRoIDxiPiUxPC9iPiBiYWtlZC4iLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxZTQyKSkpICsKICAgICAgICAiPHE+KGFzIHdlIGtub3cgaXQpPC9xPiIsCiAgICAgIFsyMSwgMjVdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJPaCwgeW91J3JlIGJhY2siLAogICAgICBsb2MoIkFzY2VuZCB3aXRoIDxiPiUxPC9iPiBiYWtlZC4iLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxZTQ1KSkpICsKICAgICAgICAiPHE+TWlzc2VkIHVzPzwvcT4iLAogICAgICBbMjEsIDI1XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiTGF6YXJ1cyIsCiAgICAgIGxvYygiQXNjZW5kIHdpdGggPGI+JTE8L2I+IGJha2VkLiIsIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KDFlNDgpKSkgKwogICAgICAgICI8cT5BbGwgcmlzZS48L3E+IiwKICAgICAgWzIxLCAyNV0KICAgICk7CgogICAgR2FtZS5DcHNBY2hpZXZlbWVudCgiTGVpc3VyZWx5IHBhY2UiKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIkh5cGVyc29uaWMiKTsKCiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiRmVlZCBtZSwgT3J0ZWlsIik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiQW5kIHRoZW4gd2hhdD8iKTsKCiAgICBvcmRlciA9IDcwMDI7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlRyaWNlbnRlbm5pYWwgYW5kIGEgaGFsZiIsCiAgICAgIGxvYygiSGF2ZSBhdCBsZWFzdCA8Yj4lMSBvZiBldmVyeXRoaW5nPC9iPi4iLCAzNTApICsKICAgICAgICAiPHE+KGl0J3MgZnJlZSByZWFsIGVzdGF0ZSk8L3E+IiwKICAgICAgWzIxLCAyNl0KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlF1YWRyaWNlbnRlbm5pYWwiLAogICAgICBsb2MoIkhhdmUgYXQgbGVhc3QgPGI+JTEgb2YgZXZlcnl0aGluZzwvYj4uIiwgNDAwKSArCiAgICAgICAgIjxxPllvdSd2ZSBoYWQgdG8gZG8gaG9ycmlibGUgdGhpbmdzIHRvIGdldCB0aGlzIGZhci48YnI+SG9ycmlibGUuLi4gaG9ycmlibGUgdGhpbmdzLjwvcT4iLAogICAgICBbMjIsIDI2XQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiUXVhZHJpY2VudGVubmlhbCBhbmQgYSBoYWxmIiwKICAgICAgbG9jKCJIYXZlIGF0IGxlYXN0IDxiPiUxIG9mIGV2ZXJ5dGhpbmc8L2I+LiIsIDQ1MCkgKwogICAgICAgICI8cT5BdCB0aGlzIHBvaW50LCB5b3UgbWlnaHQganVzdCBiZSBjb21wZW5zYXRpbmcgZm9yIHNvbWV0aGluZy48L3E+IiwKICAgICAgWzIzLCAyNl0KICAgICk7CgogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJRdWluY2VudGVubmlhbCIsCiAgICAgIGxvYygiSGF2ZSBhdCBsZWFzdCA8Yj4lMSBvZiBldmVyeXRoaW5nPC9iPi4iLCA1MDApICsKICAgICAgICAiPHE+U29tZSBwZW9wbGUgd291bGQgc2F5IHlvdSdyZSBoYWxmd2F5IHRoZXJlLjxicj5XZSBkbyBub3QgY2FyZSBmb3IgdGhvc2UgcGVvcGxlIGFuZCB0aGVpciByZWNrbGVzcyBzZW5zZSBvZiB1bmNoZWNrZWQgb3B0aW1pc20uPC9xPiIsCiAgICAgIFsyOSwgMjVdCiAgICApOwoKICAgIG9yZGVyID0gMjExMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIk1haWxsYXJkIHJlYWN0aW9uIiwKICAgICAgbG9jKCJIYXJ2ZXN0IGEgPGI+Y2FyYW1lbGl6ZWQgc3VnYXIgbHVtcDwvYj4uIiksCiAgICAgIFsyOSwgMjddCiAgICApOwoKICAgIG9yZGVyID0gMzAyNTA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIldoZW4gdGhlIGNvb2tpZXMgYXNjZW5kIGp1c3QgcmlnaHQiLAogICAgICBsb2MoIkFzY2VuZCB3aXRoIGV4YWN0bHkgPGI+JTE8L2I+LiIsIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KDFlMTIpKSksCiAgICAgIFsyNSwgN10KICAgICk7CiAgICBHYW1lLmxhc3QucG9vbCA9ICJzaGFkb3ciOyAvL3RoaXMgYWNoaWV2ZW1lbnQgaXMgc2hhZG93IGJlY2F1c2UgaXQgaXMgb25seSBhY2hpZXZhYmxlIHRocm91Z2ggYmxpbmQgbHVjayBvciByZWFkaW5nIGV4dGVybmFsIGd1aWRlczsgdGhpcyBtYXkgY2hhbmdlIGluIHRoZSBmdXR1cmUKCiAgICBvcmRlciA9IDEwNTA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIldpdGggaGVyIGZpbmdlciBhbmQgaGVyIHRodW1iIiwKICAgICAgbG9jKCJIYXZlIDxiPiUxPC9iPi4iLCBsb2MoIiUxIGN1cnNvciIsIExCZWF1dGlmeSg2MDApKSksCiAgICAgIFswLCAxNl0KICAgICk7CgogICAgb3JkZXIgPSAxMTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiRGVmZW5zZSBvZiB0aGUgYW5jaWVudHMiLCAiIiwgIkdyYW5kbWEiLCAxMik7CiAgICBvcmRlciA9IDEyMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJTaGFycGVzdCB0b29sIGluIHRoZSBzaGVkIiwgIiIsICJGYXJtIiwgMTEpOwogICAgb3JkZXIgPSAxMzAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiSGV5IG5vdywgeW91J3JlIGEgcm9jayIsICIiLCAiTWluZSIsIDExKTsKICAgIG9yZGVyID0gMTQwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkJyZWFrIHRoZSBtb2xkIiwgIiIsICJGYWN0b3J5IiwgMTEpOwogICAgb3JkZXIgPSAxNDI1OwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiR2V0IHRoZSBzaG93IG9uLCBnZXQgcGFpZCIsICIiLCAiQmFuayIsIDExKTsKICAgIG9yZGVyID0gMTQ1MDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJNeSB3b3JsZCdzIG9uIGZpcmUsIGhvdyBhYm91dCB5b3VycyIsCiAgICAgICIiLAogICAgICAiVGVtcGxlIiwKICAgICAgMTEKICAgICk7CiAgICBvcmRlciA9IDE0NzU7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KAogICAgICAiVGhlIG1ldGVvciBtZW4gYmVnIHRvIGRpZmZlciIsCiAgICAgICIiLAogICAgICAiV2l6YXJkIHRvd2VyIiwKICAgICAgMTEKICAgICk7CiAgICBvcmRlciA9IDE1MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJPbmx5IHNob290aW5nIHN0YXJzIiwgIiIsICJTaGlwbWVudCIsIDExKTsKICAgIG9yZGVyID0gMTYwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJXZSBjb3VsZCBhbGwgdXNlIGEgbGl0dGxlIGNoYW5nZSIsCiAgICAgICIiLAogICAgICAiQWxjaGVteSBsYWIiLAogICAgICAxMQogICAgKTsgLy8iYWxsIHRoYXQgZ2xpdHRlcnMgaXMgZ29sZCIgd2FzIGFscmVhZHkgYW4gYWNoaWV2ZW1lbnQKICAgIG9yZGVyID0gMTcwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJZb3VyIGJyYWluIGdldHMgc21hcnQgYnV0IHlvdXIgaGVhZCBnZXRzIGR1bWIiLAogICAgICAiIiwKICAgICAgIlBvcnRhbCIsCiAgICAgIDExCiAgICApOwogICAgb3JkZXIgPSAxODAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiVGhlIHllYXJzIHN0YXJ0IGNvbWluZyIsICIiLCAiVGltZSBtYWNoaW5lIiwgMTEpOwogICAgb3JkZXIgPSAxOTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiV2hhdCBhIGNvbmNlcHQiLCAiIiwgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwgMTEpOwogICAgb3JkZXIgPSAyMDAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIllvdSdsbCBuZXZlciBzaGluZSBpZiB5b3UgZG9uJ3QgZ2xvdyIsCiAgICAgICIiLAogICAgICAiUHJpc20iLAogICAgICAxMQogICAgKTsKICAgIG9yZGVyID0gMjEwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJZb3UnbGwgbmV2ZXIga25vdyBpZiB5b3UgZG9uJ3QgZ28iLAogICAgICAiIiwKICAgICAgIkNoYW5jZW1ha2VyIiwKICAgICAgMTEKICAgICk7CgogICAgb3JkZXIgPSAyMjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiU2VsZi1jb250YWluZWQiLCAiIiwgIkZyYWN0YWwgZW5naW5lIiwgMSk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJUaHJldyB5b3UgZm9yIGEgbG9vcCIsICIiLCAiRnJhY3RhbCBlbmdpbmUiLCAyKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlRoZSBzdW0gb2YgaXRzIHBhcnRzIiwgIiIsICJGcmFjdGFsIGVuZ2luZSIsIDMpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIkJlYXJzIHJlcGVhdGluZyIsCiAgICAgICI8cT5XaGVyZSBkaWQgdGhlc2UgY29tZSBmcm9tPzwvcT4iLAogICAgICAiRnJhY3RhbCBlbmdpbmUiLAogICAgICA0CiAgICApOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTW9yZSBvZiB0aGUgc2FtZSIsICIiLCAiRnJhY3RhbCBlbmdpbmUiLCA1KTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkxhc3QgcmVjdXJzZSIsICIiLCAiRnJhY3RhbCBlbmdpbmUiLCA2KTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIk91dCBvZiBvbmUsIG1hbnkiLCAiIiwgIkZyYWN0YWwgZW5naW5lIiwgNyk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJBbiBleGFtcGxlIG9mIHJlY3Vyc2lvbiIsICIiLCAiRnJhY3RhbCBlbmdpbmUiLCA4KTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJGb3IgbW9yZSBpbmZvcm1hdGlvbiBvbiB0aGlzIGFjaGlldmVtZW50LCBwbGVhc2UgcmVmZXIgdG8gaXRzIHRpdGxlIiwKICAgICAgIiIsCiAgICAgICJGcmFjdGFsIGVuZ2luZSIsCiAgICAgIDkKICAgICk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KAogICAgICAiSSdtIHNvIG1ldGEsIGV2ZW4gdGhpcyBhY2hpZXZlbWVudCIsCiAgICAgICIiLAogICAgICAiRnJhY3RhbCBlbmdpbmUiLAogICAgICAxMAogICAgKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIk5ldmVyIGdldCBib3JlZCIsICIiLCAiRnJhY3RhbCBlbmdpbmUiLCAxMSk7CgogICAgb3JkZXIgPSAyMjIwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIlRoZSBuZWVkcyBvZiB0aGUgbWFueSIsICJGcmFjdGFsIGVuZ2luZSIsIDEpOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIkVhdGluZyBpdHMgb3duIiwgIkZyYWN0YWwgZW5naW5lIiwgMik7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiV2UgbXVzdCBnbyBkZWVwZXIiLCAiRnJhY3RhbCBlbmdpbmUiLCAzKTsKCiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgiU2llcnBpbnNraSByaG9tYm9pZHMiLCAiIiwgWzIwLCAyNl0pOwogICAgR2FtZS5PYmplY3RzWyJGcmFjdGFsIGVuZ2luZSJdLmxldmVsQWNoaWV2MTAgPSBHYW1lLmxhc3Q7CgogICAgR2FtZS5DcHNBY2hpZXZlbWVudCgiR290dGEgZ28gZmFzdCIpOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIkkgdGhpbmsgaXQncyBzYWZlIHRvIHNheSB5b3UndmUgZ290IGl0IG1hZGUiKTsKCiAgICBvcmRlciA9IDYwMDI7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlJlbmFpc3NhbmNlIGJha2VyIiwKICAgICAgbG9jKCJPd24gPGI+JTE8L2I+IHVwZ3JhZGVzIGFuZCA8Yj4lMjwvYj4gYnVpbGRpbmdzLiIsIFs0MDAsIDgwMDBdKSArCiAgICAgICAgIjxxPklmIHlvdSBoYXZlIHNlZW4gZnVydGhlciwgaXQgaXMgYnkgc3RhbmRpbmcgb24gdGhlIHNob3VsZGVycyBvZiBnaWFudHMgLSBhIG15c3RlcmlvdXMgc3BlY2llcyBvZiB0b3dlcmluZyBodW1hbm9pZHMgdW50aWwgbm93IHRob3VnaHQgbG9uZy1leHRpbmN0LjwvcT4iLAogICAgICBbMTAsIDEwXQogICAgKTsKCiAgICBvcmRlciA9IDEwOTg7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlZldGVyYW4iLAogICAgICBsb2MoIk93biBhdCBsZWFzdCA8Yj4lMTwvYj4gZ3JhbmRtYSB0eXBlcy4iLCAxNCkgKyAiPHE+MTQncyBhIGNyb3dkITwvcT4iLAogICAgICBbMTAsIDldCiAgICApOwoKICAgIG9yZGVyID0gMTAwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlRoaWNrLXNraW5uZWQiLAogICAgICBsb2MoCiAgICAgICAgIkhhdmUgeW91ciA8Yj5yZWluZm9yY2VkIG1lbWJyYW5lPC9iPiBwcm90ZWN0IHRoZSA8Yj5zaGltbWVyaW5nIHZlaWw8L2I+LiIKICAgICAgKSwKICAgICAgWzcsIDEwXQogICAgKTsKCiAgICBvcmRlciA9IDIzMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJGMTIiLCAiIiwgIkphdmFzY3JpcHQgY29uc29sZSIsIDEpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiVmFyaWFibGUgc3VjY2VzcyIsICIiLCAiSmF2YXNjcmlwdCBjb25zb2xlIiwgMik7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJObyBjb21tZW50cyIsICIiLCAiSmF2YXNjcmlwdCBjb25zb2xlIiwgMyk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJVcCB0byBjb2RlIiwgIiIsICJKYXZhc2NyaXB0IGNvbnNvbGUiLCA0KTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIldvcmtzIG9uIG15IG1hY2hpbmUiLCAiIiwgIkphdmFzY3JpcHQgY29uc29sZSIsIDUpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiVGVjaG5pY2FsIGRlYnQiLCAiIiwgIkphdmFzY3JpcHQgY29uc29sZSIsIDYpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTWluZCB5b3VyIGxhbmd1YWdlIiwgIiIsICJKYXZhc2NyaXB0IGNvbnNvbGUiLCA3KTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkluY29uc29sYWJsZSIsICIiLCAiSmF2YXNjcmlwdCBjb25zb2xlIiwgOCk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJDbG9zdXJlIiwgIiIsICJKYXZhc2NyaXB0IGNvbnNvbGUiLCA5KTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJEdWRlIHdoYXQgaWYgd2UncmUgYWxsIGxpdmluZyBpbiBhIHNpbXVsYXRpb24gbGlrZSB3aGF0IGlmIHdlJ3JlIGFsbCBqdXN0IGNvZGUgb24gYSBjb21wdXRlciBzb21ld2hlcmUiLAogICAgICAiIiwKICAgICAgIkphdmFzY3JpcHQgY29uc29sZSIsCiAgICAgIDEwCiAgICApOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIlRha2luZyB0aGUgYmFjayBzdHJlZXRzIiwKICAgICAgIiIsCiAgICAgICJKYXZhc2NyaXB0IGNvbnNvbGUiLAogICAgICAxMQogICAgKTsKCiAgICBvcmRlciA9IDIzMjA7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiSW5oZXJpdGVkIHByb3RvdHlwZSIsICJKYXZhc2NyaXB0IGNvbnNvbGUiLCAxKTsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KAogICAgICAiQSBtb2RlbCBvZiBkb2N1bWVudCBvYmplY3QiLAogICAgICAiSmF2YXNjcmlwdCBjb25zb2xlIiwKICAgICAgMgogICAgKTsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJGaXJzdC1jbGFzcyBjaXRpemVuIiwgIkphdmFzY3JpcHQgY29uc29sZSIsIDMpOwoKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KCJBbGV4YW5kcmlhIiwgIiIsIFszMiwgMjZdKTsKICAgIEdhbWUuT2JqZWN0c1siSmF2YXNjcmlwdCBjb25zb2xlIl0ubGV2ZWxBY2hpZXYxMCA9IEdhbWUubGFzdDsKCiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJCYWtlIGhpbSBhd2F5LCB0b3lzIik7CiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJZb3UncmUgIzEgc28gd2h5IHRyeSBoYXJkZXIiKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIkhhdmVuJ3QgZXZlbiBiZWd1biB0byBwZWFrIik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiQSBzb21ldGltZXMgZm9vZCIpOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIk5vdCBlbm91Z2ggb2YgYSBnb29kIHRoaW5nIik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiSG9ybiBvZiBwbGVudHkiKTsKCiAgICBvcmRlciA9IDMwMDUwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJTbXVyZiBhY2NvdW50IiwKICAgICAgbG9jKCJBc2NlbmQgd2l0aCA8Yj4lMTwvYj4gYmFrZWQuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWU1MSkpKSArCiAgICAgICAgIjxxPkl0J3MgbGlrZSB5b3UganVzdCBhcHBlYXJlZCBvdXQgb2YgdGhlIGJsdWUhPC9xPiIsCiAgICAgIFsyMSwgMzJdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJJZiBhdCBmaXJzdCB5b3UgZG9uJ3Qgc3VjY2VlZCIsCiAgICAgIGxvYygiQXNjZW5kIHdpdGggPGI+JTE8L2I+IGJha2VkLiIsIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KDFlNTQpKSkgKwogICAgICAgICI8cT5JZiBhdCBmaXJzdCB5b3UgZG9uJ3Qgc3VjY2VlZCwgdHJ5LCB0cnksIHRyeSBhZ2Fpbi48YnI+QnV0IGlzbid0IHRoYXQgdGhlIGRlZmluaXRpb24gb2YgaW5zYW5pdHk/PC9xPiIsCiAgICAgIFsyMSwgMzJdCiAgICApOwoKICAgIG9yZGVyID0gMzMwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIk8gRm9ydHVuYSIsCiAgICAgIGxvYygKICAgICAgICAnT3duIGV2ZXJ5IDxiPmZvcnR1bmUgdXBncmFkZTwvYj4uPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+T3duaW5nIHRoaXMgYWNoaWV2ZW1lbnQgbWFrZXMgZm9ydHVuZXMgYXBwZWFyIDxiPnR3aWNlIGFzIG9mdGVuPC9iPjsgdW5sb2NrZWQgZm9ydHVuZSB1cGdyYWRlcyBhbHNvIGhhdmUgYSA8Yj4lMSUgY2hhbmNlPC9iPiB0byBjYXJyeSBvdmVyIGFmdGVyIGFzY2VuZGluZy4nLAogICAgICAgIDQwCiAgICAgICksCiAgICAgIFsyOSwgOF0KICAgICk7CgogICAgb3JkZXIgPSA2MTYxNTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiSW5pdGlhbCBwdWJsaWMgb2ZmZXJpbmciLAogICAgICBsb2MoIk1ha2UgeW91ciBmaXJzdCBzdG9jayBtYXJrZXQgcHJvZml0LiIpLAogICAgICBbMCwgMzNdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJSb29raWUgbnVtYmVycyIsCiAgICAgIGxvYygiT3duIGF0IGxlYXN0IDxiPiUxPC9iPiBvZiBldmVyeSBzdG9jayBtYXJrZXQgZ29vZC4iLCAxMDApICsKICAgICAgICAiPHE+R290dGEgcHVtcCB0aG9zZSBudW1iZXJzIHVwITwvcT4iLAogICAgICBbOSwgMzNdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJObyBub2JpbGl0eSBpbiBwb3ZlcnR5IiwKICAgICAgbG9jKCJPd24gYXQgbGVhc3QgPGI+JTE8L2I+IG9mIGV2ZXJ5IHN0b2NrIG1hcmtldCBnb29kLiIsIDUwMCkgKwogICAgICAgICI8cT5XaGF0IGtpbmQgb2YgdHdpc3RlZCBpbmRpdmlkdWFsIGlzIG91dCB0aGVyZSBjcmFtbWluZyBjYW1lbHMgdGhyb3VnaCBuZWVkbGUgaG9sZXMgYW55d2F5PzwvcT4iLAogICAgICBbMTAsIDMzXQogICAgKTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiRnVsbCB3YXJlaG91c2VzIiwKICAgICAgbG9jKCJPd24gYXQgbGVhc3QgPGI+JTE8L2I+IG9mIGEgc3RvY2sgbWFya2V0IGdvb2QuIiwgMTAwMCksCiAgICAgIFsxMSwgMzNdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJNYWtlIG15IGRheSIsCiAgICAgIGxvYygiTWFrZSA8Yj5hIGRheTwvYj4gb2YgQ3BTICgkJTEpIGluIDEgc3RvY2sgbWFya2V0IHNhbGUuIiwgODY0MDApLAogICAgICBbMSwgMzNdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJCdXkgYnV5IGJ1eSIsCiAgICAgIGxvYygiU3BlbmQgPGI+YSBkYXk8L2I+IG9mIENwUyAoJCUxKSBpbiAxIHN0b2NrIG1hcmtldCBwdXJjaGFzZS4iLCA4NjQwMCksCiAgICAgIFsxLCAzM10KICAgICk7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkdhc2VvdXMgYXNzZXRzIiwKICAgICAgbG9jKAogICAgICAgICJIYXZlIHlvdXIgc3RvY2sgbWFya2V0IHByb2ZpdHMgc3VycGFzcyA8Yj5hIHdob2xlIHllYXI8L2I+IG9mIENwUyAoJCUxKS4iLAogICAgICAgIDMxNTM2MDAwCiAgICAgICkgKyAiPHE+Qm95LCBob3cgdm9sYXRpbGUhPC9xPiIsCiAgICAgIFsxOCwgMzNdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAic2hhZG93IjsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiUHlyYW1pZCBzY2hlbWUiLAogICAgICBsb2MoIlVubG9jayB0aGUgPGI+aGlnaGVzdC10aWVyPC9iPiBzdG9jayBtYXJrZXQgaGVhZHF1YXJ0ZXJzLiIpLAogICAgICBbMTgsIDMzXQogICAgKTsKCiAgICBvcmRlciA9IDEwMDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJKZWxsaWNsZXMiLAogICAgICBsb2MoIk93biA8Yj4lMTwvYj4ga2l0dGVuIHVwZ3JhZGVzLiIsIDEwKSArCiAgICAgICAgIjxxPkplbGxpY2xlcyBjYW4gYW5kIGplbGxpY2xlcyBkbyEgTWFrZSBzdXJlIHRvIHdhc2ggeW91ciBqZWxsaWNsZXMgZXZlcnkgZGF5ITwvcT4iLAogICAgICBbMTgsIDE5XQogICAgKTsKCiAgICBvcmRlciA9IDcwMDI7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlF1aW5jZW50ZW5uaWFsIGFuZCBhIGhhbGYiLAogICAgICBsb2MoIkhhdmUgYXQgbGVhc3QgPGI+JTEgb2YgZXZlcnl0aGluZzwvYj4uIiwgNTUwKSArCiAgICAgICAgIjxxPlRoaXMgd29uJ3QgZmlsbCB0aGUgY2h1cm5pbmcgdm9pZCBpbnNpZGUsIHlvdSBrbm93LjwvcT4iLAogICAgICBbMjksIDI2XQogICAgKTsKCiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJXaGF0IGRpZCB3ZSBldmVuIGVhdCBiZWZvcmUgdGhlc2UiKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIkhlYXZ5IGZsb3ciKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIk1vcmUgeW91IHNheT8iKTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJMYXJnZSBhbmQgaW4gY2hhcmdlIik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiQWJzb2x1dGVseSBzdHVmZmVkIik7CiAgICBHYW1lLkJhbmtBY2hpZXZlbWVudCgiSXQncyBvbmx5IHdhZmVyLXRoaW4iLCAiSnVzdCB0aGUgb25lISIpOwoKICAgIG9yZGVyID0gMTAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQ2xpY2tldHkgc3BsaXQiLAogICAgICBsb2MoIk1ha2UgPGI+JTE8L2I+IGZyb20gY2xpY2tpbmcuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUyNykpKSwKICAgICAgWzExLCAzMV0KICAgICk7CiAgICBvcmRlciA9IDEwNTA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkdvdHRhIGhhbmQgaXQgdG8geW91IiwKICAgICAgbG9jKCJIYXZlIDxiPiUxPC9iPi4iLCBsb2MoIiUxIGN1cnNvciIsIExCZWF1dGlmeSg3MDApKSksCiAgICAgIFswLCAxN10KICAgICk7CiAgICBvcmRlciA9IDExMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJPa2F5IGJvb21lciIsICIiLCAiR3JhbmRtYSIsIDEzKTsKICAgIG9yZGVyID0gMTIwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIk92ZXJyaXBlIiwgIiIsICJGYXJtIiwgMTIpOwogICAgb3JkZXIgPSAxMzAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiUm9jayBvbiIsICIiLCAiTWluZSIsIDEyKTsKICAgIG9yZGVyID0gMTQwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlNlbGYtbWFubWFkZSBtYW4iLCAiIiwgIkZhY3RvcnkiLCAxMik7CiAgICBvcmRlciA9IDE0MjU7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJDaGVja3Mgb3V0IiwgIiIsICJCYW5rIiwgMTIpOwogICAgb3JkZXIgPSAxNDUwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTGl2aW5nIG9uIGEgcHJheWVyIiwgIiIsICJUZW1wbGUiLCAxMik7CiAgICBvcmRlciA9IDE0NzU7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KAogICAgICAiSGlnaXR1cyBmaWdpdHVzIG1pZ2l0dXMgbXVtIiwKICAgICAgIiIsCiAgICAgICJXaXphcmQgdG93ZXIiLAogICAgICAxMgogICAgKTsKICAgIG9yZGVyID0gMTUwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlRoZSBpbmNyZWRpYmxlIGpvdXJuZXkiLCAiIiwgIlNoaXBtZW50IiwgMTIpOwogICAgb3JkZXIgPSAxNjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiSnVzdCBhIHBoYXNlIiwgIiIsICJBbGNoZW15IGxhYiIsIDEyKTsKICAgIG9yZGVyID0gMTcwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkRvbid0IGxldCBtZSBsZWF2ZSwgTXVycGgiLCAiIiwgIlBvcnRhbCIsIDEyKTsKICAgIG9yZGVyID0gMTgwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkNhdmVtYW4gdG8gY29zbW9zIiwgIiIsICJUaW1lIG1hY2hpbmUiLCAxMik7CiAgICBvcmRlciA9IDE5MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJQYXJ0aWN1bGFyIHRhc3RlcyIsICIiLCAiQW50aW1hdHRlciBjb25kZW5zZXIiLCAxMik7CiAgICBvcmRlciA9IDIwMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJBIGxpZ2h0IHNuYWNrIiwgIiIsICJQcmlzbSIsIDEyKTsKICAgIG9yZGVyID0gMjEwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlRlbXB0aW5nIGZhdGUiLCAiIiwgIkNoYW5jZW1ha2VyIiwgMTIpOwogICAgb3JkZXIgPSAyMjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiVGF1dG9sb2dpY2FsIiwgIiIsICJGcmFjdGFsIGVuZ2luZSIsIDEyKTsKICAgIG9yZGVyID0gMjMwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJDdXJseSBicmFjZXMiLAogICAgICAiPHE+T3IgYXMgdGhlIEZyZW5jaCBjYWxsIHRoZW0sIG11c3RhY2hlIGJveGVzLjxicj5HbyB3ZWxsIHdpdGggcXVvdGVzLjwvcT4iLAogICAgICAiSmF2YXNjcmlwdCBjb25zb2xlIiwKICAgICAgMTIKICAgICk7CgogICAgb3JkZXIgPSAxMDAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiU2V2ZW4gaG9yc2VzaG9lcyIsCiAgICAgIGxvYygiQ2xpY2sgPGI+JTE8L2I+LiIsIGxvYygiJTEgZ29sZGVuIGNvb2tpZSIsIExCZWF1dGlmeSgyNzc3NykpKSArCiAgICAgICAgIjxxPkVub3VnaCBmb3Igb25lIG9mIHRob3NlIGZ1bmt5IGhvcnNlcyB0aGF0IGdyYXplIG5lYXIgeW91ciBmYWN0b3JpZXMuPC9xPiIsCiAgICAgIFsyMSwgMzNdCiAgICApOwogICAgR2FtZS5sYXN0LnBvb2wgPSAic2hhZG93IjsKCiAgICBvcmRlciA9IDExMDA1OwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJPbGRlbiBkYXlzIiwKICAgICAgbG9jKCJGaW5kIHRoZSA8Yj5mb3Jnb3R0ZW4gbWFkZWxlaW5lPC9iPi4iKSArCiAgICAgICAgIjxxPkRhc2hOZXQgRmFybXMgcmVtZW1iZXJzLjwvcT4iLAogICAgICBbMTIsIDNdCiAgICApOwoKICAgIG9yZGVyID0gMTA1MDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiVGhlIGRldmlsJ3Mgd29ya3Nob3AiLAogICAgICBsb2MoIkhhdmUgPGI+JTE8L2I+LiIsIGxvYygiJTEgY3Vyc29yIiwgTEJlYXV0aWZ5KDgwMCkpKSwKICAgICAgWzAsIDE4XQogICAgKTsKICAgIG9yZGVyID0gMTIwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkluIHRoZSBncmVlbiIsICIiLCAiRmFybSIsIDEzKTsKICAgIG9yZGVyID0gMTMwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJNb3VudGFpbiBvdXQgb2YgYSBtb2xlaGlsbCwgYnV0IGxpa2UgaW4gYSBnb29kIHdheSIsCiAgICAgICIiLAogICAgICAiTWluZSIsCiAgICAgIDEzCiAgICApOwogICAgb3JkZXIgPSAxNDAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiVGhlIHdoZWVscyBvZiBwcm9ncmVzcyIsICIiLCAiRmFjdG9yeSIsIDEzKTsKICAgIG9yZGVyID0gMTQyNTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlRoYXQncyByaWNoIiwgIiIsICJCYW5rIiwgMTMpOwogICAgb3JkZXIgPSAxNDUwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiUHJlYWNoZXMgYW5kIGNyZWFtIiwgIiIsICJUZW1wbGUiLCAxMyk7CiAgICBvcmRlciA9IDE0NzU7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJNYWdpYyB0aGlua2luZyIsICIiLCAiV2l6YXJkIHRvd2VyIiwgMTMpOwogICAgb3JkZXIgPSAxNTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIklzIHRoZXJlIGxpZmUgb24gTWFycz8iLAogICAgICAiPHE+WWVzLCB0aGVyZSBpcy4gWW91J3JlIGN1cnJlbnRseSB1c2luZyBpdCBhcyBmaWxsaW5nIGluIGV4cGVyaW1lbnRhbCBmbGF2b3IgcHJvdG90eXBlICM4MTA2NTcuPC9xPiIsCiAgICAgICJTaGlwbWVudCIsCiAgICAgIDEzCiAgICApOwogICAgb3JkZXIgPSAxNjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiQmFkIGNoZW1pc3RyeSIsICIiLCAiQWxjaGVteSBsYWIiLCAxMyk7CiAgICBvcmRlciA9IDE3MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJSZWR1Y2VkIHRvIGdpYmJlcmluZyBoZWFwcyIsICIiLCAiUG9ydGFsIiwgMTMpOwogICAgb3JkZXIgPSAxODAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiQmFjayBhbHJlYWR5PyIsICIiLCAiVGltZSBtYWNoaW5lIiwgMTMpOwogICAgb3JkZXIgPSAxOTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTnVjbGVhciB0aHJvbmUiLCAiIiwgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwgMTMpOwogICAgb3JkZXIgPSAyMDAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTWFraW5nIGxpZ2h0IG9mIHRoZSBzaXR1YXRpb24iLCAiIiwgIlByaXNtIiwgMTMpOwogICAgb3JkZXIgPSAyMTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIkZsaXAgYSBjb29raWUuIENoaXBzLCBJIHdpbi4gQ3J1c3QsIHlvdSBsb3NlLiIsCiAgICAgICIiLAogICAgICAiQ2hhbmNlbWFrZXIiLAogICAgICAxMwogICAgKTsKICAgIG9yZGVyID0gMjIwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkluIGFuZCBvZiBpdHNlbGYiLCAiIiwgIkZyYWN0YWwgZW5naW5lIiwgMTMpOwogICAgb3JkZXIgPSAyMzAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIkR1Y2sgdHlwaW5nIiwKICAgICAgIjxxPkhlbGxvLCB0aGlzIGlzIGEgZHVjayB0eXBpbmcuIEdvdCBhbnkgZ3JhcGVzPzwvcT4iLAogICAgICAiSmF2YXNjcmlwdCBjb25zb2xlIiwKICAgICAgMTMKICAgICk7CgogICAgb3JkZXIgPSAyNDAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIlRoZXknbGwgbmV2ZXIga25vdyB3aGF0IGhpdCAnZW0iLAogICAgICAiIiwKICAgICAgIklkbGV2ZXJzZSIsCiAgICAgIDEKICAgICk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJXZWxsLXZlcnNlZCIsICIiLCAiSWRsZXZlcnNlIiwgMik7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJSaXBlIGZvciB0aGUgcGlja2luZyIsICIiLCAiSWRsZXZlcnNlIiwgMyk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJVbnJlYWwiLCAiIiwgIklkbGV2ZXJzZSIsIDQpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiT25jZSB5b3UndmUgc2VlbiBvbmUiLCAiIiwgIklkbGV2ZXJzZSIsIDUpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiU3BvaWxzIGFuZCBwbHVuZGVyIiwgIiIsICJJZGxldmVyc2UiLCA2KTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJOb2JvZHkgZXhpc3RzIG9uIHB1cnBvc2UsIG5vYm9keSBiZWxvbmdzIGFueXdoZXJlIiwKICAgICAgIjxxPkNvbWUgd2F0Y2ggVFY/PC9xPiIsCiAgICAgICJJZGxldmVyc2UiLAogICAgICA3CiAgICApOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiSHlwZXJzcGFjZSBleHByZXNzd2F5IiwgIiIsICJJZGxldmVyc2UiLCA4KTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlZlcnNhdGlsZSIsICIiLCAiSWRsZXZlcnNlIiwgOSk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJZb3UgYXJlIGluZXZpdGFibGUiLCAiIiwgIklkbGV2ZXJzZSIsIDEwKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkF3YXkgZnJvbSB0aGlzIHBsYWNlIiwgIiIsICJJZGxldmVyc2UiLCAxMSk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJFdmVyeXdoZXJlIGF0IG9uY2UiLCAiIiwgIklkbGV2ZXJzZSIsIDEyKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJSZWplY3QgcmVhbGl0eSwgc3Vic3RpdHV0ZSB5b3VyIG93biIsCiAgICAgICIiLAogICAgICAiSWRsZXZlcnNlIiwKICAgICAgMTMKICAgICk7CgogICAgb3JkZXIgPSAyNDIwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIkZyaW5nZSIsICJJZGxldmVyc2UiLCAxKTsKICAgIEdhbWUuUHJvZHVjdGlvbkFjaGlldmVtZW50KCJDb2hlcmVuY2UiLCAiSWRsZXZlcnNlIiwgMik7CiAgICBHYW1lLlByb2R1Y3Rpb25BY2hpZXZlbWVudCgiRWFydGgtNjE2IiwgIklkbGV2ZXJzZSIsIDMpOwoKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KCJTdHJhbmdlIHRvcG9sb2dpZXMiLCAiIiwgWzMzLCAyNl0pOwogICAgR2FtZS5PYmplY3RzWyJJZGxldmVyc2UiXS5sZXZlbEFjaGlldjEwID0gR2FtZS5sYXN0OwoKICAgIG9yZGVyID0gNTAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiR3JhbmQgZGVzaWduIiwKICAgICAgbG9jKCJPd24gPGI+JTE8L2I+LiIsIGxvYygiJTEgYnVpbGRpbmciLCBMQmVhdXRpZnkoNTAwMCkpKSArCiAgICAgICAgIjxxPlRoZXknbGwgcmVtZW1iZXIgeW91IGZvcmV2ZXIhPC9xPiIsCiAgICAgIFszMiwgMTJdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJFY3VtZW5vcG9saXMiLAogICAgICBsb2MoIk93biA8Yj4lMTwvYj4uIiwgbG9jKCIlMSBidWlsZGluZyIsIExCZWF1dGlmeSg3NTAwKSkpICsKICAgICAgICAiPHE+R2V0dGluZyBhIHdlZSBiaXQgY3JhbXBlZC48L3E+IiwKICAgICAgWzMzLCAxMl0KICAgICk7CgogICAgb3JkZXIgPSA2MDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJUaGUgZnVsbCBwaWN0dXJlIiwKICAgICAgbG9jKCJQdXJjaGFzZSA8Yj4lMTwvYj4uIiwgbG9jKCIlMSB1cGdyYWRlIiwgTEJlYXV0aWZ5KDMwMCkpKSArCiAgICAgICAgIjxxPlNvIHRoYXQncyB3aGVyZSB0aGF0IGZpdHMgaW4hPC9xPiIsCiAgICAgIFszMiwgMTFdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJXaGVuIHRoZXJlJ3Mgbm90aGluZyBsZWZ0IHRvIGFkZCIsCiAgICAgIGxvYygiUHVyY2hhc2UgPGI+JTE8L2I+LiIsIGxvYygiJTEgdXBncmFkZSIsIExCZWF1dGlmeSg0MDApKSkgKwogICAgICAgICI8cT4uLi5rZWVwIGdvaW5nLjwvcT4iLAogICAgICBbMzMsIDExXQogICAgKTsKCiAgICBvcmRlciA9IDcwMDI7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIlNleGNlbnRlbm5pYWwiLAogICAgICBsb2MoIkhhdmUgYXQgbGVhc3QgPGI+JTEgb2YgZXZlcnl0aGluZzwvYj4uIiwgNjAwKSArCiAgICAgICAgIjxxPkhleSwgbmljZSBtaWxlc3RvbmUhPC9xPiIsCiAgICAgIFszMSwgMzNdCiAgICApOwoKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIktlZXAgZ29pbmcgdW50aWwgSSBzYXkgc3RvcCIpOwogICAgR2FtZS5DcHNBY2hpZXZlbWVudCgiQnV0IEkgZGlkbid0IHNheSBzdG9wLCBkaWQgST8iKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIldpdGggdW5yaXZhbGVkIGZlcnZvciIpOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIlRoaW5rIGJpZyIpOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIkh5cGVyc2l6ZSBtZSIpOwogICAgR2FtZS5CYW5rQWNoaWV2ZW1lbnQoIk1heCBjYXBhY2l0eSIpOwoKICAgIG9yZGVyID0gNjE2MTY7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIkxpcXVpZCBhc3NldHMiLAogICAgICBsb2MoIkhhdmUgeW91ciBzdG9jayBtYXJrZXQgcHJvZml0cyBzdXJwYXNzIDxiPiQlMTwvYj4uIiwgMWU3KSwKICAgICAgWzEyLCAzM10KICAgICk7CgogICAgb3JkZXIgPSAxMTAwMDsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiU3RpZmxpbmcgdGhlIHByZXNzIiwKICAgICAgbG9jKCJTcXVpc2ggdGhlIG5ld3MgdGlja2VyIGZsYXQsIHRoZW4gY2xpY2sgb24gaXQuIikgKwogICAgICAgICI8cT5OYXJyb3cgaW4gaGVyZSBvciBpcyBpdCBqdXN0IG1lPzwvcT4iLAogICAgICBbMjcsIDddCiAgICApOwoKICAgIG9yZGVyID0gMjUwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkl0J3MgYmlnIGJyYWluIHRpbWUiLCAiIiwgIkNvcnRleCBiYWtlciIsIDEpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiSnVzdCBteSBpbWFnaW5hdGlvbiIsICIiLCAiQ29ydGV4IGJha2VyIiwgMik7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJOb3cgdGhlcmUncyBhbiBpZGVhIiwgIiIsICJDb3J0ZXggYmFrZXIiLCAzKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoCiAgICAgICJUaGUgb3JnYW4gdGhhdCBuYW1lZCBpdHNlbGYiLAogICAgICAiIiwKICAgICAgIkNvcnRleCBiYWtlciIsCiAgICAgIDQKICAgICk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJHeXJpZmljYXRpb24iLCAiIiwgIkNvcnRleCBiYWtlciIsIDUpOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgJ0EgdHJhZGVtYXJrZWQgcG9ydG1hbnRlYXUgb2YgImltYWdpbmF0aW9uIiBhbmQgImVuZ2luZWVyaW5nIicsCiAgICAgICIiLAogICAgICAiQ29ydGV4IGJha2VyIiwKICAgICAgNgogICAgKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIk1pbmRmdWxuZXNzIiwgIiIsICJDb3J0ZXggYmFrZXIiLCA3KTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlRoZSAxMCUgbXl0aCIsICIiLCAiQ29ydGV4IGJha2VyIiwgOCk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KAogICAgICAiRG9uJ3QgdGhpbmsgYWJvdXQgaXQgdG9vIGhhcmQiLAogICAgICAiIiwKICAgICAgIkNvcnRleCBiYWtlciIsCiAgICAgIDkKICAgICk7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KAogICAgICAiVGhvdWdoIGZvb2xzIHNlbGRvbSBkaWZmZXIiLAogICAgICAiIiwKICAgICAgIkNvcnRleCBiYWtlciIsCiAgICAgIDEwCiAgICApOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTG9va2luZyBraW5kIG9mIGR1bWIiLCAiIiwgIkNvcnRleCBiYWtlciIsIDExKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkEgYmVhdXRpZnVsIG1pbmQiLCAiIiwgIkNvcnRleCBiYWtlciIsIDEyKTsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIkNhcmRpbmFsIHN5bmFwc2VzIiwgIiIsICJDb3J0ZXggYmFrZXIiLCAxMyk7CgogICAgb3JkZXIgPSAyNTIwOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIlBvc2l0aXZlIHRoaW5raW5nIiwgIkNvcnRleCBiYWtlciIsIDEpOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIlRoZSB0aG91Z2h0IHRoYXQgY291bnRzIiwgIkNvcnRleCBiYWtlciIsIDIpOwogICAgR2FtZS5Qcm9kdWN0aW9uQWNoaWV2ZW1lbnQoIlVudGhpbmthYmxlIiwgIkNvcnRleCBiYWtlciIsIDMpOwoKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KCJHaWZ0ZWQiLCAiIiwgWzM0LCAyNl0pOwogICAgR2FtZS5PYmplY3RzWyJDb3J0ZXggYmFrZXIiXS5sZXZlbEFjaGlldjEwID0gR2FtZS5sYXN0OwoKICAgIG9yZGVyID0gMTEwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIlRoZXkgbW9pc3RseSBjb21lIGF0IG5pZ2h0IiwgIiIsICJHcmFuZG1hIiwgMTQpOwogICAgb3JkZXIgPSAxMjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiSXQncyBncm93biBvbiB5b3UiLCAiIiwgIkZhcm0iLCAxNCk7CiAgICBvcmRlciA9IDEzMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KAogICAgICAiRG9uJ3QgbGV0IHRoZSB3YWxscyBjYXZlIGluIG9uIHlvdSIsCiAgICAgICIiLAogICAgICAiTWluZSIsCiAgICAgIDE0CiAgICApOwogICAgb3JkZXIgPSAxNDAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiUmVwbGFjZWQgYnkgcm9ib3RzIiwgIiIsICJGYWN0b3J5IiwgMTQpOwogICAgb3JkZXIgPSAxNDI1OwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIkZpbmFuY2lhbCBwcm9kaWd5IiwKICAgICAgIjxxPkltYWdpbmUgaG93IGl0IHdvdWxkIGJlLCB0byBiZSBhdCB0aGUgdG9wIG1ha2luZyBjYXNoIG1vbmV5LjwvcT4iLAogICAgICAiQmFuayIsCiAgICAgIDE0CiAgICApOwogICAgb3JkZXIgPSAxNDUwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiQW5kIEkgd2lsbCBwcmF5IHRvIGEgYmlnIGdvZCIsICIiLCAiVGVtcGxlIiwgMTQpOwogICAgb3JkZXIgPSAxNDc1OwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiU2hvc3BsZSBDb2x1cGlzIiwgIiIsICJXaXphcmQgdG93ZXIiLCAxNCk7CiAgICBvcmRlciA9IDE1MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJGYWxzZSB2YWN1dW0iLCAiIiwgIlNoaXBtZW50IiwgMTQpOwogICAgb3JkZXIgPSAxNjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTWV0YWxsaWMgdGFzdGUiLCAiIiwgIkFsY2hlbXkgbGFiIiwgMTQpOwogICAgb3JkZXIgPSAxNzAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiU3dpc3MgY2hlZXNlIiwgIiIsICJQb3J0YWwiLCAxNCk7CiAgICBvcmRlciA9IDE4MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KAogICAgICAiQnV0IHRoZSBmdXR1cmUgcmVmdXNlZCB0byBjaGFuZ2UiLAogICAgICAiIiwKICAgICAgIlRpbWUgbWFjaGluZSIsCiAgICAgIDE0CiAgICApOwogICAgb3JkZXIgPSAxOTAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIldoYXQncyB0aGUgZGFyayBtYXR0ZXIgd2l0aCB5b3UiLAogICAgICAiIiwKICAgICAgIkFudGltYXR0ZXIgY29uZGVuc2VyIiwKICAgICAgMTQKICAgICk7CiAgICBvcmRlciA9IDIwMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KCJFbmxpZ2h0ZW5tZW50IiwgIiIsICJQcmlzbSIsIDE0KTsKICAgIG9yZGVyID0gMjEwMDsKICAgIEdhbWUuVGllcmVkQWNoaWV2ZW1lbnQoIk5ldmVyIHRlbGwgbWUgdGhlIG9kZHMiLCAiIiwgIkNoYW5jZW1ha2VyIiwgMTQpOwogICAgb3JkZXIgPSAyMjAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgKICAgICAgIkJsb3dpbmcgYW4gQXBvbGxvbmlhbiBnYXNrZXQiLAogICAgICAiIiwKICAgICAgIkZyYWN0YWwgZW5naW5lIiwKICAgICAgMTQKICAgICk7CiAgICBvcmRlciA9IDIzMDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KAogICAgICAiR2V0IHdpdGggdGhlIHByb2dyYW0iLAogICAgICAiIiwKICAgICAgIkphdmFzY3JpcHQgY29uc29sZSIsCiAgICAgIDE0CiAgICApOwogICAgb3JkZXIgPSAyNDAwOwogICAgR2FtZS5UaWVyZWRBY2hpZXZlbWVudCgiTG9zdCB5b3VyIGNvc21pYyBtYXJibGVzIiwgIiIsICJJZGxldmVyc2UiLCAxNCk7CiAgICBvcmRlciA9IDI1MDA7CiAgICBHYW1lLlRpZXJlZEFjaGlldmVtZW50KAogICAgICAiQnkgd2lsbCBhbG9uZSBJIHNldCBteSBtaW5kIGluIG1vdGlvbiIsCiAgICAgICIiLAogICAgICAiQ29ydGV4IGJha2VyIiwKICAgICAgMTQKICAgICk7CgogICAgb3JkZXIgPSAxMDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJBaW4ndCB0aGF0IGEgY2xpY2sgaW4gdGhlIGhlYWQiLAogICAgICBsb2MoIk1ha2UgPGI+JTE8L2I+IGZyb20gY2xpY2tpbmcuIiwgbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMWUyOSkpKSwKICAgICAgWzExLCAzNF0KICAgICk7CgogICAgb3JkZXIgPSA3MDAyOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJTZXhjZW50ZW5uaWFsIGFuZCBhIGhhbGYiLAogICAgICBsb2MoIkhhdmUgYXQgbGVhc3QgPGI+JTEgb2YgZXZlcnl0aGluZzwvYj4uIiwgNjUwKSArCiAgICAgICAgIjxxPkhvcGUgeW91J3JlIGVuam95aW5nIHRoZSBncmluZCBzbyBmYXIhIEl0IGdldHMgd29yc2UuPC9xPiIsCiAgICAgIFsyMSwgMzRdCiAgICApOwoKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIkkgYW0gc3BlZWQiKTsKICAgIEdhbWUuQ3BzQWNoaWV2ZW1lbnQoIkFuZCBvbiBhbmQgb24iKTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJGYWtlIGl0IHRpbGwgeW91IGJha2UgaXQiKTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJIaXN0b3J5IGluIHRoZSBiYWtpbmciKTsKCiAgICBvcmRlciA9IDIyMTAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJCYWJ5IGl0J3Mgb2xkIG91dHNpZGUiLAogICAgICBsb2MoIkNsaWNrIG9uZSBvZiBTYW50YSdzIGhlbHBlciBncmFuZG1hcyBkdXJpbmcgQ2hyaXN0bWFzIHNlYXNvbi4iKSwKICAgICAgWzEwLCA5XQogICAgKTsKCiAgICBvcmRlciA9IDUwMDA7CiAgICBuZXcgR2FtZS5BY2hpZXZlbWVudCgKICAgICAgIk15cmlhZCIsCiAgICAgIGxvYygiT3duIDxiPiUxPC9iPi4iLCBsb2MoIiUxIGJ1aWxkaW5nIiwgTEJlYXV0aWZ5KDEwMDAwKSkpICsKICAgICAgICAiPHE+QXQgdGhpcyBwb2ludCwgbW9zdCBvZiB5b3VyIGFzc2V0cyBsaWUgaW4gcmVhbCBlc3RhdGUuPC9xPiIsCiAgICAgIFszMSwgNl0KICAgICk7CgogICAgb3JkZXIgPSA2MDAwOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJLYWl6ZW4iLAogICAgICBsb2MoIlB1cmNoYXNlIDxiPiUxPC9iPi4iLCBsb2MoIiUxIHVwZ3JhZGUiLCBMQmVhdXRpZnkoNTAwKSkpICsKICAgICAgICAiPHE+SnVzdCBhIGxpdHRsZSBtb3JlLjwvcT4iLAogICAgICBbMzEsIDVdCiAgICApOwogICAgbmV3IEdhbWUuQWNoaWV2ZW1lbnQoCiAgICAgICJCZXlvbmQgcXVhbGl0eSIsCiAgICAgIGxvYygiUHVyY2hhc2UgPGI+JTE8L2I+LiIsIGxvYygiJTEgdXBncmFkZSIsIExCZWF1dGlmeSg2MDApKSkgKwogICAgICAgICI8cT5Ed2FyZmluZyBhbGwgb2YgbWFua2luZCdzIGFjY29tcGxpc2htZW50cy48L3E+IiwKICAgICAgWzMyLCA1XQogICAgKTsKCiAgICBHYW1lLkNwc0FjaGlldmVtZW50KCJFdmVyeXRoaW5nIGhhcHBlbnMgc28gbXVjaCIpOwogICAgR2FtZS5DcHNBY2hpZXZlbWVudCgiSSdsbCByZXN0IHdoZW4gSSdtIGRlYWQiKTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJXaGF0IGRvIHlvdSBnZXQgZm9yIHRoZSBiYWtlciB3aG8gaGFzIGV2ZXJ5dGhpbmciKTsKICAgIEdhbWUuQmFua0FjaGlldmVtZW50KCJCb3R0b21sZXNzIHBpdCIpOwoKICAgIG9yZGVyID0gNjAwMTsKICAgIG5ldyBHYW1lLkFjaGlldmVtZW50KAogICAgICAiQWxsIHRoZSBzdGFycyBpbiBoZWF2ZW4iLAogICAgICBsb2MoIk93biA8Yj4lMTwvYj4gaGVhdmVubHkgdXBncmFkZXMuIiwgMTAwKSwKICAgICAgWzMwLCA1XQogICAgKTsKCiAgICAvL2VuZCBvZiBhY2hpZXZlbWVudHMKCiAgICBmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0cykgewogICAgICBpZiAoR2FtZS5PYmplY3RzW2ldLmxldmVsQWNoaWV2MTApIHsKICAgICAgICBHYW1lLk9iamVjdHNbaV0ubGV2ZWxBY2hpZXYxMC5iYXNlRGVzYyA9IGxvYygKICAgICAgICAgICJSZWFjaCBsZXZlbCA8Yj4lMTwvYj4gJTIuIiwKICAgICAgICAgIFsxMCwgR2FtZS5PYmplY3RzW2ldLnBsdXJhbF0KICAgICAgICApOwogICAgICAgIEdhbWUuT2JqZWN0c1tpXS5sZXZlbEFjaGlldjEwLmRlc2MgPQogICAgICAgICAgR2FtZS5PYmplY3RzW2ldLmxldmVsQWNoaWV2MTAuYmFzZURlc2M7CiAgICAgIH0KICAgIH0KCiAgICBMb2NhbGl6ZVVwZ3JhZGVzQW5kQWNoaWV2cygpOwoKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJCUJVRkZTCgkJPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KCiAgICBHYW1lLmJ1ZmZzID0ge307IC8vYnVmZnMgY3VycmVudGx5IGluIGVmZmVjdCBieSBuYW1lCiAgICBHYW1lLmJ1ZmZzSSA9IDA7CiAgICBHYW1lLmJ1ZmZzTCA9IGwoImJ1ZmZzIik7CiAgICBHYW1lLmdhaW5CdWZmID0gZnVuY3Rpb24gKHR5cGUsIHRpbWUsIGFyZzEsIGFyZzIsIGFyZzMpIHsKICAgICAgdHlwZSA9IEdhbWUuYnVmZlR5cGVzQnlOYW1lW3R5cGVdOwogICAgICB2YXIgb2JqID0gdHlwZS5mdW5jKHRpbWUsIGFyZzEsIGFyZzIsIGFyZzMpOwogICAgICBvYmoudHlwZSA9IHR5cGU7CiAgICAgIG9iai5hcmcxID0gYXJnMTsKICAgICAgb2JqLmFyZzIgPSBhcmcyOwogICAgICBvYmouYXJnMyA9IGFyZzM7CiAgICAgIGlmICghb2JqLmRuYW1lICYmIG9iai5uYW1lICE9ICI/Pz8iKSBvYmouZG5hbWUgPSBsb2Mob2JqLm5hbWUpOwoKICAgICAgdmFyIGJ1ZmYgPSB7CiAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICB0aW1lOiAwLAogICAgICAgIG5hbWU6ICI/Pz8iLAogICAgICAgIGRlc2M6ICIiLAogICAgICAgIGljb246IFswLCAwXSwKICAgICAgfTsKICAgICAgaWYgKEdhbWUuYnVmZnNbb2JqLm5hbWVdKSB7CiAgICAgICAgLy9pZiB0aGVyZSBpcyBhbHJlYWR5IGEgYnVmZiBpbiBlZmZlY3Qgd2l0aCB0aGlzIG5hbWUKICAgICAgICB2YXIgYnVmZiA9IEdhbWUuYnVmZnNbb2JqLm5hbWVdOwogICAgICAgIGlmIChvYmoubWF4KSBidWZmLnRpbWUgPSBNYXRoLm1heChvYmoudGltZSwgYnVmZi50aW1lKTsgLy9uZXcgZHVyYXRpb24gaXMgbWF4IG9mIG9sZCBhbmQgbmV3CiAgICAgICAgaWYgKG9iai5hZGQpIGJ1ZmYudGltZSArPSBvYmoudGltZTsgLy9uZXcgZHVyYXRpb24gaXMgb2xkICsgbmV3CiAgICAgICAgaWYgKCFvYmoubWF4ICYmICFvYmouYWRkKSBidWZmLnRpbWUgPSBvYmoudGltZTsgLy9uZXcgZHVyYXRpb24gaXMgc2V0IHRvIG5ldwogICAgICAgIGJ1ZmYubWF4VGltZSA9IGJ1ZmYudGltZTsKICAgICAgfSAvL2NyZWF0ZSBuZXcgYnVmZgogICAgICBlbHNlIHsKICAgICAgICBmb3IgKHZhciBpIGluIG9iaikgeyAvL3Bhc3RlIHBhcmFtZXRlcnMgb250byBidWZmCiAgICAgICAgICBidWZmW2ldID0gb2JqW2ldOwogICAgICAgIH0KICAgICAgICBidWZmLm1heFRpbWUgPSBidWZmLnRpbWU7CiAgICAgICAgR2FtZS5idWZmc1tidWZmLm5hbWVdID0gYnVmZjsKICAgICAgICBidWZmLmlkID0gR2FtZS5idWZmc0k7CgogICAgICAgIC8vY3JlYXRlIGRvbQogICAgICAgIEdhbWUuYnVmZnNMLmlubmVySFRNTCA9CiAgICAgICAgICBHYW1lLmJ1ZmZzTC5pbm5lckhUTUwgKwogICAgICAgICAgJzxkaXYgaWQ9ImJ1ZmYnICsKICAgICAgICAgIGJ1ZmYuaWQgKwogICAgICAgICAgJyIgY2xhc3M9ImNyYXRlIGVuYWJsZWQgYnVmZiIgJyArCiAgICAgICAgICAoYnVmZi5kZXNjCiAgICAgICAgICAgID8gR2FtZS5nZXRUb29sdGlwKAogICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9InByb21wdCIgc3R5bGU9Im1pbi13aWR0aDoyMDBweDt0ZXh0LWFsaWduOmNlbnRlcjtmb250LXNpemU6MTFweDttYXJnaW46OHB4IDBweDsiIGlkPSJ0b29sdGlwQnVmZiI+PGgzPicgKwogICAgICAgICAgICAgICAgICBidWZmLmRuYW1lICsKICAgICAgICAgICAgICAgICAgJzwvaDM+PGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgICAgICAgICAgIGJ1ZmYuZGVzYyArCiAgICAgICAgICAgICAgICAgICI8L2Rpdj4iLAogICAgICAgICAgICAgICAgImxlZnQiLAogICAgICAgICAgICAgICAgdHJ1ZQogICAgICAgICAgICAgICkKICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgJyBzdHlsZT0ib3BhY2l0eToxO2Zsb2F0Om5vbmU7ZGlzcGxheTpibG9jazsnICsKICAgICAgICAgIHdyaXRlSWNvbihidWZmLmljb24pICsKICAgICAgICAgICciPjwvZGl2Pic7CgogICAgICAgIGJ1ZmYubCA9IGwoImJ1ZmYiICsgYnVmZi5pZCk7CgogICAgICAgIEdhbWUuYnVmZnNJKys7CiAgICAgIH0KICAgICAgR2FtZS5yZWNhbGN1bGF0ZUdhaW5zID0gMTsKICAgICAgR2FtZS5zdG9yZVRvUmVmcmVzaCA9IDE7CiAgICAgIHJldHVybiBidWZmOwogICAgfTsKICAgIEdhbWUuaGFzQnVmZiA9IGZ1bmN0aW9uICgKICAgICAgd2hhdCAvL3JldHVybnMgMCBpZiB0aGVyZSBpcyBubyBidWZmIGluIGVmZmVjdCB3aXRoIHRoaXMgbmFtZTsgZWxzZSwgcmV0dXJucyBpdAogICAgKSB7CiAgICAgIGlmICghR2FtZS5idWZmc1t3aGF0XSkgcmV0dXJuIDA7CiAgICAgIGVsc2UgcmV0dXJuIEdhbWUuYnVmZnNbd2hhdF07CiAgICB9OwogICAgR2FtZS51cGRhdGVCdWZmcyA9IGZ1bmN0aW9uICgpIC8vZXhlY3V0ZWQgZXZlcnkgbG9naWMgZnJhbWUKICAgIHsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLmJ1ZmZzKSB7CiAgICAgICAgdmFyIGJ1ZmYgPSBHYW1lLmJ1ZmZzW2ldOwoKICAgICAgICBpZiAoYnVmZi50aW1lID49IDApIHsKICAgICAgICAgIGlmICghbCgiYnVmZlBpZVRpbWVyIiArIGJ1ZmYuaWQpKQogICAgICAgICAgICBsKCJidWZmIiArIGJ1ZmYuaWQpLmlubmVySFRNTCA9CiAgICAgICAgICAgICAgbCgiYnVmZiIgKyBidWZmLmlkKS5pbm5lckhUTUwgKwogICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJwaWVUaW1lciIgaWQ9ImJ1ZmZQaWVUaW1lcicgKwogICAgICAgICAgICAgIGJ1ZmYuaWQgKwogICAgICAgICAgICAgICciPjwvZGl2Pic7CiAgICAgICAgICB2YXIgVCA9IDEgLSBidWZmLnRpbWUgLyBidWZmLm1heFRpbWU7CiAgICAgICAgICBUID0gKFQgKiAxNDQpICUgMTQ0OwogICAgICAgICAgbCgiYnVmZlBpZVRpbWVyIiArIGJ1ZmYuaWQpLnN0eWxlLmJhY2tncm91bmRQb3NpdGlvbiA9CiAgICAgICAgICAgIC1NYXRoLmZsb29yKFQgJSAxOCkgKiA0OCArICJweCAiICsgLU1hdGguZmxvb3IoVCAvIDE4KSAqIDQ4ICsgInB4IjsKICAgICAgICB9CiAgICAgICAgYnVmZi50aW1lLS07CiAgICAgICAgaWYgKGJ1ZmYudGltZSA8PSAwKSB7CiAgICAgICAgICBpZiAoR2FtZS5vbkNyYXRlID09IGwoImJ1ZmYiICsgYnVmZi5pZCkpIEdhbWUudG9vbHRpcC5oaWRlKCk7CiAgICAgICAgICBpZiAoYnVmZi5vbkRpZSkgYnVmZi5vbkRpZSgpOwogICAgICAgICAgR2FtZS5idWZmc0wucmVtb3ZlQ2hpbGQobCgiYnVmZiIgKyBidWZmLmlkKSk7CiAgICAgICAgICBpZiAoR2FtZS5idWZmc1tidWZmLm5hbWVdKSB7CiAgICAgICAgICAgIEdhbWUuYnVmZnNbYnVmZi5uYW1lXSA9IDA7CiAgICAgICAgICAgIGRlbGV0ZSBHYW1lLmJ1ZmZzW2J1ZmYubmFtZV07CiAgICAgICAgICB9CiAgICAgICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICAgICAgR2FtZS5zdG9yZVRvUmVmcmVzaCA9IDE7CiAgICAgICAgfQogICAgICB9CiAgICB9OwogICAgR2FtZS5raWxsQnVmZiA9IGZ1bmN0aW9uICgKICAgICAgd2hhdCAvL3JlbW92ZSBhIGJ1ZmYgYnkgbmFtZQogICAgKSB7CiAgICAgIGlmIChHYW1lLmJ1ZmZzW3doYXRdKSB7CiAgICAgICAgR2FtZS5idWZmc1t3aGF0XS50aW1lID0gMDsgLypHYW1lLmJ1ZmZzW3doYXRdPTA7Ki8KICAgICAgfQogICAgfTsKICAgIEdhbWUua2lsbEJ1ZmZzID0gZnVuY3Rpb24gKCkgLy9yZW1vdmUgYWxsIGJ1ZmZzCiAgICB7CiAgICAgIEdhbWUuYnVmZnNMLmlubmVySFRNTCA9ICIiOwogICAgICBHYW1lLmJ1ZmZzID0ge307CiAgICAgIEdhbWUucmVjYWxjdWxhdGVHYWlucyA9IDE7CiAgICAgIEdhbWUuc3RvcmVUb1JlZnJlc2ggPSAxOwogICAgfTsKCiAgICBHYW1lLmJ1ZmZUeXBlcyA9IFtdOyAvL2J1ZmYgYXJjaGV0eXBlczsgb25seSBidWZmcyBkZWNsYXJlZCBmcm9tIHRoZXNlIGNhbiBiZSBzYXZlZCBhbmQgbG9hZGVkCiAgICBHYW1lLmJ1ZmZUeXBlc0J5TmFtZSA9IFtdOwogICAgR2FtZS5idWZmVHlwZXNOID0gMDsKICAgIEdhbWUuYnVmZlR5cGUgPSBmdW5jdGlvbiAobmFtZSwgZnVuYykgewogICAgICB0aGlzLm5hbWUgPSBuYW1lOwogICAgICB0aGlzLmZ1bmMgPSBmdW5jOyAvL3RoaXMgaXMgYSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBidWZmIG9iamVjdDsgaXQgdGFrZXMgYSAidGltZSIgYXJndW1lbnQgaW4gc2Vjb25kcywgYW5kIDMgbW9yZSBvcHRpb25hbCBhcmd1bWVudHMgYXQgbW9zdCwgd2hpY2ggd2lsbCBiZSBzYXZlZCBhbmQgbG9hZGVkIGFzIGZsb2F0cwogICAgICB0aGlzLmlkID0gR2FtZS5idWZmVHlwZXNOOwogICAgICB0aGlzLnZhbmlsbGEgPSBHYW1lLnZhbmlsbGE7CiAgICAgIEdhbWUuYnVmZlR5cGVzQnlOYW1lW3RoaXMubmFtZV0gPSB0aGlzOwogICAgICBHYW1lLmJ1ZmZUeXBlc1tHYW1lLmJ1ZmZUeXBlc05dID0gdGhpczsKICAgICAgR2FtZS5idWZmVHlwZXNOKys7CiAgICB9OwoKICAgIC8qCgkJYmFzaWMgYnVmZiBwYXJhbWV0ZXJzIDoKCQkJbmFtZTonS2l0dGVuIHJhaW4nLAoJCQlkZXNjOidJdFwncyByYWluaW5nIGtpdHRlbnMhJywKCQkJaWNvbjpbMCwwXSwKCQkJdGltZTozMCpHYW1lLmZwcwoJCW90aGVyIHBhcmFtZXRlcnMgOgoJCQl2aXNpYmxlOmZhbHNlIC0gd2lsbCBoaWRlIHRoZSBidWZmIGZyb20gdGhlIGJ1ZmYgbGlzdAoJCQlhZGQ6dHJ1ZSAtIGlmIHRoaXMgYnVmZiBhbHJlYWR5IGV4aXN0cywgYWRkIHRoZSBuZXcgZHVyYXRpb24gdG8gdGhlIG9sZCBvbmUKCQkJbWF4OnRydWUgLSBpZiB0aGlzIGJ1ZmYgYWxyZWFkeSBleGlzdHMsIHNldCB0aGUgbmV3IGR1cmF0aW9uIHRvIHRoZSBtYXggb2YgZWl0aGVyCgkJCW9uRGllOmZ1bmN0aW9uKCl7fSAtIGZ1bmN0aW9uIHdpbGwgZXhlY3V0ZSB3aGVuIHRoZSBidWZmIHJ1bnMgb3V0CgkJCXBvd2VyOjMgLSB1c2VkIGJ5IHNvbWUgYnVmZnMKCQkJbXVsdENwUzozIC0gYnVmZiBtdWx0aXBsaWVzIENwUyBieSB0aGlzIGFtb3VudAoJCQltdWx0Q2xpY2s6MyAtIGJ1ZmYgbXVsdGlwbGllcyBjbGljayBwb3dlciBieSB0aGlzIGFtb3VudAoJCSovCgogICAgLy9iYXNlIGJ1ZmZzCiAgICBuZXcgR2FtZS5idWZmVHlwZSgiZnJlbnp5IiwgZnVuY3Rpb24gKHRpbWUsIHBvdykgewogICAgICByZXR1cm4gewogICAgICAgIG5hbWU6ICJGcmVuenkiLAogICAgICAgIGRlc2M6IGxvYygiQ29va2llIHByb2R1Y3Rpb24geCUxIGZvciAlMiEiLCBbCiAgICAgICAgICBwb3csCiAgICAgICAgICBHYW1lLnNheVRpbWUodGltZSAqIEdhbWUuZnBzLCAtMSksCiAgICAgICAgXSksCiAgICAgICAgaWNvbjogWzEwLCAxNF0sCiAgICAgICAgdGltZTogdGltZSAqIEdhbWUuZnBzLAogICAgICAgIGFkZDogdHJ1ZSwKICAgICAgICBtdWx0Q3BTOiBwb3csCiAgICAgICAgYXVyYTogMSwKICAgICAgfTsKICAgIH0pOwogICAgbmV3IEdhbWUuYnVmZlR5cGUoImJsb29kIGZyZW56eSIsIGZ1bmN0aW9uICh0aW1lLCBwb3cpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBuYW1lOiAiRWxkZXIgZnJlbnp5IiwKICAgICAgICBkZXNjOiBsb2MoIkNvb2tpZSBwcm9kdWN0aW9uIHglMSBmb3IgJTIhIiwgWwogICAgICAgICAgcG93LAogICAgICAgICAgR2FtZS5zYXlUaW1lKHRpbWUgKiBHYW1lLmZwcywgLTEpLAogICAgICAgIF0pLAogICAgICAgIGljb246IFsyOSwgNl0sCiAgICAgICAgdGltZTogdGltZSAqIEdhbWUuZnBzLAogICAgICAgIGFkZDogdHJ1ZSwKICAgICAgICBtdWx0Q3BTOiBwb3csCiAgICAgICAgYXVyYTogMSwKICAgICAgfTsKICAgIH0pOwogICAgbmV3IEdhbWUuYnVmZlR5cGUoImNsb3QiLCBmdW5jdGlvbiAodGltZSwgcG93KSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgbmFtZTogIkNsb3QiLAogICAgICAgIGRlc2M6IGxvYygKICAgICAgICAgICJDb29raWUgcHJvZHVjdGlvbiBoYWx2ZWQgZm9yICUxISIsCiAgICAgICAgICBHYW1lLnNheVRpbWUodGltZSAqIEdhbWUuZnBzLCAtMSkKICAgICAgICApLAogICAgICAgIGljb246IFsxNSwgNV0sCiAgICAgICAgdGltZTogdGltZSAqIEdhbWUuZnBzLAogICAgICAgIGFkZDogdHJ1ZSwKICAgICAgICBtdWx0Q3BTOiBwb3csCiAgICAgICAgYXVyYTogMiwKICAgICAgfTsKICAgIH0pOwogICAgbmV3IEdhbWUuYnVmZlR5cGUoImRyYWdvbiBoYXJ2ZXN0IiwgZnVuY3Rpb24gKHRpbWUsIHBvdykgewogICAgICBpZiAoR2FtZS5IYXMoIkRyYWdvbiBmYW5nIikpIHBvdyA9IE1hdGguY2VpbChwb3cgKiAxLjEpOwogICAgICByZXR1cm4gewogICAgICAgIG5hbWU6ICJEcmFnb24gSGFydmVzdCIsCiAgICAgICAgZGVzYzogbG9jKCJDb29raWUgcHJvZHVjdGlvbiB4JTEgZm9yICUyISIsIFsKICAgICAgICAgIHBvdywKICAgICAgICAgIEdhbWUuc2F5VGltZSh0aW1lICogR2FtZS5mcHMsIC0xKSwKICAgICAgICBdKSwKICAgICAgICBpY29uOiBbMTAsIDI1XSwKICAgICAgICB0aW1lOiB0aW1lICogR2FtZS5mcHMsCiAgICAgICAgYWRkOiB0cnVlLAogICAgICAgIG11bHRDcFM6IHBvdywKICAgICAgICBhdXJhOiAxLAogICAgICB9OwogICAgfSk7CiAgICBuZXcgR2FtZS5idWZmVHlwZSgiZXZlcnl0aGluZyBtdXN0IGdvIiwgZnVuY3Rpb24gKHRpbWUsIHBvdykgewogICAgICByZXR1cm4gewogICAgICAgIG5hbWU6ICJFdmVyeXRoaW5nIG11c3QgZ28iLAogICAgICAgIGRlc2M6IGxvYygiQWxsIGJ1aWxkaW5ncyBhcmUgJTElIGNoZWFwZXIgZm9yICUyISIsIFsKICAgICAgICAgIHBvdywKICAgICAgICAgIEdhbWUuc2F5VGltZSh0aW1lICogR2FtZS5mcHMsIC0xKSwKICAgICAgICBdKSwKICAgICAgICBpY29uOiBbMTcsIDZdLAogICAgICAgIHRpbWU6IHRpbWUgKiBHYW1lLmZwcywKICAgICAgICBhZGQ6IHRydWUsCiAgICAgICAgcG93ZXI6IHBvdywKICAgICAgICBhdXJhOiAxLAogICAgICB9OwogICAgfSk7CiAgICBuZXcgR2FtZS5idWZmVHlwZSgiY3Vyc2VkIGZpbmdlciIsIGZ1bmN0aW9uICh0aW1lLCBwb3cpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBuYW1lOiAiQ3Vyc2VkIGZpbmdlciIsCiAgICAgICAgZGVzYzogbG9jKAogICAgICAgICAgIkNvb2tpZSBwcm9kdWN0aW9uIGhhbHRlZCBmb3IgJTEsPGJyPmJ1dCBlYWNoIGNsaWNrIGlzIHdvcnRoICUyIG9mIENwUy4iLAogICAgICAgICAgW0dhbWUuc2F5VGltZSh0aW1lICogR2FtZS5mcHMsIC0xKSwgR2FtZS5zYXlUaW1lKHRpbWUgKiBHYW1lLmZwcywgLTEpXQogICAgICAgICksCiAgICAgICAgaWNvbjogWzEyLCAxN10sCiAgICAgICAgdGltZTogdGltZSAqIEdhbWUuZnBzLAogICAgICAgIGFkZDogdHJ1ZSwKICAgICAgICBwb3dlcjogcG93LAogICAgICAgIG11bHRDcFM6IDAsCiAgICAgICAgYXVyYTogMSwKICAgICAgfTsKICAgIH0pOwogICAgbmV3IEdhbWUuYnVmZlR5cGUoImNsaWNrIGZyZW56eSIsIGZ1bmN0aW9uICh0aW1lLCBwb3cpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBuYW1lOiAiQ2xpY2sgZnJlbnp5IiwKICAgICAgICBkZXNjOiBsb2MoIkNsaWNraW5nIHBvd2VyIHglMSBmb3IgJTIhIiwgWwogICAgICAgICAgcG93LAogICAgICAgICAgR2FtZS5zYXlUaW1lKHRpbWUgKiBHYW1lLmZwcywgLTEpLAogICAgICAgIF0pLAogICAgICAgIGljb246IFswLCAxNF0sCiAgICAgICAgdGltZTogdGltZSAqIEdhbWUuZnBzLAogICAgICAgIGFkZDogdHJ1ZSwKICAgICAgICBtdWx0Q2xpY2s6IHBvdywKICAgICAgICBhdXJhOiAxLAogICAgICB9OwogICAgfSk7CiAgICBuZXcgR2FtZS5idWZmVHlwZSgiZHJhZ29uZmxpZ2h0IiwgZnVuY3Rpb24gKHRpbWUsIHBvdykgewogICAgICBpZiAoR2FtZS5IYXMoIkRyYWdvbiBmYW5nIikpIHBvdyA9IE1hdGguY2VpbChwb3cgKiAxLjEpOwogICAgICByZXR1cm4gewogICAgICAgIG5hbWU6ICJEcmFnb25mbGlnaHQiLAogICAgICAgIGRlc2M6IGxvYygiQ2xpY2tpbmcgcG93ZXIgeCUxIGZvciAlMiEiLCBbCiAgICAgICAgICBwb3csCiAgICAgICAgICBHYW1lLnNheVRpbWUodGltZSAqIEdhbWUuZnBzLCAtMSksCiAgICAgICAgXSksCiAgICAgICAgaWNvbjogWzAsIDI1XSwKICAgICAgICB0aW1lOiB0aW1lICogR2FtZS5mcHMsCiAgICAgICAgYWRkOiB0cnVlLAogICAgICAgIG11bHRDbGljazogcG93LAogICAgICAgIGF1cmE6IDEsCiAgICAgIH07CiAgICB9KTsKICAgIG5ldyBHYW1lLmJ1ZmZUeXBlKCJjb29raWUgc3Rvcm0iLCBmdW5jdGlvbiAodGltZSwgcG93KSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgbmFtZTogIkNvb2tpZSBzdG9ybSIsCiAgICAgICAgZGVzYzogbG9jKCJDb29raWVzIGV2ZXJ5d2hlcmUhIiksCiAgICAgICAgaWNvbjogWzIyLCA2XSwKICAgICAgICB0aW1lOiB0aW1lICogR2FtZS5mcHMsCiAgICAgICAgYWRkOiB0cnVlLAogICAgICAgIHBvd2VyOiBwb3csCiAgICAgICAgYXVyYTogMSwKICAgICAgfTsKICAgIH0pOwogICAgbmV3IEdhbWUuYnVmZlR5cGUoImJ1aWxkaW5nIGJ1ZmYiLCBmdW5jdGlvbiAodGltZSwgcG93LCBidWlsZGluZykgewogICAgICB2YXIgb2JqID0gR2FtZS5PYmplY3RzQnlJZFtidWlsZGluZ107CiAgICAgIHJldHVybiB7CiAgICAgICAgbmFtZTogR2FtZS5nb2xkZW5Db29raWVCdWlsZGluZ0J1ZmZzW29iai5uYW1lXVswXSwKICAgICAgICBkbmFtZTogRU4KICAgICAgICAgID8gR2FtZS5nb2xkZW5Db29raWVCdWlsZGluZ0J1ZmZzW29iai5uYW1lXVswXQogICAgICAgICAgOiBsb2MoIiUxIFBvd2VyISIsIG9iai5kbmFtZSksCiAgICAgICAgZGVzYzoKICAgICAgICAgIGxvYygKICAgICAgICAgICAgIllvdXIgJTEgYXJlIGJvb3N0aW5nIHlvdXIgQ3BTISIsCiAgICAgICAgICAgIGxvYygiJTEgIiArIG9iai5ic2luZ2xlLCBMQmVhdXRpZnkob2JqLmFtb3VudCkpCiAgICAgICAgICApICsKICAgICAgICAgICI8YnI+IiArCiAgICAgICAgICBsb2MoIkNvb2tpZSBwcm9kdWN0aW9uICslMSUgZm9yICUyISIsIFsKICAgICAgICAgICAgQmVhdXRpZnkoTWF0aC5jZWlsKHBvdyAqIDEwMCAtIDEwMCkpLAogICAgICAgICAgICBHYW1lLnNheVRpbWUodGltZSAqIEdhbWUuZnBzLCAtMSksCiAgICAgICAgICBdKSwKICAgICAgICBpY29uOiBbb2JqLmljb25Db2x1bW4sIDE0XSwKICAgICAgICB0aW1lOiB0aW1lICogR2FtZS5mcHMsCiAgICAgICAgYWRkOiB0cnVlLAogICAgICAgIG11bHRDcFM6IHBvdywKICAgICAgICBhdXJhOiAxLAogICAgICB9OwogICAgfSk7CiAgICBuZXcgR2FtZS5idWZmVHlwZSgiYnVpbGRpbmcgZGVidWZmIiwgZnVuY3Rpb24gKHRpbWUsIHBvdywgYnVpbGRpbmcpIHsKICAgICAgdmFyIG9iaiA9IEdhbWUuT2JqZWN0c0J5SWRbYnVpbGRpbmddOwogICAgICByZXR1cm4gewogICAgICAgIG5hbWU6IEdhbWUuZ29sZGVuQ29va2llQnVpbGRpbmdCdWZmc1tvYmoubmFtZV1bMV0sCiAgICAgICAgZG5hbWU6IEVOCiAgICAgICAgICA/IEdhbWUuZ29sZGVuQ29va2llQnVpbGRpbmdCdWZmc1tvYmoubmFtZV1bMV0KICAgICAgICAgIDogbG9jKCIlMSBCdXJkZW4hIiwgb2JqLmRuYW1lKSwKICAgICAgICBkZXNjOgogICAgICAgICAgbG9jKAogICAgICAgICAgICAiWW91ciAlMSBhcmUgcnVzdGluZyB5b3VyIENwUyEiLAogICAgICAgICAgICBsb2MoIiUxICIgKyBvYmouYnNpbmdsZSwgTEJlYXV0aWZ5KG9iai5hbW91bnQpKQogICAgICAgICAgKSArCiAgICAgICAgICAiPGJyPiIgKwogICAgICAgICAgbG9jKCJDb29raWUgcHJvZHVjdGlvbiAlMSUgc2xvd2VyIGZvciAlMiEiLCBbCiAgICAgICAgICAgIEJlYXV0aWZ5KE1hdGguY2VpbChwb3cgKiAxMDAgLSAxMDApKSwKICAgICAgICAgICAgR2FtZS5zYXlUaW1lKHRpbWUgKiBHYW1lLmZwcywgLTEpLAogICAgICAgICAgXSksCiAgICAgICAgaWNvbjogW29iai5pY29uQ29sdW1uLCAxNV0sCiAgICAgICAgdGltZTogdGltZSAqIEdhbWUuZnBzLAogICAgICAgIGFkZDogdHJ1ZSwKICAgICAgICBtdWx0Q3BTOiAxIC8gcG93LAogICAgICAgIGF1cmE6IDIsCiAgICAgIH07CiAgICB9KTsKICAgIG5ldyBHYW1lLmJ1ZmZUeXBlKCJzdWdhciBibGVzc2luZyIsIGZ1bmN0aW9uICh0aW1lLCBwb3cpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBuYW1lOiAiU3VnYXIgYmxlc3NpbmciLAogICAgICAgIGRlc2M6IGxvYygiWW91IGZpbmQgJTElIG1vcmUgZ29sZGVuIGNvb2tpZXMgZm9yIHRoZSBuZXh0ICUyLiIsIFsKICAgICAgICAgIDEwLAogICAgICAgICAgR2FtZS5zYXlUaW1lKHRpbWUgKiBHYW1lLmZwcywgLTEpLAogICAgICAgIF0pLAogICAgICAgIGljb246IFsyOSwgMTZdLAogICAgICAgIHRpbWU6IHRpbWUgKiBHYW1lLmZwcywKICAgICAgICAvL2FkZDp0cnVlCiAgICAgIH07CiAgICB9KTsKICAgIG5ldyBHYW1lLmJ1ZmZUeXBlKCJoYWdnbGVyIGx1Y2siLCBmdW5jdGlvbiAodGltZSwgcG93KSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgbmFtZTogIkhhZ2dsZXIncyBsdWNrIiwKICAgICAgICBkZXNjOiBsb2MoIkFsbCB1cGdyYWRlcyBhcmUgJTElIGNoZWFwZXIgZm9yICUyISIsIFsKICAgICAgICAgIHBvdywKICAgICAgICAgIEdhbWUuc2F5VGltZSh0aW1lICogR2FtZS5mcHMsIC0xKSwKICAgICAgICBdKSwKICAgICAgICBpY29uOiBbMjUsIDExXSwKICAgICAgICB0aW1lOiB0aW1lICogR2FtZS5mcHMsCiAgICAgICAgcG93ZXI6IHBvdywKICAgICAgICBtYXg6IHRydWUsCiAgICAgIH07CiAgICB9KTsKICAgIG5ldyBHYW1lLmJ1ZmZUeXBlKCJoYWdnbGVyIG1pc2VyeSIsIGZ1bmN0aW9uICh0aW1lLCBwb3cpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBuYW1lOiAiSGFnZ2xlcidzIG1pc2VyeSIsCiAgICAgICAgZGVzYzogbG9jKCJBbGwgdXBncmFkZXMgYXJlICUxJSBwcmljaWVyIGZvciAlMiEiLCBbCiAgICAgICAgICBwb3csCiAgICAgICAgICBHYW1lLnNheVRpbWUodGltZSAqIEdhbWUuZnBzLCAtMSksCiAgICAgICAgXSksCiAgICAgICAgaWNvbjogWzI1LCAxMV0sCiAgICAgICAgdGltZTogdGltZSAqIEdhbWUuZnBzLAogICAgICAgIHBvd2VyOiBwb3csCiAgICAgICAgbWF4OiB0cnVlLAogICAgICB9OwogICAgfSk7CiAgICBuZXcgR2FtZS5idWZmVHlwZSgicGl4aWUgbHVjayIsIGZ1bmN0aW9uICh0aW1lLCBwb3cpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBuYW1lOiAiQ3JhZnR5IHBpeGllcyIsCiAgICAgICAgZGVzYzogbG9jKCJBbGwgYnVpbGRpbmdzIGFyZSAlMSUgY2hlYXBlciBmb3IgJTIhIiwgWwogICAgICAgICAgcG93LAogICAgICAgICAgR2FtZS5zYXlUaW1lKHRpbWUgKiBHYW1lLmZwcywgLTEpLAogICAgICAgIF0pLAogICAgICAgIGljb246IFsyNiwgMTFdLAogICAgICAgIHRpbWU6IHRpbWUgKiBHYW1lLmZwcywKICAgICAgICBwb3dlcjogcG93LAogICAgICAgIG1heDogdHJ1ZSwKICAgICAgfTsKICAgIH0pOwogICAgbmV3IEdhbWUuYnVmZlR5cGUoInBpeGllIG1pc2VyeSIsIGZ1bmN0aW9uICh0aW1lLCBwb3cpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBuYW1lOiAiTmFzdHkgZ29ibGlucyIsCiAgICAgICAgZGVzYzogbG9jKCJBbGwgYnVpbGRpbmdzIGFyZSAlMSUgcHJpY2llciBmb3IgJTIhIiwgWwogICAgICAgICAgcG93LAogICAgICAgICAgR2FtZS5zYXlUaW1lKHRpbWUgKiBHYW1lLmZwcywgLTEpLAogICAgICAgIF0pLAogICAgICAgIGljb246IFsyNiwgMTFdLAogICAgICAgIHRpbWU6IHRpbWUgKiBHYW1lLmZwcywKICAgICAgICBwb3dlcjogcG93LAogICAgICAgIG1heDogdHJ1ZSwKICAgICAgfTsKICAgIH0pOwogICAgbmV3IEdhbWUuYnVmZlR5cGUoIm1hZ2ljIGFkZXB0IiwgZnVuY3Rpb24gKHRpbWUsIHBvdykgewogICAgICByZXR1cm4gewogICAgICAgIG5hbWU6ICJNYWdpYyBhZGVwdCIsCiAgICAgICAgZGVzYzogbG9jKCJTcGVsbHMgYmFja2ZpcmUgJTEgdGltZXMgbGVzcyBmb3IgJTIuIiwgWwogICAgICAgICAgcG93LAogICAgICAgICAgR2FtZS5zYXlUaW1lKHRpbWUgKiBHYW1lLmZwcywgLTEpLAogICAgICAgIF0pLAogICAgICAgIGljb246IFsyOSwgMTFdLAogICAgICAgIHRpbWU6IHRpbWUgKiBHYW1lLmZwcywKICAgICAgICBwb3dlcjogcG93LAogICAgICAgIG1heDogdHJ1ZSwKICAgICAgfTsKICAgIH0pOwogICAgbmV3IEdhbWUuYnVmZlR5cGUoIm1hZ2ljIGluZXB0IiwgZnVuY3Rpb24gKHRpbWUsIHBvdykgewogICAgICByZXR1cm4gewogICAgICAgIG5hbWU6ICJNYWdpYyBpbmVwdCIsCiAgICAgICAgZGVzYzogbG9jKCJTcGVsbHMgYmFja2ZpcmUgJTEgdGltZXMgbW9yZSBmb3IgJTIuIiwgWwogICAgICAgICAgcG93LAogICAgICAgICAgR2FtZS5zYXlUaW1lKHRpbWUgKiBHYW1lLmZwcywgLTEpLAogICAgICAgIF0pLAogICAgICAgIGljb246IFsyOSwgMTFdLAogICAgICAgIHRpbWU6IHRpbWUgKiBHYW1lLmZwcywKICAgICAgICBwb3dlcjogcG93LAogICAgICAgIG1heDogdHJ1ZSwKICAgICAgfTsKICAgIH0pOwogICAgbmV3IEdhbWUuYnVmZlR5cGUoImRldmFzdGF0aW9uIiwgZnVuY3Rpb24gKHRpbWUsIHBvdykgewogICAgICByZXR1cm4gewogICAgICAgIG5hbWU6ICJEZXZhc3RhdGlvbiIsCiAgICAgICAgZGVzYzogbG9jKCJDbGlja2luZyBwb3dlciArJTElIGZvciAlMiEiLCBbCiAgICAgICAgICBNYXRoLmZsb29yKHBvdyAqIDEwMCAtIDEwMCksCiAgICAgICAgICBHYW1lLnNheVRpbWUodGltZSAqIEdhbWUuZnBzLCAtMSksCiAgICAgICAgXSksCiAgICAgICAgaWNvbjogWzIzLCAxOF0sCiAgICAgICAgdGltZTogdGltZSAqIEdhbWUuZnBzLAogICAgICAgIG11bHRDbGljazogcG93LAogICAgICAgIGF1cmE6IDEsCiAgICAgICAgbWF4OiB0cnVlLAogICAgICB9OwogICAgfSk7CiAgICBuZXcgR2FtZS5idWZmVHlwZSgic3VnYXIgZnJlbnp5IiwgZnVuY3Rpb24gKHRpbWUsIHBvdykgewogICAgICByZXR1cm4gewogICAgICAgIG5hbWU6ICJTdWdhciBmcmVuenkiLAogICAgICAgIGRlc2M6IGxvYygiQ29va2llIHByb2R1Y3Rpb24geCUxIGZvciAlMiEiLCBbCiAgICAgICAgICBwb3csCiAgICAgICAgICBHYW1lLnNheVRpbWUodGltZSAqIEdhbWUuZnBzLCAtMSksCiAgICAgICAgXSksCiAgICAgICAgaWNvbjogWzI5LCAxNF0sCiAgICAgICAgdGltZTogdGltZSAqIEdhbWUuZnBzLAogICAgICAgIGFkZDogdHJ1ZSwKICAgICAgICBtdWx0Q3BTOiBwb3csCiAgICAgICAgYXVyYTogMCwKICAgICAgfTsKICAgIH0pOwogICAgbmV3IEdhbWUuYnVmZlR5cGUoImxvYW4gMSIsIGZ1bmN0aW9uICh0aW1lLCBwb3cpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBuYW1lOiAiTG9hbiAxIiwKICAgICAgICBkbmFtZTogbG9jKCJMb2FuICUxIiwgMSksCiAgICAgICAgZGVzYzogbG9jKCJDb29raWUgcHJvZHVjdGlvbiB4JTEgZm9yICUyISIsIFsKICAgICAgICAgIHBvdywKICAgICAgICAgIEdhbWUuc2F5VGltZSh0aW1lICogR2FtZS5mcHMsIC0xKSwKICAgICAgICBdKSwKICAgICAgICBpY29uOiBbMSwgMzNdLAogICAgICAgIHRpbWU6IHRpbWUgKiBHYW1lLmZwcywKICAgICAgICBwb3dlcjogcG93LAogICAgICAgIG11bHRDcFM6IHBvdywKICAgICAgICBtYXg6IHRydWUsCiAgICAgICAgb25EaWU6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGlmIChHYW1lLnRha2VMb2FuKSB7CiAgICAgICAgICAgIEdhbWUudGFrZUxvYW4oMSwgdHJ1ZSk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgfTsKICAgIH0pOwogICAgbmV3IEdhbWUuYnVmZlR5cGUoImxvYW4gMSBpbnRlcmVzdCIsIGZ1bmN0aW9uICh0aW1lLCBwb3cpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBuYW1lOiAiTG9hbiAxIChpbnRlcmVzdCkiLAogICAgICAgIGRuYW1lOiBsb2MoIkxvYW4gJTEgKGludGVyZXN0KSIsIDEpLAogICAgICAgIGRlc2M6IGxvYygiQ29va2llIHByb2R1Y3Rpb24geCUxIGZvciAlMiEiLCBbCiAgICAgICAgICBwb3csCiAgICAgICAgICBHYW1lLnNheVRpbWUodGltZSAqIEdhbWUuZnBzLCAtMSksCiAgICAgICAgXSksCiAgICAgICAgaWNvbjogWzEsIDMzXSwKICAgICAgICB0aW1lOiB0aW1lICogR2FtZS5mcHMsCiAgICAgICAgcG93ZXI6IHBvdywKICAgICAgICBtdWx0Q3BTOiBwb3csCiAgICAgICAgbWF4OiB0cnVlLAogICAgICB9OwogICAgfSk7CiAgICBuZXcgR2FtZS5idWZmVHlwZSgibG9hbiAyIiwgZnVuY3Rpb24gKHRpbWUsIHBvdykgewogICAgICByZXR1cm4gewogICAgICAgIG5hbWU6ICJMb2FuIDIiLAogICAgICAgIGRuYW1lOiBsb2MoIkxvYW4gJTEiLCAyKSwKICAgICAgICBkZXNjOiBsb2MoIkNvb2tpZSBwcm9kdWN0aW9uIHglMSBmb3IgJTIhIiwgWwogICAgICAgICAgcG93LAogICAgICAgICAgR2FtZS5zYXlUaW1lKHRpbWUgKiBHYW1lLmZwcywgLTEpLAogICAgICAgIF0pLAogICAgICAgIGljb246IFsxLCAzM10sCiAgICAgICAgdGltZTogdGltZSAqIEdhbWUuZnBzLAogICAgICAgIHBvd2VyOiBwb3csCiAgICAgICAgbXVsdENwUzogcG93LAogICAgICAgIG1heDogdHJ1ZSwKICAgICAgICBvbkRpZTogZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKEdhbWUudGFrZUxvYW4pIHsKICAgICAgICAgICAgR2FtZS50YWtlTG9hbigyLCB0cnVlKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICB9OwogICAgfSk7CiAgICBuZXcgR2FtZS5idWZmVHlwZSgibG9hbiAyIGludGVyZXN0IiwgZnVuY3Rpb24gKHRpbWUsIHBvdykgewogICAgICByZXR1cm4gewogICAgICAgIG5hbWU6ICJMb2FuIDIgKGludGVyZXN0KSIsCiAgICAgICAgZG5hbWU6IGxvYygiTG9hbiAlMSAoaW50ZXJlc3QpIiwgMiksCiAgICAgICAgZGVzYzogbG9jKCJDb29raWUgcHJvZHVjdGlvbiB4JTEgZm9yICUyISIsIFsKICAgICAgICAgIHBvdywKICAgICAgICAgIEdhbWUuc2F5VGltZSh0aW1lICogR2FtZS5mcHMsIC0xKSwKICAgICAgICBdKSwKICAgICAgICBpY29uOiBbMSwgMzNdLAogICAgICAgIHRpbWU6IHRpbWUgKiBHYW1lLmZwcywKICAgICAgICBwb3dlcjogcG93LAogICAgICAgIG11bHRDcFM6IHBvdywKICAgICAgICBtYXg6IHRydWUsCiAgICAgIH07CiAgICB9KTsKICAgIG5ldyBHYW1lLmJ1ZmZUeXBlKCJsb2FuIDMiLCBmdW5jdGlvbiAodGltZSwgcG93KSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgbmFtZTogIkxvYW4gMyIsCiAgICAgICAgZG5hbWU6IGxvYygiTG9hbiAlMSIsIDMpLAogICAgICAgIGRlc2M6IGxvYygiQ29va2llIHByb2R1Y3Rpb24geCUxIGZvciAlMiEiLCBbCiAgICAgICAgICBwb3csCiAgICAgICAgICBHYW1lLnNheVRpbWUodGltZSAqIEdhbWUuZnBzLCAtMSksCiAgICAgICAgXSksCiAgICAgICAgaWNvbjogWzEsIDMzXSwKICAgICAgICB0aW1lOiB0aW1lICogR2FtZS5mcHMsCiAgICAgICAgcG93ZXI6IHBvdywKICAgICAgICBtdWx0Q3BTOiBwb3csCiAgICAgICAgbWF4OiB0cnVlLAogICAgICAgIG9uRGllOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAoR2FtZS50YWtlTG9hbikgewogICAgICAgICAgICBHYW1lLnRha2VMb2FuKDMsIHRydWUpOwogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgIH07CiAgICB9KTsKICAgIG5ldyBHYW1lLmJ1ZmZUeXBlKCJsb2FuIDMgaW50ZXJlc3QiLCBmdW5jdGlvbiAodGltZSwgcG93KSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgbmFtZTogIkxvYW4gMyAoaW50ZXJlc3QpIiwKICAgICAgICBkbmFtZTogbG9jKCJMb2FuICUxIChpbnRlcmVzdCkiLCAzKSwKICAgICAgICBkZXNjOiBsb2MoIkNvb2tpZSBwcm9kdWN0aW9uIHglMSBmb3IgJTIhIiwgWwogICAgICAgICAgcG93LAogICAgICAgICAgR2FtZS5zYXlUaW1lKHRpbWUgKiBHYW1lLmZwcywgLTEpLAogICAgICAgIF0pLAogICAgICAgIGljb246IFsxLCAzM10sCiAgICAgICAgdGltZTogdGltZSAqIEdhbWUuZnBzLAogICAgICAgIHBvd2VyOiBwb3csCiAgICAgICAgbXVsdENwUzogcG93LAogICAgICAgIG1heDogdHJ1ZSwKICAgICAgfTsKICAgIH0pOwoKICAgIC8vZW5kIG9mIGJ1ZmZzCgogICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkJR1JBTkRNQVBPQ0FMWVBTRQoJCT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCiAgICBHYW1lLlVwZGF0ZUdyYW5kbWFwb2NhbHlwc2UgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChHYW1lLkhhcygiRWxkZXIgQ292ZW5hbnQiKSB8fCBHYW1lLk9iamVjdHNbIkdyYW5kbWEiXS5hbW91bnQgPT0gMCkKICAgICAgICBHYW1lLmVsZGVyV3JhdGggPSAwOwogICAgICBlbHNlIGlmIChHYW1lLnBsZWRnZVQgPiAwKSB7CiAgICAgICAgLy9pZiB0aGUgcGxlZGdlIGlzIGFjdGl2ZSwgbG93ZXIgaXQKICAgICAgICBHYW1lLnBsZWRnZVQtLTsKICAgICAgICBpZiAoR2FtZS5wbGVkZ2VUID09IDApIHsKICAgICAgICAgIC8vZGlkIHdlIHJlYWNoIDA/IG1ha2UgdGhlIHBsZWRnZSBwdXJjaGFzYWJsZSBhZ2FpbgogICAgICAgICAgR2FtZS5Mb2NrKCJFbGRlciBQbGVkZ2UiKTsKICAgICAgICAgIEdhbWUuVW5sb2NrKCJFbGRlciBQbGVkZ2UiKTsKICAgICAgICAgIEdhbWUuZWxkZXJXcmF0aCA9IDE7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmIChHYW1lLkhhcygiT25lIG1pbmQiKSAmJiBHYW1lLmVsZGVyV3JhdGggPT0gMCkgewogICAgICAgICAgR2FtZS5lbGRlcldyYXRoID0gMTsKICAgICAgICB9CiAgICAgICAgaWYgKAogICAgICAgICAgTWF0aC5yYW5kb20oKSA8IDAuMDAxICYmCiAgICAgICAgICBHYW1lLmVsZGVyV3JhdGggPAogICAgICAgICAgICBHYW1lLkhhcygiT25lIG1pbmQiKSArCiAgICAgICAgICAgICAgR2FtZS5IYXMoIkNvbW11bmFsIGJyYWluc3dlZXAiKSArCiAgICAgICAgICAgICAgR2FtZS5IYXMoIkVsZGVyIFBhY3QiKQogICAgICAgICkgewogICAgICAgICAgR2FtZS5lbGRlcldyYXRoKys7IC8vaGF2ZSB3ZSBhbHJlYWR5IHBsZWRnZWQ/IG1ha2UgdGhlIGVsZGVyIHdyYXRoIHNoaWZ0IGJldHdlZW4gZGlmZmVyZW50IHN0YWdlcwogICAgICAgIH0KICAgICAgICBpZiAoCiAgICAgICAgICBHYW1lLkhhcygiRWxkZXIgUGFjdCIpICYmCiAgICAgICAgICBHYW1lLlVwZ3JhZGVzWyJFbGRlciBQbGVkZ2UiXS51bmxvY2tlZCA9PSAwCiAgICAgICAgKSB7CiAgICAgICAgICBHYW1lLkxvY2soIkVsZGVyIFBsZWRnZSIpOwogICAgICAgICAgR2FtZS5VbmxvY2soIkVsZGVyIFBsZWRnZSIpOwogICAgICAgIH0KICAgICAgfQogICAgICBHYW1lLmVsZGVyV3JhdGhEICs9IChHYW1lLmVsZGVyV3JhdGggKyAxIC0gR2FtZS5lbGRlcldyYXRoRCkgKiAwLjAwMTsgLy9zbG93bHkgZmFkZSB0byB0aGUgdGFyZ2V0IHdyYXRoIHN0YXRlCgogICAgICBpZiAoR2FtZS5lbGRlcldyYXRoICE9IEdhbWUuZWxkZXJXcmF0aE9sZCkgewogICAgICAgIGlmIChHYW1lLmNsaWNrc1RoaXNTZXNzaW9uID4gMCkgewogICAgICAgICAgaWYgKEdhbWUuZWxkZXJXcmF0aCA+PSAzKSBQbGF5Q3VlKCJmYWRlVG8iLCAiZ3JhbmRtYXBvY2FseXBzZSIpOwogICAgICAgICAgZWxzZSBQbGF5Q3VlKCJmYWRlVG8iLCAiY2xpY2siKTsKICAgICAgICB9CiAgICAgICAgR2FtZS5zdG9yZVRvUmVmcmVzaCA9IDE7CiAgICAgIH0KCiAgICAgIEdhbWUuZWxkZXJXcmF0aE9sZCA9IEdhbWUuZWxkZXJXcmF0aDsKCiAgICAgIEdhbWUuVXBkYXRlV3JpbmtsZXJzKCk7CiAgICB9OwoKICAgIC8vd3JpbmtsZXJzCgogICAgZnVuY3Rpb24gaW5SZWN0KHgsIHksIHJlY3QpIHsKICAgICAgLy9maW5kIG91dCBpZiB0aGUgcG9pbnQgeCx5IGlzIGluIHRoZSByb3RhdGVkIHJlY3RhbmdsZSByZWN0e3csaCxyLG99ICh3aWR0aCxoZWlnaHQscm90YXRpb24gaW4gcmFkaWFucyx5LW9yaWdpbikgKG5lZWRzIHRvIGJlIG5vcm1hbGl6ZWQpCiAgICAgIC8vSSBmb3VuZCB0aGlzIHNvbWV3aGVyZSBvbmxpbmUgSSBndWVzcwogICAgICB2YXIgZHggPSB4ICsgTWF0aC5zaW4oLXJlY3QucikgKiAtKHJlY3QuaCAvIDIgLSByZWN0Lm8pLAogICAgICAgIGR5ID0geSArIE1hdGguY29zKC1yZWN0LnIpICogLShyZWN0LmggLyAyIC0gcmVjdC5vKTsKICAgICAgdmFyIGgxID0gTWF0aC5zcXJ0KGR4ICogZHggKyBkeSAqIGR5KTsKICAgICAgdmFyIGN1cnJBID0gTWF0aC5hdGFuMihkeSwgZHgpOwogICAgICB2YXIgbmV3QSA9IGN1cnJBIC0gcmVjdC5yOwogICAgICB2YXIgeDIgPSBNYXRoLmNvcyhuZXdBKSAqIGgxOwogICAgICB2YXIgeTIgPSBNYXRoLnNpbihuZXdBKSAqIGgxOwogICAgICBpZiAoCiAgICAgICAgeDIgPiAtMC41ICogcmVjdC53ICYmCiAgICAgICAgeDIgPCAwLjUgKiByZWN0LncgJiYKICAgICAgICB5MiA+IC0wLjUgKiByZWN0LmggJiYKICAgICAgICB5MiA8IDAuNSAqIHJlY3QuaAogICAgICApCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBHYW1lLndyaW5rbGVySFAgPSAyLjE7CiAgICBHYW1lLndyaW5rbGVycyA9IFtdOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxMjsgaSsrKSB7CiAgICAgIEdhbWUud3JpbmtsZXJzLnB1c2goewogICAgICAgIGlkOiBwYXJzZUludChpKSwKICAgICAgICBjbG9zZTogMCwKICAgICAgICBzdWNrZWQ6IDAsCiAgICAgICAgcGhhc2U6IDAsCiAgICAgICAgeDogMCwKICAgICAgICB5OiAwLAogICAgICAgIHI6IDAsCiAgICAgICAgaHVydDogMCwKICAgICAgICBocDogR2FtZS53cmlua2xlckhQLAogICAgICAgIHNlbGVjdGVkOiAwLAogICAgICAgIHR5cGU6IDAsCiAgICAgIH0pOwogICAgfQogICAgR2FtZS5nZXRXcmlua2xlcnNNYXggPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBuID0gMTA7CiAgICAgIGlmIChHYW1lLkhhcygiRWxkZXIgc3BpY2UiKSkgbiArPSAyOwogICAgICByZXR1cm4gbjsKICAgIH07CiAgICBHYW1lLlJlc2V0V3JpbmtsZXJzID0gZnVuY3Rpb24gKCkgewogICAgICBmb3IgKHZhciBpIGluIEdhbWUud3JpbmtsZXJzKSB7CiAgICAgICAgR2FtZS53cmlua2xlcnNbaV0gPSB7CiAgICAgICAgICBpZDogcGFyc2VJbnQoaSksCiAgICAgICAgICBjbG9zZTogMCwKICAgICAgICAgIHN1Y2tlZDogMCwKICAgICAgICAgIHBoYXNlOiAwLAogICAgICAgICAgeDogMCwKICAgICAgICAgIHk6IDAsCiAgICAgICAgICByOiAwLAogICAgICAgICAgaHVydDogMCwKICAgICAgICAgIGhwOiBHYW1lLndyaW5rbGVySFAsCiAgICAgICAgICBzZWxlY3RlZDogMCwKICAgICAgICAgIHR5cGU6IDAsCiAgICAgICAgfTsKICAgICAgfQogICAgfTsKICAgIEdhbWUuQ29sbGVjdFdyaW5rbGVycyA9IGZ1bmN0aW9uICgpIHsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLndyaW5rbGVycykgewogICAgICAgIEdhbWUud3JpbmtsZXJzW2ldLmhwID0gMDsKICAgICAgfQogICAgfTsKICAgIEdhbWUud3JpbmtsZXJTcXVpc2hTb3VuZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDQpICsgMTsKICAgIEdhbWUucGxheVdyaW5rbGVyU3F1aXNoU291bmQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIFBsYXlTb3VuZCgKICAgICAgICAic25kLyIgKwogICAgICAgICAgKEdhbWUuV0lOS0xFUlMgPyAic3F1ZWFrIiA6ICJzcXVpc2giKSArCiAgICAgICAgICBHYW1lLndyaW5rbGVyU3F1aXNoU291bmQgKwogICAgICAgICAgIi5tcDMiLAogICAgICAgIDAuNQogICAgICApOwogICAgICBHYW1lLndyaW5rbGVyU3F1aXNoU291bmQgKz0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMS41KSArIDE7CiAgICAgIGlmIChHYW1lLndyaW5rbGVyU3F1aXNoU291bmQgPiA0KSBHYW1lLndyaW5rbGVyU3F1aXNoU291bmQgLT0gNDsKICAgIH07CiAgICBHYW1lLlNwYXduV3JpbmtsZXIgPSBmdW5jdGlvbiAobWUpIHsKICAgICAgaWYgKCFtZSkgewogICAgICAgIHZhciBtYXggPSBHYW1lLmdldFdyaW5rbGVyc01heCgpOwogICAgICAgIHZhciBuID0gMDsKICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUud3JpbmtsZXJzKSB7CiAgICAgICAgICBpZiAoR2FtZS53cmlua2xlcnNbaV0ucGhhc2UgPiAwKSBuKys7CiAgICAgICAgfQogICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS53cmlua2xlcnMpIHsKICAgICAgICAgIHZhciBpdCA9IEdhbWUud3JpbmtsZXJzW2ldOwogICAgICAgICAgaWYgKGl0LnBoYXNlID09IDAgJiYgR2FtZS5lbGRlcldyYXRoID4gMCAmJiBuIDwgbWF4ICYmIGl0LmlkIDwgbWF4KSB7CiAgICAgICAgICAgIG1lID0gaXQ7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoIW1lKSByZXR1cm4gZmFsc2U7CiAgICAgIG1lLnBoYXNlID0gMTsKICAgICAgbWUuaHAgPSBHYW1lLndyaW5rbGVySFA7CiAgICAgIG1lLnR5cGUgPSAwOwogICAgICBpZiAoTWF0aC5yYW5kb20oKSA8IDAuMDAwMSkgbWUudHlwZSA9IDE7IC8vc2hpbnkgd3JpbmtsZXIKICAgICAgcmV0dXJuIG1lOwogICAgfTsKICAgIEdhbWUuUG9wUmFuZG9tV3JpbmtsZXIgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciB3cmlua2xlcnMgPSBbXTsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLndyaW5rbGVycykgewogICAgICAgIGlmIChHYW1lLndyaW5rbGVyc1tpXS5waGFzZSA+IDAgJiYgR2FtZS53cmlua2xlcnNbaV0uaHAgPiAwKQogICAgICAgICAgd3JpbmtsZXJzLnB1c2goR2FtZS53cmlua2xlcnNbaV0pOwogICAgICB9CiAgICAgIGlmICh3cmlua2xlcnMubGVuZ3RoID4gMCkgewogICAgICAgIHZhciBtZSA9IGNob29zZSh3cmlua2xlcnMpOwogICAgICAgIG1lLmhwID0gLTEwOwogICAgICAgIHJldHVybiBtZTsKICAgICAgfQogICAgICByZXR1cm4gZmFsc2U7CiAgICB9OwogICAgR2FtZS5VcGRhdGVXcmlua2xlcnMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciB4QmFzZSA9IDA7CiAgICAgIHZhciB5QmFzZSA9IDA7CiAgICAgIHZhciBvbldyaW5rbGVyID0gMDsKICAgICAgaWYgKEdhbWUuTGVmdEJhY2tncm91bmQpIHsKICAgICAgICB4QmFzZSA9IEdhbWUuY29va2llT3JpZ2luWDsKICAgICAgICB5QmFzZSA9IEdhbWUuY29va2llT3JpZ2luWTsKICAgICAgfQogICAgICB2YXIgbWF4ID0gR2FtZS5nZXRXcmlua2xlcnNNYXgoKTsKICAgICAgdmFyIG4gPSAwOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUud3JpbmtsZXJzKSB7CiAgICAgICAgaWYgKEdhbWUud3JpbmtsZXJzW2ldLnBoYXNlID4gMCkgbisrOwogICAgICB9CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS53cmlua2xlcnMpIHsKICAgICAgICB2YXIgbWUgPSBHYW1lLndyaW5rbGVyc1tpXTsKICAgICAgICBpZiAobWUucGhhc2UgPT0gMCAmJiBHYW1lLmVsZGVyV3JhdGggPiAwICYmIG4gPCBtYXggJiYgbWUuaWQgPCBtYXgpIHsKICAgICAgICAgIHZhciBjaGFuY2UgPSAwLjAwMDAxICogR2FtZS5lbGRlcldyYXRoOwogICAgICAgICAgY2hhbmNlICo9IEdhbWUuZWZmKCJ3cmlua2xlclNwYXduIik7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIlVuaG9seSBiYWl0IikpIGNoYW5jZSAqPSA1OwogICAgICAgICAgaWYgKEdhbWUuaGFzR29kKSB7CiAgICAgICAgICAgIHZhciBnb2RMdmwgPSBHYW1lLmhhc0dvZCgic2Nvcm4iKTsKICAgICAgICAgICAgaWYgKGdvZEx2bCA9PSAxKSBjaGFuY2UgKj0gMi41OwogICAgICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMikgY2hhbmNlICo9IDI7CiAgICAgICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAzKSBjaGFuY2UgKj0gMS41OwogICAgICAgICAgfQogICAgICAgICAgaWYgKEdhbWUuSGFzKCJXcmlua2xlciBkb29ybWF0IikpIGNoYW5jZSA9IDAuMTsKICAgICAgICAgIGlmIChNYXRoLnJhbmRvbSgpIDwgY2hhbmNlKSB7CiAgICAgICAgICAgIC8vcmVzcGF3bgogICAgICAgICAgICBHYW1lLlNwYXduV3JpbmtsZXIobWUpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAobWUucGhhc2UgPiAwKSB7CiAgICAgICAgICBpZiAobWUuY2xvc2UgPCAxKSBtZS5jbG9zZSArPSAxIC8gR2FtZS5mcHMgLyAxMDsKICAgICAgICAgIGlmIChtZS5jbG9zZSA+IDEpIG1lLmNsb3NlID0gMTsKICAgICAgICB9IGVsc2UgbWUuY2xvc2UgPSAwOwogICAgICAgIGlmIChtZS5jbG9zZSA9PSAxICYmIG1lLnBoYXNlID09IDEpIHsKICAgICAgICAgIG1lLnBoYXNlID0gMjsKICAgICAgICAgIEdhbWUucmVjYWxjdWxhdGVHYWlucyA9IDE7CiAgICAgICAgfQogICAgICAgIGlmIChtZS5waGFzZSA9PSAyKSB7CiAgICAgICAgICBtZS5zdWNrZWQgKz0gKEdhbWUuY29va2llc1BzIC8gR2FtZS5mcHMpICogR2FtZS5jcHNTdWNrZWQ7IC8vc3VjayB0aGUgY29va2llcwogICAgICAgIH0KICAgICAgICBpZiAobWUucGhhc2UgPiAwKSB7CiAgICAgICAgICBpZiAobWUudHlwZSA9PSAwKSB7CiAgICAgICAgICAgIGlmIChtZS5ocCA8IEdhbWUud3JpbmtsZXJIUCkgbWUuaHAgKz0gMC4wNDsKICAgICAgICAgICAgbWUuaHAgPSBNYXRoLm1pbihHYW1lLndyaW5rbGVySFAsIG1lLmhwKTsKICAgICAgICAgIH0gZWxzZSBpZiAobWUudHlwZSA9PSAxKSB7CiAgICAgICAgICAgIGlmIChtZS5ocCA8IEdhbWUud3JpbmtsZXJIUCAqIDMpIG1lLmhwICs9IDAuMDQ7CiAgICAgICAgICAgIG1lLmhwID0gTWF0aC5taW4oR2FtZS53cmlua2xlckhQICogMywgbWUuaHApOwogICAgICAgICAgfQogICAgICAgICAgdmFyIGQgPSAxMjggKiAoMiAtIG1lLmNsb3NlKTsgLy8qR2FtZS5CaWdDb29raWVTaXplOwogICAgICAgICAgaWYgKEdhbWUucHJlZnMuZmFuY3kpCiAgICAgICAgICAgIGQgKz0gTWF0aC5jb3MoR2FtZS5UICogMC4wNSArIHBhcnNlSW50KG1lLmlkKSkgKiA0OwogICAgICAgICAgbWUuciA9IChtZS5pZCAvIG1heCkgKiAzNjA7CiAgICAgICAgICBpZiAoR2FtZS5wcmVmcy5mYW5jeSkKICAgICAgICAgICAgbWUuciArPSBNYXRoLnNpbihHYW1lLlQgKiAwLjA1ICsgcGFyc2VJbnQobWUuaWQpKSAqIDQ7CiAgICAgICAgICBtZS54ID0geEJhc2UgKyBNYXRoLnNpbigobWUuciAqIE1hdGguUEkpIC8gMTgwKSAqIGQ7CiAgICAgICAgICBtZS55ID0geUJhc2UgKyBNYXRoLmNvcygobWUuciAqIE1hdGguUEkpIC8gMTgwKSAqIGQ7CiAgICAgICAgICBpZiAoR2FtZS5wcmVmcy5mYW5jeSkKICAgICAgICAgICAgbWUuciArPSBNYXRoLnNpbihHYW1lLlQgKiAwLjA5ICsgcGFyc2VJbnQobWUuaWQpKSAqIDQ7CiAgICAgICAgICB2YXIgcmVjdCA9IHsgdzogMTAwLCBoOiAyMDAsIHI6ICgtbWUuciAqIE1hdGguUEkpIC8gMTgwLCBvOiAxMCB9OwogICAgICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPCAwLjAxICYmICFHYW1lLnByZWZzLm5vdFNjYXJ5KQogICAgICAgICAgICBtZS5odXJ0ID0gTWF0aC5tYXgobWUuaHVydCwgTWF0aC5yYW5kb20oKSk7CiAgICAgICAgICBpZiAoR2FtZS5UICUgNSA9PSAwICYmIEdhbWUuQ2FuQ2xpY2spIHsKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgIEdhbWUuTGVmdEJhY2tncm91bmQgJiYKICAgICAgICAgICAgICBHYW1lLm1vdXNlWCA8IEdhbWUuTGVmdEJhY2tncm91bmQuY2FudmFzLndpZHRoICYmCiAgICAgICAgICAgICAgaW5SZWN0KEdhbWUubW91c2VYIC0gbWUueCwgR2FtZS5tb3VzZVkgLSBtZS55LCByZWN0KQogICAgICAgICAgICApCiAgICAgICAgICAgICAgbWUuc2VsZWN0ZWQgPSAxOwogICAgICAgICAgICBlbHNlIG1lLnNlbGVjdGVkID0gMDsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChtZS5zZWxlY3RlZCAmJiBvbldyaW5rbGVyID09IDAgJiYgR2FtZS5DYW5DbGljaykgewogICAgICAgICAgICBtZS5odXJ0ID0gTWF0aC5tYXgobWUuaHVydCwgMC4yNSk7CiAgICAgICAgICAgIC8vbWUuY2xvc2UqPTAuOTk7CiAgICAgICAgICAgIGlmIChHYW1lLkNsaWNrICYmIEdhbWUubGFzdENsaWNrZWRFbCA9PSBsKCJiYWNrZ3JvdW5kTGVmdENhbnZhcyIpKSB7CiAgICAgICAgICAgICAgaWYgKEdhbWUua2V5c1sxN10gJiYgR2FtZS5zZXNhbWUpIHsKICAgICAgICAgICAgICAgIG1lLnR5cGUgPSAhbWUudHlwZTsKICAgICAgICAgICAgICAgIFBsYXlTb3VuZCgic25kL3NoaW1tZXJDbGljay5tcDMiKTsKICAgICAgICAgICAgICB9IC8vY3RybC1jbGljayBvbiBhIHdyaW5rbGVyIGluIGdvZCBtb2RlIHRvIHRvZ2dsZSBpdHMgc2hpbmluZXNzCiAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBHYW1lLnBsYXlXcmlua2xlclNxdWlzaFNvdW5kKCk7CiAgICAgICAgICAgICAgICBtZS5odXJ0ID0gMTsKICAgICAgICAgICAgICAgIG1lLmhwIC09IDAuNzU7CiAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgIEdhbWUucHJlZnMucGFydGljbGVzICYmCiAgICAgICAgICAgICAgICAgICFHYW1lLnByZWZzLm5vdFNjYXJ5ICYmCiAgICAgICAgICAgICAgICAgICFHYW1lLldJTktMRVJTICYmCiAgICAgICAgICAgICAgICAgICEobWUuaHAgPD0gMC41ICYmIG1lLnBoYXNlID4gMCkKICAgICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgICB2YXIgeCA9IG1lLnggKyBNYXRoLnNpbigobWUuciAqIE1hdGguUEkpIC8gMTgwKSAqIDkwOwogICAgICAgICAgICAgICAgICB2YXIgeSA9IG1lLnkgKyBNYXRoLmNvcygobWUuciAqIE1hdGguUEkpIC8gMTgwKSAqIDkwOwogICAgICAgICAgICAgICAgICBmb3IgKHZhciBpaSA9IDA7IGlpIDwgMzsgaWkrKykgewogICAgICAgICAgICAgICAgICAgIC8vR2FtZS5wYXJ0aWNsZUFkZCh4K01hdGgucmFuZG9tKCkqNTAtMjUseStNYXRoLnJhbmRvbSgpKjUwLTI1LE1hdGgucmFuZG9tKCkqNC0yLE1hdGgucmFuZG9tKCkqLTItMiwxLDEsMiwnd3JpbmtsZXJCaXRzLnBuZycpOwogICAgICAgICAgICAgICAgICAgIHZhciBwYXJ0ID0gR2FtZS5wYXJ0aWNsZUFkZCgKICAgICAgICAgICAgICAgICAgICAgIHgsCiAgICAgICAgICAgICAgICAgICAgICB5LAogICAgICAgICAgICAgICAgICAgICAgTWF0aC5yYW5kb20oKSAqIDQgLSAyLAogICAgICAgICAgICAgICAgICAgICAgTWF0aC5yYW5kb20oKSAqIC0yIC0gMiwKICAgICAgICAgICAgICAgICAgICAgIDEsCiAgICAgICAgICAgICAgICAgICAgICAxLAogICAgICAgICAgICAgICAgICAgICAgMiwKICAgICAgICAgICAgICAgICAgICAgIG1lLnR5cGUgPT0gMQogICAgICAgICAgICAgICAgICAgICAgICA/ICJzaGlueVdyaW5rbGVyQml0cy5wbmciCiAgICAgICAgICAgICAgICAgICAgICAgIDogIndyaW5rbGVyQml0cy5wbmciCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICBwYXJ0LnIgPSAtbWUucjsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBHYW1lLkNsaWNrID0gMDsKICAgICAgICAgICAgfQogICAgICAgICAgICBvbldyaW5rbGVyID0gMTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChtZS5odXJ0ID4gMCkgewogICAgICAgICAgbWUuaHVydCAtPSA1IC8gR2FtZS5mcHM7CiAgICAgICAgICAvL21lLmNsb3NlLT1tZS5odXJ0KjAuMDU7CiAgICAgICAgICAvL21lLngrPU1hdGgucmFuZG9tKCkqMi0xOwogICAgICAgICAgLy9tZS55Kz1NYXRoLnJhbmRvbSgpKjItMTsKICAgICAgICAgIG1lLnIgKz0gTWF0aC5zaW4oR2FtZS5UICogMSkgKiBtZS5odXJ0ICogMTg7IC8vTWF0aC5yYW5kb20oKSoyLTE7CiAgICAgICAgfQogICAgICAgIGlmIChtZS5ocCA8PSAwLjUgJiYgbWUucGhhc2UgPiAwKSB7CiAgICAgICAgICBHYW1lLnBsYXlXcmlua2xlclNxdWlzaFNvdW5kKCk7CiAgICAgICAgICBQbGF5U291bmQoCiAgICAgICAgICAgICJzbmQvcG9wIiArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDMgKyAxKSArICIubXAzIiwKICAgICAgICAgICAgMC43NQogICAgICAgICAgKTsKICAgICAgICAgIEdhbWUud3JpbmtsZXJzUG9wcGVkKys7CiAgICAgICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICAgICAgbWUucGhhc2UgPSAwOwogICAgICAgICAgbWUuY2xvc2UgPSAwOwogICAgICAgICAgbWUuaHVydCA9IDA7CiAgICAgICAgICBtZS5ocCA9IDM7CiAgICAgICAgICB2YXIgdG9TdWNrID0gMS4xOwogICAgICAgICAgaWYgKEdhbWUuSGFzKCJTYWNyaWxlZ2lvdXMgY29ycnVwdGlvbiIpKSB0b1N1Y2sgKj0gMS4wNTsKICAgICAgICAgIGlmIChtZS50eXBlID09IDEpIHRvU3VjayAqPSAzOyAvL3NoaW55IHdyaW5rbGVycyBhcmUgYW4gZWx1c2l2ZSwgcHJvZml0YWJsZSBicmVlZAogICAgICAgICAgbWUuc3Vja2VkICo9IHRvU3VjazsgLy9jb29raWUgZG91Z2ggZG9lcyB3ZWlyZCB0aGluZ3MgaW5zaWRlIHdyaW5rbGVyIGRpZ2VzdGl2ZSB0cmFjdHMKICAgICAgICAgIGlmIChHYW1lLkhhcygiV3JpbmtsZXJzcGF3biIpKSBtZS5zdWNrZWQgKj0gMS4wNTsKICAgICAgICAgIGlmIChHYW1lLmhhc0dvZCkgewogICAgICAgICAgICB2YXIgZ29kTHZsID0gR2FtZS5oYXNHb2QoInNjb3JuIik7CiAgICAgICAgICAgIGlmIChnb2RMdmwgPT0gMSkgbWUuc3Vja2VkICo9IDEuMTU7CiAgICAgICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAyKSBtZS5zdWNrZWQgKj0gMS4xOwogICAgICAgICAgICBlbHNlIGlmIChnb2RMdmwgPT0gMykgbWUuc3Vja2VkICo9IDEuMDU7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAobWUuc3Vja2VkID4gMC41KSB7CiAgICAgICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgICAgIG1lLnR5cGUgPT0gMQogICAgICAgICAgICAgICAgPyBsb2MoIkV4cGxvZGVkIGEgc2hpbnkgd3JpbmtsZXIiKQogICAgICAgICAgICAgICAgOiBsb2MoIkV4cGxvZGVkIGEgd3JpbmtsZXIiKSwKICAgICAgICAgICAgICBsb2MoIkZvdW5kIDxiPiUxPC9iPiEiLCBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeShtZS5zdWNrZWQpKSksCiAgICAgICAgICAgICAgWzE5LCA4XSwKICAgICAgICAgICAgICA2CiAgICAgICAgICAgICk7CiAgICAgICAgICAgIEdhbWUuUG9wdXAoCiAgICAgICAgICAgICAgJzxkaXYgc3R5bGU9ImZvbnQtc2l6ZTo4MCU7Ij4nICsKICAgICAgICAgICAgICAgIGxvYygiKyUxISIsIGxvYygiJTEgY29va2llIiwgTEJlYXV0aWZ5KG1lLnN1Y2tlZCkpKSArCiAgICAgICAgICAgICAgICAiPC9kaXY+IiwKICAgICAgICAgICAgICBHYW1lLm1vdXNlWCwKICAgICAgICAgICAgICBHYW1lLm1vdXNlWQogICAgICAgICAgICApOwoKICAgICAgICAgICAgaWYgKEdhbWUuc2Vhc29uID09ICJoYWxsb3dlZW4iKSB7CiAgICAgICAgICAgICAgLy9pZiAoTWF0aC5yYW5kb20oKTwoR2FtZS5IYXNBY2hpZXYoJ1Nwb29reSBjb29raWVzJyk/MC4yOjAuMDUpKS8vaGFsbG93ZWVuIGNvb2tpZSBkcm9wcwogICAgICAgICAgICAgIHZhciBmYWlsUmF0ZSA9IDAuOTU7CiAgICAgICAgICAgICAgaWYgKEdhbWUuSGFzQWNoaWV2KCJTcG9va3kgY29va2llcyIpKSBmYWlsUmF0ZSA9IDAuODsKICAgICAgICAgICAgICBpZiAoR2FtZS5IYXMoIlN0YXJ0ZXJyb3IiKSkgZmFpbFJhdGUgKj0gMC45OwogICAgICAgICAgICAgIGZhaWxSYXRlICo9IDEgLyBHYW1lLmRyb3BSYXRlTXVsdCgpOwogICAgICAgICAgICAgIGlmIChHYW1lLmhhc0dvZCkgewogICAgICAgICAgICAgICAgdmFyIGdvZEx2bCA9IEdhbWUuaGFzR29kKCJzZWFzb25zIik7CiAgICAgICAgICAgICAgICBpZiAoZ29kTHZsID09IDEpIGZhaWxSYXRlICo9IDAuOTsKICAgICAgICAgICAgICAgIGVsc2UgaWYgKGdvZEx2bCA9PSAyKSBmYWlsUmF0ZSAqPSAwLjk1OwogICAgICAgICAgICAgICAgZWxzZSBpZiAoZ29kTHZsID09IDMpIGZhaWxSYXRlICo9IDAuOTc7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmIChtZS50eXBlID09IDEpIGZhaWxSYXRlICo9IDAuOTsKICAgICAgICAgICAgICBpZiAoTWF0aC5yYW5kb20oKSA+IGZhaWxSYXRlKSB7CiAgICAgICAgICAgICAgICAvL2hhbGxvd2VlbiBjb29raWUgZHJvcHMKICAgICAgICAgICAgICAgIHZhciBjb29raWUgPSBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAiU2t1bGwgY29va2llcyIsCiAgICAgICAgICAgICAgICAgICJHaG9zdCBjb29raWVzIiwKICAgICAgICAgICAgICAgICAgIkJhdCBjb29raWVzIiwKICAgICAgICAgICAgICAgICAgIlNsaW1lIGNvb2tpZXMiLAogICAgICAgICAgICAgICAgICAiUHVtcGtpbiBjb29raWVzIiwKICAgICAgICAgICAgICAgICAgIkV5ZWJhbGwgY29va2llcyIsCiAgICAgICAgICAgICAgICAgICJTcGlkZXIgY29va2llcyIsCiAgICAgICAgICAgICAgICBdKTsKICAgICAgICAgICAgICAgIGlmICghR2FtZS5IYXNVbmxvY2tlZChjb29raWUpICYmICFHYW1lLkhhcyhjb29raWUpKSB7CiAgICAgICAgICAgICAgICAgIEdhbWUuVW5sb2NrKGNvb2tpZSk7CiAgICAgICAgICAgICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgICAgICAgICAgIEdhbWUuVXBncmFkZXNbY29va2llXS5kbmFtZSwKICAgICAgICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAgICAgICAiWW91IGFsc28gZm91bmQgPGI+JTE8L2I+ISIsCiAgICAgICAgICAgICAgICAgICAgICBHYW1lLlVwZ3JhZGVzW2Nvb2tpZV0uZG5hbWUKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIEdhbWUuVXBncmFkZXNbY29va2llXS5pY29uCiAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIEdhbWUuRHJvcEVnZygwLjk4KTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChtZS50eXBlID09IDEpIEdhbWUuV2luKCJMYXN0IENoYW5jZSB0byBTZWUiKTsKICAgICAgICAgIEdhbWUuRWFybihtZS5zdWNrZWQpOwogICAgICAgICAgLyppZiAoR2FtZS5wcmVmcy5wYXJ0aWNsZXMgJiYgIUdhbWUuV0lOS0xFUlMpCgkJCQkJewoJCQkJCQl2YXIgeD1tZS54KyhNYXRoLnNpbihtZS5yKk1hdGguUEkvMTgwKSoxMDApOwoJCQkJCQl2YXIgeT1tZS55KyhNYXRoLmNvcyhtZS5yKk1hdGguUEkvMTgwKSoxMDApOwoJCQkJCQlmb3IgKHZhciBpaT0wO2lpPDY7aWkrKykKCQkJCQkJewoJCQkJCQkJR2FtZS5wYXJ0aWNsZUFkZCh4K01hdGgucmFuZG9tKCkqNTAtMjUseStNYXRoLnJhbmRvbSgpKjUwLTI1LE1hdGgucmFuZG9tKCkqNC0yLE1hdGgucmFuZG9tKCkqLTItMiwxLDEsMiwnd3JpbmtsZXJCaXRzLnBuZycpOwoJCQkJCQl9CgkJCQkJfSovCiAgICAgICAgICBpZiAoR2FtZS5wcmVmcy5wYXJ0aWNsZXMpIHsKICAgICAgICAgICAgdmFyIHggPSBtZS54ICsgTWF0aC5zaW4oKG1lLnIgKiBNYXRoLlBJKSAvIDE4MCkgKiA5MDsKICAgICAgICAgICAgdmFyIHkgPSBtZS55ICsgTWF0aC5jb3MoKG1lLnIgKiBNYXRoLlBJKSAvIDE4MCkgKiA5MDsKICAgICAgICAgICAgaWYgKG1lLnN1Y2tlZCA+IDApIHsKICAgICAgICAgICAgICBmb3IgKHZhciBpaSA9IDA7IGlpIDwgNTsgaWkrKykgewogICAgICAgICAgICAgICAgR2FtZS5wYXJ0aWNsZUFkZCgKICAgICAgICAgICAgICAgICAgR2FtZS5tb3VzZVgsCiAgICAgICAgICAgICAgICAgIEdhbWUubW91c2VZLAogICAgICAgICAgICAgICAgICBNYXRoLnJhbmRvbSgpICogNCAtIDIsCiAgICAgICAgICAgICAgICAgIE1hdGgucmFuZG9tKCkgKiAtMiAtIDIsCiAgICAgICAgICAgICAgICAgIE1hdGgucmFuZG9tKCkgKiAwLjUgKyAwLjc1LAogICAgICAgICAgICAgICAgICAxLjUsCiAgICAgICAgICAgICAgICAgIDIKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghR2FtZS5wcmVmcy5ub3RTY2FyeSAmJiAhR2FtZS5XSU5LTEVSUykgewogICAgICAgICAgICAgIGZvciAodmFyIGlpID0gMDsgaWkgPCA4OyBpaSsrKSB7CiAgICAgICAgICAgICAgICB2YXIgcGFydCA9IEdhbWUucGFydGljbGVBZGQoCiAgICAgICAgICAgICAgICAgIHgsCiAgICAgICAgICAgICAgICAgIHksCiAgICAgICAgICAgICAgICAgIE1hdGgucmFuZG9tKCkgKiA0IC0gMiwKICAgICAgICAgICAgICAgICAgTWF0aC5yYW5kb20oKSAqIC0yIC0gMiwKICAgICAgICAgICAgICAgICAgMSwKICAgICAgICAgICAgICAgICAgMSwKICAgICAgICAgICAgICAgICAgMiwKICAgICAgICAgICAgICAgICAgbWUudHlwZSA9PSAxID8gInNoaW55V3JpbmtsZXJCaXRzLnBuZyIgOiAid3JpbmtsZXJCaXRzLnBuZyIKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICBwYXJ0LnIgPSAtbWUucjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIG1lLnN1Y2tlZCA9IDA7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChvbldyaW5rbGVyKSB7CiAgICAgICAgR2FtZS5tb3VzZVBvaW50ZXIgPSAxOwogICAgICB9CiAgICB9OwogICAgR2FtZS5EcmF3V3JpbmtsZXJzID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgY3R4ID0gR2FtZS5MZWZ0QmFja2dyb3VuZDsKICAgICAgdmFyIHNlbGVjdGVkID0gMDsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLndyaW5rbGVycykgewogICAgICAgIHZhciBtZSA9IEdhbWUud3JpbmtsZXJzW2ldOwogICAgICAgIGlmIChtZS5waGFzZSA+IDApIHsKICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IG1lLmNsb3NlOwogICAgICAgICAgY3R4LnNhdmUoKTsKICAgICAgICAgIGN0eC50cmFuc2xhdGUobWUueCwgbWUueSk7CiAgICAgICAgICB2YXIgc3cgPSAxMDAgKyAyICogTWF0aC5zaW4oR2FtZS5UICogMC4yICsgaSAqIDMpOwogICAgICAgICAgdmFyIHNoID0gMjAwICsgNSAqIE1hdGguc2luKEdhbWUuVCAqIDAuMiAtIDIgKyBpICogMyk7CiAgICAgICAgICBpZiAoR2FtZS5wcmVmcy5mYW5jeSkgewogICAgICAgICAgICBjdHgudHJhbnNsYXRlKDAsIDMwKTsKICAgICAgICAgICAgY3R4LnJvdGF0ZSgoLW1lLnIgKiBNYXRoLlBJKSAvIDE4MCk7CiAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoUGljKCJ3cmlua2xlclNoYWRvdy5wbmciKSwgLXN3IC8gMiwgLTEwLCBzdywgc2gpOwogICAgICAgICAgICBjdHgucm90YXRlKChtZS5yICogTWF0aC5QSSkgLyAxODApOwogICAgICAgICAgICBjdHgudHJhbnNsYXRlKDAsIC0zMCk7CiAgICAgICAgICB9CiAgICAgICAgICBjdHgucm90YXRlKCgtbWUuciAqIE1hdGguUEkpIC8gMTgwKTsKICAgICAgICAgIC8vdmFyIHM9TWF0aC5taW4oMSxtZS5zdWNrZWQvKEdhbWUuY29va2llc1BzKjYwKSkqMC43NSswLjI1Oy8vc2NhbGUgd3JpbmtsZXJzIGFzIHRoZXkgZWF0CiAgICAgICAgICAvL2N0eC5zY2FsZShNYXRoLnBvdyhzLDEuNSkqMS4yNSxzKTsKICAgICAgICAgIC8vY3R4LmZpbGxSZWN0KC01MCwtMTAsMTAwLDIwMCk7CiAgICAgICAgICB2YXIgcGljID0gR2FtZS5XSU5LTEVSUyA/ICJ3aW5rbGVyLnBuZyIgOiAid3JpbmtsZXIucG5nIjsKICAgICAgICAgIGlmIChtZS50eXBlID09IDEpCiAgICAgICAgICAgIHBpYyA9IEdhbWUuV0lOS0xFUlMgPyAic2hpbnlXaW5rbGVyLnBuZyIgOiAic2hpbnlXcmlua2xlci5wbmciOwogICAgICAgICAgZWxzZSBpZiAoR2FtZS5zZWFzb24gPT0gImNocmlzdG1hcyIpCiAgICAgICAgICAgIHBpYyA9IEdhbWUuV0lOS0xFUlMgPyAid2ludGVyV2lua2xlci5wbmciIDogIndpbnRlcldyaW5rbGVyLnBuZyI7CiAgICAgICAgICBjdHguZHJhd0ltYWdlKFBpYyhwaWMpLCAtc3cgLyAyLCAtMTAsIHN3LCBzaCk7CiAgICAgICAgICBpZiAoIUdhbWUuV0lOS0xFUlMgJiYgR2FtZS5wcmVmcy5ub3RTY2FyeSkKICAgICAgICAgICAgY3R4LmRyYXdJbWFnZSgKICAgICAgICAgICAgICBQaWMoCiAgICAgICAgICAgICAgICBNYXRoLnNpbigKICAgICAgICAgICAgICAgICAgR2FtZS5UICogMC4wMDMgKwogICAgICAgICAgICAgICAgICAgIGkgKiAxMSArCiAgICAgICAgICAgICAgICAgICAgMTM3ICsKICAgICAgICAgICAgICAgICAgICBNYXRoLnNpbihHYW1lLlQgKiAwLjAxNyArIGkgKiAxMykKICAgICAgICAgICAgICAgICkgPiAwLjk5OTcKICAgICAgICAgICAgICAgICAgPyAid3JpbmtsZXJCbGluay5wbmciCiAgICAgICAgICAgICAgICAgIDogIndyaW5rbGVyR29vZ2xpZXMucG5nIgogICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgLXN3IC8gMiwKICAgICAgICAgICAgICAtMTAgKyAxICogTWF0aC5zaW4oR2FtZS5UICogMC4yICsgaSAqIDMgKyAxLjIpLAogICAgICAgICAgICAgIHN3LAogICAgICAgICAgICAgIHNoCiAgICAgICAgICAgICk7CiAgICAgICAgICAvL2N0eC5kcmF3SW1hZ2UoUGljKHBpYyksLTUwLC0xMCk7CiAgICAgICAgICAvL2N0eC5maWxsVGV4dChtZS5pZCsnIDogJyttZS5zdWNrZWQsMCwwKTsKICAgICAgICAgIGlmIChtZS50eXBlID09IDEgJiYgTWF0aC5yYW5kb20oKSA8IDAuMyAmJiBHYW1lLnByZWZzLnBhcnRpY2xlcykgewogICAgICAgICAgICAvL3NwYXJrbGUKICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gTWF0aC5yYW5kb20oKSAqIDAuNjUgKyAwLjE7CiAgICAgICAgICAgIHZhciBzID0gTWF0aC5yYW5kb20oKSAqIDMwICsgNTsKICAgICAgICAgICAgY3R4Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9ICJsaWdodGVyIjsKICAgICAgICAgICAgY3R4LmRyYXdJbWFnZSgKICAgICAgICAgICAgICBQaWMoImdsaW50LmpwZyIpLAogICAgICAgICAgICAgIC1zIC8gMiArIE1hdGgucmFuZG9tKCkgKiA1MCAtIDI1LAogICAgICAgICAgICAgIC1zIC8gMiArIE1hdGgucmFuZG9tKCkgKiAyMDAsCiAgICAgICAgICAgICAgcywKICAgICAgICAgICAgICBzCiAgICAgICAgICAgICk7CiAgICAgICAgICB9CiAgICAgICAgICBjdHgucmVzdG9yZSgpOwoKICAgICAgICAgIGlmIChHYW1lLnByZWZzLnBhcnRpY2xlcyAmJiBtZS5waGFzZSA9PSAyICYmIE1hdGgucmFuZG9tKCkgPCAwLjAzKSB7CiAgICAgICAgICAgIEdhbWUucGFydGljbGVBZGQoCiAgICAgICAgICAgICAgbWUueCwKICAgICAgICAgICAgICBtZS55LAogICAgICAgICAgICAgIE1hdGgucmFuZG9tKCkgKiA0IC0gMiwKICAgICAgICAgICAgICBNYXRoLnJhbmRvbSgpICogLTIgLSAyLAogICAgICAgICAgICAgIE1hdGgucmFuZG9tKCkgKiAwLjUgKyAwLjUsCiAgICAgICAgICAgICAgMSwKICAgICAgICAgICAgICAyCiAgICAgICAgICAgICk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKG1lLnNlbGVjdGVkKSBzZWxlY3RlZCA9IG1lOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoc2VsZWN0ZWQgJiYgR2FtZS5IYXMoIkV5ZSBvZiB0aGUgd3JpbmtsZXIiKSkgewogICAgICAgIHZhciB4ID0gR2FtZS5jb29raWVPcmlnaW5YOwogICAgICAgIHZhciB5ID0gR2FtZS5jb29raWVPcmlnaW5ZOwogICAgICAgIGN0eC5mb250ID0gIjE0cHggTWVycml3ZWF0aGVyIjsKICAgICAgICBjdHgudGV4dEFsaWduID0gImNlbnRlciI7CiAgICAgICAgdmFyIHRleHQgPSBsb2MoIlN3YWxsb3dlZDoiKTsKICAgICAgICB2YXIgd2lkdGggPSBNYXRoLmNlaWwoCiAgICAgICAgICBNYXRoLm1heCgKICAgICAgICAgICAgY3R4Lm1lYXN1cmVUZXh0KHRleHQpLndpZHRoLAogICAgICAgICAgICBjdHgubWVhc3VyZVRleHQoQmVhdXRpZnkoc2VsZWN0ZWQuc3Vja2VkKSkud2lkdGgKICAgICAgICAgICkKICAgICAgICApOwogICAgICAgIGN0eC5maWxsU3R5bGUgPSAiIzAwMCI7CiAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMC42NTsKICAgICAgICAvKmN0eC5zdHJva2VTdHlsZT0nIzAwMCc7CgkJCQljdHgubGluZVdpZHRoPTg7CgkJCQljdHguYmVnaW5QYXRoKCk7CgkJCQljdHgubW92ZVRvKHgseSk7CgkJCQljdHgubGluZVRvKE1hdGguZmxvb3Ioc2VsZWN0ZWQueCksTWF0aC5mbG9vcihzZWxlY3RlZC55KSk7CgkJCQljdHguc3Ryb2tlKCk7Ki8KICAgICAgICB2YXIgeE8gPSB4IC0gd2lkdGggLyAyIC0gMTY7CiAgICAgICAgdmFyIHlPID0geSAtIDQ7CiAgICAgICAgdmFyIGRpc3QgPSBNYXRoLmZsb29yKAogICAgICAgICAgTWF0aC5zcXJ0KAogICAgICAgICAgICAoc2VsZWN0ZWQueCAtIHhPKSAqIChzZWxlY3RlZC54IC0geE8pICsKICAgICAgICAgICAgICAoc2VsZWN0ZWQueSAtIHlPKSAqIChzZWxlY3RlZC55IC0geU8pCiAgICAgICAgICApCiAgICAgICAgKTsKICAgICAgICB2YXIgYW5nbGUgPSAtTWF0aC5hdGFuMih5TyAtIHNlbGVjdGVkLnksIHhPIC0gc2VsZWN0ZWQueCkgKyBNYXRoLlBJIC8gMjsKICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSAiI2ZmZiI7CiAgICAgICAgY3R4LmxpbmVXaWR0aCA9IDE7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBNYXRoLmZsb29yKGRpc3QgLyAxMik7IGkrKykgewogICAgICAgICAgdmFyIHhDID0gc2VsZWN0ZWQueCArIE1hdGguc2luKGFuZ2xlKSAqIGkgKiAxMjsKICAgICAgICAgIHZhciB5QyA9IHNlbGVjdGVkLnkgKyBNYXRoLmNvcyhhbmdsZSkgKiBpICogMTI7CiAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7CiAgICAgICAgICBjdHguYXJjKAogICAgICAgICAgICB4QywKICAgICAgICAgICAgeUMsCiAgICAgICAgICAgIDQgKwogICAgICAgICAgICAgIChHYW1lLnByZWZzLmZhbmN5CiAgICAgICAgICAgICAgICA/IDIgKiBNYXRoLnBvdyhNYXRoLnNpbigtR2FtZS5UICogMC4yICsgaSAqIDAuMyksIDQpCiAgICAgICAgICAgICAgICA6IDApLAogICAgICAgICAgICAwLAogICAgICAgICAgICAyICogTWF0aC5QSSwKICAgICAgICAgICAgZmFsc2UKICAgICAgICAgICk7CiAgICAgICAgICBjdHguZmlsbCgpOwogICAgICAgICAgY3R4LnN0cm9rZSgpOwogICAgICAgIH0KICAgICAgICBjdHguZmlsbFJlY3QoeCAtIHdpZHRoIC8gMiAtIDggLSAxMCwgeSAtIDIzLCB3aWR0aCArIDE2ICsgMjAsIDM4KTsKICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSAiI2ZmZiI7CiAgICAgICAgY3R4LmxpbmVXaWR0aCA9IDE7CiAgICAgICAgY3R4LnN0cm9rZVJlY3QoCiAgICAgICAgICB4IC0gd2lkdGggLyAyIC0gOCAtIDEwICsgMS41LAogICAgICAgICAgeSAtIDIzICsgMS41LAogICAgICAgICAgd2lkdGggKyAxNiArIDIwIC0gMywKICAgICAgICAgIDM4IC0gMwogICAgICAgICk7CiAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMTsKICAgICAgICBjdHguZmlsbFN0eWxlID0gIiNmZmYiOwogICAgICAgIGN0eC5maWxsVGV4dCh0ZXh0LCB4ICsgMTQsIHkgLSA4KTsKICAgICAgICBjdHguZmlsbFRleHQoQmVhdXRpZnkoc2VsZWN0ZWQuc3Vja2VkKSwgeCArIDEwLCB5ICsgOCk7CiAgICAgICAgdmFyIHMgPSA1NCArIDIgKiBNYXRoLnNpbihHYW1lLlQgKiAwLjQpOwogICAgICAgIGN0eC5kcmF3SW1hZ2UoCiAgICAgICAgICBQaWMoImljb25zLnBuZyIpLAogICAgICAgICAgMjcgKiA0OCwKICAgICAgICAgIDI2ICogNDgsCiAgICAgICAgICA0OCwKICAgICAgICAgIDQ4LAogICAgICAgICAgeCAtIHdpZHRoIC8gMiAtIDE2IC0gcyAvIDIsCiAgICAgICAgICB5IC0gNCAtIHMgLyAyLAogICAgICAgICAgcywKICAgICAgICAgIHMKICAgICAgICApOwogICAgICB9CiAgICB9OwogICAgR2FtZS5TYXZlV3JpbmtsZXJzID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgYW1vdW50ID0gMDsKICAgICAgdmFyIGFtb3VudFNoaW5pZXMgPSAwOwogICAgICB2YXIgbnVtYmVyID0gMDsKICAgICAgdmFyIHNoaW5pZXMgPSAwOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUud3JpbmtsZXJzKSB7CiAgICAgICAgaWYgKEdhbWUud3JpbmtsZXJzW2ldLnN1Y2tlZCA+IDAuNSkgewogICAgICAgICAgbnVtYmVyKys7CiAgICAgICAgICBpZiAoR2FtZS53cmlua2xlcnNbaV0udHlwZSA9PSAxKSB7CiAgICAgICAgICAgIHNoaW5pZXMrKzsKICAgICAgICAgICAgYW1vdW50U2hpbmllcyArPSBHYW1lLndyaW5rbGVyc1tpXS5zdWNrZWQ7CiAgICAgICAgICB9IGVsc2UgYW1vdW50ICs9IEdhbWUud3JpbmtsZXJzW2ldLnN1Y2tlZDsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHsKICAgICAgICBhbW91bnQ6IGFtb3VudCwKICAgICAgICBudW1iZXI6IG51bWJlciwKICAgICAgICBzaGluaWVzOiBzaGluaWVzLAogICAgICAgIGFtb3VudFNoaW5pZXM6IGFtb3VudFNoaW5pZXMsCiAgICAgIH07CiAgICB9OwogICAgR2FtZS5Mb2FkV3JpbmtsZXJzID0gZnVuY3Rpb24gKGFtb3VudCwgbnVtYmVyLCBzaGluaWVzLCBhbW91bnRTaGluaWVzKSB7CiAgICAgIGlmIChudW1iZXIgPiAwICYmIChhbW91bnQgPiAwIHx8IGFtb3VudFNoaW5pZXMgPiAwKSkgewogICAgICAgIHZhciBmdWxsTnVtYmVyID0gbnVtYmVyIC0gc2hpbmllczsKICAgICAgICB2YXIgZnVsbE51bWJlclNoaW5pZXMgPSBzaGluaWVzOwogICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS53cmlua2xlcnMpIHsKICAgICAgICAgIGlmIChudW1iZXIgPiAwKSB7CiAgICAgICAgICAgIEdhbWUud3JpbmtsZXJzW2ldLnBoYXNlID0gMjsKICAgICAgICAgICAgR2FtZS53cmlua2xlcnNbaV0uY2xvc2UgPSAxOwogICAgICAgICAgICBHYW1lLndyaW5rbGVyc1tpXS5ocCA9IDM7CiAgICAgICAgICAgIGlmIChzaGluaWVzID4gMCkgewogICAgICAgICAgICAgIEdhbWUud3JpbmtsZXJzW2ldLnR5cGUgPSAxOwogICAgICAgICAgICAgIEdhbWUud3JpbmtsZXJzW2ldLnN1Y2tlZCA9IGFtb3VudFNoaW5pZXMgLyBmdWxsTnVtYmVyU2hpbmllczsKICAgICAgICAgICAgICBzaGluaWVzLS07CiAgICAgICAgICAgIH0gZWxzZSBHYW1lLndyaW5rbGVyc1tpXS5zdWNrZWQgPSBhbW91bnQgLyBmdWxsTnVtYmVyOwogICAgICAgICAgICBudW1iZXItLTsKICAgICAgICAgIH0gLy9yZXNwYXduCiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJCVNQRUNJQUwgVEhJTkdTIEFORCBTVFVGRgoJCT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCgogICAgR2FtZS5zcGVjaWFsVGFiID0gIiI7CiAgICBHYW1lLnNwZWNpYWxUYWJIb3ZlcmVkID0gIiI7CiAgICBHYW1lLnNwZWNpYWxUYWJzID0gW107CgogICAgR2FtZS5VcGRhdGVTcGVjaWFsID0gZnVuY3Rpb24gKCkgewogICAgICBHYW1lLnNwZWNpYWxUYWJzID0gW107CiAgICAgIGlmIChHYW1lLkhhcygiQSBmZXN0aXZlIGhhdCIpKSBHYW1lLnNwZWNpYWxUYWJzLnB1c2goInNhbnRhIik7CiAgICAgIGlmIChHYW1lLkhhcygiQSBjcnVtYmx5IGVnZyIpKSBHYW1lLnNwZWNpYWxUYWJzLnB1c2goImRyYWdvbiIpOwogICAgICBpZiAoR2FtZS5zcGVjaWFsVGFicy5sZW5ndGggPT0gMCkgewogICAgICAgIEdhbWUuVG9nZ2xlU3BlY2lhbE1lbnUoMCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoR2FtZS5MZWZ0QmFja2dyb3VuZCkgewogICAgICAgIEdhbWUuc3BlY2lhbFRhYkhvdmVyZWQgPSAiIjsKICAgICAgICB2YXIgbGVuID0gR2FtZS5zcGVjaWFsVGFicy5sZW5ndGg7CiAgICAgICAgaWYgKGxlbiA9PSAwKSByZXR1cm47CiAgICAgICAgdmFyIHkgPSBHYW1lLkxlZnRCYWNrZ3JvdW5kLmNhbnZhcy5oZWlnaHQgLSAyNCAtIDQ4ICogbGVuOwogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgR2FtZS5zcGVjaWFsVGFicy5sZW5ndGg7IGkrKykgewogICAgICAgICAgdmFyIHNlbGVjdGVkID0gMDsKICAgICAgICAgIGlmIChHYW1lLnNwZWNpYWxUYWIgPT0gR2FtZS5zcGVjaWFsVGFic1tpXSkgc2VsZWN0ZWQgPSAxOwogICAgICAgICAgdmFyIHggPSAyNDsKICAgICAgICAgIHZhciBzID0gMTsKICAgICAgICAgIGlmIChzZWxlY3RlZCkgewogICAgICAgICAgICBzID0gMjsKICAgICAgICAgICAgeCArPSAyNDsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIE1hdGguYWJzKEdhbWUubW91c2VYIC0geCkgPD0gMjQgKiBzICYmCiAgICAgICAgICAgIE1hdGguYWJzKEdhbWUubW91c2VZIC0geSkgPD0gMjQgKiBzCiAgICAgICAgICApIHsKICAgICAgICAgICAgR2FtZS5zcGVjaWFsVGFiSG92ZXJlZCA9IEdhbWUuc3BlY2lhbFRhYnNbaV07CiAgICAgICAgICAgIEdhbWUubW91c2VQb2ludGVyID0gMTsKICAgICAgICAgICAgR2FtZS5DYW5DbGljayA9IDA7CiAgICAgICAgICAgIGlmIChHYW1lLkNsaWNrICYmIEdhbWUubGFzdENsaWNrZWRFbCA9PSBsKCJiYWNrZ3JvdW5kTGVmdENhbnZhcyIpKSB7CiAgICAgICAgICAgICAgaWYgKEdhbWUuc3BlY2lhbFRhYiAhPSBHYW1lLnNwZWNpYWxUYWJzW2ldKSB7CiAgICAgICAgICAgICAgICBHYW1lLnNwZWNpYWxUYWIgPSBHYW1lLnNwZWNpYWxUYWJzW2ldOwogICAgICAgICAgICAgICAgR2FtZS5Ub2dnbGVTcGVjaWFsTWVudSgxKTsKICAgICAgICAgICAgICAgIFBsYXlTb3VuZCgic25kL3ByZXNzLm1wMyIpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBHYW1lLlRvZ2dsZVNwZWNpYWxNZW51KDApOwogICAgICAgICAgICAgICAgUGxheVNvdW5kKCJzbmQvcHJlc3MubXAzIik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIC8vUGxheVNvdW5kKCdzbmQvdGljay5tcDMnKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHkgKz0gNDg7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIEdhbWUuc2FudGFMZXZlbHMgPSBbCiAgICAgICJGZXN0aXZlIHRlc3QgdHViZSIsCiAgICAgICJGZXN0aXZlIG9ybmFtZW50IiwKICAgICAgIkZlc3RpdmUgd3JlYXRoIiwKICAgICAgIkZlc3RpdmUgdHJlZSIsCiAgICAgICJGZXN0aXZlIHByZXNlbnQiLAogICAgICAiRmVzdGl2ZSBlbGYgZmV0dXMiLAogICAgICAiRWxmIHRvZGRsZXIiLAogICAgICAiRWxmbGluZyIsCiAgICAgICJZb3VuZyBlbGYiLAogICAgICAiQnVsa3kgZWxmIiwKICAgICAgIk5pY2siLAogICAgICAiU2FudGEgQ2xhdXMiLAogICAgICAiRWxkZXIgU2FudGEiLAogICAgICAiVHJ1ZSBTYW50YSIsCiAgICAgICJGaW5hbCBDbGF1cyIsCiAgICBdOwogICAgaWYgKCFFTikgewogICAgICBmb3IgKHZhciBpIGluIEdhbWUuc2FudGFMZXZlbHMpIHsKICAgICAgICBHYW1lLnNhbnRhTGV2ZWxzW2ldID0gbG9jKEdhbWUuc2FudGFMZXZlbHNbaV0pOwogICAgICB9CiAgICB9CiAgICBmb3IgKHZhciBpIGluIEdhbWUuc2FudGFEcm9wcykgeyAvL3NjYWxlIGNocmlzdG1hcyB1cGdyYWRlIHByaWNlcyB3aXRoIHNhbnRhIGxldmVsCiAgICAgIEdhbWUuVXBncmFkZXNbR2FtZS5zYW50YURyb3BzW2ldXS5wcmljZUZ1bmMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIE1hdGgucG93KDMsIEdhbWUuc2FudGFMZXZlbCkgKiAyNTI1OwogICAgICB9OwogICAgfQoKICAgIEdhbWUuVXBncmFkZVNhbnRhID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgbW9uaSA9IE1hdGgucG93KEdhbWUuc2FudGFMZXZlbCArIDEsIEdhbWUuc2FudGFMZXZlbCArIDEpOwogICAgICBpZiAoR2FtZS5jb29raWVzID4gbW9uaSAmJiBHYW1lLnNhbnRhTGV2ZWwgPCAxNCkgewogICAgICAgIFBsYXlTb3VuZCgic25kL3NoaW1tZXJDbGljay5tcDMiKTsKCiAgICAgICAgR2FtZS5TcGVuZChtb25pKTsKICAgICAgICBHYW1lLnNhbnRhTGV2ZWwgPSAoR2FtZS5zYW50YUxldmVsICsgMSkgJSAxNTsKICAgICAgICBpZiAoR2FtZS5zYW50YUxldmVsID09IDE0KSB7CiAgICAgICAgICBHYW1lLlVubG9jaygiU2FudGEncyBkb21pbmlvbiIpOwogICAgICAgICAgR2FtZS5Ob3RpZnkoCiAgICAgICAgICAgIGxvYygiWW91IGFyZSBncmFudGVkICUxLiIsIEdhbWUuVXBncmFkZXNbIlNhbnRhJ3MgZG9taW5pb24iXS5kbmFtZSksCiAgICAgICAgICAgICIiLAogICAgICAgICAgICBHYW1lLlVwZ3JhZGVzWyJTYW50YSdzIGRvbWluaW9uIl0uaWNvbgogICAgICAgICAgKTsKICAgICAgICB9CiAgICAgICAgdmFyIGRyb3BzID0gW107CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLnNhbnRhRHJvcHMpIHsKICAgICAgICAgIGlmICghR2FtZS5IYXNVbmxvY2tlZChHYW1lLnNhbnRhRHJvcHNbaV0pKQogICAgICAgICAgICBkcm9wcy5wdXNoKEdhbWUuc2FudGFEcm9wc1tpXSk7CiAgICAgICAgfQogICAgICAgIHZhciBkcm9wID0gY2hvb3NlKGRyb3BzKTsKICAgICAgICBpZiAoZHJvcCkgewogICAgICAgICAgR2FtZS5VbmxvY2soZHJvcCk7CiAgICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgICAgbG9jKCJGb3VuZCBhIHByZXNlbnQhIiksCiAgICAgICAgICAgIGxvYygiWW91IGZpbmQgYSBwcmVzZW50IHdoaWNoIGNvbnRhaW5zLi4uIikgKwogICAgICAgICAgICAgICI8YnI+PGI+IiArCiAgICAgICAgICAgICAgR2FtZS5VcGdyYWRlc1tkcm9wXS5kbmFtZSArCiAgICAgICAgICAgICAgIjwvYj4hIiwKICAgICAgICAgICAgR2FtZS5VcGdyYWRlc1tkcm9wXS5pY29uCiAgICAgICAgICApOwogICAgICAgIH0KCiAgICAgICAgR2FtZS5Ub2dnbGVTcGVjaWFsTWVudSgxKTsKCiAgICAgICAgaWYgKGwoInNwZWNpYWxQaWMiKSkgewogICAgICAgICAgdmFyIHJlY3QgPSBsKCJzcGVjaWFsUGljIikuZ2V0Qm91bmRzKCk7CiAgICAgICAgICBHYW1lLlNwYXJrbGVBdCgKICAgICAgICAgICAgKHJlY3QubGVmdCArIHJlY3QucmlnaHQpIC8gMiwKICAgICAgICAgICAgKHJlY3QudG9wICsgcmVjdC5ib3R0b20pIC8gMgogICAgICAgICAgKSArCiAgICAgICAgICAgIDMyIC0KICAgICAgICAgICAgVG9wQmFyT2Zmc2V0OwogICAgICAgIH0KCiAgICAgICAgaWYgKEdhbWUuc2FudGFMZXZlbCA+PSA2KSBHYW1lLldpbigiQ29taW5nIHRvIHRvd24iKTsKICAgICAgICBpZiAoR2FtZS5zYW50YUxldmVsID49IDE0KSBHYW1lLldpbigiQWxsIGhhaWwgU2FudGEiKTsKICAgICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICAgIEdhbWUudXBncmFkZXNUb1JlYnVpbGQgPSAxOwogICAgICB9CiAgICB9OwoKICAgIEdhbWUuZHJhZ29uTGV2ZWxzID0gWwogICAgICB7CiAgICAgICAgbmFtZTogIkRyYWdvbiBlZ2ciLAogICAgICAgIGFjdGlvbjogbG9jKCJDaGlwIGl0IiksCiAgICAgICAgcGljOiAwLAogICAgICAgIGNvc3Q6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBHYW1lLmNvb2tpZXMgPj0gMTAwMDAwMDsKICAgICAgICB9LAogICAgICAgIGJ1eTogZnVuY3Rpb24gKCkgewogICAgICAgICAgR2FtZS5TcGVuZCgxMDAwMDAwKTsKICAgICAgICB9LAogICAgICAgIGNvc3RTdHI6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxMDAwMDAwKSk7CiAgICAgICAgfSwKICAgICAgfSwKICAgICAgewogICAgICAgIG5hbWU6ICJEcmFnb24gZWdnIiwKICAgICAgICBhY3Rpb246IGxvYygiQ2hpcCBpdCIpLAogICAgICAgIHBpYzogMSwKICAgICAgICBjb3N0OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gR2FtZS5jb29raWVzID49IDEwMDAwMDAgKiAyOwogICAgICAgIH0sCiAgICAgICAgYnV5OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBHYW1lLlNwZW5kKDEwMDAwMDAgKiAyKTsKICAgICAgICB9LAogICAgICAgIGNvc3RTdHI6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxMDAwMDAwICogMikpOwogICAgICAgIH0sCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBuYW1lOiAiRHJhZ29uIGVnZyIsCiAgICAgICAgYWN0aW9uOiBsb2MoIkNoaXAgaXQiKSwKICAgICAgICBwaWM6IDIsCiAgICAgICAgY29zdDogZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIEdhbWUuY29va2llcyA+PSAxMDAwMDAwICogNDsKICAgICAgICB9LAogICAgICAgIGJ1eTogZnVuY3Rpb24gKCkgewogICAgICAgICAgR2FtZS5TcGVuZCgxMDAwMDAwICogNCk7CiAgICAgICAgfSwKICAgICAgICBjb3N0U3RyOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMTAwMDAwMCAqIDQpKTsKICAgICAgICB9LAogICAgICB9LAogICAgICB7CiAgICAgICAgbmFtZTogIlNoaXZlcmluZyBkcmFnb24gZWdnIiwKICAgICAgICBhY3Rpb246IGxvYygiSGF0Y2ggaXQiKSwKICAgICAgICBwaWM6IDMsCiAgICAgICAgY29zdDogZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIEdhbWUuY29va2llcyA+PSAxMDAwMDAwICogODsKICAgICAgICB9LAogICAgICAgIGJ1eTogZnVuY3Rpb24gKCkgewogICAgICAgICAgR2FtZS5TcGVuZCgxMDAwMDAwICogOCk7CiAgICAgICAgfSwKICAgICAgICBjb3N0U3RyOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gbG9jKCIlMSBjb29raWUiLCBMQmVhdXRpZnkoMTAwMDAwMCAqIDgpKTsKICAgICAgICB9LAogICAgICB9LAogICAgICB7CiAgICAgICAgbmFtZTogIktydW1ibG9yLCBjb29raWUgaGF0Y2hsaW5nIiwKICAgICAgICBhY3Rpb246CiAgICAgICAgICAiVHJhaW4gQnJlYXRoIG9mIE1pbGs8YnI+PHNtYWxsPkF1cmEgOiBraXR0ZW5zIGFyZSA1JSBtb3JlIGVmZmVjdGl2ZTwvc21hbGw+IiwKICAgICAgICBwaWM6IDQsCiAgICAgICAgY29zdDogZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIEdhbWUuY29va2llcyA+PSAxMDAwMDAwICogMTY7CiAgICAgICAgfSwKICAgICAgICBidXk6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEdhbWUuU3BlbmQoMTAwMDAwMCAqIDE2KTsKICAgICAgICB9LAogICAgICAgIGNvc3RTdHI6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeSgxMDAwMDAwICogMTYpKTsKICAgICAgICB9LAogICAgICB9LAogICAgICB7CiAgICAgICAgbmFtZTogIktydW1ibG9yLCBjb29raWUgaGF0Y2hsaW5nIiwKICAgICAgICBhY3Rpb246CiAgICAgICAgICAiVHJhaW4gRHJhZ29uIEN1cnNvcjxicj48c21hbGw+QXVyYSA6IGNsaWNraW5nIGlzIDUlIG1vcmUgZWZmZWN0aXZlPC9zbWFsbD4iLAogICAgICAgIHBpYzogNCwKICAgICAgfSwKICAgICAgewogICAgICAgIG5hbWU6ICJLcnVtYmxvciwgY29va2llIGhhdGNobGluZyIsCiAgICAgICAgYWN0aW9uOgogICAgICAgICAgIlRyYWluIEVsZGVyIEJhdHRhbGlvbjxicj48c21hbGw+QXVyYSA6IGdyYW5kbWFzIGdhaW4gKzElIENwUyBmb3IgZXZlcnkgbm9uLWdyYW5kbWEgYnVpbGRpbmc8L3NtYWxsPiIsCiAgICAgICAgcGljOiA0LAogICAgICB9LAogICAgICB7CiAgICAgICAgbmFtZTogIktydW1ibG9yLCBjb29raWUgaGF0Y2hsaW5nIiwKICAgICAgICBhY3Rpb246CiAgICAgICAgICAiVHJhaW4gUmVhcGVyIG9mIEZpZWxkczxicj48c21hbGw+QXVyYSA6IGdvbGRlbiBjb29raWVzIG1heSB0cmlnZ2VyIGEgRHJhZ29uIEhhcnZlc3Q8L3NtYWxsPiIsCiAgICAgICAgcGljOiA0LAogICAgICB9LAogICAgICB7CiAgICAgICAgbmFtZTogIktydW1ibG9yLCBjb29raWUgZHJhZ29uIiwKICAgICAgICBhY3Rpb246CiAgICAgICAgICAiVHJhaW4gRWFydGggU2hhdHRlcmVyPGJyPjxzbWFsbD5BdXJhIDogYnVpbGRpbmdzIHNlbGwgYmFjayBmb3IgNTAlIGluc3RlYWQgb2YgMjUlPC9zbWFsbD4iLAogICAgICAgIHBpYzogNSwKICAgICAgfSwKICAgICAgewogICAgICAgIG5hbWU6ICJLcnVtYmxvciwgY29va2llIGRyYWdvbiIsCiAgICAgICAgYWN0aW9uOgogICAgICAgICAgIlRyYWluIE1hc3RlciBvZiB0aGUgQXJtb3J5PGJyPjxzbWFsbD5BdXJhIDogYWxsIHVwZ3JhZGVzIGFyZSAyJSBjaGVhcGVyPC9zbWFsbD4iLAogICAgICAgIHBpYzogNSwKICAgICAgfSwKICAgICAgewogICAgICAgIG5hbWU6ICJLcnVtYmxvciwgY29va2llIGRyYWdvbiIsCiAgICAgICAgYWN0aW9uOgogICAgICAgICAgIlRyYWluIEZpZXJjZSBIb2FyZGVyPGJyPjxzbWFsbD5BdXJhIDogYWxsIGJ1aWxkaW5ncyBhcmUgMiUgY2hlYXBlcjwvc21hbGw+IiwKICAgICAgICBwaWM6IDUsCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBuYW1lOiAiS3J1bWJsb3IsIGNvb2tpZSBkcmFnb24iLAogICAgICAgIGFjdGlvbjoKICAgICAgICAgICJUcmFpbiBEcmFnb24gR29kPGJyPjxzbWFsbD5BdXJhIDogcHJlc3RpZ2UgQ3BTIGJvbnVzICs1JTwvc21hbGw+IiwKICAgICAgICBwaWM6IDUsCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBuYW1lOiAiS3J1bWJsb3IsIGNvb2tpZSBkcmFnb24iLAogICAgICAgIGFjdGlvbjoKICAgICAgICAgICJUcmFpbiBBcmNhbmUgQXVyYTxicj48c21hbGw+QXVyYSA6IGdvbGRlbiBjb29raWVzIGFwcGVhciA1JSBtb3JlIG9mdGVuPC9zbWFsbD4iLAogICAgICAgIHBpYzogNSwKICAgICAgfSwKICAgICAgewogICAgICAgIG5hbWU6ICJLcnVtYmxvciwgY29va2llIGRyYWdvbiIsCiAgICAgICAgYWN0aW9uOgogICAgICAgICAgIlRyYWluIERyYWdvbmZsaWdodDxicj48c21hbGw+QXVyYSA6IGdvbGRlbiBjb29raWVzIG1heSB0cmlnZ2VyIGEgRHJhZ29uZmxpZ2h0PC9zbWFsbD4iLAogICAgICAgIHBpYzogNSwKICAgICAgfSwKICAgICAgewogICAgICAgIG5hbWU6ICJLcnVtYmxvciwgY29va2llIGRyYWdvbiIsCiAgICAgICAgYWN0aW9uOgogICAgICAgICAgIlRyYWluIEFuY2VzdHJhbCBNZXRhbW9ycGhvc2lzPGJyPjxzbWFsbD5BdXJhIDogZ29sZGVuIGNvb2tpZXMgZ2l2ZSAxMCUgbW9yZSBjb29raWVzPC9zbWFsbD4iLAogICAgICAgIHBpYzogNSwKICAgICAgfSwKICAgICAgewogICAgICAgIG5hbWU6ICJLcnVtYmxvciwgY29va2llIGRyYWdvbiIsCiAgICAgICAgYWN0aW9uOgogICAgICAgICAgIlRyYWluIFVuaG9seSBEb21pbmlvbjxicj48c21hbGw+QXVyYSA6IHdyYXRoIGNvb2tpZXMgZ2l2ZSAxMCUgbW9yZSBjb29raWVzPC9zbWFsbD4iLAogICAgICAgIHBpYzogNSwKICAgICAgfSwKICAgICAgewogICAgICAgIG5hbWU6ICJLcnVtYmxvciwgY29va2llIGRyYWdvbiIsCiAgICAgICAgYWN0aW9uOgogICAgICAgICAgIlRyYWluIEVwb2NoIE1hbmlwdWxhdG9yPGJyPjxzbWFsbD5BdXJhIDogZ29sZGVuIGNvb2tpZSBlZmZlY3RzIGxhc3QgNSUgbG9uZ2VyPC9zbWFsbD4iLAogICAgICAgIHBpYzogNSwKICAgICAgfSwKICAgICAgewogICAgICAgIG5hbWU6ICJLcnVtYmxvciwgY29va2llIGRyYWdvbiIsCiAgICAgICAgYWN0aW9uOgogICAgICAgICAgIlRyYWluIE1pbmQgT3ZlciBNYXR0ZXI8YnI+PHNtYWxsPkF1cmEgOiArMjUlIHJhbmRvbSBkcm9wczwvc21hbGw+IiwKICAgICAgICBwaWM6IDUsCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBuYW1lOiAiS3J1bWJsb3IsIGNvb2tpZSBkcmFnb24iLAogICAgICAgIGFjdGlvbjoKICAgICAgICAgICJUcmFpbiBSYWRpYW50IEFwcGV0aXRlPGJyPjxzbWFsbD5BdXJhIDogYWxsIGNvb2tpZSBwcm9kdWN0aW9uIG11bHRpcGxpZWQgYnkgMjwvc21hbGw+IiwKICAgICAgICBwaWM6IDUsCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBuYW1lOiAiS3J1bWJsb3IsIGNvb2tpZSBkcmFnb24iLAogICAgICAgIGFjdGlvbjoKICAgICAgICAgICJUcmFpbiBEcmFnb24ncyBGb3J0dW5lPGJyPjxzbWFsbD5BdXJhIDogKzEyMyUgQ3BTIHBlciBnb2xkZW4gY29va2llIG9uLXNjcmVlbjwvc21hbGw+IiwKICAgICAgICBwaWM6IDUsCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBuYW1lOiAiS3J1bWJsb3IsIGNvb2tpZSBkcmFnb24iLAogICAgICAgIGFjdGlvbjoKICAgICAgICAgICJUcmFpbiBEcmFnb24ncyBDdXJ2ZTxicj48c21hbGw+QXVyYSA6IHN1Z2FyIGx1bXBzIGdyb3cgNSUgZmFzdGVyLCA1MCUgd2VpcmRlcjwvc21hbGw+IiwKICAgICAgICBwaWM6IDUsCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBuYW1lOiAiS3J1bWJsb3IsIGNvb2tpZSBkcmFnb24iLAogICAgICAgIGFjdGlvbjoKICAgICAgICAgICJUcmFpbiBSZWFsaXR5IEJlbmRpbmc8YnI+PHNtYWxsPkF1cmEgOiAxMCUgb2YgZXZlcnkgb3RoZXIgYXVyYSwgY29tYmluZWQ8L3NtYWxsPiIsCiAgICAgICAgcGljOiA1LAogICAgICB9LAogICAgICB7CiAgICAgICAgbmFtZTogIktydW1ibG9yLCBjb29raWUgZHJhZ29uIiwKICAgICAgICBhY3Rpb246CiAgICAgICAgICAiVHJhaW4gRHJhZ29uIE9yYnM8YnI+PHNtYWxsPkF1cmEgOiBzZWxsaW5nIHlvdXIgYmVzdCBidWlsZGluZyBtYXkgZ3JhbnQgYSB3aXNoPC9zbWFsbD4iLAogICAgICAgIHBpYzogNSwKICAgICAgfSwKICAgICAgewogICAgICAgIG5hbWU6ICJLcnVtYmxvciwgY29va2llIGRyYWdvbiIsCiAgICAgICAgYWN0aW9uOgogICAgICAgICAgIlRyYWluIFN1cHJlbWUgSW50ZWxsZWN0PGJyPjxzbWFsbD5BdXJhIDogY29uZmVycyB2YXJpb3VzIHBvd2VycyB0byB5b3VyIG1pbmlnYW1lczwvc21hbGw+IiwKICAgICAgICBwaWM6IDUsCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBuYW1lOiAiS3J1bWJsb3IsIGNvb2tpZSBkcmFnb24iLAogICAgICAgIGFjdGlvbjoKICAgICAgICAgIGxvYygiQmFrZSBkcmFnb24gY29va2llIikgKwogICAgICAgICAgIjxicj48c21hbGw+IiArCiAgICAgICAgICBsb2MoIkRlbGljaW91cyEiKSArCiAgICAgICAgICAiPC9zbWFsbD4iLAogICAgICAgIHBpYzogNiwKICAgICAgICBjb3N0OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgZmFpbCA9IDA7CiAgICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0cykgewogICAgICAgICAgICBpZiAoR2FtZS5PYmplY3RzW2ldLmFtb3VudCA8IDUwKSBmYWlsID0gMTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBmYWlsID09IDA7CiAgICAgICAgfSwKICAgICAgICBidXk6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKSB7CiAgICAgICAgICAgIEdhbWUuT2JqZWN0c1tpXS5zYWNyaWZpY2UoNTApOwogICAgICAgICAgfQogICAgICAgICAgR2FtZS5VbmxvY2soIkRyYWdvbiBjb29raWUiKTsKICAgICAgICB9LAogICAgICAgIGNvc3RTdHI6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBsb2MoIiUxIG9mIGV2ZXJ5IGJ1aWxkaW5nIiwgNTApOwogICAgICAgIH0sCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBuYW1lOiAiS3J1bWJsb3IsIGNvb2tpZSBkcmFnb24iLAogICAgICAgIGFjdGlvbjoKICAgICAgICAgIGxvYygiVHJhaW4gc2Vjb25kYXJ5IGF1cmEiKSArCiAgICAgICAgICAiPGJyPjxzbWFsbD4iICsKICAgICAgICAgIGxvYygiTGV0cyB5b3UgdXNlIHR3byBkcmFnb24gYXVyYXMgc2ltdWx0YW5lb3VzbHkiKSArCiAgICAgICAgICAiPC9zbWFsbD4iLAogICAgICAgIHBpYzogNywKICAgICAgICBjb3N0OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgZmFpbCA9IDA7CiAgICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0cykgewogICAgICAgICAgICBpZiAoR2FtZS5PYmplY3RzW2ldLmFtb3VudCA8IDIwMCkgZmFpbCA9IDE7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gZmFpbCA9PSAwOwogICAgICAgIH0sCiAgICAgICAgYnV5OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0cykgewogICAgICAgICAgICBHYW1lLk9iamVjdHNbaV0uc2FjcmlmaWNlKDIwMCk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBjb3N0U3RyOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gbG9jKCIlMSBvZiBldmVyeSBidWlsZGluZyIsIDIwMCk7CiAgICAgICAgfSwKICAgICAgfSwKICAgICAgewogICAgICAgIG5hbWU6ICJLcnVtYmxvciwgY29va2llIGRyYWdvbiIsCiAgICAgICAgYWN0aW9uOiBsb2MoIllvdXIgZHJhZ29uIGlzIGZ1bGx5IHRyYWluZWQuIiksCiAgICAgICAgcGljOiA4LAogICAgICB9LAogICAgXTsKCiAgICBHYW1lLmRyYWdvbkF1cmFzID0gewogICAgICAwOiB7CiAgICAgICAgbmFtZTogIk5vIGF1cmEiLAogICAgICAgIHBpYzogWzAsIDddLAogICAgICAgIGRlc2M6IGxvYygiU2VsZWN0IGFuIGF1cmEgZnJvbSB0aG9zZSB5b3VyIGRyYWdvbiBrbm93cy4iKSwKICAgICAgfSwKICAgICAgMTogewogICAgICAgIG5hbWU6ICJCcmVhdGggb2YgTWlsayIsCiAgICAgICAgcGljOiBbMTgsIDI1XSwKICAgICAgICBkZXNjOiBsb2MoIktpdHRlbnMgYXJlIDxiPiUxJTwvYj4gbW9yZSBlZmZlY3RpdmUuIiwgNSksCiAgICAgIH0sCiAgICAgIDI6IHsKICAgICAgICBuYW1lOiAiRHJhZ29uIEN1cnNvciIsCiAgICAgICAgcGljOiBbMCwgMjVdLAogICAgICAgIGRlc2M6IGxvYygiQ2xpY2tpbmcgaXMgPGI+JTElPC9iPiBtb3JlIHBvd2VyZnVsLiIsIDUpLAogICAgICB9LAogICAgICAzOiB7CiAgICAgICAgbmFtZTogIkVsZGVyIEJhdHRhbGlvbiIsCiAgICAgICAgcGljOiBbMSwgMjVdLAogICAgICAgIGRlc2M6IGxvYygKICAgICAgICAgICJHcmFuZG1hcyBnYWluIDxiPislMSUgQ3BTPC9iPiBmb3IgZWFjaCBub24tZ3JhbmRtYSBidWlsZGluZy4iLAogICAgICAgICAgMQogICAgICAgICksCiAgICAgIH0sCiAgICAgIDQ6IHsKICAgICAgICBuYW1lOiAiUmVhcGVyIG9mIEZpZWxkcyIsCiAgICAgICAgcGljOiBbMiwgMjVdLAogICAgICAgIGRlc2M6IGxvYygiR29sZGVuIGNvb2tpZXMgbWF5IHRyaWdnZXIgYSA8Yj5EcmFnb24gSGFydmVzdDwvYj4uIiksCiAgICAgIH0sCiAgICAgIDU6IHsKICAgICAgICBuYW1lOiAiRWFydGggU2hhdHRlcmVyIiwKICAgICAgICBwaWM6IFszLCAyNV0sCiAgICAgICAgZGVzYzogbG9jKAogICAgICAgICAgIkJ1aWxkaW5ncyBzZWxsIGJhY2sgZm9yIDxiPiUxJTwvYj4gaW5zdGVhZCBvZiAlMiUuIiwKICAgICAgICAgIFs1MCwgMjVdCiAgICAgICAgKSwKICAgICAgfSwKICAgICAgNjogewogICAgICAgIG5hbWU6ICJNYXN0ZXIgb2YgdGhlIEFybW9yeSIsCiAgICAgICAgcGljOiBbNCwgMjVdLAogICAgICAgIGRlc2M6IGxvYygiQWxsIHVwZ3JhZGVzIGFyZSA8Yj4lMSUgY2hlYXBlcjwvYj4uIiwgMiksCiAgICAgIH0sCiAgICAgIDc6IHsKICAgICAgICBuYW1lOiAiRmllcmNlIEhvYXJkZXIiLAogICAgICAgIHBpYzogWzE1LCAyNV0sCiAgICAgICAgZGVzYzogbG9jKCJBbGwgYnVpbGRpbmdzIGFyZSA8Yj4lMSUgY2hlYXBlcjwvYj4uIiwgMiksCiAgICAgIH0sCiAgICAgIDg6IHsKICAgICAgICBuYW1lOiAiRHJhZ29uIEdvZCIsCiAgICAgICAgcGljOiBbMTYsIDI1XSwKICAgICAgICBkZXNjOiBsb2MoIjxiPislMSU8L2I+IHByZXN0aWdlIGxldmVsIGVmZmVjdCBvbiBDcFMuIiwgNSksCiAgICAgIH0sCiAgICAgIDk6IHsKICAgICAgICBuYW1lOiAiQXJjYW5lIEF1cmEiLAogICAgICAgIHBpYzogWzE3LCAyNV0sCiAgICAgICAgZGVzYzogbG9jKCJHb2xkZW4gY29va2llcyBhcHBlYXIgPGI+JTElPC9iPiBtb3JlIG9mdGVuLiIsIDUpLAogICAgICB9LAogICAgICAxMDogewogICAgICAgIG5hbWU6ICJEcmFnb25mbGlnaHQiLAogICAgICAgIHBpYzogWzUsIDI1XSwKICAgICAgICBkZXNjOiBsb2MoIkdvbGRlbiBjb29raWVzIG1heSB0cmlnZ2VyIGEgPGI+RHJhZ29uZmxpZ2h0PC9iPi4iKSwKICAgICAgfSwKICAgICAgMTE6IHsKICAgICAgICBuYW1lOiAiQW5jZXN0cmFsIE1ldGFtb3JwaG9zaXMiLAogICAgICAgIHBpYzogWzYsIDI1XSwKICAgICAgICBkZXNjOiBsb2MoIkdvbGRlbiBjb29raWVzIGdpdmUgPGI+JTElPC9iPiBtb3JlIGNvb2tpZXMuIiwgMTApLAogICAgICB9LAogICAgICAxMjogewogICAgICAgIG5hbWU6ICJVbmhvbHkgRG9taW5pb24iLAogICAgICAgIHBpYzogWzcsIDI1XSwKICAgICAgICBkZXNjOiBsb2MoIldyYXRoIGNvb2tpZXMgZ2l2ZSA8Yj4lMSU8L2I+IG1vcmUgY29va2llcy4iLCAxMCksCiAgICAgIH0sCiAgICAgIDEzOiB7CiAgICAgICAgbmFtZTogIkVwb2NoIE1hbmlwdWxhdG9yIiwKICAgICAgICBwaWM6IFs4LCAyNV0sCiAgICAgICAgZGVzYzogbG9jKCJHb2xkZW4gY29va2llcyBzdGF5IDxiPiUxJTwvYj4gbG9uZ2VyLiIsIDUpLAogICAgICB9LAogICAgICAxNDogewogICAgICAgIG5hbWU6ICJNaW5kIE92ZXIgTWF0dGVyIiwKICAgICAgICBwaWM6IFsxMywgMjVdLAogICAgICAgIGRlc2M6IGxvYygiUmFuZG9tIGRyb3BzIGFyZSA8Yj4lMSUgbW9yZSBjb21tb248L2I+LiIsIDI1KSwKICAgICAgfSwKICAgICAgMTU6IHsKICAgICAgICBuYW1lOiAiUmFkaWFudCBBcHBldGl0ZSIsCiAgICAgICAgcGljOiBbMTQsIDI1XSwKICAgICAgICBkZXNjOiBsb2MoIkFsbCBjb29raWUgcHJvZHVjdGlvbiA8Yj5tdWx0aXBsaWVkIGJ5ICUxPC9iPi4iLCAyKSwKICAgICAgfSwKICAgICAgMTY6IHsKICAgICAgICBuYW1lOiAiRHJhZ29uJ3MgRm9ydHVuZSIsCiAgICAgICAgcGljOiBbMTksIDI1XSwKICAgICAgICBkZXNjOiBsb2MoCiAgICAgICAgICAiPGI+KyUxJSBDcFM8L2I+IHBlciBnb2xkZW4gY29va2llIG9uLXNjcmVlbiwgbXVsdGlwbGljYXRpdmUuIiwKICAgICAgICAgIDEyMwogICAgICAgICksCiAgICAgIH0sCiAgICAgIDE3OiB7CiAgICAgICAgbmFtZTogIkRyYWdvbidzIEN1cnZlIiwKICAgICAgICBwaWM6IFsyMCwgMjVdLAogICAgICAgIGRlc2M6CiAgICAgICAgICBsb2MoIjxiPislMSU8L2I+IHN1Z2FyIGx1bXAgZ3Jvd3RoLiIsIDUpICsKICAgICAgICAgICIgIiArCiAgICAgICAgICBsb2MoIlN1Z2FyIGx1bXBzIGFyZSA8Yj50d2ljZSBhcyBsaWtlbHk8L2I+IHRvIGJlIHVudXN1YWwuIiksCiAgICAgIH0sCiAgICAgIDE4OiB7CiAgICAgICAgbmFtZTogIlJlYWxpdHkgQmVuZGluZyIsCiAgICAgICAgcGljOiBbMzIsIDI1XSwKICAgICAgICBkZXNjOiBsb2MoCiAgICAgICAgICAiPGI+T25lIHRlbnRoPC9iPiBvZiBldmVyeSBvdGhlciBkcmFnb24gYXVyYSwgPGI+Y29tYmluZWQ8L2I+LiIKICAgICAgICApLAogICAgICB9LAogICAgICAxOTogewogICAgICAgIG5hbWU6ICJEcmFnb24gT3JicyIsCiAgICAgICAgcGljOiBbMzMsIDI1XSwKICAgICAgICBkZXNjOiBsb2MoCiAgICAgICAgICAiV2l0aCBubyBidWZmcyBhbmQgbm8gZ29sZGVuIGNvb2tpZXMgb24gc2NyZWVuLCBzZWxsaW5nIHlvdXIgbW9zdCBwb3dlcmZ1bCBidWlsZGluZyBoYXMgPGI+JTElIGNoYW5jZSB0byBzdW1tb24gb25lPC9iPi4iLAogICAgICAgICAgMTAKICAgICAgICApLAogICAgICB9LAogICAgICAyMDogewogICAgICAgIG5hbWU6ICJTdXByZW1lIEludGVsbGVjdCIsCiAgICAgICAgcGljOiBbMzQsIDI1XSwKICAgICAgICBkZXNjOiBsb2MoCiAgICAgICAgICAiQ29uZmVycyB2YXJpb3VzIHBvd2VycyB0byB5b3VyIG1pbmlnYW1lcyB3aGlsZSBhY3RpdmUuPGJyPlNlZSB0aGUgYm90dG9tIG9mIGVhY2ggbWluaWdhbWUgZm9yIG1vcmUgZGV0YWlscy4iCiAgICAgICAgKSwKICAgICAgfSwKICAgIH07CgogICAgR2FtZS5kcmFnb25BdXJhc0JOID0ge307CiAgICBmb3IgKHZhciBpIGluIEdhbWUuZHJhZ29uQXVyYXMpIHsKICAgICAgR2FtZS5kcmFnb25BdXJhc0JOW0dhbWUuZHJhZ29uQXVyYXNbaV0ubmFtZV0gPSBHYW1lLmRyYWdvbkF1cmFzW2ldOwogICAgfQogICAgZm9yICh2YXIgaSBpbiBHYW1lLmRyYWdvbkF1cmFzKSB7CiAgICAgIEdhbWUuZHJhZ29uQXVyYXNbaV0uaWQgPSBwYXJzZUludChpKTsKICAgICAgR2FtZS5kcmFnb25BdXJhc1tpXS5kbmFtZSA9IGxvYyhHYW1lLmRyYWdvbkF1cmFzW2ldLm5hbWUpOwogICAgfQoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgR2FtZS5kcmFnb25MZXZlbHMubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIGl0ID0gR2FtZS5kcmFnb25MZXZlbHNbaV07CiAgICAgIGl0Lm5hbWUgPSBsb2MoaXQubmFtZSk7CiAgICAgIGlmIChpID49IDQgJiYgaSA8IEdhbWUuZHJhZ29uTGV2ZWxzLmxlbmd0aCAtIDMpIHsKICAgICAgICBpZiAoIUVOKQogICAgICAgICAgaXQuYWN0aW9uID0KICAgICAgICAgICAgbG9jKCJUcmFpbiAlMSIsIEdhbWUuZHJhZ29uQXVyYXNbaSAtIDNdLmRuYW1lKSArCiAgICAgICAgICAgICI8YnI+PHNtYWxsPiIgKwogICAgICAgICAgICBsb2MoIkF1cmE6ICUxIiwgR2FtZS5kcmFnb25BdXJhc1tpIC0gM10uZGVzYykgKwogICAgICAgICAgICAiPC9zbWFsbD4iOwogICAgICAgIGlmIChpID49IDUpIHsKICAgICAgICAgIGl0LmNvc3RTdHIgPSAoZnVuY3Rpb24gKGJ1aWxkaW5nKSB7CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGxvYygiJTEgIiArIGJ1aWxkaW5nLmJzaW5nbGUsIExCZWF1dGlmeSgxMDApKTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0pKEdhbWUuT2JqZWN0c0J5SWRbaSAtIDVdKTsKICAgICAgICAgIGl0LmNvc3QgPSAoZnVuY3Rpb24gKGJ1aWxkaW5nKSB7CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGJ1aWxkaW5nLmFtb3VudCA+PSAxMDA7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9KShHYW1lLk9iamVjdHNCeUlkW2kgLSA1XSk7CiAgICAgICAgICBpdC5idXkgPSAoZnVuY3Rpb24gKGJ1aWxkaW5nKSB7CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgYnVpbGRpbmcuc2FjcmlmaWNlKDEwMCk7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9KShHYW1lLk9iamVjdHNCeUlkW2kgLSA1XSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgR2FtZS5oYXNBdXJhID0gZnVuY3Rpb24gKHdoYXQpIHsKICAgICAgaWYgKAogICAgICAgIEdhbWUuZHJhZ29uQXVyYXNbR2FtZS5kcmFnb25BdXJhXS5uYW1lID09IHdoYXQgfHwKICAgICAgICBHYW1lLmRyYWdvbkF1cmFzW0dhbWUuZHJhZ29uQXVyYTJdLm5hbWUgPT0gd2hhdAogICAgICApCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIGVsc2UgcmV0dXJuIGZhbHNlOwogICAgfTsKICAgIEdhbWUuYXVyYU11bHQgPSBmdW5jdGlvbiAod2hhdCkgewogICAgICB2YXIgbiA9IDA7CiAgICAgIGlmICgKICAgICAgICBHYW1lLmRyYWdvbkF1cmFzW0dhbWUuZHJhZ29uQXVyYV0ubmFtZSA9PSB3aGF0IHx8CiAgICAgICAgR2FtZS5kcmFnb25BdXJhc1tHYW1lLmRyYWdvbkF1cmEyXS5uYW1lID09IHdoYXQKICAgICAgKQogICAgICAgIG4gPSAxOwogICAgICBpZiAoCiAgICAgICAgKEdhbWUuZHJhZ29uQXVyYXNbR2FtZS5kcmFnb25BdXJhXS5uYW1lID09ICJSZWFsaXR5IEJlbmRpbmciIHx8CiAgICAgICAgICBHYW1lLmRyYWdvbkF1cmFzW0dhbWUuZHJhZ29uQXVyYTJdLm5hbWUgPT0gIlJlYWxpdHkgQmVuZGluZyIpICYmCiAgICAgICAgR2FtZS5kcmFnb25MZXZlbCA+PSBHYW1lLmRyYWdvbkF1cmFzQk5bd2hhdF0uaWQgKyA0CiAgICAgICkKICAgICAgICBuICs9IDAuMTsKICAgICAgcmV0dXJuIG47CiAgICB9OwoKICAgIEdhbWUuU2VsZWN0RHJhZ29uQXVyYSA9IGZ1bmN0aW9uIChzbG90LCB1cGRhdGUpIHsKICAgICAgdmFyIGN1cnJlbnRBdXJhID0gMDsKICAgICAgdmFyIG90aGVyQXVyYSA9IDA7CiAgICAgIGlmIChzbG90ID09IDApIGN1cnJlbnRBdXJhID0gR2FtZS5kcmFnb25BdXJhOwogICAgICBlbHNlIGN1cnJlbnRBdXJhID0gR2FtZS5kcmFnb25BdXJhMjsKICAgICAgaWYgKHNsb3QgPT0gMCkgb3RoZXJBdXJhID0gR2FtZS5kcmFnb25BdXJhMjsKICAgICAgZWxzZSBvdGhlckF1cmEgPSBHYW1lLmRyYWdvbkF1cmE7CiAgICAgIGlmICghdXBkYXRlKSBHYW1lLlNlbGVjdGluZ0RyYWdvbkF1cmEgPSBjdXJyZW50QXVyYTsKCiAgICAgIHZhciBzdHIgPSAiIjsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLmRyYWdvbkF1cmFzKSB7CiAgICAgICAgaWYgKEdhbWUuZHJhZ29uTGV2ZWwgPj0gcGFyc2VJbnQoaSkgKyA0KSB7CiAgICAgICAgICB2YXIgaWNvbiA9IEdhbWUuZHJhZ29uQXVyYXNbaV0ucGljOwogICAgICAgICAgaWYgKGkgPT0gMCB8fCBpICE9IG90aGVyQXVyYSkKICAgICAgICAgICAgc3RyICs9CiAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImNyYXRlIGVuYWJsZWQnICsKICAgICAgICAgICAgICAoaSA9PSBHYW1lLlNlbGVjdGluZ0RyYWdvbkF1cmEgPyAiIGhpZ2hsaWdodGVkIiA6ICIiKSArCiAgICAgICAgICAgICAgJyIgc3R5bGU9Im9wYWNpdHk6MTtmbG9hdDpub25lO2Rpc3BsYXk6aW5saW5lLWJsb2NrOycgKwogICAgICAgICAgICAgIHdyaXRlSWNvbihpY29uKSArCiAgICAgICAgICAgICAgJyIgJyArCiAgICAgICAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgICAgICAgIj1cIlBsYXlTb3VuZCgnc25kL3RpY2subXAzJyk7R2FtZS5TZXREcmFnb25BdXJhKCIgKwogICAgICAgICAgICAgIGkgKwogICAgICAgICAgICAgICIsIiArCiAgICAgICAgICAgICAgc2xvdCArCiAgICAgICAgICAgICAgJyk7IiBvbk1vdXNlT3V0PSJHYW1lLkRlc2NyaWJlRHJhZ29uQXVyYSgnICsKICAgICAgICAgICAgICBHYW1lLlNlbGVjdGluZ0RyYWdvbkF1cmEgKwogICAgICAgICAgICAgICcpOyIgb25Nb3VzZU92ZXI9IkdhbWUuRGVzY3JpYmVEcmFnb25BdXJhKCcgKwogICAgICAgICAgICAgIGkgKwogICAgICAgICAgICAgICcpOyInICsKICAgICAgICAgICAgICAiPjwvZGl2PiI7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgaGlnaGVzdEJ1aWxkaW5nID0gMDsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICBpZiAoR2FtZS5PYmplY3RzW2ldLmFtb3VudCA+IDApIGhpZ2hlc3RCdWlsZGluZyA9IEdhbWUuT2JqZWN0c1tpXTsKICAgICAgfQoKICAgICAgR2FtZS5Qcm9tcHQoCiAgICAgICAgIjxpZCBQaWNrRHJhZ29uQXVyYT48aDM+IiArCiAgICAgICAgICBsb2MoCiAgICAgICAgICAgIHNsb3QgPT0gMQogICAgICAgICAgICAgID8gIlNldCB5b3VyIGRyYWdvbidzIHNlY29uZGFyeSBhdXJhIgogICAgICAgICAgICAgIDogIlNldCB5b3VyIGRyYWdvbidzIGF1cmEiCiAgICAgICAgICApICsKICAgICAgICAgICI8L2gzPiIgKwogICAgICAgICAgJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicgKwogICAgICAgICAgJzxkaXYgaWQ9ImRyYWdvbkF1cmFJbmZvIiBzdHlsZT0ibWluLWhlaWdodDo2MHB4OyI+PC9kaXY+JyArCiAgICAgICAgICAnPGRpdiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7Ij4nICsKICAgICAgICAgIHN0ciArCiAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgICAnPGRpdiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7bWFyZ2luLWJvdHRvbTo4cHg7Ij4nICsKICAgICAgICAgIChoaWdoZXN0QnVpbGRpbmcgPT0gMAogICAgICAgICAgICA/IGxvYygKICAgICAgICAgICAgICAgICJTd2l0Y2hpbmcgeW91ciBhdXJhIGlzIDxiPmZyZWU8L2I+IGJlY2F1c2UgeW91IG93biBubyBidWlsZGluZ3MuIgogICAgICAgICAgICAgICkKICAgICAgICAgICAgOiBsb2MoCiAgICAgICAgICAgICAgICAiVGhlIGNvc3Qgb2Ygc3dpdGNoaW5nIHlvdXIgYXVyYSBpcyA8Yj4lMTwvYj4uPGJyPlRoaXMgd2lsbCBhZmZlY3QgeW91ciBDcFMhIiwKICAgICAgICAgICAgICAgIGxvYygiJTEgIiArIGhpZ2hlc3RCdWlsZGluZy5ic2luZ2xlLCBMQmVhdXRpZnkoMSkpCiAgICAgICAgICAgICAgKSkgKwogICAgICAgICAgIjwvZGl2PiIsCiAgICAgICAgWwogICAgICAgICAgWwogICAgICAgICAgICBsb2MoIkNvbmZpcm0iKSwKICAgICAgICAgICAgKHNsb3QgPT0gMCA/ICJHYW1lLmRyYWdvbkF1cmEiIDogIkdhbWUuZHJhZ29uQXVyYTIiKSArCiAgICAgICAgICAgICAgIj1HYW1lLlNlbGVjdGluZ0RyYWdvbkF1cmE7IiArCiAgICAgICAgICAgICAgKGhpZ2hlc3RCdWlsZGluZyA9PSAwIHx8IGN1cnJlbnRBdXJhID09IEdhbWUuU2VsZWN0aW5nRHJhZ29uQXVyYQogICAgICAgICAgICAgICAgPyAiIgogICAgICAgICAgICAgICAgOiAiR2FtZS5PYmplY3RzQnlJZFsiICsKICAgICAgICAgICAgICAgICAgaGlnaGVzdEJ1aWxkaW5nLmlkICsKICAgICAgICAgICAgICAgICAgIl0uc2FjcmlmaWNlKDEpOyIpICsKICAgICAgICAgICAgICAiR2FtZS5Ub2dnbGVTcGVjaWFsTWVudSgxKTtHYW1lLkNsb3NlUHJvbXB0KCk7IiwKICAgICAgICAgIF0sCiAgICAgICAgICBsb2MoIkNhbmNlbCIpLAogICAgICAgIF0sCiAgICAgICAgMCwKICAgICAgICAid2lkZVByb21wdCIKICAgICAgKTsKICAgICAgR2FtZS5EZXNjcmliZURyYWdvbkF1cmEoR2FtZS5TZWxlY3RpbmdEcmFnb25BdXJhKTsKICAgIH07CiAgICBHYW1lLlNlbGVjdGluZ0RyYWdvbkF1cmEgPSAtMTsKICAgIEdhbWUuU2V0RHJhZ29uQXVyYSA9IGZ1bmN0aW9uIChhdXJhLCBzbG90KSB7CiAgICAgIEdhbWUuU2VsZWN0aW5nRHJhZ29uQXVyYSA9IGF1cmE7CiAgICAgIEdhbWUuU2VsZWN0RHJhZ29uQXVyYShzbG90LCAxKTsKICAgIH07CiAgICBHYW1lLkRlc2NyaWJlRHJhZ29uQXVyYSA9IGZ1bmN0aW9uIChhdXJhKSB7CiAgICAgIGwoImRyYWdvbkF1cmFJbmZvIikuaW5uZXJIVE1MID0KICAgICAgICAnPGRpdiBzdHlsZT0ibWluLXdpZHRoOjIwMHB4O3RleHQtYWxpZ246Y2VudGVyOyI+PGg0PicgKwogICAgICAgIEdhbWUuZHJhZ29uQXVyYXNbYXVyYV0uZG5hbWUgKwogICAgICAgICI8L2g0PiIgKwogICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICBHYW1lLmRyYWdvbkF1cmFzW2F1cmFdLmRlc2MgKwogICAgICAgICI8L2Rpdj4iOwogICAgfTsKCiAgICBHYW1lLlVwZ3JhZGVEcmFnb24gPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICgKICAgICAgICBHYW1lLmRyYWdvbkxldmVsIDwgR2FtZS5kcmFnb25MZXZlbHMubGVuZ3RoIC0gMSAmJgogICAgICAgIEdhbWUuZHJhZ29uTGV2ZWxzW0dhbWUuZHJhZ29uTGV2ZWxdLmNvc3QoKQogICAgICApIHsKICAgICAgICBQbGF5U291bmQoInNuZC9zaGltbWVyQ2xpY2subXAzIik7CiAgICAgICAgR2FtZS5kcmFnb25MZXZlbHNbR2FtZS5kcmFnb25MZXZlbF0uYnV5KCk7CiAgICAgICAgR2FtZS5kcmFnb25MZXZlbCA9IChHYW1lLmRyYWdvbkxldmVsICsgMSkgJSBHYW1lLmRyYWdvbkxldmVscy5sZW5ndGg7CgogICAgICAgIGlmIChHYW1lLmRyYWdvbkxldmVsID49IEdhbWUuZHJhZ29uTGV2ZWxzLmxlbmd0aCAtIDEpCiAgICAgICAgICBHYW1lLldpbigiSGVyZSBiZSBkcmFnb24iKTsKICAgICAgICBHYW1lLlRvZ2dsZVNwZWNpYWxNZW51KDEpOwogICAgICAgIGlmIChsKCJzcGVjaWFsUGljIikpIHsKICAgICAgICAgIHZhciByZWN0ID0gbCgic3BlY2lhbFBpYyIpLmdldEJvdW5kcygpOwogICAgICAgICAgR2FtZS5TcGFya2xlQXQoCiAgICAgICAgICAgIChyZWN0LmxlZnQgKyByZWN0LnJpZ2h0KSAvIDIsCiAgICAgICAgICAgIChyZWN0LnRvcCArIHJlY3QuYm90dG9tKSAvIDIKICAgICAgICAgICkgKwogICAgICAgICAgICAzMiAtCiAgICAgICAgICAgIFRvcEJhck9mZnNldDsKICAgICAgICB9CiAgICAgICAgR2FtZS5yZWNhbGN1bGF0ZUdhaW5zID0gMTsKICAgICAgICBHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkID0gMTsKICAgICAgfQogICAgfTsKCiAgICBHYW1lLmxhc3RDbGlja2VkU3BlY2lhbFBpYyA9IDA7CiAgICBHYW1lLkNsaWNrU3BlY2lhbFBpYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKAogICAgICAgIEdhbWUuc3BlY2lhbFRhYiA9PSAiZHJhZ29uIiAmJgogICAgICAgIEdhbWUuZHJhZ29uTGV2ZWwgPj0gNCAmJgogICAgICAgIEdhbWUuSGFzKCJQZXQgdGhlIGRyYWdvbiIpICYmCiAgICAgICAgbCgic3BlY2lhbFBpYyIpCiAgICAgICkgewogICAgICAgIHRyaWdnZXJBbmltKGwoInNwZWNpYWxQaWMiKSwgInB1Y2tlciIpOwogICAgICAgIFBsYXlTb3VuZCgKICAgICAgICAgICJzbmQvY2xpY2siICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyArIDEpICsgIi5tcDMiLAogICAgICAgICAgMC41CiAgICAgICAgKTsKICAgICAgICBpZiAoRGF0ZS5ub3coKSAtIEdhbWUubGFzdENsaWNrZWRTcGVjaWFsUGljID4gMjAwMCkKICAgICAgICAgIFBsYXlTb3VuZCgic25kL2dyb3dsLm1wMyIpOwogICAgICAgIC8vZWxzZSBpZiAoTWF0aC5yYW5kb20oKTwwLjUpIFBsYXlTb3VuZCgnc25kL2dyb3dsLm1wMycsMC41K01hdGgucmFuZG9tKCkqMC4yKTsKICAgICAgICBHYW1lLmxhc3RDbGlja2VkU3BlY2lhbFBpYyA9IERhdGUubm93KCk7CiAgICAgICAgaWYgKEdhbWUucHJlZnMucGFydGljbGVzKSB7CiAgICAgICAgICBHYW1lLnBhcnRpY2xlQWRkKAogICAgICAgICAgICBHYW1lLm1vdXNlWCwKICAgICAgICAgICAgR2FtZS5tb3VzZVkgLSAzMiwKICAgICAgICAgICAgTWF0aC5yYW5kb20oKSAqIDQgLSAyLAogICAgICAgICAgICBNYXRoLnJhbmRvbSgpICogLTIgLSA0LAogICAgICAgICAgICBNYXRoLnJhbmRvbSgpICogMC4yICsgMC41LAogICAgICAgICAgICAxLAogICAgICAgICAgICAyLAogICAgICAgICAgICBbMjAsIDNdCiAgICAgICAgICApOwogICAgICAgIH0KICAgICAgICBpZiAoR2FtZS5kcmFnb25MZXZlbCA+PSA4ICYmIE1hdGgucmFuZG9tKCkgPCAxIC8gMjApIHsKICAgICAgICAgIE1hdGguc2VlZHJhbmRvbShHYW1lLnNlZWQgKyAiL2RyYWdvblRpbWUiKTsKICAgICAgICAgIHZhciBkcm9wcyA9IFsKICAgICAgICAgICAgIkRyYWdvbiBzY2FsZSIsCiAgICAgICAgICAgICJEcmFnb24gY2xhdyIsCiAgICAgICAgICAgICJEcmFnb24gZmFuZyIsCiAgICAgICAgICAgICJEcmFnb24gdGVkZHkgYmVhciIsCiAgICAgICAgICBdOwogICAgICAgICAgZHJvcHMgPSBzaHVmZmxlKGRyb3BzKTsKICAgICAgICAgIHZhciBkcm9wID0KICAgICAgICAgICAgZHJvcHNbTWF0aC5mbG9vcigobmV3IERhdGUoKS5nZXRNaW51dGVzKCkgLyA2MCkgKiBkcm9wcy5sZW5ndGgpXTsKICAgICAgICAgIGlmICghR2FtZS5IYXMoZHJvcCkgJiYgIUdhbWUuSGFzVW5sb2NrZWQoZHJvcCkpIHsKICAgICAgICAgICAgR2FtZS5VbmxvY2soZHJvcCk7CiAgICAgICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgICAgIGRyb3AsCiAgICAgICAgICAgICAgIjxiPiIgKyBsb2MoIllvdXIgZHJhZ29uIGRyb3BwZWQgc29tZXRoaW5nISIpICsgIjwvYj4iLAogICAgICAgICAgICAgIEdhbWUuVXBncmFkZXNbZHJvcF0uaWNvbgogICAgICAgICAgICApOwogICAgICAgICAgfQogICAgICAgICAgTWF0aC5zZWVkcmFuZG9tKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIEdhbWUuVG9nZ2xlU3BlY2lhbE1lbnUgPSBmdW5jdGlvbiAob24pIHsKICAgICAgaWYgKG9uKSB7CiAgICAgICAgdmFyIHBpYyA9ICIiOwogICAgICAgIHZhciBmcmFtZSA9IDA7CiAgICAgICAgaWYgKEdhbWUuc3BlY2lhbFRhYiA9PSAic2FudGEiKSB7CiAgICAgICAgICBwaWMgPSAic2FudGEucG5nIjsKICAgICAgICAgIGZyYW1lID0gR2FtZS5zYW50YUxldmVsOwogICAgICAgIH0gZWxzZSBpZiAoR2FtZS5zcGVjaWFsVGFiID09ICJkcmFnb24iKSB7CiAgICAgICAgICBwaWMgPSAiZHJhZ29uLnBuZz92PSIgKyBHYW1lLnZlcnNpb247CiAgICAgICAgICBmcmFtZSA9IEdhbWUuZHJhZ29uTGV2ZWxzW0dhbWUuZHJhZ29uTGV2ZWxdLnBpYzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcGljID0gImRyYWdvbi5wbmc/dj0iICsgR2FtZS52ZXJzaW9uOwogICAgICAgICAgZnJhbWUgPSA0OwogICAgICAgIH0KCiAgICAgICAgdmFyIHN0ciA9CiAgICAgICAgICAnPGRpdiBpZD0ic3BlY2lhbFBpYyIgJyArCiAgICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAgICc9IkdhbWUuQ2xpY2tTcGVjaWFsUGljKCk7IiBzdHlsZT0iJyArCiAgICAgICAgICAoR2FtZS5zcGVjaWFsVGFiID09ICJkcmFnb24iICYmCiAgICAgICAgICBHYW1lLmRyYWdvbkxldmVsID49IDQgJiYKICAgICAgICAgIEdhbWUuSGFzKCJQZXQgdGhlIGRyYWdvbiIpCiAgICAgICAgICAgID8gImN1cnNvcjpwb2ludGVyOyIKICAgICAgICAgICAgOiAiIikgKwogICAgICAgICAgInBvc2l0aW9uOmFic29sdXRlO2xlZnQ6LTE2cHg7dG9wOi02NHB4O3dpZHRoOjk2cHg7aGVpZ2h0Ojk2cHg7YmFja2dyb3VuZDp1cmwoaW1nLyIgKwogICAgICAgICAgcGljICsKICAgICAgICAgICIpO2JhY2tncm91bmQtcG9zaXRpb246IiArCiAgICAgICAgICAtZnJhbWUgKiA5NiArCiAgICAgICAgICAncHggMHB4O2ZpbHRlcjpkcm9wLXNoYWRvdygwcHggM3B4IDJweCAjMDAwKTstd2Via2l0LWZpbHRlcjpkcm9wLXNoYWRvdygwcHggM3B4IDJweCAjMDAwKTsiPjwvZGl2Pic7CiAgICAgICAgc3RyICs9CiAgICAgICAgICAnPGRpdiBjbGFzcz0iY2xvc2UiIG9uY2xpY2s9IlBsYXlTb3VuZChcJ3NuZC9wcmVzcy5tcDNcJyk7R2FtZS5Ub2dnbGVTcGVjaWFsTWVudSgwKTsiPng8L2Rpdj4nOwoKICAgICAgICBpZiAoR2FtZS5zcGVjaWFsVGFiID09ICJzYW50YSIpIHsKICAgICAgICAgIHZhciBtb25pID0gTWF0aC5wb3coR2FtZS5zYW50YUxldmVsICsgMSwgR2FtZS5zYW50YUxldmVsICsgMSk7CgogICAgICAgICAgc3RyICs9CiAgICAgICAgICAgICc8aDMgc3R5bGU9InBvaW50ZXItZXZlbnRzOm5vbmU7Ij4nICsKICAgICAgICAgICAgR2FtZS5zYW50YUxldmVsc1tHYW1lLnNhbnRhTGV2ZWxdICsKICAgICAgICAgICAgIjwvaDM+IjsKICAgICAgICAgIGlmIChHYW1lLnNhbnRhTGV2ZWwgPCAxNCkgewogICAgICAgICAgICBzdHIgKz0KICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9Im9wdGlvbkJveCIgc3R5bGU9Im1hcmdpbi1ib3R0b206MHB4OyI+PGEgY2xhc3M9Im9wdGlvbiBmcmFtZWQgbGFyZ2UgdGl0bGUiICcgKwogICAgICAgICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICAgICAgICc9IkdhbWUuVXBncmFkZVNhbnRhKCk7Ij4nICsKICAgICAgICAgICAgICAnPGRpdiBzdHlsZT0iZGlzcGxheTp0YWJsZS1jZWxsO3ZlcnRpY2FsLWFsaWduOm1pZGRsZTsiPicgKwogICAgICAgICAgICAgIGxvYygiRXZvbHZlIikgKwogICAgICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICAgICAnPGRpdiBzdHlsZT0iZGlzcGxheTp0YWJsZS1jZWxsO3ZlcnRpY2FsLWFsaWduOm1pZGRsZTtwYWRkaW5nOjRweCAxMnB4OyI+fDwvZGl2PicgKwogICAgICAgICAgICAgICc8ZGl2IHN0eWxlPSJkaXNwbGF5OnRhYmxlLWNlbGw7dmVydGljYWwtYWxpZ246bWlkZGxlO2ZvbnQtc2l6ZTo2NSU7Ij4nICsKICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAic2FjcmlmaWNlICUxIiwKICAgICAgICAgICAgICAgICI8ZGl2IiArCiAgICAgICAgICAgICAgICAgIChHYW1lLmNvb2tpZXMgPiBtb25pID8gIiIgOiAnIHN0eWxlPSJjb2xvcjojNzc3OyInKSArCiAgICAgICAgICAgICAgICAgICI+IiArCiAgICAgICAgICAgICAgICAgIGxvYygKICAgICAgICAgICAgICAgICAgICAiJTEgY29va2llIiwKICAgICAgICAgICAgICAgICAgICBMQmVhdXRpZnkoCiAgICAgICAgICAgICAgICAgICAgICBNYXRoLnBvdyhHYW1lLnNhbnRhTGV2ZWwgKyAxLCBHYW1lLnNhbnRhTGV2ZWwgKyAxKQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgKSArCiAgICAgICAgICAgICAgICAgICI8L2Rpdj4iCiAgICAgICAgICAgICAgKSArCiAgICAgICAgICAgICAgIjwvZGl2PiIgKwogICAgICAgICAgICAgICI8L2E+PC9kaXY+IjsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKEdhbWUuc3BlY2lhbFRhYiA9PSAiZHJhZ29uIikgewogICAgICAgICAgdmFyIGxldmVsID0gR2FtZS5kcmFnb25MZXZlbHNbR2FtZS5kcmFnb25MZXZlbF07CgogICAgICAgICAgc3RyICs9ICc8aDMgc3R5bGU9InBvaW50ZXItZXZlbnRzOm5vbmU7Ij4nICsgbGV2ZWwubmFtZSArICI8L2gzPiI7CgogICAgICAgICAgaWYgKEdhbWUuZHJhZ29uTGV2ZWwgPj0gNSkgewogICAgICAgICAgICB2YXIgaWNvbiA9IEdhbWUuZHJhZ29uQXVyYXNbR2FtZS5kcmFnb25BdXJhXS5waWM7CiAgICAgICAgICAgIHN0ciArPQogICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJjcmF0ZSBlbmFibGVkIiBzdHlsZT0ib3BhY2l0eToxO3Bvc2l0aW9uOmFic29sdXRlO3JpZ2h0OjE4cHg7dG9wOi01OHB4OycgKwogICAgICAgICAgICAgIHdyaXRlSWNvbihpY29uKSArCiAgICAgICAgICAgICAgJyIgJyArCiAgICAgICAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgICAgICAgIj1cIlBsYXlTb3VuZCgnc25kL3RpY2subXAzJyk7R2FtZS5TZWxlY3REcmFnb25BdXJhKDApO1wiICIgKwogICAgICAgICAgICAgIEdhbWUuZ2V0VG9vbHRpcCgKICAgICAgICAgICAgICAgICc8ZGl2IHN0eWxlPSJtaW4td2lkdGg6MjAwcHg7dGV4dC1hbGlnbjpjZW50ZXI7IiBpZD0idG9vbHRpcERyYWdvbkF1cmFTZWxlY3QiPjxoND4nICsKICAgICAgICAgICAgICAgICAgR2FtZS5kcmFnb25BdXJhc1tHYW1lLmRyYWdvbkF1cmFdLmRuYW1lICsKICAgICAgICAgICAgICAgICAgIjwvaDQ+IiArCiAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJsaW5lIj48L2Rpdj4nICsKICAgICAgICAgICAgICAgICAgR2FtZS5kcmFnb25BdXJhc1tHYW1lLmRyYWdvbkF1cmFdLmRlc2MgKwogICAgICAgICAgICAgICAgICAiPC9kaXY+IiwKICAgICAgICAgICAgICAgICJ0b3AiCiAgICAgICAgICAgICAgKSArCiAgICAgICAgICAgICAgIj48L2Rpdj4iOwogICAgICAgICAgfQogICAgICAgICAgaWYgKEdhbWUuZHJhZ29uTGV2ZWwgPj0gMjYpIHsKICAgICAgICAgICAgLy8ybmQgYXVyYSBzbG90OyBpbmNyZWFzZWQgd2l0aCBsYXN0IGJ1aWxkaW5nIChjb3J0ZXggYmFrZXIpCiAgICAgICAgICAgIHZhciBpY29uID0gR2FtZS5kcmFnb25BdXJhc1tHYW1lLmRyYWdvbkF1cmEyXS5waWM7CiAgICAgICAgICAgIHN0ciArPQogICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJjcmF0ZSBlbmFibGVkIiBzdHlsZT0ib3BhY2l0eToxO3Bvc2l0aW9uOmFic29sdXRlO3JpZ2h0OjgwcHg7dG9wOi01OHB4OycgKwogICAgICAgICAgICAgIHdyaXRlSWNvbihpY29uKSArCiAgICAgICAgICAgICAgJyIgJyArCiAgICAgICAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgICAgICAgIj1cIlBsYXlTb3VuZCgnc25kL3RpY2subXAzJyk7R2FtZS5TZWxlY3REcmFnb25BdXJhKDEpO1wiICIgKwogICAgICAgICAgICAgIEdhbWUuZ2V0VG9vbHRpcCgKICAgICAgICAgICAgICAgICc8ZGl2IHN0eWxlPSJtaW4td2lkdGg6MjAwcHg7dGV4dC1hbGlnbjpjZW50ZXI7IiBpZD0idG9vbHRpcERyYWdvbkF1cmFTZWxlY3QyIj48aDQ+JyArCiAgICAgICAgICAgICAgICAgIEdhbWUuZHJhZ29uQXVyYXNbR2FtZS5kcmFnb25BdXJhMl0uZG5hbWUgKwogICAgICAgICAgICAgICAgICAiPC9oND4iICsKICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicgKwogICAgICAgICAgICAgICAgICBHYW1lLmRyYWdvbkF1cmFzW0dhbWUuZHJhZ29uQXVyYTJdLmRlc2MgKwogICAgICAgICAgICAgICAgICAiPC9kaXY+IiwKICAgICAgICAgICAgICAgICJ0b3AiCiAgICAgICAgICAgICAgKSArCiAgICAgICAgICAgICAgIj48L2Rpdj4iOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChHYW1lLmRyYWdvbkxldmVsIDwgR2FtZS5kcmFnb25MZXZlbHMubGVuZ3RoIC0gMSkgewogICAgICAgICAgICBzdHIgKz0KICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JyArCiAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9Im9wdGlvbkJveCIgc3R5bGU9Im1hcmdpbi1ib3R0b206MHB4OyI+PGEgY2xhc3M9Im9wdGlvbiBmcmFtZWQgbGFyZ2UgdGl0bGUiICcgKwogICAgICAgICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICAgICAgICc9IkdhbWUuVXBncmFkZURyYWdvbigpOyI+JyArCiAgICAgICAgICAgICAgJzxkaXYgc3R5bGU9ImRpc3BsYXk6dGFibGUtY2VsbDt2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7Ij4nICsKICAgICAgICAgICAgICBsZXZlbC5hY3Rpb24gKwogICAgICAgICAgICAgICI8L2Rpdj4iICsKICAgICAgICAgICAgICAnPGRpdiBzdHlsZT0iZGlzcGxheTp0YWJsZS1jZWxsO3ZlcnRpY2FsLWFsaWduOm1pZGRsZTtwYWRkaW5nOjRweCAxMnB4OyI+fDwvZGl2PicgKwogICAgICAgICAgICAgICc8ZGl2IHN0eWxlPSJkaXNwbGF5OnRhYmxlLWNlbGw7dmVydGljYWwtYWxpZ246bWlkZGxlO2ZvbnQtc2l6ZTo2NSU7Ij4nICsKICAgICAgICAgICAgICBsb2MoCiAgICAgICAgICAgICAgICAic2FjcmlmaWNlICUxIiwKICAgICAgICAgICAgICAgICI8ZGl2IiArCiAgICAgICAgICAgICAgICAgIChsZXZlbC5jb3N0KCkgPyAiIiA6ICcgc3R5bGU9ImNvbG9yOiM3Nzc7IicpICsKICAgICAgICAgICAgICAgICAgIj4iICsKICAgICAgICAgICAgICAgICAgbGV2ZWwuY29zdFN0cigpICsKICAgICAgICAgICAgICAgICAgIjwvZGl2PiIKICAgICAgICAgICAgICApICsKICAgICAgICAgICAgICAiPC9kaXY+IiArCiAgICAgICAgICAgICAgIjwvYT48L2Rpdj4iOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3RyICs9CiAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2PicgKwogICAgICAgICAgICAgICc8ZGl2IHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjttYXJnaW4tYm90dG9tOjRweDsiPicgKwogICAgICAgICAgICAgIGxldmVsLmFjdGlvbiArCiAgICAgICAgICAgICAgIjwvZGl2PiI7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBsKCJzcGVjaWFsUG9wdXAiKS5pbm5lckhUTUwgPSBzdHI7CgogICAgICAgIGwoInNwZWNpYWxQb3B1cCIpLmNsYXNzTmFtZSA9ICJmcmFtZWQgcHJvbXB0IG9uU2NyZWVuIjsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoR2FtZS5zcGVjaWFsVGFiICE9ICIiKSB7CiAgICAgICAgICBHYW1lLnNwZWNpYWxUYWIgPSAiIjsKICAgICAgICAgIGwoInNwZWNpYWxQb3B1cCIpLmNsYXNzTmFtZSA9ICJmcmFtZWQgcHJvbXB0IG9mZlNjcmVlbiI7CiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgaWYgKEdhbWUuc3BlY2lhbFRhYiA9PSAiIikgewogICAgICAgICAgICAgIC8qbCgnc3BlY2lhbFBvcHVwJykuc3R5bGUuZGlzcGxheT0nbm9uZSc7Ki8gbCgKICAgICAgICAgICAgICAgICJzcGVjaWFsUG9wdXAiCiAgICAgICAgICAgICAgKS5pbm5lckhUTUwgPSAiIjsKICAgICAgICAgICAgfQogICAgICAgICAgfSwgMTAwMCAqIDAuMik7CiAgICAgICAgfQogICAgICB9CiAgICB9OwogICAgR2FtZS5EcmF3U3BlY2lhbCA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGxlbiA9IEdhbWUuc3BlY2lhbFRhYnMubGVuZ3RoOwogICAgICBpZiAobGVuID09IDApIHJldHVybjsKICAgICAgR2FtZS5MZWZ0QmFja2dyb3VuZC5nbG9iYWxBbHBoYSA9IDE7CiAgICAgIHZhciB5ID0gR2FtZS5MZWZ0QmFja2dyb3VuZC5jYW52YXMuaGVpZ2h0IC0gMjQgLSA0OCAqIGxlbjsKICAgICAgdmFyIHRhYkkgPSAwOwoKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLnNwZWNpYWxUYWJzKSB7CiAgICAgICAgdmFyIHNlbGVjdGVkID0gMDsKICAgICAgICB2YXIgaG92ZXJlZCA9IDA7CiAgICAgICAgaWYgKEdhbWUuc3BlY2lhbFRhYiA9PSBHYW1lLnNwZWNpYWxUYWJzW2ldKSBzZWxlY3RlZCA9IDE7CiAgICAgICAgaWYgKEdhbWUuc3BlY2lhbFRhYkhvdmVyZWQgPT0gR2FtZS5zcGVjaWFsVGFic1tpXSkgaG92ZXJlZCA9IDE7CiAgICAgICAgdmFyIHggPSAyNDsKICAgICAgICB2YXIgcyA9IDE7CiAgICAgICAgdmFyIHBpYyA9ICIiOwogICAgICAgIHZhciBmcmFtZSA9IDA7CiAgICAgICAgaWYgKGhvdmVyZWQpIHsKICAgICAgICAgIHMgPSAxOwogICAgICAgICAgeCA9IDI0OwogICAgICAgIH0KICAgICAgICBpZiAoc2VsZWN0ZWQpIHsKICAgICAgICAgIHMgPSAxOwogICAgICAgICAgeCA9IDQ4OwogICAgICAgIH0KCiAgICAgICAgaWYgKEdhbWUuc3BlY2lhbFRhYnNbaV0gPT0gInNhbnRhIikgewogICAgICAgICAgcGljID0gInNhbnRhLnBuZyI7CiAgICAgICAgICBmcmFtZSA9IEdhbWUuc2FudGFMZXZlbDsKICAgICAgICB9IGVsc2UgaWYgKEdhbWUuc3BlY2lhbFRhYnNbaV0gPT0gImRyYWdvbiIpIHsKICAgICAgICAgIHBpYyA9ICJkcmFnb24ucG5nP3Y9IiArIEdhbWUudmVyc2lvbjsKICAgICAgICAgIGZyYW1lID0gR2FtZS5kcmFnb25MZXZlbHNbR2FtZS5kcmFnb25MZXZlbF0ucGljOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBwaWMgPSAiZHJhZ29uLnBuZz92PSIgKyBHYW1lLnZlcnNpb247CiAgICAgICAgICBmcmFtZSA9IDQ7CiAgICAgICAgfQoKICAgICAgICBpZiAoaG92ZXJlZCB8fCBzZWxlY3RlZCkgewogICAgICAgICAgdmFyIHNzID0gcyAqIDY0OwogICAgICAgICAgdmFyIHIgPSBNYXRoLmZsb29yKChHYW1lLlQgKiAwLjUpICUgMzYwKTsKICAgICAgICAgIEdhbWUuTGVmdEJhY2tncm91bmQuc2F2ZSgpOwogICAgICAgICAgR2FtZS5MZWZ0QmFja2dyb3VuZC50cmFuc2xhdGUoeCwgeSk7CiAgICAgICAgICBpZiAoR2FtZS5wcmVmcy5mYW5jeSkKICAgICAgICAgICAgR2FtZS5MZWZ0QmFja2dyb3VuZC5yb3RhdGUoKHIgLyAzNjApICogTWF0aC5QSSAqIDIpOwogICAgICAgICAgR2FtZS5MZWZ0QmFja2dyb3VuZC5nbG9iYWxBbHBoYSA9IDAuNzU7CiAgICAgICAgICBHYW1lLkxlZnRCYWNrZ3JvdW5kLmRyYXdJbWFnZSgKICAgICAgICAgICAgUGljKCJzaGluZS5wbmciKSwKICAgICAgICAgICAgLXNzIC8gMiwKICAgICAgICAgICAgLXNzIC8gMiwKICAgICAgICAgICAgc3MsCiAgICAgICAgICAgIHNzCiAgICAgICAgICApOwogICAgICAgICAgR2FtZS5MZWZ0QmFja2dyb3VuZC5yZXN0b3JlKCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoR2FtZS5wcmVmcy5mYW5jeSkKICAgICAgICAgIEdhbWUuTGVmdEJhY2tncm91bmQuZHJhd0ltYWdlKAogICAgICAgICAgICBQaWMocGljKSwKICAgICAgICAgICAgOTYgKiBmcmFtZSwKICAgICAgICAgICAgMCwKICAgICAgICAgICAgOTYsCiAgICAgICAgICAgIDk2LAogICAgICAgICAgICB4ICsgKHNlbGVjdGVkID8gMCA6IE1hdGguc2luKEdhbWUuVCAqIDAuMiArIHRhYkkpICogMykgLSAyNCAqIHMsCiAgICAgICAgICAgIHkgLQogICAgICAgICAgICAgIChzZWxlY3RlZCA/IDYgOiBNYXRoLmFicyhNYXRoLmNvcyhHYW1lLlQgKiAwLjIgKyB0YWJJKSkgKiA2KSAtCiAgICAgICAgICAgICAgMjQgKiBzLAogICAgICAgICAgICA0OCAqIHMsCiAgICAgICAgICAgIDQ4ICogcwogICAgICAgICAgKTsKICAgICAgICBlbHNlCiAgICAgICAgICBHYW1lLkxlZnRCYWNrZ3JvdW5kLmRyYXdJbWFnZSgKICAgICAgICAgICAgUGljKHBpYyksCiAgICAgICAgICAgIDk2ICogZnJhbWUsCiAgICAgICAgICAgIDAsCiAgICAgICAgICAgIDk2LAogICAgICAgICAgICA5NiwKICAgICAgICAgICAgeCAtIDI0ICogcywKICAgICAgICAgICAgeSAtIDI0ICogcywKICAgICAgICAgICAgNDggKiBzLAogICAgICAgICAgICA0OCAqIHMKICAgICAgICAgICk7CgogICAgICAgIHRhYkkrKzsKICAgICAgICB5ICs9IDQ4OwogICAgICB9CiAgICB9OwoKICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJCVZJU1VBTCBFRkZFQ1RTCgkJPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KCiAgICBHYW1lLkFsbE1pbGtzID0gWwogICAgICB7IG5hbWU6ICJBdXRvbWF0aWMiLCBpY29uOiBbMCwgN10sIHR5cGU6IC0xLCBwaWM6ICJtaWxrUGxhaW4iIH0sCiAgICAgIHsgbmFtZTogIlBsYWluIG1pbGsiLCBpY29uOiBbMSwgOF0sIHR5cGU6IDAsIHBpYzogIm1pbGtQbGFpbiIgfSwKICAgICAgeyBuYW1lOiAiQ2hvY29sYXRlIG1pbGsiLCBpY29uOiBbMiwgOF0sIHR5cGU6IDAsIHBpYzogIm1pbGtDaG9jb2xhdGUiIH0sCiAgICAgIHsgbmFtZTogIlJhc3BiZXJyeSBtaWxrIiwgaWNvbjogWzMsIDhdLCB0eXBlOiAwLCBwaWM6ICJtaWxrUmFzcGJlcnJ5IiB9LAogICAgICB7IG5hbWU6ICJPcmFuZ2UgbWlsayIsIGljb246IFs0LCA4XSwgdHlwZTogMCwgcGljOiAibWlsa09yYW5nZSIgfSwKICAgICAgeyBuYW1lOiAiQ2FyYW1lbCBtaWxrIiwgaWNvbjogWzUsIDhdLCB0eXBlOiAwLCBwaWM6ICJtaWxrQ2FyYW1lbCIgfSwKICAgICAgeyBuYW1lOiAiQmFuYW5hIG1pbGsiLCBpY29uOiBbNiwgOF0sIHR5cGU6IDAsIHBpYzogIm1pbGtCYW5hbmEiIH0sCiAgICAgIHsgbmFtZTogIkxpbWUgbWlsayIsIGljb246IFs3LCA4XSwgdHlwZTogMCwgcGljOiAibWlsa0xpbWUiIH0sCiAgICAgIHsgbmFtZTogIkJsdWViZXJyeSBtaWxrIiwgaWNvbjogWzgsIDhdLCB0eXBlOiAwLCBwaWM6ICJtaWxrQmx1ZWJlcnJ5IiB9LAogICAgICB7IG5hbWU6ICJTdHJhd2JlcnJ5IG1pbGsiLCBpY29uOiBbOSwgOF0sIHR5cGU6IDAsIHBpYzogIm1pbGtTdHJhd2JlcnJ5IiB9LAogICAgICB7IG5hbWU6ICJWYW5pbGxhIG1pbGsiLCBpY29uOiBbMTAsIDhdLCB0eXBlOiAwLCBwaWM6ICJtaWxrVmFuaWxsYSIgfSwKICAgICAgeyBuYW1lOiAiWmVicmEgbWlsayIsIGljb246IFsxMCwgN10sIHR5cGU6IDEsIHBpYzogIm1pbGtaZWJyYSIgfSwKICAgICAgeyBuYW1lOiAiQ29zbWljIG1pbGsiLCBpY29uOiBbOSwgN10sIHR5cGU6IDEsIHBpYzogIm1pbGtTdGFycyIgfSwKICAgICAgeyBuYW1lOiAiRmxhbWluZyBtaWxrIiwgaWNvbjogWzgsIDddLCB0eXBlOiAxLCBwaWM6ICJtaWxrRmlyZSIgfSwKICAgICAgeyBuYW1lOiAiU2FuZ3VpbmUgbWlsayIsIGljb246IFs3LCA3XSwgdHlwZTogMSwgcGljOiAibWlsa0Jsb29kIiB9LAogICAgICB7IG5hbWU6ICJNaWRhcyBtaWxrIiwgaWNvbjogWzYsIDddLCB0eXBlOiAxLCBwaWM6ICJtaWxrR29sZCIgfSwKICAgICAgeyBuYW1lOiAiTWlkbmlnaHQgbWlsayIsIGljb246IFs1LCA3XSwgdHlwZTogMSwgcGljOiAibWlsa0JsYWNrIiB9LAogICAgICB7CiAgICAgICAgbmFtZTogIkdyZWVuIGluZmVybm8gbWlsayIsCiAgICAgICAgaWNvbjogWzQsIDddLAogICAgICAgIHR5cGU6IDEsCiAgICAgICAgcGljOiAibWlsa0dyZWVuRmlyZSIsCiAgICAgIH0sCiAgICAgIHsgbmFtZTogIkZyb3N0ZmlyZSBtaWxrIiwgaWNvbjogWzMsIDddLCB0eXBlOiAxLCBwaWM6ICJtaWxrQmx1ZUZpcmUiIH0sCiAgICAgIHsgbmFtZTogIkhvbmV5IG1pbGsiLCBpY29uOiBbMjEsIDIzXSwgdHlwZTogMCwgcGljOiAibWlsa0hvbmV5IiB9LAogICAgICB7IG5hbWU6ICJDb2ZmZWUgbWlsayIsIGljb246IFsyMiwgMjNdLCB0eXBlOiAwLCBwaWM6ICJtaWxrQ29mZmVlIiB9LAogICAgICB7IG5hbWU6ICJUZWEgbWlsayIsIGljb246IFsyMywgMjNdLCB0eXBlOiAwLCBwaWM6ICJtaWxrVGVhIiB9LAogICAgICB7IG5hbWU6ICJDb2NvbnV0IG1pbGsiLCBpY29uOiBbMjQsIDIzXSwgdHlwZTogMCwgcGljOiAibWlsa0NvY29udXQiIH0sCiAgICAgIHsgbmFtZTogIkNoZXJyeSBtaWxrIiwgaWNvbjogWzI1LCAyM10sIHR5cGU6IDAsIHBpYzogIm1pbGtDaGVycnkiIH0sCiAgICAgIHsgbmFtZTogIlNveSBtaWxrIiwgaWNvbjogWzI3LCAyM10sIHR5cGU6IDEsIHBpYzogIm1pbGtTb3kiIH0sCiAgICAgIHsgbmFtZTogIlNwaWNlZCBtaWxrIiwgaWNvbjogWzI2LCAyM10sIHR5cGU6IDAsIHBpYzogIm1pbGtTcGljZWQiIH0sCiAgICAgIHsgbmFtZTogIk1hcGxlIG1pbGsiLCBpY29uOiBbMjgsIDIzXSwgdHlwZTogMCwgcGljOiAibWlsa01hcGxlIiB9LAogICAgICB7IG5hbWU6ICJNaW50IG1pbGsiLCBpY29uOiBbMjksIDIzXSwgdHlwZTogMCwgcGljOiAibWlsa01pbnQiIH0sCiAgICAgIHsgbmFtZTogIkxpY29yaWNlIG1pbGsiLCBpY29uOiBbMzAsIDIzXSwgdHlwZTogMCwgcGljOiAibWlsa0xpY29yaWNlIiB9LAogICAgICB7IG5hbWU6ICJSb3NlIG1pbGsiLCBpY29uOiBbMzEsIDIzXSwgdHlwZTogMCwgcGljOiAibWlsa1Jvc2UiIH0sCiAgICAgIHsKICAgICAgICBuYW1lOiAiRHJhZ29uZnJ1aXQgbWlsayIsCiAgICAgICAgaWNvbjogWzIxLCAyNF0sCiAgICAgICAgdHlwZTogMCwKICAgICAgICBwaWM6ICJtaWxrRHJhZ29uZnJ1aXQiLAogICAgICB9LAogICAgICB7IG5hbWU6ICJNZWxvbiBtaWxrIiwgaWNvbjogWzIyLCAyNF0sIHR5cGU6IDAsIHBpYzogIm1pbGtNZWxvbiIgfSwKICAgICAgewogICAgICAgIG5hbWU6ICJCbGFja2N1cnJhbnQgbWlsayIsCiAgICAgICAgaWNvbjogWzIzLCAyNF0sCiAgICAgICAgdHlwZTogMCwKICAgICAgICBwaWM6ICJtaWxrQmxhY2tjdXJyYW50IiwKICAgICAgfSwKICAgIF07CgogICAgR2FtZS5NaWxrcyA9IFtdOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBHYW1lLkFsbE1pbGtzLmxlbmd0aDsgaSsrKSB7CiAgICAgIEdhbWUuQWxsTWlsa3NbaV0uYm5hbWUgPSBHYW1lLkFsbE1pbGtzW2ldLm5hbWU7CiAgICAgIEdhbWUuQWxsTWlsa3NbaV0ubmFtZSA9IGxvYyhHYW1lLkFsbE1pbGtzW2ldLm5hbWUpOwogICAgICBHYW1lLkFsbE1pbGtzW2ldLnBpYyArPSAiLnBuZyI7CiAgICAgIGlmIChHYW1lLkFsbE1pbGtzW2ldLnR5cGUgPT0gMCkgewogICAgICAgIEdhbWUuQWxsTWlsa3NbaV0ucmFuayA9IEdhbWUuTWlsa3MubGVuZ3RoOwogICAgICAgIEdhbWUuTWlsa3MucHVzaChHYW1lLkFsbE1pbGtzW2ldKTsKICAgICAgfQogICAgfQogICAgR2FtZS5NaWxrID0gR2FtZS5NaWxrc1swXTsKCiAgICBHYW1lLm1vdXNlUG9pbnRlciA9IDA7IC8vd2hlbiAxLCBkcmF3IHRoZSBtb3VzZSBhcyBhIHBvaW50ZXIgb24gdGhlIGxlZnQgc2NyZWVuCgogICAgR2FtZS5jb29raWVPcmlnaW5YID0gMDsKICAgIEdhbWUuY29va2llT3JpZ2luWSA9IDA7CiAgICBHYW1lLkRyYXdCYWNrZ3JvdW5kID0gZnVuY3Rpb24gKCkgewogICAgICBUaW1lci5jbGVhbigpOwogICAgICAvL2JhY2tncm91bmQKICAgICAgaWYgKCFHYW1lLkJhY2tncm91bmQpIHsKICAgICAgICAvL2luaXQgc29tZSBzdHVmZgogICAgICAgIEdhbWUuQmFja2dyb3VuZCA9IGwoImJhY2tncm91bmRDYW52YXMiKS5nZXRDb250ZXh0KCIyZCIpOwogICAgICAgIEdhbWUuQmFja2dyb3VuZC5jYW52YXMud2lkdGggPQogICAgICAgICAgR2FtZS5CYWNrZ3JvdW5kLmNhbnZhcy5wYXJlbnROb2RlLm9mZnNldFdpZHRoOwogICAgICAgIEdhbWUuQmFja2dyb3VuZC5jYW52YXMuaGVpZ2h0ID0KICAgICAgICAgIEdhbWUuQmFja2dyb3VuZC5jYW52YXMucGFyZW50Tm9kZS5vZmZzZXRIZWlnaHQ7CiAgICAgICAgR2FtZS5MZWZ0QmFja2dyb3VuZCA9IGwoImJhY2tncm91bmRMZWZ0Q2FudmFzIikuZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgICBHYW1lLkxlZnRCYWNrZ3JvdW5kLmNhbnZhcy53aWR0aCA9CiAgICAgICAgICBHYW1lLkxlZnRCYWNrZ3JvdW5kLmNhbnZhcy5wYXJlbnROb2RlLm9mZnNldFdpZHRoOwogICAgICAgIEdhbWUuTGVmdEJhY2tncm91bmQuY2FudmFzLmhlaWdodCA9CiAgICAgICAgICBHYW1lLkxlZnRCYWNrZ3JvdW5kLmNhbnZhcy5wYXJlbnROb2RlLm9mZnNldEhlaWdodDsKICAgICAgICAvL3ByZWxvYWQgYXNjZW5kIGFuaW1hdGlvbiBiaXRzIHNvIHRoZXkgc2hvdyB1cCBpbnN0YW50bHkKICAgICAgICBHYW1lLkxlZnRCYWNrZ3JvdW5kLmdsb2JhbEFscGhhID0gMDsKICAgICAgICBHYW1lLkxlZnRCYWNrZ3JvdW5kLmRyYXdJbWFnZShQaWMoImJyb2tlbkNvb2tpZS5wbmciKSwgMCwgMCk7CiAgICAgICAgR2FtZS5MZWZ0QmFja2dyb3VuZC5kcmF3SW1hZ2UoUGljKCJicm9rZW5Db29raWVIYWxvLnBuZyIpLCAwLCAwKTsKICAgICAgICBHYW1lLkxlZnRCYWNrZ3JvdW5kLmRyYXdJbWFnZShQaWMoInN0YXJiZy5qcGciKSwgMCwgMCk7CgogICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJyZXNpemUiLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgIEdhbWUuQmFja2dyb3VuZC5jYW52YXMud2lkdGggPQogICAgICAgICAgICBHYW1lLkJhY2tncm91bmQuY2FudmFzLnBhcmVudE5vZGUub2Zmc2V0V2lkdGg7CiAgICAgICAgICBHYW1lLkJhY2tncm91bmQuY2FudmFzLmhlaWdodCA9CiAgICAgICAgICAgIEdhbWUuQmFja2dyb3VuZC5jYW52YXMucGFyZW50Tm9kZS5vZmZzZXRIZWlnaHQ7CiAgICAgICAgICBHYW1lLkxlZnRCYWNrZ3JvdW5kLmNhbnZhcy53aWR0aCA9CiAgICAgICAgICAgIEdhbWUuTGVmdEJhY2tncm91bmQuY2FudmFzLnBhcmVudE5vZGUub2Zmc2V0V2lkdGg7CiAgICAgICAgICBHYW1lLkxlZnRCYWNrZ3JvdW5kLmNhbnZhcy5oZWlnaHQgPQogICAgICAgICAgICBHYW1lLkxlZnRCYWNrZ3JvdW5kLmNhbnZhcy5wYXJlbnROb2RlLm9mZnNldEhlaWdodDsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgdmFyIGN0eCA9IEdhbWUuTGVmdEJhY2tncm91bmQ7CgogICAgICBpZiAoR2FtZS5PbkFzY2VuZCkgewogICAgICAgIFRpbWVyLmNsZWFuKCk7CiAgICAgICAgLy9zdGFycnkgYmFja2dyb3VuZCBvbiBhc2NlbmQgc2NyZWVuCiAgICAgICAgdmFyIHcgPSBHYW1lLkJhY2tncm91bmQuY2FudmFzLndpZHRoOwogICAgICAgIHZhciBoID0gR2FtZS5CYWNrZ3JvdW5kLmNhbnZhcy5oZWlnaHQ7CiAgICAgICAgdmFyIGIgPSBHYW1lLmFzY2VuZGwuZ2V0Qm91bmRzKCk7CiAgICAgICAgdmFyIHggPSAoYi5sZWZ0ICsgYi5yaWdodCkgLyAyOwogICAgICAgIHZhciB5ID0gKGIudG9wICsgYi5ib3R0b20pIC8gMjsKICAgICAgICBHYW1lLkJhY2tncm91bmQuZ2xvYmFsQWxwaGEgPSAwLjU7CiAgICAgICAgdmFyIHMgPSAxICogR2FtZS5Bc2NlbmRab29tICogKDEgKyBNYXRoLmNvcyhHYW1lLlQgKiAwLjAwMjcpICogMC4wNSk7CiAgICAgICAgR2FtZS5CYWNrZ3JvdW5kLmZpbGxQYXR0ZXJuKAogICAgICAgICAgUGljKCJzdGFyYmcuanBnIiksCiAgICAgICAgICAwLAogICAgICAgICAgMCwKICAgICAgICAgIHcsCiAgICAgICAgICBoLAogICAgICAgICAgMTAyNCAqIHMsCiAgICAgICAgICAxMDI0ICogcywKICAgICAgICAgIHggKyBHYW1lLkFzY2VuZE9mZlggKiAwLjI1ICogcywKICAgICAgICAgIHkgKyBHYW1lLkFzY2VuZE9mZlkgKiAwLjI1ICogcwogICAgICAgICk7CiAgICAgICAgVGltZXIudHJhY2soInN0YXIgbGF5ZXIgMSIpOwogICAgICAgIGlmIChHYW1lLnByZWZzLmZhbmN5KSB7CiAgICAgICAgICAvL2FkZGl0aW9uYWwgc3RhciBsYXllcgogICAgICAgICAgR2FtZS5CYWNrZ3JvdW5kLmdsb2JhbEFscGhhID0KICAgICAgICAgICAgMC41ICogKDAuNSArIE1hdGguc2luKEdhbWUuVCAqIDAuMDIpICogMC4zKTsKICAgICAgICAgIHZhciBzID0gMiAqIEdhbWUuQXNjZW5kWm9vbSAqICgxICsgTWF0aC5zaW4oR2FtZS5UICogMC4wMDIpICogMC4wNyk7CiAgICAgICAgICAvL0dhbWUuQmFja2dyb3VuZC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb249J2xpZ2h0ZXInOwogICAgICAgICAgR2FtZS5CYWNrZ3JvdW5kLmZpbGxQYXR0ZXJuKAogICAgICAgICAgICBQaWMoInN0YXJiZy5qcGciKSwKICAgICAgICAgICAgMCwKICAgICAgICAgICAgMCwKICAgICAgICAgICAgdywKICAgICAgICAgICAgaCwKICAgICAgICAgICAgMTAyNCAqIHMsCiAgICAgICAgICAgIDEwMjQgKiBzLAogICAgICAgICAgICB4ICsgR2FtZS5Bc2NlbmRPZmZYICogMC4yNSAqIHMsCiAgICAgICAgICAgIHkgKyBHYW1lLkFzY2VuZE9mZlkgKiAwLjI1ICogcwogICAgICAgICAgKTsKICAgICAgICAgIC8vR2FtZS5CYWNrZ3JvdW5kLmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbj0nc291cmNlLW92ZXInOwogICAgICAgICAgVGltZXIudHJhY2soInN0YXIgbGF5ZXIgMiIpOwoKICAgICAgICAgIHggPSB4ICsgR2FtZS5Bc2NlbmRPZmZYICogR2FtZS5Bc2NlbmRab29tOwogICAgICAgICAgeSA9IHkgKyBHYW1lLkFzY2VuZE9mZlkgKiBHYW1lLkFzY2VuZFpvb207CiAgICAgICAgICAvL3dpc3B5IG5lYnVsYSBhcm91bmQgdGhlIGNlbnRlcgogICAgICAgICAgR2FtZS5CYWNrZ3JvdW5kLnNhdmUoKTsKICAgICAgICAgIEdhbWUuQmFja2dyb3VuZC5nbG9iYWxBbHBoYSA9IDAuNTsKICAgICAgICAgIEdhbWUuQmFja2dyb3VuZC50cmFuc2xhdGUoeCwgeSk7CiAgICAgICAgICBHYW1lLkJhY2tncm91bmQuZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gImxpZ2h0ZXIiOwogICAgICAgICAgR2FtZS5CYWNrZ3JvdW5kLnJvdGF0ZShHYW1lLlQgKiAwLjAwMSk7CiAgICAgICAgICBzID0gKDYwMCArIDE1MCAqIE1hdGguc2luKEdhbWUuVCAqIDAuMDA3KSkgKiBHYW1lLkFzY2VuZFpvb207CiAgICAgICAgICBHYW1lLkJhY2tncm91bmQuZHJhd0ltYWdlKAogICAgICAgICAgICBQaWMoImhlYXZlblJpbmcxLmpwZyIpLAogICAgICAgICAgICAtcyAvIDIsCiAgICAgICAgICAgIC1zIC8gMiwKICAgICAgICAgICAgcywKICAgICAgICAgICAgcwogICAgICAgICAgKTsKICAgICAgICAgIEdhbWUuQmFja2dyb3VuZC5yb3RhdGUoLUdhbWUuVCAqIDAuMDAxNyk7CiAgICAgICAgICBzID0gKDYwMCArIDE1MCAqIE1hdGguc2luKEdhbWUuVCAqIDAuMDAzNykpICogR2FtZS5Bc2NlbmRab29tOwogICAgICAgICAgR2FtZS5CYWNrZ3JvdW5kLmRyYXdJbWFnZSgKICAgICAgICAgICAgUGljKCJoZWF2ZW5SaW5nMi5qcGciKSwKICAgICAgICAgICAgLXMgLyAyLAogICAgICAgICAgICAtcyAvIDIsCiAgICAgICAgICAgIHMsCiAgICAgICAgICAgIHMKICAgICAgICAgICk7CiAgICAgICAgICBHYW1lLkJhY2tncm91bmQucmVzdG9yZSgpOwogICAgICAgICAgVGltZXIudHJhY2soIm5lYnVsYSIpOwoKICAgICAgICAgIC8vR2FtZS5CYWNrZ3JvdW5kLmRyYXdJbWFnZShQaWMoJ3NoYWRlZEJvcmRlcnMucG5nJyksMCwwLHcsaCk7CiAgICAgICAgICAvL1RpbWVyLnRyYWNrKCdib3JkZXInKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIGdvb2RCdWZmID0gMDsKICAgICAgICB2YXIgYmFkQnVmZiA9IDA7CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLmJ1ZmZzKSB7CiAgICAgICAgICBpZiAoR2FtZS5idWZmc1tpXS5hdXJhID09IDEpIGdvb2RCdWZmID0gMTsKICAgICAgICAgIGlmIChHYW1lLmJ1ZmZzW2ldLmF1cmEgPT0gMikgYmFkQnVmZiA9IDE7CiAgICAgICAgfQoKICAgICAgICBpZiAoR2FtZS5kcmF3VCAlIDUgPT0gMCkgewogICAgICAgICAgaWYgKGZhbHNlICYmIEdhbWUuYmdUeXBlICE9IDAgJiYgR2FtZS5hc2NlbnNpb25Nb2RlICE9IDEpIHsKICAgICAgICAgICAgLy9sKCdiYWNrZ3JvdW5kQ2FudmFzJykuc3R5bGUuYmFja2dyb3VuZD0ndXJsKGltZy9zaGFkZWRCb3JkZXJzU29mdC5wbmcpIDBweCAwcHgsdXJsKGltZy9iZ1doZWF0LmpwZykgNTAlIDUwJSc7CiAgICAgICAgICAgIC8vbCgnYmFja2dyb3VuZENhbnZhcycpLnN0eWxlLmJhY2tncm91bmRTaXplPScxMDAlIDEwMCUsY292ZXInOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbCgiYmFja2dyb3VuZENhbnZhcyIpLnN0eWxlLmJhY2tncm91bmQgPSAidHJhbnNwYXJlbnQiOwogICAgICAgICAgICBHYW1lLmRlZmF1bHRCZyA9ICJiZ0JsdWUiOwogICAgICAgICAgICBHYW1lLmJnUiA9IDA7CgogICAgICAgICAgICBpZiAoR2FtZS5zZWFzb24gPT0gImZvb2xzIikgR2FtZS5kZWZhdWx0QmcgPSAiYmdNb25leSI7CiAgICAgICAgICAgIGlmIChHYW1lLmVsZGVyV3JhdGhEIDwgMSB8fCBHYW1lLnByZWZzLm5vdFNjYXJ5KSB7CiAgICAgICAgICAgICAgR2FtZS5iZ1IgPSAwOwogICAgICAgICAgICAgIEdhbWUuYmcgPSBHYW1lLmRlZmF1bHRCZzsKICAgICAgICAgICAgICBHYW1lLmJnRmFkZSA9IEdhbWUuZGVmYXVsdEJnOwogICAgICAgICAgICB9IGVsc2UgaWYgKEdhbWUuZWxkZXJXcmF0aEQgPj0gMSAmJiBHYW1lLmVsZGVyV3JhdGhEIDwgMikgewogICAgICAgICAgICAgIEdhbWUuYmdSID0gKEdhbWUuZWxkZXJXcmF0aEQgLSAxKSAvIDE7CiAgICAgICAgICAgICAgR2FtZS5iZyA9IEdhbWUuZGVmYXVsdEJnOwogICAgICAgICAgICAgIEdhbWUuYmdGYWRlID0gImdyYW5kbWFzMSI7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoR2FtZS5lbGRlcldyYXRoRCA+PSAyICYmIEdhbWUuZWxkZXJXcmF0aEQgPCAzKSB7CiAgICAgICAgICAgICAgR2FtZS5iZ1IgPSAoR2FtZS5lbGRlcldyYXRoRCAtIDIpIC8gMTsKICAgICAgICAgICAgICBHYW1lLmJnID0gImdyYW5kbWFzMSI7CiAgICAgICAgICAgICAgR2FtZS5iZ0ZhZGUgPSAiZ3JhbmRtYXMyIjsKICAgICAgICAgICAgfSBlbHNlIGlmIChHYW1lLmVsZGVyV3JhdGhEID49IDMpIHsKICAgICAgICAgICAgICAvLyAmJiBHYW1lLmVsZGVyV3JhdGhEPDQpCiAgICAgICAgICAgICAgR2FtZS5iZ1IgPSAoR2FtZS5lbGRlcldyYXRoRCAtIDMpIC8gMTsKICAgICAgICAgICAgICBHYW1lLmJnID0gImdyYW5kbWFzMiI7CiAgICAgICAgICAgICAgR2FtZS5iZ0ZhZGUgPSAiZ3JhbmRtYXMzIjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKEdhbWUuYmdUeXBlICE9IDAgJiYgR2FtZS5hc2NlbnNpb25Nb2RlICE9IDEpIHsKICAgICAgICAgICAgICBHYW1lLmJnUiA9IDA7CiAgICAgICAgICAgICAgR2FtZS5iZyA9IEdhbWUuQkdzQnlDaG9pY2VbR2FtZS5iZ1R5cGVdLnBpYzsKICAgICAgICAgICAgICBHYW1lLmJnRmFkZSA9IEdhbWUuYmc7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEdhbWUuQmFja2dyb3VuZC5maWxsUGF0dGVybigKICAgICAgICAgICAgICBQaWMoR2FtZS5iZyArICIuanBnIiksCiAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgIEdhbWUuQmFja2dyb3VuZC5jYW52YXMud2lkdGgsCiAgICAgICAgICAgICAgR2FtZS5CYWNrZ3JvdW5kLmNhbnZhcy5oZWlnaHQsCiAgICAgICAgICAgICAgNTEyLAogICAgICAgICAgICAgIDUxMiwKICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgIDAKICAgICAgICAgICAgKTsKICAgICAgICAgICAgaWYgKEdhbWUuYmdSID4gMCkgewogICAgICAgICAgICAgIEdhbWUuQmFja2dyb3VuZC5nbG9iYWxBbHBoYSA9IEdhbWUuYmdSOwogICAgICAgICAgICAgIEdhbWUuQmFja2dyb3VuZC5maWxsUGF0dGVybigKICAgICAgICAgICAgICAgIFBpYyhHYW1lLmJnRmFkZSArICIuanBnIiksCiAgICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgIEdhbWUuQmFja2dyb3VuZC5jYW52YXMud2lkdGgsCiAgICAgICAgICAgICAgICBHYW1lLkJhY2tncm91bmQuY2FudmFzLmhlaWdodCwKICAgICAgICAgICAgICAgIDUxMiwKICAgICAgICAgICAgICAgIDUxMiwKICAgICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgICAwCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBHYW1lLkJhY2tncm91bmQuZ2xvYmFsQWxwaGEgPSAxOwogICAgICAgICAgICBHYW1lLkJhY2tncm91bmQuZHJhd0ltYWdlKAogICAgICAgICAgICAgIFBpYygic2hhZGVkQm9yZGVyc1NvZnQucG5nIiksCiAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgIEdhbWUuQmFja2dyb3VuZC5jYW52YXMud2lkdGgsCiAgICAgICAgICAgICAgR2FtZS5CYWNrZ3JvdW5kLmNhbnZhcy5oZWlnaHQKICAgICAgICAgICAgKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgVGltZXIudHJhY2soIndpbmRvdyBiYWNrZ3JvdW5kIik7CgogICAgICAgIC8vY2xlYXIKICAgICAgICBjdHguY2xlYXJSZWN0KDAsIDAsIGN0eC5jYW52YXMud2lkdGgsIGN0eC5jYW52YXMuaGVpZ2h0KTsKICAgICAgICAvKmlmIChHYW1lLkFzY2VuZFRpbWVyPEdhbWUuQXNjZW5kQnJlYWtwb2ludCkgY3R4LmNsZWFyUmVjdCgwLDAsY3R4LmNhbnZhcy53aWR0aCxjdHguY2FudmFzLmhlaWdodCk7CgkJCQllbHNlCgkJCQl7CgkJCQkJY3R4Lmdsb2JhbEFscGhhPTAuMDU7CgkJCQkJY3R4LmZpbGxTdHlsZT0nIzAwMCc7CgkJCQkJY3R4LmZpbGxSZWN0KDAsMCxjdHguY2FudmFzLndpZHRoLGN0eC5jYW52YXMuaGVpZ2h0KTsKCQkJCQljdHguZ2xvYmFsQWxwaGE9MTsKCQkJCQlPbGRDYW52YXNEcmF3SW1hZ2UuYXBwbHkoY3R4LFtjdHguY2FudmFzLE1hdGgucmFuZG9tKCkqNC0yLE1hdGgucmFuZG9tKCkqNC0yLTRdKTsKCQkJCQljdHguZ2xvYmFsQWxwaGE9MTsKCQkJCX0qLwogICAgICAgIFRpbWVyLmNsZWFuKCk7CgogICAgICAgIHZhciBzaG93RHJhZ29uID0gMDsKICAgICAgICBpZiAoR2FtZS5oYXNCdWZmKCJEcmFnb25mbGlnaHQiKSB8fCBHYW1lLmhhc0J1ZmYoIkRyYWdvbiBIYXJ2ZXN0IikpCiAgICAgICAgICBzaG93RHJhZ29uID0gMTsKCiAgICAgICAgR2FtZS5jb29raWVPcmlnaW5YID0gTWF0aC5mbG9vcihjdHguY2FudmFzLndpZHRoIC8gMik7CiAgICAgICAgR2FtZS5jb29raWVPcmlnaW5ZID0gTWF0aC5mbG9vcihjdHguY2FudmFzLmhlaWdodCAqIDAuNCk7CgogICAgICAgIGlmIChHYW1lLkFzY2VuZFRpbWVyID09IDApIHsKICAgICAgICAgIGlmIChHYW1lLnByZWZzLnBhcnRpY2xlcykgewogICAgICAgICAgICAvL2ZhbGxpbmcgY29va2llcwogICAgICAgICAgICB2YXIgcGljID0gIiI7CiAgICAgICAgICAgIHZhciBvcGFjaXR5ID0gMTsKICAgICAgICAgICAgaWYgKEdhbWUuZWxkZXJXcmF0aEQgPD0gMS41IHx8IEdhbWUucHJlZnMubm90U2NhcnkpIHsKICAgICAgICAgICAgICBpZiAoR2FtZS5jb29raWVzUHMgPj0gMTAwMCkgcGljID0gImNvb2tpZVNob3dlcjMucG5nIjsKICAgICAgICAgICAgICBlbHNlIGlmIChHYW1lLmNvb2tpZXNQcyA+PSA1MDApIHBpYyA9ICJjb29raWVTaG93ZXIyLnBuZyI7CiAgICAgICAgICAgICAgZWxzZSBpZiAoR2FtZS5jb29raWVzUHMgPj0gNTApIHBpYyA9ICJjb29raWVTaG93ZXIxLnBuZyI7CiAgICAgICAgICAgICAgZWxzZSBwaWMgPSAiIjsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocGljICE9ICIiKSB7CiAgICAgICAgICAgICAgaWYgKEdhbWUuZWxkZXJXcmF0aEQgPj0gMSAmJiAhR2FtZS5wcmVmcy5ub3RTY2FyeSkKICAgICAgICAgICAgICAgIG9wYWNpdHkgPSAxIC0gKE1hdGgubWluKEdhbWUuZWxkZXJXcmF0aEQsIDEuNSkgLSAxKSAvIDAuNTsKICAgICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSBvcGFjaXR5OwogICAgICAgICAgICAgIHZhciB5ID0gTWF0aC5mbG9vcihHYW1lLlQgKiAyKSAlIDUxMjsKICAgICAgICAgICAgICBjdHguZmlsbFBhdHRlcm4oCiAgICAgICAgICAgICAgICBQaWMocGljKSwKICAgICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgICAgY3R4LmNhbnZhcy53aWR0aCwKICAgICAgICAgICAgICAgIGN0eC5jYW52YXMuaGVpZ2h0ICsgNTEyLAogICAgICAgICAgICAgICAgNTEyLAogICAgICAgICAgICAgICAgNTEyLAogICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgIHkKICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy9zbm93CiAgICAgICAgICAgIGlmIChHYW1lLnNlYXNvbiA9PSAiY2hyaXN0bWFzIikgewogICAgICAgICAgICAgIHZhciB5ID0gTWF0aC5mbG9vcihHYW1lLlQgKiAyLjUpICUgNTEyOwogICAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDAuNzU7CiAgICAgICAgICAgICAgY3R4Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9ICJsaWdodGVyIjsKICAgICAgICAgICAgICBjdHguZmlsbFBhdHRlcm4oCiAgICAgICAgICAgICAgICBQaWMoInNub3cyLmpwZyIpLAogICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgICBjdHguY2FudmFzLndpZHRoLAogICAgICAgICAgICAgICAgY3R4LmNhbnZhcy5oZWlnaHQgKyA1MTIsCiAgICAgICAgICAgICAgICA1MTIsCiAgICAgICAgICAgICAgICA1MTIsCiAgICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgICAgeQogICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgY3R4Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9ICJzb3VyY2Utb3ZlciI7CiAgICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvL2hlYXJ0cwogICAgICAgICAgICBpZiAoR2FtZS5zZWFzb24gPT0gInZhbGVudGluZXMiKSB7CiAgICAgICAgICAgICAgdmFyIHkgPSBNYXRoLmZsb29yKEdhbWUuVCAqIDIuNSkgJSA1MTI7CiAgICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMTsKICAgICAgICAgICAgICBjdHguZmlsbFBhdHRlcm4oCiAgICAgICAgICAgICAgICBQaWMoImhlYXJ0U3Rvcm0ucG5nIiksCiAgICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgIGN0eC5jYW52YXMud2lkdGgsCiAgICAgICAgICAgICAgICBjdHguY2FudmFzLmhlaWdodCArIDUxMiwKICAgICAgICAgICAgICAgIDUxMiwKICAgICAgICAgICAgICAgIDUxMiwKICAgICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgICB5CiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIFRpbWVyLnRyYWNrKCJsZWZ0IGJhY2tncm91bmQiKTsKCiAgICAgICAgICAgIEdhbWUucGFydGljbGVzRHJhdygwKTsKICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMTsKICAgICAgICAgICAgVGltZXIudHJhY2soInBhcnRpY2xlcyIpOwoKICAgICAgICAgICAgLy9iaWcgY29va2llIHNoaW5lCiAgICAgICAgICAgIHZhciBzID0gNTEyOwoKICAgICAgICAgICAgdmFyIHggPSBHYW1lLmNvb2tpZU9yaWdpblg7CiAgICAgICAgICAgIHZhciB5ID0gR2FtZS5jb29raWVPcmlnaW5ZOwoKICAgICAgICAgICAgdmFyIHIgPSBNYXRoLmZsb29yKChHYW1lLlQgKiAwLjUpICUgMzYwKTsKICAgICAgICAgICAgY3R4LnNhdmUoKTsKICAgICAgICAgICAgY3R4LnRyYW5zbGF0ZSh4LCB5KTsKICAgICAgICAgICAgY3R4LnJvdGF0ZSgociAvIDM2MCkgKiBNYXRoLlBJICogMik7CiAgICAgICAgICAgIHZhciBhbHBoYU11bHQgPSAxOwogICAgICAgICAgICBpZiAoR2FtZS5iZ1R5cGUgPT0gMiB8fCBHYW1lLmJnVHlwZSA9PSA0KSBhbHBoYU11bHQgPSAwLjU7CiAgICAgICAgICAgIHZhciBwaWMgPSAic2hpbmUucG5nIjsKICAgICAgICAgICAgaWYgKGdvb2RCdWZmKSB7CiAgICAgICAgICAgICAgcGljID0gInNoaW5lR29sZC5wbmciOwogICAgICAgICAgICAgIGFscGhhTXVsdCA9IDE7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoYmFkQnVmZikgewogICAgICAgICAgICAgIHBpYyA9ICJzaGluZVJlZC5wbmciOwogICAgICAgICAgICAgIGFscGhhTXVsdCA9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGdvb2RCdWZmICYmIEdhbWUucHJlZnMuZmFuY3kpCiAgICAgICAgICAgICAgY3R4Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9ICJsaWdodGVyIjsKICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMC41ICogYWxwaGFNdWx0OwogICAgICAgICAgICBjdHguZHJhd0ltYWdlKFBpYyhwaWMpLCAtcyAvIDIsIC1zIC8gMiwgcywgcyk7CiAgICAgICAgICAgIGN0eC5yb3RhdGUoKCgtciAqIDIpIC8gMzYwKSAqIE1hdGguUEkgKiAyKTsKICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMC4yNSAqIGFscGhhTXVsdDsKICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShQaWMocGljKSwgLXMgLyAyLCAtcyAvIDIsIHMsIHMpOwogICAgICAgICAgICBjdHgucmVzdG9yZSgpOwogICAgICAgICAgICBUaW1lci50cmFjaygic2hpbmUiKTsKCiAgICAgICAgICAgIGlmIChHYW1lLlJlaW5jYXJuYXRlVGltZXIgPiAwKSB7CiAgICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0KICAgICAgICAgICAgICAgIDEgLSBHYW1lLlJlaW5jYXJuYXRlVGltZXIgLyBHYW1lLlJlaW5jYXJuYXRlRHVyYXRpb247CiAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9ICIjMDAwIjsKICAgICAgICAgICAgICBjdHguZmlsbFJlY3QoMCwgMCwgY3R4LmNhbnZhcy53aWR0aCwgY3R4LmNhbnZhcy5oZWlnaHQpOwogICAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDE7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChzaG93RHJhZ29uKSB7CiAgICAgICAgICAgICAgLy9iaWcgZHJhZ29uCiAgICAgICAgICAgICAgdmFyIHMgPSAzMDAgKiAyICogKDEgKyBNYXRoLnNpbihHYW1lLlQgKiAwLjAxMykgKiAwLjEpOwogICAgICAgICAgICAgIHZhciB4ID0gR2FtZS5jb29raWVPcmlnaW5YIC0gcyAvIDI7CiAgICAgICAgICAgICAgdmFyIHkgPQogICAgICAgICAgICAgICAgR2FtZS5jb29raWVPcmlnaW5ZIC0gcyAvICgxLjQgKyAwLjIgKiBNYXRoLnNpbihHYW1lLlQgKiAwLjAxKSk7CiAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShQaWMoImRyYWdvbkJHLnBuZyIpLCB4LCB5LCBzLCBzKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy9iaWcgY29va2llCiAgICAgICAgICAgIGlmIChmYWxzZSkgewogICAgICAgICAgICAgIC8vZG9uJ3QgZG8gdGhhdAogICAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDE7CiAgICAgICAgICAgICAgdmFyIGFtb3VudCA9IE1hdGguZmxvb3IoR2FtZS5jb29raWVzKS50b1N0cmluZygpOwogICAgICAgICAgICAgIHZhciBkaWdpdHMgPSBhbW91bnQubGVuZ3RoOwogICAgICAgICAgICAgIHZhciBzcGFjZSA9IDA7CiAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkaWdpdHM7IGkrKykgewogICAgICAgICAgICAgICAgdmFyIHMgPSAxNiAqIChkaWdpdHMgLSBpKTsKICAgICAgICAgICAgICAgIHZhciBudW0gPSBwYXJzZUludChhbW91bnRbaV0pOwogICAgICAgICAgICAgICAgaWYgKGkgPiAwKSBzcGFjZSAtPSAocyAqICgxIC0gbnVtIC8gMTApKSAvIDI7CiAgICAgICAgICAgICAgICBpZiAoaSA9PSAwICYmIG51bSA+IDEpIHNwYWNlICs9IHMgKiAwLjE7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBpaSA9IDA7IGlpIDwgbnVtOyBpaSsrKSB7CiAgICAgICAgICAgICAgICAgIHZhciB4ID0gR2FtZS5jb29raWVPcmlnaW5YOwogICAgICAgICAgICAgICAgICB2YXIgeSA9IEdhbWUuY29va2llT3JpZ2luWTsKICAgICAgICAgICAgICAgICAgdmFyIHNwaW4gPQogICAgICAgICAgICAgICAgICAgIEdhbWUuVCAqICgwLjAwNSArIGkgKiAwLjAwMSkgKyBpICsgKGlpIC8gbnVtKSAqIE1hdGguUEkgKiAyOwogICAgICAgICAgICAgICAgICB4ICs9IE1hdGguc2luKHNwaW4pICogc3BhY2U7CiAgICAgICAgICAgICAgICAgIHkgKz0gTWF0aC5jb3Moc3BpbikgKiBzcGFjZTsKICAgICAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZSgKICAgICAgICAgICAgICAgICAgICBQaWMoInBlcmZlY3RDb29raWUucG5nIiksCiAgICAgICAgICAgICAgICAgICAgeCAtIHMgLyAyLAogICAgICAgICAgICAgICAgICAgIHkgLSBzIC8gMiwKICAgICAgICAgICAgICAgICAgICBzLAogICAgICAgICAgICAgICAgICAgIHMKICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHNwYWNlICs9IHMgLyAyOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAxOwogICAgICAgICAgICAgIHZhciBzID0gMjU2ICogR2FtZS5CaWdDb29raWVTaXplOwogICAgICAgICAgICAgIHZhciB4ID0gR2FtZS5jb29raWVPcmlnaW5YOwogICAgICAgICAgICAgIHZhciB5ID0gR2FtZS5jb29raWVPcmlnaW5ZOwogICAgICAgICAgICAgIGN0eC5zYXZlKCk7CiAgICAgICAgICAgICAgaWYgKEdhbWUucHJlZnMuZmFuY3kpCiAgICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKAogICAgICAgICAgICAgICAgICBQaWMoImNvb2tpZVNoYWRvdy5wbmciKSwKICAgICAgICAgICAgICAgICAgeCAtIHMgLyAyLAogICAgICAgICAgICAgICAgICB5IC0gcyAvIDIgKyAyMCwKICAgICAgICAgICAgICAgICAgcywKICAgICAgICAgICAgICAgICAgcwogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICBjdHgudHJhbnNsYXRlKHgsIHkpOwogICAgICAgICAgICAgIGlmIChHYW1lLnNlYXNvbiA9PSAiZWFzdGVyIikgewogICAgICAgICAgICAgICAgdmFyIG5lc3RXID0gMzA0ICogMC45OCAqIEdhbWUuQmlnQ29va2llU2l6ZTsKICAgICAgICAgICAgICAgIHZhciBuZXN0SCA9IDE2MSAqIDAuOTggKiBHYW1lLkJpZ0Nvb2tpZVNpemU7CiAgICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKAogICAgICAgICAgICAgICAgICBQaWMoIm5lc3QucG5nIiksCiAgICAgICAgICAgICAgICAgIC1uZXN0VyAvIDIsCiAgICAgICAgICAgICAgICAgIC1uZXN0SCAvIDIgKyAxMzAsCiAgICAgICAgICAgICAgICAgIG5lc3RXLAogICAgICAgICAgICAgICAgICBuZXN0SAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgLy9jdHgucm90YXRlKCgoR2FtZS5zdGFydERhdGUlMzYwKS8zNjApKk1hdGguUEkqMik7CiAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShQaWMoInBlcmZlY3RDb29raWUucG5nIiksIC1zIC8gMiwgLXMgLyAyLCBzLCBzKTsKCiAgICAgICAgICAgICAgaWYgKGdvb2RCdWZmICYmIEdhbWUucHJlZnMucGFydGljbGVzKSB7CiAgICAgICAgICAgICAgICAvL3NwYXJrbGUKICAgICAgICAgICAgICAgIGN0eC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb24gPSAibGlnaHRlciI7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDE7IGkrKykgewogICAgICAgICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSBNYXRoLnJhbmRvbSgpICogMC42NSArIDAuMTsKICAgICAgICAgICAgICAgICAgdmFyIHNpemUgPSBNYXRoLnJhbmRvbSgpICogMzAgKyA1OwogICAgICAgICAgICAgICAgICB2YXIgYSA9IE1hdGgucmFuZG9tKCkgKiBNYXRoLlBJICogMjsKICAgICAgICAgICAgICAgICAgdmFyIGQgPSAocyAqIDAuOSAqIE1hdGgucmFuZG9tKCkpIC8gMjsKICAgICAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZSgKICAgICAgICAgICAgICAgICAgICBQaWMoImdsaW50LmpwZyIpLAogICAgICAgICAgICAgICAgICAgIC1zaXplIC8gMiArIE1hdGguc2luKGEpICogZCwKICAgICAgICAgICAgICAgICAgICAtc2l6ZSAvIDIgKyBNYXRoLmNvcyhhKSAqIGQsCiAgICAgICAgICAgICAgICAgICAgc2l6ZSwKICAgICAgICAgICAgICAgICAgICBzaXplCiAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjdHgucmVzdG9yZSgpOwogICAgICAgICAgICAgIFRpbWVyLnRyYWNrKCJiaWcgY29va2llIik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gLy9ubyBwYXJ0aWNsZXMKICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAvL2JpZyBjb29raWUgc2hpbmUKICAgICAgICAgICAgdmFyIHMgPSA1MTI7CiAgICAgICAgICAgIHZhciB4ID0gR2FtZS5jb29raWVPcmlnaW5YIC0gcyAvIDI7CiAgICAgICAgICAgIHZhciB5ID0gR2FtZS5jb29raWVPcmlnaW5ZIC0gcyAvIDI7CiAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDAuNTsKICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShQaWMoInNoaW5lLnBuZyIpLCB4LCB5LCBzLCBzKTsKCiAgICAgICAgICAgIGlmIChzaG93RHJhZ29uKSB7CiAgICAgICAgICAgICAgLy9iaWcgZHJhZ29uCiAgICAgICAgICAgICAgdmFyIHMgPSAzMDAgKiAyICogKDEgKyBNYXRoLnNpbihHYW1lLlQgKiAwLjAxMykgKiAwLjEpOwogICAgICAgICAgICAgIHZhciB4ID0gR2FtZS5jb29raWVPcmlnaW5YIC0gcyAvIDI7CiAgICAgICAgICAgICAgdmFyIHkgPQogICAgICAgICAgICAgICAgR2FtZS5jb29raWVPcmlnaW5ZIC0gcyAvICgxLjQgKyAwLjIgKiBNYXRoLnNpbihHYW1lLlQgKiAwLjAxKSk7CiAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShQaWMoImRyYWdvbkJHLnBuZyIpLCB4LCB5LCBzLCBzKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy9iaWcgY29va2llCiAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDE7CiAgICAgICAgICAgIHZhciBzID0gMjU2ICogR2FtZS5CaWdDb29raWVTaXplOwogICAgICAgICAgICB2YXIgeCA9IEdhbWUuY29va2llT3JpZ2luWCAtIHMgLyAyOwogICAgICAgICAgICB2YXIgeSA9IEdhbWUuY29va2llT3JpZ2luWSAtIHMgLyAyOwogICAgICAgICAgICBpZiAoR2FtZS5wcmVmcy5mYW5jeSkKICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKFBpYygiY29va2llU2hhZG93LnBuZyIpLCB4LCB5ICsgMjAsIHMsIHMpOwogICAgICAgICAgICBjdHguZHJhd0ltYWdlKFBpYygicGVyZmVjdENvb2tpZS5wbmciKSwgeCwgeSwgcywgcyk7CiAgICAgICAgICB9CgogICAgICAgICAgLy9jdXJzb3JzCiAgICAgICAgICBpZiAoR2FtZS5wcmVmcy5jdXJzb3JzKSB7CiAgICAgICAgICAgIGN0eC5zYXZlKCk7CiAgICAgICAgICAgIGN0eC50cmFuc2xhdGUoR2FtZS5jb29raWVPcmlnaW5YLCBHYW1lLmNvb2tpZU9yaWdpblkpOwogICAgICAgICAgICB2YXIgcGljID0gUGljKCJjdXJzb3IucG5nIik7CiAgICAgICAgICAgIHZhciBmYW5jeSA9IEdhbWUucHJlZnMuZmFuY3k7CgogICAgICAgICAgICBpZiAoc2hvd0RyYWdvbikgY3R4Lmdsb2JhbEFscGhhID0gMC4yNTsKICAgICAgICAgICAgdmFyIGFtb3VudCA9IEdhbWUuT2JqZWN0c1siQ3Vyc29yIl0uYW1vdW50OwogICAgICAgICAgICAvL3ZhciBzcGU9LTE7CiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYW1vdW50OyBpKyspIHsKICAgICAgICAgICAgICB2YXIgbiA9IE1hdGguZmxvb3IoaSAvIDUwKTsKICAgICAgICAgICAgICAvL3ZhciBhPSgoaSswLjUqbiklNTApLzUwOwogICAgICAgICAgICAgIHZhciB3ID0gMDsKICAgICAgICAgICAgICBpZiAoZmFuY3kpCiAgICAgICAgICAgICAgICB3ID0gTWF0aC5zaW4oCiAgICAgICAgICAgICAgICAgIEdhbWUuVCAqIDAuMDI1ICsgKCgoaSArIG4gKiAxMikgJSAyNSkgLyAyNSkgKiBNYXRoLlBJICogMgogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICBpZiAodyA+IDAuOTk3KSB3ID0gMS41OwogICAgICAgICAgICAgIGVsc2UgaWYgKHcgPiAwLjk5NCkgdyA9IDAuNTsKICAgICAgICAgICAgICBlbHNlIHcgPSAwOwogICAgICAgICAgICAgIHcgKj0gLTQ7CiAgICAgICAgICAgICAgaWYgKGZhbmN5KSB3ICs9IE1hdGguc2luKCgobiArIEdhbWUuVCAqIDAuMDEpICogTWF0aC5QSSkgLyAyKSAqIDQ7CiAgICAgICAgICAgICAgdmFyIHggPSAwOwogICAgICAgICAgICAgIHZhciB5ID0gMTQwIC8qICpHYW1lLkJpZ0Nvb2tpZVNpemUqLyArIG4gKiAxNiArIHcgLSAxNjsKCiAgICAgICAgICAgICAgdmFyIHJvdCA9IDcuMjsgLy8oMS81MCkqMzYwCiAgICAgICAgICAgICAgaWYgKGkgPT0gMCAmJiBmYW5jeSkgcm90IC09IEdhbWUuVCAqIDAuMTsKICAgICAgICAgICAgICBpZiAoaSAlIDUwID09IDApIHJvdCArPSA3LjIgLyAyOwogICAgICAgICAgICAgIGN0eC5yb3RhdGUoKHJvdCAvIDM2MCkgKiBNYXRoLlBJICogMik7CiAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShwaWMsIDAsIDAsIDMyLCAzMiwgeCwgeSwgMzIsIDMyKTsKICAgICAgICAgICAgICAvL2N0eC5kcmF3SW1hZ2UocGljLDMyKihpPT1zcGUpLDAsMzIsMzIseCx5LDMyLDMyKTsKCiAgICAgICAgICAgICAgLyppZiAoaT09c3BlKQoJCQkJCQkJewoJCQkJCQkJCXkrPTE2OwoJCQkJCQkJCXg9R2FtZS5jb29raWVPcmlnaW5YK01hdGguc2luKC0oKHItNSkvMzYwKSpNYXRoLlBJKjIpKnk7CgkJCQkJCQkJeT1HYW1lLmNvb2tpZU9yaWdpblkrTWF0aC5jb3MoLSgoci01KS8zNjApKk1hdGguUEkqMikqeTsKCQkJCQkJCQlpZiAoR2FtZS5DYW5DbGljayAmJiBjdHggJiYgTWF0aC5hYnMoR2FtZS5tb3VzZVgteCk8MTYgJiYgTWF0aC5hYnMoR2FtZS5tb3VzZVkteSk8MTYpIEdhbWUubW91c2VQb2ludGVyPTE7CgkJCQkJCQl9Ki8KICAgICAgICAgICAgfQogICAgICAgICAgICBjdHgucmVzdG9yZSgpOwogICAgICAgICAgICBUaW1lci50cmFjaygiY3Vyc29ycyIpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB2YXIgdEJhc2UgPSBNYXRoLm1heCgKICAgICAgICAgICAgMCwKICAgICAgICAgICAgKEdhbWUuQXNjZW5kVGltZXIgLSBHYW1lLkFzY2VuZEJyZWFrcG9pbnQpIC8KICAgICAgICAgICAgICAoR2FtZS5Bc2NlbmREdXJhdGlvbiAtIEdhbWUuQXNjZW5kQnJlYWtwb2ludCkKICAgICAgICAgICk7CiAgICAgICAgICAvL2JpZyBjcnVtYmxpbmcgY29va2llCiAgICAgICAgICAvL3ZhciB0PSgzKk1hdGgucG93KHRCYXNlLDIpLTIqTWF0aC5wb3codEJhc2UsMykpOy8vUyBjdXJ2ZQogICAgICAgICAgdmFyIHQgPSBNYXRoLnBvdyh0QmFzZSwgMC41KTsKCiAgICAgICAgICB2YXIgc2hha2UgPSAwOwogICAgICAgICAgaWYgKEdhbWUuQXNjZW5kVGltZXIgPCBHYW1lLkFzY2VuZEJyZWFrcG9pbnQpIHsKICAgICAgICAgICAgc2hha2UgPSBHYW1lLkFzY2VuZFRpbWVyIC8gR2FtZS5Bc2NlbmRCcmVha3BvaW50OwogICAgICAgICAgfQogICAgICAgICAgLy9lbHNlIHtzaGFrZT0xLXQ7fQoKICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDE7CgogICAgICAgICAgdmFyIHggPSBHYW1lLmNvb2tpZU9yaWdpblg7CiAgICAgICAgICB2YXIgeSA9IEdhbWUuY29va2llT3JpZ2luWTsKCiAgICAgICAgICB4ICs9IChNYXRoLnJhbmRvbSgpICogMiAtIDEpICogMTAgKiBzaGFrZTsKICAgICAgICAgIHkgKz0gKE1hdGgucmFuZG9tKCkgKiAyIC0gMSkgKiAxMCAqIHNoYWtlOwoKICAgICAgICAgIHZhciBzID0gMTsKICAgICAgICAgIGlmICh0QmFzZSA+IDApIHsKICAgICAgICAgICAgY3R4LnNhdmUoKTsKICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMSAtIE1hdGgucG93KHQsIDAuNSk7CiAgICAgICAgICAgIGN0eC50cmFuc2xhdGUoeCwgeSk7CiAgICAgICAgICAgIGN0eC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb24gPSAibGlnaHRlciI7CiAgICAgICAgICAgIGN0eC5yb3RhdGUoR2FtZS5UICogMC4wMDcpOwogICAgICAgICAgICBzID0gMC41ICsgTWF0aC5wb3codEJhc2UsIDAuNikgKiAxOwogICAgICAgICAgICB2YXIgczIgPSA2MDAgKiBzOwogICAgICAgICAgICBjdHguZHJhd0ltYWdlKFBpYygiaGVhdmVuUmluZzEuanBnIiksIC1zMiAvIDIsIC1zMiAvIDIsIHMyLCBzMik7CiAgICAgICAgICAgIGN0eC5yb3RhdGUoLUdhbWUuVCAqIDAuMDAyKTsKICAgICAgICAgICAgcyA9IDAuNSArIE1hdGgucG93KDEgLSB0QmFzZSwgMC40KSAqIDE7CiAgICAgICAgICAgIHMyID0gNjAwICogczsKICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShQaWMoImhlYXZlblJpbmcyLmpwZyIpLCAtczIgLyAyLCAtczIgLyAyLCBzMiwgczIpOwogICAgICAgICAgICBjdHgucmVzdG9yZSgpOwogICAgICAgICAgfQoKICAgICAgICAgIHMgPSAyNTY7IC8vKkdhbWUuQmlnQ29va2llU2l6ZTsKCiAgICAgICAgICBjdHguc2F2ZSgpOwogICAgICAgICAgY3R4LnRyYW5zbGF0ZSh4LCB5KTsKICAgICAgICAgIGN0eC5yb3RhdGUodCAqIC0wLjEgKiBNYXRoLlBJICogMik7CgogICAgICAgICAgdmFyIGNodW5rcyA9IHsKICAgICAgICAgICAgMDogNywKICAgICAgICAgICAgMTogNiwKICAgICAgICAgICAgMjogMywKICAgICAgICAgICAgMzogMiwKICAgICAgICAgICAgNDogOCwKICAgICAgICAgICAgNTogMSwKICAgICAgICAgICAgNjogOSwKICAgICAgICAgICAgNzogNSwKICAgICAgICAgICAgODogMCwKICAgICAgICAgICAgOTogNCwKICAgICAgICAgIH07CiAgICAgICAgICBzICo9IHQgLyAyICsgMTsKICAgICAgICAgIC8qY3R4Lmdsb2JhbEFscGhhPSgxLXQpKjAuMzM7CgkJCQkJZm9yICh2YXIgaT0wO2k8MTA7aSsrKQoJCQkJCXsKCQkJCQkJdmFyIGQ9KHQtMC4yKSooODArKChpKzIpJTMpKjQwKTsKCQkJCQkJY3R4LmRyYXdJbWFnZShQaWMoJ2Jyb2tlbkNvb2tpZS5wbmcnKSwyNTYqKGNodW5rc1tpXSksMCwyNTYsMjU2LC1zLzIrTWF0aC5zaW4oLSgoKGNodW5rc1tpXSs0KSUxMCkvMTApKk1hdGguUEkqMikqZCwtcy8yK01hdGguY29zKC0oKChjaHVua3NbaV0rNCklMTApLzEwKSpNYXRoLlBJKjIpKmQscyxzKTsKCQkJCQl9CgkJCQkJY3R4Lmdsb2JhbEFscGhhPSgxLXQpKjAuNjY7CgkJCQkJZm9yICh2YXIgaT0wO2k8MTA7aSsrKQoJCQkJCXsKCQkJCQkJdmFyIGQ9KHQtMC4xKSooODArKChpKzIpJTMpKjQwKTsKCQkJCQkJY3R4LmRyYXdJbWFnZShQaWMoJ2Jyb2tlbkNvb2tpZS5wbmcnKSwyNTYqKGNodW5rc1tpXSksMCwyNTYsMjU2LC1zLzIrTWF0aC5zaW4oLSgoKGNodW5rc1tpXSs0KSUxMCkvMTApKk1hdGguUEkqMikqZCwtcy8yK01hdGguY29zKC0oKChjaHVua3NbaV0rNCklMTApLzEwKSpNYXRoLlBJKjIpKmQscyxzKTsKCQkJCQl9Ki8KICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDEgLSB0OwogICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxMDsgaSsrKSB7CiAgICAgICAgICAgIHZhciBkID0gdCAqICg4MCArICgoaSArIDIpICUgMykgKiA0MCk7CiAgICAgICAgICAgIHZhciB4MiA9IChNYXRoLnJhbmRvbSgpICogMiAtIDEpICogNSAqIHNoYWtlOwogICAgICAgICAgICB2YXIgeTIgPSAoTWF0aC5yYW5kb20oKSAqIDIgLSAxKSAqIDUgKiBzaGFrZTsKICAgICAgICAgICAgY3R4LmRyYXdJbWFnZSgKICAgICAgICAgICAgICBQaWMoImJyb2tlbkNvb2tpZS5wbmciKSwKICAgICAgICAgICAgICAyNTYgKiBjaHVua3NbaV0sCiAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAyNTYsCiAgICAgICAgICAgICAgMjU2LAogICAgICAgICAgICAgIC1zIC8gMiArCiAgICAgICAgICAgICAgICBNYXRoLnNpbigtKCgoY2h1bmtzW2ldICsgNCkgJSAxMCkgLyAxMCkgKiBNYXRoLlBJICogMikgKiBkICsKICAgICAgICAgICAgICAgIHgyLAogICAgICAgICAgICAgIC1zIC8gMiArCiAgICAgICAgICAgICAgICBNYXRoLmNvcygtKCgoY2h1bmtzW2ldICsgNCkgJSAxMCkgLyAxMCkgKiBNYXRoLlBJICogMikgKiBkICsKICAgICAgICAgICAgICAgIHkyLAogICAgICAgICAgICAgIHMsCiAgICAgICAgICAgICAgcwogICAgICAgICAgICApOwogICAgICAgICAgfQogICAgICAgICAgdmFyIGJyb2tlbkhhbG8gPSAxIC0gTWF0aC5taW4odCAvICgxIC8gMyksIDEgLyAzKSAqIDM7CiAgICAgICAgICBpZiAoR2FtZS5Bc2NlbmRUaW1lciA8IEdhbWUuQXNjZW5kQnJlYWtwb2ludCkKICAgICAgICAgICAgYnJva2VuSGFsbyA9IEdhbWUuQXNjZW5kVGltZXIgLyBHYW1lLkFzY2VuZEJyZWFrcG9pbnQ7CiAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSBicm9rZW5IYWxvOwogICAgICAgICAgY3R4LmRyYXdJbWFnZSgKICAgICAgICAgICAgUGljKCJicm9rZW5Db29raWVIYWxvLnBuZyIpLAogICAgICAgICAgICAtcyAvIDEuMzMzMywKICAgICAgICAgICAgLXMgLyAxLjMzMzMsCiAgICAgICAgICAgIHMgKiAxLjUsCiAgICAgICAgICAgIHMgKiAxLjUKICAgICAgICAgICk7CgogICAgICAgICAgY3R4LnJlc3RvcmUoKTsKCiAgICAgICAgICAvL2ZsYXJlcwogICAgICAgICAgdmFyIG4gPSA5OwogICAgICAgICAgdmFyIHQgPSBHYW1lLkFzY2VuZFRpbWVyIC8gR2FtZS5Bc2NlbmRCcmVha3BvaW50OwogICAgICAgICAgaWYgKEdhbWUuQXNjZW5kVGltZXIgPCBHYW1lLkFzY2VuZEJyZWFrcG9pbnQpIHsKICAgICAgICAgICAgY3R4LnNhdmUoKTsKICAgICAgICAgICAgY3R4LnRyYW5zbGF0ZSh4LCB5KTsKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgICAgICAgICAgICBpZiAoTWF0aC5mbG9vcigodCAvIDMpICogbiAqIDMgKyBpICogMi43KSAlIDIpIHsKICAgICAgICAgICAgICAgIHZhciB0MiA9IE1hdGgucG93KCgodCAvIDMpICogbiAqIDMgKyBpICogMi43KSAlIDEsIDEuNSk7CiAgICAgICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAoMSAtIHQpICogKEdhbWUuZHJhd1QgJSAyID09IDAgPyAwLjUgOiAxKTsKICAgICAgICAgICAgICAgIHZhciBzdyA9ICgxIC0gdDIgKiAwLjUpICogOTY7CiAgICAgICAgICAgICAgICB2YXIgc2ggPSAoMC41ICsgdDIgKiAxLjUpICogOTY7CiAgICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKAogICAgICAgICAgICAgICAgICBQaWMoInNoaW5lU3Bva2UucG5nIiksCiAgICAgICAgICAgICAgICAgIC1zdyAvIDIsCiAgICAgICAgICAgICAgICAgIC1zaCAtIDMyIC0gKDEgLSB0MikgKiAyNTYsCiAgICAgICAgICAgICAgICAgIHN3LAogICAgICAgICAgICAgICAgICBzaAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgY3R4LnJvdGF0ZSgoTWF0aC5QSSAqIDIpIC8gbik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTsKICAgICAgICAgIH0KCiAgICAgICAgICAvL2ZsYXNoIGF0IGJyZWFrcG9pbnQKICAgICAgICAgIGlmICh0QmFzZSA8IDAuMSAmJiB0QmFzZSA+IDApIHsKICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMSAtIHRCYXNlIC8gMC4xOwogICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gIiNmZmYiOwogICAgICAgICAgICBjdHguZmlsbFJlY3QoMCwgMCwgY3R4LmNhbnZhcy53aWR0aCwgY3R4LmNhbnZhcy5oZWlnaHQpOwogICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAxOwogICAgICAgICAgfQogICAgICAgICAgaWYgKHRCYXNlID4gMC44KSB7CiAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9ICh0QmFzZSAtIDAuOCkgLyAwLjI7CiAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSAiIzAwMCI7CiAgICAgICAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCBjdHguY2FudmFzLndpZHRoLCBjdHguY2FudmFzLmhlaWdodCk7CiAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDE7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvL21pbGsgYW5kIG1pbGsgYWNjZXNzb3JpZXMKICAgICAgICBpZiAoR2FtZS5wcmVmcy5taWxrKSB7CiAgICAgICAgICB2YXIgd2lkdGggPSBjdHguY2FudmFzLndpZHRoOwogICAgICAgICAgdmFyIGhlaWdodCA9IGN0eC5jYW52YXMuaGVpZ2h0OwogICAgICAgICAgdmFyIHggPSBNYXRoLmZsb29yKAogICAgICAgICAgICAoR2FtZS5UICogMiAtIChHYW1lLm1pbGtIIC0gR2FtZS5taWxrSGQpICogMjAwMCArIDQ4MCAqIDIpICUgNDgwCiAgICAgICAgICApOyAvL01hdGguZmxvb3IoKEdhbWUuVCoyK01hdGguc2luKEdhbWUuVCowLjEpKjIrTWF0aC5zaW4oR2FtZS5UKjAuMDMpKjItKEdhbWUubWlsa0gtR2FtZS5taWxrSGQpKjIwMDArNDgwKjIpJTQ4MCk7CiAgICAgICAgICB2YXIgeSA9IEdhbWUubWlsa0hkICogaGVpZ2h0OyAvLygoKEdhbWUubWlsa0hkKSpjdHguY2FudmFzLmhlaWdodCkqKDErMC4wNSooTWF0aC5zaW4oR2FtZS5UKjAuMDE3KS8yKzAuNSkpKTsKICAgICAgICAgIHZhciBhID0gMTsKICAgICAgICAgIGlmIChHYW1lLkFzY2VuZFRpbWVyID4gMCkgewogICAgICAgICAgICB5ICo9IDEgLSBNYXRoLnBvdyhHYW1lLkFzY2VuZFRpbWVyIC8gR2FtZS5Bc2NlbmRCcmVha3BvaW50LCAyKSAqIDI7CiAgICAgICAgICAgIGEgKj0gMSAtIE1hdGgucG93KEdhbWUuQXNjZW5kVGltZXIgLyBHYW1lLkFzY2VuZEJyZWFrcG9pbnQsIDIpICogMjsKICAgICAgICAgIH0gZWxzZSBpZiAoR2FtZS5SZWluY2FybmF0ZVRpbWVyID4gMCkgewogICAgICAgICAgICB5ICo9CiAgICAgICAgICAgICAgMSAtCiAgICAgICAgICAgICAgTWF0aC5wb3coCiAgICAgICAgICAgICAgICAxIC0gR2FtZS5SZWluY2FybmF0ZVRpbWVyIC8gR2FtZS5SZWluY2FybmF0ZUR1cmF0aW9uLAogICAgICAgICAgICAgICAgMgogICAgICAgICAgICAgICkgKgogICAgICAgICAgICAgICAgMjsKICAgICAgICAgICAgYSAqPQogICAgICAgICAgICAgIDEgLQogICAgICAgICAgICAgIE1hdGgucG93KAogICAgICAgICAgICAgICAgMSAtIEdhbWUuUmVpbmNhcm5hdGVUaW1lciAvIEdhbWUuUmVpbmNhcm5hdGVEdXJhdGlvbiwKICAgICAgICAgICAgICAgIDIKICAgICAgICAgICAgICApICoKICAgICAgICAgICAgICAgIDI7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKEdhbWUuVE9ZUykgewogICAgICAgICAgICAvL2dvbGx5CiAgICAgICAgICAgIGlmICghR2FtZS5Ub3kpIHsKICAgICAgICAgICAgICBHYW1lLnRveXMgPSBbXTsKICAgICAgICAgICAgICBHYW1lLnRveXNUeXBlID0gY2hvb3NlKFsxLCAyXSk7CiAgICAgICAgICAgICAgR2FtZS5Ub3kgPSBmdW5jdGlvbiAoeCwgeSkgewogICAgICAgICAgICAgICAgdGhpcy5pZCA9IEdhbWUudG95cy5sZW5ndGg7CiAgICAgICAgICAgICAgICB0aGlzLnggPSB4OwogICAgICAgICAgICAgICAgdGhpcy55ID0geTsKICAgICAgICAgICAgICAgIHRoaXMueGQgPSBNYXRoLnJhbmRvbSgpICogMTAgLSA1OwogICAgICAgICAgICAgICAgdGhpcy55ZCA9IE1hdGgucmFuZG9tKCkgKiAxMCAtIDU7CiAgICAgICAgICAgICAgICB0aGlzLnIgPSBNYXRoLnJhbmRvbSgpICogTWF0aC5QSSAqIDI7CiAgICAgICAgICAgICAgICB0aGlzLnJkID0gTWF0aC5yYW5kb20oKSAqIDAuMSAtIDAuMDU7CiAgICAgICAgICAgICAgICB2YXIgdiA9IE1hdGgucmFuZG9tKCk7CiAgICAgICAgICAgICAgICB2YXIgYSA9IDAuNTsKICAgICAgICAgICAgICAgIHZhciBiID0gMC41OwogICAgICAgICAgICAgICAgaWYgKHYgPD0gYSkgdiA9IGIgLSBiICogTWF0aC5wb3coMSAtIHYgLyBhLCAzKTsKICAgICAgICAgICAgICAgIGVsc2UgdiA9IGIgKyAoMSAtIGIpICogTWF0aC5wb3coKHYgLSBhKSAvICgxIC0gYSksIDMpOwogICAgICAgICAgICAgICAgdGhpcy5zID0gKEdhbWUudG95c1R5cGUgPT0gMSA/IDY0IDogNDgpICogKDAuMSArIHYgKiAxLjkpOwogICAgICAgICAgICAgICAgaWYgKEdhbWUudG95c1R5cGUgPT0gMikgdGhpcy5zID0gdGhpcy5pZCAlIDEwID09IDEgPyA5NiA6IDQ4OwogICAgICAgICAgICAgICAgdGhpcy5zdCA9IHRoaXMuczsKICAgICAgICAgICAgICAgIHRoaXMucyA9IDA7CiAgICAgICAgICAgICAgICB2YXIgY29va2llcyA9IFtbMTAsIDBdXTsKICAgICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5VcGdyYWRlcykgewogICAgICAgICAgICAgICAgICB2YXIgY29va2llID0gR2FtZS5VcGdyYWRlc1tpXTsKICAgICAgICAgICAgICAgICAgaWYgKGNvb2tpZS5ib3VnaHQgPiAwICYmIGNvb2tpZS5wb29sID09ICJjb29raWUiKQogICAgICAgICAgICAgICAgICAgIGNvb2tpZXMucHVzaChjb29raWUuaWNvbik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0aGlzLmljb24gPSBjaG9vc2UoY29va2llcyk7CiAgICAgICAgICAgICAgICB0aGlzLmRyYWdnZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHRoaXMubCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICAgICAgICAgICAgdGhpcy5sLmlubmVySFRNTCA9IHRoaXMuaWQ7CiAgICAgICAgICAgICAgICB0aGlzLmwuc3R5bGUuY3NzVGV4dCA9CiAgICAgICAgICAgICAgICAgICJjdXJzb3I6cG9pbnRlcjtib3JkZXItcmFkaXVzOiIgKwogICAgICAgICAgICAgICAgICB0aGlzLnMgLyAyICsKICAgICAgICAgICAgICAgICAgInB4O29wYWNpdHk6MDt3aWR0aDoiICsKICAgICAgICAgICAgICAgICAgdGhpcy5zICsKICAgICAgICAgICAgICAgICAgInB4O2hlaWdodDoiICsKICAgICAgICAgICAgICAgICAgdGhpcy5zICsKICAgICAgICAgICAgICAgICAgInB4O2JhY2tncm91bmQ6Izk5OTtwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OjBweDt0b3A6MHB4O3otaW5kZXg6MTAwMDAwMDA7dHJhbnNmb3JtOnRyYW5zbGF0ZSgtMTAwMHB4LC0xMDAwcHgpOyI7CiAgICAgICAgICAgICAgICBsKCJzZWN0aW9uTGVmdCIpLmFwcGVuZENoaWxkKHRoaXMubCk7CiAgICAgICAgICAgICAgICBBZGRFdmVudCgKICAgICAgICAgICAgICAgICAgdGhpcy5sLAogICAgICAgICAgICAgICAgICAibW91c2Vkb3duIiwKICAgICAgICAgICAgICAgICAgKGZ1bmN0aW9uICh3aGF0KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgIHdoYXQuZHJhZ2dlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgfSkodGhpcykKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICBBZGRFdmVudCgKICAgICAgICAgICAgICAgICAgdGhpcy5sLAogICAgICAgICAgICAgICAgICAibW91c2V1cCIsCiAgICAgICAgICAgICAgICAgIChmdW5jdGlvbiAod2hhdCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICB3aGF0LmRyYWdnZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICB9KSh0aGlzKQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIEdhbWUudG95cy5wdXNoKHRoaXMpOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBmb3IgKAogICAgICAgICAgICAgICAgdmFyIGkgPSAwOwogICAgICAgICAgICAgICAgaSA8CiAgICAgICAgICAgICAgICBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxNSArIChHYW1lLnRveXNUeXBlID09IDEgPyA1IDogMzApKTsKICAgICAgICAgICAgICAgIGkrKwogICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgbmV3IEdhbWUuVG95KAogICAgICAgICAgICAgICAgICBNYXRoLnJhbmRvbSgpICogd2lkdGgsCiAgICAgICAgICAgICAgICAgIE1hdGgucmFuZG9tKCkgKiBoZWlnaHQgKiAwLjMKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDAuNTsKICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLnRveXMpIHsKICAgICAgICAgICAgICB2YXIgbWUgPSBHYW1lLnRveXNbaV07CiAgICAgICAgICAgICAgY3R4LnNhdmUoKTsKICAgICAgICAgICAgICBjdHgudHJhbnNsYXRlKG1lLngsIG1lLnkpOwogICAgICAgICAgICAgIGN0eC5yb3RhdGUobWUucik7CiAgICAgICAgICAgICAgaWYgKEdhbWUudG95c1R5cGUgPT0gMSkKICAgICAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoCiAgICAgICAgICAgICAgICAgIFBpYygic21hbGxDb29raWVzLnBuZyIpLAogICAgICAgICAgICAgICAgICAobWUuaWQgJSA4KSAqIDY0LAogICAgICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgICAgICA2NCwKICAgICAgICAgICAgICAgICAgNjQsCiAgICAgICAgICAgICAgICAgIC1tZS5zIC8gMiwKICAgICAgICAgICAgICAgICAgLW1lLnMgLyAyLAogICAgICAgICAgICAgICAgICBtZS5zLAogICAgICAgICAgICAgICAgICBtZS5zCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoCiAgICAgICAgICAgICAgICAgIFBpYygiaWNvbnMucG5nIiksCiAgICAgICAgICAgICAgICAgIG1lLmljb25bMF0gKiA0OCwKICAgICAgICAgICAgICAgICAgbWUuaWNvblsxXSAqIDQ4LAogICAgICAgICAgICAgICAgICA0OCwKICAgICAgICAgICAgICAgICAgNDgsCiAgICAgICAgICAgICAgICAgIC1tZS5zIC8gMiwKICAgICAgICAgICAgICAgICAgLW1lLnMgLyAyLAogICAgICAgICAgICAgICAgICBtZS5zLAogICAgICAgICAgICAgICAgICBtZS5zCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMTsKICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLnRveXMpIHsKICAgICAgICAgICAgICB2YXIgbWUgPSBHYW1lLnRveXNbaV07CiAgICAgICAgICAgICAgLy9wc3N0Li4uIG5vdCByZWFsIHBoeXNpY3MKICAgICAgICAgICAgICBmb3IgKHZhciBpaSBpbiBHYW1lLnRveXMpIHsKICAgICAgICAgICAgICAgIHZhciBpdCA9IEdhbWUudG95c1tpaV07CiAgICAgICAgICAgICAgICBpZiAoaXQuaWQgIT0gbWUuaWQpIHsKICAgICAgICAgICAgICAgICAgdmFyIHgxID0gbWUueCArIG1lLnhkOwogICAgICAgICAgICAgICAgICB2YXIgeTEgPSBtZS55ICsgbWUueWQ7CiAgICAgICAgICAgICAgICAgIHZhciB4MiA9IGl0LnggKyBpdC54ZDsKICAgICAgICAgICAgICAgICAgdmFyIHkyID0gaXQueSArIGl0LnlkOwogICAgICAgICAgICAgICAgICB2YXIgZGlzdCA9CiAgICAgICAgICAgICAgICAgICAgTWF0aC5zcXJ0KE1hdGgucG93KHgxIC0geDIsIDIpICsgTWF0aC5wb3coeTEgLSB5MiwgMikpIC8KICAgICAgICAgICAgICAgICAgICAobWUucyAvIDIgKyBpdC5zIC8gMik7CiAgICAgICAgICAgICAgICAgIGlmIChkaXN0IDwgKEdhbWUudG95c1R5cGUgPT0gMSA/IDAuOTUgOiAwLjc1KSkgewogICAgICAgICAgICAgICAgICAgIHZhciBhbmdsZSA9IE1hdGguYXRhbjIoeTEgLSB5MiwgeDEgLSB4Mik7CiAgICAgICAgICAgICAgICAgICAgdmFyIHYxID0gTWF0aC5zcXJ0KE1hdGgucG93KG1lLnhkLCAyKSArIE1hdGgucG93KG1lLnlkLCAyKSk7CiAgICAgICAgICAgICAgICAgICAgdmFyIHYyID0gTWF0aC5zcXJ0KE1hdGgucG93KGl0LnhkLCAyKSArIE1hdGgucG93KGl0LnlkLCAyKSk7CiAgICAgICAgICAgICAgICAgICAgdmFyIHYgPSAoKHYxICsgdjIpIC8gMiArIGRpc3QpICogMC43NTsKICAgICAgICAgICAgICAgICAgICB2YXIgcmF0aW8gPSBpdC5zIC8gbWUuczsKICAgICAgICAgICAgICAgICAgICBtZS54ZCArPSBNYXRoLnNpbigtYW5nbGUgKyBNYXRoLlBJIC8gMikgKiB2ICogcmF0aW87CiAgICAgICAgICAgICAgICAgICAgbWUueWQgKz0gTWF0aC5jb3MoLWFuZ2xlICsgTWF0aC5QSSAvIDIpICogdiAqIHJhdGlvOwogICAgICAgICAgICAgICAgICAgIGl0LnhkICs9IE1hdGguc2luKC1hbmdsZSAtIE1hdGguUEkgLyAyKSAqIHYgKiAoMSAvIHJhdGlvKTsKICAgICAgICAgICAgICAgICAgICBpdC55ZCArPSBNYXRoLmNvcygtYW5nbGUgLSBNYXRoLlBJIC8gMikgKiB2ICogKDEgLyByYXRpbyk7CiAgICAgICAgICAgICAgICAgICAgbWUucmQgKz0gKE1hdGgucmFuZG9tKCkgKiAxIC0gMC41KSAqIDAuMSAqIHJhdGlvOwogICAgICAgICAgICAgICAgICAgIGl0LnJkICs9IChNYXRoLnJhbmRvbSgpICogMSAtIDAuNSkgKiAwLjEgKiAoMSAvIHJhdGlvKTsKICAgICAgICAgICAgICAgICAgICBtZS5yZCAqPSBNYXRoLm1pbigxLCB2KTsKICAgICAgICAgICAgICAgICAgICBpdC5yZCAqPSBNYXRoLm1pbigxLCB2KTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAobWUueSA+PSBoZWlnaHQgLSBHYW1lLm1pbGtIZCAqIGhlaWdodCArIDgpIHsKICAgICAgICAgICAgICAgIG1lLnhkICo9IDAuODU7CiAgICAgICAgICAgICAgICBtZS55ZCAqPSAwLjg1OwogICAgICAgICAgICAgICAgbWUucmQgKj0gMC44NTsKICAgICAgICAgICAgICAgIG1lLnlkIC09IDE7CiAgICAgICAgICAgICAgICBtZS54ZCArPSAoTWF0aC5yYW5kb20oKSAqIDEgLSAwLjUpICogMC4zOwogICAgICAgICAgICAgICAgbWUueWQgKz0gKE1hdGgucmFuZG9tKCkgKiAxIC0gMC41KSAqIDAuMDU7CiAgICAgICAgICAgICAgICBtZS5yZCArPSAoTWF0aC5yYW5kb20oKSAqIDEgLSAwLjUpICogMC4wMjsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbWUueGQgKj0gMC45OTsKICAgICAgICAgICAgICAgIG1lLnJkICo9IDAuOTk7CiAgICAgICAgICAgICAgICBtZS55ZCArPSAxOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBtZS55ZCAqPSBNYXRoLm1pbigKICAgICAgICAgICAgICAgIDEsCiAgICAgICAgICAgICAgICBNYXRoLmFicyhtZS55IC0gKGhlaWdodCAtIEdhbWUubWlsa0hkICogaGVpZ2h0KSAvIDE2KQogICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgbWUucmQgKz0gKG1lLnhkICogMC4wMSkgLyAobWUucyAvIChHYW1lLnRveXNUeXBlID09IDEgPyA2NCA6IDQ4KSk7CiAgICAgICAgICAgICAgaWYgKG1lLnggPCBtZS5zIC8gMiAmJiBtZS54ZCA8IDApCiAgICAgICAgICAgICAgICBtZS54ZCA9IE1hdGgubWF4KDAuMSwgLW1lLnhkICogMC42KTsKICAgICAgICAgICAgICBlbHNlIGlmIChtZS54IDwgbWUucyAvIDIpIHsKICAgICAgICAgICAgICAgIG1lLnhkID0gMDsKICAgICAgICAgICAgICAgIG1lLnggPSBtZS5zIC8gMjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKG1lLnggPiB3aWR0aCAtIG1lLnMgLyAyICYmIG1lLnhkID4gMCkKICAgICAgICAgICAgICAgIG1lLnhkID0gTWF0aC5taW4oLTAuMSwgLW1lLnhkICogMC42KTsKICAgICAgICAgICAgICBlbHNlIGlmIChtZS54ID4gd2lkdGggLSBtZS5zIC8gMikgewogICAgICAgICAgICAgICAgbWUueGQgPSAwOwogICAgICAgICAgICAgICAgbWUueCA9IHdpZHRoIC0gbWUucyAvIDI7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIG1lLnhkID0gTWF0aC5taW4oTWF0aC5tYXgobWUueGQsIC0zMCksIDMwKTsKICAgICAgICAgICAgICBtZS55ZCA9IE1hdGgubWluKE1hdGgubWF4KG1lLnlkLCAtMzApLCAzMCk7CiAgICAgICAgICAgICAgbWUucmQgPSBNYXRoLm1pbihNYXRoLm1heChtZS5yZCwgLTAuNSksIDAuNSk7CiAgICAgICAgICAgICAgbWUueCArPSBtZS54ZDsKICAgICAgICAgICAgICBtZS55ICs9IG1lLnlkOwogICAgICAgICAgICAgIG1lLnIgKz0gbWUucmQ7CiAgICAgICAgICAgICAgbWUuciA9IG1lLnIgJSAoTWF0aC5QSSAqIDIpOwogICAgICAgICAgICAgIG1lLnMgKz0gKG1lLnN0IC0gbWUucykgKiAwLjU7CiAgICAgICAgICAgICAgaWYgKEdhbWUudG95c1R5cGUgPT0gMiAmJiAhbWUuZHJhZ2dlZCAmJiBNYXRoLnJhbmRvbSgpIDwgMC4wMDMpCiAgICAgICAgICAgICAgICBtZS5zdCA9IGNob29zZShbNDgsIDQ4LCA0OCwgNDgsIDk2XSk7CiAgICAgICAgICAgICAgaWYgKG1lLmRyYWdnZWQpIHsKICAgICAgICAgICAgICAgIG1lLnggPSBHYW1lLm1vdXNlWDsKICAgICAgICAgICAgICAgIG1lLnkgPSBHYW1lLm1vdXNlWTsKICAgICAgICAgICAgICAgIG1lLnhkICs9ICgoR2FtZS5tb3VzZVggLSBHYW1lLm1vdXNlWDIpICogMyAtIG1lLnhkKSAqIDAuNTsKICAgICAgICAgICAgICAgIG1lLnlkICs9ICgoR2FtZS5tb3VzZVkgLSBHYW1lLm1vdXNlWTIpICogMyAtIG1lLnlkKSAqIDAuNTsKICAgICAgICAgICAgICAgIG1lLmwuc3R5bGUudHJhbnNmb3JtID0KICAgICAgICAgICAgICAgICAgInRyYW5zbGF0ZSgiICsKICAgICAgICAgICAgICAgICAgKG1lLnggLSBtZS5zIC8gMikgKwogICAgICAgICAgICAgICAgICAicHgsIiArCiAgICAgICAgICAgICAgICAgIChtZS55IC0gbWUucyAvIDIpICsKICAgICAgICAgICAgICAgICAgInB4KSBzY2FsZSg1MCkiOwogICAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAgbWUubC5zdHlsZS50cmFuc2Zvcm0gPQogICAgICAgICAgICAgICAgICAidHJhbnNsYXRlKCIgKwogICAgICAgICAgICAgICAgICAobWUueCAtIG1lLnMgLyAyKSArCiAgICAgICAgICAgICAgICAgICJweCwiICsKICAgICAgICAgICAgICAgICAgKG1lLnkgLSBtZS5zIC8gMikgKwogICAgICAgICAgICAgICAgICAicHgpIjsKICAgICAgICAgICAgICBtZS5sLnN0eWxlLndpZHRoID0gbWUucyArICJweCI7CiAgICAgICAgICAgICAgbWUubC5zdHlsZS5oZWlnaHQgPSBtZS5zICsgInB4IjsKICAgICAgICAgICAgICBjdHguc2F2ZSgpOwogICAgICAgICAgICAgIGN0eC50cmFuc2xhdGUobWUueCwgbWUueSk7CiAgICAgICAgICAgICAgY3R4LnJvdGF0ZShtZS5yKTsKICAgICAgICAgICAgICBpZiAoR2FtZS50b3lzVHlwZSA9PSAxKQogICAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZSgKICAgICAgICAgICAgICAgICAgUGljKCJzbWFsbENvb2tpZXMucG5nIiksCiAgICAgICAgICAgICAgICAgIChtZS5pZCAlIDgpICogNjQsCiAgICAgICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgICAgIDY0LAogICAgICAgICAgICAgICAgICA2NCwKICAgICAgICAgICAgICAgICAgLW1lLnMgLyAyLAogICAgICAgICAgICAgICAgICAtbWUucyAvIDIsCiAgICAgICAgICAgICAgICAgIG1lLnMsCiAgICAgICAgICAgICAgICAgIG1lLnMKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZSgKICAgICAgICAgICAgICAgICAgUGljKCJpY29ucy5wbmciKSwKICAgICAgICAgICAgICAgICAgbWUuaWNvblswXSAqIDQ4LAogICAgICAgICAgICAgICAgICBtZS5pY29uWzFdICogNDgsCiAgICAgICAgICAgICAgICAgIDQ4LAogICAgICAgICAgICAgICAgICA0OCwKICAgICAgICAgICAgICAgICAgLW1lLnMgLyAyLAogICAgICAgICAgICAgICAgICAtbWUucyAvIDIsCiAgICAgICAgICAgICAgICAgIG1lLnMsCiAgICAgICAgICAgICAgICAgIG1lLnMKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHZhciBwaWMgPSBHYW1lLk1pbGsucGljOwogICAgICAgICAgaWYgKEdhbWUubWlsa1R5cGUgIT0gMCAmJiBHYW1lLmFzY2Vuc2lvbk1vZGUgIT0gMSkKICAgICAgICAgICAgcGljID0gR2FtZS5BbGxNaWxrc1tHYW1lLm1pbGtUeXBlXS5waWM7CiAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAwLjk1ICogYTsKICAgICAgICAgIGN0eC5maWxsUGF0dGVybigKICAgICAgICAgICAgUGljKHBpYyksCiAgICAgICAgICAgIDAsCiAgICAgICAgICAgIGhlaWdodCAtIHksCiAgICAgICAgICAgIHdpZHRoICsgNDgwLAogICAgICAgICAgICAxLAogICAgICAgICAgICA0ODAsCiAgICAgICAgICAgIDQ4MCwKICAgICAgICAgICAgeCwKICAgICAgICAgICAgMAogICAgICAgICAgKTsKCiAgICAgICAgICBjdHguZmlsbFN0eWxlID0gIiMwMDAiOwogICAgICAgICAgY3R4LmZpbGxSZWN0KDAsIGhlaWdodCAtIHkgKyA0ODAsIHdpZHRoLCBNYXRoLm1heCgwLCB5IC0gNDgwKSk7CiAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAxOwoKICAgICAgICAgIFRpbWVyLnRyYWNrKCJtaWxrIik7CiAgICAgICAgfQoKICAgICAgICBpZiAoR2FtZS5Bc2NlbmRUaW1lciA+IDApIHsKICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoCiAgICAgICAgICAgIFBpYygic2hhZGVkQm9yZGVyc1NvZnQucG5nIiksCiAgICAgICAgICAgIDAsCiAgICAgICAgICAgIDAsCiAgICAgICAgICAgIGN0eC5jYW52YXMud2lkdGgsCiAgICAgICAgICAgIGN0eC5jYW52YXMuaGVpZ2h0CiAgICAgICAgICApOwogICAgICAgIH0KCiAgICAgICAgaWYgKEdhbWUuQXNjZW5kVGltZXIgPT0gMCkgewogICAgICAgICAgR2FtZS5EcmF3V3JpbmtsZXJzKCk7CiAgICAgICAgICBUaW1lci50cmFjaygid3JpbmtsZXJzIik7CiAgICAgICAgICBHYW1lLkRyYXdTcGVjaWFsKCk7CiAgICAgICAgICBUaW1lci50cmFjaygiZXZvbHZhYmxlcyIpOwoKICAgICAgICAgIEdhbWUucGFydGljbGVzRHJhdygyKTsKICAgICAgICAgIFRpbWVyLnRyYWNrKCJ0ZXh0IHBhcnRpY2xlcyIpOwoKICAgICAgICAgIC8vc2hpbnkgYm9yZGVyIGR1cmluZyBmcmVuemllcyBldGMKICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDE7CiAgICAgICAgICB2YXIgYm9yZGVycyA9ICJzaGFkZWRCb3JkZXJzU29mdC5wbmciOwogICAgICAgICAgaWYgKGdvb2RCdWZmKSBib3JkZXJzID0gInNoYWRlZEJvcmRlcnNHb2xkLnBuZyI7CiAgICAgICAgICBlbHNlIGlmIChiYWRCdWZmKSBib3JkZXJzID0gInNoYWRlZEJvcmRlcnNSZWQucG5nIjsKICAgICAgICAgIGlmIChnb29kQnVmZiAmJiBHYW1lLnByZWZzLmZhbmN5KQogICAgICAgICAgICBjdHguZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gImxpZ2h0ZXIiOwogICAgICAgICAgY3R4LmRyYXdJbWFnZSgKICAgICAgICAgICAgUGljKGJvcmRlcnMpLAogICAgICAgICAgICAwLAogICAgICAgICAgICAwLAogICAgICAgICAgICBjdHguY2FudmFzLndpZHRoLAogICAgICAgICAgICBjdHguY2FudmFzLmhlaWdodAogICAgICAgICAgKTsKICAgICAgICAgIGlmIChnb29kQnVmZiAmJiBHYW1lLnByZWZzLmZhbmN5KQogICAgICAgICAgICBjdHguZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gInNvdXJjZS1vdmVyIjsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkJSU5JVElBTElaQVRJT04gRU5EOyBHQU1FIFJFQURZIFRPIExBVU5DSAoJCT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCgogICAgR2FtZS5raWxsU2hpbW1lcnMoKTsKCiAgICAvL2Jvb29vbwogICAgR2FtZS5SdWluVGhlRnVuID0gZnVuY3Rpb24gKHNpbGVudCkgewogICAgICBHYW1lLnBvcHVwcyA9IDA7CiAgICAgIEdhbWUuU2V0QWxsVXBncmFkZXMoMSk7CiAgICAgIEdhbWUuU2V0QWxsQWNoaWV2cygxKTsKICAgICAgR2FtZS5wb3B1cHMgPSAwOwogICAgICBHYW1lLkVhcm4oOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5KTsKICAgICAgR2FtZS5NYXhTcGVjaWFscygpOwogICAgICBHYW1lLm5leHRSZXNlYXJjaCA9IDA7CiAgICAgIEdhbWUucmVzZWFyY2hUID0gLTE7CiAgICAgIEdhbWUudXBncmFkZXNUb1JlYnVpbGQgPSAxOwogICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICBHYW1lLnBvcHVwcyA9IDE7CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5PYmplY3RzW2ldOwogICAgICAgIGlmIChtZS5sZXZlbCA8IDEwKSB7CiAgICAgICAgICBtZS5sZXZlbCA9IDk7CiAgICAgICAgICBtZS5sZXZlbFVwKHRydWUpOwogICAgICAgIH0KICAgICAgICBpZiAobWUubWluaWdhbWUgJiYgbWUubWluaWdhbWUub25SdWluVGhlRnVuKSBtZS5taW5pZ2FtZS5vblJ1aW5UaGVGdW4oKTsKICAgICAgfQogICAgICBpZiAoIXNpbGVudCkgewogICAgICAgIEdhbWUuTm90aWZ5KAogICAgICAgICAgIlRob3UgZG90aCBydWluZXRoIHRoZSBmdW4hIiwKICAgICAgICAgICJZb3UncmUgZnJlZS4gRnJlZSBhdCBsYXN0LiIsCiAgICAgICAgICBbMTEsIDVdCiAgICAgICAgKTsKICAgICAgfQogICAgICByZXR1cm4gIllvdSBmZWVsIGEgYml0dGVyIHRhc3RlIGluIHlvdXIgbW91dGguLi4iOwogICAgfTsKCiAgICBHYW1lLlNldEFsbFVwZ3JhZGVzID0gZnVuY3Rpb24gKG9uKSB7CiAgICAgIEdhbWUucG9wdXBzID0gMDsKICAgICAgdmFyIGxlZnRvdXQgPSBbCiAgICAgICAgIk1hZ2ljIHNoZW5hbmlnYW5zIiwKICAgICAgICAiT2NjdWx0IG9ic3RydWN0aW9uIiwKICAgICAgICAiR2x1Y29zZS1jaGFyZ2VkIGFpciIsCiAgICAgIF07CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5VcGdyYWRlcykgewogICAgICAgIGlmICgKICAgICAgICAgIG9uICYmCiAgICAgICAgICAoR2FtZS5VcGdyYWRlc1tpXS5wb29sID09ICJ0b2dnbGUiIHx8CiAgICAgICAgICAgIGxlZnRvdXQuaW5kZXhPZihHYW1lLlVwZ3JhZGVzW2ldLm5hbWUpICE9IC0xKQogICAgICAgICkgewogICAgICAgIH0gZWxzZSBpZiAob24pIEdhbWUuVXBncmFkZXNbaV0uZWFybigpOwogICAgICAgIGVsc2UgaWYgKCFvbikgR2FtZS5VcGdyYWRlc1tpXS5sb3NlKCk7CiAgICAgIH0KICAgICAgR2FtZS51cGdyYWRlc1RvUmVidWlsZCA9IDE7CiAgICAgIEdhbWUucmVjYWxjdWxhdGVHYWlucyA9IDE7CiAgICAgIEdhbWUucG9wdXBzID0gMTsKICAgIH07CiAgICBHYW1lLlNldEFsbEFjaGlldnMgPSBmdW5jdGlvbiAob24pIHsKICAgICAgR2FtZS5wb3B1cHMgPSAwOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUuQWNoaWV2ZW1lbnRzKSB7CiAgICAgICAgaWYgKG9uICYmIEdhbWUuQWNoaWV2ZW1lbnRzW2ldLnBvb2wgIT0gImR1bmdlb24iKQogICAgICAgICAgR2FtZS5XaW4oR2FtZS5BY2hpZXZlbWVudHNbaV0ubmFtZSk7CiAgICAgICAgZWxzZSBpZiAoIW9uKSBHYW1lLlJlbW92ZUFjaGlldihHYW1lLkFjaGlldmVtZW50c1tpXS5uYW1lKTsKICAgICAgfQogICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICBHYW1lLnBvcHVwcyA9IDE7CiAgICB9OwogICAgR2FtZS5HZXRBbGxEZWJ1Z3MgPSBmdW5jdGlvbiAoKSB7CiAgICAgIEdhbWUucG9wdXBzID0gMDsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlVwZ3JhZGVzKSB7CiAgICAgICAgaWYgKEdhbWUuVXBncmFkZXNbaV0ucG9vbCA9PSAiZGVidWciKSBHYW1lLlVwZ3JhZGVzW2ldLmVhcm4oKTsKICAgICAgfQogICAgICBHYW1lLnVwZ3JhZGVzVG9SZWJ1aWxkID0gMTsKICAgICAgR2FtZS5yZWNhbGN1bGF0ZUdhaW5zID0gMTsKICAgICAgR2FtZS5wb3B1cHMgPSAxOwogICAgfTsKICAgIEdhbWUuTWF4U3BlY2lhbHMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIEdhbWUuZHJhZ29uTGV2ZWwgPSBHYW1lLmRyYWdvbkxldmVscy5sZW5ndGggLSAxOwogICAgICBHYW1lLnNhbnRhTGV2ZWwgPSBHYW1lLnNhbnRhTGV2ZWxzLmxlbmd0aCAtIDE7CiAgICB9OwoKICAgIEdhbWUuU2VzYW1lUmVzZXQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBuYW1lID0gR2FtZS5iYWtlcnlOYW1lOwogICAgICBHYW1lLkhhcmRSZXNldCgyKTsKICAgICAgR2FtZS5iYWtlcnlOYW1lID0gbmFtZTsKICAgICAgR2FtZS5iYWtlcnlOYW1lUmVmcmVzaCgpOwogICAgICBHYW1lLkFjaGlldmVtZW50c1siQ2hlYXRlZCBjb29raWVzIHRhc3RlIGF3ZnVsIl0ud29uID0gMTsKICAgIH07CgogICAgR2FtZS5kZWJ1Z1RpbWVyc09uID0gMDsKICAgIEdhbWUuc2VzYW1lID0gMDsKICAgIEdhbWUuT3BlblNlc2FtZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHN0ciA9ICIiOwogICAgICBzdHIgKz0KICAgICAgICAnPGRpdiBjbGFzcz0iaWNvbiIgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlO2xlZnQ6LTlweDt0b3A6LTZweDtiYWNrZ3JvdW5kLXBvc2l0aW9uOicgKwogICAgICAgIC0xMCAqIDQ4ICsKICAgICAgICAicHggIiArCiAgICAgICAgLTYgKiA0OCArCiAgICAgICAgJ3B4OyI+PC9kaXY+JzsKICAgICAgc3RyICs9CiAgICAgICAgJzxkaXYgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlO2xlZnQ6MHB4O3RvcDowcHg7ei1pbmRleDoxMDtmb250LXNpemU6MTBweDtiYWNrZ3JvdW5kOiMwMDA7cGFkZGluZzoxcHg7IiBpZD0iZnBzQ291bnRlciI+PC9kaXY+JzsKCiAgICAgIHN0ciArPSAnPGRpdiBpZD0iZGV2Q29uc29sZUNvbnRlbnQiPic7CiAgICAgIHN0ciArPQogICAgICAgICc8ZGl2IGNsYXNzPSJ0aXRsZSIgc3R5bGU9ImZvbnQtc2l6ZToxNHB4O21hcmdpbjo2cHg7Ij5EZXYgdG9vbHM8L2Rpdj4nOwoKICAgICAgc3RyICs9CiAgICAgICAgJzxhIGNsYXNzPSJvcHRpb24gbmVhdG8iICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICc9IkdhbWUuQXNjZW5kKDEpOyI+QXNjZW5kPC9hPic7CiAgICAgIHN0ciArPSAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JzsKICAgICAgc3RyICs9CiAgICAgICAgJzxhIGNsYXNzPSJvcHRpb24gbmVhdG8iICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICc9IkdhbWUuY29va2llcyo9MTA7R2FtZS5jb29raWVzRWFybmVkKj0xMDsiPngxMDwvYT4nOwogICAgICBzdHIgKz0KICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiBuZWF0byIgJyArCiAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgJz0iR2FtZS5jb29raWVzLz0xMDtHYW1lLmNvb2tpZXNFYXJuZWQvPTEwOyI+LzEwPC9hPjxicj4nOwogICAgICBzdHIgKz0KICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiBuZWF0byIgJyArCiAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgJz0iR2FtZS5jb29raWVzKj0xMDAwO0dhbWUuY29va2llc0Vhcm5lZCo9MTAwMDsiPngxazwvYT4nOwogICAgICBzdHIgKz0KICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiBuZWF0byIgJyArCiAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgJz0iR2FtZS5jb29raWVzLz0xMDAwO0dhbWUuY29va2llc0Vhcm5lZC89MTAwMDsiPi8xazwvYT48YnI+JzsKICAgICAgc3RyICs9CiAgICAgICAgJzxhIGNsYXNzPSJvcHRpb24gbmVhdG8iICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICc9ImZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKXtHYW1lLk9iamVjdHNbaV0uYnV5KDEwMCk7fSI+QnV5IDEwMCBvZiBhbGw8L2E+JzsgLy9mb3IgKHZhciBuPTA7bjwxMDA7bisrKXtmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0cyl7R2FtZS5PYmplY3RzW2ldLmJ1eSgxKTt9fQogICAgICBzdHIgKz0KICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiBuZWF0byIgJyArCiAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgJz0iZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpe0dhbWUuT2JqZWN0c1tpXS5zZWxsKDEwMCk7fSI+U2VsbCAxMDAgb2YgYWxsPC9hPjxicj4nOwogICAgICBzdHIgKz0KICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiBuZWF0byIgJyArCiAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgJz0iR2FtZS5nYWluTHVtcHMoMTApOyI+KzEwIGx1bXBzPC9hPic7CiAgICAgIHN0ciArPQogICAgICAgICc8YSBjbGFzcz0ib3B0aW9uIG5lYXRvIiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJmb3IgKHZhciBpIGluIEdhbWUuT2JqZWN0cyl7R2FtZS5PYmplY3RzW2ldLmxldmVsPTA7R2FtZS5PYmplY3RzW2ldLm9uTWluaWdhbWU9ZmFsc2U7R2FtZS5PYmplY3RzW2ldLnJlZnJlc2goKTt9R2FtZS5yZWNhbGN1bGF0ZUdhaW5zPTE7Ij5SZXNldCBsZXZlbHM8L2E+JzsKICAgICAgc3RyICs9CiAgICAgICAgJzxhIGNsYXNzPSJvcHRpb24gbmVhdG8iICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICc9IkdhbWUuY29va2llc1Jlc2V0Kz1HYW1lLkhvd01hbnlDb29raWVzUmVzZXQoKEdhbWUuaGVhdmVubHlDaGlwc3x8MSkqMTAwMCk7R2FtZS5FYXJuSGVhdmVubHlDaGlwcygwLHRydWUpO0dhbWUucmVjYWxjdWxhdGVHYWlucz0xOyI+SEMgeDFrPC9hPic7CiAgICAgIHN0ciArPQogICAgICAgICc8YSBjbGFzcz0ib3B0aW9uIG5lYXRvIiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJHYW1lLmNvb2tpZXNSZXNldD0oR2FtZS5oZWF2ZW5seUNoaXBzPDEwMD8wOkdhbWUuSG93TWFueUNvb2tpZXNSZXNldChNYXRoLmZsb29yKEdhbWUuaGVhdmVubHlDaGlwcyowLjAwMSkpKTtHYW1lLmNvb2tpZXNSZXNldD1NYXRoLm1heChHYW1lLmNvb2tpZXNSZXNldCwwKTtHYW1lLkVhcm5IZWF2ZW5seUNoaXBzKDAsdHJ1ZSk7aWYgKEdhbWUuY29va2llc1Jlc2V0PD0wKXtHYW1lLmhlYXZlbmx5Q2hpcHM9MDt9R2FtZS5yZWNhbGN1bGF0ZUdhaW5zPTE7Ij5IQyAvMWs8L2E+PGJyPic7IC8vd2VlIGJpdCBpbmFjY3VyYXRlCiAgICAgIHN0ciArPQogICAgICAgICc8YSBjbGFzcz0ib3B0aW9uIG5lYXRvIiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJHYW1lLmNvb2tpZXNFYXJuZWQ9MDtHYW1lLnJlY2FsY3VsYXRlR2FpbnM9MTsiPlJlc2V0IGNvb2tpZXMgZWFybmVkPC9hPjxicj4nOwogICAgICBzdHIgKz0gJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2Pic7CiAgICAgIHN0ciArPQogICAgICAgICc8YSBjbGFzcz0ib3B0aW9uIHdhcm5pbmciICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICc9IkdhbWUuUnVpblRoZUZ1bigxKTsiPlJ1aW4gVGhlIEZ1bjwvYT4nOwogICAgICBzdHIgKz0KICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiB3YXJuaW5nIiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJHYW1lLlNlc2FtZVJlc2V0KCk7Ij5XaXBlPC9hPic7CiAgICAgIHN0ciArPQogICAgICAgICc8YSBjbGFzcz0ib3B0aW9uIG5lYXRvIiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJHYW1lLkdldEFsbERlYnVncygpOyI+QWxsIGRlYnVnczwvYT4nOwogICAgICBzdHIgKz0KICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiBuZWF0byIgJyArCiAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgJz0iR2FtZS5kZWJ1Z1RpbWVyc09uPSFHYW1lLmRlYnVnVGltZXJzT247R2FtZS5PcGVuU2VzYW1lKCk7Ij5UaW1lcnMgJyArCiAgICAgICAgKEdhbWUuZGVidWdUaW1lcnNPbiA/ICJPbiIgOiAiT2ZmIikgKwogICAgICAgICI8L2E+PGJyPiI7CiAgICAgIHN0ciArPQogICAgICAgICc8YSBjbGFzcz0ib3B0aW9uIG5lYXRvIiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJHYW1lLlNldEFsbFVwZ3JhZGVzKDApOyI+Tm8gdXBncmFkZXM8L2E+JzsKICAgICAgc3RyICs9CiAgICAgICAgJzxhIGNsYXNzPSJvcHRpb24gbmVhdG8iICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICc9IkdhbWUuU2V0QWxsVXBncmFkZXMoMSk7Ij5BbGwgdXBncmFkZXM8L2E+PGJyPic7CiAgICAgIHN0ciArPQogICAgICAgICc8YSBjbGFzcz0ib3B0aW9uIG5lYXRvIiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJHYW1lLlNldEFsbEFjaGlldnMoMCk7Ij5ObyBhY2hpZXZzPC9hPic7CiAgICAgIHN0ciArPQogICAgICAgICc8YSBjbGFzcz0ib3B0aW9uIG5lYXRvIiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJHYW1lLlNldEFsbEFjaGlldnMoMSk7Ij5BbGwgYWNoaWV2czwvYT48YnI+JzsKICAgICAgc3RyICs9CiAgICAgICAgJzxhIGNsYXNzPSJvcHRpb24gbmVhdG8iICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICc9IkdhbWUuc2FudGFMZXZlbD0wO0dhbWUuZHJhZ29uTGV2ZWw9MDsiPlJlc2V0IHNwZWNpYWxzPC9hPic7CiAgICAgIHN0ciArPQogICAgICAgICc8YSBjbGFzcz0ib3B0aW9uIG5lYXRvIiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJHYW1lLk1heFNwZWNpYWxzKCk7Ij5NYXggc3BlY2lhbHM8L2E+PGJyPic7CiAgICAgIHN0ciArPQogICAgICAgICc8YSBjbGFzcz0ib3B0aW9uIG5lYXRvIiAnICsKICAgICAgICBHYW1lLmNsaWNrU3RyICsKICAgICAgICAnPSJHYW1lLmx1bXBSZWZpbGw9MDsvKkRhdGUubm93KCktR2FtZS5nZXRMdW1wUmVmaWxsTWF4KCk7Ki8iPlJlc2V0IHJlZmlsbHM8L2E+JzsKICAgICAgc3RyICs9CiAgICAgICAgJzxhIGNsYXNzPSJvcHRpb24gbmVhdG8iICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICc9IkdhbWUuRWRpdEFzY2VuZCgpOyI+JyArCiAgICAgICAgKEdhbWUuRGVidWdnaW5nUHJlc3RpZ2UgPyAiRXhpdCBBc2NlbmQgRWRpdCIgOiAiQXNjZW5kIEVkaXQiKSArCiAgICAgICAgIjwvYT4iOwogICAgICBzdHIgKz0KICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiBuZWF0byIgJyArCiAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgJz0iR2FtZS5EZWJ1Z1VwZ3JhZGVDcFMoKTsiPkRlYnVnIHVwZ3JhZGVzIENwUzwvYT4nOwogICAgICBzdHIgKz0KICAgICAgICAnPGEgY2xhc3M9Im9wdGlvbiBuZWF0byIgJyArCiAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgJz0iR2FtZS5zZWVkPUdhbWUubWFrZVNlZWQoKTsiPlJlLXNlZWQ8L2E+JzsKICAgICAgc3RyICs9CiAgICAgICAgJzxhIGNsYXNzPSJvcHRpb24gbmVhdG8iICcgKwogICAgICAgIEdhbWUuY2xpY2tTdHIgKwogICAgICAgICI9XCJHYW1lLmhlcmFsZHM9MTAwO2woJ2hlcmFsZHNBbW91bnQnKS50ZXh0Q29udGVudD1HYW1lLmhlcmFsZHM7R2FtZS5leHRlcm5hbERhdGFMb2FkZWQ9dHJ1ZTtHYW1lLnJlY2FsY3VsYXRlR2FpbnM9MTtcIj5NYXggaGVyYWxkczwvYT4iOwogICAgICBzdHIgKz0gJzxkaXYgY2xhc3M9ImxpbmUiPjwvZGl2Pic7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgR2FtZS5nb2xkZW5Db29raWVDaG9pY2VzLmxlbmd0aCAvIDI7IGkrKykgewogICAgICAgIHN0ciArPQogICAgICAgICAgJzxhIGNsYXNzPSJvcHRpb24gbmVhdG8iICcgKwogICAgICAgICAgR2FtZS5jbGlja1N0ciArCiAgICAgICAgICAiPVwidmFyIG5ld1NoaW1tZXI9bmV3IEdhbWUuc2hpbW1lcignZ29sZGVuJyk7bmV3U2hpbW1lci5mb3JjZT0nIiArCiAgICAgICAgICBHYW1lLmdvbGRlbkNvb2tpZUNob2ljZXNbaSAqIDIgKyAxXSArCiAgICAgICAgICAiJztcIj4iICsKICAgICAgICAgIEdhbWUuZ29sZGVuQ29va2llQ2hvaWNlc1tpICogMl0gKwogICAgICAgICAgIjwvYT4iOwogICAgICAgIC8vc3RyKz0nPGEgY2xhc3M9Im9wdGlvbiBuZWF0byIgJytHYW1lLmNsaWNrU3RyKyc9IkdhbWUuZ29sZGVuQ29va2llLmZvcmNlPVwnJytHYW1lLmdvbGRlbkNvb2tpZS5jaG9pY2VzW2kqMisxXSsnXCc7R2FtZS5nb2xkZW5Db29raWUuc3Bhd24oKTsiPicrR2FtZS5nb2xkZW5Db29raWUuY2hvaWNlc1tpKjJdKyc8L2E+JzsKICAgICAgICAvL3N0cis9JzxhIGNsYXNzPSJvcHRpb24gbmVhdG8iICcrR2FtZS5jbGlja1N0cisnPSJHYW1lLmdvbGRlbkNvb2tpZS5jbGljaygwLFwnJytHYW1lLmdvbGRlbkNvb2tpZS5jaG9pY2VzW2kqMisxXSsnXCcpOyI+JytHYW1lLmdvbGRlbkNvb2tpZS5jaG9pY2VzW2kqMl0rJzwvYT4nOwogICAgICB9CiAgICAgIHN0ciArPSAiPC9kaXY+IjsKCiAgICAgIGwoImRldkNvbnNvbGUiKS5pbm5lckhUTUwgPSBzdHI7CgogICAgICBpZiAoIWwoImZwc0dyYXBoIikpIHsKICAgICAgICB2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIik7CiAgICAgICAgZGl2LmlkID0gImZwc0dyYXBoIjsKICAgICAgICBkaXYud2lkdGggPSAxMjg7CiAgICAgICAgZGl2LmhlaWdodCA9IDY0OwogICAgICAgIGRpdi5zdHlsZS5vcGFjaXR5ID0gMC41OwogICAgICAgIGRpdi5zdHlsZS5wb2ludGVyRXZlbnRzID0gIm5vbmUiOwogICAgICAgIGRpdi5zdHlsZS50cmFuc2Zvcm1PcmlnaW4gPSAiMCUgMCUiOwogICAgICAgIGRpdi5zdHlsZS50cmFuc2Zvcm0gPSAic2NhbGUoMC43NSkiOwogICAgICAgIC8vbCgnZGV2Q29uc29sZScpLmFwcGVuZENoaWxkKGRpdik7CiAgICAgICAgbCgiZGV2Q29uc29sZSIpLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKAogICAgICAgICAgZGl2LAogICAgICAgICAgbCgiZGV2Q29uc29sZSIpLm5leHRTaWJsaW5nCiAgICAgICAgKTsKICAgICAgICBHYW1lLmZwc0dyYXBoID0gZGl2OwogICAgICAgIEdhbWUuZnBzR3JhcGhDdHggPSBHYW1lLmZwc0dyYXBoLmdldENvbnRleHQoIjJkIiwgeyBhbHBoYTogZmFsc2UgfSk7CiAgICAgICAgdmFyIGN0eCA9IEdhbWUuZnBzR3JhcGhDdHg7CiAgICAgICAgY3R4LmZpbGxTdHlsZSA9ICIjMDAwIjsKICAgICAgICBjdHguZmlsbFJlY3QoMCwgMCwgMTI4LCA2NCk7CiAgICAgIH0KCiAgICAgIGwoImRlYnVnIikuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgIEdhbWUuc2VzYW1lID0gMTsKICAgICAgR2FtZS5BY2hpZXZlbWVudHNbIkNoZWF0ZWQgY29va2llcyB0YXN0ZSBhd2Z1bCJdLndvbiA9IDE7CiAgICB9OwoKICAgIEdhbWUuRWRpdEFzY2VuZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCFHYW1lLkRlYnVnZ2luZ1ByZXN0aWdlKSB7CiAgICAgICAgR2FtZS5EZWJ1Z2dpbmdQcmVzdGlnZSA9IHRydWU7CiAgICAgICAgR2FtZS5Bc2NlbmRUaW1lciA9IDA7CiAgICAgICAgR2FtZS5PbkFzY2VuZCA9IDE7CiAgICAgICAgR2FtZS5yZW1vdmVDbGFzcygiYXNjZW5kSW50cm8iKTsKICAgICAgICBHYW1lLmFkZENsYXNzKCJhc2NlbmRpbmciKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBHYW1lLkRlYnVnZ2luZ1ByZXN0aWdlID0gZmFsc2U7CiAgICAgIH0KICAgICAgR2FtZS5CdWlsZEFzY2VuZFRyZWUoKTsKICAgICAgR2FtZS5PcGVuU2VzYW1lKCk7CiAgICB9OwoKICAgIC8vZXhwZXJpbWVudGFsIGRlYnVnZ2luZyBmdW5jdGlvbiB0aGF0IGN5Y2xlcyB0aHJvdWdoIGV2ZXJ5IG93bmVkIHVwZ3JhZGUsIHR1cm5zIGl0IG9mZiBhbmQgb24sIGFuZCBsaXN0cyBob3cgbXVjaCBlYWNoIHVwZ3JhZGUgaXMgcGFydGljaXBhdGluZyB0byBDcFMKICAgIEdhbWUuZGVidWdnZWRVcGdyYWRlQ3BTID0gW107CiAgICBHYW1lLmRlYnVnZ2VkVXBncmFkZUNwQ2xpY2sgPSBbXTsKICAgIEdhbWUuZGVidWdDb2xvcnMgPSBbCiAgICAgICIjMzIyIiwKICAgICAgIiM0MTEiLAogICAgICAiIzYwMCIsCiAgICAgICIjOTAwIiwKICAgICAgIiNmMzAiLAogICAgICAiI2Y5MCIsCiAgICAgICIjZmYwIiwKICAgICAgIiM5ZjAiLAogICAgICAiIzBmOSIsCiAgICAgICIjMDlmIiwKICAgICAgIiM5MGYiLAogICAgXTsKICAgIEdhbWUuRGVidWdVcGdyYWRlQ3BTID0gZnVuY3Rpb24gKCkgewogICAgICBHYW1lLkNhbGN1bGF0ZUdhaW5zKCk7CiAgICAgIEdhbWUuZGVidWdnZWRVcGdyYWRlQ3BTID0gW107CiAgICAgIEdhbWUuZGVidWdnZWRVcGdyYWRlQ3BDbGljayA9IFtdOwogICAgICB2YXIgQ3BTID0gR2FtZS5jb29raWVzUHM7CiAgICAgIHZhciBDcENsaWNrID0gR2FtZS5jb21wdXRlZE1vdXNlQ3BzOwogICAgICBmb3IgKHZhciBpIGluIEdhbWUuVXBncmFkZXMpIHsKICAgICAgICB2YXIgbWUgPSBHYW1lLlVwZ3JhZGVzW2ldOwogICAgICAgIGlmIChtZS5ib3VnaHQpIHsKICAgICAgICAgIG1lLmJvdWdodCA9IDA7CiAgICAgICAgICBHYW1lLkNhbGN1bGF0ZUdhaW5zKCk7CiAgICAgICAgICAvL0dhbWUuZGVidWdnZWRVcGdyYWRlQ3BTW21lLm5hbWVdPUNwUy1HYW1lLmNvb2tpZXNQczsKICAgICAgICAgIEdhbWUuZGVidWdnZWRVcGdyYWRlQ3BTW21lLm5hbWVdID0gQ3BTIC8gKEdhbWUuY29va2llc1BzIHx8IDEpIC0gMTsKICAgICAgICAgIEdhbWUuZGVidWdnZWRVcGdyYWRlQ3BDbGlja1ttZS5uYW1lXSA9CiAgICAgICAgICAgIENwQ2xpY2sgLyAoR2FtZS5jb21wdXRlZE1vdXNlQ3BzIHx8IDEpIC0gMTsKICAgICAgICAgIG1lLmJvdWdodCA9IDE7CiAgICAgICAgfQogICAgICB9CiAgICAgIEdhbWUuQ2FsY3VsYXRlR2FpbnMoKTsKICAgIH07CgogICAgR2FtZS52YW5pbGxhID0gMDsgLy9ldmVyeXRoaW5nIHdlIGNyZWF0ZSBiZXlvbmQgdGhpcyB3aWxsIGJlIHNhdmVkIGluIG1vZCBzdHJ1Y3R1cmVzCgogICAgR2FtZS5sYXVuY2hNb2RzKCk7CgogICAgR2FtZS5ydW5Nb2RIb29rKCJjcmVhdGUiKTsgLy9kZWNsYXJlIGN1c3RvbSB1cGdyYWRlcy9hY2hpZXZzL2J1ZmZzL2J1aWxkaW5ncyBoZXJlIQoKICAgIEJlYXV0aWZ5QWxsKCk7CgogICAgaWYgKCFBcHApIHsKICAgICAgaWYgKCFHYW1lLkxvYWRTYXZlKCkpIHsKICAgICAgICAvL3RyeSB0byBsb2FkIHRoZSBzYXZlIHdoZW4gd2Ugb3BlbiB0aGUgcGFnZS4gaWYgdGhpcyBmYWlscywgdHJ5IHRvIGJydXRlLWZvcmNlIGl0IGhhbGYgYSBzZWNvbmQgbGF0ZXIKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBsb2NhbCA9IGxvY2FsU3RvcmFnZUdldChHYW1lLlNhdmVUbyk7CiAgICAgICAgICBHYW1lLkxvYWRTYXZlKGxvY2FsKTsKICAgICAgICB9LCA1MDApOwogICAgICB9CiAgICB9IGVsc2UgaWYgKEFwcC5zYXZlRGF0YSkKICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgR2FtZS5Mb2FkU2F2ZShBcHAuc2F2ZURhdGEpOwogICAgICB9LCAxMDApOwogICAgZWxzZQogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBHYW1lLkxvYWRTYXZlKCk7CiAgICAgIH0sIDEwMCk7CgogICAgR2FtZS5yZWFkeSA9IDE7CiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKAogICAgICAgIHR5cGVvZiBzaG93QWRzID09PSAidW5kZWZpbmVkIiAmJgogICAgICAgICghbCgiZGV0ZWN0QWRzIikgfHwgbCgiZGV0ZWN0QWRzIikuY2xpZW50SGVpZ2h0IDwgMSkKICAgICAgKQogICAgICAgIEdhbWUuYWRkQ2xhc3MoIm5vQWRzIik7CiAgICB9LCA1MDApOwogICAgbCgib2ZmR2FtZU1lc3NhZ2UiKS5pbm5lckhUTUwgPSAiIjsKICAgIGwoIm9mZkdhbWVNZXNzYWdlV3JhcCIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICBHYW1lLkxvb3AoKTsKICAgIEdhbWUuRHJhdygpOwoKICAgIFBsYXlDdWUoImxhdW5jaCIpOwoKICAgIGlmICghRU4pIHsKICAgICAgdmFyIGFkYXB0V2lkdGggPSBmdW5jdGlvbiAobm9kZSkgewogICAgICAgIHZhciBlbCA9IG5vZGUuZmlyc3RDaGlsZDsKICAgICAgICB2YXIgd2lkdGggPSBlbC5jbGllbnRXaWR0aDsKICAgICAgICBpZiAoZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCJzdWJCdXR0b24iKSkgewogICAgICAgICAgaWYgKHdpZHRoIC8gOTUgPiAxKSBlbC5zdHlsZS5wYWRkaW5nID0gIjZweCAwcHgiOwogICAgICAgIH0KICAgICAgICB3aWR0aCA9IHdpZHRoIC8gOTU7CiAgICAgICAgaWYgKHdpZHRoID4gMSkgewogICAgICAgICAgZWwuc3R5bGUuZm9udFNpemUgPQogICAgICAgICAgICAocGFyc2VJbnQod2luZG93LmdldENvbXB1dGVkU3R5bGUoZWwpLmZvbnRTaXplKSAqIDEpIC8gd2lkdGggKyAicHgiOwogICAgICAgICAgZWwuc3R5bGUudHJhbnNmb3JtID0gInNjYWxlKDEsIiArIHdpZHRoICsgIikiOwogICAgICAgIH0KICAgICAgfTsKICAgICAgbCgicHJlZnNCdXR0b24iKS5maXJzdENoaWxkLmlubmVySFRNTCA9IGxvYygiT3B0aW9ucyIpOwogICAgICBsKCJzdGF0c0J1dHRvbiIpLmZpcnN0Q2hpbGQuaW5uZXJIVE1MID0gbG9jKCJTdGF0cyIpOwogICAgICBsKCJsb2dCdXR0b24iKS5maXJzdENoaWxkLmlubmVySFRNTCA9IGxvYygiSW5mbyIpOwogICAgICBsKCJsZWdhY3lCdXR0b24iKS5maXJzdENoaWxkLmlubmVySFRNTCA9IGxvYygiTGVnYWN5Iik7CiAgICAgIGFkYXB0V2lkdGgobCgicHJlZnNCdXR0b24iKSk7CiAgICAgIGFkYXB0V2lkdGgobCgic3RhdHNCdXR0b24iKSk7CiAgICAgIGFkYXB0V2lkdGgobCgibG9nQnV0dG9uIikpOwogICAgICBhZGFwdFdpZHRoKGwoImxlZ2FjeUJ1dHRvbiIpKTsKICAgICAgbCgiY2hlY2tGb3JVcGRhdGUiKS5jaGlsZE5vZGVzWzBdLnRleHRDb250ZW50ID0gbG9jKCJOZXcgdXBkYXRlISIpOwogICAgICBsKCJidWlsZGluZ3NUaXRsZSIpLmNoaWxkTm9kZXNbMF0udGV4dENvbnRlbnQgPSBsb2MoIkJ1aWxkaW5ncyIpOwogICAgICBsKCJzdG9yZVRpdGxlIikuY2hpbGROb2Rlc1swXS50ZXh0Q29udGVudCA9IGxvYygiU3RvcmUiKTsKICAgIH0KICB9OwogIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJTE9HSUMKCT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCiAgR2FtZS5Mb2dpYyA9IGZ1bmN0aW9uICgpIHsKICAgIEdhbWUuYm91bmRzID0gR2FtZS5sLmdldEJvdW5kcygpOwoKICAgIGlmICghR2FtZS5PbkFzY2VuZCAmJiBHYW1lLkFzY2VuZFRpbWVyID09IDApIHsKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICBpZiAoR2FtZS5PYmplY3RzW2ldLmVhY2hGcmFtZSkgR2FtZS5PYmplY3RzW2ldLmVhY2hGcmFtZSgpOwogICAgICB9CiAgICAgIEdhbWUuVXBkYXRlU3BlY2lhbCgpOwogICAgICBHYW1lLlVwZGF0ZUdyYW5kbWFwb2NhbHlwc2UoKTsKCiAgICAgIC8vdGhlc2UgYXJlIGtpbmRhIGZ1bgogICAgICAvL2lmIChHYW1lLkJpZ0Nvb2tpZVN0YXRlPT0yICYmICFHYW1lLnByb21wdE9uICYmIEdhbWUuU2Nyb2xsIT0wKSBHYW1lLkNsaWNrQ29va2llKCk7CiAgICAgIC8vaWYgKEdhbWUuQmlnQ29va2llU3RhdGU9PTEgJiYgIUdhbWUucHJvbXB0T24pIEdhbWUuQ2xpY2tDb29raWUoKTsKCiAgICAgIC8vaGFuZGxlIGdyYXBoaWMgc3R1ZmYKICAgICAgaWYgKEdhbWUucHJlZnMud29iYmx5KSB7CiAgICAgICAgaWYgKEdhbWUuQmlnQ29va2llU3RhdGUgPT0gMSkgR2FtZS5CaWdDb29raWVTaXplVCA9IDAuOTg7CiAgICAgICAgZWxzZSBpZiAoR2FtZS5CaWdDb29raWVTdGF0ZSA9PSAyKSBHYW1lLkJpZ0Nvb2tpZVNpemVUID0gMS4wNTsKICAgICAgICBlbHNlIEdhbWUuQmlnQ29va2llU2l6ZVQgPSAxOwogICAgICAgIEdhbWUuQmlnQ29va2llU2l6ZUQgKz0KICAgICAgICAgIChHYW1lLkJpZ0Nvb2tpZVNpemVUIC0gR2FtZS5CaWdDb29raWVTaXplKSAqIDAuNzU7CiAgICAgICAgR2FtZS5CaWdDb29raWVTaXplRCAqPSAwLjc1OwogICAgICAgIEdhbWUuQmlnQ29va2llU2l6ZSArPSBHYW1lLkJpZ0Nvb2tpZVNpemVEOwogICAgICAgIEdhbWUuQmlnQ29va2llU2l6ZSA9IE1hdGgubWF4KDAuMSwgR2FtZS5CaWdDb29raWVTaXplKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoR2FtZS5CaWdDb29raWVTdGF0ZSA9PSAxKQogICAgICAgICAgR2FtZS5CaWdDb29raWVTaXplICs9ICgwLjk4IC0gR2FtZS5CaWdDb29raWVTaXplKSAqIDAuNTsKICAgICAgICBlbHNlIGlmIChHYW1lLkJpZ0Nvb2tpZVN0YXRlID09IDIpCiAgICAgICAgICBHYW1lLkJpZ0Nvb2tpZVNpemUgKz0gKDEuMDUgLSBHYW1lLkJpZ0Nvb2tpZVNpemUpICogMC41OwogICAgICAgIGVsc2UgR2FtZS5CaWdDb29raWVTaXplICs9ICgxIC0gR2FtZS5CaWdDb29raWVTaXplKSAqIDAuNTsKICAgICAgfQogICAgICBHYW1lLnBhcnRpY2xlc1VwZGF0ZSgpOwoKICAgICAgaWYgKEdhbWUubW91c2VQb2ludGVyKSBsKCJzZWN0aW9uTGVmdCIpLnN0eWxlLmN1cnNvciA9ICJwb2ludGVyIjsKICAgICAgZWxzZSBsKCJzZWN0aW9uTGVmdCIpLnN0eWxlLmN1cnNvciA9ICJhdXRvIjsKICAgICAgR2FtZS5tb3VzZVBvaW50ZXIgPSAwOwoKICAgICAgLy9oYW5kbGUgbWlsayBhbmQgbWlsayBhY2Nlc3NvcmllcwogICAgICBHYW1lLm1pbGtQcm9ncmVzcyA9IEdhbWUuQWNoaWV2ZW1lbnRzT3duZWQgLyAyNTsKICAgICAgaWYgKEdhbWUubWlsa1Byb2dyZXNzID49IDAuNSkgR2FtZS5VbmxvY2soIktpdHRlbiBoZWxwZXJzIik7CiAgICAgIGlmIChHYW1lLm1pbGtQcm9ncmVzcyA+PSAxKSBHYW1lLlVubG9jaygiS2l0dGVuIHdvcmtlcnMiKTsKICAgICAgaWYgKEdhbWUubWlsa1Byb2dyZXNzID49IDIpIEdhbWUuVW5sb2NrKCJLaXR0ZW4gZW5naW5lZXJzIik7CiAgICAgIGlmIChHYW1lLm1pbGtQcm9ncmVzcyA+PSAzKSBHYW1lLlVubG9jaygiS2l0dGVuIG92ZXJzZWVycyIpOwogICAgICBpZiAoR2FtZS5taWxrUHJvZ3Jlc3MgPj0gNCkgR2FtZS5VbmxvY2soIktpdHRlbiBtYW5hZ2VycyIpOwogICAgICBpZiAoR2FtZS5taWxrUHJvZ3Jlc3MgPj0gNSkgR2FtZS5VbmxvY2soIktpdHRlbiBhY2NvdW50YW50cyIpOwogICAgICBpZiAoR2FtZS5taWxrUHJvZ3Jlc3MgPj0gNikgR2FtZS5VbmxvY2soIktpdHRlbiBzcGVjaWFsaXN0cyIpOwogICAgICBpZiAoR2FtZS5taWxrUHJvZ3Jlc3MgPj0gNykgR2FtZS5VbmxvY2soIktpdHRlbiBleHBlcnRzIik7CiAgICAgIGlmIChHYW1lLm1pbGtQcm9ncmVzcyA+PSA4KSBHYW1lLlVubG9jaygiS2l0dGVuIGNvbnN1bHRhbnRzIik7CiAgICAgIGlmIChHYW1lLm1pbGtQcm9ncmVzcyA+PSA5KQogICAgICAgIEdhbWUuVW5sb2NrKCJLaXR0ZW4gYXNzaXN0YW50cyB0byB0aGUgcmVnaW9uYWwgbWFuYWdlciIpOwogICAgICBpZiAoR2FtZS5taWxrUHJvZ3Jlc3MgPj0gMTApIEdhbWUuVW5sb2NrKCJLaXR0ZW4gbWFya2V0ZWVycyIpOwogICAgICBpZiAoR2FtZS5taWxrUHJvZ3Jlc3MgPj0gMTEpIEdhbWUuVW5sb2NrKCJLaXR0ZW4gYW5hbHlzdHMiKTsKICAgICAgaWYgKEdhbWUubWlsa1Byb2dyZXNzID49IDEyKSBHYW1lLlVubG9jaygiS2l0dGVuIGV4ZWN1dGl2ZXMiKTsKICAgICAgaWYgKEdhbWUubWlsa1Byb2dyZXNzID49IDEzKSBHYW1lLlVubG9jaygiS2l0dGVuIGFkbWlucyIpOwogICAgICBHYW1lLm1pbGtIID0gTWF0aC5taW4oMSwgR2FtZS5taWxrUHJvZ3Jlc3MpICogMC4zNTsKICAgICAgR2FtZS5taWxrSGQgKz0gKEdhbWUubWlsa0ggLSBHYW1lLm1pbGtIZCkgKiAwLjAyOwoKICAgICAgR2FtZS5NaWxrID0KICAgICAgICBHYW1lLk1pbGtzWwogICAgICAgICAgTWF0aC5taW4oTWF0aC5mbG9vcihHYW1lLm1pbGtQcm9ncmVzcyksIEdhbWUuTWlsa3MubGVuZ3RoIC0gMSkKICAgICAgICBdOwoKICAgICAgaWYgKEdhbWUuYXV0b2NsaWNrZXJEZXRlY3RlZCA+IDApIEdhbWUuYXV0b2NsaWNrZXJEZXRlY3RlZC0tOwoKICAgICAgLy9oYW5kbGUgcmVzZWFyY2gKICAgICAgaWYgKEdhbWUucmVzZWFyY2hUID4gMCkgewogICAgICAgIEdhbWUucmVzZWFyY2hULS07CiAgICAgIH0KICAgICAgaWYgKEdhbWUucmVzZWFyY2hUID09IDAgJiYgR2FtZS5uZXh0UmVzZWFyY2gpIHsKICAgICAgICBpZiAoIUdhbWUuSGFzKEdhbWUuVXBncmFkZXNCeUlkW0dhbWUubmV4dFJlc2VhcmNoXS5uYW1lKSkgewogICAgICAgICAgR2FtZS5VbmxvY2soR2FtZS5VcGdyYWRlc0J5SWRbR2FtZS5uZXh0UmVzZWFyY2hdLm5hbWUpOwogICAgICAgICAgR2FtZS5Ob3RpZnkoCiAgICAgICAgICAgIGxvYygiUmVzZWFyY2ggY29tcGxldGUiKSwKICAgICAgICAgICAgbG9jKAogICAgICAgICAgICAgICJZb3UgaGF2ZSBkaXNjb3ZlcmVkOiA8Yj4lMTwvYj4uIiwKICAgICAgICAgICAgICBHYW1lLlVwZ3JhZGVzQnlJZFtHYW1lLm5leHRSZXNlYXJjaF0uZG5hbWUKICAgICAgICAgICAgKSwKICAgICAgICAgICAgR2FtZS5VcGdyYWRlc0J5SWRbR2FtZS5uZXh0UmVzZWFyY2hdLmljb24KICAgICAgICAgICk7CiAgICAgICAgfQogICAgICAgIEdhbWUubmV4dFJlc2VhcmNoID0gMDsKICAgICAgICBHYW1lLnJlc2VhcmNoVCA9IC0xOwogICAgICAgIEdhbWUucmVjYWxjdWxhdGVHYWlucyA9IDE7CiAgICAgIH0KICAgICAgLy9oYW5kbGUgc2Vhc29ucwogICAgICBpZiAoR2FtZS5zZWFzb25UID4gMCkgewogICAgICAgIEdhbWUuc2Vhc29uVC0tOwogICAgICB9CiAgICAgIGlmICgKICAgICAgICBHYW1lLnNlYXNvblQgPD0gMCAmJgogICAgICAgIEdhbWUuc2Vhc29uICE9ICIiICYmCiAgICAgICAgR2FtZS5zZWFzb24gIT0gR2FtZS5iYXNlU2Vhc29uICYmCiAgICAgICAgIUdhbWUuSGFzKCJFdGVybmFsIHNlYXNvbnMiKQogICAgICApIHsKICAgICAgICBHYW1lLk5vdGlmeSgKICAgICAgICAgIEdhbWUuc2Vhc29uc1tHYW1lLnNlYXNvbl0ub3ZlciwKICAgICAgICAgICIiLAogICAgICAgICAgR2FtZS5zZWFzb25zW0dhbWUuc2Vhc29uXS50cmlnZ2VyVXBncmFkZS5pY29uCiAgICAgICAgKTsKICAgICAgICBpZiAoR2FtZS5IYXMoIlNlYXNvbiBzd2l0Y2hlciIpKSB7CiAgICAgICAgICBHYW1lLlVubG9jayhHYW1lLnNlYXNvbnNbR2FtZS5zZWFzb25dLnRyaWdnZXIpOwogICAgICAgICAgR2FtZS5zZWFzb25zW0dhbWUuc2Vhc29uXS50cmlnZ2VyVXBncmFkZS5ib3VnaHQgPSAwOwogICAgICAgIH0KICAgICAgICBHYW1lLnNlYXNvbiA9IEdhbWUuYmFzZVNlYXNvbjsKICAgICAgICBHYW1lLnNlYXNvblQgPSAtMTsKICAgICAgfQoKICAgICAgLy9wcmVzcyBjdHJsIHRvIGJ1bGstYnV5IDEwLCBzaGlmdCB0byBidWxrLWJ1eSAxMDAKICAgICAgaWYgKCFHYW1lLnByb21wdE9uKSB7CiAgICAgICAgaWYgKChHYW1lLmtleXNbMTZdIHx8IEdhbWUua2V5c1sxN10pICYmICFHYW1lLmJ1eUJ1bGtTaG9ydGN1dCkgewogICAgICAgICAgR2FtZS5idXlCdWxrT2xkID0gR2FtZS5idXlCdWxrOwogICAgICAgICAgaWYgKEdhbWUua2V5c1sxNl0pIEdhbWUuYnV5QnVsayA9IDEwMDsKICAgICAgICAgIGlmIChHYW1lLmtleXNbMTddKSBHYW1lLmJ1eUJ1bGsgPSAxMDsKICAgICAgICAgIEdhbWUuYnV5QnVsa1Nob3J0Y3V0ID0gMTsKICAgICAgICAgIEdhbWUuc3RvcmVCdWxrQnV0dG9uKC0xKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKCFHYW1lLmtleXNbMTZdICYmICFHYW1lLmtleXNbMTddICYmIEdhbWUuYnV5QnVsa1Nob3J0Y3V0KSB7CiAgICAgICAgLy9yZWxlYXNlCiAgICAgICAgR2FtZS5idXlCdWxrID0gR2FtZS5idXlCdWxrT2xkOwogICAgICAgIEdhbWUuYnV5QnVsa1Nob3J0Y3V0ID0gMDsKICAgICAgICBHYW1lLnN0b3JlQnVsa0J1dHRvbigtMSk7CiAgICAgIH0KCiAgICAgIC8vaGFuZGxlIGNvb2tpZXMKICAgICAgaWYgKEdhbWUucmVjYWxjdWxhdGVHYWlucykgR2FtZS5DYWxjdWxhdGVHYWlucygpOwogICAgICBHYW1lLkVhcm4oR2FtZS5jb29raWVzUHMgLyBHYW1lLmZwcyk7IC8vYWRkIGNvb2tpZXMgcGVyIHNlY29uZAoKICAgICAgLy9ncm93IGx1bXBzCiAgICAgIEdhbWUuZG9MdW1wcygpOwoKICAgICAgLy9taW5pZ2FtZXMKICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICB2YXIgbWUgPSBHYW1lLk9iamVjdHNbaV07CiAgICAgICAgaWYgKAogICAgICAgICAgR2FtZS5pc01pbmlnYW1lUmVhZHkobWUpICYmCiAgICAgICAgICBtZS5taW5pZ2FtZS5sb2dpYyAmJgogICAgICAgICAgR2FtZS5hc2NlbnNpb25Nb2RlICE9IDEKICAgICAgICApCiAgICAgICAgICBtZS5taW5pZ2FtZS5sb2dpYygpOwogICAgICB9CgogICAgICBpZiAoR2FtZS5zcGVjaWFsVGFiICE9ICIiICYmIEdhbWUuVCAlIChHYW1lLmZwcyAqIDMpID09IDApCiAgICAgICAgR2FtZS5Ub2dnbGVTcGVjaWFsTWVudSgxKTsKCiAgICAgIC8vd3JpbmtsZXJzCiAgICAgIGlmIChHYW1lLmNwc1N1Y2tlZCA+IDApIHsKICAgICAgICBHYW1lLkRpc3NvbHZlKChHYW1lLmNvb2tpZXNQcyAvIEdhbWUuZnBzKSAqIEdhbWUuY3BzU3Vja2VkKTsKICAgICAgICBHYW1lLmNvb2tpZXNTdWNrZWQgKz0gKEdhbWUuY29va2llc1BzIC8gR2FtZS5mcHMpICogR2FtZS5jcHNTdWNrZWQ7CiAgICAgICAgLy9zaG91bGQgYmUgdXNpbmcgb25lIG9mIHRoZSBmb2xsb3dpbmcsIGJ1dCBJJ20gbm90IHN1cmUgd2hhdCBJJ20gdXNpbmcgdGhpcyBzdGF0IGZvciBhbnltb3JlCiAgICAgICAgLy9HYW1lLmNvb2tpZXNTdWNrZWQ9R2FtZS53cmlua2xlcnMucmVkdWNlKGZ1bmN0aW9uKHMsdyl7cmV0dXJuIHMrdy5zdWNrZWQ7fSwwKTsKICAgICAgICAvL2ZvciAodmFyIGkgaW4gR2FtZS53cmlua2xlcnMpIHtHYW1lLmNvb2tpZXNTdWNrZWQrPUdhbWUud3JpbmtsZXJzW2ldLnN1Y2tlZDt9CiAgICAgIH0KCiAgICAgIC8vdmFyIGNwcz1HYW1lLmNvb2tpZXNQcytHYW1lLmNvb2tpZXMqMC4wMTsvL2V4cG9uZW50aWFsIGNvb2tpZXMKICAgICAgLy9HYW1lLkVhcm4oY3BzL0dhbWUuZnBzKTsvL2FkZCBjb29raWVzIHBlciBzZWNvbmQKCiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5PYmplY3RzW2ldOwogICAgICAgIG1lLnRvdGFsQ29va2llcyArPSAobWUuc3RvcmVkVG90YWxDcHMgKiBHYW1lLmdsb2JhbENwc011bHQpIC8gR2FtZS5mcHM7CiAgICAgIH0KICAgICAgaWYgKAogICAgICAgIEdhbWUucHJlZnMucGFydGljbGVzICYmCiAgICAgICAgR2FtZS5jb29raWVzICYmCiAgICAgICAgR2FtZS5UICUgTWF0aC5jZWlsKEdhbWUuZnBzIC8gTWF0aC5taW4oMTAsIEdhbWUuY29va2llc1BzKSkgPT0gMAogICAgICApCiAgICAgICAgR2FtZS5wYXJ0aWNsZUFkZCgpOyAvL2Nvb2tpZSBzaG93ZXIKCiAgICAgIGlmIChHYW1lLlQgJSAoR2FtZS5mcHMgKiAxMCkgPT0gMCkgR2FtZS5yZWNhbGN1bGF0ZUdhaW5zID0gMTsgLy9yZWNhbGN1bGF0ZSBDcFMgZXZlcnkgMTAgc2Vjb25kcyAoZm9yIGR5bmFtaWMgYm9vc3RzIHN1Y2ggYXMgQ2VudHVyeSBlZ2cpCgogICAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCQkJVU5MT0NLSU5HIFNUVUZGCgkJCT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCiAgICAgIGlmIChHYW1lLlQgJSBHYW1lLmZwcyA9PSAwICYmIE1hdGgucmFuZG9tKCkgPCAxIC8gMTAwMDAwMCkKICAgICAgICBHYW1lLldpbigiSnVzdCBwbGFpbiBsdWNreSIpOyAvLzEgY2hhbmNlIGluIDEsMDAwLDAwMCBldmVyeSBzZWNvbmQgYWNoaWV2ZW1lbnQKICAgICAgaWYgKEdhbWUuVCAlIChHYW1lLmZwcyAqIDUpID09IDAgJiYgR2FtZS5PYmplY3RzQnlJZC5sZW5ndGggPiAwKSB7CiAgICAgICAgLy9jaGVjayBzb21lIGFjaGlldmVtZW50cyBhbmQgdXBncmFkZXMKICAgICAgICBpZiAoaXNOYU4oR2FtZS5jb29raWVzKSkgewogICAgICAgICAgR2FtZS5jb29raWVzID0gMDsKICAgICAgICAgIEdhbWUuY29va2llc0Vhcm5lZCA9IDA7CiAgICAgICAgICBHYW1lLnJlY2FsY3VsYXRlR2FpbnMgPSAxOwogICAgICAgIH0KCiAgICAgICAgdmFyIHRpbWVQbGF5ZWQgPSBuZXcgRGF0ZSgpOwogICAgICAgIHRpbWVQbGF5ZWQuc2V0VGltZShEYXRlLm5vdygpIC0gR2FtZS5zdGFydERhdGUpOwoKICAgICAgICBpZiAoCiAgICAgICAgICAhR2FtZS5mdWxsRGF0ZSB8fAogICAgICAgICAgRGF0ZS5ub3coKSAtIEdhbWUuZnVsbERhdGUgPj0gMzY1ICogMjQgKiA2MCAqIDYwICogMTAwMAogICAgICAgICkKICAgICAgICAgIEdhbWUuV2luKCJTbyBtdWNoIHRvIGRvIHNvIG11Y2ggdG8gc2VlIik7CgogICAgICAgIGlmICgKICAgICAgICAgIEdhbWUuY29va2llc0Vhcm5lZCA+PSAxMDAwMDAwICYmCiAgICAgICAgICAoR2FtZS5hc2NlbnNpb25Nb2RlID09IDEgfHwgR2FtZS5yZXNldHMgPT0gMCkKICAgICAgICApIHsKICAgICAgICAgIC8vY2hhbGxlbmdlIHJ1biBvciBoYXNuJ3QgYXNjZW5kZWQgeWV0CiAgICAgICAgICBpZiAodGltZVBsYXllZCA8PSAxMDAwICogNjAgKiAzNSkgR2FtZS5XaW4oIlNwZWVkIGJha2luZyBJIik7CiAgICAgICAgICBpZiAodGltZVBsYXllZCA8PSAxMDAwICogNjAgKiAyNSkgR2FtZS5XaW4oIlNwZWVkIGJha2luZyBJSSIpOwogICAgICAgICAgaWYgKHRpbWVQbGF5ZWQgPD0gMTAwMCAqIDYwICogMTUpIEdhbWUuV2luKCJTcGVlZCBiYWtpbmcgSUlJIik7CgogICAgICAgICAgaWYgKEdhbWUuY29va2llQ2xpY2tzIDw9IDE1KSBHYW1lLldpbigiTmV2ZXJjbGljayIpOwogICAgICAgICAgaWYgKEdhbWUuY29va2llQ2xpY2tzIDw9IDApIEdhbWUuV2luKCJUcnVlIE5ldmVyY2xpY2siKTsKICAgICAgICAgIGlmIChHYW1lLmNvb2tpZXNFYXJuZWQgPj0gMTAwMDAwMDAwMCAmJiBHYW1lLlVwZ3JhZGVzT3duZWQgPT0gMCkKICAgICAgICAgICAgR2FtZS5XaW4oIkhhcmRjb3JlIik7CiAgICAgICAgfQoKICAgICAgICBmb3IgKHZhciBpIGluIEdhbWUuVW5sb2NrQXQpIHsKICAgICAgICAgIHZhciB1bmxvY2sgPSBHYW1lLlVubG9ja0F0W2ldOwogICAgICAgICAgaWYgKEdhbWUuY29va2llc0Vhcm5lZCA+PSB1bmxvY2suY29va2llcykgewogICAgICAgICAgICB2YXIgcGFzcyA9IDE7CiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICB1bmxvY2sucmVxdWlyZSAmJgogICAgICAgICAgICAgICFHYW1lLkhhcyh1bmxvY2sucmVxdWlyZSkgJiYKICAgICAgICAgICAgICAhR2FtZS5IYXNBY2hpZXYodW5sb2NrLnJlcXVpcmUpCiAgICAgICAgICAgICkKICAgICAgICAgICAgICBwYXNzID0gMDsKICAgICAgICAgICAgaWYgKHVubG9jay5zZWFzb24gJiYgR2FtZS5zZWFzb24gIT0gdW5sb2NrLnNlYXNvbikgcGFzcyA9IDA7CiAgICAgICAgICAgIGlmIChwYXNzKSB7CiAgICAgICAgICAgICAgR2FtZS5VbmxvY2sodW5sb2NrLm5hbWUpOwogICAgICAgICAgICAgIEdhbWUuV2luKHVubG9jay5uYW1lKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKEdhbWUuSGFzKCJHb2xkZW4gc3dpdGNoIikpIEdhbWUuVW5sb2NrKCJHb2xkZW4gc3dpdGNoIFtvZmZdIik7CiAgICAgICAgaWYgKAogICAgICAgICAgR2FtZS5IYXMoIlNoaW1tZXJpbmcgdmVpbCIpICYmCiAgICAgICAgICAhR2FtZS5IYXMoIlNoaW1tZXJpbmcgdmVpbCBbb2ZmXSIpICYmCiAgICAgICAgICAhR2FtZS5IYXMoIlNoaW1tZXJpbmcgdmVpbCBbb25dIikKICAgICAgICApIHsKICAgICAgICAgIEdhbWUuVW5sb2NrKCJTaGltbWVyaW5nIHZlaWwgW29uXSIpOwogICAgICAgICAgR2FtZS5VcGdyYWRlc1siU2hpbW1lcmluZyB2ZWlsIFtvZmZdIl0uZWFybigpOwogICAgICAgIH0KICAgICAgICBpZiAoR2FtZS5IYXMoIlN1Z2FyIGNyYXZpbmciKSkgR2FtZS5VbmxvY2soIlN1Z2FyIGZyZW56eSIpOwogICAgICAgIGlmIChHYW1lLkhhcygiQ2xhc3NpYyBkYWlyeSBzZWxlY3Rpb24iKSkgR2FtZS5VbmxvY2soIk1pbGsgc2VsZWN0b3IiKTsKICAgICAgICBpZiAoR2FtZS5IYXMoIkJhc2ljIHdhbGxwYXBlciBhc3NvcnRtZW50IikpCiAgICAgICAgICBHYW1lLlVubG9jaygiQmFja2dyb3VuZCBzZWxlY3RvciIpOwogICAgICAgIGlmIChHYW1lLkhhcygiR29sZGVuIGNvb2tpZSBhbGVydCBzb3VuZCIpKQogICAgICAgICAgR2FtZS5VbmxvY2soIkdvbGRlbiBjb29raWUgc291bmQgc2VsZWN0b3IiKTsKICAgICAgICBpZiAoR2FtZS5IYXMoIlNvdW5kIHRlc3QiKSkgR2FtZS5VbmxvY2soIkp1a2Vib3giKTsKCiAgICAgICAgaWYgKEdhbWUuSGFzKCJQcmlzbSBoZWFydCBiaXNjdWl0cyIpKSBHYW1lLldpbigiTG92ZWx5IGNvb2tpZXMiKTsKICAgICAgICBpZiAoR2FtZS5zZWFzb24gPT0gImVhc3RlciIpIHsKICAgICAgICAgIHZhciBlZ2dzID0gMDsKICAgICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5lYXN0ZXJFZ2dzKSB7CiAgICAgICAgICAgIGlmIChHYW1lLkhhc1VubG9ja2VkKEdhbWUuZWFzdGVyRWdnc1tpXSkpIGVnZ3MrKzsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChlZ2dzID49IDEpIEdhbWUuV2luKCJUaGUgaHVudCBpcyBvbiIpOwogICAgICAgICAgaWYgKGVnZ3MgPj0gNykgR2FtZS5XaW4oIkVnZ2luZyBvbiIpOwogICAgICAgICAgaWYgKGVnZ3MgPj0gMTQpIEdhbWUuV2luKCJNYXNzIEVhc3RlcmlhIik7CiAgICAgICAgICBpZiAoZWdncyA+PSBHYW1lLmVhc3RlckVnZ3MubGVuZ3RoKSBHYW1lLldpbigiSGlkZSAmIHNlZWsgY2hhbXBpb24iKTsKICAgICAgICB9CgogICAgICAgIGlmIChHYW1lLkhhcygiRm9ydHVuZSBjb29raWVzIikpIHsKICAgICAgICAgIHZhciBsaXN0ID0gR2FtZS5UaWVyc1siZm9ydHVuZSJdLnVwZ3JhZGVzOwogICAgICAgICAgdmFyIGZvcnR1bmVzID0gMDsKICAgICAgICAgIGZvciAodmFyIGkgaW4gbGlzdCkgewogICAgICAgICAgICBpZiAoR2FtZS5IYXMobGlzdFtpXS5uYW1lKSkgZm9ydHVuZXMrKzsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChmb3J0dW5lcyA+PSBsaXN0Lmxlbmd0aCkgR2FtZS5XaW4oIk8gRm9ydHVuYSIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKEdhbWUuSGFzKCJMZWdhY3kiKSAmJiBHYW1lLmFzY2Vuc2lvbk1vZGUgIT0gMSkgewogICAgICAgICAgR2FtZS5VbmxvY2soIkhlYXZlbmx5IGNoaXAgc2VjcmV0Iik7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIkhlYXZlbmx5IGNoaXAgc2VjcmV0IikpCiAgICAgICAgICAgIEdhbWUuVW5sb2NrKCJIZWF2ZW5seSBjb29raWUgc3RhbmQiKTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiSGVhdmVubHkgY29va2llIHN0YW5kIikpIEdhbWUuVW5sb2NrKCJIZWF2ZW5seSBiYWtlcnkiKTsKICAgICAgICAgIGlmIChHYW1lLkhhcygiSGVhdmVubHkgYmFrZXJ5IikpCiAgICAgICAgICAgIEdhbWUuVW5sb2NrKCJIZWF2ZW5seSBjb25mZWN0aW9uZXJ5Iik7CiAgICAgICAgICBpZiAoR2FtZS5IYXMoIkhlYXZlbmx5IGNvbmZlY3Rpb25lcnkiKSkgR2FtZS5VbmxvY2soIkhlYXZlbmx5IGtleSIpOwoKICAgICAgICAgIGlmIChHYW1lLkhhcygiSGVhdmVubHkga2V5IikpIEdhbWUuV2luKCJXaG9sZXNvbWUiKTsKICAgICAgICB9CgogICAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5CYW5rQWNoaWV2ZW1lbnRzKSB7CiAgICAgICAgICBpZiAoR2FtZS5jb29raWVzRWFybmVkID49IEdhbWUuQmFua0FjaGlldmVtZW50c1tpXS50aHJlc2hvbGQpCiAgICAgICAgICAgIEdhbWUuV2luKEdhbWUuQmFua0FjaGlldmVtZW50c1tpXS5uYW1lKTsKICAgICAgICB9CgogICAgICAgIHZhciBidWlsZGluZ3NPd25lZCA9IDA7CiAgICAgICAgdmFyIG1hdGhlbWF0aWNpYW4gPSAxOwogICAgICAgIHZhciBiYXNlMTAgPSAxOwogICAgICAgIHZhciBtaW5BbW91bnQgPSAxMDAwMDA7CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICAgIGJ1aWxkaW5nc093bmVkICs9IEdhbWUuT2JqZWN0c1tpXS5hbW91bnQ7CiAgICAgICAgICBtaW5BbW91bnQgPSBNYXRoLm1pbihHYW1lLk9iamVjdHNbaV0uYW1vdW50LCBtaW5BbW91bnQpOwogICAgICAgICAgaWYgKCFHYW1lLkhhc0FjaGlldigiTWF0aGVtYXRpY2lhbiIpKSB7CiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICBHYW1lLk9iamVjdHNbaV0uYW1vdW50IDwKICAgICAgICAgICAgICBNYXRoLm1pbigKICAgICAgICAgICAgICAgIDEyOCwKICAgICAgICAgICAgICAgIE1hdGgucG93KDIsIEdhbWUuT2JqZWN0c0J5SWQubGVuZ3RoIC0gR2FtZS5PYmplY3RzW2ldLmlkIC0gMSkKICAgICAgICAgICAgICApCiAgICAgICAgICAgICkKICAgICAgICAgICAgICBtYXRoZW1hdGljaWFuID0gMDsKICAgICAgICAgIH0KICAgICAgICAgIGlmICghR2FtZS5IYXNBY2hpZXYoIkJhc2UgMTAiKSkgewogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgR2FtZS5PYmplY3RzW2ldLmFtb3VudCA8CiAgICAgICAgICAgICAgKEdhbWUuT2JqZWN0c0J5SWQubGVuZ3RoIC0gR2FtZS5PYmplY3RzW2ldLmlkKSAqIDEwCiAgICAgICAgICAgICkKICAgICAgICAgICAgICBiYXNlMTAgPSAwOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAobWluQW1vdW50ID49IDEpIEdhbWUuV2luKCJPbmUgd2l0aCBldmVyeXRoaW5nIik7CiAgICAgICAgaWYgKG1hdGhlbWF0aWNpYW4gPT0gMSkgR2FtZS5XaW4oIk1hdGhlbWF0aWNpYW4iKTsKICAgICAgICBpZiAoYmFzZTEwID09IDEpIEdhbWUuV2luKCJCYXNlIDEwIik7CiAgICAgICAgaWYgKG1pbkFtb3VudCA+PSAxMDApIHsKICAgICAgICAgIEdhbWUuV2luKCJDZW50ZW5uaWFsIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiTWlsayBjaG9jb2xhdGUgYnV0dGVyIGJpc2N1aXQiKTsKICAgICAgICB9CiAgICAgICAgaWYgKG1pbkFtb3VudCA+PSAxNTApIHsKICAgICAgICAgIEdhbWUuV2luKCJDZW50ZW5uaWFsIGFuZCBhIGhhbGYiKTsKICAgICAgICAgIEdhbWUuVW5sb2NrKCJEYXJrIGNob2NvbGF0ZSBidXR0ZXIgYmlzY3VpdCIpOwogICAgICAgIH0KICAgICAgICBpZiAobWluQW1vdW50ID49IDIwMCkgewogICAgICAgICAgR2FtZS5XaW4oIkJpY2VudGVubmlhbCIpOwogICAgICAgICAgR2FtZS5VbmxvY2soIldoaXRlIGNob2NvbGF0ZSBidXR0ZXIgYmlzY3VpdCIpOwogICAgICAgIH0KICAgICAgICBpZiAobWluQW1vdW50ID49IDI1MCkgewogICAgICAgICAgR2FtZS5XaW4oIkJpY2VudGVubmlhbCBhbmQgYSBoYWxmIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiUnVieSBjaG9jb2xhdGUgYnV0dGVyIGJpc2N1aXQiKTsKICAgICAgICB9CiAgICAgICAgaWYgKG1pbkFtb3VudCA+PSAzMDApIHsKICAgICAgICAgIEdhbWUuV2luKCJUcmljZW50ZW5uaWFsIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiTGF2ZW5kZXIgY2hvY29sYXRlIGJ1dHRlciBiaXNjdWl0Iik7CiAgICAgICAgfQogICAgICAgIGlmIChtaW5BbW91bnQgPj0gMzUwKSB7CiAgICAgICAgICBHYW1lLldpbigiVHJpY2VudGVubmlhbCBhbmQgYSBoYWxmIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiU3ludGhldGljIGNob2NvbGF0ZSBncmVlbiBob25leSBidXR0ZXIgYmlzY3VpdCIpOwogICAgICAgIH0KICAgICAgICBpZiAobWluQW1vdW50ID49IDQwMCkgewogICAgICAgICAgR2FtZS5XaW4oIlF1YWRyaWNlbnRlbm5pYWwiKTsKICAgICAgICAgIEdhbWUuVW5sb2NrKCJSb3lhbCByYXNwYmVycnkgY2hvY29sYXRlIGJ1dHRlciBiaXNjdWl0Iik7CiAgICAgICAgfQogICAgICAgIGlmIChtaW5BbW91bnQgPj0gNDUwKSB7CiAgICAgICAgICBHYW1lLldpbigiUXVhZHJpY2VudGVubmlhbCBhbmQgYSBoYWxmIik7CiAgICAgICAgICBHYW1lLlVubG9jaygKICAgICAgICAgICAgIlVsdHJhLWNvbmNlbnRyYXRlZCBoaWdoLWVuZXJneSBjaG9jb2xhdGUgYnV0dGVyIGJpc2N1aXQiCiAgICAgICAgICApOwogICAgICAgIH0KICAgICAgICBpZiAobWluQW1vdW50ID49IDUwMCkgewogICAgICAgICAgR2FtZS5XaW4oIlF1aW5jZW50ZW5uaWFsIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiUHVyZSBwaXRjaC1ibGFjayBjaG9jb2xhdGUgYnV0dGVyIGJpc2N1aXQiKTsKICAgICAgICB9CiAgICAgICAgaWYgKG1pbkFtb3VudCA+PSA1NTApIHsKICAgICAgICAgIEdhbWUuV2luKCJRdWluY2VudGVubmlhbCBhbmQgYSBoYWxmIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiQ29zbWljIGNob2NvbGF0ZSBidXR0ZXIgYmlzY3VpdCIpOwogICAgICAgIH0KICAgICAgICBpZiAobWluQW1vdW50ID49IDYwMCkgewogICAgICAgICAgR2FtZS5XaW4oIlNleGNlbnRlbm5pYWwiKTsKICAgICAgICAgIEdhbWUuVW5sb2NrKCJCdXR0ZXIgYmlzY3VpdCAod2l0aCBidXR0ZXIpIik7CiAgICAgICAgfQogICAgICAgIGlmIChtaW5BbW91bnQgPj0gNjUwKSB7CiAgICAgICAgICBHYW1lLldpbigiU2V4Y2VudGVubmlhbCBhbmQgYSBoYWxmIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiRXZlcnlidXR0ZXIgYmlzY3VpdCIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKEdhbWUuaGFuZG1hZGVDb29raWVzID49IDEwMDApIHsKICAgICAgICAgIEdhbWUuV2luKCJDbGlja3Rhc3RpYyIpOwogICAgICAgICAgR2FtZS5VbmxvY2soIlBsYXN0aWMgbW91c2UiKTsKICAgICAgICB9CiAgICAgICAgaWYgKEdhbWUuaGFuZG1hZGVDb29raWVzID49IDEwMDAwMCkgewogICAgICAgICAgR2FtZS5XaW4oIkNsaWNrYXRobG9uIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiSXJvbiBtb3VzZSIpOwogICAgICAgIH0KICAgICAgICBpZiAoR2FtZS5oYW5kbWFkZUNvb2tpZXMgPj0gMTAwMDAwMDApIHsKICAgICAgICAgIEdhbWUuV2luKCJDbGlja29seW1waWNzIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiVGl0YW5pdW0gbW91c2UiKTsKICAgICAgICB9CiAgICAgICAgaWYgKEdhbWUuaGFuZG1hZGVDb29raWVzID49IDEwMDAwMDAwMDApIHsKICAgICAgICAgIEdhbWUuV2luKCJDbGlja29yYW1hIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiQWRhbWFudGl1bSBtb3VzZSIpOwogICAgICAgIH0KICAgICAgICBpZiAoR2FtZS5oYW5kbWFkZUNvb2tpZXMgPj0gMTAwMDAwMDAwMDAwKSB7CiAgICAgICAgICBHYW1lLldpbigiQ2xpY2thc21pYyIpOwogICAgICAgICAgR2FtZS5VbmxvY2soIlVub2J0YWluaXVtIG1vdXNlIik7CiAgICAgICAgfQogICAgICAgIGlmIChHYW1lLmhhbmRtYWRlQ29va2llcyA+PSAxMDAwMDAwMDAwMDAwMCkgewogICAgICAgICAgR2FtZS5XaW4oIkNsaWNrYWdlZGRvbiIpOwogICAgICAgICAgR2FtZS5VbmxvY2soIkVsdWRpdW0gbW91c2UiKTsKICAgICAgICB9CiAgICAgICAgaWYgKEdhbWUuaGFuZG1hZGVDb29raWVzID49IDEwMDAwMDAwMDAwMDAwMDApIHsKICAgICAgICAgIEdhbWUuV2luKCJDbGlja25hcm9rIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiV2lzaGFsbG95IG1vdXNlIik7CiAgICAgICAgfQogICAgICAgIGlmIChHYW1lLmhhbmRtYWRlQ29va2llcyA+PSAxMDAwMDAwMDAwMDAwMDAwMDApIHsKICAgICAgICAgIEdhbWUuV2luKCJDbGlja2FzdHJvcGhlIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiRmFudGFzdGVlbCBtb3VzZSIpOwogICAgICAgIH0KICAgICAgICBpZiAoR2FtZS5oYW5kbWFkZUNvb2tpZXMgPj0gMTAwMDAwMDAwMDAwMDAwMDAwMDApIHsKICAgICAgICAgIEdhbWUuV2luKCJDbGlja2F0YWNseXNtIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiTmV2ZXJjcmFjayBtb3VzZSIpOwogICAgICAgIH0KICAgICAgICBpZiAoR2FtZS5oYW5kbWFkZUNvb2tpZXMgPj0gMTAwMDAwMDAwMDAwMDAwMDAwMDAwMCkgewogICAgICAgICAgR2FtZS5XaW4oIlRoZSB1bHRpbWF0ZSBjbGlja2Rvd24iKTsKICAgICAgICAgIEdhbWUuVW5sb2NrKCJBcm15dGhyaWwgbW91c2UiKTsKICAgICAgICB9CiAgICAgICAgaWYgKEdhbWUuaGFuZG1hZGVDb29raWVzID49IDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCkgewogICAgICAgICAgR2FtZS5XaW4oIkFsbCB0aGUgb3RoZXIga2lkcyB3aXRoIHRoZSBwdW1wZWQgdXAgY2xpY2tzIik7CiAgICAgICAgICBHYW1lLlVubG9jaygiVGVjaG5vYnNpZGlhbiBtb3VzZSIpOwogICAgICAgIH0KICAgICAgICBpZiAoR2FtZS5oYW5kbWFkZUNvb2tpZXMgPj0gMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDApIHsKICAgICAgICAgIEdhbWUuV2luKCJPbmUuLi5tb3JlLi4uY2xpY2suLi4iKTsKICAgICAgICAgIEdhbWUuVW5sb2NrKCJQbGFzbWFyYmxlIG1vdXNlIik7CiAgICAgICAgfQogICAgICAgIGlmIChHYW1lLmhhbmRtYWRlQ29va2llcyA+PSAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwKSB7CiAgICAgICAgICBHYW1lLldpbigiQ2xpY2tldHkgc3BsaXQiKTsKICAgICAgICAgIEdhbWUuVW5sb2NrKCJNaXJhY3VsaXRlIG1vdXNlIik7CiAgICAgICAgfQogICAgICAgIGlmIChHYW1lLmhhbmRtYWRlQ29va2llcyA+PSAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDApIHsKICAgICAgICAgIEdhbWUuV2luKCJBaW4ndCB0aGF0IGEgY2xpY2sgaW4gdGhlIGhlYWQiKTsKICAgICAgICAgIEdhbWUuVW5sb2NrKCJBZXRoZXJpY2UgbW91c2UiKTsKICAgICAgICB9CgogICAgICAgIGlmIChHYW1lLmNvb2tpZXNFYXJuZWQgPCBHYW1lLmNvb2tpZXMpCiAgICAgICAgICBHYW1lLldpbigiQ2hlYXRlZCBjb29raWVzIHRhc3RlIGF3ZnVsIik7CgogICAgICAgIGlmICgKICAgICAgICAgIEdhbWUuSGFzKCJTa3VsbCBjb29raWVzIikgJiYKICAgICAgICAgIEdhbWUuSGFzKCJHaG9zdCBjb29raWVzIikgJiYKICAgICAgICAgIEdhbWUuSGFzKCJCYXQgY29va2llcyIpICYmCiAgICAgICAgICBHYW1lLkhhcygiU2xpbWUgY29va2llcyIpICYmCiAgICAgICAgICBHYW1lLkhhcygiUHVtcGtpbiBjb29raWVzIikgJiYKICAgICAgICAgIEdhbWUuSGFzKCJFeWViYWxsIGNvb2tpZXMiKSAmJgogICAgICAgICAgR2FtZS5IYXMoIlNwaWRlciBjb29raWVzIikKICAgICAgICApCiAgICAgICAgICBHYW1lLldpbigiU3Bvb2t5IGNvb2tpZXMiKTsKICAgICAgICBpZiAoR2FtZS53cmlua2xlcnNQb3BwZWQgPj0gMSkgR2FtZS5XaW4oIkl0Y2hzY3JhdGNoZXIiKTsKICAgICAgICBpZiAoR2FtZS53cmlua2xlcnNQb3BwZWQgPj0gNTApIEdhbWUuV2luKCJXcmlua2xlc3F1aXNoZXIiKTsKICAgICAgICBpZiAoR2FtZS53cmlua2xlcnNQb3BwZWQgPj0gMjAwKSBHYW1lLldpbigiTW9pc3RidXJzdGVyIik7CgogICAgICAgIGlmICgKICAgICAgICAgIEdhbWUuY29va2llc0Vhcm5lZCA+PSAxMDAwMDAwICYmCiAgICAgICAgICBHYW1lLkhhcygiSG93IHRvIGJha2UgeW91ciBkcmFnb24iKQogICAgICAgICkKICAgICAgICAgIEdhbWUuVW5sb2NrKCJBIGNydW1ibHkgZWdnIik7CgogICAgICAgIGlmIChHYW1lLmNvb2tpZXNFYXJuZWQgPj0gMjUgJiYgR2FtZS5zZWFzb24gPT0gImNocmlzdG1hcyIpCiAgICAgICAgICBHYW1lLlVubG9jaygiQSBmZXN0aXZlIGhhdCIpOwogICAgICAgIGlmICgKICAgICAgICAgIEdhbWUuSGFzKCJDaHJpc3RtYXMgdHJlZSBiaXNjdWl0cyIpICYmCiAgICAgICAgICBHYW1lLkhhcygiU25vd2ZsYWtlIGJpc2N1aXRzIikgJiYKICAgICAgICAgIEdhbWUuSGFzKCJTbm93bWFuIGJpc2N1aXRzIikgJiYKICAgICAgICAgIEdhbWUuSGFzKCJIb2xseSBiaXNjdWl0cyIpICYmCiAgICAgICAgICBHYW1lLkhhcygiQ2FuZHkgY2FuZSBiaXNjdWl0cyIpICYmCiAgICAgICAgICBHYW1lLkhhcygiQmVsbCBiaXNjdWl0cyIpICYmCiAgICAgICAgICBHYW1lLkhhcygiUHJlc2VudCBiaXNjdWl0cyIpCiAgICAgICAgKQogICAgICAgICAgR2FtZS5XaW4oIkxldCBpdCBzbm93Iik7CgogICAgICAgIGlmIChHYW1lLnJlaW5kZWVyQ2xpY2tlZCA+PSAxKSBHYW1lLldpbigiT2ggZGVlciIpOwogICAgICAgIGlmIChHYW1lLnJlaW5kZWVyQ2xpY2tlZCA+PSA1MCkgR2FtZS5XaW4oIlNsZWlnaCBvZiBoYW5kIik7CiAgICAgICAgaWYgKEdhbWUucmVpbmRlZXJDbGlja2VkID49IDIwMCkgR2FtZS5XaW4oIlJlaW5kZWVyIHNsZWlnaGVyIik7CgogICAgICAgIGlmIChidWlsZGluZ3NPd25lZCA+PSAxMDApIEdhbWUuV2luKCJCdWlsZGVyIik7CiAgICAgICAgaWYgKGJ1aWxkaW5nc093bmVkID49IDUwMCkgR2FtZS5XaW4oIkFyY2hpdGVjdCIpOwogICAgICAgIGlmIChidWlsZGluZ3NPd25lZCA+PSAxMDAwKSBHYW1lLldpbigiRW5naW5lZXIiKTsKICAgICAgICBpZiAoYnVpbGRpbmdzT3duZWQgPj0gMjUwMCkgR2FtZS5XaW4oIkxvcmQgb2YgQ29uc3RydWN0cyIpOwogICAgICAgIGlmIChidWlsZGluZ3NPd25lZCA+PSA1MDAwKSBHYW1lLldpbigiR3JhbmQgZGVzaWduIik7CiAgICAgICAgaWYgKGJ1aWxkaW5nc093bmVkID49IDc1MDApIEdhbWUuV2luKCJFY3VtZW5vcG9saXMiKTsKICAgICAgICBpZiAoYnVpbGRpbmdzT3duZWQgPj0gMTAwMDApIEdhbWUuV2luKCJNeXJpYWQiKTsKICAgICAgICBpZiAoR2FtZS5VcGdyYWRlc093bmVkID49IDIwKSBHYW1lLldpbigiRW5oYW5jZXIiKTsKICAgICAgICBpZiAoR2FtZS5VcGdyYWRlc093bmVkID49IDUwKSBHYW1lLldpbigiQXVnbWVudGVyIik7CiAgICAgICAgaWYgKEdhbWUuVXBncmFkZXNPd25lZCA+PSAxMDApIEdhbWUuV2luKCJVcGdyYWRlciIpOwogICAgICAgIGlmIChHYW1lLlVwZ3JhZGVzT3duZWQgPj0gMjAwKSBHYW1lLldpbigiTG9yZCBvZiBQcm9ncmVzcyIpOwogICAgICAgIGlmIChHYW1lLlVwZ3JhZGVzT3duZWQgPj0gMzAwKSBHYW1lLldpbigiVGhlIGZ1bGwgcGljdHVyZSIpOwogICAgICAgIGlmIChHYW1lLlVwZ3JhZGVzT3duZWQgPj0gNDAwKQogICAgICAgICAgR2FtZS5XaW4oIldoZW4gdGhlcmUncyBub3RoaW5nIGxlZnQgdG8gYWRkIik7CiAgICAgICAgaWYgKEdhbWUuVXBncmFkZXNPd25lZCA+PSA1MDApIEdhbWUuV2luKCJLYWl6ZW4iKTsKICAgICAgICBpZiAoR2FtZS5VcGdyYWRlc093bmVkID49IDYwMCkgR2FtZS5XaW4oIkJleW9uZCBxdWFsaXR5Iik7CiAgICAgICAgaWYgKGJ1aWxkaW5nc093bmVkID49IDQwMDAgJiYgR2FtZS5VcGdyYWRlc093bmVkID49IDMwMCkKICAgICAgICAgIEdhbWUuV2luKCJQb2x5bWF0aCIpOwogICAgICAgIGlmIChidWlsZGluZ3NPd25lZCA+PSA4MDAwICYmIEdhbWUuVXBncmFkZXNPd25lZCA+PSA0MDApCiAgICAgICAgICBHYW1lLldpbigiUmVuYWlzc2FuY2UgYmFrZXIiKTsKCiAgICAgICAgaWYgKCFHYW1lLkhhc0FjaGlldigiSmVsbGljbGVzIikpIHsKICAgICAgICAgIHZhciBraXR0ZW5zID0gMDsKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgR2FtZS5VcGdyYWRlc0J5UG9vbFsia2l0dGVuIl0ubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKEdhbWUuSGFzKEdhbWUuVXBncmFkZXNCeVBvb2xbImtpdHRlbiJdW2ldLm5hbWUpKSBraXR0ZW5zKys7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoa2l0dGVucyA+PSAxMCkgR2FtZS5XaW4oIkplbGxpY2xlcyIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKEdhbWUuY29va2llc0Vhcm5lZCA+PSAxZTE0ICYmICFHYW1lLkhhc0FjaGlldigiWW91IHdpbiBhIGNvb2tpZSIpKSB7CiAgICAgICAgICBHYW1lLldpbigiWW91IHdpbiBhIGNvb2tpZSIpOwogICAgICAgICAgR2FtZS5FYXJuKDEpOwogICAgICAgIH0KCiAgICAgICAgaWYgKEdhbWUuc2hpbW1lclR5cGVzWyJnb2xkZW4iXS5uID49IDQpIEdhbWUuV2luKCJGb3VyLWxlYWYgY29va2llIik7CgogICAgICAgIHZhciBncmFuZG1hcyA9IDA7CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLkdyYW5kbWFTeW5lcmdpZXMpIHsKICAgICAgICAgIGlmIChHYW1lLkhhcyhHYW1lLkdyYW5kbWFTeW5lcmdpZXNbaV0pKSBncmFuZG1hcysrOwogICAgICAgIH0KICAgICAgICBpZiAoIUdhbWUuSGFzQWNoaWV2KCJFbGRlciIpICYmIGdyYW5kbWFzID49IDcpIEdhbWUuV2luKCJFbGRlciIpOwogICAgICAgIGlmICghR2FtZS5IYXNBY2hpZXYoIlZldGVyYW4iKSAmJiBncmFuZG1hcyA+PSAxNCkgR2FtZS5XaW4oIlZldGVyYW4iKTsKICAgICAgICBpZiAoCiAgICAgICAgICBHYW1lLk9iamVjdHNbIkdyYW5kbWEiXS5hbW91bnQgPj0gNiAmJgogICAgICAgICAgIUdhbWUuSGFzKCJCaW5nbyBjZW50ZXIvUmVzZWFyY2ggZmFjaWxpdHkiKSAmJgogICAgICAgICAgR2FtZS5IYXNBY2hpZXYoIkVsZGVyIikKICAgICAgICApCiAgICAgICAgICBHYW1lLlVubG9jaygiQmluZ28gY2VudGVyL1Jlc2VhcmNoIGZhY2lsaXR5Iik7CiAgICAgICAgaWYgKEdhbWUucGxlZGdlcyA+IDApIEdhbWUuV2luKCJFbGRlciBuYXAiKTsKICAgICAgICBpZiAoR2FtZS5wbGVkZ2VzID49IDUpIEdhbWUuV2luKCJFbGRlciBzbHVtYmVyIik7CiAgICAgICAgaWYgKEdhbWUucGxlZGdlcyA+PSAxMCkgR2FtZS5VbmxvY2soIlNhY3JpZmljaWFsIHJvbGxpbmcgcGlucyIpOwogICAgICAgIGlmICgKICAgICAgICAgIEdhbWUuT2JqZWN0c1siQ3Vyc29yIl0uYW1vdW50ICsgR2FtZS5PYmplY3RzWyJHcmFuZG1hIl0uYW1vdW50ID49CiAgICAgICAgICA3NzcKICAgICAgICApCiAgICAgICAgICBHYW1lLldpbigiVGhlIGVsZGVyIHNjcm9sbHMiKTsKCiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICAgIHZhciBpdCA9IEdhbWUuT2JqZWN0c1tpXTsKICAgICAgICAgIGZvciAodmFyIGlpIGluIGl0LnByb2R1Y3Rpb25BY2hpZXZzKSB7CiAgICAgICAgICAgIGlmIChpdC50b3RhbENvb2tpZXMgPj0gaXQucHJvZHVjdGlvbkFjaGlldnNbaWldLnBvdykKICAgICAgICAgICAgICBHYW1lLldpbihpdC5wcm9kdWN0aW9uQWNoaWV2c1tpaV0uYWNoaWV2Lm5hbWUpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKAogICAgICAgICAgIUdhbWUuSGFzQWNoaWV2KCJDb29raWUtZHVua2VyIikgJiYKICAgICAgICAgIEdhbWUuTGVmdEJhY2tncm91bmQgJiYKICAgICAgICAgIEdhbWUubWlsa1Byb2dyZXNzID4gMC4xICYmCiAgICAgICAgICBHYW1lLkxlZnRCYWNrZ3JvdW5kLmNhbnZhcy5oZWlnaHQgKiAwLjQgKyAyNTYgLyAyIC0gMTYgPgogICAgICAgICAgICAoMSAtIEdhbWUubWlsa0hkKSAqIEdhbWUuTGVmdEJhY2tncm91bmQuY2FudmFzLmhlaWdodAogICAgICAgICkKICAgICAgICAgIEdhbWUuV2luKCJDb29raWUtZHVua2VyIik7CiAgICAgICAgLy8mJiBsKCdiaWdDb29raWUnKS5nZXRCb3VuZHMoKS5ib3R0b20+bCgnbWlsaycpLmdldEJvdW5kcygpLnRvcCsxNiAmJiBHYW1lLm1pbGtQcm9ncmVzcz4wLjEpIEdhbWUuV2luKCdDb29raWUtZHVua2VyJyk7CgogICAgICAgIEdhbWUucnVuTW9kSG9vaygiY2hlY2siKTsKICAgICAgfQoKICAgICAgR2FtZS5jb29raWVzZCArPSAoR2FtZS5jb29raWVzIC0gR2FtZS5jb29raWVzZCkgKiAwLjM7CgogICAgICBpZiAoR2FtZS5zdG9yZVRvUmVmcmVzaCkgR2FtZS5SZWZyZXNoU3RvcmUoKTsKICAgICAgaWYgKEdhbWUudXBncmFkZXNUb1JlYnVpbGQpIEdhbWUuUmVidWlsZFVwZ3JhZGVzKCk7CgogICAgICBHYW1lLnVwZGF0ZVNoaW1tZXJzKCk7CiAgICAgIEdhbWUudXBkYXRlQnVmZnMoKTsKCiAgICAgIEdhbWUuVXBkYXRlVGlja2VyKCk7CiAgICB9CgogICAgaWYgKEdhbWUuVCAlIChHYW1lLmZwcyAqIDIpID09IDApIHsKICAgICAgdmFyIHRpdGxlID0gIkNvb2tpZSBDbGlja2VyIjsKICAgICAgaWYgKEdhbWUuc2Vhc29uID09ICJmb29scyIpIHRpdGxlID0gIkNvb2tpZSBCYWtlciI7CiAgICAgIGRvY3VtZW50LnRpdGxlID0KICAgICAgICAoR2FtZS5PbkFzY2VuZCA/IChFTiA/ICJBc2NlbmRpbmchICIgOiBsb2MoIkFzY2VuZGluZyIpICsgIiB8ICIpIDogIiIpICsKICAgICAgICBsb2MoIiUxIGNvb2tpZSIsIExCZWF1dGlmeShHYW1lLmNvb2tpZXMpKSArCiAgICAgICAgIiAtICIgKwogICAgICAgIHRpdGxlOwogICAgfQogICAgaWYgKEdhbWUuVCAlIDE1ID09IDApIHsKICAgICAgLy93cml0dGVuIHRocm91Z2ggdGhlIG1hZ2ljIG9mICJob3BlIGZvciB0aGUgYmVzdCIgbWF0aHMKICAgICAgdmFyIGNoaXBzT3duZWQgPSBHYW1lLkhvd011Y2hQcmVzdGlnZShHYW1lLmNvb2tpZXNSZXNldCk7CiAgICAgIHZhciBhc2NlbmROb3dUb093biA9IE1hdGguZmxvb3IoCiAgICAgICAgR2FtZS5Ib3dNdWNoUHJlc3RpZ2UoR2FtZS5jb29raWVzUmVzZXQgKyBHYW1lLmNvb2tpZXNFYXJuZWQpCiAgICAgICk7CiAgICAgIHZhciBhc2NlbmROb3dUb0dldCA9IGFzY2VuZE5vd1RvT3duIC0gTWF0aC5mbG9vcihjaGlwc093bmVkKTsKICAgICAgdmFyIG5leHRDaGlwQXQgPQogICAgICAgIEdhbWUuSG93TWFueUNvb2tpZXNSZXNldChNYXRoLmZsb29yKGNoaXBzT3duZWQgKyBhc2NlbmROb3dUb0dldCArIDEpKSAtCiAgICAgICAgR2FtZS5Ib3dNYW55Q29va2llc1Jlc2V0KE1hdGguZmxvb3IoY2hpcHNPd25lZCArIGFzY2VuZE5vd1RvR2V0KSk7CiAgICAgIHZhciBjb29raWVzVG9OZXh0ID0KICAgICAgICBHYW1lLkhvd01hbnlDb29raWVzUmVzZXQoYXNjZW5kTm93VG9Pd24gKyAxKSAtCiAgICAgICAgKEdhbWUuY29va2llc0Vhcm5lZCArIEdhbWUuY29va2llc1Jlc2V0KTsKICAgICAgdmFyIHBlcmNlbnQgPSAxIC0gY29va2llc1RvTmV4dCAvIG5leHRDaGlwQXQ7CgogICAgICAvL2ZpbGwgdGhlIHRvb2x0aXAgdW5kZXIgdGhlIExlZ2FjeSB0YWIKICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgpOwogICAgICBkYXRlLnNldFRpbWUoRGF0ZS5ub3coKSAtIEdhbWUuc3RhcnREYXRlKTsKICAgICAgdmFyIHRpbWVJblNlY29uZHMgPSBkYXRlLmdldFRpbWUoKSAvIDEwMDA7CiAgICAgIHZhciBzdGFydERhdGUgPSBHYW1lLnNheVRpbWUodGltZUluU2Vjb25kcyAqIEdhbWUuZnBzLCAtMSk7CgogICAgICB2YXIgc3RyID0gIiI7CiAgICAgIGlmIChFTikKICAgICAgICBzdHIgKz0KICAgICAgICAgICJZb3UndmUgYmVlbiBvbiB0aGlzIHJ1biBmb3IgPGI+IiArCiAgICAgICAgICAoc3RhcnREYXRlID09ICIiID8gIm5vdCB2ZXJ5IGxvbmciIDogc3RhcnREYXRlKSArCiAgICAgICAgICAiPC9iPi48YnI+IjsKICAgICAgZWxzZQogICAgICAgIHN0ciArPQogICAgICAgICAgbG9jKCJZb3UndmUgYmVlbiBvbiB0aGlzIHJ1biBmb3IgPGI+JTE8L2I+LiIsIHN0YXJ0RGF0ZSkgKyAiPGJyPiI7CiAgICAgIHN0ciArPSAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JzsKICAgICAgaWYgKEdhbWUucHJlc3RpZ2UgPiAwKSB7CiAgICAgICAgc3RyICs9IGxvYygKICAgICAgICAgICJZb3VyIHByZXN0aWdlIGxldmVsIGlzIGN1cnJlbnRseSA8Yj4lMTwvYj4uPGJyPihDcFMgKyUyJSkiLAogICAgICAgICAgW0JlYXV0aWZ5KEdhbWUucHJlc3RpZ2UpLCBCZWF1dGlmeShHYW1lLnByZXN0aWdlKV0KICAgICAgICApOwogICAgICAgIHN0ciArPSAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JzsKICAgICAgfQogICAgICBpZiAoYXNjZW5kTm93VG9HZXQgPCAxKQogICAgICAgIHN0ciArPSBsb2MoIkFzY2VuZGluZyBub3cgd291bGQgZ3JhbnQgeW91IG5vIHByZXN0aWdlLiIpOwogICAgICBlbHNlIGlmIChhc2NlbmROb3dUb0dldCA8IDIpCiAgICAgICAgc3RyICs9IGxvYygKICAgICAgICAgICJBc2NlbmRpbmcgbm93IHdvdWxkIGdyYW50IHlvdTxicj48Yj4xIHByZXN0aWdlIGxldmVsPC9iPiAoKzElIENwUyk8YnI+YW5kIDxiPjEgaGVhdmVubHkgY2hpcDwvYj4gdG8gc3BlbmQuIgogICAgICAgICk7CiAgICAgIGVsc2UKICAgICAgICBzdHIgKz0gbG9jKAogICAgICAgICAgIkFzY2VuZGluZyBub3cgd291bGQgZ3JhbnQgeW91PGJyPjxiPiUxIHByZXN0aWdlIGxldmVsczwvYj4gKCslMiUgQ3BTKTxicj5hbmQgPGI+JTMgaGVhdmVubHkgY2hpcHM8L2I+IHRvIHNwZW5kLiIsCiAgICAgICAgICBbCiAgICAgICAgICAgIEJlYXV0aWZ5KGFzY2VuZE5vd1RvR2V0KSwKICAgICAgICAgICAgQmVhdXRpZnkoYXNjZW5kTm93VG9HZXQpLAogICAgICAgICAgICBCZWF1dGlmeShhc2NlbmROb3dUb0dldCksCiAgICAgICAgICBdCiAgICAgICAgKTsKICAgICAgaWYgKGNvb2tpZXNUb05leHQgPj0gMCkgewogICAgICAgIC8vbm90ZTogY29va2llc1RvTmV4dCBjYW4gYmUgbmVnYXRpdmUgYXQgaGlnaGVyIEhDIGFtb3VudHMgZHVlIHRvIHByZWNpc2lvbiBsb3NzLiB3ZSBzaW1wbHkgaGlkZSBpdCBpbiBzdWNoIGNhc2VzLCBhcyB0aGlzIHVzdWFsbHkgb25seSBvY2N1cnMgd2hlbiB0aGUgZ2FwIGlzIHNtYWxsIGFuZCByYXBpZGx5IG92ZXJjb21lIGFueXdheQogICAgICAgIHN0ciArPSAnPGRpdiBjbGFzcz0ibGluZSI+PC9kaXY+JzsKICAgICAgICBzdHIgKz0KICAgICAgICAgIGxvYygKICAgICAgICAgICAgIllvdSBuZWVkIDxiPiUxIG1vcmUgY29va2llczwvYj4gZm9yIHRoZSBuZXh0IGxldmVsLiIsCiAgICAgICAgICAgIEJlYXV0aWZ5KGNvb2tpZXNUb05leHQpCiAgICAgICAgICApICsgIjxicj4iOwogICAgICB9CiAgICAgIGwoImFzY2VuZFRvb2x0aXAiKS5pbm5lckhUTUwgPSBzdHI7CgogICAgICBpZiAoYXNjZW5kTm93VG9HZXQgPiAwKSB7CiAgICAgICAgLy9zaG93IG51bWJlciBzYXlpbmcgaG93IG1hbnkgY2hpcHMgeW91J2QgZ2V0IHJlc2V0dGluZyBub3cKICAgICAgICBHYW1lLmFzY2VuZE51bWJlci50ZXh0Q29udGVudCA9ICIrIiArIFNpbXBsZUJlYXV0aWZ5KGFzY2VuZE5vd1RvR2V0KTsKICAgICAgICBHYW1lLmFzY2VuZE51bWJlci5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgfSBlbHNlIHsKICAgICAgICBHYW1lLmFzY2VuZE51bWJlci5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICB9CgogICAgICBpZiAoCiAgICAgICAgYXNjZW5kTm93VG9HZXQgPiBHYW1lLmFzY2VuZE1ldGVyTGV2ZWwgfHwKICAgICAgICBHYW1lLmFzY2VuZE1ldGVyUGVyY2VudFQgPCBHYW1lLmFzY2VuZE1ldGVyUGVyY2VudAogICAgICApIHsKICAgICAgICAvL3Jlc2V0IHRoZSBnYXVnZSBhbmQgcGxheSBhIHNvdW5kIGlmIHdlIGdhaW5lZCBhIHBvdGVudGlhbCBsZXZlbAogICAgICAgIEdhbWUuYXNjZW5kTWV0ZXJQZXJjZW50ID0gMDsKICAgICAgICAvL1BsYXlTb3VuZCgnc25kL2xldmVsUHJlc3RpZ2UubXAzJyk7Ly9hIGJpdCB0b28gYW5ub3lpbmcKICAgICAgfQogICAgICBHYW1lLmFzY2VuZE1ldGVyTGV2ZWwgPSBhc2NlbmROb3dUb0dldDsKICAgICAgR2FtZS5hc2NlbmRNZXRlclBlcmNlbnRUID0gcGVyY2VudDsgLy9nYXVnZSB0aGF0IGZpbGxzIHVwIGFzIHlvdSBuZWFyIHlvdXIgbmV4dCBjaGlwCiAgICAgIC8vaWYgKEdhbWUuYXNjZW5kTWV0ZXJQZXJjZW50VDxHYW1lLmFzY2VuZE1ldGVyUGVyY2VudCkge0dhbWUuYXNjZW5kTWV0ZXJQZXJjZW50PTA7UGxheVNvdW5kKCdzbmQvbGV2ZWxQcmVzdGlnZS5tcDMnLDAuNSk7fQogICAgICAvL2lmIChwZXJjZW50Pj0xKSB7R2FtZS5hc2NlbmRNZXRlci5jbGFzc05hbWU9Jyc7fSBlbHNlIEdhbWUuYXNjZW5kTWV0ZXIuY2xhc3NOYW1lPSdmaWxsaW5nJzsKICAgIH0KICAgIC8vR2FtZS5hc2NlbmRNZXRlci5zdHlsZS5yaWdodD1NYXRoLmZsb29yKE1hdGgubWF4KDAsMS1HYW1lLmFzY2VuZE1ldGVyUGVyY2VudCkqMTAwKSsncHgnOwogICAgR2FtZS5hc2NlbmRNZXRlci5zdHlsZS5iYWNrZ3JvdW5kUG9zaXRpb24gPQogICAgICAtR2FtZS5UICogMC41IC0gR2FtZS5hc2NlbmRNZXRlclBlcmNlbnQgKiAxMDAgKyAicHgiOwogICAgR2FtZS5hc2NlbmRNZXRlci5zdHlsZS50cmFuc2Zvcm0gPQogICAgICAidHJhbnNsYXRlKCIgKwogICAgICBNYXRoLmZsb29yKC1NYXRoLm1heCgwLCAxIC0gR2FtZS5hc2NlbmRNZXRlclBlcmNlbnQpICogMTAwKSArCiAgICAgICIlLDBweCkiOwogICAgR2FtZS5hc2NlbmRNZXRlclBlcmNlbnQgKz0KICAgICAgKEdhbWUuYXNjZW5kTWV0ZXJQZXJjZW50VCAtIEdhbWUuYXNjZW5kTWV0ZXJQZXJjZW50KSAqIDAuMTsKCiAgICBHYW1lLk5vdGVzTG9naWMoKTsKICAgIGlmIChHYW1lLm1vdXNlTW92ZWQgfHwgR2FtZS5TY3JvbGwgfHwgR2FtZS50b29sdGlwLmR5bmFtaWMpCiAgICAgIEdhbWUudG9vbHRpcC51cGRhdGUoKTsKCiAgICBpZiAoCiAgICAgIEdhbWUuVCAlIChHYW1lLmZwcyAqIDUpID09IDAgJiYKICAgICAgIUdhbWUubW91c2VEb3duICYmCiAgICAgIChHYW1lLm9uTWVudSA9PSAic3RhdHMiIHx8IEdhbWUub25NZW51ID09ICJwcmVmcyIpCiAgICApCiAgICAgIEdhbWUuVXBkYXRlTWVudSgpOwogICAgaWYgKEdhbWUuVCAlIChHYW1lLmZwcyAqIDEpID09IDApIEdhbWUuVXBkYXRlUHJvbXB0KCk7CiAgICBpZiAoR2FtZS5Bc2NlbmRUaW1lciA+IDApIEdhbWUuVXBkYXRlQXNjZW5kSW50cm8oKTsKICAgIGlmIChHYW1lLlJlaW5jYXJuYXRlVGltZXIgPiAwKSBHYW1lLlVwZGF0ZVJlaW5jYXJuYXRlSW50cm8oKTsKICAgIGlmIChHYW1lLk9uQXNjZW5kKSBHYW1lLlVwZGF0ZUFzY2VuZCgpOwoKICAgIEdhbWUucnVuTW9kSG9vaygibG9naWMiKTsKCiAgICBpZiAoR2FtZS5zcGFya2xlc1QgPiAwKSB7CiAgICAgIEdhbWUuc3BhcmtsZXMuc3R5bGUuYmFja2dyb3VuZFBvc2l0aW9uID0KICAgICAgICAtTWF0aC5mbG9vcigoR2FtZS5zcGFya2xlc0ZyYW1lcyAtIEdhbWUuc3BhcmtsZXNUICsgMSkgKiAxMjgpICsKICAgICAgICAicHggMHB4IjsKICAgICAgR2FtZS5zcGFya2xlc1QtLTsKICAgICAgaWYgKEdhbWUuc3BhcmtsZXNUID09IDEpIEdhbWUuc3BhcmtsZXMuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgIH0KCiAgICBHYW1lLkNsaWNrID0gMDsKICAgIEdhbWUuU2Nyb2xsID0gMDsKICAgIEdhbWUubW91c2VNb3ZlZCA9IDA7CiAgICBHYW1lLkNhbkNsaWNrID0gMTsKCiAgICBpZiAoCiAgICAgIChHYW1lLnRvU2F2ZSB8fAogICAgICAgIChHYW1lLlQgJSAoR2FtZS5mcHMgKiA2MCkgPT0gMCAmJgogICAgICAgICAgR2FtZS5UID4gR2FtZS5mcHMgKiAxMCAmJgogICAgICAgICAgR2FtZS5wcmVmcy5hdXRvc2F2ZSkpICYmCiAgICAgICFHYW1lLk9uQXNjZW5kCiAgICApIHsKICAgICAgLy9jaGVjayBpZiB3ZSBjYW4gc2F2ZSA6IG5vIG1pbmlnYW1lcyBhcmUgbG9hZGluZwogICAgICB2YXIgY2FuU2F2ZSA9IHRydWU7CiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5PYmplY3RzW2ldOwogICAgICAgIGlmIChtZS5taW5pZ2FtZUxvYWRpbmcpIHsKICAgICAgICAgIGNhblNhdmUgPSBmYWxzZTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoY2FuU2F2ZSkgR2FtZS5Xcml0ZVNhdmUoKTsKICAgIH0KICAgIGlmICghR2FtZS50b1NhdmUgJiYgIUdhbWUuaXNTYXZpbmcpIHsKICAgICAgaWYgKEdhbWUudG9SZWxvYWQpIHsKICAgICAgICBHYW1lLnRvUmVsb2FkID0gZmFsc2U7CiAgICAgICAgaWYgKCFBcHApIHsKICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBBcHAucmVsb2FkKCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChHYW1lLnRvUXVpdCkgewogICAgICAgIEdhbWUudG9RdWl0ID0gZmFsc2U7CiAgICAgICAgaWYgKCFBcHApIHsKICAgICAgICAgIHdpbmRvdy5jbG9zZSgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBBcHAucXVpdCgpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGlmIChBcHAgJiYgQXBwLmxvZ2ljKSBBcHAubG9naWMoR2FtZS5UKTsKCiAgICAvL2V2ZXJ5IGhvdXI6IGdldCBzZXJ2ZXIgZGF0YSAoaWUuIHVwZGF0ZSBub3RpZmljYXRpb24sIHBhdHJlb24sIHN0ZWFtIGV0YykKICAgIGlmICgKICAgICAgR2FtZS5UICUgKEdhbWUuZnBzICogNjAgKiA2MCkgPT0gMCAmJgogICAgICBHYW1lLlQgPiBHYW1lLmZwcyAqIDEwIC8qICYmIEdhbWUucHJlZnMuYXV0b3VwZGF0ZSovCiAgICApIHsKICAgICAgR2FtZS5DaGVja1VwZGF0ZXMoKTsKICAgICAgR2FtZS5HcmFiRGF0YSgpOwogICAgfQoKICAgIEdhbWUuVCsrOwogIH07CgogIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJRFJBVwoJPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KCiAgR2FtZS5EcmF3ID0gZnVuY3Rpb24gKCkgewogICAgR2FtZS5EcmF3QmFja2dyb3VuZCgpOwogICAgVGltZXIudHJhY2soImVuZCBvZiBiYWNrZ3JvdW5kIik7CgogICAgaWYgKCFHYW1lLk9uQXNjZW5kKSB7CiAgICAgIHZhciBzdHIgPSBCZWF1dGlmeShNYXRoLnJvdW5kKEdhbWUuY29va2llc2QpKTsKICAgICAgaWYgKEdhbWUuY29va2llc2QgPj0gMTAwMDAwMCkgewogICAgICAgIC8vZGlydHkgcGFkZGluZwogICAgICAgIHZhciBzcGFjZVBvcyA9IHN0ci5pbmRleE9mKCIgIik7CiAgICAgICAgdmFyIGRvdFBvcyA9IHN0ci5pbmRleE9mKCIuIik7CiAgICAgICAgdmFyIGFkZCA9ICIiOwogICAgICAgIGlmIChzcGFjZVBvcyAhPSAtMSkgewogICAgICAgICAgaWYgKGRvdFBvcyA9PSAtMSkgYWRkICs9ICIuMDAwIjsKICAgICAgICAgIGVsc2UgewogICAgICAgICAgICBpZiAoc3BhY2VQb3MgLSBkb3RQb3MgPT0gMikgYWRkICs9ICIwMCI7CiAgICAgICAgICAgIGlmIChzcGFjZVBvcyAtIGRvdFBvcyA9PSAzKSBhZGQgKz0gIjAiOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBzdHIgPSBbc3RyLnNsaWNlKDAsIHNwYWNlUG9zKSwgYWRkLCBzdHIuc2xpY2Uoc3BhY2VQb3MpXS5qb2luKCIiKTsKICAgICAgfQoKICAgICAgc3RyID0gbG9jKCIlMSBjb29raWUiLCB7IG46IE1hdGgucm91bmQoR2FtZS5jb29raWVzZCksIGI6IHN0ciB9KTsKICAgICAgaWYgKHN0ci5sZW5ndGggPiAxNCkgc3RyID0gc3RyLnJlcGxhY2UoIiAiLCAiPGJyPiIpOwoKICAgICAgaWYgKEdhbWUucHJlZnMubW9ub3NwYWNlKQogICAgICAgIHN0ciA9ICc8c3BhbiBjbGFzcz0ibW9ub3NwYWNlIj4nICsgc3RyICsgIjwvc3Bhbj4iOwogICAgICBzdHIgPQogICAgICAgIHN0ciArCiAgICAgICAgJzxkaXYgaWQ9ImNvb2tpZXNQZXJTZWNvbmQiJyArCiAgICAgICAgKEdhbWUuY3BzU3Vja2VkID4gMCA/ICcgY2xhc3M9IndyaW5rbGVkIicgOiAiIikgKwogICAgICAgICI+IiArCiAgICAgICAgbG9jKCJwZXIgc2Vjb25kOiIpICsKICAgICAgICAiICIgKwogICAgICAgIEJlYXV0aWZ5KEdhbWUuY29va2llc1BzICogKDEgLSBHYW1lLmNwc1N1Y2tlZCksIDEpICsKICAgICAgICAiPC9kaXY+IjsKICAgICAgbCgiY29va2llcyIpLmlubmVySFRNTCA9IHN0cjsKICAgICAgVGltZXIudHJhY2soImNvb2tpZSBhbW91bnQiKTsKCiAgICAgIGZvciAodmFyIGkgaW4gR2FtZS5PYmplY3RzKSB7CiAgICAgICAgdmFyIG1lID0gR2FtZS5PYmplY3RzW2ldOwogICAgICAgIGlmIChtZS5vbk1pbmlnYW1lICYmIG1lLm1pbmlnYW1lLmRyYXcgJiYgIW1lLm11dGVkICYmICFHYW1lLm9uTWVudSkKICAgICAgICAgIG1lLm1pbmlnYW1lLmRyYXcoKTsKICAgICAgfQogICAgICBUaW1lci50cmFjaygiZHJhdyBtaW5pZ2FtZXMiKTsKCiAgICAgIGlmIChHYW1lLmRyYXdUICUgNSA9PSAwKSB7CiAgICAgICAgLy9pZiAoR2FtZS5wcmVmcy5tb25vc3BhY2UpIHtsKCdjb29raWVzJykuY2xhc3NOYW1lPSd0aXRsZSBtb25vc3BhY2UnO30gZWxzZSB7bCgnY29va2llcycpLmNsYXNzTmFtZT0ndGl0bGUnO30KICAgICAgICB2YXIgbGFzdExvY2tlZCA9IDA7CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLk9iamVjdHMpIHsKICAgICAgICAgIHZhciBtZSA9IEdhbWUuT2JqZWN0c1tpXTsKCiAgICAgICAgICAvL21ha2UgcHJvZHVjdHMgZnVsbC1vcGFjaXR5IGlmIHdlIGNhbiBidXkgdGhlbQogICAgICAgICAgdmFyIGNsYXNzZXMgPSAicHJvZHVjdCI7CiAgICAgICAgICB2YXIgcHJpY2UgPSBtZS5idWxrUHJpY2U7CiAgICAgICAgICBpZiAoR2FtZS5jb29raWVzRWFybmVkID49IG1lLmJhc2VQcmljZSB8fCBtZS5ib3VnaHQgPiAwKSB7CiAgICAgICAgICAgIGNsYXNzZXMgKz0gIiB1bmxvY2tlZCI7CiAgICAgICAgICAgIGxhc3RMb2NrZWQgPSAwOwogICAgICAgICAgICBtZS5sb2NrZWQgPSAwOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY2xhc3NlcyArPSAiIGxvY2tlZCI7CiAgICAgICAgICAgIGxhc3RMb2NrZWQrKzsKICAgICAgICAgICAgbWUubG9ja2VkID0gMTsKICAgICAgICAgIH0KICAgICAgICAgIGlmICgKICAgICAgICAgICAgKEdhbWUuYnV5TW9kZSA9PSAxICYmIEdhbWUuY29va2llcyA+PSBwcmljZSkgfHwKICAgICAgICAgICAgKEdhbWUuYnV5TW9kZSA9PSAtMSAmJiBtZS5hbW91bnQgPiAwKQogICAgICAgICAgKQogICAgICAgICAgICBjbGFzc2VzICs9ICIgZW5hYmxlZCI7CiAgICAgICAgICBlbHNlIGNsYXNzZXMgKz0gIiBkaXNhYmxlZCI7CiAgICAgICAgICBpZiAobGFzdExvY2tlZCA+IDIpIGNsYXNzZXMgKz0gIiB0b2dnbGVkT2ZmIjsKICAgICAgICAgIG1lLmwuY2xhc3NOYW1lID0gY2xhc3NlczsKICAgICAgICAgIC8vaWYgKG1lLmlkPjApIHtsKCdwcm9kdWN0TmFtZScrbWUuaWQpLmlubmVySFRNTD1CZWF1dGlmeShtZS5zdG9yZWRUb3RhbENwcy9HYW1lLk9iamVjdHNCeUlkW21lLmlkLTFdLnN0b3JlZFRvdGFsQ3BzLDIpO30KICAgICAgICB9CgogICAgICAgIC8vbWFrZSB1cGdyYWRlcyBmdWxsLW9wYWNpdHkgaWYgd2UgY2FuIGJ1eSB0aGVtCiAgICAgICAgdmFyIGxhc3RQcmljZSA9IDA7CiAgICAgICAgZm9yICh2YXIgaSBpbiBHYW1lLlVwZ3JhZGVzSW5TdG9yZSkgewogICAgICAgICAgdmFyIG1lID0gR2FtZS5VcGdyYWRlc0luU3RvcmVbaV07CiAgICAgICAgICBpZiAoIW1lLmJvdWdodCkgewogICAgICAgICAgICB2YXIgcHJpY2UgPSBtZS5nZXRQcmljZSgpOwogICAgICAgICAgICB2YXIgY2FuQnV5ID0gbWUuY2FuQnV5KCk7IC8vKEdhbWUuY29va2llcz49cHJpY2UpOwogICAgICAgICAgICB2YXIgZW5hYmxlZCA9IGwoInVwZ3JhZGUiICsgaSkuY2xhc3NOYW1lLmluZGV4T2YoImVuYWJsZWQiKSA+IC0xOwogICAgICAgICAgICBpZiAoKGNhbkJ1eSAmJiAhZW5hYmxlZCkgfHwgKCFjYW5CdXkgJiYgZW5hYmxlZCkpCiAgICAgICAgICAgICAgR2FtZS51cGdyYWRlc1RvUmVidWlsZCA9IDE7CiAgICAgICAgICAgIGlmIChwcmljZSA8IGxhc3RQcmljZSkgR2FtZS5zdG9yZVRvUmVmcmVzaCA9IDE7IC8vaXMgdGhpcyB1cGdyYWRlIGxlc3MgZXhwZW5zaXZlIHRoYW4gdGhlIHByZXZpb3VzIG9uZT8gdHJpZ2dlciBhIHJlZnJlc2ggdG8gc29ydCBpdCBhZ2FpbgogICAgICAgICAgICBsYXN0UHJpY2UgPSBwcmljZTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChtZS50aW1lckRpc3BsYXkpIHsKICAgICAgICAgICAgdmFyIFQgPSBtZS50aW1lckRpc3BsYXkoKTsKICAgICAgICAgICAgaWYgKFQgIT0gLTEpIHsKICAgICAgICAgICAgICBpZiAoIWwoInVwZ3JhZGVQaWVUaW1lciIgKyBpKSkKICAgICAgICAgICAgICAgIGwoInVwZ3JhZGUiICsgaSkuaW5uZXJIVE1MID0KICAgICAgICAgICAgICAgICAgbCgidXBncmFkZSIgKyBpKS5pbm5lckhUTUwgKwogICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0icGllVGltZXIiIGlkPSJ1cGdyYWRlUGllVGltZXInICsKICAgICAgICAgICAgICAgICAgaSArCiAgICAgICAgICAgICAgICAgICciPjwvZGl2Pic7CiAgICAgICAgICAgICAgVCA9IChUICogMTQ0KSAlIDE0NDsKICAgICAgICAgICAgICBsKCJ1cGdyYWRlUGllVGltZXIiICsgaSkuc3R5bGUuYmFja2dyb3VuZFBvc2l0aW9uID0KICAgICAgICAgICAgICAgIC1NYXRoLmZsb29yKFQgJSAxOCkgKiA0OCArCiAgICAgICAgICAgICAgICAicHggIiArCiAgICAgICAgICAgICAgICAtTWF0aC5mbG9vcihUIC8gMTgpICogNDggKwogICAgICAgICAgICAgICAgInB4IjsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIC8vaWYgKG1lLmNhbkJ1eSgpKSBsKCd1cGdyYWRlJytpKS5jbGFzc05hbWU9J2NyYXRlIHVwZ3JhZGUgZW5hYmxlZCc7IGVsc2UgbCgndXBncmFkZScraSkuY2xhc3NOYW1lPSdjcmF0ZSB1cGdyYWRlIGRpc2FibGVkJzsKICAgICAgICB9CiAgICAgIH0KICAgICAgVGltZXIudHJhY2soInN0b3JlIik7CgogICAgICBpZiAoR2FtZS5QQVJUWSkgewogICAgICAgIC8vaSB3YXMgYm9yZWQgYW5kIGZlbHQgbGlrZSBtZXNzaW5nIHdpdGggQ1NTCiAgICAgICAgdmFyIHB1bHNlID0gTWF0aC5wb3coKEdhbWUuVCAlIDEwKSAvIDEwLCAwLjUpOwogICAgICAgIEdhbWUubC5zdHlsZS5maWx0ZXIgPQogICAgICAgICAgImh1ZS1yb3RhdGUoIiArCiAgICAgICAgICAoKEdhbWUuVCAqIDUpICUgMzYwKSArCiAgICAgICAgICAiZGVnKSBicmlnaHRuZXNzKCIgKwogICAgICAgICAgKDE1MCAtIDUwICogcHVsc2UpICsKICAgICAgICAgICIlKSI7CiAgICAgICAgR2FtZS5sLnN0eWxlLndlYmtpdEZpbHRlciA9CiAgICAgICAgICAiaHVlLXJvdGF0ZSgiICsKICAgICAgICAgICgoR2FtZS5UICogNSkgJSAzNjApICsKICAgICAgICAgICJkZWcpIGJyaWdodG5lc3MoIiArCiAgICAgICAgICAoMTUwIC0gNTAgKiBwdWxzZSkgKwogICAgICAgICAgIiUpIjsKICAgICAgICBHYW1lLmwuc3R5bGUudHJhbnNmb3JtID0KICAgICAgICAgICJzY2FsZSgiICsKICAgICAgICAgICgxLjAyIC0gMC4wMiAqIHB1bHNlKSArCiAgICAgICAgICAiLCIgKwogICAgICAgICAgKDEuMDIgLSAwLjAyICogcHVsc2UpICsKICAgICAgICAgICIpIHJvdGF0ZSgiICsKICAgICAgICAgIE1hdGguc2luKEdhbWUuVCAqIDAuNSkgKiAwLjUgKwogICAgICAgICAgImRlZykiOwogICAgICAgIEdhbWUud3JhcHBlci5zdHlsZS5vdmVyZmxvd1ggPSAiaGlkZGVuIjsKICAgICAgICBHYW1lLndyYXBwZXIuc3R5bGUub3ZlcmZsb3dZID0gImhpZGRlbiI7CiAgICAgIH0KCiAgICAgIFRpbWVyLmNsZWFuKCk7CiAgICAgIGlmICgKICAgICAgICBHYW1lLnByZWZzLmFuaW1hdGUgJiYKICAgICAgICAoKEdhbWUucHJlZnMuZmFuY3kgJiYgR2FtZS5kcmF3VCAlIDEgPT0gMCkgfHwKICAgICAgICAgICghR2FtZS5wcmVmcy5mYW5jeSAmJiBHYW1lLmRyYXdUICUgMTAgPT0gMCkpICYmCiAgICAgICAgR2FtZS5Bc2NlbmRUaW1lciA9PSAwICYmCiAgICAgICAgR2FtZS5vbk1lbnUgPT0gIiIKICAgICAgKQogICAgICAgIEdhbWUuRHJhd0J1aWxkaW5ncygpOwogICAgICBUaW1lci50cmFjaygiYnVpbGRpbmdzIik7CgogICAgICBHYW1lLnRleHRQYXJ0aWNsZXNVcGRhdGUoKTsKICAgICAgVGltZXIudHJhY2soInRleHQgcGFydGljbGVzIik7CiAgICB9CgogICAgR2FtZS5Ob3Rlc0RyYXcoKTsKICAgIFRpbWVyLnRyYWNrKCJub3RlcyIpOwoKICAgIEdhbWUucnVuTW9kSG9vaygiZHJhdyIpOwoKICAgIEdhbWUuZHJhd1QrKzsKICAgIC8vaWYgKEdhbWUucHJlZnMuYWx0RHJhdykgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKEdhbWUuRHJhdyk7CiAgfTsKCiAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CglNQUlOIExPT1AKCT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCiAgR2FtZS5Mb29wID0gZnVuY3Rpb24gKCkgewogICAgaWYgKEdhbWUudGltZWRvdXQpIHJldHVybiBmYWxzZTsKICAgIFRpbWVyLnNheSgiU1RBUlQiKTsKICAgIFRpbWVyLnRyYWNrKCJicm93c2VyIHN0dWZmIik7CiAgICBUaW1lci5zYXkoIkxPR0lDIik7CiAgICAvL3VwZGF0ZSBnYW1lIGxvZ2ljICEKICAgIEdhbWUuY2F0Y2h1cExvZ2ljID0gMDsKICAgIEdhbWUuTG9naWMoKTsKICAgIEdhbWUuY2F0Y2h1cExvZ2ljID0gMTsKCiAgICB2YXIgdGltZSA9IERhdGUubm93KCk7CgogICAgLy9sYXRlbmN5IGNvbXBlbnNhdG9yCiAgICBHYW1lLmFjY3VtdWxhdGVkRGVsYXkgKz0gdGltZSAtIEdhbWUudGltZSAtIDEwMDAgLyBHYW1lLmZwczsKICAgIGlmIChHYW1lLnByZWZzLnRpbWVvdXQgJiYgdGltZSAtIEdhbWUubGFzdEFjdGl2aXR5ID49IDEwMDAgKiA2MCAqIDUpIHsKICAgICAgaWYgKEdhbWUuYWNjdW11bGF0ZWREZWxheSA+IDEwMDAgKiA2MCAqIDMwKQogICAgICAgIEdhbWUuZGVsYXlUaW1lb3V0cyArPSAzOyAvL21vcmUgdGhhbiAzMCBtaW51dGVzIGRlbGF5PyBjb21wdXRlciBwcm9iYWJseSBhc2xlZXAgYW5kIG5vdCBtYWtpbmcgY29va2llcyBhbnl3YXkKICAgICAgZWxzZSBpZiAoR2FtZS5hY2N1bXVsYXRlZERlbGF5ID4gMTAwMCAqIDUpIEdhbWUuZGVsYXlUaW1lb3V0cysrOyAvL2FkZCB0byB0aW1lb3V0IGNvdW50ZXIgd2hlbiB3ZSBza2lwIDEwIHNlY29uZHMgd29ydGggb2YgZnJhbWVzIChhbmQgdGhlIHBsYXllciBoYXMgYmVlbiBpbmFjdGl2ZSBmb3IgYXQgbGVhc3QgNSBtaW51dGVzKQogICAgICBpZiAoR2FtZS5kZWxheVRpbWVvdXRzID49IDMpIEdhbWUuVGltZW91dCgpOyAvL3RyaWdnZXIgdGltZW91dCB3aGVuIHRoZSB0aW1lb3V0IGNvdW50ZXIgaXMgMysKICAgIH0KCiAgICBHYW1lLmFjY3VtdWxhdGVkRGVsYXkgPSBNYXRoLm1pbihHYW1lLmFjY3VtdWxhdGVkRGVsYXksIDEwMDAgKiA1KTsgLy9kb24ndCBjb21wZW5zYXRlIG92ZXIgNSBzZWNvbmRzOyBpZiB5b3UgZG8sIHNvbWV0aGluZydzIHByb2JhYmx5IHZlcnkgd3JvbmcKICAgIEdhbWUudGltZSA9IHRpbWU7CgogICAgLy9pZiAoR2FtZS5hY2N1bXVsYXRlZERlbGF5Pj1HYW1lLmZwcykgY29uc29sZS5sb2coJ2RlbGF5OicsTWF0aC5yb3VuZChHYW1lLmFjY3VtdWxhdGVkRGVsYXkvR2FtZS5mcHMpKTsKICAgIHdoaWxlIChHYW1lLmFjY3VtdWxhdGVkRGVsYXkgPiAwKSB7CiAgICAgIEdhbWUuTG9naWMoKTsKICAgICAgR2FtZS5hY2N1bXVsYXRlZERlbGF5IC09IDEwMDAgLyBHYW1lLmZwczsgLy9hcyBsb25nIGFzIHdlJ3JlIGRldGVjdGluZyBsYXRlbmN5IChzbG93ZXIgdGhhbiB0YXJnZXQgZnBzKSwgZXhlY3V0ZSBsb2dpYyAodGhpcyBtYWtlcyBkcmF3aW5nIHNsb3dlciBidXQgbWFrZXMgdGhlIGxvZ2ljIGJlaGF2ZSBjbG9zZXIgdG8gY29ycmVjdCB0YXJnZXQgZnBzKQogICAgfQogICAgR2FtZS5jYXRjaHVwTG9naWMgPSAwOwogICAgVGltZXIudHJhY2soImxvZ2ljIik7CiAgICBUaW1lci5zYXkoIkVORCBMT0dJQyIpOwogICAgLyoKCQlpZiAoIUdhbWUucHJlZnMuYWx0RHJhdykKCQl7CgkJCXZhciBoYXNGb2N1cz1kb2N1bWVudC5oYXNGb2N1cygpOwoJCQlUaW1lci5zYXkoJ0RSQVcnKTsKCQkJaWYgKGhhc0ZvY3VzIHx8IEdhbWUucHJlZnMuZm9jdXMgfHwgR2FtZS5sb29wVCUxMD09MCkgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKEdhbWUuRHJhdyk7CgkJCS8vaWYgKGRvY3VtZW50Lmhhc0ZvY3VzKCkgfHwgR2FtZS5sb29wVCU1PT0wKSBHYW1lLkRyYXcoKTsKCQkJVGltZXIuc2F5KCdFTkQgRFJBVycpOwoJCX0KCQllbHNlIHJlcXVlc3RBbmltYXRpb25GcmFtZShHYW1lLkRyYXcpOyovCiAgICBpZiAoR2FtZS52aXNpYmxlKSBHYW1lLkRyYXcoKTsKCiAgICAvL2lmICghaGFzRm9jdXMpIEdhbWUudG9vbHRpcC5oaWRlKCk7CgogICAgaWYgKEdhbWUuc2VzYW1lKSB7CiAgICAgIC8vZnBzIGNvdW50ZXIgYW5kIGdyYXBoCiAgICAgIEdhbWUucHJldmlvdXNGcHMgPSBHYW1lLmN1cnJlbnRGcHM7CiAgICAgIEdhbWUuY3VycmVudEZwcyA9IEdhbWUuZ2V0RnBzKCk7CiAgICAgIHZhciBjdHggPSBHYW1lLmZwc0dyYXBoQ3R4OwogICAgICBjdHguZHJhd0ltYWdlKEdhbWUuZnBzR3JhcGgsIC0xLCAwKTsKICAgICAgY3R4LmZpbGxTdHlsZSA9CiAgICAgICAgInJnYigiICsgTWF0aC5yb3VuZCgoMSAtIEdhbWUuY3VycmVudEZwcyAvIEdhbWUuZnBzKSAqIDEyOCkgKyAiLDAsMCkiOwogICAgICBjdHguZmlsbFJlY3QoMTI4IC0gMSwgMCwgMSwgNjQpOwogICAgICBjdHguc3Ryb2tlU3R5bGUgPSAiI2ZmZiI7CiAgICAgIGN0eC5iZWdpblBhdGgoKTsKICAgICAgY3R4Lm1vdmVUbygxMjggLSAxLCAoMSAtIEdhbWUucHJldmlvdXNGcHMgLyBHYW1lLmZwcykgKiA2NCk7CiAgICAgIGN0eC5saW5lVG8oMTI4LCAoMSAtIEdhbWUuY3VycmVudEZwcyAvIEdhbWUuZnBzKSAqIDY0KTsKICAgICAgY3R4LnN0cm9rZSgpOwoKICAgICAgbCgiZnBzQ291bnRlciIpLnRleHRDb250ZW50ID0gR2FtZS5jdXJyZW50RnBzICsgIiBmcHMiOwogICAgICB2YXIgc3RyID0gIiI7CiAgICAgIGZvciAodmFyIGkgaW4gVGltZXIubGFiZWxzKSB7CiAgICAgICAgc3RyICs9IFRpbWVyLmxhYmVsc1tpXTsKICAgICAgfQogICAgICBpZiAoR2FtZS5kZWJ1Z1RpbWVyc09uKSBsKCJkZWJ1Z0xvZyIpLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICBlbHNlIGwoImRlYnVnTG9nIikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgbCgiZGVidWdMb2ciKS5pbm5lckhUTUwgPSBzdHI7CiAgICB9CiAgICBUaW1lci5yZXNldCgpOwoKICAgIEdhbWUubG9vcFQrKzsKICAgIHNldFRpbWVvdXQoR2FtZS5Mb29wLCAxMDAwIC8gR2FtZS5mcHMpOwogIH07Cn07CgovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KTEFVTkNIIFRISVMgVEhJTkcKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KLy9HYW1lLkxhdW5jaCgpOwoKLy90cnkge0dhbWUuTGF1bmNoKCk7fQovL2NhdGNoKGVycikge2NvbnNvbGUubG9nKCdFUlJPUiA6ICcrZXJyLm1lc3NhZ2UpO30KCndpbmRvdy5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgaWYgKCFHYW1lLnJlYWR5KSB7CiAgICB2YXIgbG9hZExhbmdBbmRMYXVuY2ggPSBmdW5jdGlvbiAobGFuZywgZmlyc3RMYXVuY2gpIHsKICAgICAgaWYgKCFmaXJzdExhdW5jaCkgbG9jYWxTdG9yYWdlU2V0KCJDb29raWVDbGlja2VyTGFuZyIsIGxhbmcpOwoKICAgICAgLy9Mb2FkTGFuZygnLi4vQ29va2llIENsaWNrZXIgTG9jYWxpemF0aW9uL0VOLmpzJyxmdW5jdGlvbihsYW5nKXtyZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgTG9hZExhbmcoCiAgICAgICAgImxvYy9FTi5qcz92PSIgKyBHYW1lLnZlcnNpb24sCiAgICAgICAgKGZ1bmN0aW9uIChsYW5nKSB7CiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBsb2NTdHJpbmdzRmFsbGJhY2sgPSBsb2NTdHJpbmdzOwogICAgICAgICAgICBMb2FkTGFuZygibG9jLyIgKyBsYW5nICsgIi5qcz92PSIgKyBHYW1lLnZlcnNpb24sIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICB2YXIgbGF1bmNoID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgR2FtZS5MYXVuY2goKTsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKAogICAgICAgICAgICAgICAgICAiWz09PSAiICsKICAgICAgICAgICAgICAgICAgICBjaG9vc2UoWwogICAgICAgICAgICAgICAgICAgICAgIk9oLCBoZWxsbyEiLAogICAgICAgICAgICAgICAgICAgICAgImhleSwgaG93J3MgaXQgaGFuZ2luIiwKICAgICAgICAgICAgICAgICAgICAgICJBYm91dCB0byBjaGVhdCBpbiBzb21lIGNvb2tpZXMgb3IganVzdCBjaGVja2luZyBmb3IgYnVncz8iLAogICAgICAgICAgICAgICAgICAgICAgIlJlbWVtYmVyIDogY2hlYXRlZCBjb29raWVzIHRhc3RlIGF3ZnVsISIsCiAgICAgICAgICAgICAgICAgICAgICAiSGV5LCBPcnRlaWwgaGVyZS4gQ2hlYXRlZCBjb29raWVzIHRhc3RlIGF3ZnVsLi4uIG9yIGRvIHRoZXk/IiwKICAgICAgICAgICAgICAgICAgICBdKSArCiAgICAgICAgICAgICAgICAgICAgIiA9PT1dIgogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIEdhbWUuTG9hZChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIEdhbWUuSW5pdCgpOwogICAgICAgICAgICAgICAgICBpZiAoZmlyc3RMYXVuY2gpIEdhbWUuc2hvd0xhbmdTZWxlY3Rpb24odHJ1ZSk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIC8vdHJ5IHtHYW1lLkxvYWQoR2FtZS5Jbml0KTt9CiAgICAgICAgICAgICAgICAvL2NhdGNoKGVycikge2NvbnNvbGUubG9nKCdFUlJPUiA6ICcrZXJyLm1lc3NhZ2UpO30KICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIGlmIChBcHAgJiYgQXBwLmxvYWRNb2RzKSBBcHAubG9hZE1vZHMobGF1bmNoKTsKICAgICAgICAgICAgICBlbHNlIGxhdW5jaCgpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH07CiAgICAgICAgfSkobGFuZykKICAgICAgKTsKICAgIH07CgogICAgdmFyIHNob3dMYW5nU2VsZWN0ID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7CiAgICAgIHZhciBzdHIgPSAiIjsKICAgICAgZm9yICh2YXIgaSBpbiBMYW5ncykgewogICAgICAgIHZhciBsYW5nID0gTGFuZ3NbaV07CiAgICAgICAgc3RyICs9CiAgICAgICAgICAnPGRpdiBjbGFzcz0ibGFuZ1NlbGVjdEJ1dHRvbiB0aXRsZSIgaWQ9ImxhbmdTZWxlY3QtJyArCiAgICAgICAgICBpICsKICAgICAgICAgICciPicgKwogICAgICAgICAgbGFuZy5uYW1lICsKICAgICAgICAgICI8L2Rpdj4iOwogICAgICB9CiAgICAgIGwoIm9mZkdhbWVNZXNzYWdlIikuaW5uZXJIVE1MID0KICAgICAgICAnPGRpdiBjbGFzcz0idGl0bGUiIGlkPSJsYW5ndWFnZVNlbGVjdEhlYWRlciI+TGFuZ3VhZ2U8L2Rpdj4nICsKICAgICAgICAnPGRpdiBjbGFzcz0ibGluZSIgc3R5bGU9Im1heC13aWR0aDozMDBweDsiPjwvZGl2PicgKwogICAgICAgIHN0cjsKICAgICAgZm9yICh2YXIgaSBpbiBMYW5ncykgewogICAgICAgIHZhciBsYW5nID0gTGFuZ3NbaV07CiAgICAgICAgQWRkRXZlbnQoCiAgICAgICAgICBsKCJsYW5nU2VsZWN0LSIgKyBpKSwKICAgICAgICAgICJjbGljayIsCiAgICAgICAgICAoZnVuY3Rpb24gKGxhbmcpIHsKICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBjYWxsYmFjayhsYW5nKTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0pKGkpCiAgICAgICAgKTsKICAgICAgICBBZGRFdmVudCgKICAgICAgICAgIGwoImxhbmdTZWxlY3QtIiArIGkpLAogICAgICAgICAgIm1vdXNlb3ZlciIsCiAgICAgICAgICAoZnVuY3Rpb24gKGxhbmcpIHsKICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBQbGF5U291bmQoInNuZC9zbWFsbFRpY2subXAzIiwgMC43NSk7CiAgICAgICAgICAgICAgbCgibGFuZ3VhZ2VTZWxlY3RIZWFkZXIiKS5pbm5lckhUTUwgPSBMYW5nc1tsYW5nXS5jaGFuZ2VMYW5ndWFnZTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0pKGkpCiAgICAgICAgKTsKICAgICAgfQogICAgfTsKCiAgICB2YXIgbGFuZyA9IGxvY2FsU3RvcmFnZUdldCgiQ29va2llQ2xpY2tlckxhbmciKTsKICAgIGlmIChBcHAgJiYgIWxhbmcpIHNob3dMYW5nU2VsZWN0KGxvYWRMYW5nQW5kTGF1bmNoKTsKICAgIGVsc2UgaWYgKCFsYW5nKSB7CiAgICAgIGxvYWRMYW5nQW5kTGF1bmNoKCJFTiIsIHRydWUpOwogICAgfSBlbHNlIGxvYWRMYW5nQW5kTGF1bmNoKGxhbmcpOwogIH0KfTsK"></script>

    <!-- ad -->
    <script src="showads.js"></script>
    <!-- /ad -->

    <!--[if IE]>
      <style type="text/css">
        #ifIE9 {
          display: block;
        }
      </style>
    <![endif]-->

    <!--[if lt IE9]><script src="excanvas.compiled.js"></script><![endif]-->
  </head>
  <body>
    <div id="wrapper">
      <div id="topBar">
        <div><b style="font-weight: bold;">Cookies</b>&trade; &copy; <a href="https://google.com" target="_blank" id="topbarOrteil">Teethpasta</a>, 2022 - <a href="https://google.com" target="_blank" id="topbarDashnet">Teethpasta</a></div>
        <div><a href="https://google.com" target="_blank" id="topbarTwitter">Blank</a></div>
        <div><a href="https://google.com" target="_blank" id="topbarTumblr">Blank</a></div>
        <div style="position: relative;">
          <div style="width: 22px; height: 32px; background: url(img/discord.png); position: absolute; left: 0px; top: 0px; pointer-events: none;"></div>
          <a href="https://google.com" target="_blank" style="padding-left: 16px;" id="topbarDiscord">Blank</a>
        </div>
        <div style="position: relative;">
          <div style="width: 25px; height: 32px; background: url(img/weeHoodie.png); position: absolute; left: -2px; top: 0px; pointer-events: none;"></div>
          <a class="blueLink" href="https://google.com" target="_blank" style="padding-left: 12px;" id="topbarMerch">Nothing</a>
        </div>
        <div style="position: relative;">
          <div style="width: 22px; height: 32px; background: url(img/patreon.png); position: absolute; left: 0px; top: 0px; pointer-events: none;"></div>
          <a class="orangeLink" href="https://google.com" target="_blank" style="padding-left: 16px;" id="topbarPatreon">Patreon</a>
        </div>
        <div style="position: relative; display: none; font-weight: bold;" id="heralds">
          <div style="position: absolute; top: -4px; width: 31px; height: 39px; background: url(img/heraldFlag.png); left: 50%; margin-left: -15px; pointer-events: none;"></div>
          <div id="heraldsAmount" style="position: relative; z-index: 10; text-shadow: 0px 1px 0px #000, 0px 0px 6px #ff00e4; color: #fff;">-</div>
        </div>
        <div><a class="lightblueLink" style="font-weight: bold;" href="https://google.com" target="_blank" id="topbarMobileCC">Blank</a></div>
        <div><a class="lightblueLink" style="font-weight: bold;" href="https://google.com" target="_blank" id="topbarSteamCC">Blank</a></div>
        <div style="float: right; position: relative;">
          <div id="tinyglobe" style="position: absolute; top: -4px; width: 22px; height: 22px; background: url(img/tinyglobeSheet.gif); right: 4px; top: 4px; pointer-events: none;"></div>
          <a
            id="changeLanguage"
            style="font-variant: small-caps; padding-right: 20px;"
            onmouseover="INTERVAL_TINYGLOBE=setInterval(function(){var tinyglobe=document.getElementById('tinyglobe');tinyglobe.style.backgroundPosition=(parseInt(tinyglobe.style.backgroundPosition)-22)+'px';},30);"
            onmouseout="clearInterval(INTERVAL_TINYGLOBE);"
          >
            Change language
          </a>
          <script>
            document.getElementById("tinyglobe").style.backgroundPosition = -[0, 19, 27][Math.floor(Math.random() * 3)] * 22 + "px";
          </script>
        </div>
        <div id="links" class="hoverer">
          Other versions
          <div class="hoverable">
          </div>
        </div>
      </div>
      <div id="game">
        <div id="versionNumber" class="title"></div>
        <script>
          document.getElementById("versionNumber").innerHTML = "v. " + VERSION;
        </script>
        <div id="offGameMessageWrap">
          <div id="offGameMessage">
            <div id="loader">
              <div class="spinnyBig"></div>
              <div class="spinnySmall"></div>
              <div id="loading" class="title">Loading...</div>
              <div id="failedToLoad" class="title">
                This is taking longer than expected...<br />
                <div style="font-size: 65%; line-height: 120%;">
                  <!-- error -->Slow connection? If not, please make sure your javascript is enabled, then refresh.<br />
                  If problems persist, this might be on our side - wait a few minutes, then hit ctrl+f5!<br /><!-- /error -->
                  If you can open a issue in the github so we know this happened!
                </div>
              </div>
              <div id="ifIE9" class="title" style="font-size: 100%; line-height: 120%;">
                Your browser may not be recent enough to run Cookies.<br />
                You might want to update, or switch to a more modern browser such as Chrome or Firefox.
              </div>
            </div>
          </div>
        </div>

        <canvas id="backgroundCanvas"></canvas>

        <div id="goldenCookie" class="goldenCookie"></div>
        <div id="seasonPopup" class="seasonPopup"></div>
        <div id="shimmers"></div>
        <div id="alert"></div>
        <div id="particles"></div>
        <div id="sparkles" class="sparkles"></div>
        <div id="notes"></div>
        <div id="darken"></div>
        <div id="toggleBox" class="framed prompt"></div>
        <div id="promptAnchor">
          <div id="prompt" class="framed">
            <div id="promptContent"></div>
            <div id="promptClose" class="close" style="display: none;" onclick="PlaySound('snd/tickOff.mp3');Game.ClosePrompt();">x</div>
          </div>
        </div>
        <div id="ascend">
          <div id="ascendBG"></div>
          <div id="ascendZoomable">
            <div id="ascendContent"><div id="ascendUpgrades" style="position: absolute;"></div></div>
          </div>
          <div id="ascendOverlay"></div>
        </div>

        <div id="debug">
          <div id="devConsole" class="framed"></div>
          <div id="debugLog"></div>
        </div>

        <div id="sectionLeft" class="inset">
          <canvas id="backgroundLeftCanvas" style="z-index: 5;"></canvas>
          <div class="blackFiller"></div>
          <div class="blackGradient"></div>
          <div id="sectionLeftInfo"></div>
          <div id="cookies" class="title"></div>
          <div id="bakeryNameAnchor"><div id="bakeryName" class="title"></div></div>
          <div id="specialPopup" class="framed prompt offScreen"></div>
          <div id="buffs" class="crateBox"></div>
          <div id="cookieAnchor">
            <button id="bigCookie"></button>
            <div id="cookieNumbers"></div>
          </div>
          <div id="sectionLeftExtra"></div>
        </div>

        <div class="separatorLeft" id="leftBeam"></div>
        <div class="separatorRight" id="rightBeam"></div>

        <div id="sectionMiddle" class="inset">
          <div id="comments" class="inset title">
            <div id="prefsButton" class="panelButton"><div class="subButton">Options</div></div>
            <div id="statsButton" class="panelButton"><div>Stats</div></div>
            <div id="logButton" class="panelButton">
              <div>Info</div>
              <div id="checkForUpdate">New update!</div>
            </div>
            <div id="legacyButton" class="panelButton">
              <div class="subButton">Legacy</div>
              <div id="ascendMeterContainer" class="smallFramed meterContainer"><div id="ascendMeter" class="meter filling"></div></div>
              <div class="roundedPanel" id="ascendNumber"></div>
              <div id="ascendTooltip" class="framed"></div>
            </div>
            <div id="commentsText">
              <div id="commentsText1" class="commentsText"></div>
              <div id="commentsText2" class="commentsText"></div>
            </div>
            <div class="separatorBottom"></div>
          </div>
          <div id="centerArea">
            <div id="buildingsTitle" class="inset title zoneTitle">Buildings</div>
            <div id="buildingsMaster"></div>
            <div id="rows"></div>
            <div id="menu"></div>
          </div>
        </div>

        <div id="sectionRight" class="inset">
          <div id="store">
            <div id="storeTitle" class="inset title zoneTitle">Store</div>
            <div id="toggleUpgrades" class="storeSection upgradeBox"></div>
            <div id="techUpgrades" class="storeSection upgradeBox"></div>
            <div id="vaultUpgrades" class="storeSection upgradeBox"></div>
            <div id="upgrades" class="storeSection upgradeBox"></div>
            <div id="products" class="storeSection"></div>
          </div>
        </div>

        <div id="tooltipAnchor"><div id="tooltip" class="framed" onMouseOut="Game.tooltip.hide();"></div></div>
        <div id="preloadImages" style="display: none;"></div>
      </div>
    </div>
  </body>
</html>
